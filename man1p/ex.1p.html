<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:45:11 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>EX(1P) POSIX Programmer&rsquo;s Manual EX(1P)</p>

<p style="margin-top: 1em">PROLOG <br>
This manual page is part of the POSIX Programmer&rsquo;s
Manual. The Linux implementation of this interface may
differ (consult the corresponding Linux manual page for
details of <br>
Linux behavior), or the interface may not be implemented on
Linux.</p>

<p style="margin-top: 1em">NAME <br>
ex - text editor</p>

<p style="margin-top: 1em">SYNOPSIS <br>
ex [-rR][-s | -v][-c command][-t tagstring][-w size][file
...]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
The ex utility is a line-oriented text editor. There are two
other modes of the editor-open and visual-in which
screen-oriented editing is available. This is described more
fully <br>
by the ex open and visual commands and in vi .</p>

<p style="margin-top: 1em">This section uses the term edit
buffer to describe the current working text. No specific
implementation is implied by this term. All editing changes
are performed on the edit <br>
buffer, and no changes to it shall affect any file until an
editor command writes the file.</p>

<p style="margin-top: 1em">Certain terminals do not have
all the capabilities necessary to support the complete ex
definition, such as the full-screen editing commands (
visual mode or open mode). When <br>
these commands cannot be supported on such terminals, this
condition shall not produce an error message such as
&quot;not an editor command&quot; or report a syntax error.
The implementa&acirc; <br>
tion may either accept the commands and produce results on
the screen that are the result of an unsuccessful attempt to
meet the requirements of this volume of <br>
IEEE Std 1003.1-2001 or report an error describing the
terminal-related deficiency.</p>

<p style="margin-top: 1em">OPTIONS <br>
The ex utility shall conform to the Base Definitions volume
of IEEE Std 1003.1-2001, Section 12.2, Utility Syntax
Guidelines.</p>

<p style="margin-top: 1em">The following options shall be
supported:</p>

<p style="margin-top: 1em">-c command <br>
Specify an initial command to be executed in the first edit
buffer loaded from an existing file (see the EXTENDED
DESCRIPTION section). Implementations may support more <br>
than a single -c option. In such implementations, the
specified commands shall be executed in the order specified
on the command line.</p>

<p style="margin-top: 1em">-r Recover the named files (see
the EXTENDED DESCRIPTION section). Recovery information for
a file shall be saved during an editor or system crash (for
example, when the edi&acirc; <br>
tor is terminated by a signal which the editor can catch),
or after the use of an ex preserve command.</p>

<p style="margin-top: 1em">A crash in this context is an
unexpected failure of the system or utility that requires
restarting the failed system or utility. A system crash
implies that any utilities running <br>
at the time also crash. In the case of an editor or system
crash, the number of changes to the edit buffer (since the
most recent preserve command) that will be recovered is <br>
unspecified.</p>

<p style="margin-top: 1em">If no file operands are given
and the -t option is not specified, all other options, the
EXINIT variable, and any .exrc files shall be ignored; a
list of all recoverable files <br>
available to the invoking user shall be written, and the
editor shall exit normally without further action.</p>

<p style="margin-top: 1em">-R Set readonly edit option.</p>

<p style="margin-top: 1em">-s Prepare ex for batch use by
taking the following actions:</p>

<p style="margin-top: 1em">* Suppress writing prompts and
informational (but not diagnostic) messages.</p>

<p style="margin-top: 1em">* Ignore the value of TERM and
any implementation default terminal type and assume the
terminal is a type incapable of supporting open or visual
modes; see the visual <br>
command and the description of vi .</p>

<p style="margin-top: 1em">* Suppress the use of the EXINIT
environment variable and the reading of any .exrc file; see
the EXTENDED DESCRIPTION section.</p>

<p style="margin-top: 1em">* Suppress autoindentation,
ignoring the value of the autoindent edit option.</p>

<p style="margin-top: 1em">-t tagstring <br>
Edit the file containing the specified tagstring; see ctags
. The tags feature represented by -t tagstring and the tag
command is optional. It shall be provided on any <br>
system that also provides a conforming implementation of
ctags; otherwise, the use of -t produces undefined results.
On any system, it shall be an error to specify more <br>
than a single -t option.</p>

<p style="margin-top: 1em">-v Begin in visual mode (see vi
).</p>

<p style="margin-top: 1em">-w size <br>
Set the value of the window editor option to size.</p>

<p style="margin-top: 1em">OPERANDS <br>
The following operand shall be supported:</p>

<p style="margin-top: 1em">file A pathname of a file to be
edited.</p>

<p style="margin-top: 1em">STDIN <br>
The standard input consists of a series of commands and
input text, as described in the EXTENDED DESCRIPTION
section. The implementation may limit each line of standard
input to <br>
a length of {LINE_MAX}.</p>

<p style="margin-top: 1em">If the standard input is not a
terminal device, it shall be as if the -s option had been
specified.</p>

<p style="margin-top: 1em">If a read from the standard
input returns an error, or if the editor detects an
end-of-file condition from the standard input, it shall be
equivalent to a SIGHUP asynchronous <br>
event.</p>

<p style="margin-top: 1em">INPUT FILES <br>
Input files shall be text files or files that would be text
files except for an incomplete last line that is not longer
than {LINE_MAX}-1 bytes in length and contains no NUL <br>
characters. By default, any incomplete last line shall be
treated as if it had a trailing &lt;newline&gt;. The editing
of other forms of files may optionally be allowed by ex
implemen&acirc; <br>
tations.</p>

<p style="margin-top: 1em">The .exrc files and source files
shall be text files consisting of ex commands; see the
EXTENDED DESCRIPTION section.</p>

<p style="margin-top: 1em">By default, the editor shall
read lines from the files to be edited without interpreting
any of those lines as any form of editor command.</p>

<p style="margin-top: 1em">ENVIRONMENT VARIABLES <br>
The following environment variables shall affect the
execution of ex:</p>

<p style="margin-top: 1em">COLUMNS <br>
Override the system-selected horizontal screen size. See the
Base Definitions volume of IEEE Std 1003.1-2001, Chapter 8,
Environment Variables for valid values and results <br>
when it is unset or null.</p>

<p style="margin-top: 1em">EXINIT Determine a list of ex
commands that are executed on editor start-up. See the
EXTENDED DESCRIPTION section for more details of the
initialization phase.</p>

<p style="margin-top: 1em">HOME Determine a pathname of a
directory that shall be searched for an editor start-up file
named .exrc; see the EXTENDED DESCRIPTION section.</p>

<p style="margin-top: 1em">LANG Provide a default value for
the internationalization variables that are unset or null.
(See the Base Definitions volume of IEEE Std 1003.1-2001,
Section 8.2, Internation&acirc; <br>
alization Variables for the precedence of
internationalization variables used to determine the values
of locale categories.)</p>

<p style="margin-top: 1em">LC_ALL If set to a non-empty
string value, override the values of all the other
internationalization variables.</p>

<p style="margin-top: 1em">LC_COLLATE</p>

<p style="margin-top: 1em">Determine the locale for the
behavior of ranges, equivalence classes, and multi-character
collating elements within regular expressions.</p>

<p style="margin-top: 1em">LC_CTYPE <br>
Determine the locale for the interpretation of sequences of
bytes of text data as characters (for example, single-byte
as opposed to multi-byte characters in arguments and <br>
input files), the behavior of character classes within
regular expressions, the classification of characters as
uppercase or lowercase letters, the case conversion of
let&acirc; <br>
ters, and the detection of word boundaries.</p>

<p style="margin-top: 1em">LC_MESSAGES <br>
Determine the locale that should be used to affect the
format and contents of diagnostic messages written to
standard error.</p>

<p style="margin-top: 1em">LINES Override the
system-selected vertical screen size, used as the number of
lines in a screenful and the vertical screen size in visual
mode. See the Base Definitions volume <br>
of IEEE Std 1003.1-2001, Chapter 8, Environment Variables
for valid values and results when it is unset or null.</p>

<p style="margin-top: 1em">NLSPATH <br>
Determine the location of message catalogs for the
processing of LC_MESSAGES .</p>

<p style="margin-top: 1em">PATH Determine the search path
for the shell command specified in the ex editor commands !,
shell, read, and write, and the open and visual mode command
!; see the description <br>
of command search and execution in Command Search and
Execution .</p>

<p style="margin-top: 1em">SHELL Determine the preferred
command line interpreter for use as the default value of the
shell edit option.</p>

<p style="margin-top: 1em">TERM Determine the name of the
terminal type. If this variable is unset or null, an
unspecified default terminal type shall be used.</p>

<p style="margin-top: 1em">ASYNCHRONOUS EVENTS <br>
The following term is used in this and following sections to
specify command and asynchronous event actions:</p>

<p style="margin-top: 1em">complete write</p>

<p style="margin-top: 1em">A complete write is a write of
the entire contents of the edit buffer to a file of a type
other than a terminal device, or the saving of the edit
buffer caused by the user <br>
executing the ex preserve command. Writing the contents of
the edit buffer to a temporary file that will be removed
when the editor exits shall not be considered a com&acirc;
<br>
plete write.</p>

<p style="margin-top: 1em">The following actions shall be
taken upon receipt of signals:</p>

<p style="margin-top: 1em">SIGINT If the standard input is
not a terminal device, ex shall not write the file or return
to command or text input mode, and shall exit with a
non-zero exit status.</p>

<p style="margin-top: 1em">Otherwise, if executing an open
or visual text input mode command, ex in receipt of SIGINT
shall behave identically to its receipt of the &lt;ESC&gt;
character.</p>

<p style="margin-top: 1em">Otherwise:</p>

<p style="margin-top: 1em">1. If executing an ex text input
mode command, all input lines that have been completely
entered shall be resolved into the edit buffer, and any
partially entered line <br>
shall be discarded.</p>

<p style="margin-top: 1em">2. If there is a currently
executing command, it shall be aborted and a message
displayed. Unless otherwise specified by the ex or vi
command descriptions, it is unspeci&acirc; <br>
fied whether any lines modified by the executing command
appear modified, or as they were before being modified by
the executing command, in the buffer.</p>

<p style="margin-top: 1em">If the currently executing
command was a motion command, its associated command shall
be discarded.</p>

<p style="margin-top: 1em">3. If in open or visual command
mode, the terminal shall be alerted.</p>

<p style="margin-top: 1em">4. The editor shall then return
to command mode.</p>

<p style="margin-top: 1em">SIGCONT <br>
The screen shall be refreshed if in open or visual mode.</p>

<p style="margin-top: 1em">SIGHUP If the edit buffer has
been modified since the last complete write, ex shall
attempt to save the edit buffer so that it can be recovered
later using the -r option or the <br>
ex recover command. The editor shall not write the file or
return to command or text input mode, and shall terminate
with a non-zero exit status.</p>

<p style="margin-top: 1em">SIGTERM <br>
Refer to SIGHUP.</p>

<p style="margin-top: 1em">The action taken for all other
signals is unspecified.</p>

<p style="margin-top: 1em">STDOUT <br>
The standard output shall be used only for writing prompts
to the user, for informational messages, and for writing
lines from the file.</p>

<p style="margin-top: 1em">STDERR <br>
The standard error shall be used only for diagnostic
messages.</p>

<p style="margin-top: 1em">OUTPUT FILES <br>
The output from ex shall be text files.</p>

<p style="margin-top: 1em">EXTENDED DESCRIPTION <br>
Only the ex mode of the editor is described in this section.
See vi for additional editing capabilities available in
ex.</p>

<p style="margin-top: 1em">When an error occurs, ex shall
write a message. If the terminal supports a standout mode
(such as inverse video), the message shall be written in
standout mode. If the terminal <br>
does not support a standout mode, and the edit option
errorbells is set, an alert action shall precede the error
message.</p>

<p style="margin-top: 1em">By default, ex shall start in
command mode, which shall be indicated by a : prompt; see
the prompt command. Text input mode can be entered by the
append, insert, or change com&acirc; <br>
mands; it can be exited (and command mode re-entered) by
typing a period ( &rsquo;.&rsquo; ) alone at the beginning
of a line.</p>

<p style="margin-top: 1em">Initialization in ex and vi <br>
The following symbols are used in this and following
sections to specify locations in the edit buffer:</p>

<p style="margin-top: 1em">alternate and current
pathnames</p>

<p style="margin-top: 1em">Two pathnames, named current and
alternate, are maintained by the editor. Any ex commands
that take filenames as arguments shall set them as
follows:</p>

<p style="margin-top: 1em">1. If a file argument is
specified to the ex edit, ex, or recover commands, or if an
ex tag command replaces the contents of the edit buffer.</p>

<p style="margin-top: 1em">a. If the command replaces the
contents of the edit buffer, the current pathname shall be
set to the file argument or the file indicated by the tag,
and the alternate <br>
pathname shall be set to the previous value of the current
pathname.</p>

<p style="margin-top: 1em">b. Otherwise, the alternate
pathname shall be set to the file argument.</p>

<p style="margin-top: 1em">2. If a file argument is
specified to the ex next command:</p>

<p style="margin-top: 1em">a. If the command replaces the
contents of the edit buffer, the current pathname shall be
set to the first file argument, and the alternate pathname
shall be set to <br>
the previous value of the current pathname.</p>

<p style="margin-top: 1em">3. If a file argument is
specified to the ex file command, the current pathname shall
be set to the file argument, and the alternate pathname
shall be set to the previous <br>
value of the current pathname.</p>

<p style="margin-top: 1em">4. If a file argument is
specified to the ex read and write commands (that is, when
reading or writing a file, and not to the program named by
the shell edit option), or <br>
a file argument is specified to the ex xit command:</p>

<p style="margin-top: 1em">a. If the current pathname has
no value, the current pathname shall be set to the file
argument.</p>

<p style="margin-top: 1em">b. Otherwise, the alternate
pathname shall be set to the file argument.</p>

<p style="margin-top: 1em">If the alternate pathname is set
to the previous value of the current pathname when the
current pathname had no previous value, then the alternate
pathname shall have no value as <br>
a result.</p>

<p style="margin-top: 1em">current line</p>

<p style="margin-top: 1em">The line of the edit buffer
referenced by the cursor. Each command description specifies
the current line after the command has been executed, as the
current line value. <br>
When the edit buffer contains no lines, the current line
shall be zero; see Addressing in ex .</p>

<p style="margin-top: 1em">current column</p>

<p style="margin-top: 1em">The current display line column
occupied by the cursor. (The columns shall be numbered
beginning at 1.) Each command description specifies the
current column after the <br>
command has been executed, as the current column value. This
column is an ideal column that is remembered over the
lifetime of the editor. The actual display line column <br>
upon which the cursor rests may be different from the
current column; see the cursor positioning discussion in
Command Descriptions in vi .</p>

<p style="margin-top: 1em">set to non-&lt;blank&gt;</p>

<p style="margin-top: 1em">A description for a current
column value, meaning that the current column shall be set
to the last display line column on which is displayed any
part of the first non- <br>
&lt;blank&gt; of the line. If the line has no non-
&lt;blank&gt; non- &lt;newline&gt;s, the current column
shall be set to the last display line column on which is
displayed any part of the <br>
last non- &lt;newline&gt; in the line. If the line is empty,
the current column shall be set to column position 1.</p>

<p style="margin-top: 1em">The length of lines in the edit
buffer may be limited to {LINE_MAX} bytes. In open and
visual mode, the length of lines in the edit buffer may be
limited to the number of charac&acirc; <br>
ters that will fit in the display. If either limit is
exceeded during editing, an error message shall be written.
If either limit is exceeded by a line read in from a file,
an <br>
error message shall be written and the edit session may be
terminated.</p>

<p style="margin-top: 1em">If the editor stops running due
to any reason other than a user command, and the edit buffer
has been modified since the last complete write, it shall be
equivalent to a SIGHUP <br>
asynchronous event. If the system crashes, it shall be
equivalent to a SIGHUP asynchronous event.</p>

<p style="margin-top: 1em">During initialization (before
the first file is copied into the edit buffer or any user
commands from the terminal are processed) the following
shall occur:</p>

<p style="margin-top: 1em">1. If the environment variable
EXINIT is set, the editor shall execute the ex commands
contained in that variable.</p>

<p style="margin-top: 1em">2. If the EXINIT variable is not
set, and all of the following are true:</p>

<p style="margin-top: 1em">a. The HOME environment variable
is not null and not empty.</p>

<p style="margin-top: 1em">b. The file .exrc in the
directory referred to by the HOME environment variable:</p>

<p style="margin-top: 1em">1. Exists</p>

<p style="margin-top: 1em">2. Is owned by the same user ID
as the real user ID of the process or the process has
appropriate privileges</p>

<p style="margin-top: 1em">3. Is not writable by anyone
other than the owner</p>

<p style="margin-top: 1em">the editor shall execute the ex
commands contained in that file.</p>

<p style="margin-top: 1em">3. If and only if all of the
following are true:</p>

<p style="margin-top: 1em">a. The current directory is not
referred to by the HOME environment variable.</p>

<p style="margin-top: 1em">b. A command in the EXINIT
environment variable or a command in the .exrc file in the
directory referred to by the HOME environment variable sets
the editor option exrc.</p>

<p style="margin-top: 1em">c. The .exrc file in the current
directory:</p>

<p style="margin-top: 1em">1. Exists</p>

<p style="margin-top: 1em">2. Is owned by the same user ID
as the real user ID of the process, or by one of a set of
implementation-defined user IDs</p>

<p style="margin-top: 1em">3. Is not writable by anyone
other than the owner</p>

<p style="margin-top: 1em">the editor shall attempt to
execute the ex commands contained in that file.</p>

<p style="margin-top: 1em">Lines in any .exrc file that are
blank lines shall be ignored. If any .exrc file exists, but
is not read for ownership or permission reasons, it shall be
an error.</p>

<p style="margin-top: 1em">After the EXINIT variable and
any .exrc files are processed, the first file specified by
the user shall be edited, as follows:</p>

<p style="margin-top: 1em">1. If the user specified the -t
option, the effect shall be as if the ex tag command was
entered with the specified argument, with the exception that
if tag processing does not <br>
result in a file to edit, the effect shall be as described
in step 3. below.</p>

<p style="margin-top: 1em">2. Otherwise, if the user
specified any command line file arguments, the effect shall
be as if the ex edit command was entered with the first of
those arguments as its file <br>
argument.</p>

<p style="margin-top: 1em">3. Otherwise, the effect shall
be as if the ex edit command was entered with a nonexistent
filename as its file argument. It is unspecified whether
this action shall set the <br>
current pathname. In an implementation where this action
does not set the current pathname, any editor command using
the current pathname shall fail until an editor command <br>
sets the current pathname.</p>

<p style="margin-top: 1em">If the -r option was specified,
the first time a file in the initial argument list or a file
specified by the -t option is edited, if recovery
information has previously been <br>
saved about it, that information shall be recovered and the
editor shall behave as if the contents of the edit buffer
have already been modified. If there are multiple instances
<br>
of the file to be recovered, the one most recently saved
shall be recovered, and an informational message that there
are previous versions of the file that can be recovered
shall <br>
be written. If no recovery information about a file is
available, an informational message to this effect shall be
written, and the edit shall proceed as usual.</p>

<p style="margin-top: 1em">If the -c option was specified,
the first time a file that already exists (including a file
that might not exist but for which recovery information is
available, when the -r <br>
option is specified) replaces or initializes the contents of
the edit buffer, the current line shall be set to the last
line of the edit buffer, the current column shall be set
<br>
to non- &lt;blank&gt;, and the ex commands specified with
the -c option shall be executed. In this case, the current
line and current column shall not be set as described for
the com&acirc; <br>
mand associated with the replacement or initialization of
the edit buffer contents. However, if the -t option or a tag
command is associated with this action, the -c option
com&acirc; <br>
mands shall be executed and then the movement to the tag
shall be performed.</p>

<p style="margin-top: 1em">The current argument list shall
initially be set to the filenames specified by the user on
the command line. If no filenames are specified by the user,
the current argument list <br>
shall be empty. If the -t option was specified, it is
unspecified whether any filename resulting from tag
processing shall be prepended to the current argument list.
In the case <br>
where the filename is added as a prefix to the current
argument list, the current argument list reference shall be
set to that filename. In the case where the filename is not
<br>
added as a prefix to the current argument list, the current
argument list reference shall logically be located before
the first of the filenames specified on the command line
<br>
(for example, a subsequent ex next command shall edit the
first filename from the command line). If the -t option was
not specified, the current argument list reference shall be
<br>
to the first of the filenames on the command line.</p>

<p style="margin-top: 1em">Addressing in ex <br>
Addressing in ex relates to the current line and the current
column; the address of a line is its 1-based line number,
the address of a column is its 1-based count from the <br>
beginning of the line. Generally, the current line is the
last line affected by a command. The current line number is
the address of the current line. In each command
descrip&acirc; <br>
tion, the effect of the command on the current line number
and the current column is described.</p>

<p style="margin-top: 1em">Addresses are constructed as
follows:</p>

<p style="margin-top: 1em">1. The character &rsquo;.&rsquo;
(period) shall address the current line.</p>

<p style="margin-top: 1em">2. The character &rsquo;$&rsquo;
shall address the last line of the edit buffer.</p>

<p style="margin-top: 1em">3. The positive decimal number n
shall address the nth line of the edit buffer.</p>

<p style="margin-top: 1em">4. The address
&quot;&rsquo;x&quot; refers to the line marked with the mark
name character &rsquo;x&rsquo;, which shall be a lowercase
letter from the portable character set or one of the
characters &rsquo;&lsquo;&rsquo; or <br>
&rsquo;&quot; . It shall be an error if the line that was
marked is not currently present in the edit buffer or the
mark has not been set. Lines can be marked with the ex mark
or k com&acirc; <br>
mands, or the vi m command.</p>

<p style="margin-top: 1em">5. A regular expression enclosed
by slashes ( &rsquo;/&rsquo; ) shall address the first line
found by searching forwards from the line following the
current line toward the end of the edit <br>
buffer and stopping at the first line for which the line
excluding the terminating &lt;newline&gt; matches the
regular expression. As stated in Regular Expressions in ex,
an <br>
address consisting of a null regular expression delimited by
slashes &quot;//&quot; shall address the next line for which
the line excluding the terminating &lt;newline&gt; matches
the last <br>
regular expression encountered. In addition, the second
slash can be omitted at the end of a command line. If the
wrapscan edit option is set, the search shall wrap around to
<br>
the beginning of the edit buffer and continue up to and
including the current line, so that the entire edit buffer
is searched. Within the regular expression, the sequence
<br>
&quot;&quot; shall represent a literal slash instead of the
regular expression delimiter.</p>

<p style="margin-top: 1em">6. A regular expression enclosed
in question marks ( &rsquo;?&rsquo; ) shall address the
first line found by searching backwards from the line
preceding the current line toward the begin&acirc; <br>
ning of the edit buffer and stopping at the first line for
which the line excluding the terminating &lt;newline&gt;
matches the regular expression. An address consisting of a
null <br>
regular expression delimited by question marks
&quot;??&quot; shall address the previous line for which the
line excluding the terminating &lt;newline&gt; matches the
last regular expression <br>
encountered. In addition, the second question mark can be
omitted at the end of a command line. If the wrapscan edit
option is set, the search shall wrap around from the <br>
beginning of the edit buffer to the end of the edit buffer
and continue up to and including the current line, so that
the entire edit buffer is searched. Within the regular <br>
expression, the sequence &quot; <br>
7. A plus sign ( &rsquo;+&rsquo; ) or a minus sign (
&rsquo;-&rsquo; ) followed by a decimal number shall address
the current line plus or minus the number. A &rsquo;+&rsquo;
or &rsquo;-&rsquo; not followed by a decimal num&acirc; <br>
ber shall address the current line plus or minus 1.</p>

<p style="margin-top: 1em">Addresses can be followed by
zero or more address offsets, optionally
&lt;blank&gt;-separated. Address offsets are constructed as
follows:</p>

<p style="margin-top: 1em">1. A &rsquo;+&rsquo; or
&rsquo;-&rsquo; immediately followed by a decimal number
shall add (subtract) the indicated number of lines to (from)
the address. A &rsquo;+&rsquo; or &rsquo;-&rsquo; not
followed by a decimal number <br>
shall add (subtract) 1 to (from) the address.</p>

<p style="margin-top: 1em">2. A decimal number shall add
the indicated number of lines to the address.</p>

<p style="margin-top: 1em">It shall not be an error for an
intermediate address value to be less than zero or greater
than the last line in the edit buffer. It shall be an error
for the final address value <br>
to be less than zero or greater than the last line in the
edit buffer.</p>

<p style="margin-top: 1em">Commands take zero, one, or two
addresses; see the descriptions of 1addr and 2addr in
Command Descriptions in ex . If more than the required
number of addresses are provided to a <br>
command that requires zero addresses, it shall be an error.
Otherwise, if more than the required number of addresses are
provided to a command, the addresses specified first <br>
shall be evaluated and then discarded until the maximum
number of valid addresses remain.</p>

<p style="margin-top: 1em">Addresses shall be separated
from each other by a comma ( &rsquo;,&rsquo; ) or a
semicolon ( &rsquo;;&rsquo; ). If no address is specified
before or after a comma or semicolon separator, it shall be
as <br>
if the address of the current line was specified before or
after the separator. In the case of a semicolon separator,
the current line ( &rsquo;.&rsquo; ) shall be set to the
first address, <br>
and only then will the next address be calculated. This
feature can be used to determine the starting line for
forwards and backwards searches (see rules 5. and 6.).</p>

<p style="margin-top: 1em">A percent sign ( &rsquo;%&rsquo;
) shall be equivalent to entering the two addresses
&quot;1,$&quot; .</p>

<p style="margin-top: 1em">Any delimiting &lt;blank&gt;s
between addresses, address separators, or address offsets
shall be discarded.</p>

<p style="margin-top: 1em">Command Line Parsing in ex <br>
The following symbol is used in this and following sections
to describe parsing behavior:</p>

<p style="margin-top: 1em">escape If a character is
referred to as &quot;backslash-escaped&quot; or &quot;
&lt;control&gt;-V-escaped,&quot; it shall mean that the
character acquired or lost a special meaning by virtue of
being pre&acirc; <br>
ceded, respectively, by a backslash or &lt;control&gt;-V
character. Unless otherwise specified, the escaping
character shall be discarded at that time and shall not be
further <br>
considered for any purpose.</p>

<p style="margin-top: 1em">Command-line parsing shall be
done in the following steps. For each step, characters
already evaluated shall be ignored; that is, the phrase
&quot;leading character&quot; refers to the <br>
next character that has not yet been evaluated.</p>

<p style="margin-top: 1em">1. Leading colon characters
shall be skipped.</p>

<p style="margin-top: 1em">2. Leading &lt;blank&gt;s shall
be skipped.</p>

<p style="margin-top: 1em">3. If the leading character is a
double-quote character, the characters up to and including
the next non-backslash-escaped &lt;newline&gt; shall be
discarded, and any subsequent char&acirc; <br>
acters shall be parsed as a separate command.</p>

<p style="margin-top: 1em">4. Leading characters that can
be interpreted as addresses shall be evaluated; see
Addressing in ex .</p>

<p style="margin-top: 1em">5. Leading &lt;blank&gt;s shall
be skipped.</p>

<p style="margin-top: 1em">6. If the next character is a
vertical-line character or a &lt;newline&gt;:</p>

<p style="margin-top: 1em">a. If the next character is a
&lt;newline&gt;:</p>

<p style="margin-top: 1em">1. If ex is in open or visual
mode, the current line shall be set to the last address
specified, if any.</p>

<p style="margin-top: 1em">2. Otherwise, if the last
command was terminated by a vertical-line character, no
action shall be taken; for example, the command
&quot;||&lt;newline&gt;&quot; shall execute two implied <br>
commands, not three.</p>

<p style="margin-top: 1em">3. Otherwise, step 6.b. shall
apply.</p>

<p style="margin-top: 1em">b. Otherwise, the implied
command shall be the print command. The last #, p, and l
flags specified to any ex command shall be remembered and
shall apply to this implied com&acirc; <br>
mand. Executing the ex number, print, or list command shall
set the remembered flags to #, nothing, and l, respectively,
plus any other flags specified for that execution <br>
of the number, print, or list command.</p>

<p style="margin-top: 1em">If ex is not currently
performing a global or v command, and no address or count is
specified, the current line shall be incremented by 1 before
the command is executed. If <br>
incrementing the current line would result in an address
past the last line in the edit buffer, the command shall
fail, and the increment shall not happen.</p>

<p style="margin-top: 1em">c. The &lt;newline&gt; or
vertical-line character shall be discarded and any
subsequent characters shall be parsed as a separate
command.</p>

<p style="margin-top: 1em">7. The command name shall be
comprised of the next character (if the character is not
alphabetic), or the next character and any subsequent
alphabetic characters (if the charac&acirc; <br>
ter is alphabetic), with the following exceptions:</p>

<p style="margin-top: 1em">a. Commands that consist of any
prefix of the characters in the command name delete,
followed immediately by any of the characters
&rsquo;l&rsquo;, &rsquo;p&rsquo;, &rsquo;+&rsquo;,
&rsquo;-&rsquo;, or &rsquo;#&rsquo; shall be inter&acirc;
<br>
preted as a delete command, followed by a &lt;blank&gt;,
followed by the characters that were not part of the prefix
of the delete command. The maximum number of characters <br>
shall be matched to the command name delete; for example,
&quot;del&quot; shall not be treated as &quot;de&quot;
followed by the flag l.</p>

<p style="margin-top: 1em">b. Commands that consist of the
character &rsquo;k&rsquo;, followed by a character that can
be used as the name of a mark, shall be equivalent to the
mark command followed by a &lt;blank&gt;, <br>
followed by the character that followed the &rsquo;k&rsquo;
.</p>

<p style="margin-top: 1em">c. Commands that consist of the
character &rsquo;s&rsquo;, followed by characters that could
be interpreted as valid options to the s command, shall be
the equivalent of the s command, <br>
without any pattern or replacement values, followed by a
&lt;blank&gt;, followed by the characters after the
&rsquo;s&rsquo; .</p>

<p style="margin-top: 1em">8. The command name shall be
matched against the possible command names, and a command
name that contains a prefix matching the characters
specified by the user shall be the <br>
executed command. In the case of commands where the
characters specified by the user could be ambiguous, the
executed command shall be as follows:</p>

<p style="margin-top: 1em">a append n next t t <br>
c change p print u undo <br>
ch change pr print un undo <br>
e edit r read v v <br>
m move re read w write <br>
ma mark s s</p>

<p style="margin-top: 1em">Implementation extensions with
names causing similar ambiguities shall not be checked for a
match until all possible matches for commands specified by
IEEE Std 1003.1-2001 have <br>
been checked.</p>

<p style="margin-top: 1em">9. If the command is a !
command, or if the command is a read command followed by
zero or more &lt;blank&gt;s and a !, or if the command is a
write command followed by one or more <br>
&lt;blank&gt;s and a !, the rest of the command shall
include all characters up to a non-backslash-escaped
&lt;newline&gt;. The &lt;newline&gt; shall be discarded and
any subsequent characters <br>
shall be parsed as a separate ex command.</p>

<p style="margin-top: 1em">10. Otherwise, if the command is
an edit, ex, or next command, or a visual command while in
open or visual mode, the next part of the command shall be
parsed as follows:</p>

<p style="margin-top: 1em">a. Any &rsquo;!&rsquo; character
immediately following the command shall be skipped and be
part of the command.</p>

<p style="margin-top: 1em">b. Any leading &lt;blank&gt;s
shall be skipped and be part of the command.</p>

<p style="margin-top: 1em">c. If the next character is a
&rsquo;+&rsquo;, characters up to the first
non-backslash-escaped &lt;newline&gt; or
non-backslash-escaped &lt;blank&gt; shall be skipped and be
part of the command.</p>

<p style="margin-top: 1em">d. The rest of the command shall
be determined by the steps specified in paragraph 12.</p>

<p style="margin-top: 1em">11. Otherwise, if the command is
a global, open, s, or v command, the next part of the
command shall be parsed as follows:</p>

<p style="margin-top: 1em">a. Any leading &lt;blank&gt;s
shall be skipped and be part of the command.</p>

<p style="margin-top: 1em">b. If the next character is not
an alphanumeric, double-quote, &lt;newline&gt;, backslash,
or vertical-line character:</p>

<p style="margin-top: 1em">1. The next character shall be
used as a command delimiter.</p>

<p style="margin-top: 1em">2. If the command is a global,
open, or v command, characters up to the first
non-backslash-escaped &lt;newline&gt;, or first
non-backslash-escaped delimiter character, shall <br>
be skipped and be part of the command.</p>

<p style="margin-top: 1em">3. If the command is an s
command, characters up to the first non-backslash-escaped
&lt;newline&gt;, or second non-backslash-escaped delimiter
character, shall be skipped and <br>
be part of the command.</p>

<p style="margin-top: 1em">c. If the command is a global or
v command, characters up to the first non-backslash-escaped
&lt;newline&gt; shall be skipped and be part of the
command.</p>

<p style="margin-top: 1em">d. Otherwise, the rest of the
command shall be determined by the steps specified in
paragraph 12.</p>

<p style="margin-top: 1em">12. Otherwise:</p>

<p style="margin-top: 1em">a. If the command was a map,
unmap, abbreviate, or unabbreviate command, characters up to
the first non- &lt;control&gt;-V-escaped &lt;newline&gt;,
vertical-line, or double-quote char&acirc; <br>
acter shall be skipped and be part of the command.</p>

<p style="margin-top: 1em">b. Otherwise, characters up to
the first non-backslash-escaped &lt;newline&gt;,
vertical-line, or double-quote character shall be skipped
and be part of the command.</p>

<p style="margin-top: 1em">c. If the command was an append,
change, or insert command, and the step 12.b. ended at a
vertical-line character, any subsequent characters, up to
the next non-backslash- <br>
escaped &lt;newline&gt; shall be used as input text to the
command.</p>

<p style="margin-top: 1em">d. If the command was ended by a
double-quote character, all subsequent characters, up to the
next non-backslash-escaped &lt;newline&gt;, shall be
discarded.</p>

<p style="margin-top: 1em">e. The terminating
&lt;newline&gt; or vertical-line character shall be
discarded and any subsequent characters shall be parsed as a
separate ex command.</p>

<p style="margin-top: 1em">Command arguments shall be
parsed as described by the Synopsis and Description of each
individual ex command. This parsing shall not be
&lt;blank&gt;-sensitive, except for the ! argu&acirc; <br>
ment, which must follow the command name without intervening
&lt;blank&gt;s, and where it would otherwise be ambiguous.
For example, count and flag arguments need not be
&lt;blank&gt;-sepa&acirc; <br>
rated because &quot;d22p&quot; is not ambiguous, but file
arguments to the ex next command must be separated by one or
more &lt;blank&gt;s. Any &lt;blank&gt; in command arguments
for the abbreviate, <br>
unabbreviate, map, and unmap commands can be
&lt;control&gt;-V-escaped, in which case the &lt;blank&gt;
shall not be used as an argument delimiter. Any
&lt;blank&gt; in the command argument for <br>
any other command can be backslash-escaped, in which case
that &lt;blank&gt; shall not be used as an argument
delimiter.</p>

<p style="margin-top: 1em">Within command arguments for the
abbreviate, unabbreviate, map, and unmap commands, any
character can be &lt;control&gt;-V-escaped. All such escaped
characters shall be treated liter&acirc; <br>
ally and shall have no special meaning. Within command
arguments for all other ex commands that are not regular
expressions or replacement strings, any character that would
oth&acirc; <br>
erwise have a special meaning can be backslash-escaped.
Escaped characters shall be treated literally, without
special meaning as shell expansion characters or
&rsquo;!&rsquo;, &rsquo;%&rsquo;, and &rsquo;#&rsquo; <br>
expansion characters. See Regular Expressions in ex and
Replacement Strings in ex for descriptions of command
arguments that are regular expressions or replacement
strings.</p>

<p style="margin-top: 1em">Non-backslash-escaped
&rsquo;%&rsquo; characters appearing in file arguments to
any ex command shall be replaced by the current pathname;
unescaped &rsquo;#&rsquo; characters shall be replaced by
the <br>
alternate pathname. It shall be an error if &rsquo;%&rsquo;
or &rsquo;#&rsquo; characters appear unescaped in an
argument and their corresponding values are not set.</p>

<p style="margin-top: 1em">Non-backslash-escaped
&rsquo;!&rsquo; characters in the arguments to either the ex
! command or the open and visual mode ! command, or in the
arguments to the ex read command, where the <br>
first non- &lt;blank&gt; after the command name is a
&rsquo;!&rsquo; character, or in the arguments to the ex
write command where the command name is followed by one or
more &lt;blank&gt;s and the first <br>
non- &lt;blank&gt; after the command name is a
&rsquo;!&rsquo; character, shall be replaced with the
arguments to the last of those three commands as they
appeared after all unescaped &rsquo;%&rsquo;,
&rsquo;#&rsquo;, <br>
and &rsquo;!&rsquo; characters were replaced. It shall be an
error if &rsquo;!&rsquo; characters appear unescaped in one
of these commands and there has been no previous execution
of one of these com&acirc; <br>
mands.</p>

<p style="margin-top: 1em">If an error occurs during the
parsing or execution of an ex command:</p>

<p style="margin-top: 1em">* An informational message to
this effect shall be written. Execution of the ex command
shall stop, and the cursor (for example, the current line
and column) shall not be fur&acirc; <br>
ther modified.</p>

<p style="margin-top: 1em">* If the ex command resulted
from a map expansion, all characters from that map expansion
shall be discarded, except as otherwise specified by the map
command.</p>

<p style="margin-top: 1em">* Otherwise, if the ex command
resulted from the processing of an EXINIT environment
variable, a .exrc file, a :source command, a -c option, or a
+ command specified to an ex <br>
edit, ex, next, or visual command, no further commands from
the source of the commands shall be executed.</p>

<p style="margin-top: 1em">* Otherwise, if the ex command
resulted from the execution of a buffer or a global or v
command, no further commands caused by the execution of the
buffer or the global or v <br>
command shall be executed.</p>

<p style="margin-top: 1em">* Otherwise, if the ex command
was not terminated by a &lt;newline&gt;, all characters up
to and including the next non-backslash-escaped
&lt;newline&gt; shall be discarded.</p>

<p style="margin-top: 1em">Input Editing in ex <br>
The following symbol is used in this and the following
sections to specify command actions:</p>

<p style="margin-top: 1em">word In the POSIX locale, a word
consists of a maximal sequence of letters, digits, and
underscores, delimited at both ends by characters other than
letters, digits, or under&acirc; <br>
scores, or by the beginning or end of a line or the edit
buffer.</p>

<p style="margin-top: 1em">When accepting input characters
from the user, in either ex command mode or ex text input
mode, ex shall enable canonical mode input processing, as
defined in the System Inter&acirc; <br>
faces volume of IEEE Std 1003.1-2001.</p>

<p style="margin-top: 1em">If in ex text input mode:</p>

<p style="margin-top: 1em">1. If the number edit option is
set, ex shall prompt for input using the line number that
would be assigned to the line if it is entered, in the
format specified for the ex num&acirc; <br>
ber command.</p>

<p style="margin-top: 1em">2. If the autoindent edit option
is set, ex shall prompt for input using autoindent
characters, as described by the autoindent edit option.
autoindent characters shall follow <br>
the line number, if any.</p>

<p style="margin-top: 1em">If in ex command mode:</p>

<p style="margin-top: 1em">1. If the prompt edit option is
set, input shall be prompted for using a single
&rsquo;:&rsquo; character; otherwise, there shall be no
prompt.</p>

<p style="margin-top: 1em">The input characters in the
following sections shall have the following effects on the
input line.</p>

<p style="margin-top: 1em">Scroll <br>
Synopsis:</p>

<p style="margin-top: 1em">eof</p>

<p style="margin-top: 1em">See the description of the stty
eof character in stty .</p>

<p style="margin-top: 1em">If in ex command mode: If the
eof character is the first character entered on the line,
the line shall be evaluated as if it contained two
characters: a &lt;control&gt;-D and a &lt;new&acirc; <br>
line&gt;.</p>

<p style="margin-top: 1em">Otherwise, the eof character
shall have no special meaning.</p>

<p style="margin-top: 1em">If in ex text input mode: If the
cursor follows an autoindent character, the autoindent
characters in the line shall be modified so that a part of
the next text input character <br>
will be displayed on the first column in the line after the
previous shiftwidth edit option column boundary, and the
user shall be prompted again for input for the same
line.</p>

<p style="margin-top: 1em">Otherwise, if the cursor follows
a &rsquo;0&rsquo;, which follows an autoindent character,
and the &rsquo;0&rsquo; was the previous text input
character, the &rsquo;0&rsquo; and all autoindent characters
in the <br>
line shall be discarded, and the user shall be prompted
again for input for the same line.</p>

<p style="margin-top: 1em">Otherwise, if the cursor follows
a &rsquo;^&rsquo;, which follows an autoindent character,
and the &rsquo;^&rsquo; was the previous text input
character, the &rsquo;^&rsquo; and all autoindent characters
in the <br>
line shall be discarded, and the user shall be prompted
again for input for the same line. In addition, the
autoindent level for the next input line shall be derived
from the <br>
same line from which the autoindent level for the current
input line was derived.</p>

<p style="margin-top: 1em">Otherwise, if there are no
autoindent or text input characters in the line, the eof
character shall be discarded.</p>

<p style="margin-top: 1em">Otherwise, the eof character
shall have no special meaning.</p>

<p style="margin-top: 1em">&lt;newline&gt; <br>
Synopsis:</p>

<p style="margin-top: 1em">&lt;newline&gt;</p>

<p style="margin-top: 1em">&lt;control&gt;-J</p>

<p style="margin-top: 1em">If in ex command mode: Cause the
command line to be parsed; &lt;control&gt;-J shall be mapped
to the &lt;newline&gt; for this purpose.</p>

<p style="margin-top: 1em">If in ex text input mode:
Terminate the current line. If there are no characters other
than autoindent characters on the line, all characters on
the line shall be discarded.</p>

<p style="margin-top: 1em">Prompt for text input on a new
line after the current line. If the autoindent edit option
is set, an appropriate number of autoindent characters shall
be added as a prefix to the <br>
line as described by the ex autoindent edit option.</p>

<p style="margin-top: 1em">&lt;backslash&gt; <br>
Synopsis:</p>

<p style="margin-top: 1em">&lt;backslash&gt;</p>

<p style="margin-top: 1em">Allow the entry of a subsequent
&lt;newline&gt; or &lt;control&gt;-J as a literal character,
removing any special meaning that it may have to the editor
during text input mode. The backslash <br>
character shall be retained and evaluated when the command
line is parsed, or retained and included when the input text
becomes part of the edit buffer.</p>

<p style="margin-top: 1em">&lt;control&gt;-V <br>
Synopsis:</p>

<p style="margin-top: 1em">&lt;control&gt;-V</p>

<p style="margin-top: 1em">Allow the entry of any
subsequent character as a literal character, removing any
special meaning that it may have to the editor during text
input mode. The &lt;control&gt;-V character <br>
shall be discarded before the command line is parsed or the
input text becomes part of the edit buffer.</p>

<p style="margin-top: 1em">If the &quot;literal next&quot;
functionality is performed by the underlying system, it is
implementation-defined whether a character other than
&lt;control&gt;-V performs this function.</p>

<p style="margin-top: 1em">&lt;control&gt;-W <br>
Synopsis:</p>

<p style="margin-top: 1em">&lt;control&gt;-W</p>

<p style="margin-top: 1em">Discard the &lt;control&gt;-W,
and the word previous to it in the input line, including any
&lt;blank&gt;s following the word and preceding the
&lt;control&gt;-W. If the &quot;word erase&quot;
functionality <br>
is performed by the underlying system, it is
implementation-defined whether a character other than
&lt;control&gt;-W performs this function.</p>

<p style="margin-top: 1em">Command Descriptions in ex <br>
The following symbols are used in this section to represent
command modifiers. Some of these modifiers can be omitted,
in which case the specified defaults shall be used.</p>

<p style="margin-top: 1em">1addr A single line address,
given in any of the forms described in Addressing in ex ;
the default shall be the current line ( &rsquo;.&rsquo; ),
unless otherwise specified.</p>

<p style="margin-top: 1em">If the line address is zero, it
shall be an error, unless otherwise specified in the
following command descriptions.</p>

<p style="margin-top: 1em">If the edit buffer is empty, and
the address is specified with a command other than =,
append, insert, open, put, read, or visual, or the address
is not zero, it shall be an <br>
error.</p>

<p style="margin-top: 1em">2addr Two addresses specifying
an inclusive range of lines. If no addresses are specified,
the default for 2addr shall be the current line only (
&quot;.,.&quot; ), unless otherwise spec&acirc; <br>
ified in the following command descriptions. If one address
is specified, 2addr shall specify that line only, unless
otherwise specified in the following command descrip&acirc;
<br>
tions.</p>

<p style="margin-top: 1em">It shall be an error if the
first address is greater than the second address.</p>

<p style="margin-top: 1em">If the edit buffer is empty, and
the two addresses are specified with a command other than
the !, write, wq, or xit commands, or either address is not
zero, it shall be an error.</p>

<p style="margin-top: 1em">count A positive decimal number.
If count is specified, it shall be equivalent to specifying
an additional address to the command, unless otherwise
specified by the following <br>
command descriptions. The additional address shall be equal
to the last address specified to the command (either
explicitly or by default) plus count-1.</p>

<p style="margin-top: 1em">If this would result in an
address greater than the last line of the edit buffer, it
shall be corrected to equal the last line of the edit
buffer.</p>

<p style="margin-top: 1em">flags One or more of the
characters &rsquo;+&rsquo;, &rsquo;-&rsquo;,
&rsquo;#&rsquo;, &rsquo;p&rsquo;, or &rsquo;l&rsquo; (ell).
The flag characters can be &lt;blank&gt;-separated, and in
any order or combination. The characters &rsquo;#&rsquo;,
&rsquo;p&rsquo;, <br>
and &rsquo;l&rsquo; shall cause lines to be written in the
format specified by the print command with the specified
flags.</p>

<p style="margin-top: 1em">The lines to be written are as
follows:</p>

<p style="margin-top: 1em">1. All edit buffer lines written
during the execution of the ex &amp;, ~, list, number, open,
print, s, visual, and z commands shall be written as
specified by flags.</p>

<p style="margin-top: 1em">2. After the completion of an ex
command with a flag as an argument, the current line shall
be written as specified by flags, unless the current line
was the last line <br>
written by the command.</p>

<p style="margin-top: 1em">The characters &rsquo;+&rsquo;
and &rsquo;-&rsquo; cause the value of the current line
after the execution of the ex command to be adjusted by the
offset address as described in Addressing in ex . This <br>
adjustment shall occur before the current line is written as
described in 2. above.</p>

<p style="margin-top: 1em">The default for flags shall be
none.</p>

<p style="margin-top: 1em">buffer One of a number of named
areas for holding text. The named buffers are specified by
the alphanumeric characters of the POSIX locale. There shall
also be one &quot;unnamed&quot; buf&acirc; <br>
fer. When no buffer is specified for editor commands that
use a buffer, the unnamed buffer shall be used. Commands
that store text into buffers shall store the text as it <br>
was before the command took effect, and shall store text
occurring earlier in the file before text occurring later in
the file, regardless of how the text region was spec&acirc;
<br>
ified. Commands that store text into buffers shall store the
text into the unnamed buffer as well as any specified
buffer.</p>

<p style="margin-top: 1em">In ex commands, buffer names are
specified as the name by itself. In open or visual mode
commands the name is preceded by a double quote ( &rsquo;
)&rsquo; character.</p>

<p style="margin-top: 1em">If the specified buffer name is
an uppercase character, and the buffer contents are to be
modified, the buffer shall be appended to rather than being
overwritten. If the buffer <br>
is not being modified, specifying the buffer name in
lowercase and uppercase shall have identical results.</p>

<p style="margin-top: 1em">There shall also be buffers
named by the numbers 1 through 9. In open and visual mode,
if a region of text including characters from more than a
single line is being modified by <br>
the vi c or d commands, the motion character associated with
the c or d commands specifies that the buffer text shall be
in line mode, or the commands %, &lsquo;, /, ?, (, ), N, n,
{, <br>
or } are used to define a region of text for the c or d
commands, the contents of buffers 1 through 8 shall be moved
into the buffer named by the next numerically greater value,
<br>
the contents of buffer 9 shall be discarded, and the region
of text shall be copied into buffer 1. This shall be in
addition to copying the text into a user-specified buffer or
<br>
unnamed buffer, or both. Numeric buffers can be specified as
a source buffer for open and visual mode commands; however,
specifying a numeric buffer as the write target of an <br>
open or visual mode command shall have unspecified
results.</p>

<p style="margin-top: 1em">The text of each buffer shall
have the characteristic of being in either line or character
mode. Appending text to a non-empty buffer shall set the
mode to match the characteris&acirc; <br>
tic of the text being appended. Appending text to a buffer
shall cause the creation of at least one additional line in
the buffer. All text stored into buffers by ex commands <br>
shall be in line mode. The ex commands that use buffers as
the source of text specify individually how buffers of
different modes are handled. Each open or visual mode
command <br>
that uses buffers for any purpose specifies individually the
mode of the text stored into the buffer and how buffers of
different modes are handled.</p>

<p style="margin-top: 1em">file Command text used to derive
a pathname. The default shall be the current pathname, as
defined previously, in which case, if no current pathname
has yet been established it <br>
shall be an error, except where specifically noted in the
individual command descriptions that follow. If the command
text contains any of the characters &rsquo;~&rsquo;,
&rsquo;{&rsquo;, &rsquo;[&rsquo;, <br>
&rsquo;*&rsquo;, &rsquo;?&rsquo;, &rsquo;$&rsquo;,
&rsquo;&lsquo;&rsquo;, &rsquo;&quot;, &rsquo; ,&rsquo; and
&rsquo;&acute;, it shall be subjected to the process of
&quot;shell expansions&quot;, as described below; if more
than a single pathname results and the com&acirc; <br>
mand expects only one, it shall be an error.</p>

<p style="margin-top: 1em">The process of shell expansions
in the editor shall be done as follows. The ex utility shall
pass two arguments to the program named by the shell edit
option; the first shall be <br>
-c, and the second shall be the string &quot;echo&quot; and
the command text as a single argument. The standard output
and standard error of that command shall replace the command
text.</p>

<p style="margin-top: 1em">! A character that can be
appended to the command name to modify its operation, as
detailed in the individual command descriptions. With the
exception of the ex read, write, <br>
and ! commands, the &rsquo;!&rsquo; character shall only act
as a modifier if there are no &lt;blank&gt;s between it and
the command name.</p>

<p style="margin-top: 1em">remembered search direction</p>

<p style="margin-top: 1em">The vi commands N and n begin
searching in a forwards or backwards direction in the edit
buffer based on a remembered search direction, which is
initially unset, and is <br>
set by the ex global, v, s, and tag commands, and the vi /
and ? commands.</p>

<p style="margin-top: 1em">Abbreviate <br>
Synopsis:</p>

<p style="margin-top: 1em">ab[breviate][lhs rhs]</p>

<p style="margin-top: 1em">If lhs and rhs are not
specified, write the current list of abbreviations and do
nothing more.</p>

<p style="margin-top: 1em">Implementations may restrict the
set of characters accepted in lhs or rh, except that
printable characters and &lt;blank&gt;s shall not be
restricted. Additional restrictions shall be <br>
implementation-defined.</p>

<p style="margin-top: 1em">In both lhs and rhs, any
character may be escaped with a &lt;control&gt;-V, in which
case the character shall not be used to delimit lhs from
rhs, and the escaping &lt;control&gt;-V shall be <br>
discarded.</p>

<p style="margin-top: 1em">In open and visual text input
mode, if a non-word or &lt;ESC&gt; character that is not
escaped by a &lt;control&gt;-V character is entered after a
word character, a check shall be made for a <br>
set of characters matching lhs, in the text input entered
during this command. If it is found, the effect shall be as
if rhs was entered instead of lhs.</p>

<p style="margin-top: 1em">The set of characters that are
checked is defined as follows:</p>

<p style="margin-top: 1em">1. If there are no characters
inserted before the word and non-word or &lt;ESC&gt;
characters that triggered the check, the set of characters
shall consist of the word character.</p>

<p style="margin-top: 1em">2. If the character inserted
before the word and non-word or &lt;ESC&gt; characters that
triggered the check is a word character, the set of
characters shall consist of the characters <br>
inserted immediately before the triggering characters that
are word characters, plus the triggering word character.</p>

<p style="margin-top: 1em">3. If the character inserted
before the word and non-word or &lt;ESC&gt; characters that
triggered the check is not a word character, the set of
characters shall consist of the char&acirc; <br>
acters that were inserted before the triggering characters
that are neither &lt;blank&gt;s nor word characters, plus
the triggering word character.</p>

<p style="margin-top: 1em">It is unspecified whether the
lhs argument entered for the ex abbreviate and unabbreviate
commands is replaced in this fashion. Regardless of whether
or not the replacement <br>
occurs, the effect of the command shall be as if the
replacement had not occurred.</p>

<p style="margin-top: 1em">Current line: Unchanged.</p>

<p style="margin-top: 1em">Current column: Unchanged.</p>

<p style="margin-top: 1em">Append <br>
Synopsis:</p>

<p style="margin-top: 1em">[1addr] a[ppend][!]</p>

<p style="margin-top: 1em">Enter ex text input mode; the
input text shall be placed after the specified line. If line
zero is specified, the text shall be placed at the beginning
of the edit buffer.</p>

<p style="margin-top: 1em">This command shall be affected
by the number and autoindent edit options; following the
command name with &rsquo;!&rsquo; shall cause the autoindent
edit option setting to be toggled for the <br>
duration of this command only.</p>

<p style="margin-top: 1em">Current line: Set to the last
input line; if no lines were input, set to the specified
line, or to the first line of the edit buffer if a line of
zero was specified, or zero if <br>
the edit buffer is empty.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Arguments <br>
Synopsis:</p>

<p style="margin-top: 1em">ar[gs]</p>

<p style="margin-top: 1em">Write the current argument list,
with the current argument-list entry, if any, between
&rsquo;[&rsquo; and &rsquo;]&rsquo; characters.</p>

<p style="margin-top: 1em">Current line: Unchanged.</p>

<p style="margin-top: 1em">Current column: Unchanged.</p>

<p style="margin-top: 1em">Change <br>
Synopsis:</p>

<p style="margin-top: 1em">[2addr] c[hange][!][count]</p>

<p style="margin-top: 1em">Enter ex text input mode; the
input text shall replace the specified lines. The specified
lines shall be copied into the unnamed buffer, which shall
become a line mode buffer.</p>

<p style="margin-top: 1em">This command shall be affected
by the number and autoindent edit options; following the
command name with &rsquo;!&rsquo; shall cause the autoindent
edit option setting to be toggled for the <br>
duration of this command only.</p>

<p style="margin-top: 1em">Current line: Set to the last
input line; if no lines were input, set to the line before
the first address, or to the first line of the edit buffer
if there are no lines preced&acirc; <br>
ing the first address, or to zero if the edit buffer is
empty.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Change Directory <br>
Synopsis:</p>


<p style="margin-top: 1em">chd[ir][!][directory]cd[!][directory]</p>

<p style="margin-top: 1em">Change the current working
directory to directory.</p>

<p style="margin-top: 1em">If no directory argument is
specified, and the HOME environment variable is set to a
non-null and non-empty value, directory shall default to the
value named in the HOME environ&acirc; <br>
ment variable. If the HOME environment variable is empty or
is undefined, the default value of directory is
implementation-defined.</p>

<p style="margin-top: 1em">If no &rsquo;!&rsquo; is
appended to the command name, and the edit buffer has been
modified since the last complete write, and the current
pathname does not begin with a &rsquo;/&rsquo;, it shall be
an <br>
error.</p>

<p style="margin-top: 1em">Current line: Unchanged.</p>

<p style="margin-top: 1em">Current column: Unchanged.</p>

<p style="margin-top: 1em">Copy <br>
Synopsis:</p>

<p style="margin-top: 1em">[2addr] co[py] 1addr [flags]
<br>
[2addr] t 1addr [flags]</p>

<p style="margin-top: 1em">Copy the specified lines after
the specified destination line; line zero specifies that the
lines shall be placed at the beginning of the edit
buffer.</p>

<p style="margin-top: 1em">Current line: Set to the last
line copied.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Delete <br>
Synopsis:</p>

<p style="margin-top: 1em">[2addr]
d[elete][buffer][count][flags]</p>

<p style="margin-top: 1em">Delete the specified lines into
a buffer (defaulting to the unnamed buffer), which shall
become a line-mode buffer.</p>

<p style="margin-top: 1em">Flags can immediately follow the
command name; see Command Line Parsing in ex .</p>

<p style="margin-top: 1em">Current line: Set to the line
following the deleted lines, or to the last line in the edit
buffer if that line is past the end of the edit buffer, or
to zero if the edit buffer <br>
is empty.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Edit <br>
Synopsis:</p>


<p style="margin-top: 1em">e[dit][!][+command][file]ex[!][+command][file]</p>

<p style="margin-top: 1em">If no &rsquo;!&rsquo; is
appended to the command name, and the edit buffer has been
modified since the last complete write, it shall be an
error.</p>

<p style="margin-top: 1em">If file is specified, replace
the current contents of the edit buffer with the current
contents of file, and set the current pathname to file. If
file is not specified, replace <br>
the current contents of the edit buffer with the current
contents of the file named by the current pathname. If for
any reason the current contents of the file cannot be <br>
accessed, the edit buffer shall be empty.</p>

<p style="margin-top: 1em">The + command option shall be
&lt;blank&gt;-delimited; &lt;blank&gt;s within + command can
be escaped by preceding them with a backslash character. The
+ command shall be interpreted as an <br>
ex command immediately after the contents of the edit buffer
have been replaced and the current line and column have been
set.</p>

<p style="margin-top: 1em">If the edit buffer is empty:</p>

<p style="margin-top: 1em">Current line: Set to 0.</p>

<p style="margin-top: 1em">Current column: Set to 1.</p>

<p style="margin-top: 1em">Otherwise, if executed while in
ex command mode or if the + command argument is
specified:</p>

<p style="margin-top: 1em">Current line: Set to the last
line of the edit buffer.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Otherwise, if file is omitted or
results in the current pathname:</p>

<p style="margin-top: 1em">Current line: Set to the first
line of the edit buffer.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Otherwise, if file is the same
as the last file edited, the line and column shall be set as
follows; if the file was previously edited, the line and
column may be set as follows:</p>

<p style="margin-top: 1em">Current line: Set to the last
value held when that file was last edited. If this value is
not a valid line in the new edit buffer, set to the first
line of the edit buffer.</p>

<p style="margin-top: 1em">Current column: If the current
line was set to the last value held when the file was last
edited, set to the last value held when the file was last
edited. Otherwise, or if the <br>
last value is not a valid column in the new edit buffer, set
to non- &lt;blank&gt;.</p>

<p style="margin-top: 1em">Otherwise:</p>

<p style="margin-top: 1em">Current line: Set to the first
line of the edit buffer.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">File <br>
Synopsis:</p>

<p style="margin-top: 1em">f[ile][file]</p>

<p style="margin-top: 1em">If a file argument is specified,
the alternate pathname shall be set to the current pathname,
and the current pathname shall be set to file.</p>

<p style="margin-top: 1em">Write an informational message.
If the file has a current pathname, it shall be included in
this message; otherwise, the message shall indicate that
there is no current pathname. <br>
If the edit buffer contains lines, the current line number
and the number of lines in the edit buffer shall be included
in this message; otherwise, the message shall indicate <br>
that the edit buffer is empty. If the edit buffer has been
modified since the last complete write, this fact shall be
included in this message. If the readonly edit option is
<br>
set, this fact shall be included in this message. The
message may contain other unspecified information.</p>

<p style="margin-top: 1em">Current line: Unchanged.</p>

<p style="margin-top: 1em">Current column: Unchanged.</p>

<p style="margin-top: 1em">Global <br>
Synopsis:</p>

<p style="margin-top: 1em">[2addr] g[lobal] /pattern/
[commands] <br>
[2addr] v /pattern/ [commands]</p>

<p style="margin-top: 1em">The optional &rsquo;!&rsquo;
character after the global command shall be the same as
executing the v command.</p>

<p style="margin-top: 1em">If pattern is empty (for
example, &quot;//&quot; ) or not specified, the last regular
expression used in the editor command shall be used as the
pattern. The pattern can be delimited by <br>
slashes (shown in the Synopsis), as well as any
non-alphanumeric or non- &lt;blank&gt; other than backslash,
vertical line, double quote, or &lt;newline&gt;.</p>

<p style="margin-top: 1em">If no lines are specified, the
lines shall default to the entire file.</p>

<p style="margin-top: 1em">The global and v commands are
logically two-pass operations. First, mark the lines within
the specified lines for which the line excluding the
terminating &lt;newline&gt; matches ( <br>
global) or does not match ( v or global!) the specified
pattern. Second, execute the ex commands given by commands,
with the current line ( &rsquo;.&rsquo; ) set to each marked
line. If an <br>
error occurs during this process, or the contents of the
edit buffer are replaced (for example, by the ex :edit
command) an error message shall be written and no more
commands <br>
resulting from the execution of this command shall be
processed.</p>

<p style="margin-top: 1em">Multiple ex commands can be
specified by entering multiple commands on a single line
using a vertical line to delimit them, or one per line, by
escaping each &lt;newline&gt; with a <br>
backslash.</p>

<p style="margin-top: 1em">If no commands are
specified:</p>

<p style="margin-top: 1em">1. If in ex command mode, it
shall be as if the print command were specified.</p>

<p style="margin-top: 1em">2. Otherwise, no command shall
be executed.</p>

<p style="margin-top: 1em">For the append, change, and
insert commands, the input text shall be included as part of
the command, and the terminating period can be omitted if
the command ends the list of <br>
commands. The open and visual commands can be specified as
one of the commands, in which case each marked line shall
cause the editor to enter open or visual mode. If open or
<br>
visual mode is exited using the vi Q command, the current
line shall be set to the next marked line, and open or
visual mode reentered, until the list of marked lines is
<br>
exhausted.</p>

<p style="margin-top: 1em">The global, v, and undo commands
cannot be used in commands. Marked lines may be deleted by
commands executed for lines occurring earlier in the file
than the marked lines. In <br>
this case, no commands shall be executed for the deleted
lines.</p>

<p style="margin-top: 1em">If the remembered search
direction is not set, the global and v commands shall set it
to forward.</p>

<p style="margin-top: 1em">The autoprint and autoindent
edit options shall be inhibited for the duration of the g or
v command.</p>

<p style="margin-top: 1em">Current line: If no commands
executed, set to the last marked line. Otherwise, as
specified for the executed ex commands.</p>

<p style="margin-top: 1em">Current column: If no commands
are executed, set to non- &lt;blank&gt;; otherwise, as
specified for the individual ex commands.</p>

<p style="margin-top: 1em">Insert <br>
Synopsis:</p>

<p style="margin-top: 1em">[1addr] i[nsert][!]</p>

<p style="margin-top: 1em">Enter ex text input mode; the
input text shall be placed before the specified line. If the
line is zero or 1, the text shall be placed at the beginning
of the edit buffer.</p>

<p style="margin-top: 1em">This command shall be affected
by the number and autoindent edit options; following the
command name with &rsquo;!&rsquo; shall cause the autoindent
edit option setting to be toggled for the <br>
duration of this command only.</p>

<p style="margin-top: 1em">Current line: Set to the last
input line; if no lines were input, set to the line before
the specified line, or to the first line of the edit buffer
if there are no lines preced&acirc; <br>
ing the specified line, or zero if the edit buffer is
empty.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Join <br>
Synopsis:</p>

<p style="margin-top: 1em">[2addr]
j[oin][!][count][flags]</p>

<p style="margin-top: 1em">If count is specified: If no
address was specified, the join command shall behave as if
2addr were the current line and the current line plus count
(.,. + count).</p>

<p style="margin-top: 1em">If one address was specified,
the join command shall behave as if 2addr were the specified
address and the specified address plus count ( addr, addr +
count).</p>

<p style="margin-top: 1em">If two addresses were specified,
the join command shall behave as if an additional address,
equal to the last address plus count -1 ( addr1, addr2,
addr2 + count -1), was speci&acirc; <br>
fied.</p>

<p style="margin-top: 1em">If this would result in a second
address greater than the last line of the edit buffer, it
shall be corrected to be equal to the last line of the edit
buffer.</p>

<p style="margin-top: 1em">If no count is specified: If no
address was specified, the join command shall behave as if
2addr were the current line and the next line (.,. +1).</p>

<p style="margin-top: 1em">If one address was specified,
the join command shall behave as if 2addr were the specified
address and the next line ( addr, addr +1).</p>

<p style="margin-top: 1em">Join the text from the specified
lines together into a single line, which shall replace the
specified lines.</p>

<p style="margin-top: 1em">If a &rsquo;!&rsquo; character
is appended to the command name, the join shall be without
modification of any line, independent of the current
locale.</p>

<p style="margin-top: 1em">Otherwise, in the POSIX locale,
set the current line to the first of the specified lines,
and then, for each subsequent line, proceed as follows:</p>

<p style="margin-top: 1em">1. Discard leading
&lt;space&gt;s from the line to be joined.</p>

<p style="margin-top: 1em">2. If the line to be joined is
now empty, delete it, and skip steps 3 through 5.</p>

<p style="margin-top: 1em">3. If the current line ends in a
&lt;blank&gt;, or the first character of the line to be
joined is a &rsquo;)&rsquo; character, join the lines
without further modification.</p>

<p style="margin-top: 1em">4. If the last character of the
current line is a &rsquo;.&rsquo;, join the lines with two
&lt;space&gt;s between them.</p>

<p style="margin-top: 1em">5. Otherwise, join the lines
with a single &lt;space&gt; between them.</p>

<p style="margin-top: 1em">Current line: Set to the first
line specified.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">List <br>
Synopsis:</p>

<p style="margin-top: 1em">[2addr] l[ist][count][flags]</p>

<p style="margin-top: 1em">This command shall be equivalent
to the ex command:</p>

<p style="margin-top: 1em">[2addr] p[rint][count]
l[flags]</p>

<p style="margin-top: 1em">See Print .</p>

<p style="margin-top: 1em">Map <br>
Synopsis:</p>

<p style="margin-top: 1em">map[!][lhs rhs]</p>

<p style="margin-top: 1em">If lhs and rhs are not
specified:</p>

<p style="margin-top: 1em">1. If &rsquo;!&rsquo; is
specified, write the current list of text input mode
maps.</p>

<p style="margin-top: 1em">2. Otherwise, write the current
list of command mode maps.</p>

<p style="margin-top: 1em">3. Do nothing more.</p>

<p style="margin-top: 1em">Implementations may restrict the
set of characters accepted in lhs or rhs, except that
printable characters and &lt;blank&gt;s shall not be
restricted. Additional restrictions shall be <br>
implementation-defined. In both lhs and rhs, any character
can be escaped with a &lt;control&gt;-V, in which case the
character shall not be used to delimit lhs from rhs, and the
<br>
escaping &lt;control&gt;-V shall be discarded.</p>

<p style="margin-top: 1em">If the character &rsquo;!&rsquo;
is appended to the map command name, the mapping shall be
effective during open or visual text input mode rather than
open or visual command mode. This <br>
allows lhs to have two different map definitions at the same
time: one for command mode and one for text input mode.</p>

<p style="margin-top: 1em">For command mode mappings: When
the lhs is entered as any part of a vi command in open or
visual mode (but not as part of the arguments to the
command), the action shall be as if <br>
the corresponding rhs had been entered.</p>

<p style="margin-top: 1em">If any character in the command,
other than the first, is escaped using a &lt;control&gt;-V
character, that character shall not be part of a match to an
lhs.</p>

<p style="margin-top: 1em">It is unspecified whether
implementations shall support map commands where the lhs is
more than a single character in length, where the first
character of the lhs is printable.</p>

<p style="margin-top: 1em">If lhs contains more than one
character and the first character is &rsquo;#&rsquo;,
followed by a sequence of digits corresponding to a numbered
function key, then when this function key is <br>
typed it shall be mapped to rhs. Characters other than
digits following a &rsquo;#&rsquo; character also represent
the function key named by the characters in the lhs
following the &rsquo;#&rsquo; and <br>
may be mapped to rhs. It is unspecified how function keys
are named or what function keys are supported.</p>

<p style="margin-top: 1em">For text input mode mappings:
When the lhs is entered as any part of text entered in open
or visual text input modes, the action shall be as if the
corresponding rhs had been <br>
entered.</p>

<p style="margin-top: 1em">If any character in the input
text is escaped using a &lt;control&gt;-V character, that
character shall not be part of a match to an lhs.</p>

<p style="margin-top: 1em">It is unspecified whether the
lhs text entered for subsequent map or unmap commands is
replaced with the rhs text for the purposes of the screen
display; regardless of whether or <br>
not the display appears as if the corresponding rhs text was
entered, the effect of the command shall be as if the lhs
text was entered.</p>

<p style="margin-top: 1em">If only part of the lhs is
entered, it is unspecified how long the editor will wait for
additional, possibly matching characters before treating the
already entered characters as <br>
not matching the lhs.</p>

<p style="margin-top: 1em">The rhs characters shall
themselves be subject to remapping, unless otherwise
specified by the remap edit option, except that if the
characters in lhs occur as prefix characters <br>
in rhs, those characters shall not be remapped.</p>

<p style="margin-top: 1em">On block-mode terminals, the
mapping need not occur immediately (for example, it may
occur after the terminal transmits a group of characters to
the system), but it shall achieve <br>
the same results as if it occurred immediately.</p>

<p style="margin-top: 1em">Current line: Unchanged.</p>

<p style="margin-top: 1em">Current column: Unchanged.</p>

<p style="margin-top: 1em">Mark <br>
Synopsis:</p>

<p style="margin-top: 1em">[1addr] ma[rk] character <br>
[1addr] k character</p>

<p style="margin-top: 1em">Implementations shall support
character values of a single lowercase letter of the POSIX
locale and the characters &rsquo;&lsquo;&rsquo; and
&rsquo;&quot; ; support of other characters is
implementation- <br>
defined.</p>

<p style="margin-top: 1em">If executing the vi m command,
set the specified mark to the current line and 1-based
numbered character referenced by the current column, if any;
otherwise, column position 1.</p>

<p style="margin-top: 1em">Otherwise, set the specified
mark to the specified line and 1-based numbered first non-
&lt;blank&gt; non- &lt;newline&gt; in the line, if any;
otherwise, the last non- &lt;newline&gt; in the <br>
line, if any; otherwise, column position 1.</p>

<p style="margin-top: 1em">The mark shall remain associated
with the line until the mark is reset or the line is
deleted. If a deleted line is restored by a subsequent undo
command, any marks previously <br>
associated with the line, which have not been reset, shall
be restored as well. Any use of a mark not associated with a
current line in the edit buffer shall be an error.</p>

<p style="margin-top: 1em">The marks &lsquo; and &rsquo;
shall be set as described previously, immediately before the
following events occur in the editor:</p>

<p style="margin-top: 1em">1. The use of &rsquo;$&rsquo; as
an ex address</p>

<p style="margin-top: 1em">2. The use of a positive decimal
number as an ex address</p>

<p style="margin-top: 1em">3. The use of a search command
as an ex address</p>

<p style="margin-top: 1em">4. The use of a mark reference
as an ex address</p>

<p style="margin-top: 1em">5. The use of the following open
and visual mode commands: &lt;control&gt;-], %, (, ), [, ],
{, }</p>

<p style="margin-top: 1em">6. The use of the following open
and visual mode commands: &rsquo;, G, H, L, M, z if the
current line will change as a result of the command</p>

<p style="margin-top: 1em">7. The use of the open and
visual mode commands: /, ?, N, &lsquo;, n if the current
line or column will change as a result of the command</p>

<p style="margin-top: 1em">8. The use of the ex mode
commands: z, undo, global, v</p>

<p style="margin-top: 1em">For rules 1., 2., 3., and 4.,
the &lsquo; and &rsquo; marks shall not be set if the ex
command is parsed as specified by rule 6.a. in Command Line
Parsing in ex .</p>

<p style="margin-top: 1em">For rules 5., 6., and 7., the
&lsquo; and &rsquo; marks shall not be set if the commands
are used as motion commands in open and visual mode.</p>

<p style="margin-top: 1em">For rules 1., 2., 3., 4., 5.,
6., 7., and 8., the &lsquo; and &rsquo; marks shall not be
set if the command fails.</p>

<p style="margin-top: 1em">The &lsquo; and &rsquo; marks
shall be set as described previously, each time the contents
of the edit buffer are replaced (including the editing of
the initial buffer), if in open or visual <br>
mode, or if in ex mode and the edit buffer is not empty,
before any commands or movements (including commands or
movements specified by the -c or -t options or the + command
<br>
argument) are executed on the edit buffer. If in open or
visual mode, the marks shall be set as if executing the vi m
command; otherwise, as if executing the ex mark command.</p>

<p style="margin-top: 1em">When changing from ex mode to
open or visual mode, if the &lsquo; and &rsquo; marks are
not already set, the &lsquo; and &rsquo; marks shall be set
as described previously.</p>

<p style="margin-top: 1em">Current line: Unchanged.</p>

<p style="margin-top: 1em">Current column: Unchanged.</p>

<p style="margin-top: 1em">Move <br>
Synopsis:</p>

<p style="margin-top: 1em">[2addr] m[ove] 1addr [flags]</p>

<p style="margin-top: 1em">Move the specified lines after
the specified destination line. A destination of line zero
specifies that the lines shall be placed at the beginning of
the edit buffer. It shall <br>
be an error if the destination line is within the range of
lines to be moved.</p>

<p style="margin-top: 1em">Current line: Set to the last of
the moved lines.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Next <br>
Synopsis:</p>

<p style="margin-top: 1em">n[ext][!][+command][file
...]</p>

<p style="margin-top: 1em">If no &rsquo;!&rsquo; is
appended to the command name, and the edit buffer has been
modified since the last complete write, it shall be an
error, unless the file is successfully written as <br>
specified by the autowrite option.</p>

<p style="margin-top: 1em">If one or more files is
specified:</p>

<p style="margin-top: 1em">1. Set the argument list to the
specified filenames.</p>

<p style="margin-top: 1em">2. Set the current argument list
reference to be the first entry in the argument list.</p>

<p style="margin-top: 1em">3. Set the current pathname to
the first filename specified.</p>

<p style="margin-top: 1em">Otherwise:</p>

<p style="margin-top: 1em">1. It shall be an error if there
are no more filenames in the argument list after the
filename currently referenced.</p>

<p style="margin-top: 1em">2. Set the current pathname and
the current argument list reference to the filename after
the filename currently referenced in the argument list.</p>

<p style="margin-top: 1em">Replace the contents of the edit
buffer with the contents of the file named by the current
pathname. If for any reason the contents of the file cannot
be accessed, the edit buf&acirc; <br>
fer shall be empty.</p>

<p style="margin-top: 1em">This command shall be affected
by the autowrite and writeany edit options.</p>

<p style="margin-top: 1em">The + command option shall be
&lt;blank&gt;-delimited; &lt;blank&gt;s can be escaped by
preceding them with a backslash character. The + command
shall be interpreted as an ex command immedi&acirc; <br>
ately after the contents of the edit buffer have been
replaced and the current line and column have been set.</p>

<p style="margin-top: 1em">Current line: Set as described
for the edit command.</p>

<p style="margin-top: 1em">Current column: Set as described
for the edit command.</p>

<p style="margin-top: 1em">Number <br>
Synopsis:</p>

<p style="margin-top: 1em">[2addr] nu[mber][count][flags]
<br>
[2addr] #[count][flags]</p>

<p style="margin-top: 1em">These commands shall be
equivalent to the ex command:</p>

<p style="margin-top: 1em">[2addr] p[rint][count]
#[flags]</p>

<p style="margin-top: 1em">See Print .</p>

<p style="margin-top: 1em">Open <br>
Synopsis:</p>

<p style="margin-top: 1em">[1addr] o[pen] /pattern/
[flags]</p>

<p style="margin-top: 1em">This command need not be
supported on block-mode terminals or terminals with
insufficient capabilities. If standard input, standard
output, or standard error are not terminal <br>
devices, the results are unspecified.</p>

<p style="margin-top: 1em">Enter open mode.</p>

<p style="margin-top: 1em">The trailing delimiter can be
omitted from pattern at the end of the command line. If
pattern is empty (for example, &quot;//&quot; ) or not
specified, the last regular expression used in <br>
the editor shall be used as the pattern. The pattern can be
delimited by slashes (shown in the Synopsis), as well as any
alphanumeric, or non- &lt;blank&gt; other than backslash,
ver&acirc; <br>
tical line, double quote, or &lt;newline&gt;.</p>

<p style="margin-top: 1em">Current line: Set to the
specified line.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Preserve <br>
Synopsis:</p>

<p style="margin-top: 1em">pre[serve]</p>

<p style="margin-top: 1em">Save the edit buffer in a form
that can later be recovered by using the -r option or by
using the ex recover command. After the file has been
preserved, a mail message shall be <br>
sent to the user. This message shall be readable by invoking
the mailx utility. The message shall contain the name of the
file, the time of preservation, and an ex command that <br>
could be used to recover the file. Additional information
may be included in the mail message.</p>

<p style="margin-top: 1em">Current line: Unchanged.</p>

<p style="margin-top: 1em">Current column: Unchanged.</p>

<p style="margin-top: 1em">Print <br>
Synopsis:</p>

<p style="margin-top: 1em">[2addr]
p[rint][count][flags]</p>

<p style="margin-top: 1em">Write the addressed lines. The
behavior is unspecified if the number of columns on the
display is less than the number of columns required to write
any single character in the <br>
lines being written.</p>

<p style="margin-top: 1em">Non-printable characters, except
for the &lt;tab&gt;, shall be written as
implementation-defined multi-character sequences.</p>

<p style="margin-top: 1em">If the # flag is specified or
the number edit option is set, each line shall be preceded
by its line number in the following format:</p>

<p style="margin-top: 1em">&quot;%6d &quot;, &lt;line
number&gt;</p>

<p style="margin-top: 1em">If the l flag is specified or
the list edit option is set:</p>

<p style="margin-top: 1em">1. The characters listed in the
Base Definitions volume of IEEE Std 1003.1-2001, Table 5-1,
Escape Sequences and Associated Actions shall be written as
the corresponding escape <br>
sequence.</p>

<p style="margin-top: 1em">2. Non-printable characters not
in the Base Definitions volume of IEEE Std 1003.1-2001,
Table 5-1, Escape Sequences and Associated Actions shall be
written as one three-digit <br>
octal number (with a preceding backslash) for each byte in
the character (most significant byte first). If the size of
a byte on the system is greater than 9 bits, the format <br>
used for non-printable characters is
implementation-defined.</p>

<p style="margin-top: 1em">3. The end of each line shall be
marked with a &rsquo;$&rsquo;, and literal &rsquo;$&rsquo;
characters within the line shall be written with a preceding
backslash.</p>

<p style="margin-top: 1em">Long lines shall be folded; the
length at which folding occurs is unspecified, but should be
appropriate for the output terminal, considering the number
of columns of the termi&acirc; <br>
nal.</p>

<p style="margin-top: 1em">If a line is folded, and the l
flag is not specified and the list edit option is not set,
it is unspecified whether a multi-column character at the
folding position is separated; <br>
it shall not be discarded.</p>

<p style="margin-top: 1em">Current line: Set to the last
written line.</p>

<p style="margin-top: 1em">Current column: Unchanged if the
current line is unchanged; otherwise, set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Put <br>
Synopsis:</p>

<p style="margin-top: 1em">[1addr] pu[t][buffer]</p>

<p style="margin-top: 1em">Append text from the specified
buffer (by default, the unnamed buffer) to the specified
line; line zero specifies that the text shall be placed at
the beginning of the edit buf&acirc; <br>
fer. Each portion of a line in the buffer shall become a new
line in the edit buffer, regardless of the mode of the
buffer.</p>

<p style="margin-top: 1em">Current line: Set to the last
line entered into the edit buffer.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Quit <br>
Synopsis:</p>

<p style="margin-top: 1em">q[uit][!]</p>

<p style="margin-top: 1em">If no &rsquo;!&rsquo; is
appended to the command name:</p>

<p style="margin-top: 1em">1. If the edit buffer has been
modified since the last complete write, it shall be an
error.</p>

<p style="margin-top: 1em">2. If there are filenames in the
argument list after the filename currently referenced, and
the last command was not a quit, wq, xit, or ZZ (see Exit )
command, it shall be an <br>
error.</p>

<p style="margin-top: 1em">Otherwise, terminate the editing
session.</p>

<p style="margin-top: 1em">Read <br>
Synopsis:</p>

<p style="margin-top: 1em">[1addr] r[ead][!][file]</p>

<p style="margin-top: 1em">If &rsquo;!&rsquo; is not the
first non- &lt;blank&gt; to follow the command name, a copy
of the specified file shall be appended into the edit buffer
after the specified line; line zero specifies <br>
that the copy shall be placed at the beginning of the edit
buffer. The number of lines and bytes read shall be written.
If no file is named, the current pathname shall be the <br>
default. If there is no current pathname, then file shall
become the current pathname. If there is no current pathname
or file operand, it shall be an error. Specifying a file
<br>
that is not of type regular shall have unspecified
results.</p>

<p style="margin-top: 1em">Otherwise, if file is preceded
by &rsquo;!&rsquo;, the rest of the line after the
&rsquo;!&rsquo; shall have &rsquo;%&rsquo;, &rsquo;#&rsquo;,
and &rsquo;!&rsquo; characters expanded as described in
Command Line Parsing in ex .</p>

<p style="margin-top: 1em">The ex utility shall then pass
two arguments to the program named by the shell edit option;
the first shall be -c and the second shall be the expanded
arguments to the read com&acirc; <br>
mand as a single argument. The standard input of the program
shall be set to the standard input of the ex program when it
was invoked. The standard error and standard output of <br>
the program shall be appended into the edit buffer after the
specified line.</p>

<p style="margin-top: 1em">Each line in the copied file or
program output (as delimited by &lt;newline&gt;s or the end
of the file or output if it is not immediately preceded by a
&lt;newline&gt;), shall be a separate <br>
line in the edit buffer. Any occurrences of
&lt;carriage-return&gt; and &lt;newline&gt; pairs in the
output shall be treated as single &lt;newline&gt;s.</p>

<p style="margin-top: 1em">The special meaning of the
&rsquo;!&rsquo; following the read command can be overridden
by escaping it with a backslash character.</p>

<p style="margin-top: 1em">Current line: If no lines are
added to the edit buffer, unchanged. Otherwise, if in open
or visual mode, set to the first line entered into the edit
buffer. Otherwise, set to <br>
the last line entered into the edit buffer.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Recover <br>
Synopsis:</p>

<p style="margin-top: 1em">rec[over][!] file</p>

<p style="margin-top: 1em">If no &rsquo;!&rsquo; is
appended to the command name, and the edit buffer has been
modified since the last complete write, it shall be an
error.</p>

<p style="margin-top: 1em">If no file operand is specified,
then the current pathname shall be used. If there is no
current pathname or file operand, it shall be an error.</p>

<p style="margin-top: 1em">If no recovery information has
previously been saved about file, the recover command shall
behave identically to the edit command, and an informational
message to this effect <br>
shall be written.</p>

<p style="margin-top: 1em">Otherwise, set the current
pathname to file, and replace the current contents of the
edit buffer with the recovered contents of file. If there
are multiple instances of the file <br>
to be recovered, the one most recently saved shall be
recovered, and an informational message that there are
previous versions of the file that can be recovered shall be
written. <br>
The editor shall behave as if the contents of the edit
buffer have already been modified.</p>

<p style="margin-top: 1em">Current file: Set as described
for the edit command.</p>

<p style="margin-top: 1em">Current column: Set as described
for the edit command.</p>

<p style="margin-top: 1em">Rewind <br>
Synopsis:</p>

<p style="margin-top: 1em">rew[ind][!]</p>

<p style="margin-top: 1em">If no &rsquo;!&rsquo; is
appended to the command name, and the edit buffer has been
modified since the last complete write, it shall be an
error, unless the file is successfully written as <br>
specified by the autowrite option.</p>

<p style="margin-top: 1em">If the argument list is empty,
it shall be an error.</p>

<p style="margin-top: 1em">The current argument list
reference and the current pathname shall be set to the first
filename in the argument list.</p>

<p style="margin-top: 1em">Replace the contents of the edit
buffer with the contents of the file named by the current
pathname. If for any reason the contents of the file cannot
be accessed, the edit buf&acirc; <br>
fer shall be empty.</p>

<p style="margin-top: 1em">This command shall be affected
by the autowrite and writeany edit options.</p>

<p style="margin-top: 1em">Current line: Set as described
for the edit command.</p>

<p style="margin-top: 1em">Current column: Set as described
for the edit command.</p>

<p style="margin-top: 1em">Set <br>
Synopsis:</p>

<p style="margin-top: 1em">se[t][option[=[value]]
...][nooption ...][option? ...][all]</p>

<p style="margin-top: 1em">When no arguments are specified,
write the value of the term edit option and those options
whose values have been changed from the default settings;
when the argument all is <br>
specified, write all of the option values.</p>

<p style="margin-top: 1em">Giving an option name followed
by the character &rsquo;?&rsquo; shall cause the current
value of that option to be written. The &rsquo;?&rsquo; can
be separated from the option name by zero or more <br>
&lt;blank&gt;s. The &rsquo;?&rsquo; shall be necessary only
for Boolean valued options. Boolean options can be given
values by the form set option to turn them on or set no
option to turn them <br>
off; string and numeric options can be assigned by the form
set option= value. Any &lt;blank&gt;s in strings can be
included as is by preceding each &lt;blank&gt; with an
escaping backslash. <br>
More than one option can be set or listed by a single set
command by specifying multiple arguments, each separated
from the next by one or more &lt;blank&gt;s.</p>

<p style="margin-top: 1em">See Edit Options in ex for
details about specific options.</p>

<p style="margin-top: 1em">Current line: Unchanged.</p>

<p style="margin-top: 1em">Current column: Unchanged.</p>

<p style="margin-top: 1em">Shell <br>
Synopsis:</p>

<p style="margin-top: 1em">sh[ell]</p>

<p style="margin-top: 1em">Invoke the program named in the
shell edit option with the single argument -i (interactive
mode). Editing shall be resumed when the program exits.</p>

<p style="margin-top: 1em">Current line: Unchanged.</p>

<p style="margin-top: 1em">Current column: Unchanged.</p>

<p style="margin-top: 1em">Source <br>
Synopsis:</p>

<p style="margin-top: 1em">so[urce] file</p>

<p style="margin-top: 1em">Read and execute ex commands
from file. Lines in the file that are blank lines shall be
ignored.</p>

<p style="margin-top: 1em">Current line: As specified for
the individual ex commands.</p>

<p style="margin-top: 1em">Current column: As specified for
the individual ex commands.</p>

<p style="margin-top: 1em">Substitute <br>
Synopsis:</p>

<p style="margin-top: 1em">[2addr]
s[ubstitute][/pattern/repl/[options][count][flags]]</p>

<p style="margin-top: 1em">[2addr]
&amp;[options][count][flags]]</p>

<p style="margin-top: 1em">[2addr]
~[options][count][flags]]</p>

<p style="margin-top: 1em">Replace the first instance of
the pattern pattern by the string repl on each specified
line. (See Regular Expressions in ex and Replacement Strings
in ex .) Any non-alphabetic, <br>
non- &lt;blank&gt; delimiter other than &rsquo;&acute;,
&rsquo;|&rsquo;, double quote, or &lt;newline&gt; can be
used instead of &rsquo;/&rsquo; . Backslash characters can
be used to escape delimiters, backslash characters, <br>
and other special characters.</p>

<p style="margin-top: 1em">The trailing delimiter can be
omitted from pattern or from repl at the end of the command
line. If both pattern and repl are not specified or are
empty (for example, &quot;//&quot; ), the <br>
last s command shall be repeated. If only pattern is not
specified or is empty, the last regular expression used in
the editor shall be used as the pattern. If only repl is not
<br>
specified or is empty, the pattern shall be replaced by
nothing. If the entire replacement pattern is
&rsquo;%&rsquo;, the last replacement pattern to an s
command shall be used.</p>

<p style="margin-top: 1em">Entering a
&lt;carriage-return&gt; in repl (which requires an escaping
backslash in ex mode and an escaping &lt;control&gt;-V in
open or vi mode) shall split the line at that point,
creating <br>
a new line in the edit buffer. The &lt;carriage-return&gt;
shall be discarded.</p>

<p style="margin-top: 1em">If options includes the letter
&rsquo;g&rsquo; ( global), all non-overlapping instances of
the pattern in the line shall be replaced.</p>

<p style="margin-top: 1em">If options includes the letter
&rsquo;c&rsquo; ( confirm), then before each substitution
the line shall be written; the written line shall reflect
all previous substitutions. On the follow&acirc; <br>
ing line, &lt;space&gt;s shall be written beneath the
characters from the line that are before the pattern to be
replaced, and &rsquo;^&rsquo; characters written beneath the
characters included in <br>
the pattern to be replaced. The ex utility shall then wait
for a response from the user. An affirmative response shall
cause the substitution to be done, while any other input
<br>
shall not make the substitution. An affirmative response
shall consist of a line with the affirmative response (as
defined by the current locale) at the beginning of the line.
<br>
This line shall be subject to editing in the same way as the
ex command line.</p>

<p style="margin-top: 1em">If interrupted (see the
ASYNCHRONOUS EVENTS section), any modifications confirmed by
the user shall be preserved in the edit buffer after the
interrupt.</p>

<p style="margin-top: 1em">If the remembered search
direction is not set, the s command shall set it to
forward.</p>

<p style="margin-top: 1em">In the second Synopsis, the
&amp; command shall repeat the previous substitution, as if
the &amp; command were replaced by:</p>

<p style="margin-top: 1em">s/pattern/repl/</p>

<p style="margin-top: 1em">where pattern and repl are as
specified in the previous s, &amp;, or ~ command.</p>

<p style="margin-top: 1em">In the third Synopsis, the ~
command shall repeat the previous substitution, as if the
&rsquo;~&rsquo; were replaced by:</p>

<p style="margin-top: 1em">s/pattern/repl/</p>

<p style="margin-top: 1em">where pattern shall be the last
regular expression specified to the editor, and repl shall
be from the previous substitution (including &amp; and ~)
command.</p>

<p style="margin-top: 1em">These commands shall be affected
by the LC_MESSAGES environment variable.</p>

<p style="margin-top: 1em">Current line: Set to the last
line in which a substitution occurred, or, unchanged if no
substitution occurred.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Suspend <br>
Synopsis:</p>

<p style="margin-top: 1em">su[spend][!]st[op][!]</p>

<p style="margin-top: 1em">Allow control to return to the
invoking process; ex shall suspend itself as if it had
received the SIGTSTP signal. The suspension shall occur only
if job control is enabled in <br>
the invoking shell (see the description of set -m).</p>

<p style="margin-top: 1em">These commands shall be affected
by the autowrite and writeany edit options.</p>

<p style="margin-top: 1em">The current susp character (see
stty ) shall be equivalent to the suspend command.</p>

<p style="margin-top: 1em">Tag <br>
Synopsis:</p>

<p style="margin-top: 1em">ta[g][!] tagstring</p>

<p style="margin-top: 1em">The results are unspecified if
the format of a tags file is not as specified by the ctags
utility (see ctags ) description.</p>

<p style="margin-top: 1em">The tag command shall search for
tagstring in the tag files referred to by the tag edit
option, in the order they are specified, until a reference
to tagstring is found. Files <br>
shall be searched from beginning to end. If no reference is
found, it shall be an error and an error message to this
effect shall be written. If the reference is not found, or
if <br>
an error occurs while processing a file referred to in the
tag edit option, it shall be an error, and an error message
shall be written at the first occurrence of such an
error.</p>

<p style="margin-top: 1em">Otherwise, if the tags file
contained a pattern, the pattern shall be treated as a
regular expression used in the editor; for example, for the
purposes of the s command.</p>

<p style="margin-top: 1em">If the tagstring is in a file
with a different name than the current pathname, set the
current pathname to the name of that file, and replace the
contents of the edit buffer with <br>
the contents of that file. In this case, if no
&rsquo;!&rsquo; is appended to the command name, and the
edit buffer has been modified since the last complete write,
it shall be an error, <br>
unless the file is successfully written as specified by the
autowrite option.</p>

<p style="margin-top: 1em">This command shall be affected
by the autowrite, tag, taglength, and writeany edit
options.</p>

<p style="margin-top: 1em">Current line: If the tags file
contained a line number, set to that line number. If the
line number is larger than the last line in the edit buffer,
an error message shall be <br>
written and the current line shall be set as specified for
the edit command.</p>

<p style="margin-top: 1em">If the tags file contained a
pattern, set to the first occurrence of the pattern in the
file. If no matching pattern is found, an error message
shall be written and the current <br>
line shall be set as specified for the edit command.</p>

<p style="margin-top: 1em">Current column: If the tags file
contained a line-number reference and that line-number was
not larger than the last line in the edit buffer, or if the
tags file contained a pat&acirc; <br>
tern and that pattern was found, set to non- &lt;blank&gt;.
Otherwise, set as specified for the edit command.</p>

<p style="margin-top: 1em">Unabbreviate <br>
Synopsis:</p>

<p style="margin-top: 1em">una[bbrev] lhs</p>

<p style="margin-top: 1em">If lhs is not an entry in the
current list of abbreviations (see Abbreviate ), it shall be
an error. Otherwise, delete lhs from the list of
abbreviations.</p>

<p style="margin-top: 1em">Current line: Unchanged.</p>

<p style="margin-top: 1em">Current column: Unchanged.</p>

<p style="margin-top: 1em">Undo <br>
Synopsis:</p>

<p style="margin-top: 1em">u[ndo]</p>

<p style="margin-top: 1em">Reverse the changes made by the
last command that modified the contents of the edit buffer,
including undo. For this purpose, the global, v, open, and
visual commands, and com&acirc; <br>
mands resulting from buffer executions and mapped character
expansions, are considered single commands.</p>

<p style="margin-top: 1em">If no action that can be undone
preceded the undo command, it shall be an error.</p>

<p style="margin-top: 1em">If the undo command restores
lines that were marked, the mark shall also be restored
unless it was reset subsequent to the deletion of the
lines.</p>

<p style="margin-top: 1em">Current line:</p>

<p style="margin-top: 1em">1. If lines are added or changed
in the file, set to the first line added or changed.</p>

<p style="margin-top: 1em">2. Set to the line before the
first line deleted, if it exists.</p>

<p style="margin-top: 1em">3. Set to 1 if the edit buffer
is not empty.</p>

<p style="margin-top: 1em">4. Set to zero.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Unmap <br>
Synopsis:</p>

<p style="margin-top: 1em">unm[ap][!] lhs</p>

<p style="margin-top: 1em">If &rsquo;!&rsquo; is appended
to the command name, and if lhs is not an entry in the list
of text input mode map definitions, it shall be an error.
Otherwise, delete lhs from the list of <br>
text input mode map definitions.</p>

<p style="margin-top: 1em">If no &rsquo;!&rsquo; is
appended to the command name, and if lhs is not an entry in
the list of command mode map definitions, it shall be an
error. Otherwise, delete lhs from the list of <br>
command mode map definitions.</p>

<p style="margin-top: 1em">Current line: Unchanged.</p>

<p style="margin-top: 1em">Current column: Unchanged.</p>

<p style="margin-top: 1em">Version <br>
Synopsis:</p>

<p style="margin-top: 1em">ve[rsion]</p>

<p style="margin-top: 1em">Write a message containing
version information for the editor. The format of the
message is unspecified.</p>

<p style="margin-top: 1em">Current line: Unchanged.</p>

<p style="margin-top: 1em">Current column: Unchanged.</p>

<p style="margin-top: 1em">Visual <br>
Synopsis:</p>

<p style="margin-top: 1em">[1addr]
vi[sual][type][count][flags]</p>

<p style="margin-top: 1em">If ex is currently in open or
visual mode, the Synopsis and behavior of the visual command
shall be the same as the edit command, as specified by Edit
.</p>

<p style="margin-top: 1em">Otherwise, this command need not
be supported on block-mode terminals or terminals with
insufficient capabilities. If standard input, standard
output, or standard error are not <br>
terminal devices, the results are unspecified.</p>

<p style="margin-top: 1em">If count is specified, the value
of the window edit option shall be set to count (as
described in window ). If the &rsquo;^&rsquo; type character
was also specified, the window edit option <br>
shall be set before being used by the type character.</p>

<p style="margin-top: 1em">Enter visual mode. If type is
not specified, it shall be as if a type of &rsquo;+&rsquo;
was specified. The type shall cause the following
effects:</p>

<p style="margin-top: 1em">+ Place the beginning of the
specified line at the top of the display.</p>

<p style="margin-top: 1em">- Place the end of the specified
line at the bottom of the display.</p>

<p style="margin-top: 1em">. Place the beginning of the
specified line in the middle of the display.</p>

<p style="margin-top: 1em">^ If the specified line is less
than or equal to the value of the window edit option, set
the line to 1; otherwise, decrement the line by the value of
the window edit option <br>
minus 1. Place the beginning of this line as close to the
bottom of the displayed lines as possible, while still
displaying the value of the window edit option number of
<br>
lines.</p>

<p style="margin-top: 1em">Current line: Set to the
specified line.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Write <br>
Synopsis:</p>

<p style="margin-top: 1em">[2addr]
w[rite][!][&gt;&gt;][file] <br>
[2addr] w[rite][!][file] <br>
[2addr] wq[!][&gt;&gt;][file]</p>

<p style="margin-top: 1em">If no lines are specified, the
lines shall default to the entire file.</p>

<p style="margin-top: 1em">The command wq shall be
equivalent to a write command followed by a quit command;
wq! shall be equivalent to write! followed by quit. In both
cases, if the write command fails, <br>
the quit shall not be attempted.</p>

<p style="margin-top: 1em">If the command name is not
followed by one or more &lt;blank&gt;s, or file is not
preceded by a &rsquo;!&rsquo; character, the write shall be
to a file.</p>

<p style="margin-top: 1em">1. If the &gt;&gt; argument is
specified, and the file already exists, the lines shall be
appended to the file instead of replacing its contents. If
the &gt;&gt; argument is specified, and <br>
the file does not already exist, it is unspecified whether
the write shall proceed as if the &gt;&gt; argument had not
been specified or if the write shall fail.</p>

<p style="margin-top: 1em">2. If the readonly edit option
is set (see readonly ), the write shall fail.</p>

<p style="margin-top: 1em">3. If file is specified, and is
not the current pathname, and the file exists, the write
shall fail.</p>

<p style="margin-top: 1em">4. If file is not specified, the
current pathname shall be used. If there is no current
pathname, the write command shall fail.</p>

<p style="margin-top: 1em">5. If the current pathname is
used, and the current pathname has been changed by the file
or read commands, and the file exists, the write shall fail.
If the write is success&acirc; <br>
ful, subsequent writes shall not fail for this reason
(unless the current pathname is changed again).</p>

<p style="margin-top: 1em">6. If the whole edit buffer is
not being written, and the file to be written exists, the
write shall fail.</p>

<p style="margin-top: 1em">For rules 1., 2., 4., and 5.,
the write can be forced by appending the character
&rsquo;!&rsquo; to the command name.</p>

<p style="margin-top: 1em">For rules 2., 4., and 5., the
write can be forced by setting the writeany edit option.</p>

<p style="margin-top: 1em">Additional,
implementation-defined tests may cause the write to
fail.</p>

<p style="margin-top: 1em">If the edit buffer is empty, a
file without any contents shall be written.</p>

<p style="margin-top: 1em">An informational message shall
be written noting the number of lines and bytes written.</p>

<p style="margin-top: 1em">Otherwise, if the command is
followed by one or more &lt;blank&gt;s, and the file is
preceded by &rsquo;!&rsquo;, the rest of the line after the
&rsquo;!&rsquo; shall have &rsquo;%&rsquo;, &rsquo;#&rsquo;,
and &rsquo;!&rsquo; characters <br>
expanded as described in Command Line Parsing in ex .</p>

<p style="margin-top: 1em">The ex utility shall then pass
two arguments to the program named by the shell edit option;
the first shall be -c and the second shall be the expanded
arguments to the write com&acirc; <br>
mand as a single argument. The specified lines shall be
written to the standard input of the command. The standard
error and standard output of the program, if any, shall be
<br>
written as described for the print command. If the last
character in that output is not a &lt;newline&gt;, a
&lt;newline&gt; shall be written at the end of the
output.</p>

<p style="margin-top: 1em">The special meaning of the
&rsquo;!&rsquo; following the write command can be
overridden by escaping it with a backslash character.</p>

<p style="margin-top: 1em">Current line: Unchanged.</p>

<p style="margin-top: 1em">Current column: Unchanged.</p>

<p style="margin-top: 1em">Write and Exit <br>
Synopsis:</p>

<p style="margin-top: 1em">[2addr] x[it][!][file]</p>

<p style="margin-top: 1em">If the edit buffer has not been
modified since the last complete write, xit shall be
equivalent to the quit command, or if a &rsquo;!&rsquo; is
appended to the command name, to quit!.</p>

<p style="margin-top: 1em">Otherwise, xit shall be
equivalent to the wq command, or if a &rsquo;!&rsquo; is
appended to the command name, to wq!.</p>

<p style="margin-top: 1em">Current line: Unchanged.</p>

<p style="margin-top: 1em">Current column: Unchanged.</p>

<p style="margin-top: 1em">Yank <br>
Synopsis:</p>

<p style="margin-top: 1em">[2addr]
ya[nk][buffer][count]</p>

<p style="margin-top: 1em">Copy the specified lines to the
specified buffer (by default, the unnamed buffer), which
shall become a line-mode buffer.</p>

<p style="margin-top: 1em">Current line: Unchanged.</p>

<p style="margin-top: 1em">Current column: Unchanged.</p>

<p style="margin-top: 1em">Adjust Window <br>
Synopsis:</p>

<p style="margin-top: 1em">[1addr] z[!][type
...][count][flags]</p>

<p style="margin-top: 1em">If no line is specified, the
current line shall be the default; if type is omitted as
well, the current line value shall first be incremented by
1. If incrementing the current <br>
line would cause it to be greater than the last line in the
edit buffer, it shall be an error.</p>

<p style="margin-top: 1em">If there are &lt;blank&gt;s
between the type argument and the preceding z command name
or optional &rsquo;!&rsquo; character, it shall be an
error.</p>

<p style="margin-top: 1em">If count is specified, the value
of the window edit option shall be set to count (as
described in window ). If count is omitted, it shall default
to 2 times the value of the <br>
scroll edit option, or if ! was specified, the number of
lines in the display minus 1.</p>

<p style="margin-top: 1em">If type is omitted, then count
lines starting with the specified line shall be written.
Otherwise, count lines starting with the line specified by
the type argument shall be <br>
written.</p>

<p style="margin-top: 1em">The type argument shall change
the lines to be written. The possible values of type are as
follows:</p>

<p style="margin-top: 1em">- The specified line shall be
decremented by the following value:</p>

<p style="margin-top: 1em">(((number of &quot;-&quot;
characters) x count) -1)</p>

<p style="margin-top: 1em">If the calculation would result
in a number less than 1, it shall be an error. Write lines
from the edit buffer, starting at the new value of line,
until count lines or the last <br>
line in the edit buffer has been written.</p>

<p style="margin-top: 1em">+ The specified line shall be
incremented by the following value:</p>

<p style="margin-top: 1em">(((number of &quot;+&quot;
characters) -1) x count) +1</p>

<p style="margin-top: 1em">If the calculation would result
in a number greater than the last line in the edit buffer,
it shall be an error. Write lines from the edit buffer,
starting at the new value of <br>
line, until count lines or the last line in the edit buffer
has been written.</p>

<p style="margin-top: 1em">=,. If more than a single
&rsquo;.&rsquo; or &rsquo;=&rsquo; is specified, it shall be
an error. The following steps shall be taken:</p>

<p style="margin-top: 1em">1. If count is zero, nothing
shall be written.</p>

<p style="margin-top: 1em">2. Write as many of the N lines
before the current line in the edit buffer as exist. If
count or &rsquo;!&rsquo; was specified, N shall be:</p>

<p style="margin-top: 1em">(count -1) /2</p>

<p style="margin-top: 1em">Otherwise, N shall be:</p>

<p style="margin-top: 1em">(count -3) /2</p>

<p style="margin-top: 1em">If N is a number less than 3, no
lines shall be written.</p>

<p style="margin-top: 1em">3. If &rsquo;=&rsquo; was
specified as the type character, write a line consisting of
the smaller of the number of columns in the display divided
by two, or 40 &rsquo;-&rsquo; characters.</p>

<p style="margin-top: 1em">4. Write the current line.</p>

<p style="margin-top: 1em">5. Repeat step 3.</p>

<p style="margin-top: 1em">6. Write as many of the N lines
after the current line in the edit buffer as exist. N shall
be defined as in step 2. If N is a number less than 3, no
lines shall be <br>
written. If count is less than 3, no lines shall be
written.</p>

<p style="margin-top: 1em">^ The specified line shall be
decremented by the following value:</p>

<p style="margin-top: 1em">(((number of &quot;^&quot;
characters) +1) x count) -1</p>

<p style="margin-top: 1em">If the calculation would result
in a number less than 1, it shall be an error. Write lines
from the edit buffer, starting at the new value of line,
until count lines or the last <br>
line in the edit buffer has been written.</p>

<p style="margin-top: 1em">Current line: Set to the last
line written, unless the type is =, in which case, set to
the specified line.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Escape <br>
Synopsis:</p>

<p style="margin-top: 1em">! command <br>
[addr]! command</p>

<p style="margin-top: 1em">The contents of the line after
the &rsquo;!&rsquo; shall have &rsquo;%&rsquo;,
&rsquo;#&rsquo;, and &rsquo;!&rsquo; characters expanded as
described in Command Line Parsing in ex . If the expansion
causes the text of the line <br>
to change, it shall be redisplayed, preceded by a single
&rsquo;!&rsquo; character.</p>

<p style="margin-top: 1em">The ex utility shall execute the
program named by the shell edit option. It shall pass two
arguments to the program; the first shall be -c, and the
second shall be the expanded <br>
arguments to the ! command as a single argument.</p>

<p style="margin-top: 1em">If no lines are specified, the
standard input, standard output, and standard error of the
program shall be set to the standard input, standard output,
and standard error of the <br>
ex program when it was invoked. In addition, a warning
message shall be written if the edit buffer has been
modified since the last complete write, and the warn edit
option is <br>
set.</p>

<p style="margin-top: 1em">If lines are specified, they
shall be passed to the program as standard input, and the
standard output and standard error of the program shall
replace those lines in the edit <br>
buffer. Each line in the program output (as delimited by
&lt;newline&gt;s or the end of the output if it is not
immediately preceded by a &lt;newline&gt;), shall be a
separate line in the <br>
edit buffer. Any occurrences of &lt;carriage-return&gt; and
&lt;newline&gt; pairs in the output shall be treated as
single &lt;newline&gt;s. The specified lines shall be copied
into the unnamed <br>
buffer before they are replaced, and the unnamed buffer
shall become a line-mode buffer.</p>

<p style="margin-top: 1em">If in ex mode, a single
&rsquo;!&rsquo; character shall be written when the program
completes.</p>

<p style="margin-top: 1em">This command shall be affected
by the shell and warn edit options. If no lines are
specified, this command shall be affected by the autowrite
and writeany edit options. If lines <br>
are specified, this command shall be affected by the
autoprint edit option.</p>

<p style="margin-top: 1em">Current line:</p>

<p style="margin-top: 1em">1. If no lines are specified,
unchanged.</p>

<p style="margin-top: 1em">2. Otherwise, set to the last
line read in, if any lines are read in.</p>

<p style="margin-top: 1em">3. Otherwise, set to the line
before the first line of the lines specified, if that line
exists.</p>

<p style="margin-top: 1em">4. Otherwise, set to the first
line of the edit buffer if the edit buffer is not empty.</p>

<p style="margin-top: 1em">5. Otherwise, set to zero.</p>

<p style="margin-top: 1em">Current column: If no lines are
specified, unchanged. Otherwise, set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Shift Left <br>
Synopsis:</p>

<p style="margin-top: 1em">[2addr] &lt;[&lt;
...][count][flags]</p>

<p style="margin-top: 1em">Shift the specified lines to the
start of the line; the number of column positions to be
shifted shall be the number of command characters times the
value of the shiftwidth edit <br>
option. Only leading &lt;blank&gt;s shall be deleted or
changed into other &lt;blank&gt;s in shifting; other
characters shall not be affected.</p>

<p style="margin-top: 1em">Lines to be shifted shall be
copied into the unnamed buffer, which shall become a
line-mode buffer.</p>

<p style="margin-top: 1em">This command shall be affected
by the autoprint edit option.</p>

<p style="margin-top: 1em">Current line: Set to the last
line in the lines specified.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Shift Right <br>
Synopsis:</p>

<p style="margin-top: 1em">[2addr] &gt;[&gt;
...][count][flags]</p>

<p style="margin-top: 1em">Shift the specified lines away
from the start of the line; the number of column positions
to be shifted shall be the number of command characters
times the value of the <br>
shiftwidth edit option. The shift shall be accomplished by
adding &lt;blank&gt;s as a prefix to the line or changing
leading &lt;blank&gt;s into other &lt;blank&gt;s. Empty
lines shall not be <br>
changed.</p>

<p style="margin-top: 1em">Lines to be shifted shall be
copied into the unnamed buffer, which shall become a
line-mode buffer.</p>

<p style="margin-top: 1em">This command shall be affected
by the autoprint edit option.</p>

<p style="margin-top: 1em">Current line: Set to the last
line in the lines specified.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">&lt;control&gt;-D <br>
Synopsis:</p>

<p style="margin-top: 1em">&lt;control&gt;-D</p>

<p style="margin-top: 1em">Write the next n lines, where n
is the minimum of the values of the scroll edit option and
the number of lines after the current line in the edit
buffer. If the current line is <br>
the last line of the edit buffer it shall be an error.</p>

<p style="margin-top: 1em">Current line: Set to the last
line written.</p>

<p style="margin-top: 1em">Current column: Set to non-
&lt;blank&gt;.</p>

<p style="margin-top: 1em">Write Line Number <br>
Synopsis:</p>

<p style="margin-top: 1em">[1addr] = [flags]</p>

<p style="margin-top: 1em">If line is not specified, it
shall default to the last line in the edit buffer. Write the
line number of the specified line.</p>

<p style="margin-top: 1em">Current line: Unchanged.</p>

<p style="margin-top: 1em">Current column: Unchanged.</p>

<p style="margin-top: 1em">Execute <br>
Synopsis:</p>

<p style="margin-top: 1em">[2addr] @ buffer[2addr] *
buffer</p>

<p style="margin-top: 1em">If no buffer is specified or is
specified as &rsquo;@&rsquo; or &rsquo;*&rsquo;, the last
buffer executed shall be used. If no previous buffer has
been executed, it shall be an error.</p>

<p style="margin-top: 1em">For each line specified by the
addresses, set the current line ( &rsquo;.&rsquo; ) to the
specified line, and execute the contents of the named buffer
(as they were at the time the @ com&acirc; <br>
mand was executed) as ex commands. For each line of a
line-mode buffer, and all but the last line of a
character-mode buffer, the ex command parser shall behave as
if the line <br>
was terminated by a &lt;newline&gt;.</p>

<p style="margin-top: 1em">If an error occurs during this
process, or a line specified by the addresses does not exist
when the current line would be set to it, or more than a
single line was specified by <br>
the addresses, and the contents of the edit buffer are
replaced (for example, by the ex :edit command) an error
message shall be written, and no more commands resulting
from the <br>
execution of this command shall be processed.</p>

<p style="margin-top: 1em">Current line: As specified for
the individual ex commands.</p>

<p style="margin-top: 1em">Current column: As specified for
the individual ex commands.</p>

<p style="margin-top: 1em">Regular Expressions in ex <br>
The ex utility shall support regular expressions that are a
superset of the basic regular expressions described in the
Base Definitions volume of IEEE Std 1003.1-2001, Section
<br>
9.3, Basic Regular Expressions. A null regular expression (
&quot;//&quot; ) shall be equivalent to the last regular
expression encountered.</p>

<p style="margin-top: 1em">Regular expressions can be used
in addresses to specify lines and, in some commands (for
example, the substitute command), to specify portions of a
line to be substituted.</p>

<p style="margin-top: 1em">The following constructs can be
used to enhance the basic regular expressions:</p>

<p style="margin-top: 1em">&lt; Match the beginning of a
word. (See the definition of word at the beginning of
Command Descriptions in ex .)</p>

<p style="margin-top: 1em">&gt; Match the end of a
word.</p>

<p style="margin-top: 1em">~ Match the replacement part of
the last substitute command. The tilde ( &rsquo;~&rsquo; )
character can be escaped in a regular expression to become a
normal character with no special <br>
meaning. The backslash shall be discarded.</p>

<p style="margin-top: 1em">When the editor option magic is
not set, the only characters with special meanings shall be
&rsquo;^&rsquo; at the beginning of a pattern,
&rsquo;$&rsquo; at the end of a pattern, and &rsquo;&acute;
. The charac&acirc; <br>
ters &rsquo;.&rsquo;, &rsquo;*&rsquo;, &rsquo;[&rsquo;, and
&rsquo;~&rsquo; shall be treated as ordinary characters
unless preceded by a &rsquo;&acute; ; when preceded by a
&rsquo;&acute; they shall regain their special meaning, or
in the case of <br>
backslash, be handled as a single backslash. Backslashes
used to escape other characters shall be discarded.</p>

<p style="margin-top: 1em">Replacement Strings in ex <br>
The character &rsquo;&amp;&rsquo; ( &rsquo;&rsquo; if the
editor option magic is not set) in the replacement string
shall stand for the text matched by the pattern to be
replaced. The character &rsquo;~&rsquo; (
&rsquo;&nbsp;&rsquo; <br>
if magic is not set) shall be replaced by the replacement
part of the previous substitute command. The sequence
&rsquo;0, where n is an integer, shall be replaced by the
text matched <br>
by the pattern enclosed in the nth set of parentheses
&rsquo;and &rsquo;&rsquo; .</p>

<p style="margin-top: 1em">The strings &rsquo;
&rsquo;&rsquo;, &rsquo; and &rsquo;U&rsquo; can be used to
modify the case of elements in the replacement string (using
the &rsquo;&rsquo; or &quot; <br>
shall cause the character that follows to be converted to
lowercase (uppercase). The string &rsquo;U&rsquo; ) shall
cause all characters subsequent to it to be converted to
lower&acirc; <br>
case (uppercase) as they are inserted by the substitution
until the string &rsquo;\&rsquo; or &rsquo;&acute;, or the
end of the replacement string, is encountered.</p>

<p style="margin-top: 1em">Otherwise, any character
following a backslash shall be treated as that literal
character, and the escaping backslash shall be
discarded.</p>

<p style="margin-top: 1em">An example of case conversion
with the s command is as follows:</p>

<p style="margin-top: 1em">:p <br>
The cat sat on the mat. <br>
:s/&lt;.at&gt;/&amp;/gp <br>
The Cat Sat on the Mat. <br>
:s/SM/SU1\M/p <br>
The Cat SAT ON THE Mat.</p>

<p style="margin-top: 1em">Edit Options in ex <br>
The ex utility has a number of options that modify its
behavior. These options have default settings, which can be
changed using the set command.</p>

<p style="margin-top: 1em">Options are Boolean unless
otherwise specified.</p>

<p style="margin-top: 1em">autoindent, ai <br>
[Default unset]</p>

<p style="margin-top: 1em">If autoindent is set, each line
in input mode shall be indented (using first as many
&lt;tab&gt;s as possible, as determined by the editor option
tabstop, and then using &lt;space&gt;s) to <br>
align with another line, as follows:</p>

<p style="margin-top: 1em">1. If in open or visual mode and
the text input is part of a line-oriented command (see the
EXTENDED DESCRIPTION in vi ), align to the first column.</p>

<p style="margin-top: 1em">2. Otherwise, if in open or
visual mode, indentation for each line shall be set as
follows:</p>

<p style="margin-top: 1em">a. If a line was previously
inserted as part of this command, it shall be set to the
indentation of the last inserted line by default, or as
otherwise specified for the <br>
&lt;control&gt;-D character in Input Mode Commands in vi
.</p>

<p style="margin-top: 1em">b. Otherwise, it shall be set to
the indentation of the previous current line, if any;
otherwise, to the first column.</p>

<p style="margin-top: 1em">3. For the ex a, i, and c
commands, indentation for each line shall be set as
follows:</p>

<p style="margin-top: 1em">a. If a line was previously
inserted as part of this command, it shall be set to the
indentation of the last inserted line by default, or as
otherwise specified for the eof <br>
character in Scroll .</p>

<p style="margin-top: 1em">b. Otherwise, if the command is
the ex a command, it shall be set to the line appended
after, if any; otherwise to the first column.</p>

<p style="margin-top: 1em">c. Otherwise, if the command is
the ex i command, it shall be set to the line inserted
before, if any; otherwise to the first column.</p>

<p style="margin-top: 1em">d. Otherwise, if the command is
the ex c command, it shall be set to the indentation of the
line replaced.</p>

<p style="margin-top: 1em">autoprint, ap <br>
[Default set]</p>

<p style="margin-top: 1em">If autoprint is set, the current
line shall be written after each ex command that modifies
the contents of the current edit buffer, and after each tag
command for which the tag <br>
search pattern was found or tag line number was valid,
unless:</p>

<p style="margin-top: 1em">1. The command was executed
while in open or visual mode.</p>

<p style="margin-top: 1em">2. The command was executed as
part of a global or v command or @ buffer execution.</p>

<p style="margin-top: 1em">3. The command was the form of
the read command that reads a file into the edit buffer.</p>

<p style="margin-top: 1em">4. The command was the append,
change, or insert command.</p>

<p style="margin-top: 1em">5. The command was not
terminated by a &lt;newline&gt;.</p>

<p style="margin-top: 1em">6. The current line shall be
written by a flag specified to the command; for example,
delete # shall write the current line as specified for the
flag modifier to the delete com&acirc; <br>
mand, and not as specified by the autoprint edit option.</p>

<p style="margin-top: 1em">autowrite, aw <br>
[Default unset]</p>

<p style="margin-top: 1em">If autowrite is set, and the
edit buffer has been modified since it was last completely
written to any file, the contents of the edit buffer shall
be written as if the ex write <br>
command had been specified without arguments, before each
command affected by the autowrite edit option is executed.
Appending the character &rsquo;!&rsquo; to the command name
of any of the <br>
ex commands except &rsquo;!&rsquo; shall prevent the write.
If the write fails, it shall be an error and the command
shall not be executed.</p>

<p style="margin-top: 1em">beautify, bf <br>
[Default unset]</p>

<p style="margin-top: 1em">If beautify is set, all
non-printable characters, other than &lt;tab&gt;s,
&lt;newline&gt;s, and &lt;form-feed&gt;s, shall be discarded
from text read in from files.</p>

<p style="margin-top: 1em">directory, dir <br>
[Default implementation-defined]</p>

<p style="margin-top: 1em">The value of this option
specifies the directory in which the editor buffer is to be
placed. If this directory is not writable by the user, the
editor shall quit.</p>

<p style="margin-top: 1em">edcompatible, ed <br>
[Default unset]</p>

<p style="margin-top: 1em">Causes the presence of g and c
suffixes on substitute commands to be remembered, and
toggled by repeating the suffixes.</p>

<p style="margin-top: 1em">errorbells, eb <br>
[Default unset]</p>

<p style="margin-top: 1em">If the editor is in ex mode, and
the terminal does not support a standout mode (such as
inverse video), and errorbells is set, error messages shall
be preceded by alerting the <br>
terminal.</p>

<p style="margin-top: 1em">exrc <br>
[Default unset]</p>

<p style="margin-top: 1em">If exrc is set, ex shall access
any .exrc file in the current directory, as described in
Initialization in ex and vi . If exrc is not set, ex shall
ignore any .exrc file in the <br>
current directory during initialization, unless the current
directory is that named by the HOME environment
variable.</p>

<p style="margin-top: 1em">ignorecase, ic <br>
[Default unset]</p>

<p style="margin-top: 1em">If ignorecase is set, characters
that have uppercase and lowercase representations shall have
those representations considered as equivalent for purposes
of regular expression <br>
comparison.</p>

<p style="margin-top: 1em">The ignorecase edit option shall
affect all remembered regular expressions; for example,
unsetting the ignorecase edit option shall cause a
subsequent vi n command to search for <br>
the last basic regular expression in a case-sensitive
fashion.</p>

<p style="margin-top: 1em">list <br>
[Default unset]</p>

<p style="margin-top: 1em">If list is set, edit buffer
lines written while in ex command mode shall be written as
specified for the print command with the l flag specified.
In open or visual mode, each <br>
edit buffer line shall be displayed as specified for the ex
print command with the l flag specified. In open or visual
text input mode, when the cursor does not rest on any
char&acirc; <br>
acter in the line, it shall rest on the &rsquo;$&rsquo;
marking the end of the line.</p>

<p style="margin-top: 1em">magic <br>
[Default set]</p>

<p style="margin-top: 1em">If magic is set, modify the
interpretation of characters in regular expressions and
substitution replacement strings (see Regular Expressions in
ex and Replacement Strings in ex <br>
).</p>

<p style="margin-top: 1em">mesg <br>
[Default set]</p>

<p style="margin-top: 1em">If mesg is set, the permission
for others to use the write or talk commands to write to the
terminal shall be turned on while in open or visual mode.
The shell-level command mesg <br>
n shall take precedence over any setting of the ex mesg
option; that is, if mesg y was issued before the editor
started (or in a shell escape), such as:</p>

<p style="margin-top: 1em">:!mesg y</p>

<p style="margin-top: 1em">the mesg option in ex shall
suppress incoming messages, but the mesg option shall not
enable incoming messages if mesg n was issued.</p>

<p style="margin-top: 1em">number, nu <br>
[Default unset]</p>

<p style="margin-top: 1em">If number is set, edit buffer
lines written while in ex command mode shall be written with
line numbers, in the format specified by the print command
with the # flag specified. <br>
In ex text input mode, each line shall be preceded by the
line number it will have in the file.</p>

<p style="margin-top: 1em">In open or visual mode, each
edit buffer line shall be displayed with a preceding line
number, in the format specified by the ex print command with
the # flag specified. This <br>
line number shall not be considered part of the line for the
purposes of evaluating the current column; that is, column
position 1 shall be the first column position after the <br>
format specified by the print command.</p>

<p style="margin-top: 1em">paragraphs, para <br>
[Default in the POSIX locale IPLPPPQPP LIpplpipbp]</p>

<p style="margin-top: 1em">The paragraphs edit option shall
define additional paragraph boundaries for the open and
visual mode commands. The paragraphs edit option can be set
to a character string con&acirc; <br>
sisting of zero or more character pairs. It shall be an
error to set it to an odd number of characters.</p>

<p style="margin-top: 1em">prompt <br>
[Default set]</p>

<p style="margin-top: 1em">If prompt is set, ex command
mode input shall be prompted for with a colon (
&rsquo;:&rsquo; ); when unset, no prompt shall be
written.</p>

<p style="margin-top: 1em">readonly <br>
[Default see text]</p>

<p style="margin-top: 1em">If the readonly edit option is
set, read-only mode shall be enabled (see Write ). The
readonly edit option shall be initialized to set if either
of the following conditions are <br>
true:</p>

<p style="margin-top: 1em">* The command-line option -R was
specified.</p>

<p style="margin-top: 1em">* Performing actions equivalent
to the access() function called with the following arguments
indicates that the file lacks write permission:</p>

<p style="margin-top: 1em">1. The current pathname is used
as the path argument.</p>

<p style="margin-top: 1em">2. The constant W_OK is used as
the amode argument.</p>

<p style="margin-top: 1em">The readonly edit option may be
initialized to set for other, implementation-defined
reasons. The readonly edit option shall not be initialized
to unset based on any special <br>
privileges of the user or process. The readonly edit option
shall be reinitialized each time that the contents of the
edit buffer are replaced (for example, by an edit or next
<br>
command) unless the user has explicitly set it, in which
case it shall remain set until the user explicitly unsets
it. Once unset, it shall again be reinitialized each time
that <br>
the contents of the edit buffer are replaced.</p>

<p style="margin-top: 1em">redraw <br>
[Default unset]</p>

<p style="margin-top: 1em">The editor simulates an
intelligent terminal on a dumb terminal. (Since this is
likely to require a large amount of output to the terminal,
it is useful only at high transmission <br>
speeds.)</p>

<p style="margin-top: 1em">remap <br>
[Default set]</p>

<p style="margin-top: 1em">If remap is set, map translation
shall allow for maps defined in terms of other maps;
translation shall continue until a final product is
obtained. If unset, only a one-step <br>
translation shall be done.</p>

<p style="margin-top: 1em">report <br>
[Default 5]</p>

<p style="margin-top: 1em">The value of this report edit
option specifies what number of lines being added, copied,
deleted, or modified in the edit buffer will cause an
informational message to be written <br>
to the user. The following conditions shall cause an
informational message. The message shall contain the number
of lines added, copied, deleted, or modified, but is
otherwise <br>
unspecified.</p>

<p style="margin-top: 1em">* An ex or vi editor command,
other than open, undo, or visual, that modifies at least the
value of the report edit option number of lines, and which
is not part of an ex global <br>
or v command, or ex or vi buffer execution, shall cause an
informational message to be written.</p>

<p style="margin-top: 1em">* An ex yank or vi y or Y
command, that copies at least the value of the report edit
option plus 1 number of lines, and which is not part of an
ex global or v command, or ex or <br>
vi buffer execution, shall cause an informational message to
be written.</p>

<p style="margin-top: 1em">* An ex global, v, open, undo,
or visual command or ex or vi buffer execution, that adds or
deletes a total of at least the value of the report edit
option number of lines, and <br>
which is not part of an ex global or v command, or ex or vi
buffer execution, shall cause an informational message to be
written. (For example, if 3 lines were added and 8 <br>
lines deleted during an ex visual command, 5 would be the
number compared against the report edit option after the
command completed.)</p>

<p style="margin-top: 1em">scroll, scr <br>
[Default (number of lines in the display -1)/2]</p>

<p style="margin-top: 1em">The value of the scroll edit
option shall determine the number of lines scrolled by the
ex &lt;control&gt;-D and z commands. For the vi
&lt;control&gt;-D and &lt;control&gt;-U commands, it shall
<br>
be the initial number of lines to scroll when no previous
&lt;control&gt;-D or &lt;control&gt;-U command has been
executed.</p>

<p style="margin-top: 1em">sections <br>
[Default in the POSIX locale NHSHH HUnhsh]</p>

<p style="margin-top: 1em">The sections edit option shall
define additional section boundaries for the open and visual
mode commands. The sections edit option can be set to a
character string consisting of <br>
zero or more character pairs; it shall be an error to set it
to an odd number of characters.</p>

<p style="margin-top: 1em">shell, sh <br>
[Default from the environment variable SHELL ]</p>

<p style="margin-top: 1em">The value of this option shall
be a string. The default shall be taken from the SHELL
environment variable. If the SHELL environment variable is
null or empty, the sh (see sh ) <br>
utility shall be the default.</p>

<p style="margin-top: 1em">shiftwidth, sw <br>
[Default 8]</p>

<p style="margin-top: 1em">The value of this option shall
give the width in columns of an indentation level used
during autoindentation and by the shift commands ( &lt; and
&gt;).</p>

<p style="margin-top: 1em">showmatch, sm <br>
[Default unset]</p>

<p style="margin-top: 1em">The functionality described for
the showmatch edit option need not be supported on
block-mode terminals or terminals with insufficient
capabilities.</p>

<p style="margin-top: 1em">If showmatch is set, in open or
visual mode, when a &rsquo;)&rsquo; or &rsquo;}&rsquo; is
typed, if the matching &rsquo;(&rsquo; or &rsquo;{&rsquo; is
currently visible on the display, the matching
&rsquo;(&rsquo; or &rsquo;{&rsquo; shall be flagged <br>
moving the cursor to its location for an unspecified amount
of time.</p>

<p style="margin-top: 1em">showmode <br>
[Default unset]</p>

<p style="margin-top: 1em">If showmode is set, in open or
visual mode, the current mode that the editor is in shall be
displayed on the last line of the display. Command mode and
text input mode shall be <br>
differentiated; other unspecified modes and
implementation-defined information may be displayed.</p>

<p style="margin-top: 1em">slowopen <br>
[Default unset]</p>

<p style="margin-top: 1em">If slowopen is set during open
and visual text input modes, the editor shall not update
portions of the display other than those display line
columns that display the characters <br>
entered by the user (see Input Mode Commands in vi ).</p>

<p style="margin-top: 1em">tabstop, ts <br>
[Default 8]</p>

<p style="margin-top: 1em">The value of this edit option
shall specify the column boundary used by a &lt;tab&gt; in
the display (see autoprint, ap and Input Mode Commands in vi
).</p>

<p style="margin-top: 1em">taglength, tl <br>
[Default zero]</p>

<p style="margin-top: 1em">The value of this edit option
shall specify the maximum number of characters that are
considered significant in the user-specified tag name and in
the tag name from the tags <br>
file. If the value is zero, all characters in both tag names
shall be significant.</p>

<p style="margin-top: 1em">tags <br>
[Default see text]</p>

<p style="margin-top: 1em">The value of this edit option
shall be a string of &lt;blank&gt;-delimited pathnames of
files used by the tag command. The default value is
unspecified.</p>

<p style="margin-top: 1em">term <br>
[Default from the environment variable TERM ]</p>

<p style="margin-top: 1em">The value of this edit option
shall be a string. The default shall be taken from the TERM
variable in the environment. If the TERM environment
variable is empty or null, the <br>
default is unspecified. The editor shall use the value of
this edit option to determine the type of the display
device.</p>

<p style="margin-top: 1em">The results are unspecified if
the user changes the value of the term edit option after
editor initialization.</p>

<p style="margin-top: 1em">terse <br>
[Default unset]</p>

<p style="margin-top: 1em">If terse is set, error messages
may be less verbose. However, except for this caveat, error
messages are unspecified. Furthermore, not all error
messages need change for differ&acirc; <br>
ent settings of this option.</p>

<p style="margin-top: 1em">warn <br>
[Default set]</p>

<p style="margin-top: 1em">If warn is set, and the contents
of the edit buffer have been modified since they were last
completely written, the editor shall write a warning message
before certain ! commands <br>
(see Escape ).</p>

<p style="margin-top: 1em">window <br>
[Default see text]</p>

<p style="margin-top: 1em">A value used in open and visual
mode, by the &lt;control&gt;-B and &lt;control&gt;-F
commands, and, in visual mode, to specify the number of
lines displayed when the screen is repainted.</p>

<p style="margin-top: 1em">If the -w command-line option is
not specified, the default value shall be set to the value
of the LINES environment variable. If the LINES environment
variable is empty or null, <br>
the default shall be the number of lines in the display
minus 1.</p>

<p style="margin-top: 1em">Setting the window edit option
to zero or to a value greater than the number of lines in
the display minus 1 (either explicitly or based on the -w
option or the LINES environment <br>
variable) shall cause the window edit option to be set to
the number of lines in the display minus 1.</p>

<p style="margin-top: 1em">The baud rate of the terminal
line may change the default in an implementation-defined
manner.</p>

<p style="margin-top: 1em">wrapmargin, wm <br>
[Default 0]</p>

<p style="margin-top: 1em">If the value of this edit option
is zero, it shall have no effect.</p>

<p style="margin-top: 1em">If not in the POSIX locale, the
effect of this edit option is implementation-defined.</p>

<p style="margin-top: 1em">Otherwise, it shall specify a
number of columns from the ending margin of the
terminal.</p>

<p style="margin-top: 1em">During open and visual text
input modes, for each character for which any part of the
character is displayed in a column that is less than
wrapmargin columns from the ending mar&acirc; <br>
gin of the display line, the editor shall behave as
follows:</p>

<p style="margin-top: 1em">1. If the character triggering
this event is a &lt;blank&gt;, it, and all immediately
preceding &lt;blank&gt;s on the current line entered during
the execution of the current text input <br>
command, shall be discarded, and the editor shall behave as
if the user had entered a single &lt;newline&gt; instead. In
addition, if the next user-entered character is a
&lt;space&gt;, <br>
it shall be discarded as well.</p>

<p style="margin-top: 1em">2. Otherwise, if there are one
or more &lt;blank&gt;s on the current line immediately
preceding the last group of inserted non- &lt;blank&gt;s
which was entered during the execution of the <br>
current text input command, the &lt;blank&gt;s shall be
replaced as if the user had entered a single &lt;newline&gt;
instead.</p>

<p style="margin-top: 1em">If the autoindent edit option is
set, and the events described in 1. or 2. are performed, any
&lt;blank&gt;s at or after the cursor in the current line
shall be discarded.</p>

<p style="margin-top: 1em">The ending margin shall be
determined by the system or overridden by the user, as
described for COLUMNS in the ENVIRONMENT VARIABLES section
and the Base Definitions volume of <br>
IEEE Std 1003.1-2001, Chapter 8, Environment Variables.</p>

<p style="margin-top: 1em">wrapscan, ws <br>
[Default set]</p>

<p style="margin-top: 1em">If wrapscan is set, searches
(the ex / or ? addresses, or open and visual mode /, ?, N,
and n commands) shall wrap around the beginning or end of
the edit buffer; when unset, <br>
searches shall stop at the beginning or end of the edit
buffer.</p>

<p style="margin-top: 1em">writeany, wa <br>
[Default unset]</p>

<p style="margin-top: 1em">If writeany is set, some of the
checks performed when executing the ex write commands shall
be inhibited, as described in editor option autowrite.</p>

<p style="margin-top: 1em">EXIT STATUS <br>
The following exit values shall be returned:</p>

<p style="margin-top: 1em">0 Successful completion.</p>

<p style="margin-top: 1em">&gt;0 An error occurred.</p>

<p style="margin-top: 1em">CONSEQUENCES OF ERRORS <br>
When any error is encountered and the standard input is not
a terminal device file, ex shall not write the file or
return to command or text input mode, and shall terminate
with <br>
a non-zero exit status.</p>

<p style="margin-top: 1em">Otherwise, when an unrecoverable
error is encountered, it shall be equivalent to a SIGHUP
asynchronous event.</p>

<p style="margin-top: 1em">Otherwise, when an error is
encountered, the editor shall behave as specified in Command
Line Parsing in ex .</p>

<p style="margin-top: 1em">The following sections are
informative.</p>

<p style="margin-top: 1em">APPLICATION USAGE <br>
If a SIGSEGV signal is received while ex is saving a file,
the file might not be successfully saved.</p>

<p style="margin-top: 1em">The next command can accept more
than one file, so usage such as:</p>

<p style="margin-top: 1em">next &lsquo;ls [abc]*&lsquo;</p>

<p style="margin-top: 1em">is valid; it would not be valid
for the edit or read commands, for example, because they
expect only one file and unspecified results occur.</p>

<p style="margin-top: 1em">EXAMPLES <br>
None.</p>

<p style="margin-top: 1em">RATIONALE <br>
The ex/ vi specification is based on the historical practice
found in the 4 BSD and System V implementations of ex and
vi. A freely redistributable implementation of ex/ vi, <br>
which is tracking IEEE Std 1003.1-2001 fairly closely, and
demonstrates the intended changes between historical
implementations and IEEE Std 1003.1-2001, may be obtained by
<br>
anonymous FTP from:</p>


<p style="margin-top: 1em">ftp://ftp.rdg.opengroup.org/pub/mirrors/nvi</p>

<p style="margin-top: 1em">A restricted editor (both the
historical red utility and modifications to ex) were
considered and rejected for inclusion. Neither option
provided the level of security that users <br>
might expect.</p>

<p style="margin-top: 1em">It is recognized that ex visual
mode and related features would be difficult, if not
impossible, to implement satisfactorily on a block-mode
terminal, or a terminal without any <br>
form of cursor addressing; thus, it is not a mandatory
requirement that such features should work on all terminals.
It is the intention, however, that an ex implementation
should <br>
provide the full set of capabilities on all terminals
capable of supporting them.</p>

<p style="margin-top: 1em">Options <br>
The -c replacement for + command was inspired by the -e
option of sed. Historically, all such commands (see edit and
next as well) were executed from the last line of the edit
<br>
buffer. This meant, for example, that &quot;+/pattern&quot;
would fail unless the wrapscan option was set. IEEE Std
1003.1-2001 requires conformance to historical practice.
Historically, <br>
some implementations restricted the ex commands that could
be listed as part of the command line arguments. For
consistency, IEEE Std 1003.1-2001 does not permit these
restric&acirc; <br>
tions.</p>

<p style="margin-top: 1em">In historical implementations of
the editor, the -R option (and the readonly edit option)
only prevented overwriting of files; appending to files was
still permitted, mapping <br>
loosely into the csh noclobber variable. Some
implementations, however, have not followed this semantic,
and readonly does not permit appending either. IEEE Std
1003.1-2001 fol&acirc; <br>
lows the latter practice, believing that it is a more
obvious and intuitive meaning of readonly.</p>

<p style="margin-top: 1em">The -s option suppresses all
interactive user feedback and is useful for editing scripts
in batch jobs. The list of specific effects is historical
practice. The terminal type <br>
&quot;incapable of supporting open and visual modes&quot;
has historically been named &quot;dumb&quot;.</p>

<p style="margin-top: 1em">The -t option was required
because the ctags utility appears in IEEE Std 1003.1-2001
and the option is available in all historical
implementations of ex.</p>

<p style="margin-top: 1em">Historically, the ex and vi
utilities accepted a -x option, which did encryption based
on the algorithm found in the historical crypt utility. The
-x option for encryption, and <br>
the associated crypt utility, were omitted because the
algorithm used was not specifiable and the export control
laws of some nations make it difficult to export
cryptographic <br>
technology. In addition, it did not historically provide the
level of security that users might expect.</p>

<p style="margin-top: 1em">Standard Input <br>
An end-of-file condition is not equivalent to an end-of-file
character. A common end-of-file character,
&lt;control&gt;-D, is historically an ex command.</p>

<p style="margin-top: 1em">There was no maximum line length
in historical implementations of ex. Specifically, as it was
parsed in chunks, the addresses had a different maximum
length than the filenames. <br>
Further, the maximum line buffer size was declared as
BUFSIZ, which was different lengths on different systems.
This version selected the value of {LINE_MAX} to impose a
reason&acirc; <br>
able restriction on portable usage of ex and to aid test
suite writers in their development of realistic tests that
exercise this limit.</p>

<p style="margin-top: 1em">Input Files <br>
It was an explicit decision by the standard developers that
a &lt;newline&gt; be added to any file lacking one. It was
believed that this feature of ex and vi was relied on by
users in <br>
order to make text files lacking a trailing &lt;newline&gt;
more portable. It is recognized that this will require a
user-specified option or extension for implementations that
permit <br>
ex and vi to edit files of type other than text if such
files are not otherwise identified by the system. It was
agreed that the ability to edit files of arbitrary type can
be <br>
useful, but it was not considered necessary to mandate that
an ex or vi implementation be required to handle files other
than text files.</p>

<p style="margin-top: 1em">The paragraph in the INPUT FILES
section, &quot;By default, ...&quot;, is intended to close a
long-standing security problem in ex and vi; that of the
&quot;modeline&quot; or &quot;modelines&quot; edit <br>
option. This feature allows any line in the first or last
five lines of the file containing the strings
&quot;ex:&quot; or &quot;vi:&quot; (and, apparently,
&quot;ei:&quot; or &quot;vx:&quot; ) to be a line containing
<br>
editor commands, and ex interprets all the text up to the
next &rsquo;:&rsquo; or &lt;newline&gt; as a command.
Consider the consequences, for example, of an unsuspecting
user using ex or vi as <br>
the editor when replying to a mail message in which a line
such as:</p>

<p style="margin-top: 1em">ex:! rm -rf :</p>

<p style="margin-top: 1em">appeared in the signature lines.
The standard developers believed strongly that an editor
should not by default interpret any lines of a file. Vendors
are strongly urged to <br>
delete this feature from their implementations of ex and
vi.</p>

<p style="margin-top: 1em">Asynchronous Events <br>
The intention of the phrase &quot;complete write&quot; is
that the entire edit buffer be written to stable storage.
The note regarding temporary files is intended for
implementations that <br>
use temporary files to back edit buffers unnamed by the
user.</p>

<p style="margin-top: 1em">Historically, SIGQUIT was
ignored by ex, but was the equivalent of the Q command in
visual mode; that is, it exited visual mode and entered ex
mode. IEEE Std 1003.1-2001 permits, <br>
but does not require, this behavior. Historically, SIGINT
was often used by vi users to terminate text input mode (
&lt;control&gt;-C is often easier to enter than
&lt;ESC&gt;). Some imple&acirc; <br>
mentations of vi alerted the terminal on this event, and
some did not. IEEE Std 1003.1-2001 requires that SIGINT
behave identically to &lt;ESC&gt;, and that the terminal not
be <br>
alerted.</p>

<p style="margin-top: 1em">Historically, suspending the ex
editor during text input mode was similar to SIGINT, as
completed lines were retained, but any partial line
discarded, and the editor returned to <br>
command mode. IEEE Std 1003.1-2001 is silent on this issue;
implementations are encouraged to follow historical
practice, where possible.</p>

<p style="margin-top: 1em">Historically, the vi editor did
not treat SIGTSTP as an asynchronous event, and it was
therefore impossible to suspend the editor in visual text
input mode. There are two major <br>
reasons for this. The first is that SIGTSTP is a broadcast
signal on UNIX systems, and the chain of events where the
shell execs an application that then execs vi usually caused
<br>
confusion for the terminal state if SIGTSTP was delivered to
the process group in the default manner. The second was that
most implementations of the UNIX curses package are not <br>
reentrant, and the receipt of SIGTSTP at the wrong time will
cause them to crash. IEEE Std 1003.1-2001 is silent on this
issue; implementations are encouraged to treat suspen&acirc;
<br>
sion as an asynchronous event if possible.</p>

<p style="margin-top: 1em">Historically, modifications to
the edit buffer made before SIGINT interrupted an operation
were retained; that is, anywhere from zero to all of the
lines to be modified might <br>
have been modified by the time the SIGINT arrived. These
changes were not discarded by the arrival of SIGINT. IEEE
Std 1003.1-2001 permits this behavior, noting that the undo
<br>
command is required to be able to undo these partially
completed commands.</p>

<p style="margin-top: 1em">The action taken for signals
other than SIGINT, SIGCONT, SIGHUP, and SIGTERM is
unspecified because some implementations attempt to save the
edit buffer in a useful state when <br>
other signals are received.</p>

<p style="margin-top: 1em">Standard Error <br>
For ex/ vi, diagnostic messages are those messages reported
as a result of a failed attempt to invoke ex or vi, such as
invalid options or insufficient resources, or an abnormal
<br>
termination condition. Diagnostic messages should not be
confused with the error messages generated by inappropriate
or illegal user commands.</p>

<p style="margin-top: 1em">Initialization in ex and vi <br>
If an ex command (other than cd, chdir, or source) has a
filename argument, one or both of the alternate and current
pathnames will be set. Informally, they are set as
follows:</p>

<p style="margin-top: 1em">1. If the ex command is one that
replaces the contents of the edit buffer, and it succeeds,
the current pathname will be set to the filename argument
(the first filename argu&acirc; <br>
ment in the case of the next command) and the alternate
pathname will be set to the previous current pathname, if
there was one.</p>

<p style="margin-top: 1em">2. In the case of the file
read/write forms of the read and write commands, if there is
no current pathname, the current pathname will be set to the
filename argument.</p>

<p style="margin-top: 1em">3. Otherwise, the alternate
pathname will be set to the filename argument.</p>

<p style="margin-top: 1em">For example, :edit foo and
:recover foo, when successful, set the current pathname,
and, if there was a previous current pathname, the alternate
pathname. The commands :write, <br>
!command, and :edit set neither the current or alternate
pathnames. If the :edit foo command were to fail for some
reason, the alternate pathname would be set. The read and
write <br>
commands set the alternate pathname to their file argument,
unless the current pathname is not set, in which case they
set the current pathname to their file arguments. The <br>
alternate pathname was not historically set by the :source
command. IEEE Std 1003.1-2001 requires conformance to
historical practice. Implementations adding commands that
take <br>
filenames as arguments are encouraged to set the alternate
pathname as described here.</p>

<p style="margin-top: 1em">Historically, ex and vi read the
.exrc file in the $HOME directory twice, if the editor was
executed in the $HOME directory. IEEE Std 1003.1-2001
prohibits this behavior.</p>

<p style="margin-top: 1em">Historically, the 4 BSD ex and
vi read the $HOME and local .exrc files if they were owned
by the real ID of the user, or the sourceany option was set,
regardless of other consid&acirc; <br>
erations. This was a security problem because it is possible
to put normal UNIX system commands inside a .exrc file. IEEE
Std 1003.1-2001 does not specify the sourceany option, <br>
and historical implementations are encouraged to delete
it.</p>

<p style="margin-top: 1em">The .exrc files must be owned by
the real ID of the user, and not writable by anyone other
than the owner. The appropriate privileges exception is
intended to permit users to <br>
acquire special privileges, but continue to use the .exrc
files in their home directories.</p>

<p style="margin-top: 1em">System V Release 3.2 and later
vi implementations added the option [no]exrc. The behavior
is that local .exrc files are read-only if the exrc option
is set. The default for the <br>
exrc option was off, so by default, local .exrc files were
not read. The problem this was intended to solve was that
System V permitted users to give away files, so there is no
<br>
possible ownership or writeability test to ensure that the
file is safe. This is still a security problem on systems
where users can give away files, but there is nothing
addi&acirc; <br>
tional that IEEE Std 1003.1-2001 can do. The
implementation-defined exception is intended to permit
groups to have local .exrc files that are shared by users,
by creating pseudo- <br>
users to own the shared files.</p>

<p style="margin-top: 1em">IEEE Std 1003.1-2001 does not
mention system-wide ex and vi start-up files. While they
exist in several implementations of ex and vi, they are not
present in any implementations <br>
considered historical practice by IEEE Std 1003.1-2001.
Implementations that have such files should use them only if
they are owned by the real user ID or an appropriate user
<br>
(for example, root on UNIX systems) and if they are not
writable by any user other than their owner. System-wide
start-up files should be read before the EXINIT variable,
<br>
$HOME/.exrc, or local .exrc files are evaluated.</p>

<p style="margin-top: 1em">Historically, any ex command
could be entered in the EXINIT variable or the .exrc file,
although ones requiring that the edit buffer already contain
lines of text generally <br>
caused historical implementations of the editor to drop
core. IEEE Std 1003.1-2001 requires that any ex command be
permitted in the EXINIT variable and .exrc files, for
simplic&acirc; <br>
ity of specification and consistency, although many of them
will obviously fail under many circumstances.</p>

<p style="margin-top: 1em">The initialization of the
contents of the edit buffer uses the phrase &quot;the effect
shall be&quot; with regard to various ex commands. The
intent of this phrase is that edit buffer con&acirc; <br>
tents loaded during the initialization phase not be lost;
that is, loading the edit buffer should fail if the .exrc
file read in the contents of a file and did not subsequently
<br>
write the edit buffer. An additional intent of this phrase
is to specify that the initial current line and column is
set as specified for the individual ex commands.</p>

<p style="margin-top: 1em">Historically, the -t option
behaved as if the tag search were a + command; that is, it
was executed from the last line of the file specified by the
tag. This resulted in the <br>
search failing if the pattern was a forward search pattern
and the wrapscan edit option was not set. IEEE Std
1003.1-2001 does not permit this behavior, requiring that
the search <br>
for the tag pattern be performed on the entire file, and, if
not found, that the current line be set to a more reasonable
location in the file.</p>

<p style="margin-top: 1em">Historically, the empty edit
buffer presented for editing when a file was not specified
by the user was unnamed. This is permitted by IEEE Std
1003.1-2001; however, implementa&acirc; <br>
tions are encouraged to provide users a temporary filename
for this buffer because it permits them the use of ex
commands that use the current pathname during temporary edit
ses&acirc; <br>
sions.</p>

<p style="margin-top: 1em">Historically, the file specified
using the -t option was not part of the current argument
list. This practice is permitted by IEEE Std 1003.1-2001;
however, implementations are <br>
encouraged to include its name in the current argument list
for consistency.</p>

<p style="margin-top: 1em">Historically, the -c command was
generally not executed until a file that already exists was
edited. IEEE Std 1003.1-2001 requires conformance to this
historical practice. Com&acirc; <br>
mands that could cause the -c command to be executed include
the ex commands edit, next, recover, rewind, and tag, and
the vi commands &lt;control&gt;-^ and &lt;control&gt;-].
Historically, <br>
reading a file into an edit buffer did not cause the -c
command to be executed (even though it might set the current
pathname) with the exception that it did cause the -c
command <br>
to be executed if: the editor was in ex mode, the edit
buffer had no current pathname, the edit buffer was empty,
and no read commands had yet been attempted. For consistency
and <br>
simplicity of specification, IEEE Std 1003.1-2001 does not
permit this behavior.</p>

<p style="margin-top: 1em">Historically, the -r option was
the same as a normal edit session if there was no recovery
information available for the file. This allowed users to
enter:</p>

<p style="margin-top: 1em">vi -r *.c</p>

<p style="margin-top: 1em">and recover whatever files were
recoverable. In some implementations, recovery was attempted
only on the first file named, and the file was not entered
into the argument list; in <br>
others, recovery was attempted for each file named. In
addition, some historical implementations ignored -r if -t
was specified or did not support command line file arguments
<br>
with the -t option. For consistency and simplicity of
specification, IEEE Std 1003.1-2001 disallows these special
cases, and requires that recovery be attempted the first
time <br>
each file is edited.</p>

<p style="margin-top: 1em">Historically, vi initialized the
&lsquo; and &rsquo; marks, but ex did not. This meant that
if the first command in ex mode was visual or if an ex
command was executed first (for example, <br>
vi +10 file), vi was entered without the marks being
initialized. Because the standard developers believed the
marks to be generally useful, and for consistency and
simplicity of <br>
specification, IEEE Std 1003.1-2001 requires that they
always be initialized if in open or visual mode, or if in ex
mode and the edit buffer is not empty. Not initializing it
in <br>
ex mode if the edit buffer is empty is historical practice;
however, it has always been possible to set (and use) marks
in empty edit buffers in open and visual mode edit
ses&acirc; <br>
sions.</p>

<p style="margin-top: 1em">Addressing <br>
Historically, ex and vi accepted the additional addressing
forms &rsquo;&rsquo; and &rsquo; IEEE Std 1003.1-2001,
mostly because nobody can remember whether they ever did
anything different historically.</p>

<p style="margin-top: 1em">Historically, ex and vi
permitted an address of zero for several commands, and
permitted the % address in empty files for others. For
consistency, IEEE Std 1003.1-2001 requires <br>
support for the former in the few commands where it makes
sense, and disallows it otherwise. In addition, because IEEE
Std 1003.1-2001 requires that % be logically equivalent to
<br>
&quot;1,$&quot;, it is also supported where it makes sense
and disallowed otherwise.</p>

<p style="margin-top: 1em">Historically, the % address
could not be followed by further addresses. For consistency
and simplicity of specification, IEEE Std 1003.1-2001
requires that additional addresses <br>
be supported.</p>

<p style="margin-top: 1em">All of the following are valid
addresses:</p>

<p style="margin-top: 1em">+++ Three lines after the
current line.</p>

<p style="margin-top: 1em">/re/- One line before the next
occurrence of re.</p>

<p style="margin-top: 1em">-2 Two lines before the current
line.</p>

<p style="margin-top: 1em">3 ---- 2 <br>
Line one (note intermediate negative address).</p>

<p style="margin-top: 1em">1 2 3 Line six.</p>

<p style="margin-top: 1em">Any number of addresses can be
provided to commands taking addresses; for example,
&quot;1,2,3,4,5p&quot; prints lines 4 and 5, because two is
the greatest valid number of addresses <br>
accepted by the print command. This, in combination with the
semicolon delimiter, permits users to create commands based
on ordered patterns in the file. For example, the command
<br>
3;/foo/;+2print will display the first line after line 3
that contains the pattern foo, plus the next two lines. Note
that the address 3; must be evaluated before being discarded
<br>
because the search origin for the /foo/ command depends on
this.</p>

<p style="margin-top: 1em">Historically, values could be
added to addresses by including them after one or more
&lt;blank&gt;s; for example, 3 - 5p wrote the seventh line
of the file, and /foo/ 5 was the same as <br>
/foo/+5. However, only absolute values could be added; for
example, 5 /foo/ was an error. IEEE Std 1003.1-2001 requires
conformance to historical practice. Address offsets are <br>
separately specified from addresses because they could
historically be provided to visual mode search commands.</p>

<p style="margin-top: 1em">Historically, any missing
addresses defaulted to the current line. This was true for
leading and trailing comma-delimited addresses, and for
trailing semicolon-delimited <br>
addresses. For consistency, IEEE Std 1003.1-2001 requires it
for leading semicolon addresses as well.</p>

<p style="margin-top: 1em">Historically, ex and vi accepted
the &rsquo;^&rsquo; character as both an address and as a
flag offset for commands. In both cases it was identical to
the &rsquo;-&rsquo; character. IEEE Std 1003.1-2001 <br>
does not require or prohibit this behavior.</p>

<p style="margin-top: 1em">Historically, the enhancements
to basic regular expressions could be used in addressing;
for example, &rsquo;~&rsquo;, &rsquo;&lt;&rsquo;, and
&rsquo;&gt;&rsquo; . IEEE Std 1003.1-2001 requires
conformance to histori&acirc; <br>
cal practice; that is, that regular expression usage be
consistent, and that regular expression enhancements be
supported wherever regular expressions are used.</p>

<p style="margin-top: 1em">Command Line Parsing in ex <br>
Historical ex command parsing was even more complex than
that described here. IEEE Std 1003.1-2001 requires the
subset of the command parsing that the standard developers
<br>
believed was documented and that users could reasonably be
expected to use in a portable fashion, and that was
historically consistent between implementations. (The
discarded <br>
functionality is obscure, at best.) Historical
implementations will require changes in order to comply with
IEEE Std 1003.1-2001; however, users are not expected to
notice any of <br>
these changes. Most of the complexity in ex parsing is to
handle three special termination cases:</p>

<p style="margin-top: 1em">1. The !, global, v, and the
filter versions of the read and write commands are delimited
by &lt;newline&gt;s (they can contain vertical-line
characters that are usually shell pipes).</p>

<p style="margin-top: 1em">2. The ex, edit, next, and
visual in open and visual mode commands all take ex
commands, optionally containing vertical-line characters, as
their first arguments.</p>

<p style="margin-top: 1em">3. The s command takes a regular
expression as its first argument, and uses the delimiting
characters to delimit the command.</p>

<p style="margin-top: 1em">Historically, vertical-line
characters in the + command argument of the ex, edit, next,
vi, and visual commands, and in the pattern and replacement
parts of the s command, did <br>
not delimit the command, and in the filter cases for read
and write, and the !, global, and v commands, they did not
delimit the command at all. For example, the following
com&acirc; <br>
mands are all valid:</p>

<p style="margin-top: 1em">:edit +25 | s/abc/ABC/ file.c
<br>
:s/ | /PIPE/ <br>
:read !spell % | columnate <br>
:global/pattern/p | l <br>
:s/a/b/ | s/c/d | set</p>

<p style="margin-top: 1em">Historically, empty or
&lt;blank&gt; filled lines in .exrc files and sourced files
(as well as EXINIT variables and ex command scripts) were
treated as default commands; that is, print <br>
commands. IEEE Std 1003.1-2001 specifically requires that
they be ignored when encountered in .exrc and sourced files
to eliminate a common source of new user error.</p>

<p style="margin-top: 1em">Historically, ex commands with
multiple adjacent (or &lt;blank&gt;-separated) vertical
lines were handled oddly when executed from ex mode. For
example, the command ||| &lt;carriage- <br>
return&gt;, when the cursor was on line 1, displayed lines
2, 3, and 5 of the file. In addition, the command | would
only display the line after the next line, instead of the
next <br>
two lines. The former worked more logically when executed
from vi mode, and displayed lines 2, 3, and 4. IEEE Std
1003.1-2001 requires the vi behavior; that is, a single
default <br>
command and line number increment for each command
separator, and trailing &lt;newline&gt;s after vertical-line
separators are discarded.</p>

<p style="margin-top: 1em">Historically, ex permitted a
single extra colon as a leading command character; for
example, :g/pattern/:p was a valid command. IEEE Std
1003.1-2001 generalizes this to require <br>
that any number of leading colon characters be stripped.</p>

<p style="margin-top: 1em">Historically, any prefix of the
delete command could be followed without intervening
&lt;blank&gt;s by a flag character because in the command d
p, p is interpreted as the buffer p. <br>
IEEE Std 1003.1-2001 requires conformance to historical
practice.</p>

<p style="margin-top: 1em">Historically, the k command
could be followed by the mark name without intervening
&lt;blank&gt;s. IEEE Std 1003.1-2001 requires conformance to
historical practice.</p>

<p style="margin-top: 1em">Historically, the s command
could be immediately followed by flag and option characters;
for example, s/e/E/|s|sgc3p was a valid command. However,
flag characters could not stand <br>
alone; for example, the commands sp and s l would fail,
while the command sgp and s gl would succeed. (Obviously,
the &rsquo;#&rsquo; flag character was used as a delimiter
character if it <br>
followed the command.) Another issue was that option
characters had to precede flag characters even when the
command was fully specified; for example, the command
s/e/E/pg would <br>
fail, while the command s/e/E/gp would succeed. IEEE Std
1003.1-2001 requires conformance to historical practice.</p>

<p style="margin-top: 1em">Historically, the first command
name that had a prefix matching the input from the user was
the executed command; for example, ve, ver, and vers all
executed the version command. <br>
Commands were in a specific order, however, so that a
matched append, not abbreviate. IEEE Std 1003.1-2001
requires conformance to historical practice. The restriction
on com&acirc; <br>
mand search order for implementations with extensions is to
avoid the addition of commands such that the historical
prefixes would fail to work portably.</p>

<p style="margin-top: 1em">Historical implementations of ex
and vi did not correctly handle multiple ex commands,
separated by vertical-line characters, that entered or
exited visual mode or the editor. <br>
Because implementations of vi exist that do not exhibit this
failure mode, IEEE Std 1003.1-2001 does not permit it.</p>

<p style="margin-top: 1em">The requirement that alphabetic
command names consist of all following alphabetic characters
up to the next non-alphabetic character means that
alphabetic command names must be <br>
separated from their arguments by one or more non-alphabetic
characters, normally a &lt;blank&gt; or &rsquo;!&rsquo;
character, except as specified for the exceptions, the
delete, k, and s com&acirc; <br>
mands.</p>

<p style="margin-top: 1em">Historically, the repeated
execution of the ex default print commands (
&lt;control&gt;-D, eof, &lt;newline&gt;,
&lt;carriage-return&gt;) erased any prompting character and
displayed the next <br>
lines without scrolling the terminal; that is, immediately
below any previously displayed lines. This provided a
cleaner presentation of the lines in the file for the user.
<br>
IEEE Std 1003.1-2001 does not require this behavior because
it may be impossible in some situations; however,
implementations are strongly encouraged to provide this
semantic if <br>
possible.</p>

<p style="margin-top: 1em">Historically, it was possible to
change files in the middle of a command, and have the rest
of the command executed in the new file; for example:</p>

<p style="margin-top: 1em">:edit +25 file.c | s/abc/ABC/ |
1</p>

<p style="margin-top: 1em">was a valid command, and the
substitution was attempted in the newly edited file. IEEE
Std 1003.1-2001 requires conformance to historical practice.
The following commands are <br>
examples that exercise the ex parser:</p>

<p style="margin-top: 1em">echo &rsquo;foo | bar&rsquo;
&gt; file1; echo &rsquo;foo/bar&rsquo; &gt; file2; <br>
vi <br>
:edit +1 | s/|/PIPE/ | w file1 | e file2 | 1 | s//SLASH/ |
wq</p>

<p style="margin-top: 1em">Historically, there was no
protection in editor implementations to avoid ex global, v,
@, or * commands changing edit buffers during execution of
their associated commands. <br>
Because this would almost invariably result in catastrophic
failure of the editor, and implementations exist that do
exhibit these problems, IEEE Std 1003.1-2001 requires that
<br>
changing the edit buffer during a global or v command, or
during a @ or * command for which there will be more than a
single execution, be an error. Implementations supporting
<br>
multiple edit buffers simultaneously are strongly encouraged
to apply the same semantics to switching between buffers as
well.</p>

<p style="margin-top: 1em">The ex command quoting required
by IEEE Std 1003.1-2001 is a superset of the quoting in
historical implementations of the editor. For example, it
was not historically possible to <br>
escape a &lt;blank&gt; in a filename; for example, :edit
foo\&nbsp;bar would report that too many filenames had been
entered for the edit command, and there was no method of
escaping a <br>
&lt;blank&gt; in the first argument of an edit, ex, next, or
visual command at all. IEEE Std 1003.1-2001 extends
historical practice, requiring that quoting behavior be made
consistent <br>
across all ex commands, except for the map, unmap,
abbreviate, and unabbreviate commands, which historically
used &lt;control&gt;-V instead of backslashes for quoting.
For those four <br>
commands, IEEE Std 1003.1-2001 requires conformance to
historical practice.</p>

<p style="margin-top: 1em">Backslash quoting in ex is
non-intuitive. Backslash escapes are ignored unless they
escape a special character; for example, when performing
file argument expansion, the string <br>
&quot;\%&quot; is equivalent to &rsquo;&rsquo;, not
&quot;&lt;current pathname&gt;&quot;. This can be confusing
for users because backslash is usually one of the characters
that causes shell expansion to be per&acirc; <br>
formed, and therefore shell quoting rules must be taken into
consideration. Generally, quoting characters are only
considered if they escape a special character, and a quoting
<br>
character must be provided for each layer of parsing for
which the character is special. As another example, only a
single backslash is necessary for the &rsquo;equence in
substi&acirc; <br>
tute replacement patterns, because the character
&rsquo;l&rsquo; is not special to any parsing layer above
it.</p>

<p style="margin-top: 1em">&lt;control&gt;-V quoting in ex
is slightly different from backslash quoting. In the four
commands where &lt;control&gt;-V quoting applies (
abbreviate, unabbreviate, map, and unmap), any <br>
character may be escaped by a &lt;control&gt;-V whether it
would have a special meaning or not. IEEE Std 1003.1-2001
requires conformance to historical practice.</p>

<p style="margin-top: 1em">Historical implementations of
the editor did not require delimiters within character
classes to be escaped; for example, the command :s/[/]// on
the string &quot;xxx/yyy&quot; would delete <br>
the &rsquo;/&rsquo; from the string. IEEE Std 1003.1-2001
disallows this historical practice for consistency and
because it places a large burden on implementations by
requiring that knowl&acirc; <br>
edge of regular expressions be built into the editor
parser.</p>

<p style="margin-top: 1em">Historically, quoting
&lt;newline&gt;s in ex commands was handled inconsistently.
In most cases, the &lt;newline&gt; always terminated the
command, regardless of any preceding escape charac&acirc;
<br>
ter, because backslash characters did not escape
&lt;newline&gt;s for most ex commands. However, some ex
commands (for example, s, map, and abbreviation) permitted
&lt;newline&gt;s to be <br>
escaped (although in the case of map and abbreviation,
&lt;control&gt;-V characters escaped them instead of
backslashes). This was true in not only the command line,
but also .exrc and <br>
sourced files. For example, the command:</p>

<p style="margin-top: 1em">map =
foo&lt;control-V&gt;&lt;newline&gt;bar</p>

<p style="margin-top: 1em">would succeed, although it was
sometimes difficult to get the &lt;control&gt;-V and the
inserted &lt;newline&gt; passed to the ex parser. For
consistency and simplicity of specification, <br>
IEEE Std 1003.1-2001 requires that it be possible to escape
&lt;newline&gt;s in ex commands at all times, using
backslashes for most ex commands, and using
&lt;control&gt;-V characters for <br>
the map and abbreviation commands. For example, the command
print &lt;newline&gt; list is required to be parsed as the
single command print &lt;newline&gt; list. While this
differs from <br>
historical practice, IEEE Std 1003.1-2001 developers
believed it unlikely that any script or user depended on the
historical behavior.</p>

<p style="margin-top: 1em">Historically, an error in a
command specified using the -c option did not cause the rest
of the -c commands to be discarded. IEEE Std 1003.1-2001
disallows this for consistency <br>
with mapped keys, the @, global, source, and v commands, the
EXINIT environment variable, and the .exrc files.</p>

<p style="margin-top: 1em">Input Editing in ex <br>
One of the common uses of the historical ex editor is over
slow network connections. Editors that run in canonical mode
can require far less traffic to and from, and far less <br>
processing on, the host machine, as well as more easily
supporting block-mode terminals. For these reasons, IEEE Std
1003.1-2001 requires that ex be implemented using canonical
<br>
mode input processing, as was done historically.</p>

<p style="margin-top: 1em">IEEE Std 1003.1-2001 does not
require the historical 4 BSD input editing characters
&quot;word erase&quot; or &quot;literal next&quot;. For this
reason, it is unspecified how they are handled by ex, <br>
although they must have the required effect. Implementations
that resolve them after the line has been ended using a
&lt;newline&gt; or &lt;control&gt;-M character, and
implementations that <br>
rely on the underlying system terminal support for this
processing, are both conforming. Implementations are
strongly urged to use the underlying system functionality,
if at all <br>
possible, for compatibility with other system text input
interfaces.</p>

<p style="margin-top: 1em">Historically, when the eof
character was used to decrement the autoindent level, the
cursor moved to display the new end of the autoindent
characters, but did not move the cursor <br>
to a new line, nor did it erase the &lt;control&gt;-D
character from the line. IEEE Std 1003.1-2001 does not
specify that the cursor remain on the same line or that the
rest of the <br>
line is erased; however, implementations are strongly
encouraged to provide the best possible user interface; that
is, the cursor should remain on the same line, and any
&lt;con&acirc; <br>
trol&gt;-D character on the line should be erased.</p>

<p style="margin-top: 1em">IEEE Std 1003.1-2001 does not
require the historical 4 BSD input editing character
&quot;reprint&quot;, traditionally &lt;control&gt;-R, which
redisplayed the current input from the user. For <br>
this reason, and because the functionality cannot be
implemented after the line has been terminated by the user,
IEEE Std 1003.1-2001 makes no requirements about this
functional&acirc; <br>
ity. Implementations are strongly urged to make this
historical functionality available, if possible.</p>

<p style="margin-top: 1em">Historically, &lt;control&gt;-Q
did not perform a literal next function in ex, as it did in
vi. IEEE Std 1003.1-2001 requires conformance to historical
practice to avoid breaking his&acirc; <br>
torical ex scripts and .exrc files.</p>

<p style="margin-top: 1em">eof <br>
Whether the eof character immediately modifies the
autoindent characters in the prompt is left unspecified so
that implementations can conform in the presence of systems
that do <br>
not support this functionality. Implementations are
encouraged to modify the line and redisplay it immediately,
if possible.</p>

<p style="margin-top: 1em">The specification of the
handling of the eof character differs from historical
practice only in that eof characters are not discarded if
they follow normal characters in the text <br>
input. Historically, they were always discarded.</p>

<p style="margin-top: 1em">Command Descriptions in ex <br>
Historically, several commands (for example, global, v,
visual, s, write, wq, yank, !, &lt;, &gt;, &amp;, and ~)
were executable in empty files (that is, the default
address(es) were 0), <br>
or permitted explicit addresses of 0 (for example, 0 was a
valid address, or 0,0 was a valid range). Addresses of 0, or
command execution in an empty file, make sense only for <br>
commands that add new text to the edit buffer or write
commands (because users may wish to write empty files). IEEE
Std 1003.1-2001 requires this behavior for such commands and
<br>
disallows it otherwise, for consistency and simplicity of
specification.</p>

<p style="margin-top: 1em">A count to an ex command has
been historically corrected to be no greater than the last
line in a file; for example, in a five-line file, the
command 1,6print would fail, but the <br>
command 1print300 would succeed. IEEE Std 1003.1-2001
requires conformance to historical practice.</p>

<p style="margin-top: 1em">Historically, the use of flags
in ex commands could be obscure. General historical practice
was as described by IEEE Std 1003.1-2001, but there were
some special cases. For <br>
instance, the list, number, and print commands ignored
trailing address offsets; for example, 3p +++# would display
line 3, and 3 would be the current line after the execution
of <br>
the command. The open and visual commands ignored both the
trailing offsets and the trailing flags. Also, flags
specified to the open and visual commands interacted badly
with <br>
the list edit option, and setting and then unsetting it
during the open/visual session would cause vi to stop
displaying lines in the specified format. For consistency
and sim&acirc; <br>
plicity of specification, IEEE Std 1003.1-2001 does not
permit any of these exceptions to the general rule.</p>

<p style="margin-top: 1em">IEEE Std 1003.1-2001 uses the
word copy in several places when discussing buffers. This is
not intended to imply implementation.</p>

<p style="margin-top: 1em">Historically, ex users could not
specify numeric buffers because of the ambiguity this would
cause; for example, in the command 3 delete 2, it is unclear
whether 2 is a buffer <br>
name or a count. IEEE Std 1003.1-2001 requires conformance
to historical practice by default, but does not preclude
extensions.</p>

<p style="margin-top: 1em">Historically, the contents of
the unnamed buffer were frequently discarded after commands
that did not explicitly affect it; for example, when using
the edit command to switch <br>
files. For consistency and simplicity of specification, IEEE
Std 1003.1-2001 does not permit this behavior.</p>

<p style="margin-top: 1em">The ex utility did not
historically have access to the numeric buffers, and,
furthermore, deleting lines in ex did not modify their
contents. For example, if, after doing a <br>
delete in vi, the user switched to ex, did another delete,
and then switched back to vi, the contents of the numeric
buffers would not have changed. IEEE Std 1003.1-2001
requires <br>
conformance to historical practice. Numeric buffers are
described in the ex utility in order to confine the
description of buffers to a single location in IEEE Std
1003.1-2001.</p>

<p style="margin-top: 1em">The metacharacters that trigger
shell expansion in file arguments match historical practice,
as does the method for doing shell expansion.
Implementations wishing to provide <br>
users with the flexibility to alter the set of
metacharacters are encouraged to provide a shellmeta string
edit option.</p>

<p style="margin-top: 1em">Historically, ex commands
executed from vi refreshed the screen when it did not
strictly need to do so; for example, :!date &gt; /dev/null
does not require a screen refresh because <br>
the output of the UNIX date command requires only a single
line of the screen. IEEE Std 1003.1-2001 requires that the
screen be refreshed if it has been overwritten, but makes
<br>
no requirements as to how an implementation should make that
determination. Implementations may prompt and refresh the
screen regardless.</p>

<p style="margin-top: 1em">Abbreviate <br>
Historical practice was that characters that were entered as
part of an abbreviation replacement were subject to map
expansions, the showmatch edit option, further abbreviation
<br>
expansions, and so on; that is, they were logically pushed
onto the terminal input queue, and were not a simple
replacement. IEEE Std 1003.1-2001 requires conformance to
histori&acirc; <br>
cal practice. Historical practice was that whenever a
non-word character (that had not been escaped by a
&lt;control&gt;-V) was entered after a word character, vi
would check for <br>
abbreviations. The check was based on the type of the
character entered before the word character of the
word/non-word pair that triggered the check. The word
character of the <br>
word/non-word pair that triggered the check and all
characters entered before the trigger pair that were of that
type were included in the check, with the exception of
&lt;blank&gt;s, <br>
which always delimited the abbreviation.</p>

<p style="margin-top: 1em">This means that, for the
abbreviation to work, the lhs must end with a word
character, there can be no transitions from word to non-word
characters (or vice versa) other than <br>
between the last and next-to-last characters in the lhs, and
there can be no &lt;blank&gt;s in the lhs. In addition,
because of the historical quoting rules, it was impossible
to enter <br>
a literal &lt;control&gt;-V in the lhs. IEEE Std 1003.1-2001
requires conformance to historical practice. Historical
implementations did not inform users when abbreviations that
could <br>
never be used were entered; implementations are strongly
encouraged to do so.</p>

<p style="margin-top: 1em">For example, the following
abbreviations will work:</p>

<p style="margin-top: 1em">:ab (p REPLACE <br>
:ab p REPLACE <br>
:ab ((p REPLACE</p>

<p style="margin-top: 1em">The following abbreviations will
not work:</p>

<p style="margin-top: 1em">:ab ( REPLACE <br>
:ab (pp REPLACE</p>

<p style="margin-top: 1em">Historical practice is that
words on the vi colon command line were subject to
abbreviation expansion, including the arguments to the
abbrev (and more interestingly) the unabbrev <br>
command. Because there are implementations that do not do
abbreviation expansion for the first argument to those
commands, this is permitted, but not required, by <br>
IEEE Std 1003.1-2001. However, the following sequence:</p>

<p style="margin-top: 1em">:ab foo bar <br>
:ab foo baz</p>

<p style="margin-top: 1em">resulted in the addition of an
abbreviation of &quot;baz&quot; for the string
&quot;bar&quot; in historical ex/ vi, and the sequence:</p>

<p style="margin-top: 1em">:ab foo1 bar <br>
:ab foo2 bar <br>
:unabbreviate foo2</p>

<p style="margin-top: 1em">deleted the abbreviation
&quot;foo1&quot;, not &quot;foo2&quot; . These behaviors are
not permitted by IEEE Std 1003.1-2001 because they clearly
violate the expectations of the user.</p>

<p style="margin-top: 1em">It was historical practice that
&lt;control&gt;-V, not backslash, characters be interpreted
as escaping subsequent characters in the abbreviate command.
IEEE Std 1003.1-2001 requires <br>
conformance to historical practice; however, it should be
noted that an abbreviation containing a &lt;blank&gt; will
never work.</p>

<p style="margin-top: 1em">Append <br>
Historically, any text following a vertical-line command
separator after an append, change, or insert command became
part of the insert text. For example, in the command:</p>

<p style="margin-top: 1em">:g/pattern/append|stuff1</p>

<p style="margin-top: 1em">a line containing the text
&quot;stuff1&quot; would be appended to each line matching
pattern. It was also historically valid to enter:</p>

<p style="margin-top: 1em">:append|stuff1 <br>
stuff2 <br>
.</p>

<p style="margin-top: 1em">and the text on the ex command
line would be appended along with the text inserted after
it. There was an historical bug, however, that the user had
to enter two terminating <br>
lines (the &rsquo;.&rsquo; lines) to terminate text input
mode in this case. IEEE Std 1003.1-2001 requires conformance
to historical practice, but disallows the historical need
for multi&acirc; <br>
ple terminating lines.</p>

<p style="margin-top: 1em">Change <br>
See the RATIONALE for the append command. Historical
practice for cursor positioning after the change command
when no text is input, is as described in IEEE Std
1003.1-2001. How&acirc; <br>
ever, one System V implementation is known to have been
modified such that the cursor is positioned on the first
address specified, and not on the line before the first
address. <br>
IEEE Std 1003.1-2001 disallows this modification for
consistency.</p>

<p style="margin-top: 1em">Historically, the change command
did not support buffer arguments, although some
implementations allow the specification of an optional
buffer. This behavior is neither required <br>
nor disallowed by IEEE Std 1003.1-2001.</p>

<p style="margin-top: 1em">Change Directory <br>
A common extension in ex implementations is to use the
elements of a cdpath edit option as prefix directories for
path arguments to chdir that are relative pathnames and that
do <br>
not have &rsquo;.&rsquo; or &quot;..&quot; as their first
component. Elements in the cdpath edit option are
colon-separated. The initial value of the cdpath edit option
is the value of the shell <br>
CDPATH environment variable. This feature was not included
in IEEE Std 1003.1-2001 because it does not exist in any of
the implementations considered historical practice.</p>

<p style="margin-top: 1em">Copy <br>
Historical implementations of ex permitted copies to lines
inside of the specified range; for example, :2,5copy3 was a
valid command. IEEE Std 1003.1-2001 requires conformance to
<br>
historical practice.</p>

<p style="margin-top: 1em">Delete <br>
IEEE Std 1003.1-2001 requires support for the historical
parsing of a delete command followed by flags, without any
intervening &lt;blank&gt;s. For example:</p>

<p style="margin-top: 1em">1dp Deletes the first line and
prints the line that was second.</p>

<p style="margin-top: 1em">1delep As for 1dp.</p>

<p style="margin-top: 1em">1d Deletes the first line,
saving it in buffer p.</p>

<p style="margin-top: 1em">1d p1l (Pee-one-ell.) Deletes
the first line, saving it in buffer p, and listing the line
that was second.</p>

<p style="margin-top: 1em">Edit <br>
Historically, any ex command could be entered as a + command
argument to the edit command, although some (for example,
insert and append) were known to confuse historical
imple&acirc; <br>
mentations. For consistency and simplicity of specification,
IEEE Std 1003.1-2001 requires that any command be supported
as an argument to the edit command.</p>

<p style="margin-top: 1em">Historically, the command
argument was executed with the current line set to the last
line of the file, regardless of whether the edit command was
executed from visual mode or <br>
not. IEEE Std 1003.1-2001 requires conformance to historical
practice.</p>

<p style="margin-top: 1em">Historically, the + command
specified to the edit and next commands was delimited by the
first &lt;blank&gt;, and there was no way to quote them. For
consistency, IEEE Std 1003.1-2001 <br>
requires that the usual ex backslash quoting be
provided.</p>

<p style="margin-top: 1em">Historically, specifying the +
command argument to the edit command required a filename to
be specified as well; for example, :edit +100 would always
fail. For consistency and <br>
simplicity of specification, IEEE Std 1003.1-2001 does not
permit this usage to fail for that reason.</p>

<p style="margin-top: 1em">Historically, only the cursor
position of the last file edited was remembered by the
editor. IEEE Std 1003.1-2001 requires that this be
supported; however, implementations are <br>
permitted to remember and restore the cursor position for
any file previously edited.</p>

<p style="margin-top: 1em">File <br>
Historical versions of the ex editor file command displayed
a current line and number of lines in the edit buffer of 0
when the file was empty, while the vi &lt;control&gt;-G
command <br>
displayed a current line and number of lines in the edit
buffer of 1 in the same situation. IEEE Std 1003.1-2001 does
not permit this discrepancy, instead requiring that a
mes&acirc; <br>
sage be displayed indicating that the file is empty.</p>

<p style="margin-top: 1em">Global <br>
The two-pass operation of the global and v commands is not
intended to imply implementation, only the required result
of the operation.</p>

<p style="margin-top: 1em">The current line and column are
set as specified for the individual ex commands. This
requirement is cumulative; that is, the current line and
column must track across all the <br>
commands executed by the global or v commands.</p>

<p style="margin-top: 1em">Insert <br>
See the RATIONALE for the append command.</p>

<p style="margin-top: 1em">Historically, insert could not
be used with an address of zero; that is, not when the edit
buffer was empty. IEEE Std 1003.1-2001 requires that this
command behave consistently <br>
with the append command.</p>

<p style="margin-top: 1em">Join <br>
The action of the join command in relation to the special
characters is only defined for the POSIX locale because the
correct amount of white space after a period varies; in
Ja&acirc; <br>
panese none is required, in French only a single space, and
so on.</p>

<p style="margin-top: 1em">List <br>
The historical output of the list command was potentially
ambiguous. The standard developers believed correcting this
to be more important than adhering to historical practice,
<br>
and IEEE Std 1003.1-2001 requires unambiguous output.</p>

<p style="margin-top: 1em">Map <br>
Historically, command mode maps only applied to command
names; for example, if the character &rsquo;x&rsquo; was
mapped to &rsquo;y&rsquo;, the command fx searched for the
&rsquo;x&rsquo; character, not the &rsquo;y&rsquo; <br>
character. IEEE Std 1003.1-2001 requires this behavior.
Historically, entering &lt;control&gt;-V as the first
character of a vi command was an error. Several
implementations have <br>
extended the semantics of vi such that &lt;control&gt;-V
means that the subsequent command character is not mapped.
This is permitted, but not required, by IEEE Std
1003.1-2001. <br>
Regardless, using &lt;control&gt;-V to escape the second or
later character in a sequence of characters that might match
a map command, or any character in text input mode, is
histori&acirc; <br>
cal practice, and stops the entered keys from matching a
map. IEEE Std 1003.1-2001 requires conformance to historical
practice.</p>

<p style="margin-top: 1em">Historical implementations
permitted digits to be used as a map command lhs, but then
ignored the map. IEEE Std 1003.1-2001 requires that the
mapped digits not be ignored.</p>

<p style="margin-top: 1em">The historical implementation of
the map command did not permit map commands that were more
than a single character in length if the first character was
printable. This behavior <br>
is permitted, but not required, by IEEE Std 1003.1-2001.</p>

<p style="margin-top: 1em">Historically, mapped characters
were remapped unless the remap edit option was not set, or
the prefix of the mapped characters matched the mapping
characters; for example, in the <br>
map:</p>

<p style="margin-top: 1em">:map ab abcd</p>

<p style="margin-top: 1em">the characters &quot;ab&quot;
were used as is and were not remapped, but the characters
&quot;cd&quot; were mapped if appropriate. This can cause
infinite loops in the vi mapping mechanisms. <br>
IEEE Std 1003.1-2001 requires conformance to historical
practice, and that such loops be interruptible.</p>

<p style="margin-top: 1em">Text input maps had the same
problems with expanding the lhs for the ex map! and unmap!
command as did the ex abbreviate and unabbreviate commands.
See the RATIONALE for the ex <br>
abbreviate command. IEEE Std 1003.1-2001 requires similar
modification of some historical practice for the map and
unmap commands, as described for the abbreviate and
unabbrevi&acirc; <br>
ate commands.</p>

<p style="margin-top: 1em">Historically, maps that were
subsets of other maps behaved differently depending on the
order in which they were defined. For example:</p>

<p style="margin-top: 1em">:map! ab short <br>
:map! abc long</p>

<p style="margin-top: 1em">would always translate the
characters &quot;ab&quot; to &quot;short&quot;, regardless
of how fast the characters &quot;abc&quot; were entered. If
the entry order was reversed:</p>

<p style="margin-top: 1em">:map! abc long <br>
:map! ab short</p>

<p style="margin-top: 1em">the characters &quot;ab&quot;
would cause the editor to pause, waiting for the completing
&rsquo;c&rsquo; character, and the characters might never be
mapped to &quot;short&quot; . For consistency and
simplic&acirc; <br>
ity of specification, IEEE Std 1003.1-2001 requires that the
shortest match be used at all times.</p>

<p style="margin-top: 1em">The length of time the editor
spends waiting for the characters to complete the lhs is
unspecified because the timing capabilities of systems are
often inexact and variable, and <br>
it may depend on other factors such as the speed of the
connection. The time should be long enough for the user to
be able to complete the sequence, but not long enough for
the <br>
user to have to wait. Some implementations of vi have added
a keytime option, which permits users to set the number of
0,1 seconds the editor waits for the completing characters.
<br>
Because mapped terminal function and cursor keys tend to
start with an &lt;ESC&gt; character, and &lt;ESC&gt; is the
key ending vi text input mode, maps starting with
&lt;ESC&gt; characters are <br>
generally exempted from this timeout period, or, at least
timed out differently.</p>

<p style="margin-top: 1em">Mark <br>
Historically, users were able to set the &quot;previous
context&quot; marks explicitly. In addition, the ex commands
&quot; and &rsquo;&lsquo; and the vi commands &quot;,
&lsquo;&lsquo;, &lsquo;&rsquo;, and &rsquo;&lsquo; all
referred to the same <br>
mark. In addition, the previous context marks were not set
if the command, with which the address setting the mark was
associated, failed. IEEE Std 1003.1-2001 requires
confor&acirc; <br>
mance to historical practice. Historically, if marked lines
were deleted, the mark was also deleted, but would reappear
if the change was undone. IEEE Std 1003.1-2001 requires <br>
conformance to historical practice.</p>

<p style="margin-top: 1em">The description of the special
events that set the &lsquo; and &rsquo; marks matches
historical practice. For example, historically the command
/a/,/b/ did not set the &lsquo; and &rsquo; marks, but the
<br>
command /a/,/b/delete did.</p>

<p style="margin-top: 1em">Next <br>
Historically, any ex command could be entered as a + command
argument to the next command, although some (for example,
insert and append) were known to confuse historical
imple&acirc; <br>
mentations. IEEE Std 1003.1-2001 requires that any command
be permitted and that it behave as specified. The next
command can accept more than one file, so usage such as:</p>

<p style="margin-top: 1em">next &lsquo;ls [abc] &lsquo;</p>

<p style="margin-top: 1em">is valid; it need not be valid
for the edit or read commands, for example, because they
expect only one filename.</p>

<p style="margin-top: 1em">Historically, the next command
behaved differently from the :rewind command in that it
ignored the force flag if the autowrite flag was set. For
consistency, IEEE Std 1003.1-2001 <br>
does not permit this behavior.</p>

<p style="margin-top: 1em">Historically, the next command
positioned the cursor as if the file had never been edited
before, regardless. IEEE Std 1003.1-2001 does not permit
this behavior, for consistency <br>
with the edit command.</p>

<p style="margin-top: 1em">Implementations wanting to
provide a counterpart to the next command that edited the
previous file have used the command prev[ious], which takes
no file argument. <br>
IEEE Std 1003.1-2001 does not require this command.</p>

<p style="margin-top: 1em">Open <br>
Historically, the open command would fail if the open edit
option was not set. IEEE Std 1003.1-2001 does not mention
the open edit option and does not require this behavior.
<br>
Some historical implementations do not permit entering open
mode from open or visual mode, only from ex mode. For
consistency, IEEE Std 1003.1-2001 does not permit this
behavior.</p>

<p style="margin-top: 1em">Historically, entering open mode
from the command line (that is, vi +open) resulted in
anomalous behaviors; for example, the ex file and set
commands, and the vi command &lt;con&acirc; <br>
trol&gt;-G did not work. For consistency, IEEE Std
1003.1-2001 does not permit this behavior.</p>

<p style="margin-top: 1em">Historically, the open command
only permitted &rsquo;/&rsquo; characters to be used as the
search pattern delimiter. For consistency, IEEE Std
1003.1-2001 requires that the search delimiters <br>
used by the s, global, and v commands be accepted as
well.</p>

<p style="margin-top: 1em">Preserve <br>
The preserve command does not historically cause the file to
be considered unmodified for the purposes of future commands
that may exit the editor. IEEE Std 1003.1-2001 requires <br>
conformance to historical practice.</p>

<p style="margin-top: 1em">Historical documentation stated
that mail was not sent to the user when preserve was
executed; however, historical implementations did send mail
in this case. <br>
IEEE Std 1003.1-2001 requires conformance to the historical
implementations.</p>

<p style="margin-top: 1em">Print <br>
The writing of NUL by the print command is not specified as
a special case because the standard developers did not want
to require ex to support NUL characters. Historically, <br>
characters were displayed using the ARPA standard mappings,
which are as follows:</p>

<p style="margin-top: 1em">1. Printable characters are left
alone.</p>

<p style="margin-top: 1em">2. Control characters less than
177 are represented as &rsquo;^&rsquo; followed by the
character offset from the &rsquo;@&rsquo; character in the
ASCII map; for example, 07 is represented as
&rsquo;^G&rsquo; .</p>

<p style="margin-top: 1em">3. 177 is represented as
&rsquo;^&rsquo; followed by &rsquo;?&rsquo; .</p>

<p style="margin-top: 1em">The display of characters having
their eighth bit set was less standard. Existing
implementations use hex (0x00), octal ( 00), and a meta-bit
display. (The latter displayed <br>
bytes that had their eighth bit set as the two characters
&quot;M-&quot; followed by the seven-bit display as
described above.) The latter probably has the best claim to
historical prac&acirc; <br>
tice because it was used for the -v option of 4 BSD and 4
BSD-derived versions of the cat utility since 1980.</p>

<p style="margin-top: 1em">No specific display format is
required by IEEE Std 1003.1-2001.</p>

<p style="margin-top: 1em">Explicit dependence on the ASCII
character set has been avoided where possible, hence the use
of the phrase an &quot;implementation-defined
multi-character sequence&quot; for the display <br>
of non-printable characters in preference to the historical
usage of, for instance, &quot;^I&quot; for the &lt;tab&gt;.
Implementations are encouraged to conform to historical
practice in the <br>
absence of any strong reason to diverge.</p>

<p style="margin-top: 1em">Historically, all ex commands
beginning with the letter &rsquo;p&rsquo; could be entered
using capitalized versions of the commands; for example,
P[rint], Pre[serve], and Pu[t] were all <br>
valid command names. IEEE Std 1003.1-2001 permits, but does
not require, this historical practice because capital forms
of the commands are used by some implementations for <br>
other purposes.</p>

<p style="margin-top: 1em">Put <br>
Historically, an ex put command, executed from open or
visual mode, was the same as the open or visual mode P
command, if the buffer was named and was cut in character
mode, and <br>
the same as the p command if the buffer was named and cut in
line mode. If the unnamed buffer was the source of the text,
the entire line from which the text was taken was usu&acirc;
<br>
ally put, and the buffer was handled as if in line mode, but
it was possible to get extremely anomalous behavior. In
addition, using the Q command to switch into ex mode, and
<br>
then doing a put often resulted in errors as well, such as
appending text that was unrelated to the (supposed) contents
of the buffer. For consistency and simplicity of
specifi&acirc; <br>
cation, IEEE Std 1003.1-2001 does not permit these
behaviors. All ex put commands are required to operate in
line mode, and the contents of the buffers are not altered
by chang&acirc; <br>
ing the mode of the editor.</p>

<p style="margin-top: 1em">Read <br>
Historically, an ex read command executed from open or
visual mode, executed in an empty file, left an empty line
as the first line of the file. For consistency and
simplicity of <br>
specification, IEEE Std 1003.1-2001 does not permit this
behavior. Historically, a read in open or visual mode from a
program left the cursor at the last line read in, not the
<br>
first. For consistency, IEEE Std 1003.1-2001 does not permit
this behavior.</p>

<p style="margin-top: 1em">Historical implementations of ex
were unable to undo read commands that read from the output
of a program. For consistency, IEEE Std 1003.1-2001 does not
permit this behavior.</p>

<p style="margin-top: 1em">Historically, the ex and vi
message after a successful read or write command specified
&quot;characters&quot;, not &quot;bytes&quot;. IEEE Std
1003.1-2001 requires that the number of bytes be dis&acirc;
<br>
played, not the number of characters, because it may be
difficult in multi-byte implementations to determine the
number of characters read. Implementations are encouraged to
<br>
clarify the message displayed to the user.</p>

<p style="margin-top: 1em">Historically, reads were not
permitted on files other than type regular, except that FIFO
files could be read (probably only because they did not
exist when ex and vi were origi&acirc; <br>
nally written). Because the historical ex evaluated read!
and read ! equivalently, there can be no optional way to
force the read. IEEE Std 1003.1-2001 permits, but does not
<br>
require, this behavior.</p>

<p style="margin-top: 1em">Recover <br>
Some historical implementations of the editor permitted
users to recover the edit buffer contents from a previous
edit session, and then exit without saving those contents
(or <br>
explicitly discarding them). The intent of IEEE Std
1003.1-2001 in requiring that the edit buffer be treated as
already modified is to prevent this user error.</p>

<p style="margin-top: 1em">Rewind <br>
Historical implementations supported the rewind command when
the user was editing the first file in the list; that is,
the file that the rewind command would edit. <br>
IEEE Std 1003.1-2001 requires conformance to historical
practice.</p>

<p style="margin-top: 1em">Substitute <br>
Historically, ex accepted an r option to the s command. The
effect of the r option was to use the last regular
expression used in any command as the pattern, the same as
the ~ <br>
command. The r option is not required by IEEE Std
1003.1-2001. Historically, the c and g options were toggled;
for example, the command :s/abc/def/ was the same as
s/abc/def/ccc&acirc; <br>
cgggg. For simplicity of specification, IEEE Std 1003.1-2001
does not permit this behavior.</p>

<p style="margin-top: 1em">The tilde command is often used
to replace the last search RE. For example, in the
sequence:</p>

<p style="margin-top: 1em">s/red/blue/ <br>
/green <br>
~</p>

<p style="margin-top: 1em">the ~ command is equivalent
to:</p>

<p style="margin-top: 1em">s/green/blue/</p>

<p style="margin-top: 1em">Historically, ex accepted all of
the following forms:</p>

<p style="margin-top: 1em">s/abc/def/ <br>
s/abc/def <br>
s/abc/ <br>
s/abc</p>

<p style="margin-top: 1em">IEEE Std 1003.1-2001 requires
conformance to this historical practice.</p>

<p style="margin-top: 1em">The s command presumes that the
&rsquo;^&rsquo; character only occupies a single column in
the display. Much of the ex and vi specification presumes
that the &lt;space&gt; only occupies a single <br>
column in the display. There are no known character sets for
which this is not true.</p>

<p style="margin-top: 1em">Historically, the final column
position for the substitute commands was based on previous
column movements; a search for a pattern followed by a
substitution would leave the col&acirc; <br>
umn position unchanged, while a 0 command followed by a
substitution would change the column position to the first
non- &lt;blank&gt;. For consistency and simplicity of
specification, <br>
IEEE Std 1003.1-2001 requires that the final column position
always be set to the first non- &lt;blank&gt;.</p>

<p style="margin-top: 1em">Set <br>
Historical implementations redisplayed all of the options
for each occurrence of the all keyword. IEEE Std 1003.1-2001
permits, but does not require, this behavior.</p>

<p style="margin-top: 1em">Tag <br>
No requirement is made as to where ex and vi shall look for
the file referenced by the tag entry. Historical practice
has been to look for the path found in the tags file, based
<br>
on the current directory. A useful extension found in some
implementations is to look based on the directory containing
the tags file that held the entry, as well. No
require&acirc; <br>
ment is made as to which reference for the tag in the tags
file is used. This is deliberate, in order to permit
extensions such as multiple entries in a tags file for a
tag.</p>

<p style="margin-top: 1em">Because users often specify many
different tags files, some of which need not be relevant or
exist at any particular time, IEEE Std 1003.1-2001 requires
that error messages about <br>
problem tags files be displayed only if the requested tag is
not found, and then, only once for each time that the tag
edit option is changed.</p>

<p style="margin-top: 1em">The requirement that the current
edit buffer be unmodified is only necessary if the file
indicated by the tag entry is not the same as the current
file (as defined by the current <br>
pathname). Historically, the file would be reloaded if the
filename had changed, as well as if the filename was
different from the current pathname. For consistency and
simplic&acirc; <br>
ity of specification, IEEE Std 1003.1-2001 does not permit
this behavior, requiring that the name be the only factor in
the decision.</p>

<p style="margin-top: 1em">Historically, vi only searched
for tags in the current file from the current cursor to the
end of the file, and therefore, if the wrapscan option was
not set, tags occurring <br>
before the current cursor were not found. IEEE Std
1003.1-2001 considers this a bug, and implementations are
required to search for the first occurrence in the file,
regardless.</p>

<p style="margin-top: 1em">Undo <br>
The undo description deliberately uses the word
&quot;modified&quot;. The undo command is not intended to
undo commands that replace the contents of the edit buffer,
such as edit, next, <br>
tag, or recover.</p>

<p style="margin-top: 1em">Cursor positioning after the
undo command was inconsistent in the historical vi,
sometimes attempting to restore the original cursor position
( global, undo, and v commands), and <br>
sometimes, in the presence of maps, placing the cursor on
the last line added or changed instead of the first. IEEE
Std 1003.1-2001 requires a simplified behavior for
consistency <br>
and simplicity of specification.</p>

<p style="margin-top: 1em">Version <br>
The version command cannot be exactly specified since there
is no widely-accepted definition of what the version
information should contain. Implementations are encouraged
to do <br>
something reasonably intelligent.</p>

<p style="margin-top: 1em">Write <br>
Historically, the ex and vi message after a successful read
or write command specified &quot;characters&quot;, not
&quot;bytes&quot;. IEEE Std 1003.1-2001 requires that the
number of bytes be dis&acirc; <br>
played, not the number of characters because it may be
difficult in multi-byte implementations to determine the
number of characters written. Implementations are encouraged
to <br>
clarify the message displayed to the user.</p>

<p style="margin-top: 1em">Implementation-defined tests are
permitted so that implementations can make additional
checks; for example, for locks or file modification
times.</p>

<p style="margin-top: 1em">Historically, attempting to
append to a nonexistent file caused an error. It has been
left unspecified in IEEE Std 1003.1-2001 to permit
implementations to let the write succeed, <br>
so that the append semantics are similar to those of the
historical csh.</p>

<p style="margin-top: 1em">Historical vi permitted empty
edit buffers to be written. However, since the way vi got
around dealing with &quot;empty&quot; files was to always
have a line in the edit buffer, no matter <br>
what, it wrote them as files of a single, empty line. IEEE
Std 1003.1-2001 does not permit this behavior.</p>

<p style="margin-top: 1em">Historically, ex restored
standard output and standard error to their values as of
when ex was invoked, before writes to programs were
performed. This could disturb the terminal <br>
configuration as well as be a security issue for some
terminals. IEEE Std 1003.1-2001 does not permit this,
requiring that the program output be captured and displayed
as if by <br>
the ex print command.</p>

<p style="margin-top: 1em">Adjust Window <br>
Historically, the line count was set to the value of the
scroll option if the type character was end-of-file. This
feature was broken on most historical implementations long
ago, <br>
however, and is not documented anywhere. For this reason,
IEEE Std 1003.1-2001 is resolutely silent.</p>

<p style="margin-top: 1em">Historically, the z command was
&lt;blank&gt;-sensitive and z + and z - did different things
than z+ and z- because the type could not be distinguished
from a flag. (The commands z. <br>
and z = were historically invalid.) IEEE Std 1003.1-2001
requires conformance to this historical practice.</p>

<p style="margin-top: 1em">Historically, the z command was
further &lt;blank&gt;-sensitive in that the count could not
be &lt;blank&gt;-delimited; for example, the commands z= 5
and z- 5 were also invalid. Because the <br>
count is not ambiguous with respect to either the type
character or the flags, this is not permitted by IEEE Std
1003.1-2001.</p>

<p style="margin-top: 1em">Escape <br>
Historically, ex filter commands only read the standard
output of the commands, letting standard error appear on the
terminal as usual. The vi utility, however, read both
stan&acirc; <br>
dard output and standard error. IEEE Std 1003.1-2001
requires the latter behavior for both ex and vi, for
consistency.</p>

<p style="margin-top: 1em">Shift Left and Shift Right <br>
Historically, it was possible to add shift characters to
increase the effect of the command; for example,
&lt;&lt;&lt; outdented (or &gt;&gt;&gt; indented) the lines
3 levels of indentation <br>
instead of the default 1. IEEE Std 1003.1-2001 requires
conformance to historical practice.</p>

<p style="margin-top: 1em">&lt;control&gt;-D <br>
Historically, the &lt;control&gt;-D command erased the
prompt, providing the user with an unbroken presentation of
lines from the edit buffer. This is not required by <br>
IEEE Std 1003.1-2001; implementations are encouraged to
provide it if possible. Historically, the &lt;control&gt;-D
command took, and then ignored, a count. IEEE Std
1003.1-2001 does <br>
not permit this behavior.</p>

<p style="margin-top: 1em">Write Line Number <br>
Historically, the ex = command, when executed in ex mode in
an empty edit buffer, reported 0, and from open or visual
mode, reported 1. For consistency and simplicity of
specifi&acirc; <br>
cation, IEEE Std 1003.1-2001 does not permit this
behavior.</p>

<p style="margin-top: 1em">Execute <br>
Historically, ex did not correctly handle the inclusion of
text input commands (that is, append, insert, and change) in
executed buffers. IEEE Std 1003.1-2001 does not permit <br>
this exclusion for consistency.</p>

<p style="margin-top: 1em">Historically, the logical
contents of the buffer being executed did not change if the
buffer itself were modified by the commands being executed;
that is, buffer execution did <br>
not support self-modifying code. IEEE Std 1003.1-2001
requires conformance to historical practice.</p>

<p style="margin-top: 1em">Historically, the @ command took
a range of lines, and the @ buffer was executed once per
line, with the current line ( &rsquo;.&rsquo; ) set to each
specified line. IEEE Std 1003.1-2001 <br>
requires conformance to historical practice.</p>

<p style="margin-top: 1em">Some historical implementations
did not notice if errors occurred during buffer execution.
This, coupled with the ability to specify a range of lines
for the ex @ command, makes <br>
it trivial to cause them to drop core. IEEE Std 1003.1-2001
requires that implementations stop buffer execution if any
error occurs, if the specified line doesn&rsquo;t exist, or
if <br>
the contents of the edit buffer itself are replaced (for
example, the buffer executes the ex :edit command).</p>

<p style="margin-top: 1em">Regular Expressions in ex <br>
Historical practice is that the characters in the
replacement part of the last s command-that is, those
matched by entering a &rsquo;~&rsquo; in the regular
expression-were not further <br>
expanded by the regular expression engine. So, if the
characters contained the string &quot;a.,&quot; they would
match &rsquo;a&rsquo; followed by &quot;.,&quot; and not
&rsquo;a&rsquo; followed by any character. <br>
IEEE Std 1003.1-2001 requires conformance to historical
practice.</p>

<p style="margin-top: 1em">Edit Options in ex <br>
The following paragraphs describe the historical behavior of
some edit options that were not, for whatever reason,
included in IEEE Std 1003.1-2001. Implementations are
strongly <br>
encouraged to only use these names if the functionality
described here is fully supported.</p>

<p style="margin-top: 1em">extended <br>
The extended edit option has been used in some
implementations of vi to provide extended regular
expressions instead of basic regular expressions This option
was omitted <br>
from IEEE Std 1003.1-2001 because it is not widespread
historical practice.</p>

<p style="margin-top: 1em">flash The flash edit option
historically caused the screen to flash instead of beeping
on error. This option was omitted from IEEE Std 1003.1-2001
because it is not found in <br>
some historical implementations.</p>

<p style="margin-top: 1em">hardtabs <br>
The hardtabs edit option historically defined the number of
columns between hardware tab settings. This option was
omitted from IEEE Std 1003.1-2001 because it was <br>
believed to no longer be generally useful.</p>

<p style="margin-top: 1em">modeline <br>
The modeline (sometimes named modelines) edit option
historically caused ex or vi to read the five first and last
lines of the file for editor commands. This option is a <br>
security problem, and vendors are strongly encouraged to
delete it from historical implementations.</p>

<p style="margin-top: 1em">open The open edit option
historically disallowed the ex open and visual commands.
This edit option was omitted because these commands are
required by IEEE Std 1003.1-2001.</p>

<p style="margin-top: 1em">optimize <br>
The optimize edit option historically expedited text
throughput by setting the terminal to not do automatic
&lt;carriage-return&gt;s when printing more than one logical
line of <br>
output. This option was omitted from IEEE Std 1003.1-2001
because it was intended for terminals without addressable
cursors, which are rarely, if ever, still used.</p>

<p style="margin-top: 1em">ruler The ruler edit option has
been used in some implementations of vi to present a current
row/column ruler for the user. This option was omitted from
IEEE Std 1003.1-2001 <br>
because it is not widespread historical practice.</p>

<p style="margin-top: 1em">sourceany <br>
The sourceany edit option historically caused ex or vi to
source start-up files that were owned by users other than
the user running the editor. This option is a security <br>
problem, and vendors are strongly encouraged to remove it
from their implementations.</p>

<p style="margin-top: 1em">timeout <br>
The timeout edit option historically enabled the (now
standard) feature of only waiting for a short period before
returning keys that could be part of a macro. This
fea&acirc; <br>
ture was omitted from IEEE Std 1003.1-2001 because its
behavior is now standard, it is not widely useful, and it
was rarely documented.</p>

<p style="margin-top: 1em">verbose <br>
The verbose edit option has been used in some
implementations of vi to cause vi to output error messages
for common errors; for example, attempting to move the
cursor past <br>
the beginning or end of the line instead of only alerting
the screen. (The historical vi only alerted the terminal and
presented no message for such errors. The historical <br>
editor option terse did not select when to present error
messages, it only made existing error messages more or less
verbose.) This option was omitted from <br>
IEEE Std 1003.1-2001 because it is not widespread historical
practice; however, implementors are encouraged to use it if
they wish to provide error messages for naive <br>
users.</p>

<p style="margin-top: 1em">wraplen <br>
The wraplen edit option has been used in some
implementations of vi to specify an automatic margin
measured from the left margin instead of from the right
margin. This is <br>
useful when multiple screen sizes are being used to edit a
single file. This option was omitted from IEEE Std
1003.1-2001 because it is not widespread historical
practice; <br>
however, implementors are encouraged to use it if they add
this functionality.</p>

<p style="margin-top: 1em">autoindent, ai <br>
Historically, the command 0a did not do any autoindentation,
regardless of the current indentation of line 1. IEEE Std
1003.1-2001 requires that any indentation present in line
<br>
1 be used.</p>

<p style="margin-top: 1em">autoprint, ap <br>
Historically, the autoprint edit option was not completely
consistent or based solely on modifications to the edit
buffer. Exceptions were the read command (when reading from
a <br>
file, but not from a filter), the append, change, insert,
global, and v commands, all of which were not affected by
autoprint, and the tag command, which was affected by
auto&acirc; <br>
print. IEEE Std 1003.1-2001 requires conformance to
historical practice.</p>

<p style="margin-top: 1em">Historically, the autoprint
option only applied to the last of multiple commands entered
using vertical-bar delimiters; for example, delete
&lt;newline&gt; was affected by autoprint, <br>
but delete|version &lt;newline&gt; was not. IEEE Std
1003.1-2001 requires conformance to historical practice.</p>

<p style="margin-top: 1em">autowrite, aw <br>
Appending the &rsquo;!&rsquo; character to the ex next
command to avoid performing an automatic write was not
supported in historical implementations. IEEE Std
1003.1-2001 requires that the <br>
behavior match the other ex commands for consistency.</p>

<p style="margin-top: 1em">ignorecase, ic <br>
Historical implementations of case-insensitive matching (the
ignorecase edit option) lead to counterintuitive situations
when uppercase characters were used in range expressions.
<br>
Historically, the process was as follows:</p>

<p style="margin-top: 1em">1. Take a line of text from the
edit buffer.</p>

<p style="margin-top: 1em">2. Convert uppercase to
lowercase in text line.</p>

<p style="margin-top: 1em">3. Convert uppercase to
lowercase in regular expressions, except in character class
specifications.</p>

<p style="margin-top: 1em">4. Match regular expressions
against text.</p>

<p style="margin-top: 1em">This would mean that, with
ignorecase in effect, the text:</p>

<p style="margin-top: 1em">The cat sat on the mat</p>

<p style="margin-top: 1em">would be matched by</p>

<p style="margin-top: 1em">/^the/</p>

<p style="margin-top: 1em">but not by:</p>

<p style="margin-top: 1em">/^[A-Z]he/</p>

<p style="margin-top: 1em">For consistency with other
commands implementing regular expressions, IEEE Std
1003.1-2001 does not permit this behavior.</p>

<p style="margin-top: 1em">paragraphs, para <br>
The ISO POSIX-2:1993 standard made the default paragraphs
and sections edit options implementation-defined, arguing
they were historically oriented to the UNIX system troff
text <br>
formatter, and a &quot;portable user&quot; could use the {,
}, [[, ]], (, and ) commands in open or visual mode and have
the cursor stop in unexpected places. IEEE Std 1003.1-2001
speci&acirc; <br>
fies their values in the POSIX locale because the unusual
grouping (they only work when grouped into two characters at
a time) means that they cannot be used for general-purpose
<br>
movement, regardless.</p>

<p style="margin-top: 1em">readonly <br>
Implementations are encouraged to provide the best possible
information to the user as to the read-only status of the
file, with the exception that they should not consider the
<br>
current special privileges of the process. This provides
users with a safety net because they must force the
overwrite of read-only files, even when running with
additional priv&acirc; <br>
ileges.</p>

<p style="margin-top: 1em">The readonly edit option
specification largely conforms to historical practice. The
only difference is that historical implementations did not
notice that the user had set the <br>
readonly edit option in cases where the file was already
marked read-only for some reason, and would therefore
reinitialize the readonly edit option the next time the
contents of <br>
the edit buffer were replaced. This behavior is disallowed
by IEEE Std 1003.1-2001.</p>

<p style="margin-top: 1em">report <br>
The requirement that lines copied to a buffer interact
differently than deleted lines is historical practice. For
example, if the report edit option is set to 3, deleting 3
lines <br>
will cause a report to be written, but 4 lines must be
copied before a report is written.</p>

<p style="margin-top: 1em">The requirement that the ex
global, v, open, undo, and visual commands present reports
based on the total number of lines added or deleted during
the command execution, and that <br>
commands executed by the global and v commands not present
reports, is historical practice. IEEE Std 1003.1-2001
extends historical practice by requiring that buffer
execution <br>
be treated similarly. The reasons for this are two-fold.
Historically, only the report by the last command executed
from the buffer would be seen by the user, as each new
report <br>
would overwrite the last. In addition, the standard
developers believed that buffer execution had more in common
with global and v commands than it did with other ex
commands, <br>
and should behave similarly, for consistency and simplicity
of specification.</p>

<p style="margin-top: 1em">showmatch, sm <br>
The length of time the cursor spends on the matching
character is unspecified because the timing capabilities of
systems are often inexact and variable. The time should be
long <br>
enough for the user to notice, but not long enough for the
user to become annoyed. Some implementations of vi have
added a matchtime option that permits users to set the
number <br>
of 0,1 second intervals the cursor pauses on the matching
character.</p>

<p style="margin-top: 1em">showmode <br>
The showmode option has been used in some historical
implementations of ex and vi to display the current editing
mode when in open or visual mode. The editing modes have
gener&acirc; <br>
ally included &quot;command&quot; and &quot;input&quot;, and
sometimes other modes such as &quot;replace&quot; and
&quot;change&quot;. The string was usually displayed on the
bottom line of the screen at the far right- <br>
hand corner. In addition, a preceding &rsquo;*&rsquo;
character often denoted whether the contents of the edit
buffer had been modified. The latter display has sometimes
been part of the <br>
showmode option, and sometimes based on another option. This
option was not available in the 4 BSD historical
implementation of vi, but was viewed as generally useful,
particu&acirc; <br>
larly to novice users, and is required by IEEE Std
1003.1-2001.</p>

<p style="margin-top: 1em">The smd shorthand for the
showmode option was not present in all historical
implementations of the editor. IEEE Std 1003.1-2001 requires
it, for consistency.</p>

<p style="margin-top: 1em">Not all historical
implementations of the editor displayed a mode string for
command mode, differentiating command mode from text input
mode by the absence of a mode string. <br>
IEEE Std 1003.1-2001 permits this behavior for consistency
with historical practice, but implementations are encouraged
to provide a display string for both modes.</p>

<p style="margin-top: 1em">slowopen <br>
Historically the slowopen option was automatically set if
the terminal baud rate was less than 1200 baud, or if the
baud rate was 1200 baud and the redraw option was not set.
The <br>
slowopen option had two effects. First, when inserting
characters in the middle of a line, characters after the
cursor would not be pushed ahead, but would appear to be
overwrit&acirc; <br>
ten. Second, when creating a new line of text, lines after
the current line would not be scrolled down, but would
appear to be overwritten. In both cases, ending text input
mode <br>
would cause the screen to be refreshed to match the actual
contents of the edit buffer. Finally, terminals that were
sufficiently intelligent caused the editor to ignore the
<br>
slowopen option. IEEE Std 1003.1-2001 permits most
historical behavior, extending historical practice to
require slowopen behaviors if the edit option is set by the
user.</p>

<p style="margin-top: 1em">tags <br>
The default path for tags files is left unspecified as
implementations may have their own tags implementations that
do not correspond to the historical ones. The default tags
<br>
option value should probably at least include the file
./tags.</p>

<p style="margin-top: 1em">term <br>
Historical implementations of ex and vi ignored changes to
the term edit option after the initial terminal information
was loaded. This is permitted by IEEE Std 1003.1-2001;
how&acirc; <br>
ever, implementations are encouraged to permit the user to
modify their terminal type at any time.</p>

<p style="margin-top: 1em">terse <br>
Historically, the terse edit option optionally provided a
shorter, less descriptive error message, for some error
messages. This is permitted, but not required, by <br>
IEEE Std 1003.1-2001. Historically, most common visual mode
errors (for example, trying to move the cursor past the end
of a line) did not result in an error message, but simply
<br>
alerted the terminal. Implementations wishing to provide
messages for novice users are urged to do so based on the
edit option verbose, and not terse.</p>

<p style="margin-top: 1em">window <br>
In historical implementations, the default for the window
edit option was based on the baud rate as follows:</p>

<p style="margin-top: 1em">1. If the baud rate was less
than 1200, the edit option w300 set the window value; for
example, the line:</p>

<p style="margin-top: 1em">set w300=12</p>

<p style="margin-top: 1em">would set the window option to
12 if the baud rate was less than 1200.</p>

<p style="margin-top: 1em">2. If the baud rate was equal to
1200, the edit option w1200 set the window value.</p>

<p style="margin-top: 1em">3. If the baud rate was greater
than 1200, the edit option w9600 set the window value.</p>

<p style="margin-top: 1em">The w300, w1200, and w9600
options do not appear in IEEE Std 1003.1-2001 because of
their dependence on specific baud rates.</p>

<p style="margin-top: 1em">In historical implementations,
the size of the window displayed by various commands was
related to, but not necessarily the same as, the window edit
option. For example, the size <br>
of the window was set by the ex command visual 10, but it
did not change the value of the window edit option. However,
changing the value of the window edit option did change the
<br>
number of lines that were displayed when the screen was
repainted. IEEE Std 1003.1-2001 does not permit this
behavior in the interests of consistency and simplicity of
specifi&acirc; <br>
cation, and requires that all commands that change the
number of lines that are displayed do it by setting the
value of the window edit option.</p>

<p style="margin-top: 1em">wrapmargin, wm <br>
Historically, the wrapmargin option did not affect maps
inserting characters that also had associated counts; for
example :map K 5aABC DEF. Unfortunately, there are widely
used <br>
maps that depend on this behavior. For consistency and
simplicity of specification, IEEE Std 1003.1-2001 does not
permit this behavior.</p>

<p style="margin-top: 1em">Historically, wrapmargin was
calculated using the column display width of all characters
on the screen. For example, an implementation using
&quot;^I&quot; to represent &lt;tab&gt;s when the <br>
list edit option was set, where &rsquo;^&rsquo; and
&rsquo;I&rsquo; each took up a single column on the screen,
would calculate the wrapmargin based on a value of 2 for
each &lt;tab&gt;. The number edit <br>
option similarly changed the effective length of the line as
well. IEEE Std 1003.1-2001 requires conformance to
historical practice.</p>

<p style="margin-top: 1em">FUTURE DIRECTIONS <br>
None.</p>

<p style="margin-top: 1em">SEE ALSO <br>
Command Search and Execution, ctags, ed, sed, sh, stty, vi,
the System Interfaces volume of IEEE Std 1003.1-2001,
access()</p>

<p style="margin-top: 1em">COPYRIGHT <br>
Portions of this text are reprinted and reproduced in
electronic form from IEEE Std 1003.1, 2003 Edition, Standard
for Information Technology -- Portable Operating System
Inter&acirc; <br>
face (POSIX), The Open Group Base Specifications Issue 6,
Copyright (C) 2001-2003 by the Institute of Electrical and
Electronics Engineers, Inc and The Open Group. In the event
<br>
of any discrepancy between this version and the original
IEEE and The Open Group Standard, the original IEEE and The
Open Group Standard is the referee document. The original
<br>
Standard can be obtained online at
http://www.opengroup.org/unix/online.html .</p>

<p style="margin-top: 1em">IEEE/The Open Group 2003
EX(1P)</p>
<hr>
</body>
</html>
