<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:43:24 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>X509(1) OpenSSL X509(1)</p>

<p style="margin-top: 1em">NAME <br>
x509 - Certificate display and signing utility</p>

<p style="margin-top: 1em">SYNOPSIS <br>
openssl x509 [-inform DER|PEM|NET] [-outform DER|PEM|NET]
[-keyform DER|PEM] [-CAform DER|PEM] [-CAkeyform DER|PEM]
[-in filename] [-out filename] [-serial] [-hash] <br>
[-subject_hash] [-issuer_hash] [-subject] [-issuer]
[-nameopt option] [-email] [-ocsp_uri] [-startdate]
[-enddate] [-purpose] [-dates] [-modulus] [-pubkey]
[-fingerprint] <br>
[-alias] [-noout] [-trustout] [-clrtrust] [-clrreject]
[-addtrust arg] [-addreject arg] [-setalias arg] [-days arg]
[-set_serial n] [-signkey filename] [-x509toreq] [-req] [-CA
<br>
filename] [-CAkey filename] [-CAcreateserial] [-CAserial
filename] [-text] [-C] [-md2|-md5|-sha1|-mdc2] [-clrext]
[-extfile filename] [-extensions section] [-engine id]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
The x509 command is a multi purpose certificate utility. It
can be used to display certificate information, convert
certificates to various forms, sign certificate requests
like <br>
a &quot;mini CA&quot; or edit certificate trust
settings.</p>

<p style="margin-top: 1em">Since there are a large number
of options they will split up into various sections.</p>

<p style="margin-top: 1em">OPTIONS <br>
INPUT, OUTPUT AND GENERAL PURPOSE OPTIONS <br>
-inform DER|PEM|NET <br>
This specifies the input format normally the command will
expect an X509 certificate but this can change if other
options such as -req are present. The DER format is the DER
<br>
encoding of the certificate and PEM is the base64 encoding
of the DER encoding with header and footer lines added. The
NET option is an obscure Netscape server format that is <br>
now obsolete.</p>

<p style="margin-top: 1em">-outform DER|PEM|NET <br>
This specifies the output format, the options have the same
meaning as the -inform option.</p>

<p style="margin-top: 1em">-in filename <br>
This specifies the input filename to read a certificate from
or standard input if this option is not specified.</p>

<p style="margin-top: 1em">-out filename <br>
This specifies the output filename to write to or standard
output by default.</p>

<p style="margin-top: 1em">-md2|-md5|-sha1|-mdc2 <br>
the digest to use. This affects any signing or display
option that uses a message digest, such as the -fingerprint,
-signkey and -CA options. If not specified then SHA1 is <br>
used. If the key being used to sign with is a DSA key then
this option has no effect: SHA1 is always used with DSA
keys. For full list of digests see openssl dgst -h
output.</p>

<p style="margin-top: 1em">-engine id <br>
specifying an engine (by its unique id string) will cause
x509 to attempt to obtain a functional reference to the
specified engine, thus initialising it if needed. The engine
<br>
will then be set as the default for all available
algorithms.</p>

<p style="margin-top: 1em">DISPLAY OPTIONS <br>
Note: the -alias and -purpose options are also display
options but are described in the TRUST SETTINGS section.</p>

<p style="margin-top: 1em">-text <br>
prints out the certificate in text form. Full details are
output including the public key, signature algorithms,
issuer and subject names, serial number any extensions <br>
present and any trust settings.</p>

<p style="margin-top: 1em">-certopt option <br>
customise the output format used with -text. The option
argument can be a single option or multiple options
separated by commas. The -certopt switch may be also be used
more <br>
than once to set multiple options. See the TEXT OPTIONS
section for more information.</p>

<p style="margin-top: 1em">-noout <br>
this option prevents output of the encoded version of the
request.</p>

<p style="margin-top: 1em">-pubkey <br>
outputs the the certificate&rsquo;s SubjectPublicKeyInfo
block in PEM format.</p>

<p style="margin-top: 1em">-modulus <br>
this option prints out the value of the modulus of the
public key contained in the certificate.</p>

<p style="margin-top: 1em">-serial <br>
outputs the certificate serial number.</p>

<p style="margin-top: 1em">-subject_hash <br>
outputs the &quot;hash&quot; of the certificate subject
name. This is used in OpenSSL to form an index to allow
certificates in a directory to be looked up by subject
name.</p>

<p style="margin-top: 1em">-issuer_hash <br>
outputs the &quot;hash&quot; of the certificate issuer
name.</p>

<p style="margin-top: 1em">-hash <br>
synonym for &quot;-subject_hash&quot; for backward
compatibility reasons.</p>

<p style="margin-top: 1em">-subject_hash_old <br>
outputs the &quot;hash&quot; of the certificate subject name
using the older algorithm as used by OpenSSL versions before
1.0.0.</p>

<p style="margin-top: 1em">-issuer_hash_old <br>
outputs the &quot;hash&quot; of the certificate issuer name
using the older algorithm as used by OpenSSL versions before
1.0.0.</p>

<p style="margin-top: 1em">-subject <br>
outputs the subject name.</p>

<p style="margin-top: 1em">-issuer <br>
outputs the issuer name.</p>

<p style="margin-top: 1em">-nameopt option <br>
option which determines how the subject or issuer names are
displayed. The option argument can be a single option or
multiple options separated by commas. Alternatively the <br>
-nameopt switch may be used more than once to set multiple
options. See the NAME OPTIONS section for more
information.</p>

<p style="margin-top: 1em">-email <br>
outputs the email address(es) if any.</p>

<p style="margin-top: 1em">-ocsp_uri <br>
outputs the OCSP responder address(es) if any.</p>

<p style="margin-top: 1em">-startdate <br>
prints out the start date of the certificate, that is the
notBefore date.</p>

<p style="margin-top: 1em">-enddate <br>
prints out the expiry date of the certificate, that is the
notAfter date.</p>

<p style="margin-top: 1em">-dates <br>
prints out the start and expiry dates of a certificate.</p>

<p style="margin-top: 1em">-fingerprint <br>
prints out the digest of the DER encoded version of the
whole certificate (see digest options).</p>

<p style="margin-top: 1em">-C this outputs the certificate
in the form of a C source file.</p>

<p style="margin-top: 1em">TRUST SETTINGS <br>
Please note these options are currently experimental and may
well change.</p>

<p style="margin-top: 1em">A trusted certificate is an
ordinary certificate which has several additional pieces of
information attached to it such as the permitted and
prohibited uses of the certificate <br>
and an &quot;alias&quot;.</p>

<p style="margin-top: 1em">Normally when a certificate is
being verified at least one certificate must be
&quot;trusted&quot;. By default a trusted certificate must
be stored locally and must be a root CA: any <br>
certificate chain ending in this CA is then usable for any
purpose.</p>

<p style="margin-top: 1em">Trust settings currently are
only used with a root CA. They allow a finer control over
the purposes the root CA can be used for. For example a CA
may be trusted for SSL client <br>
but not SSL server use.</p>

<p style="margin-top: 1em">See the description of the
verify utility for more information on the meaning of trust
settings.</p>

<p style="margin-top: 1em">Future versions of OpenSSL will
recognize trust settings on any certificate: not just root
CAs.</p>

<p style="margin-top: 1em">-trustout <br>
this causes x509 to output a trusted certificate. An
ordinary or trusted certificate can be input but by default
an ordinary certificate is output and any trust settings are
<br>
discarded. With the -trustout option a trusted certificate
is output. A trusted certificate is automatically output if
any trust settings are modified.</p>

<p style="margin-top: 1em">-setalias arg <br>
sets the alias of the certificate. This will allow the
certificate to be referred to using a nickname for example
&quot;Steve&rsquo;s Certificate&quot;.</p>

<p style="margin-top: 1em">-alias <br>
outputs the certificate alias, if any.</p>

<p style="margin-top: 1em">-clrtrust <br>
clears all the permitted or trusted uses of the
certificate.</p>

<p style="margin-top: 1em">-clrreject <br>
clears all the prohibited or rejected uses of the
certificate.</p>

<p style="margin-top: 1em">-addtrust arg <br>
adds a trusted certificate use. Any object name can be used
here but currently only clientAuth (SSL client use),
serverAuth (SSL server use) and emailProtection (S/MIME <br>
email) are used. Other OpenSSL applications may define
additional uses.</p>

<p style="margin-top: 1em">-addreject arg <br>
adds a prohibited use. It accepts the same values as the
-addtrust option.</p>

<p style="margin-top: 1em">-purpose <br>
this option performs tests on the certificate extensions and
outputs the results. For a more complete description see the
CERTIFICATE EXTENSIONS section.</p>

<p style="margin-top: 1em">SIGNING OPTIONS <br>
The x509 utility can be used to sign certificates and
requests: it can thus behave like a &quot;mini CA&quot;.</p>

<p style="margin-top: 1em">-signkey filename <br>
this option causes the input file to be self signed using
the supplied private key.</p>

<p style="margin-top: 1em">If the input file is a
certificate it sets the issuer name to the subject name
(i.e. makes it self signed) changes the public key to the
supplied value and changes the start <br>
and end dates. The start date is set to the current time and
the end date is set to a value determined by the -days
option. Any certificate extensions are retained unless the
<br>
-clrext option is supplied.</p>

<p style="margin-top: 1em">If the input is a certificate
request then a self signed certificate is created using the
supplied private key using the subject name in the
request.</p>

<p style="margin-top: 1em">-clrext <br>
delete any extensions from a certificate. This option is
used when a certificate is being created from another
certificate (for example with the -signkey or the -CA
options). <br>
Normally all extensions are retained.</p>

<p style="margin-top: 1em">-keyform PEM|DER <br>
specifies the format (DER or PEM) of the private key file
used in the -signkey option.</p>

<p style="margin-top: 1em">-days arg <br>
specifies the number of days to make a certificate valid
for. The default is 30 days.</p>

<p style="margin-top: 1em">-x509toreq <br>
converts a certificate into a certificate request. The
-signkey option is used to pass the required private
key.</p>

<p style="margin-top: 1em">-req <br>
by default a certificate is expected on input. With this
option a certificate request is expected instead.</p>

<p style="margin-top: 1em">-set_serial n <br>
specifies the serial number to use. This option can be used
with either the -signkey or -CA options. If used in
conjunction with the -CA option the serial number file (as
<br>
specified by the -CAserial or -CAcreateserial options) is
not used.</p>

<p style="margin-top: 1em">The serial number can be decimal
or hex (if preceded by 0x). Negative serial numbers can also
be specified but their use is not recommended.</p>

<p style="margin-top: 1em">-CA filename <br>
specifies the CA certificate to be used for signing. When
this option is present x509 behaves like a &quot;mini
CA&quot;. The input file is signed by this CA using this
option: that is <br>
its issuer name is set to the subject name of the CA and it
is digitally signed using the CAs private key.</p>

<p style="margin-top: 1em">This option is normally combined
with the -req option. Without the -req option the input is a
certificate which must be self signed.</p>

<p style="margin-top: 1em">-CAkey filename <br>
sets the CA private key to sign a certificate with. If this
option is not specified then it is assumed that the CA
private key is present in the CA certificate file.</p>

<p style="margin-top: 1em">-CAserial filename <br>
sets the CA serial number file to use.</p>

<p style="margin-top: 1em">When the -CA option is used to
sign a certificate it uses a serial number specified in a
file. This file consist of one line containing an even
number of hex digits with the <br>
serial number to use. After each use the serial number is
incremented and written out to the file again.</p>

<p style="margin-top: 1em">The default filename consists of
the CA certificate file base name with &quot;.srl&quot;
appended. For example if the CA certificate file is called
&quot;mycacert.pem&quot; it expects to find a <br>
serial number file called &quot;mycacert.srl&quot;.</p>

<p style="margin-top: 1em">-CAcreateserial <br>
with this option the CA serial number file is created if it
does not exist: it will contain the serial number
&quot;02&quot; and the certificate being signed will have
the 1 as its <br>
serial number. Normally if the -CA option is specified and
the serial number file does not exist it is an error.</p>

<p style="margin-top: 1em">-extfile filename <br>
file containing certificate extensions to use. If not
specified then no extensions are added to the
certificate.</p>

<p style="margin-top: 1em">-extensions section <br>
the section to add certificate extensions from. If this
option is not specified then the extensions should either be
contained in the unnamed (default) section or the default
<br>
section should contain a variable called
&quot;extensions&quot; which contains the section to use.
See the x509v3_config(5) manual page for details of the
extension section format.</p>

<p style="margin-top: 1em">NAME OPTIONS <br>
The nameopt command line switch determines how the subject
and issuer names are displayed. If no nameopt switch is
present the default &quot;oneline&quot; format is used which
is <br>
compatible with previous versions of OpenSSL. Each option is
described in detail below, all options can be preceded by a
- to turn the option off. Only the first four will <br>
normally be used.</p>

<p style="margin-top: 1em">compat <br>
use the old format. This is equivalent to specifying no name
options at all.</p>

<p style="margin-top: 1em">RFC2253 <br>
displays names compatible with RFC2253 equivalent to
esc_2253, esc_ctrl, esc_msb, utf8, dump_nostr, dump_unknown,
dump_der, sep_comma_plus, dn_rev and sname.</p>

<p style="margin-top: 1em">oneline <br>
a oneline format which is more readable than RFC2253. It is
equivalent to specifying the esc_2253, esc_ctrl, esc_msb,
utf8, dump_nostr, dump_der, use_quote, <br>
sep_comma_plus_space, space_eq and sname options.</p>

<p style="margin-top: 1em">multiline <br>
a multiline format. It is equivalent esc_ctrl, esc_msb,
sep_multiline, space_eq, lname and align.</p>

<p style="margin-top: 1em">esc_2253 <br>
escape the &quot;special&quot; characters required by
RFC2253 in a field That is ,+&quot;&lt;&gt;;. Additionally #
is escaped at the beginning of a string and a space
character at the beginning <br>
or end of a string.</p>

<p style="margin-top: 1em">esc_ctrl <br>
escape control characters. That is those with ASCII values
less than 0x20 (space) and the delete (0x7f) character. They
are escaped using the RFC2253 X <br>
are two hex digits representing the character value).</p>

<p style="margin-top: 1em">esc_msb <br>
escape characters with the MSB set, that is with ASCII
values larger than 127.</p>

<p style="margin-top: 1em">use_quote <br>
escapes some characters by surrounding the whole string with
&quot; characters, without the option all escaping is done
with the &nbsp;character.</p>

<p style="margin-top: 1em">utf8 <br>
convert all strings to UTF8 format first. This is required
by RFC2253. If you are lucky enough to have a UTF8
compatible terminal then the use of this option (and not
setting <br>
esc_msb) may result in the correct display of multibyte
(international) characters. Is this option is not present
then multibyte characters larger than 0xff will be <br>
represented using the format UXXXX for 16 bits and WXXXXXXXX
for 32 bits. Also if this option is off any UTF8Strings will
be converted to their character form first.</p>

<p style="margin-top: 1em">no_type <br>
this option does not attempt to interpret multibyte
characters in any way. That is their content octets are
merely dumped as though one octet represents each character.
This <br>
is useful for diagnostic purposes but will result in rather
odd looking output.</p>

<p style="margin-top: 1em">show_type <br>
show the type of the ASN1 character string. The type
precedes the field contents. For example &quot;BMPSTRING:
Hello World&quot;.</p>

<p style="margin-top: 1em">dump_der <br>
when this option is set any fields that need to be hexdumped
will be dumped using the DER encoding of the field.
Otherwise just the content octets will be displayed. Both
<br>
options use the RFC2253 #XXXX... format.</p>

<p style="margin-top: 1em">dump_nostr <br>
dump non character string types (for example OCTET STRING)
if this option is not set then non character string types
will be displayed as though each content octet represents
<br>
a single character.</p>

<p style="margin-top: 1em">dump_all <br>
dump all fields. This option when used with dump_der allows
the DER encoding of the structure to be unambiguously
determined.</p>

<p style="margin-top: 1em">dump_unknown <br>
dump any field whose OID is not recognised by OpenSSL.</p>

<p style="margin-top: 1em">sep_comma_plus,
sep_comma_plus_space, sep_semi_plus_space, sep_multiline
<br>
these options determine the field separators. The first
character is between RDNs and the second between multiple
AVAs (multiple AVAs are very rare and their use is <br>
discouraged). The options ending in &quot;space&quot;
additionally place a space after the separator to make it
more readable. The sep_multiline uses a linefeed character
for the RDN <br>
separator and a spaced + for the AVA separator. It also
indents the fields by four characters.</p>

<p style="margin-top: 1em">dn_rev <br>
reverse the fields of the DN. This is required by RFC2253.
As a side effect this also reverses the order of multiple
AVAs but this is permissible.</p>

<p style="margin-top: 1em">nofname, sname, lname, oid <br>
these options alter how the field name is displayed. nofname
does not display the field at all. sname uses the
&quot;short name&quot; form (CN for commonName for example).
lname uses <br>
the long form. oid represents the OID in numerical form and
is useful for diagnostic purpose.</p>

<p style="margin-top: 1em">align <br>
align field values for a more readable output. Only usable
with sep_multiline.</p>

<p style="margin-top: 1em">space_eq <br>
places spaces round the = character which follows the field
name.</p>

<p style="margin-top: 1em">TEXT OPTIONS <br>
As well as customising the name output format, it is also
possible to customise the actual fields printed using the
certopt options when the text option is present. The default
<br>
behaviour is to print all fields.</p>

<p style="margin-top: 1em">compatible <br>
use the old format. This is equivalent to specifying no
output options at all.</p>

<p style="margin-top: 1em">no_header <br>
don&rsquo;t print header information: that is the lines
saying &quot;Certificate&quot; and &quot;Data&quot;.</p>

<p style="margin-top: 1em">no_version <br>
don&rsquo;t print out the version number.</p>

<p style="margin-top: 1em">no_serial <br>
don&rsquo;t print out the serial number.</p>

<p style="margin-top: 1em">no_signame <br>
don&rsquo;t print out the signature algorithm used.</p>

<p style="margin-top: 1em">no_validity <br>
don&rsquo;t print the validity, that is the notBefore and
notAfter fields.</p>

<p style="margin-top: 1em">no_subject <br>
don&rsquo;t print out the subject name.</p>

<p style="margin-top: 1em">no_issuer <br>
don&rsquo;t print out the issuer name.</p>

<p style="margin-top: 1em">no_pubkey <br>
don&rsquo;t print out the public key.</p>

<p style="margin-top: 1em">no_sigdump <br>
don&rsquo;t give a hexadecimal dump of the certificate
signature.</p>

<p style="margin-top: 1em">no_aux <br>
don&rsquo;t print out certificate trust information.</p>

<p style="margin-top: 1em">no_extensions <br>
don&rsquo;t print out any X509V3 extensions.</p>

<p style="margin-top: 1em">ext_default <br>
retain default extension behaviour: attempt to print out
unsupported certificate extensions.</p>

<p style="margin-top: 1em">ext_error <br>
print an error message for unsupported certificate
extensions.</p>

<p style="margin-top: 1em">ext_parse <br>
ASN1 parse unsupported extensions.</p>

<p style="margin-top: 1em">ext_dump <br>
hex dump unsupported extensions.</p>

<p style="margin-top: 1em">ca_default <br>
the value used by the ca utility, equivalent to no_issuer,
no_pubkey, no_header, no_version, no_sigdump and
no_signame.</p>

<p style="margin-top: 1em">EXAMPLES <br>
Note: in these examples the &rsquo;&acute; means the example
should be all on one line.</p>

<p style="margin-top: 1em">Display the contents of a
certificate:</p>

<p style="margin-top: 1em">openssl x509 -in cert.pem -noout
-text</p>

<p style="margin-top: 1em">Display the certificate serial
number:</p>

<p style="margin-top: 1em">openssl x509 -in cert.pem -noout
-serial</p>

<p style="margin-top: 1em">Display the certificate subject
name:</p>

<p style="margin-top: 1em">openssl x509 -in cert.pem -noout
-subject</p>

<p style="margin-top: 1em">Display the certificate subject
name in RFC2253 form:</p>

<p style="margin-top: 1em">openssl x509 -in cert.pem -noout
-subject -nameopt RFC2253</p>

<p style="margin-top: 1em">Display the certificate subject
name in oneline form on a terminal supporting UTF8:</p>

<p style="margin-top: 1em">openssl x509 -in cert.pem -noout
-subject -nameopt oneline,-esc_msb</p>

<p style="margin-top: 1em">Display the certificate MD5
fingerprint:</p>

<p style="margin-top: 1em">openssl x509 -in cert.pem -noout
-fingerprint</p>

<p style="margin-top: 1em">Display the certificate SHA1
fingerprint:</p>

<p style="margin-top: 1em">openssl x509 -sha1 -in cert.pem
-noout -fingerprint</p>

<p style="margin-top: 1em">Convert a certificate from PEM
to DER format:</p>

<p style="margin-top: 1em">openssl x509 -in cert.pem
-inform PEM -out cert.der -outform DER</p>

<p style="margin-top: 1em">Convert a certificate to a
certificate request:</p>

<p style="margin-top: 1em">openssl x509 -x509toreq -in
cert.pem -out req.pem -signkey key.pem</p>

<p style="margin-top: 1em">Convert a certificate request
into a self signed certificate using extensions for a
CA:</p>

<p style="margin-top: 1em">openssl x509 -req -in careq.pem
-extfile openssl.cnf -extensions v3_ca -signkey key.pem -out
cacert.pem</p>

<p style="margin-top: 1em">Sign a certificate request using
the CA certificate above and add user certificate
extensions:</p>

<p style="margin-top: 1em">openssl x509 -req -in req.pem
-extfile openssl.cnf -extensions v3_usr -CA cacert.pem
-CAkey key.pem -CAcreateserial</p>

<p style="margin-top: 1em">Set a certificate to be trusted
for SSL client use and change set its alias to
&quot;Steve&rsquo;s Class 1 CA&quot;</p>

<p style="margin-top: 1em">openssl x509 -in cert.pem
-addtrust clientAuth -setalias &quot;Steve&rsquo;s Class 1
CA&quot; -out trust.pem</p>

<p style="margin-top: 1em">NOTES <br>
The PEM format uses the header and footer lines:</p>

<p style="margin-top: 1em">-----BEGIN CERTIFICATE----- <br>
-----END CERTIFICATE-----</p>

<p style="margin-top: 1em">it will also handle files
containing:</p>

<p style="margin-top: 1em">-----BEGIN X509 CERTIFICATE-----
<br>
-----END X509 CERTIFICATE-----</p>

<p style="margin-top: 1em">Trusted certificates have the
lines</p>

<p style="margin-top: 1em">-----BEGIN TRUSTED
CERTIFICATE----- <br>
-----END TRUSTED CERTIFICATE-----</p>

<p style="margin-top: 1em">The conversion to UTF8 format
used with the name options assumes that T61Strings use the
ISO8859-1 character set. This is wrong but Netscape and MSIE
do this as do many <br>
certificates. So although this is incorrect it is more
likely to display the majority of certificates
correctly.</p>

<p style="margin-top: 1em">The -fingerprint option takes
the digest of the DER encoded certificate. This is commonly
called a &quot;fingerprint&quot;. Because of the nature of
message digests the fingerprint of a <br>
certificate is unique to that certificate and two
certificates with the same fingerprint can be considered to
be the same.</p>

<p style="margin-top: 1em">The Netscape fingerprint uses
MD5 whereas MSIE uses SHA1.</p>

<p style="margin-top: 1em">The -email option searches the
subject name and the subject alternative name extension.
Only unique email addresses will be printed out: it will not
print the same address more <br>
than once.</p>

<p style="margin-top: 1em">CERTIFICATE EXTENSIONS <br>
The -purpose option checks the certificate extensions and
determines what the certificate can be used for. The actual
checks done are rather complex and include various hacks and
<br>
workarounds to handle broken certificates and software.</p>

<p style="margin-top: 1em">The same code is used when
verifying untrusted certificates in chains so this section
is useful if a chain is rejected by the verify code.</p>

<p style="margin-top: 1em">The basicConstraints extension
CA flag is used to determine whether the certificate can be
used as a CA. If the CA flag is true then it is a CA, if the
CA flag is false then it <br>
is not a CA. All CAs should have the CA flag set to
true.</p>

<p style="margin-top: 1em">If the basicConstraints
extension is absent then the certificate is considered to be
a &quot;possible CA&quot; other extensions are checked
according to the intended use of the <br>
certificate. A warning is given in this case because the
certificate should really not be regarded as a CA: however
it is allowed to be a CA to work around some broken
software.</p>

<p style="margin-top: 1em">If the certificate is a V1
certificate (and thus has no extensions) and it is self
signed it is also assumed to be a CA but a warning is again
given: this is to work around the <br>
problem of Verisign roots which are V1 self signed
certificates.</p>

<p style="margin-top: 1em">If the keyUsage extension is
present then additional restraints are made on the uses of
the certificate. A CA certificate must have the keyCertSign
bit set if the keyUsage <br>
extension is present.</p>

<p style="margin-top: 1em">The extended key usage extension
places additional restrictions on the certificate uses. If
this extension is present (whether critical or not) the key
can only be used for the <br>
purposes specified.</p>

<p style="margin-top: 1em">A complete description of each
test is given below. The comments about basicConstraints and
keyUsage and V1 certificates above apply to all CA
certificates.</p>

<p style="margin-top: 1em">SSL Client <br>
The extended key usage extension must be absent or include
the &quot;web client authentication&quot; OID. keyUsage must
be absent or it must have the digitalSignature bit set. <br>
Netscape certificate type must be absent or it must have the
SSL client bit set.</p>

<p style="margin-top: 1em">SSL Client CA <br>
The extended key usage extension must be absent or include
the &quot;web client authentication&quot; OID. Netscape
certificate type must be absent or it must have the SSL CA
bit set: <br>
this is used as a work around if the basicConstraints
extension is absent.</p>

<p style="margin-top: 1em">SSL Server <br>
The extended key usage extension must be absent or include
the &quot;web server authentication&quot; and/or one of the
SGC OIDs. keyUsage must be absent or it must have the <br>
digitalSignature, the keyEncipherment set or both bits set.
Netscape certificate type must be absent or have the SSL
server bit set.</p>

<p style="margin-top: 1em">SSL Server CA <br>
The extended key usage extension must be absent or include
the &quot;web server authentication&quot; and/or one of the
SGC OIDs. Netscape certificate type must be absent or the
SSL CA <br>
bit must be set: this is used as a work around if the
basicConstraints extension is absent.</p>

<p style="margin-top: 1em">Netscape SSL Server <br>
For Netscape SSL clients to connect to an SSL server it must
have the keyEncipherment bit set if the keyUsage extension
is present. This isn&rsquo;t always valid because some <br>
cipher suites use the key for digital signing. Otherwise it
is the same as a normal SSL server.</p>

<p style="margin-top: 1em">Common S/MIME Client Tests <br>
The extended key usage extension must be absent or include
the &quot;email protection&quot; OID. Netscape certificate
type must be absent or should have the S/MIME bit set. If
the <br>
S/MIME bit is not set in netscape certificate type then the
SSL client bit is tolerated as an alternative but a warning
is shown: this is because some Verisign certificates <br>
don&rsquo;t set the S/MIME bit.</p>

<p style="margin-top: 1em">S/MIME Signing <br>
In addition to the common S/MIME client tests the
digitalSignature bit must be set if the keyUsage extension
is present.</p>

<p style="margin-top: 1em">S/MIME Encryption <br>
In addition to the common S/MIME tests the keyEncipherment
bit must be set if the keyUsage extension is present.</p>

<p style="margin-top: 1em">S/MIME CA <br>
The extended key usage extension must be absent or include
the &quot;email protection&quot; OID. Netscape certificate
type must be absent or must have the S/MIME CA bit set: this
is <br>
used as a work around if the basicConstraints extension is
absent.</p>

<p style="margin-top: 1em">CRL Signing <br>
The keyUsage extension must be absent or it must have the
CRL signing bit set.</p>

<p style="margin-top: 1em">CRL Signing CA <br>
The normal CA tests apply. Except in this case the
basicConstraints extension must be present.</p>

<p style="margin-top: 1em">BUGS <br>
Extensions in certificates are not transferred to
certificate requests and vice versa.</p>

<p style="margin-top: 1em">It is possible to produce
invalid certificates or requests by specifying the wrong
private key or using inconsistent options in some cases:
these should be checked.</p>

<p style="margin-top: 1em">There should be options to
explicitly set such things as start and end dates rather
than an offset from the current time.</p>

<p style="margin-top: 1em">The code to implement the verify
behaviour described in the TRUST SETTINGS is currently being
developed. It thus describes the intended behaviour rather
than the current <br>
behaviour. It is hoped that it will represent reality in
OpenSSL 0.9.5 and later.</p>

<p style="margin-top: 1em">SEE ALSO <br>
req(1), ca(1), genrsa(1), gendsa(1), verify(1),
x509v3_config(5)</p>

<p style="margin-top: 1em">HISTORY <br>
Before OpenSSL 0.9.8, the default digest for RSA keys was
MD5.</p>

<p style="margin-top: 1em">The hash algorithm used in the
-subject_hash and -issuer_hash options before OpenSSL 1.0.0
was based on the deprecated MD5 algorithm and the encoding
of the distinguished name. <br>
In OpenSSL 1.0.0 and later it is based on a canonical
version of the DN using SHA1. This means that any
directories using the old form must have their links rebuilt
using <br>
c_rehash or similar.</p>

<p style="margin-top: 1em">1.0.1e 2017-02-20 X509(1)</p>
<hr>
</body>
</html>
