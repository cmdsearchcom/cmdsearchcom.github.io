<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:30:27 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>PENCTL(1) General Commands Manual PENCTL(1)</p>

<p style="margin-top: 1em">NAME <br>
penctl - control a running pen load balancer</p>

<p style="margin-top: 1em">SYNOPSIS <br>
penctl host:port|/path/to/socket command</p>

<p style="margin-top: 1em">EXAMPLE <br>
penctl lbhost:8888 roundrobin</p>

<p style="margin-top: 1em">Turns off client tracking on the
load balancer running on lbhost.</p>

<p style="margin-top: 1em">penctl /var/run/pen/tmp/ctrl
status</p>

<p style="margin-top: 1em">Prints status information in
html format.</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Penctl connects to the optional control socket on a pen load
balancer. It reads commands from the command line, performs
minimal syntax checking and sends them to pen. Replies, <br>
if any, are printed on stdout.</p>

<p style="margin-top: 1em">The program can also be used
through the cgi script penctl.cgi, which allows pen to be
controlled from any web browser.</p>

<p style="margin-top: 1em">OPTIONS <br>
host:port <br>
Specifies a control port where the load balancer listens for
commands.</p>

<p style="margin-top: 1em">COMMANDS <br>
abort_on_error <br>
Call abort() when a fatal error is encountered. This will
create a core file which allows further troubleshooting.
Disabled by default.</p>

<p style="margin-top: 1em">no abort_on_error <br>
Exit normally on fatal error with an error code which
indicates failure.</p>

<p style="margin-top: 1em">acl N permit|deny sourceip4
[mask] <br>
Adds an entry to access list N, where N is a number from 0
to 9. The source and mask addresses are in the usual dotted
quad notation. If mask is omitted, it defaults to <br>
255.255.255.255.</p>

<p style="margin-top: 1em">acl N permit|deny
sourceip6[/length] <br>
If the source address contains the character
&rsquo;:&rsquo;, the address is interpreted as IPv6. Unlike
IPv4 access entries, a length is used to indicate the mask.
If length is omit&acirc; <br>
ted, it defaults to 128.</p>

<p style="margin-top: 1em">acl N permit|deny country NN
<br>
If the source address is the special word
&quot;country&quot;, a two-letter country code can be used
to restrict access to the load balancer. For this to work,
pen must be built <br>
with geoip support.</p>

<p style="margin-top: 1em">no acl N <br>
Deletes all entries from access list N. The resulting access
list permits all traffic.</p>

<p style="margin-top: 1em">ascii Communication dumps in
ascii format (cf option -a).</p>

<p style="margin-top: 1em">no ascii <br>
Communication dumps in hex format.</p>

<p style="margin-top: 1em">blacklist <br>
Return current blacklist time in seconds.</p>

<p style="margin-top: 1em">blacklist T <br>
Set the blacklist time in seconds.</p>

<p style="margin-top: 1em">block Do not make sockets
nonblocking. This is obsolete as of 0.26.0 and does
nothing.</p>

<p style="margin-top: 1em">no block <br>
Make sockets nonblocking.</p>

<p style="margin-top: 1em">client_acl N <br>
Check connecting clients against access list N (default
0).</p>

<p style="margin-top: 1em">clients_max [N] <br>
With argument, increase the maximum number of known clients.
Returns max number of clients.</p>

<p style="margin-top: 1em">close N <br>
Close connection N</p>

<p style="margin-top: 1em">connection N <br>
Display some basic information about connection N.</p>

<p style="margin-top: 1em">conn_max [N] <br>
With argument, increase the max number of simultaneous
connections. Returns max number.</p>

<p style="margin-top: 1em">control <br>
Return address and port where pen listens for control
connections.</p>

<p style="margin-top: 1em">control_acl N <br>
Check accesses to the control port against access list N
(default 0).</p>

<p style="margin-top: 1em">debug Return current debug
level.</p>

<p style="margin-top: 1em">debug N <br>
Set debug level to N.</p>

<p style="margin-top: 1em">delayed_forward <br>
Always wait for the next round of the main loop before
forwarding data. Normally pen tries to do that immediately.
This is obsolete as of 0.26.0 and does nothing.</p>

<p style="margin-top: 1em">no delayed_forward <br>
Try to forward data immediately, to avoid the overhead of
copying it to a temporary buffer and waiting for the next
main loop round.</p>

<p style="margin-top: 1em">dsr_if IF <br>
Use IF as the interface for Direct Server Return.</p>

<p style="margin-top: 1em">dummy Act as a dummy web server
with very limited functionality but high performance. Only
useful for testing. Disabled by default.</p>

<p style="margin-top: 1em">no dummy <br>
Do not act as a dummy web server.</p>

<p style="margin-top: 1em">epoll Use epoll for event
management (Linux). This is the default on Linux.</p>

<p style="margin-top: 1em">exit Exit. Only available if pen
was started with the -X option.</p>

<p style="margin-top: 1em">hash Use a hash on the client IP
address for initial server selection.</p>

<p style="margin-top: 1em">no hash <br>
Do not use a hash.</p>

<p style="margin-top: 1em">http Add X-Forwarded-For headers
to http requests.</p>

<p style="margin-top: 1em">no http <br>
Do not add X-Forwarded-For headers.</p>

<p style="margin-top: 1em">idle_timeout N <br>
Close connections that have been inactive for N seconds.
Default 0 = never close.</p>

<p style="margin-top: 1em">idlers [N] <br>
Create N reliable idle connections to the backend servers.
Without argument, display the current/requested number of
reliable idlers.</p>

<p style="margin-top: 1em">include FILE <br>
Read commands from file.</p>

<p style="margin-top: 1em">kqueue Use kqueue for event
management (FreeBSD, NetBSD, OpenBSD). This is the default
on the systems that have it.</p>

<p style="margin-top: 1em">listen Return local address and
port pen listens to for incoming client connections.</p>

<p style="margin-top: 1em">listen [address:]:port <br>
Close the listening socket and reopen using specified
address (optional) and port.</p>

<p style="margin-top: 1em">log Show where pen is logging,
if anywhere.</p>

<p style="margin-top: 1em">log FILE <br>
Log to FILE.</p>

<p style="margin-top: 1em">mode Write a summary of the
current mode of operation. The listed modes are block,
delayed_forward, hash, roundrobin, stubborn.</p>

<p style="margin-top: 1em">no log Turn off logging.</p>

<p style="margin-top: 1em">pending_max N <br>
Max allowed number of pending nonblocking connections.
Default 100, minimum 1.</p>

<p style="margin-top: 1em">pid Return the process id of the
running daemon.</p>

<p style="margin-top: 1em">poll Use poll for event
management.</p>

<p style="margin-top: 1em">prio Use the priority based
algorithm.</p>

<p style="margin-top: 1em">no prio <br>
Do not use the priority based algorithm.</p>

<p style="margin-top: 1em">recent [N] <br>
Shows which clients have connected in the last N seconds
(default 300).</p>

<p style="margin-top: 1em">roundrobin <br>
Use round-robin server selection without client tracking</p>

<p style="margin-top: 1em">no roundrobin</p>

<p style="margin-top: 1em">select Use select for event
management.</p>

<p style="margin-top: 1em">server N [ acl A
|&Acirc;&nbsp;address A | port P | max M | hard H |
blacklist T | weight W | prio P ] <br>
Change acl, address, port, weight, priority and/or max
connections for server N, or blacklist it for T seconds.</p>

<p style="margin-top: 1em">servers <br>
List address, port, weight, priority and max number of
simultaneous connections for each remote server.</p>

<p style="margin-top: 1em">socket N <br>
Show to which connection socket N belongs.</p>

<p style="margin-top: 1em">source IP <br>
Set the local address to IP for upstream connections, i.e.
where Pen connects to backend servers.</p>

<p style="margin-top: 1em">ssl_ciphers CIPHERS <br>
Choose list of available SSL ciphers, specified in the
format described in
https://www.openssl.org/docs/apps/ciphers.html.</p>


<p style="margin-top: 1em">ssl_client_renegotiation_interval
S <br>
Allowing the client to request renegotiation is a potential
denial of service vector. This command specifies the minimum
number of seconds the client has to wait between <br>
requests for renegotiation requests. Default 3600 =
effectively disabled.</p>

<p style="margin-top: 1em">ssl_ocsp_response FILENAME <br>
Specifies the location of a file containing a pre-fetched
OCSP response. The file must be refreshed regularly by a
cron job or similar and the ssl_ocsp_response command <br>
repeated to make Pen re-read the file..</p>

<p style="margin-top: 1em">ssl_option OPTION <br>
Manipulate SSL options. The available options are no_sslv2,
no_sslv3, no_tlsv1, no_tlsv1.1, no_tlsv1.2,
cipher_server_preference. Use the command multiple times to
specify <br>
multiple options.</p>

<p style="margin-top: 1em">ssl_sni_path PATH <br>
This command enables the Server Name Indication TLS
extension by specifying a directory where domain.key,
domain.crt and domain.ca files can be found.</p>

<p style="margin-top: 1em">status Print status information
in html format.</p>

<p style="margin-top: 1em">stubborn <br>
If the initial server selection is unavailable, close the
client connection without trying another</p>

<p style="margin-top: 1em">no stubborn</p>

<p style="margin-top: 1em">tarpit_acl [N] <br>
Used in DSR mode. If N is an existing access list, Pen will
reply to ARP requests for IP addresses that match the access
list, and reply with SYN+ACK to TCP SYN requests <br>
to these addresses. The result is that someone trying to
scan a network will be slowed down by a large number of
false positives.</p>

<p style="margin-top: 1em">tcp_fastclose up|down|both|off
<br>
Close both sockets to upstream and downstream if one of them
closes theirs. Default = off.</p>

<p style="margin-top: 1em">tcp_nodelay <br>
Set TCP_NODELAY on sockets, effectively turning off the
Nagle algorithm.</p>

<p style="margin-top: 1em">no tcp_nodelay <br>
Do not set TCP_NODELAY on sockets. This is the default.</p>

<p style="margin-top: 1em">timeout <br>
Return current connect timeout in seconds.</p>

<p style="margin-top: 1em">timeout N <br>
Set connect timeout to N seconds.</p>

<p style="margin-top: 1em">tracking N <br>
Set tracking time, i.e. how long clients will be remembered.
The default 0 will never expire clients based on time.</p>

<p style="margin-top: 1em">transparent <br>
On compatible platforms, use the client&rsquo;s address as
source address in the connection to the backend server.</p>

<p style="margin-top: 1em">no transparent <br>
Use Pen&rsquo;s address as source address in the connection
to the backend server.</p>

<p style="margin-top: 1em">web_stats <br>
Return file name of html status reports, if any.</p>

<p style="margin-top: 1em">web_stats FILE <br>
Set the name of html status reports.</p>

<p style="margin-top: 1em">no web_stats <br>
Do not generate html status reports.</p>

<p style="margin-top: 1em">weight Use weight for server
selection.</p>

<p style="margin-top: 1em">no weight <br>
Do not use weight for server selection.</p>

<p style="margin-top: 1em">write [FILE] <br>
Write the current configuration into a file which can be
used to start pen. If FILE is omitted, the configuration is
written into pen&rsquo;s original configuration file.</p>

<p style="margin-top: 1em">SEE ALSO <br>
pen(1)</p>

<p style="margin-top: 1em">AUTHOR <br>
Copyright (C) 2002-2015 Ulric Eriksson,
&lt;ulric@siag.nu&gt;.</p>

<p style="margin-top: 1em">LOCAL PENCTL(1)</p>
<hr>
</body>
</html>
