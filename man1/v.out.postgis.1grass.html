<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>v.out.postgis(1grass)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">v.out.postgis(1grass)</td>
    <td class="head-vol">Grass User's Manual</td>
    <td class="head-rtitle">v.out.postgis(1grass)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<i></i><b>v.out.postgis</b> - Exports a vector map layer to PostGIS feature
  table.
<h1 class="Sh" title="Sh" id="KEYWORDS"><a class="selflink" href="#KEYWORDS">KEYWORDS</a></h1>
vector, export, PostGIS, simple features, topology, 3D
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>v.out.postgis</b>
<div>&#x00A0;</div>
<b>v.out.postgis --help</b>
<div>&#x00A0;</div>
<b>v.out.postgis</b> [-<b>tl2</b>] <b>input</b>=<i>name</i>
  [<b>type</b>=<i>string</i>[, <i>string</i>,...]] [<b>layer</b>=<i>string</i>]
  <b>output</b>=<i>string</i> [<b>output_layer</b>=<i>name</i>]
  [<b>output_link</b>= <i>name</i>]
  [<b>options</b>=<i>key=value</i>[,<i>key=value</i>,...]] [-- <b>overwrite</b>]
  [-- <b>help</b>] [--<b>verbose</b>] [--<b>quiet</b>] [--<b>ui</b>]
<h2 class="Ss" title="Ss" id="Flags:"><a class="selflink" href="#Flags:">Flags:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-t</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Do not export attribute table</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Export PostGIS topology instead of simple features</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-2</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Force 2D output even if input is 3D
    <div>&#x00A0;</div>
    Useful if input is 3D but all z coordinates are identical</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--overwrite</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Allow output files to overwrite existing files</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Print usage summary</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verbose</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Verbose module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--quiet</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Quiet module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ui</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Force launching GUI dialog</dd>
</dl>
<h2 class="Ss" title="Ss" id="Parameters:"><a class="selflink" href="#Parameters:">Parameters:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>input</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input vector map</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>type</b>=<i>string[,</i><i>string</i>,...]</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Input feature type
    <div>&#x00A0;</div>
    Options: <i>point, line, boundary, centroid, area, face, kernel, auto</i>
    <div>&#x00A0;</div>
    Default: <i>auto</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>layer</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Layer number or name
    <div>&#x00A0;</div>
    Default: <i>1</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>output</b>=<i>string</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name for output PostGIS datasource
    <div>&#x00A0;</div>
    Starts with &#x2019;PG&#x2019; prefix, eg.
    &#x2019;PG:dbname=grass&#x2019;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>output_layer</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name for output PostGIS layer
    <div>&#x00A0;</div>
    If not specified, input name is used</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>output_link</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name for output vector map defined as a link to the PostGIS feature table
    <div>&#x00A0;</div>
    If not specified, the vector link is not created. The link can be also
      manually created by &#x2019;v.external&#x2019; module.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>options</b>=<i>key=value[,</i><i>key=value</i>,...]</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Creation options
    <div>&#x00A0;</div>
    Examples:
    <div>&#x00A0;</div>
    &#x2019;FID=cat&#x2019;: define feature id column &#x2019;cat&#x2019;
    <div>&#x00A0;</div>
    &#x2019;GEOMETRY_NAME=wkb_geometry&#x2019;: define geometry column
      &#x2019;wkb_geometry&#x2019;
    <div>&#x00A0;</div>
    &#x2019;SPATIAL_INDEX=NO&#x2019;: do not create spatial index on geometry
      column</dd>
</dl>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<i>v.out.postgis</i> exports an existing GRASS vector map layer to PostGIS
  feature table. Features without category are skipped.
<div class="Pp"></div>
By default GRASS GIS topological features are converted into simple features
  (see OGC Simple Feature Access specification for details). Flag <b>-l</b>
  allows to export vector features as topological elements stored in PostGIS
  Topology schema. Note that topological export requires PostGIS version 2 or
  later.
<div class="Pp"></div>
Additional creation options can be defined by <b>options</b> parameter:
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">FID=&lt;column&gt; - name of column which will be used as
      primary key (feature id), default: fid</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">GEOMETRY_NAME=&lt;column&gt; name of column which will be
      used for storing geometry data in feature table, default: geom</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">SPATIAL_INDEX=YES|NO - enable/disable creating spatial
      index on geometry column, default: YES</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">PRIMARY_KEY=YES|NO - enable/disable adding primary key on
      FID column, default: YES</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">SRID=&lt;value&gt; - spatial reference identifier, default:
      not defined</dd>
</dl>
</div>
PostGIS Topology related options (relevant only for <b>-l</b> flag):
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">TOPOSCHEMA_NAME=&lt;schema name&gt; - name of PostGIS
      Topology schema, default: topo_&lt;input&gt;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">TOPOGEOM_NAME=&lt;column&gt; - name of column which will be
      used for storing topogeometry data in feature table, default: topo</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">TOPO_TOLERANCE=&lt;value&gt; - tolerance for PostGIS
      Topology schema, see CreateTopology function for defails, default: 0</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">TOPO_GEO_ONLY=YES|NO - store in PostGIS Topology schema
      only data relevant to Topo-Geo data model, default: NO</dd>
</dl>
</div>
<div class="Pp"></div>
Creation <b>options</b> are comma-separated pairs (key=value), the options are
  case-insensitive. Note that <b>options</b> defined by <i>v.external.out</i>
  are ignored by <i>v.out.postgis</i>.
<div class="Pp"></div>
<i>v.out.postgis</i> optionally also creates a new vector map in the current
  mapset if <b>output_link</b> is defined.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
By default <i>v.out.postgis</i> exports vector data as <i>simple</i>
  <i>features</i>, ie. boundaries and centroids (forming topological areas)
  become polygons, isles become holes. Geometry of simple feature elements is
  stored in PostGIS feature table in the column named &quot;geom&quot;. Name of
  the geometry column can be changed by
  <b>options=</b>GEOMETRY_NAME=&lt;column&gt;. Note that for exporting vector
  features as simple features can be alternatively used PostgreSQL driver from
  OGR library through <i>v.out.ogr</i> module.
<div class="Pp"></div>
Also note that it&#x2019;s allowed to store in the feature table only features
  of the same type, ie. mixing of points and lines is not currently possible.
  The feature type is determined for output feature table from the first vector
  feature accessing data sequentially ( <b>type=auto</b>). Vector features of
  other types are during export skipped. User can choose preferable feature type
  by <b>type</b> parameter. Only single type is currently allowed (see TODO
  section for details).
<div class="Pp"></div>
<i>v.out.postgis</i> currently supports only three basic output simple feature
  types: Points, Linestrings and Polygons. Also 3D features of the same type are
  supported, eg. 3D points are exported as PointZ simple feature. Faces are
  exported as 3D polygons. 3D features are written to the output automatically
  if input vector map is 3D. If <b>-2</b> flag is given then the output is
  always 2D (z-coordinate is silently ignored for 3D input vector maps).
<div class="Pp"></div>
Multigeometries are not currently supported. Features with the same category are
  exported as multiple singe features.
<div class="Pp"></div>
<i>v.out.postgis</i> also allows exporting vector features as <i>topological
  elements</i> in PostGIS Topology schema. PostGIS Topology extension uses three
  tables to store basic topological elements which forms topological objects
  like areas or isles in GRASS terminology. <i>Nodes</i> (0-dimensional
  topological elements) are stored in &quot;node&quot; table, <i>edges</i>
  (1-dimensional elements) in &quot;edge&quot; table and <i>faces</i>
  (2-dimensional elements) in &quot;face&quot; table.
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">GRASS nodes are stored in <i>node</i> table</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">GRASS points are stored in <i>node</i> table as regular
      nodes</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">GRASS centroids are stored in <i>node</i> table as regular
      nodes (&quot;containing_face&quot; refers to related area)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">GRASS lines are stored in <i>edge</i> table</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">GRASS boundaries are stored in <i>edge</i> table</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">GRASS areas are stored in <i>face</i> table</dd>
</dl>
</div>
Tables <i>node</i>, <i>edge</i> and <i>face</i> are stored in given topological
  schema. By default <i>v.out.postgis</i> defines its name as
  topo_&lt;input&gt;. Alternatively, the name for topology schema can be defined
  by <b>options=</b>TOPOSCHEMA_NAME=&lt;name&gt;.
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<h2 class="Ss" title="Ss" id="Export_Simple_Features"><a class="selflink" href="#Export_Simple_Features">Export
  Simple Features</a></h2>
Export vector map &quot;urbanarea&quot; as feature table &quot;urbanarea&quot;
  located in database &quot;grass&quot;, schema &quot;public&quot;. Note that
  this database schema is automatically used when not defined by the user.
<div>&#x00A0;</div>
<pre>
v.out.postgis input=urbanarea output=&quot;PG:dbname=grass&quot;
</pre>
GRASS areas are converted into polygons, isles into holes. We can check the
  number or created polygons by simple SQL query below.
<div>&#x00A0;</div>
<pre>
db.select driver=pg database=grass \
 sql=&quot;SELECT ST_GeometryType(geom) as geom_type, count(*) from urbanarea group by geom_type&quot;
geom_type|count
ST_Polygon|657
</pre>
<i>Note:</i> same procedure can be done by <i>v.out.ogr</i> module, eg.
<div>&#x00A0;</div>
<pre>
v.out.ogr input=urbanarea output=&quot;PG:dbname=grass&quot; format=PostgreSQL
</pre>
In this case GRASS vector data are exported to PostGIS database using OGR
  library, namely using PostgreSQL driver. Contrary to the <i>v.out.ogr</i>
  module, <i>v.out.postgis</i> is using directly PostGIS data provider which is
  part of GRASS vector engine. Beside that, <i>v.out.postgis</i> is optimized
  for PostGIS export including topological access to the data.
<h2 class="Ss" title="Ss" id="Export_data_into_specific_database_schema"><a class="selflink" href="#Export_data_into_specific_database_schema">Export
  data into specific database schema</a></h2>
Database schema for storing exported data can be defined by <b>output_layer</b>
  as &lt;schema_name&gt;.&lt;table_name&gt;. If the specified schema
  doesn&#x2019;t exist in the database, then it&#x2019;s automatically created.
<div class="Pp"></div>
Export vector map &quot;bridges&quot; as feature table in database schema
  &quot;grassout&quot;.
<div>&#x00A0;</div>
<pre>
v.out.postgis input=bridges output=&quot;PG:dbname=grass&quot; output_layer=grassout.bridges
</pre>
<h2 class="Ss" title="Ss" id="Export_data_with_creation_options"><a class="selflink" href="#Export_data_with_creation_options">Export
  data with creation options</a></h2>
Example below demonstrates how to define name for geometry column and disable
  building spatial index. Spatial reference system is defined by srid identifier
  which corresponds in this case with EPSG 3358 (North Carolina dataset).
<div>&#x00A0;</div>
<pre>
v.out.postgis input=roadsmajor output=&quot;PG:dbname=grass&quot; options=&quot;GEOMETRY_NAME=wkb_geometry,SPATIAL_INDEX=NO,SRID=3358&quot;
</pre>
<h2 class="Ss" title="Ss" id="Link_exported_data"><a class="selflink" href="#Link_exported_data">Link
  exported data</a></h2>
Exported data can be linked as vector map created in the current mapset by
  specifying <b>output_link</b> parameter. In the example below vector map
  &quot;busstopsall&quot; from PERMANENT mapset is exported into
  &quot;grass&quot; PostGIS database. <i>v.out.postgis</i> after successful
  export also creates in the current mapset GRASS vector map as a link to the
  PostGIS feature table.
<div>&#x00A0;</div>
<pre>
v.out.postgis input=busstopsall@PERMANENT output=&quot;PG:dbname=grass&quot; output_link=busstopsall_pg
</pre>
Created link can be checked by <i>v.info</i>:
<div>&#x00A0;</div>
<pre>
 v.info busstopsall_pg
...
 |----------------------------------------------------------------------------|
 | Map format:      PostGIS (PostgreSQL)                                      |
 | DB table:        public.busstopsall                                        |
 | DB name:         grass                                                     |
 | Geometry column: geom                                                      |
 | Feature type:    point                                                     |
 | Topology:        pseudo (simple features)                                  |
 |----------------------------------------------------------------------------|
...
</pre>
<h2 class="Ss" title="Ss" id="Export_data_without_attributes"><a class="selflink" href="#Export_data_without_attributes">Export
  data without attributes</a></h2>
<i>v.out.postgis</i> allows ignoring attributes when exporting vector features
  by specifying <b>-t</b> flag. Command below exports vector features without
  attributes. The feature will contain only two columns, the fid and geometry
  column.
<div>&#x00A0;</div>
<pre>
v.out.postgis -t input=railroads output=&quot;PG:dbname=grass&quot;
</pre>
<h2 class="Ss" title="Ss" id="Export_topological_data"><a class="selflink" href="#Export_topological_data">Export
  topological data</a></h2>
By default <i>v.out.postgis</i> exports data as simple features. Flag <b>-l</b>
  allows exporting data as topological elements instead of simple features.
  Export topological elements is stored in PostGIS Topology schema.
<div>&#x00A0;</div>
<pre>
v.out.postgis -l input=busroutesall output=&quot;PG:dbname=grass&quot;
</pre>
For more info about PostGIS Topology implementation in GRASS see the wiki page.
<h1 class="Sh" title="Sh" id="TODO"><a class="selflink" href="#TODO">TODO</a></h1>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Multi-feature export</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Allow mixed features (points, lines)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Support other simple feature types like GeometryCollection
      and others</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Implement missing options from <i>v.out.ogr</i>: <b>-a</b>,
      <b>-s</b>, <b>-c</b>, <b>-p</b>, <b>-n</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Add options: <b>cats</b>, <b>where</b></dd>
</dl>
</div>
<h1 class="Sh" title="Sh" id="REQUIREMENTS"><a class="selflink" href="#REQUIREMENTS">REQUIREMENTS</a></h1>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">PostGIS 2.x or later for topological export (flag
      <b>-l</b>)</dd>
</dl>
</div>
<h1 class="Sh" title="Sh" id="REFERENCES"><a class="selflink" href="#REFERENCES">REFERENCES</a></h1>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">OGC Simple Feature Access specification</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">PostGIS Topology documentation</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">GRASS-PostGIS data provider</dd>
</dl>
</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i></i> <i>v.out.ogr,</i> <i>v.external,</i> <i>v.external.out,</i>
  <i>v.in.ogr</i> <i></i>
<div class="Pp"></div>
See also PostGIS and PostGIS Topology wiki page from GRASS User Wiki.
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Martin Landa, Czech Technical University in Prague, Czech Republic (development
  supported by Fondazione Edmund Mach and Comune di Trento, Italy)
<div class="Pp"></div>
<i>Last changed: $Date: 2015-11-24 09:07:58 +0100 (Tue, 24 Nov 2015) $</i>
<h1 class="Sh" title="Sh" id="SOURCE_CODE"><a class="selflink" href="#SOURCE_CODE">SOURCE
  CODE</a></h1>
Available at: v.out.postgis source code (history)
<div class="Pp"></div>
Main index | Vector index | Topics index | Keywords index | Graphical index |
  Full index
<div class="Pp"></div>
&#x00A9; 2003-2016 GRASS Development Team, GRASS GIS 7.2.0 Reference
  Manual</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os">GRASS 7.2.0</td>
  </tr>
</table>
</body>
</html>
