<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>AVOCADO(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">AVOCADO(1)</td>
    <td class="head-vol"></td>
    <td class="head-rtitle">AVOCADO(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
avocado - test runner command line tool
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>avocado [-h] [-v] [--config [CONFIG_FILE]] [--show
    [STREAM[:LVL]]] [-s]</b></dt>
  <dd class="It-tag">{config,diff,distro,exec-path,list,multiplex,plugins,run,sysinfo}
      ...</dd>
</dl>
</div>
<br/>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
Avocado is a modern test framework that is built on the experience accumulated
  with <i>autotest</i> (<i>http://autotest.github.io</i>).
<div style="height: 1.00em;">&#x00A0;</div>
<i>avocado</i> is also the name of its test runner command line tool, described
  in this man page.
<div style="height: 1.00em;">&#x00A0;</div>
For more information about the Avocado project, please check its website:
  <i>http://avocado-framework.github.io/</i>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
The following list of options are builtin, application level <i>avocado</i>
  options. Most other options are implemented via plugins and will depend on
  them being loaded ( <i>avocado --help</i>):
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
-h, --help            show this help message and exit
-v, --version         show program's version number and exit
--config [CONFIG_FILE]
                      Use custom configuration from a file
--show [STREAM[:LVL]]
                      List of comma separated builtin logs, or logging
                      streams optionally followed by LEVEL (DEBUG,INFO,...).
                      Builtin streams are: &quot;test&quot;: test output; &quot;debug&quot;:
                      tracebacks and other debugging info; &quot;app&quot;:
                      application output; &quot;early&quot;: early logging of other
                      streams, including test (very verbose); &quot;remote&quot;:
                      fabric/paramiko debug; &quot;all&quot;: all builtin streams;
                      &quot;none&quot;: disables regular output (leaving only errors
                      enabled). By default: 'app'
-s, --silent          disables regular output (leaving only errors enabled)
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Real use of avocado depends on running avocado subcommands. This a typical list
  of avocado subcommands:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
config              Shows avocado config keys
diff                Shows the difference between 2 jobs.
distro              Shows detected Linux distribution
exec-path           Returns path to avocado bash libraries and exits.
list                List available tests
multiplex           Tool to analyze and visualize test variants and params
plugins             Displays plugin information
run                 Runs one or more tests (native test, test alias,
                    binary or script)
sysinfo             Collect system information
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
To get usage instructions for a given subcommand, run it with <i>--help</i>.
  Example:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado run --help
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Options for subcommand <i>run</i> (<i>avocado run --help</i>):
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
positional arguments:
  TEST_REFERENCE        List of test references (aliases or paths)
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  -d, --dry-run         Instead of running the test only list them and log
                        their params.
  --force-job-id UNIQUE_JOB_ID
                        Forces the use of a particular job ID. Used internally
                        when interacting with an avocado server. You should
                        not use this option unless you know exactly what
                        you're doing
  --job-results-dir DIRECTORY
                        Forces to use of an alternate job results directory.
  --job-timeout SECONDS
                        Set the maximum amount of time (in SECONDS) that tests
                        are allowed to execute. Values &lt;= zero means &quot;no
                        timeout&quot;. You can also use suffixes, like: s
                        (seconds), m (minutes), h (hours).
  --failfast {on,off}   Enable or disable the job interruption on first failed
                        test.
  --keep-tmp {on,off}   Keep job temporary files (useful for avocado
                        debugging). Defaults to off.
  --sysinfo {on,off}    Enable or disable system information (hardware
                        details, profilers, etc.). Current: on
  --execution-order {tests-per-variant,variants-per-test}
                        How to iterate through test suite and variants
<div class="Pp"></div>
output and result format:
  -s, --silent          Silence stdout
  --show-job-log        Display only the job log on stdout. Useful for test
                        debugging purposes. No output will be displayed if you
                        also specify --silent
  --store-logging-stream [STREAM[:LEVEL] [STREAM[:LEVEL] ...]]
                        Store given logging STREAMs in
                        $JOB_RESULTS_DIR/$STREAM.$LEVEL.
  --html FILE           Enable HTML output to the FILE where the result should
                        be written. The value - (output to stdout) is not
                        supported since not all HTML resources can be embedded
                        into a single file (page resources will be copied to
                        the output file dir)
  --open-browser        Open the generated report on your preferred browser.
                        This works even if --html was not explicitly passed,
                        since an HTML report is always generated on the job
                        results dir. Current: False
  --html-job-result {on,off}
                        Enables default HTML result in the job results
                        directory. File will be located at
                        &quot;html/results.html&quot;.
  --journal             Records test status changes (for use with avocado-
                        journal-replay and avocado-server)
  --json FILE           Enable JSON result format and write it to FILE. Use
                        '-' to redirect to the standard output.
  --json-job-result {on,off}
                        Enables default JSON result in the job results
                        directory. File will be named &quot;results.json&quot;.
  --tap FILE            Enable TAP result output and write it to FILE. Use '-'
                        to redirect to the standard output.
  --tap-job-result {on,off}
                        Enables default TAP result in the job results
                        directory. File will be named &quot;results.tap&quot;.
  --xunit FILE          Enable xUnit result format and write it to FILE. Use
                        '-' to redirect to the standard output.
  --xunit-job-result {on,off}
                        Enables default xUnit result in the job results
                        directory. File will be named &quot;results.xml&quot;.
  -z, --archive         Archive (ZIP) files generated by tests
<div class="Pp"></div>
output check arguments:
  --output-check-record {none,all,stdout,stderr}
                        Record output streams of your tests to reference files
                        (valid options: none (do not record output streams),
                        all (record both stdout and stderr), stdout (record
                        only stderr), stderr (record only stderr). Current:
                        none
  --output-check {on,off}
                        Enable or disable test output (stdout/stderr) check.
                        If this option is off, no output will be checked, even
                        if there are reference files present for the test.
                        Current: on (output check enabled)
<div class="Pp"></div>
loader options:
  --loaders [LOADERS [LOADERS ...]]
                        Overrides the priority of the test loaders. You can
                        specify either @loader_name or TEST_TYPE. By default
                        it tries all available loaders according to priority
                        set in settings-&gt;plugins.loaders.
  --external-runner EXECUTABLE
                        Path to an specific test runner that allows the use of
                        its own tests. This should be used for running tests
                        that do not conform to Avocado' SIMPLE testinterface
                        and can not run standalone. Note: the use of
                        --external-runner overwrites the --loaders to
                        &quot;external_runner&quot;
  --external-runner-chdir {runner,test}
                        Change directory before executing tests. This option
                        may be necessary because of requirements and/or
                        limitations of the external test runner. If the
                        external runner requires to be run from its own base
                        directory,use &quot;runner&quot; here. If the external runner
                        runs tests based on files and requires to be run from
                        the directory where those files are located, use
                        &quot;test&quot; here and specify the test directory with the
                        option &quot;--external-runner-testdir&quot;. Defaults to &quot;None&quot;
  --external-runner-testdir DIRECTORY
                        Where test files understood by the external test
                        runner are located in the filesystem. Obviously this
                        assumes and only applies to external test runners that
                        run tests from files
<div class="Pp"></div>
filtering parameters:
  --filter-by-tags TAGS
                        Filter INSTRUMENTED tests based on &quot;:avocado:
                        tags=tag1,tag2&quot; notation in their class docstring
  --filter-by-tags-include-empty
                        Include all tests without tags during filtering. This
                        effectively means they will be kept in the test suite
                        found previously to filtering.
<div class="Pp"></div>
test execution inside docker container:
  --docker IMAGE        Name of the docker image torun tests on.
  --docker-cmd CMD      Override the docker command, eg. 'sudo docker' or
                        other base docker options like hypervisor. Default:
                        'docker'
  --docker-options OPT  Extra options for docker run cmd. (see: man docker-
                        run)
  --docker-no-cleanup   Preserve container after test
<div class="Pp"></div>
keep environment variables:
  --env-keep ENV_KEEP   Keep environment variables in remote executions
<div class="Pp"></div>
GNU Debugger support:
  --gdb-run-bin EXECUTABLE[:BREAKPOINT]
                        Run a given executable inside the GNU debugger,
                        pausing at a given breakpoint (defaults to &quot;main&quot;)
  --gdb-prerun-commands EXECUTABLE:COMMANDS
                        After loading an executable in GDB, but before
                        actually running it, execute the GDB commands in the
                        given file. EXECUTABLE is optional, if omitted
                        COMMANDS will apply to all executables
  --gdb-coredump {on,off}
                        Automatically generate a core dump when the inferior
                        process received a fatal signal such as SIGSEGV or
                        SIGABRT
<div class="Pp"></div>
test execution on a remote machine:
  --remote-hostname REMOTE_HOSTNAME
                        Specify the hostname to login on remote machine
  --remote-port REMOTE_PORT
                        Specify the port number to login on remote machine.
                        Current: 22
  --remote-username REMOTE_USERNAME
                        Specify the username to login on remote machine.
                        Current: apahim
  --remote-password REMOTE_PASSWORD
                        Specify the password to login on remote machine
  --remote-key-file REMOTE_KEY_FILE
                        Specify an identity file with a private key instead of
                        a password (Example: .pem files from Amazon EC2)
  --remote-timeout SECONDS
                        Amount of time (in seconds) to wait for a successful
                        connection to the remote machine. Defaults to 60
                        seconds.
<div class="Pp"></div>
job replay:
  --replay REPLAY_JOBID
                        Replay a job identified by its (partial) hash id. Use
                        &quot;--replay latest&quot; to replay the latest job.
  --replay-test-status REPLAY_TESTSTATUS
                        Filter tests to replay by test status
  --replay-ignore REPLAY_IGNORE
                        Ignore variants (variants) and/or configuration
                        (config) from the source job
<div class="Pp"></div>
resultsdb options:
  --resultsdb-api RESULTSDB_API
                        Specify the resultsdb API url
  --resultsdb-logs RESULTSDB_LOGS
                        Specify the URL where the logs are published
<div class="Pp"></div>
test execution on a Virtual Machine:
  --vm-domain VM_DOMAIN
                        Specify Libvirt Domain Name
  --vm-hypervisor-uri VM_HYPERVISOR_URI
                        Specify hypervisor URI driver connection. Current:
                        qemu:///system
  --vm-hostname VM_HOSTNAME
                        Specify VM hostname to login. By default Avocado
                        attempts to automatically find the VM IP address.
  --vm-port VM_PORT     Specify the port number to login on VM. Current: 22
  --vm-username VM_USERNAME
                        Specify the username to login on VM
  --vm-password VM_PASSWORD
                        Specify the password to login on VM
  --vm-key-file VM_KEY_FILE
                        Specify an identity file with a private key instead of
                        a password (Example: .pem files from Amazon EC2)
  --vm-cleanup          Restore VM to a previous state, before running tests
  --vm-timeout SECONDS  Amount of time (in seconds) to wait for a successful
                        connection to the virtual machine. Defaults to 120
                        seconds.
<div class="Pp"></div>
wrapper support:
  --wrapper SCRIPT[:EXECUTABLE]
                        Use a script to wrap executables run by a test. The
                        wrapper is either a path to a script (AKA a global
                        wrapper) or a path to a script followed by colon
                        symbol (:), plus a shell like glob to the target
                        EXECUTABLE. Multiple wrapper options are allowed, but
                        only one global wrapper can be defined.
<div class="Pp"></div>
yaml to mux options:
  -m [FILE [FILE ...]], --mux-yaml [FILE [FILE ...]]
                        Location of one or more Avocado multiplex (.yaml)
                        FILE(s) (order dependent)
  --mux-filter-only [MUX_FILTER_ONLY [MUX_FILTER_ONLY ...]]
                        Filter only path(s) from multiplexing
  --mux-filter-out [MUX_FILTER_OUT [MUX_FILTER_OUT ...]]
                        Filter out path(s) from multiplexing
  --mux-path [MUX_PATH [MUX_PATH ...]]
                        List of default paths used to determine path priority
                        when querying for parameters
  --mux-inject [MUX_INJECT [MUX_INJECT ...]]
                        Inject [path:]key:node values into the final multiplex
                        tree.
<div class="Pp"></div>
yaml to mux options [deprecated]:
  --multiplex [FILE [FILE ...]]
                        DEPRECATED: Location of one or more Avocado multiplex
                        (.yaml) FILE(s) (order dependent)
  --filter-only [FILTER_ONLY [FILTER_ONLY ...]]
                        DEPRECATED: Filter only path(s) from multiplexing (use
                        --mux-filter-only instead)
  --filter-out [FILTER_OUT [FILTER_OUT ...]]
                        DEPRECATED: Filter out path(s) from multiplexing (use
                        --mux-filter-out instead)
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Options for subcommand <i>config</i> (<i>avocado config --help</i>):
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
optional arguments:
  -h, --help            show this help message and exit
  --datadir             Shows the data directories currently being used by
                        avocado
  --paginator {on,off}  Turn the paginator on/off. Current: on
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Options for subcommand <i>diff</i> (<i>avocado diff --help</i>):
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
positional arguments:
  &lt;JOB&gt;                 A job reference, identified by a (partial) unique ID
                        (SHA1) or test results directory.
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  --html FILE           Enable HTML output to the FILE where the result should
                        be written.
  --open-browser        Generate and open a HTML report in your preferred
                        browser. If no --html file is provided, create a
                        temporary file.
  --diff-filter DIFF_FILTER
                        Comma separated filter of diff sections:
                        (no)cmdline,(no)time,(no)variants,(no)results,
                        (no)config,(no)sysinfo (defaults to all enabled).
  --paginator {on,off}  Turn the paginator on/off. Current: on
  --create-reports      Create temporary files with job reports (to be used by
                        other diff tools)
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Options for subcommand <i>distro</i> (<i>avocado distro --help</i>):
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
optional arguments:
  -h, --help            show this help message and exit
  --distro-def-create   Creates a distro definition file based on the path
                        given
  --distro-def-name DISTRO_DEF_NAME
                        Distribution short name
  --distro-def-version DISTRO_DEF_VERSION
                        Distribution major version number
  ---distro-def-release DISTRO_DEF_RELEASE
                        Distribution release version number
  --distro-def-arch DISTRO_DEF_ARCH
                        Primary architecture that the distro targets
  --distro-def-path DISTRO_DEF_PATH
                        Top level directory of the distro installation files
  --distro-def-type {deb,rpm}
                        Distro type (one of: deb, rpm)
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Options for subcommand <i>exec-path</i> (<i>avocado exec-path --help</i>):
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
optional arguments:
  -h, --help  show this help message and exit
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Options for subcommand <i>list</i> (<i>avocado list --help</i>):
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
positional arguments:
  reference             List of test references (aliases or paths). If empty,
                        avocado will list tests on the configured test source,
                        (see 'avocado config --datadir') Also, if there are
                        other test loader plugins active, tests from those
                        plugins might also show up (behavior may vary among
                        plugins)
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  -V, --verbose         Whether to show extra information (headers and
                        summary). Current: False
  --paginator {on,off}  Turn the paginator on/off. Current: on
<div class="Pp"></div>
loader options:
  --loaders [LOADERS [LOADERS ...]]
                        Overrides the priority of the test loaders. You can
                        specify either @loader_name or TEST_TYPE. By default
                        it tries all available loaders according to priority
                        set in settings-&gt;plugins.loaders.
  --external-runner EXECUTABLE
                        Path to an specific test runner that allows the use of
                        its own tests. This should be used for running tests
                        that do not conform to Avocado' SIMPLE testinterface
                        and can not run standalone. Note: the use of
                        --external-runner overwrites the --loaders to
                        &quot;external_runner&quot;
  --external-runner-chdir {runner,test}
                        Change directory before executing tests. This option
                        may be necessary because of requirements and/or
                        limitations of the external test runner. If the
                        external runner requires to be run from its own base
                        directory,use &quot;runner&quot; here. If the external runner
                        runs tests based on files and requires to be run from
                        the directory where those files are located, use
                        &quot;test&quot; here and specify the test directory with the
                        option &quot;--external-runner-testdir&quot;. Defaults to &quot;None&quot;
  --external-runner-testdir DIRECTORY
                        Where test files understood by the external test
                        runner are located in the filesystem. Obviously this
                        assumes and only applies to external test runners that
                        run tests from files
<div class="Pp"></div>
filtering parameters:
  --filter-by-tags TAGS
                        Filter INSTRUMENTED tests based on &quot;:avocado:
                        tags=tag1,tag2&quot; notation in their class docstring
  --filter-by-tags-include-empty
                        Include all tests without tags during filtering. This
                        effectively means they will be kept in the test suite
                        found previously to filtering.
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Options for subcommand <i>multiplex</i> (<i>avocado multiplex --help</i>):
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
optional arguments:
  -h, --help            show this help message and exit
  --summary SUMMARY     Verbosity of the variants summary. (positive integer -
                        0, 1, ... - or none, brief, normal, verbose, full,
                        max)
  --variants VARIANTS   Verbosity of the list of variants. (positive integer -
                        0, 1, ... - or none, brief, normal, verbose, full,
                        max)
  --system-wide         Combine the files with the default tree.
  -c, --contents        [obsoleted by --variants] Shows the node content
                        (variables)
<div class="Pp"></div>
environment view options:
  -d, --debug           Debug the multiplex tree.
<div class="Pp"></div>
tree view options:
  -t, --tree            [obsoleted by --summary] Shows the multiplex tree
                        structure
  -i, --inherit         [obsoleted by --summary] Show the inherited values
<div class="Pp"></div>
yaml to mux options:
  -m [FILE [FILE ...]], --mux-yaml [FILE [FILE ...]]
                        Location of one or more Avocado multiplex (.yaml)
                        FILE(s) (order dependent)
  --mux-filter-only [MUX_FILTER_ONLY [MUX_FILTER_ONLY ...]]
                        Filter only path(s) from multiplexing
  --mux-filter-out [MUX_FILTER_OUT [MUX_FILTER_OUT ...]]
                        Filter out path(s) from multiplexing
  --mux-path [MUX_PATH [MUX_PATH ...]]
                        List of default paths used to determine path priority
                        when querying for parameters
  --mux-inject [MUX_INJECT [MUX_INJECT ...]]
                        Inject [path:]key:node values into the final multiplex
                        tree.
<div class="Pp"></div>
yaml to mux options [deprecated]:
  --multiplex [FILE [FILE ...]]
                        DEPRECATED: Location of one or more Avocado multiplex
                        (.yaml) FILE(s) (order dependent)
  --filter-only [FILTER_ONLY [FILTER_ONLY ...]]
                        DEPRECATED: Filter only path(s) from multiplexing (use
                        --mux-filter-only instead)
  --filter-out [FILTER_OUT [FILTER_OUT ...]]
                        DEPRECATED: Filter out path(s) from multiplexing (use
                        --mux-filter-out instead)
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Options for subcommand <i>plugins</i> (<i>avocado plugins --help</i>):
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
optional arguments:
  -h, --help            show this help message and exit
  --paginator {on,off}  Turn the paginator on/off. Current: on
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Options for subcommand <i>sysinfo</i> (<i>avocado sysinfo --help</i>):
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
positional arguments:
  sysinfodir  Dir where to dump sysinfo
<div class="Pp"></div>
optional arguments:
  -h, --help  show this help message and exit
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="RUNNING_A_TEST"><a class="selflink" href="#RUNNING_A_TEST">RUNNING
  A TEST</a></h1>
The most common use of the <i>avocado</i> command line tool is to run a test:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado run sleeptest.py
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
This command will run the <i>sleeptest.py</i> test, as found on the standard
  test directories. The output should be similar to:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
JOB ID    : &lt;id&gt;
JOB LOG   : /home/&lt;user&gt;/avocado/job-results/job-&lt;date&gt;-&lt;shortid&gt;/job.log
 (1/1) sleeptest.py:SleepTest.test: PASS (1.01 s)
RESULTS    : PASS 1 | ERROR 0 | FAIL 0 | SKIP 0 | WARN 0 | INTERRUPT 0
JOB TIME   : 1.11 s
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The test directories will vary depending on you system and installation method
  used. Still, it's pretty easy to find that out as shown in the next section.
<h1 class="Sh" title="Sh" id="DEBUGGING_TESTS"><a class="selflink" href="#DEBUGGING_TESTS">DEBUGGING
  TESTS</a></h1>
When you are developing new tests, frequently you want to look at the straight
  output of the job log in the stdout, without having to tail the job log. In
  order to do that, you can use --show-job-log to the avocado test runner:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ scripts/avocado run examples/tests/sleeptest.py --show-job-log
...
PARAMS (key=timeout, path=*, default=None) =&gt; None
START 1-sleeptest.py:SleepTest.test
PARAMS (key=sleep_length, path=*, default=1) =&gt; 1
Sleeping for 1.00 seconds
Not logging /var/log/messages (lack of permissions)
PASS 1-sleeptest.py:SleepTest.test
...
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Let's say you are debugging a test particularly large, with lots of debug output
  and you want to reduce this output to only messages with level 'INFO' and
  higher. You can set job-log-level to info to reduce the amount of output.
<div style="height: 1.00em;">&#x00A0;</div>
Edit your <i>~/.config/avocado/avocado.conf</i> file and add:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[job.output]
loglevel = info
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Running the same example with this option will give you:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ scripts/avocado run sleeptest --show-job-log
...
START 1-sleeptest.py:SleepTest.test
PASS 1-sleeptest.py:SleepTest.test
...
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The levels you can choose are the levels available in the python logging system
  <i>https://docs.python.org/2/library/logging.html#logging-levels</i>,
  translated to lowercase strings, so 'notset', 'debug', 'info', 'warning',
  'error', 'critical', in order of severity.
<div style="height: 1.00em;">&#x00A0;</div>
As you can see, the UI output is suppressed and only the job log goes to stdout,
  making this a useful feature for test development/debugging.
<h1 class="Sh" title="Sh" id="SILENCING_RUNNER_STDOUT"><a class="selflink" href="#SILENCING_RUNNER_STDOUT">SILENCING
  RUNNER STDOUT</a></h1>
You may specify <i>--silent</i>, that means avocado will turn off all runner
  stdout. Even if you specify things like <i>--show-job-log</i> in the CLI,
  <i>--silent</i> will have precedence and you will not get application stdout.
  Note that <i>--silent</i> does not affect on disk job logs, those continue to
  be generated normally.
<h1 class="Sh" title="Sh" id="SILENCING_SYSINFO_REPORT"><a class="selflink" href="#SILENCING_SYSINFO_REPORT">SILENCING
  SYSINFO REPORT</a></h1>
You may specify --sysinfo=off and avocado will not collect profilers, hardware
  details and other system information, inside the job result directory.
<h1 class="Sh" title="Sh" id="LISTING_TESTS"><a class="selflink" href="#LISTING_TESTS">LISTING
  TESTS</a></h1>
The <i>avocado</i> command line tool also has a <i>list</i> command, that lists
  the known tests in a given path, be it a path to an individual test, or a path
  to a directory. If no arguments provided, avocado will inspect the contents of
  the test location being used by avocado (if you are in doubt about which one
  is that, you may use <i>avocado config --datadir</i>). The output looks like:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado list
INSTRUMENTED /usr/share/avocado/tests/abort.py
INSTRUMENTED /usr/share/avocado/tests/datadir.py
INSTRUMENTED /usr/share/avocado/tests/doublefail.py
INSTRUMENTED /usr/share/avocado/tests/doublefree.py
INSTRUMENTED /usr/share/avocado/tests/errortest.py
INSTRUMENTED /usr/share/avocado/tests/failtest.py
INSTRUMENTED /usr/share/avocado/tests/fiotest.py
INSTRUMENTED /usr/share/avocado/tests/gdbtest.py
INSTRUMENTED /usr/share/avocado/tests/gendata.py
INSTRUMENTED /usr/share/avocado/tests/linuxbuild.py
INSTRUMENTED /usr/share/avocado/tests/multiplextest.py
INSTRUMENTED /usr/share/avocado/tests/passtest.py
INSTRUMENTED /usr/share/avocado/tests/skiptest.py
INSTRUMENTED /usr/share/avocado/tests/sleeptenmin.py
INSTRUMENTED /usr/share/avocado/tests/sleeptest.py
INSTRUMENTED /usr/share/avocado/tests/synctest.py
INSTRUMENTED /usr/share/avocado/tests/timeouttest.py
INSTRUMENTED /usr/share/avocado/tests/trinity.py
INSTRUMENTED /usr/share/avocado/tests/warntest.py
INSTRUMENTED /usr/share/avocado/tests/whiteboard.py
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Here, <i>INSTRUMENTED</i> means that the files there are python files with an
  avocado test class in them, therefore, that they are what we call instrumented
  tests. This means those tests can use all avocado APIs and facilities. Let's
  try to list a directory with a bunch of executable shell scripts:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado list examples/wrappers/
SIMPLE examples/wrappers/dummy.sh
SIMPLE examples/wrappers/ltrace.sh
SIMPLE examples/wrappers/perf.sh
SIMPLE examples/wrappers/strace.sh
SIMPLE examples/wrappers/time.sh
SIMPLE examples/wrappers/valgrind.sh
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Here, <i>SIMPLE</i> means that those files are executables, that avocado will
  simply execute and return PASS or FAIL depending on their return codes (PASS
  -&gt; 0, FAIL -&gt; any integer different than 0). You can also provide the
  <i>--verbose</i>, or <i>-V</i> flag to display files that were detected but
  are not avocado tests, along with summary information:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado list examples/gdb-prerun-scripts/ -V
Type       Test                                     Tag(s)
NOT_A_TEST examples/gdb-prerun-scripts/README
NOT_A_TEST examples/gdb-prerun-scripts/pass-sigusr1
<div class="Pp"></div>
TEST TYPES SUMMARY
==================
SIMPLE: 0
INSTRUMENTED: 0
MISSING: 0
NOT_A_TEST: 2
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
That summarizes the basic commands you should be using more frequently when you
  start with avocado. Let's talk now about how avocado stores test results.
<h1 class="Sh" title="Sh" id="EXPLORING_RESULTS"><a class="selflink" href="#EXPLORING_RESULTS">EXPLORING
  RESULTS</a></h1>
When <i>avocado</i> runs tests, it saves all its results on your system:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
JOB ID    : &lt;id&gt;
JOB LOG   : /home/&lt;user&gt;/avocado/job-results/job-&lt;date&gt;-&lt;shortid&gt;/job.log
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
For your convenience, <i>avocado</i> maintains a link to the latest job run (an
  <i>avocado run</i> command in this context), so you can always use
  <i>&quot;latest&quot;</i> to browse your test results:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ ls /home/&lt;user&gt;/avocado/job-results/latest
id
jobdata
job.log
results.json
results.tap
results.xml
sysinfo
test-results
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The main log file is <i>job.log</i>, but every test has its own results
  directory:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ ls -1 ~/avocado/job-results/latest/test-results/
1-sleeptest.py:SleepTest.test
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Since this is a directory, it should have content similar to:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ ls -1 ~/avocado/job-results/latest/test-results/1-sleeptest.py\:SleepTest.test/
data
debug.log
remote.log
stderr
stdout
sysinfo
whiteboard
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="MULTIPLEX"><a class="selflink" href="#MULTIPLEX">MULTIPLEX</a></h1>
Avocado has a powerful tool that enables multiple test scenarios to be run using
  a single, unmodified test. This mechanism uses a YAML file called the
  'multiplex file', that tells avocado how to multiply all possible test
  scenarios automatically.
<div style="height: 1.00em;">&#x00A0;</div>
A command by the same name, <i>multiplex</i>, is available on the <i>avocado</i>
  command line tool, and enables you to see all the test scenarios that can be
  run:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado multiplex -m examples/tests/sleeptest.py.data/sleeptest.yaml -c
Variants generated:
<div class="Pp"></div>
Variant 1:    /run/short
    /run/short:sleep_length =&gt; 0.5
<div class="Pp"></div>
Variant 2:    /run/medium
    /run/medium:sleep_length =&gt; 1
<div class="Pp"></div>
Variant 3:    /run/long
    /run/long:sleep_length =&gt; 5
<div class="Pp"></div>
Variant 4:    /run/longest
    /run/longest:sleep_length =&gt; 10
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
This is a sample that varies the parameter <i>sleep_length</i> through the
  scenarios <b>/run/short</b> (sleeps for 0.5 s), <b>/run/medium</b> (sleeps for
  1 s), <b>/run/long</b> (sleeps for 5s), <b>/run/longest</b> (sleeps for 10s).
  The YAML file (multiplex file) that produced the output above is:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
!mux
short:
    sleep_length: 0.5
medium:
    sleep_length: 1
long:
    sleep_length: 5
longest:
    sleep_length: 10
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
You can execute <i>sleeptest</i> in all variations exposed above with:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado run sleeptest.py -m examples/tests/sleeptest.py.data/sleeptest.yaml
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
And the output should look like:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
JOB ID    : &lt;id&gt;
JOB LOG   : /home/&lt;user&gt;/avocado/job-results/job-&lt;date&gt;-&lt;shortid&gt;/job.log
 (1/4) sleeptest.py:SleepTest.test;1: PASS (0.51 s)
 (2/4) sleeptest.py:SleepTest.test;2: PASS (1.01 s)
 (3/4) sleeptest.py:SleepTest.test;3: PASS (5.02 s)
 (4/4) sleeptest.py:SleepTest.test;4: PASS (10.01 s)
RESULTS    : PASS 4 | ERROR 0 | FAIL 0 | SKIP 0 | WARN 0 | INTERRUPT 0
JOB TIME   : 16.65 s
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The <i>multiplex</i> plugin and the test runner supports two kinds of global
  filters, through the command line options <i>--mux-filter-only</i> and
  <i>--mux-filter-out</i>. The <i>mux-filter-only</i> exclusively includes one
  or more paths and the <i>mux-filter-out</i> removes one or more paths from
  being processed.
<div style="height: 1.00em;">&#x00A0;</div>
From the previous example, if we are interested to use the variants
  <i>/run/medium</i> and <i>/run/longest</i>, we do the following command line:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado run sleeptest.py -m examples/tests/sleeptest.py.data/sleeptest.yaml \
      --mux-filter-only /run/medium /run/longest
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
And if you want to remove <i>/small</i> from the variants created, we do the
  following:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado run sleeptest.py -m examples/tests/sleeptest.py.data/sleeptest.yaml \
      --mux-filter-out /run/medium
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Note that both <i>--mux-filter-only</i> and <i>--mux-filter-out</i> filters can
  be arranged in the same command line.
<div style="height: 1.00em;">&#x00A0;</div>
The multiplexer also supports default paths. The base path is <b>/run/*</b> but
  it can be overridden by <b>--mux-path</b>, which accepts multiple arguments.
  What it does: it splits leaves by the provided paths. Each query goes one by
  one through those sub-trees and first one to hit the match returns the result.
  It might not solve all problems, but it can help to combine existing YAML
  files with your ones:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
qa: # large and complex read-only file, content injected into /qa
    tests:
        timeout: 10
    ...
my_variants: !mux # your YAML file injected into /my_variants
    short:
        timeout: 1
    long:
        timeout: 1000
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
You want to use an existing test which uses <b>params.get('timeout', '*')</b>.
  Then you can use <b>--mux-path '/my_variants/*' '/qa/*'</b> and it'll first
  look in your variants. If no matches are found, then it would proceed to
  <b>/qa/*</b>
<div style="height: 1.00em;">&#x00A0;</div>
Keep in mind that only slices defined in mux-path are taken into account for
  relative paths (the ones starting with <b>*</b>).
<h1 class="Sh" title="Sh" id="DEBUGGING_EXECUTABLES_RUN_AS_PART_OF_A_TEST"><a class="selflink" href="#DEBUGGING_EXECUTABLES_RUN_AS_PART_OF_A_TEST">DEBUGGING
  EXECUTABLES RUN AS PART OF A TEST</a></h1>
One interesting avocado feature is the ability to automatically and
  transparently run executables that are used on a given test inside the GNU
  debugger.
<div style="height: 1.00em;">&#x00A0;</div>
Suppose you are running a test that uses an external, compiled, image converter.
  Now suppose you're feeding it with different types of images, including broken
  image files, and it fails at a given point. You wish you could connect to the
  debugger at that given source location while your test is running. This is how
  to do just that with avocado:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado run --gdb-run-bin=convert:convert_ppm_to_raw converttest.py
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The job starts running just as usual, and so does your test:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
JOB ID    : &lt;id&gt;
JOB LOG   : /home/&lt;user&gt;/avocado/job-results/job-&lt;date&gt;-&lt;shortid&gt;/job.log
TESTS     : 1
 (1/1) converttest.py:ConvertTest.test: /
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The <i>convert</i> executable though, automatically runs inside GDB. Avocado
  will stop when the given breakpoint is reached:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
TEST PAUSED because of debugger breakpoint. To DEBUG your application run:
/home/&lt;user&gt;/avocado/job-results/job-&lt;date&gt;-&lt;shortid&gt;/test-results/converttest.py/data/convert.gdb.sh
<div class="Pp"></div>
NOTE: please use *disconnect* command in gdb before exiting, or else the debugged process will be KILLED
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
From this point, you can run the generated script ( <i>convert.gdb.sh</i>) to
  debug you application.
<div style="height: 1.00em;">&#x00A0;</div>
As noted, it is strongly recommended that you <i>disconnect</i> from gdb while
  your executable is still running. That is, if the executable finished running
  while you are debugging it, avocado has no way to know about its status.
<div style="height: 1.00em;">&#x00A0;</div>
Avocado will automatically send a <i>continue</i> command to the debugger when
  you disconnect from and exit gdb.
<div style="height: 1.00em;">&#x00A0;</div>
If, for some reason you have a custom GDB, or your system does not put GDB on
  what avocado believes to be the standard location ( <i>/usr/bin/gdb</i>), you
  can override that in the section <i>gdb.paths</i> of your documentation:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[gdb.paths]
gdb = /usr/bin/gdb
gdbserver = /usr/bin/gdbserver
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
So running avocado after setting those will use the appropriate gdb/gdbserver
  path.
<div style="height: 1.00em;">&#x00A0;</div>
If you are debugging a special application and need to setup GDB in custom ways
  by running GDB commands, you can do that with the <i>--gdb-prerun-commands</i>
  option:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado run --gdb-run-bin=foo:bar --gdb-prerun-commands=/tmp/disable-signals footest.py
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
In this example, <i>/tmp/disable-signals</i> is a simple text file containing
  two lines:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
signal SIGUSR1 pass
signal SIGUSR1 nostop
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Each line is a GDB command, so you can have from simple to very complex
  debugging environments configured like that.
<h1 class="Sh" title="Sh" id="WRAP_EXECUTABLE_RUN_BY_TESTS"><a class="selflink" href="#WRAP_EXECUTABLE_RUN_BY_TESTS">WRAP
  EXECUTABLE RUN BY TESTS</a></h1>
Avocado allows the instrumentation of executables being run by a test in a
  transparent way. The user specifies a script (&quot;the wrapper&quot;) to be
  used to run the actual program called by the test.
<div style="height: 1.00em;">&#x00A0;</div>
If the instrumentation script is implemented correctly, it should not interfere
  with the test behavior. That is, the wrapper should avoid changing the return
  status, standard output and standard error messages of the original
  executable.
<div style="height: 1.00em;">&#x00A0;</div>
The user can be specific about which program to wrap (with a shell-like glob),
  or if that is omitted, a global wrapper that will apply to all programs called
  by the test.
<div style="height: 1.00em;">&#x00A0;</div>
So, for every executable run by the test, the program name will be compared to
  the pattern to decide whether to wrap it or not. You can have multiples
  wrappers and patterns defined.
<div style="height: 1.00em;">&#x00A0;</div>
Examples:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado run datadir.py --wrapper examples/wrappers/strace.sh
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Any command created by the test datadir will be wrapped on <b>strace.sh</b>.
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado run datadir.py --wrapper examples/wrappers/ltrace.sh:*make \
                         --wrapper examples/wrappers/perf.sh:*datadir
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Any command that matches the pattern <i>*make</i> will be wrapper on
  <b>ltrace.sh</b> and the pattern <b>*datadir</b> will trigger the execution of
  <b>perf.sh</b>.
<div style="height: 1.00em;">&#x00A0;</div>
Note that it is not possible to use <b>--gdb-run-bin</b> together with
  <b>--wrapper</b>, they are incompatible.
<h1 class="Sh" title="Sh" id="RUNNING_TESTS_WITH_AN_EXTERNAL_RUNNER"><a class="selflink" href="#RUNNING_TESTS_WITH_AN_EXTERNAL_RUNNER">RUNNING
  TESTS WITH AN EXTERNAL RUNNER</a></h1>
It's quite common to have organically grown test suites in most software
  projects. These usually include a custom built, very specific test runner that
  knows how to find and run their own tests.
<div style="height: 1.00em;">&#x00A0;</div>
Still, running those tests inside Avocado may be a good idea for various
  reasons, including being able to have results in different human and machine
  readable formats, collecting system information alongside those tests (the
  Avocado's <i>sysinfo</i> functionality), and more.
<div style="height: 1.00em;">&#x00A0;</div>
Avocado makes that possible by means of its &quot;external runner&quot; feature.
  The most basic way of using it is:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado run --external-runner=/path/to/external_runner foo bar baz
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
In this example, Avocado will report individual test results for tests
  <i>foo</i>, <i>bar</i> and <i>baz</i>. The actual results will be based on the
  return code of individual executions of <i>/path/to/external_runner foo</i>,
  <i>/path/to/external_runner bar</i> and finally <i>/path/to/external_runner
  baz</i>.
<div style="height: 1.00em;">&#x00A0;</div>
As another way to explain an show how this feature works, think of the
  &quot;external runner&quot; as some kind of interpreter and the individual
  tests as anything that this interpreter recognizes and is able to execute. A
  UNIX shell, say <i>/bin/sh</i> could be considered an external runner, and
  files with shell code could be considered tests:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ echo &quot;exit 0&quot; &gt; /tmp/pass
$ echo &quot;exit 1&quot; &gt; /tmp/fail
$ avocado run --external-runner=/bin/sh /tmp/pass /tmp/fail
JOB ID    : &lt;id&gt;
JOB LOG   : /home/&lt;user&gt;/avocado/job-results/job-&lt;date&gt;-&lt;shortid&gt;/job.log
TESTS      : 2
(1/2) /tmp/pass: PASS (0.01 s)
(2/2) /tmp/fail: FAIL (0.01 s)
RESULTS    : PASS 1 | ERROR 0 | FAIL 1 | SKIP 0 | WARN 0 | INTERRUPT 0
JOB TIME   : 0.11 s
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
This example is pretty obvious, and could be achieved by giving <i>/tmp/pass</i>
  and <i>/tmp/fail</i> shell &quot;shebangs&quot; (<i>#!/bin/sh</i>), making
  them executable ( <i>chmod +x /tmp/pass /tmp/fail)</i>, and running them as
  &quot;SIMPLE&quot; tests.
<div style="height: 1.00em;">&#x00A0;</div>
But now consider the following example:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado run --external-runner=/bin/curl http://local-avocado-server:9405/jobs/ \
                                          http://remote-avocado-server:9405/jobs/
JOB ID    : &lt;id&gt;
JOB LOG   : /home/&lt;user&gt;/avocado/job-results/job-&lt;date&gt;-&lt;shortid&gt;/job.log
TESTS      : 2
(1/2) http://local-avocado-server:9405/jobs/: PASS (0.02 s)
(2/2) http://remote-avocado-server:9405/jobs/: FAIL (3.02 s)
RESULTS    : PASS 1 | ERROR 0 | FAIL 1 | SKIP 0 | WARN 0 | INTERRUPT 0
JOB TIME   : 3.14 s
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
This effectively makes <i>/bin/curl</i> an &quot;external test runner&quot;,
  responsible for trying to fetch those URLs, and reporting PASS or FAIL for
  each of them.
<h1 class="Sh" title="Sh" id="RECORDING_TEST_REFERENCE_OUTPUT"><a class="selflink" href="#RECORDING_TEST_REFERENCE_OUTPUT">RECORDING
  TEST REFERENCE OUTPUT</a></h1>
As a tester, you may want to check if the output of a given application matches
  an expected output. In order to help with this common use case, we offer the
  option <b>--output-check-record [mode]</b> to the test runner. If this option
  is used, it will store the stdout or stderr of the process (or both, if you
  specified <b>all</b>) being executed to reference files:
  <b>stdout.expected</b> and <b>stderr.expected</b>.
<div style="height: 1.00em;">&#x00A0;</div>
Those files will be recorded in the test data dir. The data dir is in the same
  directory as the test source file, named <b>[source_file_name.data]</b>. Let's
  take as an example the test <b>synctest.py</b>. In a fresh checkout of
  avocado, you can see:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
examples/tests/synctest.py.data/stderr.expected
examples/tests/synctest.py.data/stdout.expected
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
From those 2 files, only stdout.expected is non empty:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ cat examples/tests/synctest.py.data/stdout.expected
PAR : waiting
PASS : sync interrupted
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The output files were originally obtained using the test runner and passing the
  option --output-check-record all to the test runner:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado run --output-check-record all examples/tests/synctest.py
JOB ID    : &lt;id&gt;
JOB LOG   : /home/&lt;user&gt;/avocado/job-results/job-&lt;date&gt;-&lt;shortid&gt;/job.log
 (1/1) examples/tests/synctest.py:SyncTest.test: PASS (4.00 s)
RESULTS    : PASS 1 | ERROR 0 | FAIL 0 | SKIP 0 | WARN 0 | INTERRUPT 0
JOB TIME   : 4.10 s
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
After the reference files are added, the check process is transparent, in the
  sense that you do not need to provide special flags to the test runner. Now,
  every time the test is executed, after it is done running, it will check if
  the outputs are exactly right before considering the test as PASSed. If you
  want to override the default behavior and skip output check entirely, you may
  provide the flag <b>--output-check=off</b> to the test runner.
<div style="height: 1.00em;">&#x00A0;</div>
The <b>avocado.utils.process</b> APIs have a parameter <b>allow_output_check</b>
  (defaults to <b>all</b>), so that you can select which process outputs will go
  to the reference files, should you chose to record them. You may choose
  <b>all</b>, for both stdout and stderr, <b>stdout</b>, for the stdout only,
  <b>stderr</b>, for only the stderr only, or <b>none</b>, to allow neither of
  them to be recorded and checked.
<div style="height: 1.00em;">&#x00A0;</div>
This process works fine also with simple tests, executables that return 0
  (PASSed) or != 0 (FAILed). Let's consider our bogus example:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ cat output_record.sh
#!/bin/bash
echo &quot;Hello, world!&quot;
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Let's record the output (both stdout and stderr) for this one:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado run output_record.sh --output-check-record all
JOB ID    : &lt;id&gt;
JOB LOG   : /home/&lt;user&gt;/avocado/job-results/job-&lt;date&gt;-&lt;shortid&gt;/job.log
TESTS     : 1
(1/1) home/$USER/Code/avocado/output_record.sh: PASS (0.01 s)
RESULTS    : PASS 1 | ERROR 0 | FAIL 0 | SKIP 0 | WARN 0 | INTERRUPT 0
JOB TIME   : 0.11 s
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
After this is done, you'll notice that a the test data directory appeared in the
  same level of our shell script, containing 2 files:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ ls output_record.sh.data/
stderr.expected  stdout.expected
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Let's look what's in each of them:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ cat output_record.sh.data/stdout.expected
Hello, world!
$ cat output_record.sh.data/stderr.expected
$
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Now, every time this test runs, it'll take into account the expected files that
  were recorded, no need to do anything else but run the test.
<h1 class="Sh" title="Sh" id="RUNNING_REMOTE_TESTS"><a class="selflink" href="#RUNNING_REMOTE_TESTS">RUNNING
  REMOTE TESTS</a></h1>
Avocado allows you to execute tests on a remote machine by means of a SSH
  network connection. The remote machine must be configured to accept remote
  connections and the Avocado framework have to be installed in both origin and
  remote machines.
<div style="height: 1.00em;">&#x00A0;</div>
When running tests on remote machine, the test sources and its data (if any
  present) are transferred to the remote target, just before the test execution.
  After the test execution, all test results are transferred back to the origin
  machine.
<div style="height: 1.00em;">&#x00A0;</div>
Here is how to run the sleeptest example test in a remote machine with IP
  address 192.168.0.123 (standard port 22), remote user name <i>fedora</i> and
  remote user password <i>123456</i>:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado run sleeptest.py --remote-hostname 192.168.0.123 --remote-username fedora --remote-password 123456
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The output should look like:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
JOB ID    : &lt;id&gt;
JOB LOG   : /home/&lt;user&gt;/avocado/job-results/job-&lt;date&gt;-&lt;shortid&gt;/job.log
LOGIN      : fedora@localhost:22 (TIMEOUT: 60 seconds)
 (1/1) sleeptest.py:SleepTest.test: PASS (1.02 s)
RESULTS    : PASS 1 | ERROR 0 | FAIL 0 | SKIP 0 | WARN 0 | INTERRUPT 0
JOB TIME   : 1.12 s
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
For more information, please consult the topic Remote Machine Plugin on
  Avocado's online documentation.
<h1 class="Sh" title="Sh" id="LINUX_DISTRIBUTION_UTILITIES"><a class="selflink" href="#LINUX_DISTRIBUTION_UTILITIES">LINUX
  DISTRIBUTION UTILITIES</a></h1>
Avocado has some planned features that depend on knowing the Linux Distribution
  being used on the system. The most basic command prints the detected Linux
  Distribution:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado distro
Detected distribution: fedora (x86_64) version 21 release 0
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Other features are available with the same command when command line options are
  given, as shown by the <i>--help</i> option.
<div style="height: 1.00em;">&#x00A0;</div>
For instance, it possible to create a so-called &quot;Linux Distribution
  Definition&quot; file, by inspecting an installation tree. The installation
  tree could be the contents of the official installation ISO or a local network
  mirror.
<div style="height: 1.00em;">&#x00A0;</div>
These files let Avocado pinpoint if a given installed package is part of the
  original Linux Distribution or something else that was installed from an
  external repository or even manually. This, in turn, can help detecting
  regressions in base system pacakges that affected a given test result.
<div style="height: 1.00em;">&#x00A0;</div>
To generate a definition file run:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ avocado distro --distro-def-create --distro-def-name avocadix  \
                 --distro-def-version 1 --distro-def-arch x86_64 \
                 --distro-def-type rpm --distro-def-path /mnt/dvd
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
And the output will be something like:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
Loading distro information from tree... Please wait...
Distro information saved to &quot;avocadix-1-x86_64.distro&quot;
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
System wide configuration file
    /etc/avocado/avocado.conf
<div class="Pp"></div>
Extra configuration files
    /etc/avocado/conf.d/
<div class="Pp"></div>
User configuration file
    ~/.config/avocado/avocado.conf
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
If you find a bug, please report it over our github page as an issue:
  <i>https://github.com/avocado-framework/avocado/issues</i>
<h1 class="Sh" title="Sh" id="LICENSE"><a class="selflink" href="#LICENSE">LICENSE</a></h1>
Avocado is released under GPLv2 (explicit version)
  <i>http://gnu.org/licenses/gpl-2.0.html</i>. Even though most of the current
  code is licensed under a &quot;and any later version&quot; clause, some parts
  are specifically bound to the version 2 of the license and therefore that's
  the official license of the prject itself. For more details, please see the
  LICENSE file in the project source code directory.
<h1 class="Sh" title="Sh" id="MORE_INFORMATION"><a class="selflink" href="#MORE_INFORMATION">MORE
  INFORMATION</a></h1>
For more information please check Avocado's project website, located at
  <i>http://avocado-framework.github.io/</i>. There you'll find links to online
  documentation, source code and community resources.
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Avocado Development Team &lt; <i>avocado-devel@redhat.com</i>&gt;</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
