<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:21:25 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>dotlock(1) User Manuals dotlock(1)</p>

<p style="margin-top: 1em">NAME <br>
lbdb_dotlock - Lock mail spool files.</p>

<p style="margin-top: 1em">SYNOPSIS <br>
lbdb_dotlock [-t|-f|-u|-d] [-r retries] file</p>

<p style="margin-top: 1em">DESCRIPTION <br>
dotlock implements the traditional mail spool file locking
method: To lock file, a file named file.lock is created.</p>

<p style="margin-top: 1em">OPTIONS <br>
-t Just try. dotlock won&rsquo;t actually lock a file, but
inform the invoking process if it&rsquo;s at all possible to
lock file.</p>

<p style="margin-top: 1em">-f Force the lock. If another
process holds a lock on file longer than a certain amount of
time, dotlock will break that lock by removing the
lockfile.</p>

<p style="margin-top: 1em">-u Unlock. dotlock will remove
file.lock.</p>

<p style="margin-top: 1em">-d Delete. dotlock will lock
file, remove it if it has length 0, and afterwards remove
file.lock.</p>

<p style="margin-top: 1em">-r retries <br>
This command line option tells dotlock to try locking
retries times before giving up or (if invoked with the -f
command line option) break a lock. The default value is 5.
<br>
dotlock waits one second between successive locking
attempts.</p>

<p style="margin-top: 1em">FILES <br>
file.lock <br>
The lock file dotlock generates.</p>

<p style="margin-top: 1em">SEE ALSO <br>
fcntl(2), flock(2), lockfile(1), lbdb-fetchaddr(1)</p>

<p style="margin-top: 1em">DIAGNOSTICS <br>
dotlock gives all diagnostics in its return values:</p>

<p style="margin-top: 1em">0 - DL_EX_OK <br>
The program was successful.</p>

<p style="margin-top: 1em">1 - DL_EX_ERROR <br>
An unspecified error such as bad command line parameters,
lack of system memory and the like has occurred.</p>

<p style="margin-top: 1em">3 - DL_EX_EXIST <br>
The user wants to lock a file which has been locked by
another process already. If dotlock is invoked with the -f
command line option, dotlock won&rsquo;t generate this
error, <br>
but break other processes&rsquo; locks.</p>

<p style="margin-top: 1em">4 - DL_EX_NEED_RPIVS <br>
This return value only occurs if dotlock has been invoked
with the -t command line option. It means that dotlock will
have to use its group mail privileges to lock file.</p>

<p style="margin-top: 1em">5 - DL_EX_IMPOSSIBLE <br>
This return value only occurs if dotlock has been invoked
with the -t command line option. It means that dotlock is
unable to lock file.</p>

<p style="margin-top: 1em">NOTES <br>
dotlock tries to implement an NFS-safe dotlocking method
which was borrowed from lockfile(1).</p>

<p style="margin-top: 1em">If the user can&rsquo;t open
file for reading with his normal privileges, dotlock will
return the DL_EX_ERROR exit value to avoid certain attacks
against other users&rsquo; spool files. The <br>
code carefully avoids race conditions when checking
permissions; for details of all this see the comments in
dotlock.c.</p>

<p style="margin-top: 1em">HISTORY <br>
dotlock is part of the Mutt mail user agent package. It has
been created to avoid running mutt with group mail
privileges.</p>

<p style="margin-top: 1em">AUTHOR <br>
Thomas Roessler &lt;roessler@guug.de&gt;</p>

<p style="margin-top: 1em">Unix JANUARY 2016 dotlock(1)</p>
<hr>
</body>
</html>
