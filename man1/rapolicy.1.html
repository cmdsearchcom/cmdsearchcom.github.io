<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:34:58 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>RAPOLICY(1) General Commands Manual RAPOLICY(1)</p>

<p style="margin-top: 1em">NAME <br>
rapolicy - compare a argus(8) data file/stream against a
Cisco Access Control List.</p>

<p style="margin-top: 1em">SYNOPSIS <br>
rapolicy -r argus-file [raoptions] [--
filter-expression]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Rapolicy reads argus data from an argus-file list, and tests
the argus data stream against a Cisco access control list
configuration file Rapolicy can do many things as defined
<br>
by its configuration file. The configuration file in not
optional and the example below is well commented. The ACL
file is specified in the configuration file.</p>

<p style="margin-top: 1em">OPTIONS <br>
Rapolicy, like all ra based clients, supports a large number
of options. Options that have specific meaning to rapolicy
are:</p>

<p style="margin-top: 1em">-f &lt;rapolicy configuration
file&gt; defines the actions of the client. <br>
-D 3 Print the output of the state event machine.</p>

<p style="margin-top: 1em">See ra(1) for a complete
description of ra options.</p>

<p style="margin-top: 1em">EXAMPLE INVOCATION <br>
rapolicy -f rapolicy.conf -r argus.file</p>

<p style="margin-top: 1em">CISCO ACL SYNTAX <br>
Rapolicy handles both standard and extended, numbered and
named Cisco Access Control Lists</p>

<p style="margin-top: 1em">EXAMPLE CONFIGURATION <br>
This example is provided as an example only.</p>

<p style="margin-top: 1em"># <br>
# Argus Software <br>
# Copyright (c) 2000-2016 QoSient, LLC <br>
# All rights reserved. <br>
# <br>
# This program is free software; you can redistribute it
and/or modify <br>
# it under the terms of the GNU General Public License as
published by <br>
# the Free Software Foundation; either version 2, or (at
your option) <br>
# any later version. <br>
# <br>
# This program is distributed in the hope that it will be
useful, <br>
# but WITHOUT ANY WARRANTY; without even the implied
warranty of <br>
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See
the <br>
# GNU General Public License for more details. <br>
# <br>
# You should have received a copy of the GNU General Public
License <br>
# along with this program; if not, write to the Free
Software <br>
# Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
<br>
# <br>
# <br>
# Example rapolicy.conf <br>
# <br>
# Rapolicy, like most ra* programs, can read a program
specific <br>
# configuration file. This is an example configuration for
rapolicy() <br>
# that provides the opportunity to modify the default
behavior of <br>
# parsing a Cisco ACL definition, and reporting on flows
that match <br>
# aspects of the policy defined by the ACL. <br>
# <br>
# This file is read by rapolicy() from the command line
using the <br>
# &quot; -f rapolicy.conf &quot; option. <br>
# <br>
# RA_POLICY_DUMP_POLICY is a debugging aid. If it is set to
yes, then rapolicy() will read <br>
# and parse the ACL file and output an English language
description of the actions associated <br>
# with each ACL entry. After outputting the explaination,
rapolicy will exit.</p>


<p style="margin-top: 1em">RA_POLICY_DUMP_POLICY=&quot;yes&quot;</p>

<p style="margin-top: 1em"># The rapolicy client parses a
Cisco IOS ACL and constructs a filter which is used <br>
# to permit or deny flows. Under normal circumstances the
packets meeting the <br>
# criteria for a permit rule are output by the client. There
are circumstances where <br>
# it is useful to see the flows that are dropped.
RA_POLICY_SHOW_WHICH can be set <br>
# to a value of &quot;deny&quot; in these cases.</p>


<p style="margin-top: 1em">RA_POLICY_SHOW_WHICH=&quot;permit&quot;</p>

<p style="margin-top: 1em"># Under normal operating
conditions, only the flow records that match a permit <br>
# or a deny rule (depending on the value of
RA_POLICY_SHOW_WHICH) are output. In <br>
# some instance like baselining the actions of an ACL, the
goal is to have a fully <br>
# labeled set of flows regardless of the ACL&rsquo;s permit
or deny determination. In these <br>
# instances, a value of yes for RA_POLICY_JUST_LABEL will
allow the full processing of <br>
# the flows and will label them according to the settings of
the label flags but all of <br>
# the flows handled by the ACL will be output</p>


<p style="margin-top: 1em">RA_POLICY_JUST_LABEL=&quot;no&quot;</p>

<p style="margin-top: 1em"># A Cisco IP ACL normally has no
impact on non-IP traffic eg: ARP, DDCMP, Slotted-Aloha <br>
# RA_POLICY_PERMIT_OTHERS can be set to &quot;yes&quot; for
the normal behavior or &quot;no&quot; to block <br>
# non-IP traffic</p>


<p style="margin-top: 1em">RA_POLICY_PERMIT_OTHERS=&quot;yes&quot;</p>

<p style="margin-top: 1em"># The rapolicy client can add a
label to a flow indicating the action (permit, deny, <br>
# or implictDeny), the ACL name or number) and the line
within the ACL that caused the <br>
# action. <br>
# <br>
# if RA_POLICY_LABEL_LOG is set to &quot;yes&quot; labels
will be added to flows matching ACL <br>
# entries that have a log qualifier.</p>


<p style="margin-top: 1em">RA_POLICY_LABEL_LOG=&quot;no&quot;</p>

<p style="margin-top: 1em"># If RA_POLICY_LABEL_ALL is set
to &quot;yes&quot; regardless of the value of
RA_POLICY_LABEL_LOG, <br>
# any flow that matches an ACL entry will be labeled</p>


<p style="margin-top: 1em">RA_POLICY_LABEL_ALL=&quot;no&quot;</p>

<p style="margin-top: 1em"># Every Cisos IOS ACL has an
implicit deny as its last entry. Flows that do not match any
<br>
# ACL entry are usually dropped silently.
RA_POLICY_LABEL_IMPLICIT will label flows that <br>
# are dropped by the implicit deny rule. Under normal
circumstances, these flows are not <br>
# labeled. The values of RA_POLICY_LABEL_ALL and
RA_POLICY_LABEL_LOG do not govern the <br>
# labeling of these flows.</p>


<p style="margin-top: 1em">RA_POLICY_LABEL_IMPLICIT=&quot;no&quot;</p>

<p style="margin-top: 1em"># The ACL is contained in a
standard ASCII text file which is identified by the value of
<br>
# RA_POLICY_ACL_FILE Since rapolicy is not designed to be a
syntax checker, it is a <br>
# good idea to create the ACL on a Cisco device and take the
output of show running <br>
# (or the appropriate equivalent command) as the input ACL
for rapolicy() <br>
# The policy file should be defined as the last item in the
rapolicy.conf file <br>
# or there may be unexpected side effects</p>


<p style="margin-top: 1em">RA_POLICY_ACL_FILE=&quot;/tmp/ACL03.txt&quot;</p>

<p style="margin-top: 1em">COPYRIGHT <br>
Copyright (c) 2000-2016 QoSient. All rights reserved.</p>

<p style="margin-top: 1em">AUTHORS <br>
Carter Bullard (carter@qosient.com). <br>
David Edelman (dwedelman@acm.org)</p>

<p style="margin-top: 1em">SEE ALSO <br>
ra(1), rarc(5), argus(8)</p>

<p style="margin-top: 1em">rapolicy 3.0.8 09 July 2013
RAPOLICY(1)</p>
<hr>
</body>
</html>
