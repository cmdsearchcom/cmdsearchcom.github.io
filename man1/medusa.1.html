<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>MEDUSA(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">MEDUSA(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">MEDUSA(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
MEDUSA - Parallel Network Login Auditor
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>medusa</b> [-h host|-H file] [-u username|-U file] [-p password|-P file] [-C
  file] -M module [OPTIONS]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<i>Medusa</i> is intended to be a speedy, massively parallel, modular, login
  brute-forcer. The goal is to support as many services which allow remote
  authentication as possible. The author considers following items to some of
  the key features of this application:
<div style="height: 1.00em;">&#x00A0;</div>
*Thread-based parallel testing. Brute-force testing can be performed against
  multiple hosts, users or passwords concurrently.
<div style="height: 1.00em;">&#x00A0;</div>
*Flexible user input. Target information (host/user/password) can be specified
  in a variety of ways. For example, each item can be either a single entry or a
  file containing multiple entries. Additionally, a combination file format
  allows the user to refine their target listing.
<div style="height: 1.00em;">&#x00A0;</div>
*Modular design. Each service module exists as an independent .mod file. This
  means that no modifications are necessary to the core application in order to
  extend the supported list of services for brute-forcing.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h [TARGET]</b></dt>
  <dd class="It-tag">Target hostname or IP address.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-H [FILE]</b></dt>
  <dd class="It-tag">Reads target specifications from the file specified rather
      than from the command line. The file should contain a list separated by
      newlines.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-u [TARGET]</b></dt>
  <dd class="It-tag">Target username.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-U [FILE]</b></dt>
  <dd class="It-tag">Reads target usernames from the file specified rather than
      from the command line. The file should contain a list separated by
      newlines.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p [TARGET]</b></dt>
  <dd class="It-tag">Target password.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-P [FILE]</b></dt>
  <dd class="It-tag">Reads target passwords from the file specified rather than
      from the command line. The file should contain a list separated by
      newlines.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-C [FILE]</b></dt>
  <dd class="It-tag">File containing combo entries. Combo files are colon
      separated and in the following format: host:user:password. If any of the
      three fields are left empty, the respective information should be provided
      either as a single global value or as a list in a file.
    <div style="height: 1.00em;">&#x00A0;</div>
    The following combinations are possible in the combo file: 1.) foo:bar:fud
      2.) foo:bar: 3.) foo:: 4.) :bar:fud 5.) :bar: 6.) ::fud 7.) foo::fud
    <div style="height: 1.00em;">&#x00A0;</div>
    Medusa also supports using PwDump files as a combo file. The format of these
      files should be user:id:lm:ntlm:::. We look for ':::' at the end of the
      first line to determine if the file contains PwDump output.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-O [FILE]</b></dt>
  <dd class="It-tag">File to append log information to. Medusa will log all
      accounts credentials found to be valid or cause an unknown error. It will
      also log the start and stop times of an audit, along with the calling
      parameters.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-e [n/s/ns]</b></dt>
  <dd class="It-tag">Additional password checks ([n] No Password, [s] Password =
      Username). If both options are being used, they should be specified
      together (&quot;-e ns&quot;). If only a single option is being called use
      either &quot;-e n&quot; or &quot;-e s&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-M [TEXT]</b></dt>
  <dd class="It-tag">Name of the module to execute (without the .mod extension).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-m [TEXT]</b></dt>
  <dd class="It-tag">Parameter to pass to the module. This can be passed
      multiple times with a different parameter each time and they will all be
      sent to the module (i.e. -m Param1 -m Param2, etc.)
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d</b></dt>
  <dd class="It-tag">Dump all known modules.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n [NUM]</b></dt>
  <dd class="It-tag">Use for non-default TCP port number.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s</b></dt>
  <dd class="It-tag">Enable SSL.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-g [NUM]</b></dt>
  <dd class="It-tag">Give up after trying to connect for NUM seconds (default
      3).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-r [NUM]</b></dt>
  <dd class="It-tag">Sleep NUM seconds between retry attempts (default 3).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-R [NUM]</b></dt>
  <dd class="It-tag">Attempt NUM retries before giving up. The total number of
      attempts will be NUM + 1.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c [NUM]</b></dt>
  <dd class="It-tag">Set the number of usec that are waited during a test of the
      established network socket. Some services (e.g. FTP, IMAP, POP3, and SMTP)
      may be configured to drop connections after an arbitrary number of failed
      logon attempts. We try to reuse the established connection to send
      authentication attempts until this disconnect occurs, at which point the
      connection is reestablished. To accomplish this, we check the socket to
      see if it's still alive before authenticating within select modules. The
      default is perform a 1 usec check. It may be necessary to specify much
      larger values. For example, a 1000 usec was needed against our test vsftp
      server to avoid issues with its built-in anti-bruteforce mechanisms.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-t [NUM]</b></dt>
  <dd class="It-tag">Total number of logins to be tested concurrently. It should
      be noted that rougly t x T threads could be running at any one time. 381
      appears to be the limit on my fairly boring Gentoo Linux host.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-T [NUM]</b></dt>
  <dd class="It-tag">Total number of hosts to be tested concurrently.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-L</b></dt>
  <dd class="It-tag">Parallelize logins using one username per thread. The
      default is to process the entire username before proceeding.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b></dt>
  <dd class="It-tag">Stop scanning host after first valid username/password
      found.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-F</b></dt>
  <dd class="It-tag">Stop audit after first valid username/password found on any
      host.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-b</b></dt>
  <dd class="It-tag">Suppress startup banner
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-q</b></dt>
  <dd class="It-tag">Display module's usage information. This should be used in
      conjunction with the &quot;-M&quot; option. For example, &quot;medusa -M
      smbnt -q&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v [NUM]</b></dt>
  <dd class="It-tag">Verbose level [0 - 6 (more)]. All messages at or below the
      specified level will be displayed. The default level is 5.
    <div style="height: 1.00em;">&#x00A0;</div>
    The following is the breakdown of the verbose levels: 0) EXIT APPLICATION 1)
      MESSAGE WITHOUT TAG 2) LOG MESSAGE WITHOUT TAG 3) IMPORTANT MESSAGE 4)
      ACCOUNT FOUND 5) ACCOUNT CHECK 6) GENERAL MESSAGE
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-w [NUM]</b></dt>
  <dd class="It-tag">Error debug level [0 - 10 (more)]. All messages at or below
      the specified level will be displayed. The default level is 5.
    <div style="height: 1.00em;">&#x00A0;</div>
    The following is the breakdown of the error levels: 0) FATAL 1) ALERT 2)
      CRITICAL 3) ERROR 4) WARNING 5) NOTICE 6) INFO 7) DEBUG 8) DEBUG - AUDIT
      9) DEBUG - SERVER 10) DEBUG - MODULE
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-V</b></dt>
  <dd class="It-tag">Display version
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-Z [TEXT]</b></dt>
  <dd class="It-tag">Allows basic resuming of a previous scan. The supplied
      parameter describes which hosts were completed, which were partially
      tested and which had not been started. When Medusa receives a SIGINT, it
      will calculate and display a &quot;resume map&quot;. This map can then be
      supplied to the next run. For example, &quot;medusa [OPTIONS PREVIOUSLY
      USED] -Z h6u1u2h8.&quot;. In this particular example, hosts 1-5 were
      completed, host 6 was partially done (user 1 was partially completed and
      user 2 and beyond had not been started), host 7 was completed and host 8
      and beyond had not been started. Medusa will parse this map and skip hosts
      and users accordingly. It should be noted that only host and user-level,
      not password-level, resuming is supported. If a user had been previously
      started, but was not completed, it will be tested from the start of its
      respective password list.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
JoMo-Kun &lt;jmk@foofus.net&gt; fizzgig &lt;fizzgig@foofus.net&gt;
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Found a bug? Feel free to send in a patch.</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
