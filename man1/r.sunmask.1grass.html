<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>r.sunmask(1grass)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">r.sunmask(1grass)</td>
    <td class="head-vol">Grass User's Manual</td>
    <td class="head-rtitle">r.sunmask(1grass)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<i></i><b>r.sunmask</b> - Calculates cast shadow areas from sun position and
  elevation raster map.
<div>&#x00A0;</div>
Either exact sun position (A) is specified, or date/time to calculate the sun
  position (B) by r.sunmask itself.
<h1 class="Sh" title="Sh" id="KEYWORDS"><a class="selflink" href="#KEYWORDS">KEYWORDS</a></h1>
raster, solar, sun position, shadow
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>r.sunmask</b>
<div>&#x00A0;</div>
<b>r.sunmask --help</b>
<div>&#x00A0;</div>
<b>r.sunmask</b> [-<b>zsg</b>] <b>elevation</b>=<i>name</i>
  [<b>output</b>=<i>name</i>] [ <b>altitude</b>=<i>float</i>]
  [<b>azimuth</b>=<i>float</i>] [<b>year</b>=<i>integer</i>]
  [<b>month</b>=<i>integer</i>] [ <b>day</b>=<i>integer</i>]
  [<b>hour</b>=<i>integer</i>] [ <b>minute</b>=<i>integer</i>]
  [<b>second</b>=<i>integer</i>] [<b>timezone</b>=<i>integer</i>]
  [<b>east</b>=<i>value</i>] [<b>north</b>=<i>value</i>] [--<b>overwrite</b>]
  [-- <b>help</b>] [--<b>verbose</b>] [--<b>quiet</b>] [--<b>ui</b>]
<h2 class="Ss" title="Ss" id="Flags:"><a class="selflink" href="#Flags:">Flags:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-z</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Do not ignore zero elevation</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Calculate sun position only and exit</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-g</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Print the sun position output in shell script style</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--overwrite</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Allow output files to overwrite existing files</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Print usage summary</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verbose</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Verbose module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--quiet</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Quiet module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ui</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Force launching GUI dialog</dd>
</dl>
<h2 class="Ss" title="Ss" id="Parameters:"><a class="selflink" href="#Parameters:">Parameters:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>elevation</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input elevation raster map</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>output</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name for output raster map</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>altitude</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Altitude of the sun in degrees above the horizon (A)
    <div>&#x00A0;</div>
    Options: <i>0-89.999</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>azimuth</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Azimuth of the sun in degrees from north (A)
    <div>&#x00A0;</div>
    Options: <i>0-360</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>year</b>=<i>integer</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Year (B)
    <div>&#x00A0;</div>
    Options: <i>1950-2050</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>month</b>=<i>integer</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Month (B)
    <div>&#x00A0;</div>
    Options: <i>0-12</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>day</b>=<i>integer</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Day (B)
    <div>&#x00A0;</div>
    Options: <i>0-31</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>hour</b>=<i>integer</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Hour (B)
    <div>&#x00A0;</div>
    Options: <i>0-24</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>minute</b>=<i>integer</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Minutes (B)
    <div>&#x00A0;</div>
    Options: <i>0-60</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>second</b>=<i>integer</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Seconds (B)
    <div>&#x00A0;</div>
    Options: <i>0-60</i>
    <div>&#x00A0;</div>
    Default: <i>0</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>timezone</b>=<i>integer</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Timezone
    <div>&#x00A0;</div>
    East positive, offset from GMT, also use to adjust daylight savings</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>east</b>=<i>value</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Easting coordinate (point of interest)
    <div>&#x00A0;</div>
    Default: map center</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>north</b>=<i>value</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Northing coordinate (point of interest)
    <div>&#x00A0;</div>
    Default: map center</dd>
</dl>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<i>r.sunmask</i> creates an output map layer based on an input elevation raster
  map layer and the sun position. The output map layer contains the cast shadow
  areas arising from sun shine and elevations. The user can define the sun
  position either directly or the module calculates it from given location and
  date/time parameters using the NREL sun position algorithm. So either
  &quot;A:&quot;-parameters to specify the exact known sun position or
  &quot;B:-parameters&quot; to specify date/time for sun position calculation by
  <i>r.sunmask</i> itself have to be used.
<div class="Pp"></div>
The module performs sunset/sunrise checks and refraction correction for sun
  position calculation. Local coordinate systems are internally transformed to
  latitude/longitude for the SOLPOS algorithm. The elevation is not considered
  in the sunset/sunrise calculations.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
<i>r.sunmask</i> and daylight savings: Rather than converting the local time to
  GMT, the SOLPOS algorithm uses what is called Local Standard Time, which is
  generally politically defined as an offset from GMT. So the key is the offset
  from GMT, which the solpos Time Zone parameter. If the user specifies clock
  time (different for winter and summer), s/he would have to change the Time
  Zone parameter seasonally in <i>r.sunmask</i> (timezone parameter). See also
  Daylight saving time by region and country.
<div class="Pp"></div>
Note: In latitude/longitude locations the position coordinates pair (east/west)
  has to be specified in decimal degree (not D:M:S). If not specified, the map
  center&#x2019;s coordinates will be used. Also <i>g.region -l</i> displays the
  map center&#x2019;s coordinates in latitude/longitude (or <i>g.region -c</i>
  in the actual coordinate system).
<div class="Pp"></div>
Note for module usage with the <i>-g</i> flag, when performing calculations
  close to sunset/sunrise:
<div>&#x00A0;</div>
<pre>
 [...]
 sunangleabovehorizont=0.434240
 sunrise=07:59:19
 sunset=16:25:17
 Time (07:59:02) is before sunrise (07:59:19)!
 WARNING: Nothing to calculate. Please verify settings.
 No map calculation requested. Finished.
</pre>
In above calculation it appears to be a mistake as the program indicates that we
  are before sunrise while the <i>sun angle above horizon</i> is already
  positive. The reason is that <i>sun angle above horizon</i> is calculated with
  correction for atmosphere refraction while <i>sunrise</i> and <i>sunset</i>
  are calculated <b>without</b> correction for atmosphere refraction. The output
  without <i>-g</i> flag contains related indications.
<h1 class="Sh" title="Sh" id="EXAMPLE"><a class="selflink" href="#EXAMPLE">EXAMPLE</a></h1>
Example for North Carolina sample data set for the calculation of sun position
  angles and more:
<div>&#x00A0;</div>
<pre>
# set the region to a place near Raleigh (NC)
g.region raster=elev_lid792_1m -p
# compute only sun position and no output map
r.sunmask -s elev_lid792_1m year=2012 month=2 \
          day=22 hour=10 minute=30 timezone=-5
Using map center coordinates: 638650.000000 220375.000000
Calculating sun position... (using solpos (V. 11 April 2001) from NREL)
2012/02/22, daynum: 53, time: 10:30:00 (decimal time: 10.500000)
long: -78.678856, lat: 35.736160, timezone: -5.000000
Solar position: sun azimuth: 143.006409, sun angle above horz. (refraction corrected): 36.233879
Sunrise time (without refraction): 06:58:11
Sunset time  (without refraction): 17:58:47
# with -g flag, useful for eval() shell function
r.sunmask -s -g elev_lid792_1m  year=2012 month=2 \
          day=22 hour=10 minute=30 timezone=-5
Using map center coordinates: 638650.000000 220375.000000
Calculating sun position... (using solpos (V. 11 April 2001) from NREL)
date=2012/02/22
daynum=53
time=10:30:00
decimaltime=10.500000
longitudine=-78.678856
latitude=35.736160
timezone=-5.000000
sunazimuth=143.006409
sunangleabovehorizon=36.233879
sunrise=06:58:11
sunset=17:58:47
</pre>
<h1 class="Sh" title="Sh" id="Acknowledgements"><a class="selflink" href="#Acknowledgements">Acknowledgements</a></h1>
Acknowledgements: National Renewable Energy Laboratory for their SOLPOS 2.0 sun
  position algorithm.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i></i> <i>g.region,</i> <i>r.sun,</i> <i>r.sunhours,</i> <i>r.slope.aspect</i>
  <i></i>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Janne Soimasuo, Finland 1994
<div>&#x00A0;</div>
update to FP by Huidae Cho 2001
<div>&#x00A0;</div>
added solpos algorithm feature by Markus Neteler 2001
<div class="Pp"></div>
<i>Last changed: $Date: 2014-12-19 22:17:36 +0100 (Fri, 19 Dec 2014) $</i>
<h1 class="Sh" title="Sh" id="SOURCE_CODE"><a class="selflink" href="#SOURCE_CODE">SOURCE
  CODE</a></h1>
Available at: r.sunmask source code (history)
<div class="Pp"></div>
Main index | Raster index | Topics index | Keywords index | Graphical index |
  Full index
<div class="Pp"></div>
&#x00A9; 2003-2016 GRASS Development Team, GRASS GIS 7.2.0 Reference
  Manual</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os">GRASS 7.2.0</td>
  </tr>
</table>
</body>
</html>
