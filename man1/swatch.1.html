<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>SWATCH(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">SWATCH(1)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">SWATCH(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
swatch - simple watcher
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>swatch</b> [ <b>--awk-field-syntax</b> ] [ <b>--config-file|-c</b>
  <i>file</i> ] [ <b>--daemon</b> ] [ <b>--extra-include-dir|-I</b> <i>path</i>
  ] [ <b>--extra-module|-M</b> <i>module_name</i> ] [ <b>--help|-h</b> ] [
  <b>--input-record-separator</b> <i>regex</i> ] [ <b>--old-style-config|-O</b>
  ] [ <b>--pid-file</b> <i>file</i> ] [ <b>--restart-time|-r</b> <i>time</i> ] [
  <b>--script-dir</b> <i>path</i> ] [ <b>--tail-args</b>
  <i>arguments_for_tail_program</i> ] [ <b>--tail-program-name</b>
  <i>filename</i> ] [ <b>--version|-V</b> ] [ <b>--use-cpan-file-tail</b> ] [ [
  <b>--examine|-f</b> <i>file_to_examine</i> ] | [ <b>--read-pipe|-p</b>
  <i>program_to_pipe_from</i> ] | [ <b>--tail-file|-t</b> <i>file_to_tail</i> ]
  ] [ <b>--debug</b> [ <i>level</i> ] ] [ <b>--dump-script</b> <i>filename</i> ]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>Swatch</b> is designed to monitor system activity. In order for <b>Swatch</b>
  to be useful, it requires a configuration file which contains
  <i>pattern(s)</i> to look for and <i>action(s)</i> to perform when each
  pattern is found.
<h1 class="Sh" title="Sh" id="COMMAND_LINE_OPTIONS"><a class="selflink" href="#COMMAND_LINE_OPTIONS">COMMAND
  LINE OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--awk-field-syntax</b></dt>
  <dd class="It-tag">Use this option only if you want to overide regular
      expression backreferencing in favor of <b></b><b><i>awk</i></b><b>(1)</b>
      style field referencing. Included for backward compatability.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--config-file|-c</b> <i>filename</i></dt>
  <dd class="It-tag">Tells <b>swatch</b> where to find its configuration file.
      The default is <i>${HOME}/.swatchrc</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--daemon</b></dt>
  <dd class="It-tag">This tells <b>swatch</b> to run in the background and
      disassociate itself from any terminal.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--extra-include-dir|-I</b> <i>path</i></dt>
  <dd class="It-tag">This tells <b>swatch</b> where to look for custom
      <i>action</i> modules.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--extra-module|-M</b> <i>module_name</i></dt>
  <dd class="It-tag">This tells <b>swatch</b> what custom <i>action</i> modules
      to load in.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help|-h</b></dt>
  <dd class="It-tag">Prints usage information and exits.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--input-record-separator</b>=<i>regular_expression</i></dt>
  <dd class="It-tag">Tells <b>swatch</b> to use <i>regular_expression</i> to
      delineate the boundary of each input record. The default is a carriage
      return.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--old-style-config|-O</b></dt>
  <dd class="It-tag">This tells <b>swatch</b> that your configuration file is
      written using the syntax that was abandoned back in the 1990's.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--pid-file</b> <i>file</i></dt>
  <dd class="It-tag">Writes the process ID to <i>file</i>. Useful when running
      in daemon mode.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--restart-time</b>=<i>[+]hh:mm[am|pm]</i> or <b>-r</b>
    <i>[+]hh:mm[am|pm]</i></dt>
  <dd class="It-tag">Restart at the specified time where <i>hh</i> is hours and
      <i>mm</i> is minutes. If the am/pm indicator is omitted, then a 24-hour
      clock is assumed. If the time is preceded by the &quot;+&quot; character,
      then the restart time will be set to the current time plus the specified
      time and the am/pm indicator will be ignored.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--script-dir</b>=<i>/path/to/directory</i></dt>
  <dd class="It-tag">This switch causes the temporary watcher script to be
      written to a file in the specified directory rather than the user's home
      directory. It is highly advised that you do <b>NOT</b> use directories
      that are writable by others such as /tmp.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tail-args</b> <i>arguments_for_tail_program</i></dt>
  <dd class="It-tag">Pass specific options to the
      <b></b><b><i>tail</i></b><b>(1)</b> program.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tail-program-name</b> <i>filename</i></dt>
  <dd class="It-tag">Runs an alternate <b></b><b><i>tail</i></b><b>(1)</b> like
      program instead of the system default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--version</b> or <b>-V</b></dt>
  <dd class="It-tag">Prints version information and exits.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--use-cpan-file-tail</b></dt>
  <dd class="It-tag">Use CPAN's File::Tail module to read the log file instead
      of the <i>tail</i>(1) command.</dd>
</dl>
<div class="Pp"></div>
You may specify only one of the following options:
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tail-file</b>=<i>filename</i> or <b>-t</b>
    <i>filename</i></dt>
  <dd class="It-tag">Examine lines of text as they are added to filename.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--read-pipe</b>=<i>command</i> or <b>-p</b>
    <i>command</i></dt>
  <dd class="It-tag">Examine input piped in from the <i>command</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--examine</b>=<i>filename</i> or <b>-f</b>
    <i>filename</i></dt>
  <dd class="It-tag">Use <i>filename</i> as the file to examine. <b>Swatch</b>
      will do a single pass through the named file.</dd>
</dl>
<div class="Pp"></div>
The following options are purely for debugging purposes, but are documented here
  for completeness:
<dl class="Bl-tag">
  <dt class="It-tag"><b>--debug</b>[=<i>level</i>]</dt>
  <dd class="It-tag">Spew out various levels of debugging for swatch
    developers.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dump-script</b>[=<i>filename</i>]</dt>
  <dd class="It-tag">Instead of running the watcher script after it is
      generated, it is written to <i>filename</i> or to STDOUT.</dd>
</dl>
<div class="Pp"></div>
If swatch is called with no options, it is the same as typing the command line
<div class="Pp"></div>
<pre>
        swatch --config-file=~/.swatchrc --tail-file=/var/log/syslog
</pre>
<div class="Pp"></div>
or if /var/log/messages exists
<div class="Pp"></div>
<pre>
        swatch --config-file=~/.swatchrc --tail-file=/var/log/messages
</pre>
<h1 class="Sh" title="Sh" id="THE_CONFIGURATION_FILE"><a class="selflink" href="#THE_CONFIGURATION_FILE">THE
  CONFIGURATION FILE</a></h1>
The configuration file is used by the <b></b><b><i>swatch</i></b><b>(8)</b>
  program to determine what types of expression patterns to look for and what
  type of action(s) should be taken when a pattern is matched.
<div class="Pp"></div>
Each line should contain a keyword and a, sometimes optional, value for that
  keyword. The keyword and value are separated by a space or an equal (=) sign.
<div class="Pp"></div>
watchfor regex
<div class="Pp"></div>
ignore regex
<dl class="Bl-tag">
  <dt class="It-tag"><b>echo [modes]</b></dt>
  <dd class="It-tag">Echo the matched line. The text mode may be <i>normal</i>,
      <i>bold</i>, <i>underscore</i>, <i>blink</i>, <i>inverse</i>,
      <i>black</i>, <i>red</i>, <i>green</i>, <i>yellow</i>, <i>blue</i>,
      <i>magenta</i>, <i>cyan</i>, <i>white</i>, <i>black_h</i>, <i>red_h</i>,
      <i>green_h</i>, <i>yellow_h</i>, <i>blue_h</i>, <i>magenta_h</i>,
      <i>cyan_h</i>, and/or <i>white_h</i>. The <i>_h</i> colors specify a
      highlighting color. The other colors are assigned to the letters. Some
      modes may not work on some terminals. <b>Normal</b> is the default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>bell [N]</b></dt>
  <dd class="It-tag">Echo the matched line, and send a bell <i>N</i> times
      (default = 1).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>exec command</b></dt>
  <dd class="It-tag">Execute <i>command</i>. The <i>command</i> may contain
      variables which are substituted with fields from the matched line. A
      <i></i> <i>$N</i><i></i> will be replaced by the <i>Nth</i> field in the
      line. A <i></i><i>$0</i><i></i> or <i>$*</i> will be replaced by the
      entire line.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>mail
    [addresses=address:address:...][,subject=your_text_here]</b></dt>
  <dd class="It-tag">Send <i>mail</i> to <i>address(es)</i> containing the
      matched lines as they appear (default address is the user who is running
      the program).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>pipe command[,keep_open]</b></dt>
  <dd class="It-tag">Pipe matched lines into <i>command</i>. Use the
      <b>keep_open</b> option to force the pipe to stay open until a different
      pipe action is run or until swatch exits.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>write [user:user:...]</b></dt>
  <dd class="It-tag">Use <b></b><b><i>write</i></b><b>(1)</b> to send matched
      lines to <i>user(s)</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>throttle
    hours:minutes:seconds,[key=message|regex|&lt;regexE</b>]&gt;</dt>
  <dd class="It-tag">This action has been depreciated. Use <b>threshold</b>
      instead For example,</dd>
</dl>
<div style="margin-left: 4.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">throttle 15:00,key=&quot;foo&quot;</div>
</div>
<div style="margin-left: 4.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
would look like this
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">threshold
  track_by=&quot;foo&quot;,type=limit,count=1,seconds=900</div>
</div>
<div style="margin-left: 4.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>threshold track_by=key,
    type=&lt;limit|threshold|both</b>, count=number, seconds=number&gt;</dt>
  <dd class="It-tag">Thresholding can be done for the complete <b>watchfor</b>
      block and/or for individual actions. Add &quot;threshold=on&quot; as an
      option along with the other threshold options when thresholding an
      individual action.</dd>
</dl>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>track_by</b></dt>
  <dd class="It-tag">The value of this should be something that is unique to the
      <b>watchfor</b> regular expression. Tip: enclose unique parts of the
      regular expression in parentheses, then use the sub matches as part of the
      value (e.g. track_by=&quot;$2:$4&quot;).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>type</b></dt>
  <dd class="It-tag">There are three types of thresholding. They are as
    follows:</dd>
</dl>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>limit</b></dt>
  <dd class="It-tag">Perform action(s) for the first &quot;<b>count</b>&quot;
      matches during the time interval specified by &quot; <b>seconds</b>&quot;,
      then ignore events for the rest of the time interval (kind of like
      throttle)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>threshold</b></dt>
  <dd class="It-tag">Perform action(s) on each match for up to <b>count</b>
      matches during the time interval specified by <b>seconds</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>both</b></dt>
  <dd class="It-tag">Perform actions(s) once per time interval after
      &quot;<b>count</b>&quot; matches occur, then ignore additional matches
      during the time interval specified by &quot; <b>seconds</b>&quot;</dd>
</dl>
</div>
<div style="margin-left: 4.00ex;"></div>
</div>
<div style="margin-left: 4.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>continue</b></dt>
  <dd class="It-tag">Use this action to cause <b>swatch</b> to continue to try
      to match other pattern/action groups after it is done with the current
      pattern/action block.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>quit</b></dt>
  <dd class="It-tag">Use this action to cause <b>swatch</b> to clean up and quit
      immediately.</dd>
</dl>
<h1 class="Sh" title="Sh" id="SPECIAL_OPTION"><a class="selflink" href="#SPECIAL_OPTION">SPECIAL
  OPTION</a></h1>
The following may be used as an option for any of the above actions except for
  throttle and threshold.
<dl class="Bl-tag">
  <dt class="It-tag"><b>when=</b><i>day_of_week:hour_of_day</i></dt>
  <dd class="It-tag">Use this option to specify windows of time and days when
      the action can be performed. For example:</dd>
</dl>
<div style="margin-left: 4.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">mail=sysad-pager@somehost.somedomain,when=1-6:8-17</div>
</div>
<div style="margin-left: 4.00ex;"></div>
<h1 class="Sh" title="Sh" id="FOR_PERL_HACKS_ONLY"><a class="selflink" href="#FOR_PERL_HACKS_ONLY">FOR
  PERL HACKS ONLY</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>perlcode</b> [<i>depth</i>] arbitrary_Perl_code</dt>
  <dd class="It-tag">This permits you to easily insert random Perl code into
      your swatchrc file. The optional depth value tells swatch how deep into
      the code to put the perl code. (0=outside the main loop, 1=inside the main
      loop (default), 2=just inside the conditional used by the current watchfor
      statement, and 3=inside the throttle block).
    <div style="height: 1.00em;">&#x00A0;</div>
    Its intended use is to permit variable substitution. For example:</dd>
</dl>
<div style="margin-left: 4.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">perlcode
  $syslog=&quot;^\w{3}\s+\d{1,2}\s+\d{2}:\d{2}:\d{2}.*&quot;;
<div style="height: 1.00em;">&#x00A0;</div>
watchfor /$syslog hostname pppd/&gt;</div>
</div>
<div style="margin-left: 4.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
but any valid Perl is permitted. Remember the semicolon, and make judicious use
  of the <b>--dump-script</b> option if you run into trouble.</div>
<h1 class="Sh" title="Sh" id="CONFIGURATION_EXAMPLE"><a class="selflink" href="#CONFIGURATION_EXAMPLE">CONFIGURATION
  EXAMPLE</a></h1>
<div style="margin-left: 4.00ex;">perlcode my $fsf_regex =
  '\d{2}:\d{2}:\d{2}\s+(.* file system full)';
<div style="height: 1.00em;">&#x00A0;</div>
watchfor /$fsf_regex/
<br/>
 threshold track_by=$1,type=limit,count=1,seconds=60
<br/>
 echo
<br/>
 bell</div>
<div class="Pp"></div>
In this example, a line which contains the string &quot;file system full&quot;
  will be echoed and the screen bell will sound. Also, <b>threshold</b> will use
  what is matched within the parentheses as its key rather than trying to use
  the log message with its time stamp cut out. Multiple instances of the message
  will not be echoed if they appear within a minute of the first one. Instead
  the following message will be acted upon after the time interval has expired.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b></b><b><i>signal</i></b><b>(3)</b>, <b></b><b><i>perl</i></b><b>(1)</b>,
  <b></b> <b><i>perlre</i></b><b>(1)</b>
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
Upon receiving an ALRM or HUP signal swatch will re-read the configuration file
  and restart, except when used with the <i>--daemon</i> command line option
  where it will simply exit. Swatch will terminate gracefully when it receives a
  QUIT, TERM, or INT signal.
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
<pre>
    E. Todd Atkins
    Todd.Atkins@StanfordAlumni.ORG
</pre>
<h1 class="Sh" title="Sh" id="AVAILABILITY"><a class="selflink" href="#AVAILABILITY">AVAILABILITY</a></h1>
Swatch is a SourceForge project whose project page is at
  http://sourceforge.net/projects/swatch and homepage is at
  http://swatch.sourceforge.net</div>
<table class="foot">
  <tr>
    <td class="foot-date">2017-02-12</td>
    <td class="foot-os">perl v5.24.1</td>
  </tr>
</table>
</body>
</html>
