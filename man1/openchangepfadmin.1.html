<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>OPENCHANGEPFADMIN(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">OPENCHANGEPFADMIN(1)</td>
    <td class="head-vol">OpenChange Users' Manual</td>
    <td class="head-rtitle">OPENCHANGEPFADMIN(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
openchangepfadmin - Exchange users and Public Folder administration tool
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>
openchangepfadmin [-?] [-?|--help] [--usage] [-f|--database PATH] [-p|--profile PROFILE]
    [-P|--password PASSWORD] [--apassword=PASSWORD] [--adesc=DESCRIPTION] [--acomment=COMMENT]
    [--afullname=NAME] [--list] [--mkdir] [--rmdir] [--comment=COMMENT] [--dirclass=CLASS]
    [--adduser=USERNAME] [--rmuser=USERNAME] [--addright=RIGHT] [--rmright] [--modright=RIGHT]
    [--debuglevel=LEVEL] [--dump-data] [--folder=FOLDER] [--username=USERNAME]
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
openchangepfadmin is a administrative command line tool designed to facilitate
  user management related operations (create, delete, modify) on a remote
  Exchange server and manage public folder store and permissions.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="COMMANDS"><a class="selflink" href="#COMMANDS">COMMANDS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--adduser=USERNAME</b></dt>
  <dd class="It-tag">Create a Exchange user with the username specified by
      USERNAME
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--rmuser=USERNAME</b></dt>
  <dd class="It-tag">Delete the Exchange user account specified by USERNAME
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--list</b></dt>
  <dd class="It-tag">List Public Folder hierarchy (IPM_SUBTREE)
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--mkdir</b></dt>
  <dd class="It-tag">Create a folder in the Public Folder store
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--rmdir</b></dt>
  <dd class="It-tag">Delete a folder in the Public Folder store
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--addright=RIGHT</b></dt>
  <dd class="It-tag">Add permission and roles for a user on a Public Folder
      directory.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--modright=RIGHT</b></dt>
  <dd class="It-tag">Modify permissions and roles for a user on a Public Folder
      directory
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--rmright</b></dt>
  <dd class="It-tag">Delete permissions and roles for a specific user
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--database=DATABASE</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b></dt>
  <dd class="It-tag">Set the MAPI profile database. If no database is specified,
      then openchangeclient tries to load the default one:
      <b>$HOME/.openchange/profiles.ldb</b>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--profile=PROFILE</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p</b></dt>
  <dd class="It-tag">Set the profile to use. If a profile is not specified, and
      one of the profiles has been set as the default in the profile database
      (for example, using mapiprofile -S), then that default profile will be
      used.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--password</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-P</b></dt>
  <dd class="It-tag">Set the password for the profile to use. This can be
      omitted if the password is stored in the profile.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--apassword=PASSWORD</b></dt>
  <dd class="It-tag">Define the password to set for the user specified with
      --adduser. If no password is explicitely supplied, openchangepfadmin will
      arbitrary set a random one.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--adesc=DESCRIPTION</b></dt>
  <dd class="It-tag">This command can only be used with --adduser and specifies
      a description for this account
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--acomment=COMMENT</b></dt>
  <dd class="It-tag">This command can only be used with --adduser and specifies
      a comment for this account.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--afullname=NAME</b></dt>
  <dd class="It-tag">This command can only be used with --adduser and specifies
      the user full name for this account.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--comment=COMMENT</b></dt>
  <dd class="It-tag">This command can only be used with --mkdir and specifies a
      comment for the folder.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dirclass=CLASS</b></dt>
  <dd class="It-tag">This command can only be used with --mkdir and specifies
      the container class of the directory we want to create. Possible values
      are: IPF.Appointment, IPF.Contact, IPF.Journal, IPF.Note, IPF.StickyNote,
      IPF.Task, IPF.Post
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--folder=FOLDER</b></dt>
  <dd class="It-tag">This command can only be used with --addright, --modright
      and --rmright. Specify the folder where permissions and roles have to be
      changed.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--username=USERNAME</b></dt>
  <dd class="It-tag">This command can only be used with --addright, --modright
      and --rmright. Specify the username we want to change permissions and
      roles for.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dump-data</b></dt>
  <dd class="It-tag">Dump the hex data. This is only required for debugging or
      educational purposes.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--debuglevel LEVEL</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d</b></dt>
  <dd class="It-tag">Set the debug level.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<b>Creating user</b>
<pre>
openchangepfadmin --adduser=linuxowner --apassword=linuxowner   \
                    --adesc=&quot;Linux Owner Test account&quot;          \
		    --afullname=&quot;Linux Owner&quot;
    mapiadmin_user_add       : MAPI_E_SUCCESS (0x0)
username: linuxowner
password: linuxowner
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
Creates a user account with username and password set to linuxowner.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Deleting user:</b>
<pre>
openchangepfadmin --rmuser=linuxowner
    mapiadmin_user_del       : MAPI_E_SUCCESS (0x0)
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<b>Create Public Folder:</b>
<pre>
openchangepfadmin --mkdir --folder=public_events --dirclass=IPF.Appointment
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
Creates a folder in the Public Folder store named public_events with a container
  class set to Appointment. This folder will display calendar items.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Delete Public Folder:</b>
<pre>
openchangepfadmin --rmdir --folder=public_events
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<b>List Public Folder hierarchy:</b>
<pre>
openchangepfadmin --list
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<b>Add Permission:</b>
<pre>
openchangepfadmin --username=linuxowner --folder=public_events \
                    --addright=RoleOwner
Permission RoleOwner added for linuxowner on folder public_events
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<b>Modify Permission</b>
<pre>
openchangepfadmin --username=Anonymous --folder=public_events \
  		    --modright=RoleNone
Permission changed to RoleNone for Anonymous on folder appointment
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
Note that you can only change permissions for a user already listed in the ACL
  table.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="NOTE"><a class="selflink" href="#NOTE">NOTE</a></h1>
Permissions and Roles possible values are:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RightsNone</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RightsReadItems</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RightsCreateItems</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RightsEditOwn</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RightsDeleteOwn</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RightsEditAll</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RightsDeleteAll</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RightsCreateSubfolders</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RightsFolderOwner</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RightsFolderContact</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RoleNone</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RoleReviewer</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RoleContributor</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RoleNoneditingAuthor</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RoleAuthor</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RoleEditor</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RolePublishAuthor</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RolePublishEditor</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RightsAll</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RoleOwner			
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
AddUserPermission, ModifyUserPermission, RemoveUserPermission
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Julien Kerihuel &lt;j.kerihuel at openchange dot org&gt;</div>
<table class="foot">
  <tr>
    <td class="foot-date">2013-01-24</td>
    <td class="foot-os">OpenChange 2.0 QUADRANT</td>
  </tr>
</table>
</body>
</html>
