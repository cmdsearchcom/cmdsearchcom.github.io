<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>CPDUP(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">CPDUP(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">CPDUP(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<b class="Nm" title="Nm">cpdup</b> &#x2014; <span class="Nd" title="Nd">mirror
  filesystems</span>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<table class="Nm">
  <tr>
    <td><b class="Nm" title="Nm">cpdup</b></td>
    <td>[<span class="Op"><b class="Fl" title="Fl">-C</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-v</b>[<span class="Op"><b class="Cm" title="Cm">v</b>[<span class="Op"><b class="Cm" title="Cm">v</b></span>]</span>]</span>]
      [<span class="Op"><b class="Fl" title="Fl">-d</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-n</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-u</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-I</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-f</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-F</b>
      <var class="Ar" title="Ar">ssh-arg</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-s0</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-i0</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-j0</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-l</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-q</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-o</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-m</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-H</b>
      <var class="Ar" title="Ar">path</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-M</b>
      <var class="Ar" title="Ar">file</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-V</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-VV</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-S</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-R</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-k</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-K</b>
      <var class="Ar" title="Ar">file</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-X</b>
      <var class="Ar" title="Ar">file</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-x</b></span>]
      [<span class="Op">[<span class="Op"><var class="Ar" title="Ar">user</var><code class="Li">@</code></span>]<var class="Ar" title="Ar">host</var>:</span>]<var class="Ar" title="Ar">source_dir</var>
      [<span class="Op">[<span class="Op"><var class="Ar" title="Ar">user</var><code class="Li">@</code></span>]<var class="Ar" title="Ar">host</var>:</span>]<var class="Ar" title="Ar">target_dir</var></td>
  </tr>
</table>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <b class="Nm" title="Nm">cpdup</b> utility makes an exact mirror copy of the
  source in the destination, creating and deleting files and directories as
  necessary. UTimes, hardlinks, softlinks, devices, permissions, and flags are
  mirrored. By default, <b class="Nm" title="Nm">cpdup</b> asks for confirmation
  if any file or directory needs to be removed from the destination and does not
  copy files which it believes to have already been synchronized (by observing
  that the source and destination files' sizes and mtimes match).
  <b class="Nm" title="Nm">cpdup</b> does not cross mount points in either the
  source or the destination. As a safety measure,
  <b class="Nm" title="Nm">cpdup</b> refuses to replace a destination directory
  with a file.
<div class="Pp"></div>
The following options are available:
<dl class="Bl-tag" style="margin-left: 7.80ex;">
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#C"><b class="Fl" title="Fl" id="C">-C</b></a></dt>
  <dd class="It-tag">If the source or target is a remote host, request that the
      <a class="Xr" title="Xr">ssh(1)</a> session be compressed. This is the
      same as <b class="Fl" title="Fl">-F</b>
    <b class="Fl" title="Fl">-C</b>.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#v"><b class="Fl" title="Fl" id="v">-v</b></a>[<span class="Op"><b class="Cm" title="Cm">v</b>[<span class="Op"><b class="Cm" title="Cm">v</b></span>]</span>]</dt>
  <dd class="It-tag">Set verboseness. By default
      <b class="Nm" title="Nm">cpdup</b> does not report its progress except
      when asking for confirmation. A single <b class="Fl" title="Fl">-v</b>
      will only report modifications made to the destination.
      <b class="Fl" title="Fl">-vv</b> will report directories as they are being
      traversed as well as modifications made to the destination.
      <b class="Fl" title="Fl">-vvv</b> will cause all files and directories to
      be reported whether or not modifications are made.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#d"><b class="Fl" title="Fl" id="d">-d</b></a></dt>
  <dd class="It-tag">Print directories as they are being traversed. Useful to
      watch the progress; this typically produces much less output than
      <b class="Fl" title="Fl">-vv</b>.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#n"><b class="Fl" title="Fl" id="n">-n</b></a></dt>
  <dd class="It-tag">Go through the motions but don't actually make any changes
      to the target.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#u"><b class="Fl" title="Fl" id="u">-u</b></a></dt>
  <dd class="It-tag">Causes the output generated by
      <b class="Fl" title="Fl">-v</b> and <b class="Fl" title="Fl">-d</b> to be
      unbuffered. This can be useful for obtaining prompt progress updates
      through a pipe.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#I"><b class="Fl" title="Fl" id="I">-I</b></a></dt>
  <dd class="It-tag">will cause <b class="Nm" title="Nm">cpdup</b> to print a
      summary at the end with performance counters.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#f"><b class="Fl" title="Fl" id="f">-f</b></a></dt>
  <dd class="It-tag">Forces file updates to occur even if the files appear to be
      the same. If the <b class="Fl" title="Fl">-H</b> option is used, this
      option will force a byte for byte comparison between the original file and
      the file in the hardlink path, even if all the stat info matches, but will
      still use a hardlink if they match.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#F"><b class="Fl" title="Fl" id="F">-F</b></a>
    <var class="Ar" title="Ar">ssh-arg</var></dt>
  <dd class="It-tag">Pass <var class="Ar" title="Ar">ssh-arg</var> to ssh. For
      example &#x201C;<b class="Fl" title="Fl">-F</b>
      <b class="Fl" title="Fl">-p222</b>&#x201D;. Note the lack of a space.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#s0"><b class="Fl" title="Fl" id="s0">-s0</b></a></dt>
  <dd class="It-tag">Disable the disallow-file-replaces-directory safety
      feature. This safety feature is enabled by default to prevent user
      mistakes from blowing away everything accidentally.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#i0"><b class="Fl" title="Fl" id="i0">-i0</b></a></dt>
  <dd class="It-tag">Do not request confirmation when removing something.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#j0"><b class="Fl" title="Fl" id="j0">-j0</b></a></dt>
  <dd class="It-tag">Do not try to recreate CHR or BLK devices.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#l"><b class="Fl" title="Fl" id="l">-l</b></a></dt>
  <dd class="It-tag">Line buffer verbose output.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#q"><b class="Fl" title="Fl" id="q">-q</b></a></dt>
  <dd class="It-tag">Quiet operation.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#o"><b class="Fl" title="Fl" id="o">-o</b></a></dt>
  <dd class="It-tag">Do not remove any files, just overwrite/add.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#m"><b class="Fl" title="Fl" id="m">-m</b></a></dt>
  <dd class="It-tag">Generate and maintain a MD5 checkfile called
      <i class="Pa" title="Pa">.MD5.CHECKSUMS</i> in each directory on the
      source and do an MD5 check on each file of the destination when the
      destination appears to be the same as the source. If the check fails, the
      source is recopied to the destination. When you specify a destination
      directory, the MD5 checkfile is only updated as needed and may not be
      updated even if modifications are made to a source file. If you do not
      specify a destination directory the <b class="Nm" title="Nm">cpdup</b>
      command forcefully regenerates the MD5 checkfile for every file in the
      source.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#M"><b class="Fl" title="Fl" id="M">-M</b></a>
    <var class="Ar" title="Ar">file</var></dt>
  <dd class="It-tag">Works the same as <b class="Fl" title="Fl">-m</b> but
      allows you to specify the name of the MD5 checkfile.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#H"><b class="Fl" title="Fl" id="H">-H</b></a>
    <var class="Ar" title="Ar">path</var></dt>
  <dd class="It-tag"><b class="Nm" title="Nm">cpdup</b> will create a hardlink
      from a file found under <var class="Ar" title="Ar">path</var> to the
      target instead of copying the source to the target if the file found via
      <var class="Ar" title="Ar">path</var> is identical to the source. Note
      that a remote host specification should not be used for this option's
      <var class="Ar" title="Ar">path</var>, but the
      <var class="Ar" title="Ar">path</var> will be relative to the target
      machine.
    <div class="Pp"></div>
    This allows one to use <b class="Nm" title="Nm">cpdup</b> to create
      incremental backups of a filesystem. Create a direct &#x2018;level
      0&#x2019; backup, and then specify the level 0 backup path with this
      option when creating an incremental backup to a different target
      directory. This method works so long as the filesystem does not hit a
      hardlink limit. If the system does hit a hardlink limit,
      <b class="Nm" title="Nm">cpdup</b> will generate a warning and copy the
      file instead. Note that <b class="Nm" title="Nm">cpdup</b> must record
      file paths for any hardlinked file while operating and therefore uses a
      great deal more memory when dealing with hardlinks or hardlink-based
      backups. Example use:
    <div class="Pp"></div>
    <div class="D1"><code class="Li">cpdup -i0 -s0 -I -H /backup/home.l0 /home
      /backup/home.l1</code></div>
    <div class="Pp"></div>
    WARNING: If this option is used <b class="Nm" title="Nm">cpdup</b> must
      record the paths for all files it encounters while it operates and it is
      possible that you may run the process out of memory.
    <div class="Pp"></div>
    The file found via the hardlink path will be byte-by-byte compared with the
      source if the <b class="Fl" title="Fl">-V</b> or
      <b class="Fl" title="Fl">-f</b> option is also used, otherwise only the
      stat info is checked to determine whether it matches the source.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#V"><b class="Fl" title="Fl" id="V">-V</b></a></dt>
  <dd class="It-tag">This forces the contents of regular files to be verified,
      even if the files appear to the be the same. Whereas the
      <b class="Fl" title="Fl">-f</b> (force) option forces a copy regardless,
      this option will avoid rewriting the target if everything matches and the
      contents are verified to be the same.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#VV"><b class="Fl" title="Fl" id="VV">-VV</b></a></dt>
  <dd class="It-tag">This works the same as <b class="Fl" title="Fl">-V</b> but
      ignores mtime entirely, making it suitable for comparing HAMMER master and
      slave filesystems or copies made without mtime retention.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#S"><b class="Fl" title="Fl" id="S">-S</b></a></dt>
  <dd class="It-tag">This places <b class="Nm" title="Nm">cpdup</b> into slave
      mode and is used to initiate the slave protocol on a remote machine. This
      option is not intended to be used by humans.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#R"><b class="Fl" title="Fl" id="R">-R</b></a></dt>
  <dd class="It-tag">Place the slave into read-only mode. Can only be used when
      the source is remote. Useful for unattended backups via SSH keys.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#k"><b class="Fl" title="Fl" id="k">-k</b></a></dt>
  <dd class="It-tag">Generate and maintain a FSMID checkfile called
      <i class="Pa" title="Pa"> .FSMID.CHECK</i> in each directory on the
      target. <b class="Nm" title="Nm">cpdup</b> will check the FSMID for each
      source file or directory against the checkfile on the target and will not
      copy the file or recurse through the directory when a match occurs. Any
      source file or directory with the same name as the checkfile will be
      ignored. The FSMID will be re-checked after the copy has been completed
      and <b class="Nm" title="Nm">cpdup</b> will loop on that directory or file
      until it is sure it has an exact copy.
    <div class="Pp"></div>
    Warning: FSMID is not always supported by a filesystem and may not be
      synchronized if a crash occurs. <span class="Ux">DragonFly</span> will
      simulate an FSMID when it is otherwise not supported by the filesystem,
      and users should be aware that simulated FSMIDs may change state in such
      cases even if the underlying hierarchy does not due to cache flushes.
      Additionally, the FSMID may not reflect changes made to remote filesystems
      by other hosts. For example, using these options with NFS mounted sources
      will not work well.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#K"><b class="Fl" title="Fl" id="K">-K</b></a>
    <var class="Ar" title="Ar">file</var></dt>
  <dd class="It-tag">Works the same as <b class="Fl" title="Fl">-k</b> but
      allows you to specify the name of the FSMID checkfile.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#x"><b class="Fl" title="Fl" id="x">-x</b></a></dt>
  <dd class="It-tag">Causes <b class="Nm" title="Nm">cpdup</b> to use the
      exclusion file <i class="Pa" title="Pa">.cpignore</i> in each directory on
      the source to determine which files to ignore. When this option is used,
      the exclusion filename itself is automatically excluded from the copy. If
      this option is not used then the filename
      <i class="Pa" title="Pa">.cpignore</i> is not considered special and will
      be copied along with everything else.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><a class="selflink" href="#X"><b class="Fl" title="Fl" id="X">-X</b></a>
    <var class="Ar" title="Ar">file</var></dt>
  <dd class="It-tag">Works the same as <b class="Fl" title="Fl">-x</b> but
      allows you to specify the name of the exclusion file. This file is
      automatically excluded from the copy. Only one exclusion file may be
      specified.</dd>
</dl>
<h1 class="Sh" title="Sh" id="REMOTE_COPYING"><a class="selflink" href="#REMOTE_COPYING">REMOTE
  COPYING</a></h1>
<b class="Nm" title="Nm">cpdup</b> can mirror directory structures across
  machines and can also do third-party copies. This also works between machines
  that use different byte order. <a class="Xr" title="Xr">ssh(1)</a> sessions
  are used and <b class="Nm" title="Nm">cpdup</b> is run on the remote
  machine(s) in slave mode. You can use the <b class="Fl" title="Fl">-F</b>
  option to pass additional flags to the ssh command if necessary.
<div class="Pp"></div>
The syntax of remote path specifications is similar to
  <a class="Xr" title="Xr">scp(1)</a>. In particular, that means that a local
  path containing a colon must be preceded by a slash to prevent it being
  considered a remote host: &#x2018;<code class="Li">foo:bar</code>&#x2019;
  causes <b class="Nm" title="Nm">cpdup</b> to look for a directory called
  &#x2018;<code class="Li">bar</code>&#x2019; on host
  &#x2018;<code class="Li">foo</code>&#x2019;, while
  &#x2018;<code class="Li">./foo:bar</code>&#x2019; denotes the directory
  &#x2018;<code class="Li">foo:bar</code>&#x2019; on the local machine.
<h1 class="Sh" title="Sh" id="DIAGNOSTICS"><a class="selflink" href="#DIAGNOSTICS">DIAGNOSTICS</a></h1>
The <b class="Nm" title="Nm">cpdup</b> utility exits 0 if no error occurred and
  &gt;0 if an error occurred.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<a class="Xr" title="Xr">cp(1)</a>, <a class="Xr" title="Xr">cpio(1)</a>,
  <a class="Xr" title="Xr">scp(1)</a>, <a class="Xr" title="Xr">ssh(1)</a>,
  <a class="Xr" title="Xr">tar(1)</a>
<h1 class="Sh" title="Sh" id="HISTORY"><a class="selflink" href="#HISTORY">HISTORY</a></h1>
The <b class="Nm" title="Nm">cpdup</b> command was originally created to update
  servers at BEST Internet circa 1997 and was placed under the
  <span class="Ux">FreeBSD</span> copyright for inclusion in the ports area in
  1999. The program was written by Matthew Dillon, Dima Ruban, and later
  significantly improved by Oliver Fromme.
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
<a class="Xr" title="Xr">UFS(5)</a> has a hardlink limit of 32767. Many
  programs, in particular CVS with regards to its CVS/Root file, will generate a
  lot of hard links. When using the <b class="Fl" title="Fl">-H</b> option it
  may not be possible for <b class="Nm" title="Nm">cpdup</b> to maintain these
  hard links. If this occurs, <b class="Nm" title="Nm">cpdup</b> will be forced
  to copy the file instead of link it, and thus not be able to make a perfect
  copy of the filesystem.
<div class="Pp"></div>
When so-called sparse files (i.e. files with &quot;holes&quot;) are copied, the
  holes will be filled in the target files, so they occupy more physical disk
  space than the source files.
<div class="Pp"></div>
For compatibility reasons, the slave protocol is not as efficient for writing
  remote files as it is for reading them. Therefore it is recommended to run
  <b class="Nm" title="Nm">cpdup</b> on the target machine when making remote
  copies, so the source machine is remote. If you do it the other way,
  <b class="Nm" title="Nm">cpdup</b> will run somewhat slower.</div>
<table class="foot">
  <tr>
    <td class="foot-date">November 24, 2009</td>
    <td class="foot-os">Linux 4.12.14-300.fc26.x86_64</td>
  </tr>
</table>
</body>
</html>
