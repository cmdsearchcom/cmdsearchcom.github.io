<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:11:32 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>GABBI(1) Gabbi GABBI(1)</p>

<p style="margin-top: 1em">NAME <br>
gabbi - Gabbi Documentation</p>

<p style="margin-top: 1em">Gabbi tests are expressed in
YAML as a series of HTTP requests with their expected
response:</p>

<p style="margin-top: 1em">tests: <br>
- name: retrieve root <br>
GET: / <br>
status: 200</p>

<p style="margin-top: 1em">This will trigger a GET request
to / on the configured host. The test will pass if the
response&rsquo;s status code is 200.</p>

<p style="margin-top: 1em">TEST STRUCTURE <br>
The top-level tests category contains an ordered sequence of
test declarations, each describing the expected response to
a given request:</p>

<p style="margin-top: 1em">Metadata <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;
<br>
&acirc;Key &acirc; Description &acirc; Notes &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;name &acirc; The test&rsquo;s name. Must be unique
within a file. &acirc; required &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;desc &acirc; An arbitrary string describing the test.
&acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;verbose &acirc; If True or all (synonymous), prints a
repre&acirc; &acirc; defaults to False &acirc; <br>
&acirc; &acirc; sentation of the current request and
response &acirc; &acirc; <br>
&acirc; &acirc; to stdout, including both headers and body.
If &acirc; &acirc; <br>
&acirc; &acirc; set to headers or body, only the
corresponding &acirc; &acirc; <br>
&acirc; &acirc; part of the request and response will be
&acirc; &acirc; <br>
&acirc; &acirc; printed. If the output is a TTY, colors will
&acirc; &acirc; <br>
&acirc; &acirc; be used. See VerboseHttp for details.
&acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;skip &acirc; A string message which if set will cause
the &acirc; defaults to False &acirc; <br>
&acirc; &acirc; test to be skipped with the provided
message. &acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;xfail &acirc; Determines whether to expect this test
to &acirc; &acirc; <br>
&acirc; &acirc; fail. Note that the test will be run anyway.
&acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;</p>

<p style="margin-top: 1em">Note: When tests are generated
dynamically, the TestCase name will include the respective
test&rsquo;s name, lowercased with spaces transformed to _.
In at least some test runners this <br>
will allow you to select and filter on test name.</p>

<p style="margin-top: 1em">Request Parameters <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;
<br>
&acirc;Key &acirc; Description &acirc; Notes &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;any uppercase string &acirc; Any such key is
considered an HTTP method, &acirc; &acirc; <br>
&acirc; &acirc; with the corresponding value expressing the
&acirc; &acirc; <br>
&acirc; &acirc; URL. &acirc; &acirc; <br>
&acirc; &acirc; &acirc; &acirc; <br>
&acirc; &acirc; This is a shortcut combining method and url
&acirc; &acirc; <br>
&acirc; &acirc; into a single statement: &acirc; &acirc;
<br>
&acirc; &acirc; &acirc; &acirc; <br>
&acirc; &acirc; GET: /index &acirc; &acirc; <br>
&acirc; &acirc; &acirc; &acirc; <br>
&acirc; &acirc; corresponds to: &acirc; &acirc; <br>
&acirc; &acirc; &acirc; &acirc; <br>
&acirc; &acirc; method: GET &acirc; &acirc; <br>
&acirc; &acirc; url: /index &acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;method &acirc; The HTTP request method. &acirc;
defaults to GET &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;</p>

<p style="margin-top: 1em">&acirc;url &acirc; The URL to
request. This can either be a full &acirc; required &acirc;
<br>
&acirc; &acirc; path (e.g. &quot;/index&quot;) or a fully
qualified URL &acirc; &acirc; <br>
&acirc; &acirc; (i.e. including host and scheme, e.g.
&quot;&acirc; &acirc; &acirc; <br>
&acirc; &acirc; http://example.org/index&quot;) &acirc; see
host for &acirc; &acirc; <br>
&acirc; &acirc; details. &acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;request_headers &acirc; A dictionary of key-value
pairs representing &acirc; &acirc; <br>
&acirc; &acirc; request header names and values. These will
be &acirc; &acirc; <br>
&acirc; &acirc; added to the constructed request. &acirc;
&acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;query_parameters &acirc; A dictionary of query
parameters that will be &acirc; &acirc; <br>
&acirc; &acirc; added to the url as query string. If that
URL &acirc; &acirc; <br>
&acirc; &acirc; already contains a set of query parameters,
&acirc; &acirc; <br>
&acirc; &acirc; those wil be extended. See example for a
&acirc; &acirc; <br>
&acirc; &acirc; demonstration of how the data is structured.
&acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;data &acirc; A representation to pass as the body of
a &acirc; &acirc; <br>
&acirc; &acirc; request. Note that content-type in &acirc;
&acirc; <br>
&acirc; &acirc; request_headers should also be set &acirc;
see Data &acirc; &acirc; <br>
&acirc; &acirc; for details. &acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;redirects &acirc; If True, redirects will
automatically be fol&acirc; &acirc; defaults to False
&acirc; <br>
&acirc; &acirc; lowed. &acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;ssl &acirc; Determines whether the request uses SSL
(i.e. &acirc; defaults to False &acirc; <br>
&acirc; &acirc; HTTPS). Note that the url&rsquo;s scheme
takes &acirc; &acirc; <br>
&acirc; &acirc; precedence if present &acirc; see host for
details. &acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;</p>

<p style="margin-top: 1em">Response Expectations <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;
<br>
&acirc;Key &acirc; Description &acirc; Notes &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;status &acirc; The expected response status code.
Multiple &acirc; defaults to 200 &acirc; <br>
&acirc; &acirc; acceptable response codes may be provided,
&acirc; &acirc; <br>
&acirc; &acirc; separated by || (e.g. 302 || 301 &acirc;
note, how&acirc; &acirc; &acirc; <br>
&acirc; &acirc; ever, that this indicates ambiguity, which
is &acirc; &acirc; <br>
&acirc; &acirc; generally undesirable). &acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;response_headers &acirc; A dictionary of key-value
pairs representing &acirc; &acirc; <br>
&acirc; &acirc; expected response header names and values.
If &acirc; &acirc; <br>
&acirc; &acirc; a header&rsquo;s value is wrapped in /.../,
it will &acirc; &acirc; <br>
&acirc; &acirc; be treated as a regular expression. &acirc;
&acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;response_forbidden_headers &acirc; A list of headers
which must not be present. &acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;response_strings &acirc; A list of string fragments
expected to be &acirc; &acirc; <br>
&acirc; &acirc; present in the response body. &acirc;
&acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;response_json_paths &acirc; A dictionary of JSONPath
rules paired with &acirc; &acirc; <br>
&acirc; &acirc; expected matches. Using this rule requires
&acirc; &acirc; <br>
&acirc; &acirc; that the content being sent from the server
is &acirc; &acirc; <br>
&acirc; &acirc; JSON (i.e. a content type of
application/json &acirc; &acirc; <br>
&acirc; &acirc; or containing +json) &acirc; &acirc; <br>
&acirc; &acirc; &acirc; &acirc; <br>
&acirc; &acirc; If the value is wrapped in /.../ the result
of &acirc; &acirc; <br>
&acirc; &acirc; the JSONPath query will be compared against
&acirc; &acirc; <br>
&acirc; &acirc; the value as a regular expression. &acirc;
&acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;</p>

<p style="margin-top: 1em">&acirc;poll &acirc; A dictionary
of two keys: &acirc; &acirc; <br>
&acirc; &acirc; &acirc; &acirc; <br>
&acirc; &acirc; &Acirc;&middot; count: An integer stating
the number &acirc; &acirc; <br>
&acirc; &acirc; of times to attempt this test before &acirc;
&acirc; <br>
&acirc; &acirc; giving up. &acirc; &acirc; <br>
&acirc; &acirc; &acirc; &acirc; <br>
&acirc; &acirc; &Acirc;&middot; delay: A floating point
number of &acirc; &acirc; <br>
&acirc; &acirc; seconds to delay between attempts. &acirc;
&acirc; <br>
&acirc; &acirc; &acirc; &acirc; <br>
&acirc; &acirc; This makes it possible to poll for a &acirc;
&acirc; <br>
&acirc; &acirc; resource created via an asynchronous &acirc;
&acirc; <br>
&acirc; &acirc; request. Use with caution. &acirc; &acirc;
<br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;</p>

<p style="margin-top: 1em">Note that many of these items
allow substitutions.</p>

<p style="margin-top: 1em">Default values for a
file&rsquo;s tests may be provided via the top-level
defaults category. These take precedence over the global
defaults (explained below).</p>

<p style="margin-top: 1em">For examples see the gabbi
tests, example and the gabbi-demo tutorial.</p>

<p style="margin-top: 1em">FIXTURES <br>
The top-level fixtures category contains a sequence of named
fixtures.</p>

<p style="margin-top: 1em">RESPONSE HANDLERS <br>
response_* keys are examples of Response Handlers. Custom
handlers may be created by test authors for specific use
cases. See handlers for more information.</p>

<p style="margin-top: 1em">SUBSTITUTION <br>
There are a number of magical variables that can be used to
make reference to the state of a current test or the one
just prior. These are replaced with real values during test
<br>
processing. They are processed in the order given.</p>

<p style="margin-top: 1em">&Acirc;&middot; $SCHEME: The
current scheme/protocol (usually http or https).</p>

<p style="margin-top: 1em">&Acirc;&middot; $NETLOC: The
host and potentially port of the request.</p>

<p style="margin-top: 1em">&Acirc;&middot;
$ENVIRON[&rsquo;&lt;environment variable&gt;&rsquo;]: The
name of an environment variable. Its value will replace the
magical variable. If the string value of the environment
variable is &quot;True&quot; <br>
or &quot;False&quot; then the resulting value will be the
corresponding boolean, not a string.</p>

<p style="margin-top: 1em">&Acirc;&middot; $COOKIE: All the
cookies set by any Set-Cookie headers in the prior response,
including only the cookie key and value pairs and no
metadata (e.g. expires or domain).</p>

<p style="margin-top: 1em">&Acirc;&middot; $LAST_URL: The
URL defined in the prior request, after substitutions have
been made.</p>

<p style="margin-top: 1em">&Acirc;&middot; $LOCATION: The
location header returned in the prior response.</p>

<p style="margin-top: 1em">&Acirc;&middot;
$HEADERS[&rsquo;&lt;header&gt;&rsquo;]: The value of any
header from the prior response.</p>

<p style="margin-top: 1em">&Acirc;&middot;
$RESPONSE[&rsquo;&lt;json path&gt;&rsquo;]: A JSONPath query
into the prior response. See jsonpath for more on
formatting.</p>

<p style="margin-top: 1em">Where a single-quote character,
&rsquo;, is shown above you may also use a double-quote
character, &quot;, but in any given expression the same
character must be used at both ends.</p>

<p style="margin-top: 1em">All of these variables may be
used in all of the following fields:</p>

<p style="margin-top: 1em">&Acirc;&middot; url</p>

<p style="margin-top: 1em">&Acirc;&middot;
query_parameters</p>

<p style="margin-top: 1em">&Acirc;&middot; data</p>

<p style="margin-top: 1em">&Acirc;&middot;
request_headers</p>

<p style="margin-top: 1em">&Acirc;&middot;
response_strings</p>

<p style="margin-top: 1em">&Acirc;&middot;
response_json_paths (on the value side of the key value
pair)</p>

<p style="margin-top: 1em">&Acirc;&middot; response_headers
(on the value side of the key value pair)</p>

<p style="margin-top: 1em">&Acirc;&middot;
response_forbidden_headers</p>

<p style="margin-top: 1em">With these variables it ought to
be possible to traverse an API without any explicit
statements about the URLs being used. If you need a
replacement on a field that is not cur&acirc; <br>
rently supported please raise an issue or provide a
patch.</p>

<p style="margin-top: 1em">As all of these features needed
to be tested in the development of gabbi itself, the gabbi
tests are a good source of examples on how to use the
functionality. See also example <br>
for a collection of examples and the gabbi-demo
tutorial.</p>

<p style="margin-top: 1em">DATA <br>
The data key has some special handing to allow for a bit
more flexibility when doing a POST or PUT. If the value is
not a string (that is, it is a sequence or structure) it is
<br>
treated as a data structure which is turned into a JSON
string. If the value is a string that begins with &lt;@ then
the rest of the string is treated as the name of a file to
be <br>
loaded from the same directory as the YAML file. If the
value is an undecorated string, that&rsquo;s the value.</p>

<p style="margin-top: 1em">When reading from a file care
should be taken to ensure that a reasonable content-type is
set for the data as this will control if any encoding is
done of the resulting string <br>
value. If it is text, json, xml or javascript it will be
encoded to UTF-8.</p>

<p style="margin-top: 1em">To run gabbi tests with a test
harness they must be generated in some fashion and then run.
This is accomplished by a test loader. Initially gabbi only
supported those test har&acirc; <br>
nesses that supported the load_tests protocol in UnitTest.
It now possible to also build and run tests with pytest with
some limitations described below.</p>

<p style="margin-top: 1em">NOTE: <br>
It is also possible to run gabbi tests from the command
line. See runner.</p>

<p style="margin-top: 1em">WARNING: <br>
If test are being run with a runner that supports
concurrency (such as testrepository) it is critical that the
test runner is informed of how to group the tests into their
<br>
respective suites. The usual way to do this is to use a
regular expression that groups based on the name of the yaml
files. For example, when using testrepository the <br>
.testr.conf file needs an entry similar to the
following:</p>


<p style="margin-top: 1em">group_regex=gabbi.suitemaker.(test_[^_]+_[^_]+)</p>

<p style="margin-top: 1em">UNITTEST STYLE LOADER <br>
To run the tests with a load_tests style loader a test file
containing a load_tests method is required. That will look a
bit like:</p>

<p style="margin-top: 1em">&quot;&quot;&quot;A sample test
module.&quot;&quot;&quot;</p>

<p style="margin-top: 1em"># For pathname munging <br>
import os</p>

<p style="margin-top: 1em"># The module that build_tests
comes from. <br>
from gabbi import driver</p>

<p style="margin-top: 1em"># We need access to the WSGI
application that hosts our service <br>
from myapp import wsgiapp</p>

<p style="margin-top: 1em"># We&rsquo;re using fixtures in
the YAML files, we need to know where to <br>
# load them from. <br>
from myapp.test import fixtures</p>

<p style="margin-top: 1em"># By convention the YAML files
are put in a directory named <br>
# &quot;gabbits&quot; that is in the same directory as the
Python test file. <br>
TESTS_DIR = &rsquo;gabbits&rsquo;</p>

<p style="margin-top: 1em">def load_tests(loader, tests,
pattern): <br>
&quot;&quot;&quot;Provide a TestSuite to the discovery
process.&quot;&quot;&quot; <br>
test_dir = os.path.join(os.path.dirname(__file__),
TESTS_DIR) <br>
# Pass &quot;require_ssl=True&quot; as an argument to force
all tests <br>
# to use SSL in requests. <br>
return driver.build_tests(test_dir, loader, <br>
intercept=wsgiapp.app, <br>
fixture_module=fixtures)</p>

<p style="margin-top: 1em">For details on the arguments
available when building tests see build_tests().</p>

<p style="margin-top: 1em">Once the test loader has been
created, it needs to be run. There are many options. Which
is appropriate depends very much on your environment. Here
are some examples using <br>
unittest or testtools that require minimal knowledge to get
started.</p>

<p style="margin-top: 1em">By file:</p>

<p style="margin-top: 1em">python -m testtools.run -v
test/test_loader.py</p>

<p style="margin-top: 1em">By module:</p>

<p style="margin-top: 1em">python -m testttols.run -v
test.test_loader</p>

<p style="margin-top: 1em">python -m unittest -v
test.test_loader</p>

<p style="margin-top: 1em">Using test discovery to locate
all tests in a directory tree:</p>

<p style="margin-top: 1em">python -m testtools.run
discover</p>

<p style="margin-top: 1em">python -m unittest discover
test</p>

<p style="margin-top: 1em">See the source distribution and
the tutorial repo for more advanced options, including using
testrepository and subunit.</p>

<p style="margin-top: 1em">PYTEST <br>
Since pytest does not support the load_tests system, a
different way of generating tests is required. A test file
must be created that calls py_test_generator() and yields
the <br>
generated tests. That will look a bit like this:</p>

<p style="margin-top: 1em">&quot;&quot;&quot;A sample
pytest module.&quot;&quot;&quot;</p>

<p style="margin-top: 1em"># For pathname munging <br>
import os</p>

<p style="margin-top: 1em"># The module that build_tests
comes from. <br>
from gabbi import driver</p>

<p style="margin-top: 1em"># We need access to the WSGI
application that hosts our service <br>
from myapp import wsgiapp</p>

<p style="margin-top: 1em"># We&rsquo;re using fixtures in
the YAML files, we need to know where to <br>
# load them from. <br>
from myapp.test import fixtures</p>

<p style="margin-top: 1em"># By convention the YAML files
are put in a directory named <br>
# &quot;gabbits&quot; that is in the same directory as the
Python test file. <br>
TESTS_DIR = &rsquo;gabbits&rsquo;</p>

<p style="margin-top: 1em">def test_gabbits(): <br>
test_dir = os.path.join(os.path.dirname(__file__),
TESTS_DIR) <br>
# Pass &quot;require_ssl=True&quot; as an argument to force
all tests <br>
# to use SSL in requests. <br>
test_generator = driver.py_test_generator( <br>
test_dir, intercept=wsgiapp.app, <br>
fixture_module=fixtures)</p>

<p style="margin-top: 1em">for test in test_generator: <br>
yield test</p>

<p style="margin-top: 1em">This can then be run with the
usual pytest commands. For example:</p>

<p style="margin-top: 1em">py.test -svx
pytest-example.py</p>

<p style="margin-top: 1em">WARNING: <br>
In pytest&gt;=3.0 yield tests are deprecated and using them
will cause pytest to produce a warning. If you wish to
ignore and hide these warnings add the
--disable-pytest-warn&acirc; <br>
ings parameter to the invocation of py.test or use a version
of pytest earlier than version 3.0. A new way of creating
gabbi tests that works more effectively with modern <br>
pytest is being developed.</p>

<p style="margin-top: 1em">What follows is a commented
example of some tests in a single file demonstrating many of
the format features. See loader for the Python needed to
integrate with a testing har&acirc; <br>
ness.</p>

<p style="margin-top: 1em"># Fixtures can be used to set
any necessary configuration, such as a <br>
# persistence layer, and establish sample data. They operate
per <br>
# file. They are context managers, each one wrapping the
next in the <br>
# sequence.</p>

<p style="margin-top: 1em">fixtures: <br>
- ConfigFixture <br>
- SampleDataFixture</p>

<p style="margin-top: 1em"># There is an included fixture
named &quot;SkipAllFixture&quot; which can be <br>
# used to declare that all the tests in the given file are
to be <br>
# skipped.</p>

<p style="margin-top: 1em"># Each test file can specify a
set of defaults that will be used for <br>
# every request. This is useful for always specifying a
particular <br>
# header or always requiring SSL. These values will be used
on every <br>
# test in the file unless overriden. Lists and dicts are
merged one <br>
# level deep, except for &quot;data&quot; which is copied
verbatim whether it <br>
# is a string, list or dict (it can be all three).</p>

<p style="margin-top: 1em">defaults: <br>
ssl: True <br>
request_headers: <br>
x-my-token: zoom</p>

<p style="margin-top: 1em"># The tests themselves are a
list under a &quot;tests&quot; key. It&rsquo;s useful <br>
# to use plenty of whitespace to help readability.</p>

<p style="margin-top: 1em">tests:</p>

<p style="margin-top: 1em"># Each request *must* have a
name which is unique to the file. When it <br>
# becomes a TestCase the name will be lowercased and spaces
will <br>
# become &quot;_&quot;. Use that generated name when
limiting test runs.</p>

<p style="margin-top: 1em">- name: a test for root <br>
desc: Some explanatory text that could be used by other
tooling</p>

<p style="margin-top: 1em"># The URL can either be relative
to a host specified elsewhere or <br>
# be a fully qualified &quot;http&quot; or &quot;https&quot;
URL. *You* are responsible <br>
# for url-encoding the URL.</p>

<p style="margin-top: 1em">url: /</p>

<p style="margin-top: 1em"># If no status or method are
provided they default to &quot;200&quot; and <br>
# &quot;GET&quot;.</p>

<p style="margin-top: 1em"># A single test can override
settings in defaults (set above).</p>

<p style="margin-top: 1em">- name: root without ssl
redirects <br>
ssl: False <br>
url: / <br>
status: 302</p>

<p style="margin-top: 1em"># When evaluating response
headers it is possible to use a regular <br>
# expression to not have to test the whole value.</p>

<p style="margin-top: 1em">response_headers: <br>
location: /https/</p>

<p style="margin-top: 1em"># By default redirects will not
be followed. This can be changed.</p>

<p style="margin-top: 1em">- name: follow root without ssl
redirect <br>
ssl: False <br>
redirects: True <br>
url: / <br>
status: 200 # This is the response code after the
redirect.</p>

<p style="margin-top: 1em"># URLs can express query
parameters in two ways: either in the url <br>
# value directly, or as query_parameters. If both are used
then <br>
# query_parameters are appended. In this example the
resulting URL <br>
# will be equivalient to <br>
#
/foo?section=news&amp;article=1&amp;article=2&amp;date=yesterday
<br>
# but not necessarily in that order.</p>

<p style="margin-top: 1em">- name: create a url with
parameters <br>
url: /foo?section=news <br>
query_parameters: <br>
article: <br>
- 1 <br>
- 2 <br>
date: yesterday</p>

<p style="margin-top: 1em"># Request headers can be used to
declare media-type choices and <br>
# experiment with authorization handling (amongst other
things). <br>
# Response headers allow evaluating headers in the response.
These <br>
# two together form the core value of gabbi.</p>

<p style="margin-top: 1em">- name: test accept <br>
url: /resource <br>
request_headers: <br>
accept: application/json <br>
response_headers: <br>
content-type: /application/json/</p>

<p style="margin-top: 1em"># If a header must not be
present in a response at all that can be <br>
# expressed in a test as follows.</p>

<p style="margin-top: 1em">- name: test forbidden headers
<br>
url: /resource <br>
response_forbidden_headers: <br>
- x-special-header</p>

<p style="margin-top: 1em"># All of the above requests have
defaulted to a &quot;GET&quot; method. When <br>
# using &quot;POST&quot;, &quot;PUT&quot; or
&quot;PATCH&quot;, the &quot;data&quot; key provides the
<br>
# request body.</p>

<p style="margin-top: 1em">- name: post some text <br>
url: /text_repo <br>
method: POST <br>
request_headers: <br>
content-type: text/plain <br>
data: &quot;I&rsquo;m storing this&quot; <br>
status: 201</p>

<p style="margin-top: 1em"># If the data is not a string,
it will be transformed into JSON. <br>
# You must supply an appropriate content-type request
header.</p>

<p style="margin-top: 1em">- name: post some json <br>
url: /json_repo <br>
method: POST <br>
request_headers: <br>
content-type: application/json <br>
data: <br>
name: smith <br>
abode: castle <br>
status: 201</p>

<p style="margin-top: 1em"># If the data is a string
prepended with &quot;&lt;@&quot; the value will be <br>
# treated as the name of a file in the same directory as the
YAML <br>
# file. Again, you must supply an appropriate content-type.
If the <br>
# content-type is one of several &quot;text-like&quot;
types, the content will <br>
# be assumed to be UTF-8 encoded.</p>

<p style="margin-top: 1em">- name: post an image <br>
url: /image_repo <br>
method: POST <br>
request_headers: <br>
content-type: image/png <br>
data: &lt;@kittens.png</p>

<p style="margin-top: 1em"># A single request can be marked
to be skipped.</p>

<p style="margin-top: 1em">- name: patch an image <br>
skip: patching images not yet implemented <br>
url: /image_repo/12d96fb8-e78c-11e4-8c03-685b35afa334 <br>
method: PATCH</p>

<p style="margin-top: 1em"># Or a single request can be
marked that it is expected to fail.</p>

<p style="margin-top: 1em">- name: check allow headers <br>
desc: the framework doesn&rsquo;t do allow yet <br>
xfail: True <br>
url: /post_only_url <br>
method: PUT <br>
status: 405 <br>
response_headers: <br>
allow: POST</p>

<p style="margin-top: 1em"># The body of a response can be
evaluated with response handlers. <br>
# The most simple checks for a set of strings anywhere in
the <br>
# response. Note that the strings are members of a list.</p>

<p style="margin-top: 1em">- name: check for css file <br>
url: /blog/posts/12 <br>
response_strings: <br>
- normalize.css</p>

<p style="margin-top: 1em"># For JSON responses, JSONPath
rules can be used.</p>

<p style="margin-top: 1em">- name: post some json get back
json <br>
url: /json_repo <br>
method: POST <br>
request_headers: <br>
content-type: application/json <br>
data: <br>
name: smith <br>
abode: castle <br>
status: 201 <br>
response_json_paths: <br>
$.name: smith <br>
$.abode: castle</p>

<p style="margin-top: 1em"># Requests run in sequence. One
test can make reference to the test <br>
# immediately prior using some special variables. <br>
# &quot;$LOCATION&quot; contains the &quot;location&quot;
header in the previous <br>
# response. <br>
# &quot;$HEADERS&quot; is a pseudo dictionary containing all
the headers of <br>
# the previous response. <br>
# &quot;$ENVIRON&quot; is a pseudo dictionary providing
access to the current <br>
# environment. <br>
# &quot;$RESPONSE&quot; provides access to the JSON in the
prior response, via <br>
# JSONPath. See http://jsonpath-rw.readthedocs.io/ for <br>
# jsonpath-rw formatting. <br>
# $SCHEME and $NETLOC provide access to the current protocol
and <br>
# location (host and port).</p>

<p style="margin-top: 1em">- name: get the thing we just
posted <br>
url: $LOCATION <br>
request_headers: <br>
x-magic-exchange: $HEADERS[&rsquo;x-magic-exchange&rsquo;]
<br>
x-token: $ENVIRON[&rsquo;OS_TOKEN&rsquo;] <br>
response_json_paths: <br>
$.name: $RESPONSE[&rsquo;$.name&rsquo;] <br>
$.abode: $RESPONSE[&rsquo;$.abode&rsquo;] <br>
response_headers: <br>
content-location: /$SCHEME://$NETLOC/</p>

<p style="margin-top: 1em"># For APIs where resource
creation is asynchronous it can be <br>
# necessary to poll for the resulting resource. First we
create the <br>
# resource in one test. The next test uses the
&quot;poll&quot; key to loop <br>
# with a delay for a set number of times.</p>

<p style="margin-top: 1em">- name: create asynch <br>
url: /async_creator <br>
method: POST <br>
request_headers: <br>
content-type: application/json <br>
data: <br>
name: jones <br>
abode: bungalow <br>
status: 202</p>

<p style="margin-top: 1em">- name: poll for created
resource <br>
url: $LOCATION <br>
poll: <br>
count: 10 # try up to ten times <br>
delay: .5 # wait .5 seconds between each try <br>
response_json_paths: <br>
$.name: $RESPONSE[&rsquo;$.name&rsquo;] <br>
$.abode: $RESPONSE[&rsquo;$.abode&rsquo;]</p>

<p style="margin-top: 1em">Gabbi supports JSONPath both for
validating JSON response bodies and within
substitutions.</p>

<p style="margin-top: 1em">JSONPath expressions are
provided by jsonpath_rw, with jsonpath_rw_ext custom
extensions to address common requirements:</p>

<p style="margin-top: 1em">1. Sorting via sorted and
[/property].</p>

<p style="margin-top: 1em">2. Filtering via [?property =
value].</p>

<p style="margin-top: 1em">3. Returning the respective
length via len.</p>

<p style="margin-top: 1em">(These apply both to arrays and
key-value pairs.)</p>

<p style="margin-top: 1em">Here is a JSONPath example
demonstrating some of these features. Given JSON data as
follows:</p>

<p style="margin-top: 1em">{ <br>
&quot;pets&quot;: [ <br>
{&quot;type&quot;: &quot;cat&quot;, &quot;sound&quot;:
&quot;meow&quot;}, <br>
{&quot;type&quot;: &quot;dog&quot;, &quot;sound&quot;:
&quot;woof&quot;} <br>
] <br>
}</p>

<p style="margin-top: 1em">If the ordering of the list in
pets is predictable and reliable it is relatively
straightforward to test values:</p>

<p style="margin-top: 1em">response_json_paths: <br>
# length of list is two <br>
$.pets.&lsquo;len&lsquo;: 2 <br>
# sound of second item in list is woof <br>
$.pets[1].sound: woof</p>

<p style="margin-top: 1em">If the ordering is not
predictable additional effort is required:</p>

<p style="margin-top: 1em">response_json_paths: <br>
# sort by type <br>
$.pets[/type][0].sound: meow <br>
# sort by type, reversed <br>
$.pets[ype][0].sound: woof <br>
# all the sounds <br>
$.pets[/type]..sound: [&rsquo;meow&rsquo;,
&rsquo;woof&rsquo;] <br>
# filter by type = dog <br>
$.pets[?type = &quot;dog&quot;].sound: woof</p>

<p style="margin-top: 1em">If it is necessary to validate
the entire JSON response use a JSONPath of $:</p>

<p style="margin-top: 1em">response_json_paths: <br>
$: <br>
pets: <br>
- type: cat <br>
sound: meow <br>
- type: dog <br>
sound: woof</p>

<p style="margin-top: 1em">This is not a technique that
should be used frequently as it can lead to difficult to
read tests and it also indicates that your gabbi tests are
being used to test your serializ&acirc; <br>
ers and data models, not just your API interactions.</p>

<p style="margin-top: 1em">There are more JSONPath examples
in example and in the jsonpath_rw and jsonpath_rw_ext
documentation.</p>

<p style="margin-top: 1em">The target host is the host on
which the API to be tested can be found. Gabbi intends to
preserve the flow and semantics of HTTP interactions as much
as possible, and every HTTP <br>
request needs to be directed at a host of some form. Gabbi
provides three ways to control this:</p>

<p style="margin-top: 1em">&Acirc;&middot; Using
wsgi-intercept to provide a fake socket and WSGI environment
on an arbitrary host and port attached to a WSGI application
(see intercept examples).</p>

<p style="margin-top: 1em">&Acirc;&middot; Using fully
qualified url values in the YAML defined tests (see full
examples).</p>

<p style="margin-top: 1em">&Acirc;&middot; Using a host and
(optionally) port defined at test build time (see live
examples).</p>

<p style="margin-top: 1em">The intercept and live methods
are mutually exclusive per test builder, but either kind of
test can freely intermix fully qualified URLs into the
sequence of tests in a YAML <br>
file.</p>

<p style="margin-top: 1em">For test driven development and
local tests the intercept style of testing lowers test
requirements (no web server required) and is fast.
Interception is performed as part of <br>
fixtures processing as the most deeply nested fixture. This
allows any configuration or database setup to be performed
prior to the WSGI application being created.</p>

<p style="margin-top: 1em">For the implementation of the
above see build_tests().</p>

<p style="margin-top: 1em">Each suite of tests is
represented by a single YAML file, and may optionally use
one or more fixtures to provide the necessary environment
required by the tests in that file.</p>

<p style="margin-top: 1em">Fixtures are implemented as
nested context managers. Subclasses of GabbiFixture must
implement start_fixture and stop_fixture methods for
creating and destroying, respectively, <br>
any resources managed by the fixture. While the subclass may
choose to implement __init__ it is important that no
exceptions are thrown in that method, otherwise the stack of
<br>
context managers will fail in unexpected ways. Instead
initialization of real resources should happen in
start_fixture.</p>

<p style="margin-top: 1em">At this time there is no
mechanism for the individual tests to have any direct
awareness of the fixtures. The fixtures exist, conceptually,
on the server side of the API being <br>
tested.</p>

<p style="margin-top: 1em">Fixtures may do whatever is
required by the testing environment, however there are two
common scenarios:</p>

<p style="margin-top: 1em">&Acirc;&middot; Establishing
(and then resetting when a test suite has finished) any
baseline configuration settings and persistence systems
required for the tests.</p>

<p style="margin-top: 1em">&Acirc;&middot; Creating sample
data for use by the tests.</p>

<p style="margin-top: 1em">If a fixture raises
unittest.case.SkipTest during start_fixture all the tests in
the current file will be skipped. This makes it possible to
skip the tests if some optional con&acirc; <br>
figuration (such as a particular type of database) is not
available.</p>

<p style="margin-top: 1em">If an exception is raised while
a fixture is being used, information about the exception
will be stored on the fixture so that the stop_fixture
method can decide if the exception <br>
should change how the fixture should clean up. The exception
information can be found on exc_type, exc_value and
traceback method attributes.</p>

<p style="margin-top: 1em">In some contexts (for example CI
environments with a large number of tests being run in a
broadly concurrent environment where output is logged to a
single file) it can be impor&acirc; <br>
tant to capture and consolidate stray output that is
produced during the tests and display it associated with an
individual test. This can help debugging and avoids unusable
out&acirc; <br>
put that is the result of multiple streams being
interleaved.</p>

<p style="margin-top: 1em">Inner fixtures have been added
to support this. These are fixtures more in line with the
tradtional unittest concept of fixtures: a class on which
setUp and cleanUp is automati&acirc; <br>
cally called.</p>

<p style="margin-top: 1em">build_tests() accepts a named
parameter arguments of inner_fixtures. The value of that
argument may be an ordered list of fixtures.Fixture classes
that will be called when each <br>
individual test is set up.</p>

<p style="margin-top: 1em">An example fixture that could be
useful is the FakeLogger.</p>

<p style="margin-top: 1em">NOTE: <br>
At this time inner_fixtures are not supported when using the
pytest loader.</p>

<p style="margin-top: 1em">Content handlers are responsible
for preparing request data and evaluating response data
based on the content-type of the request and response. A
content handler operates as fol&acirc; <br>
lows:</p>

<p style="margin-top: 1em">&Acirc;&middot; Structured YAML
data provided via the data attribute is converted to a
string or bytes sequence and used as request body.</p>

<p style="margin-top: 1em">&Acirc;&middot; The response
body (a string or sequence of bytes) is transformed into a
content-type dependent structure and stored in an internal
attribute named response_data that is:</p>

<p style="margin-top: 1em">&Acirc;&middot; used when
evaluating the response body</p>

<p style="margin-top: 1em">&Acirc;&middot; used in
$RESPONSE[] substitutions</p>

<p style="margin-top: 1em">By default, gabbi provides
content handlers for JSON. In that content handler the data
test key is converted from structured YAML into a JSON
string. Response bodies are con&acirc; <br>
verted from a JSON string into a data structure in
response_data that is used when evaluating
response_json_paths entries in a test or doing
JSONPath-based $RESPONSE[] substitu&acirc; <br>
tions.</p>

<p style="margin-top: 1em">Further content handlers can be
added as extensions. Test authors may need these extensions
for their own suites, or enterprising developers may wish to
create and distribute <br>
extensions for others to use.</p>

<p style="margin-top: 1em">NOTE: <br>
One extension that is likely to be useful is a content
handler that turns data into url-encoded form data suitable
for POST and turns an HTML response into a DOM object.</p>

<p style="margin-top: 1em">EXTENSIONS <br>
Content handlers are an evolution of the response handler
concept in earlier versions gabbi. To preserve backwards
compatibility with existing response handlers, old style
<br>
response handlers are still allowed, but new handlers should
implement the content handler interface (described
below).</p>

<p style="margin-top: 1em">Registering additional custom
handlers is done by passing a subclass of ContentHandler to
build_tests():</p>

<p style="margin-top: 1em">driver.build_tests(test_dir,
loader, host=None, <br>
intercept=simple_wsgi.SimpleWsgi, <br>
content_handlers=[MyContentHandler])</p>

<p style="margin-top: 1em">If pytest is being used:</p>


<p style="margin-top: 1em">driver.py_test_generator(test_dir,
intercept=simple_wsgi.SimpleWsgi, <br>
content_handlers=[MyContenHandler])</p>

<p style="margin-top: 1em">WARNING: <br>
When there are multiple handlers listed that accept the same
content-type, the one that is earliest in the list will be
used.</p>

<p style="margin-top: 1em">With gabbi-run, custom handlers
can be loaded via the --response-handler option -- see
load_response_handlers() for details.</p>

<p style="margin-top: 1em">NOTE: <br>
The use of the --response-handler argument is done to
preserve backwards compatibility and avoid excessive
arguments. Both types of handler may be passed to the
argument.</p>

<p style="margin-top: 1em">Implementation Details <br>
Creating a content handler requires subclassing
ContentHandler and implementing several methods. These
methods are described below, but inspecting JSONHandler will
be instruc&acirc; <br>
tive in highlighting required arguments and techniques.</p>

<p style="margin-top: 1em">To provide a
response_&lt;something&gt; response-body evaluator a
subclass must define:</p>

<p style="margin-top: 1em">&Acirc;&middot; test_key_suffix:
This, along with the prefix response_, forms the key used in
the test structure. It is a class level string.</p>

<p style="margin-top: 1em">&Acirc;&middot; test_key_value:
The key&rsquo;s default value, either an empty list ([]) or
empty dict ({}). It is a class level value.</p>

<p style="margin-top: 1em">&Acirc;&middot; action: An
instance method which tests the expected values against the
HTTP response - it is invoked for each entry, with the
parameters depending on the default value. The <br>
arguments to action are (in order):</p>

<p style="margin-top: 1em">&Acirc;&middot; self: The
current instance.</p>

<p style="margin-top: 1em">&Acirc;&middot; test: The
currently active HTTPTestCase</p>

<p style="margin-top: 1em">&Acirc;&middot; item: The
current entry if test_key_value is a list, otherwise the key
half of the key/value pair at this entry.</p>

<p style="margin-top: 1em">&Acirc;&middot; value: None if
test_key_value is a list, otherwise the value half of the
key/value pair at this entry.</p>

<p style="margin-top: 1em">To translate request or response
bodies to or from structured data a subclass must define an
accepts method. This should return True if this class is
willing to translate the <br>
provided content-type. During request processing it is given
the value of the content-type header that will be sent in
the request. During response processing it is given the <br>
value of the content-type header of the response. This makes
it possible to handle different request and response bodies
in the same handler, if desired. For example a handler <br>
might accept application/x-www-form-urlencoded and
text/html.</p>

<p style="margin-top: 1em">If accepts is defined two
additional static methods should be defined:</p>

<p style="margin-top: 1em">&Acirc;&middot; dumps: Turn
structured Python data from the data key in a test into a
string or byte stream.</p>

<p style="margin-top: 1em">&Acirc;&middot; loads: Turn a
string or byte stream in a response into a Python data
structure. Gabbi will put this data on the response_data
attribute on the test, where it can be used in the <br>
evaluations described above (in the action method) or in
$RESPONSE handling. An example usage here would be to turn
HTML into a DOM.</p>

<p style="margin-top: 1em">Finally if a replacer class
method is defined, then when a $RESPONSE substitution is
encountered, replacer will be passed the response_data of
the prior test and the argument <br>
within the $RESPONSE.</p>

<p style="margin-top: 1em">Please see the JSONHandler
source for additional detail.</p>

<p style="margin-top: 1em">If there is a running web
service that needs to be tested and creating a test loader
with build_tests() is either inconvenient or overkill it is
possible to run YAML test files <br>
directly from the command line with the console-script
gabbi-run. It accepts YAML on stdin or as multiple file
arguments, and generates and runs tests and outputs a
summary of <br>
the results.</p>

<p style="margin-top: 1em">The provided YAML may not use
custom fixtures but otherwise uses the default format. host
information is either expressed directly in the YAML file or
provided on the command <br>
line:</p>

<p style="margin-top: 1em">gabbi-run [host[:port]] &lt;
/my/test.yaml</p>

<p style="margin-top: 1em">or:</p>

<p style="margin-top: 1em">gabbi-run http://host:port &lt;
/my/test.yaml</p>

<p style="margin-top: 1em">To test with one or more files
the following command syntax may be used:</p>

<p style="margin-top: 1em">gabbi-run http://host:port --
/my/test.yaml /my/other.yaml</p>

<p style="margin-top: 1em">NOTE: <br>
The filename arguments must come after a -- and all other
arguments (host, port, prefix, failfast) must come before
the --.</p>

<p style="margin-top: 1em">To facilitate using the same
tests against the same application mounted in different
locations in a WSGI server, a prefix may be provided as a
second argument:</p>

<p style="margin-top: 1em">gabbi-run host[:port] [prefix]
&lt; /my/test.yaml</p>

<p style="margin-top: 1em">or in the target URL:</p>

<p style="margin-top: 1em">gabbi-run
http://host:port/prefix &lt; /my/test.yaml</p>

<p style="margin-top: 1em">The value of prefix will be
prepended to the path portion of URLs that are not fully
qualified.</p>

<p style="margin-top: 1em">Anywhere host is used, if it is
a raw IPV6 address it should be wrapped in [ and ].</p>

<p style="margin-top: 1em">If https is used in the target,
then the tests in the provided YAML will default to ssl:
True.</p>

<p style="margin-top: 1em">If a -x or --failfast argument
is provided then gabbi-run will exit after the first test
failure.</p>

<p style="margin-top: 1em">These are informal release notes
for gabbi since version 1.0.0, highlighting major features
and changes. For more detail see the commit logs on
GitHub.</p>

<p style="margin-top: 1em">1.27.0 <br>
Allow gabbi-run to accept multiple filenames as command line
arguments instead of reading tests from stdin.</p>

<p style="margin-top: 1em">1.26.0 <br>
Switch from response handlers to handlers to allow more
flexible processing of both response _and_ request
bodies.</p>

<p style="margin-top: 1em">Add inner fixtures for per test
fixtures, useful for output capturing.</p>

<p style="margin-top: 1em">1.25.0 <br>
Allow the test_loader_name arg to gabbi.driver.build_tests()
to override the prefix of the pretty printed name of
generated tests.</p>

<p style="margin-top: 1em">1.24.0 <br>
String values in JSONPath matches may be wrapped in
/.../&lsquo; to be treated as regular expressions.</p>

<p style="margin-top: 1em">1.23.0 <br>
Better documentation of how to run gabbi in a concurrent
environment. Improved handling of pytest fixtures and test
counts.</p>

<p style="margin-top: 1em">1.22.0 <br>
Add url to gabbi.driver.build_tests() to use instead of
host, port and prefix.</p>

<p style="margin-top: 1em">1.21.0 <br>
Add require_ssl to gabbi.driver.build_tests() to force use
of SSL.</p>

<p style="margin-top: 1em">1.20.0 <br>
Add $COOKIE substitution.</p>

<p style="margin-top: 1em">1.19.1 <br>
Correctly support IPV6 hosts.</p>

<p style="margin-top: 1em">1.19.0 <br>
Add $LAST_URL substitution.</p>

<p style="margin-top: 1em">1.17.0 <br>
Introduce support for loading and running tests with
pytest.</p>

<p style="margin-top: 1em">1.16.0 <br>
Use urllib3 instead of httplib2 for driving HTTP
requests.</p>

<p style="margin-top: 1em">1.13.0 <br>
Add sorting and filtering to jsonpath handling.</p>

<p style="margin-top: 1em">1.11.0 <br>
Add the response_forbidden_headers to response
expectations.</p>

<p style="margin-top: 1em">1.7.0 <br>
Instead of:</p>

<p style="margin-top: 1em">tests: <br>
- name: a simple get <br>
url: /some/path <br>
method: get</p>

<p style="margin-top: 1em">1.7.0 also makes it possible
to:</p>

<p style="margin-top: 1em">tests: <br>
- name: a simple get <br>
GET: /some/path</p>

<p style="margin-top: 1em">Any upper case key is treated as
a method.</p>

<p style="margin-top: 1em">1.4.0 AND 1.5.0 <br>
Enhanced flexibility and colorization when setting tests to
be verbose.</p>

<p style="margin-top: 1em">1.3.0 <br>
Adds the query_parameters key to request parameters.</p>

<p style="margin-top: 1em">1.2.0 <br>
The start of improvements and extensions to jsonpath
handling. In this case the addition of the len function.</p>

<p style="margin-top: 1em">1.1.0 <br>
Vastly improved output and behavior in gabbi-run.</p>

<p style="margin-top: 1em">1.0.0 <br>
Version 1 was the first release with a commitment to a
stable format. Since then new fields have been added but
have not been taken away.</p>

<p style="margin-top: 1em">The following people have
contributed code to gabbi. Thanks to them. Thanks also to
all the people who have made gabbi better by reporting
issues and their successes and fail&acirc; <br>
ures with using gabbi.</p>

<p style="margin-top: 1em">&Acirc;&middot; Chris Dent</p>

<p style="margin-top: 1em">&Acirc;&middot; FND</p>

<p style="margin-top: 1em">&Acirc;&middot; Mehdi
Abaakouk</p>

<p style="margin-top: 1em">&Acirc;&middot; Jason Myers</p>

<p style="margin-top: 1em">&Acirc;&middot; Kim Raymoure</p>

<p style="margin-top: 1em">&Acirc;&middot; Michael
McCune</p>

<p style="margin-top: 1em">&Acirc;&middot; Imran Hayder</p>

<p style="margin-top: 1em">&Acirc;&middot; Julien
Danjou</p>

<p style="margin-top: 1em">&Acirc;&middot; Danek Duvall</p>

<p style="margin-top: 1em">&Acirc;&middot; Marc
Abramowitz</p>

<p style="margin-top: 1em">NOTE: <br>
This section provides a collection of questions with answers
that don&rsquo;t otherwise fit in the rest of the
documentation. If something is missing, please create an
issue.</p>

<p style="margin-top: 1em">As this document grows it will
gain a more refined structure.</p>

<p style="margin-top: 1em">GENERAL <br>
Is gabbi only for testing Python-based APIs? <br>
No, you can use gabbi-run to test an HTTP service built in
any programming language.</p>

<p style="margin-top: 1em">WORKAROUNDS <br>
pytest produces warnings about yield tests. Can I make them
stop? <br>
Yes, run as py.test --disable-pytest-warnings to quiet the
warnings. Or use a version of pytest less than 3.0. For more
details see pytest.</p>

<p style="margin-top: 1em">TESTING STYLE <br>
Can I have variables in my YAML file? <br>
Gabbi provides the $ENVIRON substitution which can operate a
bit like variables that are set elsewhere and then used in
the tests defined by the YAML.</p>

<p style="margin-top: 1em">If you find it necessary to have
variables within a single YAML file you take advantage of
YAML alias nodes list this:</p>

<p style="margin-top: 1em">vars: <br>
- &amp;uuid_1 5613AABF-BAED-4BBA-887A-252B2D3543F8</p>

<p style="margin-top: 1em">tests: <br>
- name: send a uuid to a post <br>
POST: /resource <br>
request_headers: <br>
content-type: application/json <br>
data: <br>
uuid: *uuid_1</p>

<p style="margin-top: 1em">You can alias all sorts of
nodes, not just single items. Be aware that the replacement
of an alias node happens while the YAML is being loaded,
before gabbi does any processing.</p>

<p style="margin-top: 1em">How many tests should be put in
one YAML file? <br>
For the sake of readability it is best to keep each YAML
file relatively short. Since each YAML file represents a
sequence of requests, it usually makes sense to create a new
<br>
file when a test is not dependent on any before it.</p>

<p style="margin-top: 1em">It&rsquo;s tempting to put all
the tests for any resource or URL in the same file, but this
eventually leads to files that are too long and are thus
difficult to read.</p>

<p style="margin-top: 1em">CASE MODULE <br>
A single HTTP request represented as a subclass of
testtools.TestCase</p>

<p style="margin-top: 1em">The test case encapsulates the
request headers and body and expected response headers and
body. When the test is run an HTTP request is made using
urllib3. Assertions are made <br>
against the reponse.</p>

<p style="margin-top: 1em">class
gabbi.case.HTTPTestCase(*args, **kwargs) <br>
Bases: testtools.testcase.TestCase</p>

<p style="margin-top: 1em">Encapsulate a single HTTP
request as a TestCase.</p>

<p style="margin-top: 1em">If the test is a member of a
sequence of requests, ensure that prior tests are run.</p>

<p style="margin-top: 1em">To keep the test harness happy
we need to make sure the setUp and tearDown are only run
once.</p>


<p style="margin-top: 1em">assert_in_or_print_output(expected,
iterable) <br>
Assert the iterable contains expected or print some
output.</p>

<p style="margin-top: 1em">If the output is long, it is
limited by either GABBI_MAX_CHARS_OUTPUT in the environment
or the MAX_CHARS_OUTPUT constant.</p>

<p style="margin-top: 1em">base_test =
{&rsquo;status&rsquo;: &rsquo;200&rsquo;,
&rsquo;xfail&rsquo;: False, &rsquo;redirects&rsquo;: False,
&rsquo;verbose&rsquo;: False,
&rsquo;query_parameters&rsquo;: {}, &rsquo;url&rsquo;:
&rsquo;&rsquo;, &rsquo;skip&rsquo;: &rsquo;&rsquo;,
&rsquo;name&rsquo;: &rsquo;&rsquo;, &rsquo;ssl&rsquo;:
False, &rsquo;request_head&acirc; <br>
ers&rsquo;: {}, &rsquo;poll&rsquo;: {}, &rsquo;data&rsquo;:
&rsquo;&rsquo;, &rsquo;method&rsquo;: &rsquo;GET&rsquo;,
&rsquo;desc&rsquo;: &rsquo;&rsquo;}</p>


<p style="margin-top: 1em">get_content_handler(content_type)
<br>
Determine the content handler for this media type.</p>

<p style="margin-top: 1em">replace_template(message) <br>
Replace magic strings in message.</p>

<p style="margin-top: 1em">run(result=None) <br>
Store the current result handler on this test.</p>

<p style="margin-top: 1em">setUp()</p>

<p style="margin-top: 1em">tearDown()</p>

<p style="margin-top: 1em">test_request() <br>
Run this request if it has not yet run.</p>

<p style="margin-top: 1em">If there is a prior test in the
sequence, run it first.</p>


<p style="margin-top: 1em">gabbi.case.potentialFailure(func)
<br>
Decorate a test method that is expected to fail if
&rsquo;xfail&rsquo; is true.</p>

<p style="margin-top: 1em">DRIVER MODULE <br>
Generate HTTP tests from YAML files</p>

<p style="margin-top: 1em">Each HTTP request is its own
TestCase and can be requested to be run in isolation from
other tests. If it is a member of a sequence of requests,
prior requests will be run.</p>

<p style="margin-top: 1em">A sequence is represented by an
ordered list in a single YAML file.</p>

<p style="margin-top: 1em">Each sequence becomes a
TestSuite.</p>

<p style="margin-top: 1em">An entire directory of YAML
files is a TestSuite of TestSuites.</p>

<p style="margin-top: 1em">gabbi.driver.build_tests(path,
loader, host=None, port=8001, intercept=None,
test_loader_name=None, fixture_module=None,
response_handlers=None, content_handlers=None,
prefix=&rsquo;&rsquo;, <br>
require_ssl=False, url=None, inner_fixtures=None) <br>
Read YAML files from a directory to create tests.</p>

<p style="margin-top: 1em">Each YAML file represents an
ordered sequence of HTTP requests.</p>

<p style="margin-top: 1em">Parameters</p>

<p style="margin-top: 1em">&Acirc;&middot; path -- The
directory where yaml files are located.</p>

<p style="margin-top: 1em">&Acirc;&middot; loader -- The
TestLoader.</p>

<p style="margin-top: 1em">&Acirc;&middot; host -- The host
to test against. Do not use with intercept.</p>

<p style="margin-top: 1em">&Acirc;&middot; port -- The port
to test against. Used with host.</p>

<p style="margin-top: 1em">&Acirc;&middot; intercept --
WSGI app factory for wsgi-intercept.</p>

<p style="margin-top: 1em">&Acirc;&middot; test_loader_name
-- Base name for test classes. Use this to align the naming
of the tests with other tests in a system.</p>

<p style="margin-top: 1em">&Acirc;&middot; fixture_module
-- Python module containing fixture classes.</p>

<p style="margin-top: 1em">&Acirc;&middot; response_handers
-- ResponseHandler classes.</p>

<p style="margin-top: 1em">&Acirc;&middot; content_handlers
(List of ContentHandler classes.) -- ContentHandler
classes.</p>

<p style="margin-top: 1em">&Acirc;&middot; prefix -- A URL
prefix for all URLs that are not fully qualified.</p>

<p style="margin-top: 1em">&Acirc;&middot; url -- A full
URL to test against. Replaces host, port and prefix.</p>

<p style="margin-top: 1em">&Acirc;&middot; require_ssl --
If True, make all tests default to using SSL.</p>

<p style="margin-top: 1em">&Acirc;&middot; inner_fixtures
(List of fixtures.Fixture classes.) -- A list of Fixtures to
use with each individual test request.</p>

<p style="margin-top: 1em">Return type <br>
TestSuite containing multiple TestSuites (one for each YAML
file)</p>


<p style="margin-top: 1em">gabbi.driver.py_test_generator(test_dir,
host=None, port=8001, intercept=None, prefix=None,
test_loader_name=None, fixture_module=None,
response_handlers=None, content_han&acirc; <br>
dlers=None, require_ssl=False, url=None) <br>
Generate tests cases for py.test</p>

<p style="margin-top: 1em">This uses build_tests to create
TestCases and then yields them in a way that pytest can
handle.</p>


<p style="margin-top: 1em">gabbi.driver.test_suite_from_yaml(loader,
test_base_name, test_yaml, test_directory, host, port,
fixture_module, intercept, prefix=&rsquo;&rsquo;) <br>
Legacy wrapper retained for backwards compatibility.</p>

<p style="margin-top: 1em">SUITEMAKER MODULE <br>
The code that creates a suite of tests.</p>

<p style="margin-top: 1em">The key piece of code is
test_suite_from_dict(). It produces a gabbi.suite.GabbiSuite
containing one or more gabbi.case.HTTPTestCase.</p>

<p style="margin-top: 1em">class
gabbi.suitemaker.TestBuilder <br>
Bases: type</p>

<p style="margin-top: 1em">Metaclass to munge a dynamically
created test.</p>

<p style="margin-top: 1em">required_attributes =
{&rsquo;has_run&rsquo;: False}</p>

<p style="margin-top: 1em">class
gabbi.suitemaker.TestMaker(test_base_name, test_defaults,
test_directory, fixture_classes, loader, host, port,
intercept, prefix, response_handlers, content_handlers, <br>
test_loader_name=None, inner_fixtures=None) <br>
Bases: object</p>

<p style="margin-top: 1em">A class for encapsulating test
invariants.</p>

<p style="margin-top: 1em">All of the tests in a single
gabbi file have invariants which are provided when creating
each HTTPTestCase. It is not useful to pass these around
when making each test <br>
case. So they are wrapped in this class which then has
make_one_test called multiple times to generate all the
tests in the suite.</p>

<p style="margin-top: 1em">make_one_test(test_dict,
prior_test) <br>
Create one single HTTPTestCase.</p>

<p style="margin-top: 1em">The returned HTTPTestCase is
added to the TestSuite currently being built (one per YAML
file).</p>


<p style="margin-top: 1em">gabbi.suitemaker.test_suite_from_dict(loader,
test_base_name, suite_dict, test_directory, host, port,
fixture_module, intercept, prefix=&rsquo;&rsquo;,
handlers=None, test_loader_name=None, <br>
inner_fixtures=None) <br>
Generate a GabbiSuite from a dict represent a list of
tests.</p>

<p style="margin-top: 1em">The dict takes the form:</p>

<p style="margin-top: 1em">Parameters</p>

<p style="margin-top: 1em">&Acirc;&middot; fixtures -- An
optional list of fixture classes that this suite can
use.</p>

<p style="margin-top: 1em">&Acirc;&middot; defaults -- An
optional dictionary of default values to be used in each
test.</p>

<p style="margin-top: 1em">&Acirc;&middot; tests -- A list
of individual tests, themselves each being a dictionary. See
gabbi.case.BASE_TEST.</p>


<p style="margin-top: 1em">gabbi.suitemaker.test_update(orig_dict,
new_dict) <br>
Modify test in place to update with new data.</p>

<p style="margin-top: 1em">FIXTURE MODULE <br>
Manage fixtures for gabbi at the test suite level.</p>

<p style="margin-top: 1em">class gabbi.fixture.GabbiFixture
<br>
Bases: object</p>

<p style="margin-top: 1em">A context manager that operates
as a fixture.</p>

<p style="margin-top: 1em">Subclasses must implement
start_fixture and stop_fixture, each of which contain the
logic for stopping and starting whatever the fixture is.
What a fixture is is left as <br>
an exercise for the implementor.</p>

<p style="margin-top: 1em">These context managers will be
nested so any actual work needs to happen in start_fixture
and stop_fixture and not in __init__. Otherwise exception
handling will not work <br>
properly.</p>

<p style="margin-top: 1em">start_fixture() <br>
Implement the actual workings of starting the fixture
here.</p>

<p style="margin-top: 1em">stop_fixture() <br>
Implement the actual workings of stopping the fixture
here.</p>

<p style="margin-top: 1em">exception
gabbi.fixture.GabbiFixtureError <br>
Bases: exceptions.Exception</p>

<p style="margin-top: 1em">Generic exception for
GabbiFixture.</p>

<p style="margin-top: 1em">class
gabbi.fixture.SkipAllFixture <br>
Bases: gabbi.fixture.GabbiFixture</p>

<p style="margin-top: 1em">A fixture that skips all the
tests in the current suite.</p>

<p style="margin-top: 1em">start_fixture()</p>

<p style="margin-top: 1em">gabbi.fixture.nest(*args,
**kwds) <br>
Nest a series of fixtures.</p>

<p style="margin-top: 1em">This is duplicated from nested
in the stdlib, which has been deprecated because of issues
with how exceptions are difficult to handle during __init__.
Gabbi needs to nest <br>
an unknown number of fixtures dynamically, so the with
syntax that replaces nested will not work.</p>

<p style="margin-top: 1em">HANDLERS MODULE <br>
Package for response and content handlers that process the
body of a response in various ways.</p>

<p style="margin-top: 1em">handlers.base Module <br>
Base classes for response and content handlers.</p>

<p style="margin-top: 1em">class
gabbi.handlers.base.ContentHandler <br>
Bases: gabbi.handlers.base.ResponseHandler</p>

<p style="margin-top: 1em">A subclass of ResponseHandlers
that adds content handling.</p>

<p style="margin-top: 1em">static accepts(content_type)
<br>
Return True if this handler can handler this type.</p>

<p style="margin-top: 1em">static dumps(data, pretty=False)
<br>
Return structured data as a string.</p>

<p style="margin-top: 1em">If pretty is true, prettify.</p>

<p style="margin-top: 1em">classmethod gen_replacer(test)
<br>
Return a function which does RESPONSE replacing.</p>

<p style="margin-top: 1em">static loads(data) <br>
Create structured (Python) data from a stream.</p>

<p style="margin-top: 1em">classmethod
replacer(response_data, path) <br>
Return the string the is replacing RESPONSE.</p>

<p style="margin-top: 1em">class
gabbi.handlers.base.ResponseHandler <br>
Bases: object</p>

<p style="margin-top: 1em">Add functionality for making
assertions about an HTTP response.</p>

<p style="margin-top: 1em">A subclass may implement two
methods: action and preprocess.</p>

<p style="margin-top: 1em">preprocess takes one argument,
the TestCase. It is called exactly once for each test before
looping across the assertions. It is used, rarely, to copy
the test.output into <br>
a useful form (such as a parsed DOM).</p>

<p style="margin-top: 1em">action takes two or three
arguments. If test_key_value is a list action is called with
the test case and a single list item. If test_key_value is a
dict then action is <br>
called with the test case and a key and value pair.</p>

<p style="margin-top: 1em">action(test, item, value=None)
<br>
Test an individual entry for this response handler.</p>

<p style="margin-top: 1em">If the entry is a key value pair
the key is in item and the value in value. Otherwise the
entry is considered a single item from a list.</p>

<p style="margin-top: 1em">preprocess(test) <br>
Do any pre-single-test preprocessing.</p>

<p style="margin-top: 1em">test_key_suffix =
&rsquo;&rsquo;</p>

<p style="margin-top: 1em">test_key_value = []</p>

<p style="margin-top: 1em">handlers.core Module <br>
Core response handlers.</p>

<p style="margin-top: 1em">class
gabbi.handlers.core.ForbiddenHeadersResponseHandler <br>
Bases: gabbi.handlers.base.ResponseHandler</p>

<p style="margin-top: 1em">Test that listed headers are not
in the response.</p>

<p style="margin-top: 1em">action(test, forbidden,
value=None)</p>

<p style="margin-top: 1em">test_key_suffix =
&rsquo;forbidden_headers&rsquo;</p>

<p style="margin-top: 1em">test_key_value = []</p>

<p style="margin-top: 1em">class
gabbi.handlers.core.HeadersResponseHandler <br>
Bases: gabbi.handlers.base.ResponseHandler</p>

<p style="margin-top: 1em">Compare expected headers with
actual headers.</p>

<p style="margin-top: 1em">If a header value is wrapped in
/ it is treated as a raw regular expression.</p>

<p style="margin-top: 1em">Headers values are always
treated as strings.</p>

<p style="margin-top: 1em">action(test, header,
value=None)</p>

<p style="margin-top: 1em">test_key_suffix =
&rsquo;headers&rsquo;</p>

<p style="margin-top: 1em">test_key_value = {}</p>

<p style="margin-top: 1em">class
gabbi.handlers.core.StringResponseHandler <br>
Bases: gabbi.handlers.base.ResponseHandler</p>

<p style="margin-top: 1em">Test for matching strings in the
the response body.</p>

<p style="margin-top: 1em">action(test, expected,
value=None)</p>

<p style="margin-top: 1em">test_key_suffix =
&rsquo;strings&rsquo;</p>

<p style="margin-top: 1em">test_key_value = []</p>

<p style="margin-top: 1em">handlers.jsonhandler Module <br>
JSON-related content handling.</p>

<p style="margin-top: 1em">class
gabbi.handlers.jsonhandler.JSONHandler <br>
Bases: gabbi.handlers.base.ContentHandler</p>

<p style="margin-top: 1em">A ContentHandler for JSON</p>

<p style="margin-top: 1em">&Acirc;&middot; Structured test
data is turned into JSON when request content-type is
JSON.</p>

<p style="margin-top: 1em">&Acirc;&middot; Response bodies
that are JSON strings are made into Python data on the test
response_data attribute when the response content-type is
JSON.</p>

<p style="margin-top: 1em">&Acirc;&middot; A
response_json_paths response handler is added.</p>

<p style="margin-top: 1em">&Acirc;&middot; JSONPaths in
$RESPONSE substitutions are supported.</p>

<p style="margin-top: 1em">static accepts(content_type)</p>

<p style="margin-top: 1em">action(test, path, value=None)
<br>
Test json_paths against json data.</p>

<p style="margin-top: 1em">static dumps(data,
pretty=False)</p>

<p style="margin-top: 1em">static
extract_json_path_value(data, path) <br>
Extract the value at JSON Path path from the data.</p>

<p style="margin-top: 1em">The input data is a Python
datastructure, not a JSON string.</p>

<p style="margin-top: 1em">static loads(data)</p>

<p style="margin-top: 1em">classmethod
replacer(response_data, match)</p>

<p style="margin-top: 1em">test_key_suffix =
&rsquo;json_paths&rsquo;</p>

<p style="margin-top: 1em">test_key_value = {}</p>

<p style="margin-top: 1em">SUITE MODULE <br>
A TestSuite for containing gabbi tests.</p>

<p style="margin-top: 1em">This suite has two features: the
contained tests are ordered and there are suite-level
fixtures that operate as context managers.</p>

<p style="margin-top: 1em">class
gabbi.suite.GabbiSuite(tests=()) <br>
Bases: unittest.suite.TestSuite</p>

<p style="margin-top: 1em">A TestSuite with fixtures.</p>

<p style="margin-top: 1em">The suite wraps the tests with a
set of nested context managers that operate as fixtures.</p>

<p style="margin-top: 1em">If a fixture raises
unittest.case.SkipTest during setup, all the tests in this
suite will be skipped.</p>

<p style="margin-top: 1em">run(result, debug=False) <br>
Override TestSuite run to start suite-level fixtures.</p>

<p style="margin-top: 1em">To avoid exception confusion,
use a null Fixture when there are no fixtures.</p>

<p style="margin-top: 1em">start(result) <br>
Start fixtures when using pytest.</p>

<p style="margin-top: 1em">stop() Stop fixtures when using
pytest.</p>

<p style="margin-top: 1em">gabbi.suite.noop(*args) <br>
A noop method used to disable collected tests.</p>

<p style="margin-top: 1em">RUNNER MODULE <br>
Implementation of a command-line runner for gabbi files (AKA
suites).</p>


<p style="margin-top: 1em">gabbi.runner.extract_file_paths(argv)
<br>
Extract command-line arguments following the --
end-of-options delimiter, if any.</p>


<p style="margin-top: 1em">gabbi.runner.initialize_handlers(response_handlers)</p>


<p style="margin-top: 1em">gabbi.runner.load_response_handlers(import_path)
<br>
Load and return custom response handlers from the given
Python package or module.</p>

<p style="margin-top: 1em">The import path references
either a specific response handler class
(&quot;package.module:class&quot;) or a module that contains
one or more response handler classes
(&quot;package.mod&acirc; <br>
ule&quot;).</p>

<p style="margin-top: 1em">For the latter, the module is
expected to contain a gabbi_response_handlers object, which
is either a list of response handler classes or a function
returning such a list.</p>

<p style="margin-top: 1em">gabbi.runner.run() <br>
Run simple tests from STDIN.</p>

<p style="margin-top: 1em">This command provides a way to
run a set of tests encoded in YAML that is provided on
STDIN. No fixtures are supported, so this is primarily
designed for use with real <br>
running services.</p>

<p style="margin-top: 1em">Host and port information may be
provided in three different ways:</p>

<p style="margin-top: 1em">&Acirc;&middot; In the URL value
of the tests.</p>

<p style="margin-top: 1em">&Acirc;&middot; In a host or
host:port argument on the command line.</p>

<p style="margin-top: 1em">&Acirc;&middot; In a URL on the
command line.</p>

<p style="margin-top: 1em">An example run might looks like
this:</p>

<p style="margin-top: 1em">gabbi-run example.com:9999 &lt;
mytest.yaml</p>

<p style="margin-top: 1em">or:</p>

<p style="margin-top: 1em">gabbi-run http://example.com:999
&lt; mytest.yaml</p>

<p style="margin-top: 1em">It is also possible to provide a
URL prefix which can be useful if the target application
might be mounted in different locations. An example:</p>

<p style="margin-top: 1em">gabbi-run example.com:9999
/mountpoint &lt; mytest.yaml</p>

<p style="margin-top: 1em">or:</p>

<p style="margin-top: 1em">gabbi-run
http://example.com:9999/mountpoint &lt; mytest.yaml</p>

<p style="margin-top: 1em">Use -x or --failfast to abort
after the first error or failure:</p>

<p style="margin-top: 1em">gabbi-run -x example.com:9999
/mountpoint &lt; mytest.yaml</p>

<p style="margin-top: 1em">Multiple files may be named as
arguments, separated from other arguments by a --. Each file
will be run as a separate test suite:</p>

<p style="margin-top: 1em">gabbi-run http://example.com --
/path/to/x.yaml /path/to/y.yaml</p>

<p style="margin-top: 1em">Output is formatted as unittest
summary information.</p>

<p style="margin-top: 1em">gabbi.runner.run_suite(handle,
handler_objects, host, port, prefix, force_ssl=False,
failfast=False) <br>
Run the tests from the YAML in handle.</p>

<p style="margin-top: 1em">REPORTER MODULE <br>
TestRunner and TestResult for gabbi-run.</p>

<p style="margin-top: 1em">class
gabbi.reporter.ConciseTestResult(stream, descriptions,
verbosity) <br>
Bases: unittest.runner.TextTestResult</p>

<p style="margin-top: 1em">A TextTestResult with simple but
useful output.</p>

<p style="margin-top: 1em">If the output is a tty or
GABBI_FORCE_COLOR is set in the environment, output will be
colorized.</p>

<p style="margin-top: 1em">addError(test, err)</p>

<p style="margin-top: 1em">addExpectedFailure(test,
err)</p>

<p style="margin-top: 1em">addFailure(test, err)</p>

<p style="margin-top: 1em">addSkip(test, reason)</p>

<p style="margin-top: 1em">addSuccess(test)</p>

<p style="margin-top: 1em">addUnexpectedSuccess(test)</p>

<p style="margin-top: 1em">getDescription(test)</p>

<p style="margin-top: 1em">printErrorList(flavor,
errors)</p>

<p style="margin-top: 1em">startTest(test)</p>

<p style="margin-top: 1em">class
gabbi.reporter.ConciseTestRunner(stream=&lt;open file
&rsquo;&lt;stderr&gt;&rsquo;, mode &rsquo;w&rsquo;&gt;,
descriptions=True, verbosity=1, failfast=False,
buffer=False, resultclass=None) <br>
Bases: unittest.runner.TextTestRunner</p>

<p style="margin-top: 1em">A TextTestRunner that uses
ConciseTestResult for reporting results.</p>

<p style="margin-top: 1em">resultclass <br>
alias of ConciseTestResult</p>

<p style="margin-top: 1em">class
gabbi.reporter.PyTestResult(stream=None, descriptions=None,
verbosity=None) <br>
Bases: unittest.result.TestResult</p>

<p style="margin-top: 1em">Wrap a test result to allow it
to work with pytest.</p>

<p style="margin-top: 1em">The main behaviors here are:</p>

<p style="margin-top: 1em">&Acirc;&middot; to turn what had
been exceptions back into exceptions</p>

<p style="margin-top: 1em">&Acirc;&middot; use
pytest&rsquo;s skip and xfail methods</p>

<p style="margin-top: 1em">addError(test, err)</p>

<p style="margin-top: 1em">addExpectedFailure(test,
err)</p>

<p style="margin-top: 1em">addFailure(test, err)</p>

<p style="margin-top: 1em">addSkip(test, reason)</p>

<p style="margin-top: 1em">UTILS MODULE <br>
Utility functions grab bag.</p>


<p style="margin-top: 1em">gabbi.utils.create_url(base_url,
host, port=None, prefix=&rsquo;&rsquo;, ssl=False) <br>
Given pieces of a path-based url, return a fully qualified
url.</p>


<p style="margin-top: 1em">gabbi.utils.decode_response_content(header_dict,
content) <br>
Decode content to a proper string.</p>


<p style="margin-top: 1em">gabbi.utils.extract_content_type(header_dict,
default=&rsquo;application/binary&rsquo;) <br>
Extract parsed content-type from headers.</p>


<p style="margin-top: 1em">gabbi.utils.get_colorizer(stream)
<br>
Return a function to colorize a string.</p>

<p style="margin-top: 1em">Only if stream is a tty .</p>


<p style="margin-top: 1em">gabbi.utils.host_info_from_target(target,
prefix=None) <br>
Turn url or host:port and target into test destination.</p>


<p style="margin-top: 1em">gabbi.utils.load_yaml(handle=None,
yaml_file=None) <br>
Read and parse any YAML file or filehandle.</p>

<p style="margin-top: 1em">Let exceptions flow where they
may.</p>

<p style="margin-top: 1em">If no file or handle is
provided, read from STDIN.</p>


<p style="margin-top: 1em">gabbi.utils.not_binary(content_type)
<br>
Decide if something is content we&rsquo;d like to treat as a
string.</p>


<p style="margin-top: 1em">gabbi.utils.parse_content_type(content_type,
default_charset=&rsquo;utf-8&rsquo;) <br>
Parse content type value for media type and charset.</p>

<p style="margin-top: 1em">EXCEPTION MODULE <br>
Gabbi specific exceptions.</p>

<p style="margin-top: 1em">exception
gabbi.exception.GabbiFormatError <br>
Bases: exceptions.ValueError</p>

<p style="margin-top: 1em">An exception to encapsulate
poorly formed test data.</p>

<p style="margin-top: 1em">exception
gabbi.exception.GabbiSyntaxWarning <br>
Bases: exceptions.SyntaxWarning</p>

<p style="margin-top: 1em">A warning about syntax that is
not desirable.</p>

<p style="margin-top: 1em">HTTPCLIENT MODULE <br>
Subclass of Http class for verbosity.</p>

<p style="margin-top: 1em">class
gabbi.httpclient.Http(num_pools=10, headers=None,
**connection_pool_kw) <br>
Bases: urllib3.poolmanager.PoolManager</p>

<p style="margin-top: 1em">A subclass of the
urllib3.PoolManager to munge the data.</p>

<p style="margin-top: 1em">This transforms the response to
look more like what httplib2 provided when it was used as
the httpclient.</p>

<p style="margin-top: 1em">request(absolute_uri, method,
body, headers, redirect)</p>

<p style="margin-top: 1em">class
gabbi.httpclient.VerboseHttp(**kwargs) <br>
Bases: gabbi.httpclient.Http</p>

<p style="margin-top: 1em">A subclass of Http that
verbosely reports on activity.</p>

<p style="margin-top: 1em">If the output is a tty or
GABBI_FORCE_COLOR is set in the environment, then output
will be colorized according to COLORMAP.</p>

<p style="margin-top: 1em">Output can include request and
response headers, request and response body content (if of a
printable content-type), or both.</p>

<p style="margin-top: 1em">The color of the output has
reasonable defaults. These may be overridden by setting the
following environment variables</p>

<p style="margin-top: 1em">&Acirc;&middot;
GABBI_CAPTION_COLOR</p>

<p style="margin-top: 1em">&Acirc;&middot;
GABBI_HEADER_COLOR</p>

<p style="margin-top: 1em">&Acirc;&middot;
GABBI_REQUEST_COLOR</p>

<p style="margin-top: 1em">&Acirc;&middot;
GABBI_STATUS_COLOR</p>

<p style="margin-top: 1em">to any of: BLACK RED GREEN
YELLOW BLUE MAGENTA CYAN WHITE</p>

<p style="margin-top: 1em">COLORMAP =
{&rsquo;status&rsquo;: &rsquo;CYAN&rsquo;,
&rsquo;caption&rsquo;: &rsquo;BLUE&rsquo;,
&rsquo;request&rsquo;: &rsquo;CYAN&rsquo;,
&rsquo;header&rsquo;: &rsquo;YELLOW&rsquo;}</p>

<p style="margin-top: 1em">HEADER_BLACKLIST =
[&rsquo;status&rsquo;, &rsquo;reason&rsquo;]</p>

<p style="margin-top: 1em">REQUEST_PREFIX =
&rsquo;&gt;&rsquo;</p>

<p style="margin-top: 1em">RESPONSE_PREFIX =
&rsquo;&lt;&rsquo;</p>

<p style="margin-top: 1em">request(absolute_uri, method,
body, headers, redirect) <br>
Display request parameters before requesting.</p>


<p style="margin-top: 1em">gabbi.httpclient.get_http(verbose=False,
caption=&rsquo;&rsquo;) <br>
Return an Http class for making requests.</p>

<p style="margin-top: 1em">JSON_PARSER MODULE <br>
Keep one single global jsonpath parser.</p>

<p style="margin-top: 1em">gabbi.json_parser.parse(path)
<br>
Parse a JSONPath expression use the global parser.</p>

<p style="margin-top: 1em">Gabbi is a tool for running HTTP
tests where requests and responses are expressed as
declarations in a collection of YAML files. The simplest
test looks like this:</p>

<p style="margin-top: 1em">tests: <br>
- name: A test <br>
GET: /api/resources/id</p>

<p style="margin-top: 1em">See the rest of these docs for
more details on the many features and formats for setting
request headers and bodies and evaluating responses.</p>

<p style="margin-top: 1em">The name is derived from
&quot;gabby&quot;: excessively talkative. In a test
environment having visibility of what a test is actually
doing is a good thing. This is especially true when <br>
the goal of a test is to test the HTTP, not the testing
infrastructure. Gabbi tries to put the HTTP interaction in
the foreground of testing.</p>

<p style="margin-top: 1em">Tests can be run using unittest
style test runners or py.test or from the command line with
a gabbi-run script.</p>

<p style="margin-top: 1em">If you want to get straight to
creating tests look at example, the test files in the source
distribution and format. A gabbi-demo repository provides a
tutorial of using gabbi to <br>
build an API, via the commit history of the repo.</p>

<p style="margin-top: 1em">PURPOSE <br>
Gabbi works to bridge the gap between human readable YAML
files (see format for details) that represent HTTP requests
and expected responses and the rather complex world of
auto&acirc; <br>
mated testing.</p>

<p style="margin-top: 1em">Each YAML file represents an
ordered list of HTTP requests along with the expected
responses. This allows a single file to represent a process
in the API being tested. For exam&acirc; <br>
ple:</p>

<p style="margin-top: 1em">&Acirc;&middot; Create a
resource.</p>

<p style="margin-top: 1em">&Acirc;&middot; Retrieve a
resource.</p>

<p style="margin-top: 1em">&Acirc;&middot; Delete a
resource.</p>

<p style="margin-top: 1em">&Acirc;&middot; Retrieve a
resource again to confirm it is gone.</p>

<p style="margin-top: 1em">At the same time it is still
possible to ask gabbi to run just one request. If it is in a
sequence of tests, those tests prior to it in the YAML file
will be run (in order). In <br>
any single process any test will only be run once.
Concurrency is handled such that one file runs in one
process.</p>

<p style="margin-top: 1em">These features mean that it is
possible to create tests that are useful for both humans (as
tools for learning, improving and developing APIs) and
automated CI systems.</p>

<p style="margin-top: 1em">Significant flexibility and
power is available in the format to make it relatively
straightforward to test existing complex APIs. This extended
functionality includes the use of <br>
JSONPath to query response bodies and templating of test
data to allow access to the prior HTTP response in the
current request. For APIs which do not use JSON additional
han&acirc; <br>
dlers can be created.</p>

<p style="margin-top: 1em">Care should be taken when using
this functionality when you are creating a new API. If your
API is so complex that it needs complex test files then you
may wish to take that as a <br>
sign that your API itself too complex. One goal of gabbi is
to encourage transparent and comprehensible APIs.</p>

<p style="margin-top: 1em">Though gabbi is written in
Python and under the covers uses unittest data structures
and processes, there is no requirement that the host be a
Python-based service. Anything <br>
talking HTTP can be tested. A runner makes it possible to
simply create YAML files and point them at a running
server.</p>

<p style="margin-top: 1em">AUTHOR <br>
Chris Dent</p>

<p style="margin-top: 1em">Feb 11, 2017 GABBI(1)</p>
<hr>
</body>
</html>
