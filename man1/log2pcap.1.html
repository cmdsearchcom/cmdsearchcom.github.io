<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>LOG2PCAP(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">LOG2PCAP(1)</td>
    <td class="head-vol">User Commands</td>
    <td class="head-rtitle">LOG2PCAP(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
log2pcap - Extract network traces from Samba log files
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div class="Pp" style="margin-left: 1.00ex; text-indent: -1.00ex;">log2pcap [-h]
  [-q] [logfile] [pcap_file]</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This tool is part of the <b>samba</b>(7) suite.
<div class="Pp"></div>
log2pcap reads in a samba log file and generates a pcap file (readable by most
  sniffers, such as ethereal or tcpdump) based on the packet dumps in the log
  file.
<div class="Pp"></div>
The log file must have a <i>log level</i> of at least <b>5</b> to get the SMB
  header/parameters right, <b>10</b> to get the first 512 data bytes of the
  packet and <b>50</b> to get the whole packet.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
-h
<div style="margin-left: 4.00ex;">If this parameter is specified the output file
  will be a hex dump, in a format that is readable by the text2pcap
  utility.</div>
<div class="Pp"></div>
-q
<div style="margin-left: 4.00ex;">Be quiet. No warning messages about missing or
  incomplete data will be given.</div>
<div class="Pp"></div>
logfile
<div style="margin-left: 4.00ex;">Samba log file. log2pcap will try to read the
  log from stdin if the log file is not specified.</div>
<div class="Pp"></div>
pcap_file
<div style="margin-left: 4.00ex;">Name of the output file to write the pcap (or
  hexdump) data to. If this argument is not specified, output data will be
  written to stdout.</div>
<div class="Pp"></div>
-?|--help
<div style="margin-left: 4.00ex;">Print a summary of command line options.</div>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
Extract all network traffic from all samba log files:
<div class="Pp"></div>
<div style="margin-left: 4.00ex;">
<pre>
			$ log2pcap &lt; /var/log/* &gt; trace.pcap
	
</pre>
</div>
<div class="Pp"></div>
Convert to pcap using text2pcap:
<div class="Pp"></div>
<div style="margin-left: 4.00ex;">
<pre>
	$ log2pcap -h samba.log | text2pcap -T 139,139 - trace.pcap
	
</pre>
</div>
<h1 class="Sh" title="Sh" id="VERSION"><a class="selflink" href="#VERSION">VERSION</a></h1>
This man page is correct for version 3 of the Samba suite.
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Only SMB data is extracted from the samba logs, no LDAP, NetBIOS lookup or other
  data.
<div class="Pp"></div>
The generated TCP and IP headers don't contain a valid checksum.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>text2pcap</b>(1), <b>ethereal</b>(1)
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
The original Samba software and related utilities were created by Andrew
  Tridgell. Samba is now developed by the Samba Team as an Open Source project
  similar to the way the Linux kernel is developed.
<div class="Pp"></div>
This manpage was written by Jelmer Vernooij.</div>
<table class="foot">
  <tr>
    <td class="foot-date">05/25/2017</td>
    <td class="foot-os">Samba 4.4</td>
  </tr>
</table>
</body>
</html>
