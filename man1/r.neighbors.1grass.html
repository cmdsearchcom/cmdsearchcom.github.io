<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>r.neighbors(1grass)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">r.neighbors(1grass)</td>
    <td class="head-vol">Grass User's Manual</td>
    <td class="head-rtitle">r.neighbors(1grass)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<i></i><b>r.neighbors</b> - Makes each cell category value a function of the
  category values assigned to the cells around it, and stores new cell values in
  an output raster map layer.
<h1 class="Sh" title="Sh" id="KEYWORDS"><a class="selflink" href="#KEYWORDS">KEYWORDS</a></h1>
raster, algebra, statistics, aggregation, neighbor, focal statistics, filter
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>r.neighbors</b>
<div>&#x00A0;</div>
<b>r.neighbors --help</b>
<div>&#x00A0;</div>
<b>r.neighbors</b> [-<b>ac</b>] <b>input</b>=<i>name</i>
  [<b>selection</b>=<i>name</i>] <b>output</b>=<i>name</i>[,<i>name</i>,...]
  [<b>method</b>=<i>string</i>[,<i>string</i>,...]] [<b>size</b>=<i>integer</i>]
  [ <b>title</b>=<i>phrase</i>] [<b>weight</b>=<i>name</i>]
  [<b>gauss</b>=<i>float</i>] [ <b>quantile</b>=<i>float</i>[,<i>float</i>,...]]
  [-- <b>overwrite</b>] [--<b>help</b>] [--<b>verbose</b>] [--<b>quiet</b>]
  [--<b>ui</b>]
<h2 class="Ss" title="Ss" id="Flags:"><a class="selflink" href="#Flags:">Flags:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-a</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Do not align output with the input</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Use circular neighborhood</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--overwrite</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Allow output files to overwrite existing files</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Print usage summary</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verbose</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Verbose module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--quiet</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Quiet module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ui</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Force launching GUI dialog</dd>
</dl>
<h2 class="Ss" title="Ss" id="Parameters:"><a class="selflink" href="#Parameters:">Parameters:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>input</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input raster map</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>selection</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of an input raster map to select the cells which should be
    processed</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>output</b>=<i>name[,</i><i>name</i>,...]
    <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name for output raster map</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>method</b>=<i>string[,</i><i>string</i>,...]</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Neighborhood operation
    <div>&#x00A0;</div>
    Options: <i>average, median, mode, minimum, maximum, range, stddev, sum,
      count, variance, diversity, interspersion, quart1, quart3, perc90,
      quantile</i>
    <div>&#x00A0;</div>
    Default: <i>average</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>size</b>=<i>integer</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Neighborhood size
    <div>&#x00A0;</div>
    Default: <i>3</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>title</b>=<i>phrase</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Title for output raster map</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>weight</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Text file containing weights</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>gauss</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Sigma (in cells) for Gaussian filter</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>quantile</b>=<i>float[,</i><i>float</i>,...]</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Quantile to calculate for method=quantile
    <div>&#x00A0;</div>
    Options: <i>0.0-1.0</i></dd>
</dl>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<i></i><b>r.neighbors</b> looks at each cell in a raster input file, and
  examines the values assigned to the cells in some user-defined
  &quot;neighborhood&quot; around it. It outputs a new raster map layer in which
  each cell is assigned a value that is some (user-specified) function of the
  values in that cell&#x2019;s neighborhood. For example, each cell in the
  output layer might be assigned a value equal to the average of the values
  appearing in its 3 x 3 cell &quot;neighborhood&quot; in the input layer. Note
  that the centre cell is also included in the calculation.
<h2 class="Ss" title="Ss" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h2>
The user must specify the names of the raster map layers to be used for
  <b>input</b> and <b>output</b>, the <b>method</b> used to analyze neighborhood
  values (i.e., the neighborhood function or operation to be performed), and the
  <b>size</b> of the neighborhood.
<div class="Pp"></div>
The user can optionally specify a <b>selection</b> map, to compute new values
  only where the raster cells of the selection map are not NULL. In case of a
  NULL cells, the values from the input map are copied into the output map. This
  may useful to smooth only parts of an elevation map (pits, peaks, ...).
<div class="Pp"></div>
<i>Example how to use a selection map with method=average:</i>
<div>&#x00A0;</div>
input map:
<div>&#x00A0;</div>
<pre>
1 1  1 1 1
1 1  1 1 1
1 1 10 1 1
1 1  1 1 1
1 1  1 1 1
</pre>
selection map, NULL values are marked as *:
<div>&#x00A0;</div>
<pre>
* * * * *
* * 1 * *
* 1 1 1 *
* * 1 * *
* * * * *
</pre>
The output map:
<div>&#x00A0;</div>
<pre>
1 1 1 1 1
1 1 2 1 1
1 2 2 2 1
1 1 2 1 1
1 1 1 1 1
</pre>
Without using the selection map, the output map would look like this:
<div>&#x00A0;</div>
<pre>
1 1 1 1 1
1 2 2 2 1
1 2 2 2 1
1 2 2 2 1
1 1 1 1 1
</pre>
<div class="Pp"></div>
Optionally, the user can also specify the <b>TITLE</b> to be assigned to the
  raster map layer <b>output</b>, elect to not align the resolution of the
  output with that of the input (the <b>-a</b> option), and run
  <i></i><b>r.neighbors</b> with a custom matrix weights with the <i>weight</i>
  option. These options are described further below.
<div class="Pp"></div>
<i>Neighborhood Operation Methods:</i> The <b>neighborhood</b> operators
  determine what new value a center cell in a neighborhood will have after
  examining values inside its neighboring cells. Each cell in a raster map layer
  becomes the center cell of a neighborhood as the neighborhood window moves
  from cell to cell throughout the map layer. <i></i><b>r.neighbors</b> can
  perform the following operations:
<dl class="Bl-tag">
  <dt class="It-tag"><b>average</b> </dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The average value within the neighborhood. In the following example, the
      result would be:
    <div>&#x00A0;</div>
    (7*4 + 6 + 5 + 4*3)/9 = 5.6667
    <div>&#x00A0;</div>
    The result is rounded to the nearest integer (in this case 6).
    <div>&#x00A0;</div>
    <pre>
   Raw Data     Operation     New Data
   +---+---+---+          +---+---+---+
   | 7 | 7 | 5 |          |   |   |   |
   +---+---+---+ average  +---+---+---+
   | 4 | 7 | 4 |---------&gt;|   | 6 |   |
   +---+---+---+          +---+---+---+
   | 7 | 6 | 4 |          |   |   |   |
   +---+---+---+          +---+---+---+
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>median</b> </dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The value found half-way through a list of the neighborhood&#x2019;s values,
      when these are ranged in numerical order.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>mode</b> </dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The most frequently occurring value in the neighborhood.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>minimum</b> </dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The minimum value within the neighborhood.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>maximum</b> </dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The maximum value within the neighborhood.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>range</b> </dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The range value within the neighborhood.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>stddev</b> </dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The statistical standard deviation of values within the neighborhood
      (rounded to the nearest integer).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>sum</b> </dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The sum of values within the neighborhood.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>count</b> </dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The count of filled (not NULL) cells.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>variance</b> </dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The statistical variance of values within the neighborhood (rounded to the
      nearest integer).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>diversity</b> </dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The number of different values within the neighborhood. In the above
      example, the diversity is 4.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>interspersion</b> </dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The percentage of cells containing values which differ from the values
      assigned to the center cell in the neighborhood, plus 1. In the above
      example, the interspersion is:
    <div>&#x00A0;</div>
    5/8 * 100 + 1 = 63.5
    <div>&#x00A0;</div>
    The result is rounded to the nearest integer (in this case 64).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>quart1, quart3</b> </dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The result will be the first or the third quartile (equal of 25th and 75th
      percentiles).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>perc90</b> </dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The result will be the 90th percentile of neighborhood.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>quantile</b> </dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Any quantile as specified by &quot;quantile&quot; input parameter.</dd>
</dl>
<div class="Pp"></div>
<i>Neighborhood Size:</i> The neighborhood <b>size</b> specifies which cells
  surrounding any given cell fall into the neighborhood for that cell. The
  <b>size</b> must be an odd integer and represent the length of one of moving
  window edges in cells. For example, a size value of 3 will result in
<div>&#x00A0;</div>
<pre>
                              _ _ _
                             |_|_|_|
    3 x 3 neighborhood ---&gt;  |_|_|_|
                             |_|_|_|
</pre>
<div class="Pp"></div>
<i>Matrix weights:</i> A custom matrix can be used if none of the neighborhood
  operation methods are desirable by using the <b>weight</b>. This option must
  be used in conjunction with the <b>size</b> option to specify the matrix size.
  The weights desired are to be entered into a text file. For example, to
  calculate the focal mean with a matrix <b>size</b> of 3,
<div>&#x00A0;</div>
<pre>
r.neigbors in=input.map out=output.map size=3 weight=weights.txt
</pre>
The contents of the weight.txt file:
<div>&#x00A0;</div>
<pre>
3 3 3
1 4 8
9 5 3
</pre>
This corresponds to the following 3x3 matrix:
<div>&#x00A0;</div>
<pre>
+-+-+-+
|3|3|3|
+-+-+-+
|1|4|8|
+-+-+-+
|9|5|3|
+-+-+-+
</pre>
To calculate an annulus shaped neighborhood the contents of weight.txt file may
  be e.g. for size=5:
<div>&#x00A0;</div>
<pre>
 0 1 1 1 0
 1 0 0 0 1
 1 0 0 0 1
 1 0 0 0 1
 0 1 1 1 0
</pre>
The way that weights are used depends upon the specific aggregate (
  <b>method</b>) being used. However, most of the aggregates have the property
  that multiplying all of the weights by the same factor won&#x2019;t change the
  final result (an exception is <b>method=count</b>). Also, most (if not all) of
  them have the properties that an integer weight of N is equivalent to N
  occurrences of the cell value, and having all weights equal to one produces
  the same result as when weights are not used. When weights are used, the
  calculation for <b>method=average</b> is:
<div>&#x00A0;</div>
<pre>
  sum(w[i]*x[i]) / sum(w[i])
</pre>
In the case where all weights are zero, this will end up with both the numerator
  and denominator to zero, which produces a NULL result.
<h2 class="Ss" title="Ss" id="FLAGS"><a class="selflink" href="#FLAGS">FLAGS</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-a</b> </dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    If specified, <i></i><b>r.neighbors</b> will not align the output raster map
      layer with that of the input raster map layer. The
      <i></i><b>r.neighbors</b> program works in the current geographic region.
      It is recommended, but not required, that the resolution of the geographic
      region be the same as that of the raster map layer. By default, if
      unspecified, <i></i><b>r.neighbors</b> will align these geographic region
      settings.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c</b> </dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    This flag will use a circular neighborhood for the moving analysis window,
      centered on the current cell.</dd>
</dl>
<div class="Pp"></div>
The exact masks for the first few neighborhood sizes are as follows:
<div>&#x00A0;</div>
<pre>
3x3     . X .		5x5	. . X . .	7x7	. . . X . . .
        X O X			. X X X .		. X X X X X .
        . X .			X X O X X		. X X X X X .
				. X X X .		X X X O X X X
 				. . X . .		. X X X X X .
							. X X X X X .
        						. . . X . . .
9x9	. . . . X . . . .		11x11   . . . . . X . . . . .
	. . X X X X X . .			. . X X X X X X X . .
        . X X X X X X X .			. X X X X X X X X X .
        . X X X X X X X .			. X X X X X X X X X .
        X X X X O X X X X			. X X X X X X X X X .
        . X X X X X X X .			X X X X X O X X X X X
        . X X X X X X X .			. X X X X X X X X X .
        . . X X X X X . .			. X X X X X X X X X .
        . . . . X . . . .			. X X X X X X X X X .
				        	. . X X X X X X X . .
				        	. . . . . X . . . . .
</pre>
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
The <i></i><b>r.neighbors</b> program works in the current geographic region
  with the current mask, if any. It is recommended, but not required, that the
  resolution of the geographic region be the same as that of the raster map
  layer. By default, <i></i><b>r.neighbors</b> will align these geographic
  region settings. However, the user can select to keep original input and
  output resolutions which are not aligned by specifying this (e.g., using the
  <b>-a</b> option).
<div class="Pp"></div>
<i></i><b>r.neighbors</b> doesn&#x2019;t propagate NULLs, but computes the
  aggregate over the non-NULL cells in the neighborhood.
<div class="Pp"></div>
The <b>-c</b> flag and the <b>weights</b> parameter are mutually exclusive. Any
  use of the two together will produce an error. Differently-shaped neighborhood
  analysis windows may be achieved by using the <b>weight=</b> parameter to
  specify a weights file where all values are equal. The user can also vary the
  weights at the edge of the neighborhood according to the proportion of the
  cell that lies inside the neighborhood circle, effectively anti-aliasing the
  analysis mask.
<div class="Pp"></div>
For aggregates where a weighted calculation isn&#x2019;t meaningful
  (specifically: minimum, maximum, diversity and interspersion), the weights are
  used to create a binary mask, where zero causes the cell to be ignored and any
  non-zero value causes the cell to be used.
<div class="Pp"></div>
<i></i><b>r.neighbors</b> copies the GRASS <i>color</i> files associated with
  the input raster map layer for those output map layers that are based on the
  neighborhood average, median, mode, minimum, and maximum. Because standard
  deviation, variance, diversity, and interspersion are indices, rather than
  direct correspondents to input values, no <i>color</i> files are copied for
  these map layers. (The user should note that although the <i>color</i> file is
  copied for <i>average</i> neighborhood function output, whether or not the
  color file makes sense for the output will be dependent on the input data
  values.)
<h2 class="Ss" title="Ss" id="Propagation_of_output_precision"><a class="selflink" href="#Propagation_of_output_precision">Propagation
  of output precision</a></h2>
The following logic has been implemented: For any aggregate, there are two
  factors affecting the output type:
<dl class="Bl-tag">
  <dt class="It-tag"><b>1</b></dt>
  <dd class="It-tag">Whether the input map is integer or floating-point.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>2</b></dt>
  <dd class="It-tag">Whether the weighted or unweighted version of the aggregate
      is used.</dd>
</dl>
<div class="Pp"></div>
These combine to create four possibilities:
<table class="tbl">
  <colgroup>
    <col style="width: 60.00ex;"/>
    <col style="width: 1.00ex;"/>
    <col style="width: 60.00ex;"/>
    <col style="width: 1.00ex;"/>
    <col style="width: 60.00ex;"/>
    <col style="width: 1.00ex;"/>
    <col style="width: 60.00ex;"/>
    <col style="width: 1.00ex;"/>
    <col style="width: 60.00ex;"/>
  </colgroup>
  <tr>
    <td>input type</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
  </tr>
  <tr>
    <td>weighted</td>
    <td> </td>
    <td>no</td>
    <td> </td>
    <td>yes</td>
    <td> </td>
    <td>no</td>
    <td> </td>
    <td>yes</td>
  </tr>
  <tr>
    <td></td>
    <td> </td>
    <td></td>
    <td> </td>
    <td></td>
    <td> </td>
    <td></td>
    <td> </td>
    <td></td>
  </tr>
  <tr>
    <td>average</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
  </tr>
  <tr>
    <td>median</td>
    <td> </td>
    <td>[1]</td>
    <td> </td>
    <td>[1]</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
  </tr>
  <tr>
    <td>mode</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>[2]</td>
    <td> </td>
    <td>[2]</td>
  </tr>
  <tr>
    <td>minimum</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
  </tr>
  <tr>
    <td>maximum</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
  </tr>
  <tr>
    <td>range</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
  </tr>
  <tr>
    <td>stddev</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
  </tr>
  <tr>
    <td>sum</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
  </tr>
  <tr>
    <td>count</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>float</td>
  </tr>
  <tr>
    <td>variance</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
  </tr>
  <tr>
    <td>diversity</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>integer</td>
  </tr>
  <tr>
    <td>interspersion</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>integer</td>
    <td> </td>
    <td>integer</td>
  </tr>
  <tr>
    <td>quart1</td>
    <td> </td>
    <td>[1]</td>
    <td> </td>
    <td>[1]</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
  </tr>
  <tr>
    <td>quart3</td>
    <td> </td>
    <td>[1]</td>
    <td> </td>
    <td>[1]</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
  </tr>
  <tr>
    <td>perc90</td>
    <td> </td>
    <td>[1]</td>
    <td> </td>
    <td>[1]</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
  </tr>
  <tr>
    <td>quantile</td>
    <td> </td>
    <td>[1]</td>
    <td> </td>
    <td>[1]</td>
    <td> </td>
    <td>float</td>
    <td> </td>
    <td>float</td>
  </tr>
</table>
<div class="Pp"></div>
[1] For integer input, quantiles may produce float results from interpolating
  between adjacent values.
<div>&#x00A0;</div>
[2] Calculating the mode of floating-point data is essentially meaningless.
<div class="Pp"></div>
With the current aggregates, there are 5 cases:
<dl class="Bl-tag">
  <dt class="It-tag"><b>1</b></dt>
  <dd class="It-tag">Output is always float: average, variance, stddev,
      quantiles (with interpolation).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>2</b></dt>
  <dd class="It-tag">Output is always integer: diversity, interspersion.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>3</b></dt>
  <dd class="It-tag">Output is integer if unweighted, float if weighted:
    count.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>4</b></dt>
  <dd class="It-tag">Output matches input: minimum, maximum, range, mode
      (subject to note 2 above), quantiles (without interpolation).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>5</b></dt>
  <dd class="It-tag">Output is integer for integer input and unweighted
      aggregate, otherwise float: sum.</dd>
</dl>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<h2 class="Ss" title="Ss" id="Measure_occupancy_of_neighborhood"><a class="selflink" href="#Measure_occupancy_of_neighborhood">Measure
  occupancy of neighborhood</a></h2>
Set up 10x10 computational region to aid visual inspection of results
<div>&#x00A0;</div>
<pre>
g.region rows=10 cols=10
</pre>
Fill 50% of computational region with randomly located cells.
  &quot;distance=0&quot; will allow filling adjacent cells.
<div>&#x00A0;</div>
<pre>
r.random.cells output=random_cells distance=0 ncells=50
</pre>
Count non-empty (not NULL) cells in 3x3 neighborhood
<div>&#x00A0;</div>
<pre>
r.neighbors input=random_cells output=counts method=count
</pre>
Optionally - exclude centre cell from the count (= only look around)
<div>&#x00A0;</div>
<pre>
r.mapcalc &quot;cound_around = if( isnull(random_cells), counts, counts - 1)&quot;
</pre>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i>g.region</i>
<div>&#x00A0;</div>
<i>r.clump</i>
<div>&#x00A0;</div>
<i>r.mapcalc</i>
<div>&#x00A0;</div>
<i>r.mfilter</i>
<div>&#x00A0;</div>
<i>r.statistics</i>
<div>&#x00A0;</div>
<i>r.support</i>
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
Original version: Michael Shapiro, U.S.Army Construction Engineering Research
  Laboratory
<div>&#x00A0;</div>
Updates for GRASS GIS 7 by Glynn Clements and others
<div class="Pp"></div>
<i>Last changed: $Date: 2016-06-08 22:20:56 +0200 (Wed, 08 Jun 2016) $</i>
<h1 class="Sh" title="Sh" id="SOURCE_CODE"><a class="selflink" href="#SOURCE_CODE">SOURCE
  CODE</a></h1>
Available at: r.neighbors source code (history)
<div class="Pp"></div>
Main index | Raster index | Topics index | Keywords index | Graphical index |
  Full index
<div class="Pp"></div>
&#x00A9; 2003-2016 GRASS Development Team, GRASS GIS 7.2.0 Reference
  Manual</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os">GRASS 7.2.0</td>
  </tr>
</table>
</body>
</html>
