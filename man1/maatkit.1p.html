<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:23:25 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>MAATKIT(1) User Contributed Perl Documentation
MAATKIT(1)</p>

<p style="margin-top: 1em">NAME <br>
maatkit - Essential command-line utilities for MySQL.</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Maatkit is a collection of command-line utilities that
provide missing functionality for MySQL. Some of the tools
implement lacking server functionality, such as online <br>
consistency checks for master/slave replication; others are
client-side utilities such as a query profiler.</p>

<p style="margin-top: 1em">The following tools are
included:</p>

<p style="margin-top: 1em">$Revision: 7540 $ <br>
mk-archiver 1.0.27 <br>
mk-config-diff 1.0.0 <br>
mk-deadlock-logger 1.0.21 <br>
mk-duplicate-key-checker 1.2.15 <br>
mk-error-log 1.0.3 <br>
mk-fifo-split 1.0.7 <br>
mk-find 0.9.23 <br>
mk-heartbeat 1.0.23 <br>
mk-index-usage 0.9.4 <br>
mk-kill 0.9.10 <br>
mk-loadavg 0.9.7 <br>
mk-log-player 1.0.9 <br>
mk-parallel-dump 1.0.28 <br>
mk-parallel-restore 1.0.24 <br>
mk-purge-logs 0.9.0 <br>
mk-query-advisor 1.0.4 <br>
mk-query-digest 0.9.29 <br>
mk-query-profiler 1.1.22 <br>
mk-show-grants 1.0.23 <br>
mk-slave-delay 1.0.23 <br>
mk-slave-find 1.0.16 <br>
mk-slave-move 0.9.12 <br>
mk-slave-prefetch 1.0.21 <br>
mk-slave-restart 1.0.22 <br>
mk-table-checksum 1.2.23 <br>
mk-table-sync 1.0.31 <br>
mk-table-usage 1.0.1 <br>
mk-tcp-model 1.0.1 <br>
mk-upgrade 0.9.8 <br>
mk-variable-advisor 1.0.2 <br>
mk-visual-explain 1.0.22</p>

<p style="margin-top: 1em">mk-archiver <br>
Archive rows from a MySQL table into another table or a
file. See mk-archiver.</p>

<p style="margin-top: 1em">mk-checksum-filter <br>
Filter checksums from mk-table-checksum. See
mk-checksum-filter.</p>

<p style="margin-top: 1em">mk-config-diff <br>
Diff MySQL configuration files and server variables. See
mk-config-diff.</p>

<p style="margin-top: 1em">mk-deadlock-logger <br>
Extract and log MySQL deadlock information. See
mk-deadlock-logger.</p>

<p style="margin-top: 1em">mk-duplicate-key-checker <br>
Find duplicate indexes and foreign keys on MySQL tables. See
mk-duplicate-key-checker.</p>

<p style="margin-top: 1em">mk-error-log <br>
Find new and different MySQL error log entries. See
mk-error-log.</p>

<p style="margin-top: 1em">mk-fifo-split <br>
Split files and pipe lines to a fifo without really
splitting. See mk-fifo-split.</p>

<p style="margin-top: 1em">mk-find <br>
Find MySQL tables and execute actions, like GNU find. See
mk-find.</p>

<p style="margin-top: 1em">mk-heartbeat <br>
Monitor MySQL replication delay. See mk-heartbeat.</p>

<p style="margin-top: 1em">mk-index-usage <br>
Read queries from a log and analyze how they use indexes.
See mk-index-usage.</p>

<p style="margin-top: 1em">mk-kill <br>
Kill MySQL queries that match certain criteria. See
mk-kill.</p>

<p style="margin-top: 1em">mk-loadavg <br>
Watch MySQL load and take action when it gets too high. See
mk-loadavg.</p>

<p style="margin-top: 1em">mk-log-player <br>
Replay MySQL query logs. See mk-log-player.</p>

<p style="margin-top: 1em">mk-merge-mqd-results <br>
Merge multiple mk-query-digest reports into one. See
mk-merge-mqd-results.</p>

<p style="margin-top: 1em">mk-parallel-dump <br>
(DEPRECATED) Dump MySQL tables in parallel. See
mk-parallel-dump.</p>

<p style="margin-top: 1em">mk-parallel-restore <br>
(DEPRECATED) Load files into MySQL in parallel. See
mk-parallel-restore.</p>

<p style="margin-top: 1em">mk-profile-compact <br>
Compact the output from mk-query-profiler. See
mk-profile-compact.</p>

<p style="margin-top: 1em">mk-purge-logs <br>
Purge binary logs on a master based on purge rules. See
mk-purge-logs.</p>

<p style="margin-top: 1em">mk-query-advisor <br>
Analyze queries and advise on possible problems. See
mk-query-advisor.</p>

<p style="margin-top: 1em">mk-query-digest <br>
Analyze query execution logs and generate a query report,
filter, replay, or transform queries for MySQL, PostgreSQL,
memcached, and more. See mk-query-digest.</p>

<p style="margin-top: 1em">mk-query-profiler <br>
Execute SQL statements and print statistics, or measure
activity caused by other processes. See
mk-query-profiler.</p>

<p style="margin-top: 1em">mk-show-grants <br>
Canonicalize and print MySQL grants so you can effectively
replicate, compare and version-control them. See
mk-show-grants.</p>

<p style="margin-top: 1em">mk-slave-delay <br>
Make a MySQL slave server lag behind its master. See
mk-slave-delay.</p>

<p style="margin-top: 1em">mk-slave-find <br>
Find and print replication hierarchy tree of MySQL slaves.
See mk-slave-find.</p>

<p style="margin-top: 1em">mk-slave-move <br>
Move a MySQL slave around in the replication hierarchy. See
mk-slave-move.</p>

<p style="margin-top: 1em">mk-slave-prefetch <br>
Pipeline relay logs on a MySQL slave to pre-warm caches. See
mk-slave-prefetch.</p>

<p style="margin-top: 1em">mk-slave-restart <br>
Watch and restart MySQL replication after errors. See
mk-slave-restart.</p>

<p style="margin-top: 1em">mk-table-checksum <br>
Perform an online replication consistency check, or checksum
MySQL tables efficiently on one or many servers. See
mk-table-checksum.</p>

<p style="margin-top: 1em">mk-table-sync <br>
Synchronize MySQL table data efficiently. See
mk-table-sync.</p>

<p style="margin-top: 1em">mk-table-usage <br>
Read queries from a log and analyze how they use tables. See
mk-table-usage.</p>

<p style="margin-top: 1em">mk-tcp-model <br>
Transform tcpdump into metrics that permit performance and
scalability modeling. See mk-tcp-model.</p>

<p style="margin-top: 1em">mk-upgrade <br>
Execute queries on multiple servers and check for
differences. See mk-upgrade.</p>

<p style="margin-top: 1em">mk-variable-advisor <br>
Analyze MySQL variables and advise on possible problems. See
mk-variable-advisor.</p>

<p style="margin-top: 1em">mk-visual-explain <br>
Format EXPLAIN output as a tree. See mk-visual-explain.</p>

<p style="margin-top: 1em">INSTALLATION <br>
Strictly speaking these tools require no installation; you
should be able to run them stand-alone. However, on UNIX-ish
systems you can use the standard Perl installation <br>
sequence:</p>

<p style="margin-top: 1em">cd &lt;package directory&gt;
<br>
perl Makefile.PL <br>
make install</p>

<p style="margin-top: 1em">CONFIGURATION <br>
Maatkit tools can read options from configuration files. The
configuration file syntax is simple and direct, and bears
some resemblances to the MySQL command-line client tools.
<br>
The configuration files all follow the same conventions.</p>

<p style="margin-top: 1em">Internally, what actually
happens is that the lines are read from the file and then
added as command-line options and arguments to the Maatkit
tool, so just think of the <br>
configuration files as a way to write your command
lines.</p>

<p style="margin-top: 1em">SYNTAX <br>
The syntax of the files is as follows:</p>

<p style="margin-top: 1em">&Acirc;&middot; Whitespace
followed by a hash (#) sign signifies that the rest of the
line is a comment. This is deleted.</p>

<p style="margin-top: 1em">&Acirc;&middot; Whitespace is
stripped from the beginning and end of all lines.</p>

<p style="margin-top: 1em">&Acirc;&middot; Empty lines are
ignored.</p>

<p style="margin-top: 1em">&Acirc;&middot; Each line is
permitted to be in either of the following formats:</p>

<p style="margin-top: 1em">option <br>
option=value</p>

<p style="margin-top: 1em">Whitespace around the equals
sign is deleted during processing.</p>

<p style="margin-top: 1em">&Acirc;&middot; Only long
options are recognized.</p>

<p style="margin-top: 1em">&Acirc;&middot; A line
containing only two hyphens signals the end of option
parsing. Any further lines are interpreted as additional
arguments (not options) to the program.</p>

<p style="margin-top: 1em">FILES <br>
The tools read several configuration files in order:</p>

<p style="margin-top: 1em">1. The global Maatkit
configuration file, /etc/maatkit/maatkit.conf. All tools
read this file, so you should only add options to it that
you want to apply to all Maatkit tools.</p>

<p style="margin-top: 1em">2. The global tool configuration
file, /etc/maatkit/[toolname].conf. This file is named after
the specific tool you&rsquo;re using, so you can add options
that apply only to that <br>
tool.</p>

<p style="margin-top: 1em">3. The user&rsquo;s own Maatkit
configuration file, $HOME/.maatkit.conf. All tools read this
file, so you should only add options to it that you want to
apply to all Maatkit tools.</p>

<p style="margin-top: 1em">4. The user&rsquo;s tool
configuration file, $HOME/.[toolname].conf. This file is
named after the specific tool you&rsquo;re using, so you can
add options that apply only to that tool.</p>

<p style="margin-top: 1em">SPECIFYING CONFIGURATION FILES
<br>
There is a special --config option, which lets you specify
which configuration files Maatkit should read. You specify a
comma-separated list of files. However, its behavior is <br>
not like other command-line options. It must be given first
on the command line, before any other options. If you try to
specify it anywhere else, it will cause an error. <br>
Also, you cannot specify --config=/path/to/file; you must
specify the option and the path to the file(s) separated by
whitespace, without an equals-sign between them, e.g.</p>

<p style="margin-top: 1em">--config /path/to/file</p>

<p style="margin-top: 1em">If you don&rsquo;t want any
configuration files at all, specify &quot;--config
&rsquo;&rsquo;&quot; to provide an empty list of files.</p>

<p style="margin-top: 1em">DSN (DATA SOURCE NAME)
SPECIFICATIONS <br>
Maatkit uses DSNs to specify how to create a DBD connection
to a MySQL server. The maatkit tools that have command-line
arguments such as -u or -p use them to create a DSN <br>
behind the scenes, then use the DSN to connect to MySQL.</p>

<p style="margin-top: 1em">A DSN is a string of key=value
parts separated by commas. The possible keys are shown later
in this document. You can also get a quick synopsis from the
--help output of many <br>
of the maatkit tools.</p>

<p style="margin-top: 1em">PARTS <br>
Many of the tools add more parts to DSNs for special
purposes, and sometimes override parts to make them do
something slightly different. However, all the tools support
at least <br>
the following:</p>

<p style="margin-top: 1em">A Specifies the default
character set for the connection.</p>

<p style="margin-top: 1em">Enables character set settings
in Perl and MySQL. If the value is &quot;utf8&quot;, sets
Perl&rsquo;s binmode on STDOUT to utf8, passes the
&quot;mysql_enable_utf8&quot; option to DBD::mysql, and <br>
runs &quot;SET NAMES UTF8&quot; after connecting to MySQL.
Any other value sets binmode on STDOUT without the utf8
layer, and runs &quot;SET NAMES&quot; after connecting to
MySQL.</p>

<p style="margin-top: 1em">Unfortunately, there is no way
from within Perl itself to specify the client
library&rsquo;s character set. &quot;SET NAMES&quot; only
affects the server; if the client library&rsquo;s settings
<br>
don&rsquo;t match, there could be problems. You can use the
defaults file to specify the client library&rsquo;s
character set, however. See the description of the F part
below.</p>

<p style="margin-top: 1em">D Specifies the
connection&rsquo;s default database.</p>

<p style="margin-top: 1em">F Specifies a defaults file the
mysql client library (the C client library used by
DBD::mysql, not maatkit itself) should read. The maatkit
tools all read the [client] section <br>
within the defaults file. If you omit this, the standard
defaults files will be read in the usual order.
&quot;Standard&quot; varies from system to system, because
the filenames to <br>
read are compiled into the client library. On Debian
systems, for example, it&rsquo;s usually /etc/mysql/my.cnf
then ~/.my.cnf. If you place the following into ~/.my.cnf,
maatkit <br>
will Do The Right Thing:</p>

<p style="margin-top: 1em">[client] <br>
user=your_user_name <br>
pass=secret</p>

<p style="margin-top: 1em">Omitting the F part is usually
the right thing to do. As long as you have configured your
~/.my.cnf correctly, that will result in maatkit connecting
automatically without <br>
needing a username or password.</p>

<p style="margin-top: 1em">You can also specify a default
character set in the defaults file. Unlike the &quot;A&quot;
part described above, this will actually instruct the client
library (DBD::mysql) to change <br>
the character set it uses internally, which cannot be
accomplished any other way as far as I know, except for
&quot;utf8&quot;.</p>

<p style="margin-top: 1em">P Port number to use for the
connection. Note that the usual special-case behaviors
apply: if you specify &quot;localhost&quot; as your hostname
on Unix systems, the connection actually <br>
uses a socket file, not a TCP/IP connection, and thus
ignores the port.</p>

<p style="margin-top: 1em">S Socket file to use for the
connection (on Unix systems).</p>

<p style="margin-top: 1em">h Hostname or IP address for the
connection.</p>

<p style="margin-top: 1em">p Password to use when
connecting.</p>

<p style="margin-top: 1em">u User for login if not current
user.</p>

<p style="margin-top: 1em">BAREWORD <br>
Many of the tools will let you specify a DSN as a single
word, without any key=value syntax. This is called a
&rsquo;bareword&rsquo;. How this is handled is
tool-specific, but it is <br>
usually interpreted as the &quot;h&quot; part. The
tool&rsquo;s --help output will tell you the behavior for
that tool.</p>

<p style="margin-top: 1em">DEFAULT PROPAGATION <br>
Many tools will let you propagate values from one DSN to the
next, so you don&rsquo;t have to specify all the parts for
each DSN. For example, if you want to specify a username and
<br>
password for each DSN, you can connect to three hosts as
follows:</p>

<p style="margin-top: 1em">h=host1,u=fred,p=wilma host2
host3</p>

<p style="margin-top: 1em">This is tool-specific.</p>

<p style="margin-top: 1em">SYSTEM REQUIREMENTS <br>
You need Perl, DBI, DBD::mysql, and some core packages that
ought to be installed in any reasonably new version of
Perl.</p>

<p style="margin-top: 1em">BUGS <br>
If you find bugs, need features, etc please use the bug
tracker, forums, and mailing lists at
http://code.google.com/p/maatkit/</p>

<p style="margin-top: 1em">COPYRIGHT, LICENSE AND WARRANTY
<br>
This program is copyright (c) 2007 Baron Schwartz and
others. Feedback and improvements are welcome.</p>

<p style="margin-top: 1em">THIS PROGRAM IS PROVIDED
&quot;AS IS&quot; AND WITHOUT ANY EXPRESS OR IMPLIED
WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED
WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR A <br>
PARTICULAR PURPOSE.</p>

<p style="margin-top: 1em">This program is free software;
you can redistribute it and/or modify it under the terms of
the GNU General Public License as published by the Free
Software Foundation, version 2; <br>
OR the Perl Artistic License. On UNIX and similar systems,
you can issue &lsquo;man perlgpl&rsquo; or &lsquo;man
perlartistic&rsquo; to read these licenses.</p>

<p style="margin-top: 1em">You should have received a copy
of the GNU General Public License along with this program;
if not, write to the Free Software Foundation, Inc., 59
Temple Place, Suite 330, <br>
Boston, MA 02111-1307 USA.</p>

<p style="margin-top: 1em">AUTHOR <br>
See the individual program&rsquo;s documentation for
details.</p>

<p style="margin-top: 1em">VERSION <br>
This manual page documents Distrib 7540 $Revision: 534
$.</p>

<p style="margin-top: 1em">perl v5.24.1 2011-06-08
MAATKIT(1)</p>
<hr>
</body>
</html>
