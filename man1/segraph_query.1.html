<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>segraph_query(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">segraph_query(1)</td>
    <td class="head-vol">SELinux Policy Analysis Tool</td>
    <td class="head-rtitle">segraph_query(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<b>segraph_query </b>- SELinux policy analysis tool
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>
<b>segraph_query</b> [<b>-h</b>] [<b>-d</b> <i>POLICY_GRAPH2</i>] <i>POLICY_GRAPH</i> <i>QUERY_FUNCTIONS</i>
<div class="Pp"></div>
</pre>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
Analyses policy graph using given query functions.
<h2 class="Ss" title="Ss" id="Available_query_functions:"><a class="selflink" href="#Available_query_functions:">Available
  query functions:</a></h2>
<div style="margin-left: 5.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>write_executable</b></dt>
  <dd class="It-tag">Finds all types corresponding to executables, that can be
      written to. Lists dictionary with execuatable types as keys and types with
      write permission as values.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>transition_write</b></dt>
  <dd class="It-tag">Finds domain transitions via entrypoints that can be
      rewritten by source domain. This effectively increases reach of source
      domain by access rights of target domain. Lists triplets of (source
      domain, target domain, entrypoint)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>write_to_security</b></dt>
  <dd class="It-tag">Find domains that are allowed write access to
      &quot;security related&quot; types. Lists domains with the specified write
      access and lists of affected types (security types that can be written
    to)</dd>
</dl>
</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<h2 class="Ss" title="Ss" id="Positional_arguments:"><a class="selflink" href="#Positional_arguments:">Positional
  arguments:</a></h2>
<div style="margin-left: 5.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><i>POLICY_GRAPH</i></b></dt>
  <dd class="It-tag">Policy graph file</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><i>QUERY_FUNCTIONS</i></b></dt>
  <dd class="It-tag">Comma separated list of query functions to be executed</dd>
</dl>
</div>
<h2 class="Ss" title="Ss" id="Optional_arguments:"><a class="selflink" href="#Optional_arguments:">Optional
  arguments:</a></h2>
<div style="margin-left: 5.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-h</b>, <b>--help</b></b></dt>
  <dd class="It-tag">Show help message and exit</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-d</b> <i>POLICY_GRAPH2</i>, <b>--diff</b>
    <i>POLICY_GRAPH2</i></b></dt>
  <dd class="It-tag">Another policy graph file for comparison</dd>
</dl>
</div>
<h1 class="Sh" title="Sh" id="EXAMPLE"><a class="selflink" href="#EXAMPLE">EXAMPLE</a></h1>
Check a policy graph (created using sebuild_graph) with write_executable
  function:
<div class="Pp"></div>
<pre>
      $ graph_query.py graph write_executable
<div class="Pp"></div>
</pre>
Show consequences of change in policy (graph2 was created after the change):
<div class="Pp"></div>
<pre>
      $ segraph_query graph2 write_executable,transition_write,write_to_security -d graph
<div class="Pp"></div>
<div class="Pp"></div>
</pre>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>sebuild_graph</b>(1)
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Vit Mojzis &lt;vmojzis@redhat.com&gt;</div>
<table class="foot">
  <tr>
    <td class="foot-date">2017-02-09</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
