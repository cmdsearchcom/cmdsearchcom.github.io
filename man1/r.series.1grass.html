<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>r.series(1grass)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">r.series(1grass)</td>
    <td class="head-vol">Grass User's Manual</td>
    <td class="head-rtitle">r.series(1grass)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<i></i><b>r.series</b> - Makes each output cell value a function of the values
  assigned to the corresponding cells in the input raster map layers.
<h1 class="Sh" title="Sh" id="KEYWORDS"><a class="selflink" href="#KEYWORDS">KEYWORDS</a></h1>
raster, aggregation, series
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>r.series</b>
<div>&#x00A0;</div>
<b>r.series --help</b>
<div>&#x00A0;</div>
<b>r.series</b> [-<b>nz</b>] [<b>input</b>=<i>name</i>[,<i>name</i>,...]]
  [<b>file</b>= <i>name</i>] <b>output</b>=<i>name</i>[,<i>name</i>,...]
  <b>method</b>= <i>string</i>[,<i>string</i>,...]
  [<b>quantile</b>=<i>float</i>[, <i>float</i>,...]]
  [<b>weights</b>=<i>float</i>[, <i>float</i>,...]] [<b>range</b>=<i>lo,hi</i>]
  [-- <b>overwrite</b>] [--<b>help</b>] [--<b>verbose</b>] [--<b>quiet</b>]
  [--<b>ui</b>]
<h2 class="Ss" title="Ss" id="Flags:"><a class="selflink" href="#Flags:">Flags:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Propagate NULLs</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-z</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Do not keep files open</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--overwrite</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Allow output files to overwrite existing files</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Print usage summary</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verbose</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Verbose module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--quiet</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Quiet module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ui</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Force launching GUI dialog</dd>
</dl>
<h2 class="Ss" title="Ss" id="Parameters:"><a class="selflink" href="#Parameters:">Parameters:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>input</b>=<i>name[,</i><i>name</i>,...]</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input raster map(s)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>file</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Input file with one raster map name and optional one weight per line, field
      separator between name and weight is |</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>output</b>=<i>name[,</i><i>name</i>,...]
    <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name for output raster map</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>method</b>=<i>string[,</i><i>string</i>,...]
    <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Aggregate operation
    <div>&#x00A0;</div>
    Options: <i>average, count, median, mode, minimum, min_raster, maximum,
      max_raster, stddev, range, sum, variance, diversity, slope, offset,
      detcoeff, tvalue, quart1, quart3, perc90, quantile, skewness,
    kurtosis</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>quantile</b>=<i>float[,</i><i>float</i>,...]</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Quantile to calculate for method=quantile
    <div>&#x00A0;</div>
    Options: <i>0.0-1.0</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>weights</b>=<i>float[,</i><i>float</i>,...]</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Weighting factor for each input map, default value is 1.0 for each input
    map</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>range</b>=<i>lo,hi</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Ignore values outside this range</dd>
</dl>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<i>r.series</i> makes each output cell value a function of the values assigned
  to the corresponding cells in the input raster map layers.
<div class="Pp"></div>
Following methods are available:
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">average: average value</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">count: count of non-NULL cells</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">median: median value</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">mode: most frequently occurring value</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">minimum: lowest value</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">maximum: highest value</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">range: range of values (max - min)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">stddev: standard deviation</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">sum: sum of values</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">variance: statistical variance</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">diversity: number of different values</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">slope: linear regression slope</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">offset: linear regression offset</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">detcoeff: linear regression coefficient of
    determination</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">tvalue: linear regression t-value</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">min_raster: raster map number with the minimum time-series
      value</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">max_raster: raster map number with the maximum time-series
      value</dd>
</dl>
</div>
Note that most parameters accept multiple answers, allowing multiple aggregates
  to be computed in a single run, e.g.:
<div class="Pp"></div>
<pre>
r.series input=map1,...,mapN \
         output=map.mean,map.stddev \
	 method=average,stddev
</pre>
or:
<div class="Pp"></div>
<pre>
r.series input=map1,...,mapN \
         output=map.p10,map.p50,map.p90 \
         method=quantile,quantile,quantile \
         quantile=0.1,0.5,0.9
</pre>
The same number of values must be provided for all options.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
<h2 class="Ss" title="Ss" id="No-data_(NULL)_handling"><a class="selflink" href="#No-data_(NULL)_handling">No-data
  (NULL) handling</a></h2>
With <i>-n</i> flag, any cell for which any of the corresponding input cells are
  NULL is automatically set to NULL (NULL propagation). The aggregate function
  is not called, so all methods behave this way with respect to the <i>-n</i>
  flag.
<div class="Pp"></div>
Without <i>-n</i> flag, the complete list of inputs for each cell (including
  NULLs) is passed to the aggregate function. Individual aggregates can handle
  data as they choose. Mostly, they just compute the aggregate over the non-NULL
  values, producing a NULL result only if all inputs are NULL.
<h2 class="Ss" title="Ss" id="Minimum_and_maximum_analysis"><a class="selflink" href="#Minimum_and_maximum_analysis">Minimum
  and maximum analysis</a></h2>
The <i>min_raster</i> and <i>max_raster</i> methods generate a map with the
  number of the raster map that holds the minimum/maximum value of the
  time-series. The numbering starts at <i>0</i> up to <i>n</i> for the first and
  the last raster listed in <i>input=</i>, respectively.
<h2 class="Ss" title="Ss" id="Range_analysis"><a class="selflink" href="#Range_analysis">Range
  analysis</a></h2>
If the <i>range=</i> option is given, any values which fall outside that range
  will be treated as if they were NULL. The <i>range</i> parameter can be set to
  <i>low,high</i> thresholds: values outside of this range are treated as NULL
  (i.e., they will be ignored by most aggregates, or will cause the result to be
  NULL if -n is given). The <i>low,high</i> thresholds are floating point, so
  use <i>-inf</i> or <i>inf</i> for a single threshold (e.g., <i>range=0,inf</i>
  to ignore negative values, or <i>range=-inf,-200.4</i> to ignore values above
  -200.4).
<h2 class="Ss" title="Ss" id="Linear_regression"><a class="selflink" href="#Linear_regression">Linear
  regression</a></h2>
Linear regression (slope, offset, coefficient of determination, t-value) assumes
  equal time intervals. If the data have irregular time intervals, NULL raster
  maps can be inserted into time series to make time intervals equal (see
  example).
<h2 class="Ss" title="Ss" id="Quantiles"><a class="selflink" href="#Quantiles">Quantiles</a></h2>
<i>r.series</i> can calculate arbitrary quantiles.
<h2 class="Ss" title="Ss" id="Memory_consumption"><a class="selflink" href="#Memory_consumption">Memory
  consumption</a></h2>
Memory usage is not an issue, as <i>r.series</i> only needs to hold one row from
  each map at a time.
<h2 class="Ss" title="Ss" id="Management_of_open_file_limits"><a class="selflink" href="#Management_of_open_file_limits">Management
  of open file limits</a></h2>
Number of raster maps to be processed is given by the limit of the operating
  system. For example, both the hard and soft limits are typically 1024. The
  soft limit can be changed with e.g. ulimit -n 1500 (UNIX-based operating
  systems) but not higher than the hard limit. If it is too low, you can as
  superuser add an entry in
<div>&#x00A0;</div>
<pre>
/etc/security/limits.conf
# &lt;domain&gt;      &lt;type&gt;  &lt;item&gt;         &lt;value&gt;
your_username  hard    nofile          1500
</pre>
This would raise the hard limit to 1500 file. Be warned that more files open
  need more RAM. See also the Wiki page Hints for large raster data processing.
<div class="Pp"></div>
For each map a weighting factor can be specified using the <i>weights</i>
  option. Using weights can be meaningful when computing sum or average of maps
  with different temporal extent. The default weight is 1.0. The number of
  weights must be identical with the number of input maps and must have the same
  order. Weights can also be specified in the input file.
<div class="Pp"></div>
Use the <i>file</i> option to analyze large amount of raster maps without
  hitting open files limit and the size limit of command line arguments. The
  computation is slower than the <i>input</i> option method. For every sinlge
  row in the output map(s) all input maps are opened and closed. The amount of
  RAM will rise linear with the number of specified input maps. The input and
  file options are mutually exclusive. Input is a text file with a new line
  separated list of raster map names and optional weights. As separator between
  the map name and the weight the character &quot;|&quot; must be used.
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
Using <i>r.series</i> with wildcards:
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<pre>
r.series input=&quot;`g.list pattern=&#x2019;insitu_data.*&#x2019; sep=,`&quot; \
         output=insitu_data.stddev method=stddev
</pre>
<div class="Pp"></div>
Note the <i>g.list</i> script also supports regular expressions for selecting
  map names.
<div class="Pp"></div>
Using <i>r.series</i> with NULL raster maps (in order to consider a
  &quot;complete&quot; time series):
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<pre>
r.mapcalc &quot;dummy = null()&quot;
r.series in=map2001,map2002,dummy,dummy,map2005,map2006,dummy,map2008 \
         out=res_slope,res_offset,res_coeff meth=slope,offset,detcoeff
</pre>
<div class="Pp"></div>
Example for multiple aggregates to be computed in one run (3 resulting
  aggregates from two input maps):
<div>&#x00A0;</div>
<pre>
r.series in=one,two out=result_avg,res_slope,result_count meth=sum,slope,count
</pre>
<div class="Pp"></div>
Example to use the file option of r.series:
<div>&#x00A0;</div>
<pre>
cat &gt; input.txt &lt;&lt; EOF
map1
map2
map3
EOF
r.series file=input.txt out=result_sum meth=sum
</pre>
<div class="Pp"></div>
Example to use the file option of r.series including weights. The weight 0.75
  should be assigned to map2. As the other maps do not have weights we can leave
  it out:
<div>&#x00A0;</div>
<pre>
cat &gt; input.txt &lt;&lt; EOF
map1
map2|0.75
map3
EOF
r.series file=input.txt out=result_sum meth=sum
</pre>
<div class="Pp"></div>
Example for counting the number of days above a certain temperature using daily
  average maps (&#x2019;???&#x2019; as DOY wildcard):
<div>&#x00A0;</div>
<pre>
# Approach for shell based systems
r.series input=`g.list rast pattern=&quot;temp_2003_???_avg&quot; sep=,` \
         output=temp_2003_days_over_25deg range=25.0,100.0 method=count
# Approach in two steps (e.g., for Windows systems)
g.list rast pattern=&quot;temp_2003_???_avg&quot; output=mapnames.txt
r.series file=mapnames.txt \
         output=temp_2003_days_over_25deg range=25.0,100.0 method=count
</pre>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i></i> <i>g.list,</i> <i>g.region,</i> <i>r.quantile,</i>
  <i>r.series.accumulate,</i> <i>r.series.interp,</i> <i>r.univar</i> <i></i>
<div class="Pp"></div>
Hints for large raster data processing
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Glynn Clements
<div class="Pp"></div>
<i>Last changed: $Date: 2016-01-29 10:29:57 +0100 (Fri, 29 Jan 2016) $</i>
<h1 class="Sh" title="Sh" id="SOURCE_CODE"><a class="selflink" href="#SOURCE_CODE">SOURCE
  CODE</a></h1>
Available at: r.series source code (history)
<div class="Pp"></div>
Main index | Raster index | Topics index | Keywords index | Graphical index |
  Full index
<div class="Pp"></div>
&#x00A9; 2003-2016 GRASS Development Team, GRASS GIS 7.2.0 Reference
  Manual</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os">GRASS 7.2.0</td>
  </tr>
</table>
</body>
</html>
