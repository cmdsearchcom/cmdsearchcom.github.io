<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:35:28 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>REPOSURGEON(1) Development Tools REPOSURGEON(1)</p>

<p style="margin-top: 1em">NAME <br>
reposurgeon - surgical operations on repositories</p>

<p style="margin-top: 1em">SYNOPSIS <br>
reposurgeon [command...]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
The purpose of reposurgeon is to enable risky operations
that VCSes (version-control systems) don&rsquo;t want to let
you do, such as (a) editing past comments and metadata, (b)
<br>
excising commits, (c) coalescing and splitting commits, (d)
removing files and subtrees from repo history, (e) merging
or grafting two or more repos, and (f) cutting a repo in
<br>
two by cutting a parent-child link, preserving the branch
structure of both child repos.</p>

<p style="margin-top: 1em">A major use of reposurgeon is to
assist a human operator to perform higher-quality
conversions among version control systems than can be
achieved with fully automated converters.</p>

<p style="margin-top: 1em">The original motivation for
reposurgeon was to clean up artifacts created by repository
conversions. It was foreseen that the tool would also have
applications when code needs to <br>
be removed from repositories for legal or policy
reasons.</p>

<p style="margin-top: 1em">To keep reposurgeon simple and
flexible, it normally does not do its own repository reading
and writing. Instead, it relies on being able to parse and
emit the command streams <br>
created by git-fast-export and read by git-fast-import. This
means that it can be used on any version-control system that
has both fast-export and fast-import utilities. The <br>
git-import stream format also implicitly defines a common
language of primitive operations for reposurgeon to
speak.</p>

<p style="margin-top: 1em">Fully supported systems (those
for which reposurgeon can both read and write repositories)
include git, hg, bzr, svn, darcs, bk, RCS, and SRC. For a
complete list, with <br>
dependencies and technical notes, type prefer to the
reposurgeon prompt.</p>

<p style="margin-top: 1em">Writing to the file-oriented
systems RCS and SRC is done via rcs-fast-import(1) and has
some serious limitations because those systems cannot
represent all the metadata in a <br>
git-fast-export stream. Consult that tool&rsquo;s
documentation for details and partial workarounds.</p>

<p style="margin-top: 1em">Writing Subversion repositories
also has some significant limitations, discussed in the
section on Working With Subversion.</p>

<p style="margin-top: 1em">Fossil repository files can be
read in using the --format=fossil option of the read command
and written out with the --format=fossil option of the
write. Ignore patterns are not <br>
translated in either direction.</p>

<p style="margin-top: 1em">CVS is supported for read only,
not write. For CVS, reposurgeon must be run from within a
repository directory (one with a CVSROOT subdirectory). Each
module becomes a <br>
subdirectory in the the reposurgeon representation of the
change history.</p>

<p style="margin-top: 1em">In order to deal with
version-control systems that do not have fast-export
equivalents, reposurgeon can also host extractor code that
reads repositories directly. For each <br>
version-control system supported through an extractor,
reposurgeon uses a small amount of knowledge about the
system&rsquo;s command-line tools to (in effect) replay
repository history <br>
into an input stream internally. Repositories under systems
supported through extractors can be read by reposurgeon, but
not modified by it. In particular, reposurgeon can be <br>
used to move a repository history from any VCS supported by
an extractor to any VCS supported by a normal
importer/exporter pair.</p>

<p style="margin-top: 1em">Mercurial repository reading is
implemented with an extractor class; writing is handled with
the stock &quot;hg fastimport&quot; command. A test
extractor exists for git, but is normally <br>
disabled in favor of the regular exporter.</p>

<p style="margin-top: 1em">For guidance on the pragmatics
of repository conversion, see the DVCS Migration
HOWTO[1].</p>

<p style="margin-top: 1em">SAFETY WARNINGS <br>
reposurgeon is a sharp enough tool to cut you. It takes care
not to ever write a repository in an actually inconsistent
state, and will terminate with an error message rather <br>
than proceed when its internal data structures are confused.
However, there are lots of things you can do with it - like
altering stored commit timestamps so they no longer match
<br>
the commit sequence - that are likely to cause havoc after
you&rsquo;re done. Proceed with caution and check your
work.</p>

<p style="margin-top: 1em">Also note that, if your DVCS
does the usual thing of making commit IDs a cryptographic
hash of content and parent links, editing a
publicly-accessible repository with this tool <br>
would be a bad idea. All of the surgical operations in
reposurgeon will modify the hash chains.</p>

<p style="margin-top: 1em">Please also see the notes on
system-specific issues under the section called
&acirc;LIMITATIONS AND GUARANTEES&acirc;.</p>

<p style="margin-top: 1em">OPERATION <br>
The program can be run in one of two modes, either as an
interactive command interpreter or in batch mode to execute
commands given as arguments on the reposurgeon invocation
<br>
line. The only differences between these modes are (1) the
interactive one begins by turning on the &rsquo;verbose
1&rsquo; option, (2) in batch mode all errors (including
normally <br>
recoverable errors in selection-set syntax) are fatal, and
(3) each command-line argument beginning with
&acirc;--&acirc; has that stripped off (which, in particular
means that --help and <br>
--version will work as expected). Also, in interactive mode,
Ctrl-P and Ctrl-N will be available to scroll through your
command history and tab completion of both command <br>
keywords and name arguments (wherever that makes semantic
sense) is available.</p>

<p style="margin-top: 1em">A git-fast-import stream
consists of a sequence of commands which must be executed in
the specified sequence to build the repo; to avoid confusion
with reposurgeon commands we <br>
will refer to the stream commands as events in this
documentation. These events are implicitly numbered from 1
upwards. Most commands require specifying a selection of
event <br>
sequence numbers so reposurgeon will know which events to
modify or delete.</p>

<p style="margin-top: 1em">For all the details of event
types and semantics, see the git-fast-import(1) manual page;
the rest of this paragraph is a quick start for the
impatient. Most events in a stream <br>
are commits describing revision states of the repository;
these group together under a single change comment one or
more fileops (file operations), which usually point to blobs
<br>
that are revision states of individual files. A fileop may
also be a delete operation indicating that a specified
previously-existing file was deleted as part of the version
<br>
commit; there are a couple of other special fileop types of
lesser importance.</p>

<p style="margin-top: 1em">Commands to reposurgeon consist
of a command keyword, sometimes preceded by a selection set,
sometimes followed by whitespace-separated arguments. It is
often possible to omit <br>
the selection-set argument and have it default to something
reasonable.</p>

<p style="margin-top: 1em">Here are some motivating
examples. The commands will be explained in more detail
after the description of selection syntax.</p>

<p style="margin-top: 1em">:15 edit ;; edit the object
associated with mark :15</p>

<p style="margin-top: 1em">edit ;; edit all editable
objects</p>

<p style="margin-top: 1em">29..71 list ;; list summary
index of events 29..71</p>

<p style="margin-top: 1em">236..$ list ;; List events from
236 to the last</p>

<p style="margin-top: 1em">&lt;#523&gt; inspect ;; Look for
commit #523; they are numbered <br>
;; 1-origin from the beginning of the repository.</p>

<p style="margin-top: 1em">&lt;2317&gt; inspect ;; Look for
a tag with the name 2317, a tip commit <br>
;; of a branch named 2317, or a commit with legacy ID <br>
;; 2317. Inspect what is found. A plain number is <br>
;; probably a legacy ID inherited from a Subversion <br>
;; revision number.</p>

<p style="margin-top: 1em">/regression/ list ;; list all
commits and tags with comments or <br>
;; committer headers or author headers containing <br>
;; the string &quot;regression&quot;</p>

<p style="margin-top: 1em">1..:97 &amp; =T delete ;; delete
tags from event 1 to mark 97</p>

<p style="margin-top: 1em">[Makefile] inspect ;; Inspect
all commits with a file op touching Makefile <br>
;; and all blobs referred to in a fileop <br>
;; touching Makefile.</p>

<p style="margin-top: 1em">:46 tip ;; Display the branch
tip that owns commit :46.</p>

<p style="margin-top: 1em">@dsc(:55) list ;; Display all
commits with ancestry tracing to :55</p>

<p style="margin-top: 1em">@min([.gitignore]) remove
.gitignore delete <br>
;; Remove the first .gitignore fileop in the repo.</p>

<p style="margin-top: 1em">SELECTION SYNTAX <br>
The selection-set specification syntax is an
expression-oriented minilanguage. The most basic term in
this language is a location. The following sorts of
primitive locations are <br>
supported:</p>

<p style="margin-top: 1em">event numbers <br>
A plain numeric literal is interpreted as a 1-origin
event-sequence number.</p>

<p style="margin-top: 1em">marks <br>
A numeric literal preceded by a colon is interpreted as a
mark; see the import stream format documentation for
explanation of the semantics of marks.</p>

<p style="margin-top: 1em">tag and branch names <br>
The basename of a branch (including branches in the
refs/tags namespace) refers to its tip commit. The name of a
tag is equivalent to its mark (that of the tag itself, not
<br>
the commit it refers to). Tag and branch locations are
bracketed with &lt; &gt; (angle brackets) to distinguish
them from command keywords.</p>

<p style="margin-top: 1em">legacy IDs <br>
If the contents of name brackets (&lt; &gt;) does not match
a tag or branch name, the interpreter next searches legacy
IDs of commits. This is especially useful when you have <br>
imported a Subversion dump; it means that commits made from
it can be referred to by their corresponding Subversion
revision numbers.</p>

<p style="margin-top: 1em">commit numbers <br>
A numeric literal within name brackets (&lt; &gt;) preceded
by # is interpreted as a 1-origin commit-sequence
number.</p>

<p style="margin-top: 1em">$ <br>
Refers to the last event.</p>

<p style="margin-top: 1em">These may be grouped into sets
in the following ways:</p>

<p style="margin-top: 1em">ranges <br>
A range is two locations separated by &quot;..&quot;, and is
the set of events beginning at the left-hand location and
ending at the right-hand location (inclusive).</p>

<p style="margin-top: 1em">lists <br>
Comma-separated lists of locations and ranges are accepted,
with the obvious meaning.</p>

<p style="margin-top: 1em">There are some other ways to
construct event sets:</p>

<p style="margin-top: 1em">visibility sets <br>
A visibility set is an expression specifying a set of event
types. It will consist of a leading equal sign, followed by
type letters. These are the type letters:</p>


<p style="margin-top: 1em">&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;
<br>
&acirc;B &acirc; blobs &acirc; Most default selection sets
exclude blobs; &acirc; <br>
&acirc; &acirc; &acirc; they have to be manipulated through
the &acirc; <br>
&acirc; &acirc; &acirc; commits they are attached to.
&acirc; <br>

&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;C &acirc; commits &acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;D &acirc; all-delete commits &acirc; These are
artifacts produced by some older &acirc; <br>
&acirc; &acirc; &acirc; repository-conversion tools. &acirc;
<br>

&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;H &acirc; head (branch tip) commits &acirc; &acirc;
<br>

&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;O &acirc; orphaned (parentless) commits &acirc;
&acirc; <br>

&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;U &acirc; commits with callouts as parents &acirc;
&acirc; <br>

&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;Z &acirc; commits with no fileops &acirc; &acirc;
<br>

&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;M &acirc; merge (multi-parent) commits &acirc;
&acirc; <br>

&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;F &acirc; fork (multi-child) commits &acirc; &acirc;
<br>

&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;L &acirc; commits with unclean multi-line comments
&acirc; &acirc; <br>
&acirc; &acirc; (without a separating empty line after the
&acirc; &acirc; <br>
&acirc; &acirc; first) &acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;I &acirc; commits for which metadata cannot be
decoded &acirc; &acirc; <br>
&acirc; &acirc; to UTF-8 &acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;T &acirc; tags &acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;R &acirc; resets &acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;P &acirc; Passthrough &acirc; All event types simply
passed through, &acirc; <br>
&acirc; &acirc; &acirc; including comments, progress
commands, and &acirc; <br>
&acirc; &acirc; &acirc; checkpoint commands. &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;N &acirc; Legacy IDs &acirc; Any string matching a
cookie (legacy-ID) &acirc; <br>
&acirc; &acirc; &acirc; format. &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;</p>

<p style="margin-top: 1em">references <br>
A reference name (bracketed by angle brackets) resolves to a
single object, either a commit or tag.</p>


<p style="margin-top: 1em">&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;
<br>
&acirc; type &acirc; interpretation &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; tag name &acirc; annotated tag with that name
&acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; branch name &acirc; the branch tip commit &acirc;
<br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; legacy ID &acirc; commit with that legacy ID &acirc;
<br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;assigned name &acirc; name equated to a selection by
assign &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;
<br>
Note that if an annotated tag and a branch have the same
name foo, &lt;foo&gt; will resolve to the tag rather than
the branch tip commit.</p>

<p style="margin-top: 1em">dates and action stamps <br>
A date or action stamp in angle brackets resolves to a
selection set of all matching commits.</p>


<p style="margin-top: 1em">&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;
<br>
&acirc; type &acirc; interpretation &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; RFC3339 timestamp &acirc; commit or tag with that
time/date &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; action stamp (timestamp!email) &acirc; commits or
tags with that timestamp and author (or committer &acirc;
<br>
&acirc; &acirc; if no author). &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;yyyy-mm-dd part of RFC3339 timestamp &acirc; all
commits and tags with that date &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;
<br>
To refine the match to a single commit, use a 1-origin index
suffix separated by &rsquo;#&rsquo;. Thus
&quot;&lt;2000-02-06T09:35:10Z&gt;&quot; can match multiple
commits, but &quot;&lt;2000-02-06T09:35:10Z#2&gt;&quot; <br>
matches only the second in the set.</p>

<p style="margin-top: 1em">text search <br>
A text search expression is a Python regular expression
surrounded by forward slashes (to embed a forward slash in
it, use a Python string escape such as f).</p>

<p style="margin-top: 1em">A text search normally matches
against the comment fields of commits and annotated tags, or
against their author/committer names, or against the names
of tags; also the text <br>
of passthrough objects.</p>

<p style="margin-top: 1em">The scope of a text search can
be changed with qualifier letters after the trailing slash.
These are as follows:</p>


<p style="margin-top: 1em">&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;
<br>
&acirc;letter &acirc; interpretation &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; a &acirc; author name in commit &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; b &acirc; branch name in commit; also matches blobs
referenced by &acirc; <br>
&acirc; &acirc; commits on matching branches, and tags which
point to commmits &acirc; <br>
&acirc; &acirc; on patching branches. &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; c &acirc; comment text of commit or tag &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; r &acirc; committish reference in tag or reset
&acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; p &acirc; text in passthrough &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; t &acirc; tagger in tag &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; n &acirc; name of tag &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; B &acirc; blob content &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;
<br>
Multiple qualifier letters can add more search scopes.</p>

<p style="margin-top: 1em">(The &acirc;b&acirc; qualifier
replaces the branchset syntax in earlier versions of
reposurgeon.)</p>

<p style="margin-top: 1em">paths <br>
A &quot;path expression&quot; enclosed in square brackets
resolves to the set of all commits and blobs related to a
path matching the given expression. The path expression
itself is <br>
either a path literal or a regular expression surrounded by
slashes. Immediately after the trailing / of a path regexp
you can put any number of the following characters <br>
which act as flags: &rsquo;a&rsquo;, &rsquo;c&rsquo;,
&rsquo;D&rsquo;, &quot;M&rsquo;, &rsquo;R&rsquo;,
&rsquo;C&rsquo;, &rsquo;N&rsquo;.</p>

<p style="margin-top: 1em">By default, a path is related to
a commit if the latter has a fileop that touches that file
path - modifies that change it, deletes that remove it,
renames and copies that <br>
have it as a source or target. When the &rsquo;c&rsquo; flag
is in use the meaning changes: the paths related to a commit
become all paths that would be present in a checkout for
that <br>
commit.</p>

<p style="margin-top: 1em">A path literal matches a commit
if and only if the path literal is exactly one of the paths
related to the commit (no prefix or suffix operation is
done). In particular a <br>
path literal won&rsquo;t match if it corresponds to a
directory in the chosen repository.</p>

<p style="margin-top: 1em">A regular expression matches a
commit if it matches any path related to the commit anywhere
in the path. You can use &rsquo;^&rsquo; or &rsquo;$&rsquo;
if you want the expression to only match at <br>
the beginning or end of paths. When the &rsquo;a&rsquo; flag
is in use, the path expression selects commits whose every
path matches the regular expression. This is not always a
subset <br>
of commits selected without the &rsquo;a&rsquo; flag because
it also selects commits with no related paths (e.g. empty
commits, deletealls and commits with empty trees). If you
want to <br>
avoid those, you can use e.g. &rsquo;[/regex/] &amp;
[/regex/a]&rsquo;.</p>

<p style="margin-top: 1em">The flags &rsquo;D&rsquo;,
&quot;M&rsquo;, &rsquo;R&rsquo;, &rsquo;C&rsquo;,
&rsquo;N&rsquo; restrict match checking to the corresponding
fileop types. Note that this means an &rsquo;a&rsquo; match
is easier (not harder) to achieve. These are <br>
no-iops when used with &rsquo;c&rsquo;.</p>

<p style="margin-top: 1em">A path or literal matches a blob
if it matches any path that appeared in a modification
fileop that referred to that blob. To select purely matching
blobs or matching <br>
commits, compose a path expression with =B or =C.</p>

<p style="margin-top: 1em">If you need to embed
&rsquo;[^/]&rsquo; into your regular expression (e.g. to
express &quot;all characters but a slash&quot;) you can use
a Python string escape such as f.</p>

<p style="margin-top: 1em">function calls <br>
The expression language has named special functions. The
sequence for a named function is &acirc;@&acirc; followed by
a function name, followed by an argument in parentheses.
Presently <br>
the following functions are defined:</p>


<p style="margin-top: 1em">&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;
<br>
&acirc;name &acirc; interpretation &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;min &acirc; minimum member of a selection set &acirc;
<br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;max &acirc; maximum member of a selection set &acirc;
<br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;amp &acirc; nonempty selection set becomes all
objects, empty set is &acirc; <br>
&acirc; &acirc; returned empty &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;par &acirc; all parents of commits in the argument
set &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;chn &acirc; all children of commits in the argument
set &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;dsc &acirc; all commits descended from the argument
set (argument set &acirc; <br>
&acirc; &acirc; included) &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;anc &acirc; all commits whom the argument set is
descended from (argument &acirc; <br>
&acirc; &acirc; set included) &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;pre &acirc; events before the argument set; empty if
the argument set &acirc; <br>
&acirc; &acirc; includes the first event. &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;suc &acirc; events after the argument set; empty if
the argument set &acirc; <br>
&acirc; &acirc; includes the last event. &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;srt &acirc; sort the argument set by event number.
&acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;</p>

<p style="margin-top: 1em">Set expressions may be combined
with the operators | and &amp;; these are, respectively, set
union and intersection. The | has lower precedence than
intersection, but you may use <br>
parentheses &rsquo;(&rsquo; and &rsquo;)&rsquo; to group
expressions in case there is ambiguity (this replaces the
curly brackets used in older versions of the syntax).</p>

<p style="margin-top: 1em">Any set operation may be
followed by &rsquo;?&rsquo; to add the set members&rsquo;
neighbors and referents. This extends the set to include the
parents and children of all commits in the set, and <br>
the referents of any tags and resets in the set. Each blob
reference in the set is replaced by all commit events that
refer to it. The &rsquo;?&rsquo; can be repeated to extend
the <br>
neighborhood depth.</p>

<p style="margin-top: 1em">Do set negation with prefix ~;
it has higher precedence than &amp; and | but lower than
?</p>

<p style="margin-top: 1em">IMPORT AND EXPORT <br>
reposurgeon can hold multiple repository states in core.
Each has a name. At any given time, one may be selected for
editing. Commands in this group import repositories, export
<br>
them, and manipulate the in-core list and the selection.</p>

<p style="margin-top: 1em">read [--format=fossil]
[directory|-|&lt;infile] <br>
With a directory-name argument, this command attempts to
read in the contents of a repository in any supported
version-control system under that directory; read with no
<br>
arguments does this in the current directory. If output is
redirected to a plain file, it will be read in as a
fast-import stream or Subversion dumpfile. With an argument
of <br>
&acirc;-&acirc;, this command reads a fast-import stream or
Subversion dumpfile from standard input (this will be useful
in filters constructed with command-line arguments).</p>

<p style="margin-top: 1em">If the contents is a fast-import
stream, any &quot;cvs-revision&quot; property on a commit is
taken to be a newline-separated list of CVS revision cookies
pointing to the commit, and <br>
used for reference lifting.</p>

<p style="margin-top: 1em">If the contents is a fast-import
stream, any &quot;legacy-id&quot; property on a commit is
taken to be a legacy ID token pointing to the commit, and
used for reference-lifting.</p>

<p style="margin-top: 1em">If the read location is a git
repository and contains a .git/cvsauthors file (such as is
left in place by git cvsimport -A) that file will be read in
as if it had been given <br>
to the authors read command.</p>

<p style="margin-top: 1em">If the read location is a
directory, and its repository subdirectory has a file named
legacy-map, that file will be read as though passed to a
legacy read command.</p>

<p style="margin-top: 1em">If the read location is a file
and the --format=fossil is used, the file is interpreted as
a Fossil repository.</p>

<p style="margin-top: 1em">The just-read-in repo is added
to the list of loaded repositories and becomes the current
one, selected for surgery. If it was read from a plain file
and the file name ends <br>
with one of the extensions .fi or .svn, that extension is
removed from the load list name.</p>

<p style="margin-top: 1em">Note: this command does not take
a selection set.</p>

<p style="margin-top: 1em">write [--legacy]
[--format=fossil] [--noincremental] [--callout]
[&gt;outfile|-] <br>
Dump selected events as a fast-import stream representing
the edited repository; the default selection set is all
events. Where to dump to is standard output if there is no
<br>
argument or the argument is &rsquo;-&rsquo;, or the target
of an output redirect.</p>

<p style="margin-top: 1em">Alternatively, if there is no
redirect and the argument names a directory, the repository
is rebuilt into that directory, with any selection set being
ignored; if that target <br>
directory is nonempty its contents are backed up to a save
directory.</p>

<p style="margin-top: 1em">If the write location is a file
and the --format=fossil is used, the file is written in
Fossil repository format.</p>

<p style="margin-top: 1em">With the --legacy option, the
Legacy-ID of each commit is appended to its commit comment
at write time. This option is mainly useful for debugging
conversion edge cases.</p>

<p style="margin-top: 1em">If you specify a partial
selection set such that some commits are included but their
parents are not, the output will include incremental dump
cookies for each branch with an <br>
origin outside the selection set, just before the first
reference to that branch in a commit. An incremental dump
cookie looks like &quot;refs/heads/foo^0&quot; and is a clue
to <br>
export-stream loaders that the branch should be glued to the
tip of a pre-existing branch of the same name. The
--noincremental option suppresses this behavior.</p>

<p style="margin-top: 1em">When you specify a partial
selection set, including a commit object forces the
inclusion of every blob to which it refers and every tag
that refers to it.</p>

<p style="margin-top: 1em">Specifying a partial selection
may cause a situation in which some parent marks in merges
don&rsquo;t correspond to commits present in the dump. When
this happens and --callout <br>
option was specified, the write code replaces the merge mark
with a callout, the action stamp of the parent commit;
otherwise the parent mark is omitted. Importers will fail
<br>
when reading a stream dump with callouts; it is intended to
be used by the graft command.</p>

<p style="margin-top: 1em">Specifying a write selection set
with gaps in it is allowed but unlikely to lead to good
results if it is loaded by an importer.</p>

<p style="margin-top: 1em">Property extensions will be be
omitted from the output if the importer for the preferred
repository type cannot digest them.</p>

<p style="margin-top: 1em">Note: to examine small groups of
commits without the progress meter, use inspect.</p>

<p style="margin-top: 1em">choose [reponame] <br>
Choose a named repo on which to operate. The name of a repo
is normally the basename of the directory or file it was
loaded from, but repos loaded from standard input are <br>
&quot;unnamed&quot;. reposurgeon will add a disambiguating
suffix if there have been multiple reads from the same
source.</p>

<p style="margin-top: 1em">With no argument, lists the
names of the currently stored repositories and their load
times. The second column is &rsquo;*&rsquo; for the
currently selected repository, &rsquo;-&rsquo; for
others.</p>

<p style="margin-top: 1em">drop [reponame] <br>
Drop a repo named by the argument from reposurgeon&rsquo;s
list, freeing the memory used for its metadata and deleting
on-disk blobs. With no argument, drops the currently chosen
<br>
repo.</p>

<p style="margin-top: 1em">rename reponame <br>
Rename the currently chosen repo; requires an argument.
Won&rsquo;t do it if there is already one by the new
name.</p>

<p style="margin-top: 1em">REBUILDS IN PLACE <br>
reposurgeon can rebuild an altered repository in place.
Untracked files are normally saved and restored when the
contents of the new repository is checked out (but see the
<br>
documentation of the &acirc;preserve&acirc; command for a
caveat).</p>

<p style="margin-top: 1em">rebuild [directory] <br>
Rebuild a repository from the state held by reposurgeon.
This command does not take a selection set.</p>

<p style="margin-top: 1em">The single argument, if present,
specifies the target directory in which to do the rebuild;
if the repository read was from a repo directory (and not a
git-import stream), it <br>
defaults to that directory. If the target directory is
nonempty its contents are backed up to a save directory.
Files and directories on the repository&rsquo;s preserve
list are <br>
copied back from the backup directory after repo rebuild.
The default preserve list depends on the repository type,
and can be displayed with the stats command.</p>

<p style="margin-top: 1em">If reposurgeon has a nonempty
legacy map, it will be written to a file named legacy-map in
the repository subdirectory as though by a legacy write
command. (This will <br>
normally be the case for Subversion and CVS
conversions.)</p>

<p style="margin-top: 1em">preserve [file...] <br>
Add (presumably untracked) files or directories to the
repo&rsquo;s list of paths to be restored from the backup
directory after a rebuild. Each argument, if any, is
interpreted as <br>
a pathname. The current preserve list is displayed
afterwards.</p>

<p style="margin-top: 1em">It is only necessary to use this
feature if your version-control system lacks a command to
list files under version control. Under systems with such a
command (which include <br>
git and hg), all files that are neither beneath the
repository dot directory nor under reposurgeon temporary
directories are preserved automatically.</p>

<p style="margin-top: 1em">unpreserve [file...] <br>
Remove (presumably untracked) files or directories to the
repo&rsquo;s list of paths to be restored from the backup
directory after a rebuild. Each argument, if any, is
interpreted <br>
as a pathname. The current preserve list is displayed
afterwards.</p>

<p style="margin-top: 1em">INFORMATION AND REPORTS <br>
Commands in this group report information about the selected
repository.</p>

<p style="margin-top: 1em">The output of these commands can
individually be redirected to a named output file. Where
indicated in the syntax, you can prefix the output filename
with &acirc;&gt;&acirc; and give it as a <br>
following argument. If you use &acirc;&gt;&gt;&acirc; the
file is opened for append rather than write.</p>

<p style="margin-top: 1em">list [&gt;outfile] <br>
This is the main command for identifying the events you want
to modify. It lists commits in the selection set by event
sequence number with summary information. The first <br>
column is raw event numbers, the second a timestamp in local
time. If the repository has legacy IDs, they will be
displayed in the third column. The leading portion of the
<br>
comment follows.</p>

<p style="margin-top: 1em">stamp [&gt;outfile] <br>
Alternative form of listing that displays full action
stamps, usable as references in selections. Supports &gt;
redirection.</p>

<p style="margin-top: 1em">tip [&gt;outfile] <br>
Display the branch tip names associated with commits in the
selection set. These will not necessarily be the same as
their branch fields (which will often be tag names if the
<br>
repo contains either annotated or lightweight tags).</p>

<p style="margin-top: 1em">If a commit is at a branch tip,
its tip is its branch name. If it has only one child, its
tip is the child&rsquo;s tip. If it has multiple children,
then if there is a child with a <br>
matching branch name its tip is the child&rsquo;s tip.
Otherwise this function throws a recoverable error.</p>

<p style="margin-top: 1em">tags [&gt;outfile] <br>
Display tags and resets: three fields, an event number and a
type and a name. Branch tip commits associated with tags are
also displayed with the type field &rsquo;commit&rsquo;.
<br>
Supports &gt; redirection.</p>

<p style="margin-top: 1em">stats [repo-name...]
[&gt;outfile] <br>
Report size statistics and import/export method information
about named repositories, or with no argument the currently
chosen repository.</p>

<p style="margin-top: 1em">count [&gt;outfile] <br>
Report a count of items in the selection set. Default set is
everything in the currently-selected repo. Supports &gt;
redirection.</p>

<p style="margin-top: 1em">inspect [&gt;outfile] <br>
Dump a fast-import stream representing selected events to
standard output. Just like a write, except (1) the progress
meter is disabled, and (2) there is an identifying <br>
header before each event dump.</p>

<p style="margin-top: 1em">graph [&gt;outfile] <br>
Emit a visualization of the commit graph in the DOT markup
language used by the graphviz tool suite. This can be fed as
input to the main graphviz rendering program dot(1), <br>
which will yield a viewable image. Supports &gt;
redirection.</p>

<p style="margin-top: 1em">You may find a script like this
useful:</p>

<p style="margin-top: 1em">graph $1 &gt;/tmp/foo$$ <br>
shell dot &lt;/tmp/foo$$ -Tpng | display -; rm
/tmp/foo$$</p>

<p style="margin-top: 1em">You can substitute in your own
preferred image viewer, of course.</p>

<p style="margin-top: 1em">sizes [&gt;outfile] <br>
Print a report on data volume per branch; takes a selection
set, defaulting to all events. The numbers tally the size of
uncompressed blobs, commit and tag comments, and <br>
other metadata strings (a blob is counted each time a commit
points at it).</p>

<p style="margin-top: 1em">The numbers are not an exact
measure of storage size: they are intended mainly as a way
to get information on how to efficiently partition a
repository that has become large <br>
enough to be unwieldy.</p>

<p style="margin-top: 1em">Supports &gt; redirection.</p>

<p style="margin-top: 1em">lint [&gt;outfile] <br>
Look for DAG and metadata configurations that may indicate a
problem. Presently checks for: (1) Mid-branch deletes, (2)
disconnected commits, (3) parentless commits, (4) the <br>
existence of multiple roots, (5) committer and author IDs
that don&rsquo;t look well-formed as DVCS IDs, (6) multiple
child links with identical branch labels descending from the
<br>
same commit, (7) time and action-stamp collisions.</p>

<p style="margin-top: 1em">Options to issue only partial
reports are supported; &quot;lint --options&quot; or
&quot;lint -?&quot; lists them.</p>

<p style="margin-top: 1em">The options and output format of
this command are unstable; they may change without notice as
more sanity checks are added.</p>

<p style="margin-top: 1em">when &gt;timespec <br>
Interconvert between git timestamps (integer Unix time plus
TZ) and RFC3339 format. Takes one argument, autodetects the
format. Useful when eyeballing export streams. Also <br>
accepts any other supported date format and converts to
RFC3339.</p>

<p style="margin-top: 1em">SURGICAL OPERATIONS <br>
These are the operations the rest of reposurgeon is designed
to support.</p>

<p style="margin-top: 1em">squash [policy...] <br>
Combine or delete commits in a selection set of events. The
default selection set for this command is empty. Has no
effect on events other than commits unless the --delete <br>
policy is selected; see the &rsquo;delete&rsquo; command for
discussion.</p>

<p style="margin-top: 1em">Normally, when a commit is
squashed, its file operation list (and any associated blob
references) gets either prepended to the beginning of the
operation list of each of the <br>
commit&rsquo;s children or appended to the operation list of
each of the commit&rsquo;s parents. Then children of a
deleted commit get it removed from their parent set and its
parents <br>
added to their parent set.</p>

<p style="margin-top: 1em">The default is to squash
forward, modifying children; but see the list of policy
modifiers below for how to change this.</p>

<p style="margin-top: 1em">Warning <br>
It is easy to get the bounds of a squash command wrong, with
confusing and destructive results. Beware thinking you can
squash on a selection set to merge all commits <br>
except the last one into the last one; what you will
actually do is to merge all of them to the first commit
after the selected set. <br>
Normally, any tag pointing to a combined commit will also be
pushed forward. But see the list of policy modifiers below
for how to change this.</p>

<p style="margin-top: 1em">Following all operation moves,
every one of the altered file operation lists is reduced to
a shortest normalized form. The normalized form detects
various combinations of <br>
modification, deletion, and renaming and simplifies the
operation sequence as much as it can without losing any
information.</p>

<p style="margin-top: 1em">After canonicalization, a file
op list may still end up containing multiple M operations on
the same file. Normally the tool utters a warning when this
occurs but does not <br>
try to resolve it.</p>

<p style="margin-top: 1em">The following modifiers change
these policies:</p>

<p style="margin-top: 1em">--delete <br>
Simply discards all file ops and tags associated with
deleted commit(s).</p>

<p style="margin-top: 1em">--coalesce <br>
Discard all M operations (and associated blobs) except the
last.</p>

<p style="margin-top: 1em">--pushback <br>
Append fileops to parents, rather than prepending to
children.</p>

<p style="margin-top: 1em">--pushforward <br>
Prepend fileops to children. This is the default; it can be
specified in a lift script for explicitness about
intentions.</p>

<p style="margin-top: 1em">--tagforward <br>
With the &quot;tagforward&quot; modifier, any tag on the
deleted commit is pushed forward to the first child rather
than being deleted. This is the default; it can be specified
for <br>
explicitness.</p>

<p style="margin-top: 1em">--tagback <br>
With the &quot;--tagback&quot; modifier, any tag on the
deleted commit is pushed backward to the first parent rather
than being deleted.</p>

<p style="margin-top: 1em">--quiet <br>
Suppresses warning messages about deletion of commits with
non-delete fileops.</p>

<p style="margin-top: 1em">--complain <br>
The opposite of quiet. Can be specified for
explicitness.</p>

<p style="margin-top: 1em">Under any of these policies
except &acirc;--delete&acirc;, deleting a commit that has
children does not back out the changes made by that commit,
as they will still be present in the <br>
blobs attached to versions past the end of the deletion set.
All a delete does when the commit has children is lose the
metadata information about when and by who those <br>
changes were actually made; after the delete any such
changes will be attributed to the first undeleted children
of the deleted commits. It is expected that this command
will <br>
be useful mainly for removing commits mechanically generated
by repository converters such as cvs2svn.</p>

<p style="margin-top: 1em">delete [policy...] <br>
Delete a selection set of events. The default selection set
for this command is empty. On a set of commits, this is
equivalent to a squash with the --delete flag. It <br>
unconditionally deletes tags, resets, and passthroughs;
blobs can be removed only as a side effect of deleting every
commit that points at them.</p>

<p style="margin-top: 1em">divide parent [child] <br>
Attempt to partition a repo by cutting the parent-child link
between two specified commits (they must be adjacent). Does
not take a general selection set. It is only <br>
necessary to specify the parent commit, unless it has
multiple children in which case the child commit must follow
(separate it with a comma).</p>

<p style="margin-top: 1em">If the repo was named
&rsquo;foo&rsquo;, you will normally end up with two repos
named &rsquo;foo-early&rsquo; and &rsquo;foo-late&rsquo;
(option and feature events at the beginning of the early
segment will be <br>
duplicated onto the beginning of the late one.). But if the
commit graph would remain connected through another path
after the cut, the behavior changes. In this case, if the
<br>
parent and child were on the same branch &rsquo;qux&rsquo;,
the branch segments are renamed &rsquo;qux-early&rsquo; and
&rsquo;qux-late&rsquo; but the repo is not divided.</p>

<p style="margin-top: 1em">expunge [--notagify] [path |
/regexp/]... <br>
Expunge files from the selected portion of the repo history;
the default is the entire history. The arguments to this
command may be paths or Python regular expressions <br>
matching paths (regexps must be marked by being surrounded
with //).</p>

<p style="margin-top: 1em">All filemodify (M) operations
and delete (D) operations involving a matched file in the
selected set of events are disconnected from the repo and
put in a removal set. <br>
Renames are followed as the tool walks forward in the
selection set; each triggers a warning message. If a
selected file is a copy (C) target, the copy will be deleted
and a <br>
warning message issued. If a selected file is a copy source,
the copy target will be added to the list of paths to be
deleted and a warning issued.</p>

<p style="margin-top: 1em">After file expunges have been
performed, any commits with no remaining file operations
will be removed, and any tags pointing to them. By default
each deleted commit is <br>
replaced with a tag of the form
&rsquo;emptycommit-ident&rsquo; on the preceding commit
unless --notagify is specified as an argument. Commits with
deleted fileops pointing both in and <br>
outside the path set are not deleted, but are cloned into
the removal set.</p>

<p style="margin-top: 1em">The removal set is not
discarded. It is assembled into a new repository named after
the old one with the suffix &quot;-expunges&quot; added.
Thus, this command can be used to carve a <br>
repository into sections by file path matches.</p>

<p style="margin-top: 1em">tagify [--canonicalize]
[--tipdeletes] [--tagify-merges] <br>
Search for empty commits and turn them into tags. Takes an
optional selection set argument defaulting to all commits.
For each commit in the selection set, turn it into a tag
<br>
with the same message and author information if it has no
fileops. By default merge commits are not considered, even
if they have no fileops (thus no tree differences with <br>
their first parent). To change that, use the --tagify-merges
option.</p>

<p style="margin-top: 1em">The name of the generated tag
will be &rsquo;emptycommit-ident&rsquo;, where ident is
generated from the legacy ID of the deleted commit, or from
its mark, or from its index in the <br>
repository, with a disambiguation suffix if needed.</p>

<p style="margin-top: 1em">With the --canonicalize, tagify
tries harder to detect trivial commits by first ensuring
that all fileops of selected commits will have an actual
effect when processed by <br>
fast-import.</p>

<p style="margin-top: 1em">With the --tipdeletes, tagify
also considers branch tips with only deleteall fileops to be
candidates for tagification. The corresponding tags get
names of the form <br>
&rsquo;tipdelete-branchname&rsquo; rather than the default
&rsquo;emptycommit-ident&rsquo;.</p>

<p style="margin-top: 1em">With the --tagify-merges, tagify
also tagifies merge commits that have no fileops. When this
is done the merge link is move to the yagified
commit&rsquo;s parent.</p>

<p style="margin-top: 1em">coalesce [--debug|--changelog]
[timefuzz] <br>
Scan the selection set for runs of commits with identical
comments close to each other in time (this is a common form
of scar tissues in repository up-conversions from older <br>
file-oriented version-control systems). Merge these cliques
by deleting all but the last commit, in order; fileops from
the deleted commits are pushed forward to that last <br>
one</p>

<p style="margin-top: 1em">The optional second argument, if
present, is a maximum time separation in seconds; the
default is 90 seconds.</p>

<p style="margin-top: 1em">The default selection set for
this command is =C, all commits. Occasionally you may want
to restrict it, for example to avoid coalescing unrelated
cliques of &quot;*** empty log <br>
message ***&quot; commits from CVS lifts.</p>

<p style="margin-top: 1em">With the --debug option, show
messages about mismatches.</p>

<p style="margin-top: 1em">With the --changelog option, any
commit with a comment containing the string &rsquo;empty log
message&rsquo; (such as is generated by CVS) and containing
exactly one file operation <br>
modifying a path ending in ChangeLog is treated specially.
Such ChangeLog commits are considered to match any commit
before them by content, and will coalesce with it if the
<br>
committer matches and the commit separation is small enough.
This option handles a convention used by Free Software
Foundation projects.</p>

<p style="margin-top: 1em">split {at|by} item <br>
The first argument is required to be a commit location; the
second is a preposition which indicates which splitting
method to use. If the preposition is &rsquo;at&rsquo;, then
the third <br>
argument must be an integer 1-origin index of a file
operation within the commit. If it is &rsquo;by&rsquo;, then
the third argument must be a pathname to be prefix-matched,
pathname <br>
match is done first).</p>

<p style="margin-top: 1em">The commit is copied and
inserted into a new position in the event sequence,
immediately following itself; the duplicate becomes the
child of the original, and replaces it as <br>
parent of the original&rsquo;s children. Commit metadata is
duplicated; the new commit then gets a new mark. If the new
commit has a legacy ID, the suffix &rsquo;.split&rsquo; is
appended to <br>
it.</p>

<p style="margin-top: 1em">Finally, some file operations -
starting at the one matched or indexed by the split argument
- are moved forward from the original commit into the new
one. Legal indices are <br>
2-n, where n is the number of file operations in the
original commit.</p>

<p style="margin-top: 1em">add {D path | M perm mark path |
R source target | C source target} <br>
To a specified commit, add a specified fileop.</p>

<p style="margin-top: 1em">For a D operation to be valid
there must be an M operation for the path in the
commit&rsquo;s ancestry. For an M operation to be valid, the
&rsquo;perm&rsquo; part must be a token ending with <br>
755 or 644 and the &rsquo;mark&rsquo; must refer to a blob
that precedes the commit location. For an R or C operation
to be valid, there must be an M operation for the source in
the <br>
commit&rsquo;s ancestry.</p>

<p style="margin-top: 1em">remove [index | path | deletes]
[to commit] <br>
From a specified commit, remove a specified fileop. The op
must be one of (a) the keyword &acirc;deletes&acirc;, (b) a
file path, (c) a file path preceded by an op type set (some
subset <br>
of the letters DMRCN), or (d) a 1-origin numeric index. The
&acirc;deletes&acirc; keyword selects all D fileops in the
commit; the others select one each.</p>

<p style="margin-top: 1em">If the &acirc;to&acirc; clause
is present, the removed op is appended to the commit
specified by the following singleton selection set. This
option cannot be combined with &acirc;deletes&acirc;.</p>

<p style="margin-top: 1em">Note that this command does not
attempt to scavenge blobs even if the deleted fileop might
be the only reference to them. This behavior may change in a
future release.</p>

<p style="margin-top: 1em">blob <br>
Create a blob at mark :1 after renumbering other marks
starting from :2. Data is taken from stdin, which may be a
here-doc. This can be used with the add command to patch
<br>
synthetic data into a repository.</p>

<p style="margin-top: 1em">renumber <br>
Renumber the marks in a repository, from :1 up to :&lt;n&gt;
where &lt;n&gt; is the count of the last mark. Just in case
an importer ever cares about mark ordering or gaps in the
<br>
sequence.</p>

<p style="margin-top: 1em">A side effect of this comment is
to clean up stray &quot;done&quot; passthroughs that may
have entered the repository via graft operations. After a
renumber, the repository will have <br>
at most one &quot;done&quot; and it will be at the end of
the events.</p>

<p style="margin-top: 1em">mailbox_out [&gt;outfile] <br>
Emit a mailbox file of messages in RFC822 format
representing the contents of repository metadata. Takes a
selection set; members of the set other than commits,
annotated <br>
tags, and passthroughs are ignored (that is, presently,
blobs and resets).</p>

<p style="margin-top: 1em">The output from this command can
optionally be redirected to a named output file. Prefix the
filename with &acirc;&gt;&acirc; and give it as a following
argument.</p>

<p style="margin-top: 1em">May have an option --filter,
followed by = and a /-enclosed regular expression. If this
is given, only headers with names matching it are emitted.
In this context the name of <br>
the header includes its trailing colon.</p>

<p style="margin-top: 1em">mailbox_in [&lt;infile]
[--changed &gt;outfile] <br>
Accept a mailbox file of messages in RFC822 format
representing the contents of the metadata in selected
commits and annotated tags. Takes no selection set. If there
is an <br>
argument it will be taken as the name of a mailbox file to
read from; no argument, or one of &rsquo;-&rsquo;; reads
from standard input.</p>

<p style="margin-top: 1em">Users should be aware that
modifying an Event-Number or Event-Mark field will change
which event the update from that message is applied to. This
is unlikely to have good <br>
results.</p>

<p style="margin-top: 1em">If the Event-Number and
Event-Mark fields are absent, the mailbox_in logic will
attempt to match the commit or tag first by Legacy-ID, then
by a unique committer ID and <br>
timestamp pair.</p>

<p style="margin-top: 1em">If output is redirected and the
modifier &acirc;--changed&acirc; appears, a minimal set of
modifications actually made is written to the output file in
a form that can be fed back in.</p>

<p style="margin-top: 1em">setfield attribute value <br>
In the selected objects (defaulting to none) set every
instance of a named field to a string value. The string may
be quoted to include whitespace, and use backslash escapes
<br>
interpreted by the Python string-escape codec, such as and
.</p>

<p style="margin-top: 1em">Attempts to set nonexistent
attributes are ignored. Valid values for the attribute are
internal Python field names; in particular, for commits,
&acirc;comment&acirc; and &acirc;branch&acirc; are <br>
legal. Consult the source code for other interesting
values.</p>

<p style="margin-top: 1em">append [--rstrip] [&gt;text]
<br>
Append text to the comments of commits and tags in the
specified selection set. The text is the first token of the
command and may be a quoted string. C-style escape <br>
sequences in the string are interpreted using Python&rsquo;s
string_decode codec.</p>

<p style="margin-top: 1em">If the option --rstrip is given,
the comment is right-stripped before the new text is
appended.</p>

<p style="margin-top: 1em">filter
[--shell|--regex|--replace|--dedos] <br>
Run blobs, commit comments, or tag comments in the selection
set through the filter specified on the command line.</p>

<p style="margin-top: 1em">In any mode other than --dedos,
attempting to specify a selection set including both blobs
and non-blobs (that is, commits or tags) throws an error.
Inline content in commits <br>
is filtered when the selection set contains (only) blobs and
the commit is within the range bounded by the earliest and
latest blob in the specification.</p>

<p style="margin-top: 1em">When filtering blobs, if the
command line contains the magic cookie &rsquo;%PATHS%&rsquo;
it is replaced with a space-separated list of all paths that
reference the blob.</p>

<p style="margin-top: 1em">With --shell, the remainder of
the line specifies a filter as a shell command. Each blob or
comment is presented to the filter on standard input; the
content is replaced with <br>
whatever the filter emits to standard output.</p>

<p style="margin-top: 1em">With --regex, the remainder of
the line is expected to be a Python regular expression
substitution written as /from/to/ with from and to being
passed as arguments to the <br>
standard re.sub() function and it applied to modify the
content. Actually, any non-space character will work as a
delimiter in place of the /; this makes it easier to use /
<br>
in patterns. Ordinarily only the first such substitution is
performed; putting &rsquo;g&rsquo; after the slash replaces
globally, and a numeric literal gives the maximum number of
<br>
substitutions to perform. Other flags available restrict
substitution scope - &rsquo;c&rsquo; for comment text only,
&rsquo;C&rsquo; for committer name only, &rsquo;a&rsquo; for
author names only. Note that <br>
parsing of a --regex argument will be confused by ant
substring consisting of whitespace followed by #; use
&quot;ather than whitespace to avoid this.</p>

<p style="margin-top: 1em">With --replace, the behavior is
like --regexp but the expressions are not interpreted as
regular expressions. (This is slightly faster). line
terminators are</p>

<p style="margin-top: 1em">With --dedos, DOS/Windows-style
replaced with 0</p>

<p style="margin-top: 1em">transcode codec <br>
Transcode blobs, commit comments and committer/author names,
or tag comments and tag committer names in the selection set
to UTF-8 from the character encoding specified on <br>
the command line.</p>

<p style="margin-top: 1em">Attempting to specify a
selection set including both blobs and non-blobs (that is,
commits or tags) throws an error. Inline content in commits
is filtered when the selection <br>
set contains (only) blobs and the commit is within the range
bounded by the earliest and latest blob in the
specification.</p>

<p style="margin-top: 1em">The encoding argument must name
one of the codecs known to the Python standard codecs
library. In particular, &rsquo;latin-1&rsquo; is a valid
codec name.</p>

<p style="margin-top: 1em">Errors in this command are
fatal, because an error may leave repository objects in a
damaged state.</p>

<p style="margin-top: 1em">The theory behind the design of
this command is that the repository might contain a mixture
of encodings used to enter commit metadata by different
people at different times. <br>
After using =I to identify metadata containing non-Unicode
high bytes in text, a human must use context to identify
which particular encodings were used in particular event
<br>
spans and compose appropriate transcode commands to fix them
up.</p>

<p style="margin-top: 1em">edit <br>
Report the selection set of events to a tempfile as
mailbox_out does, call an editor on it, and update from the
result as mailbox_in does. If you do not specify an editor
<br>
name as second argument, it will be taken from the $EDITOR
variable in your environment.</p>

<p style="margin-top: 1em">Normally this command ignores
blobs because mailbox_out does. However, if you specify a
selection set consisting of a single blob, your editor will
be called directly on the <br>
blob file.</p>

<p style="margin-top: 1em">timeoffset offset [timezone]
<br>
Apply a time offset to all time/date stamps in the selected
set. An offset argument is required; it may be in the form
[+-]ss, [+-]mm:ss or [+-]hh:mm:ss. The leading sign is <br>
required to distinguish it from a selection expression.</p>

<p style="margin-top: 1em">Optionally you may also specify
another argument in the form [+-]hhmm, a timezone literal to
apply. To apply a timezone without an offset, use an offset
literal of +0 or -0.</p>

<p style="margin-top: 1em">unite [--prune] reponame... <br>
Unite repositories. Name any number of loaded repositories;
they will be united into one union repo and removed from the
load list. The union repo will be selected.</p>

<p style="margin-top: 1em">The root of each repo (other
than the oldest repo) will be grafted as a child to the last
commit in the dump with a preceding commit date. This will
produce a union <br>
repository with one branch for each part. Running last to
first, duplicate tag and branch names will be disambiguated
using the source repository name (thus, recent <br>
duplicates will get priority over older ones). After all
grafts, marks will be renumbered.</p>

<p style="margin-top: 1em">The name of the new repo will be
the names of all parts concatenated, separated by
&rsquo;+&rsquo;. It will have no source directory or
preferred system type.</p>

<p style="margin-top: 1em">With the option --prune, at each
join D operations for every ancestral file existing will be
prepended to the root commit, then it will be canonicalized
using the rules for <br>
squashing the effect will be that only files with properly
matching M, R, and C operations in the root survive.</p>

<p style="margin-top: 1em">graft [--prune] reponame <br>
For when unite doesn&rsquo;t give you enough control. This
command may have either of two forms, selected by the size
of the selection set. The first argument is always required
to <br>
be the name of a loaded repo.</p>

<p style="margin-top: 1em">If the selection set is of size
1, it must identify a single commit in the currently chosen
repo; in this case the name repo&rsquo;s root will become a
child of the specified <br>
commit. If the selection set is empty, the named repo must
contain one or more callouts matching a commits in the
currently chosen repo.</p>

<p style="margin-top: 1em">Labels and branches in the named
repo are prefixed with its name; then it is grafted to the
selected one. Any other callouts in the named repo are also
resolved in the <br>
context of the currently chosen one. Finally, the named repo
is removed from the load list.</p>

<p style="margin-top: 1em">With the option --prune, prepend
a deleteall operation into the root of the grafted
repository.</p>

<p style="margin-top: 1em">path [source] rename [--force]
[target] <br>
Rename a path in every fileop of every selected commit. The
default selection set is all commits. The first argument is
interpreted as a Python regular expression to match <br>
against paths; the second may contain back-reference
syntax.</p>

<p style="margin-top: 1em">Ordinarily, if the target path
already exists in the fileops, or is visible in the ancestry
of the commit, this command throws an error. With the
--force option, these checks <br>
are skipped.</p>

<p style="margin-top: 1em">paths [{sub|sup}] [dirname]
[&gt;outfile] <br>
Takes a selection set. Without a modifier, list all paths
touched by fileops in the selection set (which defaults to
the entire repo). This reporting variant does <br>
&gt;-redirection.</p>

<p style="margin-top: 1em">With the &rsquo;sub&rsquo;
modifier, take a second argument that is a directory name
and prepend it to every path. With the &rsquo;sup&rsquo;
modifier, strip any directory argument from the start of
<br>
the path if it appears there; with no argument, strip the
first directory component from every path.</p>

<p style="margin-top: 1em">merge <br>
Create a merge link. Takes a selection set argument,
ignoring all but the lowest (source) and highest (target)
members. Creates a merge link from the highest member
(child) <br>
to the lowest (parent).</p>

<p style="margin-top: 1em">unmerge <br>
Linearize a commit. Takes a selection set argument, which
must resolve to a single commit, and removes all its parents
except for the first.</p>

<p style="margin-top: 1em">It is equivalent to reparent
first_parent,commit rebase, where commit is the same
selection set as used with unmerge and first_parent is a set
resolving commit&rsquo;s first parent <br>
(see the reparent command below</p>

<p style="margin-top: 1em">The main interest of the unmerge
is that you don&rsquo;t have to find and specify the first
parent yourself, saving time and avoiding errors when nearby
surgery would make a manual <br>
first parent argument stale.</p>

<p style="margin-top: 1em">reparent [options...] [policy]
<br>
Changes the parent list of a commit. Takes a selection set,
zero or more option arguments, and an optional policy
argument.</p>

<p style="margin-top: 1em">Selection set: <br>
The selection set must resolve to one or more commits. The
selected commit with the highest event number (not
necessarily the last one selected) is the commit to modify.
<br>
The remainder of the selected commits, if any, become its
parents: the selected commit with the lowest event number
(which is not necessarily the first one selected) <br>
becomes the first parent, the selected commit with second
lowest event number becomes the second parent, and so on.
All original parent links are removed. Examples:</p>

<p style="margin-top: 1em"># this makes 17 the parent of 33
<br>
17,33 reparent</p>

<p style="margin-top: 1em"># this also makes 17 the parent
of 33 <br>
33,17 reparent</p>

<p style="margin-top: 1em"># this makes 33 a root
(parentless) commit <br>
33 reparent</p>

<p style="margin-top: 1em"># this makes 33 an octopus merge
commit. its first parent <br>
# is commit 15, second parent is 17, and third parent is 22
<br>
22,33,15,17 reparent</p>

<p style="margin-top: 1em">Options:</p>

<p style="margin-top: 1em">--use-order <br>
Use the selection order to determine which selected commit
is the commit to modify and which are the parents (and if
there are multiple parents, their order). The <br>
last selected commit (not necessarily the one with the
highest event number) is the commit to modify, the first
selected commit (not necessarily the one with the <br>
lowest event number) becomes the first parent, the second
selected commit becomes the second parent, and so on.
Examples:</p>

<p style="margin-top: 1em"># this makes 33 the parent of 17
<br>
33|17 reparent --use-order</p>

<p style="margin-top: 1em"># this makes 17 an octopus merge
commit. its first parent <br>
# is commit 22, second parent is 33, and third parent is 15
<br>
22,33,15|17 reparent --use-order</p>

<p style="margin-top: 1em">Because ancestor commit events
must appear before their descendants, giving a commit with a
low event number a parent with a high event number triggers
a re-sort of <br>
the events. A re-sort assigns different event numbers to
some or all of the events. Re-sorting only works if the
reparenting does not introduce any cycles. To swap <br>
the order of two commits that have an
ancestor&acirc;descendant relationship without introducing a
cycle during the process, you must reparent the descendant
commit first.</p>

<p style="margin-top: 1em">Policy: <br>
By default, the manifest of the reparented commit is
computed before modifying it; a deleteall and some fileops
are prepended so that the manifest stays unchanged even <br>
when the first parent has been changed. This behavior can be
changed by specifying a policy:</p>

<p style="margin-top: 1em">rebase <br>
Inhibits the default behavior&acirc;no deleteall is issued
and the tree contents of all descendents can be modified as
a result.</p>

<p style="margin-top: 1em">branch branchname...
{rename|delete} [arg] <br>
Rename or delete a branch (and any associated resets). First
argument must be an existing branch name; second argument
must one of the verbs &rsquo;rename&rsquo; or
&rsquo;delete&rsquo;.</p>

<p style="margin-top: 1em">For a &rsquo;rename&rsquo;, the
third argument may be any token that is a syntactically
valid branch name (but not the name of an existing branch).
For a &rsquo;delete&rsquo;, no third argument is <br>
required.</p>

<p style="margin-top: 1em">For either name, if it does not
contain a &rsquo;/&rsquo; the prefix
&rsquo;refs/heads&rsquo; is prepended.</p>

<p style="margin-top: 1em">tag tagname...
{move|rename|delete} [arg]. <br>
Create, move, rename, or delete a tag.</p>

<p style="margin-top: 1em">Creation is a special case.
First argument is a nane, which must not be an existing tag.
Takes a singleton event second argument which must point to
a commit. A tag object <br>
pointing to the commit is created and inserted just after
the last tag in the repo (or just after the last commit if
there are no tags). The tagger, committish, and comment <br>
fields are copied from the commit&rsquo;s committer, mark,
and comment fields.</p>

<p style="margin-top: 1em">Otherwise, first argument must
be an existing tag name; second argument must be one of the
verbs &acirc;move&acirc;, &acirc;rename&acirc;, or
&acirc;delete&acirc;.</p>

<p style="margin-top: 1em">For a &acirc;move&acirc;, a
third argument must be a singleton selection set. For a
&acirc;rename&acirc;, the third argument may be any token
that is a syntactically valid tag name (but not the name
<br>
of an existing tag). For a &acirc;delete&acirc;, no third
argument is required.</p>

<p style="margin-top: 1em">The behavior of this command is
complex because features which present as tags may be any of
three things: (1) True tag objects, (2) lightweight tags,
actually sequences of <br>
commits with a common branchname beginning with
&acirc;refs/tags&acirc; - in this case the tag is considered
to point to the last commit in the sequence, (3) Reset
objects. These may <br>
occur in combination; in fact, stream exporters from systems
with annotation tags commonly express each of these as a
true tag object (1) pointing at the tip commit of a <br>
sequence (2) in which the basename of the common branch
field is identical to the tag name. An exporter that
generates lightweight-tagged commit sequences (2) may or may
not <br>
generate resets pointing at their tip commits.</p>

<p style="margin-top: 1em">This command tries to handle all
combinations in a natural way by doing up to three
operations on any true tag, commit sequence, and reset
matching the source name. In a <br>
rename, all are renamed together. In a delete, any matching
tag or reset is deleted; then matching branch fields are
changed to match the branch of the unique descendent of <br>
the tagged commit, if there is one. When a tag is moved, no
branch fields are changed and a warning is issued.</p>

<p style="margin-top: 1em">Attempts to delete a lightweight
tag may fail with the message &acirc;couldn&rsquo;t
determine a unique successor&acirc;. When this happens, the
tag is on a commit with multiple children that <br>
have different branch labels. There is a hole in the
specification of git fast-import streams that leaves it
uncertain how branch labels can be safely reassigned in this
<br>
case; rather than do something risky, reposurgeon throws a
recoverable error.</p>

<p style="margin-top: 1em">reset resetname...
{move|rename|delete} [arg]. <br>
Move, rename, or delete a reset. First argument must match
an existing reset name; second argument must be one of the
verbs &acirc;move&acirc;, &acirc;rename&acirc;, or
&acirc;delete&acirc;.</p>

<p style="margin-top: 1em">For a &acirc;move&acirc;, a
third argument must be a singleton selection set. For a
&acirc;rename&acirc;, the third argument may be any token
token that matches a syntactically valid reset name (but
<br>
not the name of an existing reset). For a
&acirc;delete&acirc;, no third argument is required.</p>

<p style="margin-top: 1em">For either name, if it does not
contain a &acirc;/&acirc; the prefix &acirc;heads/&acirc; is
prepended. If it does not begin with &acirc;refs/&acirc;,
&acirc;refs/&acirc; is prepended.</p>

<p style="margin-top: 1em">An argument matches a
reset&rsquo;s name if it is either the entire reference
(refs/heads/FOO or refs/tags/FOO for some some value of FOO)
or the basename (e.g. FOO), or a suffix <br>
of the form heads/FOO or tags/FOO. An unqualified basename
is assumed to refer to a head.</p>

<p style="margin-top: 1em">When a reset is renamed, commit
branch fields matching the tag are renamed with it to match.
When a reset is deleted, matching branch fields are changed
to match the branch <br>
of the unique descendent of the tip commit of the associated
branch, if there is one. When a reset is moved, no branch
fields are changed.</p>

<p style="margin-top: 1em">debranch source-branch...
[target-branch]. <br>
Takes one or two arguments which must be the names of source
and target branches; if the second (target) argument is
omitted it defaults to refs/heads/master. Any trailing <br>
segment of a branch name is accepted as a synonym for it;
thus master is the same as refs/heads/master. Does not take
a selection set.</p>

<p style="margin-top: 1em">The history of the source branch
is merged into the history of the target branch, becoming
the history of a subdirectory with the name of the source
branch. Any resets of the <br>
source branch are removed.</p>

<p style="margin-top: 1em">strip [blobs|reduce]. <br>
Reduce the selected repository to make it a more tractable
test case. Use this when reporting bugs.</p>

<p style="margin-top: 1em">With the modifier
&rsquo;blobs&rsquo;, replace each blob in the repository
with a small, self-identifying stub, leaving all metadata
and DAG topology intact. This is useful when you are <br>
reporting a bug, for reducing large repositories to test
cases of manageable size.</p>

<p style="margin-top: 1em">A selection set is effective
only with the &rsquo;blobs&rsquo; option, defaulting to all
blobs. The &rsquo;reduce&rsquo; mode always acts on the
entire repository.</p>

<p style="margin-top: 1em">With the modifier
&rsquo;reduce&rsquo;, perform a topological reduction that
throws out uninteresting commits. If a commit has all file
modifications (no deletions or copies or renames) <br>
and has exactly one ancestor and one descendant, then it may
be boring. To be fully boring, it must also not be referred
to by any tag or reset. Interesting commits are not <br>
boring, or have a non-boring parent or non-boring child.</p>

<p style="margin-top: 1em">With no modifiers, this command
strips blobs.</p>

<p style="margin-top: 1em">ignores [rename]. [translate].
[defaults]. <br>
Intelligent handling of ignore-pattern files. This command
fails if no repository has been selected or no preferred
write type has been set for the repository. It does not <br>
take a selection set.</p>

<p style="margin-top: 1em">If the rename modifier is
present, this command attempts to rename all ignore-pattern
files to whatever is appropriate for the preferred type -
e.g. .gitignore for git, <br>
.hgignore for hg, etc. This option does not cause any
translation of the ignore files it renames.</p>

<p style="margin-top: 1em">If the translate modifier is
present, syntax translation of each ignore file is
attempted. At present, the only transformation the code
knows is to prepend a &rsquo;syntax: glob&rsquo; <br>
header if the preferred type is hg.</p>

<p style="margin-top: 1em">If the defaults modifier is
present, the command attempts to prepend these default
patterns to all ignore files. If no ignore file is created
by the first commit, it will be <br>
modified to create one containing the defaults. This command
will error out on prefer types that have no default ignore
patterns (git and hg, in particular). It will also <br>
error out when it knows the import tool has already set
default patterns.</p>

<p style="margin-top: 1em">REFERENCE LIFTING <br>
This group of commands is meant for fixing up references in
commits that are in the format of older version control
systems. The general workflow is this: first, go over the
<br>
comment history and change all old-fashioned commit
references into machine-parseable cookies. Then,
automatically turn the machine-parseable cookie into action
stamps. The point <br>
of dividing the process this way is that the first part is
hard for a machine to get right, while the second part is
prone to errors when a human does it.</p>

<p style="margin-top: 1em">A Subversion cookie is a comment
substring of the form [[SVN:ddddd]] (example: [[SVN:2355]]
with the revision read directly via the Subversion exporter,
deduced from git-svn <br>
metadata, or matching a $Revision$ header embedded in blob
data for the filename.</p>

<p style="margin-top: 1em">A CVS cookie is a comment
substring of the form [[CVS:filename:revision]] (example:
[[CVS:src/README:1.23]] with the revision matching a CVS
$Id$ or $Revision$ header embedded in <br>
blob data for the filename.</p>

<p style="margin-top: 1em">A mark cookie is of the form
[[:dddd]] and is simply a reference to the specified mark.
You may want to hand-patch this in when one of previous
forms is inconvenient.</p>

<p style="margin-top: 1em">An action stamp is an RFC3339
timestamp, followed by a &rsquo;!&rsquo;, followed by an
author email address (author rather than committer because
that timestamp is not changed when a patch <br>
is replayed on to a branch). It attempts to refer to a
commit without being VCS-specific. Thus, instead of
&quot;commit 304a53c2&quot; or &quot;r2355&quot;,
&quot;2011-10-25T15:11:09Z!fred@foonly.com&quot;.</p>

<p style="margin-top: 1em">The following git aliases allow
git to work directly with action stamps. Append it to your
~/.gitconfig; if you already have an [alias] section, leave
off the first line.</p>

<p style="margin-top: 1em">[alias] <br>
# git stamp &lt;commit-ish&gt; - print a reposurgeon-style
action stamp <br>
stamp = show -s --format=&rsquo;%cI!%ce&rsquo;</p>

<p style="margin-top: 1em"># git scommit &lt;stamp&gt;
&lt;rev-list-args&gt; - list most recent commit that matches
&lt;stamp&gt;. <br>
# Must also specify a branch to search or --all, after these
arguments. <br>
scommit = &quot;!f(){ d=${1%%!*}; a=${1##*!}; arg=</p>

<p style="margin-top: 1em"># git scommits &lt;stamp&gt;
&lt;rev-list-args&gt; - as above, but list all matching
commits. <br>
scommits = &quot;!f(){ d=${1%%!*}; a=${1##*!}; arg=</p>

<p style="margin-top: 1em"># git smaster &lt;stamp&gt; -
list most recent commit on master that matches
&lt;stamp&gt;. <br>
smaster = &quot;!f(){ git scommit <br>
smasters = &quot;!f(){ git scommits</p>

<p style="margin-top: 1em"># git shs &lt;stamp&gt; - show
the commits on master that match &lt;stamp&gt;. <br>
shs = &quot;!f(){ stamp=$(git smasters $1); shift; git show
${stamp:?not found} $*; }; f&quot;</p>

<p style="margin-top: 1em"># git slog &lt;stamp&gt;
&lt;log-args&gt; - start git log at &lt;stamp&gt; on master
<br>
slog = &quot;!f(){ stamp=$(git smaster $1); shift; git log
${stamp:?not found} $*; }; f&quot;</p>

<p style="margin-top: 1em"># git sco &lt;stamp&gt; - check
out most recent commit on master that matches &lt;stamp&gt;.
<br>
sco = &quot;!f(){ stamp=$(git smaster $1); shift; git
checkout ${stamp:?not found} $*; }; f&quot;</p>

<p style="margin-top: 1em">There is a rare case in which an
action stamp will not refer uniquely to one commit. It is
theoretically possible that the same author might check in
revisions on different <br>
branches within the one-second resolution of the timestamps
in a fast-import stream. There is nothing to be done about
this; tools using action stamps need to be aware of the <br>
possibility and throw a warning when it occurs.</p>

<p style="margin-top: 1em">In order to support reference
lifting, reposurgeon internally builds a legacy-reference
map that associates revision identifiers in older
version-control systems with commits. <br>
The contents of this map comes from three places: (1)
cvs2svn:rev properties if the repository was read from a
Subversion dump stream, (2) $Id$ and $Revision$ headers in
<br>
repository files, and (3) the .git/cvs-revisions created by
git cvsimport.</p>

<p style="margin-top: 1em">The detailed sequence for
lifting possible references is this: first, find possible
CVS and Subversion references with the references or =N
visibility set; then replace them with <br>
equivalent cookies; then run references lift to turn the
cookies into action stamps (using the information in the
legacy-reference map) without having to do the lookup by
hand.</p>

<p style="margin-top: 1em">references [list|edit|lift]
[&gt;outfile] <br>
With the modifier &rsquo;list&rsquo;, list commit and tag
comments for strings that might be CVS- or Subversion-style
revision identifiers. This will be useful when you want to
replace <br>
them with equivalent cookies that can automatically be
translated into VCS-independent action stamps. This
reporting command supports &gt;-redirection. It is
equivalent to &rsquo;=N <br>
list&rsquo;.</p>

<p style="margin-top: 1em">With the modifier
&rsquo;edit&rsquo;, edit the set where revision IDs are
found. This is equivalent to &rsquo;=N edit&rsquo;.</p>

<p style="margin-top: 1em">With the modifier
&quot;lift&quot;, attempt to resolve Subversion and CVS
cookies in comments into action stamps using the legacy map.
An action stamp is a <br>
timestamp/email/sequence-number combination uniquely
identifying the commit associated with that blob, as
described in the section called &acirc;TRANSLATION
STYLE&acirc;.</p>

<p style="margin-top: 1em">It is not guaranteed that every
such reference will be resolved, or even that any at all
will be. Normally all references in history from a
Subversion repository will <br>
resolve, but CVS references are less likely to be
resolvable.</p>

<p style="margin-top: 1em">VARIABLES, MACROS AND EXTENSIONS
<br>
Occasionally you will need to issue a large number of
complex surgical commands of very similar form, and
it&rsquo;s convenient to be able to package that form so you
don&rsquo;t need to do <br>
a lot of error-prone typing. For those occasions,
reposurgeon supports simple forms of named variables and
macro expansion.</p>

<p style="margin-top: 1em">assign [name] <br>
Compute a leading selection set and assign it to a symbolic
name. It is an error to assign to a name that is already
assigned, or to any existing branch name. Assignments may
<br>
be cleared by sequence mutations (though not ordinary
deletions); you will see a warning when this occurs.</p>

<p style="margin-top: 1em">With no selection set and no
name, list all assignments.&gt;</p>

<p style="margin-top: 1em">Use this to optimize out
location and selection computations that would otherwise be
performed repeatedly, e.g. in macro calls.</p>

<p style="margin-top: 1em">unassign [name] <br>
Unassign a symbolic name. Throws an error if the name is not
assigned.</p>

<p style="margin-top: 1em">names [&gt;outfile] <br>
List the names of all known branches and tags. Tells you
what things are legal within angle brackets and
parentheses.</p>

<p style="margin-top: 1em">define name body <br>
Define a macro. The first whitespace-separated token is the
name; the remainder of the line is the body, unless it is
&acirc;{&acirc;, which begins a multi-line macro terminated
by a <br>
line beginning with &acirc;}&acirc;.</p>

<p style="margin-top: 1em">A later &acirc;do&acirc; call
can invoke this macro.</p>

<p style="margin-top: 1em">The command &acirc;define&acirc;
by itself without a name or body produces a macro list.</p>

<p style="margin-top: 1em">do name arguments... <br>
Expand and perform a macro. The first whitespace-separated
token is the name of the macro to be called; remaining
tokens replace {0}, {1}... in the macro definition (the <br>
conventions used are those of the Python format method).
Tokens may contain whitespace if they are string-quoted;
string quotes are stripped. Macros can call macros.</p>

<p style="margin-top: 1em">If the macro expansion does not
itself begin with a selection set, whatever set was
specified before the &quot;do&quot; keyword is available to
the command generated by the expansion.</p>

<p style="margin-top: 1em">undefine name] <br>
Undefine the named macro.</p>

<p style="margin-top: 1em">Here&rsquo;s an example to
illustrate how you might use this. In CVS repositories of
projects that use the GNU ChangeLog convention, a very
common pre-conversion artifact is a commit <br>
with the comment &quot;***empty log message***&quot; that
modifies only a ChangeLog entry explaining the commit
immediately previous to it. The following</p>

<p style="margin-top: 1em">define changelog &lt;{0}&gt;
&amp; /empty log message/ squash --pushback <br>
do changelog 2012-08-14T21:51:35Z <br>
do changelog 2012-08-08T22:52:14Z <br>
do changelog 2012-08-07T04:48:26Z <br>
do changelog 2012-08-08T07:19:09Z <br>
do changelog 2012-07-28T18:40:10Z</p>

<p style="margin-top: 1em">is equivalent to the more
verbose</p>

<p style="margin-top: 1em">&lt;2012-08-14T21:51:35Z&gt;
&amp; /empty log message/ squash --pushback <br>
&lt;2012-08-08T22:52:14Z&gt; &amp; /empty log message/
squash --pushback <br>
&lt;2012-08-07T04:48:26Z&gt; &amp; /empty log message/
squash --pushback <br>
&lt;2012-08-08T07:19:09Z&gt; &amp; /empty log message/
squash --pushback <br>
&lt;2012-07-28T18:40:10Z&gt; &amp; /empty log message/
squash --pushback</p>

<p style="margin-top: 1em">but you are less likely to make
difficult-to-notice errors typing the first version.</p>

<p style="margin-top: 1em">(Also note how the text regexp
acts as a failsafe against the possibility of typing a wrong
date that doesn&rsquo;t refer to a commit with an empty
comment. This was a real-world <br>
example from the CVS-to-git conversion of groff.)</p>

<p style="margin-top: 1em">When even a macro is not enough,
you can write and call custom Python extensions.</p>

<p style="margin-top: 1em">exec name <br>
Execute custom code from standard input (normally a file via
&lt; redirection). Use this to set up custom extension
functions for later eval calls. The code has full access to
<br>
all internal data structures. Functions defined are
accessible to later eval calls.</p>

<p style="margin-top: 1em">This can be called in a script
with the extension code in a here-doc.</p>

<p style="margin-top: 1em">eval function-name <br>
Evaluate a line of code in the current interpreter context.
Typically this will be a call to a function defined by a
previous exec. The variables _repository and _selection <br>
will have the obvious values. Note that _selection will be a
list of integers, not objects.</p>

<p style="margin-top: 1em">script filename [arg...] <br>
Takes a filename and optional following arguments. Reads
each line from the file and executes it as a command.</p>

<p style="margin-top: 1em">During execution of the script,
the script name replaces the string $0 and the optional
following arguments (if any) replace the strings $1, $2 ...
$n in the script text. <br>
This is done before tokenization, so the $1 in a string like
&acirc;foo$1bar&acirc; will be expanded. Additionally, $$ is
expanded to the current process ID (which may be useful for
<br>
scripts that use tempfiles).</p>

<p style="margin-top: 1em">Within scripts (and only within
scripts) reposurgeon accepts a slightly extended syntax:
First, a backslash ending a line signals that the command
continues on the next line. <br>
Any number of consecutive lines thus escaped are
concatenated, without the ending backslashes, prior to
evaluation. Second, a command that takes an input filename
argument <br>
can instead take literal following data in the syntax of a
shell here-document. That is: if the filename is replaced by
&quot;&lt;&lt;EOF&quot;, all following lines in the script
up to a <br>
terminating line consisting only of &quot;EOF&quot; will be
read, placed in a temporary file, and that file fed to the
command and afterwards deleted. EOF may be replaced by any
<br>
string. Backslashes have no special meaning while reading a
here-document.</p>

<p style="margin-top: 1em">Scripts may have comments. Any
line beginning with a &rsquo;#&rsquo; is ignored. If a line
has a trailing position that begins with one or more
whitespace characters followed by &rsquo;#&rsquo;, <br>
that trailing portion is ignored.</p>

<p style="margin-top: 1em">ARTIFACT REMOVAL <br>
Some commands automate fixing various kinds of artifacts
associated with repository conversions from older
systems.</p>

<p style="margin-top: 1em">authors [read|write]
[&lt;filename] [&gt;filename] <br>
Apply or dump author-map information for the specified
selection set, defaulting to all events.</p>

<p style="margin-top: 1em">Lifts from CVS and Subversion
may have only usernames local to the repository host in
committer and author IDs. DVCSes want email addresses
(net-wide identifiers) and <br>
complete names. To supply the map from one to the other, an
authors file is expected to consist of lines each beginning
with a local user ID, followed by a &rsquo;=&rsquo;
(possibly <br>
surrounded by whitespace) followed by a full name and email
address, optionally followed by a timezone offset field.
Thus:</p>

<p style="margin-top: 1em">ferd = Ferd J. Foonly
&lt;foonly@foo.com&gt; -0500</p>

<p style="margin-top: 1em">An authors file may have comment
lines beginning with &rsquo;#&rsquo;; these are ignored.</p>

<p style="margin-top: 1em">When an authors file is applied,
email addresses in committer and author metadata for which
the local ID matches between &lt; and @ are replaced
according to the mapping (this <br>
handles git-svn lifts). Alternatively, if the local ID is
the entire address, this is also considered a match (this
handles what git-cvsimport and cvs2git do)</p>

<p style="margin-top: 1em">With the &rsquo;read&rsquo;
modifier, or no modifier, apply author mapping data (from
standard input or a &lt;-redirected file). May be useful if
you are editing a repo or dump created by <br>
cvs2git or by git-svn invoked without -A.</p>

<p style="margin-top: 1em">With the &rsquo;write&rsquo;
modifier, write a mapping file that could be interpreted by
authors read, with entries for each unique committer,
author, and tagger (to standard output or a <br>
&lt;-redirected mapping file). This may be helpful as a
start on building an authors file, though each part to the
right of an equals sign will need editing.</p>

<p style="margin-top: 1em">branchify [path-set] <br>
Specify the list of directories to be treated as potential
branches (to become tags if there are no modifications after
the creation copies) when analyzing a Subversion repo. <br>
This list is ignored when the --nobranch read option is
used. It defaults to the &rsquo;standard layout&rsquo; set
of directories, plus any unrecognized directories in the
repository <br>
root.</p>

<p style="margin-top: 1em">With no arguments, displays the
current branchification set.</p>

<p style="margin-top: 1em">An asterisk at the end of a path
in the set means &rsquo;all immediate subdirectories of this
path, unless they are part of another (longer) path in the
branchify set&rsquo;.</p>

<p style="margin-top: 1em">Note that the branchify set is a
property of the reposurgeon interpreter, not of any
individual repository, and will persist across Subversion
dumpfile reads. This may lead <br>
to unexpected results if you forget to re-set it.</p>

<p style="margin-top: 1em">branchify_map
[/regex/branch/...] <br>
Specify the list of regular expressions used for mapping the
svn branches that are detected by branchify. If none of the
expressions match the default behaviour applies. This <br>
maps a branch to the name of the last directory, except for
trunk and &acirc;*&acirc; which are mapped to master and
root.</p>

<p style="margin-top: 1em">With no arguments the current
regex replacement pairs are shown. Passing
&rsquo;reset&rsquo; will clear the mapping.</p>

<p style="margin-top: 1em">The branchify command will match
each branch name against regex1 and if it matches rewrite
its branch name to branch1. If not it will try regex2 and so
forth until it either <br>
found a matching regex or there are no regexs left. The
regular expressions should be in Python&rsquo;s[2]. format.
The branch name can use backreferences (see the re.sub
function <br>
in the Python documentation).</p>

<p style="margin-top: 1em">Note that the regular
expressions are appended to &rsquo;refs/&rsquo; without
either the needed &rsquo;heads/&rsquo; or
&rsquo;tags/&rsquo;. This allows for choosing the right kind
of branch type.</p>

<p style="margin-top: 1em">While the syntax template above
uses slashes, any first character will be used as a
delimeter (and you will need to use a different one in the
common case that the paths <br>
contain slashes).</p>

<p style="margin-top: 1em">Note that the branchify_map set
is a property of the reposurgeon interpreter, not of any
individual repository, and will persist across Subversion
dumpfile reads. This may <br>
lead to unexpected results if you forget to re-set it.</p>

<p style="margin-top: 1em">EXAMINING TREE STATES <br>
manifest [regular expression] [&gt;outfile] <br>
Takes an optional selection set argument defaulting to all
commits, and an optional Python regular expression. For each
commit in the selection set, print the mapping of all <br>
paths in that commit tree to the corresponding blob marks,
mirroring what files would be created in a checkout of the
commit. If a regular expression is given, only print <br>
&quot;path -&gt; mark&quot; lines for paths matching it.
This command supports &gt; redirection.</p>

<p style="margin-top: 1em">checkout directory <br>
Takes a selection set which must resolve to a single commit,
and a second argument. The second argument is interpreted as
a directory name. The state of the code tree at that <br>
commit is materialized beneath the directory.</p>

<p style="margin-top: 1em">diff [&gt;outfile] <br>
Display the difference between commits. Takes a
selection-set argument which must resolve to exactly two
commits. Supports output redirection.</p>

<p style="margin-top: 1em">HOUSEKEEPING <br>
These are backed up by the following housekeeping commands,
none of which take a selection set:</p>

<p style="margin-top: 1em">help <br>
Get help on the interpreter commands. Optionally follow with
whitespace and a command name; with no argument, lists all
commands. &rsquo;?&rsquo; also invokes this.</p>

<p style="margin-top: 1em">shell <br>
Execute the shell command given in the remainder of the
line. &rsquo;!&rsquo; also invokes this.</p>

<p style="margin-top: 1em">prefer [repotype] <br>
With no arguments, describe capabilities of all supported
systems. With an argument (which must be the name of a
supported system) this has two effects:</p>

<p style="margin-top: 1em">First, if there are multiple
repositories in a directory you do a read on, reposurgeon
will read the preferred one (otherwise it will complain that
it can&rsquo;t choose among <br>
them).</p>

<p style="margin-top: 1em">Secondly, this will change
reposurgeon&rsquo;s preferred type for output. This means
that you do a write to a directory, it will build a repo of
the preferred type rather than its <br>
original type (if it had one).</p>

<p style="margin-top: 1em">If no preferred type has been
explicitly selected, reading in a repository (but not a
fast-import stream) will implicitly set the preferred type
to the type of that <br>
repository.</p>

<p style="margin-top: 1em">In older versions of reposurgeon
this command changed the type of the selected repository, if
there is one. That behavior interacted badly with attempts
to interpret legacy <br>
IDs and has been removed.</p>

<p style="margin-top: 1em">sourcetype [repotype] <br>
Report (with no arguments) or select (with one argument) the
current repository&rsquo;s source type. This type is
normally set at repository-read time, but may remain unset
if the <br>
source was a stream file.</p>

<p style="margin-top: 1em">The source type affects the
interpretation of legacy IDs (for purposes of the =N
visibility set and the &rsquo;references&rsquo; command) by
controlling the regular expressions used to <br>
recognize them. If no preferred output type has been set, it
may also change the output format of stream files made from
the repository.</p>

<p style="margin-top: 1em">The source type is reliably set
whenever a live repository is read, or when a Subversion
stream or Fossil dump is interpreted but not necessarily by
other stream files. <br>
Streams generated by cvs-fast-export(1) using the
--reposurgeon are detected as CVS. In some other cases, the
source system is detected from the presence of magic
$-headers <br>
in contents blobs.</p>

<p style="margin-top: 1em">INSTRUMENTATION <br>
A few commands have been implemented primarily for debugging
and regression-testing purposes, but may be useful in
unusual circumstances.</p>

<p style="margin-top: 1em">The output of most of these
commands can individually be redirected to a named output
file. Where indicated in the syntax, you can prefix the
output filename with &acirc;&gt;&acirc; and give it <br>
as a following argument.</p>

<p style="margin-top: 1em">index [&gt;outfile] <br>
Display four columns of info on objects in the selection
set: their number, their type, the associate mark (or
&rsquo;-&rsquo; if no mark) and a summary field varying by
type. For a <br>
branch or tag it&rsquo;s the reference; for a commit
it&rsquo;s the commit branch; for a blob it&rsquo;s the
repository path of the file in the blob.</p>

<p style="margin-top: 1em">The default selection set for
this command is =CTRU, all objects except blobs.</p>

<p style="margin-top: 1em">resolve [label-text...] <br>
Does nothing but resolve a selection-set expression and echo
the resulting event-number set to standard output. The
remainder of the line after the command is used as a label
<br>
for the output.</p>

<p style="margin-top: 1em">Implemented mainly for
regression testing, but may be useful for exploring the
selection-set language.</p>

<p style="margin-top: 1em">verbose [n] <br>
&rsquo;verbose 1&rsquo; enables the progress meter and
messages, &rsquo;verbose 0&rsquo; disables them. Higher
levels of verbosity are available but intended for
developers only.</p>

<p style="margin-top: 1em">quiet [on | off] <br>
Without an argument, this command requests a report of the
quiet boolean; with the argument &rsquo;on&rsquo; or
&rsquo;off&rsquo; it is changed. When quiet is on,
time-varying report fields which <br>
would otherwise cause spurious failures in regression
testing are suppressed.</p>

<p style="margin-top: 1em">print output-text... <br>
Does nothing but ship its argument line to standard output.
Useful in regression tests.</p>

<p style="margin-top: 1em">echo [number] <br>
&rsquo;echo 1&rsquo; causes each reposurgeon command to be
echoed to standard output just before its output. This can
be useful in constructing regression tests that are easily
checked <br>
by eyeball.</p>

<p style="margin-top: 1em">version [version...] <br>
With no argument, display the program version and the list
of VCSes directly supported. With argument, declare the
major version (single digit) or full version (major.minor)
<br>
under which the enclosing script was developed. The program
will error out if the major version has changed (which means
the surgical language is not backwards compatible).</p>

<p style="margin-top: 1em">It is good practice to start
your lift script with a version requirement, especially if
you are going to archive it for later reference.</p>

<p style="margin-top: 1em">prompt [format...] <br>
Set the command prompt format to the value of the command
line; with an empty command line, display it. The prompt
format is evaluated in Python after each command with the
<br>
following dictionary substitutions:</p>

<p style="margin-top: 1em">chosen <br>
The name of the selected repository, or None if none is
currently selected.</p>

<p style="margin-top: 1em">Thus, one useful format might be
&rsquo;rs[%(chosen)s]%% &rsquo;.</p>

<p style="margin-top: 1em">More format items may be added
in the future. The default prompt corresponds to the format
&rsquo;reposurgeon%% &rsquo;. The format line is evaluated
with shell quotng of tokens, so that <br>
spaces can be included.</p>

<p style="margin-top: 1em">history <br>
List the commands you have entered this session.</p>

<p style="margin-top: 1em">legacy [read|write]
[&lt;filename] [&gt;filename] <br>
Apply or list legacy-reference information. Does not take a
selection set. The &rsquo;read&rsquo; variant reads from
standard input or a &lt;-redirected filename; the
&rsquo;write&rsquo; variant writes <br>
to standard output or a &gt;-redirected filename.</p>

<p style="margin-top: 1em">A legacy-reference file maps
reference cookies to (committer, commit-date,
sequence-number) pairs; these in turn (should) uniquely
identify a commit. The format is two <br>
whitespace-separated fields: the cookie followed by an
action stamp identifying the commit.</p>

<p style="margin-top: 1em">It should not normally be
necessary to use this command. The legacy map is
automatically preserved through repository reads and
rebuilds, being stored in the file legacy-map <br>
under the repository subdirectory..</p>

<p style="margin-top: 1em">set [option] <br>
Turn on an option flag. With no arguments, list all
options</p>

<p style="margin-top: 1em">Most options are described in
conjunction with the specific operations that the modify.
One of general interest is &acirc;compressblobs&acirc;; this
enables compression on the blob files <br>
in the internal representation reposurgeon uses for editing
repositories. With this option, reading and writing of
repositories is slower, but editing a repository requires
<br>
less (sometimes much less) disk space.</p>

<p style="margin-top: 1em">clear [option] <br>
Turn off an option flag. With no arguments, list all
options</p>

<p style="margin-top: 1em">profile <br>
Enable profiling. Profile statistics are dumped to the path
given as argument. Must be one of the initial command-line
arguments, and gathers statistics only on code executed <br>
via &rsquo;-&rsquo;.</p>

<p style="margin-top: 1em">timing <br>
Display statistics on phase timing in repository analysis.
Mainly of interest to developers trying to speed up the
program.</p>

<p style="margin-top: 1em">exit <br>
Exit, reporting the time. Included here because, while EOT
will also cleanly exit the interpreter, this command reports
elapsed time since start.</p>

<p style="margin-top: 1em">WORKING WITH MERCURIAL <br>
reposurgeon uses a built-in extractor class to perform
extractions from Mercurial repositories.</p>

<p style="margin-top: 1em">Mercurial branches are exported
as branches in the exported repository and tags are exported
as tags. By default, bookmarks are ignored. You can specify
explicit handling for <br>
bookmarks by setting reposurgeon.bookmarks in your .hg/hgrc.
Set the value to the prefix that reposurgeon should use for
bookmarks.</p>

<p style="margin-top: 1em">For example, if your bookmarks
represent branches, put this at the bottom of your
.hg/hgrc:</p>

<p style="margin-top: 1em">[reposurgeon] <br>
bookmarks=heads/</p>

<p style="margin-top: 1em">If you do that, it&rsquo;s your
responsibility to ensure that branch names do not conflict
with bookmark names. You can add a prefix like
bookmarks=heads/feature- to disambiguate as <br>
necessary.</p>

<p style="margin-top: 1em">WORKING WITH SUBVERSION <br>
reposurgeon can read Subversion dumpfiles or edit a
Subversion repository (and you must point it at a
repository, not a checkout directory). The reposurgeon
distribution includes <br>
a script named &acirc;repotool&acirc; that you can use to
make and then incrementally update a local mirror of a
remote repository for editing or conversion purposes.</p>

<p style="margin-top: 1em">READING SUBVERSION REPOSITORIES
<br>
Certain optional modifiers on the read command change its
behavior when reading Subversion repositories:</p>

<p style="margin-top: 1em">--nobranch <br>
Suppress branch analysis.</p>

<p style="margin-top: 1em">--ignore-properties <br>
Suppress read-time warnings about discarded property
settings.</p>

<p style="margin-top: 1em">--user-ignores <br>
Don&rsquo;t generate .gitignore files from svn:ignore
properties. Instead, just pass through .gitignore files
found in the history.</p>

<p style="margin-top: 1em">--use-uuid <br>
If the --use-uuid read option is set, the repository&rsquo;s
UUID will be used as the hostname when faking up email
addresses, a la git-svn. Otherwise, addresses will be
generated <br>
the way git cvs-import does it, simply ciopying the username
into the address field.</p>

<p style="margin-top: 1em">These modifiers can go anywhere
in any order on the read command line after the read verb.
They must be whitespace-separated.</p>

<p style="margin-top: 1em">Here are the rules used for
mapping subdirectories in a Subversion repository to
branches:</p>

<p style="margin-top: 1em">1. At any given time there is a
set of eligible paths and path wildcards which declare
potential branches. See the documentation of the branchify
for how to alter this set, <br>
which initially consists of {trunk, tags/*, branches/*, and
&rsquo;*&rsquo;}.</p>

<p style="margin-top: 1em">2. A repository is considered
&quot;flat&quot; if it has no directory that matches a path
or path wildcard in the branchify set. All commits in a flat
repository are assigned to branch <br>
master, and what would have been branch structure becomes
directory structure. In this case, we&rsquo;re done; all the
other rules apply to non-flat repos.</p>

<p style="margin-top: 1em">If you give the option
--nobranch when reading a Subversion repository, branch
analysis is skipped and the repository is treated as though
flat (left as a linear sequence of <br>
commits on refs/heads/master). This may be useful if your
repository configuration is highly unusual and you need to
do your own branch surgery. Note that this option will <br>
disable partitioning of mixed commits.</p>

<p style="margin-top: 1em">3. If &quot;trunk&quot; is
eligible, it always becomes the master branch.</p>

<p style="margin-top: 1em">4. If an element of the
branchify set ends with *, each immediate subdirectory of it
is considered a potential branch. If &rsquo;*&rsquo; is in
the branchify set (which is true by default) <br>
all top-level directories other than /trunk, /tags, and
/branches are also considered potential branches.</p>

<p style="margin-top: 1em">5. Each potential branch is
checked to see if it has commits on it after the initial
creation or copy. If there are such commits, it becomes a
branch. If not, it becomes a tag <br>
in order to preserve the commit metadata. (In all cases, the
name of the tag or branch is the basename of the
directory.)</p>

<p style="margin-top: 1em">6. Files in the top-level
directory are assigned to a synthetic branch named
&rsquo;root&rsquo;.</p>

<p style="margin-top: 1em">Each commit that only creates or
deletes directories (in particular, copy commits for tags
and branches, and commits that only change properties) will
be transformed into a tag <br>
named after the branch, containing the date/author/comment
metadata from the commit. While this produces a desirable
result for tags, non-tag branches (including trunk) will
also <br>
get root tags this way. This apparent misfeature has been
accepted so that reposurgeon will never destroy
human-generated metadata that might have value; it is left
up to the <br>
user to manually remove unwanted tags.</p>

<p style="margin-top: 1em">Subversion branch deletions are
turned into deletealls, clearing the fileset of the
import-stream branch. When a branch finishes with a
deleteall at its tip, the deleteall is <br>
transformed into a tag. This rule cleans up after aborted
branch renames.</p>

<p style="margin-top: 1em">Occasionally (and usually by
mistake) a branchy Subversion repository will contain
revisions that touch multiple branches. These are handled by
partitioning them into multiple <br>
import-stream commits, one on each affected branch. The
Legacy-ID of such a split commit will have a pseudo-decimal
part - for example, if Subversion revision 2317 touches
three <br>
branches, the three generated commits will have IDs 2317.1,
2317.2, and 2317.3.</p>

<p style="margin-top: 1em">The svn:executable and
svn:special properties are translated into permission
settings in the input stream; svn:executable becomes 100755
and svn:special becomes 120000 <br>
(indicating a symlink; the blob contents will be the path to
which the symlink should resolve).</p>

<p style="margin-top: 1em">Any cvs2svn:rev properties
generated by cvs2svn are incorporated into the internal map
used for reference-lifting, then discarded.</p>

<p style="margin-top: 1em">Normally, per-directory
svn:ignore properties become .gitignore files. Actual
.gitignore files in a Subversion directory are presumed to
have been created by git-svn users <br>
separately from native Subversion ignore properties and
discarded with a warning. It is up to the user to merge the
content of such files into the target repository by hand.
But <br>
this behavior is inverted by the --user-ignores option; if
that is on, .gitignore files are passed through and
Subversion svn:ignore properties are discarded.</p>

<p style="margin-top: 1em">(Regardless of the setting of
the --user-ignores option, .cvsignore files found in
Subversion repositories always become .gitignores in the
translation. The assumption is that <br>
these date from before a CVS-to-SVN lift and should be
preserved to affect behavior when browsing that section of
the repository.)</p>

<p style="margin-top: 1em">svn:mergeinfo properties are
interpreted. Any svn:mergeinfo property on a revision A with
a merge source range ending in revision B produces a merge
link such that B becomes a <br>
parent of A.</p>

<p style="margin-top: 1em">All other Subversion properties
are discarded. (This may change in a future release.) The
property for which this is most likely to cause semantic
problems is svn:eol-style. <br>
However, since property-change-only commits get turned into
annotated tags, the translated tags will retain information
about setting changes.</p>

<p style="margin-top: 1em">The sub-second resolution on
Subversion commit dates is discarded; Git wants integer
timestamps only.</p>

<p style="margin-top: 1em">Because fast-import format
cannot represent an empty directory, empty directories in
Subversion repositories will be lost in translation.</p>

<p style="margin-top: 1em">Normally, Subversion local
usernames are mapped in the style of git cvs-import; thus
user &quot;foo&quot; becomes &quot;foo &lt;foo&gt;&quot;,
which is sufficient to pacify git and other systems that
<br>
require email addresses. With the option
&quot;svn_use_uuid&quot;, usernames are mapped in the
git-svn style, with the repository&rsquo;s UUID used as a
fake domain in the email address. Both <br>
forms can be remapped to real address using the authors read
command.</p>

<p style="margin-top: 1em">Reading a Subversion stream
enables writing of the legacy map as &rsquo;legacy&rsquo;
passthroughs when the repo is written to a stream file.</p>

<p style="margin-top: 1em">reposurgeon tries hard to
silently do the right thing, but there are Subversion edge
cases in which it emits warnings because a human may need to
intervene and perform fixups by <br>
hand. Here are the less obvious messages it may emit:</p>

<p style="margin-top: 1em">user-generated .gitignore <br>
This message means means reposurgeon has found a .gitignore
file in the Subversion repository it is analyzing. This
probably happened because somebody was using git-svn as a
<br>
live gateway, and created ignores which may or may not be
congruent with those in the generated .gitignore files that
the Subversion ignore properties will be translated <br>
into. You&rsquo;ll need to make a policy decision about
which set of ignores to use in the conversion, and possibly
set the --user-ignores option on read to pass through <br>
user-created .gitignore files; in that case this warning
will not be emitted.</p>

<p style="margin-top: 1em">can&rsquo;t connect nonempty
branch XXXX to origin <br>
This is a serious error. reposurgeon has been unable to find
a link from a specified branch to the trunk (master) branch.
The commit graph will not be fully connected and <br>
will need manual repair.</p>

<p style="margin-top: 1em">permission information may be
lost <br>
A Subversion node change on a file sets or clears
properties, but no ancestor can be found for this file.
Executable or symlink position may be set wrongly on later
revisions <br>
of this file. Subversion user-defined properties may also be
scrambled or lost. Usually this error can be ignored.</p>

<p style="margin-top: 1em">properties set <br>
reposurgeon has detected a setting of a user-defined
property, or the Subversion properties svn:externals. These
properties cannot be expressed in an import stream; the user
<br>
is notified in case this is a showstopper for the conversion
or some corrective action is required, but normally this
error can be ignored. This warning is suppressed by the <br>
--ignore-properties option.</p>

<p style="margin-top: 1em">branch links detected by file
ops only <br>
Branch links are normally deduced by examining Subversion
directory copy operations. A common user error (making a
branch with a non-Subversion directory copy and then doing
<br>
an svn add on the contends) can defeat this. While
reposurgeon should detect and cope with most such copies
correctly, you should examine the commit graph to check that
the <br>
branch is rooted at the correct place.</p>

<p style="margin-top: 1em">could not tagify root commit
<br>
The earliest commit in your Subversion repository has file
operations, rather than being a pure directory creation.
This probably means your Subversion dump file is <br>
malformed, or you may have attempted to lift from an
incremental dump. Proceed with caution.</p>

<p style="margin-top: 1em">deleting parentless tip delete
<br>
This message may be triggered by a Subversion branch move
followed by a re-creation under the source name. Check near
the indicated revision to make sure the renamed branch <br>
is connected to master.</p>

<p style="margin-top: 1em">mid-branch deleteall <br>
A deleteall operation has been found in the middle of a
branch history. This usually indicates that a Subversion tag
or branch was created by mistake, and someone later tried
<br>
to undo the error by deleting the tag/branch directory
before recreating it with a copy operation. Examine the
topology near the deleteall closely, it may need
hand-hacking. <br>
It is fairly likely that both (a) the reposurgeon
translation will be different from what other translators
(such as git-svn) produce, and (b) it will not be
immediately <br>
obvious which is right.</p>

<p style="margin-top: 1em">lookback for XXX failed, not
making branch link <br>
Branch analysis failed, probably due to a set of file copies
that reposurgeon thought it should interpret as a botched
branch creation but couldn&rsquo;t deduce a history for.
This <br>
is a warning; check how the directory XXX is converted, it
may need post-editing into a branch.</p>

<p style="margin-top: 1em">WRITING SUBVERSION REPOSITORIES
<br>
reposurgeon has support for writing Subversion repositories.
Due to mismatches between the ontology of Subversion and
that of git import streams, this support has some <br>
significant limitations and bugs.</p>

<p style="margin-top: 1em">In summary, Subversion
repository histories do not round-trip through reposurgeon
editing. File content changes are preserved but some
metadata is unavoidably lost. Furthermore, <br>
writing out a DVCS history in Subversion also loses
significant portions of its metadata. Details follow.</p>

<p style="margin-top: 1em">Writing a Subversion repository
or dump stream discards author information, the
committer&rsquo;s name, and the hostname part of the commit
address; only the commit timestamp and the <br>
local part of the committer&rsquo;s email address are
preserved, the latter becoming the Subversion author field.
However, reading a Subversion repository and writing it out
again will <br>
preserve the author fields.</p>

<p style="margin-top: 1em">Import-stream timestamps have
1-second granularity. The sub-second parts of Subversion
commit timestamps will be lost on their way through
reposurgeon.</p>

<p style="margin-top: 1em">Empty directories aren&rsquo;t
represented in import streams. Consequently, reading and
writing Subversion repositories preserves file content, but
not empty directories. It is also <br>
not guaranteed that after editing a Subversion repository
that the sequence of directory creations and deletions
relative to other operations will be identical; the only
<br>
guarantee is that enclosing directories will be created
before any files in them are.</p>

<p style="margin-top: 1em">When reading a Subversion
repository, reposurgeon discards the special directory-copy
nodes associated with branch creations. These can&rsquo;t be
recreated if and when the repository <br>
is written back out to Subversion; rather, each branch copy
node from the original translates into a branch creation
plus the first set of file modifications on the branch.</p>

<p style="margin-top: 1em">When reading a Subversion
repository, reposurgeon also automatically breaks apart
mixed-branch commits. These are not re-united if the
repository is written back out.</p>

<p style="margin-top: 1em">When writing to a Subversion
repository, all lightweight tags become Subversion tag
copies with empty log comments, named for the tag basename.
The committer name and timestamp <br>
are copied from the commit the tag points to. The
distinction between heads and tags is lost.</p>

<p style="margin-top: 1em">Because of the preceding two
points, it is not guaranteed that even revision numbers will
be stable when a Subversion repository is read in and then
written out!</p>

<p style="margin-top: 1em">Subversion repositories are
always written with a standard (trunk/tags/branches) layout.
Thus, a repository with a nonstandard shape that has been
analyzed by reposurgeon won&rsquo;t <br>
be written out with the same shape.</p>

<p style="margin-top: 1em">When writing a Subversion
repository, branch merges are translated into svn:mergeinfo
properties in the simplest possible way - as an
svn:mergeinfo property of the translated <br>
merge commit listing the merge source revisions.</p>

<p style="margin-top: 1em">Subversion has a concept of
&quot;flows&quot;; that is, named segments of history
corresponding to files or directories that are created when
the path is added, cloned when the path is <br>
copied, and deleted when the path is deleted. This
information is not preserved in import streams or the
internal representation that reposurgeon uses. Thus, after
editing, the <br>
flow boundaries of a Subversion history may be arbitrarily
changed.</p>

<p style="margin-top: 1em">IGNORE PATTERNS <br>
reposurgeon recognizes how supported VCSes represent file
ignores (CVS .cvsignore files lurking untranslated in older
Subversion repositories, Subversion ignore properties, <br>
.gitignore/.hgignore/.bzrignore file in other systems) and
moves ignore declarations among these containers on repo
input and output. This will be sufficient if the ignore <br>
patterns are exact filenames.</p>

<p style="margin-top: 1em">Translation may not, however, be
perfect when the ignore patterns are Unix glob patterns or
regular expressions. This compatibility table describes
which patterns will translate; <br>
&acirc;plain&acirc; indicates a plain filename with no glob
or regexp syntax or negation.</p>

<p style="margin-top: 1em">RCS has no ignore files or
patterns and is therefore not included in the table.</p>


<p style="margin-top: 1em">&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;
<br>
&acirc; &acirc; from CVS &acirc; from svn &acirc; from git
&acirc; from hg &acirc; from bzr &acirc; from darcs &acirc;
from SRC &acirc; from bk &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; &acirc; &acirc; &acirc; &acirc; &acirc; &acirc;
&acirc; &acirc; &acirc; <br>
&acirc; to CVS &acirc; all &acirc; all &acirc; all except
&acirc; all &acirc; all except &acirc; plain &acirc; all
&acirc; all &acirc; <br>
&acirc; &acirc; &acirc; &acirc; !-prefixed &acirc; &acirc;
RE:- and &acirc; &acirc; &acirc; &acirc; <br>
&acirc; &acirc; &acirc; &acirc; but &acirc; &acirc;
!-prefixed &acirc; &acirc; &acirc; &acirc; <br>
&acirc; &acirc; &acirc; &acirc; nonempty &acirc; &acirc;
&acirc; &acirc; &acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; &acirc; all except !.PP &acirc; &acirc; &acirc;
&acirc; &acirc; &acirc; &acirc; &acirc; <br>
&acirc; to svn &acirc; &acirc; all &acirc; all except
&acirc; all &acirc; all except &acirc; plain &acirc; all
&acirc; all &acirc; <br>
&acirc; &acirc; &acirc; &acirc; !-prefixed &acirc; &acirc;
RE:- and &acirc; &acirc; &acirc; &acirc; <br>
&acirc; &acirc; &acirc; &acirc; &acirc; &acirc; !-prefixed
&acirc; &acirc; &acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; &acirc; &acirc; &acirc; &acirc; &acirc; &acirc;
&acirc; &acirc; &acirc; <br>
&acirc; to git &acirc; all &acirc; all &acirc; all &acirc;
all except &acirc; all except &acirc; plain &acirc; all
&acirc; all &acirc; <br>
&acirc; &acirc; &acirc; &acirc; &acirc; !-prefixed &acirc;
RE:-prefixed &acirc; &acirc; &acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; &acirc; &acirc; &acirc; &acirc; &acirc; &acirc;
&acirc; &acirc; &acirc; <br>
&acirc; to hg &acirc; all except &acirc; all &acirc; all
except &acirc; all &acirc; all except &acirc; plain &acirc;
all &acirc; all &acirc; <br>
&acirc; &acirc; ! &acirc; &acirc; !-prefixed &acirc; &acirc;
RE:- and &acirc; &acirc; &acirc; &acirc; <br>
&acirc; &acirc; &acirc; &acirc; &acirc; &acirc; !-prefixed
&acirc; &acirc; &acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; &acirc; &acirc; &acirc; &acirc; &acirc; &acirc;
&acirc; &acirc; &acirc; <br>
&acirc; to bzr &acirc; all &acirc; all &acirc; all &acirc;
all &acirc; all &acirc; plain &acirc; all &acirc; all
&acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; &acirc; &acirc; &acirc; &acirc; &acirc; &acirc;
&acirc; &acirc; &acirc; <br>
&acirc; to darcs &acirc; plain &acirc; plain &acirc; plain
&acirc; plain &acirc; plain &acirc; all &acirc; all &acirc;
all &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; &acirc; &acirc; &acirc; &acirc; &acirc; &acirc;
&acirc; &acirc; &acirc; <br>
&acirc; to SRC &acirc; all except &acirc; all &acirc; all
except &acirc; all &acirc; all except &acirc; plain &acirc;
all &acirc; all &acirc; <br>
&acirc; &acirc; ! &acirc; &acirc; !-prefixed &acirc; &acirc;
RE:- and &acirc; &acirc; &acirc; &acirc; <br>
&acirc; &acirc; &acirc; &acirc; &acirc; &acirc; !-prefixed
&acirc; &acirc; &acirc; &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;</p>

<p style="margin-top: 1em">The hg rows and columns of the
table describes compatibility to hg&rsquo;s glob syntax
rather than its default regular-expression syntax. When
writing to an hg repository from any <br>
other kind, reposurgeon prepends to the output .hgignore a
&quot;syntax: glob&quot; line.</p>

<p style="margin-top: 1em">TRANSLATION STYLE <br>
After converting a CVS, SVN, or BitKeeper repository, check
for and remove $-cookies in the head revision(s) of the
files. The full Subversion set is $Date:, $Revision:, <br>
$Author:, $HeadURL and $Id:. CVS uses $Author:, $Date:,
$Header:, $Id:, $Log:, $Revision:, also (rarely) $Locker:,
$Name:, $RCSfile:, $Source:, and $State:.</p>

<p style="margin-top: 1em">When you need to specify a
commit, use the action-stamp format that references lift
generates when it can resolve an SVN or CVS reference in a
comment. It is best that you not <br>
vary from this format, even in trivial ways like omitting
the &rsquo;Z&rsquo; or changing the &rsquo;T&rsquo; or
&rsquo;!&rsquo; or &rsquo;:&rsquo;. Making action stamps
uniform and machine-parseable will have good <br>
consequences for future repository-browsing tools.</p>

<p style="margin-top: 1em">Sometimes, in converting a
repository, you may need to insert an explanatory comment -
for example, if metadata has been garbled or missing and you
need to point to that fact. <br>
It&rsquo;s helpful for repository-browsing tools if there is
a uniform syntax for this that is highly unlikely to show up
in repository comments. We recommend enclosing translation
<br>
notes in [[ ]]. This has the advantage of being visually
similar to the [ ] traditionally used for editorial comments
in text.</p>

<p style="margin-top: 1em">It is good practice to include,
in the comment for the root commit of the repository, a note
dating and attributing the conversion work and explaining
these conventions. Example:</p>

<p style="margin-top: 1em">[[This repository was converted
from Subversion to git on 2011-10-24 by Eric S. Raymond
&lt;esr@thyrsus.com&gt;. Here and elsewhere, conversion
notes are enclosed in double square <br>
brackets. Junk commits generated by cvs2svn have been
removed, commit references have been mapped into a uniform
VCS-independent syntax, and some comments edited into <br>
summary-plus-continuation form.]]</p>

<p style="margin-top: 1em">It is also good practice to
include a generated tag at the point of conversion. E.g</p>

<p style="margin-top: 1em">mailbox_in --create &lt;&lt;EOF
<br>
Tag-Name: git-conversion</p>

<p style="margin-top: 1em">Marks the spot at which this
repository was converted from Subversion to git. <br>
EOF</p>

<p style="margin-top: 1em">ADVANCED EXAMPLES <br>
define lastchange { <br>
@max(=B &amp; [/ChangeLog/] &amp; /{0}/B)? list <br>
}</p>

<p style="margin-top: 1em">List the last commit that refers
to a ChangeLog file containing a specified string. (The
trick here is that ? extends the singleton set consisting of
the last eligible ChangeLog <br>
blob to its set of referring commits, and listonly notices
the commits.)</p>

<p style="margin-top: 1em">STREAM SYNTAX EXTENSIONS <br>
The event-stream parser in &acirc;reposurgeon&acirc;
supports some extended syntax. Exporters designed to work
with &acirc;reposurgeon&acirc; may have a --reposurgeon
option that enables emission of <br>
extended syntax; notably, this is true of
cvs-fast-export(1). The remainder of this section describes
these syntax extensions. The properties they set are
(usually) preserved and <br>
re-output when the stream file is written.</p>

<p style="margin-top: 1em">The token
&acirc;#reposurgeon&acirc; at the start of a comment line in
a fast-import stream signals reposurgeon that the remainder
is an extension command to be interpreted by
&acirc;reposurgeon&acirc;.</p>

<p style="margin-top: 1em">One such extension command is
implemented: #sourcetype, which behaves identically to the
reposurgeon sourcetype command. An exporter for a
version-control system named &acirc;frobozz&acirc; <br>
could, for example, say</p>

<p style="margin-top: 1em">#reposurgeon sourcetype
frobozz</p>

<p style="margin-top: 1em">Within a commit, a magic comment
of the form &acirc;#legacy-id&acirc; declares a legacy ID
from the stream file&rsquo;s source version-control
system.</p>

<p style="margin-top: 1em">Also accepted is the bzr syntax
for setting per-commit properties. While parsing commit
syntax, a line beginning with the token
&acirc;property&acirc; must contibue with a <br>
whitespace-separated property-name token. If it is then
followed by a newline it is taken to set that boolean-valued
property to true. Otherwise it must be followed by a numeric
<br>
token specifying a data length, a space, following data
(which may contain newlines) and a terminating newline. For
example:</p>

<p style="margin-top: 1em">commit refs/heads/master <br>
mark :1 <br>
committer Eric S. Raymond &lt;esr@thyrsus.com&gt; 1289147634
-0500 <br>
data 16 <br>
Example commit.</p>

<p style="margin-top: 1em">property legacy-id 2 r1 <br>
M 644 inline README</p>

<p style="margin-top: 1em">Unlike other extensions, bzr
properties are only preserved on stream output if the
preferred type is bzr, because any importer other than
bzr&rsquo;s will choke on them.</p>

<p style="margin-top: 1em">INCOMPATIBLE LANGUAGE CHANGES
<br>
In versions before 3.23, &acirc;prefer&acirc; changed the
repository type as well as the preferred output format.</p>

<p style="margin-top: 1em">In versions before 3.0, the
general command syntax put the command verb first, then the
selection set (if any) then modifiers (VSO). It has changed
to optional selection set <br>
first, then command verb, then modifiers (SVO). The change
made parsing simpler, allowed abolishing some noise
keywords, and recapitulates a successful design pattern in
some <br>
other Unix tools - notably sed(1).</p>

<p style="margin-top: 1em">In versions before 3.0, path
expressions only matched commits, not commits and the
associated blobs as well. The names of the &acirc;a&acirc;
and &acirc;c&acirc; flags were different.</p>

<p style="margin-top: 1em">In reposurgeon versions before
3.0, the delete command had the semantics of squash; also,
the policy flags did not require a &acirc;--&acirc; prefix.
The &acirc;--delete&acirc; flag was named <br>
&acirc;obliterate&acirc;.</p>

<p style="margin-top: 1em">In reposurgeon versions before
3.0, read and write optionally took file arguments rather
than requiring redirects (and the write command never wrote
into directories). This was <br>
changed in order to allow these commands to have modifiers.
These modifiers replaced several global options that no
longer exist.</p>

<p style="margin-top: 1em">In reposurgeon versions before
3.0, the earliest factor in a unite command always kept its
tag and branch names unaltered. The new rule for resolving
name conflicts, giving <br>
priority to the latest factor, produces more natural
behavior when uniting two repositories end to end; the
master branch of the second (later) one keeps its name.</p>

<p style="margin-top: 1em">In reposurgeon versions before
3.0, the tagify command expected policies as trailing
arguments to alter its behaviour. The new syntax uses
similarly named options with leading <br>
dashes, that can appear anywhere after the tagify
command</p>

<p style="margin-top: 1em">In versions before 2.9. the
syntax of &quot;authors&quot;, &quot;legacy&quot;,
&quot;list&quot;, and &quot;mailbox_{in|out}&quot; was
different (and &quot;legacy&quot; was &quot;fossils&quot;).
They took plain filename arguments rather <br>
that using redirect &lt; and &gt;.</p>

<p style="margin-top: 1em">LIMITATIONS AND GUARANTEES <br>
Guarantee: In DVCses that use commit hashes, editing with
reposurgeon never changes the hash of a commit object unless
(a) you edit the commit, or (b) it is a descendant of an
<br>
edited commit in a VCS that includes parent hashes in the
input of a child object&rsquo;s hash (git and hg both do
this).</p>

<p style="margin-top: 1em">Guarantee: reposurgeon only
requires main memory proportional to the size of a
repository&rsquo;s metadata history, not its entire content
history. (Exception: the data from inline <br>
content is held in memory.)</p>

<p style="margin-top: 1em">Guarantee: In the worst case,
reposurgeon makes its own copy of every content blob in the
repository&rsquo;s history and thus uses intermediate disk
space approximately equal to the <br>
size of a repository&rsquo;s content history. However, when
the repository to be edited is presented as a stream file,
reposurgeon requires no or only very little extra disk space
to <br>
represent it; the internal representation of content blobs
is a (seek-offset, length) pair pointing into the stream
file.</p>

<p style="margin-top: 1em">Guarantee: reposurgeon never
modifies the contents of a repository it reads, nor deletes
any repository. The results of surgery are always expressed
in a new repository.</p>

<p style="margin-top: 1em">Guarantee: Any line in a
fast-import stream that is not a part of a command
reposurgeon parses and understands will be passed through
unaltered. At present the set of potential <br>
passthroughs is known to include the progress, the options,
and checkpoint commands as well as comments led by #.</p>

<p style="margin-top: 1em">Guarantee: All reposurgeon
operations either preserve all repository state they are not
explicitly told to modify or warn you when they cannot do
so.</p>

<p style="margin-top: 1em">Guarantee: reposurgeon handles
the bzr commit-properties extension, correctly passing
through property items including those with embedded
newlines. (Such properties are also <br>
editable in the mailbox format.)</p>

<p style="margin-top: 1em">Limitation: Because reposurgeon
relies on other programs to generate and interpret the
fast-import command stream, it is subject to bugs in those
programs.</p>

<p style="margin-top: 1em">Limitation: bzr suffers from
deep confusion over whether its unit of work is a repository
or a floating branch that might have been cloned from a repo
or created from scratch, <br>
and might or might not be destined to be merged to a repo
one day. Its exporter only works on branches, but its
importer creates repos. Thus, a rebuild operation will
produce a <br>
subdirectory structure that differs from what you expect.
Look for your content under the subdirectory
&rsquo;trunk&rsquo;.</p>

<p style="margin-top: 1em">Limitation: under git, signed
tags are imported verbatim. However, any operation that
modifies any commit upstream of the target of the tag will
invalidate it.</p>

<p style="margin-top: 1em">Limitation: Stock git (at least
as of version 1.7.3.2) will choke on property extension
commands. Accordingly, reposurgeon omits them when
rebuilding a repo with git type.</p>

<p style="margin-top: 1em">Limitation: Converting an hg
repo that uses bookmarks (not branches) to git can lose
information; the branch ref that git assigns to each commit
may not be the same as the hg <br>
bookmark that was active when the commit was originally made
under hg. Unfortunately, this is a real ontological
mismatch, not a problem that can be fixed by cleverness in
<br>
reposurgeon.</p>

<p style="margin-top: 1em">Limitation: Converting an hg
repo that uses branches to git can lose information because
git does not store an explicit branch as part of commit
metadata, but colors commits with <br>
branch or tag names on the fly using a specific coloring
algorithm, which might not match the explicit branch
assignments to commits in the original hg repo. Reposurgeon
<br>
preserves the hg branch information when reading an hg repo,
so it is available from within reposurgeon itself, but there
is no way to preserve it if the repo is written to git.</p>

<p style="margin-top: 1em">Limitation: While the Subversion
read-side support is in good shape, the write-side support
is more of a sketch or proof-of-concept than a robust
implementation; it only works on <br>
very simple cases and does not round-trip. It may improve in
future releases.</p>

<p style="margin-top: 1em">Limitation: Not all BitKeeper
versions have the fast-import and fast-export commands that
reposurgeon requires. They are present back to the 7.3
opensource version.</p>

<p style="margin-top: 1em">Limitation: reposurgeon may
misbehave under a filesystem which smashes case in
filenames, or which nominally preserves case but maps names
differing only by case to the same <br>
filesystem node (Mac OS X behaves like this by default).
Problems will arise if any two paths in a repo differ by
case only. To avoid the problem on a Mac, do all your
surgery on <br>
an HFS+ file system formatted with case sensitivity
specifically enabled.</p>

<p style="margin-top: 1em">Limitation: If whitespace
followed by # appears in a string or regexp command
argument, it will be misinterpreted as the beginning of a
line-ending comment and screw up parsing.</p>

<p style="margin-top: 1em">Guarantee: As version-control
systems add support for the fast-import format, their
repositories will become editable by reposurgeon.</p>

<p style="margin-top: 1em">REQUIREMENTS <br>
reposurgeon relies on importers and exporters associated
with the VCSes it supports.</p>

<p style="margin-top: 1em">git <br>
Core git supports both export and import.</p>

<p style="margin-top: 1em">bzr <br>
Requires bzr plus the bzr-fast-import plugin.</p>

<p style="margin-top: 1em">hg <br>
Requires core hg, the hg-fastimport plugin, and the
third-party hg-fast-export.py script.</p>

<p style="margin-top: 1em">svn <br>
Stock Subversion commands support export and import.</p>

<p style="margin-top: 1em">darcs <br>
Stock darcs commands support export and import.</p>

<p style="margin-top: 1em">CVS <br>
Requires cvs-fast-export. Note that the quality of CVS lifts
may be poor, with individual lifts requiring serious
hand-hacking. This is due to inherent problems with
CVS&rsquo;s <br>
file-oriented model.</p>

<p style="margin-top: 1em">RCS <br>
Requires cvs-fast-export (yes, that&rsquo;s not a typo;
cvs-fast-export handles RCS collections as well). The caveat
for CVS applies.</p>

<p style="margin-top: 1em">CANONICALIZATION RULES <br>
It is expected that reposurgeon will be extended with more
deletion policies. Policy authors may need to know more
about how a commit&rsquo;s file operation sequence is
reduced to <br>
normal form after operations from deleted commits are
prepended to it.</p>

<p style="margin-top: 1em">Recall that each commit has a
list of file operations, each a M (modify), D (delete), R
(rename), C (copy), or &rsquo;deleteall&rsquo; (delete all
files). Only M operations have associated <br>
blobs. Normally there is only one M operation per individual
file in a commit&rsquo;s operation list.</p>

<p style="margin-top: 1em">To understand how the reduction
process works, it&rsquo;s enough to understand the case
where all the operation in the list are working on the same
file. Sublists of operations <br>
referring to different files don&rsquo;t affect each other
and reducing them can be thought of as separate operations.
Also, a &quot;deleteall&quot; acts as a D for everything and
cancels all <br>
operations before it in the list.</p>

<p style="margin-top: 1em">The reduction process walks
through the list from the beginning looking for adjacent
pairs of operations it can compose. The following table
describes all possible cases and all <br>
but one of the reductions.</p>


<p style="margin-top: 1em">&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;
<br>
&acirc; M + D &acirc; D &acirc; &acirc; <br>
&acirc; &acirc; If a file is modified then deleted, the
result is as &acirc; <br>
&acirc; &acirc; though it had been deleted. If the M was the
only &acirc; <br>
&acirc; &acirc; modify for the file, it&rsquo;s removed too.
&acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;M a + R a b &acirc; R a b + M b &acirc; &acirc; <br>
&acirc; &acirc; The purpose of this transformation is to
push renames &acirc; <br>
&acirc; &acirc; toward the beginning of the list, where they
may become &acirc; <br>
&acirc; &acirc; adjacent to another R or C they can be
composed with. &acirc; <br>
&acirc; &acirc; If the M is the only modify operation for
this file, &acirc; <br>
&acirc; &acirc; the rename is dropped. &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; M a + C a b &acirc; &acirc; <br>
&acirc; &acirc; No reduction. &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; M b + R a b &acirc; nothing &acirc; &acirc; <br>
&acirc; &acirc; Should be impossible, and may indicate
repository &acirc; <br>
&acirc; &acirc; corruption. &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; M b + C a b &acirc; nothing &acirc; &acirc; <br>
&acirc; &acirc; The copy undoes the modification. &acirc;
<br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; D + M &acirc; M &acirc; &acirc; <br>
&acirc; &acirc; If a file is deleted and modified, the
result is as &acirc; <br>
&acirc; &acirc; though the deletion had not taken place
(because M &acirc; <br>
&acirc; &acirc; operations store entire files, not deltas).
&acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; D + {D|R|C} &acirc; &acirc; <br>
&acirc; &acirc; These cases should be impossible and would
suggest the &acirc; <br>
&acirc; &acirc; repository has been corrupted. &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; R a b + D a &acirc; &acirc; <br>
&acirc; &acirc; Should never happen, and is another case
that would &acirc; <br>
&acirc; &acirc; suggest repository corruption. &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; R a b + D b &acirc; D a &acirc; &acirc; <br>
&acirc; &acirc; The delete removes the just-renamed file.
&acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; {R|C} + M &acirc; &acirc; <br>
&acirc; &acirc; No reduction. &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; R a b + R b c &acirc; R a c &acirc; &acirc; <br>
&acirc; &acirc; The b terms have to match for these
operations to have &acirc; <br>
&acirc; &acirc; made sense when they lived in separate
commits; if they &acirc; <br>
&acirc; &acirc; don&rsquo;t, it indicates repository
corruption. &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; R a b + C b c &acirc; &acirc; <br>
&acirc; &acirc; No reduction. &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; C a b + D a &acirc; R a b &acirc; &acirc; <br>
&acirc; &acirc; Copy followed by delete of the source is a
rename. &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; C a b + D b &acirc; nothing &acirc; &acirc; <br>
&acirc; &acirc; This delete undoes the copy. &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; C a b + R a c &acirc; &acirc; <br>
&acirc; &acirc; No reduction. &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; C a b + R b c &acirc; C a c &acirc; &acirc; <br>
&acirc; &acirc; Copy followed by a rename of the target
reduces to &acirc; <br>
&acirc; &acirc; single copy &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc; C + C &acirc; &acirc; <br>
&acirc; &acirc; No reduction. &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;</p>

<p style="margin-top: 1em">CRASH RECOVERY <br>
This section will become relevant only if reposurgeon or
something underneath it in the software and hardware stack
crashes while in the middle of writing out a repository, in
<br>
particular if the target directory of the rebuild is your
current directory.</p>

<p style="margin-top: 1em">The tool has two conflicting
objectives. On the one hand, we never want to risk
clobbering a pre-existing repo. On the other hand, we want
to be able to run this tool in a <br>
directory with a repo and modify it in place.</p>

<p style="margin-top: 1em">We resolve this dilemma by
playing a game of three-directory monte.</p>

<p style="margin-top: 1em">1. First, we build the repo in a
freshly-created staging directory. If your target directory
is named /path/to/foo, the staging directory will be a peer
named <br>
/path/to/foo-stageNNNN, where NNNN is a cookie derived from
reposurgeon&rsquo;s process ID.</p>

<p style="margin-top: 1em">2. We then make an empty backup
directory. This directory will be named /path/to/foo.~N~,
where N is incremented so as not to conflict with any
existing backup directories. <br>
reposurgeon never, under any circumstances, ever deletes a
backup directory.</p>

<p style="margin-top: 1em">So far, all operations are safe;
the worst that can happen up to this point if the process
gets interrupted is that the staging and backup directories
get left behind.</p>

<p style="margin-top: 1em">3. The critical region begins.
We first move everything in the target directory to the
backup directory.</p>

<p style="margin-top: 1em">4. Then we move everything in
the staging directory to the target.</p>

<p style="margin-top: 1em">5. We finish off by restoring
untracked files in the target directory from the backup
directory. That ends the critical region.</p>

<p style="margin-top: 1em">During the critical region, all
signals that can be ignored are ignored.</p>

<p style="margin-top: 1em">ERROR RETURNS <br>
Returns 1 on fatal error, 0 otherwise. In batch mode all
errors are fatal.</p>

<p style="margin-top: 1em">SEE ALSO <br>
bzr(1), cvs(1), darcs(1), git(1), hg(1), rcs(1), svn(1).
bk(1).</p>

<p style="margin-top: 1em">AUTHOR <br>
Eric S. Raymond &lt;esr@thyrsus.com&gt;; project page at
http://www.catb.org/~esr/reposurgeon.</p>

<p style="margin-top: 1em">NOTES <br>
1. DVCS Migration HOWTO <br>
http://www.catb.org/esr/dvcs-migration-guide.html</p>

<p style="margin-top: 1em">2. Python&rsquo;s <br>
http://docs.python.org/2/library/re.html</p>

<p style="margin-top: 1em">reposurgeon 03/18/2017
REPOSURGEON(1)</p>
<hr>
</body>
</html>
