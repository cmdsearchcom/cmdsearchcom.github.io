<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>CA(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">CA(1)</td>
    <td class="head-vol">OpenSSL</td>
    <td class="head-rtitle">CA(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
ca - sample minimal CA application
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>openssl</b> <b>ca</b> [ <b>-verbose</b>] [ <b>-config filename</b>] [
  <b>-name section</b>] [ <b>-gencrl</b>] [ <b>-revoke file</b>] [
  <b>-crl_reason reason</b>] [ <b>-crl_hold instruction</b>] [
  <b>-crl_compromise time</b>] [ <b>-crl_CA_compromise time</b>] [ <b>-crldays
  days</b>] [ <b>-crlhours hours</b>] [ <b>-crlexts section</b>] [ <b>-startdate
  date</b>] [ <b>-enddate date</b>] [ <b>-days arg</b>] [ <b>-md arg</b>] [
  <b>-policy arg</b>] [ <b>-keyfile arg</b>] [ <b>-key arg</b>] [ <b>-passin
  arg</b>] [ <b>-cert file</b>] [ <b>-selfsign</b>] [ <b>-in file</b>] [ <b>-out
  file</b>] [ <b>-notext</b>] [ <b>-outdir dir</b>] [ <b>-infiles</b>] [
  <b>-spkac file</b>] [ <b>-ss_cert file</b>] [ <b>-preserveDN</b>] [
  <b>-noemailDN</b>] [ <b>-batch</b>] [ <b>-msie_hack</b>] [ <b>-extensions
  section</b>] [ <b>-extfile section</b>] [ <b>-engine id</b>] [ <b>-subj
  arg</b>] [ <b>-utf8</b>] [ <b>-multivalue-rdn</b>]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <b>ca</b> command is a minimal CA application. It can be used to sign
  certificate requests in a variety of forms and generate CRLs it also maintains
  a text database of issued certificates and their status.
<div class="Pp"></div>
The options descriptions will be divided into each purpose.
<h1 class="Sh" title="Sh" id="CA_OPTIONS"><a class="selflink" href="#CA_OPTIONS">CA
  OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-config filename</b></dt>
  <dd class="It-tag">specifies the configuration file to use.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-name section</b></dt>
  <dd class="It-tag">specifies the configuration file section to use (overrides
      <b>default_ca</b> in the <b>ca</b> section).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-in filename</b></dt>
  <dd class="It-tag">an input filename containing a single certificate request
      to be signed by the CA.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-ss_cert filename</b></dt>
  <dd class="It-tag">a single self signed certificate to be signed by the
    CA.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-spkac filename</b></dt>
  <dd class="It-tag">a file containing a single Netscape signed public key and
      challenge and additional field values to be signed by the CA. See the
      <b>SPKAC FORMAT</b> section for information on the required format.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-infiles</b></dt>
  <dd class="It-tag">if present this should be the last option, all subsequent
      arguments are assumed to the the names of files containing certificate
      requests.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-out filename</b></dt>
  <dd class="It-tag">the output file to output certificates to. The default is
      standard output. The certificate details will also be printed out to this
      file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-outdir directory</b></dt>
  <dd class="It-tag">the directory to output certificates to. The certificate
      will be written to a filename consisting of the serial number in hex with
      &quot;.pem&quot; appended.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-cert</b></dt>
  <dd class="It-tag">the CA certificate file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-keyfile filename</b></dt>
  <dd class="It-tag">the private key to sign requests with.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-key password</b></dt>
  <dd class="It-tag">the password used to encrypt the private key. Since on some
      systems the command line arguments are visible (e.g. Unix with the 'ps'
      utility) this option should be used with caution.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-selfsign</b></dt>
  <dd class="It-tag">indicates the issued certificates are to be signed with the
      key the certificate requests were signed with (given with
      <b>-keyfile</b>). Cerificate requests signed with a different key are
      ignored. If <b>-spkac</b>, <b>-ss_cert</b> or <b>-gencrl</b> are given,
      <b>-selfsign</b> is ignored.
    <div style="height: 1.00em;">&#x00A0;</div>
    A consequence of using <b>-selfsign</b> is that the self-signed certificate
      appears among the entries in the certificate database (see the
      configuration option <b>database</b>), and uses the same serial number
      counter as all other certificates sign with the self-signed
    certificate.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-passin arg</b></dt>
  <dd class="It-tag">the key password source. For more information about the
      format of <b>arg</b> see the <b>PASS PHRASE ARGUMENTS</b> section in
      <i>openssl</i>(1).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-verbose</b></dt>
  <dd class="It-tag">this prints extra details about the operations being
      performed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-notext</b></dt>
  <dd class="It-tag">don't output the text form of a certificate to the output
      file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-startdate date</b></dt>
  <dd class="It-tag">this allows the start date to be explicitly set. The format
      of the date is YYMMDDHHMMSSZ (the same as an ASN1 UTCTime structure).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-enddate date</b></dt>
  <dd class="It-tag">this allows the expiry date to be explicitly set. The
      format of the date is YYMMDDHHMMSSZ (the same as an ASN1 UTCTime
      structure).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-days arg</b></dt>
  <dd class="It-tag">the number of days to certify the certificate for.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-md alg</b></dt>
  <dd class="It-tag">the message digest to use. Possible values include md5,
      sha1 and mdc2. For full list of digests see openssl dgst -h output. This
      option also applies to CRLs.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-policy arg</b></dt>
  <dd class="It-tag">this option defines the CA &quot;policy&quot; to use. This
      is a section in the configuration file which decides which fields should
      be mandatory or match the CA certificate. Check out the <b>POLICY
      FORMAT</b> section for more information.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-msie_hack</b></dt>
  <dd class="It-tag">this is a legacy option to make <b>ca</b> work with very
      old versions of the IE certificate enrollment control
      &quot;certenr3&quot;. It used UniversalStrings for almost everything.
      Since the old control has various security bugs its use is strongly
      discouraged. The newer control &quot;Xenroll&quot; does not need this
      option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-preserveDN</b></dt>
  <dd class="It-tag">Normally the DN order of a certificate is the same as the
      order of the fields in the relevant policy section. When this option is
      set the order is the same as the request. This is largely for
      compatibility with the older IE enrollment control which would only accept
      certificates if their DNs match the order of the request. This is not
      needed for Xenroll.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-noemailDN</b></dt>
  <dd class="It-tag">The DN of a certificate can contain the EMAIL field if
      present in the request DN, however it is good policy just having the
      e-mail set into the altName extension of the certificate. When this option
      is set the EMAIL field is removed from the certificate' subject and set
      only in the, eventually present, extensions. The <b>email_in_dn</b>
      keyword can be used in the configuration file to enable this
    behaviour.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-batch</b></dt>
  <dd class="It-tag">this sets the batch mode. In this mode no questions will be
      asked and all certificates will be certified automatically.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-extensions section</b></dt>
  <dd class="It-tag">the section of the configuration file containing
      certificate extensions to be added when a certificate is issued (defaults
      to <b>x509_extensions</b> unless the <b>-extfile</b> option is used). If
      no extension section is present then, a V1 certificate is created. If the
      extension section is present (even if it is empty), then a V3 certificate
      is created. See the:w <i>x509v3_config</i>(5) manual page for details of
      the extension section format.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-extfile file</b></dt>
  <dd class="It-tag">an additional configuration file to read certificate
      extensions from (using the default section unless the <b>-extensions</b>
      option is also used).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-engine id</b></dt>
  <dd class="It-tag">specifying an engine (by its unique <b>id</b> string) will
      cause <b>ca</b> to attempt to obtain a functional reference to the
      specified engine, thus initialising it if needed. The engine will then be
      set as the default for all available algorithms.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-subj arg</b></dt>
  <dd class="It-tag">supersedes subject name given in the request. The arg must
      be formatted as <i>/type0=value0/type1=value1/type2=...</i>, characters
      may be escaped by \ (backslash), no spaces are skipped.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-utf8</b></dt>
  <dd class="It-tag">this option causes field values to be interpreted as UTF8
      strings, by default they are interpreted as ASCII. This means that the
      field values, whether prompted from a terminal or obtained from a
      configuration file, must be valid UTF8 strings.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-multivalue-rdn</b></dt>
  <dd class="It-tag">this option causes the -subj argument to be interpretedt
      with full support for multivalued RDNs. Example:
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>/DC=org/DC=OpenSSL/DC=users/UID=123456+CN=John Doe</i>
    <div style="height: 1.00em;">&#x00A0;</div>
    If -multi-rdn is not used then the UID value is <i>123456+CN=John
    Doe</i>.</dd>
</dl>
<h1 class="Sh" title="Sh" id="CRL_OPTIONS"><a class="selflink" href="#CRL_OPTIONS">CRL
  OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-gencrl</b></dt>
  <dd class="It-tag">this option generates a CRL based on information in the
      index file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-crldays num</b></dt>
  <dd class="It-tag">the number of days before the next CRL is due. That is the
      days from now to place in the CRL nextUpdate field.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-crlhours num</b></dt>
  <dd class="It-tag">the number of hours before the next CRL is due.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-revoke filename</b></dt>
  <dd class="It-tag">a filename containing a certificate to revoke.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-crl_reason reason</b></dt>
  <dd class="It-tag">revocation reason, where <b>reason</b> is one of:
      <b>unspecified</b>, <b>keyCompromise</b>, <b>CACompromise</b>,
      <b>affiliationChanged</b>, <b>superseded</b>, <b>cessationOfOperation</b>,
      <b>certificateHold</b> or <b>removeFromCRL</b>. The matching of
      <b>reason</b> is case insensitive. Setting any revocation reason will make
      the CRL v2.
    <div style="height: 1.00em;">&#x00A0;</div>
    In practive <b>removeFromCRL</b> is not particularly useful because it is
      only used in delta CRLs which are not currently implemented.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-crl_hold instruction</b></dt>
  <dd class="It-tag">This sets the CRL revocation reason code to
      <b>certificateHold</b> and the hold instruction to <b>instruction</b>
      which must be an OID. Although any OID can be used only
      <b>holdInstructionNone</b> (the use of which is discouraged by RFC2459)
      <b>holdInstructionCallIssuer</b> or <b>holdInstructionReject</b> will
      normally be used.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-crl_compromise time</b></dt>
  <dd class="It-tag">This sets the revocation reason to <b>keyCompromise</b> and
      the compromise time to <b>time</b>. <b>time</b> should be in
      GeneralizedTime format that is <b>YYYYMMDDHHMMSSZ</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-crl_CA_compromise time</b></dt>
  <dd class="It-tag">This is the same as <b>crl_compromise</b> except the
      revocation reason is set to <b>CACompromise</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-crlexts section</b></dt>
  <dd class="It-tag">the section of the configuration file containing CRL
      extensions to include. If no CRL extension section is present then a V1
      CRL is created, if the CRL extension section is present (even if it is
      empty) then a V2 CRL is created. The CRL extensions specified are CRL
      extensions and <b>not</b> CRL entry extensions. It should be noted that
      some software (for example Netscape) can't handle V2 CRLs. See
      <i>x509v3_config</i>(5) manual page for details of the extension section
      format.</dd>
</dl>
<h1 class="Sh" title="Sh" id="CONFIGURATION_FILE_OPTIONS"><a class="selflink" href="#CONFIGURATION_FILE_OPTIONS">CONFIGURATION
  FILE OPTIONS</a></h1>
The section of the configuration file containing options for <b>ca</b> is found
  as follows: If the <b>-name</b> command line option is used, then it names the
  section to be used. Otherwise the section to be used must be named in the
  <b>default_ca</b> option of the <b>ca</b> section of the configuration file
  (or in the default section of the configuration file). Besides
  <b>default_ca</b>, the following options are read directly from the <b>ca</b>
  section:
<br/>
 RANDFILE preserve
<br/>
 msie_hack With the exception of <b>RANDFILE</b>, this is probably a bug and may
  change in future releases.
<div class="Pp"></div>
Many of the configuration file options are identical to command line options.
  Where the option is present in the configuration file and the command line the
  command line value is used. Where an option is described as mandatory then it
  must be present in the configuration file or the command line equivalent (if
  any) used.
<dl class="Bl-tag">
  <dt class="It-tag"><b>oid_file</b></dt>
  <dd class="It-tag">This specifies a file containing additional <b>OBJECT
      IDENTIFIERS</b>. Each line of the file should consist of the numerical
      form of the object identifier followed by white space then the short name
      followed by white space and finally the long name.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>oid_section</b></dt>
  <dd class="It-tag">This specifies a section in the configuration file
      containing extra object identifiers. Each line should consist of the short
      name of the object identifier followed by <b>=</b> and the numerical form.
      The short and long names are the same when this option is used.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>new_certs_dir</b></dt>
  <dd class="It-tag">the same as the <b>-outdir</b> command line option. It
      specifies the directory where new certificates will be placed.
    Mandatory.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>certificate</b></dt>
  <dd class="It-tag">the same as <b>-cert</b>. It gives the file containing the
      CA certificate. Mandatory.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>private_key</b></dt>
  <dd class="It-tag">same as the <b>-keyfile</b> option. The file containing the
      CA private key. Mandatory.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>RANDFILE</b></dt>
  <dd class="It-tag">a file used to read and write random number seed
      information, or an EGD socket (see <i>RAND_egd</i>(3)).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>default_days</b></dt>
  <dd class="It-tag">the same as the <b>-days</b> option. The number of days to
      certify a certificate for.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>default_startdate</b></dt>
  <dd class="It-tag">the same as the <b>-startdate</b> option. The start date to
      certify a certificate for. If not set the current time is used.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>default_enddate</b></dt>
  <dd class="It-tag">the same as the <b>-enddate</b> option. Either this option
      or <b>default_days</b> (or the command line equivalents) must be
    present.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>default_crl_hours default_crl_days</b></dt>
  <dd class="It-tag">the same as the <b>-crlhours</b> and the <b>-crldays</b>
      options. These will only be used if neither command line option is
      present. At least one of these must be present to generate a CRL.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>default_md</b></dt>
  <dd class="It-tag">the same as the <b>-md</b> option. The message digest to
      use. Mandatory.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>database</b></dt>
  <dd class="It-tag">the text database file to use. Mandatory. This file must be
      present though initially it will be empty.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>unique_subject</b></dt>
  <dd class="It-tag">if the value <b>yes</b> is given, the valid certificate
      entries in the database must have unique subjects. if the value <b>no</b>
      is given, several valid certificate entries may have the exact same
      subject. The default value is <b>yes</b>, to be compatible with older (pre
      0.9.8) versions of OpenSSL. However, to make CA certificate roll-over
      easier, it's recommended to use the value <b>no</b>, especially if
      combined with the <b>-selfsign</b> command line option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>serial</b></dt>
  <dd class="It-tag">a text file containing the next serial number to use in
      hex. Mandatory. This file must be present and contain a valid serial
      number.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>crlnumber</b></dt>
  <dd class="It-tag">a text file containing the next CRL number to use in hex.
      The crl number will be inserted in the CRLs only if this file exists. If
      this file is present, it must contain a valid CRL number.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>x509_extensions</b></dt>
  <dd class="It-tag">the same as <b>-extensions</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>crl_extensions</b></dt>
  <dd class="It-tag">the same as <b>-crlexts</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>preserve</b></dt>
  <dd class="It-tag">the same as <b>-preserveDN</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>email_in_dn</b></dt>
  <dd class="It-tag">the same as <b>-noemailDN</b>. If you want the EMAIL field
      to be removed from the DN of the certificate simply set this to 'no'. If
      not present the default is to allow for the EMAIL filed in the
      certificate's DN.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>msie_hack</b></dt>
  <dd class="It-tag">the same as <b>-msie_hack</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>policy</b></dt>
  <dd class="It-tag">the same as <b>-policy</b>. Mandatory. See the <b>POLICY
      FORMAT</b> section for more information.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>name_opt</b>, <b>cert_opt</b></dt>
  <dd class="It-tag">these options allow the format used to display the
      certificate details when asking the user to confirm signing. All the
      options supported by the <b>x509</b> utilities <b>-nameopt</b> and
      <b>-certopt</b> switches can be used here, except the <b>no_signame</b>
      and <b>no_sigdump</b> are permanently set and cannot be disabled (this is
      because the certificate signature cannot be displayed because the
      certificate has not been signed at this point).
    <div style="height: 1.00em;">&#x00A0;</div>
    For convenience the values <b>ca_default</b> are accepted by both to produce
      a reasonable output.
    <div style="height: 1.00em;">&#x00A0;</div>
    If neither option is present the format used in earlier versions of OpenSSL
      is used. Use of the old format is <b>strongly</b> discouraged because it
      only displays fields mentioned in the <b>policy</b> section, mishandles
      multicharacter string types and does not display extensions.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>copy_extensions</b></dt>
  <dd class="It-tag">determines how extensions in certificate requests should be
      handled. If set to <b>none</b> or this option is not present then
      extensions are ignored and not copied to the certificate. If set to
      <b>copy</b> then any extensions present in the request that are not
      already present are copied to the certificate. If set to <b>copyall</b>
      then all extensions in the request are copied to the certificate: if the
      extension is already present in the certificate it is deleted first. See
      the <b>WARNINGS</b> section before using this option.
    <div style="height: 1.00em;">&#x00A0;</div>
    The main use of this option is to allow a certificate request to supply
      values for certain extensions such as subjectAltName.</dd>
</dl>
<h1 class="Sh" title="Sh" id="POLICY_FORMAT"><a class="selflink" href="#POLICY_FORMAT">POLICY
  FORMAT</a></h1>
The policy section consists of a set of variables corresponding to certificate
  DN fields. If the value is &quot;match&quot; then the field value must match
  the same field in the CA certificate. If the value is &quot;supplied&quot;
  then it must be present. If the value is &quot;optional&quot; then it may be
  present. Any fields not mentioned in the policy section are silently deleted,
  unless the <b>-preserveDN</b> option is set but this can be regarded more of a
  quirk than intended behaviour.
<h1 class="Sh" title="Sh" id="SPKAC_FORMAT"><a class="selflink" href="#SPKAC_FORMAT">SPKAC
  FORMAT</a></h1>
The input to the <b>-spkac</b> command line option is a Netscape signed public
  key and challenge. This will usually come from the <b>KEYGEN</b> tag in an
  HTML form to create a new private key. It is however possible to create SPKACs
  using the <b>spkac</b> utility.
<div class="Pp"></div>
The file should contain the variable SPKAC set to the value of the SPKAC and
  also the required DN components as name value pairs. If you need to include
  the same component twice then it can be preceded by a number and a '.'.
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
Note: these examples assume that the <b>ca</b> directory structure is already
  set up and the relevant files already exist. This usually involves creating a
  CA certificate and private key with <b>req</b>, a serial number file and an
  empty index file and placing them in the relevant directories.
<div class="Pp"></div>
To use the sample configuration file below the directories demoCA,
  demoCA/private and demoCA/newcerts would be created. The CA certificate would
  be copied to demoCA/cacert.pem and its private key to
  demoCA/private/cakey.pem. A file demoCA/serial would be created containing for
  example &quot;01&quot; and the empty index file demoCA/index.txt.
<div class="Pp"></div>
Sign a certificate request:
<div class="Pp"></div>
<pre>
 openssl ca -in req.pem -out newcert.pem
</pre>
<div class="Pp"></div>
Sign a certificate request, using CA extensions:
<div class="Pp"></div>
<pre>
 openssl ca -in req.pem -extensions v3_ca -out newcert.pem
</pre>
<div class="Pp"></div>
Generate a CRL
<div class="Pp"></div>
<pre>
 openssl ca -gencrl -out crl.pem
</pre>
<div class="Pp"></div>
Sign several requests:
<div class="Pp"></div>
<pre>
 openssl ca -infiles req1.pem req2.pem req3.pem
</pre>
<div class="Pp"></div>
Certify a Netscape SPKAC:
<div class="Pp"></div>
<pre>
 openssl ca -spkac spkac.txt
</pre>
<div class="Pp"></div>
A sample SPKAC file (the SPKAC line has been truncated for clarity):
<div class="Pp"></div>
<pre>
 SPKAC=MIG0MGAwXDANBgkqhkiG9w0BAQEFAANLADBIAkEAn7PDhCeV/xIxUg8V70YRxK2A5
 CN=Steve Test
 emailAddress=steve@openssl.org
 0.OU=OpenSSL Group
 1.OU=Another Group
</pre>
<div class="Pp"></div>
A sample configuration file with the relevant sections for <b>ca</b>:
<div class="Pp"></div>
<pre>
 [ ca ]
 default_ca      = CA_default            # The default ca section
 
 [ CA_default ]
 dir            = ./demoCA              # top dir
 database       = $dir/index.txt        # index file.
 new_certs_dir  = $dir/newcerts         # new certs dir
 
 certificate    = $dir/cacert.pem       # The CA cert
 serial         = $dir/serial           # serial no file
 private_key    = $dir/private/cakey.pem# CA private key
 RANDFILE       = $dir/private/.rand    # random number file
 
 default_days   = 365                   # how long to certify for
 default_crl_days= 30                   # how long before next CRL
 default_md     = md5                   # md to use
 policy         = policy_any            # default policy
 email_in_dn    = no                    # Don't add the email into cert DN
 name_opt       = ca_default            # Subject name display option
 cert_opt       = ca_default            # Certificate display option
 copy_extensions = none                 # Don't copy extensions from request
 [ policy_any ]
 countryName            = supplied
 stateOrProvinceName    = optional
 organizationName       = optional
 organizationalUnitName = optional
 commonName             = supplied
 emailAddress           = optional
</pre>
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
Note: the location of all files can change either by compile time options,
  configuration file entries, environment variables or command line options. The
  values below reflect the default values.
<div class="Pp"></div>
<pre>
 /usr/local/ssl/lib/openssl.cnf - master configuration file
 ./demoCA                       - main CA directory
 ./demoCA/cacert.pem            - CA certificate
 ./demoCA/private/cakey.pem     - CA private key
 ./demoCA/serial                - CA serial number file
 ./demoCA/serial.old            - CA serial number backup file
 ./demoCA/index.txt             - CA text database file
 ./demoCA/index.txt.old         - CA text database backup file
 ./demoCA/certs                 - certificate output file
 ./demoCA/.rnd                  - CA random seed information
</pre>
<h1 class="Sh" title="Sh" id="ENVIRONMENT_VARIABLES"><a class="selflink" href="#ENVIRONMENT_VARIABLES">ENVIRONMENT
  VARIABLES</a></h1>
<b>OPENSSL_CONF</b> reflects the location of master configuration file it can be
  overridden by the <b>-config</b> command line option.
<h1 class="Sh" title="Sh" id="RESTRICTIONS"><a class="selflink" href="#RESTRICTIONS">RESTRICTIONS</a></h1>
The text database index file is a critical part of the process and if corrupted
  it can be difficult to fix. It is theoretically possible to rebuild the index
  file from all the issued certificates and a current CRL: however there is no
  option to do this.
<div class="Pp"></div>
V2 CRL features like delta CRLs are not currently supported.
<div class="Pp"></div>
Although several requests can be input and handled at once it is only possible
  to include one SPKAC or self signed certificate.
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
The use of an in memory text database can cause problems when large numbers of
  certificates are present because, as the name implies the database has to be
  kept in memory.
<div class="Pp"></div>
The <b>ca</b> command really needs rewriting or the required functionality
  exposed at either a command or interface level so a more friendly utility
  (perl script or GUI) can handle things properly. The scripts <b>CA.sh</b> and
  <b>CA.pl</b> help a little but not very much.
<div class="Pp"></div>
Any fields in a request that are not present in a policy are silently deleted.
  This does not happen if the <b>-preserveDN</b> option is used. To enforce the
  absence of the EMAIL field within the DN, as suggested by RFCs, regardless the
  contents of the request' subject the <b>-noemailDN</b> option can be used. The
  behaviour should be more friendly and configurable.
<div class="Pp"></div>
Cancelling some commands by refusing to certify a certificate can create an
  empty file.
<h1 class="Sh" title="Sh" id="WARNINGS"><a class="selflink" href="#WARNINGS">WARNINGS</a></h1>
The <b>ca</b> command is quirky and at times downright unfriendly.
<div class="Pp"></div>
The <b>ca</b> utility was originally meant as an example of how to do things in
  a CA. It was not supposed to be used as a full blown CA itself: nevertheless
  some people are using it for this purpose.
<div class="Pp"></div>
The <b>ca</b> command is effectively a single user command: no locking is done
  on the various files and attempts to run more than one <b>ca</b> command on
  the same database can have unpredictable results.
<div class="Pp"></div>
The <b>copy_extensions</b> option should be used with caution. If care is not
  taken then it can be a security risk. For example if a certificate request
  contains a basicConstraints extension with CA:TRUE and the
  <b>copy_extensions</b> value is set to <b>copyall</b> and the user does not
  spot this when the certificate is displayed then this will hand the requestor
  a valid CA certificate.
<div class="Pp"></div>
This situation can be avoided by setting <b>copy_extensions</b> to <b>copy</b>
  and including basicConstraints with CA:FALSE in the configuration file. Then
  if the request contains a basicConstraints extension it will be ignored.
<div class="Pp"></div>
It is advisable to also include values for other extensions such as
  <b>keyUsage</b> to prevent a request supplying its own values.
<div class="Pp"></div>
Additional restrictions can be placed on the CA certificate itself. For example
  if the CA certificate has:
<div class="Pp"></div>
<pre>
 basicConstraints = CA:TRUE, pathlen:0
</pre>
<div class="Pp"></div>
then even if a certificate is issued with CA:TRUE it will not be valid.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i>req</i>(1), <i>spkac</i>(1), <i>x509</i>(1), <i>CA.pl</i>(1),
  <i>config</i>(5), <i>x509v3_config</i>(5)</div>
<table class="foot">
  <tr>
    <td class="foot-date">2017-02-20</td>
    <td class="foot-os">1.0.1e</td>
  </tr>
</table>
</body>
</html>
