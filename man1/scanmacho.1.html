<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>SCANMACHO(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">SCANMACHO(1)</td>
    <td class="head-vol">Documentation for pax-utils</td>
    <td class="head-rtitle">SCANMACHO(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
scanmacho - user-space utility to scan Mach-O files
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div class="Pp" style="margin-left: 10.00ex; text-indent: -10.00ex;"><b>scanmacho</b>
  [ <i>options</i>] <i>Mach-Os</i>&#x00A0;or&#x00A0;<i>directories</i></div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>scanmacho</b> is a user-space utility to quickly scan given Mach-Os,
  directories, or common system paths for different information. This may
  include Mach-O types, their install_names, etc...
<div class="Pp"></div>
Because Mach-O files can be &quot;fat&quot;, it is possible for a single file to
  return multiple lines. Each line represents a single architecture, contained
  in the fat (universal) file. While there are no real restrictions, in
  practice, the entries can be distinguished by their arch type, e.g. ppc,
  ppc64, i386, x86_64, arm, ...
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<b>-A</b>, <b>--archives</b>
<div style="margin-left: 4.00ex;">Scan archives (.a files)</div>
<div class="Pp"></div>
<b>-a</b>, <b>--all</b>
<div style="margin-left: 4.00ex;">Print all useful/simple info</div>
<div class="Pp"></div>
<b>-B</b>, <b>--nobanner</b>
<div style="margin-left: 4.00ex;">Don't display the header</div>
<div class="Pp"></div>
<b>-b</b>, <b>--bind</b>
<div style="margin-left: 4.00ex;">Print flags from mach_header</div>
<div class="Pp"></div>
<b>-D</b>, <b>--endian</b>
<div style="margin-left: 4.00ex;">Print Mach-O endianness</div>
<div class="Pp"></div>
<b>-E</b>, <b>--etype</b> <i>filetype</i>
<div style="margin-left: 4.00ex;">Print only Mach-O files matching specified
  etype (like MH_EXECUTABLE, MH_DYLIB, etc...)</div>
<div class="Pp"></div>
<b>-F</b>, <b>--format</b> <i>FORMAT</i>
<div style="margin-left: 4.00ex;">Use specified format for output; see the
  <b>FORMAT</b> section for more information.</div>
<div class="Pp"></div>
<b>-f</b>, <b>--from</b> <i>FILE</i>
<div style="margin-left: 4.00ex;">Read input stream from specified
  filename</div>
<div class="Pp"></div>
<b>-g</b>, <b>--gmatch</b>
<div style="margin-left: 4.00ex;">Use strncmp to match libraries (use with
  <b>-N</b>). Or regexp with symbol matching</div>
<div class="Pp"></div>
<b>-h</b>, <b>--help</b>
<div style="margin-left: 4.00ex;">Show condensed usage and exit</div>
<div class="Pp"></div>
<b>-i</b>, <b>--interp</b>
<div style="margin-left: 4.00ex;">Print the interpreter information
  (LC_LOAD_DYLINKER)</div>
<div class="Pp"></div>
<b>-M</b>, <b>--bits</b> <i>BITS</i>
<div style="margin-left: 4.00ex;">Print only Mach-O files matching specified
  numeric bits (like 32/64)</div>
<div class="Pp"></div>
<b>-m</b>, <b>--mount</b>
<div style="margin-left: 4.00ex;">Don't recursively cross mount points</div>
<div class="Pp"></div>
<b>-N</b>, <b>--lib</b> <i>INSTALLNAME</i>
<div style="margin-left: 4.00ex;">Find Mach-Os that need the specified
  INSTALL_NAME</div>
<div class="Pp"></div>
<b>-n</b>, <b>--needed</b>
<div style="margin-left: 4.00ex;">Print libraries the Mach-O is linked against
  (LC_LOAD_DYLIB).</div>
<div class="Pp"></div>
<b>-O</b>, <b>--perms</b> <i>PERMS</i>
<div style="margin-left: 4.00ex;">Print only Mach-O files with matching
  specified octal bits (like 755).</div>
<div class="Pp"></div>
<b>-o</b>, <b>--file</b> <i>FILE</i>
<div style="margin-left: 4.00ex;">Write output stream to specified
  filename.</div>
<div class="Pp"></div>
<b>-p</b>, <b>--path</b>
<div style="margin-left: 4.00ex;">Scan all directories in PATH
  environment.</div>
<div class="Pp"></div>
<b>-q</b>, <b>--quiet</b>
<div style="margin-left: 4.00ex;">Only output 'bad' things.</div>
<div class="Pp"></div>
<b>-R</b>, <b>--recursive</b>
<div style="margin-left: 4.00ex;">Scan directories recursively</div>
<div class="Pp"></div>
<b>-r</b>, <b>--rpath</b>
<div style="margin-left: 4.00ex;">Print RPATH encoded in the Mach-O
  (LC_RPATH)</div>
<div class="Pp"></div>
<b>-S</b>, <b>--soname</b>
<div style="margin-left: 4.00ex;">Print the Mach-O's shared library name
  (install_name).</div>
<div class="Pp"></div>
<b>-V</b>, <b>--version</b>
<div style="margin-left: 4.00ex;">Print version and exit</div>
<div class="Pp"></div>
<b>-v</b>, <b>--verbose</b>
<div style="margin-left: 4.00ex;">Be verbose (can be used more than once)</div>
<div class="Pp"></div>
<b>-y</b>, <b>--symlink</b>
<div style="margin-left: 4.00ex;">Don't scan symlinks</div>
<div class="Pp"></div>
<b>-Z</b>, <b>--size</b> <i>SIZE</i>
<div style="margin-left: 4.00ex;">Print Mach-O file size</div>
<h1 class="Sh" title="Sh" id="FORMAT"><a class="selflink" href="#FORMAT">FORMAT</a></h1>
The format string is much like a printf string in that it is a literal string
  with flags requesting different information. For example, you could use a
  format string and expect the following results.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
  #  <b>scanmacho</b> <b>-BF</b> &quot;file %f needs %n; funky time&quot; /bin/bash
  file bash needs /usr/lib/libncurses.5.4.dylib,/usr/lib/libSystem.B.dylib; funky time
 
</pre>
</div>
<div class="Pp"></div>
Note that when you use a format string, generally information related flags
  should be omitted. In other words, you do not want to try and request NEEDED
  output ( <b>-n</b>) and try to specify a format output at the same time as
  these operations are mutually exclusive. Each information related flag has an
  equivalent conversion specifier, so use those instead. You can of course
  continue to use non-information related flags (such as <b>--verbose</b>).
<div class="Pp"></div>
There are three characters that introduce conversion specifiers.
<div class="Pp"></div>
&#x2022; <b>%</b> - replace with info
<div style="height: 0.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>#</b> - silent boolean match
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>+</b> - verbose match</dd>
</dl>
<div class="Pp"></div>
And there are a number of conversion specifiers. We try to match up the
  specifier with corresponding option.
<div class="Pp"></div>
&#x2022; <b>a</b> - arch type
<div style="height: 0.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>b</b> - mach_header flags
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>D</b> - endian
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>F</b> - long filename
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>f</b> - short filename
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>i</b> - dyld
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>M</b> - CPU_TYPE class
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>N</b> - specified needed
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>n</b> - needed libraries
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>p</b> - filename (minus search)
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>o</b> - mh_type
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>O</b> - perms
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>r</b> - rpaths
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>S</b> - install_name
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="MACH-O_FILETYPES"><a class="selflink" href="#MACH-O_FILETYPES">MACH-O
  FILETYPES</a></h1>
You can narrow your search by specifying the Mach-O object file type. The
  commandline option takes the symbolic type name. Multiple values can be passed
  comma separated. Example -E MH_EXECUTE,MH_DYLIB
<div class="Pp"></div>
Here is the normal list available for your pleasure.
<div class="Pp"></div>
&#x2022; <b>MH_OBJECT</b> - intermediate object file (.o)
<div style="height: 0.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>MH_EXECUTE</b> - standard executable program
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>MH_BUNDLE</b> - dlopen plugin (.bundle)
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>MH_DYLIB</b> - dynamic shared library (.dylib)
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>MH_PRELOAD</b> - executable not loaded by Mac OS X
      kernel (ROM)
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>MH_CORE</b> - program crash core file
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>MH_DYLINKER</b> - dynamic linker shared library (dyld)
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>MH_DYLIB_STUB</b> - shared library stub for static only,
      no sections
    <div style="height: 0.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>MH_DSYM</b> - debug symbols file (in .dSYM dir)
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="MACH-O_BITS"><a class="selflink" href="#MACH-O_BITS">MACH-O
  BITS</a></h1>
You can also narrow your search by specifying the Mach-O bitsize. Specify the
  numeric value.
<div class="Pp"></div>
&#x2022; <b>32</b> - 32bit mach_header
<div style="height: 0.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>64</b> - 64bit mach_header_64
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="HOMEPAGE"><a class="selflink" href="#HOMEPAGE">HOMEPAGE</a></h1>
<b>http://hardened.gentoo.org/pax-utils.xml</b>
<h1 class="Sh" title="Sh" id="REPORTING_BUGS"><a class="selflink" href="#REPORTING_BUGS">REPORTING
  BUGS</a></h1>
Please include as much information as possible (using any available debugging
  options) and send bug reports to the maintainers (see the <b>AUTHORS</b>
  section). Please use the Gentoo bugzilla at <b>http://bugs.gentoo.org/</b> if
  possible.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>chpax</b>(1), <b>dumpelf</b>(1), <b>paxctl</b>(1), <b>pspax</b>(1),
  <b>readelf</b>(1), <b>scanelf</b>(1), <b>elf</b>(5)
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
<b>Ned Ludd</b> &lt;solar@gentoo.org&gt;
<div style="margin-left: 4.00ex;">Maintainer</div>
<div class="Pp"></div>
<b>Mike Frysinger</b> &lt;vapier@gentoo.org&gt;
<div style="margin-left: 4.00ex;">Maintainer</div>
<div class="Pp"></div>
<b>Fabian Groffen</b> &lt;grobian@gentoo.org&gt;
<div style="margin-left: 4.00ex;">Mach-O Maintainer</div>
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"> 1.</dt>
  <dd class="It-tag">http://hardened.gentoo.org/pax-utils.xml</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"> 2.</dt>
  <dd class="It-tag">http://bugs.gentoo.org/</dd>
</dl>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">01/24/2017</td>
    <td class="foot-os">pax-utils 1.2.2</td>
  </tr>
</table>
</body>
</html>
