<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>GEODSOLVE(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">GEODSOLVE(1)</td>
    <td class="head-vol">GeographicLib Utilities</td>
    <td class="head-rtitle">GEODSOLVE(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
GeodSolve -- perform geodesic calculations
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>GeodSolve</b> [ <b>-i</b> | <b>-L</b> <i>lat1</i> <i>lon1</i> <i>azi1</i> |
  <b>-D</b> <i>lat1</i> <i>lon1</i> <i>azi1</i> <i>s13</i> | <b>-I</b>
  <i>lat1</i> <i>lon1</i> <i>lat3</i> <i>lon3</i> ] [ <b>-a</b> ] [ <b>-e</b>
  <i>a</i> <i>f</i> ] [ <b>-u</b> ] [ <b>-F</b> ] [ <b>-d</b> | <b>-:</b> ] [
  <b>-w</b> ] [ <b>-b</b> ] [ <b>-f</b> ] [ <b>-p</b> <i>prec</i> ] [ <b>-E</b>
  ] [ <b>--comment-delimiter</b> <i>commentdelim</i> ] [ <b>--version</b> |
  <b>-h</b> | <b>--help</b> ] [ <b>--input-file</b> <i>infile</i> |
  <b>--input-string</b> <i>instring</i> ] [ <b>--line-separator</b>
  <i>linesep</i> ] [ <b>--output-file</b> <i>outfile</i> ]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The shortest path between two points on the ellipsoid at ( <i>lat1</i>,
  <i>lon1</i>) and ( <i>lat2</i>, <i>lon2</i>) is called the geodesic. Its
  length is <i>s12</i> and the geodesic from point 1 to point 2 has forward
  azimuths <i>azi1</i> and <i>azi2</i> at the two end points.
<div class="Pp"></div>
<b>GeodSolve</b> operates in one of three modes:
<dl class="Bl-tag">
  <dt class="It-tag">1.</dt>
  <dd class="It-tag">By default, <b>GeodSolve</b> accepts lines on the standard
      input containing <i>lat1</i> <i>lon1</i> <i>azi1</i> <i>s12</i> and prints
      <i>lat2</i> <i>lon2</i> <i>azi2</i> on standard output. This is the direct
      geodesic calculation.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">2.</dt>
  <dd class="It-tag">With the <b>-i</b> command line argument, <b>GeodSolve</b>
      performs the inverse geodesic calculation. It reads lines containing
      <i>lat1</i> <i>lon1</i> <i>lat2</i> <i>lon2</i> and prints the
      corresponding values of <i>azi1</i> <i>azi2</i> <i>s12</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">3.</dt>
  <dd class="It-tag">Command line arguments <b>-L</b> <i>lat1</i> <i>lon1</i>
      <i>azi1</i> specify a geodesic line. <b>GeodSolve</b> then accepts a
      sequence of <i>s12</i> values (one per line) on standard input and prints
      <i>lat2</i> <i>lon2</i> <i>azi2</i> for each. This generates a sequence of
      points on a single geodesic. Command line arguments <b>-D</b> and
      <b>-I</b> work similarly with the geodesic line defined in terms of a
      direct or inverse geodesic calculation, respectively.</dd>
</dl>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i</b></dt>
  <dd class="It-tag">perform an inverse geodesic calculation (see 2 above).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-L</b> <i>lat1</i> <i>lon1</i> <i>azi1</i></dt>
  <dd class="It-tag">line mode (see 3 above); generate a sequence of points
      along the geodesic specified by <i>lat1</i> <i>lon1</i> <i>azi1</i>. The
      <b>-w</b> flag can be used to swap the default order of the 2 geographic
      coordinates, provided that it appears before <b>-L</b>. (<b>-l</b> is an
      alternative, deprecated, spelling of this flag.)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-D</b> <i>lat1</i> <i>lon1</i> <i>azi1</i>
    <i>s13</i></dt>
  <dd class="It-tag">line mode (see 3 above); generate a sequence of points
      along the geodesic specified by <i>lat1</i> <i>lon1</i> <i>azi1</i>
      <i>s13</i>. The <b>-w</b> flag can be used to swap the default order of
      the 2 geographic coordinates, provided that it appears before <b>-D</b>.
      Similarly, the <b>-a</b> flag can be used to change the interpretation of
      <i>s13</i> to <i>a13</i>, provided that it appears before <b>-D</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-I</b> <i>lat1</i> <i>lon1</i> <i>lat3</i>
    <i>lon3</i></dt>
  <dd class="It-tag">line mode (see 3 above); generate a sequence of points
      along the geodesic specified by <i>lat1</i> <i>lon1</i> <i>lat3</i>
      <i>lon3</i>. The <b>-w</b> flag can be used to swap the default order of
      the 2 geographic coordinates, provided that it appears before
    <b>-I</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-a</b></dt>
  <dd class="It-tag">toggle the arc mode flag (it starts off); if this flag is
      on, then on input <i>and</i> output <i>s12</i> is replaced by <i>a12</i>
      the arc length (in degrees) on the auxiliary sphere. See &quot;AUXILIARY
      SPHERE&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-e</b> <i>a</i> <i>f</i></dt>
  <dd class="It-tag">specify the ellipsoid via the equatorial radius, <i>a</i>
      and the flattening, <i>f</i>. Setting <i>f</i> = 0 results in a sphere.
      Specify <i>f</i> &lt; 0 for a prolate ellipsoid. A simple fraction, e.g.,
      1/297, is allowed for <i>f</i>. By default, the WGS84 ellipsoid is used,
      <i>a</i> = 6378137 m, <i>f</i> = 1/298.257223563.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-u</b></dt>
  <dd class="It-tag">unroll the longitude. Normally, on output longitudes are
      reduced to lie in [-180deg,180deg). However with this option, the returned
      longitude <i>lon2</i> is &quot;unrolled&quot; so that <i>lon2</i> -
      <i>lon1</i> indicates how often and in what sense the geodesic has
      encircled the earth. Use the <b>-f</b> option, to get both longitudes
      printed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-F</b></dt>
  <dd class="It-tag">fractional mode. This only has any effect with the
      <b>-D</b> and <b>-I</b> options (and is otherwise ignored). The values
      read on standard input are interpreted as fractional distances to point 3,
      i.e., as <i>s12</i>/<i>s13</i> instead of <i>s12</i>. If arc mode is in
      effect, then the values denote fractional arc length, i.e.,
      <i>a12</i>/<i>a13</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d</b></dt>
  <dd class="It-tag">output angles as degrees, minutes, seconds instead of
      decimal degrees.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-:</b></dt>
  <dd class="It-tag">like <b>-d</b>, except use : as a separator instead of the
      d, ', and &quot; delimiters.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-w</b></dt>
  <dd class="It-tag">toggle the longitude first flag (it starts off); if the
      flag is on, then on input and output, longitude precedes latitude (except
      that, on input, this can be overridden by a hemisphere designator,
      <i>N</i>, <i>S</i>, <i>E</i>, <i>W</i>).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-b</b></dt>
  <dd class="It-tag">report the <i>back</i> azimuth at point 2 instead of the
      forward azimuth.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b></dt>
  <dd class="It-tag">full output; each line of output consists of 12 quantities:
      <i>lat1</i> <i>lon1</i> <i>azi1</i> <i>lat2</i> <i>lon2</i> <i>azi2</i>
      <i>s12</i> <i>a12</i> <i>m12</i> <i>M12</i> <i>M21</i> <i>S12</i>.
      <i>a12</i> is described in &quot;AUXILIARY SPHERE&quot;. The four
      quantities <i>m12</i>, <i>M12</i>, <i>M21</i>, and <i>S12</i> are
      described in &quot;ADDITIONAL QUANTITIES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p</b> <i>prec</i></dt>
  <dd class="It-tag">set the output precision to <i>prec</i> (default 3);
      <i>prec</i> is the precision relative to 1 m. See
    &quot;PRECISION&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-E</b></dt>
  <dd class="It-tag">use &quot;exact&quot; algorithms (based on elliptic
      integrals) for the geodesic calculations. These are more accurate than the
      (default) series expansions for | <i>f</i>| &gt; 0.02.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--comment-delimiter</b> <i>commentdelim</i></dt>
  <dd class="It-tag">set the comment delimiter to <i>commentdelim</i> (e.g.,
      &quot;#&quot; or &quot;//&quot;). If set, the input lines will be scanned
      for this delimiter and, if found, the delimiter and the rest of the line
      will be removed prior to processing and subsequently appended to the
      output line (separated by a space).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--version</b></dt>
  <dd class="It-tag">print version and exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h</b></dt>
  <dd class="It-tag">print usage and exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">print full documentation and exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--input-file</b> <i>infile</i></dt>
  <dd class="It-tag">read input from the file <i>infile</i> instead of from
      standard input; a file name of &quot;-&quot; stands for standard
    input.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--input-string</b> <i>instring</i></dt>
  <dd class="It-tag">read input from the string <i>instring</i> instead of from
      standard input. All occurrences of the line separator character (default
      is a semicolon) in <i>instring</i> are converted to newlines before the
      reading begins.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--line-separator</b> <i>linesep</i></dt>
  <dd class="It-tag">set the line separator character to <i>linesep</i>. By
      default this is a semicolon.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--output-file</b> <i>outfile</i></dt>
  <dd class="It-tag">write output to the file <i>outfile</i> instead of to
      standard output; a file name of &quot;-&quot; stands for standard
    output.</dd>
</dl>
<h1 class="Sh" title="Sh" id="INPUT"><a class="selflink" href="#INPUT">INPUT</a></h1>
<b>GeodSolve</b> measures all angles in degrees and all lengths (<i>s12</i>) in
  meters, and all areas ( <i>S12</i>) in meters^2. On input angles (latitude,
  longitude, azimuth, arc length) can be as decimal degrees or degrees, minutes,
  seconds. For example, &quot;40d30&quot;, &quot;40d30'&quot;,
  &quot;40:30&quot;, &quot;40.5d&quot;, and 40.5 are all equivalent. By default,
  latitude precedes longitude for each point (the <b>-w</b> flag switches this
  convention); however on input either may be given first by appending (or
  prepending) <i>N</i> or <i>S</i> to the latitude and <i>E</i> or <i>W</i> to
  the longitude. Azimuths are measured clockwise from north; however this may be
  overridden with <i>E</i> or <i>W</i>.
<div class="Pp"></div>
For details on the allowed formats for angles, see the &quot;GEOGRAPHIC
  COORDINATES&quot; section of <i>GeoConvert</i>(1).
<h1 class="Sh" title="Sh" id="AUXILIARY_SPHERE"><a class="selflink" href="#AUXILIARY_SPHERE">AUXILIARY
  SPHERE</a></h1>
Geodesics on the ellipsoid can be transferred to the <i>auxiliary sphere</i> on
  which the distance is measured in terms of the arc length <i>a12</i> (measured
  in degrees) instead of <i>s12</i>. In terms of <i>a12</i>, 180 degrees is the
  distance from one equator crossing to the next or from the minimum latitude to
  the maximum latitude. Geodesics with <i>a12</i> &gt; 180 degrees do not
  correspond to shortest paths. With the <b>-a</b> flag, <i>s12</i> (on both
  input and output) is replaced by <i>a12</i>. The <b>-a</b> flag does
  <i>not</i> affect the full output given by the <b>-f</b> flag (which always
  includes both <i>s12</i> and <i>a12</i>).
<h1 class="Sh" title="Sh" id="ADDITIONAL_QUANTITIES"><a class="selflink" href="#ADDITIONAL_QUANTITIES">ADDITIONAL
  QUANTITIES</a></h1>
The <b>-f</b> flag reports four additional quantities.
<div class="Pp"></div>
The reduced length of the geodesic, <i>m12</i>, is defined such that if the
  initial azimuth is perturbed by d <i>azi1</i> (radians) then the second point
  is displaced by <i>m12</i> d<i>azi1</i> in the direction perpendicular to the
  geodesic. <i>m12</i> is given in meters. On a curved surface the reduced
  length obeys a symmetry relation, <i>m12</i> + <i>m21</i> = 0. On a flat
  surface, we have <i>m12</i> = <i>s12</i>.
<div class="Pp"></div>
<i>M12</i> and <i>M21</i> are geodesic scales. If two geodesics are parallel at
  point 1 and separated by a small distance <i>dt</i>, then they are separated
  by a distance <i>M12</i> <i>dt</i> at point 2. <i>M21</i> is defined similarly
  (with the geodesics being parallel to one another at point 2). <i>M12</i> and
  <i>M21</i> are dimensionless quantities. On a flat surface, we have <i>M12</i>
  = <i>M21</i> = 1.
<div class="Pp"></div>
If points 1, 2, and 3 lie on a single geodesic, then the following addition
  rules hold:
<div class="Pp"></div>
<pre>
   s13 = s12 + s23,
   a13 = a12 + a23,
   S13 = S12 + S23,
   m13 = m12 M23 + m23 M21,
   M13 = M12 M23 - (1 - M12 M21) m23 / m12,
   M31 = M32 M21 - (1 - M23 M32) m12 / m23.
</pre>
<div class="Pp"></div>
Finally, <i>S12</i> is the area between the geodesic from point 1 to point 2 and
  the equator; i.e., it is the area, measured counter-clockwise, of the geodesic
  quadrilateral with corners ( <i>lat1</i>,<i>lon1</i>), (0,<i>lon1</i>), (0,
  <i>lon2</i>), and (<i>lat2</i>,<i>lon2</i>). It is given in meters^2.
<h1 class="Sh" title="Sh" id="PRECISION"><a class="selflink" href="#PRECISION">PRECISION</a></h1>
<i>prec</i> gives precision of the output with <i>prec</i> = 0 giving 1 m
  precision, <i>prec</i> = 3 giving 1 mm precision, etc. <i>prec</i> is the
  number of digits after the decimal point for lengths. For decimal degrees, the
  number of digits after the decimal point is <i>prec</i> + 5. For DMS (degree,
  minute, seconds) output, the number of digits after the decimal point in the
  seconds component is <i>prec</i> + 1. The minimum value of <i>prec</i> is 0
  and the maximum is 10.
<h1 class="Sh" title="Sh" id="ERRORS"><a class="selflink" href="#ERRORS">ERRORS</a></h1>
An illegal line of input will print an error message to standard output
  beginning with &quot;ERROR:&quot; and causes <b>GeodSolve</b> to return an
  exit code of 1. However, an error does not cause <b>GeodSolve</b> to
  terminate; following lines will be converted.
<h1 class="Sh" title="Sh" id="ACCURACY"><a class="selflink" href="#ACCURACY">ACCURACY</a></h1>
Using the (default) series solution, GeodSolve is accurate to about 15 nm (15
  nanometers) for the WGS84 ellipsoid. The approximate maximum error (expressed
  as a distance) for an ellipsoid with the same major radius as the WGS84
  ellipsoid and different values of the flattening is
<div class="Pp"></div>
<pre>
   |f|     error
   0.01    25 nm
   0.02    30 nm
   0.05    10 um
   0.1    1.5 mm
   0.2    300 mm
</pre>
<div class="Pp"></div>
If <b>-E</b> is specified, GeodSolve is accurate to about 40 nm (40 nanometers)
  for the WGS84 ellipsoid. The approximate maximum error (expressed as a
  distance) for an ellipsoid with a quarter meridian of 10000 km and different
  values of the <i>a/b</i> = 1 - <i>f</i> is
<div class="Pp"></div>
<pre>
   1-f    error (nm)
   1/128   387
   1/64    345
   1/32    269
   1/16    210
   1/8     115
   1/4      69
   1/2      36
     1      15
     2      25
     4      96
     8     318
    16     985
    32    2352
    64    6008
   128   19024
</pre>
<h1 class="Sh" title="Sh" id="MULTIPLE_SOLUTIONS"><a class="selflink" href="#MULTIPLE_SOLUTIONS">MULTIPLE
  SOLUTIONS</a></h1>
The shortest distance returned for the inverse problem is (obviously) uniquely
  defined. However, in a few special cases there are multiple azimuths which
  yield the same shortest distance. Here is a catalog of those cases:
<dl class="Bl-tag">
  <dt class="It-tag"><i>lat1</i> = -<i>lat2</i> (with neither point at a
    pole)</dt>
  <dd class="It-tag">If <i>azi1</i> = <i>azi2</i>, the geodesic is unique.
      Otherwise there are two geodesics and the second one is obtained by
      setting [ <i>azi1</i>,<i>azi2</i>] = [ <i>azi2</i>,<i>azi1</i>],
      [<i>M12</i>, <i>M21</i>] = [<i>M21</i>,<i>M12</i>], <i>S12</i> =
      -<i>S12</i>. (This occurs when the longitude difference is near +/-180 for
      oblate ellipsoids.)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>lon2</i> = <i>lon1</i> +/- 180 (with neither point at a
    pole)</dt>
  <dd class="It-tag">If <i>azi1</i> = 0 or +/-180, the geodesic is unique.
      Otherwise there are two geodesics and the second one is obtained by
      setting [ <i>azi1</i>,<i>azi2</i>] = [-<i>azi1</i>,-<i>azi2</i>],
      <i>S12</i> = - <i>S12</i>. (This occurs when <i>lat2</i> is near
      -<i>lat1</i> for prolate ellipsoids.)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Points 1 and 2 at opposite poles</dt>
  <dd class="It-tag">There are infinitely many geodesics which can be generated
      by setting [ <i>azi1</i>,<i>azi2</i>] = [<i>azi1</i>,<i>azi2</i>] +
      [<i>d</i>,- <i>d</i>], for arbitrary <i>d</i>. (For spheres, this
      prescription applies when points 1 and 2 are antipodal.)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>s12</i> = 0 (coincident points)</dt>
  <dd class="It-tag">There are infinitely many geodesics which can be generated
      by setting [ <i>azi1</i>,<i>azi2</i>] = [<i>azi1</i>,<i>azi2</i>] +
      [<i>d</i>, <i>d</i>], for arbitrary <i>d</i>.</dd>
</dl>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
Route from JFK Airport to Singapore Changi Airport:
<div class="Pp"></div>
<pre>
   echo 40:38:23N 073:46:44W 01:21:33N 103:59:22E |
   GeodSolve -i -: -p 0
   003:18:29.9 177:29:09.2 15347628
</pre>
<div class="Pp"></div>
Equally spaced waypoints on the route:
<div class="Pp"></div>
<pre>
   for ((i = 0; i &lt;= 10; ++i)); do echo ${i}e-1; done |
   GeodSolve -I 40:38:23N 073:46:44W 01:21:33N 103:59:22E -F -: -p 0
   40:38:23.0N 073:46:44.0W 003:18:29.9
   54:24:51.3N 072:25:39.6W 004:18:44.1
   68:07:37.7N 069:40:42.9W 006:44:25.4
   81:38:00.4N 058:37:53.9W 017:28:52.7
   83:43:26.0N 080:37:16.9E 156:26:00.4
   70:20:29.2N 097:01:29.4E 172:31:56.4
   56:38:36.0N 100:14:47.6E 175:26:10.5
   42:52:37.1N 101:43:37.2E 176:34:28.6
   29:03:57.0N 102:39:34.8E 177:07:35.2
   15:13:18.6N 103:22:08.0E 177:23:44.7
   01:21:33.0N 103:59:22.0E 177:29:09.2
</pre>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i>GeoConvert</i>(1).
<div class="Pp"></div>
An online version of this utility is availbable at
  &lt;http://geographiclib.sourceforge.net/cgi-bin/GeodSolve&gt;.
<div class="Pp"></div>
The algorithms are described in C. F. F. Karney, <i>Algorithms for
  geodesics</i>, J. Geodesy 87, 43-55 (2013); DOI:
  &lt;https://dx.doi.org/10.1007/s00190-012-0578-z&gt;; addenda:
  &lt;http://geographiclib.sourceforge.net/geod-addenda.html&gt;.
<div class="Pp"></div>
The Wikipedia page, Geodesics on an ellipsoid,
  &lt;https://en.wikipedia.org/wiki/Geodesics_on_an_ellipsoid&gt;.
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
<b>GeodSolve</b> was written by Charles Karney.
<h1 class="Sh" title="Sh" id="HISTORY"><a class="selflink" href="#HISTORY">HISTORY</a></h1>
<b>GeodSolve</b> was added to GeographicLib,
  &lt;http://geographiclib.sourceforge.net&gt;, in 2009-03. Prior to version
  1.30, it was called <b>Geod</b>. (The name was changed to avoid a conflict
  with the <b>geod</b> utility in <i>proj.4</i>.)</div>
<table class="foot">
  <tr>
    <td class="foot-date">2016-02-14</td>
    <td class="foot-os">GeographicLib 1.46</td>
  </tr>
</table>
</body>
</html>
