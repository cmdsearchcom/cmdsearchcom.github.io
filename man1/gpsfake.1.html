<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>GPSFAKE(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">GPSFAKE(1)</td>
    <td class="head-vol">GPSD Documentation</td>
    <td class="head-rtitle">GPSFAKE(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
gpsfake - test harness for gpsd, simulating a GPS
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div class="Pp" style="margin-left: 8.00ex; text-indent: -8.00ex;"><b>gpsfake</b>
  [-1] [-h] [-b] [-c&#x00A0; <i>interval</i>] [-i] [-D&#x00A0;<i>debuglevel</i>]
  [-l] [-m&#x00A0; <i>monitor</i>] [-g] [-n] [-o&#x00A0;<i>options</i>] [-p]
  [-P&#x00A0; <i>port</i>] [-r&#x00A0;<i>initcmd</i>] [-s&#x00A0;<i>speed</i>]
  [-S] [-u] [-t] [-v] [ <i>logfile</i>...]</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
gpsfake is a test harness for gpsd and its clients. It opens a pty (pseudo-TTY),
  launches a gpsd instance that thinks the slave side of the pty is its GPS
  device, and repeatedly feeds the contents of one or more test logfiles through
  the master side to the GPS. If there are multiple logfiles, sentences from
  them are interleaved in the order the files are specified.
<div class="Pp"></div>
gpsfake does not require root privileges, and can be run concurrently with a
  production gpsd instance without causing problems.
<div class="Pp"></div>
The logfiles may contain packets in any supported format, including in
  particular NMEA, SiRF, TSIP, or Zodiac. Leading lines beginning with # will be
  treated as comments and ignored, except in the following special cases:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;a comment of the form #Date:
  yyyy-mm-dd (ISO8601 date format) may be used to set the initial date for the
  log.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;a comment of the form #Serial: [0-9]*
  [78][NOE][12] may be used to set serial parameters for the log - baud rate,
  word length, stop bits.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;a comment of the form #Transport: UDP
  may be used to fake a UDP source rather than the normal pty.</div>
<div class="Pp"></div>
The gpsd instance is run in foreground. The thread sending fake GPS data to the
  daemon is run in background.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
With the -1 option, the logfile is interpreted once only rather than repeatedly.
  This option is intended to facilitate regression testing.
<div class="Pp"></div>
The <b>-b</b> enables a twirling-baton progress indicator on standard error. At
  termination, it reports elapsed time.
<div class="Pp"></div>
The <b>-c</b> sets the delay between sentences in seconds. Fractional values of
  seconds are legal. The default is zero (no delay).
<div class="Pp"></div>
The <b>-l</b> makes the program dump a line or packet number just before each
  sentence is fed to the daemon. If the sentence is textual (e.g. NMEA), the
  text is dumped as well. If not, the packet will be dumped in hexadecimal
  (except for RTCM packets, which aren't dumped at all). This option is useful
  for checking that gpsfake is getting packet boundaries right.
<div class="Pp"></div>
The <b>-i</b> is for single-stepping through logfiles. It dumps the line or
  packet number (and the sentence if the protocol is textual) followed by
  &quot;? &quot;. Only when the user keys Enter is the line actually fed to
  gpsd.
<div class="Pp"></div>
The <b>-m</b> specifies a monitor program inside which the daemon should be run.
  This option is intended to be used with <b>valgrind</b>(1), <b>gdb</b>(1) and
  similar programs.
<div class="Pp"></div>
The <b>-g</b> uses the monitor facility to run the gpsd instance within gpsfake
  under control of gdb.
<div class="Pp"></div>
The <b>-o</b> specifies options to pass to the daemon. The -n option passes -n
  to start the daemon reading the GPS without waiting for a client (equivalent
  to -o &quot;-n&quot;). The <b>-D</b> passes a -D option to the daemon: thus -D
  4 is shorthand for -o &quot;-D 4&quot;.
<div class="Pp"></div>
The -p (&quot;pipe&quot;) option sets watcher mode and dumps the NMEA and GPSD
  notifications generated by the log to standard output. This is useful for
  regression-testing.
<div class="Pp"></div>
The -P (&quot;port&quot;) option sets the daemon's listening port.
<div class="Pp"></div>
The <b>-r</b> specifies an initialization command to use in pipe mode. The
  default is <b>?WATCH={&quot;enable&quot;:true,&quot;json&quot;:true}</b>.
<div class="Pp"></div>
The <b>-s</b> sets the baud rate for the slave tty. The default is 4800.
<div class="Pp"></div>
The option -S tells gpsfake to insert realistic delays in the test input rather
  than trying to stuff it through the daemon as fast as possible. This will make
  the test(s) run much slower, but avoids flaky failures due to machine lode and
  possible race conditions in the pty layer.
<div class="Pp"></div>
The <b>-t</b> forces the test framework to use TCP rather than pty devices.
  Besides being a test of TCP source handling, this may be useful for testing
  from within chroot jails where access to pty devices is locked out.
<div class="Pp"></div>
The <b>-u</b> forces the test framework to use UDP rather than pty devices.
  Besides being a test of UDP source handling, this may be useful for testing
  from within chroot jails where access to pty devices is locked out.
<div class="Pp"></div>
The <b>-v</b> enables verbose progress reports to stderr. It is mainly useful
  for debugging gpsfake itself.
<div class="Pp"></div>
The <b>-x</b> dumps packets as gpsfake gathers them. It is mainly useful for
  debugging gpsfake itself.
<div class="Pp"></div>
The <b>-h</b> makes gpsfake print a usage message and exit.
<div class="Pp"></div>
The argument must be the name of a file containing the data to be cycled at the
  device. gpsfake will print a notification each time it cycles.
<div class="Pp"></div>
Normally, gpsfake creates a pty for each logfile and passes the slave side of
  the device to the daemon. If the header comment in the logfile contains the
  string &quot;UDP&quot;, packets are instead shipped via UDP port 5000 to the
  address 192.168.0.1.255. You can monitor them with this: <b>tcpdump -s0 -n -A
  -i lo udp and port 5000</b>.
<h1 class="Sh" title="Sh" id="MAGIC_COMMENTS"><a class="selflink" href="#MAGIC_COMMENTS">MAGIC
  COMMENTS</a></h1>
Certain magic comments in test load headers can change the conditions of the
  test. These are:
<div class="Pp"></div>
Serial:
<div style="margin-left: 4.00ex;">May contain a serial-port setting such as 4800
  7N2 - baud rate followed by 7 or 8 for byte length, N or O or E for parity and
  1 or 2 for stop bits. The test is run with those settings on the slave port
  that the daemon sees.</div>
<div class="Pp"></div>
Transport:
<div style="margin-left: 4.00ex;">Values 'TCP' and 'UDP' force the use of TCP
  and UDP feeds respectively (the default is a pty).</div>
<div class="Pp"></div>
Delay-Cookie:
<div style="margin-left: 4.00ex;">Must be followed by two whitespace-separated
  fields, a delimiter character and a numeric delay in seconds. Instead of being
  broken up by packet boundaries, the test load is split on the delimiters. The
  delay is performed after each feed. Can be useful for imposing write
  boundaries in the middle of packets.</div>
<h1 class="Sh" title="Sh" id="CUSTOM_TESTS"><a class="selflink" href="#CUSTOM_TESTS">CUSTOM
  TESTS</a></h1>
gpsfake is a trivial wrapper around a Python module, also named gpsfake, that
  can be used to fully script sessions involving a gpsd instance, any number of
  client sessions, and any number of fake GPSes feeding the daemon instance with
  data from specified sentence logs.
<div class="Pp"></div>
Source and embedded documentation for this module is shipped with the gpsd
  development tools. You can use it to torture-test either gpsd itself or any
  gpsd-aware client application.
<div class="Pp"></div>
Logfiles for the use with gpsfake can be retrieved using gpspipe, gpscat, or
  gpsmon from the gpsd distribution, or any other application which is able to
  create a compatible output.
<div class="Pp"></div>
If gpsfake exits with &quot;Cannot execute gpsd: executable not found.&quot; the
  environment variable GPSD_HOME can be set to the path where gpsd can be found.
  (instead of adding that folder to the PATH environment variable
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>gpsd</b>(8), <b>gps</b>(1), <b>libgps</b>(3), <b>libgpsd</b>(3),
  <b>gpsctl</b>(1), <b>gpspipe</b>(1), <b>gpsprof</b>(1) <b>gpsmon</b>(1).
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Eric S. Raymond &lt;esr@thyrsus.com&gt;.</div>
<table class="foot">
  <tr>
    <td class="foot-date">12 Feb 2005</td>
    <td class="foot-os">The GPSD Project</td>
  </tr>
</table>
</body>
</html>
