<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>MYSQLRPLADMIN(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">MYSQLRPLADMIN(1)</td>
    <td class="head-vol">MySQL Utilities</td>
    <td class="head-rtitle">MYSQLRPLADMIN(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
mysqlrpladmin - Administration utility for MySQL replication
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div class="Pp" style="margin-left: 24.00ex; text-indent: -24.00ex;"><b>mysqlrpladmin
  [</b> <b></b><i>options</i><b>]</b></div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This utility permits users to perform administrative actions on a replication
  topology consisting of a master and its slaves. The utility is designed to
  make it easy to recover from planned maintenance of the master, or from an
  event that takes the master offline unexpectedly.
<div class="Pp"></div>
The act of taking the master offline intentionally and switching control to
  another slave is called switchover. In this case, there is no loss of
  transactions as the master is locked and all slaves are allowed to catch up to
  the master. Once the slaves have read all events from the master, the master
  is shutdown and control switched to a slave (in this case called a candidate
  slave).
<div class="Pp"></div>
Recovering from the loss of a downed master is more traumatic and since there is
  no way to know what transactions the master may have failed to send, the new
  master (called a candidate slave) must be the slave that is most up-to-date.
  How this is determined depends on the version of the server (see below).
  However, it can result in the loss of some transactions that were executed on
  the downed master but not sent. The utility accepts a list of slaves to be
  considered the candidate slave. If no slave is found to meet the requirements,
  the operation will search the list of known slaves.
<div class="Pp"></div>
The utility also provides a number of useful commands for managing a replication
  topology including the following.
<div class="Pp"></div>
<b>elect</b> This command is available to only those servers supporting global
  transaction identifiers (GTIDs), perform best slave election and report best
  slave to use in the event a switchover or failover is required. Best slave
  election is simply the first slave to meet the prerequisites. GTIDs are
  supported in version 5.6.5 and higher. This command requires the options
  <b>--master</b> and either <b>--slaves</b> or <b>--discover-slaves-login</b>.
<div class="Pp"></div>
<b>failover</b> This command is available to only those servers supporting
  GTIDs. Conduct failover to the best slave. The command will test each
  candidate slave listed for the prerequisites. Once a candidate slave is
  elected, it is made a slave of each of the other slaves thereby collecting any
  transactions executed on other slaves but not the candidate. In this way, the
  candidate becomes the most up-to-date slave. This command requires the
  <b>--slaves</b> option. The <b>--discover-slaves-login</b> option is not
  allowed because, for failover, the master is presumed to be offline or
  otherwise unreachable (so there is no way to discover the slaves). The
  <b>--master</b> option is ignored for this command.
<div class="Pp"></div>
<b>gtid</b> This command is available to only those servers supporting GTIDs. It
  displays the contents of the GTID variables, @@GLOBAL.GTID_EXECUTED,
  @@GLOBAL.GTID_PURGED, and @@GLOBAL.GTID_OWNED. The command also displays
  universally unique identifiers (UUIDs) for all servers. This command requires
  one of the following combinations: <b>--master</b> and <b>--slaves</b>, or
  <b>--master</b> and <b>--discover-slaves-login</b>.
<div class="Pp"></div>
<b>health</b> Display the replication health of the topology. By default, this
  includes the host name, port, role (MASTER or SLAVE) of the server, state of
  the server (UP = is connected, WARN = not connected but can ping, DOWN = not
  connected and cannot ping), the GTID_MODE, and health state. This command can
  be run with the following combination of options:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>--master</b> and
  <b>--slaves</b></div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>--master</b> and
  <b>--discover-slaves-login</b></div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>--slaves</b></div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The health column will display &quot;no master specified&quot; when generating a
  health report for a collection of slaves and no <b>--master</b> option
  specified.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
The master health state is based on the following; if GTID_MODE=ON, the server
  must have binary log enabled, and there must exist a user with the REPLICATE
  SLAVE privilege.
<div class="Pp"></div>
The slave health state is based on the following; the IO_THREAD and SQL_THREADS
  must be running, it must be connected to the master, there are no errors, the
  slave delay for non-gtid enabled scenarios is not more than the threshold
  provided by the <b>--max-position</b> and the slave is reading the correct
  master log file, and slave delay is not more than the <b>--seconds-behind</b>
  threshold option.
<div class="Pp"></div>
<b>reset</b> Execute the STOP SLAVE and RESET SLAVE commands on all slaves. This
  command requires the <b>--slaves</b> option. The
  <b>--discover-slaves-login</b> option is not allowed because it might not
  provide the expected result, excluding slaves with the IO thread stopped.
  Optionally, the <b>--master</b> option can also be used and in this case the
  utility will perform an additional check to verify if the specified slaves are
  associated (replication is configured) to the given master.
<div class="Pp"></div>
<b>start</b> Execute the START SLAVE command on all slaves. This command
  requires the <b>--slaves</b> option. The <b>--discover-slaves-login</b> option
  is not allowed because it might not provide the expected result, excluding
  slaves with the IO thread stopped. Optionally, the <b>--master</b> option can
  also be used and in this case the utility will perform an additional check to
  verify if the specified slaves are associated (replication is configured) to
  the given master.
<div class="Pp"></div>
<b>stop</b> Execute the STOP SLAVE command on all slaves. This command requires
  the <b>--slaves</b> option. The <b>--discover-slaves-login</b> option is not
  allowed because it might not provide the expected result, excluding slaves
  with the IO thread stopped. Optionally, the <b>--master</b> option can also be
  used and in this case the utility will perform an additional check to verify
  if the specified slaves are associated (replication is configured) to the
  given master.
<div class="Pp"></div>
<b>switchover</b> Perform slave promotion to a specified candidate slave as
  designated by the <b>--new-master</b> option. This command is available for
  both gtid-enabled servers and non-gtid-enabled scenarios. This command
  requires one of the following combinations:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>--master</b>, <b>--new-master</b>
  and <b>--slaves</b></div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>--master</b>, <b>--new-master</b>
  and <b>--discover-slaves-login</b></div>
<div class="Pp"></div>
Detection of a downed master is performed as follows. If the connection to the
  master is lost, wait <b>--ping</b> seconds and check again. If the master
  connection is lost and the master cannot be pinged or reconnected, the
  failover event occurs.
<div class="Pp"></div>
For all commands that require specifying multiple servers, the options require a
  comma-separated list of connection parameters in the following form (where the
  password, port, and socket are optional).:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;*user*&gt;[:&lt;*passwd*&gt;]@&lt;*host*&gt;[:&lt;*port*&gt;][:&lt;*socket*&gt;] or
&lt;*login-path*&gt;[:&lt;*port*&gt;][:&lt;*socket*&gt;]
</pre>
</div>
<div class="Pp"></div>
The utility permits users to discover slaves connected to the master. In order
  to use the discover slaves feature, all slaves must use the
  <b>--report-host</b> and <b>--report-port</b> startup variables to specify the
  correct hostname and ip port of the slave. If these are missing or report the
  incorrect information, the slaves health may not be reported correctly or the
  slave may not be listed at all. The 'discover slaves' feature ignores any
  slaves it cannot connect to, or if the IO thread stopped (it is not connected
  to the master).
<div class="Pp"></div>
The utility permits the user to demote a master to a slave during the switchover
  operation. The <b>--demote-master</b> option tells the utility to, once the
  new master is established, make the old master a slave of the new master. This
  permits rotation of the master role among a set of servers.
<div class="Pp"></div>
The utility permits the user to specify an external script to execute before and
  after the switchover and failover commands. The user can specify these with
  the <b>--exec-before</b> and <b>--exec-after</b> options. The return code of
  the script is used to determine success thus each script must report 0
  (success) to be considered successful. If a script returns a value other than
  0, the result code is presented in an error message.
<div class="Pp"></div>
The utility permits the user to log all actions taken during the commands. The
  <b>--log</b> option requires a valid path and file name of the file to use for
  logging operations. The log is active only when this option is specified. The
  option <b>--log-age</b> specifies the age in days that log entries are kept.
  The default is seven (7) days. Older entries are automatically deleted from
  the log file (but only if the <b>--log</b> option is specified).
<div class="Pp"></div>
The format of the log file includes the date and time of the event, the level of
  the event (informational - INFO, warning - WARN, error - ERROR, critical
  failure - CRITICAL), and the message reported by the utility.
<div class="Pp"></div>
The utility has a number of options each explained in more detail below. Some of
  the options are specific to certain commands. Warning messages are issued
  whenever an option is used that does not apply to the command requested. A
  brief overview of each command and its options is presented in the following
  paragraphs.
<div class="Pp"></div>
The start, stop, and reset commands require the <b>--slaves</b> option to list
  all of the slaves in the topology. Optionally, the <b>--master</b> option can
  be specified for the utility to check if the specified slaves are associated
  to the given master before executing the command, making sure that the command
  is only applied to slaves connected to the right replication master.
<div class="Pp"></div>
The options required for the elect, health and gtid commands include the
  <b>--master</b> option to specify the existing master, and either the
  <b>--slaves</b> option to list all of the slaves in the topology or the
  <b>--discover-slaves-login</b> option to provide the user name and password to
  discover any slaves in the topology that are registered and connected to the
  master.
<div class="Pp"></div>
The options required for switchover include the <b>--master</b> option to
  specify the existing master, the <b>--new-master</b> option to specify the
  candidate slave (the slave to become the new master), and either the
  <b>--slaves</b> option to list the considered slaves in the topology or the
  <b>--discover-slaves-login</b> option to provide the user name and password to
  discover any slaves in the topology that are registered and connected to the
  master.
<div class="Pp"></div>
The failover command requires only the <b>--slaves</b> option to explicitly list
  all of the slaves in the topology because it is expected that the master is
  down when this command is used.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The option to pass in --slaves without also passing in --master was added in
  MySQL Utilities 1.6.0.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
Use the <b>--verbose</b> option to see additional information in the health
  report and additional messages during switchover or failover. OPTIONS.PP
  <b>mysqlrpladmin</b> accepts the following command-line options:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--help
<div style="height: 1.00em;">&#x00A0;</div>
Display a help message and exit.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--license
<div style="height: 1.00em;">&#x00A0;</div>
Display license information and exit.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--candidates=&lt;candidate slave
  connections&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Connection information for candidate slave servers for failover. Valid only with
  failover command. List multiple slaves in comma-separated list.
<div style="height: 1.00em;">&#x00A0;</div>
To connect to a server, it is necessary to specify connection parameters such as
  user name, host name, password, and either a port or socket. MySQL Utilities
  provides a number of ways to provide this information. All of the methods
  require specifying your choice via a command-line option such as --server,
  --master, --slave, etc. The methods include the following in order of most
  secure to least secure.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Use login-paths from your .mylogin.cnf
  file (encrypted, not visible). Example : &lt;
  <i>login-path</i>&gt;[:&lt;<i>port</i>&gt;][:&lt; <i>socket</i>&gt;]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Use a configuration file (unencrypted,
  not visible) Note: available in release-1.5.0. Example : &lt;
  <i>configuration-file-path</i>&gt;[:&lt; <i>section</i>&gt;]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Specify the data on the command-line
  (unencrypted, visible). Example : &lt;
  <i>user</i>&gt;[:&lt;<i>passwd</i>&gt;]@&lt;
  <i>host</i>&gt;[:&lt;<i>port</i>&gt;][:&lt; <i>socket</i>&gt;]</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--demote-master
<div style="height: 1.00em;">&#x00A0;</div>
Make master a slave after switchover.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--discover-slaves-login=&lt;slave_login&gt;
<div style="height: 1.00em;">&#x00A0;</div>
At startup, query master for all registered slaves and use the user name and
  password specified to connect. Supply the user and password in the form &lt;
  <i>user</i>&gt;[:&lt;<i>passwd</i>&gt;] or &lt;<i>login-path</i>&gt;. For
  example, --discover=joe:secret will use 'joe' as the user and 'secret' as the
  password for each discovered slave.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--exec-after=&lt;script&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Name of script to execute after failover or switchover. Script name may include
  the path.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--exec-before=&lt;script&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Name of script to execute before failover or switchover. Script name may include
  the path.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--force
<div style="height: 1.00em;">&#x00A0;</div>
Ignore prerequisite checks or any inconsistencies found, such as errant
  transactions on the slaves or SQL thread errors, thus forcing the execution of
  the specified command. This option need to be used carefully as it will not
  solve any detected issue, but only ignores them and displays a warning
  message.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--format=&lt;format&gt;, -f
  &lt;format&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Display the replication health output in either grid (default), tab, csv, or
  vertical format.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--log=&lt;log_file&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Specify a log file to use for logging messages</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--log-age=&lt;days&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Specify maximum age of log entries in days. Entries older than this will be
  purged on startup. Default = 7 days.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--master=&lt;connection&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Connection information for the master server.
<div style="height: 1.00em;">&#x00A0;</div>
To connect to a server, it is necessary to specify connection parameters such as
  user name, host name, password, and either a port or socket. MySQL Utilities
  provides a number of ways to provide this information. All of the methods
  require specifying your choice via a command-line option such as --server,
  --master, --slave, etc. The methods include the following in order of most
  secure to least secure.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Use login-paths from your .mylogin.cnf
  file (encrypted, not visible). Example : &lt;
  <i>login-path</i>&gt;[:&lt;<i>port</i>&gt;][:&lt; <i>socket</i>&gt;]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Use a configuration file (unencrypted,
  not visible) Note: available in release-1.5.0. Example : &lt;
  <i>configuration-file-path</i>&gt;[:&lt; <i>section</i>&gt;]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Specify the data on the command-line
  (unencrypted, visible). Example : &lt;
  <i>user</i>&gt;[:&lt;<i>passwd</i>&gt;]@&lt;
  <i>host</i>&gt;[:&lt;<i>port</i>&gt;][:&lt; <i>socket</i>&gt;]</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--max-position=&lt;position&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Used to detect slave delay. The maximum difference between the master's log
  position and the slave's reported read position of the master. A value greater
  than this means the slave is too far behind the master. Default = 0.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--new-master=&lt;connection&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Connection information for the slave to be used to replace the master for
  switchover. Valid only with switchover command.
<div style="height: 1.00em;">&#x00A0;</div>
To connect to a server, it is necessary to specify connection parameters such as
  user name, host name, password, and either a port or socket. MySQL Utilities
  provides a number of ways to provide this information. All of the methods
  require specifying your choice via a command-line option such as --server,
  --master, --slave, etc. The methods include the following in order of most
  secure to least secure.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Use login-paths from your .mylogin.cnf
  file (encrypted, not visible). Example : &lt;
  <i>login-path</i>&gt;[:&lt;<i>port</i>&gt;][:&lt; <i>socket</i>&gt;]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Use a configuration file (unencrypted,
  not visible) Note: available in release-1.5.0. Example : &lt;
  <i>configuration-file-path</i>&gt;[:&lt; <i>section</i>&gt;]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Specify the data on the command-line
  (unencrypted, visible). Example : &lt;
  <i>user</i>&gt;[:&lt;<i>passwd</i>&gt;]@&lt;
  <i>host</i>&gt;[:&lt;<i>port</i>&gt;][:&lt; <i>socket</i>&gt;]</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--no-health
<div style="height: 1.00em;">&#x00A0;</div>
Turn off health report after switchover or failover.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--ping=&lt;number&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Number of ping attempts for detecting downed server. Note: on some platforms
  this is the same as number of seconds to wait for <i>ping</i> to return. This
  value is also used to check down status of master. Failover will wait
  <i>ping</i> seconds to check master response. If no response, failover event
  occurs.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--quiet, -q
<div style="height: 1.00em;">&#x00A0;</div>
Turn off all messages for quiet execution.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--rpl-user=&lt;replication_user&gt;
<div style="height: 1.00em;">&#x00A0;</div>
The user and password for the replication user requirement, in the format: &lt;
  <i>user</i>&gt;[:&lt;<i>password</i>&gt;] or &lt;<i>login-path</i>&gt;. E.g.
  rpl:passwd Default = None.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--script-threshold=&lt;return_code&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Value for external scripts to trigger aborting the operation if result is
  greater than or equal to the threshold.
<div style="height: 1.00em;">&#x00A0;</div>
Default = None (no threshold checking).</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--seconds-behind=&lt;seconds&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Used to detect slave delay. The maximum number of seconds behind the master
  permitted before slave is considered behind the master. Default = 0.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--slaves=&lt;slave connections&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Connection information for slave servers. List multiple slaves in
  comma-separated list. The list will be evaluated literally whereby each server
  is considered a slave to the master listed regardless if they are a slave of
  the master.
<div style="height: 1.00em;">&#x00A0;</div>
To connect to a server, it is necessary to specify connection parameters such as
  user name, host name, password, and either a port or socket. MySQL Utilities
  provides a number of ways to provide this information. All of the methods
  require specifying your choice via a command-line option such as --server,
  --master, --slave, etc. The methods include the following in order of most
  secure to least secure.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Use login-paths from your .mylogin.cnf
  file (encrypted, not visible). Example : &lt;
  <i>login-path</i>&gt;[:&lt;<i>port</i>&gt;][:&lt; <i>socket</i>&gt;]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Use a configuration file (unencrypted,
  not visible) Note: available in release-1.5.0. Example : &lt;
  <i>configuration-file-path</i>&gt;[:&lt; <i>section</i>&gt;]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Specify the data on the command-line
  (unencrypted, visible). Example : &lt;
  <i>user</i>&gt;[:&lt;<i>passwd</i>&gt;]@&lt;
  <i>host</i>&gt;[:&lt;<i>port</i>&gt;][:&lt; <i>socket</i>&gt;]</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--ssl-ca
<div style="height: 1.00em;">&#x00A0;</div>
The path to a file that contains a list of trusted SSL CAs.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--ssl-cert
<div style="height: 1.00em;">&#x00A0;</div>
The name of the SSL certificate file to use for establishing a secure
  connection.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--ssl-cert
<div style="height: 1.00em;">&#x00A0;</div>
The name of the SSL key file to use for establishing a secure connection.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--ssl
<div style="height: 1.00em;">&#x00A0;</div>
Specifies if the server connection requires use of SSL. If an encrypted
  connection cannot be established, the connection attempt fails. Default
  setting is 0 (SSL not required).</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--timeout=&lt;seconds&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Maximum timeout in seconds to wait for each replication command to complete. For
  example, timeout for slave waiting to catch up to master. Default = 300
  seconds.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--verbose, -v
<div style="height: 1.00em;">&#x00A0;</div>
Specify how much information to display. Use this option multiple times to
  increase the amount of information. For example, <b>-v</b> = verbose,
  <b>-vv</b> = more verbose, <b>-vvv</b> = debug.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--version
<div style="height: 1.00em;">&#x00A0;</div>
Display version information and exit.</div>
NOTES.PP The login user must have the appropriate permissions to execute <b>SHOW
  SLAVE STATUS</b>, <b>SHOW MASTER STATUS</b>, and <b>SHOW VARIABLES</b> on the
  appropriate servers as well as grant the REPLICATE SLAVE privilege. The
  utility checks permissions for the master, slaves, and candidates at startup.
<div class="Pp"></div>
Mixing IP and hostnames is not recommended. The replication-specific utilities
  will attempt to compare hostnames and IP addresses as aliases for checking
  slave connectivity to the master. However, if your installation does not
  support reverse name lookup, the comparison could fail. Without the ability to
  do a reverse name lookup, the replication utilities could report a false
  negative that the slave is (not) connected to the master.
<div class="Pp"></div>
For example, if you setup replication using &quot;MASTER_HOST=ubuntu.net&quot;
  on the slave and later connect to the slave with <b>mysqlrplcheck</b> and have
  the master specified as &quot;--master=192.168.0.6&quot; using the valid IP
  address for &quot;ubuntu.net&quot;, you must have the ability to do a reverse
  name lookup to compare the IP (192.168.0.6) and the hostname (ubuntu.net) to
  determine if they are the same machine.
<div class="Pp"></div>
Similarly, if you use localhost to connect to the master, the health report may
  not show all of the slaves. It is best to use the actual hostname of the
  master when connecting or setting up replication.
<div class="Pp"></div>
If the user does not specify the <b>--rpl-user</b> and the user has specified
  the switchover or failover command, the utility will check to see if the
  slaves are using --master-info-repository=TABLE. If they are not, the utility
  will stop with an error.
<div class="Pp"></div>
All the commands require either the <b>--slaves</b> or
  <b>--discover-slaves-login</b> option but both cannot be used at the same
  time. In fact, some commands only allow the use of the <b>--slaves</b> option
  which is safer to specify the list slaves, because
  <b>--discover-slaves-login</b> might not provide an up to date list of
  available slaves.
<div class="Pp"></div>
The path to the MySQL client tools should be included in the PATH environment
  variable in order to use the authentication mechanism with login-paths. This
  will allow the utility to use the <b>my_print_defaults</b> tools which is
  required to read the login-path values from the login configuration file
  (.mylogin.cnf). EXAMPLES.PP To perform best slave election for a topology with
  GTID_MODE=ON (server version 5.6.5 or higher) where all slaves are specified
  with the <b>--slaves</b> option, run the following command.:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
shell&gt;  <b>mysqlrpladmin --master=root@localhost:3331 \</b>
           <b>--slaves=root@localhost:3332,root@localhost:3333,root@localhost:3334 elect</b>
# Electing candidate slave from known slaves.
# Best slave found is located on localhost:3332.
# ...done.
</pre>
</div>
<div class="Pp"></div>
To perform best slave election supplying a candidate list, use the following
  command.:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
shell&gt;  <b>mysqlrpladmin --master=root@localhost:3331 \</b>
   <b>--slaves=root@localhost:3332,root@localhost:3333,root@localhost:3334 \</b>
   <b>--candidates=root@localhost:3333,root@localhost:3334 elect</b>
# Electing candidate slave from candidate list then slaves list.
# Best slave found is located on localhost:3332.
# ...done.
</pre>
</div>
<div class="Pp"></div>
To perform failover after a master has failed, use the following command.:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
shell&gt;  <b>mysqlrpladmin  \</b>
   <b>--slaves=root@localhost:3332,root@localhost:3333,root@localhost:3334 \</b>
   <b>--candidates=root@localhost:3333,root@localhost:3334 failover</b>
# Performing failover.
# Candidate slave localhost:3333 will become the new master.
# Preparing candidate for failover.
# Creating replication user if it does not exist.
# Stopping slaves.
# Performing STOP on all slaves.
# Switching slaves to new master.
# Starting slaves.
# Performing START on all slaves.
# Checking slaves for errors.
# Failover complete.
# ...done.
</pre>
</div>
<div class="Pp"></div>
To see the replication health of a topology with GTID_MODE=ON (server version
  5.6.5 or higher) and discover all slaves attached to the master, run the
  following command. We use the result of the failover command above.:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
shell&gt;  <b>mysqlrpladmin --master=root@localhost:3333 \</b>
   <b>--slaves=root@localhost:3332,root@localhost:3334 health</b>
# Getting health for master: localhost:3333.
#
# Replication Topology Health:
+------------+-------+---------+--------+------------+---------+
| host       | port  | role    | state  | gtid_mode  | health  |
+------------+-------+---------+--------+------------+---------+
| localhost  | 3333  | MASTER  | UP     | ON         | OK      |
| localhost  | 3332  | SLAVE   | UP     | ON         | OK      |
| localhost  | 3334  | SLAVE   | UP     | ON         | OK      |
+------------+-------+---------+--------+------------+---------+
# ...done.
</pre>
</div>
<div class="Pp"></div>
To view a detailed replication health report but with all of the replication
  health checks revealed, use the <b>--verbose</b> option as shown below. In
  this example, we use vertical format to make viewing easier.:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
shell&gt;  <b>mysqlrpladmin --master=root@localhost:3331 \</b>
           <b>--slaves=root@localhost:3332,root@localhost:3333,root@localhost:3334 \</b>
           <b>--verbose health</b>
# Getting health for master: localhost:3331.
# Attempting to contact localhost ... Success
# Attempting to contact localhost ... Success
# Attempting to contact localhost ... Success
# Attempting to contact localhost ... Success
#
# Replication Topology Health:
*************************       1. row *************************
            host: localhost
            port: 3331
            role: MASTER
           state: UP
       gtid_mode: ON
          health: OK
         version: 5.6.5-m8-debug-log
 master_log_file: mysql-bin.000001
  master_log_pos: 571
       IO_Thread:
      SQL_Thread:
     Secs_Behind:
 Remaining_Delay:
    IO_Error_Num:
        IO_Error:
*************************       2. row *************************
            host: localhost
            port: 3332
            role: SLAVE
           state: UP
       gtid_mode: ON
          health: OK
         version: 5.6.5-m8-debug-log
 master_log_file: mysql-bin.000001
  master_log_pos: 571
       IO_Thread: Yes
      SQL_Thread: Yes
     Secs_Behind: 0
 Remaining_Delay: No
    IO_Error_Num: 0
        IO_Error:
*************************       3. row *************************
            host: localhost
            port: 3333
            role: SLAVE
           state: UP
       gtid_mode: ON
          health: OK
         version: 5.6.5-m8-debug-log
 master_log_file: mysql-bin.000001
  master_log_pos: 571
       IO_Thread: Yes
      SQL_Thread: Yes
     Secs_Behind: 0
 Remaining_Delay: No
    IO_Error_Num: 0
        IO_Error:
*************************       4. row *************************
            host: localhost
            port: 3334
            role: SLAVE
           state: UP
       gtid_mode: ON
          health: OK
         version: 5.6.5-m8-debug-log
 master_log_file: mysql-bin.000001
  master_log_pos: 571
       IO_Thread: Yes
      SQL_Thread: Yes
     Secs_Behind: 0
 Remaining_Delay: No
    IO_Error_Num: 0
        IO_Error:
4 rows.
# ...done.
</pre>
</div>
<div class="Pp"></div>
To run the same failover command above, but specify a log file, use the
  following command.:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
shell&gt;  <b>mysqlrpladmin  \</b>
   <b>--slaves=root@localhost:3332,root@localhost:3333,root@localhost:3334 \</b>
   <b>--candidates=root@localhost:3333,root@localhost:3334 \</b>
   <b>--log=test_log.txt failover</b>
# Performing failover.
# Candidate slave localhost:3333 will become the new master.
# Preparing candidate for failover.
# Creating replication user if it does not exist.
# Stopping slaves.
# Performing STOP on all slaves.
# Switching slaves to new master.
# Starting slaves.
# Performing START on all slaves.
# Checking slaves for errors.
# Failover complete.
# ...done.
</pre>
</div>
<div class="Pp"></div>
After this command, the log file will contain entries like the following:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
2012-03-19 14:44:17 PM INFO Executing failover command...
2012-03-19 14:44:17 PM INFO Performing failover.
2012-03-19 14:44:17 PM INFO Candidate slave localhost:3333 will become the new master.
2012-03-19 14:44:17 PM INFO Preparing candidate for failover.
2012-03-19 14:44:19 PM INFO Creating replication user if it does not exist.
2012-03-19 14:44:19 PM INFO Stopping slaves.
2012-03-19 14:44:19 PM INFO Performing STOP on all slaves.
2012-03-19 14:44:19 PM INFO Switching slaves to new master.
2012-03-19 14:44:20 PM INFO Starting slaves.
2012-03-19 14:44:20 PM INFO Performing START on all slaves.
2012-03-19 14:44:20 PM INFO Checking slaves for errors.
2012-03-19 14:44:21 PM INFO Failover complete.
2012-03-19 14:44:21 PM INFO ...done.
</pre>
</div>
<div class="Pp"></div>
To perform switchover and demote the current master to a slave, use the
  following command.:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
shell&gt;  <b>mysqlrpladmin --master=root@localhost:3331 \</b>
   <b>--slaves=root@localhost:3332,root@localhost:3333,root@localhost:3334 \</b>
   <b>--new-master=root@localhost:3332 --demote-master switchover</b>
# Performing switchover from master at localhost:3331 to slave at localhost:3332.
# Checking candidate slave prerequisites.
# Waiting for slaves to catch up to old master.
# Stopping slaves.
# Performing STOP on all slaves.
# Demoting old master to be a slave to the new master.
# Switching slaves to new master.
# Starting all slaves.
# Performing START on all slaves.
# Checking slaves for errors.
# Switchover complete.
# ...done.
</pre>
</div>
<div class="Pp"></div>
If the replication health report is generated on the topology following the
  above command, it will display the old master as a slave as shown below.:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
# Replication Topology Health:
+------------+-------+---------+--------+------------+---------+
| host       | port  | role    | state  | gtid_mode  | health  |
+------------+-------+---------+--------+------------+---------+
| localhost  | 3332  | MASTER  | UP     | ON         | OK      |
| localhost  | 3331  | SLAVE   | UP     | ON         | OK      |
| localhost  | 3333  | SLAVE   | UP     | ON         | OK      |
| localhost  | 3334  | SLAVE   | UP     | ON         | OK      |
+------------+-------+---------+--------+------------+---------+
</pre>
</div>
<div class="Pp"></div>
You can use the discover slaves feature, if and only if all slaves report their
  host and port to the master. A sample command to generate a replication health
  report with discovery is shown below. Note that the option
  <b>--discover-slaves-login</b> cannot be used in conjunction with the
  <b>--slaves</b> option.:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
shell&gt;  <b>mysqlrpladmin --master=root@localhost:3332 --discover-slaves-login=root  health</b>
# Discovering slaves for master at localhost:3332
# Discovering slave at localhost:3331
# Found slave: localhost:3331
# Discovering slave at localhost:3333
# Found slave: localhost:3333
# Discovering slave at localhost:3334
# Found slave: localhost:3334
# Checking privileges.
#
# Replication Topology Health:
+------------+-------+---------+--------+------------+---------+
| host       | port  | role    | state  | gtid_mode  | health  |
+------------+-------+---------+--------+------------+---------+
| localhost  | 3332  | MASTER  | UP     | ON         | OK      |
| localhost  | 3331  | SLAVE   | UP     | ON         | OK      |
| localhost  | 3333  | SLAVE   | UP     | ON         | OK      |
| localhost  | 3334  | SLAVE   | UP     | ON         | OK      |
+------------+-------+---------+--------+------------+---------+
# ...done.
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
PERMISSIONS REQUIRED.PP The users on the master need the following privileges:
  SELECT and INSERT privileges on mysql database, REPLICATION SLAVE, REPLICATION
  CLIENT and GRANT OPTION. The slave users need the SUPER privilege. The repl
  user, used as the argument for the <b>--rpl-user</b> option, is either created
  automatically or if it exists, it needs the REPLICATION SLAVE privilege.
<div class="Pp"></div>
To run the <b>mysqlrpladmin</b> utility with the health command, the account
  used on the master needs an extra SUPER privilege.
<div class="Pp"></div>
As for the switchover command all the users need the following privileges:
  SUPER, GRANT OPTION, SELECT, RELOAD, DROP, CREATE and REPLICATION SLAVE
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
Copyright &#x00A9; 2006, 2015, Oracle and/or its affiliates. All rights
  reserved.
<div class="Pp"></div>
This documentation is free software; you can redistribute it and/or modify it
  only under the terms of the GNU General Public License as published by the
  Free Software Foundation; version 2 of the License.
<div class="Pp"></div>
This documentation is distributed in the hope that it will be useful, but
  WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more
  details.
<div class="Pp"></div>
You should have received a copy of the GNU General Public License along with the
  program; if not, write to the Free Software Foundation, Inc., 51 Franklin
  Street, Fifth Floor, Boston, MA 02110-1301 USA or see
  http://www.gnu.org/licenses/.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
For more information, please refer to the MySQL Utilities and Fabric
  documentation, which is available online at
  http://dev.mysql.com/doc/index-utils-fabric.html
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Oracle Corporation (http://dev.mysql.com/).</div>
<table class="foot">
  <tr>
    <td class="foot-date">09/15/2015</td>
    <td class="foot-os">MySQL 1.5.6</td>
  </tr>
</table>
</body>
</html>
