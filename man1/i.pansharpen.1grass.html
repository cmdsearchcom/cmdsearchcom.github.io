<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>i.pansharpen(1grass)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">i.pansharpen(1grass)</td>
    <td class="head-vol">Grass User's Manual</td>
    <td class="head-rtitle">i.pansharpen(1grass)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<i></i><b>i.pansharpen</b> - Image fusion algorithms to sharpen multispectral
  with high-res panchromatic channels
<h1 class="Sh" title="Sh" id="KEYWORDS"><a class="selflink" href="#KEYWORDS">KEYWORDS</a></h1>
imagery, fusion, sharpen, Brovey, IHS, HIS, PCA
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>i.pansharpen</b>
<div>&#x00A0;</div>
<b>i.pansharpen --help</b>
<div>&#x00A0;</div>
<b>i.pansharpen</b> [-<b>sl</b>] <b>red</b>=<i>name</i> <b>green</b>=<i>name</i>
  <b>blue</b>=<i>name</i> <b>pan</b>=<i>name</i> <b>output</b>=<i>basename</i>
  <b>method</b>=<i>string</i> [--<b>overwrite</b>] [--<b>help</b>]
  [--<b>verbose</b>] [-- <b>quiet</b>] [--<b>ui</b>]
<h2 class="Ss" title="Ss" id="Flags:"><a class="selflink" href="#Flags:">Flags:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Serial processing rather than parallel processing</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Rebalance blue channel for LANDSAT</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--overwrite</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Allow output files to overwrite existing files</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Print usage summary</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verbose</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Verbose module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--quiet</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Quiet module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ui</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Force launching GUI dialog</dd>
</dl>
<h2 class="Ss" title="Ss" id="Parameters:"><a class="selflink" href="#Parameters:">Parameters:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>red</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of raster map to be used for &lt;red&gt;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>green</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of raster map to be used for &lt;green&gt;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>blue</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of raster map to be used for &lt;blue&gt;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>pan</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of raster map to be used for high resolution panchromatic channel</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>output</b>=<i>basename</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name for output basename raster map(s)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>method</b>=<i>string</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Method for pan sharpening
    <div>&#x00A0;</div>
    Options: <i>brovey, ihs, pca</i>
    <div>&#x00A0;</div>
    Default: <i>ihs</i></dd>
</dl>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<i></i><b>i.pansharpen</b> uses a high resolution panchromatic band from a
  multispectral image to sharpen 3 lower resolution bands. The 3 lower
  resolution bands can then be combined into an RGB color image at a higher
  (more detailed) resolution than is possible using the original 3 bands. For
  example, Landsat ETM has low resolution spectral bands 1 (blue), 2 (green), 3
  (red), 4 (near IR), 5 (mid-IR), and 7 (mid-IR) at 30m resolution, and a high
  resolution panchromatic band 8 at 15m resolution. Pan sharpening allows bands
  3-2-1 (or other combinations of 30m resolution bands like 4-3-2 or 5-4-2) to
  be combined into a 15m resolution color image.
<div>&#x00A0;</div>
<div>&#x00A0;</div>
i.pansharpen offers a choice of three different &#x2019;pan sharpening&#x2019;
  algorithms: IHS, Brovey, and PCA.
<div>&#x00A0;</div>
<div>&#x00A0;</div>
For <i>IHS pan sharpening</i>, the original 3 lower resolution bands, selected
  as red, green and blue channels for creating an RGB composite image, are
  transformed into IHS (intensity, hue, and saturation) color space. The
  panchromatic band is then substituted for the intensity channel (I), combined
  with the original hue (H) and saturation (S) channels, and transformed back to
  RGB color space at the higher resolution of the panchromatic band. The
  algorithm for this can be represented as: RGB -&gt; IHS -&gt; [pan]HS -&gt;
  RGB.
<div>&#x00A0;</div>
<div>&#x00A0;</div>
With a <i>Brovey pan sharpening</i>, each of the 3 lower resolution bands and
  panchromatic band are combined using the following algorithm to calculate 3
  new bands at the higher resolution (example for band 1):
<div>&#x00A0;</div>
<pre>
                         band1
    new band1 = ----------------------- * panband
                 band1 + band2 + band3
</pre>
In <i>PCA pan sharpening</i>, a principal component analysis is performed on the
  original 3 lower resolution bands to create 3 principal component images (PC1,
  PC2, and PC3) and their associated eigenvectors (EV), such that:
<div>&#x00A0;</div>
<pre>
     band1  band2  band3
PC1: EV1-1  EV1-2  EV1-3
PC2: EV2-1  EV2-2  EV2-3
PC3: EV3-1  EV3-2  EV3-3
and
PC1 = EV1-1 * band1 + EV1-2 * band2 + EV1-3 * band3 - mean(bands 1,2,3)
</pre>
An inverse PCA is then performed, substituting the panchromatic band for PC1. To
  do this, the eigenvectors matrix is inverted (in this case transposed), the PC
  images are multiplied by the eigenvectors with the panchromatic band
  substituted for PC1, and mean of each band is added to each transformed image
  band using the following algorithm (example for band 1):
<div>&#x00A0;</div>
<pre>
band1&#x2019; = pan * EV1-1 + PC2 * EV2-1 + PC3 * EV3-1 + mean(band1)
</pre>
The assignment of the channels depends on the satellite. Examples of satellite
  imagery with high resolution panchromatic bands, and lower resolution spectral
  bands include Landsat 7 ETM, QuickBird, and SPOT.
<div>&#x00A0;</div>
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
The module currently only works for 8-bit images.
<div>&#x00A0;</div>
<div>&#x00A0;</div>
The command temporarily changes the computational region to the high resolution
  of the panchromatic band during sharpening calculations, then restores the
  previous region settings. The current region coordinates (and null values) are
  respected. The high resolution panchromatic image is histogram matched to the
  band it is replaces prior to substitution (i.e., the intensity channel for IHS
  sharpening, the low res band selected for each color channel with Brovey
  sharpening, and the PC1 image for PCA sharpening).
<div>&#x00A0;</div>
<div>&#x00A0;</div>
By default, the command will attempt to employ parallel processing, using up to
  3 cores simultaneously. The -s flag will disable parallel processing, but does
  use an optimized r.mapcalc expression to reduce disk I/O.
<div>&#x00A0;</div>
<div>&#x00A0;</div>
The three pan-sharpened output channels may be combined with <i>d.rgb</i> or
  <i>r.composite</i>. Colors may be optionally optimized with
  <i>i.colors.enhance</i>. While the resulting color image will be at the higher
  resolution in all cases, the 3 pan sharpening algorithms differ in terms of
  spectral response.
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<h2 class="Ss" title="Ss" id="Pan_sharpening_comparison_example"><a class="selflink" href="#Pan_sharpening_comparison_example">Pan
  sharpening comparison example</a></h2>
Pan sharpening of a Landsat image from Boulder, Colorado, USA:
<div>&#x00A0;</div>
<pre>
# R, G, B composite at 30m
g.region raster=p034r032_7dt20010924_z13_10 -p
d.rgb b=p034r032_7dt20010924_z13_10 g=lp034r032_7dt20010924_z13_20
    r=p034r032_7dt20010924_z13_30
# i.pansharpen with IHS algorithm
i.pansharpen red=p034r032_7dt20010924_z13_30 green=p034r032_7dt20010924_z13_20
    blue=p034r032_7dt20010924_z13_10 pan=p034r032_7dp20010924_z13_80
    output=ihs321 method=ihs
# ... likewise with method=brovey and method=pca
# display at 15m
g.region raster=ihs321_blue -p
d.rgb b=ihs321_blue g=ihs321_green r=ihs321_red
</pre>
<div class="Pp"></div>
<b></b><i>Results:</i>
<table class="tbl">
  <colgroup>
    <col style="width: 60.00ex;"/>
    <col style="width: 1.00ex;"/>
    <col style="width: 60.00ex;"/>
  </colgroup>
  <tr>
    <td><i>R, G, B composite of Landsat at 30m</i></td>
    <td> </td>
    <td><i>R, G, B composite of Brovey sharpened image at 15m</i></td>
  </tr>
  <tr>
    <td><i>R, G, B composite of IHS sharpened image at 15m</i></td>
    <td> </td>
    <td><i>R, G, B composite of PCA sharpened image at 15m&quot;</i></td>
  </tr>
</table>
<div>&#x00A0;</div>
<h2 class="Ss" title="Ss" id="Pan_sharpening_of_LANDSAT_ETM+_(Landsat_7)"><a class="selflink" href="#Pan_sharpening_of_LANDSAT_ETM+_(Landsat_7)">Pan
  sharpening of LANDSAT ETM+ (Landsat 7)</a></h2>
LANDSAT ETM+ (Landsat 7), North Carolina sample dataset:
<div>&#x00A0;</div>
<pre>
# original at 28m
g.region raster=lsat7_2002_10 -p
d.mon wx0
d.rgb b=lsat7_2002_10 g=lsat7_2002_20 r=lsat7_2002_30
# i.pansharpen with IHS algorithm
i.pansharpen red=lsat7_2002_30@PERMANENT \
  green=lsat7_2002_20 blue=lsat7_2002_10 \
  pan=lsat7_2002_80 method=ihs \
  output=lsat7_2002_ihs
# display at 14.25m
g.region raster=lsat7_2002_ihs_red -p
d.erase
d.rgb r=lsat7_2002_ihs_red g=lsat7_2002_ihs_green b=lsat7_2002_ihs_blue
# compare before/after (RGB support in &quot;Advanced&quot;):
g.gui.mapswipe
# optionally color balancing:
i.colors.enhance r=lsat7_2002_ihs_red g=lsat7_2002_ihs_green b=lsat7_2002_ihs_blue
</pre>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i></i> <i>i.his.rgb,</i> <i>i.rgb.his,</i> <i>i.pca,</i> <i>d.rgb,</i>
  <i>r.composite</i> <i></i>
<h1 class="Sh" title="Sh" id="REFERENCES"><a class="selflink" href="#REFERENCES">REFERENCES</a></h1>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Original Brovey formula reference unknown, probably...
    <div>&#x00A0;</div>
    Roller, N.E.G. and Cox, S., (1980). Comparison of Landsat MSS and merged
      MSS/RBV data for analysis of natural vegetation. Proc. of the 14th
      International Symposium on Remote Sensing of Environment, San Jose, Costa
      Rica, 23-30 April, pp. 1001-1007</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Amarsaikhan, D., Douglas, T. (2004). Data fusion and
      multisource image classification. International Journal of Remote Sensing,
      25(17), 3529-3539.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Behnia, P. (2005). Comparison between four methods for data
      fusion of ETM+ multispectral and pan images. Geo-spatial Information
      Science, 8(2), 98-103.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Du, Q., Younan, N. H., King, R., Shah, V. P. (2007). On the
      Performance Evaluation of Pan-Sharpening Techniques. Geoscience and Remote
      Sensing Letters, IEEE, 4(4), 518-522.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Karathanassi, V., Kolokousis, P., Ioannidou, S. (2007). A
      comparison study on fusion methods using evaluation indicators.
      International Journal of Remote Sensing, 28(10), 2309-2341.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Neteler, M, D. Grasso, I. Michelazzi, L. Miori, S. Merler,
      and C. Furlanello (2005). An integrated toolbox for image registration,
      fusion and classification. International Journal of Geoinformatics,
      1(1):51-61 (PDF)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Pohl, C, and J.L van Genderen (1998). Multisensor image
      fusion in remote sensing: concepts, methods and application. Int. J. of
      Rem. Sens., 19, 823-854.</dd>
</dl>
</div>
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
Michael Barton (Arizona State University, USA)
<div>&#x00A0;</div>
with contributions from Markus Neteler (ITC-irst, Italy); Glynn Clements; Luca
  Delucchi (Fondazione E. Mach, Italy); Markus Metz; and Hamish Bowman.
<div class="Pp"></div>
<i>Last changed: $Date: 2016-02-09 17:51:03 +0100 (Tue, 09 Feb 2016) $</i>
<h1 class="Sh" title="Sh" id="SOURCE_CODE"><a class="selflink" href="#SOURCE_CODE">SOURCE
  CODE</a></h1>
Available at: i.pansharpen source code (history)
<div class="Pp"></div>
Main index | Imagery index | Topics index | Keywords index | Graphical index |
  Full index
<div class="Pp"></div>
&#x00A9; 2003-2016 GRASS Development Team, GRASS GIS 7.2.0 Reference
  Manual</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os">GRASS 7.2.0</td>
  </tr>
</table>
</body>
</html>
