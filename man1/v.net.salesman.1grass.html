<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>v.net.salesman(1grass)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">v.net.salesman(1grass)</td>
    <td class="head-vol">Grass User's Manual</td>
    <td class="head-rtitle">v.net.salesman(1grass)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<i></i><b>v.net.salesman</b> - Creates a cycle connecting given nodes (Traveling
  salesman problem).
<div>&#x00A0;</div>
Note that TSP is NP-hard, heuristic algorithm is used by this module and created
  cycle may be sub optimal
<h1 class="Sh" title="Sh" id="KEYWORDS"><a class="selflink" href="#KEYWORDS">KEYWORDS</a></h1>
vector, network, salesman
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>v.net.salesman</b>
<div>&#x00A0;</div>
<b>v.net.salesman --help</b>
<div>&#x00A0;</div>
<b>v.net.salesman</b> [-<b>tg</b>] <b>input</b>=<i>name</i>
  <b>output</b>=<i>name</i> <b>center_cats</b>=<i>range</i>
  <b>arc_layer</b>=<i>string</i>
  <b>arc_type</b>=<i>string</i>[,<i>string</i>,...]
  <b>node_layer</b>=<i>string</i> [ <b>arc_column</b>=<i>string</i>]
  [<b>arc_backward_column</b>= <i>string</i>] [<b>turn_layer</b>=<i>string</i>]
  [ <b>turn_cat_layer</b>=<i>string</i>] [<b>sequence</b>=<i>name</i>]
  [--<b>overwrite</b>] [-- <b>help</b>] [--<b>verbose</b>] [--<b>quiet</b>]
  [--<b>ui</b>]
<h2 class="Ss" title="Ss" id="Flags:"><a class="selflink" href="#Flags:">Flags:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-t</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Use turntable</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-g</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Use geodesic calculation for longitude-latitude locations</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--overwrite</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Allow output files to overwrite existing files</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Print usage summary</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verbose</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Verbose module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--quiet</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Quiet module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ui</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Force launching GUI dialog</dd>
</dl>
<h2 class="Ss" title="Ss" id="Parameters:"><a class="selflink" href="#Parameters:">Parameters:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>input</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input vector map
    <div>&#x00A0;</div>
    Or data source for direct OGR access</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>output</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name for output vector map</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>center_cats</b>=<i>range</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Category values
    <div>&#x00A0;</div>
    Categories of points (&#x2019;cities&#x2019;) on nodes (layer is specified
      by nlayer)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>arc_layer</b>=<i>string</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Arc layer
    <div>&#x00A0;</div>
    Vector features can have category values in different layers. This number
      determines which layer to use. When used with direct OGR access this is
      the layer name.
    <div>&#x00A0;</div>
    Default: <i>1</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>arc_type</b>=<i>string[,</i><i>string</i>,...]
    <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Arc type
    <div>&#x00A0;</div>
    Input feature type
    <div>&#x00A0;</div>
    Options: <i>line, boundary</i>
    <div>&#x00A0;</div>
    Default: <i>line,boundary</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>node_layer</b>=<i>string</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Node layer (used for cities)
    <div>&#x00A0;</div>
    Vector features can have category values in different layers. This number
      determines which layer to use. When used with direct OGR access this is
      the layer name.
    <div>&#x00A0;</div>
    Default: <i>2</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>arc_column</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Arc forward/both direction(s) cost column (number)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>arc_backward_column</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    EXPERIMENTAL: Arc backward direction cost column (number)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>turn_layer</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Layer with turntable
    <div>&#x00A0;</div>
    Relevant only with -t flag
    <div>&#x00A0;</div>
    Default: <i>3</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>turn_cat_layer</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Layer with unique categories used in turntable
    <div>&#x00A0;</div>
    Relevant only with -t flag
    <div>&#x00A0;</div>
    Default: <i>4</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>sequence</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name for output file holding node sequence (&quot;-&quot; for stdout)</dd>
</dl>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<i>v.net.salesman</i> calculates the optimal route to visit nodes on a vector
  network.
<div class="Pp"></div>
Costs may be either line lengths, or attributes saved in a database table. These
  attribute values are taken as costs of whole segments, not as costs to
  traverse a length unit (e.g. meter) of the segment. For example, if the speed
  limit is 100 km / h, the cost to traverse a 10 km long road segment must be
  calculated as
<div>&#x00A0;</div>
length / speed = 10 km / (100 km/h) = 0.1 h.
<div>&#x00A0;</div>
Supported are cost assignments for arcs, and also different costs for both
  directions of a vector line. For areas, costs will be calculated along
  boundary lines.
<div class="Pp"></div>
The input vector needs to be prepared with <i>v.net operation=connect</i> in
  order to connect points representing center nodes to the network.
<div class="Pp"></div>
Points specified by category must be exactly on network nodes, and the input
  vector map needs to be prepared with <i>v.net operation=connect</i>.
<div class="Pp"></div>
Application of flag <b>-t</b> enables a turntable support. This flag requires
  additional parameters <b>turn_layer</b> and <b>turn_cat_layer</b> that are
  otherwise ignored. The turntable allows to model e.g. traffic code, where some
  turns may be prohibited. This means that the input layer is expanded by
  turntable with costs of every possible turn on any possible node
  (intersection) in both directions. Turntable can be created by the
  <i>v.net</i> module. For more information about turns in the vector network
  analyses see wiki page.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
Arcs can be closed using cost = -1. Turns support: The costs of turns on
  visiting nodes are not taken in account.
<h1 class="Sh" title="Sh" id="EXAMPLE"><a class="selflink" href="#EXAMPLE">EXAMPLE</a></h1>
Traveling salesman for 6 digitized nodes (Spearfish):
<div class="Pp"></div>
Shortest path, along unimproved roads:
<div class="Pp"></div>
Fastest path, along highways:
<div class="Pp"></div>
Searching for the shortest path using distance and the fastest path using
  traveling time according to the speed limits of different road types:
<div>&#x00A0;</div>
<pre>
# Spearfish
g.copy vect=roads,myroads
# we have 6 locations to visit on our trip
echo &quot;1|601653.5|4922869.2|a
2|608284|4923776.6|b
3|601845|4914981.9|c
4|596270|4917456.3|d
5|593330.8|4924096.6|e
6|598005.5|4921439.2|f&quot; | v.in.ascii in=- cat=1 x=2 y=3 out=centers col=&quot;cat integer, \
                         east double precision, north double precision, label varchar(43)&quot;
# verify data preparation
v.db.select centers
v.category centers op=report
# type       count        min        max
# point          6          1          6
# create lines map connecting points to network (on layer 2)
v.net myroads points=centers out=myroads_net op=connect thresh=500
v.category myroads_net op=report
# Layer / table: 1 / myroads_net
# type       count        min        max
# line         837          1          5
#
# Layer: 2
# type       count        min        max
# point          6          1          5
# find the shortest path
v.net.salesman myroads_net center_cats=1-6 out=mysalesman_distance
# set up costs as traveling time
# create unique categories for each road in layer 3
v.category in=myroads_net out=myroads_net_time opt=add cat=1 layer=3 type=line
# add new table for layer 3
v.db.addtable myroads_net_time layer=3 col=&quot;cat integer,label varchar(43),length double precision,speed double precision,cost double precision,bcost double precision&quot;
# copy road type to layer 3
v.to.db myroads_net_time layer=3 qlayer=1 opt=query qcolumn=label columns=label
# upload road length in miles
v.to.db myroads_net_time layer=3 type=line option=length col=length unit=miles
# set speed limits in miles / hour
v.db.update myroads_net_time layer=3 col=speed val=&quot;5.0&quot;
v.db.update myroads_net_time layer=3 col=speed val=&quot;75.0&quot; where=&quot;label=&#x2019;interstate&#x2019;&quot;
v.db.update myroads_net_time layer=3 col=speed val=&quot;75.0&quot; where=&quot;label=&#x2019;primary highway, hard surface&#x2019;&quot;
v.db.update myroads_net_time layer=3 col=speed val=&quot;50.0&quot; where=&quot;label=&#x2019;secondary highway, hard surface&#x2019;&quot;
v.db.update myroads_net_time layer=3 col=speed val=&quot;25.0&quot; where=&quot;label=&#x2019;light-duty road, improved surface&#x2019;&quot;
v.db.update myroads_net_time layer=3 col=speed val=&quot;5.0&quot; where=&quot;label=&#x2019;unimproved road&#x2019;&quot;
# define traveling costs as traveling time in minutes:
# set forward costs
v.db.update myroads_net_time layer=3 col=cost val=&quot;length / speed * 60&quot;
# set backward costs
v.db.update myroads_net_time layer=3 col=bcost val=&quot;length / speed * 60&quot;
# find the fastest path
v.net.salesman myroads_net_time arc_layer=3 node_layer=2 arc_column=cost arc_backward_column=bcost center_cats=1-6 out=mysalesman_time
</pre>
To display the result, run for example:
<div>&#x00A0;</div>
<pre>
# Display the results
g.region vector=myroads_net
# shortest path
d.mon x0
d.vect myroads_net
d.vect centers -c icon=basic/triangle
d.vect mysalesman_distance col=green width=2
d.font Vera
d.vect centers col=red disp=attr attrcol=label lsize=12
# fastest path
d.mon x1
d.vect myroads_net
d.vect centers -c icon=basic/triangle
d.vect mysalesman_time col=green width=2
d.font Vera
d.vect centers col=red disp=attr attrcol=label lsize=12
</pre>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i>d.path</i>, <i>v.net</i>, <i>v.net.alloc</i>, <i>v.net.iso</i>,
  <i>v.net.path</i>, <i>v.net.steiner</i>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Radim Blazek, ITC-Irst, Trento, Italy
<div>&#x00A0;</div>
Markus Metz
<div>&#x00A0;</div>
Documentation: Markus Neteler, Markus Metz
<h2 class="Ss" title="Ss" id="TURNS_SUPPORT"><a class="selflink" href="#TURNS_SUPPORT">TURNS
  SUPPORT</a></h2>
The turns support was implemnented as part of GRASS GIS turns cost project at
  Czech Technical University in Prague, Czech Republic. Eliska Kyzlikova, Stepan
  Turek, Lukas Bocan and Viera Bejdova participated at the project.
  Implementation: Stepan Turek Documentation: Lukas Bocan Mentor: Martin Landa
<div class="Pp"></div>
<i>Last changed: $Date: 2016-11-14 00:09:36 +0100 (Mon, 14 Nov 2016) $</i>
<h1 class="Sh" title="Sh" id="SOURCE_CODE"><a class="selflink" href="#SOURCE_CODE">SOURCE
  CODE</a></h1>
Available at: v.net.salesman source code (history)
<div class="Pp"></div>
Main index | Vector index | Topics index | Keywords index | Graphical index |
  Full index
<div class="Pp"></div>
&#x00A9; 2003-2016 GRASS Development Team, GRASS GIS 7.2.0 Reference
  Manual</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os">GRASS 7.2.0</td>
  </tr>
</table>
</body>
</html>
