<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:03:31 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>desproxy(1) User Commands desproxy(1)</p>

<p style="margin-top: 1em">NAME <br>
desproxy - a TCP tunnel for HTTP proxies</p>

<p style="margin-top: 1em">SYNOPSIS <br>
desproxy remote_host remote_port proxy_host proxy_port
local_port</p>

<p style="margin-top: 1em">OPTIONS <br>
None.</p>

<p style="margin-top: 1em">DESCRIPTION <br>
HTTP proxies are network servers that are used to give HTTP
(web) access to computers that are not connected to the
Internet. This is a typical scenario in corporate networks
and <br>
recently in home networks too. HTTP proxies connect to the
Internet either directly or via a parent proxy (which in
fact connects to the Internet directly or via another parent
<br>
proxy, and so on...)</p>

<p style="margin-top: 1em">HTTP clients (web browsers) use
HTTP proxies to request web pages; the HTTP server just
forwards those request to the destination server. All the
negotiation is done via the HTTP <br>
protocol, which is designed just to carry HTTP requests and
no generic (TCP/IP) traffic. That is why you can&rsquo;t
(normally) use Internet applications beside your web server
if you <br>
are behind a HTTP proxy.</p>

<p style="margin-top: 1em">That is what desproxy is good
for. Desproxy is a TCP tunnel, which means desproxy can
forward TCP/IP traffic via a HTTP proxy. Desproxy uses a
HTTP/1.1 method (CONNECT) to <br>
establish TCP/IP connections on demand. CONNECT is used for
SSL connections when accessing to secure sites, so if you
can access sites that support SSL (www.hotmail.com for <br>
example) you can use desproxy.</p>

<p style="margin-top: 1em">Not all IP (Internet) traffic is
just TCP/IP. In fact there are two more protocols widely
used in the Internet not supported by desproxy: UDP and
ICMP:</p>

<p style="margin-top: 1em">&Acirc;&middot; ICMP is used to
manage large IP networks. The only application using ICMP
you may miss is ping.</p>

<p style="margin-top: 1em">&Acirc;&middot; UDP is an
unreliable connection-less fast transport protocol, mostly
used in network games and other applications that need low
latency network traffic. Notably DNS uses UDP <br>
packets for fast delivery.</p>

<p style="margin-top: 1em">Will desproxy work with my HTTP
proxy? <br>
Short answer: just give it a try</p>

<p style="margin-top: 1em">Long answer: desproxy should
work with every HTTP proxy, with the following
exceptions:</p>

<p style="margin-top: 1em">&Acirc;&middot; MS Proxies with
NTLM authentication. NTLM is a proprietary authentication
method from Microsoft, not a standard authentication method.
Maybe in the future desproxy will <br>
support NTLM authentication, but currently it
doesn&rsquo;t.</p>

<p style="margin-top: 1em">&Acirc;&middot; HTTP/1.0
Proxies. Desproxy needs the CONNECT method, which is only
available from HTTP/1.1 protocol version. It&rsquo;s very
unlikely your proxy doesn&rsquo;t accept HTTP/1.1
requests.</p>

<p style="margin-top: 1em">&Acirc;&middot; HTTP/1.1 Proxies
without the CONNECT method. Maybe your network administrator
deactivated CONNECT support in the proxy, or maybe CONNECT
is restricted to the HTTPS port <br>
(443).</p>

<p style="margin-top: 1em">Assumptions <br>
Let&rsquo;s assume the following:</p>

<p style="margin-top: 1em">&Acirc;&middot; your HTTP proxy
host name is &quot;proxy&quot; and its address is
&quot;192.0.0.1&quot;</p>

<p style="margin-top: 1em">&Acirc;&middot; your HTTP proxy
port is &quot;8080&quot;</p>

<p style="margin-top: 1em">&Acirc;&middot; your HTTP proxy
doesn&rsquo;t need authentication. It case you need HTTP
authentication, please read [2]this.</p>

<p style="margin-top: 1em">&Acirc;&middot; your system
console will be a terminal (xterm, the console or a virtual
terminal) if you are running Linux, *BSD or other UN*X</p>

<p style="margin-top: 1em">About connections <br>
Imagine you need a network application that uses only one
TCP/IP connection with just one server. That&rsquo;s the
case of IRC in which you connect to an IRC server or ssh
where you <br>
typically connect just to one UNIX computer at a time.
That&rsquo;s what I called a &quot;static
connection&quot;.</p>

<p style="margin-top: 1em">Of course that&rsquo;s not the
case of a web browser or a file sharing program, both of
them doing several connections at a time to different
computers. That&rsquo;s what I call &quot;dynamic <br>
connections&quot;.</p>

<p style="margin-top: 1em">STATIC CONNECTIONS EXAMPLES <br>
item How to use desproxy to connect to IRC <br>
Suppose you want to connect to IRC using irc.undernet.org
port 6667 as your IRC server. First you have to start a
system console (see Assumptions above for details) and
type</p>

<p style="margin-top: 1em">desproxy irc.undernet.org 6667
proxy 8080 1080</p>

<p style="margin-top: 1em">That should start desproxy,
giving you the copyright notice along with some information.
The following is a screen capture from desproxy 0.0.23</p>


<p style="margin-top: 1em">-----------------------------------
<br>
desproxy 0.0.23</p>

<p style="margin-top: 1em">(c) Miguelanxo Otero Salgueiro
2001</p>

<p style="margin-top: 1em">This release brought to you
patched <br>
by Rutger Nijlunsig.</p>

<p style="margin-top: 1em">See RutgerWork.txt in
documentation <br>
for details about new features.</p>

<p style="margin-top: 1em">Great work guy! <br>
----------------------------------- <br>
TCP port 1080 Binded &amp; Listening <br>
Press ENTER to Quit</p>

<p style="margin-top: 1em">Desproxy reports it is listening
in local port 1080 ready for a connection.</p>

<p style="margin-top: 1em">Open your favourite IRC client
(install it first ;D) and connect to 127.0.0.1 port 1080 as
your irc server (127.0.0.1 is a virtual IP, always
referencing to your local machine). <br>
Then, your IRC client should connect to desproxy. It looks
like</p>

<p style="margin-top: 1em">Connection request from
127.0.0.1, port 1220 <br>
Connecting to http proxy (proxy:8080) <br>
Bidirectional connection established</p>

<p style="margin-top: 1em">Then you should be able to use
your IRC client as if you were directly connected to
irc.undernet.org.</p>

<p style="margin-top: 1em">How to use desproxy to log in a
computer using ssh <br>
Suppose you have a shell account in a computer that supports
secure connections via ssh. Let&rsquo;s assume it&rsquo;s
called shell.corporate.com. SSH uses port number 22 by
default. So <br>
start a new system console and type:</p>

<p style="margin-top: 1em">desproxy shell.corporate.com 22
proxy 8080 1080</p>

<p style="margin-top: 1em">Then, tell your ssh client to
connect to localhost (127.0.0.1) port 1080 and you should
get a ssh password prompt!</p>

<p style="margin-top: 1em">How to use desproxy to use other
static clients <br>
Let&rsquo;s assume you want to use network application X,
which doesn&rsquo;t support HTTP proxies but use one TCP/IP
connection (like IRC and SSH). To make X work with desproxy,
you just <br>
have to 1) Search for the default port of that application
2) Search for the default server of that application and 3)
Start desproxy, passing that info as command line <br>
parameters. Format is</p>

<p style="margin-top: 1em">desproxy remote_host remote_port
proxy_host proxy_port local_port</p>

<p style="margin-top: 1em">Just give a local_port of your
desire, but always over 1023, cause lower ports may need
administrator privileges.</p>

<p style="margin-top: 1em">About HTTP Authentication <br>
Some HTTP proxies need for security reasons a method of
checking client&rsquo;s identity. That&rsquo;s called HTTP
authentication (or HTTP authorization).</p>

<p style="margin-top: 1em">Despoxy now supports Basic HTTP
authentication. If your proxy needs other kind of
authentication (either Digest or NTLM) desproxy won&rsquo;t
work.</p>

<p style="margin-top: 1em">For desproxy to work with a HTTP
proxy that needs authentication, you have to tell desproxy
which username and password to use. Desproxy reads the
environment variable PROXY_USER <br>
to get that info.</p>

<p style="margin-top: 1em">Suppose your proxy username is
&quot;mayka&quot; and your proxy password is
&quot;007sgotLTK&quot;. Then, before using any of the
desproxy programs you should type this in your system
console:</p>

<p style="margin-top: 1em">set
PROXY_USER=mayka:007sgotLTK</p>

<p style="margin-top: 1em">Beware passwords can include
some characters that should be escaped from the system
console. For example, if your password is
&quot;moon!=sun&quot;, and you are running Linux, you should
<br>
type</p>

<p style="margin-top: 1em">export
PROXY_USER=yourusername:moon=sun</p>

<p style="margin-top: 1em">Note characters &quot;!&quot;
and &quot;=&quot; are escaped using the backslash &quot;</p>

<p style="margin-top: 1em">head1 Troubleshooting</p>

<p style="margin-top: 1em">A normal desproxy session looks
like this:</p>

<p style="margin-top: 1em">$ desproxy 127.0.0.1 21
127.0.0.1 4480 2222</p>


<p style="margin-top: 1em">-----------------------------------
<br>
desproxy &lt;version&gt;</p>

<p style="margin-top: 1em">HTTP/1.1 <br>
(c) Miguelanxo Otero Salgueiro 2001 <br>
-----------------------------------</p>

<p style="margin-top: 1em">Listening on port 2222 <br>
Connection request from 127.0.0.1, port 1227 <br>
Connecting to http proxy (127.0.0.1:4480) <br>
Bidirectional connection stablished <br>
(127.0.0.1:21) &lt;-&gt; (localhost) <br>
End of connection.</p>

<p style="margin-top: 1em">Here, a connection to local ftp
server (127.0.0.1:21) is made by using local proxy
(127.0.0.1:4480). You can see how, after the connection is
accepted, desproxy connected to the <br>
proxy, interchanged some bytes (a FTP session) and
terminates the connection.</p>

<p style="margin-top: 1em">Desproxy is quite self
explanatory about errors. Desproxy-inetd is far more
obscure, because the way inetd uses it (can&rsquo;t print
error messages) to the console.</p>

<p style="margin-top: 1em">Basically there are two kind of
errors:</p>

<p style="margin-top: 1em">&Acirc;&middot; Errors reported
when connecting to the proxy: the http page showing the
error is displayed.</p>

<p style="margin-top: 1em">&Acirc;&middot; Every other
error: a short error message is displayed.</p>

<p style="margin-top: 1em">Some common HTTP errors (as
reported by the proxy)</p>

<p style="margin-top: 1em">* HTTP 400 Bad Request - Some
versions of desproxy (0.0.21) cause <br>
this error (FATAL) <br>
* HTTP 403 Forbidden - Forbidden to do that (FATAL) <br>
* HTTP 404 Not Found - Page not found, or resource not found
(MINOR) <br>
* HTTP 405 Method not Allowed - Can&rsquo;t do CONNECT
method (FATAL) <br>
* HTTP 500 Internal Server Error - Maybe you&rsquo;re trying
to connect to <br>
a remote closed port (remote site reported connection
refused) <br>
(MINOR) <br>
* HTTP 503 Service Unavailable -&gt; The proxy can&rsquo;t
reach the site <br>
(MINOR) <br>
* HTTP 505 HTTP Version Not Supported - CONNECT method not
available <br>
(FATAL) <br>
* HTTP 502 Bad Gateway - Stands for &quot;DNS lookup
error&quot; (MINOR)</p>

<p style="margin-top: 1em">(FATAL) - Forget about using
desproxy, you can&rsquo;t surpass the proxy. (TODO) - To do,
not yet implemented. (MINOR) - Temporary fault or maybe your
fault.</p>

<p style="margin-top: 1em">ENVIRONMENT <br>
PROXY_USER <br>
An example:</p>

<p style="margin-top: 1em">PROXY_USER=mayka:007sgotLTK</p>

<p style="margin-top: 1em">Beware passwords can include
some characters that should be escaped from the system
console. For example, if your password is
&quot;moon!=sun&quot;, and you are running Linux, you <br>
should type</p>

<p style="margin-top: 1em">PROXY_USER <br>
An example:</p>


<p style="margin-top: 1em">PROXY_USER=yourusername:moon=sun</p>

<p style="margin-top: 1em">Note characters &quot;!&quot;
and &quot;=&quot; are escaped using the backslash &quot;</p>

<p style="margin-top: 1em">FILES <br>
None.</p>

<p style="margin-top: 1em">SEE ALSO <br>
dnsproxy-dns(1), dnsproxy-inetd(1), dnsproxy-socksserver(1),
connect(1)</p>

<p style="margin-top: 1em">AUTHORS <br>
This manual page was written by Jari Aalto
&lt;jari.aalto@cante.net&gt;, for the Debian GNU system (but
may be used by others). Released under license GPL v2 or, at
your option, any <br>
later version.</p>

<p style="margin-top: 1em">desproxy 2016-10-30
desproxy(1)</p>
<hr>
</body>
</html>
