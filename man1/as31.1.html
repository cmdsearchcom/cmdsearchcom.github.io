<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 15:52:20 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>AS31(1) General Commands Manual AS31(1)</p>

<p style="margin-top: 1em">NAME <br>
as31 - An Intel 8031/8051 assembler</p>

<p style="margin-top: 1em">SYNOPSIS <br>
as31 [-h] [-l] [-s] [-v] [-Aarg] [-Ffmt] [-Ofile]
infile.asm</p>

<p style="margin-top: 1em">DESCRIPTION <br>
As31 assembles infile.asm into one of several different
output formats. The output will be in a file called
infile.obj. The .asm extenstion is required.</p>

<p style="margin-top: 1em">OPTIONS <br>
The options must appear before the input file name. Both
options are optional. The text of each flag must appear on
the same argument as the flag. For example, &quot;-Fod&quot;
is a valid <br>
argument, but &quot;-F od&quot; is not.</p>

<p style="margin-top: 1em">-h This causes the assembler to
print out a verbose message describing its options. The
message is written to the standard error.</p>

<p style="margin-top: 1em">-l This option tells the
assembler to also generate a listing file. A listing will be
placed in the file infile.lst. Where &rsquo;infile&rsquo; is
the file that is being assembled. This <br>
option may appear anywhere before infile.asm. The option
must occur isolated on the command line.</p>

<p style="margin-top: 1em">The listing file shows the
assembler generated code in hex, and up to 60 characters are
retained from the source file.</p>

<p style="margin-top: 1em">-s This causes the assembler to
write output to standard output.</p>

<p style="margin-top: 1em">-v This causes the assembler to
print a version number to the standard output.</p>

<p style="margin-top: 1em">-Aarg This option specifies a
format specific string which is passed to the format
generator. Both format &quot;tdr&quot; and the srecord
formats use this option.</p>

<p style="margin-top: 1em">-Fformat <br>
This options specifies the output format that is to be
used.</p>

<p style="margin-top: 1em">Currently the only options
available for this are:</p>

<p style="margin-top: 1em">hex This format is the Intel HEX
format which is expected by a number of EPROM programmers
and the PAULMON debugger. For use with some programmers, the
output file&rsquo;s <br>
extension may have to be changed to .HEX to be recognized by
the programmer. No -A option is used. This format should be
the default if no -F option is used.</p>

<p style="margin-top: 1em">tdr This format generates an
asci file of hex digits formatted in such a way, so that
they can be read by tdr&rsquo;s debugger. An argument can be
specified (See -A option) <br>
which will pass a format specific string to the format
generator. In this case, the argument string represents an
offset to add to the location counter. This offset <br>
is specified in decimal and defaults to 64*1024 (0x10000).
To specify and offset of 100, you would need &quot;-Ftdr
-A100&quot; when invoking the assembler.</p>

<p style="margin-top: 1em">byte This format is simply an
address and a byte on each line, in ascii. No -A option is
used.</p>

<p style="margin-top: 1em">od This format is similar to the
output from od(1). The format consists of an address
followed by sixteen hexadecimal bytes, followed by the
equivilant ASCII. No -A <br>
option is used.</p>

<p style="margin-top: 1em">srec2, srec3, srec4 <br>
The srecord generator is capable of generating output with
any one of 2, 3, or 4 byte addresses. The -A option can be
used to set the base address offset, the <br>
default here is 0x0000 (unlike tdr).</p>

<p style="margin-top: 1em">NOTE: This assembler allows for
the output formats to be expanded to include many different
output formats.</p>

<p style="margin-top: 1em">-Ofile This option tells the
assembler to write the output to a file.</p>

<p style="margin-top: 1em">ASSEMBLER INSTRUCTIONS <br>
This assembler accepts standard 8031/8051 instruction
formats. Below is a list of instructions and addressing
modes.</p>

<p style="margin-top: 1em">INSTRUCTION BYTES CYCLES <br>
----------- ----- ------ <br>
ACALL addr11 2 24 <br>
ADD A, #data8 2 12 <br>
ADD A, @Ri 1 12 <br>
ADD A, Rn 1 12 <br>
ADD A, direct 2 12 <br>
ADDC A, #data8 2 12 <br>
ADDC A, @Ri 1 12 <br>
ADDC A, Rn 1 12 <br>
ADDC A, direct 2 12 <br>
AJMP addr11 2 24 <br>
ANL A, #data8 2 12 <br>
ANL A, @Ri 1 12 <br>
ANL A, Rn 1 12 <br>
ANL A, direct 2 12 <br>
ANL C, /bit 2 24 <br>
ANL C, !bit 2 24 <br>
ANL C, bit 2 24 <br>
ANL direct, #data8 3 24 <br>
ANL direct, A 2 12 <br>
CJNE @Ri, #data8, rel 3 24 <br>
CJNE A, #data8, rel 3 24 <br>
CJNE A, direct, rel 3 24 <br>
CJNE Rn, #data8, rel 3 24 <br>
CLR A 1 12 <br>
CLR C 1 12 <br>
CLR bit 2 12 <br>
CPL A 1 12 <br>
CPL C 1 12 <br>
CPL bit 2 12 <br>
DA A 1 12 <br>
DEC @Ri 1 12 <br>
DEC A 1 12 <br>
DEC DPTR 1 12 <br>
DEC Rn 1 12 <br>
DEC direct 2 12 <br>
DIV AB 1 48 <br>
DJNZ Rn, rel 2 24 <br>
DJNZ direct, rel 3 24 <br>
INC @Ri 1 12 <br>
INC A 1 12 <br>
INC DPTR 1 24 <br>
INC Rn 1 12 <br>
INC direct 2 12 <br>
JB bit, rel 3 24 <br>
JBC bit, rel 3 24 <br>
JC relative 2 24 <br>
JMP @A + DPTR 1 24 <br>
JMP @DPTR + A 1 24 <br>
JNB bit, rel 3 24 <br>
JNC relative 2 24 <br>
JNZ relative 2 24 <br>
JZ relative 2 24 <br>
LCALL addr16 3 24 <br>
LJMP addr16 3 24 <br>
MOV @Ri, #data8 2 12 <br>
MOV @Ri, A 1 12 <br>
MOV @Ri, direct 2 24 <br>
MOV A, #data8 2 12 <br>
MOV A, @Ri 1 12 <br>
MOV A, Rn 1 12 <br>
MOV A, direct 2 12 <br>
MOV C, bit 2 12 <br>
MOV DPTR, #data16 3 24 <br>
MOV Rn, #data8 2 12 <br>
MOV Rn, A 1 12 <br>
MOV Rn, direct 2 24 <br>
MOV bit, C 2 24 <br>
MOV direct, #data8 3 24 <br>
MOV direct, @Ri 2 24 <br>
MOV direct, A 2 12 <br>
MOV direct, Rn 2 24 <br>
MOV direct, direct 3 24 <br>
MOVC A, @A + DPTR 1 24 <br>
MOVC A, @A + PC 1 24 <br>
MOVC A, @DPTR + A 1 24 <br>
MOVC A, @PC + A 1 24 <br>
MOVX @DPTR, A 1 12 <br>
MOVX @Ri, A 1 24 <br>
MOVX A, @DPTR 1 24 <br>
MOVX A, @Ri 1 24 <br>
MUL AB 1 48 <br>
NOP 1 12 <br>
ORL A, #data8 2 12 <br>
ORL A, @Ri 1 12 <br>
ORL A, Rn 1 12 <br>
ORL A, direct 2 12 <br>
ORL C, /bit 2 24 <br>
ORL C, !bit 2 24 <br>
ORL C, bit 2 24 <br>
ORL direct, #data8 3 24 <br>
ORL direct, A 2 12 <br>
POP direct 2 24 <br>
PUSH direct 2 24 <br>
RET 1 24 <br>
RETI 1 24 <br>
RL A 1 12 <br>
RLC A 1 12 <br>
RR A 1 12 <br>
RRC A 1 12 <br>
SETB A 1 12 <br>
SETB bit 2 12 <br>
SJMP relative 2 24 <br>
SUBB A, #data8 2 12 <br>
SUBB A, @Ri 1 12 <br>
SUBB A, Rn 1 12 <br>
SUBB A, direct 2 12 <br>
SWAP A 1 12 <br>
XCH A, #data8 2 12 <br>
XCH A, @Ri 1 12 <br>
XCH A, Rn 1 12 <br>
XCH A, direct 2 12 <br>
XCHD A, #data8 2 12 <br>
XCHD A, @Ri 1 12 <br>
XCHD A, Rn 1 12 <br>
XCHD A, direct 2 12 <br>
XRL A, #data8 2 12 <br>
XRL A, @Ri 1 12 <br>
XRL A, Rn 1 12 <br>
XRL A, direct 2 12 <br>
XRL direct, #data8 3 12 <br>
XRL direct, A 2 12</p>

<p style="margin-top: 1em">ASSEMBLER DIRECTIVES <br>
As31 includes the following assembler directives:</p>

<p style="margin-top: 1em">.ORG expr <br>
Start assembling at the address specified by the expression
expr. An error occurs if the assembler starts assembling
over an address space that has previously been assem&acirc;
<br>
bled into.</p>

<p style="margin-top: 1em">.EQU symbol, expr <br>
Set symbol to the value of expr. The value for expr must be
known during the first pass, when the line containing the
.EQU is encountered.</p>

<p style="margin-top: 1em">.BYTE expr, expr, ... <br>
Assemble the bytes specified by the expression into memory.
A string may also be specified with this directive.</p>

<p style="margin-top: 1em">.WORD expr, expr, ... <br>
Assemble the words specified by the expression into memory.
The byte ordering used, is that used by the 8031.</p>

<p style="margin-top: 1em">.FLAG symbol1, symbol.[0-7] <br>
Sets symbol1 to the bit address specified by the
symbol.[0-7] expression. Where [0-7] denotes a character
between 0 and 7. The resulting bit address is checked to see
if <br>
it is a valid bit address.</p>

<p style="margin-top: 1em">.END This directive is
ignored.</p>

<p style="margin-top: 1em">.SKIP expr <br>
Adds the value of expr to the location counter. Used to
reserve a block of uninitialized data. Expr should be in
bytes.</p>

<p style="margin-top: 1em">LEXICAL CONVENTIONS <br>
- All characters following a semi-colon are ignored until a
newline is encountered.</p>

<p style="margin-top: 1em">- All numbers default to
decimal, unless the number starts with one of the
following:</p>

<p style="margin-top: 1em">0x or 0X <br>
This indicates a hexadecimal number. ie. 0x00ff</p>

<p style="margin-top: 1em">0b or 0B <br>
This indicates a binary number. (1&rsquo;s and 0&rsquo;s).
ie. 0b1100110010</p>

<p style="margin-top: 1em">0 This indicates an octal
number. ie. 0377</p>

<p style="margin-top: 1em">- All numbers default to
decimal, unless the number ends with one of the following
characters:</p>

<p style="margin-top: 1em">b or B This indicates a binary
number. Unless 0x was used above. ie. 1010101b</p>

<p style="margin-top: 1em">h or H This always indicates a
hex number, However the if the first character is
non-numerical, then either 0x or 0 must be specified. This
avoids confusing the assembler <br>
into thinking a hex number is a symbol. For example: 0ffh,
0xffh, 0XffH, 20h, 0x20 and 020h are means to specify a
valid hexdigit. But the following are not: ffh, <br>
0ff.</p>

<p style="margin-top: 1em">d or D This forces a number to
decimal. Unless 0X was used. ie. 129d</p>

<p style="margin-top: 1em">o or O This causes the number to
be interpreted as octal. ie. 377o</p>

<p style="margin-top: 1em">- A character constant can be
entered as &rsquo;c&rsquo; where c is some character. 0 ,
&acute; are also valid. A character constant can be used
anywhere that an integer value <br>
can.</p>

<p style="margin-top: 1em">- A string is entered as a set
of characters enclosed in double quotes &quot;&quot;. A
string is only valid with the .BYTE directive. 0 , <br>
ever is not.</p>

<p style="margin-top: 1em">- Instructions, directives, and
the symbols: R0, R1, R2, R3, R4, R5, R6, R7, A, AB, and C
can be entered in upper or lower case without assembler
confusion. These words how&acirc; <br>
ever cannot be defined as a user symbol. Any user symbol may
be used, and case will be preserved. So the user symbols
&quot;foo&quot; and &quot;Foo&quot; are different, but
&quot;addc&quot; is the <br>
same as &quot;aDdC&quot;.</p>

<p style="margin-top: 1em">- A symbol can be any alpha
numerical character plus the underscore
(&rsquo;_&rsquo;).</p>

<p style="margin-top: 1em">- Expressions are accepted in
most places where a value or a symbol is needed. An
expression consists of the following operators. All
operators evaulate to integer objects <br>
(higher precedence opertors listed first):</p>

<p style="margin-top: 1em">- Unary minus</p>

<p style="margin-top: 1em">&amp; Bit-wise AND.</p>

<p style="margin-top: 1em">| Bit-Wise OR.</p>

<p style="margin-top: 1em">* Integer multiplication.</p>

<p style="margin-top: 1em">/ Integer division</p>

<p style="margin-top: 1em">% Integer modulus</p>

<p style="margin-top: 1em">+ Integer addition.</p>

<p style="margin-top: 1em">- Integer subtraction.</p>

<p style="margin-top: 1em">- In addition to these
operators, a special symbol &rsquo;*&rsquo; may be used to
represent the current location counter.</p>

<p style="margin-top: 1em">EXAMPLES <br>
Below is a sample assembly program.</p>

<p style="margin-top: 1em">.org 0 <br>
start: mov P3, #0xff ; use alternate fns on P3 <br>
; leds on P1 are inverted. <br>
setb F0 ; climbing up <br>
mov A, #0x01 ; initial bit</p>

<p style="margin-top: 1em">write: cpl A ; write it <br>
mov P1, A <br>
cpl A <br>
acall delay <br>
jb F0, climbup ; climbing which way?</p>

<p style="margin-top: 1em">climbdn: rr A ; down - shift
right <br>
jnb ACC.0, write ; back for more <br>
setb F0 <br>
ajmp write</p>

<p style="margin-top: 1em">climbup: rl A ; up - shift left
<br>
jnb ACC.7, write ; back for more <br>
clr F0 <br>
ajmp write <br>
.end ; this directive ignored.</p>

<p style="margin-top: 1em">AUTHORS <br>
Ken Stauffer (University of Calgary)
&lt;stauffer@cpsc.ucalgary.ca&gt; <br>
Martin Langer &lt;martin-langer@gmx.de&gt;</p>
 
<p style="margin-top: 1em">AS31(1)</p>
<hr>
</body>
</html>
