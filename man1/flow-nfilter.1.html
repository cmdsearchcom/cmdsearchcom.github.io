<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:10:24 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>flow-nfilter(1) General Commands Manual
flow-nfilter(1)</p>

<p style="margin-top: 1em">NAME <br>
flow-nfilter &acirc; Filter flows.</p>

<p style="margin-top: 1em">SYNOPSIS <br>
flow-nfilter [-hk] [-b big|little] [-C comment] [-d
debug_level] [-f filter_fname] [-F filter_definition] [-v
variable binding] [-z z_level]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
The flow-nfilter utility will filter flows based on user
selectable criteria. Filters are defined in a configuration
file and are composed of primitives and a definition.
Defi&acirc; <br>
nitions contain match lines grouped to form logical AND and
OR operations on the flow using the selected primitives. A
definition may contain the invert command which will <br>
invert the result of the evaluation.</p>

<p style="margin-top: 1em">Words in the configuration file
of the form @VAR or @{VAR:-default} will be expanded at
run-time by setting variable names with the -v option.</p>

<p style="margin-top: 1em">Filter primitives begin with the
filter-primitive keyword followed by a symbolic name. Each
primitive has a type defined below. A list of permit and or
deny keywords followed <br>
by an argument are later evaulated to determine if the flow
is permitted or denied. The default action for a primitive
is to deny which may be changed with the default keyword.
<br>
Symbolic substitutions are done where appropriate.</p>

<p style="margin-top: 1em">The match keyword in a
definition selects the criteria to match a primitive. A
match type may allow more than one type of primitive, for
example the src-ip-addr match type will <br>
accept any of {ip-address, ip-address-mask,
ip-address-prefix} primitive types.</p>

<p style="margin-top: 1em">Primitive type Type
Description/Example <br>

-------------------------------------------------------------------
<br>
as Bucket Autonomous System Number. <br>
600,159,3112</p>

<p style="margin-top: 1em">ip-address-prefix-len Numeric
Integer from 0 to 32. <br>
16-31</p>

<p style="margin-top: 1em">ip-protocol Bucket Integer from
0 to 255. <br>
6,17,1</p>

<p style="margin-top: 1em">ip-tos Bucket Integer from 0 to
255 with mask. <br>
0xA0/0xE0</p>

<p style="margin-top: 1em">ip-tcp-flags Bucket Integer from
0 to 255 with mask. <br>
0x2/0x2</p>

<p style="margin-top: 1em">ifindex Bucket Integer from 0 to
65535 <br>
0,5,10</p>

<p style="margin-top: 1em">engine Bucket Integer from 0 to
255. <br>
0</p>

<p style="margin-top: 1em">ip-port Bucket Integer from 0 to
65535. <br>
80,8080,23,22</p>

<p style="margin-top: 1em">ip-address Hash List of IP
Addresses. <br>
10.0.0.1</p>

<p style="margin-top: 1em">ip-address-mask List List of IP
address/mask pairs. <br>
10.1.0.0 255.255.0.0</p>

<p style="margin-top: 1em">ip-address-prefix Trie List of
IP address/mask pairs. <br>
10.1/16</p>

<p style="margin-top: 1em">tag Hash List of tags. <br>
0xFF00</p>

<p style="margin-top: 1em">tag-mask List List of tags. <br>
0xF000/0xFF00</p>

<p style="margin-top: 1em">counter List List of Integers
with qualifier. <br>
lt 32</p>

<p style="margin-top: 1em">time List List of relative time
specifiers. <br>
gt 5:00</p>

<p style="margin-top: 1em">time-date List List of absolute
time specifiers. <br>
gt December 12, 2002 5:13:21</p>

<p style="margin-top: 1em">double List List of doubles with
qualifier. <br>
lt 32.0</p>

<p style="margin-top: 1em">rate Element Rate is calculated
as 1/rate. <br>
permit 100</p>

<p style="margin-top: 1em">Match type Description
Primitives accepted <br>

-------------------------------------------------------------------
<br>
source-as Source AS as</p>

<p style="margin-top: 1em">destination-as Destination AS
as</p>

<p style="margin-top: 1em">ip-source-address Source IP
Address ip-address, <br>
ip-address-mask, <br>
ip-address-prefix</p>

<p style="margin-top: 1em">ip-destination-address
Destination IP Address ip-address, <br>
ip-address-mask, <br>
ip-address-prefix</p>

<p style="margin-top: 1em">ip-exporter-address Exporter IP
Address ip-address, <br>
ip-address-mask, <br>
ip-address-prefix</p>

<p style="margin-top: 1em">ip-nexthop-address NextHop IP
Address ip-address, <br>
ip-address-mask, <br>
ip-address-prefix</p>

<p style="margin-top: 1em">ip-shortcut-address Shortcut IP
Address ip-address, <br>
ip-address-mask, <br>
ip-address-prefix</p>

<p style="margin-top: 1em">ip-protocol IP Protocol
ip-protocol</p>

<p style="margin-top: 1em">ip-source-address-prefix-len
<br>
Source IP address ip-address-prefix-len <br>
prefix length</p>


<p style="margin-top: 1em">ip-destination-address-prefix-len
<br>
Destination IP address ip-address-prefix-len <br>
prefix length</p>

<p style="margin-top: 1em">ip-tos IP Type Of Service
ip-tos</p>

<p style="margin-top: 1em">ip-marked-tos IP Type Of Service
ip-tos</p>

<p style="margin-top: 1em">ip-tcp-flags IP/TCP Flags
ip-tcp-flags</p>

<p style="margin-top: 1em">ip-source-port Source IP Port
ip-port <br>
eg TCP/UDP</p>

<p style="margin-top: 1em">ip-destination-port Destination
IP Port ip-port <br>
eg TCP/UDP</p>

<p style="margin-top: 1em">input-interface Source ifIndex
ifindex <br>
eg Input Interface</p>

<p style="margin-top: 1em">output-interface Destination
ifIndex ifindex <br>
eg Output Interface</p>

<p style="margin-top: 1em">start-time Start Time of flow
time, time-date</p>

<p style="margin-top: 1em">end-time End Time of Flow time,
time-date</p>

<p style="margin-top: 1em">flows Number of flows
counter</p>

<p style="margin-top: 1em">octets Number of octets
counter</p>

<p style="margin-top: 1em">packets Number of packets
counter</p>

<p style="margin-top: 1em">duration Duration of flow in ms
counter</p>

<p style="margin-top: 1em">engine-id Engine ID engine</p>

<p style="margin-top: 1em">engine-type Engine Type
engine</p>

<p style="margin-top: 1em">source-tag Source Tag tag,
tag-mask</p>

<p style="margin-top: 1em">destination-tag Destination Tag
tag, tag-mask</p>

<p style="margin-top: 1em">pps Packets Per Second
double</p>

<p style="margin-top: 1em">bps Bits Per Second double</p>

<p style="margin-top: 1em">random-sample Random Sample
rate</p>

<p style="margin-top: 1em">OPTIONS <br>
-b big|little <br>
Byte order of output.</p>

<p style="margin-top: 1em">-C Comment <br>
Add a comment.</p>

<p style="margin-top: 1em">-d debug_level <br>
Enable debugging.</p>

<p style="margin-top: 1em">-f filter_fname <br>
Filter list filename. Defaults to
/etc/flow-tools/cfg/filter.</p>

<p style="margin-top: 1em">-F filter_definition <br>
Select the active definition. Defaults to default.</p>

<p style="margin-top: 1em">-h Display help.</p>

<p style="margin-top: 1em">-k Keep time from input.</p>

<p style="margin-top: 1em">-v variable binding <br>
Set a variable FOO=bar.</p>

<p style="margin-top: 1em">-z z_level <br>
Configure compression level to z_level. 0 is disabled (no
compression), 9 is highest compression.</p>

<p style="margin-top: 1em">TIME/DATE parsing <br>
time-date parsing is implemented with getdate.y, a commonly
used function to process free-form time date specifications.
Example usage borrowed from cvs: <br>
1 month ago <br>
2 hours ago <br>
400000 seconds ago <br>
last year <br>
last Monday <br>
yesterday <br>
a fortnight ago <br>
3/31/92 10:00:07 PST <br>
January 23, 1987 10:05pm <br>
22:00 GMT</p>

<p style="margin-top: 1em">EXAMPLES <br>
An example of filter configuration file.</p>

<p style="margin-top: 1em">filter-primitive srate <br>
type rate <br>
permit 100</p>

<p style="margin-top: 1em">filter-primitive test-as <br>
type as <br>
permit 600,159</p>

<p style="margin-top: 1em">filter-primitive test-prefix-len
<br>
type ip-address-prefix-len <br>
permit 32</p>

<p style="margin-top: 1em">filter-primitive test-protocol
<br>
type ip-protocol <br>
permit tcp</p>

<p style="margin-top: 1em">filter-primitive test-tos <br>
type ip-tos <br>
mask 0xA0 <br>
permit 0xE0</p>

<p style="margin-top: 1em">filter-primitive test-tcp-flags
<br>
type ip-tcp-flags <br>
mask 0x2 <br>
permit 0x2</p>

<p style="margin-top: 1em">filter-primitive test-ifindex
<br>
type ifindex <br>
permit 0,5,10</p>

<p style="margin-top: 1em">filter-primitive test-engine
<br>
type engine <br>
permit 0</p>

<p style="margin-top: 1em">filter-primitive test-port <br>
type ip-port <br>
permit https <br>
permit 80 <br>
default deny</p>

<p style="margin-top: 1em">filter-primitive test-address
<br>
type ip-address <br>
permit 0.0.0.1 <br>
permit 0.0.0.2 <br>
default deny</p>

<p style="margin-top: 1em">filter-primitive
test-address-mask <br>
type ip-address-mask <br>
permit 128.146.197.1 255.255.255.255 <br>
permit 128.146.197.2 255.255.255.255</p>

<p style="margin-top: 1em">filter-primitive test-prefix
<br>
type ip-address-prefix <br>
permit 128.146.0.0/16 <br>
default deny</p>

<p style="margin-top: 1em">filter-primitive test-tag <br>
type tag <br>
permit 0x00 <br>
permit 0x01 <br>
permit 0xFF</p>

<p style="margin-top: 1em">filter-primitive test-tag-mask
<br>
type tag-mask <br>
permit OSU 0xFF <br>
permit 0xFF 0xFF <br>
default deny</p>

<p style="margin-top: 1em">filter-primitive test-counter
<br>
type counter <br>
permit lt 5 <br>
permit gt 10 <br>
default deny</p>

<p style="margin-top: 1em">filter-primitive test-time-date
<br>
type time-date <br>
permit gt December 12, 2002 5:13:21</p>

<p style="margin-top: 1em">filter-primitive test-time <br>
type time-date <br>
permit gt 12:15:00</p>

<p style="margin-top: 1em">filter-definition
sample-1-in-100 <br>
match random-sample srate</p>

<p style="margin-top: 1em">filter-definition t1 <br>
match engine-type test-engine <br>
or <br>
match destination-tag test-tag-mask</p>

<p style="margin-top: 1em">Display all flows with a
destination port of 80 or source port of 25 (smtp) starting
after Dec 12, 2001. The file test is populated with the
following:</p>

<p style="margin-top: 1em">filter-primitive port80 <br>
type ip-port <br>
permit 80</p>

<p style="margin-top: 1em">filter-primitive port25 <br>
type ip-port <br>
permit smtp</p>

<p style="margin-top: 1em">filter-primitive dec12 <br>
type time-date <br>
permit gt Dec 12, 2001</p>

<p style="margin-top: 1em">filter-definition foo <br>
match ip-source-port port80 <br>
match start-time dec12 <br>
or <br>
match ip-destination-port port25 <br>
match start-time dec12</p>

<p style="margin-top: 1em">flow-cat flows | flow-nfilter
-ftest -Ffoo | flow-print</p>

<p style="margin-top: 1em">FILES <br>
Configuration files: <br>
Symbols - /etc/flow-tools/sym/*. <br>
Tag - /etc/flow-tools/cfg/tag.cfg. <br>
Filter - /etc/flow-tools/cfg/filter.cfg.</p>

<p style="margin-top: 1em">BUGS <br>
None known.</p>

<p style="margin-top: 1em">AUTHOR <br>
Mark Fullmer maf@splintered.net</p>

<p style="margin-top: 1em">SEE ALSO <br>
flow-tools(1)</p>
 
<p style="margin-top: 1em">flow-nfilter(1)</p>
<hr>
</body>
</html>
