<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>FERM(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">FERM(1)</td>
    <td class="head-vol">FIREWALL RULES MADE EASY</td>
    <td class="head-rtitle">FERM(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
ferm - a firewall rule parser for linux
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>ferm</b> <i>options</i> <i>inputfile</i>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>ferm</b> is a frontend for <b>iptables</b>. It reads the rules from a
  structured configuration file and calls <i>iptables</i>(8) to insert them into
  the running kernel.
<div class="Pp"></div>
<b>ferm</b>'s goal is to make firewall rules easy to write and easy to read. It
  tries to reduce the tedious task of writing down rules, thus enabling the
  firewall administrator to spend more time on developing good rules than the
  proper implementation of the rule.
<div class="Pp"></div>
To achieve this, <b>ferm</b> uses a simple but powerful configuration language,
  which allows variables, functions, arrays, blocks. It also allows you to
  include other files, allowing you to create libraries of commonly used
  structures and functions.
<div class="Pp"></div>
<b>ferm</b>, pronounced &quot;firm&quot;, stands for &quot;For Easy Rule
  Making&quot;.
<h1 class="Sh" title="Sh" id="CAUTION"><a class="selflink" href="#CAUTION">CAUTION</a></h1>
This manual page does <i>not</i> indend to teach you how firewalling works and
  how to write good rules. There is already enough documentation on this topic.
<h1 class="Sh" title="Sh" id="INTRODUCTION"><a class="selflink" href="#INTRODUCTION">INTRODUCTION</a></h1>
Let's start with a simple example:
<div class="Pp"></div>
<pre>
    chain INPUT {
        proto tcp ACCEPT;
    }
</pre>
<div class="Pp"></div>
This will add a rule to the predefined input chain, matching and accepting all
  tcp packets. Ok, let's make it more complicated:
<div class="Pp"></div>
<pre>
    chain (INPUT OUTPUT) {
        proto (udp tcp) ACCEPT;
    }
</pre>
<div class="Pp"></div>
This will insert 4 rules, namely 2 in chain input, and 2 in chain output,
  matching and accepting both udp and tcp packets. Normally you would type this:
<div class="Pp"></div>
<pre>
   iptables -A INPUT -p tcp -j ACCEPT
   iptables -A OUTPUT -p tcp -j ACCEPT
   iptables -A INPUT -p udp -j ACCEPT
   iptables -A OUTPUT -p udp -j ACCEPT
</pre>
<div class="Pp"></div>
Note how much less typing we need to do? :-)
<div class="Pp"></div>
Basically, this is all there is to it, although you can make it quite more
  complex. Something to look at:
<div class="Pp"></div>
<pre>
   chain INPUT {
       policy ACCEPT;
       daddr 10.0.0.0/8 proto tcp dport ! ftp jump mychain sport :1023 TOS 4 settos 8 mark 2;
       daddr 10.0.0.0/8 proto tcp dport ftp REJECT;
   }
</pre>
<div class="Pp"></div>
My point here is, that *you* need to make nice rules, keep them readable to you
  and others, and not make it into a mess.
<div class="Pp"></div>
It would aid the reader if the resulting firewall rules were placed here for
  reference. Also, you could include the nested version with better readability.
<div class="Pp"></div>
Try using comments to show what you are doing:
<div class="Pp"></div>
<pre>
    # this line enables transparent http-proxying for the internal network:
    proto tcp if eth0 daddr ! 192.168.0.0/255.255.255.0
        dport http REDIRECT to-ports 3128;
</pre>
<div class="Pp"></div>
You will be thankful for it later!
<div class="Pp"></div>
<pre>
    chain INPUT {
        policy ACCEPT;
        interface (eth0 ppp0) {
            # deny access to notorius hackers, return here if no match
            # was found to resume normal firewalling
            jump badguys;
            protocol tcp jump fw_tcp;
            protocol udp jump fw_udp;
        }
    }
</pre>
<div class="Pp"></div>
The more you nest, the better it looks. Make sure the order you specify is
  correct, you would not want to do this:
<div class="Pp"></div>
<pre>
    chain FORWARD {
        proto ! udp DROP;
        proto tcp dport ftp ACCEPT;
    }
</pre>
<div class="Pp"></div>
because the second rule will never match. Best way is to specify first everyting
  that is allowed, and then deny everything else. Look at the examples for more
  good snapshots. Most people do something like this:
<div class="Pp"></div>
<pre>
    proto tcp {
        dport (
            ssh http ftp
        ) ACCEPT;
        dport 1024:65535 ! syn ACCEPT;
        DROP;
    }
</pre>
<h1 class="Sh" title="Sh" id="STRUCTURE_OF_A_FIREWALL_FILE"><a class="selflink" href="#STRUCTURE_OF_A_FIREWALL_FILE">STRUCTURE
  OF A FIREWALL FILE</a></h1>
The structure of a proper firewall file looks like simplified C-code. Only a few
  syntactic characters are used in ferm- configuration files. Besides these
  special caracters, ferm uses 'keys' and 'values', think of them as options and
  parameters, or as variables and values, whatever.
<div class="Pp"></div>
With these words, you define the characteristics of your firewall. Every
  firewall consists of two things: First, look if network traffic matches
  certain conditions, and second, what to do with that traffic.
<div class="Pp"></div>
You may specify conditions that are valid for the kernel interface program you
  are using, probably <i>iptables</i>(8). For instance, in iptables, when you
  are trying to match tcp packets, you would say:
<div class="Pp"></div>
<pre>
    iptables --protocol tcp
</pre>
<div class="Pp"></div>
In ferm, this will become:
<div class="Pp"></div>
<pre>
    protocol tcp;
</pre>
<div class="Pp"></div>
Just typing this in ferm doesn't do anything, you need to tell ferm (actually,
  you need to tell <i>iptables</i>(8) and the kernel) what to do with any
  traffic that matches this condition:
<div class="Pp"></div>
<pre>
    iptables --protocol tcp -j ACCEPT
</pre>
<div class="Pp"></div>
Or, translated to <b>ferm</b>:
<div class="Pp"></div>
<pre>
    protocol tcp ACCEPT;
</pre>
<div class="Pp"></div>
The <b>;</b> character is at the end of every ferm rule. Ferm ignores line
  breaks, meaning the above example is identical to the following:
<div class="Pp"></div>
<pre>
    protocol tcp
      ACCEPT;
</pre>
<div class="Pp"></div>
Here's a list of the special characters:
<dl class="Bl-tag">
  <dt class="It-tag"><b>;</b></dt>
  <dd class="It-tag">This character finalizes a rule.
    <div style="height: 1.00em;">&#x00A0;</div>
    Separated by semicolons, you may write multiple rules in one line, although
      this decreases readability:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    protocol tcp ACCEPT; protocol udp DROP;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>{}</b></dt>
  <dd class="It-tag">The nesting symbol defines a 'block' of rules.
    <div style="height: 1.00em;">&#x00A0;</div>
    The curly brackets contain any number of nested rules. All matches before
      the block are carried forward to these.
    <div style="height: 1.00em;">&#x00A0;</div>
    The closing curly bracket finalizes the rule set. You should not write a ';'
      after that, because that would be an empty rule.
    <div style="height: 1.00em;">&#x00A0;</div>
    Example:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    chain INPUT proto icmp {
        icmp-type echo-request ACCEPT;
        DROP;
    }
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    This block shows two rules inside a block, which will both be merged with
      anything in front of it, so you will get two rules:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    iptables -A INPUT -p icmp --icmp-type echo-request -j ACCEPT
    iptables -A INPUT -p icmp -j DROP
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    There can be multiple nesting levels:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    chain INPUT {
        proto icmp {
            icmp-type echo-request ACCEPT;
            DROP;
        }
        daddr 172.16.0.0/12 REJECT;
    }
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Note that the 'REJECT' rule is not affected by 'proto icmp', although there
      is no ';' after the closing curly brace. Translated to iptables:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    iptables -A INPUT -p icmp --icmp-type echo-request -j ACCEPT
    iptables -A INPUT -p icmp -j DROP
    iptables -A INPUT -d 172.16.0.0/12 -j REJECT
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>$</b></dt>
  <dd class="It-tag">Variable expansion. Replaces '$FOO' by the value of the
      variable. See the section <i>VARIABLES</i> for details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>&amp;</b></dt>
  <dd class="It-tag">Function call. See the section <i>FUNCTIONS</i> for
      details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>()</b></dt>
  <dd class="It-tag">The array symbol. Using the parentheses, you can define a
      'list' of values that should be applied for the key to the left of it.
    <div style="height: 1.00em;">&#x00A0;</div>
    Example:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    protocol ( tcp udp icmp )
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    this will result in three rules:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    ... -p tcp ...
    ... -p udp ...
    ... -p icmp ...
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Only values can be 'listed', so you cannot do something like this:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    proto tcp ( ACCEPT LOG );
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    but you can do this:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    chain (INPUT OUTPUT FORWARD) proto (icmp udp tcp) DROP;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    (which will result in nine rules!)
    <div style="height: 1.00em;">&#x00A0;</div>
    Values are separated by spaces. The array symbol is both left- and
      right-associative, in contrast with the nesting block, which is
      left-associative only.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot; # &quot;</dt>
  <dd class="It-tag">The comment symbol. Anything that follows this symbol up to
      the end of line is ignored.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;`command`&quot;</dt>
  <dd class="It-tag">Execute the command in a shell, and insert the process
      output. See the section <i>backticks</i> for details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">'string'</dt>
  <dd class="It-tag">Quote a string which may contain whitespaces, the dollar
      sign etc.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    LOG log-prefix ' hey, this is my log prefix!';
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;string&quot;</dt>
  <dd class="It-tag">Quote a string (see above), but variable references with a
      dollar sign are evaluated:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    DNAT to &quot;$myhost:$myport&quot;;
    </pre>
  </dd>
</dl>
<h2 class="Ss" title="Ss" id="Keywords"><a class="selflink" href="#Keywords">Keywords</a></h2>
In the previous section, we already introduced some basic keywords like
  &quot;chain&quot;, &quot;protocol&quot; and &quot;ACCEPT&quot;. Let's explore
  their nature.
<div class="Pp"></div>
There are three kinds of keywords:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>location</b> keywords define where a rule will be
      created. Example: &quot;table&quot;, &quot;chain&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>match</b> keywords perform a test on all passing
      packets. The current rule is without effect if one (or more) of the
      matches does not pass. Example: &quot;proto&quot;, &quot;daddr&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    Most matches are followed by a parameter: &quot;proto tcp&quot;, &quot;daddr
      172.16.0.0/12&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>target</b> keywords state what to do with a packet.
      Example: &quot;ACCEPT&quot;, &quot;REJECT&quot;, &quot;jump&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    Some targets define more keywords to specify details: &quot;REJECT
      reject-with icmp-net-unreachable&quot;.</dd>
</dl>
<div class="Pp"></div>
Every rule consists of a <b>location</b> and a <b>target</b>, plus any number of
  <b>matches</b>:
<div class="Pp"></div>
<pre>
    table filter                  # location
    proto tcp dport (http https)  # match
    ACCEPT;                       # target
</pre>
<div class="Pp"></div>
Strictly speaking, there is a fourth kind: <b>ferm</b> keywords (which control
  ferm's internal behaviour), but they will be explained later.
<h2 class="Ss" title="Ss" id="Parameters"><a class="selflink" href="#Parameters">Parameters</a></h2>
Many keywords take parameters. These can be specified as literals, variable
  references or lists (arrays):
<div class="Pp"></div>
<pre>
    proto udp
    saddr $TRUSTED_HOSTS;
    proto tcp dport (http https ssh);
    LOG log-prefix &quot;funky wardriver alert: &quot;;
</pre>
<div class="Pp"></div>
Some of them can be negated (lists cannot be negated):
<div class="Pp"></div>
<pre>
    proto !esp;
    proto udp dport !domain;
</pre>
<div class="Pp"></div>
Keywords which take no parameters are negated by a prefixed '!':
<div class="Pp"></div>
<pre>
    proto tcp !syn;
</pre>
<div class="Pp"></div>
Read <i>iptables</i>(8) to see where the <b>!</b> can be used.
<h1 class="Sh" title="Sh" id="BASIC_KEYWORDS"><a class="selflink" href="#BASIC_KEYWORDS">BASIC
  KEYWORDS</a></h1>
<h2 class="Ss" title="Ss" id="Location_keywords"><a class="selflink" href="#Location_keywords">Location
  keywords</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>domain [ip|ip6]</b></dt>
  <dd class="It-tag">Set the domain. &quot;ip&quot; is default and means
      &quot;IPv4&quot; (iptables). &quot;ip6&quot; is for IPv6 support, using
      &quot;ip6tables&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>table [filter|nat|mangle]</b></dt>
  <dd class="It-tag">Specifies which netfilter table this rule will be inserted
      to: &quot;filter&quot; (default), &quot;nat&quot; or
    &quot;mangle&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>chain [chain-name]</b></dt>
  <dd class="It-tag">Specifies the netfilter chain (within the current table)
      this rule will be inserted to. Common predefined chain names are
      &quot;INPUT&quot;, &quot;OUTPUT&quot;, &quot;FORWARD&quot;,
      &quot;PREROUTING&quot;, &quot;POSTROUTING&quot;, depending on the table.
      See the netfilter documentation for details.
    <div style="height: 1.00em;">&#x00A0;</div>
    If you specify a non-existing chain here, ferm will add the rule to a custom
      chain with that name.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>policy [ACCEPT|DROP|..]</b></dt>
  <dd class="It-tag">Specifies the default policy for the current chain
      (built-in only). Can be one of the built-in targets (ACCEPT, DROP, REJECT,
      ...). A packet that matches no rules in a chain will be treated as
      specified by the policy.
    <div style="height: 1.00em;">&#x00A0;</div>
    To avoid ambiguity, always specify the policies of all predefined chains
      explicitly.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b></b><b>@subchain</b><b> [&quot;CHAIN-NAME&quot;] { ...
    }</b></dt>
  <dd class="It-tag">Works like the normal block operators (i.e. without the
      <i></i> <i>@subchain</i><i></i> keyword), except that <b>ferm</b> moves
      rules within the curly braces into a new custom chain. The name for this
      chain is chosen automatically by ferm.
    <div style="height: 1.00em;">&#x00A0;</div>
    In many cases, this is faster than just a block, because the kernel may skip
      a huge block of rules when a precondition is false. Imagine the following
      example:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
 table filter chain INPUT {
     saddr (1.2.3.4 2.3.4.5 3.4.5.6 4.5.6.7 5.6.7.8) {
         proto tcp dport (http https ssh) ACCEPT;
         proto udp dport domain ACCEPT;
     }
 }
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    This generates 20 rules. When a packet arrives which does not pass the
      <b>saddr</b> match, it nonetheless checks all 20 rules. With
      <b></b><b>@subchain</b> <b></b>, this check is done once, resulting in
      faster network filtering and less CPU load:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
 table filter chain INPUT {
     saddr (1.2.3.4 2.3.4.5 3.4.5.6 4.5.6.7 5.6.7.8) @subchain {
         proto tcp dport (http https ssh) ACCEPT;
         proto udp dport domain ACCEPT;
     }
 }
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Optionally, you may define the name of the sub chain:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
 saddr (1.2.3.4 2.3.4.5 3.4.5.6) @subchain &quot;foobar&quot; {
     proto tcp dport (http https ssh) ACCEPT;
     proto udp dport domain ACCEPT;
 }
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    The name can either be a quoted string literal, or an expanded ferm
      expression such as @cat(&quot;interface_&quot;, $iface) or
      @substr($var,0,20).
    <div style="height: 1.00em;">&#x00A0;</div>
    You can achieve the same by explicitly declaring a custom chain, but you may
      feel that using <b></b><b>@subchain</b><b></b> requires less typing.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b></b><b>@gotosubchain</b><b> [&quot;CHAIN-NAME&quot;] {
    ... }</b></dt>
  <dd class="It-tag">Works like <b></b><b>@subchain</b><b></b> except that
      instead of using <b>jump</b> target it uses <b>goto</b> target. See
      discussion below for the difference between these two targets.</dd>
</dl>
<h2 class="Ss" title="Ss" id="Basic_iptables_match_keywords"><a class="selflink" href="#Basic_iptables_match_keywords">Basic
  iptables match keywords</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>interface [interface-name]</b></dt>
  <dd class="It-tag">Define the interface name, your outside network card, like
      eth0, or dialup like ppp1, or whatever device you want to match for
      passing packets. It is equivalent to the &quot;-i&quot; switch in
      <i>iptables</i>(8).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>outerface [interface-name]</b></dt>
  <dd class="It-tag">Same as interface, only for matching the outgoing interface
      for a packet, as in <i>iptables</i>(8).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>protocol [protocol-name|protocol-number]</b></dt>
  <dd class="It-tag">Currently supported by the kernel are tcp, udp and icmp, or
      their respective numbers.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>saddr|daddr [address-spec]</b></dt>
  <dd class="It-tag">Matches on packets originating from the specified address
      (saddr) or targeted at the address (daddr).
    <div style="height: 1.00em;">&#x00A0;</div>
    Examples:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    saddr 192.168/8 ACCEPT; # (identical to the next one:)
    saddr 192.168.0.0/255.255.255.0 ACCEPT;
    daddr my.domain.com ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>fragment</b></dt>
  <dd class="It-tag">Specify that only fragmented IP packets should be matched.
      When packets are larger that the maximum packet size your system can
      handle (called Maximum Transmission Unit or MTU) they will be chopped into
      bits and sent one by one as single packets. See <i>ifconfig</i>(8) if you
      want to find the MTU for your system (the default is usually 1500 bytes).
    <div style="height: 1.00em;">&#x00A0;</div>
    Fragments are frequently used in DOS attacks, because there is no way of
      finding out the origin of a fragment packet.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>sport|dport [port-spec]</b></dt>
  <dd class="It-tag">Matches on packets on the specified TCP or UDP port.
      &quot;sport&quot; matches the source port, and dport matches the
      destination port.
    <div style="height: 1.00em;">&#x00A0;</div>
    This match can be used only after you specified &quot;protocol tcp&quot; or
      &quot;protocol udp&quot;, because only these two protocols actually have
      ports.
    <div style="height: 1.00em;">&#x00A0;</div>
    And some examples of valid ports/ranges:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    dport 80 ACCEPT;
    dport http ACCEPT;
    dport ssh:http ACCEPT;
    dport 0:1023 ACCEPT; # equivalent to :1023
    dport 1023:65535 ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>syn</b></dt>
  <dd class="It-tag">Specify that the SYN flag in a tcp package should be
      matched, which are used to build new tcp connections. You can identify
      incoming connections with this, and decide wether you want to allow it or
      not. Packets that do not have this flag are probably from an already
      established connection, so it's considered reasonably safe to let these
      through.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>module [module-name]</b></dt>
  <dd class="It-tag">Load an iptables module. Most modules provide more match
      keywords. We'll get to that later.</dd>
</dl>
<h2 class="Ss" title="Ss" id="Basic_target_keywords"><a class="selflink" href="#Basic_target_keywords">Basic
  target keywords</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>jump [custom-chain-name]</b></dt>
  <dd class="It-tag">Jumps to a custom chain. If no rule in the custom chain
      matched, netfilter returns to the next rule in the previous chain.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>goto [custom-chain-name]</b></dt>
  <dd class="It-tag">Go to a custom chain. Unlike the <b>jump</b> option,
      <b>RETURN</b> will not continue processing in this chain but instead in
      the chain that called us via <b>jump</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ACCEPT</b></dt>
  <dd class="It-tag">Accepts matching packets.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>DROP</b></dt>
  <dd class="It-tag">Drop matching packets without further notice.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>REJECT</b></dt>
  <dd class="It-tag">Rejects matching packets, i.e. send an ICMP packet to the
      sender, which is port-unreachable by default. You may specify another ICMP
      type.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    REJECT; # default to icmp-port-unreachable
    REJECT reject-with icmp-net-unreachable;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Type &quot;iptables -j REJECT -h&quot; for details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>RETURN</b></dt>
  <dd class="It-tag">Finish the current chain and return to the calling chain
      (if &quot;jump [custom-chain-name]&quot; was used).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>NOP</b></dt>
  <dd class="It-tag">No action at all.</dd>
</dl>
<h1 class="Sh" title="Sh" id="ADDITIONAL_KEYWORDS"><a class="selflink" href="#ADDITIONAL_KEYWORDS">ADDITIONAL
  KEYWORDS</a></h1>
Netfilter is modular. Modules may provide additional targets and match keywords.
  The list of netfilter modules is constantly growing, and ferm tries to keep up
  with supporting them all. This chapter describes modules which are currently
  supported.
<h2 class="Ss" title="Ss" id="iptables_match_modules"><a class="selflink" href="#iptables_match_modules">iptables
  match modules</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>account</b></dt>
  <dd class="It-tag">Account traffic for all hosts in defined network/netmask.
      This is one of the match modules which behave like a target, i.e. you will
      mostly have to use the <b>NOP</b> target.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod account aname mynetwork aaddr 192.168.1.0/24 ashort NOP;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>addrtype</b></dt>
  <dd class="It-tag">Check the address type; either source address or
      destination address.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod addrtype src-type BROADCAST;
    mod addrtype dst-type LOCAL;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Type &quot;iptables -m addrtype -h&quot; for details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ah</b></dt>
  <dd class="It-tag">Checks the SPI header in an AH packet.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod ah ahspi 0x101;
    mod ah ahspi ! 0x200:0x2ff;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Additional arguments for IPv6:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod ah ahlen 32 ACCEPT;
    mod ah ahlen !32 ACCEPT;
    mod ah ahres ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>bpf</b></dt>
  <dd class="It-tag">Match using Linux Socket Filter.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod bpf bytecode &quot;4,48 0 0 9,21 0 1 6,6 0 0 1,6 0 0 0&quot;;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>comment</b></dt>
  <dd class="It-tag">Adds a comment of up to 256 characters to a rule, without
      an effect. Note that unlike ferm comments ('#'), this one will show up in
      &quot;iptables -L&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod comment comment &quot;This is my comment.&quot; ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>condition</b></dt>
  <dd class="It-tag">Matches if a value in /proc/net/ipt_condition/NAME is 1
      (path is /proc/net/ip6t_condition/NAME for the ip6 domain).
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod condition condition (abc def) ACCEPT;
    mod condition condition !foo ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>connbytes</b></dt>
  <dd class="It-tag">Match by how many bytes or packets a connection (or one of
      the two flows constituting the connection) have tranferred so far, or by
      average bytes per packet.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod connbytes connbytes 65536: connbytes-dir both connbytes-mode bytes ACCEPT;
    mod connbytes connbytes !1024:2048 connbytes-dir reply connbytes-mode packets ACCEPT;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Valid values for <i>connbytes-dir</i>: <i>original</i>, <i>reply</i>,
      <i>both</i>; for <i>connbytes-mode</i>: <i>packets</i>, <i>bytes</i>,
      <i>avgpkt</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>connlabel</b></dt>
  <dd class="It-tag">Module matches or adds connlabels to a connection.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod connlabel label &quot;name&quot;;
    mod connlabel label &quot;name&quot; set;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>connlimit</b></dt>
  <dd class="It-tag">Allows you to restrict the number of parallel TCP
      connections to a server per client IP address (or address block).
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod connlimit connlimit-above 4 REJECT;
    mod connlimit connlimit-above !4 ACCEPT;
    mod connlimit connlimit-above 4 connlimit-mask 24 REJECT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>connmark</b></dt>
  <dd class="It-tag">Check the mark field associated with the connection, set by
      the CONNMARK target.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod connmark mark 64;
    mod connmark mark 6/7;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>conntrack</b></dt>
  <dd class="It-tag">Check connection tracking information.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod conntrack ctstate (ESTABLISHED RELATED);
    mod conntrack ctproto tcp;
    mod conntrack ctorigsrc 192.168.0.2;
    mod conntrack ctorigdst 1.2.3.0/24;
    mod conntrack ctorigsrcport 67;
    mod conntrack ctorigdstport 22;
    mod conntrack ctreplsrc 2.3.4.5;
    mod conntrack ctrepldst ! 3.4.5.6;
    mod conntrack ctstatus ASSURED;
    mod conntrack ctexpire 60;
    mod conntrack ctexpire 180:240;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Type &quot;iptables -m conntrack -h&quot; for details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>cpu</b></dt>
  <dd class="It-tag">Match cpu handling this packet.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod cpu cpu 0;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>dccp</b></dt>
  <dd class="It-tag">Check DCCP (Datagram Congestion Control Protocol) specific
      attributes. This module is automatically loaded when you use
      &quot;protocol dccp&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    proto dccp sport 1234 dport 2345 ACCEPT;
    proto dccp dccp-types (SYNCACK ACK) ACCEPT;
    proto dccp dccp-types !REQUEST DROP;
    proto dccp dccp-option 2 ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>dscp</b></dt>
  <dd class="It-tag">Match the 6 bit DSCP field within the TOS field.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod dscp dscp 11;
    mod dscp dscp-class AF41;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>dst</b></dt>
  <dd class="It-tag">Match the parameters in Destination Options header (IPv6).
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod dst dst-len 10;
    mod dst dst-opts (type1 type2 ...);
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ecn</b></dt>
  <dd class="It-tag">Match the ECN bits of an IPv4 TCP header.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod ecn ecn-tcp-cwr;
    mod ecn ecn-tcp-ece;
    mod ecn ecn-ip-ect 2;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Type &quot;iptables -m ecn -h&quot; for details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>esp</b></dt>
  <dd class="It-tag">Checks the SPI header in an ESP packet.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod esp espspi 0x101;
    mod esp espspi ! 0x200:0x2ff;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>eui64</b></dt>
  <dd class="It-tag">&quot;This module matches the EUI-64 part of a stateless
      autoconfigured IPv6 address. It compares the EUI-64 derived from the
      source MAC address in Ehternet frame with the lower 64 bits of the IPv6
      source address. But &quot;Universal/Local&quot; bit is not compared. This
      module doesn't match other link layer frame, and is only valid in the
      PREROUTING, INPUT and FORWARD chains.&quot;
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod eui64 ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>fuzzy</b></dt>
  <dd class="It-tag">&quot;This module matches a rate limit based on a fuzzy
      logic controller [FLC].&quot;
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod fuzzy lower-limit 10 upper-limit 20 ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>hbh</b></dt>
  <dd class="It-tag">Matches the Hop-by-Hop Options header (ip6).
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod hbh hbh-len 8 ACCEPT;
    mod hbh hbh-len !8 ACCEPT;
    mod hbh hbh-opts (1:4 2:8) ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>hl</b></dt>
  <dd class="It-tag">Matches the Hop Limit field (ip6).
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod hl hl-eq (8 10) ACCEPT;
    mod hl hl-eq !5 ACCEPT;
    mod hl hl-gt 15 ACCEPT;
    mod hl hl-lt 2 ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>helper</b></dt>
  <dd class="It-tag">Checks which conntrack helper module tracks this
      connection. The port may be specified with &quot;-portnr&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod helper helper irc ACCEPT;
    mod helper helper ftp-21 ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>icmp</b></dt>
  <dd class="It-tag">Check ICMP specific attributes. This module is
      automatically loaded when you use &quot;protocol icmp&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    proto icmp icmp-type echo-request ACCEPT;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    This option can also be used in be <i>ip6</i> domain, although this is
      called <b>icmpv6</b> in <i>ip6tables</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
    Use &quot;iptables -p icmp &quot;-h&quot;&quot; to obtain a list of valid
      ICMP types.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>iprange</b></dt>
  <dd class="It-tag">Match a range of IPv4 addresses.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod iprange src-range 192.168.2.0-192.168.3.255;
    mod iprange dst-range ! 192.168.6.0-192.168.6.255;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ipv4options</b></dt>
  <dd class="It-tag">Match on IPv4 header options like source routing, record
      route, timestamp and router-alert.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod ipv4options ssrr ACCEPT;
    mod ipv4options lsrr ACCEPT;
    mod ipv4options no-srr ACCEPT;
    mod ipv4options !rr ACCEPT;
    mod ipv4options !ts ACCEPT;
    mod ipv4options !ra ACCEPT;
    mod ipv4options !any-opt ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ipv6header</b></dt>
  <dd class="It-tag">Matches the IPv6 extension header (ip6).
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod ipv6header header !(hop frag) ACCEPT;
    mod ipv6header header (auth dst) ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>hashlimit</b></dt>
  <dd class="It-tag">Similar to 'mod limit', but adds the ability to add
      per-destination or per-port limits managed in a hash table.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod hashlimit  hashlimit 10/minute  hashlimit-burst 30/minute
      hashlimit-mode dstip  hashlimit-name foobar  ACCEPT;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Possible values for hashlimit-mode: dstip dstport srcip srcport (or a list
      with more than one of these).
    <div style="height: 1.00em;">&#x00A0;</div>
    There are more possible settings, type &quot;iptables -m hashlimit -h&quot;
      for documentation.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ipvs</b></dt>
  <dd class="It-tag">Match IPVS connection properties.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod ipvs ipvs ACCEPT; # packet belongs to an IPVS connection
    mod ipvs vproto tcp ACCEPT; # VIP protocol to match; by number or name, e.g. &quot;tcp
    mod ipvs vaddr 1.2.3.4/24 ACCEPT; # VIP address to match
    mod ipvs vport http ACCEPT; # VIP port to match
    mod ipvs vdir ORIGINAL ACCEPT; # flow direction of packet
    mod ipvs vmethod GATE ACCEPT; # IPVS forwarding method used
    mod ipvs vportctl 80; # VIP port of the controlling connection to match
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>length</b></dt>
  <dd class="It-tag">Check the package length.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod length length 128; # exactly 128 bytes
    mod length length 512:768; # range
    mod length length ! 256; # negated
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>limit</b></dt>
  <dd class="It-tag">Limits the packet rate.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod limit limit 1/second;
    mod limit limit 15/minute limit-burst 10;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Type &quot;iptables -m limit -h&quot; for details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>mac</b></dt>
  <dd class="It-tag">Match the source MAC address.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod mac mac-source 01:23:45:67:89;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>mark</b></dt>
  <dd class="It-tag">Matches packets based on their netfilter mark field. This
      may be a 32 bit integer between 0 and 4294967295.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod mark mark 42;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>mh</b></dt>
  <dd class="It-tag">Matches the mobility header (domain <i>ip6</i>).
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    proto mh mh-type binding-update ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>multiport</b></dt>
  <dd class="It-tag">Match a set of source or destination ports (UDP and TCP
      only).
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod multiport source-ports (https ftp);
    mod multiport destination-ports (mysql domain);
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    This rule has a big advantage over &quot;dport&quot; and &quot;sport&quot;:
      it generates only one rule for up to 15 ports instead of one rule for
      every port.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>nth</b></dt>
  <dd class="It-tag">Match every 'n'th packet.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod nth every 3;
    mod nth counter 5 every 2;
    mod nth start 2 every 3;
    mod nth start 5 packet 2 every 6;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Type &quot;iptables -m nth -h&quot; for details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>osf</b></dt>
  <dd class="It-tag">Match packets depending on the operating system of the
      sender.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod osf genre Linux;
    mod osf ! genre FreeBSD ttl 1 log 1;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Type &quot;iptables -m osf -h&quot; for details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>owner</b></dt>
  <dd class="It-tag">Check information about the packet creator, namely user id,
      group id, process id, session id and command name.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod owner uid-owner 0;
    mod owner gid-owner 1000;
    mod owner pid-owner 5432;
    mod owner sid-owner 6543;
    mod owner cmd-owner &quot;sendmail&quot;;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    (&quot;cmd-owner&quot;, &quot;pid-owner&quot; and &quot;sid-owner&quot;
      require special kernel patches not included in the vanilla Linux
    kernel)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>physdev</b></dt>
  <dd class="It-tag">Matches the physical device on which a packet entered or is
      about to leave the machine. This is useful for bridged interfaces.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod physdev physdev-in ppp1;
    mod physdev physdev-out eth2;
    mod physdev physdev-is-in;
    mod physdev physdev-is-out;
    mod physdev physdev-is-bridged;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>pkttype</b></dt>
  <dd class="It-tag">Check the link-layer packet type.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod pkttype pkt-type unicast;
    mod pkttype pkt-type broadcase;
    mod pkttype pkt-type multicast;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>policy</b></dt>
  <dd class="It-tag">Matches IPsec policy being applied to this packet.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod policy dir out pol ipsec ACCEPT;
    mod policy strict reqid 23 spi 0x10 proto ah ACCEPT;
    mod policy mode tunnel tunnel-src 192.168.1.2 ACCEPT;
    mod policy mode tunnel tunnel-dst 192.168.2.1 ACCEPT;
    mod policy strict next reqid 24 spi 0x11 ACCEPT;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Note that the keyword <i>proto</i> is also used as a shorthand version of
      <i>protocol</i> (built-in match module). You can fix this conflict by
      always using the long keyword <i>protocol</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>psd</b></dt>
  <dd class="It-tag">Detect TCP/UDP port scans.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod psd psd-weight-threshold 21 psd-delay-threshold 300
      psd-lo-ports-weight 3 psd-hi-ports-weight 1 DROP;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>quota</b></dt>
  <dd class="It-tag">Implements network quotas by decrementing a byte counter
      with each packet.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod quota quota 65536 ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>random</b></dt>
  <dd class="It-tag">Match a random percentage of all packets.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod random average 70;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>realm</b></dt>
  <dd class="It-tag">Match the routing realm. Useful in environments using BGP.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod realm realm 3;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>recent</b></dt>
  <dd class="It-tag">Temporarily mark source IP addresses.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod recent set;
    mod recent rcheck seconds 60;
    mod recent set rsource name &quot;badguy&quot;;
    mod recent set rdest;
    mod recent rcheck rsource name &quot;badguy&quot; seconds 60;
    mod recent update seconds 120 hitcount 3 rttl;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    This netfilter module has a design flaw: although it is implemented as a
      match module, it has target-like behaviour when using the &quot;set&quot;
      keyword.
    <div style="height: 1.00em;">&#x00A0;</div>
    &lt;http://snowman.net/projects/ipt_recent/&gt;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>rpfilter</b></dt>
  <dd class="It-tag">Checks a reply to the packet would be sent via the same
      interface it arrived on. Packets from the loopback interface are always
      permitted.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod rpfilter proto tcp loose RETURN;
    mod rpfilter validmark accept-local RETURN;
    mod rpfilter invert DROP;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    This netfilter module is the preferred way to perform reverse path filtering
      for IPv6, and a powerful alternative to checks controlled by sysctl
      <i>net.ipv4.conf.*.rp_filter</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>rt</b></dt>
  <dd class="It-tag">Match the IPv6 routing header (ip6 only).
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod rt rt-type 2 rt-len 20 ACCEPT;
    mod rt rt-type !2 rt-len !20 ACCEPT;
    mod rt rt-segsleft 2:3 ACCEPT;
    mod rt rt-segsleft !4:5 ACCEPT;
    mod rt rt-0-res rt-0-addrs (::1 ::2) rt-0-not-strict ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>sctp</b></dt>
  <dd class="It-tag">Check SCTP (Stream Control Transmission Protocol) specific
      attributes. This module is automatically loaded when you use
      &quot;protocol sctp&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    proto sctp sport 1234 dport 2345 ACCEPT;
    proto sctp chunk-types only DATA:Be ACCEPT;
    proto sctp chunk-types any (INIT INIT_ACK) ACCEPT;
    proto sctp chunk-types !all (HEARTBEAT) ACCEPT;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Use &quot;iptables -p sctp &quot;-h&quot;&quot; to obtain a list of valid
      chunk types.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>set</b></dt>
  <dd class="It-tag">Checks the source or destination IP/Port/MAC against a set.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod set set badguys src DROP;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    See &lt;http://ipset.netfilter.org/&gt; for more information.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>state</b></dt>
  <dd class="It-tag">Checks the connection tracking state.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod state state INVALID DROP;
    mod state state (ESTABLISHED RELATED) ACCEPT;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Type &quot;iptables -m state -h&quot; for details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>statistic</b></dt>
  <dd class="It-tag">Successor of <b>nth</b> and <b>random</b>, currently
      undocumented in the <i>iptables</i>(8) man page.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod statistic mode random probability 0.8 ACCEPT;
    mod statistic mode nth every 5 packet 0 DROP;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>string</b></dt>
  <dd class="It-tag">Matches a string.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod string string &quot;foo bar&quot; ACCEPT;
    mod string algo kmp from 64 to 128 hex-string &quot;deadbeef&quot; ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>tcp</b></dt>
  <dd class="It-tag">Checks TCP specific attributes. This module is
      automatically loaded when you use &quot;protocol tcp&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    proto tcp sport 1234;
    proto tcp dport 2345;
    proto tcp tcp-flags (SYN ACK) SYN;
    proto tcp tcp-flags ! (SYN ACK) SYN;
    proto tcp tcp-flags ALL (RST ACK);
    proto tcp syn;
    proto tcp tcp-option 2;
    proto tcp mss 512;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Type &quot;iptables -p tcp -h&quot; for details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>tcpmss</b></dt>
  <dd class="It-tag">Check the TCP MSS field of a SYN or SYN/ACK packet.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod tcpmss mss 123 ACCEPT;
    mod tcpmss mss 234:567 ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>time</b></dt>
  <dd class="It-tag">Check if the time a packet arrives is in given range.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod time timestart 12:00;
    mod time timestop 13:30;
    mod time days (Mon Wed Fri);
    mod time datestart 2005:01:01;
    mod time datestart 2005:01:01:23:59:59;
    mod time datestop 2005:04:01;
    mod time monthday (30 31);
    mod time weekdays (Wed Thu);
    mod time timestart 12:00 utc;
    mod time timestart 12:00 localtz;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Type &quot;iptables -m time -h&quot; for details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>tos</b></dt>
  <dd class="It-tag">Matches a packet on the specified TOS-value.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod tos tos Minimize-Cost ACCEPT;
    mod tos tos !Normal-Service ACCEPT;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Type &quot;iptables -m tos -h&quot; for details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ttl</b></dt>
  <dd class="It-tag">Matches the ttl (time to live) field in the IP header.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod ttl ttl-eq 12; # ttl equals
    mod ttl ttl-gt 10; # ttl greater than
    mod ttl ttl-lt 16; # ttl less than
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>u32</b></dt>
  <dd class="It-tag">Compares raw data from the packet. You can specify more
      than one filter in a ferm list; these are not expanded into multiple
      rules.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mod u32 u32 '6&amp;0xFF=1' ACCEPT;
    mod u32 u32 ('27&amp;0x8f=7' '31=0x527c4833') DROP;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>unclean</b></dt>
  <dd class="It-tag">Matches packets which seem malformed or unusual. This match
      has no further parameters.</dd>
</dl>
<h2 class="Ss" title="Ss" id="iptables_target_modules"><a class="selflink" href="#iptables_target_modules">iptables
  target modules</a></h2>
The following additional targets are available in ferm, provided that you
  enabled them in your kernel:
<dl class="Bl-tag">
  <dt class="It-tag"><b>CHECKSUM</b></dt>
  <dd class="It-tag">Compute packet checksum.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    CHECKSUM checksum-fill;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CLASSIFY</b></dt>
  <dd class="It-tag">Set the CBQ class.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    CLASSIFY set-class 3:50;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CLUSTERIP</b></dt>
  <dd class="It-tag">Configure a simple cluster of nodes that share a certain IP
      and MAC address. Connections are statically distributed between the nodes.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    CLUSTERIP new hashmode sourceip clustermac 00:12:34:45:67:89
      total-nodes 4 local-node 2 hash-init 12345;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CONNMARK</b></dt>
  <dd class="It-tag">Sets the netfilter mark value associated with a connection.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    CONNMARK set-xmark 42/0xff;
    CONNMARK set-mark 42;
    CONNMARK save-mark;
    CONNMARK restore-mark;
    CONNMARK save-mark nfmask 0xff ctmask 0xff;
    CONNMARK save-mark mask 0x7fff;
    CONNMARK restore-mark mask 0x8000;
    CONNMARK and-mark 0x7;
    CONNMARK or-mark 0x4;
    CONNMARK xor-mark 0x7;
    CONNMARK and-mark 0x7;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CONNSECMARK</b></dt>
  <dd class="It-tag">This module copies security markings from packets to
      connections (if unlabeled), and from connections back to packets (also
      only if unlabeled). Typically used in conjunction with SECMARK, it is only
      valid in the mangle table.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    CONNSECMARK save;
    CONNSECMARK restore;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>DNAT to [ip-address|ip-range|ip-port-range]</b></dt>
  <dd class="It-tag">Change the destination address of the packet.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    DNAT to 10.0.0.4;
    DNAT to 10.0.0.4:80;
    DNAT to 10.0.0.4:1024-2048;
    DNAT to 10.0.1.1-10.0.1.20;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>DNPT</b></dt>
  <dd class="It-tag">Provides stateless destination IPv6-to-IPv6 Network Prefix
      Translation.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    DNPT src-pfx 2001:42::/16 dst-pfx 2002:42::/16;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ECN</b></dt>
  <dd class="It-tag">This target allows to selectively work around known ECN
      blackholes. It can only be used in the mangle table.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    ECN ecn-tcp-remove;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>HL</b></dt>
  <dd class="It-tag">Modify the IPv6 Hop Limit field (ip6/mangle only).
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    HL hl-set 5;
    HL hl-dec 2;
    HL hl-inc 1;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>HMARK</b></dt>
  <dd class="It-tag">Like MARK, i.e. set the fwmark, but the mark is calculated
      from hashing packet selector at choice.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    HMARK hmark-tuple &quot;src&quot; hmark-mod &quot;1&quot; hmark-offset &quot;1&quot;
      hmark-src-prefix 192.168.1.0/24 hmark-dst-prefix 192.168.2.0/24
      hmark-sport-mask 0x1234 hmark-dport-mask 0x2345
      hmark-spi-mask 0xdeadbeef hmark-proto-mask 0x42 hmark-rnd 0xcoffee;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>IDLETIMER</b></dt>
  <dd class="It-tag">This target can be used to identify when interfaces have
      been idle for a certain period of time.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    IDLETIMER timeout 60 label &quot;foo&quot;;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>IPV4OPTSSTRIP</b></dt>
  <dd class="It-tag">Strip all the IP options from a packet. This module does
      not take any options.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    IPV4OPTSSTRIP;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>LED</b></dt>
  <dd class="It-tag">This creates an LED-trigger that can then be attached to
      system indicator lights, to blink or illuminate them when certain packets
      pass through the system.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    LED led-trigger-id &quot;foo&quot; led-delay 100 led-always-blink;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>LOG</b></dt>
  <dd class="It-tag">Log all packets that match this rule in the kernel log. Be
      carefull with log flooding. Note that this is a &quot;non-terminating
      target&quot;, i.e. rule traversal continues at the next rule.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    LOG log-level warning log-prefix &quot;Look at this: &quot;;
    LOG log-tcp-sequence log-tcp-options;
    LOG log-ip-options;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MARK</b></dt>
  <dd class="It-tag">Sets the netfilter mark field for the packet (a 32 bit
      integer between 0 and 4294967295):
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    MARK set-mark 42;
    MARK set-xmark 7/3;
    MARK and-mark 31;
    MARK or-mark 1;
    MARK xor-mark 12;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MASQUERADE</b></dt>
  <dd class="It-tag">Masquerades matching packets. Optionally followed by a port
      or port-range for iptables. Specify as &quot;123&quot;,
      &quot;123-456&quot; or &quot;123:456&quot;. The port range parameter
      specifies what local ports masqueraded connections should originate from.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    MASQUERADE;
    MASQUERADE to-ports 1234:2345;
    MASQUERADE to-ports 1234:2345 random;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MIRROR</b></dt>
  <dd class="It-tag">Experimental demonstration target which inverts the source
      and destination fields in the IP header.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    MIRROR;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>NETMAP</b></dt>
  <dd class="It-tag">Map a whole network onto another network in the <b>nat</b>
      table.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    NETMAP to 192.168.2.0/24;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>NOTRACK</b></dt>
  <dd class="It-tag">Disable connection tracking for all packets matching that
      rule.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    proto tcp dport (135:139 445) NOTRACK;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>RATEEST</b></dt>
  <dd class="It-tag">
    <pre>
    RATEEST rateest-name &quot;foo&quot; rateest-interval 60s rateest-ewmalog 100;
    proto tcp dport (135:139 445) NOTRACK;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>NFLOG</b></dt>
  <dd class="It-tag">Log packets over netlink; this is the successor of
      <i>ULOG</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    NFLOG nflog-group 5 nflog-prefix &quot;Look at this: &quot;;
    NFLOG nflog-range 256;
    NFLOG nflog-threshold 10;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>NFQUEUE</b></dt>
  <dd class="It-tag">Userspace queueing, requires nfnetlink_queue kernel
      support.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    proto tcp dport ftp NFQUEUE queue-num 20;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>QUEUE</b></dt>
  <dd class="It-tag">Userspace queueing, the predecessor to <b>NFQUEUE</b>. All
      packets go to queue 0.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    proto tcp dport ftp QUEUE;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>REDIRECT to-ports [ports]</b></dt>
  <dd class="It-tag">Transparent proxying: alter the destination IP of the
      packet to the machine itself.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    proto tcp dport http REDIRECT to-ports 3128;
    proto tcp dport http REDIRECT to-ports 3128 random;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SAME</b></dt>
  <dd class="It-tag">Similar to SNAT, but a client is mapped to the same source
      IP for all its connections.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    SAME to 1.2.3.4-1.2.3.7;
    SAME to 1.2.3.8-1.2.3.15 nodst;
    SAME to 1.2.3.16-1.2.3.31 random;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SECMARK</b></dt>
  <dd class="It-tag">This is used to set the security mark value associated with
      the packet for use by security subsystems such as SELinux. It is only
      valid in the mangle table.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    SECMARK selctx &quot;system_u:object_r:httpd_packet_t:s0&quot;;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SET [add-set|del-set] [setname] [flag(s)]</b></dt>
  <dd class="It-tag">Add the IP to the specified set. See
      &lt;http://ipset.netfilter.org/&gt;
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    proto icmp icmp-type echo-request SET add-set badguys src;
    SET add-set &quot;foo&quot; timeout 60 exist;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SNAT to [ip-address|ip-range|ip-port-range]</b></dt>
  <dd class="It-tag">Change the source address of the packet.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    SNAT to 1.2.3.4;
    SNAT to 1.2.3.4:20000-30000;
    SNAT to 1.2.3.4 random;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SNPT</b></dt>
  <dd class="It-tag">Provides stateless source IPv6-to-IPv6 Network Prefix
      Translation.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    SNPT src-pfx 2001:42::/16 dst-pfx 2002:42::/16;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SYNPROXY</b></dt>
  <dd class="It-tag">TCP 3-way handshake proxy: let the firewall handle the TCP
      3-way handshake and only establish connection with the server socket once
      the client handshake has finished.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    SYNPROXY wscale 7 mss 1460 timestamp sack-perm
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>TCPMSS</b></dt>
  <dd class="It-tag">Alter the MSS value of TCP SYN packets.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    TCPMSS set-mss 1400;
    TCPMSS clamp-mss-to-pmtu;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>TCPOPTSTRIP</b></dt>
  <dd class="It-tag">This target will strip TCP options off a TCP packet.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    TCPOPTSTRIP strip-options (option1 option2 ...);
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>TOS set-tos [value]</b></dt>
  <dd class="It-tag">Set the tcp package Type Of Service bit to this value. This
      will be used by whatever traffic scheduler is willing to, mostly your own
      linux-machine, but maybe more. The original tos-bits are blanked and
      overwritten by this value.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    TOS set-tos Maximize-Throughput;
    TOS and-tos 7;
    TOS or-tos 1;
    TOS xor-tos 4;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Type &quot;iptables -j TOS -h&quot; for details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>TTL</b></dt>
  <dd class="It-tag">Modify the TTL header field.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    TTL ttl-set 16;
    TTL ttl-dec 1; # decrease by 1
    TTL ttl-inc 4; # increase by 4
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ULOG</b></dt>
  <dd class="It-tag">Log packets to a userspace program.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    ULOG ulog-nlgroup 5 ulog-prefix &quot;Look at this: &quot;;
    ULOG ulog-cprange 256;
    ULOG ulog-qthreshold 10;
    </pre>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="OTHER_DOMAINS"><a class="selflink" href="#OTHER_DOMAINS">OTHER
  DOMAINS</a></h1>
Since version 2.0, <b>ferm</b> supports not only <i>ip</i> and <i>ip6</i>, but
  also <i>arp</i> (ARP tables) and <i>eb</i> (ethernet bridging tables). The
  concepts are similar to <i>iptables</i>.
<h2 class="Ss" title="Ss" id="arptables_keywords"><a class="selflink" href="#arptables_keywords">arptables
  keywords</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>source-ip</b>, <b>destination-ip</b></dt>
  <dd class="It-tag">Matches the source or destination IPv4 address. Same as
      <b>saddr</b> and <b>daddr</b> in the <i>ip</i> domain.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>source-mac</b>, <b>destination-mac</b></dt>
  <dd class="It-tag">Matches the source or destination MAC address.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>interface</b>, <b>outerface</b></dt>
  <dd class="It-tag">Input and output interface.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>h-length</b></dt>
  <dd class="It-tag">Hardware length of the packet.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    chain INPUT h-length 64 ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>opcode</b></dt>
  <dd class="It-tag">Operation code, for details see the <i>iptables</i>(8).
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    opcode 9 ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>h-type</b></dt>
  <dd class="It-tag">Hardware type.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    h-type 1 ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>proto-type</b></dt>
  <dd class="It-tag">Protocol type.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    proto-type 0x800 ACCEPT;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Mangling</b></dt>
  <dd class="It-tag">The keywords <b>mangle-ip-s</b>, <b>mangle-ip-d</b>,
      <b>mangle-mac-s</b>, <b>mangle-mac-d</b>, <b>mangle-target</b> may be used
      for ARP mangling. See <i>iptables</i>(8) for details.</dd>
</dl>
<h2 class="Ss" title="Ss" id="ebtables_keywords"><a class="selflink" href="#ebtables_keywords">ebtables
  keywords</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>proto</b></dt>
  <dd class="It-tag">Matches the protocol which created the frame, e.g.
      <i>IPv4</i> or <b>PPP</b>. For a list, see <i>/etc/ethertypes</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>interface</b>, <b>outerface</b></dt>
  <dd class="It-tag">Physical input and output interface.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>logical-in</b>, <b>logical-out</b></dt>
  <dd class="It-tag">The logical bridge interface.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>saddr</b>, <b>daddr</b></dt>
  <dd class="It-tag">Matches source or destination MAC address.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Match modules</b></dt>
  <dd class="It-tag">The following match modules are supported: 802.3, arp, ip,
      mark_m, pkttype, stp, vlan, log.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Target extensions</b></dt>
  <dd class="It-tag">The following target extensions are supported: arpreply,
      dnat, mark, redirect, snat.
    <div style="height: 1.00em;">&#x00A0;</div>
    Please note that there is a conflict between <i>--mark</i> from the
      <i>mark_m</i> match module and <i>-j mark</i>. Since both would be
      implemented with the ferm keyword <b>mark</b>, we decided to solve this by
      writing the target's name in uppercase, like in the other domains. The
      following example rewrites mark 1 to 2:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    mark 1 MARK 2;
    </pre>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="ADVANCED_FEATURES"><a class="selflink" href="#ADVANCED_FEATURES">ADVANCED
  FEATURES</a></h1>
<h2 class="Ss" title="Ss" id="Variables"><a class="selflink" href="#Variables">Variables</a></h2>
In complex firewall files, it is helpful to use variables, e.g. to give a
  network interface a meaningful name.
<div class="Pp"></div>
To set variables, write:
<div class="Pp"></div>
<pre>
    @def $DEV_INTERNET = eth0;
    @def $PORTS = (http ftp);
    @def $MORE_PORTS = ($PORTS 8080);
</pre>
<div class="Pp"></div>
In the real ferm code, variables are used like any other keyword parameter:
<div class="Pp"></div>
<pre>
    chain INPUT interface $DEV_INTERNET proto tcp dport $MORE_PORTS ACCEPT;
</pre>
<div class="Pp"></div>
Note that variables can only be used in keyword parameters
  (&quot;192.168.1.1&quot;, &quot;http&quot;); they cannot contain ferm keywords
  like &quot;proto&quot; or &quot;interface&quot;.
<div class="Pp"></div>
Variables are only valid in the current block:
<div class="Pp"></div>
<pre>
    @def $DEV_INTERNET = eth1;
    chain INPUT {
        proto tcp {
            @def $DEV_INTERNET = ppp0;
            interface $DEV_INTERNET dport http ACCEPT;
        }
        interface $DEV_INTERNET DROP;
    }
</pre>
<div class="Pp"></div>
will be expanded to:
<div class="Pp"></div>
<pre>
    chain INPUT {
        proto tcp {
            interface ppp0 dport http ACCEPT;
        }
        interface eth1 DROP;
    }
</pre>
<div class="Pp"></div>
The &quot;def $DEV_INTERNET = ppp0&quot; is only valid in the &quot;proto
  tcp&quot; block; the parent block still knows &quot;set $DEV_INTERNET =
  eth1&quot;.
<div class="Pp"></div>
Include files are special - variables declared in an included file are still
  available in the calling block. This is useful when you include a file which
  only declares variables.
<h2 class="Ss" title="Ss" id="Automatic_variables"><a class="selflink" href="#Automatic_variables">Automatic
  variables</a></h2>
Some variables are set internally by ferm. Ferm scripts can use them just like
  any other variable.
<dl class="Bl-tag">
  <dt class="It-tag"><b></b><b>$FILENAME</b><b></b></dt>
  <dd class="It-tag">The name of the configuration file relative to the
      directory ferm was started in.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b></b><b>$FILEBNAME</b><b></b></dt>
  <dd class="It-tag">The base name of the configuration file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b></b><b>$DIRNAME</b><b></b></dt>
  <dd class="It-tag">The directory of the configuration file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b></b><b>$DOMAIN</b><b></b></dt>
  <dd class="It-tag">The current domain. One of <i>ip</i>, <i>ip6</i>,
      <i>arp</i>, <i>eb</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b></b><b>$TABLE</b><b></b></dt>
  <dd class="It-tag">The current netfilter table.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b></b><b>$CHAIN</b><b></b></dt>
  <dd class="It-tag">The current netfilter chain.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b></b><b>$LINE</b><b></b></dt>
  <dd class="It-tag">The line of the current script. It can be used like this:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    @def &amp;log($msg) = {
             LOG log-prefix &quot;rule=$msg:$LINE &quot;;
    }
    .
    .
    .
    &amp;log(&quot;log message&quot;);
    </pre>
  </dd>
</dl>
<h2 class="Ss" title="Ss" id="Functions"><a class="selflink" href="#Functions">Functions</a></h2>
Functions are similar to variables, except that they may have parameters, and
  they provide ferm commands, not values.
<div class="Pp"></div>
<pre>
    @def &amp;FOO() = proto (tcp udp) dport domain;
    &amp;FOO() ACCEPT;
    @def &amp;TCP_TUNNEL($port, $dest) = {
        table filter chain FORWARD interface ppp0 proto tcp dport $port daddr $dest outerface eth0 ACCEPT;
        table nat chain PREROUTING interface ppp0 proto tcp dport $port daddr 1.2.3.4 DNAT to $dest;
    }
    &amp;TCP_TUNNEL(http, 192.168.1.33);
    &amp;TCP_TUNNEL(ftp, 192.168.1.30);
    &amp;TCP_TUNNEL((ssh smtp), 192.168.1.2);
</pre>
<div class="Pp"></div>
A function call which contains a block (like '{...}') must be the last command
  in a ferm rule, i.e. it must be followed by ';'. The '&amp; <i>FOO()</i>'
  example does not contain a block, thus you may write 'ACCEPT' after the call.
  To circumvent this, you can reorder the keywords:
<div class="Pp"></div>
<pre>
    @def &amp;IPSEC() = { proto (esp ah); proto udp dport 500; }
    chain INPUT ACCEPT &amp;IPSEC();
</pre>
<h2 class="Ss" title="Ss" id="Backticks"><a class="selflink" href="#Backticks">Backticks</a></h2>
With backticks, you may use the output of an external command:
<div class="Pp"></div>
<pre>
    @def $DNSSERVERS = `grep nameserver /etc/resolv.conf | awk '{print $2}'`;
    chain INPUT proto tcp saddr $DNSSERVERS ACCEPT;
</pre>
<div class="Pp"></div>
The command is executed with the shell ( <i>/bin/sh</i>), just like backticks in
  perl. ferm does not do any variable expansion here.
<div class="Pp"></div>
The output is then tokenized, and saved as a ferm list (array). Lines beginning
  with '#' are ignored; the other lines may contain any number of values,
  separated by whitespace.
<h2 class="Ss" title="Ss" id="Includes"><a class="selflink" href="#Includes">Includes</a></h2>
The <b></b><b>@include</b><b></b> keyword allows you to include external files:
<div class="Pp"></div>
<pre>
    @include 'vars.ferm';
</pre>
<div class="Pp"></div>
The file name is relative to the calling file, e.g. when including from
  <i>/etc/ferm/ferm.conf</i>, the above statement includes
  <i>/etc/ferm/vars.ferm</i>. Variables and functions declared in an included
  file are still available in the calling file.
<div class="Pp"></div>
<b>include</b> works within a block:
<div class="Pp"></div>
<pre>
    chain INPUT {
        @include 'input.ferm';
    }
</pre>
<div class="Pp"></div>
If you specify a directory (with a trailing '/'), all files in this directory
  are included, sorted alphabetically:
<div class="Pp"></div>
<pre>
    @include 'ferm.d/';
</pre>
<div class="Pp"></div>
The function @glob can be used to expand wild cards:
<div class="Pp"></div>
<pre>
    @include @glob('*.include');
</pre>
<div class="Pp"></div>
With a trailing pipe symbol, <b>ferm</b> executes a shell command and parses its
  output:
<div class="Pp"></div>
<pre>
    @include &quot;/root/generate_ferm_rules.sh $HOSTNAME|&quot;
</pre>
<div class="Pp"></div>
<b>ferm</b> aborts, if return code is not 0.
<h2 class="Ss" title="Ss" id="Conditionals"><a class="selflink" href="#Conditionals">Conditionals</a></h2>
The keyword <b></b><b>@if</b><b></b> introduces a conditional expression:
<div class="Pp"></div>
<pre>
    @if $condition DROP;
</pre>
<div class="Pp"></div>
A value is evaluated true just like in Perl: zero, empty list, empty string are
  false, everything else is true. Examples for true values:
<div class="Pp"></div>
<pre>
    (a b); 1; 'foo'; (0 0)
</pre>
<div class="Pp"></div>
Examples for false values:
<div class="Pp"></div>
<pre>
    (); 0; '0'; ''
</pre>
<div class="Pp"></div>
There is also <b></b><b>@else</b><b></b>:
<div class="Pp"></div>
<pre>
    @if $condition DROP; @else REJECT;
</pre>
<div class="Pp"></div>
Note the semicolon before the <b></b><b>@else</b><b></b>.
<div class="Pp"></div>
It is possible to use curly braces after either <b></b><b>@if</b><b></b> or
  <b></b> <b>@else</b><b></b>:
<div class="Pp"></div>
<pre>
    @if $condition {
        MARK set-mark 2;
        RETURN;
    } @else {
        MARK set-mark 3;
    }
</pre>
<div class="Pp"></div>
Since the closing curly brace also finishes the command, there is no need for
  semicolon.
<div class="Pp"></div>
There is no <b></b><b>@elsif</b><b></b>, use <b></b><b>@else</b><b>
  </b><b>@if</b> <b></b> instead.
<div class="Pp"></div>
Example:
<div class="Pp"></div>
<pre>
    @def $have_ipv6 = `test -f /proc/net/ip6_tables_names &amp;&amp; echo 1 || echo`;
    @if $have_ipv6 {
        domain ip6 {
            # ....
        }
    }
</pre>
<h2 class="Ss" title="Ss" id="Hooks"><a class="selflink" href="#Hooks">Hooks</a></h2>
To run custom commands, you may install hooks:
<div class="Pp"></div>
<pre>
    @hook pre &quot;echo 0 &gt;/proc/sys/net/ipv4/conf/eth0/forwarding&quot;;
    @hook post &quot;echo 1 &gt;/proc/sys/net/ipv4/conf/eth0/forwarding&quot;;
    @hook flush &quot;echo 0 &gt;/proc/sys/net/ipv4/conf/eth0/forwarding&quot;;
</pre>
<div class="Pp"></div>
The specified command is executed using the shell. &quot;pre&quot; means run the
  command before applying the firewall rules, and &quot;post&quot; means run the
  command afterwards. &quot;flush&quot; hooks are run after ferm has flushed the
  firewall rules (option --flush). You may install any number of hooks.
<h1 class="Sh" title="Sh" id="BUILT-IN_FUNCTIONS"><a class="selflink" href="#BUILT-IN_FUNCTIONS">BUILT-IN
  FUNCTIONS</a></h1>
There are several built-in functions which you might find useful.
<h2 class="Ss" title="Ss" id="@defined($name),_@defined(&amp;name)"><a class="selflink" href="#@defined($name),_@defined(&amp;name)">@defined($name),
  @defined(&amp;name)</a></h2>
Tests if the variable or function is defined.
<div class="Pp"></div>
<pre>
    @def $a = 'foo';
    @if @defined($a) good;
    @if @not(@defined($a)) bad;
    @if @defined(&amp;funcname) good;
</pre>
<h2 class="Ss" title="Ss" id="@eq(a,b)"><a class="selflink" href="#@eq(a,b)">@eq(a,b)</a></h2>
Tests two values for equality. Example:
<div class="Pp"></div>
<pre>
    @if @eq($DOMAIN, ip6) DROP;
</pre>
<h2 class="Ss" title="Ss" id="@ne(a,b)"><a class="selflink" href="#@ne(a,b)">@ne(a,b)</a></h2>
Similar to @eq, this tests for non-equality.
<h2 class="Ss" title="Ss" id="@not(x)"><a class="selflink" href="#@not(x)">@not(x)</a></h2>
Negates a boolean value.
<h2 class="Ss" title="Ss" id="@resolve((hostname1_hostname2_...),_[type])"><a class="selflink" href="#@resolve((hostname1_hostname2_...),_[type])">@resolve((hostname1
  hostname2 ...), [type])</a></h2>
Usually, host names are resolved by iptables. To let ferm resolve host names,
  use the function @resolve:
<div class="Pp"></div>
<pre>
    saddr @resolve(my.host.foo) proto tcp dport ssh ACCEPT;
    saddr @resolve((another.host.foo third.host.foo)) proto tcp dport openvpn ACCEPT;
    daddr @resolve(ipv6.google.com, AAAA) proto tcp dport http ACCEPT;
</pre>
<div class="Pp"></div>
Note the double parentheses in the second line: the inner pair for creating a
  ferm list, and the outer pair as function parameter delimiters.
<div class="Pp"></div>
The second parameter is optional, and specifies the DNS record type. The default
  is &quot;A&quot;.
<div class="Pp"></div>
Be careful with resolved host names in firewall configuration. DNS requests may
  block the firewall configuration for a long time, leaving the machine
  vulnerable, or they may fail.
<h2 class="Ss" title="Ss" id="@cat(a,_b,_...)"><a class="selflink" href="#@cat(a,_b,_...)">@cat(a,
  b, ...)</a></h2>
Concatenate all parameters into one string.
<h2 class="Ss" title="Ss" id="@substr(expression,_offset,_length)"><a class="selflink" href="#@substr(expression,_offset,_length)">@substr(expression,
  offset, length)</a></h2>
Extracts a substring out of expression and returns it. First character is at
  offset 0. If OFFSET is negative, starts that far from the end of the string.
<h2 class="Ss" title="Ss" id="@length(expression)"><a class="selflink" href="#@length(expression)">@length(expression)</a></h2>
Returns the length in characters of the value of EXPR.
<h2 class="Ss" title="Ss" id="@basename(path)"><a class="selflink" href="#@basename(path)">@basename(path)</a></h2>
Return the base name of the file for a given path (File::Spec::splitpath).
<h2 class="Ss" title="Ss" id="@dirname(path)"><a class="selflink" href="#@dirname(path)">@dirname(path)</a></h2>
Return the name of the last directory for a given path, assuming the last
  component is a file name (File::Spec::splitpath).
<h2 class="Ss" title="Ss" id="@glob(path)"><a class="selflink" href="#@glob(path)">@glob(path)</a></h2>
Expand shell wildcards in the given paths (assumed to be relative to the current
  script). Returns a list of matching files. This function is useful as
  parameter of @include.
<h2 class="Ss" title="Ss" id="@ipfilter(list)"><a class="selflink" href="#@ipfilter(list)">@ipfilter(list)</a></h2>
Filters out the IP addresses that obviously do not match the current domain.
  That is useful to create common variables and rules for IPv4 and IPv6:
<div class="Pp"></div>
<pre>
    @def $TRUSTED_HOSTS = (192.168.0.40 2001:abcd:ef::40);
    domain (ip ip6) chain INPUT {
        saddr @ipfilter($TRUSTED_HOSTS) proto tcp dport ssh ACCEPT;
    }
</pre>
<h1 class="Sh" title="Sh" id="RECIPES"><a class="selflink" href="#RECIPES">RECIPES</a></h1>
The <i>./examples/</i> directory contains numerous ferm configuration which can
  be used to begin a new firewall. This sections contains more samples, recipes
  and tricks.
<h2 class="Ss" title="Ss" id="Easy_port_forwarding"><a class="selflink" href="#Easy_port_forwarding">Easy
  port forwarding</a></h2>
Ferm function make routine tasks quick and easy:
<div class="Pp"></div>
<pre>
    @def &amp;FORWARD_TCP($proto, $port, $dest) = {
        table filter chain FORWARD interface $DEV_WORLD outerface $DEV_DMZ daddr $dest proto $proto dport $port ACCEPT;
        table nat chain PREROUTING interface $DEV_WORLD daddr $HOST_STATIC proto $proto dport $port DNAT to $dest;
    }
    &amp;FORWARD_TCP(tcp, http, 192.168.1.2);
    &amp;FORWARD_TCP(tcp, smtp, 192.168.1.3);
    &amp;FORWARD_TCP((tcp udp), domain, 192.168.1.4);
</pre>
<h2 class="Ss" title="Ss" id="Remote_ferm"><a class="selflink" href="#Remote_ferm">Remote
  <b>ferm</b></a></h2>
If the target machine is not able to run <b>ferm</b> for some reason (maybe an
  embedded device without Perl), you can edit the <b>ferm</b> configuration file
  on another computer and let <b>ferm</b> generate a shell script there.
<div class="Pp"></div>
Example for OpenWRT:
<div class="Pp"></div>
<pre>
    ferm --remote --shell mywrt/ferm.conf &gt;mywrt/firewall.user
    chmod +x mywrt/firewall.user
    scp mywrt/firewall.user mywrt.local.net:/etc/
    ssh mywrt.local.net /etc/firewall.user
</pre>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--noexec</b></dt>
  <dd class="It-tag">Do not execute the <i>iptables</i>(8) commands, but skip
      instead. This way you can parse your data, use <b>--lines</b> to view the
      output.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--flush</b></dt>
  <dd class="It-tag">Clears the firewall rules and sets the policy of all chains
      to ACCEPT. <b>ferm</b> needs a configuration file for that to determine
      which domains and tables are affected.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--lines</b></dt>
  <dd class="It-tag">Show the firewall lines that were generated from the rules.
      They will be shown just before they are executed, so if you get error
      messages from <i>iptables</i>(8) etc., you can see which rule caused the
      error.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--interactive</b></dt>
  <dd class="It-tag">Apply the firewall rules and ask the user for confirmation.
      Reverts to the previous ruleset if there is no valid user response within
      30 seconds (see <b>--timeout</b>). This is useful for remote firewall
      administration: you can test the rules without fearing to lock yourself
      out.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--timeout S</b></dt>
  <dd class="It-tag">If <b>--interactive</b> is used, then roll back if there is
      no valid user response after this number of seconds. The default is
    30.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">Show a brief list of available commandline options.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--version</b></dt>
  <dd class="It-tag">Shows the version number of the program.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--fast</b></dt>
  <dd class="It-tag">Enable fast mode: ferm generates an <i>iptables-save</i>(8)
      file, and installs it with <i>iptables-restore</i>(8). This is much
      faster, because ferm calls <i>iptables</i>(8) once for every rule by
      default.
    <div style="height: 1.00em;">&#x00A0;</div>
    Fast mode is enabled by default since <b>ferm</b> 2.0, deprecating this
      option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--slow</b></dt>
  <dd class="It-tag">Disable fast mode, i.e. run <i>iptables</i>(8) for every
      rule, and don't use <i>iptables-restore</i>(8).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--shell</b></dt>
  <dd class="It-tag">Generate a shell script which calls
      <i>iptables-restore</i>(8) and prints it. Implies --fast --lines.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--remote</b></dt>
  <dd class="It-tag">Generate rules for a remote machine. Implies
      <b>--noexec</b> and <b>--lines</b>. Can be combined with
    <b>--shell</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--domain {ip|ip6}</b></dt>
  <dd class="It-tag">Handle only the specified domain. <b>ferm</b> output may be
      empty if the domain is not configured in the input file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--def '$name=value'</b></dt>
  <dd class="It-tag">Override a variable defined in the configuration file.</dd>
</dl>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i>iptables</i>(8)
<h1 class="Sh" title="Sh" id="REQUIREMENTS"><a class="selflink" href="#REQUIREMENTS">REQUIREMENTS</a></h1>
<h2 class="Ss" title="Ss" id="Operating_system"><a class="selflink" href="#Operating_system">Operating
  system</a></h2>
Linux 2.4 or newer, with netfilter support and all netfilter modules used by
  your firewall script
<h2 class="Ss" title="Ss" id="Software"><a class="selflink" href="#Software">Software</a></h2>
iptables and perl 5.6
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Bugs? What bugs?
<div class="Pp"></div>
If you find a bug, please tell us: ferm@foo-projects.org
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
Copyright (C) 2001-2012 Max Kellermann &lt;max@foo-projects.org&gt;, Auke Kok
  &lt;sofar@foo-projects.org&gt;
<div class="Pp"></div>
This program is free software; you can redistribute it and/or modify it under
  the terms of the GNU General Public License as published by the Free Software
  Foundation; either version 2 of the License, or (at your option) any later
  version.
<div class="Pp"></div>
This program is distributed in the hope that it will be useful, but WITHOUT ANY
  WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
  A PARTICULAR PURPOSE. See the GNU General Public License for more details.
<div class="Pp"></div>
You should have received a copy of the GNU General Public License along with
  this program; if not, write to the Free Software Foundation, Inc., 59 Temple
  Place, Suite 330, Boston, MA 02111-1307 USA
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Max Kellermann &lt;max@foo-projects.org&gt;, Auke Kok
  &lt;sofar@foo-projects.org&gt;</div>
<table class="foot">
  <tr>
    <td class="foot-date">2016-03-30</td>
    <td class="foot-os">ferm 2.3</td>
  </tr>
</table>
</body>
</html>
