<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>VERIFY(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">VERIFY(1)</td>
    <td class="head-vol">OpenSSL</td>
    <td class="head-rtitle">VERIFY(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
verify - Utility to verify certificates.
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>openssl</b> <b>verify</b> [ <b>-CApath directory</b>] [ <b>-CAfile file</b>]
  [ <b>-trusted_first</b>] [ <b>-purpose purpose</b>] [ <b>-policy arg</b>] [
  <b>-ignore_critical</b>] [ <b>-crl_check</b>] [ <b>-crl_check_all</b>] [
  <b>-policy_check</b>] [ <b>-explicit_policy</b>] [ <b>-inhibit_any</b>] [
  <b>-inhibit_map</b>] [ <b>-x509_strict</b>] [ <b>-extended_crl</b>] [
  <b>-use_deltas</b>] [ <b>-policy_print</b>] [ <b>-untrusted file</b>] [
  <b>-help</b>] [ <b>-issuer_checks</b>] [ <b>-attime timestamp</b>] [
  <b>-verbose</b>] [ <b>-</b>] [certificates]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <b>verify</b> command verifies certificate chains.
<h1 class="Sh" title="Sh" id="COMMAND_OPTIONS"><a class="selflink" href="#COMMAND_OPTIONS">COMMAND
  OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-CApath directory</b></dt>
  <dd class="It-tag">A directory of trusted certificates. The certificates
      should have names of the form: hash.0 or have symbolic links to them of
      this form (&quot;hash&quot; is the hashed certificate subject name: see
      the <b>-hash</b> option of the <b>x509</b> utility). Under Unix the
      <b>c_rehash</b> script will automatically create symbolic links to a
      directory of certificates.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-CAfile file</b></dt>
  <dd class="It-tag">A file of trusted certificates. The file should contain
      multiple certificates in PEM format concatenated together.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-untrusted file</b></dt>
  <dd class="It-tag">A file of untrusted certificates. The file should contain
      multiple certificates in PEM format concatenated together.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-trusted_first</b></dt>
  <dd class="It-tag">Use certificates in CA file or CA directory before the
      certificates in the untrusted file when building the trust chain to verify
      certificates. This is mainly useful in environments with Bridge CA or
      Cross-Certified CAs.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-purpose purpose</b></dt>
  <dd class="It-tag">The intended use for the certificate. If this option is not
      specified, <b>verify</b> will not consider certificate purpose during
      chain verification. Currently accepted uses are <b>sslclient</b>,
      <b>sslserver</b>, <b>nssslserver</b>, <b>smimesign</b>,
      <b>smimeencrypt</b>. See the <b>VERIFY OPERATION</b> section for more
      information.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-help</b></dt>
  <dd class="It-tag">Print out a usage message.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-verbose</b></dt>
  <dd class="It-tag">Print extra information about the operations being
      performed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-issuer_checks</b></dt>
  <dd class="It-tag">Print out diagnostics relating to searches for the issuer
      certificate of the current certificate. This shows why each candidate
      issuer certificate was rejected. The presence of rejection messages does
      not itself imply that anything is wrong; during the normal verification
      process, several rejections may take place.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-attime timestamp</b></dt>
  <dd class="It-tag">Perform validation checks using the time specified by
      <b>timestamp</b> and not the current system time. <b>timestamp</b> is the
      number of seconds since 01.01.1970 (UNIX time).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-policy arg</b></dt>
  <dd class="It-tag">Enable policy processing and add <b>arg</b> to the
      user-initial-policy-set (see RFC5280). The policy <b>arg</b> can be an
      object name an OID in numeric form. This argument can appear more than
      once.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-policy_check</b></dt>
  <dd class="It-tag">Enables certificate policy processing.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-explicit_policy</b></dt>
  <dd class="It-tag">Set policy variable require-explicit-policy (see
    RFC5280).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-inhibit_any</b></dt>
  <dd class="It-tag">Set policy variable inhibit-any-policy (see RFC5280).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-inhibit_map</b></dt>
  <dd class="It-tag">Set policy variable inhibit-policy-mapping (see
    RFC5280).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-policy_print</b></dt>
  <dd class="It-tag">Print out diagnostics related to policy processing.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-crl_check</b></dt>
  <dd class="It-tag">Checks end entity certificate validity by attempting to
      look up a valid CRL. If a valid CRL cannot be found an error occurs.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-crl_check_all</b></dt>
  <dd class="It-tag">Checks the validity of <b>all</b> certificates in the chain
      by attempting to look up valid CRLs.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-ignore_critical</b></dt>
  <dd class="It-tag">Normally if an unhandled critical extension is present
      which is not supported by OpenSSL the certificate is rejected (as required
      by RFC5280). If this option is set critical extensions are ignored.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-x509_strict</b></dt>
  <dd class="It-tag">For strict X.509 compliance, disable non-compliant
      workarounds for broken certificates.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-extended_crl</b></dt>
  <dd class="It-tag">Enable extended CRL features such as indirect CRLs and
      alternate CRL signing keys.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-use_deltas</b></dt>
  <dd class="It-tag">Enable support for delta CRLs.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-check_ss_sig</b></dt>
  <dd class="It-tag">Verify the signature on the self-signed root CA. This is
      disabled by default because it doesn't add any security.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-</b></dt>
  <dd class="It-tag">Indicates the last option. All arguments following this are
      assumed to be certificate files. This is useful if the first certificate
      filename begins with a <b>-</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>certificates</b></dt>
  <dd class="It-tag">One or more certificates to verify. If no certificates are
      given, <b>verify</b> will attempt to read a certificate from standard
      input. Certificates must be in PEM format.</dd>
</dl>
<h1 class="Sh" title="Sh" id="VERIFY_OPERATION"><a class="selflink" href="#VERIFY_OPERATION">VERIFY
  OPERATION</a></h1>
The <b>verify</b> program uses the same functions as the internal SSL and S/MIME
  verification, therefore this description applies to these verify operations
  too.
<div class="Pp"></div>
There is one crucial difference between the verify operations performed by the
  <b>verify</b> program: wherever possible an attempt is made to continue after
  an error whereas normally the verify operation would halt on the first error.
  This allows all the problems with a certificate chain to be determined.
<div class="Pp"></div>
The verify operation consists of a number of separate steps.
<div class="Pp"></div>
Firstly a certificate chain is built up starting from the supplied certificate
  and ending in the root CA. It is an error if the whole chain cannot be built
  up. The chain is built up by looking up the issuers certificate of the current
  certificate. If a certificate is found which is its own issuer it is assumed
  to be the root CA.
<div class="Pp"></div>
The process of 'looking up the issuers certificate' itself involves a number of
  steps. In versions of OpenSSL before 0.9.5a the first certificate whose
  subject name matched the issuer of the current certificate was assumed to be
  the issuers certificate. In OpenSSL 0.9.6 and later all certificates whose
  subject name matches the issuer name of the current certificate are subject to
  further tests. The relevant authority key identifier components of the current
  certificate (if present) must match the subject key identifier (if present)
  and issuer and serial number of the candidate issuer, in addition the keyUsage
  extension of the candidate issuer (if present) must permit certificate
  signing.
<div class="Pp"></div>
The lookup first looks in the list of untrusted certificates and if no match is
  found the remaining lookups are from the trusted certificates. The root CA is
  always looked up in the trusted certificate list: if the certificate to verify
  is a root certificate then an exact match must be found in the trusted list.
<div class="Pp"></div>
The second operation is to check every untrusted certificate's extensions for
  consistency with the supplied purpose. If the <b>-purpose</b> option is not
  included then no checks are done. The supplied or &quot;leaf&quot; certificate
  must have extensions compatible with the supplied purpose and all other
  certificates must also be valid CA certificates. The precise extensions
  required are described in more detail in the <b>CERTIFICATE EXTENSIONS</b>
  section of the <b>x509</b> utility.
<div class="Pp"></div>
The third operation is to check the trust settings on the root CA. The root CA
  should be trusted for the supplied purpose. For compatibility with previous
  versions of SSLeay and OpenSSL a certificate with no trust settings is
  considered to be valid for all purposes.
<div class="Pp"></div>
The final operation is to check the validity of the certificate chain. The
  validity period is checked against the current system time and the notBefore
  and notAfter dates in the certificate. The certificate signatures are also
  checked at this point.
<div class="Pp"></div>
If all operations complete successfully then certificate is considered valid. If
  any operation fails then the certificate is not valid.
<h1 class="Sh" title="Sh" id="DIAGNOSTICS"><a class="selflink" href="#DIAGNOSTICS">DIAGNOSTICS</a></h1>
When a verify operation fails the output messages can be somewhat cryptic. The
  general form of the error message is:
<div class="Pp"></div>
<pre>
 server.pem: /C=AU/ST=Queensland/O=CryptSoft Pty Ltd/CN=Test CA (1024 bit)
 error 24 at 1 depth lookup:invalid CA certificate
</pre>
<div class="Pp"></div>
The first line contains the name of the certificate being verified followed by
  the subject name of the certificate. The second line contains the error number
  and the depth. The depth is number of the certificate being verified when a
  problem was detected starting with zero for the certificate being verified
  itself then 1 for the CA that signed the certificate and so on. Finally a text
  version of the error number is presented.
<div class="Pp"></div>
An exhaustive list of the error codes and messages is shown below, this also
  includes the name of the error code as defined in the header file x509_vfy.h
  Some of the error codes are defined but never returned: these are described as
  &quot;unused&quot;.
<dl class="Bl-tag">
  <dt class="It-tag"><b>0 X509_V_OK: ok</b></dt>
  <dd class="It-tag">the operation was successful.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>2 X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT: unable to get
    issuer certificate</b></dt>
  <dd class="It-tag">the issuer certificate of a looked up certificate could not
      be found. This normally means the list of trusted certificates is not
      complete.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>3 X509_V_ERR_UNABLE_TO_GET_CRL: unable to get
    certificate CRL</b></dt>
  <dd class="It-tag">the CRL of a certificate could not be found.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>4 X509_V_ERR_UNABLE_TO_DECRYPT_CERT_SIGNATURE: unable to
    decrypt certificate's signature</b></dt>
  <dd class="It-tag">the certificate signature could not be decrypted. This
      means that the actual signature value could not be determined rather than
      it not matching the expected value, this is only meaningful for RSA
    keys.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>5 X509_V_ERR_UNABLE_TO_DECRYPT_CRL_SIGNATURE: unable to
    decrypt CRL's signature</b></dt>
  <dd class="It-tag">the CRL signature could not be decrypted: this means that
      the actual signature value could not be determined rather than it not
      matching the expected value. Unused.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>6 X509_V_ERR_UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY: unable
    to decode issuer public key</b></dt>
  <dd class="It-tag">the public key in the certificate SubjectPublicKeyInfo
      could not be read.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>7 X509_V_ERR_CERT_SIGNATURE_FAILURE: certificate
    signature failure</b></dt>
  <dd class="It-tag">the signature of the certificate is invalid.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>8 X509_V_ERR_CRL_SIGNATURE_FAILURE: CRL signature
    failure</b></dt>
  <dd class="It-tag">the signature of the certificate is invalid.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>9 X509_V_ERR_CERT_NOT_YET_VALID: certificate is not yet
    valid</b></dt>
  <dd class="It-tag">the certificate is not yet valid: the notBefore date is
      after the current time.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>10 X509_V_ERR_CERT_HAS_EXPIRED: certificate has
    expired</b></dt>
  <dd class="It-tag">the certificate has expired: that is the notAfter date is
      before the current time.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>11 X509_V_ERR_CRL_NOT_YET_VALID: CRL is not yet
    valid</b></dt>
  <dd class="It-tag">the CRL is not yet valid.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>12 X509_V_ERR_CRL_HAS_EXPIRED: CRL has expired</b></dt>
  <dd class="It-tag">the CRL has expired.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>13 X509_V_ERR_ERROR_IN_CERT_NOT_BEFORE_FIELD: format
    error in certificate's notBefore field</b></dt>
  <dd class="It-tag">the certificate notBefore field contains an invalid
    time.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>14 X509_V_ERR_ERROR_IN_CERT_NOT_AFTER_FIELD: format
    error in certificate's notAfter field</b></dt>
  <dd class="It-tag">the certificate notAfter field contains an invalid
    time.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>15 X509_V_ERR_ERROR_IN_CRL_LAST_UPDATE_FIELD: format
    error in CRL's lastUpdate field</b></dt>
  <dd class="It-tag">the CRL lastUpdate field contains an invalid time.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>16 X509_V_ERR_ERROR_IN_CRL_NEXT_UPDATE_FIELD: format
    error in CRL's nextUpdate field</b></dt>
  <dd class="It-tag">the CRL nextUpdate field contains an invalid time.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>17 X509_V_ERR_OUT_OF_MEM: out of memory</b></dt>
  <dd class="It-tag">an error occurred trying to allocate memory. This should
      never happen.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>18 X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT: self signed
    certificate</b></dt>
  <dd class="It-tag">the passed certificate is self signed and the same
      certificate cannot be found in the list of trusted certificates.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>19 X509_V_ERR_SELF_SIGNED_CERT_IN_CHAIN: self signed
    certificate in certificate chain</b></dt>
  <dd class="It-tag">the certificate chain could be built up using the untrusted
      certificates but the root could not be found locally.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>20 X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY: unable
    to get local issuer certificate</b></dt>
  <dd class="It-tag">the issuer certificate could not be found: this occurs if
      the issuer certificate of an untrusted certificate cannot be found.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>21 X509_V_ERR_UNABLE_TO_VERIFY_LEAF_SIGNATURE: unable to
    verify the first certificate</b></dt>
  <dd class="It-tag">no signatures could be verified because the chain contains
      only one certificate and it is not self signed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>22 X509_V_ERR_CERT_CHAIN_TOO_LONG: certificate chain too
    long</b></dt>
  <dd class="It-tag">the certificate chain length is greater than the supplied
      maximum depth. Unused.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>23 X509_V_ERR_CERT_REVOKED: certificate revoked</b></dt>
  <dd class="It-tag">the certificate has been revoked.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>24 X509_V_ERR_INVALID_CA: invalid CA
    certificate</b></dt>
  <dd class="It-tag">a CA certificate is invalid. Either it is not a CA or its
      extensions are not consistent with the supplied purpose.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>25 X509_V_ERR_PATH_LENGTH_EXCEEDED: path length
    constraint exceeded</b></dt>
  <dd class="It-tag">the basicConstraints pathlength parameter has been
      exceeded.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>26 X509_V_ERR_INVALID_PURPOSE: unsupported certificate
    purpose</b></dt>
  <dd class="It-tag">the supplied certificate cannot be used for the specified
      purpose.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>27 X509_V_ERR_CERT_UNTRUSTED: certificate not
    trusted</b></dt>
  <dd class="It-tag">the root CA is not marked as trusted for the specified
      purpose.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>28 X509_V_ERR_CERT_REJECTED: certificate
    rejected</b></dt>
  <dd class="It-tag">the root CA is marked to reject the specified purpose.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>29 X509_V_ERR_SUBJECT_ISSUER_MISMATCH: subject issuer
    mismatch</b></dt>
  <dd class="It-tag">the current candidate issuer certificate was rejected
      because its subject name did not match the issuer name of the current
      certificate. Only displayed when the <b>-issuer_checks</b> option is
    set.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>30 X509_V_ERR_AKID_SKID_MISMATCH: authority and subject
    key identifier mismatch</b></dt>
  <dd class="It-tag">the current candidate issuer certificate was rejected
      because its subject key identifier was present and did not match the
      authority key identifier current certificate. Only displayed when the
      <b>-issuer_checks</b> option is set.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>31 X509_V_ERR_AKID_ISSUER_SERIAL_MISMATCH: authority and
    issuer serial number mismatch</b></dt>
  <dd class="It-tag">the current candidate issuer certificate was rejected
      because its issuer name and serial number was present and did not match
      the authority key identifier of the current certificate. Only displayed
      when the <b>-issuer_checks</b> option is set.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>32 X509_V_ERR_KEYUSAGE_NO_CERTSIGN:key usage does not
    include certificate signing</b></dt>
  <dd class="It-tag">the current candidate issuer certificate was rejected
      because its keyUsage extension does not permit certificate signing.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>50 X509_V_ERR_APPLICATION_VERIFICATION: application
    verification failure</b></dt>
  <dd class="It-tag">an application specific error. Unused.</dd>
</dl>
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Although the issuer checks are a considerably improvement over the old technique
  they still suffer from limitations in the underlying X509_LOOKUP API. One
  consequence of this is that trusted certificates with matching subject name
  must either appear in a file (as specified by the <b>-CAfile</b> option) or a
  directory (as specified by <b>-CApath</b>. If they occur in both then only the
  certificates in the file will be recognised.
<div class="Pp"></div>
Previous versions of OpenSSL assume certificates with matching subject name are
  identical and mishandled them.
<div class="Pp"></div>
Previous versions of this documentation swapped the meaning of the
  <b>X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT</b> and <b>20
  X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY</b> error codes.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i>x509</i>(1)</div>
<table class="foot">
  <tr>
    <td class="foot-date">2017-02-20</td>
    <td class="foot-os">1.0.1e</td>
  </tr>
</table>
</body>
</html>
