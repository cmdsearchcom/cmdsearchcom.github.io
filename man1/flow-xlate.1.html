<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:10:25 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>flow-xlate(1) General Commands Manual flow-xlate(1)</p>

<p style="margin-top: 1em">NAME <br>
flow-xlate &acirc; Apply translations to selected fields of
a flow.</p>

<p style="margin-top: 1em">SYNOPSIS <br>
flow-xlate [-hkn] [-b big|little] [-C comment] [-d
debug_level] [-v variable binding] [-V flow_version] [-x
xlate_fname] [-X xlate_definition] [-z z_level]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
The flow-xlate utility is used to apply translations to
flows. Translations are defined in a configuration file and
are composed of actions and a definition to invoke
action(s). <br>
The definitions are in the form of terms, each term can have
a filter and multiple actions.</p>

<p style="margin-top: 1em">Words in the configuration file
of the form @VAR or @{VAR:default} will be expanded at
run-time by setting variable names with the -v option.</p>

<p style="margin-top: 1em">Translation actions begin with
the xlate-action keyword followed by a symbolic name. Each
action has a type defined below.</p>

<p style="margin-top: 1em">Translation definitions begin
with the xlate-definition keyword followed by a symbolic
name. Each definition is composed of terms which are
evaluated in the order of the config&acirc; <br>
uration file. A term may invoke a filter to conditionally
invoke an action.</p>

<p style="margin-top: 1em">Action type/sub-commands
Description/Example <br>

------------------------------------------------------------------------
<br>
ip-source-address-to-network Zero host bits based on mask.
<br>
ip-destination-address-to-network Zero host bits based on
mask.</p>

<p style="margin-top: 1em">(no sub-commands)</p>


<p style="margin-top: 1em">ip-source-address-to-class-network
Zero source host bits to <br>
match class. <br>
ip-destination-address-to-class-network Zero dst host bits
to <br>
match class.</p>

<p style="margin-top: 1em">(no sub-commands)</p>

<p style="margin-top: 1em">ip-source-address-anonymize
Anonymize source address. <br>
ip-destination-address-anonymize Anonymize destination
address. <br>
ip-address-anonymize Anonymize src/dst address.</p>

<p style="margin-top: 1em">algorithm Algorithm.
cryptopan-aes128 is <br>
currently supported. <br>
algorithm cryptopan-aes128</p>

<p style="margin-top: 1em">key Key. Key is 128 bits in hex.
<br>
key 0123456789ABCDEFG</p>

<p style="margin-top: 1em">key-file File to load key from.
Key is <br>
128 bits in hex. <br>
key-file /mfstmp/secret-key</p>

<p style="margin-top: 1em">key-file-refresh How often to
check the key file. <br>
Interval is in minutes, the <br>
optional second argument is <br>
hour:min:sec to specify the <br>
first refresh. This example <br>
will load a new key every day <br>
at 12:00:00. <br>
14400 12:00:00</p>

<p style="margin-top: 1em">ip-address-privacy-mask Apply a
mask to the source and <br>
destination address to remove <br>
bits.</p>

<p style="margin-top: 1em">ip-port-privacy-mask Apply a
mask to the source and <br>
destination port to remove <br>
bits.</p>

<p style="margin-top: 1em">tag-mask Apply mask to the
source and <br>
destination tag.</p>

<p style="margin-top: 1em">mask Source and Destination mask
<br>
to apply. <br>
mask 0xFFFF 0xFFFF</p>

<p style="margin-top: 1em">scale Scale packets and
bytes.</p>

<p style="margin-top: 1em">scale Scale to apply. <br>
scale 100</p>

<p style="margin-top: 1em">replace-source-as0 Replace
source AS 0 <br>
replace-destination-as0 Replace destination AS 0</p>

<p style="margin-top: 1em">as AS replacement value. <br>
as 3112</p>

<p style="margin-top: 1em">OPTIONS <br>
-b big|little <br>
Byte order of output.</p>

<p style="margin-top: 1em">-C Comment <br>
Add a comment.</p>

<p style="margin-top: 1em">-d debug_level <br>
Enable debugging.</p>

<p style="margin-top: 1em">-h Display help.</p>

<p style="margin-top: 1em">-k Keep time from input.</p>

<p style="margin-top: 1em">-n Don&rsquo;t load
configuration file. Useful only with -V</p>

<p style="margin-top: 1em">-v variable binding <br>
Set a variable FOO=bar.</p>

<p style="margin-top: 1em">-V pdu_version <br>
Use pdu_version format output.</p>

<p style="margin-top: 1em">1 NetFlow version 1 (No sequence
numbers, AS, or mask) <br>
5 NetFlow version 5 <br>
6 NetFlow version 6 (5+ Encapsulation size) <br>
7 NetFlow version 7 (Catalyst switches) <br>
8.1 NetFlow AS Aggregation <br>
8.2 NetFlow Proto Port Aggregation <br>
8.3 NetFlow Source Prefix Aggregation <br>
8.4 NetFlow Destination Prefix Aggregation <br>
8.5 NetFlow Prefix Aggregation <br>
8.6 NetFlow Destination (Catalyst switches) <br>
8.7 NetFlow Source Destination (Catalyst switches) <br>
8.8 NetFlow Full Flow (Catalyst switches) <br>
8.9 NetFlow ToS AS Aggregation <br>
8.10 NetFlow ToS Proto Port Aggregation <br>
8.11 NetFlow ToS Source Prefix Aggregation <br>
8.12 NetFlow ToS Destination Prefix Aggregation <br>
8.13 NetFlow ToS Prefix Aggregation <br>
8.14 NetFlow ToS Prefix Port Aggregation <br>
1005 Flow-Tools tagged version 5</p>

<p style="margin-top: 1em">-x xlate_fname <br>
Translation config file name. Defaults to
/etc/flow-tools/cfg/xlate.cfg</p>

<p style="margin-top: 1em">-X xlate_definition <br>
Translation definition. Defaults to default.</p>

<p style="margin-top: 1em">-z z_level <br>
Configure compression level to z_level. 0 is disabled (no
compression), 9 is highest compression.</p>

<p style="margin-top: 1em">EXAMPLES <br>
Convert the version 7 flows in flows.v7 to version 5,
storing the result in flows.v5.</p>

<p style="margin-top: 1em">flow-xlate -V5 &lt; flows.v7
&gt; flows.v5</p>

<p style="margin-top: 1em">Set the low 11 bits in the IP
addresses to zero unless the address is multicast or it
belongs to the 192.88.99/24 network.</p>

<p style="margin-top: 1em"># xlate.cfg <br>
include-filter filter.cfg</p>

<p style="margin-top: 1em">xlate-action MULTICAST-PRIVACY
<br>
type ip-address-privacy-mask <br>
mask 0xFFFFFFFF 0xFFFFFFFF</p>

<p style="margin-top: 1em">xlate-action UNICAST-PRIVACY
<br>
type ip-address-privacy-mask <br>
mask 0xFFFFFF00 0xFFFFF800</p>

<p style="margin-top: 1em">xlate-definition abilene_privacy
<br>
term <br>
filter mcast <br>
action MULTICAST-PRIVACY <br>
stop <br>
term <br>
filter ucast <br>
action UNICAST-PRIVACY</p>

<p style="margin-top: 1em"># filter.cfg <br>
filter-primitive MCAST <br>
type ip-address-mask <br>
permit 224.0.0.0 240.0.0.0</p>

<p style="margin-top: 1em">filter-primitive UCAST <br>
type ip-address-mask <br>
deny 224.0.0.0 240.0.0.0 <br>
default permit</p>

<p style="margin-top: 1em">filter-primitive SKIP <br>
type ip-address-mask <br>
deny 192.88.99.0 255.255.255.0 <br>
default permit</p>

<p style="margin-top: 1em">filter-definition mcast <br>
match ip-destination-address MCAST</p>

<p style="margin-top: 1em">filter-definition ucast <br>
match ip-destination-address UCAST <br>
match ip-destination-address SKIP <br>
match ip-source-address SKIP</p>

<p style="margin-top: 1em">flow-cat flows | flow-xlate
-xxlate.cfg -Xabilene_privacy | flow-print</p>

<p style="margin-top: 1em">FILES <br>
Configuration files: <br>
Symbols - /etc/flow-tools/sym/*. <br>
Filter - /etc/flow-tools/cfg/filter.cfg. <br>
Xlate - /etc/flow-tools/cfg/xlate.cfg.</p>

<p style="margin-top: 1em">BUGS <br>
The scale option can overflow the 32 bit flow counters. This
could be solved by detecting this condition and splitting
the flow in two.</p>

<p style="margin-top: 1em">Translation between aggregated
and non aggregated formats is not supported.</p>

<p style="margin-top: 1em">AUTHOR <br>
Mark Fullmer maf@splintered.net</p>

<p style="margin-top: 1em">SEE ALSO <br>
flow-tools(1)</p>
 
<p style="margin-top: 1em">flow-xlate(1)</p>
<hr>
</body>
</html>
