<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>TESTING.SH(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">TESTING.SH(1)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">TESTING.SH(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
BeakerLib - testing - asserting functions, watchdog and report
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This file contains functions related directly to testing. These functions are
  various asserts affecting final result of the phase. Watchdog and the report
  result function is included as well.
<h1 class="Sh" title="Sh" id="FUNCTIONS"><a class="selflink" href="#FUNCTIONS">FUNCTIONS</a></h1>
<h2 class="Ss" title="Ss" id="Manual_Asserts"><a class="selflink" href="#Manual_Asserts">Manual
  Asserts</a></h2>
<i>rlPass</i>
<div class="Pp"></div>
Manual assertion, asserts and logs PASS.
<div class="Pp"></div>
<pre>
    rlPass comment
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short test summary.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS.
<div class="Pp"></div>
<i>rlFail</i>
<div class="Pp"></div>
Manual assertion, asserts and logs FAIL.
<div class="Pp"></div>
<pre>
    rlFail comment
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short test summary.</dd>
</dl>
<div class="Pp"></div>
Returns 1 and asserts FAIL.
<h2 class="Ss" title="Ss" id="Arithmetic_Asserts"><a class="selflink" href="#Arithmetic_Asserts">Arithmetic
  Asserts</a></h2>
<i>rlAssert0</i>
<div class="Pp"></div>
Assertion checking for the equality of parameter to zero.
<div class="Pp"></div>
<pre>
    rlAssert0 comment value
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short test summary, e.g. &quot;Test if compilation ended
      successfully&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value</dt>
  <dd class="It-tag">Integer value (usually return code of a command).</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;value == 0&quot;.
<div class="Pp"></div>
<i>rlAssertEquals</i>
<div class="Pp"></div>
Assertion checking for the equality of two parameters.
<div class="Pp"></div>
<pre>
    rlAssertEquals comment value1 value2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short test summary, e.g. &quot;Test if all 3 packages have
      been downloaded&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value1</dt>
  <dd class="It-tag">First parameter to compare, can be a number or a
    string</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value2</dt>
  <dd class="It-tag">Second parameter to compare, can be a number or a
    string</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;value1 == value2&quot;.
<div class="Pp"></div>
<i>rlAssertNotEquals</i>
<div class="Pp"></div>
Assertion checking for the non-equality of two parameters.
<div class="Pp"></div>
<pre>
    rlAssertNotEquals comment value1 value2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short test summary, e.g. &quot;Test if return code is not
      139&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value1</dt>
  <dd class="It-tag">First parameter to compare, can be a number or a
    string</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value2</dt>
  <dd class="It-tag">Second parameter to compare, can be a number or a
    string</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;value1 != value2&quot;.
<div class="Pp"></div>
<i>rlAssertGreater</i>
<div class="Pp"></div>
Assertion checking whether first parameter is greater than the second one.
<div class="Pp"></div>
<pre>
    rlAssertGreater comment value1 value2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short test summary, e.g. &quot;Test whether there are
      running more instances of program.&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value1</dt>
  <dd class="It-tag">Integer value.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value2</dt>
  <dd class="It-tag">Integer value.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;value1 &gt; value2&quot;.
<div class="Pp"></div>
<i>rlAssertGreaterOrEqual</i>
<div class="Pp"></div>
Assertion checking whether first parameter is greater or equal to the second
  one.
<div class="Pp"></div>
<pre>
    rlAssertGreaterOrEqual comment value1 value2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short test summary (e.g. &quot;There should present at
      least one...&quot;)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value1</dt>
  <dd class="It-tag">Integer value.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value2</dt>
  <dd class="It-tag">Integer value.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;value1 X= value2&quot;.
<div class="Pp"></div>
<i>rlAssertLesser</i>
<div class="Pp"></div>
Assertion checking whether first parameter is lesser than the second one.
<div class="Pp"></div>
<pre>
    rlAssertLesser comment value1 value2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short test summary, e.g. &quot;Test whether there are
      running more instances of program.&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value1</dt>
  <dd class="It-tag">Integer value.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value2</dt>
  <dd class="It-tag">Integer value.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;value1 X value2&quot;.
<div class="Pp"></div>
<i>rlAssertLesserOrEqual</i>
<div class="Pp"></div>
Assertion checking whether first parameter is lesser or equal to the second one.
<div class="Pp"></div>
<pre>
    rlAssertLesserOrEqual comment value1 value2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short test summary (e.g. &quot;There should present at
      least one...&quot;)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value1</dt>
  <dd class="It-tag">Integer value.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value2</dt>
  <dd class="It-tag">Integer value.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;value1 X= value2&quot;.
<h2 class="Ss" title="Ss" id="File_Asserts"><a class="selflink" href="#File_Asserts">File
  Asserts</a></h2>
<i>rlAssertExists</i>
<div class="Pp"></div>
Assertion checking for the existence of a file or a directory.
<div class="Pp"></div>
<pre>
    rlAssertExists file|directory
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">file|directory</dt>
  <dd class="It-tag">Path to the file or directory.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;file&quot; exists.
<div class="Pp"></div>
<i>rlAssertNotExists</i>
<div class="Pp"></div>
Assertion checking for the non-existence of a file or a directory.
<div class="Pp"></div>
<pre>
    rlAssertNotExists file|directory
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">file|directory</dt>
  <dd class="It-tag">Path to the file or directory.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;file&quot; does not exist.
<div class="Pp"></div>
<i>rlAssertGrep</i>
<div class="Pp"></div>
Assertion checking if the file contains a pattern.
<div class="Pp"></div>
<pre>
    rlAssertGrep pattern file [options]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">pattern</dt>
  <dd class="It-tag">Regular expression to be searched for.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">file</dt>
  <dd class="It-tag">Path to the file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">options</dt>
  <dd class="It-tag">Optional parameters to be passed to grep, default is
      &quot;-q&quot;. Can be used to perform case insensitive matches (-i), or
      using extended (-E) or perl (-P) regular expressions.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;file&quot; exists and contains given
  &quot;pattern&quot;.
<div class="Pp"></div>
<i>rlAssertNotGrep</i>
<div class="Pp"></div>
Assertion checking that the file does not contain a pattern.
<div class="Pp"></div>
<pre>
    rlAssertNotGrep pattern file [options]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">pattern</dt>
  <dd class="It-tag">Regular expression to be searched for.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">file</dt>
  <dd class="It-tag">Path to the file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">options</dt>
  <dd class="It-tag">Optional parameters to be passed to grep, default is
      &quot;-q&quot;. Can be used to perform case insensitive matches (-i), or
      using extended (-E) or perl (-P) regular expressions.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;file&quot; exists and does not contain
  given &quot;pattern&quot;.
<div class="Pp"></div>
<i>rlAssertDiffer</i>
<div class="Pp"></div>
Assertion checking that two files differ (are not identical).
<div class="Pp"></div>
<pre>
    rlAssertDiffer file1 file2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">file1</dt>
  <dd class="It-tag">Path to first file1</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">file2</dt>
  <dd class="It-tag">Path to second file</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;file1&quot; and &quot;file2&quot; differs.
<div class="Pp"></div>
<i>rlAssertNotDiffer</i>
<div class="Pp"></div>
Assertion checking that two files do not differ (are identical).
<div class="Pp"></div>
<pre>
    rlAssertNotDiffer file1 file2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">file1</dt>
  <dd class="It-tag">Path to first file1</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">file2</dt>
  <dd class="It-tag">Path to second file</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;file1&quot; and &quot;file2&quot; do not
  differ.
<h2 class="Ss" title="Ss" id="Run,_Watch,_Report"><a class="selflink" href="#Run,_Watch,_Report">Run,
  Watch, Report</a></h2>
<i>rlRun</i>
<div class="Pp"></div>
Run command with optional comment and make sure its exit code matches
  expectations.
<div class="Pp"></div>
<pre>
    rlRun [-t] [-l] [-c] [-s] command [status[,status...]] [comment]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">-t</dt>
  <dd class="It-tag">If specified, stdout and stderr of the command output will
      be tagged with strigs 'STDOUT: ' and 'STDERR: '.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-l</dt>
  <dd class="It-tag">If specified, output of the command (tagged, if -t was
      specified) is logged using rlLog function. This is intended for short
      outputs, and therefore only last 50 lines are logged this way. Longer
      outputs should be analysed separately, or uploaded via rlFileSubmit or
      rlBundleLogs.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-c</dt>
  <dd class="It-tag">Same as &quot;-l&quot;, but only log the commands output if
      it failed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-s</dt>
  <dd class="It-tag">Store stdout and stderr to a file (mixed together, as the
      user would see it on a terminal) and set $rlRun_LOG variable to name of
      the file. Caller is responsible for removing the file. When -t option is
      used, the content of the file becomes tagged too.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the -s option is not used, $rlRun_LOG is not modified and keeps its
      content from the last &quot;rlRun -s&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">command</dt>
  <dd class="It-tag">Command to run.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">status</dt>
  <dd class="It-tag">Expected exit code(s). Optional, default 0. If you expect
      more exit codes, separate them with comma (e.g. &quot;0,1&quot; when both
      0 and 1 are OK and expected), or use from-to notation (i.e.
      &quot;2-5&quot; for &quot;2,3,4,5&quot;), or combine them (e.g.
      &quot;2-4,26&quot; for &quot;2,3,4,26&quot;).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short summary describing the action (optional, but
      recommended - explain what are you doing here).</dd>
</dl>
<div class="Pp"></div>
Returns the exit code of the command run. Asserts PASS when command\'s exit
  status is in the list of expected exit codes.
<div class="Pp"></div>
Note:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The output of rlRun is buffered when using &quot;-t&quot;,
      &quot;-l&quot; or &quot;-s&quot; option (they use unix pipes, which are
      buffered by nature). If you need an unbuffered output just make sure that
      &quot;expect&quot; package is installed on your system (its
      &quot;unbuffer&quot; tool will automatically be used to produce unbuffered
      output).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Be aware that there are some variables which can collide
      with your code executed within rlRun. You should avoid using
      __INTERNAL_rlRun_* variables.</dd>
</dl>
<div class="Pp"></div>
<b>Warning:</b> using &quot;unbuffer&quot; tool is now disabled because of bug
  547686.
<div class="Pp"></div>
<i>rlWatchdog</i>
<div class="Pp"></div>
Run &quot;command&quot;. If it does not finish in specified time, then kill it
  using &quot;signal&quot;.
<div class="Pp"></div>
<pre>
    rlWatchdog command timeout [signal] [callback]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">command</dt>
  <dd class="It-tag">Command to run.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">timeout</dt>
  <dd class="It-tag">Timeout to wait, in seconds.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">signal</dt>
  <dd class="It-tag">Signal to use (optional, default KILL).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">callback</dt>
  <dd class="It-tag">Callback function to be called before the signal is send
      (optional, none by default). The callback function will have one argument
      available -- PGID of the process group.</dd>
</dl>
<div class="Pp"></div>
Returns 0 if the command ends normally, without need to be killed.
<div class="Pp"></div>
<i>rlReport</i>
<div class="Pp"></div>
Report test result to the test harness. The command to be used for reporting is
  set by the respective plugin. You can also use the
  $BEAKERLIB_COMMAND_REPORT_RESULT variable to use your custom command.
<div class="Pp"></div>
<pre>
    rlReport name result [score] [log]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">name</dt>
  <dd class="It-tag">Name of the test result.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">result</dt>
  <dd class="It-tag">Result (one of PASS, WARN, FAIL). If called with something
      else, will use WARN.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">score</dt>
  <dd class="It-tag">Test score (optional).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">log</dt>
  <dd class="It-tag">Optional log file to be submitted instead of default
      &quot;OUTPUTFILE&quot;.</dd>
</dl>
<div class="Pp"></div>
<i>rlCmpVersion</i>
<div class="Pp"></div>
Compare two given versions composed by numbers and letters divided by dot (.),
  underscore (_), or dash (-).
<div class="Pp"></div>
<pre>
    rlCmpVersion ver1 ver2
</pre>
<div class="Pp"></div>
If ver1 = ver2, sign '=' is printed to stdout and 0 is returned. If ver1 &gt;
  ver2, sign '&gt;' is printed to stdout and 1 is returned. If ver1 &lt; ver2,
  sign '&lt;' is printed to stdout and 2 is returned.
<div class="Pp"></div>
<i>rlTestVersion</i>
<div class="Pp"></div>
Test releation between two given versions based on given operator.
<div class="Pp"></div>
<pre>
    rlTestVersion ver1 op ver2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">op</dt>
  <dd class="It-tag">Operator definitng the logical expression. It can be '=',
      '==', '!=', '&lt;', '&lt;=', '=&lt;', '&gt;', '&gt;=', or '=&gt;'.</dd>
</dl>
<div class="Pp"></div>
Returns 0 if the expresison ver1 op ver2 is true; 1 if the expression is false
  and 2 if something went wrong.
<h2 class="Ss" title="Ss" id="Release_Info"><a class="selflink" href="#Release_Info">Release
  Info</a></h2>
<i>rlIsRHEL</i>
<div class="Pp"></div>
Check whether we're running on RHEL. With given number of version as parameter
  returns 0 if the particular RHEL version is running. Multiple arguments can be
  passed separated with space as well as any particular release (5.1 5.2 5.3).
  Each version can have a prefix consisting of '&lt;', '&lt;=', '=', '&gt;=',
  '&gt;', matching whenever the currently installed version is lesser, lesser or
  equal, equal, equal or greater, greater than the version specified as
  argument. Note that ie. '=5' (unlike just '5') matches exactly 5 (5.0), not
  5.N, where N &gt; 0.
<div class="Pp"></div>
<pre>
    rlIsRHEL
</pre>
<div class="Pp"></div>
Returns 0 if we are running on RHEL.
<div class="Pp"></div>
<pre>
    rlIsRHEL 4.8 5
</pre>
<div class="Pp"></div>
Returns 0 if we are running RHEL 4.8 or any RHEL 5.
<div class="Pp"></div>
<i>rlIsFedora</i>
<div class="Pp"></div>
Check whether we're running on Fedora. With given number of version as parameter
  returns 0 if the particular Fedora version is running. Range matching can be
  used in the form used by rlIsRHEL.
<div class="Pp"></div>
<pre>
    rlIsFedora
</pre>
<div class="Pp"></div>
Returns 0 if we are running on Fedora.
<div class="Pp"></div>
<pre>
    rlIsFedora 9 10
</pre>
<div class="Pp"></div>
Returns 0 if we are running Fedora 9 or 10.
<h2 class="Ss" title="Ss" id="Release_Info"><a class="selflink" href="#Release_Info">Release
  Info</a></h2>
<i>rlIsCentOS</i>
<div class="Pp"></div>
Check whether we're running on CentOS. With given number of version as parameter
  returns 0 if the particular CentOS version is running. Multiple arguments can
  be passed separated with space as well as any particular release (5.1 5.2
  5.3). Each version can have a prefix consisting of '&lt;', '&lt;=', '=',
  '&gt;=', '&gt;', matching whenever the currently installed version is lesser,
  lesser or equal, equal, equal or greater, greater than the version specified
  as argument. Note that ie. '=5' (unlike just '5') matches exactly 5 (5.0), not
  5.N, where N &gt; 0.
<div class="Pp"></div>
<pre>
    rlIsCentOS
</pre>
<div class="Pp"></div>
Returns 0 if we are running on CentOS.
<div class="Pp"></div>
<pre>
    rlIsCentOS 7.1 6
</pre>
<div class="Pp"></div>
Returns 0 if we are running CentOS 7.1 or any CentOS 6.
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Ondrej Hudlicky &lt;ohudlick@redhat.com&gt;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Petr Muller &lt;pmuller@redhat.com&gt;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Jan Hutar &lt;jhutar@redhat.com&gt;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Petr Splichal &lt;psplicha@redhat.com&gt;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Ales Zelinka &lt;azelinka@redhat.com&gt;</dd>
</dl>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2017-04-21</td>
    <td class="foot-os">perl v5.24.1</td>
  </tr>
</table>
</body>
</html>
