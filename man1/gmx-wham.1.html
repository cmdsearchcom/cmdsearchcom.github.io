<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:14:24 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>GMX-WHAM(1) GROMACS GMX-WHAM(1)</p>

<p style="margin-top: 1em">NAME <br>
gmx-wham - Perform weighted histogram analysis after
umbrella sampling</p>

<p style="margin-top: 1em">SYNOPSIS <br>
gmx wham [-ix [&lt;.dat&gt;]] [-if [&lt;.dat&gt;]] [-it
[&lt;.dat&gt;]] [-ip [&lt;.dat&gt;]] <br>
[-is [&lt;.dat&gt;]] [-iiact [&lt;.dat&gt;]] [-tab
[&lt;.dat&gt;]] <br>
[-o [&lt;.xvg&gt;]] [-hist [&lt;.xvg&gt;]] [-oiact
[&lt;.xvg&gt;]] <br>
[-bsres [&lt;.xvg&gt;]] [-bsprof [&lt;.xvg&gt;]] [-xvg
&lt;enum&gt;] <br>
[-min &lt;real&gt;] [-max &lt;real&gt;] [-[no]auto] [-bins
&lt;int&gt;] <br>
[-temp &lt;real&gt;] [-tol &lt;real&gt;] [-[no]v] [-b
&lt;real&gt;] <br>
[-e &lt;real&gt;] [-dt &lt;real&gt;] [-[no]histonly]
[-[no]boundsonly] <br>
[-[no]log] [-unit &lt;enum&gt;] [-zprof0 &lt;real&gt;]
[-[no]cycl] <br>
[-[no]sym] [-[no]ac] [-acsig &lt;real&gt;] [-ac-trestart
&lt;real&gt;] <br>
[-nBootstrap &lt;int&gt;] [-bs-method &lt;enum&gt;] [-bs-tau
&lt;real&gt;] <br>
[-bs-seed &lt;int&gt;] [-histbs-block &lt;int&gt;]
[-[no]vbs]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
gmx wham is an analysis program that implements the Weighted
Histogram Analysis Method (WHAM). It is intended to analyze
output files generated by umbrella sampling simulations <br>
to compute a potential of mean force (PMF).</p>

<p style="margin-top: 1em">gmx wham is currently not fully
up to date. It only supports pull setups where the first
pull coordinate(s) is/are umbrella pull coordinates and, if
multiple coordinates need to <br>
be analyzed, all used the same geometry and dimensions. In
most cases this is not an issue.</p>

<p style="margin-top: 1em">At present, three input modes
are supported.</p>

<p style="margin-top: 1em">&Acirc;&middot; With option -it,
the user provides a file which contains the file names of
the umbrella simulation run-input files (.tpr files), AND,
with option -ix, a file which contains <br>
file names of the pullx mdrun output files. The .tpr and
pullx files must be in corresponding order, i.e. the first
.tpr created the first pullx, etc.</p>

<p style="margin-top: 1em">&Acirc;&middot; Same as the
previous input mode, except that the the user provides the
pull force output file names (pullf.xvg) with option -if.
From the pull force the position in the <br>
umbrella potential is computed. This does not work with
tabulated umbrella potentials.</p>

<p style="margin-top: 1em">&Acirc;&middot; With option -ip,
the user provides file names of (gzipped) .pdo files, i.e.
the GROMACS 3.3 umbrella output files. If you have some
unusual reaction coordinate you may also <br>
generate your own .pdo files and feed them with the -ip
option into to gmx wham. The .pdo file header must be
similar to the following:</p>

<p style="margin-top: 1em"># UMBRELLA 3.0 <br>
# Component selection: 0 0 1 <br>
# nSkip 1 <br>
# Ref. Group &rsquo;TestAtom&rsquo; <br>
# Nr. of pull groups 2 <br>
# Group 1 &rsquo;GR1&rsquo; Umb. Pos. 5.0 Umb. Cons. 1000.0
<br>
# Group 2 &rsquo;GR2&rsquo; Umb. Pos. 2.0 Umb. Cons. 500.0
<br>
#####</p>

<p style="margin-top: 1em">The number of pull groups,
umbrella positions, force constants, and names may (of
course) differ. Following the header, a time column and a
data column for each pull group fol&acirc; <br>
lows (i.e. the displacement with respect to the umbrella
center). Up to four pull groups are possible per .pdo file
at present.</p>

<p style="margin-top: 1em">By default, all pull coordinates
found in all pullx/pullf files are used in WHAM. If only
some of the pull coordinates should be used, a pull
coordinate selection file (option <br>
-is) can be provided. The selection file must contain one
line for each tpr file in tpr-files.dat. Each of these lines
must contain one digit (0 or 1) for each pull coordinate
<br>
in the tpr file. Here, 1 indicates that the pull coordinate
is used in WHAM, and 0 means it is omitted. Example: If you
have three tpr files, each containing 4 pull coordinates,
<br>
but only pull coordinates 1 and 2 should be used,
coordsel.dat looks like this:</p>

<p style="margin-top: 1em">1 1 0 0 <br>
1 1 0 0 <br>
1 1 0 0</p>

<p style="margin-top: 1em">By default, the output files
are:</p>

<p style="margin-top: 1em">&lsquo;&lsquo;-o&lsquo;&lsquo;
PMF output file <br>
&lsquo;&lsquo;-hist&lsquo;&lsquo; Histograms output file</p>

<p style="margin-top: 1em">Always check whether the
histograms sufficiently overlap.</p>

<p style="margin-top: 1em">The umbrella potential is
assumed to be harmonic and the force constants are read from
the .tpr or .pdo files. If a non-harmonic umbrella force was
applied a tabulated potential <br>
can be provided with -tab.</p>

<p style="margin-top: 1em">WHAM options <br>
&Acirc;&middot; -bins Number of bins used in analysis</p>

<p style="margin-top: 1em">&Acirc;&middot; -temp
Temperature in the simulations</p>

<p style="margin-top: 1em">&Acirc;&middot; -tol Stop
iteration if profile (probability) changed less than
tolerance</p>

<p style="margin-top: 1em">&Acirc;&middot; -auto Automatic
determination of boundaries</p>

<p style="margin-top: 1em">&Acirc;&middot; -min,-max
Boundaries of the profile</p>

<p style="margin-top: 1em">The data points that are used to
compute the profile can be restricted with options -b, -e,
and -dt. Adjust -b to ensure sufficient equilibration in
each umbrella window.</p>

<p style="margin-top: 1em">With -log (default) the profile
is written in energy units, otherwise (with -nolog) as
probability. The unit can be specified with -unit. With
energy output, the energy in the <br>
first bin is defined to be zero. If you want the free energy
at a different position to be zero, set -zprof0 (useful with
bootstrapping, see below).</p>

<p style="margin-top: 1em">For cyclic or periodic reaction
coordinates (dihedral angle, channel PMF without osmotic
gradient), the option -cycl is useful. gmx wham will make
use of the periodicity of the <br>
system and generate a periodic PMF. The first and the last
bin of the reaction coordinate will assumed be be
neighbors.</p>

<p style="margin-top: 1em">Option -sym symmetrizes the
profile around z=0 before output, which may be useful for,
e.g. membranes.</p>

<p style="margin-top: 1em">Parallelization <br>
If available, the number of OpenMP threads used by gmx wham
can be controlled by setting the OMP_NUM_THREADS environment
variable.</p>

<p style="margin-top: 1em">Autocorrelations <br>
With -ac, gmx wham estimates the integrated autocorrelation
time (IACT) tau for each umbrella window and weights the
respective window with 1/[1+2*tau/dt]. The IACTs are written
<br>
to the file defined with -oiact. In verbose mode, all
autocorrelation functions (ACFs) are written to
hist_autocorr.xvg. Because the IACTs can be severely
underestimated in case <br>
of limited sampling, option -acsig allows one to smooth the
IACTs along the reaction coordinate with a Gaussian (sigma
provided with -acsig, see output in iact.xvg). Note that
<br>
the IACTs are estimated by simple integration of the ACFs
while the ACFs are larger 0.05. If you prefer to compute the
IACTs by a more sophisticated (but possibly less robust)
<br>
method such as fitting to a double exponential, you can
compute the IACTs with gmx analyze and provide them to gmx
wham with the file iact-in.dat (option -iiact), which should
<br>
contain one line per input file (.pdo or pullx/f file) and
one column per pull coordinate in the respective file.</p>

<p style="margin-top: 1em">Error analysis <br>
Statistical errors may be estimated with bootstrap analysis.
Use it with care, otherwise the statistical error may be
substantially underestimated. More background and examples
<br>
for the bootstrap technique can be found in Hub, de Groot
and Van der Spoel, JCTC (2010) 6: 3713-3720. -nBootstrap
defines the number of bootstraps (use, e.g., 100). Four
boot&acirc; <br>
strapping methods are supported and selected with
-bs-method.</p>

<p style="margin-top: 1em">&Acirc;&middot; b-hist Default:
complete histograms are considered as independent data
points, and the bootstrap is carried out by assigning random
weights to the histograms (&quot;Bayesian boot&acirc; <br>
strap&quot;). Note that each point along the reaction
coordinate must be covered by multiple independent
histograms (e.g. 10 histograms), otherwise the statistical
error is underes&acirc; <br>
timated.</p>

<p style="margin-top: 1em">&Acirc;&middot; hist Complete
histograms are considered as independent data points. For
each bootstrap, N histograms are randomly chosen from the N
given histograms (allowing duplication, <br>
i.e. sampling with replacement). To avoid gaps without data
along the reaction coordinate blocks of histograms
(-histbs-block) may be defined. In that case, the given
his&acirc; <br>
tograms are divided into blocks and only histograms within
each block are mixed. Note that the histograms within each
block must be representative for all possible histograms,
<br>
otherwise the statistical error is underestimated.</p>

<p style="margin-top: 1em">&Acirc;&middot; traj The given
histograms are used to generate new random trajectories,
such that the generated data points are distributed
according the given histograms and properly auto&acirc; <br>
correlated. The autocorrelation time (ACT) for each window
must be known, so use -ac or provide the ACT with -iiact. If
the ACT of all windows are identical (and known), you <br>
can also provide them with -bs-tau. Note that this method
may severely underestimate the error in case of limited
sampling, that is if individual histograms do not represent
<br>
the complete phase space at the respective positions.</p>

<p style="margin-top: 1em">&Acirc;&middot; traj-gauss The
same as method traj, but the trajectories are not
bootstrapped from the umbrella histograms but from Gaussians
with the average and width of the umbrella his&acirc; <br>
tograms. That method yields similar error estimates like
method traj.</p>

<p style="margin-top: 1em">Bootstrapping output:</p>

<p style="margin-top: 1em">&Acirc;&middot; -bsres Average
profile and standard deviations</p>

<p style="margin-top: 1em">&Acirc;&middot; -bsprof All
bootstrapping profiles</p>

<p style="margin-top: 1em">With -vbs (verbose
bootstrapping), the histograms of each bootstrap are
written, and, with bootstrap method traj, the cumulative
distribution functions of the histograms.</p>

<p style="margin-top: 1em">OPTIONS <br>
Options to specify input files:</p>

<p style="margin-top: 1em">-ix [&lt;.dat&gt;]
(pullx-files.dat) (Optional) <br>
Generic data file</p>

<p style="margin-top: 1em">-if [&lt;.dat&gt;]
(pullf-files.dat) (Optional) <br>
Generic data file</p>

<p style="margin-top: 1em">-it [&lt;.dat&gt;]
(tpr-files.dat) (Optional) <br>
Generic data file</p>

<p style="margin-top: 1em">-ip [&lt;.dat&gt;]
(pdo-files.dat) (Optional) <br>
Generic data file</p>

<p style="margin-top: 1em">-is [&lt;.dat&gt;]
(coordsel.dat) (Optional) <br>
Generic data file</p>

<p style="margin-top: 1em">-iiact [&lt;.dat&gt;]
(iact-in.dat) (Optional) <br>
Generic data file</p>

<p style="margin-top: 1em">-tab [&lt;.dat&gt;]
(umb-pot.dat) (Optional) <br>
Generic data file</p>

<p style="margin-top: 1em">Options to specify output
files:</p>

<p style="margin-top: 1em">-o [&lt;.xvg&gt;] (profile.xvg)
<br>
xvgr/xmgr file</p>

<p style="margin-top: 1em">-hist [&lt;.xvg&gt;] (histo.xvg)
<br>
xvgr/xmgr file</p>

<p style="margin-top: 1em">-oiact [&lt;.xvg&gt;] (iact.xvg)
(Optional) <br>
xvgr/xmgr file</p>

<p style="margin-top: 1em">-bsres [&lt;.xvg&gt;]
(bsResult.xvg) (Optional) <br>
xvgr/xmgr file</p>

<p style="margin-top: 1em">-bsprof [&lt;.xvg&gt;]
(bsProfs.xvg) (Optional) <br>
xvgr/xmgr file</p>

<p style="margin-top: 1em">Other options:</p>

<p style="margin-top: 1em">-xvg &lt;enum&gt; (xmgrace) <br>
xvg plot formatting: xmgrace, xmgr, none</p>

<p style="margin-top: 1em">-min &lt;real&gt; (0) <br>
Minimum coordinate in profile</p>

<p style="margin-top: 1em">-max &lt;real&gt; (0) <br>
Maximum coordinate in profile</p>

<p style="margin-top: 1em">-[no]auto (yes) <br>
Determine min and max automatically</p>

<p style="margin-top: 1em">-bins &lt;int&gt; (200) <br>
Number of bins in profile</p>

<p style="margin-top: 1em">-temp &lt;real&gt; (298) <br>
Temperature</p>

<p style="margin-top: 1em">-tol &lt;real&gt; (1e-06) <br>
Tolerance</p>

<p style="margin-top: 1em">-[no]v (no) <br>
Verbose mode</p>

<p style="margin-top: 1em">-b &lt;real&gt; (50) <br>
First time to analyse (ps)</p>

<p style="margin-top: 1em">-e &lt;real&gt; (1e+20) <br>
Last time to analyse (ps)</p>

<p style="margin-top: 1em">-dt &lt;real&gt; (0) <br>
Analyse only every dt ps</p>

<p style="margin-top: 1em">-[no]histonly (no) <br>
Write histograms and exit</p>

<p style="margin-top: 1em">-[no]boundsonly (no) <br>
Determine min and max and exit (with -auto)</p>

<p style="margin-top: 1em">-[no]log (yes) <br>
Calculate the log of the profile before printing</p>

<p style="margin-top: 1em">-unit &lt;enum&gt; (kJ) <br>
Energy unit in case of log output: kJ, kCal, kT</p>

<p style="margin-top: 1em">-zprof0 &lt;real&gt; (0) <br>
Define profile to 0.0 at this position (with -log)</p>

<p style="margin-top: 1em">-[no]cycl (no) <br>
Create cyclic/periodic profile. Assumes min and max are the
same point.</p>

<p style="margin-top: 1em">-[no]sym (no) <br>
Symmetrize profile around z=0</p>

<p style="margin-top: 1em">-[no]ac (no) <br>
Calculate integrated autocorrelation times and use in
wham</p>

<p style="margin-top: 1em">-acsig &lt;real&gt; (0) <br>
Smooth autocorrelation times along reaction coordinate with
Gaussian of this sigma</p>

<p style="margin-top: 1em">-ac-trestart &lt;real&gt; (1)
<br>
When computing autocorrelation functions, restart computing
every .. (ps)</p>

<p style="margin-top: 1em">-nBootstrap &lt;int&gt; (0) <br>
nr of bootstraps to estimate statistical uncertainty (e.g.,
200)</p>

<p style="margin-top: 1em">-bs-method &lt;enum&gt; (b-hist)
<br>
Bootstrap method: b-hist, hist, traj, traj-gauss</p>

<p style="margin-top: 1em">-bs-tau &lt;real&gt; (0) <br>
Autocorrelation time (ACT) assumed for all histograms. Use
option -ac if ACT is unknown.</p>

<p style="margin-top: 1em">-bs-seed &lt;int&gt; (-1) <br>
Seed for bootstrapping. (-1 = use time)</p>

<p style="margin-top: 1em">-histbs-block &lt;int&gt; (8)
<br>
When mixing histograms only mix within blocks of
-histbs-block.</p>

<p style="margin-top: 1em">-[no]vbs (no) <br>
Verbose bootstrapping. Print the CDFs and a histogram file
for each bootstrap.</p>

<p style="margin-top: 1em">SEE ALSO <br>
gmx(1)</p>

<p style="margin-top: 1em">More information about GROMACS
is available at &lt;http://www.gromacs.org/&gt;.</p>

<p style="margin-top: 1em">COPYRIGHT <br>
2017, GROMACS development team</p>

<p style="margin-top: 1em">2016.3 Mar 13, 2017
GMX-WHAM(1)</p>
<hr>
</body>
</html>
