<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 15:58:06 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>CGM_TOOLS(1NCARG) NCAR GRAPHICS CGM_TOOLS(1NCARG)</p>

<p style="margin-top: 1em">NAME <br>
CGM_open, CGM_close, CGM_lseek, CGM_read, CGM_write,
CGM_directory, CGM_freeDirectory, CGM_printDirectory,
CGM_getInstr, CGM_flushGetInstr, CGM_putInstr,
CGM_flushOutputInstr, <br>
CGM_initMetaEdit, CGM_termMetaEdit, CGM_copyFrames,
CGM_deleteFrames, CGM_mergeFrames CGM_moveFrames,
CGM_readFrames, CGM_valid, CGM_writeFile, CGM_writeFrames,
CGM_appendFrames <br>
- Computer Graphics Metafile operations</p>

<p style="margin-top: 1em">SYNTAX <br>
#include &lt;cgm_tools.h&gt;</p>

<p style="margin-top: 1em">Cgm_fd CGM_open(metafile, size,
flags, mode) <br>
char *metafile; <br>
unsigned size; <br>
int flags; <br>
int mode;</p>

<p style="margin-top: 1em">int CGM_close(cgm_fd) <br>
Cgm_fd cgm_fd;</p>

<p style="margin-top: 1em">int CGM_lseek(cgm_fd, offset)
<br>
Cgm_fd cgm_fd; <br>
int offset;</p>

<p style="margin-top: 1em">int CGM_read(cgm_fd, buf) <br>
Cgm_fd cgm_fd; <br>
unsigned char *buf;</p>

<p style="margin-top: 1em">int CGM_write(cgm_fd, buf) <br>
Cgm_fd cgm_fd; <br>
unsigned char *buf;</p>

<p style="margin-top: 1em">Directory *CGM_directory(cgm_fd)
<br>
Cgm_fd cgm_fd;</p>

<p style="margin-top: 1em">void CGM_freeDirectory(dir) <br>
Directory *dir;</p>

<p style="margin-top: 1em">void CGM_printDirectory(dir)
<br>
Directory *dir;</p>

<p style="margin-top: 1em">int CGM_getInstr(cgm_fd, instr)
<br>
Cgm_fd cgm_fd; <br>
Instr *instr;</p>

<p style="margin-top: 1em">void CGM_flushGetInstr(cgm_fd)
<br>
Cgm_fd cgm_fd;</p>

<p style="margin-top: 1em">int CGM_putInstr(cgm_fd, instr)
<br>
Cgm_fd cgm_fd; <br>
Instr *instr;</p>

<p style="margin-top: 1em">int CGM_flushOutputInstr(cgm_fd)
<br>
Cgm_fd cgm_fd;</p>

<p style="margin-top: 1em">Directory *CGM_initMetaEdit
(metafile, size) <br>
char *metafile; <br>
unsigned int size;</p>

<p style="margin-top: 1em">int CGM_termMetaEdit()</p>

<p style="margin-top: 1em">Directory *CGM_copyFrames(start,
num, target ) <br>
unsigned int start; <br>
int num; <br>
unsigned int target;</p>

<p style="margin-top: 1em">Directory
*CGM_deleteFrames(start, num) <br>
unsigned int start, <br>
num;</p>

<p style="margin-top: 1em">Directory
*CGM_mergeFrames(bottom, top) <br>
unsigned bottom, top;</p>

<p style="margin-top: 1em">Directory *CGM_moveFrames
(start, num, target) <br>
unsigned int start, num, target;</p>

<p style="margin-top: 1em">Directory
*CGM_readFrames(metafile, start, num, target, size) <br>
char *metafile; <br>
unsigned int start; <br>
int num; <br>
unsigned int target, size;</p>

<p style="margin-top: 1em">int *CGM_validCGM(metafile) <br>
char *metafile;</p>

<p style="margin-top: 1em">int CGM_writeFile(metafile) <br>
char *metafile;</p>

<p style="margin-top: 1em">int CGM_writeFrames(metafile,
start, num) <br>
char *metafile; <br>
unsigned start, num;</p>

<p style="margin-top: 1em">int CGM_appendFrames(metafile,
start, num) <br>
char *metafile; <br>
unsigned start, num;</p>

<p style="margin-top: 1em">DESCRIPTION <br>
The argument cgm_fd refers to a valid file descriptor
created for reading or writing, as appropriate by CGM_open.
CGM_read, CGM_directory, CGM_getInstr and CGM_flushGetInstr
<br>
require a file descriptor open for reading. CGM_write,
CGM_getInstr,CGM_flushGetInstr and CGM_flushOutputInstr
require a Cgm_fd open for writing. CGM_close and CGM_lseek
will <br>
accept any valid Cgm_fd.</p>

<p style="margin-top: 1em">The size argument refers to the
CGM record size in bytes. For an NCAR CGM this value is
1440.</p>

<p style="margin-top: 1em">buf is a pointer to user
allocated memory of size size. This storage will be used for
buffering input and output of CGM_read and CGM_write
respectively.</p>

<p style="margin-top: 1em">The dir argument is a pointer to
a Directory structure created with CGM_directory or
CGM_initMetaEdit. dir is a private resource that should NOT
be directly modified by the <br>
user. A set of convenience macros is provided for this
purpose in cgm_tools.h.</p>

<p style="margin-top: 1em">The start, num and target
arguments are used to address frame numbers in a metafile
being edited with one of the commands: CGM_copyFrames,
CGM_deleteFrames, CGM_readFrames, <br>
CGM_moveFrames, CGM_writeFrames and CGM_mergeFrames. The
start argument is the first frame in a sequence of num
frame(s) to perform the editing operation on. target is
similar <br>
to start and is used by commands that require two frame
addresses such as copy. Addressing begins at zero.</p>

<p style="margin-top: 1em">CGM_open <br>
This command is modeled after the unix open command. It will
open a CGM for reading or writing as specified by the flags
argument and return a Cgm_fd file descriptor. The <br>
flags and open parameters are passed directly on to the
system open command. For a detailed explanation of these two
arguments see open(2).</p>

<p style="margin-top: 1em">CGM_close <br>
Delete a file descriptor. The inverse of CGM_open. See
close(2).</p>

<p style="margin-top: 1em">CGM_read <br>
CGM_read attempts to read size bytes from the object
referenced through the descriptor cgm_fd. size is set at the
creation of cgm_fd by CGM_open. CGM_read returns the
num&acirc; <br>
ber of bytes successfully read. A zero is returned on EOF
and a negative number implies an error occurred. The unix
system call read is called by CGM_read. See read(2).</p>

<p style="margin-top: 1em">CGM_write <br>
Attempts to write a single record of size bytes from buf
from the object referenced by cgm_edit where size is the
record size parameter provided at the creation of cgm_fd.
<br>
write returns the number of bytes successfully written. A
negative return number implies an error occurred. The unix
system call write is called by CGM_write. See <br>
write(2).</p>

<p style="margin-top: 1em">CGM_lseek <br>
Advance the file pointer of cgm_fd to offset bytes. Upon
successful completion the current file pointer offset is
returned. A negative return value is an error. The unix <br>
system call lseek is called by CGM_lseek. See lseek(2).</p>

<p style="margin-top: 1em">CGM_directory <br>
Create a table of contents for the metafile referenced by
cgm_fd. Return a pointer to this table of type Directory.
The contents of the directory include number of <br>
metafiles, number of frames, record offset for each frame,
frame length in records, optional frame description and
metafile status. These fields are meant to be read only <br>
and should only be referenced by the convenience macros
provided in cgm_tools.h. A NULL pointer is returned on
failure.</p>

<p style="margin-top: 1em">CGM_freeDirectory <br>
Free memory allocated to a directory created by
CGM_directory or CGM_initMetaEdit.</p>

<p style="margin-top: 1em">CGM_printDirectory <br>
Print the contents of a directory pointed to by dir to the
standard output.</p>

<p style="margin-top: 1em">CGM_getInstr, <br>
Fetch the next instruction in file referenced by cgm_edit
and convert it into a usable format pointed to by instr.
CGM_getInstr provides an interface to the metafile for <br>
extracting CGM elements. The user need not be concerned with
the binary format of the metafile. The fields of the Instr
are as described in cgm_tools.h. The user should <br>
note that the maximum allowable data length returned in a
single invocation is 32760 bytes. The CGM standard allows
upto 32767 bytes to be stored in a single instruction. <br>
But 32767 is not a nice number to work with. Should the data
length of a CGM instruction exceed 32760 bytes, indicated by
the boolean more flag, the next invocation of <br>
CGM_getInstr will return the remaining data up to the same
limit, etc. CGMgetInstr requires a valid Cgm_fd open for
reading. For a description on CGM see the ANSI stan&acirc;
<br>
dard.</p>

<p style="margin-top: 1em">CGM_flushGetInstr <br>
Flush the input buffer used by CGM_getInstr. CGM_getInstr
buffers the contents of the CGM and only performs actual
reads as necessary. If the user desires other then <br>
sequential read access to a CGM it becomes necessary to
flush the input buffer before reading from a new
location.</p>

<p style="margin-top: 1em">CGM_putInstr <br>
The analog to CGM_getInstr. This function buffers CGM
instructions to be written to a CGM referenced by cgm_fd.
Again the user need not be concerned with the binary format
<br>
of the file. Writes are performed sequentially in record
size size as specified during the creation of cgm_fd. The
same data length constraints that are placed on <br>
CGM_getInstr hold for CGM_putInstr. If the user wants to
output instructions with a data length greater than 32760
bytes then the data must be broken up into blocks no <br>
greater than this size. The user must also set the boolean
more flag in the Instr. cgm_fd must be a valid file
descriptor open for writing. For a description of the fields
<br>
of the Instr see the file cgm_tools.h.</p>

<p style="margin-top: 1em">CGM_flushOutputInstr <br>
Flush the output buffer used by CGM_putInstr for the file
referenced by cgm_fd. It is necessary to explicitly flush
the output buffer used by CGM_putInstr before the file <br>
is closed or any random access is performed. Otherwise not
all CGM elements will actually get written.</p>

<p style="margin-top: 1em">CGM_initMetaEdit <br>
Initialize a metafile for editing. This is the
initialization routine for the higher level editing routines
contained in this package: CGM_copyFrames, CGM_deleteFrames,
<br>
CGM_readFrames, CGM_moveFrames, CGM_writeFile,
CGM_writeFrames, and CGM_mergeFrames. These routines only
work on one metafile at a time (the one named in
CGM_init&acirc; <br>
MetaEdit. Invoking this routine for a second time without
explicitly saving any changes will have the effect of
loading a new file and discarding all changes made in the
<br>
previous file. CGM_initMetaEdit and all proceeding editing
functions that make changes to the file return a pointer to
a Directory as a convenience that allows the user <br>
to examine the state of the file. The contents of the
directory are private and should NOT be changed by the user.
A set of macros is provided in cgm_tools.h to be used <br>
for retrieving the directory&rsquo;s contents. Note: no
changes are actually made to the edit file unless it is
explicitly overwritten with either CGM_writeFile or
CGM_write&acirc; <br>
Frames.</p>

<p style="margin-top: 1em">CGM_termMetaEdit <br>
Terminate the editing session started with CGM_initMetaEdit.
This routine should be called after any editing changes have
been saved, if desired to save them, and before <br>
exiting the editing session. CGM_termMetaEdit frees valuable
resources.</p>

<p style="margin-top: 1em">CGM_copyFrames <br>
Copy num frames beginning with start to the frame addressed
by target. If target is already occupied then the source
frames are inserted in its place while the target <br>
frame, and all proceeding frames, are advanced. CGM_copy
operates on the file initialized by CGM_initMetaEdit (the
edit file). On successful completion a pointer to the <br>
current directory is returned. On error a NULL pointer is
returned.</p>

<p style="margin-top: 1em">CGM_deleteFrames <br>
Delete num frames from the edit file starting with frame
start. On successful completion a pointer to the current
directory is returned. On error a NULL pointer is <br>
returned.</p>

<p style="margin-top: 1em">CGM_mergeFrames <br>
Overwrite the contents of frame addressed bottom with the
union of the frame at location bottom and the frame at
location top. The effect of this command is equivalent to
<br>
drawing the top frame on top of the bottom frame. It is not
a union in the true sense of the word. On successful
completion a pointer to the current directory is <br>
returned. On error a NULL pointer is returned.</p>

<p style="margin-top: 1em">CGM_moveFrames <br>
Move a block of num frames from the edit file starting with
with frame start to the position occupied by frame target On
successful completion a pointer to the current <br>
directory is returned. On error a NULL pointer is
returned.</p>

<p style="margin-top: 1em">CGM_readFrames <br>
Read num frames from metafile file starting with frame
start. Insert the frames at address target in the edit file.
On successful completion a pointer to the current <br>
directory is returned. On error a NULL pointer is
returned.</p>

<p style="margin-top: 1em">CGM_validCGM <br>
Determine whether a file is a valid NCAR CGM or not. This
function performs a few simple diagnostics in an effort to
determine whether a given file is in the NCAR CGM for&acirc;
<br>
mat. The tests performed are not rigorous and it is
conceivable that the information retrieved is incorrect. A
return of 1 indicates a valid NCAR CGM. A return of 0 <br>
indicates the file is not a NCAR CGM. A return of -1
indicates an error occurred and the global variable
&lsquo;errno&rsquo; is set accordingly.</p>

<p style="margin-top: 1em">CGM_writeFile <br>
Write the entire contents of the current edit file to file.
CGM_writeFile returns the integer one on success and a
negative number on failure.</p>

<p style="margin-top: 1em">CGM_writeFrames <br>
Write a block of num frames starting with frame start to
file. The source frames come from the edit file. Note: CGM
frames are contained in a wrapper made up of CGM <br>
delimiter elements. The file created by CGM_writeFrames will
use the wrapper provided by the current edit file. Thus if a
file foo contains n frames that are read into an <br>
editing session with a file goo and then these same frames
are written out to a file zoid, zoid may or may not be the
same as the original foo. CGM_writeFrames returns <br>
the integer one on success and a negative number on
failure.</p>

<p style="margin-top: 1em">CGM_appendFrames <br>
Append a block of num frames starting with frame start to
file. file must already exist and be a valid NCAR CGM.
CGM_appendFrames returns the integer one on success and a
<br>
negative number on failure.</p>

<p style="margin-top: 1em">SEE ALSO <br>
ANSI X3.122 Computer Graphics Metafile for the Storage and
Transfer of Picture Description Information.</p>

<p style="margin-top: 1em">BUGS <br>
CGMs with more the one metafile stored in the are not
guaranteed to work.</p>

<p style="margin-top: 1em">Should not have to explicitly
flush the output buffer for CGM_getInstr. This should be
handled automatically when the file is closed.</p>

<p style="margin-top: 1em">COPYRIGHT <br>
Copyright (C) 1987-2009 <br>
University Corporation for Atmospheric Research</p>

<p style="margin-top: 1em">The use of this Software is
governed by a License Agreement.</p>

<p style="margin-top: 1em">NCARG January 1993
CGM_TOOLS(1NCARG)</p>
<hr>
</body>
</html>
