<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>NGHTTPX(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">NGHTTPX(1)</td>
    <td class="head-vol">nghttp2</td>
    <td class="head-rtitle">NGHTTPX(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
nghttpx - HTTP/2 proxy
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>nghttpx</b> [OPTIONS]... [&lt;PRIVATE_KEY&gt; &lt;CERT&gt;]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
A reverse proxy for HTTP/2, HTTP/1 and SPDY.
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>&lt;PRIVATE_KEY&gt;</b></dt>
  <dd class="It-tag">Set path to server's private key. Required unless
      &quot;no-tls&quot; parameter is used in <i>--frontend</i> option.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>&lt;CERT&gt;</b></dt>
  <dd class="It-tag">Set path to server's certificate. Required unless
      &quot;no-tls&quot; parameter is used in <i>--frontend</i> option. To make
      OCSP stapling work, this must be an absolute path.</dd>
</dl>
</div>
<br/>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
The options are categorized into several groups.
<h2 class="Ss" title="Ss" id="Connections"><a class="selflink" href="#Connections">Connections</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-b,
    --backend=(&lt;HOST&gt;,&lt;PORT&gt;|unix:&lt;PATH&gt;)[;[&lt;PATTERN&gt;[:...]][[;&lt;PARAM&gt;]...]</b></dt>
  <dd class="It-tag">Set backend host and port. The multiple backend addresses
      are accepted by repeating this option. UNIX domain socket can be specified
      by prefixing path name with &quot;unix:&quot; (e.g.,
      unix:/var/run/backend.sock).
    <div style="height: 1.00em;">&#x00A0;</div>
    Optionally, if &lt;PATTERN&gt;s are given, the backend address is only used
      if request matches the pattern. The pattern matching is closely designed
      to ServeMux in net/http package of Go programming language.
      &lt;PATTERN&gt; consists of path, host + path or just host. The path must
      start with &quot; <i>/</i>&quot;. If it ends with &quot;<i>/</i>&quot;, it
      matches all request path in its subtree. To deal with the request to the
      directory without trailing slash, the path which ends with &quot;
      <i>/</i>&quot; also matches the request path which only lacks trailing '
      <i>/</i>' (e.g., path &quot;<i>/foo/</i>&quot; matches request path &quot;
      <i>/foo</i>&quot;). If it does not end with &quot; <i>/</i>&quot;, it
      performs exact match against the request path. If host is given, it
      performs exact match against the request host. If host alone is given,
      &quot; <i>/</i>&quot; is appended to it, so that it matches all request
      paths under the host (e.g., specifying &quot;nghttp2.org&quot; equals to
      &quot;nghttp2.org/&quot;). CONNECT method is treated specially. It does
      not have path, and we don't allow empty path. To workaround this, we
      assume that CONNECT method has &quot; <i>/</i>&quot; as path.
    <div style="height: 1.00em;">&#x00A0;</div>
    Patterns with host take precedence over patterns with just path. Then,
      longer patterns take precedence over shorter ones.
    <div style="height: 1.00em;">&#x00A0;</div>
    Host can include &quot;*&quot; in the left most position to indicate
      wildcard match (only suffix match is done). The &quot;*&quot; must match
      at least one character. For example, host pattern
      &quot;*.nghttp2.org&quot; matches against &quot;www.nghttp2.org&quot; and
      &quot;git.ngttp2.org&quot;, but does not match against
      &quot;nghttp2.org&quot;. The exact hosts match takes precedence over the
      wildcard hosts match.
    <div style="height: 1.00em;">&#x00A0;</div>
    If &lt;PATTERN&gt; is omitted or empty string, &quot; <i>/</i>&quot; is used
      as pattern, which matches all request paths (catch-all pattern). The
      catch-all backend must be given.
    <div style="height: 1.00em;">&#x00A0;</div>
    When doing a match, nghttpx made some normalization to pattern, request host
      and path. For host part, they are converted to lower case. For path part,
      percent-encoded unreserved characters defined in RFC 3986 are decoded, and
      any dot-segments (&quot;..&quot; and &quot;.&quot;) are resolved and
      removed.
    <div style="height: 1.00em;">&#x00A0;</div>
    For example, <i>-b</i>'127.0.0.1,8080;nghttp2.org/httpbin/' matches the
      request host &quot;nghttp2.org&quot; and the request path &quot;
      <i>/httpbin/get</i>&quot;, but does not match the request host
      &quot;nghttp2.org&quot; and the request path &quot;
      <i>/index.html</i>&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    The multiple &lt;PATTERN&gt;s can be specified, delimiting them by
      &quot;:&quot;. Specifying
      <i>-b</i>'127.0.0.1,8080;nghttp2.org:www.nghttp2.org' has the same effect
      to specify <i>-b</i>'127.0.0.1,8080;nghttp2.org' and
      <i>-b</i>'127.0.0.1,8080;www.nghttp2.org'.
    <div style="height: 1.00em;">&#x00A0;</div>
    The backend addresses sharing same &lt;PATTERN&gt; are grouped together
      forming load balancing group.
    <div style="height: 1.00em;">&#x00A0;</div>
    Several parameters &lt;PARAM&gt; are accepted after &lt;PATTERN&gt;. The
      parameters are delimited by &quot;;&quot;. The available parameters are:
      &quot;proto=&lt;PROTO&gt;&quot;, &quot;tls&quot;,
      &quot;sni=&lt;SNI_HOST&gt;&quot;, &quot;fall=&lt;N&gt;&quot;,
      &quot;rise=&lt;N&gt;&quot;, &quot;affinity=&lt;METHOD&gt;&quot;,
      &quot;dns&quot;, and &quot;redirect-if-not-tls&quot;. The parameter
      consists of keyword, and optionally followed by &quot;=&quot; and value.
      For example, the parameter &quot;proto=h2&quot; consists of the keyword
      &quot;proto&quot; and value &quot;h2&quot;. The parameter &quot;tls&quot;
      consists of the keyword &quot;tls&quot; without value. Each parameter is
      described as follows.
    <div style="height: 1.00em;">&#x00A0;</div>
    The backend application protocol can be specified using optional
      &quot;proto&quot; parameter, and in the form of
      &quot;proto=&lt;PROTO&gt;&quot;. &lt;PROTO&gt; should be one of the
      following list without quotes: &quot;h2&quot;, &quot;http/1.1&quot;. The
      default value of &lt;PROTO&gt; is &quot;http/1.1&quot;. Note that usually
      &quot;h2&quot; refers to HTTP/2 over TLS. But in this option, it may mean
      HTTP/2 over cleartext TCP unless &quot;tls&quot; keyword is used (see
      below).
    <div style="height: 1.00em;">&#x00A0;</div>
    TLS can be enabled by specifying optional &quot;tls&quot; parameter. TLS is
      not enabled by default.
    <div style="height: 1.00em;">&#x00A0;</div>
    With &quot;sni=&lt;SNI_HOST&gt;&quot; parameter, it can override the TLS SNI
      field value with given &lt;SNI_HOST&gt;. This will default to the backend
      &lt;HOST&gt; name
    <div style="height: 1.00em;">&#x00A0;</div>
    The feature to detect whether backend is online or offline can be enabled
      using optional &quot;fall&quot; and &quot;rise&quot; parameters. Using
      &quot;fall=&lt;N&gt;&quot; parameter, if nghttpx cannot connect to a this
      backend &lt;N&gt; times in a row, this backend is assumed to be offline,
      and it is excluded from load balancing. If &lt;N&gt; is 0, this backend
      never be excluded from load balancing whatever times nghttpx cannot
      connect to it, and this is the default. There is also
      &quot;rise=&lt;N&gt;&quot; parameter. After backend was excluded from load
      balancing group, nghttpx periodically attempts to make a connection to the
      failed backend, and if the connection is made successfully &lt;N&gt; times
      in a row, the backend is assumed to be online, and it is now eligible for
      load balancing target. If &lt;N&gt; is 0, a backend is permanently
      offline, once it goes in that state, and this is the default behaviour.
    <div style="height: 1.00em;">&#x00A0;</div>
    The session affinity is enabled using &quot;affinity=&lt;METHOD&gt;&quot;
      parameter. If &quot;ip&quot; is given in &lt;METHOD&gt;, client IP based
      session affinity is enabled. If &quot;none&quot; is given in
      &lt;METHOD&gt;, session affinity is disabled, and this is the default. The
      session affinity is enabled per &lt;PATTERN&gt;. If at least one backend
      has &quot;affinity&quot; parameter, and its &lt;METHOD&gt; is not
      &quot;none&quot;, session affinity is enabled for all backend servers
      sharing the same &lt;PATTERN&gt;. It is advised to set
      &quot;affinity&quot; parameter to all backend explicitly if session
      affinity is desired. The session affinity may break if one of the backend
      gets unreachable, or backend settings are reloaded or replaced by API.
    <div style="height: 1.00em;">&#x00A0;</div>
    By default, name resolution of backend host name is done at start up, or
      reloading configuration. If &quot;dns&quot; parameter is given, name
      resolution takes place dynamically. This is useful if backend address
      changes frequently. If &quot;dns&quot; is given, name resolution of
      backend host name at start up, or reloading configuration is skipped.
    <div style="height: 1.00em;">&#x00A0;</div>
    If &quot;redirect-if-not-tls&quot; parameter is used, the matched backend
      requires that frontend connection is TLS encrypted. If it isn't, nghttpx
      responds to the request with 308 status code, and https URI the client
      should use instead is included in Location header field. The port number
      in redirect URI is 443 by default, and can be changed using
      <i>--redirect-https-port</i> option. If at least one backend has
      &quot;redirect-if-not-tls&quot; parameter, this feature is enabled for all
      backend servers sharing the same &lt;PATTERN&gt;. It is advised to set
      &quot;redirect-if-no-tls&quot; parameter to all backends explicitly if
      this feature is desired.
    <div style="height: 1.00em;">&#x00A0;</div>
    Since &quot;;&quot; and &quot;:&quot; are used as delimiter, &lt;PATTERN&gt;
      must not contain these characters. Since &quot;;&quot; has special meaning
      in shell, the option value must be quoted.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>127.0.0.1,80</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f,
    --frontend=(&lt;HOST&gt;,&lt;PORT&gt;|unix:&lt;PATH&gt;)[[;&lt;PARAM&gt;]...]</b></dt>
  <dd class="It-tag">Set frontend host and port. If &lt;HOST&gt; is '*', it
      assumes all addresses including both IPv4 and IPv6. UNIX domain socket can
      be specified by prefixing path name with &quot;unix:&quot; (e.g.,
      unix:/var/run/nghttpx.sock). This option can be used multiple times to
      listen to multiple addresses.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option can take 0 or more parameters, which are described below. Note
      that &quot;api&quot; and &quot;healthmon&quot; parameters are mutually
      exclusive.
    <div style="height: 1.00em;">&#x00A0;</div>
    Optionally, TLS can be disabled by specifying &quot;no-tls&quot; parameter.
      TLS is enabled by default.
    <div style="height: 1.00em;">&#x00A0;</div>
    To make this frontend as API endpoint, specify &quot;api&quot; parameter.
      This is disabled by default. It is important to limit the access to the
      API frontend. Otherwise, someone may change the backend server, and break
      your services, or expose confidential information to the outside the
      world.
    <div style="height: 1.00em;">&#x00A0;</div>
    To make this frontend as health monitor endpoint, specify
      &quot;healthmon&quot; parameter. This is disabled by default. Any requests
      which come through this address are replied with 200 HTTP status, without
      no body.
    <div style="height: 1.00em;">&#x00A0;</div>
    To accept PROXY protocol version 1 on frontend connection, specify
      &quot;proxyproto&quot; parameter. This is disabled by default.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>*,3000</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--backlog=&lt;N&gt;</b></dt>
  <dd class="It-tag">Set listen backlog size.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>65536</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--backend-address-family=(auto|IPv4|IPv6)</b></dt>
  <dd class="It-tag">Specify address family of backend connections. If
      &quot;auto&quot; is given, both IPv4 and IPv6 are considered. If
      &quot;IPv4&quot; is given, only IPv4 address is considered. If
      &quot;IPv6&quot; is given, only IPv6 address is considered.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>auto</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--backend-http-proxy-uri=&lt;URI&gt;</b></dt>
  <dd class="It-tag">Specify proxy URI in the form
      <i>http:/</i>/[&lt;USER&gt;:&lt;PASS&gt;@]&lt;PROXY&gt;:&lt;PORT&gt;. If a
      proxy requires authentication, specify &lt;USER&gt; and &lt;PASS&gt;. Note
      that they must be properly percent-encoded. This proxy is used when the
      backend connection is HTTP/2. First, make a CONNECT request to the proxy
      and it connects to the backend on behalf of nghttpx. This forms tunnel.
      After that, nghttpx performs SSL/TLS handshake with the downstream through
      the tunnel. The timeouts when connecting and making CONNECT request can be
      specified by <i>--backend-read-timeout</i> and
      <i>--backend-write-timeout</i> options.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Performance"><a class="selflink" href="#Performance">Performance</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n, --workers=&lt;N&gt;</b></dt>
  <dd class="It-tag">Set the number of worker threads.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>1</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--single-thread</b></dt>
  <dd class="It-tag">Run everything in one thread inside the worker process.
      This feature is provided for better debugging experience, or for the
      platforms which lack thread support. If threading is disabled, this option
      is always enabled.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--read-rate=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Set maximum average read rate on frontend connection.
      Setting 0 to this option means read rate is unlimited.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>0</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--read-burst=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Set maximum read burst size on frontend connection. Setting
      0 to this option means read burst size is unlimited.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>0</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--write-rate=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Set maximum average write rate on frontend connection.
      Setting 0 to this option means write rate is unlimited.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>0</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--write-burst=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Set maximum write burst size on frontend connection.
      Setting 0 to this option means write burst size is unlimited.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>0</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--worker-read-rate=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Set maximum average read rate on frontend connection per
      worker. Setting 0 to this option means read rate is unlimited. Not
      implemented yet.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>0</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--worker-read-burst=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Set maximum read burst size on frontend connection per
      worker. Setting 0 to this option means read burst size is unlimited. Not
      implemented yet.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>0</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--worker-write-rate=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Set maximum average write rate on frontend connection per
      worker. Setting 0 to this option means write rate is unlimited. Not
      implemented yet.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>0</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--worker-write-burst=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Set maximum write burst size on frontend connection per
      worker. Setting 0 to this option means write burst size is unlimited. Not
      implemented yet.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>0</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--worker-frontend-connections=&lt;N&gt;</b></dt>
  <dd class="It-tag">Set maximum number of simultaneous connections frontend
      accepts. Setting 0 means unlimited.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>0</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--backend-connections-per-host=&lt;N&gt;</b></dt>
  <dd class="It-tag">Set maximum number of backend concurrent connections
      (and/or streams in case of HTTP/2) per origin host. This option is
      meaningful when <i>--http2-proxy</i> option is used. The origin host is
      determined by authority portion of request URI (or :authority header field
      for HTTP/2). To limit the number of connections per frontend for default
      mode, use <i>--backend-connections-per-frontend</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>8</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--backend-connections-per-frontend=&lt;N&gt;</b></dt>
  <dd class="It-tag">Set maximum number of backend concurrent connections
      (and/or streams in case of HTTP/2) per frontend. This option is only used
      for default mode. 0 means unlimited. To limit the number of connections
      per host with <i>--http2-proxy</i> option, use
      <i>--backend-connections-per-host</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>0</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--rlimit-nofile=&lt;N&gt;</b></dt>
  <dd class="It-tag">Set maximum number of open files (RLIMIT_NOFILE) to
      &lt;N&gt;. If 0 is given, nghttpx does not set the limit.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>0</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--backend-request-buffer=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Set buffer size used to store backend request.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>16K</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--backend-response-buffer=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Set buffer size used to store backend response.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>128K</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--fastopen=&lt;N&gt;</b></dt>
  <dd class="It-tag">Enables &quot;TCP Fast Open&quot; for the listening socket
      and limits the maximum length for the queue of connections that have not
      yet completed the three-way handshake. If value is 0 then fast open is
      disabled.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>0</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--no-kqueue</b></dt>
  <dd class="It-tag">Don't use kqueue. This option is only applicable for the
      platforms which have kqueue. For other platforms, this option will be
      simply ignored.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Timeout"><a class="selflink" href="#Timeout">Timeout</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--frontend-http2-read-timeout=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">Specify read timeout for HTTP/2 and SPDY frontend
      connection.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>3m</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--frontend-read-timeout=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">Specify read timeout for HTTP/1.1 frontend connection.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>1m</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--frontend-write-timeout=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">Specify write timeout for all frontend connections.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>30s</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--frontend-keep-alive-timeout=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">Specify keep-alive timeout for frontend HTTP/1 connection.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>1m</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--stream-read-timeout=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">Specify read timeout for HTTP/2 and SPDY streams. 0 means
      no timeout.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>0</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--stream-write-timeout=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">Specify write timeout for HTTP/2 and SPDY streams. 0 means
      no timeout.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>1m</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--backend-read-timeout=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">Specify read timeout for backend connection.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>1m</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--backend-write-timeout=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">Specify write timeout for backend connection.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>30s</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--backend-connect-timeout=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">Specify timeout before establishing TCP connection to
      backend.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>30s</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--backend-keep-alive-timeout=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">Specify keep-alive timeout for backend HTTP/1 connection.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>2s</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--listener-disable-timeout=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">After accepting connection failed, connection listener is
      disabled for a given amount of time. Specifying 0 disables this feature.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>30s</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--frontend-http2-setting-timeout=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">Specify timeout before SETTINGS ACK is received from
      client.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>10s</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--backend-http2-settings-timeout=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">Specify timeout before SETTINGS ACK is received from
      backend server.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>10s</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--backend-max-backoff=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">Specify maximum backoff interval. This is used when doing
      health check against offline backend (see &quot;fail&quot; parameter in
      <i>--backend</i> option). It is also used to limit the maximum interval to
      temporarily disable backend when nghttpx failed to connect to it. These
      intervals are calculated using exponential backoff, and consecutive failed
      attempts increase the interval. This option caps its maximum value.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>2m</b></dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="SSL/TLS"><a class="selflink" href="#SSL/TLS">SSL/TLS</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ciphers=&lt;SUITE&gt;</b></dt>
  <dd class="It-tag">Set allowed cipher list for frontend connection. The format
      of the string is described in OpenSSL ciphers(1).
    <div style="height: 1.00em;">&#x00A0;</div>
    Default:
      <b>ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--client-ciphers=&lt;SUITE&gt;</b></dt>
  <dd class="It-tag">Set allowed cipher list for backend connection. The format
      of the string is described in OpenSSL ciphers(1).
    <div style="height: 1.00em;">&#x00A0;</div>
    Default:
      <b>ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ecdh-curves=&lt;LIST&gt;</b></dt>
  <dd class="It-tag">Set supported curve list for frontend connections.
      &lt;LIST&gt; is a colon separated list of curve NID or names in the
      preference order. The supported curves depend on the linked OpenSSL
      library. This function requires OpenSSL &gt;= 1.0.2.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>X25519:P-256:P-384:P-521</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-k, --insecure</b></dt>
  <dd class="It-tag">Don't verify backend server's certificate if TLS is enabled
      for backend connections.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--cacert=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Set path to trusted CA certificate file used in backend TLS
      connections. The file must be in PEM format. It can contain multiple
      certificates. If the linked OpenSSL is configured to load system wide
      certificates, they are loaded at startup regardless of this option.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--private-key-passwd-file=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Path to file that contains password for the server's
      private key. If none is given and the private key is password protected
      it'll be requested interactively.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--subcert=&lt;KEYPATH&gt;:&lt;CERTPATH&gt;[[;&lt;PARAM&gt;]...]</b></dt>
  <dd class="It-tag">Specify additional certificate and private key file.
      nghttpx will choose certificates based on the hostname indicated by client
      using TLS SNI extension. If nghttpx is built with OpenSSL &gt;= 1.0.2,
      signature algorithms (e.g., ECDSA+SHA256, RSA+SHA256) presented by client
      are also taken into consideration. This allows nghttpx to send ECDSA
      certificate to modern clients, while sending RSA based certificate to
      older clients. This option can be used multiple times. To make OCSP
      stapling work, &lt;CERTPATH&gt; must be absolute path.
    <div style="height: 1.00em;">&#x00A0;</div>
    Additional parameter can be specified in &lt;PARAM&gt;. The available
      &lt;PARAM&gt; is &quot;sct-dir=&lt;DIR&gt;&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    &quot;sct-dir=&lt;DIR&gt;&quot; specifies the path to directory which
      contains *.sct files for TLS signed_certificate_timestamp extension (RFC
      6962). This feature requires OpenSSL &gt;= 1.0.2. See also
      <i>--tls-sct-dir</i> option.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dh-param-file=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Path to file that contains DH parameters in PEM format.
      Without this option, DHE cipher suites are not available.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--npn-list=&lt;LIST&gt;</b></dt>
  <dd class="It-tag">Comma delimited list of ALPN protocol identifier sorted in
      the order of preference. That means most desirable protocol comes first.
      This is used in both ALPN and NPN. The parameter must be delimited by a
      single comma only and any white spaces are treated as a part of protocol
      string.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>h2,h2-16,h2-14,http/1.1</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verify-client</b></dt>
  <dd class="It-tag">Require and verify client certificate.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verify-client-cacert=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Path to file that contains CA certificates to verify client
      certificate. The file must be in PEM format. It can contain multiple
      certificates.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--client-private-key-file=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Path to file that contains client private key used in
      backend client authentication.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--client-cert-file=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Path to file that contains client certificate used in
      backend client authentication.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls-min-proto-version=&lt;VER&gt;</b></dt>
  <dd class="It-tag">Specify minimum SSL/TLS protocol. The name matching is done
      in case-insensitive manner. The versions between
      <i>--tls-min-proto-version</i> and <i>--tls-max-proto-version</i> are
      enabled. If the protocol list advertised by client does not overlap this
      range, you will receive the error message &quot;unknown protocol&quot;.
      The available versions are: TLSv1.2, TLSv1.1, and TLSv1.0
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>TLSv1.1</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls-max-proto-version=&lt;VER&gt;</b></dt>
  <dd class="It-tag">Specify maximum SSL/TLS protocol. The name matching is done
      in case-insensitive manner. The versions between
      <i>--tls-min-proto-version</i> and <i>--tls-max-proto-version</i> are
      enabled. If the protocol list advertised by client does not overlap this
      range, you will receive the error message &quot;unknown protocol&quot;.
      The available versions are: TLSv1.2, TLSv1.1, and TLSv1.0
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>TLSv1.2</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls-ticket-key-file=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Path to file that contains random data to construct TLS
      session ticket parameters. If aes-128-cbc is given in
      <i>--tls-ticket-key-cipher</i>, the file must contain exactly 48 bytes. If
      aes-256-cbc is given in <i>--tls-ticket-key-cipher</i>, the file must
      contain exactly 80 bytes. This options can be used repeatedly to specify
      multiple ticket parameters. If several files are given, only the first key
      is used to encrypt TLS session tickets. Other keys are accepted but server
      will issue new session ticket with first key. This allows session key
      rotation. Please note that key rotation does not occur automatically. User
      should rearrange files or change options values and restart nghttpx
      gracefully. If opening or reading given file fails, all loaded keys are
      discarded and it is treated as if none of this option is given. If this
      option is not given or an error occurred while opening or reading a file,
      key is generated every 1 hour internally and they are valid for 12 hours.
      This is recommended if ticket key sharing between nghttpx instances is not
      required.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls-ticket-key-memcached=&lt;HOST&gt;,&lt;PORT&gt;[;tls]</b></dt>
  <dd class="It-tag">Specify address of memcached server to get TLS ticket keys
      for session resumption. This enables shared TLS ticket key between
      multiple nghttpx instances. nghttpx does not set TLS ticket key to
      memcached. The external ticket key generator is required. nghttpx just
      gets TLS ticket keys from memcached, and use them, possibly replacing
      current set of keys. It is up to extern TLS ticket key generator to rotate
      keys frequently. See &quot;TLS SESSION TICKET RESUMPTION&quot; section in
      manual page to know the data format in memcached entry. Optionally,
      memcached connection can be encrypted with TLS by specifying
      &quot;tls&quot; parameter.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls-ticket-key-memcached-address-family=(auto|IPv4|IPv6)</b></dt>
  <dd class="It-tag">Specify address family of memcached connections to get TLS
      ticket keys. If &quot;auto&quot; is given, both IPv4 and IPv6 are
      considered. If &quot;IPv4&quot; is given, only IPv4 address is considered.
      If &quot;IPv6&quot; is given, only IPv6 address is considered.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>auto</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls-ticket-key-memcached-interval=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">Set interval to get TLS ticket keys from memcached.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>10m</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls-ticket-key-memcached-max-retry=&lt;N&gt;</b></dt>
  <dd class="It-tag">Set maximum number of consecutive retries before abandoning
      TLS ticket key retrieval. If this number is reached, the attempt is
      considered as failure, and &quot;failure&quot; count is incremented by 1,
      which contributed to the value controlled
      <i>--tls-ticket-key-memcached-max-fail</i> option.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>3</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls-ticket-key-memcached-max-fail=&lt;N&gt;</b></dt>
  <dd class="It-tag">Set maximum number of consecutive failure before disabling
      TLS ticket until next scheduled key retrieval.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>2</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls-ticket-key-cipher=&lt;CIPHER&gt;</b></dt>
  <dd class="It-tag">Specify cipher to encrypt TLS session ticket. Specify
      either aes-128-cbc or aes-256-cbc. By default, aes-128-cbc is used.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls-ticket-key-memcached-cert-file=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Path to client certificate for memcached connections to get
      TLS ticket keys.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls-ticket-key-memcached-private-key-file=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Path to client private key for memcached connections to get
      TLS ticket keys.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--fetch-ocsp-response-file=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Path to fetch-ocsp-response script file. It should be
      absolute path.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>/usr/local/share/nghttp2/fetch-ocsp-response</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ocsp-update-interval=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">Set interval to update OCSP response cache.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>4h</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--no-ocsp</b></dt>
  <dd class="It-tag">Disable OCSP stapling.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls-session-cache-memcached=&lt;HOST&gt;,&lt;PORT&gt;[;tls]</b></dt>
  <dd class="It-tag">Specify address of memcached server to store session cache.
      This enables shared session cache between multiple nghttpx instances.
      Optionally, memcached connection can be encrypted with TLS by specifying
      &quot;tls&quot; parameter.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls-session-cache-memcached-address-family=(auto|IPv4|IPv6)</b></dt>
  <dd class="It-tag">Specify address family of memcached connections to store
      session cache. If &quot;auto&quot; is given, both IPv4 and IPv6 are
      considered. If &quot;IPv4&quot; is given, only IPv4 address is considered.
      If &quot;IPv6&quot; is given, only IPv6 address is considered.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>auto</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls-session-cache-memcached-cert-file=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Path to client certificate for memcached connections to
      store session cache.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls-session-cache-memcached-private-key-file=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Path to client private key for memcached connections to
      store session cache.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls-dyn-rec-warmup-threshold=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Specify the threshold size for TLS dynamic record size
      behaviour. During a TLS session, after the threshold number of bytes have
      been written, the TLS record size will be increased to the maximum allowed
      (16K). The max record size will continue to be used on the active TLS
      session. After <i>--tls-dyn-rec-idle-timeout</i> has elapsed, the record
      size is reduced to 1300 bytes. Specify 0 to always use the maximum record
      size, regardless of idle period. This behaviour applies to all TLS based
      frontends, and TLS HTTP/2 backends.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>1M</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls-dyn-rec-idle-timeout=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">Specify TLS dynamic record size behaviour timeout. See
      <i>--tls-dyn-rec-warmup-threshold</i> for more information. This behaviour
      applies to all TLS based frontends, and TLS HTTP/2 backends.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>1s</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--no-http2-cipher-black-list</b></dt>
  <dd class="It-tag">Allow black listed cipher suite on frontend HTTP/2
      connection. See <i>https://tools.ietf.org/html/rfc7540#appendix-A</i> for
      the complete HTTP/2 cipher suites black list.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--client-no-http2-cipher-black-list</b></dt>
  <dd class="It-tag">Allow black listed cipher suite on backend HTTP/2
      connection. See <i>https://tools.ietf.org/html/rfc7540#appendix-A</i> for
      the complete HTTP/2 cipher suites black list.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls-sct-dir=&lt;DIR&gt;</b></dt>
  <dd class="It-tag">Specifies the directory where *.sct files exist. All *.sct
      files in &lt;DIR&gt; are read, and sent as extension_data of TLS
      signed_certificate_timestamp (RFC 6962) to client. These *.sct files are
      for the certificate specified in positional command-line argument
      &lt;CERT&gt;, or certificate option in configuration file. For additional
      certificates, use <i>--subcert</i> option. This option requires OpenSSL
      &gt;= 1.0.2.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--psk-secrets=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Read list of PSK identity and secrets from &lt;PATH&gt;.
      This is used for frontend connection. The each line of input file is
      formatted as &lt;identity&gt;:&lt;hex-secret&gt;, where &lt;identity&gt;
      is PSK identity, and &lt;hex-secret&gt; is secret in hex. An empty line,
      and line which starts with '#' are skipped. The default enabled cipher
      list might not contain any PSK cipher suite. In that case, desired PSK
      cipher suites must be enabled using <i>--ciphers</i> option. The desired
      PSK cipher suite may be black listed by HTTP/2. To use those cipher suites
      with HTTP/2, consider to use <i>--no-http2-cipher-black-list</i> option.
      But be aware its implications.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--client-psk-secrets=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Read PSK identity and secrets from &lt;PATH&gt;. This is
      used for backend connection. The each line of input file is formatted as
      &lt;identity&gt;:&lt;hex-secret&gt;, where &lt;identity&gt; is PSK
      identity, and &lt;hex-secret&gt; is secret in hex. An empty line, and line
      which starts with '#' are skipped. The first identity and secret pair
      encountered is used. The default enabled cipher list might not contain any
      PSK cipher suite. In that case, desired PSK cipher suites must be enabled
      using <i>--client-ciphers</i> option. The desired PSK cipher suite may be
      black listed by HTTP/2. To use those cipher suites with HTTP/2, consider
      to use <i>--client-no-http2-cipher-black-list</i> option. But be aware its
      implications.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="HTTP/2_and_SPDY"><a class="selflink" href="#HTTP/2_and_SPDY">HTTP/2
  and SPDY</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c,
    --frontend-http2-max-concurrent-streams=&lt;N&gt;</b></dt>
  <dd class="It-tag">Set the maximum number of the concurrent streams in one
      frontend HTTP/2 and SPDY session.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: `` 100``</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--backend-http2-max-concurrent-streams=&lt;N&gt;</b></dt>
  <dd class="It-tag">Set the maximum number of the concurrent streams in one
      backend HTTP/2 session. This sets maximum number of concurrent opened
      pushed streams. The maximum number of concurrent requests are set by a
      remote server.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>100</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--frontend-http2-window-size=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Sets the per-stream initial window size of HTTP/2 and SPDY
      frontend connection.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>65535</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--frontend-http2-connection-window-size=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Sets the per-connection window size of HTTP/2 and SPDY
      frontend connection. For SPDY connection, the value less than 64KiB is
      rounded up to 64KiB.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>65535</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--backend-http2-window-size=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Sets the initial window size of HTTP/2 backend connection.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>65535</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--backend-http2-connection-window-size=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Sets the per-connection window size of HTTP/2 backend
      connection.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>2147483647</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--http2-no-cookie-crumbling</b></dt>
  <dd class="It-tag">Don't crumble cookie header field.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--padding=&lt;N&gt;</b></dt>
  <dd class="It-tag">Add at most &lt;N&gt; bytes to a HTTP/2 frame payload as
      padding. Specify 0 to disable padding. This option is meant for debugging
      purpose and not intended to enhance protocol security.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--no-server-push</b></dt>
  <dd class="It-tag">Disable HTTP/2 server push. Server push is supported by
      default mode and HTTP/2 frontend via Link header field. It is also
      supported if both frontend and backend are HTTP/2 in default mode. In this
      case, server push from backend session is relayed to frontend, and server
      push via Link header field is also supported. SPDY frontend does not
      support server push.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--frontend-http2-optimize-write-buffer-size</b></dt>
  <dd class="It-tag">(Experimental) Enable write buffer size optimization in
      frontend HTTP/2 TLS connection. This optimization aims to reduce write
      buffer size so that it only contains bytes which can send immediately.
      This makes server more responsive to prioritized HTTP/2 stream because the
      buffering of lower priority stream is reduced. This option is only
      effective on recent Linux platform.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--frontend-http2-optimize-window-size</b></dt>
  <dd class="It-tag">(Experimental) Automatically tune connection level window
      size of frontend HTTP/2 TLS connection. If this feature is enabled,
      connection window size starts with the default window size, 65535 bytes.
      nghttpx automatically adjusts connection window size based on TCP
      receiving window size. The maximum window size is capped by the value
      specified by <i>--frontend-http2-connection-window-size</i>. Since the
      stream is subject to stream level window size, it should be adjusted using
      <i>--frontend-http2-window-size</i> option as well. This option is only
      effective on recent Linux platform.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--frontend-http2-encoder-dynamic-table-size=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Specify the maximum dynamic table size of HPACK encoder in
      the frontend HTTP/2 connection. The decoder (client) specifies the maximum
      dynamic table size it accepts. Then the negotiated dynamic table size is
      the minimum of this option value and the value which client specified.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>4K</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--frontend-http2-decoder-dynamic-table-size=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Specify the maximum dynamic table size of HPACK decoder in
      the frontend HTTP/2 connection.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>4K</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--backend-http2-encoder-dynamic-table-size=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Specify the maximum dynamic table size of HPACK encoder in
      the backend HTTP/2 connection. The decoder (backend) specifies the maximum
      dynamic table size it accepts. Then the negotiated dynamic table size is
      the minimum of this option value and the value which backend specified.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>4K</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--backend-http2-decoder-dynamic-table-size=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Specify the maximum dynamic table size of HPACK decoder in
      the backend HTTP/2 connection.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>4K</b></dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Mode"><a class="selflink" href="#Mode">Mode</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>(default mode)</b></dt>
  <dd class="It-tag">Accept HTTP/2, SPDY and HTTP/1.1 over SSL/TLS.
      &quot;no-tls&quot; parameter is used in <i>--frontend</i> option, accept
      HTTP/2 and HTTP/1.1 over cleartext TCP. The incoming HTTP/1.1 connection
      can be upgraded to HTTP/2 through HTTP Upgrade.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s, --http2-proxy</b></dt>
  <dd class="It-tag">Like default mode, but enable forward proxy. This is so
      called HTTP/2 proxy mode.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Logging"><a class="selflink" href="#Logging">Logging</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-L, --log-level=&lt;LEVEL&gt;</b></dt>
  <dd class="It-tag">Set the severity level of log output. &lt;LEVEL&gt; must be
      one of INFO, NOTICE, WARN, ERROR and FATAL.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>NOTICE</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--accesslog-file=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Set path to write access log. To reopen file, send USR1
      signal to nghttpx.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--accesslog-syslog</b></dt>
  <dd class="It-tag">Send access log to syslog. If this option is used,
      <i>--accesslog-file</i> option is ignored.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--accesslog-format=&lt;FORMAT&gt;</b></dt>
  <dd class="It-tag">Specify format string for access log. The default format is
      combined format. The following variables are available:</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$remote_addr: client IP address.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$time_local: local time in Common Log format.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$time_iso8601: local time in ISO 8601 format.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$request: HTTP request line.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$status: HTTP response status code.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$body_bytes_sent: the number of bytes sent to client as
      response body.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$http_&lt;VAR&gt;: value of HTTP request header &lt;VAR&gt;
      where '_' in &lt;VAR&gt; is replaced with '-'.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$remote_port: client port.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$server_port: server port.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$request_time: request processing time in seconds with
      milliseconds resolution.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$pid: PID of the running process.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$alpn: ALPN identifier of the protocol which generates the
      response. For HTTP/1, ALPN is always http/1.1, regardless of minor
      version.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$ssl_cipher: cipher used for SSL/TLS connection.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$ssl_protocol: protocol for SSL/TLS connection.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$ssl_session_id: session ID for SSL/TLS connection.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$ssl_session_reused: &quot;r&quot; if SSL/TLS session was
      reused. Otherwise, &quot;.&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$backend_host: backend host used to fulfill the request.
      &quot;-&quot; if backend host is not available.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$backend_port: backend port used to fulfill the request.
      &quot;-&quot; if backend host is not available.</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The variable can be enclosed by &quot;{&quot; and &quot;}&quot; for
  disambiguation (e.g., ${remote_addr}).
<div style="height: 1.00em;">&#x00A0;</div>
Default: <b>$remote_addr - - [$time_local] &quot;$request&quot; $status
  $body_bytes_sent &quot;$http_referer&quot;
  &quot;$http_user_agent&quot;</b></div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--accesslog-write-early</b></dt>
  <dd class="It-tag">Write access log when response header fields are received
      from backend rather than when request transaction finishes.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--errorlog-file=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Set path to write error log. To reopen file, send USR1
      signal to nghttpx. stderr will be redirected to the error log file unless
      <i>--errorlog-syslog</i> is used.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>/dev/stderr</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--errorlog-syslog</b></dt>
  <dd class="It-tag">Send error log to syslog. If this option is used,
      <i>--errorlog-file</i> option is ignored.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--syslog-facility=&lt;FACILITY&gt;</b></dt>
  <dd class="It-tag">Set syslog facility to &lt;FACILITY&gt;.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>daemon</b></dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="HTTP"><a class="selflink" href="#HTTP">HTTP</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--add-x-forwarded-for</b></dt>
  <dd class="It-tag">Append X-Forwarded-For header field to the downstream
      request.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--strip-incoming-x-forwarded-for</b></dt>
  <dd class="It-tag">Strip X-Forwarded-For header field from inbound client
      requests.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--add-forwarded=&lt;LIST&gt;</b></dt>
  <dd class="It-tag">Append RFC 7239 Forwarded header field with parameters
      specified in comma delimited list &lt;LIST&gt;. The supported parameters
      are &quot;by&quot;, &quot;for&quot;, &quot;host&quot;, and
      &quot;proto&quot;. By default, the value of &quot;by&quot; and
      &quot;for&quot; parameters are obfuscated string. See
      <i>--forwarded-by</i> and <i>--forwarded-for</i> options respectively.
      Note that nghttpx does not translate non-standard X-Forwarded-* header
      fields into Forwarded header field, and vice versa.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--strip-incoming-forwarded</b></dt>
  <dd class="It-tag">Strip Forwarded header field from inbound client
    requests.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--forwarded-by=(obfuscated|ip|&lt;VALUE&gt;)</b></dt>
  <dd class="It-tag">Specify the parameter value sent out with &quot;by&quot;
      parameter of Forwarded header field. If &quot;obfuscated&quot; is given,
      the string is randomly generated at startup. If &quot;ip&quot; is given,
      the interface address of the connection, including port number, is sent
      with &quot;by&quot; parameter. In case of UNIX domain socket,
      &quot;localhost&quot; is used instead of address and port. User can also
      specify the static obfuscated string. The limitation is that it must start
      with &quot;_&quot;, and only consists of character set [A-Za-z0-9._-], as
      described in RFC 7239.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>obfuscated</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--forwarded-for=(obfuscated|ip)</b></dt>
  <dd class="It-tag">Specify the parameter value sent out with &quot;for&quot;
      parameter of Forwarded header field. If &quot;obfuscated&quot; is given,
      the string is randomly generated for each client connection. If
      &quot;ip&quot; is given, the remote client address of the connection,
      without port number, is sent with &quot;for&quot; parameter. In case of
      UNIX domain socket, &quot;localhost&quot; is used instead of address.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>obfuscated</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--no-via</b></dt>
  <dd class="It-tag">Don't append to Via header field. If Via header field is
      received, it is left unaltered.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--no-location-rewrite</b></dt>
  <dd class="It-tag">Don't rewrite location header field in default mode. When
      <i>--http2-proxy</i> is used, location header field will not be altered
      regardless of this option.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--host-rewrite</b></dt>
  <dd class="It-tag">Rewrite host and :authority header fields in default mode.
      When <i>--http2-proxy</i> is used, these headers will not be altered
      regardless of this option.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--altsvc=&lt;PROTOID,PORT[,HOST,[ORIGIN]]&gt;</b></dt>
  <dd class="It-tag">Specify protocol ID, port, host and origin of alternative
      service. &lt;HOST&gt; and &lt;ORIGIN&gt; are optional. They are advertised
      in alt-svc header field only in HTTP/1.1 frontend. This option can be used
      multiple times to specify multiple alternative services. Example:
      <i>--altsvc</i>=h2,443</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--add-request-header=&lt;HEADER&gt;</b></dt>
  <dd class="It-tag">Specify additional header field to add to request header
      set. This option just appends header field and won't replace anything
      already set. This option can be used several times to specify multiple
      header fields. Example: <i>--add-request-header</i>=&quot;foo:
    bar&quot;</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--add-response-header=&lt;HEADER&gt;</b></dt>
  <dd class="It-tag">Specify additional header field to add to response header
      set. This option just appends header field and won't replace anything
      already set. This option can be used several times to specify multiple
      header fields. Example: <i>--add-response-header</i>=&quot;foo:
    bar&quot;</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--request-header-field-buffer=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Set maximum buffer size for incoming HTTP request header
      field list. This is the sum of header name and value in bytes. If trailer
      fields exist, they are counted towards this number.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>64K</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--max-request-header-fields=&lt;N&gt;</b></dt>
  <dd class="It-tag">Set maximum number of incoming HTTP request header fields.
      If trailer fields exist, they are counted towards this number.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>100</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--response-header-field-buffer=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Set maximum buffer size for incoming HTTP response header
      field list. This is the sum of header name and value in bytes. If trailer
      fields exist, they are counted towards this number.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>64K</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--max-response-header-fields=&lt;N&gt;</b></dt>
  <dd class="It-tag">Set maximum number of incoming HTTP response header fields.
      If trailer fields exist, they are counted towards this number.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>500</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--error-page=(&lt;CODE&gt;|*)=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Set file path to custom error page served when nghttpx
      originally generates HTTP error status code &lt;CODE&gt;. &lt;CODE&gt;
      must be greater than or equal to 400, and at most 599. If &quot;*&quot; is
      used instead of &lt;CODE&gt;, it matches all HTTP status code. If error
      status code comes from backend server, the custom error pages are not
      used.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--server-name=&lt;NAME&gt;</b></dt>
  <dd class="It-tag">Change server response header field value to &lt;NAME&gt;.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>nghttpx</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--no-server-rewrite</b></dt>
  <dd class="It-tag">Don't rewrite server header field in default mode. When
      <i>--http2-proxy</i> is used, these headers will not be altered regardless
      of this option.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--redirect-https-port=&lt;PORT&gt;</b></dt>
  <dd class="It-tag">Specify the port number which appears in Location header
      field when redirect to HTTPS URI is made due to
      &quot;redirect-if-not-tls&quot; parameter in <i>--backend</i> option.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>443</b></dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="API"><a class="selflink" href="#API">API</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--api-max-request-body=&lt;SIZE&gt;</b></dt>
  <dd class="It-tag">Set the maximum size of request body for API request.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>16K</b></dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="DNS"><a class="selflink" href="#DNS">DNS</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dns-cache-timeout=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">Set duration that cached DNS results remain valid. Note
      that nghttpx caches the unsuccessful results as well.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>10s</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dns-lookup-timeout=&lt;DURATION&gt;</b></dt>
  <dd class="It-tag">Set timeout that DNS server is given to respond to the
      initial DNS query. For the 2nd and later queries, server is given time
      based on this timeout, and it is scaled linearly.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>5s</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dns-max-try=&lt;N&gt;</b></dt>
  <dd class="It-tag">Set the number of DNS query before nghttpx gives up name
      lookup.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>2</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--frontend-max-requests=&lt;N&gt;</b></dt>
  <dd class="It-tag">The number of requests that single frontend connection can
      process. For HTTP/2, this is the number of streams in one HTTP/2
      connection. For HTTP/1, this is the number of keep alive requests. This is
      hint to nghttpx, and it may allow additional few requests. The default
      value is unlimited.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Debug"><a class="selflink" href="#Debug">Debug</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--frontend-http2-dump-request-header=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Dumps request headers received by HTTP/2 frontend to the
      file denoted in &lt;PATH&gt;. The output is done in HTTP/1 header field
      format and each header block is followed by an empty line. This option is
      not thread safe and MUST NOT be used with option <i>-n</i>&lt;N&gt;, where
      &lt;N&gt; &gt;= 2.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--frontend-http2-dump-response-header=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Dumps response headers sent from HTTP/2 frontend to the
      file denoted in &lt;PATH&gt;. The output is done in HTTP/1 header field
      format and each header block is followed by an empty line. This option is
      not thread safe and MUST NOT be used with option <i>-n</i>&lt;N&gt;, where
      &lt;N&gt; &gt;= 2.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-o, --frontend-frame-debug</b></dt>
  <dd class="It-tag">Print HTTP/2 frames in frontend to stderr. This option is
      not thread safe and MUST NOT be used with option <i>-n</i>=N, where N
      &gt;= 2.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Process"><a class="selflink" href="#Process">Process</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-D, --daemon</b></dt>
  <dd class="It-tag">Run in a background. If <i>-D</i> is used, the current
      working directory is changed to ' <i>/</i>'.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--pid-file=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Set path to save PID of this program.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--user=&lt;USER&gt;</b></dt>
  <dd class="It-tag">Run this program as &lt;USER&gt;. This option is intended
      to be used to drop root privileges.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Scripting"><a class="selflink" href="#Scripting">Scripting</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--mruby-file=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Set mruby script file</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Misc"><a class="selflink" href="#Misc">Misc</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--conf=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Load configuration from &lt;PATH&gt;.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default: <b>/etc/nghttpx/nghttpx.conf</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--include=&lt;PATH&gt;</b></dt>
  <dd class="It-tag">Load additional configurations from &lt;PATH&gt;. File
      &lt;PATH&gt; is read when configuration parser encountered this option.
      This option can be used multiple times, or even recursively.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v, --version</b></dt>
  <dd class="It-tag">Print version and exit.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h, --help</b></dt>
  <dd class="It-tag">Print this help and exit.</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The &lt;SIZE&gt; argument is an integer and an optional unit (e.g., 10K is 10 *
  1024). Units are K, M and G (powers of 1024).
<div style="height: 1.00em;">&#x00A0;</div>
The &lt;DURATION&gt; argument is an integer and an optional unit (e.g., 1s is 1
  second and 500ms is 500 milliseconds). Units are h, m, s or ms (hours,
  minutes, seconds and milliseconds, respectively). If a unit is omitted, a
  second is used as unit.
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><i>/etc/nghttpx/nghttpx.conf</i></b></dt>
  <dd class="It-tag">The default configuration file path nghttpx searches at
      startup. The configuration file path can be changed using <i>--conf</i>
      option.
    <div style="height: 1.00em;">&#x00A0;</div>
    Those lines which are staring <b>#</b> are treated as comment.
    <div style="height: 1.00em;">&#x00A0;</div>
    The option name in the configuration file is the long command-line option
      name with leading <b>--</b> stripped (e.g., <b>frontend</b>). Put <b>=</b>
      between option name and value. Don't put extra leading or trailing spaces.
    <div style="height: 1.00em;">&#x00A0;</div>
    When specifying arguments including characters which have special meaning to
      a shell, we usually use quotes so that shell does not interpret them. When
      writing this configuration file, quotes for this purpose must not be used.
      For example, specify additional request header field, do this:</dd>
</dl>
<div style="margin-left: 7.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
add-request-header=foo: bar
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
instead of:
<div style="margin-left: 7.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
add-request-header=&quot;foo: bar&quot;
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The options which do not take argument in the command-line <i>take</i> argument
  in the configuration file. Specify <b>yes</b> as an argument (e.g.,
  <b>http2-proxy=yes</b>). If other string is given, it is ignored.
<div style="height: 1.00em;">&#x00A0;</div>
To specify private key and certificate file which are given as positional
  arguments in command-line, use <b>private-key-file</b> and
  <b>certificate-file</b>.
<div style="height: 1.00em;">&#x00A0;</div>
<i>--conf</i> option cannot be used in the configuration file and will be
  ignored if specified.
<dl class="Bl-tag">
  <dt class="It-tag"><b>Error log</b></dt>
  <dd class="It-tag">Error log is written to stderr by default. It can be
      configured using <i>--errorlog-file</i>. The format of log message is as
      follows:
    <div style="height: 1.00em;">&#x00A0;</div>
    &lt;datetime&gt; &lt;master-pid&gt; &lt;current-pid&gt; &lt;thread-id&gt;
      &lt;level&gt; (&lt;filename&gt;:&lt;line&gt;) &lt;msg&gt;</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>&lt;datetime&gt;</b></dt>
  <dd class="It-tag">It is a conbination of date and time when the log is
      written. It is in ISO 8601 format.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>&lt;master-pid&gt;</b></dt>
  <dd class="It-tag">It is a master process ID.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>&lt;current-pid&gt;</b></dt>
  <dd class="It-tag">It is a process ID which writes this log.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>&lt;thread-id&gt;</b></dt>
  <dd class="It-tag">It is a thread ID which writes this log. It would be unique
      within &lt;current-pid&gt;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>&lt;filename&gt; and &lt;line&gt;</b></dt>
  <dd class="It-tag">They are source file name, and line number which produce
      this log.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>&lt;msg&gt;</b></dt>
  <dd class="It-tag">It is a log message body.</dd>
</dl>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="SIGNALS"><a class="selflink" href="#SIGNALS">SIGNALS</a></h1>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>SIGQUIT</b></dt>
  <dd class="It-tag">Shutdown gracefully. First accept pending connections and
      stop accepting connection. After all connections are handled, nghttpx
      exits.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SIGHUP</b></dt>
  <dd class="It-tag">Reload configuration file given in <i>--conf</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SIGUSR1</b></dt>
  <dd class="It-tag">Reopen log files.</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
SIGUSR2
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">Fork and execute nghttpx. It will execute the
  binary in the same path with same command-line arguments and environment
  variables. As of nghttpx version 1.20.0, the new master process sends SIGQUIT
  to the original master process when it is ready to serve requests. For the
  earlier versions of nghttpx, user has to send SIGQUIT to the original master
  process.
<div style="height: 1.00em;">&#x00A0;</div>
The difference between SIGUSR2 (+ SIGQUIT) and SIGHUP is that former is usually
  used to execute new binary, and the master process is newly spawned. On the
  other hand, the latter just reloads configuration file, and the same master
  process continues to exist.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<b>NOTE:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">nghttpx consists of multiple processes: one
  process for processing these signals, and another one for processing requests.
  The former spawns the latter. The former is called master process, and the
  latter is called worker process. If neverbleed is enabled, the worker process
  spawns neverbleed daemon process which does RSA key processing. The above
  signal must be sent to the master process. If the other processes received one
  of them, it is ignored. This behaviour of these processes may change in the
  future release. In other words, in the future release, the processes other
  than master process may terminate upon the reception of these signals.
  Therefore these signals should not be sent to the processes other than master
  process.</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="SERVER_PUSH"><a class="selflink" href="#SERVER_PUSH">SERVER
  PUSH</a></h1>
nghttpx supports HTTP/2 server push in default mode with Link header field.
  nghttpx looks for Link header field ( <i>RFC 5988</i>) in response headers
  from backend server and extracts URI-reference with parameter
  <b>rel=preload</b> (see <i>preload</i>) and pushes those URIs to the frontend
  client. Here is a sample Link header field to initiate server push:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
Link: &lt;/fonts/font.woff&gt;; rel=preload
Link: &lt;/css/theme.css&gt;; rel=preload
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Currently, the following restriction is applied for server push:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">1.</dt>
  <dd class="It-tag">The associated stream must have method &quot;GET&quot; or
      &quot;POST&quot;. The associated stream's status code must be 200.</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
This limitation may be loosened in the future release.
<div style="height: 1.00em;">&#x00A0;</div>
nghttpx also supports server push if both frontend and backend are HTTP/2 in
  default mode. In this case, in addition to server push via Link header field,
  server push from backend is forwarded to frontend HTTP/2 session.
<div style="height: 1.00em;">&#x00A0;</div>
HTTP/2 server push will be disabled if <i>--http2-proxy</i> is used.
<h1 class="Sh" title="Sh" id="UNIX_DOMAIN_SOCKET"><a class="selflink" href="#UNIX_DOMAIN_SOCKET">UNIX
  DOMAIN SOCKET</a></h1>
nghttpx supports UNIX domain socket with a filename for both frontend and
  backend connections.
<div style="height: 1.00em;">&#x00A0;</div>
Please note that current nghttpx implementation does not delete a socket with a
  filename. And on start up, if nghttpx detects that the specified socket
  already exists in the file system, nghttpx first deletes it. However, if
  SIGUSR2 is used to execute new binary and both old and new configurations use
  same filename, new binary does not delete the socket and continues to use it.
<h1 class="Sh" title="Sh" id="OCSP_STAPLING"><a class="selflink" href="#OCSP_STAPLING">OCSP
  STAPLING</a></h1>
OCSP query is done using external Python script <b>fetch-ocsp-response</b>,
  which has been originally developed in Perl as part of h2o project (
  <i>https://github.com/h2o/h2o</i>), and was translated into Python.
<div style="height: 1.00em;">&#x00A0;</div>
The script file is usually installed under <b>$(prefix)/share/nghttp2/</b>
  directory. The actual path to script can be customized using
  <i>--fetch-ocsp-response-file</i> option.
<div style="height: 1.00em;">&#x00A0;</div>
If OCSP query is failed, previous OCSP response, if any, is continued to be
  used.
<h1 class="Sh" title="Sh" id="TLS_SESSION_RESUMPTION"><a class="selflink" href="#TLS_SESSION_RESUMPTION">TLS
  SESSION RESUMPTION</a></h1>
nghttpx supports TLS session resumption through both session ID and session
  ticket.
<h2 class="Ss" title="Ss" id="SESSION_ID_RESUMPTION"><a class="selflink" href="#SESSION_ID_RESUMPTION">SESSION
  ID RESUMPTION</a></h2>
By default, session ID is shared by all worker threads.
<div style="height: 1.00em;">&#x00A0;</div>
If <i>--tls-session-cache-memcached</i> is given, nghttpx will insert serialized
  session data to memcached with <b>nghttpx:tls-session-cache:</b> + lowercased
  hex string of session ID as a memcached entry key, with expiry time 12 hours.
  Session timeout is set to 12 hours.
<div style="height: 1.00em;">&#x00A0;</div>
By default, connections to memcached server are not encrypted. To enable
  encryption, use <b>tls</b> keyword in <i>--tls-session-cache-memcached</i>
  option.
<h2 class="Ss" title="Ss" id="TLS_SESSION_TICKET_RESUMPTION"><a class="selflink" href="#TLS_SESSION_TICKET_RESUMPTION">TLS
  SESSION TICKET RESUMPTION</a></h2>
By default, session ticket is shared by all worker threads. The automatic key
  rotation is also enabled by default. Every an hour, new encryption key is
  generated, and previous encryption key becomes decryption only key. We set
  session timeout to 12 hours, and thus we keep at most 12 keys.
<div style="height: 1.00em;">&#x00A0;</div>
If <i>--tls-ticket-key-memcached</i> is given, encryption keys are retrieved
  from memcached. nghttpx just reads keys from memcached; one has to deploy key
  generator program to update keys frequently (e.g., every 1 hour). The example
  key generator tlsticketupdate.go is available under contrib directory in
  nghttp2 archive. The memcached entry key is <b>nghttpx:tls-ticket-key</b>. The
  data format stored in memcached is the binary format described below:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
+--------------+-------+----------------+
| VERSION (4)  |LEN (2)|KEY(48 or 80) ...
+--------------+-------+----------------+
               ^                        |
               |                        |
               +------------------------+
               (LEN, KEY) pair can be repeated
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
All numbers in the above figure is bytes. All integer fields are network byte
  order.
<div style="height: 1.00em;">&#x00A0;</div>
First 4 bytes integer VERSION field, which must be 1. The 2 bytes integer LEN
  field gives the length of following KEY field, which contains key. If
  <i>--tls-ticket-key-cipher</i>=aes-128-cbc is used, LEN must be 48. If
  <i>--tls-ticket-key-cipher</i>=aes-256-cbc is used, LEN must be 80. LEN and
  KEY pair can be repeated multiple times to store multiple keys. The key
  appeared first is used as encryption key. All the remaining keys are used as
  decryption only.
<div style="height: 1.00em;">&#x00A0;</div>
By default, connections to memcached server are not encrypted. To enable
  encryption, use <b>tls</b> keyword in <i>--tls-ticket-key-memcached</i>
  option.
<div style="height: 1.00em;">&#x00A0;</div>
If <i>--tls-ticket-key-file</i> is given, encryption key is read from the given
  file. In this case, nghttpx does not rotate key automatically. To rotate key,
  one has to restart nghttpx (see SIGNALS).
<h1 class="Sh" title="Sh" id="CERTIFICATE_TRANSPARENCY"><a class="selflink" href="#CERTIFICATE_TRANSPARENCY">CERTIFICATE
  TRANSPARENCY</a></h1>
nghttpx supports TLS <b>signed_certificate_timestamp</b> extension (<i>RFC</i>
  <i>6962</i>). The relevant options are <i>--tls-sct-dir</i> and <b>sct-dir</b>
  parameter in <i>--subcert</i>. They takes a directory, and nghttpx reads all
  files whose extension is <b>.sct</b> under the directory. The <b>*.sct</b>
  files are encoded as <b>SignedCertificateTimestamp</b> struct described in
  <i>section 3.2 of RFC 69662</i>. This format is the same one used by
  <i>nginx-ct</i> and <i>mod_ssl_ct</i>. <i>ct-submit</i> can be used to submit
  certificates to log servers, and obtain the <b>SignedCertificateTimestamp</b>
  struct which can be used with nghttpx.
<h1 class="Sh" title="Sh" id="MRUBY_SCRIPTING"><a class="selflink" href="#MRUBY_SCRIPTING">MRUBY
  SCRIPTING</a></h1>
<b>WARNING:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The current mruby extension API is
  experimental and not frozen. The API is subject to change in the future
  release.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
nghttpx allows users to extend its capability using mruby scripts. nghttpx has 2
  hook points to execute mruby script: request phase and response phase. The
  request phase hook is invoked after all request header fields are received
  from client. The response phase hook is invoked after all response header
  fields are received from backend server. These hooks allows users to modify
  header fields, or common HTTP variables, like authority or request path, and
  even return custom response without forwarding request to backend servers.
<div style="height: 1.00em;">&#x00A0;</div>
To specify mruby script file, use <i>--mruby-file</i> option. The script will be
  evaluated once per thread on startup, and it must instantiate object and
  evaluate it as the return value (e.g., <b>App.new</b>). This object is called
  app object. If app object defines <b>on_req</b> method, it is called with
  <i>Nghttpx::Env</i> object on request hook. Similarly, if app object defines
  <b>on_resp</b> method, it is called with <i>Nghttpx::Env</i> object on
  response hook. For each method invocation, user can can access
  <i>Nghttpx::Request</i> and <i>Nghttpx::Response</i> objects via
  <i>Nghttpx::Env#req</i> and <i>Nghttpx::Env#resp</i> respectively.
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>Nghttpx::REQUEST_PHASE</b></dt>
  <dd class="It-tag">Constant to represent request phase.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>Nghttpx::RESPONSE_PHASE</b></dt>
  <dd class="It-tag">Constant to represent response phase.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>class Nghttpx::Env</b></dt>
  <dd class="It-tag">Object to represent current request specific context.</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R] req</b></dt>
  <dd class="It-tag">Return <i>Request</i> object.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R] resp</b></dt>
  <dd class="It-tag">Return <i>Response</i> object.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R] ctx</b></dt>
  <dd class="It-tag">Return Ruby hash object. It persists until request
      finishes. So values set in request phase hoo can be retrieved in response
      phase hook.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R] phase</b></dt>
  <dd class="It-tag">Return the current phase.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R] remote_addr</b></dt>
  <dd class="It-tag">Return IP address of a remote client. If connection is made
      via UNIX domain socket, this returns the string
    &quot;localhost&quot;.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R] server_addr</b></dt>
  <dd class="It-tag">Return address of server that accepted the connection. This
      is a string which specified in <i>--frontend</i> option, excluding port
      number, and not a resolved IP address. For UNIX domain socket, this is a
      path to UNIX domain socket.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R] server_port</b></dt>
  <dd class="It-tag">Return port number of the server frontend which accepted
      the connection from client.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R] tls_used</b></dt>
  <dd class="It-tag">Return true if TLS is used on the connection.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R] tls_sni</b></dt>
  <dd class="It-tag">Return the TLS SNI value which client sent in this
      connection.</dd>
</dl>
</div>
<br/>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>class Nghttpx::Request</b></dt>
  <dd class="It-tag">Object to represent request from client. The modification
      to Request object is allowed only in request phase hook.</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R] http_version_major</b></dt>
  <dd class="It-tag">Return HTTP major version.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R] http_version_minor</b></dt>
  <dd class="It-tag">Return HTTP minor version.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R/W] method</b></dt>
  <dd class="It-tag">HTTP method. On assignment, copy of given value is
      assigned. We don't accept arbitrary method name. We will document them
      later, but well known methods, like GET, PUT and POST, are all
    supported.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R/W] authority</b></dt>
  <dd class="It-tag">Authority (i.e., example.org), including optional port
      component . On assignment, copy of given value is assigned.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R/W] scheme</b></dt>
  <dd class="It-tag">Scheme (i.e., http, https). On assignment, copy of given
      value is assigned.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R/W] path</b></dt>
  <dd class="It-tag">Request path, including query component (i.e.,
      /index.html). On assignment, copy of given value is assigned. The path
      does not include authority component of URI. This may include query
      component. nghttpx makes certain normalization for path. It decodes
      percent-encoding for unreserved characters (see
      <i>https://tools.ietf.org/html/rfc3986#section-2.3</i>), and resolves
      &quot;..&quot; and &quot;.&quot;. But it may leave characters which should
      be percent-encoded as is. So be careful when comparing path against
      desired string.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R] headers</b></dt>
  <dd class="It-tag">Return Ruby hash containing copy of request header fields.
      Changing values in returned hash does not change request header fields
      actually used in request processing. Use
      <i>Nghttpx::Request#add_header</i> or <i>Nghttpx::Request#set_header</i>
      to change request header fields.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>add_header(key, value)</b></dt>
  <dd class="It-tag">Add header entry associated with key. The value can be
      single string or array of string. It does not replace any existing values
      associated with key.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>set_header(key, value)</b></dt>
  <dd class="It-tag">Set header entry associated with key. The value can be
      single string or array of string. It replaces any existing values
      associated with key.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>clear_headers()</b></dt>
  <dd class="It-tag">Clear all existing request header fields.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>push(uri)</b></dt>
  <dd class="It-tag">Initiate to push resource identified by <i>uri</i>. Only
      HTTP/2 protocol supports this feature. For the other protocols, this
      method is noop. <i>uri</i> can be absolute URI, absolute path or relative
      path to the current request. For absolute or relative path, scheme and
      authority are inherited from the current request. Currently, method is
      always GET. nghttpx will issue request to backend servers to fulfill this
      request. The request and response phase hooks will be called for pushed
      resource as well.</dd>
</dl>
</div>
<br/>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>class Nghttpx::Response</b></dt>
  <dd class="It-tag">Object to represent response from backend server.</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R] http_version_major</b></dt>
  <dd class="It-tag">Return HTTP major version.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R] http_version_minor</b></dt>
  <dd class="It-tag">Return HTTP minor version.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R/W] status</b></dt>
  <dd class="It-tag">HTTP status code. It must be in the range [200, 999],
      inclusive. The non-final status code is not supported in mruby scripting
      at the moment.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>attribute [R] headers</b></dt>
  <dd class="It-tag">Return Ruby hash containing copy of response header fields.
      Changing values in returned hash does not change response header fields
      actually used in response processing. Use
      <i>Nghttpx::Response#add_header</i> or <i>Nghttpx::Response#set_header</i>
      to change response header fields.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>add_header(key, value)</b></dt>
  <dd class="It-tag">Add header entry associated with key. The value can be
      single string or array of string. It does not replace any existing values
      associated with key.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>set_header(key, value)</b></dt>
  <dd class="It-tag">Set header entry associated with key. The value can be
      single string or array of string. It replaces any existing values
      associated with key.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>clear_headers()</b></dt>
  <dd class="It-tag">Clear all existing response header fields.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>return(body)</b></dt>
  <dd class="It-tag">Return custom response <i>body</i> to a client. When this
      method is called in request phase hook, the request is not forwarded to
      the backend, and response phase hook for this request will not be invoked.
      When this method is called in response phase hook, response from backend
      server is canceled and discarded. The status code and response header
      fields should be set before using this method. To set status code, use
      :rb:meth To set response header fields, use
      <i>Nghttpx::Response#status</i>. If status code is not set, 200 is used.
      <i>Nghttpx::Response#add_header</i> and
      <i>Nghttpx::Response#set_header</i>. When this method is invoked in
      response phase hook, the response headers are filled with the ones
      received from backend server. To send completely custom header fields,
      first call <i>Nghttpx::Response#clear_headers</i> to erase all existing
      header fields, and then add required header fields. It is an error to call
      this method twice for a given request.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>send_info(status, headers)</b></dt>
  <dd class="It-tag">Send non-final (informational) response to a client.
      <i>status</i> must be in the range [100, 199], inclusive. <i>headers</i>
      is a hash containing response header fields. Its key must be a string, and
      the associated value must be either string or array of strings. Since this
      is not a final response, even if this method is invoked, request is still
      forwarded to a backend unless <i>Nghttpx::Response#return</i> is called.
      This method can be called multiple times. It cannot be called after
      <i>Nghttpx::Response#return</i> is called.</dd>
</dl>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="MRUBY_EXAMPLES"><a class="selflink" href="#MRUBY_EXAMPLES">MRUBY
  EXAMPLES</a></h2>
Modify request path:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
class App
  def on_req(env)
    env.req.path = &quot;/apps#{env.req.path}&quot;
  end
end
<div class="Pp"></div>
App.new
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Don't forget to instantiate and evaluate object at the last line.
<div style="height: 1.00em;">&#x00A0;</div>
Restrict permission of viewing a content to a specific client addresses:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
class App
  def on_req(env)
    allowed_clients = [&quot;127.0.0.1&quot;, &quot;::1&quot;]
<div class="Pp"></div>
    if env.req.path.start_with?(&quot;/log/&quot;) &amp;&amp;
       !allowed_clients.include?(env.remote_addr) then
      env.resp.status = 404
      env.resp.return &quot;permission denied&quot;
    end
  end
end
<div class="Pp"></div>
App.new
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="API_ENDPOINTS"><a class="selflink" href="#API_ENDPOINTS">API
  ENDPOINTS</a></h1>
nghttpx exposes API endpoints to manipulate it via HTTP based API. By default,
  API endpoint is disabled. To enable it, add a dedicated frontend for API using
  <i>--frontend</i> option with &quot;api&quot; parameter. All requests which
  come from this frontend address, will be treated as API request.
<div style="height: 1.00em;">&#x00A0;</div>
The response is normally JSON dictionary, and at least includes the following
  keys:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>status</b></dt>
  <dd class="It-tag">The status of the request processing. The following values
      are defined:</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>Success</b></dt>
  <dd class="It-tag">The request was successful.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Failure</b></dt>
  <dd class="It-tag">The request was failed. No change has been made.</dd>
</dl>
</div>
<br/>
<dl class="Bl-tag">
  <dt class="It-tag"><b>code</b></dt>
  <dd class="It-tag">HTTP status code</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Additionally, depending on the API endpoint, <b>data</b> key may be present, and
  its value contains the API endpoint specific data.
<div style="height: 1.00em;">&#x00A0;</div>
We wrote &quot;normally&quot;, since nghttpx may return ordinal HTML response in
  some cases where the error has occurred before reaching API endpoint (e.g.,
  header field is too large).
<div style="height: 1.00em;">&#x00A0;</div>
The following section describes available API endpoints.
<h2 class="Ss" title="Ss" id="POST_/api/v1beta1/backendconfig"><a class="selflink" href="#POST_/api/v1beta1/backendconfig">POST
  /api/v1beta1/backendconfig</a></h2>
This API replaces the current backend server settings with the requested ones.
  The request method should be POST, but PUT is also acceptable. The request
  body must be nghttpx configuration file format. For configuration file format,
  see <i>FILES</i> section. The line separator inside the request body must be
  single LF (0x0A). Currently, only <i>backend</i> option is parsed, the others
  are simply ignored. The semantics of this API is replace the current backend
  with the backend options in request body. Describe the desired set of backend
  severs, and nghttpx makes it happen. If there is no <i>backend</i> option is
  found in request body, the current set of backend is replaced with the
  <i>backend</i> option's default value, which is <b>127.0.0.1,80</b>.
<div style="height: 1.00em;">&#x00A0;</div>
The replacement is done instantly without breaking existing connections or
  requests. It also avoids any process creation as is the case with hot swapping
  with signals.
<div style="height: 1.00em;">&#x00A0;</div>
The one limitation is that only numeric IP address is allowd in <i>backend</i>
  in request body unless &quot;dns&quot; parameter is used while non numeric
  hostname is allowed in command-line or configuration file is read using
  <i>--conf</i>.
<h2 class="Ss" title="Ss" id="GET_/api/v1beta1/configrevision"><a class="selflink" href="#GET_/api/v1beta1/configrevision">GET
  /api/v1beta1/configrevision</a></h2>
This API returns configuration revision of the current nghttpx. The
  configuration revision is opaque string, and it changes after each reloading
  by SIGHUP. With this API, an external application knows that whether nghttpx
  has finished reloading its configuration by comparing the configuration
  revisions between before and after reloading. It is recommended to disable
  persistent (keep-alive) connection for this purpose in order to avoid to send
  a request using the reused connection which may bound to an old process.
<div style="height: 1.00em;">&#x00A0;</div>
This API returns response including <b>data</b> key. Its value is JSON object,
  and it contains at least the following key:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>configRevision</b></dt>
  <dd class="It-tag">The configuration revision of the current nghttpx</dd>
</dl>
</div>
<br/>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>nghttp(1)</b>, <b>nghttpd(1)</b>, <b>h2load(1)</b>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Tatsuhiro Tsujikawa
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
2012, 2015, 2016, Tatsuhiro Tsujikawa</div>
<table class="foot">
  <tr>
    <td class="foot-date">April 9, 2017</td>
    <td class="foot-os">1.21.1</td>
  </tr>
</table>
</body>
</html>
