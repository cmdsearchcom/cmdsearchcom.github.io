<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>MACHINECTL(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">MACHINECTL(1)</td>
    <td class="head-vol">machinectl</td>
    <td class="head-rtitle">MACHINECTL(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
machinectl - Control the systemd machine manager
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div class="Pp" style="margin-left: 11.00ex; text-indent: -11.00ex;"><b>machinectl</b>
  [OPTIONS...] {COMMAND} [NAME...]</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>machinectl</b> may be used to introspect and control the state of the
  <b>systemd</b>(1) virtual machine and container registration manager
  <b>systemd-machined.service</b>(8).
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
The following options are understood:
<div class="Pp"></div>
<b>-p</b>, <b>--property=</b>
<div style="margin-left: 4.00ex;">When showing machine or image properties,
  limit the output to certain properties as specified by the argument. If not
  specified, all set properties are shown. The argument should be a property
  name, such as &quot;Name&quot;. If specified more than once, all properties
  with the specified names are shown.</div>
<div class="Pp"></div>
<b>-a</b>, <b>--all</b>
<div style="margin-left: 4.00ex;">When showing machine or image properties, show
  all properties regardless of whether they are set or not.
<div style="height: 1.00em;">&#x00A0;</div>
When listing VM or container images, do not suppress images beginning in a dot
  character (&quot;.&quot;).</div>
<div class="Pp"></div>
<b>-l</b>, <b>--full</b>
<div style="margin-left: 4.00ex;">Do not ellipsize process tree entries.</div>
<div class="Pp"></div>
<b>--no-ask-password</b>
<div style="margin-left: 4.00ex;">Do not query the user for authentication for
  privileged operations.</div>
<div class="Pp"></div>
<b>--kill-who=</b>
<div style="margin-left: 4.00ex;">When used with <b>kill</b>, choose which
  processes to kill. Must be one of <b>leader</b>, or <b>all</b> to select
  whether to kill only the leader process of the machine or all processes of the
  machine. If omitted, defaults to <b>all</b>.</div>
<div class="Pp"></div>
<b>-s</b>, <b>--signal=</b>
<div style="margin-left: 4.00ex;">When used with <b>kill</b>, choose which
  signal to send to selected processes. Must be one of the well-known signal
  specifiers, such as <b>SIGTERM</b>, <b>SIGINT</b> or <b>SIGSTOP</b>. If
  omitted, defaults to <b>SIGTERM</b>.</div>
<div class="Pp"></div>
<b>--mkdir</b>
<div style="margin-left: 4.00ex;">When used with <b>bind</b> creates the
  destination directory before applying the bind mount.</div>
<div class="Pp"></div>
<b>--read-only</b>
<div style="margin-left: 4.00ex;">When used with <b>bind</b> applies a read-only
  bind mount.</div>
<div class="Pp"></div>
<b>-n</b>, <b>--lines=</b>
<div style="margin-left: 4.00ex;">When used with <b>status</b>, controls the
  number of journal lines to show, counting from the most recent ones. Takes a
  positive integer argument. Defaults to 10.</div>
<div class="Pp"></div>
<b>-o</b>, <b>--output=</b>
<div style="margin-left: 4.00ex;">When used with <b>status</b>, controls the
  formatting of the journal entries that are shown. For the available choices,
  see <b>journalctl</b>(1). Defaults to &quot;short&quot;.</div>
<div class="Pp"></div>
<b>--verify=</b>
<div style="margin-left: 4.00ex;">When downloading a container or VM image,
  specify whether the image shall be verified before it is made available. Takes
  one of &quot;no&quot;, &quot;checksum&quot; and &quot;signature&quot;. If
  &quot;no&quot; no verification is done. If &quot;checksum&quot; is specified
  the download is checked for integrity after transfer is complete, but no
  signatures are verified. If &quot;signature&quot; is specified, the checksum
  is verified and the images's signature is checked against a local keyring of
  trustable vendors. It is strongly recommended to set this option to
  &quot;signature&quot; if the server and protocol support this. Defaults to
  &quot;signature&quot;.</div>
<div class="Pp"></div>
<b>--force</b>
<div style="margin-left: 4.00ex;">When downloading a container or VM image, and
  a local copy by the specified local machine name already exists, delete it
  first and replace it by the newly downloaded image.</div>
<div class="Pp"></div>
<b>-H</b>, <b>--host=</b>
<div style="margin-left: 4.00ex;">Execute the operation remotely. Specify a
  hostname, or a username and hostname separated by &quot;@&quot;, to connect
  to. The hostname may optionally be suffixed by a container name, separated by
  &quot;:&quot;, which connects directly to a specific container on the
  specified host. This will use SSH to talk to the remote machine manager
  instance. Container names may be enumerated with <b>machinectl -H
  </b><b></b><i>HOST</i>.</div>
<div class="Pp"></div>
<b>-M</b>, <b>--machine=</b>
<div style="margin-left: 4.00ex;">Execute operation on a local container.
  Specify a container name to connect to.</div>
<div class="Pp"></div>
<b>--no-pager</b>
<div style="margin-left: 4.00ex;">Do not pipe output into a pager.</div>
<div class="Pp"></div>
<b>--no-legend</b>
<div style="margin-left: 4.00ex;">Do not print the legend, i.e. column headers
  and the footer with hints.</div>
<div class="Pp"></div>
<b>-h</b>, <b>--help</b>
<div style="margin-left: 4.00ex;">Print a short help text and exit.</div>
<div class="Pp"></div>
<b>--version</b>
<div style="margin-left: 4.00ex;">Print a short version string and exit.</div>
<h1 class="Sh" title="Sh" id="COMMANDS"><a class="selflink" href="#COMMANDS">COMMANDS</a></h1>
The following commands are understood:
<h2 class="Ss" title="Ss" id="Machine_Commands"><a class="selflink" href="#Machine_Commands">Machine
  Commands</a></h2>
<b>list</b>
<div style="margin-left: 4.00ex;">List currently running (online) virtual
  machines and containers. To enumerate container images that can be started,
  use <b>list-images</b> (see below).</div>
<div class="Pp"></div>
<b>status</b> <i>NAME</i>...
<div style="margin-left: 4.00ex;">Show terse runtime status information about
  one or more virtual machines and containers, followed by the most recent log
  data from the journal. This function is intended to generate human-readable
  output. If you are looking for computer-parsable output, use <b>show</b>
  instead. Note that the log data shown is reported by the virtual machine or
  container manager, and frequently contains console output of the machine, but
  not necessarily journal contents of the machine itself.</div>
<div class="Pp"></div>
<b>show</b> <i>NAME</i>...
<div style="margin-left: 4.00ex;">Show properties of one or more registered
  virtual machines or containers or the manager itself. If no argument is
  specified, properties of the manager will be shown. If an NAME is specified,
  properties of this virtual machine or container are shown. By default, empty
  properties are suppressed. Use <b>--all</b> to show those too. To select
  specific properties to show, use <b>--property=</b>. This command is intended
  to be used whenever computer-parsable output is required. Use <b>status</b> if
  you are looking for formatted human-readable output.</div>
<div class="Pp"></div>
<b>start</b> <i>NAME</i>...
<div style="margin-left: 4.00ex;">Start a container as a system service, using
  <b>systemd-nspawn</b>(1). This starts systemd-nspawn@.service, instantiated
  for the specified machine name, similar to the effect of <b>systemctl
  start</b> on the service name. <b>systemd-nspawn</b> looks for a container
  image by the specified name in /var/lib/machines/ (and other search paths, see
  below) and runs it. Use <b>list-images</b> (see below), for listing available
  container images to start.
<div style="height: 1.00em;">&#x00A0;</div>
Note that <b>systemd-machined.service</b>(8) also interfaces with a variety of
  other container and VM managers, <b>systemd-nspawn</b> is just one
  implementation of it. Most of the commands available in <b>machinectl</b> may
  be used on containers or VMs controlled by other managers, not just
  <b>systemd-nspawn</b>. Starting VMs and container images on those managers
  requires manager-specific tools.
<div style="height: 1.00em;">&#x00A0;</div>
To interactively start a container on the command line with full access to the
  container's console, please invoke <b>systemd-nspawn</b> directly. To stop a
  running container use <b>machinectl poweroff</b>, see below.</div>
<div class="Pp"></div>
<b>login</b> <i>NAME</i>
<div style="margin-left: 4.00ex;">Open an interactive terminal login session to
  a container. This will create a TTY connection to a specific container and
  asks for the execution of a getty on it. Note that this is only supported for
  containers running <b>systemd</b>(1) as init system.
<div style="height: 1.00em;">&#x00A0;</div>
This command will open a full login prompt on the container, which then asks for
  username and password. Use <b>systemd-run</b>(1) with the <b>--machine=</b>
  switch to invoke a single command, either interactively or in the background
  within a local container.</div>
<div class="Pp"></div>
<b>enable</b> <i>NAME</i>..., <b>disable</b> <i>NAME</i>...
<div style="margin-left: 4.00ex;">Enable or disable a container as a system
  service to start at system boot, using <b>systemd-nspawn</b>(1). This enables
  or disables systemd-nspawn@.service, instantiated for the specified machine
  name, similar to the effect of <b>systemctl enable</b> or <b>systemctl
  disable</b> on the service name.</div>
<div class="Pp"></div>
<b>poweroff</b> <i>NAME</i>...
<div style="margin-left: 4.00ex;">Power off one or more containers. This will
  trigger a reboot by sending SIGRTMIN+4 to the container's init process, which
  causes systemd-compatible init systems to shut down cleanly. This operation
  does not work on containers that do not run a <b>systemd</b>(1)-compatible
  init system, such as sysvinit. Use <b>terminate</b> (see below) to immediately
  terminate a container or VM, without cleanly shutting it down.</div>
<div class="Pp"></div>
<b>reboot</b> <i>NAME</i>...
<div style="margin-left: 4.00ex;">Reboot one or more containers. This will
  trigger a reboot by sending SIGINT to the container's init process, which is
  roughly equivalent to pressing Ctrl+Alt+Del on a non-containerized system, and
  is compatible with containers running any system manager.</div>
<div class="Pp"></div>
<b>terminate</b> <i>NAME</i>...
<div style="margin-left: 4.00ex;">Immediately terminates a virtual machine or
  container, without cleanly shutting it down. This kills all processes of the
  virtual machine or container and deallocates all resources attached to that
  instance. Use <b>poweroff</b> to issue a clean shutdown request.</div>
<div class="Pp"></div>
<b>kill</b> <i>NAME</i>...
<div style="margin-left: 4.00ex;">Send a signal to one or more processes of the
  virtual machine or container. This means processes as seen by the host, not
  the processes inside the virtual machine or container. Use <b>--kill-who=</b>
  to select which process to kill. Use <b>--signal=</b> to select the signal to
  send.</div>
<div class="Pp"></div>
<b>bind</b> <i>NAME</i> <i>PATH</i> [<i>PATH</i>]
<div style="margin-left: 4.00ex;">Bind mounts a directory from the host into the
  specified container. The first directory argument is the source directory on
  the host, the second directory argument the source directory on the host. When
  the latter is omitted the destination path in the container is the same as the
  source path on the host. When combined with the <b>--read-only</b> switch a
  ready-only bind mount is created. When combined with the <b>--mkdir</b> switch
  the destination path is first created before the mount is applied. Note that
  this option is currently only supported for <b>systemd-nspawn</b>(1)
  containers.</div>
<div class="Pp"></div>
<b>copy-to</b> <i>NAME</i> <i>PATH</i> [<i>PATH</i>]
<div style="margin-left: 4.00ex;">Copies files or directories from the host
  system into a running container. Takes a container name, followed by the
  source path on the host and the destination path in the container. If the
  destination path is omitted the same as the source path is used.</div>
<div class="Pp"></div>
<b>copy-from</b> <i>NAME</i> <i>PATH</i> [<i>PATH</i>]
<div style="margin-left: 4.00ex;">Copies files or directories from a container
  into the host system. Takes a container name, followed by the source path in
  the container the destination path on the host. If the destination path is
  omitted the same as the source path is used.</div>
<h2 class="Ss" title="Ss" id="Image_Commands"><a class="selflink" href="#Image_Commands">Image
  Commands</a></h2>
<b>list-images</b>
<div style="margin-left: 4.00ex;">Show a list of locally installed container and
  VM images. This enumerates all raw disk images and container directories and
  subvolumes in /var/lib/machines/ (and other search paths, see below). Use
  <b>start</b> (see above) to run a container off one of the listed images. Note
  that by default containers whose name begins with a dot (&quot;.&quot;) are
  not shown. To show these too, specify <b>--all</b>. Note that a special image
  &quot;.host&quot; always implicitly exists and refers to the image the host
  itself is booted from.</div>
<div class="Pp"></div>
<b>image-status</b> <i>NAME</i>...
<div style="margin-left: 4.00ex;">Show terse status information about one or
  more container or VM images. This function is intended to generate
  human-readable output. Use <b>show-image</b> (see below) to generate
  computer-parsable output instead.</div>
<div class="Pp"></div>
<b>show-image</b> <i>NAME</i>...
<div style="margin-left: 4.00ex;">Show properties of one or more registered
  virtual machine or container images, or the manager itself. If no argument is
  specified, properties of the manager will be shown. If an NAME is specified,
  properties of this virtual machine or container image are shown. By default,
  empty properties are suppressed. Use <b>--all</b> to show those too. To select
  specific properties to show, use <b>--property=</b>. This command is intended
  to be used whenever computer-parsable output is required. Use
  <b>image-status</b> if you are looking for formatted human-readable
  output.</div>
<div class="Pp"></div>
<b>clone</b> <i>NAME</i> <i>NAME</i>
<div style="margin-left: 4.00ex;">Clones a container or disk image. The
  arguments specify the name of the image to clone and the name of the newly
  cloned image. Note that plain directory container images are cloned into
  subvolume images with this command. Note that cloning a container or VM image
  is optimized for btrfs file systems, and might not be efficient on others, due
  to file system limitations.</div>
<div class="Pp"></div>
<b>rename</b> <i>NAME</i> <i>NAME</i>
<div style="margin-left: 4.00ex;">Renames a container or disk image. The
  arguments specify the name of the image to rename and the new name of the
  image.</div>
<div class="Pp"></div>
<b>read-only</b> <i>NAME</i> [<i>BOOL</i>]
<div style="margin-left: 4.00ex;">Marks or (unmarks) a container or disk image
  read-only. Takes a VM or container image name, followed by a boolean as
  arguments. If the boolean is omitted, positive is implied, i.e. the image is
  marked read-only.</div>
<div class="Pp"></div>
<b>remove</b> <i>NAME</i>...
<div style="margin-left: 4.00ex;">Removes one or more container or disk images.
  The special image &quot;.host&quot;, which refers to the host's own directory
  tree may not be removed.</div>
<h2 class="Ss" title="Ss" id="Image_Transfer_Commands"><a class="selflink" href="#Image_Transfer_Commands">Image
  Transfer Commands</a></h2>
<b>pull-tar</b> <i>URL</i> [<i>NAME</i>]
<div style="margin-left: 4.00ex;">Downloads a .tar container image from the
  specified URL, and makes it available under the specified local machine name.
  The URL must be of type &quot;http://&quot; or &quot;https://&quot;, and must
  refer to a .tar, .tar.gz, .tar.xz or .tar.bz2 archive file. If the local
  machine name is omitted the name it is automatically derived from the last
  component of the URL, with its suffix removed.
<div style="height: 1.00em;">&#x00A0;</div>
The image is verified before it is made available, unless <b>--verify=no</b> is
  specified. Verification is done via SHA256SUMS and SHA256SUMS.gpg files, that
  need to be made available on the same web server, under the same URL as the
  .tar file, but with the last component (the filename) of the URL replaced.
  With <b>--verify=checksum</b> only the SHA256 checksum for the file is
  verified, based on the SHA256SUMS file. With <b>--verify=signature</b> the
  SHA256SUMS file is first verified with detached GPG signature file
  SHA256SUMS.gpg. The public key for this verification step needs to be
  available in /usr/lib/systemd/import-pubring.gpg or
  /etc/systemd/import-pubring.gpg.
<div style="height: 1.00em;">&#x00A0;</div>
The container image will be downloaded and stored in a read-only subvolume in
  /var/lib/machines/, that is named after the specified URL and its HTTP etag. A
  writable snapshot is then taken from this subvolume, and named after the
  specified local name. This behaviour ensures that creating multiple container
  instances of the same URL is efficient, as multiple downloads are not
  necessary. In order to create only the read-only image, and avoid creating its
  writable snapshot, specify &quot;-&quot; as local machine name.
<div style="height: 1.00em;">&#x00A0;</div>
Note that the read-only subvolume is prefixed with .tar-, and is thus now shown
  by <b>list-images</b>, unless <b>--all</b> is passed.
<div style="height: 1.00em;">&#x00A0;</div>
Note that pressing C-c during execution of this command will not abort the
  download. Use <b>cancel-transfer</b>, described below.</div>
<div class="Pp"></div>
<b>pull-raw</b> <i>URL</i> [<i>NAME</i>]
<div style="margin-left: 4.00ex;">Downloads a .raw container or VM disk image
  from the specified URL, and makes it available under the specified local
  machine name. The URL must be of type &quot;http://&quot; or
  &quot;https://&quot;. The container image must either be a .qcow2 or raw disk
  image, optionally compressed as .gz, .xz, or .bz2. If the local machine name
  is omitted the name it is automatically derived from the last component of the
  URL, with its suffix removed.
<div style="height: 1.00em;">&#x00A0;</div>
Image verification is identical for raw and tar images (see above).
<div style="height: 1.00em;">&#x00A0;</div>
If the the downloaded image is in .qcow2 format it es converted into a raw image
  file before it is made available.
<div style="height: 1.00em;">&#x00A0;</div>
Downloaded images of this type will be placed as read-only .raw file in
  /var/lib/machines/. A local, writable (reflinked) copy is then made under the
  specified local machine name. To omit creation of the local, writable copy
  pass &quot;-&quot; as local machine name.
<div style="height: 1.00em;">&#x00A0;</div>
Similar to the behaviour of <b>pull-tar</b>, the read-only image is prefixed
  with .raw-, and thus now shown by <b>list-images</b>, unless <b>--all</b> is
  passed.
<div style="height: 1.00em;">&#x00A0;</div>
Note that pressing C-c during execution of this command will not abort the
  download. Use <b>cancel-transfer</b>, described below.</div>
<div class="Pp"></div>
<b>list-transfers</b>
<div style="margin-left: 4.00ex;">Shows a list of container or VM image
  downloads that are currently in progress.</div>
<div class="Pp"></div>
<b>cancel-transfers</b> <i>ID</i>...
<div style="margin-left: 4.00ex;">Aborts download of the container or VM image
  with the specified ID. To list ongoing transfers and their IDs, use
  <b>list-transfers</b>.</div>
<h1 class="Sh" title="Sh" id="FILES_AND_DIRECTORIES"><a class="selflink" href="#FILES_AND_DIRECTORIES">FILES
  AND DIRECTORIES</a></h1>
Machine images are preferably stored in /var/lib/machines/, but are also
  searched for in /usr/local/lib/machines/ and /usr/lib/machines/. For
  compatibility reasons the directory /var/lib/container/ is searched, too. Note
  that images stored below /usr are always considered read-only. It is possible
  to symlink machines images from other directories into /var/lib/machines/ to
  make them available for control with <b>machinectl</b>.
<div class="Pp"></div>
Disk images are understood by <b>systemd-nspawn</b>(1) and <b>machinectl</b> in
  three formats:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;A simple directory tree, containing
  the files and directories of the container to boot.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;A subvolume (on btrfs file systems),
  which are similar to the simple directories, described above. However, they
  have additional benefits, such as efficient cloning and quota reporting.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;&quot;Raw&quot; disk images, i.e.
  binary images of disks with a GPT or MBR partition table. Images of this type
  are regular files with the suffix &quot;.raw&quot;.</div>
<div class="Pp"></div>
See <b>systemd-nspawn</b>(1) for more information on image formats, in
  particular it's <b>--directory=</b> and <b>--image=</b> options.
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<b>Example&#x00A0;1.&#x00A0;Download an Ubuntu image and open a shell in it</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
# machinectl pull-tar https://cloud-images.ubuntu.com/trusty/current/trusty-server-cloudimg-amd64-root.tar.gz
# systemd-nspawn -M trusty-server-cloudimg-amd64-root
</pre>
</div>
<div class="Pp"></div>
This downloads and verifies the specified .tar image, and then uses
  <b>systemd-nspawn</b>(1) to open a shell in it.
<div class="Pp"></div>
<b>Example&#x00A0;2.&#x00A0;Download a Fedora image, set a root password in it,
  start it as service</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
# machinectl pull-raw --verify=no http://ftp.halifax.rwth-aachen.de/fedora/linux/releases/21/Cloud/Images/x86_64/Fedora-Cloud-Base-20141203-21.x86_64.raw.xz
# systemd-nspawn -M Fedora-Cloud-Base-20141203-21
# passwd
# exit
# machinectl start Fedora-Cloud-Base-20141203-21
# machinectl login Fedora-Cloud-Base-20141203-21
</pre>
</div>
<div class="Pp"></div>
This downloads the specified .raw image with verification disabled. Then a shell
  is opened in it and a root password is set. Afterwards the shell is left, and
  the machine started as system service. With the last command a login prompt
  into the container is requested.
<h1 class="Sh" title="Sh" id="EXIT_STATUS"><a class="selflink" href="#EXIT_STATUS">EXIT
  STATUS</a></h1>
On success, 0 is returned, a non-zero failure code otherwise.
<h1 class="Sh" title="Sh" id="ENVIRONMENT"><a class="selflink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
<i>$SYSTEMD_PAGER</i>
<div style="margin-left: 4.00ex;">Pager to use when <b>--no-pager</b> is not
  given; overrides <i>$PAGER</i>. Setting this to an empty string or the value
  &quot;cat&quot; is equivalent to passing <b>--no-pager</b>.</div>
<div class="Pp"></div>
<i>$SYSTEMD_LESS</i>
<div style="margin-left: 4.00ex;">Override the default options passed to
  <b>less</b> (&quot;FRSXMK&quot;).</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>systemd-machined.service</b>(8), <b>systemd-nspawn</b>(1),
  <b>systemd.special</b>(7)</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os">systemd 219</td>
  </tr>
</table>
</body>
</html>
