<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:07:20 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>ENEMIES-OF-CARLOTTA(1) General Commands Manual
ENEMIES-OF-CARLOTTA(1)</p>

<p style="margin-top: 1em">NAME <br>
enemies-of-carlotta - a simple mailing list manager</p>

<p style="margin-top: 1em">SYNOPSIS <br>
enemies-of-carlotta [options] [addresses]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
enemies-of-carlotta is a simple mailing list manager. If you
don&rsquo;t know what a mailing list manager is, you should
learn what they are before trying to use one. A manual page
<br>
is unfortunately too short to explain it.</p>

<p style="margin-top: 1em">Enemies of Carlotta keeps all
data about the lists in the ~/.enemies-of-carlotta
directory. It will be created automatically when you create
your first list. You need to <br>
arrange manually for the mails to be processed by the list
manager. The details differ from mail system to another. For
QMail and Postfix, see below.</p>

<p style="margin-top: 1em">Each list has one or more
owners, who also moderate subscriptions or moderate some or
all postings. On completely unmoderated lists the list
owners are responsible for answering <br>
questions about the list. On completely moderated lists,
they have to approve each message before it is sent to the
list. On lists with posting=auto, messages from subscribers
<br>
are sent automatically to the list, and the moderators have
to approve the rest.</p>

<p style="margin-top: 1em">OPTIONS <br>
--name=foo@example.com <br>
Specify the list the command is to operate on. Most of the
remaining options require you to set the list name with this
option. With the --edit, --subscribe, --unsub&acirc; <br>
scribe, and --list options, the name can be abbreviated to
by leaving out the @ sign and domain.</p>

<p style="margin-top: 1em">--create <br>
Create a new list. You must specify at least one owner with
--owner.</p>

<p style="margin-top: 1em">--owner=address <br>
Specify a list owner when creating or editing a list.</p>

<p style="margin-top: 1em">--moderator=address <br>
Specificy a list moderator when creating or editing a
list.</p>

<p style="margin-top: 1em">--language=language-code <br>
Set the language code used for looking up template files.
The code should be empty (the default, meaning English), or
a two-letter code such as fi or es.</p>

<p style="margin-top: 1em">--cleaning-woman <br>
Deal with bouncing addresses and do other cleanup. You must
run enemies-of-carlotta --cleaning-woman periodically, such
as once per hour. It will clean up all your <br>
lists.</p>

<p style="margin-top: 1em">--destroy <br>
Destroy the list.</p>

<p style="margin-top: 1em">--edit Modify the list
configuration.</p>

<p style="margin-top: 1em">--subscription=type <br>
When creating a list, set its subscription mode to free or
moderated. Use with --edit, or --create.</p>

<p style="margin-top: 1em">--posting=type <br>
When creating a list, set its posting mode to free (anyone
can post), auto (only subscribers can post, mails from
others need to be moderated), or moderated (all mails are
<br>
moderated). Use with --edit, or --create.</p>

<p style="margin-top: 1em">--archived=yes-or-no <br>
Should list messages be archived to the archive-box
directory in the list directory under the
~/.enemies-of-carlotta directory. Use yes or no.</p>


<p style="margin-top: 1em">--mail-on-subscription-changes=yes-or-no
<br>
Should the list owners be notified when someone subscribes
to or unsubscribes from the list? Use yes or no. Default is
no.</p>


<p style="margin-top: 1em">--mail-on-forced-unsubscription=yes-or-no
<br>
Should list owners be notified when someone is forcibly
dropped from the list due to too much bouncing? Use yes or
no. Default is no.</p>

<p style="margin-top: 1em">--ignore-bounce=yes-or-no <br>
Should bounces be ignored? Use yes or no. Default is no.</p>

<p style="margin-top: 1em">--list List the subscribers of a
list.</p>

<p style="margin-top: 1em">--subscribe <br>
Add subscribers to a list. The non-option arguments are the
addresses to be subscribed. Note that addresses added this
way won&rsquo;t be sent confirmation requests.</p>

<p style="margin-top: 1em">--unsubscribe <br>
Remove subscribers from a list. The non-option arguments are
the addresses to be unsubscribed. Note that addresses
removed this way won&rsquo;t be sent confirmation
requests.</p>

<p style="margin-top: 1em">--incoming <br>
Deal with an incoming message in the standard input. The
SMTP envelope sender address must be given in the SENDER
environment variable, and the SMTP envelope recipient <br>
address in the RECIPIENT environment variable. (QMail and
Postfix do this automatically.)</p>

<p style="margin-top: 1em">--skip-prefix=string <br>
Before analyzing the recipient address to see which list it
refers, remove string from its beginning. This helps deal
with QMail and Postfix virtual domains, see above.</p>

<p style="margin-top: 1em">--domain=domain.name <br>
Before analyzing the recipient address to see which list it
refers, replace the domain name part with domain.name. This
helps deal with Postfix virtual domains.</p>

<p style="margin-top: 1em">--is-list <br>
Does the address specified with --name refer to a valid
list? This sets the exit code to zero (success) if it does,
or one (failure) if it does not.</p>

<p style="margin-top: 1em">--sendmail=pathname <br>
Use pathname instead of /usr/sbin/sendmail for sending mail
via a command line interface. Note that the command must
obey the sendmail command line interface.</p>

<p style="margin-top: 1em">--smtp-server=hostname <br>
Send mail using the SMTP server at hostname (port 25). The
server must be configured to allow the list host to relay
mail through it. Note that a command line interface <br>
is used by default; SMTP sending is used only if you use
this option.</p>

<p style="margin-top: 1em">--qmqp-server=hostname <br>
Send mail using the QMQP server at hostname (port 628). The
server must be configured to allow the list host to relay
mail through it. Note that a command line interface <br>
is used by default; QMQP sending is used only if you use
this option.</p>

<p style="margin-top: 1em">--moderate <br>
Force an incoming message to be moderated, even if it is
going to a list where posting is free. This can be used for
spam filtering: you pipe incoming messages through <br>
whatever spam filter you choose to use and if the mssage
looks like spam, you ask it to be moderated by a human.</p>

<p style="margin-top: 1em">--post Force an incoming message
to be posted, even if it is going to a list where posting is
moderated. This can be used when there is an external check
for whether a mail is <br>
acceptable to the list, e.g., by checking digital
signatures.</p>

<p style="margin-top: 1em">--quiet <br>
By default, debugging log messages are sent to the standard
error output stream. With this option, they
aren&rsquo;t.</p>

<p style="margin-top: 1em">--sender=foo@example.com</p>

<p style="margin-top: 1em">--recipient=foo@example.com <br>
These two options are used with --incoming and --is-list to
override the environment variables SENDER and RECIPIENT,
respectively.</p>

<p style="margin-top: 1em">--get Get the values of one or
more configuration variables. The name of the variables are
given on the command line after the options. Each value is
printed on a separate <br>
line.</p>

<p style="margin-top: 1em">--set Set the values of one or
more configuration variables. The names and values are given
on the command line after the options and separated by an
equals sign (&quot;=&quot;). For <br>
example, the following would set the language of a list to
Finnish: enemies-of-carlotta --name=foo@bar --set
language=fi</p>

<p style="margin-top: 1em">--version <br>
Print out the version of the program.</p>

<p style="margin-top: 1em">--show-lists <br>
List the lists enemies-of-carlotta knows about.</p>

<p style="margin-top: 1em">CONFIGURATION <br>
Each list is represented by a directory, named after the
list, in ~/.enemies-of-carlotta. That directory contains
several files and directories, described below. In general,
it <br>
is not necessary to touch these at all. However, some
esoteric configuration can only be done by hand editing of
the list configuration file.</p>

<p style="margin-top: 1em">config The list configuration
file. Contents are described below.</p>

<p style="margin-top: 1em">subscribers <br>
Subscriber database. Each line contains a subscriber group,
with the first five space delimited fields being group
identifier, status, timestamp for when the group was <br>
created, timestamp for the bounce that made it switch from
status &rsquo;ok&rsquo; to &rsquo;bounced&rsquo;, and the
bounce identifier.</p>

<p style="margin-top: 1em">archive-box <br>
Archived messages.</p>

<p style="margin-top: 1em">bounce-box <br>
Bounce messages groups not in state &rsquo;ok&rsquo;.</p>

<p style="margin-top: 1em">headers-to-add <br>
These headers are added to the mails sent to the list. They
are copied to the beginning of the existing headers exactly
as they are in the file, after list headers <br>
(&quot;List-ID&quot; and such) have been added and those
mentioned in headers-to-remove have been removed.</p>

<p style="margin-top: 1em">headers-to-remove <br>
These headers are removed from mails sent to the list.</p>

<p style="margin-top: 1em">moderation-box <br>
Messages waiting for moderator approval.</p>

<p style="margin-top: 1em">subscription-box <br>
Subscription and unsubscription requests waiting to be
confirmed by the user.</p>

<p style="margin-top: 1em">templates <br>
Directory containing list specific templates (optional). If
this directory exists, templates are searched from it before
going for system wide templates. An empty file <br>
here means the corresponding message is not sent at all.
This can, for example, to be used to turn off the
&quot;please wait for moderator&quot; mails on a per-list
basis.</p>

<p style="margin-top: 1em">plugins <br>
Directory containing plugins, Python source files that are
loaded automatically by EoC upon startup. The plugins may
change how EoC operates.</p>

<p style="margin-top: 1em">The config file has a
keyword=value format:</p>

<p style="margin-top: 1em">[list] <br>
owners = liw@liw.iki.fi <br>
archived = no <br>
posting = free <br>
subscription = free <br>
mail-on-subscription-changes = yes <br>
mail-on-forced-unsubscribe = yes <br>
language = fi</p>

<p style="margin-top: 1em">The keywords archived, posting,
and subscription correspond to the options with the same
names. Other keywords are:</p>

<p style="margin-top: 1em">owners List of addresses for the
owners. Set with the --owner option.</p>

<p style="margin-top: 1em">moderators <br>
List of addresses for the moderators. Set with the
--moderator option.</p>

<p style="margin-top: 1em">mail-on-subscription-changes
<br>
Should the owners be mailed when users subscribe or
unsubscribe?</p>

<p style="margin-top: 1em">mail-on-forced-unsubscribe <br>
Should the owners be mailed when people are removed from the
list due to excessive bouncing?</p>

<p style="margin-top: 1em">ignore_bounce <br>
Bounce messages are ignored on this list. Useful for example
if list should have static subscriber list.</p>

<p style="margin-top: 1em">language <br>
Suffix for templates, to allow support for multiple
languages. (If language is set to &quot;fi&quot;, then the
template named &quot;foo&quot; is first searched as
&quot;foo.fi&quot;.)</p>

<p style="margin-top: 1em">pristine-headers <br>
Do not MIME encode the headers. Set to &quot;yes&quot; to
not encode, anything else (including empty or unset) means
encoding will happen.</p>

<p style="margin-top: 1em">EXAMPLES <br>
To create a list called moviefans@example.com, owned by
ding@example.com, use the following command (all on one
line):</p>

<p style="margin-top: 1em">enemies-of-carlotta
--name=moviefans@example.com <br>
--owner=ding@example.com --create</p>

<p style="margin-top: 1em">Note that you need to arrange
mail to arrive at the list (and its command addresses) by
configuring your mail system. For Qmail and Postfix, see
below.</p>

<p style="margin-top: 1em">To see the subscribers on that
list:</p>

<p style="margin-top: 1em">enemies-of-carlotta
--name=moviefans@example.com --list</p>

<p style="margin-top: 1em">People wanting to subscribe to
the list should mail</p>


<p style="margin-top: 1em">moviefans-subscribe@example.com</p>

<p style="margin-top: 1em">QMAIL <br>
With QMail, to arrange for incoming mail to be processed by
Enemies of Carlotta, you need to create a couple of
.qmail-extension files per list. For example, if your
username is <br>
joe and you wish to run the joe-fans mailing list, you need
to create two files, .qmail-fans and .qmail-fans-default,
containing</p>

<p style="margin-top: 1em">|enemies-of-carlotta
--incoming</p>

<p style="margin-top: 1em">If you&rsquo;re running a
virtual domain, example.com, and the mails are being
delivered to via /var/qmail/control/virtualdomains to
joe-exampledotcom, the files would be called <br>
.qmail-exampledotcom-fans and
.qmail-exampledotcom-fans-default and would contain</p>

<p style="margin-top: 1em">|enemies-of-carlotta --incoming
--skip-prefix=joe-exampledotcom-</p>

<p style="margin-top: 1em">(all on one line, of course, in
case the manual page formatter breaks it on several
lines).</p>

<p style="margin-top: 1em">COURIER-MTA <br>
For Courier-MTA, the instructions are similar to the Qmail
ones above. If your user name is joe and you wish to run the
joe-fans email list, you need to create the two files <br>
.courier-fans and .courier-fans-default in your home
directory with the content</p>

<p style="margin-top: 1em">|enemies-of-carlotta --is-list
--name $RECIPIENT || exit 67 <br>
|enemies-of-carlotta --incoming</p>

<p style="margin-top: 1em">(The former file needs only the
second line, but the first line does no harm and it is
easier to keep track of things when the files have the same
content. Note that $RECIPIENT <br>
should be included verbatim, it is not a metavariable for
you to expand.)</p>

<p style="margin-top: 1em">If you are running a virtual
domain configured so that all mail to the domain
@example.com is delivered to joe-exampledotcom, you need to
create the files .courier-exampledotcom- <br>
fans and</p>

<p style="margin-top: 1em">|enemies-of-carlotta --is-list
--name $RECIPIENT --skip-prefix=joe-exampledotcom || exit 67
<br>
|enemies-of-carlotta --incoming
--skip-prefix=joe-exampledotcom</p>

<p style="margin-top: 1em">If the virtual domain is for
list use only, then it is sufficient to create only the file
.courier-exampledotcom-default containing the latter two
lines.</p>

<p style="margin-top: 1em">POSTFIX <br>
With Postfix, you need to set up a .forward file
containing</p>

<p style="margin-top: 1em">&quot;|procmail -p&quot;</p>

<p style="margin-top: 1em">and then a .procmailrc file
containing</p>

<p style="margin-top: 1em">:0 <br>
* ? enemies-of-carlotta --name=$RECIPIENT --is-list <br>
| enemies-of-carlotta --incoming</p>

<p style="margin-top: 1em">To use Enemies of Carlotta with
a Postfix virtual domain, you need to set up a virtual
regular expression map, typically called
/etc/postfix/virtual_regexp (add virtual_maps = <br>
regexp:/etc/postfix/virtual_regexp to your
/etc/postfix/main.cf file to enable it). The regexp file
needs to do ugly things to preserve the recipient address.
Add the following <br>
to the regexp file:</p>

<p style="margin-top: 1em">/^your.virtual.domain$/ dummy
<br>
/^(yourlist|yourlist-.*)@(your.virtual.domain)$/
joe+virtual-$1</p>

<p style="margin-top: 1em">That&rsquo;s two lines. Use
joe-virtual instead, if recipient_delimiter for your Postfix
is configured to a minus instead of a plus.. Then, in your
.procmailrc file, add the <br>
--skip-prefix=joe-virtual- and --domain=your.virtual.domain
options to both calls to enemies-of-carlotta.</p>

<p style="margin-top: 1em">(Yes, I think these things are
much too complicated, too.)</p>

<p style="margin-top: 1em">MAIL COMMANDS <br>
Users and list owners use Enemies of Carlotta via e-mail
using command addresses such as foo-subscribe@example.com.
Here is a list of all command addresses list users and
owners <br>
can give. In all these examples, the name of the mailing
list is foo@example.com.</p>

<p style="margin-top: 1em">Mail commands anyone can use
<br>
These commands are meant for everyone&rsquo;s use. They
don&rsquo;t require any special priviledges.</p>

<p style="margin-top: 1em">foo@example.com <br>
Send mail to all list subscribers. The message may have to
be manually approved by the list moderators first, and they
have the power to reject a message.</p>

<p style="margin-top: 1em">foo-owner@example.com <br>
Send mail to the list owner or owners instead.</p>

<p style="margin-top: 1em">foo-help@example.com <br>
Sending mail to this address makes the list manager reply
with the help message for the list.</p>

<p style="margin-top: 1em">foo-subscribe@example.com <br>
Send mail to this address to subscribe to a list. The list
manager will respond with a confirmation request. You
won&rsquo;t be subscribed unless you reply to the
confirmation <br>
request. This way, malicious people can&rsquo;t put your
address on a mailing list, or many mailing lists.</p>


<p style="margin-top: 1em">foo-subscribe-joe=example.com@example.com
<br>
This is a second form of the subscription address. If you
want to subscribe to the list with another address than the
one you&rsquo;re sending mail from, use this one. In this
<br>
case, the address to be subscribed is joe@example.com. Note
that the confirmation request is sent to Joe, since it is
his address that is to be added to the list.</p>

<p style="margin-top: 1em">foo-unsubscribe@example.com <br>
To unsubscribe from a list, send mail to this address from
the address that is subscribed to the list. Again, you will
receive a confirmation request, to prevent mali&acirc; <br>
cious people from unsubscribing you against your will.</p>


<p style="margin-top: 1em">foo-unsubscribe-joe=example.com@example.com
<br>
To unsubscribe Joe, use this address. Again, it is Joe who
gets to confirm.</p>

<p style="margin-top: 1em">Mail commands for the list
owners <br>
These are commands that list owners can use to administer
their list.</p>


<p style="margin-top: 1em">foo-subscribe-joe=example.com@example.com
<br>
If a list owner sends mail like this, it is they who get the
confirmation request, not Joe. It is generally better for
people to subscribe themselves, but sometimes list <br>
owners want to do it, when they have permission from the
person and feel helpful.</p>


<p style="margin-top: 1em">foo-unsubscribe-joe=example.com@example.com
<br>
List owners can also unsubscribe other people.</p>

<p style="margin-top: 1em">foo-list@example.com <br>
To see who are on the list, this is the address to use. It
only works if the sender address is one of the list owners.
The sender address is the one used on the SMTP <br>
level, not the one in the From: header.</p>

<p style="margin-top: 1em">foo-setlist@example.com <br>
This lets a list owner set the whole subscriber list at
once. This is similar to using lots and lots and lots of
-subscribe and -unsubscribe commands, only less painful.
<br>
Everyone who is added to the list gets a welcome message,
and everyone who is removed from the list gets a goodbye
message.</p>

<p style="margin-top: 1em">foo-setlistsilently@example.com
<br>
This is similar to -setlist, but no welcome and goodbye
messages are sent.</p>

<p style="margin-top: 1em">PLUGINS <br>
Enemies of Carlotta supports plugins. If you don&rsquo;t
know what Python programming is, you may want to skip this
section.</p>

<p style="margin-top: 1em">A plugin is a Python module
(file named with a .py suffix), placed in the
~/.enemies-of-carlotta/plugins directory. The plugins are
loaded automatically upon startup, if their <br>
declared interface version matches the one implemented by
Enemies of Carlotta. The interface version is declared by
the module global variable PLUGIN_INTERFACE_VERSION.</p>

<p style="margin-top: 1em">Plugins can define hook
functions that are called by appropriate places in the EoC
code. At the moment, the only hook function is
send_mail_to_subscribers_hook, which can manip&acirc; <br>
ulate a mail message before it is sent to the subscribers.
The function must look like this:</p>

<p style="margin-top: 1em">def
send_mail_to_subscribers_hook(list, text):</p>

<p style="margin-top: 1em">The list argument is a reference
to the MailingList object that corresponds to the list in
question, and text is the complete text of the mail message
as it exists. The function <br>
must return the new contents of the mail message.</p>

<p style="margin-top: 1em">FILES <br>
~/.enemies-of-carlotta <br>
All files related to your mailing lists.</p>

<p style="margin-top: 1em">~/.enemies-of-carlotta/secret
<br>
Secret password used to generate signed addresses for bounce
checking and subscription verification.</p>


<p style="margin-top: 1em">~/.enemies-of-carlotta/foo@example.com
<br>
Directory containing data pertaining to the foo@example.com
list. Except for the config file in this directory, you
shouldn&rsquo;t edit anything by hand.</p>


<p style="margin-top: 1em">~/.enemies-of-carlotta/foo@example.com/config
<br>
Configuration file for the mailing list. You may need to
edit this file by hand if you wish to change moderation
status or list owners.</p>

<p style="margin-top: 1em">SEE ALSO <br>
You may want to visit the Enemies of Carlotta home page at
http://www.iki.fi/liw/eoc/.</p>
 
<p style="margin-top: 1em">ENEMIES-OF-CARLOTTA(1)</p>
<hr>
</body>
</html>
