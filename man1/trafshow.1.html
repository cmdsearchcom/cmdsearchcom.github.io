<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:40:45 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>TRAFSHOW(1) General Commands Manual TRAFSHOW(1)</p>

<p style="margin-top: 1em">NAME <br>
trafshow - full screen show network traffic</p>

<p style="margin-top: 1em">SYNOPSIS <br>
trafshow [-vpnb] [-a len] [-c conf] [-i name] [-s str] [-u
port] [-R refresh] [-P purge] [-F file | expr]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
TrafShow is a simple interactive program that gather the
network traffic from all libpcap-capable interfaces to
accumulate it in memory cache, and then separately display
it on <br>
appropriated curses window in line-narrowed manner as a list
of network flows sorted by throughput. Display updates
occurs nearly in real time, asynchronously from the data
col&acirc; <br>
lecting. It look like a live show of traffic flows. Any kind
of network traffic are mixed together in the one live-show
screen, an Ethernet, IP, etc. <br>
Hint: Please press &lsquo;H&rsquo; key inside a show to get
brief help!</p>

<p style="margin-top: 1em">The IP traffic can be aggregated
by netmask prefix bits and service ports to reorganize a
heap of trivial flows into the treelike hierarchies suitable
for human perception. The <br>
user can glance over the list of resulting flows and select
at their to browse detail. So you can deepen into the
traffic inheritance hierarchy and inspect the packets of
each <br>
trivial flow in variety of presentations: raw-hex, ascii,
time-stamp. <br>
The program make aggregation automatically when number of
flows will exceed some reasonable amount. Just a few seconds
after launch may be required for adaptation to your volume
<br>
of traffic. Use -a len option (see below) to overwrite the
default behaviour.</p>

<p style="margin-top: 1em">TrafShow also listens on UDP
port (9995 by default) for diverse feeders of Cisco Netflow
and then separately display the collected data in the same
manner as described above. The <br>
following versions of Netflow are currently supported: V1,
V5, V7. Use -u port option (see below) to overwrite the
default behaviour.</p>

<p style="margin-top: 1em">This program may be found
wonderful at lest to locate suspicious traffic on the net
very quickly on demand, or to evaluate real time traffic
bandwidth utilization, in a simplest <br>
and convenient environment. But it is not intended for
collecting and analysis of the network traffic for a long
period of time, nor for billing!</p>

<p style="margin-top: 1em">The program pretend to be IPv6
compatible and ready to using, but it is not tested enough.
You can define INET6 to do so.</p>

<p style="margin-top: 1em">OPTIONS <br>
-v Print detailed version information and exit.</p>

<p style="margin-top: 1em">-p Do not put interface(s) into
promiscuous mode.</p>

<p style="margin-top: 1em">-n Do not convert numeric values
to names (host addresses, port numbers, etc.). The mode can
be toggled On/Off during a show by pressing the
&lsquo;N&rsquo; key.</p>

<p style="margin-top: 1em">-b To place a backflow entries
near to the main streams in the sorted list of traffic
flows. <br>
Note: this mode can raise the system load dangerously high
because it take a lot of CPU cycles!</p>

<p style="margin-top: 1em">-a len To aggregate traffic
flows using IP netmask prefix len. This option also turn on
service ports aggregation. The len expected as number of
bits in the network portion of IP <br>
addresses (like CIDR). The aggragation len can be changed
during a show by pressing the &lsquo;A&rsquo; key, and
turned Off by empty string. <br>
Hint: Please use 0 to reduce output just for network
services.</p>

<p style="margin-top: 1em">-c conf <br>
Use alternate color config file instead of default
/etc/trafshow.</p>

<p style="margin-top: 1em">-i name <br>
Listen on the specified network interface name. If
unspecified, TrafShow collect data from all network
interfaces, configured UP in the system. In the last case
the sys&acirc; <br>
tem must supply enough number of packet capture devices
(like /dev/bpf#).</p>

<p style="margin-top: 1em">-s str To search and follow for
list item matched by string, moving the cursor bar. The
found item try to stay highlighted. The mode can be turned
Off by &lsquo;Ctrl-/&rsquo; key press or <br>
[re]entered again by &lsquo;/&rsquo; key directly in the
live show.</p>

<p style="margin-top: 1em">-u port <br>
Listen on the specified UDP port number for the Cisco
Netflow feed. The default port number is 9995. <br>
Hint: Please use 0 to disable this functionality.</p>

<p style="margin-top: 1em">-R refresh <br>
Set the refresh period of data show to seconds, 2 seconds by
default. This option can be changed during a show by
pressing the &lsquo;R&rsquo; key.</p>

<p style="margin-top: 1em">-P purge <br>
Set the expired data purge period to seconds, 10 seconds by
default. This option can be changed during a show by
pressing the &lsquo;P&rsquo; key.</p>

<p style="margin-top: 1em">-F file <br>
Use file as input for the filter expression.</p>

<p style="margin-top: 1em">expr Select which packets will
be displayed. If no expression is given, all packets on the
net will be displayed. Otherwise, only packets for which
expression is &lsquo;true&rsquo; will be <br>
displayed. <br>
The filter expression can be changed during a show by
pressing the &lsquo;F&rsquo; key, and turned Off by empty
string. <br>
Please see tcpdump(1) man page for syntax of filter
expression.</p>

<p style="margin-top: 1em">FILES <br>
/etc/trafshow <br>
The default colors configuration file if any.</p>

<p style="margin-top: 1em">$HOME/.trafshow <br>
The personal file with the user defined colors.</p>

<p style="margin-top: 1em">COLORS <br>
If TrafShow has been compiled with modern curses libraries
such as Slang or Ncurses it been able to show colored
traffic on the color-capable terminal. Hopefully, no special
<br>
actions required to install them because your system has it
by default (leastwise last years).</p>

<p style="margin-top: 1em">The syntax of TrafShow color
configuration file as follow:</p>

<p style="margin-top: 1em">default fcolor:bcolor <br>
Set the default screen background color-pair</p>

<p style="margin-top: 1em">port[/proto] fcolor:bcolor <br>
Set color pattern by service port</p>

<p style="margin-top: 1em">[proto] src[/mask][,port]
dst[/mask][,port] fcolor:bcolor <br>
Set color pattern by pair of source and destination
addresses</p>

<p style="margin-top: 1em">The tokens *, any, or all matchs
ANY in the pattern. Where fcolor is foreground color and
bcolor is background color. <br>
The fcolor and bcolor may be one of the following:</p>

<p style="margin-top: 1em">black red green yellow blue
magenta cyan white <br>
It posible to indicate color as number from 0 to 7.</p>

<p style="margin-top: 1em">The upper-case Fcolor mean
bright on. The upper-case Bcolor mean blink on.</p>

<p style="margin-top: 1em">SEE ALSO <br>
pcap(3), tcpdump(1), bpf(4)</p>

<p style="margin-top: 1em">ACKNOWLEDGEMENTS <br>
Thanks to Van Jacobson &lt;van(at)helios.ee.lbl.gov&gt; and
Steven McCanne &lt;mccanne(at)helios.ee.lbl.gov&gt;, all of
Lawrence Berkeley Laboratory, University of California,
Berkeley. <br>
Special thank to Jun-ichiro itojun Hagino
&lt;itojun(at)iijlab.net&gt; for IPv6 patches.</p>

<p style="margin-top: 1em">AUTHOR <br>
Vladimir Vorobyev &lt;bob(at)turbo.nsk.su&gt;.</p>

<p style="margin-top: 1em">BUGS <br>
Depending of traffic volume, TrafShow can take a lot of CPU
cycles and memory. <br>
It is impossible to use packet matching expressions in the
NetFlow mode.</p>

<p style="margin-top: 1em">May 2004 TRAFSHOW(1)</p>
<hr>
</body>
</html>
