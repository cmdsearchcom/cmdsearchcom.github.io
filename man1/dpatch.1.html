<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:05:12 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>DPATCH(1) dpatch DPATCH(1)</p>

<p style="margin-top: 1em">NAME <br>
dpatch - patch maintenance system for Debian</p>

<p style="margin-top: 1em">SYNOPSIS <br>
dpatch [options] command [command-arguments]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
dpatch is an easy to use patch system for Debian packages,
somewhat similar to the dbs package, but much simpler to
use.</p>

<p style="margin-top: 1em">It lets you store patches and
other simple customization templates in debian/patches and
otherwise does not require much reorganization of your
source tree. To get the patches <br>
applied at build time you simply need to include a makefile
snippet and then depend on the patch/unpatch target in the
build or clean stage of debian/rules. For added
flexibil&acirc; <br>
ity, you can call /usr/bin/dpatch directly too.</p>

<p style="margin-top: 1em">WARNING <br>
dpatch is deprecated, please switch to the &lsquo;3.0
(quilt)&rsquo; Debian source package format instead. See
http://wiki.debian.org/Projects/DebSrc3.0#FAQ for a short
guide on how to do <br>
it.</p>

<p style="margin-top: 1em">GLOBAL OPTIONS <br>
There are a few options which change the overall behaviour
of dpatch, and have an effect on not only one, but most of
the available commands.</p>

<p style="margin-top: 1em">These global options are:</p>

<p style="margin-top: 1em">--workdir (-d) DIRECTORY <br>
By default, dpatch applies patches to the source tree it was
run from. With this option, one can change that, and tell
dpatch to work on a different tree, although taking <br>
the dpatches from the current one.</p>

<p style="margin-top: 1em">Note that this will only pass a
second argument to dpatch scriptlets, and will not change to
the specified directory. To do that, use the --chdir option
explained below.</p>

<p style="margin-top: 1em">--chdir (-c) <br>
When using a different working directory than the current
one, change there before trying to apply patches.</p>

<p style="margin-top: 1em">This should be used together
with the --workdir option.</p>

<p style="margin-top: 1em">--strict (-S) <br>
Enable strict mode, which means that dpatch will bail out
early even on warnings (like when trying to apply a patch
which is already applied - normally it will simply skip <br>
it).</p>

<p style="margin-top: 1em">--force (-F) <br>
Force the application or deapplication of patches, even if
dpatch would normally skip them because the operation was
already done earlier.</p>

<p style="margin-top: 1em">--with-cpp <br>
Force the use of cpp. Overrides use of DPATCH_OPTION_CPP=1
option in debian/patches/00options file.</p>

<p style="margin-top: 1em">COMMANDS <br>
Patch handling commands <br>
There is a generic syntax for all patch handling commands,
namely that, that the command itself takes a list of dpatch
names to work with, then does what it is meant to do on all
<br>
of them, in the exact same order it was specified on the
command line.</p>

<p style="margin-top: 1em">Then, there is a version of each
patch handling command with an -all suffix, which does not
take any arguments, and performs the necessary action for
each and every available <br>
dpatch.</p>

<p style="margin-top: 1em">The last variation is a command
with a -until or -up-to suffix, which takes only one
argument: the name of a dpatch. The appropriate action will
be performed on all dpatches up <br>
to and including this specified one.</p>

<p style="margin-top: 1em">apply [options] <br>
patch [options] <br>
Applies one or more dpatches to the working tree (the
current directory, if not told otherwise). By default the
specified patches will be applied in the exact same order
<br>
they were specified.</p>

<p style="margin-top: 1em">Options <br>
--stampdir=directory, -s=directory <br>
Put stamp files into directory instead of the default
debian/patched. <br>
--help (-h) <br>
Print a short help message about the command. <br>
--quiet (-q) <br>
Forces the command to not print anything. <br>
--verbose (-v) <br>
Disables hiding of the scriptlet output.</p>

<p style="margin-top: 1em">deapply [options] <br>
unpatch [options] <br>
Deapplies one or more dpatches to the working tree (the
current directory, if not told otherwise). By default the
specified patches will be deapplied in the reverse order
<br>
they were specified as one generally should deapply in
reverse order (compared to the apply order, that is).</p>

<p style="margin-top: 1em">Options <br>
--stampdir=directory, -s=directory <br>
Use stamp files in directory instead of the default
debian/patched. <br>
--help (-h) <br>
Print a short help message about the command. <br>
--quiet (-q) <br>
Forces the command to not print anything. <br>
--verbose (-v) <br>
Disables hiding of the scriptlet output.</p>

<p style="margin-top: 1em">cat [options] <br>
Print meta-information about a dpatch, such as its name,
author and description (any of which can be disabled with
the appropriate option).</p>

<p style="margin-top: 1em">Options <br>
--no-meta, --desc-only (-nm, -d) <br>
Only print the patch description. <br>
--author-only (-a) <br>
Only print the author of the patch. <br>
--no-desc, (-nd) <br>
Do not print the patch description. <br>
--help (-h) <br>
Print a short help message about the command. <br>
--quiet (-q) <br>
Forces the command to not print anything.</p>

<p style="margin-top: 1em">list [options] <br>
List the name of the given patches. This commands is not
really useful, except the list-all variant, which lists all
available patches.</p>

<p style="margin-top: 1em">Options <br>
--help (-h) <br>
Print a short help message about the command.</p>

<p style="margin-top: 1em">status [options] <br>
Prints the status of the given patches - whether they are
applied to the working tree or not.</p>

<p style="margin-top: 1em">Options <br>
--stampdir=directory, -s=directory <br>
Use stamp files in directory instead of the default
debian/patched. <br>
--help (-h) <br>
Print a short help message about the command. <br>
--quiet (-q) <br>
Forces the command to not print anything.</p>

<p style="margin-top: 1em">log [options] <br>
Displays the log of the given patching attempts.</p>

<p style="margin-top: 1em">Options <br>
--stampdir=directory, -s=directory <br>
Use stamp files in directory instead of the default
debian/patched. <br>
--help (-h) <br>
Print a short help message about the command. <br>
--quiet (-q) <br>
Forces the command to not print anything, but the logs
without extra sugar on top.</p>

<p style="margin-top: 1em">call [options] <br>
Call a dpatch with a user-specified argument. All arguments
with a pkg- prefix is guaranteed to be unused by dpatch
itself, and are reserved for use with this very com&acirc;
<br>
mand.</p>

<p style="margin-top: 1em">This command is most useful for
extracting custom meta-information from dpatch
scriptlets.</p>

<p style="margin-top: 1em">Options <br>
--argument=arg (-a=arg) <br>
Call patches with arg as argument. <br>
--help (-h) <br>
Print a short help message about the command. <br>
--quiet (-q) <br>
Forces the command to not print anything.</p>

<p style="margin-top: 1em">Miscellaneous commands <br>
patch-template [options] [patchname] [description] <br>
Print a quasi-standard dpatch script template, based on the
information give on the command-line. If a description
given, it will be folded at about 72 characters into <br>
multiple lines appropriately.</p>

<p style="margin-top: 1em">When prepending the template to
STDIN, the contents of the standard input will be printed
right after the template.</p>

<p style="margin-top: 1em">Options <br>
--prepend (-p) <br>
Prepend the template to STDIN. <br>
--help (-h) <br>
Print a short help message about the command.</p>

<p style="margin-top: 1em">help (--help, -h) [command] <br>
Attempt to give a little more detailed help about dpatch
itself, or about a given dpatch command.</p>

<p style="margin-top: 1em">version <br>
Prints the dpatch version number and exits.</p>

<p style="margin-top: 1em">DPATCH IN DEBIAN PACKAGES <br>
There are two different ways to use dpatch in debian/rules:
calling it directly, or including dpatch.make(7). Only the
former method will be described here - the latter has its
<br>
own manual page.</p>

<p style="margin-top: 1em">NOTE: The following examples
also require adding the .NOTPARALLEL flag to the head of
debian/rules since the dependency lists rely on the order of
the execution. Without .NOTPAR&acirc; <br>
ALLEL, they execution order may be wrong with multiple make
threads (the -j option).</p>

<p style="margin-top: 1em">In most situations, one will
want to run dpatch as soon during the build process, as
possible. How that can be accomplished depends heavily on
the existing debian/rules. However, <br>
in common practice most packages have a build (or
build-stamp), config.status, or configure (or
configure-stamp) target. The easiest way to make dpatching
the very first thing, <br>
one only has to write a rule that calls dpatch, and add it
to the list of prerequisites for the appropriate target (see
above).</p>

<p style="margin-top: 1em">Deapplying dpatches can be easy
or a bit more tricky. If nothing in the clean rule touches
files modified by dpatches (creating incompatible changes),
you can safely add unpatch <br>
to the list of the clean rules dependencies.</p>

<p style="margin-top: 1em">If the patches might affect the
build system, they should be deapplied after the source tree
has been cleaned. To do this, rename the clean target to,
say, clean-patched, write a <br>
rule that calls dpatch to deapply the dpatches, and make a
new clean rule that has clean-patched and unpatch as its
prerequisites.</p>

<p style="margin-top: 1em">Let us look at an example!
First, let us look at the relevant parts of the original
debian/rules of our imaginary package:</p>

<p style="margin-top: 1em">config.status: configure <br>
./configure --prefix=/usr --mandir=/usr/share <br>
build: config.status <br>
${MAKE} <br>
clean: <br>
$(testdir) <br>
$(testroot) <br>
${MAKE} distclean <br>
rm -rf debian/imaginary-package debian/files
debian/substvars</p>

<p style="margin-top: 1em">After dpatchifying, this would
look like this:</p>

<p style="margin-top: 1em">config.status: patch configure
<br>
./configure --prefix=/usr --mandir=/usr/share <br>
build: config.status <br>
${MAKE} <br>
clean: clean-patched unpatch <br>
clean-patched: <br>
$(testdir) <br>
$(testroot) <br>
${MAKE} distclean <br>
rm -rf debian/imaginary-package debian/files
debian/substvars</p>

<p style="margin-top: 1em">patch: patch-stamp <br>
patch-stamp: <br>
dpatch apply-all <br>
dpatch cat-all &gt;patch-stamp</p>

<p style="margin-top: 1em">unpatch: <br>
dpatch deapply-all <br>
rm -rf patch-stamp debian/patched</p>

<p style="margin-top: 1em">Adding dpatch scriptlets to a
package <br>
When using dpatch, one surely wants to tell the system what
dpatches to apply, and which ones to discard. In the most
common situation, one only needs to list the names of the
<br>
dpatches (the filenames relative to debian/patches) in
debian/patches/00list. They usually have the extension
.dpatch and the extension can be omitted, thus a file <br>
debian/patches/01_one_patch.dpatch is written as
01_one_patch inside debian/patches/00list</p>

<p style="margin-top: 1em">However, there may be situations
where something more flexible is needed, like applying the
same patch on only two architectures, say, m68k and powerpc.
One solve this in at <br>
least two very different ways: One is to list the same patch
in both debian/patches/00list.m68k and
debian/patches/00list.powerpc, the other is to use
DPATCH_OPTION_CPP=1 in <br>
debian/patches/00options. 00list file is passed through cpp
command with DEB_BUILD_ARCH variable set to the
architecture, and DEB_BUILD_ARCH_architecture being set to
1. With <br>
cpp, our sample debian/patches/00list might look like
this:</p>

<p style="margin-top: 1em">01_manpage_typo <br>
#if defined(DEB_BUILD_ARCH_m68k) ||
defined(DEB_BUILD_ARCH_powerpc) <br>
/* This patch fixes a random build-time breakage on
Macintosh boxen. */ <br>
02_macintosh_foo <br>
#endif</p>

<p style="margin-top: 1em">Creating dpatch scriptlets <br>
There are many ways to create dpatch scriptlets. They are
simple, executable files, which follow a standardised
calling convention (documented in dpatch(7)).</p>

<p style="margin-top: 1em">You can fire up your $EDITOR, or
use dpatch-edit-patch, and you should be all set.</p>

<p style="margin-top: 1em">For most cases, where the dpatch
file is only to apply a simple patch, there is an even
easier way:</p>

<p style="margin-top: 1em">dpatch patch-template -p
&quot;01_some_patch&quot; &quot;A random patch&quot;
&lt;random.diff &gt;debian/patches/01_some_patch.dpatch</p>

<p style="margin-top: 1em">FILES <br>
debian/patches/00list <br>
The list of patches to apply, deapply, or otherwise fiddle
with.</p>

<p style="margin-top: 1em">debian/patches/00list.arch <br>
List of patches to work with - additionally to the common
list in debian/patches/00list -, when building on the arch
architecture.</p>

<p style="margin-top: 1em">/etc/dpatch.conf <br>
System-wide configuration file for dpatch, for setting
global options permanently.</p>

<p style="margin-top: 1em">~/.dpatch.conf <br>
Per-user configuration file, for setting global options
permanently.</p>

<p style="margin-top: 1em">AUTHORS <br>
dpatch was written by Joerg Jaspert, David B Harris, Gergely
Nagy, Junichi Uekawa and others.</p>

<p style="margin-top: 1em">This manual page was written by
Gergely Nagy, and updated by Junichi Uekawa</p>

<p style="margin-top: 1em">SEE ALSO <br>
dpatch(7), dpatch.make(7), dpatch-edit-patch(1),
dpatch-list-patch(1), dpatch-convert-diffgz(1)</p>

<p style="margin-top: 1em">DPATCH 2 Dec 13 2011
DPATCH(1)</p>
<hr>
</body>
</html>
