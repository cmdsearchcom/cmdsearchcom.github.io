<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>MK-PARALLEL-DUMP(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">MK-PARALLEL-DUMP(1)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">MK-PARALLEL-DUMP(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
mk-parallel-dump - (DEPRECATED) Dump MySQL tables in parallel.
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
This tool is deprecated because after several complete redesigns, we concluded
  that Perl is the wrong technology for this task. Read &quot;RISKS&quot; before
  you use it, please. It remains useful for some people who we know aren't
  depending on it in production, and therefore we are not removing it from the
  distribution.
<div class="Pp"></div>
Usage: mk-parallel-dump [OPTION...] [DSN]
<div class="Pp"></div>
mk-parallel-dump dumps MySQL tables in parallel to make some data loading
  operations more convenient. IT IS NOT A BACKUP TOOL!
<div class="Pp"></div>
Dump all databases and tables to the current directory:
<div class="Pp"></div>
<pre>
  mk-parallel-dump
</pre>
<div class="Pp"></div>
Dump all databases and tables via SELECT INTO OUTFILE to /tmp/dumps:
<div class="Pp"></div>
<pre>
  mk-parallel-dump --tab --base-dir /tmp/dumps
</pre>
<div class="Pp"></div>
Dump only table db.foo in chunks of ten thousand rows using 8 threads:
<div class="Pp"></div>
<pre>
  mk-parallel-dump --databases db --tables foo \
     --chunk-size 10000 --threads 8
</pre>
<div class="Pp"></div>
Dump tables in chunks of approximately 10kb of data (not ten thousand rows!):
<div class="Pp"></div>
<pre>
  mk-parallel-dump --chunk-size 10k
</pre>
<h1 class="Sh" title="Sh" id="RISKS"><a class="selflink" href="#RISKS">RISKS</a></h1>
The following section is included to inform users about the potential risks,
  whether known or unknown, of using this tool. The two main categories of risks
  are those created by the nature of the tool (e.g. read-only tools vs.
  read-write tools) and those created by bugs.
<div class="Pp"></div>
mk-parallel-dump is not a backup program! It is only designed for fast data
  exports, for purposes such as quickly loading data into test systems. Do not
  use mk-parallel-dump for backups.
<div class="Pp"></div>
At the time of this release there is a bug that prevents
  &quot;--lock-tables&quot; from working correctly, an unconfirmed bug that
  prevents the tool from finishing, a bug that causes the wrong character set to
  be used, and a bug replacing default values.
<div class="Pp"></div>
The authoritative source for updated information is always the online issue
  tracking system. Issues that affect this tool will be marked as such. You can
  see a list of such issues at the following URL:
  &lt;http://www.maatkit.org/bugs/mk-parallel-dump&gt;.
<div class="Pp"></div>
See also &quot;BUGS&quot; for more information on filing bugs and getting help.
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
mk-parallel-dump connects to a MySQL server, finds database and table names, and
  dumps them in parallel for speed. Only tables and data are dumped; view
  definitions or any kind of stored code (triggers, events, routines,
  procedures, etc.) are not dumped. However, if you dump the &quot;mysql&quot;
  database, you'll be dumping the stored routines anyway.
<div class="Pp"></div>
Exit status is 0 if everything went well, 1 if any chunks failed, and any other
  value indicates an internal error.
<div class="Pp"></div>
To dump all tables to uncompressed text files in the current directory, each
  database with its own directory, with a global read lock, flushing and
  recording binary log positions, each table in a single file:
<div class="Pp"></div>
<pre>
  mk-parallel-dump
</pre>
<div class="Pp"></div>
To dump tables elsewhere:
<div class="Pp"></div>
<pre>
  mk-parallel-dump --base-dir /path/to/elsewhere
</pre>
<div class="Pp"></div>
To dump to tab-separated files with &quot;SELECT INTO OUTFILE&quot;, each table
  with separate data and SQL files:
<div class="Pp"></div>
<pre>
  mk-parallel-dump --tab
</pre>
<div class="Pp"></div>
mk-parallel-dump doesn't clean out any destination directories before dumping
  into them. You can move away the old destination, then remove it after a
  successful dump, with a shell script like the following:
<div class="Pp"></div>
<pre>
   #!/bin/sh
   CNT=`ls | grep -c old`;
   if [ -d default ]; then mv default default.old.$CNT;
   mk-parallel-dump
   if [ $? != 0 ]
   then
      echo &quot;There were errors, not purging old sets.&quot;
   else
      echo &quot;No errors during dump, purging old sets.&quot;
      rm -rf default.old.*
   fi
</pre>
<div class="Pp"></div>
mk-parallel-dump checks whether files have been created before dumping. If the
  file has been created, it skips the table or chunk that would have created the
  file. This makes it possible to resume dumps. If you don't want this behavior,
  and instead you want a full dump, then move away the old files or specify
  &quot;--[no]resume&quot;.
<h1 class="Sh" title="Sh" id="CHUNKS"><a class="selflink" href="#CHUNKS">CHUNKS</a></h1>
mk-parallel-dump can break your tables into chunks when dumping, and put
  approximately the amount of data you specify into each chunk. This is useful
  for two reasons:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">A table that is dumped in chunks can be dumped in many
      threads simultaneously.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Dumping in chunks creates small files, which can be
      imported more efficiently and safely. Importing a single huge file can be
      a lot of extra work for transactional storage engines like InnoDB. A huge
      file can create a huge rollback segment in your tablespace. If the import
      fails, the rollback can take a very long time.</dd>
</dl>
<div class="Pp"></div>
To dump in chunks, specify the &quot;--chunk-size&quot; option. This option is
  an integer with an optional suffix. Without the suffix, it's the number of
  rows you want in each chunk. With the suffix, it's the approximate size of the
  data.
<div class="Pp"></div>
mk-parallel-dump tries to use index statistics to calculate where the boundaries
  between chunks should be. If the values are not evenly distributed, some
  chunks can have a lot of rows, and others may have very few or even none. Some
  chunks can exceed the size you want.
<div class="Pp"></div>
When you specify the size with a suffix, the allowed suffixes are k, M and G,
  for kibibytes, mebibytes, and gibibytes, respectively. mk-parallel-dump
  doesn't know anything about data size. It asks MySQL (via &quot;SHOW TABLE
  STATUS&quot;) how long an average row is in the table, and converts your
  option to a number of rows.
<div class="Pp"></div>
Not all tables can be broken into chunks. mk-parallel-dump looks for an index
  whose leading column is numeric (integers, real numbers, and date and time
  types). It prefers the primary key if its first column is chunk-able.
  Otherwise it chooses the first chunk-able column in the table.
<div class="Pp"></div>
Generating a series of &quot;WHERE&quot; clauses to divide a table into
  evenly-sized chunks is difficult. If you have any ideas on how to improve the
  algorithm, please write to the author (see &quot;BUGS&quot;).
<h1 class="Sh" title="Sh" id="OUTPUT"><a class="selflink" href="#OUTPUT">OUTPUT</a></h1>
Output depends on &quot;--verbose&quot;, &quot;--progress&quot;,
  &quot;--dry-run&quot; and &quot;--quiet&quot;. If &quot;--dry-run&quot; is
  specified mk-parallel-dump prints the commands or SQL statements that it would
  use to dump data but it does not actually dump any data. If
  &quot;--quiet&quot; is specified there is no output; this overrides all other
  options that affect the output.
<div class="Pp"></div>
The default output is something like the following example:
<div class="Pp"></div>
<pre>
  CHUNK  TIME  EXIT  SKIPPED DATABASE.TABLE 
     db  0.28     0        0 sakila         
    all  0.28     0        0 -
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">CHUNK</dt>
  <dd class="It-tag">The CHUNK column signifies what kind of information is in
      the line:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  Value  Meaning
  =====  ========================================================
  db     This line contains summary information about a database.
  tbl    This line contains summary information about a table.
  &lt;int&gt;  This line contains information about the Nth chunk of a
         table.
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    The types of lines you'll see depend on the &quot;--chunk-size&quot; option
      and &quot;--verbose&quot; options. mk-parallel-dump treats everything as a
      chunk. If you don't specify &quot;--chunk-size&quot;, then each table is
      one big chunk and each database is a chunk (of all its tables). Thus,
      there is output for numbered table chunks (&quot;--chunk-size&quot;),
      table chunks, and database chunks.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">TIME</dt>
  <dd class="It-tag">The TIME column shows the wallclock time elapsed while the
      chunk was dumped. If CHUNK is &quot;db&quot; or &quot;tbl&quot;, this time
      is the total wallclock time elapsed for the database or table.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">EXIT</dt>
  <dd class="It-tag">The EXIT column shows the exit status of the chunk. Any
      non-zero exit signifies an error. The cause of errors are usually printed
      to STDERR.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">SKIPPED</dt>
  <dd class="It-tag">The SKIPPED column shows how many chunks were skipped.
      These are not errors. Chunks are skipped if the dump can be resumed. See
      &quot;--[no]resume&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">DATABASE.TABLE</dt>
  <dd class="It-tag">The DATABASE.TABLE column shows to which table the chunk
      belongs. For &quot;db&quot; chunks, this shows just the database. Chunks
      are printed when they complete, and this is often out of the order you'd
      expect. For example, you might see a chunk for db1.table_1, then a chunk
      for db2.table_2, then another chunk for db1.table_1, then the
      &quot;db&quot; chunk summary for db2.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">PROGRESS</dt>
  <dd class="It-tag">If you specify &quot;--progress&quot;, then the tool adds a
      PROGRESS column after DATABASE.TABLE, which contains text similar to the
      following:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  PROGRESS
  4.10M/4.10M 100.00% ETA ... 00:00 (2009-10-16T15:37:49)
  done at 2009-10-16T15:37:48, 1 databases, 16 tables, 16 chunks
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    This column shows information about the amount of data dumped so far, the
      amount of data left to dump, and an ETA (&quot;estimated time of
      arrival&quot;). The ETA is a best-effort prediction when everything will
      be finished dumping. Sometimes the ETA is very accurate, but at other
      times it can be significantly wrong.</dd>
</dl>
<div class="Pp"></div>
The final line of the output is special: it summarizes all chunks (all table
  chunks, tables and databases).
<div class="Pp"></div>
If you specify &quot;--verbose&quot; once, then the output includes
  &quot;tbl&quot; CHUNKS:
<div class="Pp"></div>
<pre>
  CHUNK  TIME  EXIT  SKIPPED DATABASE.TABLE 
    tbl  0.07     0        0 sakila.payment 
    tbl  0.08     0        0 sakila.rental  
    tbl  0.03     0        0 sakila.film    
     db  0.28     0        0 sakila         
    all  0.28     0        0 -
</pre>
<div class="Pp"></div>
And if you specify &quot;--verbose&quot; twice in conjunction with
  &quot;--chunk-size&quot;, then the output includes the chunks:
<div class="Pp"></div>
<pre>
  CHUNK  TIME  EXIT  SKIPPED DATABASE.TABLE       
      0  0.03     0        0 sakila.payment       
      1  0.03     0        0 sakila.payment      
    tbl  0.10     0        0 sakila.payment
      0  0.01     0        1 sakila.store         
    tbl  0.02     0        1 sakila.store         
     db  0.20     0        1 sakila               
    all  0.21     0        1 -
</pre>
<div class="Pp"></div>
The output shows that &quot;sakila.payment&quot; was dumped in two chunks, and
  &quot;sakila.store&quot; was dumped in one chunk that was skipped.
<h1 class="Sh" title="Sh" id="SPEED_OF_PARALLEL_DUMPS"><a class="selflink" href="#SPEED_OF_PARALLEL_DUMPS">SPEED
  OF PARALLEL DUMPS</a></h1>
How much faster is it to dump in parallel? That depends on your hardware and
  data. You may be able dump files twice as fast, or more if you have lots of
  disks and CPUs. At the time of writing, no benchmarks exist for the current
  release. User-contributed results for older versions of mk-parallel-dump
  showed very good speedup depending on the hardware. Here are two links you can
  use as reference:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;http://www.paragon-cs.com/wordpress/?p=52&gt;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;http://mituzas.lt/2009/02/03/mydumper/&gt;</dd>
</dl>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
&quot;--lock-tables&quot; and &quot;--[no]flush-lock&quot; are mutually
  exclusive.
<div class="Pp"></div>
This tool accepts additional command-line arguments. Refer to the
  &quot;SYNOPSIS&quot; and usage information for details.
<dl class="Bl-tag">
  <dt class="It-tag">--ask-pass</dt>
  <dd class="It-tag">Prompt for a password when connecting to MySQL.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--base-dir</dt>
  <dd class="It-tag">type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    The base directory in which files will be stored.
    <div style="height: 1.00em;">&#x00A0;</div>
    The default is the current working directory. Each database gets its own
      directory under the base directory. So if the base directory is
      &quot;/tmp&quot; and database &quot;foo&quot; is dumped, then the
      directory &quot;/tmp/foo&quot; is created which contains all the table
      dump files for &quot;foo&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--[no]biggest-first</dt>
  <dd class="It-tag">default: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Process tables in descending order of size (biggest to smallest).
    <div style="height: 1.00em;">&#x00A0;</div>
    This strategy gives better parallelization. Suppose there are 8 threads and
      the last table is huge. We will finish everything else and then be running
      single-threaded while that one finishes. If that one runs first, then we
      will have the max number of threads running at a time for as long as
      possible.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--[no]bin-log-position</dt>
  <dd class="It-tag">default: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Dump the master/slave position.
    <div style="height: 1.00em;">&#x00A0;</div>
    Dump binary log positions from both &quot;SHOW MASTER STATUS&quot; and
      &quot;SHOW SLAVE STATUS&quot;, whichever can be retrieved from the server.
      The data is dumped to a file named <i>00_master_data.sql</i> in the
      &quot;--base-dir&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    The file also contains details of each table dumped, including the WHERE
      clauses used to dump it in chunks.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--charset</dt>
  <dd class="It-tag">short form: -A; type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Default character set. If the value is utf8, sets Perl's binmode on STDOUT
      to utf8, passes the mysql_enable_utf8 option to DBD::mysql, and runs SET
      NAMES UTF8 after connecting to MySQL. Any other value sets binmode on
      STDOUT without the utf8 layer, and runs SET NAMES after connecting to
      MySQL.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--chunk-size</dt>
  <dd class="It-tag">type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Number of rows or data size to dump per file.
    <div style="height: 1.00em;">&#x00A0;</div>
    Specifies that the table should be dumped in segments of approximately the
      size given. The syntax is either a plain integer, which is interpreted as
      a number of rows per chunk, or an integer with a suffix of G, M, or k,
      which is interpreted as the size of the data to be dumped in each chunk.
      See &quot;CHUNKS&quot; for more details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--client-side-buffering</dt>
  <dd class="It-tag">Fetch and buffer results in memory on client.
    <div style="height: 1.00em;">&#x00A0;</div>
    By default this option is not enabled because it causes data to be
      completely fetched from the server then buffered in-memory on the client.
      For large dumps this can require a lot of memory
    <div style="height: 1.00em;">&#x00A0;</div>
    Instead, the default (when this option is not specified) is to fetch and
      dump rows one-by-one from the server. This requires a lot less memory on
      the client but can keep the tables on the server locked longer.
    <div style="height: 1.00em;">&#x00A0;</div>
    Use this option only if you're sure that the data being dumped is relatively
      small and the client has sufficient memory. Remember that, if this option
      is specified, all &quot;--threads&quot; will buffer their results
      in-memory, so memory consumption can increase by a factor of N
      &quot;--threads&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--config</dt>
  <dd class="It-tag">type: Array
    <div style="height: 1.00em;">&#x00A0;</div>
    Read this comma-separated list of config files; if specified, this must be
      the first option on the command line.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--csv</dt>
  <dd class="It-tag">Do &quot;--tab&quot; dump in CSV format (implies
      &quot;--tab&quot;).
    <div style="height: 1.00em;">&#x00A0;</div>
    Changes &quot;--tab&quot; options so the dump file is in comma-separated
      values (CSV) format. The SELECT INTO OUTFILE statement looks like the
      following, and can be re-loaded with the same options:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
   SELECT * INTO OUTFILE %D.%N.%6C.txt
   FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '\&quot;'
   LINES TERMINATED BY '\n' FROM %D.%N;
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--databases</dt>
  <dd class="It-tag">short form: -d; type: hash
    <div style="height: 1.00em;">&#x00A0;</div>
    Dump only this comma-separated list of databases.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--databases-regex</dt>
  <dd class="It-tag">type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Dump only databases whose names match this Perl regex.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--defaults-file</dt>
  <dd class="It-tag">short form: -F; type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Only read mysql options from the given file. You must give an absolute
      pathname.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--dry-run</dt>
  <dd class="It-tag">Print commands instead of executing them.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--engines</dt>
  <dd class="It-tag">short form: -e; type: hash
    <div style="height: 1.00em;">&#x00A0;</div>
    Dump only tables that use this comma-separated list of storage engines.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--[no]flush-lock</dt>
  <dd class="It-tag">Use &quot;FLUSH TABLES WITH READ LOCK&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    This is enabled by default. The lock is taken once, at the beginning of the
      whole process and is released after all tables have been dumped. If you
      want to lock only the tables you're dumping, use
      &quot;--lock-tables&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--flush-log</dt>
  <dd class="It-tag">Execute &quot;FLUSH LOGS&quot; when getting binlog
      positions.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option is NOT enabled by default because it causes the MySQL server to
      rotate its error log, potentially overwriting error messages.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--[no]gzip</dt>
  <dd class="It-tag">default: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Compress (gzip) SQL dump files; does not work with &quot;--tab&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    The IO::Compress::Gzip Perl module is used to compress SQL dump files as
      they are written to disk. The resulting dump files have a &quot;.gz&quot;
      extension, like &quot;table.000000.sql.gz&quot;. They can be uncompressed
      with gzip. mk-parallel-restore will automatically uncompress them, too,
      when restoring.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option does not work with &quot;--tab&quot; because the MySQL server
      writes the tab dump files directly using &quot;SELECT INTO
    OUTFILE&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--help</dt>
  <dd class="It-tag">Show help and exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--host</dt>
  <dd class="It-tag">short form: -h; type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Connect to host.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--ignore-databases</dt>
  <dd class="It-tag">type: Hash
    <div style="height: 1.00em;">&#x00A0;</div>
    Ignore this comma-separated list of databases.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--ignore-databases-regex</dt>
  <dd class="It-tag">type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Ignore databases whose names match this Perl regex.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--ignore-engines</dt>
  <dd class="It-tag">type: Hash; default: FEDERATED,MRG_MyISAM
    <div style="height: 1.00em;">&#x00A0;</div>
    Do not dump tables that use this comma-separated list of storage engines.
    <div style="height: 1.00em;">&#x00A0;</div>
    The schema file will be dumped as usual. This prevents dumping data for
      Federated tables and Merge tables.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--ignore-tables</dt>
  <dd class="It-tag">type: Hash
    <div style="height: 1.00em;">&#x00A0;</div>
    Ignore this comma-separated list of table names.
    <div style="height: 1.00em;">&#x00A0;</div>
    Table names may be qualified with the database name.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--ignore-tables-regex</dt>
  <dd class="It-tag">type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Ignore tables whose names match the Perl regex.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--lock-tables</dt>
  <dd class="It-tag">Use &quot;LOCK TABLES&quot; (disables
      &quot;--[no]flush-lock&quot;).
    <div style="height: 1.00em;">&#x00A0;</div>
    Disables &quot;--[no]flush-lock&quot; (unless it was explicitly set) and
      locks tables with &quot;LOCK TABLES READ&quot;. The lock is taken and
      released for every table as it is dumped.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--lossless-floats</dt>
  <dd class="It-tag">Dump float types with extra precision for lossless restore
      (requires &quot;--tab&quot;).
    <div style="height: 1.00em;">&#x00A0;</div>
    Wraps these types with a call to &quot;FORMAT()&quot; with 17 digits of
      precision. According to the comments in Google's patches, this will give
      lossless dumping and reloading in most cases. (I shamelessly stole this
      technique from them. I don't know enough about floating-point math to have
      an opinion).
    <div style="height: 1.00em;">&#x00A0;</div>
    This works only with &quot;--tab&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--password</dt>
  <dd class="It-tag">short form: -p; type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Password to use when connecting.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--pid</dt>
  <dd class="It-tag">type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Create the given PID file. The file contains the process ID of the script.
      The PID file is removed when the script exits. Before starting, the script
      checks if the PID file already exists. If it does not, then the script
      creates and writes its own PID to it. If it does, then the script checks
      the following: if the file contains a PID and a process is running with
      that PID, then the script dies; or, if there is no process running with
      that PID, then the script overwrites the file with its own PID and starts;
      else, if the file contains no PID, then the script dies.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--port</dt>
  <dd class="It-tag">short form: -P; type: int
    <div style="height: 1.00em;">&#x00A0;</div>
    Port number to use for connection.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--progress</dt>
  <dd class="It-tag">Display progress reports.
    <div style="height: 1.00em;">&#x00A0;</div>
    Progress is displayed each time a table or chunk of a table finishes
      dumping. Progress is calculated by measuring the average data size of each
      full chunk and assuming all bytes are created equal. The output is the
      completed and total bytes, the percent completed, estimated time
      remaining, and estimated completion time. For example:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  40.72k/112.00k  36.36% ETA 00:00 (2009-10-27T19:17:53)
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    If &quot;--chunk-size&quot; is not specified then each table is effectively
      one big chunk and the progress reports are pretty accurate. When
      &quot;--chunk-size&quot; is specified the progress reports can be skewed
      because of averaging.
    <div style="height: 1.00em;">&#x00A0;</div>
    Progress reports are inaccurate when a dump is resumed. This is known issue
      and will be fixed in a later release.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--quiet</dt>
  <dd class="It-tag">short form: -q
    <div style="height: 1.00em;">&#x00A0;</div>
    Quiet output; disables &quot;--verbose&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--[no]resume</dt>
  <dd class="It-tag">default: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Resume dumps.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--set-vars</dt>
  <dd class="It-tag">type: string; default: wait_timeout=10000
    <div style="height: 1.00em;">&#x00A0;</div>
    Set these MySQL variables. Immediately after connecting to MySQL, this
      string will be appended to SET and executed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--socket</dt>
  <dd class="It-tag">short form: -S; type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Socket file to use for connection.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--stop-slave</dt>
  <dd class="It-tag">Issue &quot;STOP SLAVE&quot; on server before dumping data.
    <div style="height: 1.00em;">&#x00A0;</div>
    This ensures that the data is not changing during the dump. Issues
      &quot;START SLAVE&quot; after the dump is complete.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the slave is not running, throws an error and exits. This is to prevent
      possibly bad things from happening if the slave is not running because of
      a problem, or because someone intentionally stopped the slave for
      maintenance or some other purpose.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--tab</dt>
  <dd class="It-tag">Dump tab-separated (sets &quot;--umask&quot; 0).
    <div style="height: 1.00em;">&#x00A0;</div>
    Dump via &quot;SELECT INTO OUTFILE&quot;, which is similar to what
      &quot;mysqldump&quot; does with the &quot;--tab&quot; option, but you're
      not constrained to a single database at a time.
    <div style="height: 1.00em;">&#x00A0;</div>
    Before you use this option, make sure you know what &quot;SELECT INTO
      OUTFILE&quot; does! I recommend using it only if you're running
      mk-parallel-dump on the same machine as the MySQL server, but there is no
      protection if you don't.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option sets &quot;--umask&quot; to zero so auto-created directories are
      writable by the MySQL server.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--tables</dt>
  <dd class="It-tag">short form: -t; type: hash
    <div style="height: 1.00em;">&#x00A0;</div>
    Dump only this comma-separated list of table names.
    <div style="height: 1.00em;">&#x00A0;</div>
    Table names may be qualified with the database name.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--tables-regex</dt>
  <dd class="It-tag">type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Dump only tables whose names match this Perl regex.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--threads</dt>
  <dd class="It-tag">type: int; default: 2
    <div style="height: 1.00em;">&#x00A0;</div>
    Number of threads to dump concurrently.
    <div style="height: 1.00em;">&#x00A0;</div>
    Specifies the number of parallel processes to run. The default is 2 (this is
      mk-parallel-dump, after all -- 1 is not parallel). On GNU/Linux machines,
      the default is the number of times 'processor' appears in
      <i>/proc/cpuinfo</i>. On Windows, the default is read from the
      environment. In any case, the default is at least 2, even when there's
      only a single processor.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--[no]tz-utc</dt>
  <dd class="It-tag">default: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Enable TIMESTAMP columns to be dumped and reloaded between different time
      zones. mk-parallel-dump sets its connection time zone to UTC and adds
      &quot;SET TIME_ZONE='+00:00'&quot; to the dump file. Without this option,
      TIMESTAMP columns are dumped and reloaded in the time zones local to the
      source and destination servers, which can cause the values to change. This
      option also protects against changes due to daylight saving time.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option is identical to &quot;mysqldump --tz-utc&quot;. In fact, the
      above text was copied from mysqldump's man page.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--umask</dt>
  <dd class="It-tag">type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Set the program's &quot;umask&quot; to this octal value.
    <div style="height: 1.00em;">&#x00A0;</div>
    This is useful when you want created files and directories to be readable or
      writable by other users (for example, the MySQL server itself).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--user</dt>
  <dd class="It-tag">short form: -u; type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    User for login if not current user.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--verbose</dt>
  <dd class="It-tag">short form: -v; cumulative: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Be verbose; can specify multiple times.
    <div style="height: 1.00em;">&#x00A0;</div>
    See &quot;OUTPUT&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--version</dt>
  <dd class="It-tag">Show version and exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--wait</dt>
  <dd class="It-tag">short form: -w; type: time; default: 5m
    <div style="height: 1.00em;">&#x00A0;</div>
    Wait limit when the server is down.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the MySQL server crashes during dumping, waits until the server comes
      back and then continues with the rest of the tables.
      &quot;mk-parallel-dump&quot; will check the server every second until this
      time is exhausted, at which point it will give up and exit.
    <div style="height: 1.00em;">&#x00A0;</div>
    This implements Peter Zaitsev's &quot;safe dump&quot; request: sometimes a
      dump on a server that has corrupt data will kill the server.
      mk-parallel-dump will wait for the server to restart, then keep going.
      It's hard to say which table killed the server, so no tables will be
      retried. Tables that were being concurrently dumped when the crash
      happened will not be retried. No additional locks will be taken after the
      server restarts; it's assumed this behavior is useful only on a server
      you're not trying to dump while it's in production.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--[no]zero-chunk</dt>
  <dd class="It-tag">default: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Add a chunk for rows with zero or zero-equivalent values. The only has an
      effect when &quot;--chunk-size&quot; is specified. The purpose of the zero
      chunk is to capture a potentially large number of zero values that would
      imbalance the size of the first chunk. For example, if a lot of negative
      numbers were inserted into an unsigned integer column causing them to be
      stored as zeros, then these zero values are captured by the zero chunk
      instead of the first chunk and all its non-zero values.</dd>
</dl>
<h1 class="Sh" title="Sh" id="DSN_OPTIONS"><a class="selflink" href="#DSN_OPTIONS">DSN
  OPTIONS</a></h1>
These DSN options are used to create a DSN. Each option is given like
  &quot;option=value&quot;. The options are case-sensitive, so P and p are not
  the same option. There cannot be whitespace before or after the &quot;=&quot;
  and if the value contains whitespace it must be quoted. DSN options are
  comma-separated. See the maatkit manpage for full details.
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">A
    <div style="height: 1.00em;">&#x00A0;</div>
    dsn: charset; copy: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Default character set.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">D
    <div style="height: 1.00em;">&#x00A0;</div>
    dsn: database; copy: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Default database.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">F
    <div style="height: 1.00em;">&#x00A0;</div>
    dsn: mysql_read_default_file; copy: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Only read default options from the given file</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">h
    <div style="height: 1.00em;">&#x00A0;</div>
    dsn: host; copy: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Connect to host.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">p
    <div style="height: 1.00em;">&#x00A0;</div>
    dsn: password; copy: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Password to use when connecting.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">P
    <div style="height: 1.00em;">&#x00A0;</div>
    dsn: port; copy: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Port number to use for connection.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">S
    <div style="height: 1.00em;">&#x00A0;</div>
    dsn: mysql_socket; copy: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Socket file to use for connection.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">u
    <div style="height: 1.00em;">&#x00A0;</div>
    dsn: user; copy: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    User for login if not current user.</dd>
</dl>
<h1 class="Sh" title="Sh" id="DOWNLOADING"><a class="selflink" href="#DOWNLOADING">DOWNLOADING</a></h1>
You can download Maatkit from Google Code at
  &lt;http://code.google.com/p/maatkit/&gt;, or you can get any of the tools
  easily with a command like the following:
<div class="Pp"></div>
<pre>
   wget http://www.maatkit.org/get/toolname
   or
   wget http://www.maatkit.org/trunk/toolname
</pre>
<div class="Pp"></div>
Where &quot;toolname&quot; can be replaced with the name (or fragment of a name)
  of any of the Maatkit tools. Once downloaded, they're ready to run; no
  installation is needed. The first URL gets the latest released version of the
  tool, and the second gets the latest trunk code from Subversion.
<h1 class="Sh" title="Sh" id="ENVIRONMENT"><a class="selflink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
The environment variable &quot;MKDEBUG&quot; enables verbose debugging output in
  all of the Maatkit tools:
<div class="Pp"></div>
<pre>
   MKDEBUG=1 mk-....
</pre>
<h1 class="Sh" title="Sh" id="SYSTEM_REQUIREMENTS"><a class="selflink" href="#SYSTEM_REQUIREMENTS">SYSTEM
  REQUIREMENTS</a></h1>
You need Perl, DBI, DBD::mysql, and some core packages that ought to be
  installed in any reasonably new version of Perl.
<div class="Pp"></div>
This program works best on GNU/Linux. Filename quoting might not work well on
  Microsoft Windows if you have spaces or funny characters in your database or
  table names.
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
For a list of known bugs see
  &lt;http://www.maatkit.org/bugs/mk-parallel-dump&gt;.
<div class="Pp"></div>
Please use Google Code Issues and Groups to report bugs or request support:
  &lt;http://code.google.com/p/maatkit/&gt;. You can also join #maatkit on
  Freenode to discuss Maatkit.
<div class="Pp"></div>
Please include the complete command-line used to reproduce the problem you are
  seeing, the version of all MySQL servers involved, the complete output of the
  tool when run with &quot;--version&quot;, and if possible, debugging output
  produced by running with the &quot;MKDEBUG=1&quot; environment variable.
<h1 class="Sh" title="Sh" id="COPYRIGHT,_LICENSE_AND_WARRANTY"><a class="selflink" href="#COPYRIGHT,_LICENSE_AND_WARRANTY">COPYRIGHT,
  LICENSE AND WARRANTY</a></h1>
This program is copyright 2007-2011 Baron Schwartz. Feedback and improvements
  are welcome.
<div class="Pp"></div>
THIS PROGRAM IS PROVIDED &quot;AS IS&quot; AND WITHOUT ANY EXPRESS OR IMPLIED
  WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF
  MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
<div class="Pp"></div>
This program is free software; you can redistribute it and/or modify it under
  the terms of the GNU General Public License as published by the Free Software
  Foundation, version 2; OR the Perl Artistic License. On UNIX and similar
  systems, you can issue `man perlgpl' or `man perlartistic' to read these
  licenses.
<div class="Pp"></div>
You should have received a copy of the GNU General Public License along with
  this program; if not, write to the Free Software Foundation, Inc., 59 Temple
  Place, Suite 330, Boston, MA 02111-1307 USA.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
See also mk-parallel-restore.
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Baron Schwartz
<h1 class="Sh" title="Sh" id="ABOUT_MAATKIT"><a class="selflink" href="#ABOUT_MAATKIT">ABOUT
  MAATKIT</a></h1>
This tool is part of Maatkit, a toolkit for power users of MySQL. Maatkit was
  created by Baron Schwartz; Baron and Daniel Nichter are the primary code
  contributors. Both are employed by Percona. Financial support for Maatkit
  development is primarily provided by Percona and its clients.
<h1 class="Sh" title="Sh" id="VERSION"><a class="selflink" href="#VERSION">VERSION</a></h1>
This manual page documents Ver 1.0.28 Distrib 7540 $Revision: 7460 $.</div>
<table class="foot">
  <tr>
    <td class="foot-date">2011-06-08</td>
    <td class="foot-os">perl v5.24.1</td>
  </tr>
</table>
</body>
</html>
