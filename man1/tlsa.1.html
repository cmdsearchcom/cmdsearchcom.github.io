<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>TLSA(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">TLSA(1)</td>
    <td class="head-vol">Internet / DNS</td>
    <td class="head-rtitle">TLSA(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
tlsa - Create and verify RFC-6698 TLSA DNS records
<h1 class="Sh" title="Sh" id="SYNTAX"><a class="selflink" href="#SYNTAX">SYNTAX</a></h1>
tlsa [ <b>-h</b>] [<b>--verify</b>] [<b>-create</b>] [<b>--version</b>]
  [<b>-4</b>] [ <b>-6</b><b>--insecure</b>] [<b>--resolv.conf
  /PATH/TO/RESOLV.CONF</b>] [ <b>--port PORT</b>] [<b>--starttls
  {auto,smtp,imap,pop3,ftp}</b>] [ <b>--protocol {tcp,udp,sctp}</b>]
  [<b>--ponly-rr</b>] [ <b>--rootkey /PATH/TO/ROOT.KEY</b>] [<b>--ca-cert
  /PATH/TO/CERTSTORE</b>] [ <b>--debug</b>] [<b>--quiet</b>] [<b>--certificate
  CERTIFICATE</b>] [ <b>--output {rfc,generic,both}</b>] [<b>--usage
  {0,1,2,3}</b>] [ <b>--selector {0,1}</b>] [<b>-mtype {0,1,2}</b>]
  <i>hostname</i>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
tlsa generates RFC-6698 TLSA DNS records. To generate these records for older
  nameserver implementations that do not yet support the TLSA record, specify
  <i>--output generic</i> to output the tlsa data in Generic Record (RFC-3597)
  format. Records are generated by connecting to the website using SSL and
  grabbing the (EE) certificate and the CA chain. Depending on the type and
  selector used, this information is used to generate TLSA records. Currently.
  tlsa has no AXFR support for en-mass TLSA record generation.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<b>--create</b>
<div style="margin-left: 4.00ex;">Create a TLSA record</div>
<div class="Pp"></div>
<b>--verify</b>
<div style="margin-left: 4.00ex;">Verify a TLSA record</div>
<div class="Pp"></div>
<b>--protocol</b> tcp | udp | sctp
<div style="margin-left: 4.00ex;">Use a specific transport protocol (default:
  tcp)</div>
<div class="Pp"></div>
<b>--resolvconf</b> FILE
<div style="margin-left: 4.00ex;">Specify a custom resolv.conf file (default:
  /etc/resolv.conf). Pass empty value (--resolvconf=&quot;&quot;) to disable
  default.</div>
<div class="Pp"></div>
<b>--port</b> PORT
<div style="margin-left: 4.00ex;">Use specified port (default: 443)</div>
<div class="Pp"></div>
<b>--starttls</b> no | smtp | imap | pop3 | ftp
<div style="margin-left: 4.00ex;">Start script type for protocols which need
  special commands to start a TLS connection. Supported are 'ftp' (port 21),
  'smtp' (port 25), 'pop3' (port 110) and 'imap' (port 143). The default selects
  the type based on the port number. The value 'no' overrides auto
  detection.</div>
<div class="Pp"></div>
<b>--only-rr</b>
<div style="margin-left: 4.00ex;">Only print the DNS TLSA record</div>
<div class="Pp"></div>
<b>--certificate</b> file.crt
<div style="margin-left: 4.00ex;">Use specified certificate file, instead of
  retrieving the certificate from the server. Can be a single cert or a complete
  chain.</div>
<div class="Pp"></div>
<b>--ca-cert</b> directory
<div style="margin-left: 4.00ex;">Use specified directory containing CA bundles
  for CA validation (default: /etc/pki/tls/certs)</div>
<div class="Pp"></div>
<b>--rootkey</b> filename
<div style="margin-left: 4.00ex;">Use specified file to read the DNSSEC root key
  (in anchor or bind format)</div>
<div class="Pp"></div>
<b>--output</b> rfc | generic | both
<div style="margin-left: 4.00ex;">Output format of TLSA record. &quot;TLSA&quot;
  for rfc, &quot;TYPE52&quot; for generic (default: rfc)</div>
<div class="Pp"></div>
<b>--usage</b> 0 | 1 | 2 | 3
<div style="margin-left: 4.00ex;">Usage type: public CA (0), EE match validated
  by public CA (1), private CA (2), private EE (3) (default: 3)</div>
<div class="Pp"></div>
<b>--selector</b> 0 | 1
<div style="margin-left: 4.00ex;">The selector type describes what the type
  covers - full certificate (0) or public key (1) (default: 0)</div>
<div class="Pp"></div>
<b>--mtype</b> 0 | 1 | 2
<div style="margin-left: 4.00ex;">Type of the TLSA data. Exact match on content
  (0), SHA256 (1) or SHA512 (2) (default: 0)</div>
<div class="Pp"></div>
If neither create or verify is specified, create is used.
<h1 class="Sh" title="Sh" id="REQUIREMENTS"><a class="selflink" href="#REQUIREMENTS">REQUIREMENTS</a></h1>
tlsa requires the following python libraries: unbound, m2crypto, argparse and
  ipaddr
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
ipv4/ipv6 handling
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
typical usage:
<div class="Pp"></div>
tlsa www.fedoraproject.org
<div class="Pp"></div>
tlsa --verify -4 nohats.ca
<div class="Pp"></div>
tlsa --create --insecure fedoraproject.org
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>sshfp</b>(1)<b>ssh-keygen</b>(1)and RFC-6698
<div class="Pp"></div>
<b>http://people.redhat.com/pwouters/hash-slinger/</b>
<div class="Pp"></div>
<b>http://os3sec.org/</b>
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
Pieter Lexis &lt;pieter.lexis@os3.nl&gt;
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
Copyright 2012
<div class="Pp"></div>
This program is free software; you can redistribute it and/or modify it under
  the terms of the GNU General Public License as published by the Free Software
  Foundation; either version 2 of the License, or (at your option) any later
  version. See &lt; <b>http://www.fsf.org/copyleft/gpl.txt</b>&gt;.
<div class="Pp"></div>
This program is distributed in the hope that it will be useful, but WITHOUT ANY
  WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
  A PARTICULAR PURPOSE. See the GNU General Public License (file COPYING in the
  distribution) for more details.</div>
<table class="foot">
  <tr>
    <td class="foot-date">December 7, 2015</td>
    <td class="foot-os">Paul Wouters</td>
  </tr>
</table>
</body>
</html>
