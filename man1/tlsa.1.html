<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:40:19 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>TLSA(1) Internet / DNS TLSA(1)</p>

<p style="margin-top: 1em">NAME <br>
tlsa - Create and verify RFC-6698 TLSA DNS records</p>

<p style="margin-top: 1em">SYNTAX <br>
tlsa [-h] [--verify] [-create] [--version] [-4]
[-6--insecure] [--resolv.conf /PATH/TO/RESOLV.CONF] [--port
PORT] [--starttls {auto,smtp,imap,pop3,ftp}] [--protocol
<br>
{tcp,udp,sctp}] [--ponly-rr] [--rootkey /PATH/TO/ROOT.KEY]
[--ca-cert /PATH/TO/CERTSTORE] [--debug] [--quiet]
[--certificate CERTIFICATE] [--output {rfc,generic,both}]
[--usage <br>
{0,1,2,3}] [--selector {0,1}] [-mtype {0,1,2}] hostname</p>

<p style="margin-top: 1em">DESCRIPTION <br>
tlsa generates RFC-6698 TLSA DNS records. To generate these
records for older nameserver implementations that do not yet
support the TLSA record, specify --output generic to <br>
output the tlsa data in Generic Record (RFC-3597) format.
Records are generated by connecting to the website using SSL
and grabbing the (EE) certificate and the CA chain. <br>
Depending on the type and selector used, this information is
used to generate TLSA records. Currently. tlsa has no AXFR
support for en-mass TLSA record generation.</p>

<p style="margin-top: 1em">OPTIONS <br>
--create <br>
Create a TLSA record</p>

<p style="margin-top: 1em">--verify <br>
Verify a TLSA record</p>

<p style="margin-top: 1em">--protocol tcp | udp | sctp <br>
Use a specific transport protocol (default: tcp)</p>

<p style="margin-top: 1em">--resolvconf FILE <br>
Specify a custom resolv.conf file (default:
/etc/resolv.conf). Pass empty value
(--resolvconf=&quot;&quot;) to disable default.</p>

<p style="margin-top: 1em">--port PORT <br>
Use specified port (default: 443)</p>

<p style="margin-top: 1em">--starttls no | smtp | imap |
pop3 | ftp <br>
Start script type for protocols which need special commands
to start a TLS connection. Supported are &rsquo;ftp&rsquo;
(port 21), &rsquo;smtp&rsquo; (port 25), &rsquo;pop3&rsquo;
(port 110) and &rsquo;imap&rsquo; (port <br>
143). The default selects the type based on the port number.
The value &rsquo;no&rsquo; overrides auto detection.</p>

<p style="margin-top: 1em">--only-rr <br>
Only print the DNS TLSA record</p>

<p style="margin-top: 1em">--certificate file.crt <br>
Use specified certificate file, instead of retrieving the
certificate from the server. Can be a single cert or a
complete chain.</p>

<p style="margin-top: 1em">--ca-cert directory <br>
Use specified directory containing CA bundles for CA
validation (default: /etc/pki/tls/certs)</p>

<p style="margin-top: 1em">--rootkey filename <br>
Use specified file to read the DNSSEC root key (in anchor or
bind format)</p>

<p style="margin-top: 1em">--output rfc | generic | both
<br>
Output format of TLSA record. &quot;TLSA&quot; for rfc,
&quot;TYPE52&quot; for generic (default: rfc)</p>

<p style="margin-top: 1em">--usage 0 | 1 | 2 | 3 <br>
Usage type: public CA (0), EE match validated by public CA
(1), private CA (2), private EE (3) (default: 3)</p>

<p style="margin-top: 1em">--selector 0 | 1 <br>
The selector type describes what the type covers - full
certificate (0) or public key (1) (default: 0)</p>

<p style="margin-top: 1em">--mtype 0 | 1 | 2 <br>
Type of the TLSA data. Exact match on content (0), SHA256
(1) or SHA512 (2) (default: 0)</p>

<p style="margin-top: 1em">If neither create or verify is
specified, create is used.</p>

<p style="margin-top: 1em">REQUIREMENTS <br>
tlsa requires the following python libraries: unbound,
m2crypto, argparse and ipaddr</p>

<p style="margin-top: 1em">BUGS <br>
ipv4/ipv6 handling</p>

<p style="margin-top: 1em">EXAMPLES <br>
typical usage:</p>

<p style="margin-top: 1em">tlsa www.fedoraproject.org</p>

<p style="margin-top: 1em">tlsa --verify -4 nohats.ca</p>

<p style="margin-top: 1em">tlsa --create --insecure
fedoraproject.org</p>

<p style="margin-top: 1em">SEE ALSO <br>
sshfp(1)ssh-keygen(1)and RFC-6698</p>


<p style="margin-top: 1em">http://people.redhat.com/pwouters/hash-slinger/</p>

<p style="margin-top: 1em">http://os3sec.org/</p>

<p style="margin-top: 1em">AUTHORS <br>
Pieter Lexis &lt;pieter.lexis@os3.nl&gt;</p>

<p style="margin-top: 1em">COPYRIGHT <br>
Copyright 2012</p>

<p style="margin-top: 1em">This program is free software;
you can redistribute it and/or modify it under the terms of
the GNU General Public License as published by the Free
Software Foundation; either <br>
version 2 of the License, or (at your option) any later
version. See
&lt;http://www.fsf.org/copyleft/gpl.txt&gt;.</p>

<p style="margin-top: 1em">This program is distributed in
the hope that it will be useful, but WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR <br>
PURPOSE. See the GNU General Public License (file COPYING in
the distribution) for more details.</p>

<p style="margin-top: 1em">Paul Wouters December 7, 2015
TLSA(1)</p>
<hr>
</body>
</html>
