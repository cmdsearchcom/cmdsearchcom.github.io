<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>POSTMAP(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">POSTMAP(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">POSTMAP(1)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
postmap - Postfix lookup table management
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<br/>
<b>postmap</b> [<b>-Nbfhimnoprsvw</b>] [<b>-c </b><i>config_dir</i>] [ <b>-d
  </b> <i>key</i>] [<b>-q </b><i>key</i>]
<br/>
 [ <i>file_type</i>:]<i>file_name</i> ...
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<br/>
The <b>postmap</b>(1) command creates or queries one or more Postfix lookup
  tables, or updates an existing one. The input and output file formats are
  expected to be compatible with:
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
     <b>makemap </b><i>file_type</i> <i>file_name</i> &lt; <i>file_name</i>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
If the result files do not exist they will be created with the same group and
  other read permissions as their source file.
<div style="height: 1.00em;">&#x00A0;</div>
While the table update is in progress, signal delivery is postponed, and an
  exclusive, advisory, lock is placed on the entire table, in order to avoid
  surprises in spectator processes.
<h1 class="Sh" title="Sh" id="INPUT_FILE_FORMAT"><a class="selflink" href="#INPUT_FILE_FORMAT">INPUT
  FILE FORMAT</a></h1>
<br/>
The format of a lookup table input file is as follows:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">A table entry has the form
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
      <i>key</i> whitespace <i>value</i>
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Empty lines and whitespace-only lines are ignored, as are
      lines whose first non-whitespace character is a `#'.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">A logical line starts with non-whitespace text. A line that
      starts with whitespace continues a logical line.</dd>
</dl>
<div class="Pp"></div>
The <i>key</i> and <i>value</i> are processed as is, except that surrounding
  white space is stripped off. Unlike with Postfix alias databases, quotes
  cannot be used to protect lookup keys that contain special characters such as
  `#' or whitespace.
<div style="height: 1.00em;">&#x00A0;</div>
By default the lookup key is mapped to lowercase to make the lookups case
  insensitive; as of Postfix 2.3 this case folding happens only with tables
  whose lookup keys are fixed-case strings such as btree:, dbm: or hash:. With
  earlier versions, the lookup key is folded even with tables where a lookup
  field can match both upper and lower case text, such as regexp: and pcre:.
  This resulted in loss of information with $ <i>number</i> substitutions.
<h1 class="Sh" title="Sh" id="COMMAND-LINE_ARGUMENTS"><a class="selflink" href="#COMMAND-LINE_ARGUMENTS">COMMAND-LINE
  ARGUMENTS</a></h1>
<br/>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-b</b></dt>
  <dd class="It-tag">Enable message body query mode. When reading lookup keys
      from standard input with &quot; <b>-q -</b>&quot;, process the input as if
      it is an email message in RFC 2822 format. Each line of body content
      becomes one lookup key.
    <div style="height: 1.00em;">&#x00A0;</div>
    By default, the <b>-b</b> option starts generating lookup keys at the first
      non-header line, and stops when the end of the message is reached. To
      simulate <b>body_checks</b>(5) processing, enable MIME parsing with
      <b>-m</b>. With this, the <b>-b</b> option generates no body-style lookup
      keys for attachment MIME headers and for attached message/* headers.
    <div style="height: 1.00em;">&#x00A0;</div>
    This feature is available in Postfix version 2.6 and later.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c </b><i>config_dir</i></dt>
  <dd class="It-tag">Read the <b>main.cf</b> configuration file in the named
      directory instead of the default configuration directory.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d </b><i>key</i></dt>
  <dd class="It-tag">Search the specified maps for <i>key</i> and remove one
      entry per map. The exit status is zero when the requested information was
      found.
    <div style="height: 1.00em;">&#x00A0;</div>
    If a key value of <b>-</b> is specified, the program reads key values from
      the standard input stream. The exit status is zero when at least one of
      the requested keys was found.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b></dt>
  <dd class="It-tag">Do not fold the lookup key to lower case while creating or
      querying a table.
    <div style="height: 1.00em;">&#x00A0;</div>
    With Postfix version 2.3 and later, this option has no effect for regular
      expression tables. There, case folding is controlled by appending a flag
      to a pattern.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h</b></dt>
  <dd class="It-tag">Enable message header query mode. When reading lookup keys
      from standard input with &quot; <b>-q -</b>&quot;, process the input as if
      it is an email message in RFC 2822 format. Each logical header line
      becomes one lookup key. A multi-line header becomes one lookup key with
      one or more embedded newline characters.
    <div style="height: 1.00em;">&#x00A0;</div>
    By default, the <b>-h</b> option generates lookup keys until the first
      non-header line is reached. To simulate <b>header_checks</b>(5)
      processing, enable MIME parsing with <b>-m</b>. With this, the <b>-h</b>
      option also generates header-style lookup keys for attachment MIME headers
      and for attached message/* headers.
    <div style="height: 1.00em;">&#x00A0;</div>
    This feature is available in Postfix version 2.6 and later.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i</b></dt>
  <dd class="It-tag">Incremental mode. Read entries from standard input and do
      not truncate an existing database. By default, <b>postmap</b>(1) creates a
      new database from the entries in <b>file_name</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-m</b></dt>
  <dd class="It-tag">Enable MIME parsing with &quot;<b>-b</b>&quot; and
      &quot;<b>-h</b>&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    This feature is available in Postfix version 2.6 and later.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-N</b></dt>
  <dd class="It-tag">Include the terminating null character that terminates
      lookup keys and values. By default, <b>postmap</b>(1) does whatever is the
      default for the host operating system.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n</b></dt>
  <dd class="It-tag">Don't include the terminating null character that
      terminates lookup keys and values. By default, <b>postmap</b>(1) does
      whatever is the default for the host operating system.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-o</b></dt>
  <dd class="It-tag">Do not release root privileges when processing a non-root
      input file. By default, <b>postmap</b>(1) drops root privileges and runs
      as the source file owner instead.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p</b></dt>
  <dd class="It-tag">Do not inherit the file access permissions from the input
      file when creating a new file. Instead, create a new file with default
      access permissions (mode 0644).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-q </b><i>key</i></dt>
  <dd class="It-tag">Search the specified maps for <i>key</i> and write the
      first value found to the standard output stream. The exit status is zero
      when the requested information was found.
    <div style="height: 1.00em;">&#x00A0;</div>
    If a key value of <b>-</b> is specified, the program reads key values from
      the standard input stream and writes one line of <i>key value</i> output
      for each key that was found. The exit status is zero when at least one of
      the requested keys was found.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-r</b></dt>
  <dd class="It-tag">When updating a table, do not complain about attempts to
      update existing entries, and make those updates anyway.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s</b></dt>
  <dd class="It-tag">Retrieve all database elements, and write one line of
      <i>key value</i> output for each element. The elements are printed in
      database order, which is not necessarily the same as the original input
      order.
    <div style="height: 1.00em;">&#x00A0;</div>
    This feature is available in Postfix version 2.2 and later, and is not
      available for all database types.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v</b></dt>
  <dd class="It-tag">Enable verbose logging for debugging purposes. Multiple
      <b>-v</b> options make the software increasingly verbose.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-w</b></dt>
  <dd class="It-tag">When updating a table, do not complain about attempts to
      update existing entries, and ignore those attempts.</dd>
</dl>
<div class="Pp"></div>
Arguments:
<dl class="Bl-tag">
  <dt class="It-tag"><i>file_type</i></dt>
  <dd class="It-tag">The database type. To find out what types are supported,
      use the &quot; <b>postconf -m</b>&quot; command.
    <div style="height: 1.00em;">&#x00A0;</div>
    The <b>postmap</b>(1) command can query any supported file type, but it can
      create only the following file types:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>btree</b></dt>
  <dd class="It-tag">The output file is a btree file, named
      <i>file_name</i><b>.db</b>. This is available on systems with support for
      <b>db</b> databases.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>cdb</b></dt>
  <dd class="It-tag">The output consists of one file, named
      <i>file_name</i><b>.cdb</b>. This is available on systems with support for
      <b>cdb</b> databases.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>dbm</b></dt>
  <dd class="It-tag">The output consists of two files, named
      <i>file_name</i><b>.pag</b> and <i>file_name</i><b>.dir</b>. This is
      available on systems with support for <b>dbm</b> databases.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>hash</b></dt>
  <dd class="It-tag">The output file is a hashed file, named
      <i>file_name</i><b>.db</b>. This is available on systems with support for
      <b>db</b> databases.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>fail</b></dt>
  <dd class="It-tag">A table that reliably fails all requests. The lookup table
      name is used for logging only. This table exists to simplify Postfix error
      tests.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>sdbm</b></dt>
  <dd class="It-tag">The output consists of two files, named
      <i>file_name</i><b>.pag</b> and <i>file_name</i><b>.dir</b>. This is
      available on systems with support for <b>sdbm</b> databases.</dd>
</dl>
<div class="Pp"></div>
When no <i>file_type</i> is specified, the software uses the database type
  specified via the <b>default_database_type</b> configuration parameter.</div>
<dl class="Bl-tag">
  <dt class="It-tag"><i>file_name</i></dt>
  <dd class="It-tag">The name of the lookup table source file when rebuilding a
      database.</dd>
</dl>
<h1 class="Sh" title="Sh" id="DIAGNOSTICS"><a class="selflink" href="#DIAGNOSTICS">DIAGNOSTICS</a></h1>
<br/>
Problems are logged to the standard error stream and to <b>syslogd</b>(8). No
  output means that no problems were detected. Duplicate entries are skipped and
  are flagged with a warning.
<div style="height: 1.00em;">&#x00A0;</div>
<b>postmap</b>(1) terminates with zero exit status in case of success (including
  successful &quot; <b>postmap -q</b>&quot; lookup) and terminates with non-zero
  exit status in case of failure.
<h1 class="Sh" title="Sh" id="ENVIRONMENT"><a class="selflink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
<br/>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MAIL_CONFIG</b></dt>
  <dd class="It-tag">Directory with Postfix configuration files.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MAIL_VERBOSE</b></dt>
  <dd class="It-tag">Enable verbose logging for debugging purposes.</dd>
</dl>
<h1 class="Sh" title="Sh" id="CONFIGURATION_PARAMETERS"><a class="selflink" href="#CONFIGURATION_PARAMETERS">CONFIGURATION
  PARAMETERS</a></h1>
<br/>
The following <b>main.cf</b> parameters are especially relevant to this program.
  The text below provides only a parameter summary. See <b>postconf</b>(5) for
  more details including examples.
<dl class="Bl-tag">
  <dt class="It-tag"><b>berkeley_db_create_buffer_size (16777216)</b></dt>
  <dd class="It-tag">The per-table I/O buffer size for programs that create
      Berkeley DB hash or btree tables.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>berkeley_db_read_buffer_size (131072)</b></dt>
  <dd class="It-tag">The per-table I/O buffer size for programs that read
      Berkeley DB hash or btree tables.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>config_directory (see 'postconf -d' output)</b></dt>
  <dd class="It-tag">The default location of the Postfix main.cf and master.cf
      configuration files.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>default_database_type (see 'postconf -d'
    output)</b></dt>
  <dd class="It-tag">The default database type for use in <b>newaliases</b>(1),
      <b>postalias</b>(1) and <b>postmap</b>(1) commands.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>syslog_facility (mail)</b></dt>
  <dd class="It-tag">The syslog facility of Postfix logging.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>syslog_name (see 'postconf -d' output)</b></dt>
  <dd class="It-tag">The mail system name that is prepended to the process name
      in syslog records, so that &quot;smtpd&quot; becomes, for example,
      &quot;postfix/smtpd&quot;.</dd>
</dl>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<pre>
postalias(1), create/update/query alias database
postconf(1), supported database types
postconf(5), configuration parameters
syslogd(8), system logging
</pre>
<h1 class="Sh" title="Sh" id="README_FILES"><a class="selflink" href="#README_FILES">README
  FILES</a></h1>
<br/>
Use &quot; <b>postconf readme_directory</b>&quot; or &quot; <b>postconf
  html_directory</b>&quot; to locate this information.
<pre>
DATABASE_README, Postfix lookup table overview
</pre>
<h1 class="Sh" title="Sh" id="LICENSE"><a class="selflink" href="#LICENSE">LICENSE</a></h1>
<br/>
The Secure Mailer license must be distributed with this software.
<h1 class="Sh" title="Sh" id="AUTHOR(S)"><a class="selflink" href="#AUTHOR(S)">AUTHOR(S)</a></h1>
<pre>
Wietse Venema
IBM T.J. Watson Research
P.O. Box 704
Yorktown Heights, NY 10598, USA
</pre>
</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
