<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:42:05 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>v.distance(1grass) Grass User&rsquo;s Manual
v.distance(1grass)</p>

<p style="margin-top: 1em">NAME <br>
v.distance - Finds the nearest element in vector map
&acirc;to&acirc; for elements in vector map
&acirc;from&acirc;.</p>

<p style="margin-top: 1em">KEYWORDS <br>
vector, distance, database, attribute table</p>

<p style="margin-top: 1em">SYNOPSIS <br>
v.distance <br>
v.distance --help <br>
v.distance [-pa] from=name [from_layer=string]
[from_type=string[,string,...]] to=name [to_layer=string]
[to_type=string[,string,...]] [output=name] [dmax=float]
<br>
[dmin=float] upload=string[,string,...]
[column=name[,name,...]] [to_column=name] [table=name]
[separator=character] [--overwrite] [--help] [--verbose]
[--quiet] <br>
[--ui]</p>

<p style="margin-top: 1em">Flags: <br>
-p <br>
Print output to stdout, don&acirc;t update attribute table
<br>
First column is always category of &acirc;from&acirc;
feature called from_cat</p>

<p style="margin-top: 1em">-a <br>
Calculate distances to all features within the threshold
<br>
Output is written to stdout but may be uploaded to a new
table created by this module; multiple &acirc;upload&acirc;
options may be used.</p>

<p style="margin-top: 1em">--overwrite <br>
Allow output files to overwrite existing files</p>

<p style="margin-top: 1em">--help <br>
Print usage summary</p>

<p style="margin-top: 1em">--verbose <br>
Verbose module output</p>

<p style="margin-top: 1em">--quiet <br>
Quiet module output</p>

<p style="margin-top: 1em">--ui <br>
Force launching GUI dialog</p>

<p style="margin-top: 1em">Parameters: <br>
from=name [required] <br>
Name of existing vector map (from) <br>
Or data source for direct OGR access</p>

<p style="margin-top: 1em">from_layer=string <br>
Layer number or name (from) <br>
Vector features can have category values in different
layers. This number determines which layer to use. When used
with direct OGR access this is the layer name. <br>
Default: 1</p>

<p style="margin-top: 1em">from_type=string[,string,...]
<br>
Feature type (from) <br>
Input feature type <br>
Options: point, line, boundary, centroid, area <br>
Default: point,line,area</p>

<p style="margin-top: 1em">to=name [required] <br>
Name of existing vector map (to) <br>
Or data source for direct OGR access</p>

<p style="margin-top: 1em">to_layer=string <br>
Layer number or name (to) <br>
Vector features can have category values in different
layers. This number determines which layer to use. When used
with direct OGR access this is the layer name. <br>
Default: 1</p>

<p style="margin-top: 1em">to_type=string[,string,...] <br>
Feature type (to) <br>
Input feature type <br>
Options: point, line, boundary, centroid, area <br>
Default: point,line,area</p>

<p style="margin-top: 1em">output=name <br>
Name for output vector map containing lines connecting
nearest elements</p>

<p style="margin-top: 1em">dmax=float <br>
Maximum distance or -1 for no limit <br>
Default: -1</p>

<p style="margin-top: 1em">dmin=float <br>
Minimum distance or -1 for no limit <br>
Default: -1</p>

<p style="margin-top: 1em">upload=string[,string,...]
[required] <br>
Values describing the relation between two nearest features
<br>
Options: cat, dist, to_x, to_y, to_along, to_angle, to_attr
<br>
cat: category of the nearest feature <br>
dist: minimum distance to nearest feature <br>
to_x: x coordinate of the nearest point on the
&acirc;to&acirc; feature <br>
to_y: y coordinate of the nearest point on the
&acirc;to&acirc; feature <br>
to_along: distance to the nearest point on the
&acirc;to&acirc; feature along that linear feature <br>
to_angle: angle along the nearest linear feature in the
&acirc;to&acirc; map, measured CCW from the +x axis, in
radians, between -Pi and Pi inclusive <br>
to_attr: attribute of nearest feature given by to_column
option</p>

<p style="margin-top: 1em">column=name[,name,...] <br>
Column name(s) where values specified by
&acirc;upload&acirc; option will be uploaded</p>

<p style="margin-top: 1em">to_column=name <br>
Column name of nearest feature (used with
upload=to_attr)</p>

<p style="margin-top: 1em">table=name <br>
Name of table created when the &acirc;distance to all&acirc;
flag is used</p>

<p style="margin-top: 1em">separator=character <br>
Field separator for printing output to stdout <br>
Special characters: pipe, comma, space, tab, newline <br>
Default: pipe</p>

<p style="margin-top: 1em">DESCRIPTION <br>
v.distance finds the nearest element in vector map (to) for
elements in vector map (from). Various information about the
vectors&acirc; relationships (distance, category, etc.) may
be <br>
uploaded to the attribute table attached to the first vector
map, or printed to &acirc;stdout&acirc;. A new vector map
may be created where lines connecting nearest points on
features are <br>
written. dmin and/or dmax can be used to limit the search
radius (in lat-long locations to be given in meters since
they are calculated as geodesic distances on a sphere).</p>

<p style="margin-top: 1em">For lines to lines, say line A
to line B, v.distance calculates the shortest distance of
each vertex in A with each segment (not vertex) in B. The
module then calculates the <br>
shortest distance of each vertex in B to each segment in A.
The overall shortest distance of A points to B segments and
B points to A segments is used. Additionally, v.distance
<br>
checks for intersections. In case of intersections, the
first intersection found is used and the distance set to
zero.</p>

<p style="margin-top: 1em">For lines to areas, the distance
is set to zero if a line is (partially) inside an area. The
first point of the line that is inside the area is used as
common point. The distance <br>
is also set to zero if the line intersects with the outer
ring or any of the inner rings (isles), in which case the
fist intersection is used as common point.</p>

<p style="margin-top: 1em">For areas to areas, the module
checks first for overlap or if one area is (partially)
inside the other area. This is computationally quite
intensive. If the outer rings of the <br>
two areas do not overlap, the distance is calculated as
above for lines to lines, treating the outer rings as two
lines. Again, the first point encountered falling into an
area <br>
is used as common point, or the first intersection
point.</p>

<p style="margin-top: 1em">For anything else than points to
lines, there can be several common locations with zero
distance, and the common location would then be the result
of an overlay consisting of <br>
several points, lines, or areas. v.distance selects in these
cases a single point, and does not create an overlay like
v.overlay. In this implementation, any shared point is as
<br>
good as any other. Calculating an intersection is costlier
than to check if a vertex is inside a polygon. For example,
if a vertex of the boundary of the &acirc;to&acirc; area is
inside the <br>
&acirc;from&acirc; area, it is a common location. For speed
reasons, the distance is then set to zero and no further
tests are done.</p>

<p style="margin-top: 1em">NOTES <br>
If a nearest feature does not have a category, the attribute
column is updated to NULL.</p>

<p style="margin-top: 1em">The upload column(s) must
already exist. Create one with v.db.addcolumn.</p>

<p style="margin-top: 1em">In lat-long locations v.distance
gives distances (dist, from_along, and to_along) not in
degrees but in meters calculated as geodesic distances on a
sphere.</p>

<p style="margin-top: 1em">If one or both of the input
vector maps are 3D, the user is notified accordingly.</p>

<p style="margin-top: 1em">EXAMPLES <br>
Find nearest lines <br>
Find nearest lines in vector map &quot;ln&quot; for points
from vector map &quot;pnt&quot; within the given threshold
and write related line categories to column
&quot;linecat&quot; in an attribute table <br>
attached to vector map &quot;pnt&quot;: <br>
v.distance from=pnt to=ln upload=cat column=linecat</p>

<p style="margin-top: 1em">Find nearest area <br>
For each point from vector map &quot;pnt&quot;, find the
nearest area from map &quot;ar&quot; within the given
threshold and write the related area categories to column
&quot;areacat&quot; in an attribute ta&acirc; <br>
ble attached to vector map &quot;pnt&quot; (in the case that
a point falls into an area, the distance is zero): <br>
v.distance from=pnt to=ar upload=cat column=areacat</p>

<p style="margin-top: 1em">Create a new vector map <br>
Create a new vector map which contains lines connecting
nearest features of maps &quot;pnt&quot; and map
&quot;ln&quot;. The resulting vector map can be used for
example to connect points to a net&acirc; <br>
work as needed for network analysis: <br>
v.distance -p from=pnt to=ln out=connections upload=dist
column=dist</p>

<p style="margin-top: 1em">Query information <br>
Query information from selected point(s). v.distance takes
points from a vector map as input instead of stdin. A new
vector map with query points has to be created before the
map <br>
can be analysed.</p>

<p style="margin-top: 1em">Create query map (if not
present): <br>
echo &quot;123456|654321|1&quot; | v.in.ascii output=pnt
<br>
Find nearest features: <br>
v.distance from=pnt to=map_to_query upload=cat col=somecol
-p</p>

<p style="margin-top: 1em">Point-in-polygon <br>
The option dmax=0 is here important because otherwise for
points not falling into any area, the category of the
nearest area is recorded. <br>
For each point from vector map &quot;pnt&quot;, find the
area from vector map &quot;ar&quot; in which the individual
point falls, and write the related area categories to column
&quot;areacat&quot; into the <br>
attribute table attached to vector map &quot;pnt&quot;: <br>
v.distance from=pnt to=ar dmax=0 upload=cat
column=areacat</p>

<p style="margin-top: 1em">Univariate statistics on results
<br>
Create a vector map containing connecting lines and
investigate mean distance to targets. An alternative
solution is to use the v.distance upload=dist option to
upload distances <br>
into the bugs vector directly, then run v.univar on that.
Also note you can upload two columns at a time, e.g.
v.distance upload=cat,dist column=nearest_id,dist_to_nr.
<br>
# create working copy <br>
g.copy vect=bugsites,bugs <br>
# add new attribute column to hold nearest archsite category
number <br>
v.db.addcolumn map=bugs column=&quot;nrst_arch INTEGER&quot;
<br>
v.distance from=bugs to=archsites to_type=point
upload=to_attr to_column=cat column=nrst_arch
out=vdistance_vectors_raw <br>
# we need to give the lines category numbers, create a
table, and create <br>
# a column in that table to hold the distance data. <br>
v.category vdistance_vectors_raw out=vdistance_vectors
type=line op=add <br>
g.remove -f type=vector name=vdistance_vectors_raw <br>
v.db.addtable map=vdistance_vectors column=&quot;length
DOUBLE&quot; <br>
v.to.db map=vdistance_vectors option=length column=length
<br>
# calculcate statistics. Use v.univar.sh for extended
statistics. <br>
v.univar vdistance_vectors column=length</p>

<p style="margin-top: 1em">Print distance between points
<br>
Example for a Latitude-longitude location (EPSG 4326): <br>
# points along the equator <br>
echo &quot;0|-61|1&quot; | v.in.ascii output=pnt1 input=-
<br>
echo &quot;0|-58|1&quot; | v.in.ascii output=pnt2 input=-
<br>
# here, distances is in degree units <br>
v.distance from=pnt1 to=pnt2 upload=dist col=distance -p --q
<br>
from_cat|distance <br>
1|3</p>

<p style="margin-top: 1em">Print distance matrix <br>
Note: Matrix-style output is enabled only for flag -a and
one given upload option.</p>

<p style="margin-top: 1em">Spearfish sample data location:
<br>
v.distance -pa from=archsites to=archsites upload=dist
col=dist</p>

<p style="margin-top: 1em">North Carolina sample data
location: <br>
v.distance -pa from=hospitals to=hospitals upload=dist
col=dist separator=comma <br>
from_cat to_cat dist <br>
1 2 3 4 5 ... <br>
1 0 7489.10 339112.17 70900.39 70406.23 ... <br>
2 7489.10 0 345749.12 76025.46 75538.87 ... <br>
3 339112.17 345749.12 0 274153.19 274558.98 ... <br>
4 70900.39 76025.46 274153.19 0 501.11 ... <br>
5 70406.23 75538.87 274558.98 501.11 0 ... <br>
...</p>

<p style="margin-top: 1em">SEE ALSO <br>
r.distance, v.db.addcolumn, v.what.vect</p>

<p style="margin-top: 1em">AUTHORS <br>
Janne Soimasuo 1994, University of Joensuu, Faculty of
Forestry, Finland <br>
Cmd line coordinates support: Markus Neteler, ITC-irst,
Trento, Italy <br>
Updated for 5.1: Radim Blazek, ITC-irst, Trento, Italy <br>
Matrix-like output by Martin Landa, FBK-irst, Trento, Italy
<br>
Improved processing speed: Markus Metz <br>
Distance from any feature to any feature: Markus Metz</p>

<p style="margin-top: 1em">Last changed: $Date: 2016-05-14
19:12:07 +0200 (Sat, 14 May 2016) $</p>

<p style="margin-top: 1em">SOURCE CODE <br>
Available at: v.distance source code (history)</p>

<p style="margin-top: 1em">Main index | Vector index |
Topics index | Keywords index | Graphical index | Full
index</p>

<p style="margin-top: 1em">&Acirc;&copy; 2003-2016 GRASS
Development Team, GRASS GIS 7.2.0 Reference Manual</p>

<p style="margin-top: 1em">GRASS 7.2.0
v.distance(1grass)</p>
<hr>
</body>
</html>
