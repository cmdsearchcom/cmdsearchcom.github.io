<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>v.distance(1grass)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">v.distance(1grass)</td>
    <td class="head-vol">Grass User's Manual</td>
    <td class="head-rtitle">v.distance(1grass)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<i></i><b>v.distance</b> - Finds the nearest element in vector map
  &#x2019;to&#x2019; for elements in vector map &#x2019;from&#x2019;.
<h1 class="Sh" title="Sh" id="KEYWORDS"><a class="selflink" href="#KEYWORDS">KEYWORDS</a></h1>
vector, distance, database, attribute table
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>v.distance</b>
<div>&#x00A0;</div>
<b>v.distance --help</b>
<div>&#x00A0;</div>
<b>v.distance</b> [-<b>pa</b>] <b>from</b>=<i>name</i>
  [<b>from_layer</b>=<i>string</i>] [
  <b>from_type</b>=<i>string</i>[,<i>string</i>,...]] <b>to</b>=<i>name</i>
  [<b>to_layer</b>= <i>string</i>]
  [<b>to_type</b>=<i>string</i>[,<i>string</i>,...]] [
  <b>output</b>=<i>name</i>] [ <b>dmax</b>=<i>float</i>]
  [<b>dmin</b>=<i>float</i>] <b>upload</b>=<i>string</i>[,<i>string</i>,...]
  [<b>column</b>=<i>name</i>[,<i>name</i>,...]] [<b>to_column</b>=<i>name</i>]
  [<b>table</b>=<i>name</i>] [<b>separator</b>=<i>character</i>]
  [--<b>overwrite</b>] [-- <b>help</b>] [--<b>verbose</b>] [--<b>quiet</b>]
  [--<b>ui</b>]
<h2 class="Ss" title="Ss" id="Flags:"><a class="selflink" href="#Flags:">Flags:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Print output to stdout, don&#x2019;t update attribute table
    <div>&#x00A0;</div>
    First column is always category of &#x2019;from&#x2019; feature called
      from_cat</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-a</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Calculate distances to all features within the threshold
    <div>&#x00A0;</div>
    Output is written to stdout but may be uploaded to a new table created by
      this module; multiple &#x2019;upload&#x2019; options may be used.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--overwrite</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Allow output files to overwrite existing files</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Print usage summary</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verbose</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Verbose module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--quiet</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Quiet module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ui</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Force launching GUI dialog</dd>
</dl>
<h2 class="Ss" title="Ss" id="Parameters:"><a class="selflink" href="#Parameters:">Parameters:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>from</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of existing vector map (from)
    <div>&#x00A0;</div>
    Or data source for direct OGR access</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>from_layer</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Layer number or name (from)
    <div>&#x00A0;</div>
    Vector features can have category values in different layers. This number
      determines which layer to use. When used with direct OGR access this is
      the layer name.
    <div>&#x00A0;</div>
    Default: <i>1</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>from_type</b>=<i>string[,</i><i>string</i>,...]</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Feature type (from)
    <div>&#x00A0;</div>
    Input feature type
    <div>&#x00A0;</div>
    Options: <i>point, line, boundary, centroid, area</i>
    <div>&#x00A0;</div>
    Default: <i>point,line,area</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>to</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of existing vector map (to)
    <div>&#x00A0;</div>
    Or data source for direct OGR access</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>to_layer</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Layer number or name (to)
    <div>&#x00A0;</div>
    Vector features can have category values in different layers. This number
      determines which layer to use. When used with direct OGR access this is
      the layer name.
    <div>&#x00A0;</div>
    Default: <i>1</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>to_type</b>=<i>string[,</i><i>string</i>,...]</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Feature type (to)
    <div>&#x00A0;</div>
    Input feature type
    <div>&#x00A0;</div>
    Options: <i>point, line, boundary, centroid, area</i>
    <div>&#x00A0;</div>
    Default: <i>point,line,area</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>output</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name for output vector map containing lines connecting nearest elements</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>dmax</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Maximum distance or -1 for no limit
    <div>&#x00A0;</div>
    Default: <i>-1</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>dmin</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Minimum distance or -1 for no limit
    <div>&#x00A0;</div>
    Default: <i>-1</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>upload</b>=<i>string[,</i><i>string</i>,...]
    <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Values describing the relation between two nearest features
    <div>&#x00A0;</div>
    Options: <i>cat, dist, to_x, to_y, to_along, to_angle, to_attr</i>
    <div>&#x00A0;</div>
     <b>cat</b>: category of the nearest feature
    <div>&#x00A0;</div>
     <b>dist</b>: minimum distance to nearest feature
    <div>&#x00A0;</div>
     <b>to_x</b>: x coordinate of the nearest point on the &#x2019;to&#x2019;
      feature
    <div>&#x00A0;</div>
     <b>to_y</b>: y coordinate of the nearest point on the &#x2019;to&#x2019;
      feature
    <div>&#x00A0;</div>
     <b>to_along</b>: distance to the nearest point on the &#x2019;to&#x2019;
      feature along that linear feature
    <div>&#x00A0;</div>
     <b>to_angle</b>: angle along the nearest linear feature in the
      &#x2019;to&#x2019; map, measured CCW from the +x axis, in radians, between
      -Pi and Pi inclusive
    <div>&#x00A0;</div>
     <b>to_attr</b>: attribute of nearest feature given by to_column option</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>column</b>=<i>name[,</i><i>name</i>,...]</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Column name(s) where values specified by &#x2019;upload&#x2019; option will
      be uploaded</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>to_column</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Column name of nearest feature (used with upload=to_attr)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>table</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of table created when the &#x2019;distance to all&#x2019; flag is
    used</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>separator</b>=<i>character</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Field separator for printing output to stdout
    <div>&#x00A0;</div>
    Special characters: pipe, comma, space, tab, newline
    <div>&#x00A0;</div>
    Default: <i>pipe</i></dd>
</dl>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<i>v.distance</i> finds the nearest element in vector map (<b>to</b>) for
  elements in vector map ( <b>from</b>). Various information about the
  vectors&#x2019; relationships (distance, category, etc.) may be uploaded to
  the attribute table attached to the first vector map, or printed to
  &#x2019;stdout&#x2019;. A new vector map may be created where lines connecting
  nearest points on features are written. <b>dmin</b> and/or <b>dmax</b> can be
  used to limit the search radius (in lat-long locations to be given in meters
  since they are calculated as geodesic distances on a sphere).
<div class="Pp"></div>
For lines to lines, say line A to line B, <i>v.distance</i> calculates the
  shortest distance of each vertex in A with each segment (not vertex) in B. The
  module then calculates the shortest distance of each vertex in B to each
  segment in A. The overall shortest distance of A points to B segments and B
  points to A segments is used. Additionally, <i>v.distance</i> checks for
  intersections. In case of intersections, the first intersection found is used
  and the distance set to zero.
<div class="Pp"></div>
For lines to areas, the distance is set to zero if a line is (partially) inside
  an area. The first point of the line that is inside the area is used as common
  point. The distance is also set to zero if the line intersects with the outer
  ring or any of the inner rings (isles), in which case the fist intersection is
  used as common point.
<div class="Pp"></div>
For areas to areas, the module checks first for overlap or if one area is
  (partially) inside the other area. This is computationally quite intensive. If
  the outer rings of the two areas do not overlap, the distance is calculated as
  above for lines to lines, treating the outer rings as two lines. Again, the
  first point encountered falling into an area is used as common point, or the
  first intersection point.
<div class="Pp"></div>
For anything else than points to lines, there can be several common locations
  with zero distance, and the common location would then be the result of an
  overlay consisting of several points, lines, or areas. <i>v.distance</i>
  selects in these cases a single point, and does not create an overlay like
  <i>v.overlay</i>. In this implementation, any shared point is as good as any
  other. Calculating an intersection is costlier than to check if a vertex is
  inside a polygon. For example, if a vertex of the boundary of the
  &#x2019;to&#x2019; area is inside the &#x2019;from&#x2019; area, it is a
  common location. For speed reasons, the distance is then set to zero and no
  further tests are done.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
If a nearest feature does not have a category, the attribute column is updated
  to NULL.
<div class="Pp"></div>
The upload <b>column</b>(s) must already exist. Create one with
  <i>v.db.addcolumn</i>.
<div class="Pp"></div>
In lat-long locations <i>v.distance</i> gives distances ( <i>dist</i>,
  <i>from_along</i>, and <i>to_along</i>) not in degrees but in meters
  calculated as geodesic distances on a sphere.
<div class="Pp"></div>
If one or both of the input vector maps are 3D, the user is notified
  accordingly.
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<h2 class="Ss" title="Ss" id="Find_nearest_lines"><a class="selflink" href="#Find_nearest_lines">Find
  nearest lines</a></h2>
Find <i>nearest lines</i> in vector map &quot;ln&quot; for points from vector
  map &quot;pnt&quot; within the given threshold and write related line
  categories to column &quot;linecat&quot; in an attribute table attached to
  vector map &quot;pnt&quot;:
<div>&#x00A0;</div>
<pre>
v.distance from=pnt to=ln upload=cat column=linecat
</pre>
<h2 class="Ss" title="Ss" id="Find_nearest_area"><a class="selflink" href="#Find_nearest_area">Find
  nearest area</a></h2>
For each point from vector map &quot;pnt&quot;, find the <i>nearest area</i>
  from map &quot;ar&quot; within the given threshold and write the related area
  categories to column &quot;areacat&quot; in an attribute table attached to
  vector map &quot;pnt&quot; (in the case that a point falls into an area, the
  distance is zero):
<div>&#x00A0;</div>
<pre>
v.distance from=pnt to=ar upload=cat column=areacat
</pre>
<h2 class="Ss" title="Ss" id="Create_a_new_vector_map"><a class="selflink" href="#Create_a_new_vector_map">Create
  a new vector map</a></h2>
Create a new vector map which contains <i>lines connecting nearest</i>
  <i>features</i> of maps &quot;pnt&quot; and map &quot;ln&quot;. The resulting
  vector map can be used for example to connect points to a network as needed
  for network analysis:
<div>&#x00A0;</div>
<pre>
v.distance -p from=pnt to=ln out=connections upload=dist column=dist
</pre>
<h2 class="Ss" title="Ss" id="Query_information"><a class="selflink" href="#Query_information">Query
  information</a></h2>
Query information from selected point(s). <i>v.distance</i> takes points from a
  vector map as input instead of stdin. A new vector map with query points has
  to be created before the map can be analysed.
<div class="Pp"></div>
Create query map (if not present):
<div>&#x00A0;</div>
<pre>
echo &quot;123456|654321|1&quot; | v.in.ascii output=pnt
</pre>
Find nearest features:
<div>&#x00A0;</div>
<pre>
v.distance from=pnt to=map_to_query upload=cat col=somecol -p
</pre>
<h2 class="Ss" title="Ss" id="Point-in-polygon"><a class="selflink" href="#Point-in-polygon">Point-in-polygon</a></h2>
The option <b>dmax=0</b> is here important because otherwise for points not
  falling into any area, the category of the nearest area is recorded.
<div>&#x00A0;</div>
For each point from vector map &quot;pnt&quot;, find the <i>area</i> from vector
  map &quot;ar&quot; in which the individual point falls, and write the related
  area categories to column &quot;areacat&quot; into the attribute table
  attached to vector map &quot;pnt&quot;:
<div>&#x00A0;</div>
<pre>
v.distance from=pnt to=ar dmax=0 upload=cat column=areacat
</pre>
<h2 class="Ss" title="Ss" id="Univariate_statistics_on_results"><a class="selflink" href="#Univariate_statistics_on_results">Univariate
  statistics on results</a></h2>
Create a vector map containing connecting lines and investigate mean distance to
  targets. An alternative solution is to use the v.distance upload=dist option
  to upload distances into the <i>bugs</i> vector directly, then run v.univar on
  that. Also note you can upload two columns at a time, e.g. v.distance
  upload=cat,dist column=nearest_id,dist_to_nr.
<div>&#x00A0;</div>
<pre>
# create working copy
g.copy vect=bugsites,bugs
# add new attribute column to hold nearest archsite category number
v.db.addcolumn map=bugs column=&quot;nrst_arch INTEGER&quot;
v.distance from=bugs to=archsites to_type=point upload=to_attr \
  to_column=cat column=nrst_arch out=vdistance_vectors_raw
# we need to give the lines category numbers, create a table, and create
#  a column in that table to hold the distance data.
v.category vdistance_vectors_raw out=vdistance_vectors type=line op=add
g.remove -f type=vector name=vdistance_vectors_raw
v.db.addtable map=vdistance_vectors column=&quot;length DOUBLE&quot;
v.to.db map=vdistance_vectors option=length column=length
# calculcate statistics. Use v.univar.sh for extended statistics.
v.univar vdistance_vectors column=length
</pre>
<h2 class="Ss" title="Ss" id="Print_distance_between_points"><a class="selflink" href="#Print_distance_between_points">Print
  distance between points</a></h2>
Example for a Latitude-longitude location (EPSG 4326):
<div>&#x00A0;</div>
<pre>
# points along the equator
echo &quot;0|-61|1&quot; | v.in.ascii output=pnt1 input=-
echo &quot;0|-58|1&quot; | v.in.ascii output=pnt2 input=-
# here, distances is in degree units
v.distance from=pnt1 to=pnt2 upload=dist col=distance -p --q
from_cat|distance
1|3
</pre>
<h2 class="Ss" title="Ss" id="Print_distance_matrix"><a class="selflink" href="#Print_distance_matrix">Print
  distance matrix</a></h2>
Note: Matrix-style output is enabled only for flag <i>-a</i> and one given
  upload option.
<div class="Pp"></div>
Spearfish sample data location:
<div>&#x00A0;</div>
<pre>
v.distance -pa from=archsites to=archsites upload=dist col=dist
</pre>
<div class="Pp"></div>
North Carolina sample data location:
<div>&#x00A0;</div>
<pre>
v.distance -pa from=hospitals to=hospitals upload=dist \
  col=dist separator=comma
from_cat to_cat       dist
              1          2          3          4          5 ...
1             0    7489.10  339112.17   70900.39   70406.23 ...
2       7489.10          0  345749.12   76025.46   75538.87 ...
3     339112.17  345749.12          0  274153.19  274558.98 ...
4      70900.39   76025.46  274153.19          0     501.11 ...
5      70406.23   75538.87  274558.98     501.11          0 ...
...
</pre>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i></i> <i>r.distance,</i> <i>v.db.addcolumn,</i> <i>v.what.vect</i> <i></i>
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
Janne Soimasuo 1994, University of Joensuu, Faculty of Forestry, Finland
<div>&#x00A0;</div>
Cmd line coordinates support: Markus Neteler, ITC-irst, Trento, Italy
<div>&#x00A0;</div>
Updated for 5.1: Radim Blazek, ITC-irst, Trento, Italy
<div>&#x00A0;</div>
Matrix-like output by Martin Landa, FBK-irst, Trento, Italy
<div>&#x00A0;</div>
Improved processing speed: Markus Metz
<div>&#x00A0;</div>
Distance from any feature to any feature: Markus Metz
<div class="Pp"></div>
<i>Last changed: $Date: 2016-05-14 19:12:07 +0200 (Sat, 14 May 2016) $</i>
<h1 class="Sh" title="Sh" id="SOURCE_CODE"><a class="selflink" href="#SOURCE_CODE">SOURCE
  CODE</a></h1>
Available at: v.distance source code (history)
<div class="Pp"></div>
Main index | Vector index | Topics index | Keywords index | Graphical index |
  Full index
<div class="Pp"></div>
&#x00A9; 2003-2016 GRASS Development Team, GRASS GIS 7.2.0 Reference
  Manual</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os">GRASS 7.2.0</td>
  </tr>
</table>
</body>
</html>
