<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:20:45 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>KNIFE-SEARCH(1) knife search KNIFE-SEARCH(1)</p>

<p style="margin-top: 1em">NAME <br>
knife-search - The man page for the knife search
subcommand.</p>

<p style="margin-top: 1em">Search indexes allow queries to
be made for any type of data that is indexed by the Chef
server, including data bags (and data bag items),
environments, nodes, and roles. A <br>
defined query syntax is used to support search patterns like
exact, wildcard, range, and fuzzy. A search is a full-text
query that can be done from several locations, including
<br>
from within a recipe, by using the search subcommand in
knife, the search method in the Recipe DSL, and by using the
/search or /search/INDEX endpoints in the Chef server API.
<br>
The search engine is based on Apache Solr and is run from
the Chef server.</p>

<p style="margin-top: 1em">The knife search subcommand is
used run a search query for information that is indexed on a
Chef server.</p>

<p style="margin-top: 1em">Syntax</p>

<p style="margin-top: 1em">This subcommand has the
following syntax:</p>

<p style="margin-top: 1em">$ knife search INDEX
SEARCH_QUERY</p>

<p style="margin-top: 1em">where INDEX is one of client,
environment, node, role, or the name of a data bag and
SEARCH_QUERY is the search query syntax for the query that
will be executed.</p>

<p style="margin-top: 1em">INDEX is implied if omitted, and
will default to node. For example:</p>

<p style="margin-top: 1em">$ knife search &rsquo;*:*&rsquo;
-i</p>

<p style="margin-top: 1em">will return something similar
to:</p>

<p style="margin-top: 1em">8 items found</p>

<p style="margin-top: 1em">centos-62-dev <br>
opensuse-1203 <br>
ubuntu-1304-dev <br>
ubuntu-1304-orgtest <br>
ubuntu-1204-ohai-test <br>
ubuntu-1304-ifcfg-test <br>
ohai-test <br>
win2k8-dev</p>

<p style="margin-top: 1em">and is the same search as:</p>

<p style="margin-top: 1em">$ knife search node
&rsquo;*:*&quot; -i</p>

<p style="margin-top: 1em">If the SEARCH_QUERY does not
contain a colon character (:), then the default query
pattern is tags:*#{@query}* OR roles:*#{@query}* OR
fqdn:*#{@query}* OR addresses:*#{@query}*, <br>
which means the following two search queries are effectively
the same:</p>

<p style="margin-top: 1em">$ knife search ubuntu</p>

<p style="margin-top: 1em">or:</p>

<p style="margin-top: 1em">$ knife search node
&quot;tags:*ubuntu* OR roles:*ubuntu* OR fqdn:*ubuntu*
(etc.)&quot;</p>

<p style="margin-top: 1em">Options</p>

<p style="margin-top: 1em">This sub-command has the
following options:</p>

<p style="margin-top: 1em">-a ATTR, --attribute ATTR <br>
The attribute (or attributes) to show.</p>

<p style="margin-top: 1em">-b ROW, --start ROW <br>
The row at which return results will begin.</p>

<p style="margin-top: 1em">-c CONFIG_FILE, --config
CONFIG_FILE <br>
The configuration file to use.</p>

<p style="margin-top: 1em">--chef-zero-port PORT <br>
The port on which chef-zero will listen.</p>

<p style="margin-top: 1em">--[no-]color <br>
Use to view colored output.</p>

<p style="margin-top: 1em">-d, --disable-editing <br>
Use to prevent the $EDITOR from being opened and to accept
data as-is.</p>

<p style="margin-top: 1em">--defaults <br>
Use to have knife use the default value instead of asking a
user to provide one.</p>

<p style="margin-top: 1em">-e EDITOR, --editor EDITOR <br>
The $EDITOR that is used for all interactive commands.</p>

<p style="margin-top: 1em">-E ENVIRONMENT, --environment
ENVIRONMENT <br>
The name of the environment. When this option is added to a
command, the command will run only against the named
environment.</p>

<p style="margin-top: 1em">-F FORMAT, --format FORMAT <br>
The output format: summary (default), text, json, yaml, and
pp.</p>

<p style="margin-top: 1em">-h, --help <br>
Shows help for the command.</p>

<p style="margin-top: 1em">-i, --id-only <br>
Use to show only matching object IDs.</p>

<p style="margin-top: 1em">INDEX The name of the index to
be queried: client, environment, node, role, or
DATA_BAG_NAME. Default index: node.</p>

<p style="margin-top: 1em">-k KEY, --key KEY <br>
The private key that knife will use to sign requests made by
the API client to the Chef server.</p>

<p style="margin-top: 1em">-l, --long <br>
Use to display all attributes in the output and to show the
output as JSON.</p>

<p style="margin-top: 1em">-m, --medium <br>
Use to display normal attributes in the output and to show
the output as JSON.</p>

<p style="margin-top: 1em">-o SORT, --sort SORT <br>
The order in which search results will be sorted.</p>

<p style="margin-top: 1em">--print-after <br>
Use to show data after a destructive operation.</p>

<p style="margin-top: 1em">-q SEARCH_QUERY, --query
SEARCH_QUERY <br>
Use to protect search queries that start with a hyphen (-).
A -q query may be specified as an argument or an option, but
not both.</p>

<p style="margin-top: 1em">-r, --run-list <br>
Use to show only the run-list.</p>

<p style="margin-top: 1em">-R INT, --rows INT <br>
The number of rows to be returned.</p>

<p style="margin-top: 1em">-s URL, --server-url URL <br>
The URL for the Chef server.</p>

<p style="margin-top: 1em">SEARCH_QUERY <br>
The search query used to identify a a list of items on a
Chef server. This option uses the same syntax as the search
sub-command.</p>

<p style="margin-top: 1em">-u USER, --user USER <br>
The user name used by knife to sign requests made by the API
client to the Chef server. Authentication will fail if the
user name does not match the private key.</p>

<p style="margin-top: 1em">-v, --version <br>
The version of the chef-client.</p>

<p style="margin-top: 1em">-V, --verbose <br>
Set for more verbose outputs. Use -VV for maximum
verbosity.</p>

<p style="margin-top: 1em">-y, --yes <br>
Use to respond to all confirmation prompts with
&quot;Yes&quot;. knife will not ask for confirmation.</p>

<p style="margin-top: 1em">-z, --local-mode <br>
Use to run the chef-client in local mode. This allows all
commands that work against the Chef server to also work
against the local chef-repo.</p>

<p style="margin-top: 1em">Examples</p>

<p style="margin-top: 1em">To search for the IDs of all
nodes running on the Amazon EC2 platform, enter:</p>

<p style="margin-top: 1em">$ knife search node
&rsquo;ec2:*&rsquo; -i</p>

<p style="margin-top: 1em">to return something like:</p>

<p style="margin-top: 1em">4 items found</p>

<p style="margin-top: 1em">ip-0A7CA19F.ec2.internal</p>

<p style="margin-top: 1em">ip-0A58CF8E.ec2.internal</p>

<p style="margin-top: 1em">ip-0A58E134.ec2.internal</p>

<p style="margin-top: 1em">ip-0A7CFFD5.ec2.internal</p>

<p style="margin-top: 1em">To search for the instance type
(flavor) of all nodes running on the Amazon EC2 platform,
enter:</p>

<p style="margin-top: 1em">$ knife search node
&rsquo;ec2:*&rsquo; -a ec2.instance_type</p>

<p style="margin-top: 1em">to return something like:</p>

<p style="margin-top: 1em">4 items found</p>

<p style="margin-top: 1em">ec2.instance_type: m1.large <br>
id: ip-0A7CA19F.ec2.internal</p>

<p style="margin-top: 1em">ec2.instance_type: m1.large <br>
id: ip-0A58CF8E.ec2.internal</p>

<p style="margin-top: 1em">ec2.instance_type: m1.large <br>
id: ip-0A58E134.ec2.internal</p>

<p style="margin-top: 1em">ec2.instance_type: m1.large <br>
id: ip-0A7CFFD5.ec2.internal</p>

<p style="margin-top: 1em">To search for all nodes running
Ubuntu, enter:</p>

<p style="margin-top: 1em">$ knife search node
&rsquo;platform:ubuntu&rsquo;</p>

<p style="margin-top: 1em">To search for all nodes running
CentOS in the production environment, enter:</p>

<p style="margin-top: 1em">$ knife search node
&rsquo;chef_environment:production AND
platform:centos&rsquo;</p>

<p style="margin-top: 1em">To find a nested attribute, use
a pattern similar to the following:</p>

<p style="margin-top: 1em">$ knife search node
&lt;query_to_run&gt; -a
&lt;main_attribute&gt;.&lt;nested_attribute&gt;</p>

<p style="margin-top: 1em">To build a search query to use
more than one attribute, use an underscore (_) to separate
each attribute. For example, the following query will search
for all nodes running a <br>
specific version of Ruby:</p>

<p style="margin-top: 1em">$ knife search node
&quot;languages_ruby_version:1.9.3&quot;</p>

<p style="margin-top: 1em">To build a search query that can
find a nested attribute:</p>

<p style="margin-top: 1em">$ knife search node
name:&lt;node_name&gt; -a kernel.machine</p>

<p style="margin-top: 1em">To test a search query that will
be used in a knife ssh command:</p>

<p style="margin-top: 1em">$ knife search node
&quot;role:web NOT name:web03&quot;</p>

<p style="margin-top: 1em">where the query in the previous
example will search all servers that have the web role, but
not on the server named web03.</p>

<p style="margin-top: 1em">AUTHOR <br>
Chef</p>

<p style="margin-top: 1em">Chef 12.0 KNIFE-SEARCH(1)</p>
<hr>
</body>
</html>
