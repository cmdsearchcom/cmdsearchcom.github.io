<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:20:45 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>KNIFE-SSH(1) knife ssh KNIFE-SSH(1)</p>

<p style="margin-top: 1em">NAME <br>
knife-ssh - The man page for the knife ssh subcommand.</p>

<p style="margin-top: 1em">The knife ssh subcommand is used
to invoke SSH commands (in parallel) on a subset of nodes
within an organization, based on the results of a search
query made to the Chef server.</p>

<p style="margin-top: 1em">Syntax</p>

<p style="margin-top: 1em">This subcommand has the
following syntax:</p>

<p style="margin-top: 1em">$ knife ssh SEARCH_QUERY
SSH_COMMAND (options)</p>

<p style="margin-top: 1em">Options</p>

<p style="margin-top: 1em">This subcommand has the
following options:</p>

<p style="margin-top: 1em">-a SSH_ATTR, --attribute
SSH_ATTR <br>
The attribute that is used when opening the SSH connection.
The default attribute is the FQDN of the host. Other
possible values include a public IP address, a private IP
<br>
address, or a hostname.</p>

<p style="margin-top: 1em">-A, --forward-agent <br>
Use to enable SSH agent forwarding.</p>

<p style="margin-top: 1em">-c CONFIG_FILE, --config
CONFIG_FILE <br>
The configuration file to use.</p>

<p style="margin-top: 1em">-C NUM, --concurrency NUM <br>
The number of allowed concurrent connections.</p>

<p style="margin-top: 1em">--chef-zero-port PORT <br>
The port on which chef-zero will listen.</p>

<p style="margin-top: 1em">--[no-]color <br>
Use to view colored output.</p>

<p style="margin-top: 1em">-d, --disable-editing <br>
Use to prevent the $EDITOR from being opened and to accept
data as-is.</p>

<p style="margin-top: 1em">--defaults <br>
Use to have knife use the default value instead of asking a
user to provide one.</p>

<p style="margin-top: 1em">-e EDITOR, --editor EDITOR <br>
The $EDITOR that is used for all interactive commands.</p>

<p style="margin-top: 1em">-E ENVIRONMENT, --environment
ENVIRONMENT <br>
The name of the environment. When this option is added to a
command, the command will run only against the named
environment.</p>

<p style="margin-top: 1em">-F FORMAT, --format FORMAT <br>
The output format: summary (default), text, json, yaml, and
pp.</p>

<p style="margin-top: 1em">-G GATEWAY, --ssh-gateway
GATEWAY <br>
The SSH tunnel or gateway that is used to run a bootstrap
action on a machine that is not accessible from the
workstation.</p>

<p style="margin-top: 1em">-h, --help <br>
Shows help for the command.</p>

<p style="margin-top: 1em">-i IDENTITY_FILE,
--identity-file IDENTIFY_FILE <br>
The SSH identity file used for authentication. Key-based
authentication is recommended.</p>

<p style="margin-top: 1em">-k KEY, --key KEY <br>
The private key that knife will use to sign requests made by
the API client to the Chef server.</p>

<p style="margin-top: 1em">-m, --manual-list <br>
Use to define a search query as a space-separated list of
servers. If there is more than one item in the list, put
quotes around the entire list. For example: --man&acirc;
<br>
ual-list &quot;server01 server 02 server 03&quot;</p>

<p style="margin-top: 1em">--[no-]host-key-verify <br>
Use --no-host-key-verify to disable host key verification.
Default setting: --host-key-verify.</p>

<p style="margin-top: 1em">OTHER The shell type. Possible
values: interactive, screen, tmux, macterm, or cssh. (csshx
is deprecated in favor of cssh.)</p>

<p style="margin-top: 1em">-p PORT, --ssh-port PORT <br>
The SSH port.</p>

<p style="margin-top: 1em">-P PASSWORD, --ssh-password
PASSWORD <br>
The SSH password. This can be used to pass the password
directly on the command line. If this option is not
specified (and a password is required) knife will prompt for
<br>
the password.</p>

<p style="margin-top: 1em">--print-after <br>
Use to show data after a destructive operation.</p>

<p style="margin-top: 1em">-s URL, --server-url URL <br>
The URL for the Chef server.</p>

<p style="margin-top: 1em">SEARCH_QUERY <br>
The search query used to return a list of servers to be
accessed using SSH and the specified SSH_COMMAND. This
option uses the same syntax as the search sub-command.</p>

<p style="margin-top: 1em">SSH_COMMAND <br>
The command that will be run against the results of a search
query.</p>

<p style="margin-top: 1em">-u USER, --user USER <br>
The user name used by knife to sign requests made by the API
client to the Chef server. Authentication will fail if the
user name does not match the private key.</p>

<p style="margin-top: 1em">-v, --version <br>
The version of the chef-client.</p>

<p style="margin-top: 1em">-V, --verbose <br>
Set for more verbose outputs. Use -VV for maximum
verbosity.</p>

<p style="margin-top: 1em">-x USER_NAME, --ssh-user
USER_NAME <br>
The SSH user name.</p>

<p style="margin-top: 1em">-y, --yes <br>
Use to respond to all confirmation prompts with
&quot;Yes&quot;. knife will not ask for confirmation.</p>

<p style="margin-top: 1em">-z, --local-mode <br>
Use to run the chef-client in local mode. This allows all
commands that work against the Chef server to also work
against the local chef-repo.</p>

<p style="margin-top: 1em">Examples</p>

<p style="margin-top: 1em">To find the uptime of all of web
servers running Ubuntu on the Amazon EC2 platform,
enter:</p>

<p style="margin-top: 1em">$ knife ssh &quot;role:web&quot;
&quot;uptime&quot; -x ubuntu -a ec2.public_hostname</p>

<p style="margin-top: 1em">to return something like:</p>


<p style="margin-top: 1em">ec2-174-129-127-206.compute-1.amazonaws.com
13:50:47 up 1 day, 23:26, 1 user, load average: 0.25, 0.18,
0.11 <br>
ec2-67-202-63-102.compute-1.amazonaws.com 13:50:47 up 1 day,
23:33, 1 user, load average: 0.12, 0.13, 0.10 <br>
ec2-184-73-9-250.compute-1.amazonaws.com 13:50:48 up 16:45,
1 user, load average: 0.30, 0.22, 0.13 <br>
ec2-75-101-240-230.compute-1.amazonaws.com 13:50:48 up 1
day, 22:59, 1 user, load average: 0.24, 0.17, 0.11 <br>
ec2-184-73-60-141.compute-1.amazonaws.com 13:50:48 up 1 day,
23:30, 1 user, load average: 0.32, 0.17, 0.15</p>

<p style="margin-top: 1em">$ knife ssh &rsquo;name:*&rsquo;
&rsquo;sudo chef-client&rsquo;</p>

<p style="margin-top: 1em">To force a chef-client run on
all of the web servers running Ubuntu on the Amazon EC2
platform, enter:</p>

<p style="margin-top: 1em">$ knife ssh &quot;role:web&quot;
&quot;sudo chef-client&quot; -x ubuntu -a
ec2.public_hostname</p>

<p style="margin-top: 1em">to return something like:</p>


<p style="margin-top: 1em">ec2-67-202-63-102.compute-1.amazonaws.com
[Fri, 22 Oct 2010 14:18:37 +0000] INFO: Starting Chef Run
(Version 0.9.10) <br>
ec2-174-129-127-206.compute-1.amazonaws.com [Fri, 22 Oct
2010 14:18:37 +0000] INFO: Starting Chef Run (Version
0.9.10) <br>
ec2-184-73-9-250.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:38 +0000] INFO: Starting Chef Run (Version 0.9.10)
<br>
ec2-75-101-240-230.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:38 +0000] INFO: Starting Chef Run (Version 0.9.10)
<br>
ec2-184-73-60-141.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:38 +0000] INFO: Starting Chef Run (Version 0.9.10)
<br>
ec2-174-129-127-206.compute-1.amazonaws.com [Fri, 22 Oct
2010 14:18:39 +0000] INFO: Chef Run complete in 1.419243
seconds <br>
ec2-174-129-127-206.compute-1.amazonaws.com [Fri, 22 Oct
2010 14:18:39 +0000] INFO: cleaning the checksum cache <br>
ec2-174-129-127-206.compute-1.amazonaws.com [Fri, 22 Oct
2010 14:18:39 +0000] INFO: Running report handlers <br>
ec2-174-129-127-206.compute-1.amazonaws.com [Fri, 22 Oct
2010 14:18:39 +0000] INFO: Report handlers complete <br>
ec2-67-202-63-102.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:39 +0000] INFO: Chef Run complete in 1.578265 seconds
<br>
ec2-67-202-63-102.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:39 +0000] INFO: cleaning the checksum cache <br>
ec2-67-202-63-102.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:39 +0000] INFO: Running report handlers <br>
ec2-67-202-63-102.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:39 +0000] INFO: Report handlers complete <br>
ec2-184-73-9-250.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:40 +0000] INFO: Chef Run complete in 1.638884 seconds
<br>
ec2-184-73-9-250.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:40 +0000] INFO: cleaning the checksum cache <br>
ec2-184-73-9-250.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:40 +0000] INFO: Running report handlers <br>
ec2-184-73-9-250.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:40 +0000] INFO: Report handlers complete <br>
ec2-75-101-240-230.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:40 +0000] INFO: Chef Run complete in 1.540257 seconds
<br>
ec2-75-101-240-230.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:40 +0000] INFO: cleaning the checksum cache <br>
ec2-75-101-240-230.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:40 +0000] INFO: Running report handlers <br>
ec2-75-101-240-230.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:40 +0000] INFO: Report handlers complete <br>
ec2-184-73-60-141.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:40 +0000] INFO: Chef Run complete in 1.502489 seconds
<br>
ec2-184-73-60-141.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:40 +0000] INFO: cleaning the checksum cache <br>
ec2-184-73-60-141.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:40 +0000] INFO: Running report handlers <br>
ec2-184-73-60-141.compute-1.amazonaws.com [Fri, 22 Oct 2010
14:18:40 +0000] INFO: Report handlers complete</p>

<p style="margin-top: 1em">To query for all nodes that have
the webserver role and then use SSH to run the command sudo
chef-client, enter:</p>

<p style="margin-top: 1em">$ knife ssh
&quot;role:webserver&quot; &quot;sudo chef-client&quot;</p>

<p style="margin-top: 1em">$ knife ssh name:* &quot;sudo
aptitude upgrade -y&quot;</p>

<p style="margin-top: 1em">To specify the shell type used
on the nodes returned by a search query:</p>

<p style="margin-top: 1em">$ knife ssh
roles:opscode-omnitruck macterm</p>

<p style="margin-top: 1em">where screen is one of the
following values: cssh, interactive, macterm, screen, or
tmux. If the node does not have the shell type installed,
knife will return an error similar <br>
to the following:</p>

<p style="margin-top: 1em">you need the rb-appscript gem to
use knife ssh macterm. <br>
&lsquo;(sudo) gem install rb-appscript&lsquo; to install
<br>
ERROR: LoadError: cannot load such file -- appscript</p>

<p style="margin-top: 1em">AUTHOR <br>
Chef</p>

<p style="margin-top: 1em">Chef 12.0 KNIFE-SSH(1)</p>
<hr>
</body>
</html>
