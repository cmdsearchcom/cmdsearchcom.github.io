<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>ESOREX(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">ESOREX(1)</td>
    <td class="head-vol">User Commands</td>
    <td class="head-rtitle">ESOREX(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
esorex - ESO Recipe Execution Tool
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>esorex</b> [ <i>esorex-options</i>] <i>recipe </i>[<i>recipe-options</i>]
  <i>sof</i>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
EsoRex is the ESO Recipe Execution Tool. It can list, configure and execute
  CPL-based recipes from the command line.
<div style="height: 1.00em;">&#x00A0;</div>
One of the features provided by the CPL is the ability to create data-reduction
  algorithms that run as plugins (dynamic libraries). These are called recipes
  and are one of the main aspects of the CPL data-reduction development
  environment.
<div style="height: 1.00em;">&#x00A0;</div>
As these recipes are dynamic libraries, it is not possible to run them directly
  from the command line. However, ESO provides several tools to do this, thus
  saving recipe developers the need to write such an application themselves. One
  of these is GASGANO (a GUI-based tool) and the other is EsoRex (which runs
  from the command line) and is described here.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">Display this help and exit. If a recipe name is also given,
      then help will be given for it as well. [TRUE]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--version</b></dt>
  <dd class="It-tag">Display version information and exit. [FALSE]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--check-sof-exist</b></dt>
  <dd class="It-tag">When TRUE, all the input files must exist and be readable
      before calling the recipe. This option may also be set using the
      environment variable ESOREX_CHECK_SOF_EXIST. [FALSE]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--config</b></dt>
  <dd class="It-tag">Configuration file to be used for EsoRex. This option may
      also be set using the environment variable ESOREX_CONFIG. []</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--create-config</b></dt>
  <dd class="It-tag">Creates a configuration file for Esorex. If set to TRUE a
      config file 'esorex.rc' is created in the '.esorex' directory in $HOME of
      the user.If a filename is specified, a config file will be created
      accordingly. If a recipe is specified in the command line, then the
      configuration file will be created for the recipe instead (called
      'recipename.rc') Note that an existing file will be overwritten, but a
      backup file will be copied to 'filename.rc.bak' in the same directory. If
      the filename ends with extension .json then a machine-readable JSON format
      will be used. This option may also be set using the environment variable
      ESOREX_CREATE_CONFIG. [FALSE]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--link-dir</b></dt>
  <dd class="It-tag">The directory in which a symbolic link to each of the
      product files should be written. The enable/disable switch to control
      whether the link is actually made is the '--suppress-link' option. This
      option may also be set using the environment variable ESOREX_LINK_DIR.
      [/tmp]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--log-dir</b></dt>
  <dd class="It-tag">Directory where to place the logfile. This option may also
      be set using the environment variable ESOREX_LOG_DIR. [.]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--log-file</b></dt>
  <dd class="It-tag">Filename of logfile. This option may also be set using the
      environment variable ESOREX_LOG_FILE. [esorex.log]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--log-level</b></dt>
  <dd class="It-tag">Controls the severity level of messages that will be
      printed to the logfile. This option may also be set using the environment
      variable ESOREX_LOG_LEVEL. &lt;debug | info | warning | error | off&gt;
      [info]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--no-datamd5</b></dt>
  <dd class="It-tag">Disables the computation of the MD5 data hash for FITS
      product files. This option may also be set using the environment variable
      ESOREX_NO_DATAMD5. [FALSE]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--no-checksum</b></dt>
  <dd class="It-tag">Disables the computation of the standard FITS product
      checksums. This option may also be set using the environment variable
      ESOREX_NO_CHECKSUM. [FALSE]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--man-page</b></dt>
  <dd class="It-tag">Display a manual page for the specified recipe, and then
      exit. Note that this option only applies to recipes, and that it does
      nothing for esorex by itself. See also the '--help' option. This option
      may also be set using the environment variable ESOREX_MAN_PAGE.
    [FALSE]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--mem-check</b></dt>
  <dd class="It-tag">Report on memory status at completion of recipe execution.
      This option may also be set using the environment variable
      ESOREX_MEM_CHECK. [FALSE]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--msg-level</b></dt>
  <dd class="It-tag">Controls the severity level of messages that will be
      printed to the terminal. This option may also be set using the environment
      variable ESOREX_MSG_LEVEL. &lt;debug | info | warning | error | off&gt;
      [info]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--output-dir</b></dt>
  <dd class="It-tag">The directory where the product files should be finally
      moved to (all products are first created in the current dir). This option
      may also be set using the environment variable ESOREX_OUTPUT_DIR. [.]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--output-prefix</b></dt>
  <dd class="It-tag">Prefix applied to any output file. For example, specifying
      'pre' would translate 'filename.fits' to 'pre_0000.fits'. See also the
      '--suppress-prefix' option. This option may also be set using the
      environment variable ESOREX_OUTPUT_PREFIX. [out]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--output-readonly</b></dt>
  <dd class="It-tag">When TRUE, any existing product files in the specified
      output directory will be set to read-only, for user, group and other. If
      FALSE, then EsoRex will use the default permissions for that
      account/directory. destroy any pre-existing files. This option exists for
      the Paranal operations environment. This option can additionally be used
      to prevent EsoRex from overwriting pre-existing files. This option may
      also be set using the environment variable ESOREX_OUTPUT_READONLY.
    [FALSE]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--paf-config</b></dt>
  <dd class="It-tag">Configuration file for creation of PAF files. This option
      may also be set using the environment variable ESOREX_PAF_CONFIG. []</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--params</b></dt>
  <dd class="It-tag">List the input parameters and their current settings
      (whether from the command line or a configuration file) for the esorex
      application. Parameters are labelled using the parameter's alias. If a
      recipe is also specified, then the list of its parameters will also be
      generated in the same way. This option may also be set using the
      environment variable ESOREX_PARAMS. [FALSE]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--products-sof</b></dt>
  <dd class="It-tag">Output file which contains the FITS files created by the
      recipe. If the filename ends with extension .json then a machine-readable
      JSON formatwill be used. This option may also be set using the environment
      variable ESOREX_PRODUCTS_SOF. []</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--recipes</b></dt>
  <dd class="It-tag">Display a list of all available recipes (that are available
      in the directory tree specified with '--recipe-dir'). This option may also
      be set using the environment variable ESOREX_RECIPES. [FALSE]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--recipe-config</b></dt>
  <dd class="It-tag">Configuration file for any selected recipe. This option may
      also be set using the environment variable ESOREX_RECIPE_CONFIG. []</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--recipe-dir</b></dt>
  <dd class="It-tag">Directory containing recipe libraries. Note that esorex
      will recursively search not only the specified directory, but all
      sub-directories below it as well. Multiple directory heads may be
      specified, by separating the starting paths with colons (:). This option
      may also be set using the environment variable ESOREX_PLUGIN_DIR. [.]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--suppress-link</b></dt>
  <dd class="It-tag">When TRUE, no symbolic link is created to the output
      product. However, if FALSE, then a symbolic link is created in the
      directory specified with the option '--link-dir' for each product that is
      created by the recipe. This option may also be set using the environment
      variable ESOREX_SUPPRESS_LINK. [TRUE]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--suppress-prefix</b></dt>
  <dd class="It-tag">When TRUE, the original name of the output product, as
      produced by the recipe, is maintained. If FALSE, then the name of the
      output file is changed to the &quot;prefix_number&quot; format. The prefix
      can be altered using the '--output-prefix' option. This option may also be
      set using the environment variable ESOREX_SUPPRESS_PREFIX. [FALSE]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--time</b></dt>
  <dd class="It-tag">Measure and show the recipe's execution time. This option
      may also be set using the environment variable ESOREX_TIME. [FALSE]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--unload-plugin</b></dt>
  <dd class="It-tag">When TRUE, the plugin is unloaded after execution. If
      FALSE, the plugin is not unloaded after processing, so that a software
      like, e.g. valgrind, can be used for debugging the executed recipe. This
      option may also be set using the environment variable
      ESOREX_UNLOAD_PLUGIN. [TRUE]</dd>
</dl>
<h1 class="Sh" title="Sh" id="ENVIRONMENT"><a class="selflink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
All options can be set as environment parameters as well. See the previous
  paragraph for details.
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
<h1 class="Sh" title="Sh" id="/etc/esorex.rc_$HOME/.esorex/esorex.rc"><a class="selflink" href="#/etc/esorex.rc_$HOME/.esorex/esorex.rc">/etc/esorex.rc
  $HOME/.esorex/esorex.rc</a></h1>
Default configuration files
<div style="height: 1.00em;">&#x00A0;</div>
The configuration file contains the EsoRex options, less the `--&#x00B4; switch,
  but prefixed with `esorex.caller.&#x00B4;. Blank lines are ignored and lines
  beginning with `#&#x00B4; are treated as comments.
<div style="height: 1.00em;">&#x00A0;</div>
Here is an example configuration file.
<div style="height: 1.00em;">&#x00A0;</div>
<br/>
 # Example EsoRex configuration file
<br/>
 #
<br/>
 esorex.caller.recipe-dir=/home/username/EsoRex/Plugins
<br/>
 esorex.caller.log-dir=.
<br/>
 esorex.caller.log-file=esorex.log
<br/>
 esorex.caller.log-file=esorex.log
<br/>
 esorex.caller.output-dir=.
<br/>
 esorex.caller.output-prefix=out_
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="filename.sof"><a class="selflink" href="#filename.sof">filename.sof</a></h1>
A sof file contains a list of the input data. This data is specified in an sof
  file (which is just a text file), where each input file is specified with its
  associated classification and category. The format of each line in the sof
  file is as follows:
<div style="height: 1.00em;">&#x00A0;</div>
<br/>
 full-path-to-file classification
<div style="height: 1.00em;">&#x00A0;</div>
Optionally, a third column may be provided. Permitted values are either RAW or
  CALIB. This is for when a recipe does not identify the type of input file, but
  as all ESO recipes are required to do so, this column is typically not needed.
<div style="height: 1.00em;">&#x00A0;</div>
An example sof file, for the mythological &quot;ZIMOS&quot; instrument, might
  look like this:
<div style="height: 1.00em;">&#x00A0;</div>
<br/>
 /data/mos/ZIMOS.03-12-26T01:05:06.fits MOS_SCIENCE
<br/>
 /data/mos/ZIMOS.03-12-26T01:26:00.fits MOS_SCIENCE
<br/>
 /data/mos/ZIMOS.03-12-26T01:47:04.fits MOS_SCIENCE
<br/>
 /data/cal/master_bias4.fits MASTER_BIAS
<br/>
 /data/cal/grs_LR_red.3.tfits GRISM_TABLE
<br/>
 /data/gasgano/extract_table2.fits EXTRACT_TABLE
<br/>
 /data/cal/badpixel.3.tfits CCD_TABLE
<div style="height: 1.00em;">&#x00A0;</div>
For an concrete example for a specific instrument, check the documentation for
  that instrument.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="HINTS"><a class="selflink" href="#HINTS">HINTS</a></h1>
<h1 class="Sh" title="Sh" id="File_permissions"><a class="selflink" href="#File_permissions">File
  permissions</a></h1>
When a recipe is used with the <b>--suppress-prefix</b> option, and the
  <b>--output-dir</b> is set to the current working directory, then the first
  execution of a recipe will work correctly, but subsequent executions may fail.
  This is due to output products being given `read-only&#x00B4; permission (to
  avoid the potential inadvertant loss of products). The recipe itself is unable
  to modify the permissions, and thus it fails when attempting to create the
  file. The solution (other than using a different output directory or prefixes)
  is to change the permission of these output files or delete them prior to any
  subsequent execution of that recipe.
<div style="height: 1.00em;">&#x00A0;</div>
This problem is less likely to occur in EsoRex v2+, due to the replacement of
  the <b>--output-overwrite</b> option with the <b>--output-readonly</b> (which
  is disabled by default). However, a determined user can still reach this
  situation, in which case the non-readable products must have their permissions
  changed, as described above.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="Configuration_files"><a class="selflink" href="#Configuration_files">Configuration
  files</a></h1>
When creating configuration files, if the the recipe is provided on the command
  line, then EsoRex will generate the configuration file for this recipe. If no
  recipe name is given, then EsoRex will generate a configuration file for
  EsoRex itself. All configuration files are written in the $HOME/.esorex/
  directory.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="Memory_checking"><a class="selflink" href="#Memory_checking">Memory
  checking</a></h1>
It is possible to get EsoRex to check for memory leaks in the recipe that it is
  running, by enabling the <b>--mem-check</b> option. Then, at the conclusion of
  the recipe execution, and after memory deallocation, a list of all remaining
  allocated memory will be printed to screen. If there are no memory leaks, then
  no addition output is displayed.
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Written by the CPL group (Pipeline System Department) European Southern
  Observatory / SDD - Garching
<h1 class="Sh" title="Sh" id="REPORTING_BUGS"><a class="selflink" href="#REPORTING_BUGS">REPORTING
  BUGS</a></h1>
Report bugs to &lt;cpl-help@eso.org&gt;.
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
Copyright 2003-2012, European Southern Observatory.</div>
<table class="foot">
  <tr>
    <td class="foot-date">May 2016</td>
    <td class="foot-os">esorex </td>
  </tr>
</table>
</body>
</html>
