<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:27:19 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>NI6(1) General Commands Manual NI6(1)</p>

<p style="margin-top: 1em">NAME <br>
nI6 - A security assessment tool for attack vectors based on
ICMPv6 Node Information messages</p>

<p style="margin-top: 1em">SYNOPSIS <br>
ni6 [-i INTERFACE] [-S LINK_SRC_ADDR | -R] [-D
LINK_DST_ADDR] [-s SRC_ADDR[/LEN] | -r] [-d DST_ADDR] [-c
HOP_LIMIT] [-y FRAG_SIZE] [-u DST_OPT_HDR_SIZE] [-U
DST_OPT_U_HDR_SIZE] <br>
[-H HBH_OPT_HDR_SIZE] [-P SIZE | -6 IPV6_ADDR | -4 IPV4_ADDR
| -n NAME | -N LEN | -x LEN -o TYPE] [-Z SIZE] [-e] [-C
ICMP6_CODE] [-q NI_QTYPE] [-X NI_FLAGS] [-P SIZE | -w <br>
IPV6_ADDR | -W IPV4_ADDR | -a NAME | -A LEN | -Q LEN -O
TYPE] [-E] [-j PREFIX[/LEN]] [-k PREFIX[/LEN]] [-J
LINK_ADDR] [-K LINK_ADDR] [-b PREFIX[/LEN]] [-g
PREFIX[/LEN]] [-B <br>
LINK_ADDR] [-G LINK_ADDR] [-L | -l] [-z] [-v] [-h]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
ni6 allows the assessment of IPv6 implementations with
respect to a variety of attack vectors based on ICMPv6 Node
Information messages. This tool is part of the SI6
Networks&rsquo; <br>
IPv6 Toolkit: a security assessment suite for the IPv6
protocols.</p>

<p style="margin-top: 1em">This tool has two modes of
operation: &quot;active&quot; and &quot;listening&quot;. In
&quot;active&quot; mode, the tool attacks a specific target,
while in &quot;listening&quot; mode the tool listens to
ICMPv6 Node <br>
Information Query messages on the local network, and sends
ICMPv6 Node Information Reply messages in response to such
traffic. Active mode is employed if an IPv6 Destination <br>
Address is specified. Listening mode is employed if the
&quot;-L&quot; option (or its long counterpart
&quot;--listen&quot;) is set. If both an attack target and
the &quot;-L&quot; option are specified, the <br>
attack is launched against the specified target, and then
the tool enters listening mode to respond incoming packets
with TCP segments.</p>

<p style="margin-top: 1em">The tool supports filtering of
incoming packets based on the Ethernet Source Address, the
Ethernet Destination Address, the IPv6 Source Address, and
the IPv6 Destination Address. <br>
There are two types of filters: &quot;block filters&quot;
and &quot;accept filters&quot;. If any &quot;block
filter&quot; is specified, and the incoming packet matches
any of those filters, the message is <br>
discarded (and thus no ICMPv6 NI Reply messages are sent in
response). If any &quot;accept filter&quot; is specified,
incoming packets must match any of the specified
&quot;accept filters&quot; in <br>
order for the tool to respond with ICMPv6 NI Reply
messages.</p>

<p style="margin-top: 1em">OPTIONS <br>
ni6 takes it parameters as command-line options. Each of the
options can be specified with a short name (one character
preceded with the hyphen character, as e.g. &quot;-i&quot;)
or with a <br>
long name (a string preceded with two hyphen characters, as
e.g. &quot;--interface&quot;).</p>

<p style="margin-top: 1em">ni6 supports IPv6 Extension
Headers, including the IPv6 Fragmentation Header, which
might be of use to circumvent layer-2 filtering and/or
Network Intrusion Detection Systems <br>
(NIDS). However, IPv6 extension headers are not employed by
default, and must be explicitly enabled with the
corresponding options.</p>

<p style="margin-top: 1em">-i INTERFACE, --interface
INTERFACE <br>
This option specifies the network interface that the tool
will use. If the destination address (&quot;-d&quot; option)
is a link-local address, or the &quot;listening&quot;
(&quot;-L&quot;) mode is <br>
selected, the interface must be explicitly specified. The
interface may also be specified along with a destination
address, with the &quot;-d&quot; option.</p>

<p style="margin-top: 1em">-s SRC_ADDR, --src-address
SRC_ADDR</p>

<p style="margin-top: 1em">This option specifies the IPv6
source address (or IPv6 prefix) to be used for the Source
Address of the attack packets. If an IPv6 prefix is
specified, the IPv6 Source <br>
Address of the ICMPv6 packets will be randomized from the
specified prefix.</p>

<p style="margin-top: 1em">Note: When operating in
&quot;listening&quot; mode, the Source Address is
automatically selected depending on the IPv6 Destination
Address of the ICMPv6 NI Query (unless a specific <br>
IPv6 Source Address has been specified with the
&quot;-s&quot; option).</p>

<p style="margin-top: 1em">-d DST_ADDR, --dst-address
DST_ADDR</p>

<p style="margin-top: 1em">This option specifies the IPv6
Destination Address of the victim. It can be left
unspecified only if the &quot;-L&quot; option is selected
(i.e., if the tool is to operate in &quot;lis&acirc; <br>
tening&quot; mode).</p>

<p style="margin-top: 1em">Note: When operating in
&quot;listening&quot; mode, the Destination Address is
automatically set to the Source Address of the incoming
ICMPv6 NI Query message.</p>

<p style="margin-top: 1em">--hop-limit, -A</p>

<p style="margin-top: 1em">This option specifies the Hop
Limit to be used for the IPv6 packets. It is randomized by
default.</p>

<p style="margin-top: 1em">-y SIZE, --frag-hdr SIZE</p>

<p style="margin-top: 1em">This option specifies that the
resulting packet must be fragmented. The fragment size must
be specified as an argument to this option.</p>

<p style="margin-top: 1em">-u HDR_SIZE, --dst-opt-hdr
HDR_SIZE</p>

<p style="margin-top: 1em">This option specifies that a
Destination Options header is to be included in the
resulting packet. The extension header size must be
specified as an argument to this <br>
option (the header is filled with padding options). Multiple
Destination Options headers may be specified by means of
multiple &quot;-u&quot; options.</p>

<p style="margin-top: 1em">-U HDR_SIZE, --dst-opt-u-hdr
HDR_SIZE</p>

<p style="margin-top: 1em">This option specifies a
Destination Options header to be included in the
&quot;unfragmentable part&quot; of the resulting packet. The
header size must be specified as an argument to <br>
this option (the header is filled with padding options).
Multiple Destination Options headers may be specified by
means of multiple &quot;-U&quot; options. This option is
only valid <br>
if the &quot;-y&quot; option is specified (as the concept of
&quot;unfragmentable part&quot; only makes sense when
fragmentation is employed).</p>

<p style="margin-top: 1em">-H HDR_SIZE, --hbh-opt-hdr
HDR_SIZE</p>

<p style="margin-top: 1em">This option specifies that a
Hop-by-Hop Options header is to be included in the resulting
packet. The header size must be specified as an argument to
this option (the <br>
header is filled with padding options). Multiple Hop-by-Hop
Options headers may be specified by means of multiple
&quot;-H&quot; options.</p>

<p style="margin-top: 1em">-S SRC_LINK_ADDR,
--src-link-address SRC_LINK_ADDR</p>

<p style="margin-top: 1em">This option specifies the
link-layer Source Address of the TCP segments. If left
unspecified, the link-layer Source Address is set to the
real link-layer address of the <br>
network interface.</p>

<p style="margin-top: 1em">-D DST_LINK_ADDR,
--dst-link-address DST_LINK_ADDR</p>

<p style="margin-top: 1em">This option specifies the
link-layer Destination Address of the ICMPv6 NI packets. By
default, the link-layer Destination Address is automatically
set to the link-layer <br>
address of the destination host (for on-link destinations)
or to the link-layer of the first-hop router.</p>

<p style="margin-top: 1em">--payload-size, -P</p>

<p style="margin-top: 1em">This options specifies the size
(in bytes) of the ICMPv6 NI payload.</p>

<p style="margin-top: 1em">--subject-ipv6, -6</p>

<p style="margin-top: 1em">This option specifies an IPv6
Address to be used as the Subject of ICMPv6 Node Information
Query messages.</p>

<p style="margin-top: 1em">--subject-ipv4, -4</p>

<p style="margin-top: 1em">This option specifies an IPv4
Address to be used as the Subject of ICMPv6 Node Information
Query messages.</p>

<p style="margin-top: 1em">--subject-name, -n</p>

<p style="margin-top: 1em">This option specifies a Name to
be used as the Subject of ICMPv6 Node Information Query
messages. By default, the specified name is considered to be
a Fully-Qualified <br>
Domain Name (FQDN). Please consult the
&quot;--sname-slabel&quot; option for instructions on how to
specify &quot;single-label&quot; names.</p>

<p style="margin-top: 1em">--subject-fname, -N</p>

<p style="margin-top: 1em">This option instructs the ni6
tool to set the Subject of ICMPv6 NI Query messages to a
forged name of the specified length.</p>

<p style="margin-top: 1em">Note: The forged name is a
sequence of labels of &rsquo;a&rsquo; characters, with the
maximum label size being specified by means of the
&quot;--max-label-size&quot; option.</p>

<p style="margin-top: 1em">--subject-ename, -x</p>

<p style="margin-top: 1em">This option instructs the ni6
tool to set the Subject of an ICMPv6 NI Query message to a
malformed label of the specified length. This option is
useful for including a <br>
malformed label that &quot;spans past the end of the ICMPv6
NI Query&quot;.</p>

<p style="margin-top: 1em">--subject-nloop, -O</p>

<p style="margin-top: 1em">This option specifies that the
Data field should be set to a Name that contains a DNS
compression loop. The loop type is specified with this
option, with valid values <br>
being in the range 0-1.</p>

<p style="margin-top: 1em">--sname-slabel, -e</p>

<p style="margin-top: 1em">This option specifies that the
specified Subject Name is a single-label name, and hence
should be terminated with two (rather than one) NULL
labels.</p>

<p style="margin-top: 1em">--max-label-size, -Z</p>

<p style="margin-top: 1em">This option specifies the
maximum Name label size. It defaults to 63.</p>

<p style="margin-top: 1em">--code, -C</p>

<p style="margin-top: 1em">This option specified the ICMPv6
code. For ICMPv6 NI Query messages, if specific Subject type
is specified, the ICMPv6 code is automatically set to the
corresponding <br>
value.</p>

<p style="margin-top: 1em">--qtype, -q</p>

<p style="margin-top: 1em">This option specifies the Qtype
value of ICMPv6 NI messages. For ICMPv6 NI Reply messages,
if specific Data type is specified, the ICMPv6 Qtype is
automatically set to the <br>
corresponding value.</p>

<p style="margin-top: 1em">--flags, -X</p>

<p style="margin-top: 1em">This option specified the
&quot;Flags&quot; field of the ICMPv6 NI messages.</p>

<p style="margin-top: 1em">For ICMPv6 NI Query messages of
Qtype 3 (Node IPv6 Addresses), the &quot;Flags&quot; field
defaults to &quot;GSLCA&quot;. For ICMPv6 NI Query messages
of Qtype 4 (Node IPv4 Addresses), the <br>
&quot;Flags&quot; field defaults to &quot;A&quot;. For other
ICMPv6 NI Query messages it defaults to 0. For ICMPv6 Reply
messages, the &quot;Flags&quot; field is copied from the
corresponding ICMPv6 <br>
NI Query message.</p>

<p style="margin-top: 1em">--data-ipv6, -w</p>

<p style="margin-top: 1em">This option specifies an IPv6
Address to be used as the Data of ICMPv6 Node Information
Reply messages.</p>

<p style="margin-top: 1em">--data-ipv4, -W</p>

<p style="margin-top: 1em">This option specifies an IPv4
Address to be used as the Data of ICMPv6 Node Information
Reply messages.</p>

<p style="margin-top: 1em">--data-name, -a</p>

<p style="margin-top: 1em">This option specifies a Name to
be used as the Data of ICMPv6 Node Information Reply
messages. By default, the specified name is considered to be
a Fully-Qualified Domain <br>
Name (FQDN). Please consult the &quot;--dname-slabel&quot;
option for instructions on how to specify
&quot;single-label&quot; names.</p>

<p style="margin-top: 1em">--data-fname, -A</p>

<p style="margin-top: 1em">This option instructs the ni6
tool to set the Data of the ICMPv6 NI Reply messages to a
forged name of the specified length.</p>

<p style="margin-top: 1em">Note: The forged name is a
sequence of labels of &rsquo;a&rsquo; characters, with the
maximum label size being specified by means of the
&quot;--max-label-size&quot; option.</p>

<p style="margin-top: 1em">--data-ename, -Q</p>

<p style="margin-top: 1em">This option instructs the ni6
tool to set the Data of ICMPv6 NI Reply messages to a
malformed label of the specified length. This option is
useful for including a mal&acirc; <br>
formed label that &quot;spans past the end of the ICMPv6 NI
Reply&quot;.</p>

<p style="margin-top: 1em">--data-nloop, -O</p>

<p style="margin-top: 1em">This option specifies that the
Data field should be set to a Name that contains a DNS
compression loop. The loop type is specified with this
option, with valid values <br>
being in the range 0-2.</p>

<p style="margin-top: 1em">--dname-slabel, -E</p>

<p style="margin-top: 1em">This option specifies that the
specified Data Name is a single-label name, and hence should
be terminated with two (rather than one) NULL labels.</p>

<p style="margin-top: 1em">-j SRC_ADDR, --block-src
SRC_ADDR</p>

<p style="margin-top: 1em">This option sets a block filter
for the incoming packets, based on their IPv6 Source
Address. It allows the specification of an IPv6 prefix in
the form &quot;-j prefix/pre&acirc; <br>
fixlen&quot;. If the prefix length is not specified, a
prefix length of &quot;/128&quot; is selected (i.e., the
option assumes that a single IPv6 address, rather than an
IPv6 prefix, has <br>
been specified).</p>

<p style="margin-top: 1em">-k DST_ADDR, --block-dst
DST_ADDR</p>

<p style="margin-top: 1em">This option sets a block filter
for the incoming Neighbor Solicitation messages, based on
their IPv6 Destination Address. It allows the specification
of an IPv6 prefix in <br>
the form &quot;-k prefix/prefixlen&quot;. If the prefix
length is not specified, a prefix length of &quot;/128&quot;
is selected (i.e., the option assumes that a single IPv6
address, rather <br>
than an IPv6 prefix, has been specified).</p>

<p style="margin-top: 1em">-J SRC_ADDR, --block-link-src
SRC_ADDR</p>

<p style="margin-top: 1em">This option sets a block filter
for the incoming packets, based on their link-layer Source
Address. The option must be followed by a link-layer address
(this option is <br>
only valid for Ethernet interfaces).</p>

<p style="margin-top: 1em">-K DST_ADDR, --block-link-dst
DST_ADDR</p>

<p style="margin-top: 1em">This option sets a block filter
for the incoming packets, based on their link-layer
Destination Address. The option must be followed by a
link-layer address (this option <br>
is only valid for Ethernet interfaces).</p>

<p style="margin-top: 1em">-b SRC_ADDR, --accept-src
SRC_ADDR</p>

<p style="margin-top: 1em">This option sets an accept
filter for the incoming packets, based on their IPv6 Source
Address. It allows the specification of an IPv6 prefix in
the form &quot;-b prefix/pre&acirc; <br>
fixlen&quot;. If the prefix length is not specified, a
prefix length of &quot;/128&quot; is selected (i.e., the
option assumes that a single IPv6 address, rather than an
IPv6 prefix, has <br>
been specified).</p>

<p style="margin-top: 1em">-g DST_ADDR, --accept-dst
DST_ADDR</p>

<p style="margin-top: 1em">This option sets a accept filter
for the incoming packets, based on their IPv6 Destination
Address. It allows the specification of an IPv6 prefix in
the form &quot;-g pre&acirc; <br>
fix/prefixlen&quot;. If the prefix length is not specified,
a prefix length of &quot;/128&quot; is selected (i.e., the
option assumes that a single IPv6 address, rather than an
IPv6 pre&acirc; <br>
fix, has been specified).</p>

<p style="margin-top: 1em">-B SRC_ADDR, --accept-link-src
SRC_ADDR</p>

<p style="margin-top: 1em">This option sets an accept
filter for the incoming Neighbor Solicitation messages,
based on their link-layer Source Address. The option must be
followed by a link-layer <br>
address (this option is only valid for Ethernet
interfaces).</p>

<p style="margin-top: 1em">-G DST_ADDR, --accept-link-dst
DST_ADDR</p>

<p style="margin-top: 1em">This option sets an accept
filter for the incoming packets, based on their link-layer
Destination Address. The option must be followed by a
link-layer address (this option <br>
is only valid for Ethernet interfaces).</p>

<p style="margin-top: 1em">--forge-src-addr, -r</p>

<p style="margin-top: 1em">This option instructs the ni6
tool to forge the IPv6 Source Address of ICMPv6 NI messages.
Note that when operating in listening mode, unless this tool
is set, ni6 will <br>
not impersonate other nodes.</p>

<p style="margin-top: 1em">--forge-link-src-addr, -R</p>

<p style="margin-top: 1em">This option instructs the ni6
tool to forge the link-layer Source Address of ICMPv6 NI
messages.</p>

<p style="margin-top: 1em">Note: Some interface cards (or
their corresponding drivers) may silently discard packets
that contain a forged link-layer Source Address.</p>

<p style="margin-top: 1em">--loop, -l</p>

<p style="margin-top: 1em">This option instructs the tcp6
tool to send periodic TCP segments to the victim node. The
amount of time to pause between sending TCP segments can be
specified by means of <br>
the &quot;-z&quot; option, and defaults to 1 second. Note
that this option cannot be set in conjunction with the
&quot;-L&quot; (&quot;--listen&quot;) option.</p>

<p style="margin-top: 1em">--sleep, -z</p>

<p style="margin-top: 1em">This option specifies the amount
of time to pause between sending ICMPv6 Node Information
Query messages (when the &quot;--loop&quot; option is set).
If left unspecified, it <br>
defaults to 1 second.</p>

<p style="margin-top: 1em">--listen, -L</p>

<p style="margin-top: 1em">This instructs the ni6 tool to
operate in listening mode (possibly after attacking a
specified target). Note that this option cannot be used in
conjunction with the &quot;-l&quot; <br>
(&quot;--loop&quot;) option.</p>

<p style="margin-top: 1em">--verbose, -v</p>

<p style="margin-top: 1em">This option instructs the ni6
tool to be verbose. When the option is set twice, the tool
is &quot;very verbose&quot;, and the tool also informs which
packets have been discarded as <br>
a result of applying the specified filters.</p>

<p style="margin-top: 1em">--help, -h</p>

<p style="margin-top: 1em">Print help information for the
ni6 tool.</p>

<p style="margin-top: 1em">EXAMPLES <br>
The following sections illustrate typical use cases of the
ni6 tool.</p>

<p style="margin-top: 1em">Example #1</p>

<p style="margin-top: 1em"># ni6 -i eth0 --subject-ipv6
ff02::1 -d ff02::1 -q 2 -v</p>

<p style="margin-top: 1em">Send an ICMPv6 Node Information
Query to the multicast address ff02::1 (&quot;-d&quot;
option), with a Subject IPv6 Address of &quot;ff02::1&quot;
(&quot;--subject-ipv6&quot; option), querying for Node names
<br>
(&quot;-q&quot; option). Be verbose.</p>

<p style="margin-top: 1em">Example #2</p>

<p style="margin-top: 1em"># ni6 -i eth0 --data-fname 1000
-L --forge-src-addr -v</p>

<p style="margin-top: 1em">Listen to incoming ICMPv6 Node
Information Query messages querying for node names, and
respond with ICMPv6 NI Reply messages that contain a forged
name of 700 bytes. Forge the <br>
IPv6 Source Address of the packets. Be verbose.</p>

<p style="margin-top: 1em">AUTHOR <br>
The ni6 tool and the corresponding manual pages were
produced by Fernando Gont &lt;fgont@si6networks.com&gt; for
SI6 Networks &lt;http://www.si6networks.com&gt;.</p>

<p style="margin-top: 1em">COPYRIGHT <br>
Copyright (c) 2011-2013 Fernando Gont.</p>

<p style="margin-top: 1em">Permission is granted to copy,
distribute and/or modify this document under the terms of
the GNU Free Documentation License, Version 1.3 or any later
version published by the <br>
Free Software Foundation; with no Invariant Sections, no
Front-Cover Texts, and no Back-Cover Texts. A copy of the
license is available at <br>
&lt;http://www.gnu.org/licenses/fdl.html&gt;.</p>
 
<p style="margin-top: 1em">NI6(1)</p>
<hr>
</body>
</html>
