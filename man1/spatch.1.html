<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:38:38 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>SPATCH(1) General Commands Manual SPATCH(1)</p>

<p style="margin-top: 1em">NAME <br>
spatch - apply a semantic patch file to a set of C files</p>

<p style="margin-top: 1em">SYNOPSIS <br>
spatch --sp-file &lt;SP&gt; &lt;files&gt; [-o
&lt;outfile&gt; ] [--iso-file &lt;iso&gt; ] [ options ]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
spatch is a program matching and transformation tool for C.
The programmer describes the code to match and the
transformation to perform as a semantic patch, which looks
like a <br>
standard patch, but can transform multiple files at any
number of code sites.</p>

<p style="margin-top: 1em">Further information about spatch
is available at http://coccinelle.lip6.fr/.</p>

<p style="margin-top: 1em">Semantic patch examples can be
found at http://coccinellery.org/, and at the
scripts/coccinelle directory of the Linux Kernel source
code.</p>

<p style="margin-top: 1em">OPTIONS <br>
Here is a summary of the most commonly used options:</p>

<p style="margin-top: 1em">--sp-file &lt;file&gt; <br>
the semantic patch file</p>

<p style="margin-top: 1em">--dir &lt;dir&gt; <br>
process all files in directory recursively</p>

<p style="margin-top: 1em">--iso-file &lt;file&gt; <br>
(default=@SHAREDIR@/standard.iso)</p>

<p style="margin-top: 1em">--macro-file &lt;file&gt; <br>
(default=@SHAREDIR@/standard.h)</p>

<p style="margin-top: 1em">--debug <br>
print some information to help debug the matching
process</p>

<p style="margin-top: 1em">--all-includes <br>
causes all available include files to be used</p>

<p style="margin-top: 1em">--no-includes <br>
causes not even local include files to be used</p>

<p style="margin-top: 1em">-I &lt;dir&gt; <br>
the directory containing the include files</p>

<p style="margin-top: 1em">--include-headers <br>
process header files independently</p>

<p style="margin-top: 1em">--use-glimpse <br>
works with --dir, use information generated by
glimpseindex</p>

<p style="margin-top: 1em">-o &lt;file&gt; <br>
the output file. If none is specified, a patch is generated
on the standard output</p>

<p style="margin-top: 1em">--in-place <br>
do the modification on the file directly</p>

<p style="margin-top: 1em">--out-place <br>
store modifications in a .cocci_res file</p>

<p style="margin-top: 1em">--version <br>
show the version of spatch</p>

<p style="margin-top: 1em">--date show the date on which
spatch was compiled</p>

<p style="margin-top: 1em">--shorthelp <br>
see short list of options</p>

<p style="margin-top: 1em">--longhelp <br>
see all the available options in different categories</p>

<p style="margin-top: 1em">-help, --help <br>
show summary of options.</p>

<p style="margin-top: 1em">EXAMPLES <br>
./spatch --sp-file foo.cocci foo.c</p>

<p style="margin-top: 1em">Apply the semantic patch
foo.cocci to the C file foo.c. The semantic patch is applied
modulo a set of isomorphisms contained in standard.iso
(standard.iso is by default located <br>
in @SHAREDIR@/standard.iso). A patch showing the effect of
the application, if any, will be generated on the standard
output.</p>

<p style="margin-top: 1em">./spatch --sp-file foo.cocci
foo.c -o /tmp/newfoo.c</p>

<p style="margin-top: 1em">The same as the above, except
that a modified version of foo.c is stored in
/tmp/newfoo.c.</p>

<p style="margin-top: 1em">It is also possible to apply
spatch to all of the C files in a directory:</p>

<p style="margin-top: 1em">./spatch --cocci-file foo.cocci
--dir foodir</p>

<p style="margin-top: 1em">If the semantic patch is not
working as expected, the option --debug shows selection of
information about the application of a semantic patch to a
file or directory.</p>

<p style="margin-top: 1em">MORE OPTIONS <br>
MAIN OPTIONS</p>

<p style="margin-top: 1em">--sp-file <br>
&lt;file&gt; the semantic patch file</p>

<p style="margin-top: 1em">-o &lt;file&gt; the output
file</p>

<p style="margin-top: 1em">--in-place <br>
do the modification on the file directly</p>

<p style="margin-top: 1em">--backup-suffix <br>
suffix to use when making a backup for inplace</p>

<p style="margin-top: 1em">--out-place <br>
store modifications in a .cocci_res file</p>

<p style="margin-top: 1em">--reverse <br>
invert the semantic patch before applying it</p>

<p style="margin-top: 1em">-U set number of diff context
lines</p>

<p style="margin-top: 1em">--partial-match <br>
report partial matches of the SP on the C file</p>

<p style="margin-top: 1em">--iso-file <br>
&lt;file&gt;
(default=/usr/local/lib/coccinelle/standard.iso)</p>

<p style="margin-top: 1em">--macro-file <br>
&lt;file&gt;</p>

<p style="margin-top: 1em">--macro-file-builtins <br>
&lt;file&gt;
(default=/usr/local/lib/coccinelle/standard.h)</p>

<p style="margin-top: 1em">--recursive-includes <br>
causes all available include files, both those included in
the C file(s) and those included in header files, to be
used</p>

<p style="margin-top: 1em">--all-includes <br>
causes all available include files included in the C file(s)
to be used</p>

<p style="margin-top: 1em">--no-includes <br>
causes not even local include files to be used</p>

<p style="margin-top: 1em">--local-includes <br>
causes local include files to be used</p>

<p style="margin-top: 1em">--ignore-unknown-options <br>
For integration in a toolchain (must be set before the first
unknown option)</p>

<p style="margin-top: 1em">--include-headers <br>
process header files independently</p>

<p style="margin-top: 1em">-I &lt;dir&gt; containing the
header files (optional)</p>

<p style="margin-top: 1em">--preprocess <br>
run the C preprocessor before applying the semantic
match</p>

<p style="margin-top: 1em">-c gcc/cpp compatibility
mode</p>

<p style="margin-top: 1em">--dir &lt;dir&gt; process all
files in directory recursively</p>

<p style="margin-top: 1em">--use-glimpse <br>
works with --dir, use info generated by glimpseindex</p>

<p style="margin-top: 1em">--use-google <br>
find relevant files using google code search</p>

<p style="margin-top: 1em">--use-idutils <br>
find relevant files using id-utils</p>

<p style="margin-top: 1em">--patch <br>
&lt;dir&gt; path name with respect to which a patch should
be created</p>

<p style="margin-top: 1em">&quot;&quot; for a file in the
current directory</p>

<p style="margin-top: 1em">--kbuild-info <br>
&lt;file&gt; improve --dir by grouping related c files</p>

<p style="margin-top: 1em">--pyoutput <br>
Sets output routine: Standard values:
&lt;coccilib.output.Gtk|coccilib.output.Console&gt;</p>

<p style="margin-top: 1em">--version <br>
guess what</p>

<p style="margin-top: 1em">--date guess what</p>

<p style="margin-top: 1em">--shorthelp <br>
see short list of options</p>

<p style="margin-top: 1em">--longhelp <br>
see all the available options in different categories</p>

<p style="margin-top: 1em">ALIASES AND OBSOLETE OPTIONS</p>

<p style="margin-top: 1em">--sp command line semantic
patch</p>

<p style="margin-top: 1em">--iso short option of
--iso-file</p>

<p style="margin-top: 1em">--cocci-file <br>
&lt;file&gt; the semantic patch file</p>

<p style="margin-top: 1em">MOST USEFUL SHOW OPTIONS</p>

<p style="margin-top: 1em">--show-diff</p>

<p style="margin-top: 1em">--no-show-diff</p>

<p style="margin-top: 1em">--force-diffshow <br>
diff even if only spacing changes</p>

<p style="margin-top: 1em">--show-flow</p>

<p style="margin-top: 1em">--ctl-inline-let</p>

<p style="margin-top: 1em">--ctl-show-mcodekind</p>

<p style="margin-top: 1em">--show-bindings</p>

<p style="margin-top: 1em">--show-transinfo</p>

<p style="margin-top: 1em">--show-misc</p>

<p style="margin-top: 1em">--show-trying <br>
show the name of each function being processed</p>

<p style="margin-top: 1em">--show-dependencies <br>
show the dependencies related to each rule</p>

<p style="margin-top: 1em">VERBOSE SUBSYSTEMS OPTIONS</p>

<p style="margin-top: 1em">--verbose-ctl-engine</p>

<p style="margin-top: 1em">--verbose-match</p>

<p style="margin-top: 1em">--verbose-engine</p>

<p style="margin-top: 1em">--graphical-trace <br>
generate a pdf file representing the matching process</p>

<p style="margin-top: 1em">--gt-without-label <br>
remove graph label (requires option -graphical-trace)</p>

<p style="margin-top: 1em">--parse-error-msg</p>

<p style="margin-top: 1em">--verbose-parsing</p>

<p style="margin-top: 1em">--type-error-msg</p>

<p style="margin-top: 1em">OTHER SHOW OPTIONS</p>

<p style="margin-top: 1em">--show-c</p>

<p style="margin-top: 1em">--show-cocci</p>

<p style="margin-top: 1em">--show-before-fixed-flow</p>

<p style="margin-top: 1em">--show-ctl-tex</p>

<p style="margin-top: 1em">--show-ctl-text</p>

<p style="margin-top: 1em">--show-SP</p>

<p style="margin-top: 1em">DEBUG C PARSING/UNPARSING</p>

<p style="margin-top: 1em">--debug-cpp</p>

<p style="margin-top: 1em">--debug-lexer</p>

<p style="margin-top: 1em">--debug-etdt</p>

<p style="margin-top: 1em">--debug-typedef</p>

<p style="margin-top: 1em">--filter-msg <br>
filter some cpp message when the macro is a
&quot;known&quot; cpp construct</p>

<p style="margin-top: 1em">--filter-define-error</p>

<p style="margin-top: 1em">--filter-msg-define-error <br>
filter the error msg</p>

<p style="margin-top: 1em">--filter-passed-level</p>

<p style="margin-top: 1em">--debug-unparsing</p>

<p style="margin-top: 1em">SHORTCUT FOR ENABLING/DISABLING
A SET OF DEBUGGING OPTIONS AT ONCE</p>

<p style="margin-top: 1em">--quiet</p>

<p style="margin-top: 1em">--very-quiet</p>

<p style="margin-top: 1em">--debug</p>

<p style="margin-top: 1em">--pad</p>

<p style="margin-top: 1em">BENCH OPTIONS</p>

<p style="margin-top: 1em">--profile <br>
gather timing information about the main coccinelle
functions</p>

<p style="margin-top: 1em">--bench <br>
&lt;level&gt; for profiling the CTL engine</p>

<p style="margin-top: 1em">--timeout <br>
&lt;sec&gt; timeout in seconds</p>

<p style="margin-top: 1em">--steps <br>
max number of model checking steps per code unit</p>

<p style="margin-top: 1em">--iso-limit <br>
max depth of iso application</p>

<p style="margin-top: 1em">--no-iso-limit <br>
disable limit on max depth of iso application</p>

<p style="margin-top: 1em">--track-iso <br>
gather information about isomorphism usage</p>

<p style="margin-top: 1em">--disable-iso <br>
disable a specific isomorphism</p>

<p style="margin-top: 1em">--profile-iso <br>
gather information about the cost of isomorphism usage</p>

<p style="margin-top: 1em">CHANGE OF ALGORITHM OPTIONS</p>

<p style="margin-top: 1em">--keep-comments <br>
keep comments around removed code</p>

<p style="margin-top: 1em">--loop</p>

<p style="margin-top: 1em">--no-loops <br>
drop all back edges derived from looping constructs -
unsafe</p>

<p style="margin-top: 1em">--no-gotos <br>
drop all jumps derived from gotos - unsafe</p>

<p style="margin-top: 1em">--no-saved-typedefs <br>
drop all inferred typedefs from one parse of some code to
the next</p>

<p style="margin-top: 1em">--ocaml-regexps <br>
use OCaml Str regular expressions for constraints</p>

<p style="margin-top: 1em">--l1</p>

<p style="margin-top: 1em">--ifdef-to-if <br>
convert ifdef to if (experimental)</p>

<p style="margin-top: 1em">--no-ifdef-to-if <br>
convert ifdef to if (experimental)</p>

<p style="margin-top: 1em">--disable-multi-pass</p>

<p style="margin-top: 1em">--noif0-passing</p>

<p style="margin-top: 1em">--defined</p>

<p style="margin-top: 1em">--undefined</p>

<p style="margin-top: 1em">--noadd-typedef-root</p>

<p style="margin-top: 1em">--disallow-nested-exps <br>
disallow an expresion pattern from matching a term and its
subterm</p>

<p style="margin-top: 1em">--disable-worth-trying-opt</p>

<p style="margin-top: 1em">--only-return-is-error-exitif
this flag is not set, then break and continue are also error
exits</p>

<p style="margin-top: 1em">--allow-inconsistent-paths <br>
if this flag is set don&rsquo;t check for inconsistent
paths; dangerous</p>

<p style="margin-top: 1em">--no-safe-expressions <br>
make an expression disjunction not prioritise the topmost
disjunct</p>

<p style="margin-top: 1em">--int-bits <br>
the number of bits in an unsigned int</p>

<p style="margin-top: 1em">--long-bits <br>
the number of bits in an unsigned long</p>

<p style="margin-top: 1em">--linux-spacing <br>
spacing of + code follows the conventions of Linux</p>

<p style="margin-top: 1em">--smpl-spacing <br>
spacing of + code follows the semantic patch</p>

<p style="margin-top: 1em">-D indicate that a virtual rule
should be considered to be matched</p>

<p style="margin-top: 1em">--c++ make a small attempt to
parse C++ files. The supported extensions for source files
are .cpp, .cxx, .cc, and for header files are .h, .hpp and
.hxx. Note that this option <br>
disables the processing of .c files as Coccinelle behaviour
is different for C++.</p>

<p style="margin-top: 1em">MISC OPTIONS</p>

<p style="margin-top: 1em">--debugger <br>
option to set if launch spatch in ocamldebug</p>

<p style="margin-top: 1em">--disable-once <br>
to print more messages</p>

<p style="margin-top: 1em">--show-trace-profile <br>
show trace</p>

<p style="margin-top: 1em">--save-tmp-files</p>

<p style="margin-top: 1em">CONCURRENCY</p>

<p style="margin-top: 1em">--index <br>
the processor to use for this run of spatch</p>

<p style="margin-top: 1em">--max the number of processors
available</p>

<p style="margin-top: 1em">--mod-distrib <br>
use mod to distribute files among the processors</p>

<p style="margin-top: 1em">PAD OPTIONS</p>

<p style="margin-top: 1em">--use-cache <br>
use .ast_raw pre-parsed cached C file</p>

<p style="margin-top: 1em">--cache-prefix <br>
directory of cached ASTs, sets --use-cache</p>

<p style="margin-top: 1em">--cache-limit <br>
maximum number of cached ASTs, sets --use-cache</p>

<p style="margin-top: 1em">TEST MODE AND TEST OPTIONS
(WORKS WITH TESTS/ OR .OK FILES) <br>
The test options don&rsquo;t work with the --sp-file and so
on.</p>

<p style="margin-top: 1em">--test &lt;file&gt; launch
spatch on tests/file.[c,cocci]</p>

<p style="margin-top: 1em">--testall <br>
launch spatch on all files in tests/ having a .res</p>

<p style="margin-top: 1em">--test-okfailed <br>
generates .{ok,failed,spatch_ok} files using .res files</p>

<p style="margin-top: 1em">--test-regression-okfailed <br>
process the .{ok,failed,spatch_ok} files in current dir</p>

<p style="margin-top: 1em">--compare-with-expected <br>
use also file.res</p>

<p style="margin-top: 1em">--expected-score-file <br>
which score file to compare with in --testall</p>

<p style="margin-top: 1em">--no-update-score-file <br>
do not update the score file when --testall succeeds</p>

<p style="margin-top: 1em">--relax-include-path</p>

<p style="margin-top: 1em">ACTION MODE <br>
The action options don&rsquo;t work with the --sp-file and
so on. It&rsquo;s for the other (internal) uses of the
spatch program.</p>

<p style="margin-top: 1em">--tokens-c <br>
&lt;file&gt;</p>

<p style="margin-top: 1em">--parse-c <br>
&lt;file or dir&gt;</p>

<p style="margin-top: 1em">--parse-h <br>
&lt;file or dir&gt;</p>

<p style="margin-top: 1em">--parse-ch <br>
&lt;file or dir&gt;</p>

<p style="margin-top: 1em">--parse-i <br>
&lt;file or dir&gt;</p>

<p style="margin-top: 1em">--parse <br>
&lt;file or dir&gt;</p>

<p style="margin-top: 1em">--show-flow <br>
&lt;file or file:function&gt;</p>

<p style="margin-top: 1em">--control-flow <br>
&lt;file or file:function&gt;</p>

<p style="margin-top: 1em">--control-flow-to-file <br>
&lt;file or file:function&gt;</p>

<p style="margin-top: 1em">--test-cfg-ifdef <br>
&lt;file&gt;</p>

<p style="margin-top: 1em">--parse-unparse <br>
&lt;file&gt;</p>

<p style="margin-top: 1em">--type-c <br>
&lt;file&gt;</p>

<p style="margin-top: 1em">--compare-c <br>
&lt;file1&gt; &lt;file2&gt;</p>

<p style="margin-top: 1em">--comment-annotater-c <br>
&lt;file&gt;</p>

<p style="margin-top: 1em">--compare-c-hardcoded</p>

<p style="margin-top: 1em">--test-attributes <br>
&lt;file&gt;</p>

<p style="margin-top: 1em">--test-cpp <br>
&lt;file&gt;</p>

<p style="margin-top: 1em">--extract-macros <br>
&lt;file or dir&gt;</p>

<p style="margin-top: 1em">--extract-macros-select <br>
&lt;file or dir&gt;</p>

<p style="margin-top: 1em">--xxx &lt;file1&gt; &lt;&gt;</p>

<p style="margin-top: 1em">--parse-cocci <br>
&lt;file&gt;</p>

<p style="margin-top: 1em">--compare-c <br>
&lt;file1&gt; &lt;file2&gt;</p>

<p style="margin-top: 1em">FILES <br>
@SHAREDIR@/standard.iso <br>
This file contains the default set of isomorphisms. <br>
@SHAREDIR@/standard.h <br>
This file contains the default set of macro hints.</p>

<p style="margin-top: 1em">ENVIRONMENT <br>
COCCINELLE_HOME <br>
The path to the Coccinelle share directory. Default is
@SHAREDIR@</p>

<p style="margin-top: 1em">REFERENCES <br>
Y. Padioleau, J.L. Lawall, R.R Hansen, G. Muller.
&quot;Documenting and Automating Collateral Evolutions in
Linux Device Driver&quot;, EuroSys 2008 , Glasgow, Scotland,
April 2008, pp. <br>
247-260.</p>

<p style="margin-top: 1em">Julien Brunel, Damien Doligez,
Ren&Atilde;&copy; Rydhof Hansen, Julia L. Lawall, Gilles
Muller. &quot;A foundation for flow-based program matching:
using temporal logic and model checking&quot;, POPL <br>
2009 , Savannah, GA, USA, January 21-23, 2009, pp.
114-126.</p>

<p style="margin-top: 1em">AUTHOR <br>
spatch was written by Julia Lawall
&lt;julia.lawall@lip6.fr&gt;, Yoann Padioleau
&lt;yoann.padioleau@gmail.com&gt;, Rene Rydhof Hansen
&lt;rrh@cs.aau.dk&gt;, Henrik Stuart
&lt;henrik@hstuart.dk&gt;, <br>
Nicolas Palix &lt;nicolas.palix@imag.fr&gt;, Peter Senna
Tschudin &lt;peter.senna@gmail.com&gt;,
S&Atilde;&copy;bastien Hinderer
&lt;Sebastien.Hinderer@inria.fr&gt;, Xavier Clerc
&lt;xavier.clerc@inria.fr&gt; and <br>
Matthieu Caneill &lt;matthieu.caneill42@gmail.com&gt;.</p>

<p style="margin-top: 1em">This manual page was written by
Yoann Padioleau &lt;yoann.padioleau@gmail.com&gt;, Julia
Lawall &lt;julia.lawall@lip6.fr&gt;, Nicolas Palix
&lt;nicolas.palix@imag.fr&gt; and Peter Senna Tschudin <br>
&lt;peter.senna@gmail.com&gt;.</p>

<p style="margin-top: 1em">REPORTING BUGS <br>
Send a mail to &lt;cocci@systeme.lip6.fr&gt;</p>

<p style="margin-top: 1em">COPYRIGHT <br>
Copyright 2012, 2015, INRIA and University of Grenoble-Alpes
LIG. Copyright 2010, 2011, University of Copenhagen DIKU and
INRIA. Copyright 2005-2009, Ecole des Mines de Nantes, <br>
University of Copenhagen. spatch is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License as published by the Free Software
<br>
Foundation, according to version 2 of the License.</p>

<p style="margin-top: 1em">SEE ALSO <br>
patch(1), diff(1)</p>

<p style="margin-top: 1em">Feb 26, 2015 SPATCH(1)</p>
<hr>
</body>
</html>
