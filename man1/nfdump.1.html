<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>nfdump(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">nfdump(1)</td>
    <td class="head-vol"></td>
    <td class="head-rtitle">nfdump(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
nfdump - netflow display and analyze program
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"><b>nfdump
  [options] [filter]</b></div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>nfdump</b> is the netflow display and analyzing program of the nfdump tool
  set. It reads the netflow data from files stored by nfcapd and processes the
  flows according the options given. The filter syntax is comparable to tcpdump
  and extended for netflow data. Nfdump can also display many different top N
  flow and flow element statistics.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-r <i>inputfile</i></b></dt>
  <dd class="It-tag">Read input data from <i>inputfile</i>. Default is read from
      stdin.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-R <i>expr</i></b></dt>
  <dd class="It-tag">Read input from a sequence of files in the same directory.
      <i>expr</i> may be one of:</dd>
</dl>
<div style="margin-left: 4.00ex;">/any/<i>dir</i> Read recursively all files in
  directory <i>dir</i>.
<div class="Pp"></div>
/dir/ <i>file</i> Read all files beginning with <i>file</i>.
<div class="Pp"></div>
/dir/ <i>file1:file2</i> Read all files from <i>file1</i> to <i>file2</i>.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
When using in combination with a sub hierarchy:
<div class="Pp"></div>
/dir/ <i>sub1/sub2/file1:sub3/sub4/file2</i>
<div class="Pp"></div>
Read all files from <i>sub1/sub2/file1</i> <i>sub3/sub4/file2</i> iterating over
  all required hierarchy levels.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
Note: files are read in alphabetical sequence.</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-M <i>expr</i></b></dt>
  <dd class="It-tag">Read input from multiple directories. <i>expr</i> looks
      like: <i>/any/path/to/dir1:dir2:dir3</i> etc. and will be expanded to the
      directories: <i>/any/path/to/dir1</i>, <i>/any/path/to/dir2</i> and
      <i>/any/path/to/dir3</i> Any number of colon separated directories may be
      given. The files to read are specified by -r or -R and are expected to
      exist in all the given directories. The options -r and -R must not contain
      any directory part when used in conjunction with -M.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-m</b></dt>
  <dd class="It-tag">depricated option. Use -O tstart instead.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-O <i>order</i></b></dt>
  <dd class="It-tag">Set sort order to print flows or aggregated flows.
      <i>order</i> can be:</dd>
</dl>
<div style="margin-left: 5.00ex;">flows Sort according the number of flows
<div>&#x00A0;</div>
packets Sort according to (in)packets
<div>&#x00A0;</div>
ipkg Same as packets
<div>&#x00A0;</div>
opkg Sort according to output packets
<div>&#x00A0;</div>
bytes Sort according to (in)bytes
<div>&#x00A0;</div>
ibyte Same as bytes
<div>&#x00A0;</div>
obyte Sort according to output bytes
<div>&#x00A0;</div>
pps Sort according to (in)packets per second
<div>&#x00A0;</div>
ipps Same as ipps
<div>&#x00A0;</div>
opps Sort according to out packets per second
<div>&#x00A0;</div>
bps Sort according to (in)bytes per second
<div>&#x00A0;</div>
ibps Same as bps
<div>&#x00A0;</div>
obps Sort according to output bytes per second
<div>&#x00A0;</div>
bpp Sort according to (in)bytes per packet
<div>&#x00A0;</div>
ibpp Same as bpp
<div>&#x00A0;</div>
obpp Sort according to output packets
<div>&#x00A0;</div>
tstart Sort according to start time of flow - former -m
<div>&#x00A0;</div>
tend&quot; Sort according to end time of flows</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-w <i>outputfile</i></b></dt>
  <dd class="It-tag">If specified writes binary netflow records to
      <i>outputfile</i> ready to be processed again with nfdump. The default
      output is ASCII on stdout. In combination with options -m, -a, -b, and -B
      write aggregated and/or sorted flow cache in binary format to disk.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f <i>filterfile</i></b></dt>
  <dd class="It-tag">Reads the filter syntax from <i>filterfile</i>. Note: Any
      filter specified directly on the command line takes precedence over
    -f.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-t <i>timewin</i></b></dt>
  <dd class="It-tag">Process only flows, which fall in the time window
      <i>timewin</i>, where <i>timewin</i> is
      YYYY/MM/dd.hh:mm:ss[-YYYY/MM/dd.hh:mm:ss]. Any parts of the time spec may
      be omitted e.g YYYY/MM/dd expands to YYYY/MM/dd.00:00:00-infinity and
      processes all flow from a given day onwards. The time window may also be
      specified as +/- n. In this case it is relativ to the beginning or end of
      all flows. +10 means the first 10 seconds of all flows, -10 means the last
      10 seconds of all flows.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c <i>num</i></b></dt>
  <dd class="It-tag">Limit the number of records to read and process from
      file(es) to the first <i>num</i> flows.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-a</b></dt>
  <dd class="It-tag">Aggregate netflow data. Automatically implies -a.
      Aggregation is done at connection level by taking the 5-tuple protocol,
      srcip, dstip, srcport and dstport.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-A <i>aggregation</i></b></dt>
  <dd class="It-tag">Similar to Flexible Netflow (FNF), netflow records can be
      aggregated by any number of given v9 fields. <i>aggregation</i> is a ','
      separated list of recognised tags of the following list:</dd>
</dl>
<div style="margin-left: 5.00ex;">proto IP protocol
<div>&#x00A0;</div>
srcip Source IP address
<div>&#x00A0;</div>
dstip Destination IP address
<div>&#x00A0;</div>
srcip4/net IPv4 source IP address with applied netmask
<div>&#x00A0;</div>
srcip6/net IPv6 source IP address with applied netmask
<div>&#x00A0;</div>
dstip4/net IPv4 destination IP address with applied netmask
<div>&#x00A0;</div>
dstip6/net IPv6 destination IP address with applied netmask
<div>&#x00A0;</div>
srcnet Apply netmask srcmask in netflow record for source IP
<div>&#x00A0;</div>
dstnet Apply netmask dstmask in netflow record for dest IP
<div>&#x00A0;</div>
srcport Source port
<div>&#x00A0;</div>
dstport Destination port
<div>&#x00A0;</div>
srcmask Source mask
<div>&#x00A0;</div>
dstmask Destination mask
<div>&#x00A0;</div>
srcvlan Source vlan label
<div>&#x00A0;</div>
dstvlan Destination vlan label
<div>&#x00A0;</div>
srcas Source AS number
<div>&#x00A0;</div>
dstas Destination AS number
<div>&#x00A0;</div>
nextas BGP Next AS
<div>&#x00A0;</div>
prevas BGP Previous AS
<div>&#x00A0;</div>
inif SNMP input interface number
<div>&#x00A0;</div>
outif SNMP output interface number
<div>&#x00A0;</div>
next IP next hop
<div>&#x00A0;</div>
bgpnext BGP next hop
<div>&#x00A0;</div>
insrcmac In source MAC address
<div>&#x00A0;</div>
outdstmac out destination MAC address
<div>&#x00A0;</div>
indstmac In destintation MAC address
<div>&#x00A0;</div>
outsrcmac Out source MAC address
<div>&#x00A0;</div>
tos Source type of service
<div>&#x00A0;</div>
srctos Source type of Service
<div>&#x00A0;</div>
dsttos Destination type of Service
<div>&#x00A0;</div>
mpls1 MPLS label 1
<div>&#x00A0;</div>
mpls2 MPLS label 2
<div>&#x00A0;</div>
mpls3 MPLS label 3
<div>&#x00A0;</div>
mpls4 MPLS label 4
<div>&#x00A0;</div>
mpls5 MPLS label 5
<div>&#x00A0;</div>
mpls6 MPLS label 6
<div>&#x00A0;</div>
mpls7 MPLS label 7
<div>&#x00A0;</div>
mpls8 MPLS label 8
<div>&#x00A0;</div>
mpls9 MPLS label 9
<div>&#x00A0;</div>
mpls10 MPLS label 10
<div>&#x00A0;</div>
router Exporting router IP</div>
<div style="margin-left: 3.00ex;">
<div class="Pp"></div>
nfdump automatically compiles an appropriate output format for the selected
  aggregation unless an explicit output format is given. The automatic output
  format is identical to <b>-o 'fmt:%ts %td &lt;fields&gt; %pkt %byt %bps %bpp
  %fl'</b> where &lt;fields&gt; represents the selected aggregation tags.
<div class="Pp"></div>
Example:
<div style="margin-left: 3.00ex;"><b> -A proto,srcip,dstport</b>
<div class="Pp"></div>
<b> -A srcas,dstas</b></div>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-b</b></dt>
  <dd class="It-tag">Aggregate netflow records as bidirectional flows.
      Automatically implies -a. Aggregation is done on connection level by
      taking the 5-tuple protocol, srcip, dstip, srcport and dstport, or the
      reverse order for the corresponding connection flow. Input and output
      packets/bytes are counted and reported separate. Both flows are merged
      into a single record. An appropriate output format is selected
      automatically, which may be overwritten by any -o format option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-B</b></dt>
  <dd class="It-tag">Like -b but automagically swaps flows, such that src port
      is &gt; 1024 and dst port is &lt; 1024 as some exporters do not care
      sending the flows in proper order. It's considered to be a convenient
      option. If src and dst port are &gt; 1024 or &lt; 1024, the flows are
      taken as is.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-I</b></dt>
  <dd class="It-tag">Print flow statistics from file specified by -r, or
      timeslot specified by -R/-M.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-D <i>dns</i></b></dt>
  <dd class="It-tag">Set <i>dns</i> as nameserver to lookup hostnames.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s <i>statistic[:p][/orderby]</i></b></dt>
  <dd class="It-tag">Generate the Top N flow or flow element statistic.
      <i>statistic</i> can be:</dd>
</dl>
<div style="margin-left: 5.00ex;">record Statistic about arregated netflow
  records.
<div>&#x00A0;</div>
srcip Statistic about source IP addresses
<div>&#x00A0;</div>
dstip Statistic about destination IP addresses
<div>&#x00A0;</div>
ip Statistic about any (source or destination) IP addresses
<div>&#x00A0;</div>
nhip Statistic about next hop IP addresses
<div>&#x00A0;</div>
nhbip Statistic about BGP next hop IP addresses
<div>&#x00A0;</div>
router Statistic about exporting router IP address
<div>&#x00A0;</div>
srcport Statistic about source ports
<div>&#x00A0;</div>
dstport Statistic about destination ports
<div>&#x00A0;</div>
port Statistic about any (source or destination) ports
<div>&#x00A0;</div>
tos Statistic about type of service - default src
<div>&#x00A0;</div>
srctos Statistic about src type of service
<div>&#x00A0;</div>
dsttos Statistic about dst type of service
<div>&#x00A0;</div>
dir Statistic about flow directions ingress/egress
<div>&#x00A0;</div>
srcas Statistic about source AS numbers
<div>&#x00A0;</div>
dstas Statistic about destination AS numbers
<div>&#x00A0;</div>
as Statistic about any (source or destination) AS numbers
<div>&#x00A0;</div>
inif Statistic about input interface
<div>&#x00A0;</div>
outif Statistic about output interface
<div>&#x00A0;</div>
if Statistic about any interface
<div>&#x00A0;</div>
srcmask Statistic about src mask
<div>&#x00A0;</div>
dstmask Statistic about dst mask
<div>&#x00A0;</div>
srcvlan Statistic about src vlan label
<div>&#x00A0;</div>
dstvlan Statistic about dst vlan label
<div>&#x00A0;</div>
vlan Statistic about any vlan label
<div>&#x00A0;</div>
insrcmac Statistic about input src MAC address
<div>&#x00A0;</div>
outdstmac Statistic about output dst MAC address
<div>&#x00A0;</div>
indstmac Statistic about input dst MAC address
<div>&#x00A0;</div>
outsrcmac Statistic about output src MAC address
<div>&#x00A0;</div>
srcmac Statistic about any src MAC address
<div>&#x00A0;</div>
dstmac Statistic about any dst MAC address
<div>&#x00A0;</div>
inmac Statistic about any input MAC address
<div>&#x00A0;</div>
outmac Statistic about any output MAC address
<div>&#x00A0;</div>
mask Statistic about any mask
<div>&#x00A0;</div>
proto Statistic about IP protocols
<div>&#x00A0;</div>
mpls1 Statistic about MPLS label 1
<div>&#x00A0;</div>
mpls2 Statistic about MPLS label 2
<div>&#x00A0;</div>
mpls3 Statistic about MPLS label 3
<div>&#x00A0;</div>
mpls4 Statistic about MPLS label 4
<div>&#x00A0;</div>
mpls5 Statistic about MPLS label 5
<div>&#x00A0;</div>
mpls6 Statistic about MPLS label 6
<div>&#x00A0;</div>
mpls7 Statistic about MPLS label 7
<div>&#x00A0;</div>
mpls8 Statistic about MPLS label 8
<div>&#x00A0;</div>
mpls9 Statistic about MPLS label 9
<div>&#x00A0;</div>
mpls10 Statistic about MPLS label 10
<div>&#x00A0;</div>
sysid Internal SysID of exporter
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
NSEL/ASA stats
<div>&#x00A0;</div>
event NSEL/ASA event
<div>&#x00A0;</div>
xevent NSEL/ASA extended event
<div>&#x00A0;</div>
xsrcip NSEL/ASA translated src IP address
<div>&#x00A0;</div>
xsrcport NSEL/ASA translated src port
<div>&#x00A0;</div>
xdstip NSEL/ASA translated dst IP address
<div>&#x00A0;</div>
xdstport NSEL/ASA translated dst port
<div>&#x00A0;</div>
iacl NSEL/ASA ingress ACL
<div>&#x00A0;</div>
iace NSEL/ASA ingress ACE
<div>&#x00A0;</div>
ixace NSEL/ASA ingress xACE
<div>&#x00A0;</div>
eacl NSEL/ASA egress ACL
<div>&#x00A0;</div>
eace NSEL/ASA egress ACE
<div>&#x00A0;</div>
exace NSEL/ASA egress xACE
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
NAT stats
<div>&#x00A0;</div>
nevent NAT event
<div>&#x00A0;</div>
vrf/ivrf NAT ingress vrf
<div>&#x00A0;</div>
evrf NAT egress vrf
<div>&#x00A0;</div>
nsrcip NAT src IP address
<div>&#x00A0;</div>
nsrcport NAT src port
<div>&#x00A0;</div>
ndstip NAT dst IP address
<div>&#x00A0;</div>
ndstport NAT dst port
<div>&#x00A0;</div>
</div>
<div style="margin-left: 3.00ex;">
<div class="Pp"></div>
By adding <i>:p</i> to the statistic name, the resulting statistic is split up
  into transport layer protocols. Default is transport protocol independent
  statistics.
<div class="Pp"></div>
<i>orderby</i> is optional and specifies the order by which the statistics is
  ordered and can be <i>flows</i>, <i>packets</i>, <i>bytes</i>, <i>pps</i>,
  <i>bps</i> or <i>bpp</i>. You may specify more than one <i>orderby</i> which
  results in the same statistic but ordered differently. If no <i>orderby</i> is
  given, statistics are ordered by <i>flows</i>. You can specify as many -s flow
  element statistics on the command line for the same run.
<div class="Pp"></div>
Example:
<div style="margin-left: 3.00ex;"><b>-s srcip -s ip/flows -s
  dstport/pps/packets/bytes -s record/bytes</b></div>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-O <i>orderby</i></b></dt>
  <dd class="It-tag">Specifies the default <i>orderby</i> for flow element
      statistics -s, which applies when no <i>orderby</i> is given at -s.
      <i>orderby</i> can be <i>flows</i>, <i>packets</i>, <i>bytes</i>,
      <i>pps</i>, <i>bps</i> or <i>bpp</i>. Defaults to <i>flows</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l <i>[+/-]packet_num</i></b></dt>
  <dd class="It-tag">Limit statistics output to those records above or below the
      <i>packet_num</i> limit. <i>packet_num</i> accepts positive or negative
      numbers followed by 'K' , 'M' or 'G' 10E3, 10E6 or 10E9 flows
      respectively. See also note at -L</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-L <i>[+/-]byte_num</i></b></dt>
  <dd class="It-tag">Limit statistics output to those records above or below the
      <i>byte_num</i> limit. <i>byte_num</i> accepts positive or negative
      numbers followed by 'K' , 'M' or 'G' 10E3, 10E6 or 10E9 bytes
      respectively. <i>Note:</i> These limits only apply to the statistics and
      aggregated outputs generated with -a -s. To filter netflow records by
      packets and bytes, use the filter syntax 'packets' and 'bytes' described
      below.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n <i>num</i></b></dt>
  <dd class="It-tag">For record statistics (-s .. ): Define the number for the
      Top N. Defaults to 10. Use -n 0 to list all records.
    <div>&#x00A0;</div>
    For record sorting and aggregation (-a .. -O ..): Limit the records to the
      first top <i>num</i> sorted records. if not specified or -n 0 is given,
      all records are listed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-o <i>format</i></b></dt>
  <dd class="It-tag">Selects the output format to print flows or flow record
      statistics (-s record). The following formats are available:</dd>
</dl>
<div style="margin-left: 5.00ex;">raw Print each file flow record on multiple
  lines.
<div>&#x00A0;</div>
line Print each flow on one line. Default format.
<div>&#x00A0;</div>
long Print each flow on one line with more details
<div>&#x00A0;</div>
biline Same as line, but for bidir flows
<div>&#x00A0;</div>
bilong Same as long, but for bidir flows
<div>&#x00A0;</div>
extended Print each flow on one line with even more details.
<div>&#x00A0;</div>
nsel Print each NSEL event on one line. Default if NSEL/ASA enabled.
<div>&#x00A0;</div>
nel Print each NAT event on one line. Default if NEL enabled.
<div>&#x00A0;</div>
csv Comma separated output for machine readable processing.
<div>&#x00A0;</div>
pipe Legacy machine readable format: fields '|' separated.
<div>&#x00A0;</div>
fmt: <i>format</i> User defined output format.</div>
<div style="margin-left: 3.00ex;">For each defined output format except -o
  fmt:&lt;format&gt; an IPv6 long output format exists. <b>line6, long6 and
  extended6</b>. See <i>output formats</i> below for more information.</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-q</b></dt>
  <dd class="It-tag">Suppress the header line and the statistics at the
    bottom.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-N</b></dt>
  <dd class="It-tag">Print plain numbers in output. Easier for
    post-parsing.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i <i>ident</i></b></dt>
  <dd class="It-tag">Change ident label in file, specified by -r to
    <i>ident</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v <i>file</i></b></dt>
  <dd class="It-tag">Verify <i>file</i>. Print data file version, number of
      blocks and compression status.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-E file</b></dt>
  <dd class="It-tag">Print exporter/sampler list found in <i>file</i>. In case
      of a nfcapd collector file, an additional statistics per exporter is
      printed with number of flows, packets and sequence errors.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-x file</b></dt>
  <dd class="It-tag">Scan and print extension maps located in file file</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-j</b></dt>
  <dd class="It-tag">Compress flows. Use bz2 compression in output file. Space
      efficient method</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-z</b></dt>
  <dd class="It-tag">Compress flows. Use fast LZO1X-1 compression in output
      file. Time efficient method</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-J num</b></dt>
  <dd class="It-tag">Change compression for file(s) given by -r &lt;file&gt; or
      -R &lt;dir&gt; num: 0 uncompress, 1: LZO1X-1 compression, 2: bz2
      compression</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-Z</b></dt>
  <dd class="It-tag">Check filter syntax and exit. Sets the return value
      accordingly.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-X</b></dt>
  <dd class="It-tag">Compiles the filer syntax and dumps the filter engine table
      to stdout. This is for debugging purpose only.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-V</b></dt>
  <dd class="It-tag">Print nfdump version and exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h</b></dt>
  <dd class="It-tag">Print help text on stdout with all options and exit.</dd>
</dl>
<h1 class="Sh" title="Sh" id="RETURN_VALUE"><a class="selflink" href="#RETURN_VALUE">RETURN
  VALUE</a></h1>
Returns
<div style="margin-left: 4.00ex;">0 No error.
<div class="Pp"></div>
255 Initialization failed.
<div class="Pp"></div>
254 Error in filter syntax.
<div class="Pp"></div>
250 Internal error.</div>
<h1 class="Sh" title="Sh" id="OUTPUT_FORMATS"><a class="selflink" href="#OUTPUT_FORMATS">OUTPUT
  FORMATS</a></h1>
The output format <b>raw</b> prints each flow record on multiple lines,
  including all information available in the record. This is the most detailed
  view on a flow.
<div class="Pp"></div>
Other output formats print each flow on a single line. Predefined output formats
  are <b>line</b>, <b>long</b> and <b>extended</b> The output format <b>line</b>
  is the default output format when no format is specified. It limits the
  imformation to the connection details as well as number of packets, bytes and
  flows.
<div class="Pp"></div>
The output format <b>long</b> is identical to the format <b>line</b>, and
  includes additional information such as TCP flags and Type of Service.
<div class="Pp"></div>
The output format <b>extended</b> is identical to the format <b>long</b>, and
  includes additional computed information such as <b>pps</b>, <b>bps</b> and
  <b>bpp</b>.
<div class="Pp"></div>
<i>Fields:</i>
<div class="Pp"></div>
<div style="margin-left: 3.00ex;"><b>Date flow start:</b> Start time flow first
  seen. ISO 8601 format including miliseconds.
<div class="Pp"></div>
<b>Duration:</b> Duration of the flow in seconds and miliseconds. If flows are
  aggregated, <i>duration</i> is the time span over the entire periode of time
  from first seen to last seen.
<div class="Pp"></div>
<b>Proto:</b> Protocol used in the connection.
<div class="Pp"></div>
<b>Src IP Addr:Port:</b> Source IP address and source port.
<div class="Pp"></div>
<b>Dst IP Addr:Port:</b> Destination IP address and destination port. In case of
  ICMP, port is decodes as type.code.
<div class="Pp"></div>
<b>Flags:</b> TCP flags ORed of the connection.
<div class="Pp"></div>
<b>Tos:</b> Type of service.
<div class="Pp"></div>
<b>Packets:</b> The number of packets in this flow. If flows are aggregated, the
  packets are summed up.
<div class="Pp"></div>
<b>Bytes:</b> The number of bytes in this flow. If flows are aggregated, the
  bytes are summed up.
<div class="Pp"></div>
<b>pps:</b> The calculated packets per second: number of packets / duration. If
  flows are aggregated this results in the average pps during this periode of
  time.
<div class="Pp"></div>
<b>bps:</b> The calculated bits per second: 8 * number of bytes / duration. If
  flows are aggregated this results in the average bps during this periode of
  time.
<div class="Pp"></div>
<b>Bpp:</b> The calculated bytes per packet: number of bytes / number of
  packets. If flows are aggregated this results in the average bpp during this
  periode of time.
<div class="Pp"></div>
<b>Flows:</b> Number of flows. If flows are listed only, this number is always
  1. If flows are aggregated, this shows the number of aggregated flows to one
  record.</div>
<div class="Pp"></div>
Numbers larger than 1'000'000 (1000*1000), are scaled to 4 digits and one
  decimal digit including the scaling factor <b>M</b>, <b>G</b> or <b>T</b> for
  cleaner output, e.g. <b>923.4 M</b>
<div class="Pp"></div>
To make the output more readable, IPv6 addresses are shrinked down to 16
  characters. The seven most and seven least digits connected with two dots
  <b>'..'</b> are displayed in any normal output formats. To display the full
  IPv6 address, use the appropriate long format, which is the format name
  followed by a <b>6</b>.
<div class="Pp"></div>
Example: <b>-o line</b> displays an IPv6 address as <b>2001:23..80:d01e</b>
  where as the format <b>-o line6</b> displays the IPv6 address in full length
  <b>2001:234:aabb::211:24ff:fe80:d01e</b>. The combination of <b>-o line -6</b>
  is equivalent to <b>-o line6</b>.
<div class="Pp"></div>
The output format <b>fmt:&lt;format&gt;</b> allows you to define your own output
  format. A format description <b>format</b> consists of a single line
  containing arbitrary strings and format specifier as described below
<div class="Pp"></div>
<div style="margin-left: 3.00ex;"><b>%&lt;format&gt;</b> Inserts the predefined
  <b>format</b> at this position. e.g. <b>%line</b>
<div>&#x00A0;</div>
<b>%ff</b> flow record flags in hex.
<div>&#x00A0;</div>
<b>%ts</b> Start Time - first seen
<div>&#x00A0;</div>
<b>%te</b> End Time - last seen
<div>&#x00A0;</div>
<b>%tr</b> Time the flow was received by the collector
<div>&#x00A0;</div>
<b>%td</b> Duration
<div>&#x00A0;</div>
<b>%pr</b> Protocol
<div>&#x00A0;</div>
<b>%exp</b> Exporter ID
<div>&#x00A0;</div>
<b>%eng</b> Engine Type/ID
<div>&#x00A0;</div>
<b>%sa</b> Source Address
<div>&#x00A0;</div>
<b>%da</b> Destination Address
<div>&#x00A0;</div>
<b>%sap</b> Source Address:Port
<div>&#x00A0;</div>
<b>%dap</b> Destination Address:Port
<div>&#x00A0;</div>
<b>%sp</b> Source Port
<div>&#x00A0;</div>
<b>%dp</b> Destination Port
<div>&#x00A0;</div>
<b>%sn</b> Source Network, mask applied
<div>&#x00A0;</div>
<b>%dn</b> Destination Network, mask applied
<div>&#x00A0;</div>
<b>%nh</b> Next-hop IP Address
<div>&#x00A0;</div>
<b>%nhb</b> BGP Next-hop IP Address
<div>&#x00A0;</div>
<b>%ra</b> Router IP Address
<div>&#x00A0;</div>
<b>%sas</b> Source AS
<div>&#x00A0;</div>
<b>%das</b> Destination AS
<div>&#x00A0;</div>
<b>%nas</b> Next AS
<div>&#x00A0;</div>
<b>%pas</b> Previous AS
<div>&#x00A0;</div>
<b>%in</b> Input Interface num
<div>&#x00A0;</div>
<b>%out</b> Output Interface num
<div>&#x00A0;</div>
<b>%pkt</b> Packets - default input
<div>&#x00A0;</div>
<b>%ipkt</b> Input Packets
<div>&#x00A0;</div>
<b>%opkt</b> Output Packets
<div>&#x00A0;</div>
<b>%byt</b> Bytes - default input
<div>&#x00A0;</div>
<b>%ibyt</b> Input Bytes
<div>&#x00A0;</div>
<b>%obyt</b> Output Bytes
<div>&#x00A0;</div>
<b>%fl</b> Flows
<div>&#x00A0;</div>
<b>%flg</b> TCP Flags
<div>&#x00A0;</div>
<b>%tos</b> Tos - default src
<div>&#x00A0;</div>
<b>%stos</b> Src Tos
<div>&#x00A0;</div>
<b>%dtos</b> Dst Tos
<div>&#x00A0;</div>
<b>%dir</b> Direction: ingress, egress
<div>&#x00A0;</div>
<b>%smk</b> Src mask
<div>&#x00A0;</div>
<b>%dmk</b> Dst mask
<div>&#x00A0;</div>
<b>%fwd</b> Forwarding Status
<div>&#x00A0;</div>
<b>%svln</b> Src vlan label
<div>&#x00A0;</div>
<b>%dvln</b> Dst vlan label
<div>&#x00A0;</div>
<b>%ismc</b> Input Src Mac Addr
<div>&#x00A0;</div>
<b>%odmc</b> Output Dst Mac Addr
<div>&#x00A0;</div>
<b>%idmc</b> Input Dst Mac Addr
<div>&#x00A0;</div>
<b>%osmc</b> Output Src Mac Addr
<div>&#x00A0;</div>
<b>%mpls1</b> MPLS label 1
<div>&#x00A0;</div>
<b>%mpls2</b> MPLS label 2
<div>&#x00A0;</div>
<b>%mpls3</b> MPLS label 3
<div>&#x00A0;</div>
<b>%mpls4</b> MPLS label 4
<div>&#x00A0;</div>
<b>%mpls5</b> MPLS label 5
<div>&#x00A0;</div>
<b>%mpls6</b> MPLS label 6
<div>&#x00A0;</div>
<b>%mpls7</b> MPLS label 7
<div>&#x00A0;</div>
<b>%mpls8</b> MPLS label 8
<div>&#x00A0;</div>
<b>%mpls9</b> MPLS label 9
<div>&#x00A0;</div>
<b>%mpls10</b> MPLS label 10
<div>&#x00A0;</div>
<b>%mpls</b> MPLS labels 1-10
<div>&#x00A0;</div>
<b>%bps</b> bps - bits per second
<div>&#x00A0;</div>
<b>%pps</b> pps - packets per second
<div>&#x00A0;</div>
<b>%bpp</b> bps - Bytes per package
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
NSEL specific formats
<div>&#x00A0;</div>
<b>%nfc</b> NSEL connection ID
<div>&#x00A0;</div>
<b>%evt</b> NSEL event
<div>&#x00A0;</div>
<b>%xevt</b> NSEL extended event
<div>&#x00A0;</div>
<b>%msec</b> NSEL event time in msec
<div>&#x00A0;</div>
<b>%iacl</b> NSEL ingress ACL
<div>&#x00A0;</div>
<b>%eacl</b> NSEL egress ACL
<div>&#x00A0;</div>
<b>%xsa</b> NSEL XLATE src IP address
<div>&#x00A0;</div>
<b>%xda</b> NSEL XLATE dst IP address
<div>&#x00A0;</div>
<b>%xsp</b> NSEL XLATE src port
<div>&#x00A0;</div>
<b>%xdp</b> NSEL SLATE dst port
<div>&#x00A0;</div>
<b>%xsap</b> Xlate Source Address:Port
<div>&#x00A0;</div>
<b>%xdap</b> Xlate Destination Address:Port
<div>&#x00A0;</div>
<b>%uname</b> NSEL user name
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
NEL/NAT specific formats
<div>&#x00A0;</div>
<b>%nevt</b> NAT event - same as %evt
<div>&#x00A0;</div>
<b>%ivrf</b> NAT ingress VRF ID
<div>&#x00A0;</div>
<b>%evrf</b> NAT egress VRF ID
<div>&#x00A0;</div>
<b>%nsa</b> NAT src IP address
<div>&#x00A0;</div>
<b>%nda</b> NAT dst IP address
<div>&#x00A0;</div>
<b>%nsp</b> NAT src port
<div>&#x00A0;</div>
<b>%ndp</b> NAT dst port
<div>&#x00A0;</div>
<b>%pbstart</b> NAT pool block start
<div>&#x00A0;</div>
<b>%pbend</b> NAT pool block end
<div>&#x00A0;</div>
<b>%pbstep</b> NAT pool block step
<div>&#x00A0;</div>
<b>%pbsize</b> NAT pool block size
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
Nprobe formats
<div>&#x00A0;</div>
<b>%cl</b> Client latency
<div>&#x00A0;</div>
<b>%sl</b> Server latency
<div>&#x00A0;</div>
<b>%al</b> Application latency
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
The &quot;flow flags&quot; format (%ff) prints the internal record flags as a
  single hexadecimal number, consisting of any of these flag values or-ed
  together:
<div class="Pp"></div>
<div style="margin-left: 3.00ex;">
<div>&#x00A0;</div>
1 Record contains IPv6 addresses
<div>&#x00A0;</div>
2 Packet counters are 64-bit
<div>&#x00A0;</div>
4 Byte counters are 64-bit
<div>&#x00A0;</div>
8 IP next hop is an IPv6 address
<div>&#x00A0;</div>
16	BGP next hop is an IPv6 address
<div>&#x00A0;</div>
32 Exporting router is an IPv6 address
<div>&#x00A0;</div>
64 Record is an EVENT record
<div>&#x00A0;</div>
128 Record is sampled</div>
<div class="Pp"></div>
Example: the standard output format <b>long</b> can be created as
<div style="margin-left: 3.00ex;"><b>-o &quot;fmt:%ts %td %pr %sap -&gt; %dap
  %flg %tos %pkt %byt %fl&quot;</b></div>
<div class="Pp"></div>
You may also define your own output format and have it compiled into nfdump. See
  nfdump.c section <b>Output Formats</b> for more details.
<div class="Pp"></div>
The <b>csv</b> output format is intended to be read by another program for
  further processing. As an example, see the parse_csv.pl Perl program. The cvs
  output format consists of one or more output blocks and one summary block.
  Each output block starts with a cvs index line followed by the cvs record
  lines. The index lines describes the order, how each following record is
  composed.
<div class="Pp"></div>
Example:
<div style="margin-left: 3.00ex;">Index line: ts,te,td,sa,da,sp,dp,pr,...
<div>&#x00A0;</div>
Record line: 2004-07-11 10:30:00,2004-07-11 10:30:10,10.010,...
<div>&#x00A0;</div>
</div>
<div class="Pp"></div>
All records are in ASCII readable form. Numbers are not scaled, so each line can
  easily be parsed.
<div class="Pp"></div>
Indices used in nfdump 1.6:
<div class="Pp"></div>
<div style="margin-left: 3.00ex;">ts,te,td time records: t-start, t-end,
  duration
<div>&#x00A0;</div>
sa,da src dst address sp,dp src, dst port
<div>&#x00A0;</div>
pr protocol PF_INET or PF_INET6
<div>&#x00A0;</div>
flg TCP Flags:
<div>&#x00A0;</div>
<br/>
 000001 FIN.
<div>&#x00A0;</div>
<br/>
 000010 SYN
<div>&#x00A0;</div>
<br/>
 000100 RESET
<div>&#x00A0;</div>
<br/>
 001000 PUSH
<div>&#x00A0;</div>
<br/>
 010000 ACK
<div>&#x00A0;</div>
<br/>
 100000 URGENT
<div>&#x00A0;</div>
<br/>
 e.g. 6 =&gt; SYN + RESET
<div>&#x00A0;</div>
fwd forwarding status
<div>&#x00A0;</div>
stos src tos
<div>&#x00A0;</div>
ipkt,ibyt input packets/bytes
<div>&#x00A0;</div>
opkt,obyt output packets, bytes
<div>&#x00A0;</div>
in,out input/output interface SNMP number
<div>&#x00A0;</div>
sas,das src, dst AS
<div>&#x00A0;</div>
smk,dmk src, dst mask
<div>&#x00A0;</div>
dtos dst tos
<div>&#x00A0;</div>
dir direction
<div>&#x00A0;</div>
nh,nhb nethop IP address, bgp next hop IP
<div>&#x00A0;</div>
svln,dvln src, dst vlan id
<div>&#x00A0;</div>
ismc,odmc input src, output dst MAC
<div>&#x00A0;</div>
idmc,osmc input dst, output src MAC
<div>&#x00A0;</div>
mpls1,mpls2 MPLS label 1-10
<div>&#x00A0;</div>
mpls3,mpls4
<div>&#x00A0;</div>
mpls5,mpls6
<div>&#x00A0;</div>
mpls7,mpls8
<div>&#x00A0;</div>
mpls9,mpls10
<div>&#x00A0;</div>
ra router IP
<div>&#x00A0;</div>
eng router engine type/id
<div>&#x00A0;</div>
</div>
<div class="Pp"></div>
See parse_csv.pl for more details.
<h1 class="Sh" title="Sh" id="FILTER"><a class="selflink" href="#FILTER">FILTER</a></h1>
The filter syntax is similar to the well known pcap library used by tcpdump. The
  filter can be either specified on the command line after all options or in a
  separate file. It can span several lines. Anything after a '#' is treated as a
  comment and ignored to the end of the line. There is virtually no limit in the
  length of the filter expression. All keywords are case independent.
<div class="Pp"></div>
Any filter consists of one or more expressions <i>expr</i>. Any number of
  <i>expr</i> can be linked together:
<div class="Pp"></div>
expr <b>and</b> expr, expr <b>or</b> expr, <b>not</b> expr and <b>(</b> expr
  <b>)</b>.
<div class="Pp"></div>
<i>Expr</i> can be one of the following filter primitives:
<dl class="Bl-tag">
  <dt class="It-tag"><i>include</i></dt>
  <dd class="It-tag"><b>@include &lt;file&gt;</b>
    <div>&#x00A0;</div>
    include the content of <i>&lt;file&gt;</i> into filter.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>ip version</i></dt>
  <dd class="It-tag"><b>inet</b> or <b>ipv4</b> for IPv4
    <div>&#x00A0;</div>
     <b>inet6</b> or <b>ipv6</b> for IPv6</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>protocol</i></dt>
  <dd class="It-tag"><b>proto &lt;protocol&gt;</b>
    <div>&#x00A0;</div>
     <b>proto &lt;number&gt;</b>
    <div>&#x00A0;</div>
    where <b>&lt;protocol&gt;</b> is known protocol such as <b>tcp</b>,
      <b>udp</b>, <b>icmp</b>, <b>icmp6</b>, <b>gre</b>, <b>esp</b>, <b>ah</b>,
      etc. or a valid protocol number: <b>6</b>, <b>17</b> etc.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>IP address</i></dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 4.00ex;"><b>[src|dst] ip &lt;ipaddr&gt;</b>
<div>&#x00A0;</div>
<b>[src|dst] host &lt;ipaddr&gt;</b>
<div>&#x00A0;</div>
with <i>&lt;ipaddr&gt;</i> as any valid IPv4, IPv6 address, or a full qualified
  hostname. In case of a hostname, the IP address is looked up in DNS. If more
  than a single IP address is found, all IP addresses are chained together.
  <b>(ip1 or ip2 or ip3 ... )</b>
<div class="Pp"></div>
To check if an IP address is in a known IP list, use
<div>&#x00A0;</div>
<b>[src|dst] ip in [ &lt;iplist&gt; ] </b>
<div>&#x00A0;</div>
<b>[src|dst] host in [ &lt;iplist&gt; ] </b>
<div>&#x00A0;</div>
<i>&lt;iplist&gt;</i> is a space or comma separated list of individual
  <b>&lt;ipaddr&gt;</b> or full qualified hostnames, which are looked up in DNS.
  If more than a single IP address is found, all IP addresses are put into the
  list.</div>
<dl class="Bl-tag">
  <dt class="It-tag"><i>[src|dst]</i></dt>
  <dd class="It-tag">IP addresses, networks, ports, AS number etc. can be
      specifically selected by using a direction qualifier, such as src or
      <b>dst</b>. They can also be used in combination with <b>and</b> and
      <b>or</b>. such as <b>src and dst ip ..</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>network</i></dt>
  <dd class="It-tag"><b>[src|dst] net a.b.c.d m.n.r.s</b>
    <div>&#x00A0;</div>
    Select the IPv4 network <i>a.b.c.d</i> with netmask <i>m.n.r.s</i>.
    <div>&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
    <div>&#x00A0;</div>
     <b>[src|dst] net &lt;net&gt;/&lt;num&gt;</b>
    <div>&#x00A0;</div>
    with <i>&lt;net&gt;</i> as a valid IPv4 or IPv6 network and
      <i>&lt;num&gt;</i> as maskbits. The number of mask bits must match the
      appropriate address familiy in IPv4 or IPv6. Networks may be abreviated
      such as 172.16/16 if they are unambiguous.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>Port</i></dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 4.00ex;"><b>[src|dst] port [comp] &lt;num&gt;</b>
<div>&#x00A0;</div>
with <i>&lt;num&gt;</i> as any valid port number. If <i>comp</i> is omitted,
<br/>
 '=' is assumed. <i>comp</i> is explained more detailed below.
<div>&#x00A0;</div>
<b>[src|dst] port in [ &lt;portlist&gt; ] </b>
<div>&#x00A0;</div>
A port can be compared against a know list, where <b>&lt;portlist&gt;</b> is a
  space separated list of individual port numbers.</div>
<dl class="Bl-tag">
  <dt class="It-tag"><i>ICMP</i></dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 4.00ex;"><b>icmp-type &lt;num&gt;</b>
<div>&#x00A0;</div>
<b>icmp-code &lt;num&gt;</b>
<div>&#x00A0;</div>
with <i>&lt;num&gt;</i> as a valid icmp type/code. This automatically implies
  <b>proto icmp</b>.</div>
<dl class="Bl-tag">
  <dt class="It-tag"><i>Router ID</i></dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 4.00ex;"><b>engine-type &lt;num&gt;</b>
<div>&#x00A0;</div>
<b>engine-id &lt;num&gt;</b>
<div>&#x00A0;</div>
<b>sysid &lt;num&gt;</b>
<div>&#x00A0;</div>
with <i>&lt;num&gt;</i> as a valid router engine type/id or exporter
  ID(0..255).</div>
<dl class="Bl-tag">
  <dt class="It-tag"><i>Interface</i></dt>
  <dd class="It-tag"><b>[in|out] if &lt;num&gt;</b>
    <div>&#x00A0;</div>
    Select input or output or either interface ID, with <i>num</i> as the SNMP
      interface number.
    <div>&#x00A0;</div>
    Example: <b>in if 3</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>AS numbers</i></dt>
  <dd class="It-tag"><b>[src|dst|prev|next] as [comp] &lt;num&gt;</b>
    <div>&#x00A0;</div>
    Selects source, dstination, previous, next or any AS number with
      <i>&lt;num&gt;</i> as any valid as number. 32bit AS numbers are suported.
      If <i>comp</i> is omitted, '=' is assumed. <i>comp</i> is explained more
      detailed below.
    <div>&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
    <div>&#x00A0;</div>
     <b>[src|dst|prev|next] as in [ &lt;ASlist&gt; ] </b>
    <div>&#x00A0;</div>
    An AS number can be compared against a know list, where
      <b>&lt;ASlist&gt;</b> is a space or comma separated list of individual AS
      numbers.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>Prefix mask bits</i></dt>
  <dd class="It-tag"><b>[src|dst] mask &lt;bits&gt;</b>
    <div>&#x00A0;</div>
    with <i>&lt;bits&gt;</i> as any valid prefix mask bit value.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>Vlan labels</i></dt>
  <dd class="It-tag"><b>[src|dst] vlan &lt;num&gt;</b>
    <div>&#x00A0;</div>
    with <i>&lt;num&gt;</i> as any valid vlan label.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>Flags</i></dt>
  <dd class="It-tag"><b>flags &lt;tcpflags&gt;</b>
    <div>&#x00A0;</div>
    with <i>&lt;tcpflags&gt;</i> as a combination of:</dd>
</dl>
<div style="margin-left: 7.00ex;">A ACK.
<div>&#x00A0;</div>
S SYN.
<div>&#x00A0;</div>
F FIN.
<div>&#x00A0;</div>
R Reset.
<div>&#x00A0;</div>
P Push.
<div>&#x00A0;</div>
U Urgent.
<div>&#x00A0;</div>
X All flags on.</div>
The ordering of the flags is not relevant. Flags not mentioned are treated as
  don't care. In order to get those flows with only the SYN flag set, use the
  syntax ' <b>flags S and not</b> <b>flags AFRPU</b>'.
<dl class="Bl-tag">
  <dt class="It-tag"><i>Next hop IP</i></dt>
  <dd class="It-tag"><b>next ip &lt;ipaddr&gt;</b>
    <div>&#x00A0;</div>
    with <i>&lt;ipaddr&gt;</i> as IPv4/IPv6 IP address of next hop router.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>Next-hop router's IP in the BGP domain</i></dt>
  <dd class="It-tag"><b>bgpnext ip &lt;ipaddr&gt;</b>
    <div>&#x00A0;</div>
    with <i>&lt;ipaddr&gt;</i> as IPv4/IPv6 next-hop router's IP in the BGP
      domain. ( v9 #18 )</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>Router IP</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
     <b>router ip &lt;ipaddr&gt;</b>
    <div>&#x00A0;</div>
    Filter the flows according the IP address of the exporting router.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>MAC addresses</i></dt>
  <dd class="It-tag"><b>[InOutSrcDst] mac &lt;addr&gt;</b>
    <div>&#x00A0;</div>
    With <i>&lt;addr&gt;</i> any valid MAC address. <b>mac</b> can be more
      specific specified by using any combination of a direction specifier as
      defined by CISCO v9. <b>in src</b>, <b>in dst</b>, <b>out src</b>, <b>out
      dst</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>MPLS labels</i></dt>
  <dd class="It-tag"><b>mpls label&lt;n&gt; [comp] &lt;num&gt;</b>
    <div>&#x00A0;</div>
    With <i>&lt;n&gt;</i> as any mpls label number 1..10. Filters exactly
      specified label&lt;n&gt;.
    <div>&#x00A0;</div>
     <b>mpls eos [comp] &lt;num&gt;</b>
    <div>&#x00A0;</div>
    <div>&#x00A0;</div>
    Filters End of Stack label for a given value <i>&lt;num&gt;</i>.
    <div>&#x00A0;</div>
     <b>mpls exp&lt;n&gt; [comp] &lt;bits&gt;</b>
    <div>&#x00A0;</div>
    Filters experimental bits of label <i>&lt;n&gt;</i> with <i>&lt;bits&gt;</i>
      0..7.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>Packets</i></dt>
  <dd class="It-tag"><b>packets [comp] &lt;num&gt; [scale]</b>
    <div>&#x00A0;</div>
    To filter for netflow records with a specific packet count.
    <div>&#x00A0;</div>
    Example: <b>packets &gt; 1k</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>Bytes</i></dt>
  <dd class="It-tag"><b>bytes [comp] &lt;num&gt; [scale]</b>
    <div>&#x00A0;</div>
    To filter for netflow records with a specific byte count.
    <div>&#x00A0;</div>
    Example: <b>bytes 46</b> filters all empty IPv4 packets</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>Aggregated flows</i></dt>
  <dd class="It-tag"><b>flows [comp] &lt;num&gt; [scale]</b>
    <div>&#x00A0;</div>
    To filter for netflow records with a specific number of aggregated
    flows.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>Type of Service (TOS)</i></dt>
  <dd class="It-tag"><i>[SourceDestination]</i> <b>tos &lt;num&gt;</b>
    <div>&#x00A0;</div>
    With <i>&lt;num&gt;</i> 0..255. For compatibility with nfump 1.5.x: <b>tos
      &lt;num&gt;</b> is equivalent with <b>src tos &lt;num&gt;</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>Packets per second: Calculated value.</i></dt>
  <dd class="It-tag"><b>pps</b> <i>[comp]</i> <i>num</i> <i>[scale]</i>
    <div>&#x00A0;</div>
    To filter for flows with specific packets per second.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>Duration: Calculated value</i></dt>
  <dd class="It-tag"><b>duration</b> <i>[comp]</i> <i>num</i>
    <div>&#x00A0;</div>
    To filter for flows with specific duration in miliseconds.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>Bits per second: Calculated value.</i></dt>
  <dd class="It-tag"><b>bps</b> <i>[comp]</i> <i>num</i> <i>[scale]</i>
    <div>&#x00A0;</div>
    To filter for flows with specific bytes per second.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>Bytes per packet: Calculated value.</i></dt>
  <dd class="It-tag"><b>bpp</b> <i>[comp]</i> <i>num</i> <i>[scale]</i>
    <div>&#x00A0;</div>
    To filter for flows with specific bytes per packet.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>scale</i> scaling factor. Maybe <i>k</i> <i>m</i>
    <i>g</i>. Factor is 1000</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>comp</i> The following comparators are supported:</dt>
  <dd class="It-tag"><b>=, ==, &gt;, &lt;, EQ, LT, GT .</b> If <i>comp</i> is
      omitted, '=' is assumed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>NSEL/ASA specific filters:</b></dt>
  <dd class="It-tag"></dd>
</dl>
<div class="Pp"></div>
<i>NSEL/ASA Event</i>
<div style="margin-left: 4.00ex;"><b>asa event
  &lt;ignore|create|term|delete|deny&gt;</b>
<div>&#x00A0;</div>
<b>asa event [comp] &lt;number&gt;</b>
<div>&#x00A0;</div>
select NSEL/ASA event by name or number. If given as number it can be compared
  with a number
<div>&#x00A0;</div>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><i>NSEL/ASA denied reason</i></dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 4.00ex;"><b>asa event denied
  &lt;ingress|egress|interface|nosyn&gt;</b>
<div>&#x00A0;</div>
Select a NSEL/ASA denied event by type</div>
<dl class="Bl-tag">
  <dt class="It-tag"><i>NSEL/ASA extended events</i></dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 4.00ex;"><b>asa xevent [comp] &lt;num&gt;</b>
<div>&#x00A0;</div>
Select an extended NSELL ASA event by number, or optionally compared by a
  number.</div>
<dl class="Bl-tag">
  <dt class="It-tag"><i>X-late IP addresses and ports</i></dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 4.00ex;"><b>[src|dst] xip &lt;ip&gt;</b>
<div>&#x00A0;</div>
Select the translated IP address
<div class="Pp"></div>
<b>[src|dst] xnet &lt;net&gt;/&lt;num&gt;</b>
<div>&#x00A0;</div>
with <i>&lt;net&gt;</i> as a valid translated IPv4 or IPv6 network and
  <i>&lt;num&gt;</i> as maskbits. The number of mask bits must match the
  appropriate address familiy in IPv4 or IPv6. Networks may be abreviated such
  as 172.16/16 if they are unambiguous.
<div class="Pp"></div>
<b>[src|dst] xport &lt;port&gt;</b>
<div>&#x00A0;</div>
Select the translated port</div>
<dl class="Bl-tag">
  <dt class="It-tag"><i>NSEL/ASA ingress/egress</i></dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 4.00ex;"><b>ingress &lt;ACL|ACE|XACE&gt; [comp]
  number</b>
<div>&#x00A0;</div>
Select/compare an ingress ACL
<div class="Pp"></div>
<b>egress ACL [comp] &lt;number&gt;</b>
<div>&#x00A0;</div>
Select/compare an egress ACL</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>NEL specific NAT filters:</b></dt>
  <dd class="It-tag"></dd>
</dl>
<div class="Pp"></div>
<i>NAT Event</i>
<div style="margin-left: 4.00ex;"><b>nat event &lt;add|delete&gt;</b>
<div>&#x00A0;</div>
<b>nat event [comp] &lt;number&gt;</b>
<div>&#x00A0;</div>
select NEL NAT event by name or number. If given as number it can be compared
  with a number
<div>&#x00A0;</div>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><i>NEL NAT ip addresses and ports</i></dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 4.00ex;"><b>[src|dst] nip &lt;ip&gt;</b>
<div>&#x00A0;</div>
Select the NAT IP address
<div class="Pp"></div>
<b>[src|dst] nport &lt;port&gt;</b>
<div>&#x00A0;</div>
Select the NAT port</div>
<dl class="Bl-tag">
  <dt class="It-tag"><i>NEL NAT vrf</i></dt>
  <dd class="It-tag"><b>ingress vrf &lt;num&gt;</b> Select the vrf</dd>
</dl>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<b>nfdump -r /and/dir/nfcapd.201107110845 -c 100 'proto tcp and ( src ip
  172.16.17.18 or dst ip 172.16.17.19 )'</b> Dumps the first 100 netflow records
  which match the given filter:
<div class="Pp"></div>
<b>nfdump -r /and/dir/nfcapd.201107110845 -B</b> Map matching flows as
  bin-directional single flow.
<div class="Pp"></div>
<b>nfdump -R /and/dir/nfcapd.201107110845:nfcapd.200407110945 'host
  192.168.1.2'</b> Dumps all netflow records of host 192.168.1.2 from July 11
  08:45 - 09:45
<div class="Pp"></div>
<b>nfdump -M /to/and/dir1:dir2 -R nfcapd.200407110845:nfcapd.200407110945 -s
  record -n 20</b> Generates the Top 20 statistics from 08:45 to 09:45 from 3
  sources
<div class="Pp"></div>
<b>nfdump -r /and/dir/nfcapd.201107110845 -s record -n 20 -o extended</b>
  Generates the Top 20 statistics, extended output format
<div class="Pp"></div>
<b>nfdump -r /and/dir/nfcapd.201107110845 -s record -n 20 'in if 5 and bps &gt;
  10k'</b> Generates the Top 20 statistics from flows comming from interface 5
<div class="Pp"></div>
<b>nfdump -r /and/dir/nfcapd.201107110845 'inet6 and proto tcp and ( src port
  &gt; 1024 and dst port 80 )</b> Dumps all port 80 IPv6 connections to any web
  server.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
Generating the statistics for data files of a few hundred MB is no problem.
  However be careful if you want to create statistics of several GB of data.
  This may consume a lot of memory and can take a while. Flow anonymization has
  moved into nfanon.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
nfcapd(1), nfanon(1), nfprofile(1), nfreplay(1)
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
There is still the famous last bug. Please report them - all the last bugs -
  back to me.
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2009-09-09</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
