<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 15:58:10 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>chaosreader(1) trace network sessions and export it to
html format chaosreader(1)</p>

<p style="margin-top: 1em">NAME <br>
chaosreader - trace network sessions and export it to html
format</p>

<p style="margin-top: 1em">SYNOPSIS <br>
chaosreader</p>

<p style="margin-top: 1em">chaosreader
[-adehiknqrvxAHIRTUXY] [-D dir] <br>
[-b port[,...]] [-B port[,...]] <br>
[-j IPaddr[,...]] [-J IPaddr[,...]] <br>
[-l port[,...]] [-L port[,...]] [-m bytes[k]] <br>
[-M bytes[k]] [-o
&quot;time&quot;|&quot;size&quot;|&quot;type&quot;|&quot;ip&quot;]
<br>
[-p port[,...]] [-P port[,...]] <br>
infile [infile2 ...]</p>

<p style="margin-top: 1em">chaosreader -s [mins] | -S
[mins[,count]] <br>
[-z] [-f &rsquo;filter&rsquo;]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Chaosreader traces TCP/UDP/others sessions and fetches
application data from snoop or tcpdump logs. This is a type
of &quot;any-snarf&quot; program, as it will fetch telnet
sessions, FTP <br>
files, HTTP transfers (HTML, GIF, JPEG etc) and SMTP emails
from the captured data inside network traffic logs. A html
index file is created to that links to all the session <br>
details, including realtime replay programs for telnet,
rlogin, IRC, X11 and VNC sessions. Chaosreader reports such
as image reports and HTTP GET/POST content reports.</p>

<p style="margin-top: 1em">It also creates replay programs
for telnet sessions, so that you can play them back in
realtime (or even different speeds).</p>

<p style="margin-top: 1em">Chaosreader can also run in
standalone mode, where it invokes tcpdump or snoop (a
similar to tcpdump program for Solaris) to create the log
files and then processes them.</p>

<p style="margin-top: 1em">OPTIONS <br>
-a, --application <br>
Create application session files (default).</p>

<p style="margin-top: 1em">-d, --preferdns <br>
Show DNS names instead of IP addresses.</p>

<p style="margin-top: 1em">-e, --everything <br>
Create HTML 2-way &amp; hex files for everything.</p>

<p style="margin-top: 1em">-h Print a brief help.</p>

<p style="margin-top: 1em">--help Print verbose help (this)
and version.</p>

<p style="margin-top: 1em">--help2 <br>
Print massive help.</p>

<p style="margin-top: 1em">-i, --info <br>
Create info file.</p>

<p style="margin-top: 1em">-q, --quiet <br>
Quiet, no output to screen.</p>

<p style="margin-top: 1em">-r, --raw <br>
Create raw files.</p>

<p style="margin-top: 1em">-v, --verbose <br>
Verbose.</p>

<p style="margin-top: 1em">-x, --index <br>
Create index files (default).</p>

<p style="margin-top: 1em">-A, --noapplication <br>
Exclude application session files.</p>

<p style="margin-top: 1em">-H, --hex <br>
Include hex dumps (slow).</p>

<p style="margin-top: 1em">-I, --noinfo <br>
Exclude info files.</p>

<p style="margin-top: 1em">-R, --noraw <br>
Exclude raw files.</p>

<p style="margin-top: 1em">-T, --notcp <br>
Exclude TCP traffic.</p>

<p style="margin-top: 1em">-U, --noudp <br>
Exclude UDP traffic.</p>

<p style="margin-top: 1em">-Y, --noicmp <br>
Exclude ICMP traffic.</p>

<p style="margin-top: 1em">-X, --noindex <br>
Exclude index files.</p>

<p style="margin-top: 1em">-k, --keydata <br>
Create extra files for keystroke analysis.</p>

<p style="margin-top: 1em">-n, --names <br>
Include hostnames in hyperlinked HTTPlog (HTML)</p>

<p style="margin-top: 1em">-D dir, --dir dir <br>
Output all files to this directory.</p>

<p style="margin-top: 1em">-b 25,79, --playtcp 25,79 <br>
Replay these TCP ports as well (playback).</p>

<p style="margin-top: 1em">-B 36,42, --playudp 36,42 <br>
Replay these UDP ports as well (playback).</p>

<p style="margin-top: 1em">-l 7,79, --htmltcp 7,79 <br>
Create HTML for these TCP ports as well.</p>

<p style="margin-top: 1em">-L 7,123, --htmludp 7,123 <br>
Create HTML for these UDP ports as well.</p>

<p style="margin-top: 1em">-m 1k, --min 1k <br>
Min size of connection to save (&quot;k&quot; for Kb).</p>

<p style="margin-top: 1em">-M 1024k, --max 1k <br>
Max size of connection to save (&quot;k&quot; for Kb)</p>

<p style="margin-top: 1em">-o size, --sort size <br>
Sort Order: time/size/type/ip (Default time).</p>

<p style="margin-top: 1em">-p 21,23, --port 21,23 <br>
Only examine these ports (TCP &amp; UDP).</p>

<p style="margin-top: 1em">-P 80,81, --noport 80,81 <br>
Exclude these ports (TCP &amp; UDP).</p>

<p style="margin-top: 1em">-s 5, --runonce 5 <br>
Standalone. Run tcpdump/snoop for 5 mins.</p>

<p style="margin-top: 1em">-S 5,10, --runmany 5,10 <br>
Standalone, many. 10 samples of 5 mins each.</p>

<p style="margin-top: 1em">-S 5, --runmany 5 <br>
Standalone, endless. 5 min samples forever.</p>

<p style="margin-top: 1em">-z, --runredo <br>
Standalone, redo. Rereads last run&rsquo;s logs.</p>

<p style="margin-top: 1em">-j 10.1.2.1, --ipaddr 10.1.2.1
<br>
Only examine these IPs.</p>

<p style="margin-top: 1em">-J 10.1.2.1, --noipaddr 10.1.2.1
<br>
Exclude these IPs.</p>

<p style="margin-top: 1em">-f &rsquo;port 7&rsquo;,
--filter &rsquo;port 7&rsquo; <br>
With standalone, use this dump filter.</p>

<p style="margin-top: 1em">OUTPUT FILES <br>
Many files will be created, run this in a clean directory.
Short example:</p>

<p style="margin-top: 1em">index.html <br>
Html index (full details).</p>

<p style="margin-top: 1em">index.text <br>
Text index.</p>

<p style="margin-top: 1em">index.file <br>
File index for standalone redo mode.</p>

<p style="margin-top: 1em">image.html <br>
HTML report of images.</p>

<p style="margin-top: 1em">getpost.html <br>
HTML report of HTTP GET/POST requests.</p>

<p style="margin-top: 1em">session_0001.info <br>
Info file describing TCP session #1.</p>

<p style="margin-top: 1em">session_0001.telnet.html <br>
HTML colored 2-way capture (time sorted).</p>

<p style="margin-top: 1em">session_0001.telnet.raw <br>
Raw data 2-way capture (time sorted).</p>

<p style="margin-top: 1em">session_0001.telnet.raw1 <br>
Raw 1-way capture (assembled) server-&gt;client.</p>

<p style="margin-top: 1em">session_0001.telnet.raw2 <br>
Raw 1-way capture (assembled) client-&gt;server.</p>

<p style="margin-top: 1em">session_0002.web.html <br>
HTML colored 2-way.</p>

<p style="margin-top: 1em">session_0002.part_01.html <br>
HTTP portion of the above, a HTML file.</p>

<p style="margin-top: 1em">session_0003.web.html <br>
HTML colored 2-way.</p>

<p style="margin-top: 1em">session_0003.part_01.jpeg <br>
HTTP portion of the above, a JPEG file.</p>

<p style="margin-top: 1em">session_0004.web.html <br>
HTML colored 2-way.</p>

<p style="margin-top: 1em">session_0004.part_01.gif <br>
HTTP portion of the above, a GIF file.</p>


<p style="margin-top: 1em">session_0005.part_01.ftp-data.gz
<br>
An FTP transfer, a gz file.</p>

<p style="margin-top: 1em">CONVENTIONS <br>
session_* <br>
TCP Sessions.</p>

<p style="margin-top: 1em">stream_* <br>
UDP Streams.</p>

<p style="margin-top: 1em">icmp_* ICMP packets.</p>

<p style="margin-top: 1em">index.html <br>
HTML Index.</p>

<p style="margin-top: 1em">index.text <br>
Text Index.</p>

<p style="margin-top: 1em">index.file <br>
File Index for standalone redo mode only.</p>

<p style="margin-top: 1em">image.html <br>
HTML report of images.</p>

<p style="margin-top: 1em">getpost.html <br>
HTML report of HTTP GET/POST requests.</p>

<p style="margin-top: 1em">*.info Info file describing the
Session/Stream.</p>

<p style="margin-top: 1em">*.raw Raw data 2-way capture
(time sorted).</p>

<p style="margin-top: 1em">*.raw1 Raw 1-way capture
(assembled) server-&gt;client.</p>

<p style="margin-top: 1em">*.raw2 Raw 1-way capture
(assembled) client-&gt;server.</p>

<p style="margin-top: 1em">*.replay <br>
Session replay program (perl).</p>

<p style="margin-top: 1em">*.partial.* <br>
Partial capture (tcpdump/snoop were aware of drops).</p>

<p style="margin-top: 1em">*.hex.html <br>
2-way Hex dump, rendered in colored HTML.</p>

<p style="margin-top: 1em">*.hex.text <br>
2-way Hex dump in plain text.</p>

<p style="margin-top: 1em">*.X11.replay <br>
X11 replay script (talks X11).</p>

<p style="margin-top: 1em">*.textX11.replay <br>
X11 communicated text replay script (text only).</p>

<p style="margin-top: 1em">*.textX11.html <br>
2-way text report, rendered in red/blue HTML.</p>

<p style="margin-top: 1em">*.keydata <br>
Keystroke delay data file. Used for SSH analysis.</p>

<p style="margin-top: 1em">MODES <br>
Normal eg &quot;chaosreader infile&quot;, this is where a
tcpdump/snoop file was created previously and chaosreader
reads and processes it.</p>

<p style="margin-top: 1em">Standalone once <br>
eg &quot;chaosreader -s 10&quot; this is where chaosreader
runs tcpdump/snoop and generates the log file, in this case
for 10 minutes, and then processes the result. Some
OS&rsquo;s may <br>
not have tcpdump or snoop available so this will not work
(instead you may be able to get Ethereal, run it, save to a
file, then use normal mode). There is a master <br>
index.html and the report index.html in a sub dir, which is
of the format out_YYYYMMDD-hhmm, eg
&quot;out_20031003-2221&quot;.</p>

<p style="margin-top: 1em">Standalone, many <br>
eg &quot;chaosreader -S 5,12&quot;, this is where
chaosreader runs tcpdump/snoop and generates many log files,
in this case it samples 12 times for 5 minutes each. While
this is <br>
running, the master index.html can be viewed to watch
progress, which links to minor index.html reports in each
sub directory.</p>

<p style="margin-top: 1em">Standalone, redo <br>
eg &quot;chaosreader -ve -z&quot;, (the -z), this is where a
standalone capture was previously performed - and now you
would like to reprocess the logs - perhaps with different
<br>
options (in this case, &quot;-ve&quot;). It reads index.file
to determine which capture logs to read.</p>

<p style="margin-top: 1em">Standalone, endless <br>
eg &quot;chaosreader -S 5&quot;, like standalone many - but
runs forever (if you ever had the need?). Watch your disk
space!</p>

<p style="margin-top: 1em">Note: this is a work in
progress, some of the code is a little unpolished.</p>

<p style="margin-top: 1em">NOTES <br>
&Acirc;&middot; Run chaosreader in an empty directory.</p>

<p style="margin-top: 1em">&Acirc;&middot; Create small
packet dumps. Chaosreader uses around 5x the dump size in
memory. A 100Mb file could need 500Mb of RAM to process.</p>

<p style="margin-top: 1em">&Acirc;&middot; Your tcpdump may
allow &quot;-s0&quot; (entire packet) instead of
&quot;-s9000&quot;.</p>

<p style="margin-top: 1em">&Acirc;&middot; Beware of using
too much disk space, especially standalone mode.</p>

<p style="margin-top: 1em">&Acirc;&middot; If you capture
too many small connections giving a huge index.html, try
using the -m option to ignore small connections. eg &quot;-m
1k&quot;.</p>

<p style="margin-top: 1em">&Acirc;&middot; snoop logs may
actually work better. Snoop logs are based on RFC1761,
however there are many variants of tcpdump/libpcap and this
program cannot read them all. If you have <br>
Ethereal you can create snoop logs during the &quot;save
as&quot; option. On Solaris use &quot;snoop -o
logfile&quot;.</p>

<p style="margin-top: 1em">&Acirc;&middot; tcpdump logs may
not be portable between OSs that use different sized
timestamps or endian.</p>

<p style="margin-top: 1em">&Acirc;&middot; Logs are best
created in a memory filesystem for speed, usually /tmp.</p>

<p style="margin-top: 1em">&Acirc;&middot; For X11 or VNC
playbacks, first practise by replaying a recent captured
session of your own. The biggest problem is color depth,
your screen must match the capture. For X11 <br>
check authentication (xhost +), for VNC check the viewers
options (-8bit, &quot;Hextile&quot;, ...)</p>

<p style="margin-top: 1em">&Acirc;&middot; SSH analysis can
be performed with the &quot;sshkeydata&quot; program as
demonstrated on http://www.brendangregg.com/sshanalysis.html
. chaosreader provides the input files (*.keydata) <br>
that sshkeydata analyses.</p>

<p style="margin-top: 1em">BUGS <br>
The following assumptions may cause problems (check for new
vers):</p>

<p style="margin-top: 1em">&Acirc;&middot; A lower port
number = the service type. Eg with ports 31247 and 23, the
actual type of session is telnet (23). This may not work for
some things (eg, VNC).</p>

<p style="margin-top: 1em">&Acirc;&middot; Time based order
is more important for 2-way sessions (eg telnet), SEQ order
is more import for 1-way transfers (eg ftp-data).</p>

<p style="margin-top: 1em">&Acirc;&middot; One particular
TCP session isn&rsquo;t active for long enough that the SEQ
number loops (or even wraps).</p>

<p style="margin-top: 1em">EXAMPLES <br>
&Acirc;&middot; Example 1:</p>

<p style="margin-top: 1em">tcpdump -s9000 -w output1 #
create tcpdump capture file</p>

<p style="margin-top: 1em">chaosreader output1 # extract
recognised sessions, or,</p>

<p style="margin-top: 1em">chaosreader -ve output1 # gimme
everything, or,</p>

<p style="margin-top: 1em">chaosreader -p 20,21,23 output1
# only ftp and telnet...</p>

<p style="margin-top: 1em">&Acirc;&middot; Example 2:</p>

<p style="margin-top: 1em">snoop -o output1 # create snoop
capture file instead</p>

<p style="margin-top: 1em">chaosreader output1 # extract
recognised sessions...</p>

<p style="margin-top: 1em">&Acirc;&middot; Example 3:</p>

<p style="margin-top: 1em">chaosreader -S 2,5 # Standalone,
sniff network 5 times for 2 mins <br>
each. View index.html for progress (or .text)</p>

<p style="margin-top: 1em">SEE ALSO <br>
tcpdump(8), snoop(1M), chaosreader help page.</p>

<p style="margin-top: 1em">AUTHORS <br>
chaosreader was written by Brendan Gregg.</p>

<p style="margin-top: 1em">This manual page was written by
Joao Eriberto Mota Filho &lt;eriberto@debian.org&gt; for the
Debian project (but may be used by others).</p>

<p style="margin-top: 1em">chaosreader-0.96 18 Nov 2016
chaosreader(1)</p>
<hr>
</body>
</html>
