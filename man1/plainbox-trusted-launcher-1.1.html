<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>PLAINBOX-TRUSTED-LAUNCHER-1(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">PLAINBOX-TRUSTED-LAUNCHER-1(1)</td>
    <td class="head-vol">Plainbox</td>
    <td class="head-rtitle">PLAINBOX-TRUSTED-LAUNCHER-1(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
plainbox-trusted-launcher-1 - execute job command as another user
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
plainbox-trusted-launcher-1 [-h] (-w | -t CHECKSUM)
                            [-T NAME=VALUE [NAME=VALUE ...]] [-g CHECKSUM]
                            [-G NAME=VALUE [NAME=VALUE ...]]
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
Security elevation mechanism for plainbox
<div style="height: 1.00em;">&#x00A0;</div>
This command is a part of the implementation of <b>plainbox</b>. It is not
  intended to be invoked directly and the command line arguments and behavior
  may freely change between versions.
<div style="height: 1.00em;">&#x00A0;</div>
Technically this program is used to run a command associated with a job
  definition as another user (typically as root). The existing technologies such
  as <b>sudo</b> (8) and <b>pkexec</b> (1) don't have enough granularity to
  still restrict arbitrary commands but allow the commands that are inside
  system-wide installed locations (thus safe as one needs root access to install
  those in the first place). One additional restriction is that some commands
  are themselves generated by other jobs.
<h2 class="Ss" title="Ss" id="Execution"><a class="selflink" href="#Execution">Execution</a></h2>
<h2 class="Ss" title="Ss" id="Warm-up_Mode"><a class="selflink" href="#Warm-up_Mode">Warm-up
  Mode</a></h2>
If the <b>--warmup</b> option is specified then nothing more happens and the
  program exists immediately. This is intended to 'warm-up' the tool that
  executes <b>plainbox-trusted-launcher-1</b> itself (typically <b>pkexec</b> or
  <b>sudo</b>)
<h2 class="Ss" title="Ss" id="Normal_Execution"><a class="selflink" href="#Normal_Execution">Normal
  Execution</a></h2>
In normal execution mode, the launcher looks up the job with the checksum
  specified by <b>--target</b> and executes the command embedded inside.
  Environment passed via <b>--target-environment</b> is appended to the
  environment variables inherited from the parent process.
<div style="height: 1.00em;">&#x00A0;</div>
Standard output, standard error and exit code of
  <b>plainbox-trusted-launcher-1</b> is exactly as the values from the commands
  embedded into the selected job itself.
<h2 class="Ss" title="Ss" id="Indirect_Execution"><a class="selflink" href="#Indirect_Execution">Indirect
  Execution</a></h2>
In indirect execution mode, the launcher first looks up the job with the
  checksum specified by <b>--generator</b>, executes it, discarding stderr and
  re-interpreting stdout as a set of job definitions. Environment passed via the
  <b>--generator-environment</b> is appended (but just to the generator job, the
  <b>--target</b> job has independent environment). All of the additional job
  definitions are added to the global pool of jobs the launcher knows about.
<div style="height: 1.00em;">&#x00A0;</div>
After that the launcher continues as with normal execution, returning the same
  stdout, stderr and exit code.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<b>Optional arguments:</b>
<div class="Pp"></div>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-w<b>,</b><b> --warmup</b></b></dt>
  <dd class="It-tag">return immediately, only useful when used with
    pkexec(1)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-t<b>,</b><b> --target</b></b></dt>
  <dd class="It-tag">run a job with this checksum</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-T<b>,</b><b> --target-environment</b></b></dt>
  <dd class="It-tag">environment passed to the target job</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-g<b>,</b><b> --generator</b></b></dt>
  <dd class="It-tag">also run a job with this checksum (assuming it is a local
      job)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-G<b>,</b><b> --generator-environment</b></b></dt>
  <dd class="It-tag">environment passed to the generator job</dd>
</dl>
</div>
<br/>
<h1 class="Sh" title="Sh" id="ENVIRONMENT_VARIABLES"><a class="selflink" href="#ENVIRONMENT_VARIABLES">ENVIRONMENT
  VARIABLES</a></h1>
The following environment variables <i>DO NOT</i> affect
  <b>plainbox-trusted-launcher-1</b>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>PROVIDERPATH</b></b></dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 7.00ex;">
<div style="margin-left: 3.50ex;">For <b>plainbox</b> this would affect the set
  of directories where Plainbox looks for provider definitions. The trusted
  launcher has a fixed list of directories that cannot be extended.
<div style="height: 1.00em;">&#x00A0;</div>
The fixed list is composed of two system-wide locations:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>/usr/local/share/plainbox-providers-1</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>/usr/share/plainbox-providers-1</b></dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
All the other environment variables mentioned in <b>plainbox</b> work the same
  way.</div>
<br/>
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Currently it is impossible to use <b>plainbox-trusted-launcher-1</b> with a
  <b>local</b> job needs to run as root, that generates another <b>local</b> job
  that needs to run as root, to generate any additional jobs that also need to
  run as root. In other words, only one-level job generation is supported.
<div style="height: 1.00em;">&#x00A0;</div>
The launcher is somewhat inefficient, in that it has to re-run all of the
  dependencies of the <b>local</b> job over and over. Ideally those would be
  cached, per-session, but that would significantly increase the complexity of
  the code running as root.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>plainbox</b>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Zygmunt Krynicki &amp; Checkbox Contributors
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
2012-2014 Canonical Ltd</div>
<table class="foot">
  <tr>
    <td class="foot-date">January 5, 2016</td>
    <td class="foot-os">0.25</td>
  </tr>
</table>
</body>
</html>
