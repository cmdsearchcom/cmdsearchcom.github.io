<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:25:54 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>MOGADM(1) User Contributed Perl Documentation
MOGADM(1)</p>

<p style="margin-top: 1em">NAME <br>
mogadm - MogileFS admin tool</p>

<p style="margin-top: 1em">SYNOPSIS <br>
$ mogadm [config options] &lt;argument(s)&gt; [argument
options]</p>

<p style="margin-top: 1em">$ mogadm <br>
.... <br>
(prints contextual help, if missing command/arguments) <br>
...</p>

<p style="margin-top: 1em">OPTIONS <br>
--lib=/path/to/lib <br>
Set this option to a path to include this directory in the
module search path.</p>


<p style="margin-top: 1em">--trackers=10.0.0.117:7001,10.0.0.118:7001,...
<br>
Use these MogileFS trackers for status information.</p>

<p style="margin-top: 1em">ARGUMENTS <br>
check Check to ensure that all of the MogileFS system
components are functioning and that we can contact
everybody. The quickest way of ensuring that the entire
MogileFS <br>
system is functional from the current machine&rsquo;s point
of view.</p>

<p style="margin-top: 1em">host add &lt;host&gt; [host
options] <br>
host modify &lt;host&gt; [host options] <br>
host mark &lt;host&gt; &lt;status&gt; <br>
host delete &lt;host&gt; <br>
host list <br>
Functions for manipulating hosts. For add and modify, host
options is in the format of normal command line options and
can include anything in the &quot;HOST OPTIONS&quot; <br>
section.</p>

<p style="margin-top: 1em">device add &lt;host&gt;
&lt;device id&gt; <br>
device mark &lt;host&gt; &lt;device id&gt; &lt;status&gt;
<br>
device modify &lt;host&gt; &lt;device&gt; [device options]
<br>
device delete &lt;host&gt; &lt;device&gt; <br>
device list <br>
device next <br>
Functions for manipulating devices. For add and modify,
device options are in the format of normal command line
options and can include anything in the &quot;DEVICE
OPTIONS&quot; <br>
section.</p>

<p style="margin-top: 1em">domain add &lt;domain&gt; <br>
domain delete &lt;domain&gt; <br>
domain list <br>
Simple commands for managing MogileFS domains. Note that you
cannot delete a domain unless it has no classes and is
devoid of files.</p>

<p style="margin-top: 1em">class add &lt;domain&gt;
&lt;class&gt; [class options] <br>
class modify &lt;domain&gt; &lt;class&gt; [class options]
<br>
class delete &lt;domain&gt; &lt;class&gt; <br>
class list <br>
Commands for working with classes. Please see the
&quot;CLASS OPTIONS&quot; section for the options to use
with add/modify. Also, delete requires that the class have
no files in <br>
it before it will allow the deletion.</p>

<p style="margin-top: 1em">slave ... <br>
Add/remove slaves replicating from MogileFS master
database.</p>

<p style="margin-top: 1em">TODO: detail this</p>

<p style="margin-top: 1em">Run mogadm slave by itself for
contextual help.</p>

<p style="margin-top: 1em">fsck printlog <br>
fsck taillog <br>
fsck clearlog <br>
Display or clear the log of fsck events.</p>

<p style="margin-top: 1em">fsck reset [fsck options] <br>
Reset fsck position back to the beginning. Please see the
&quot;FSCK OPTIONS&quot; section for options to use with
fsck.</p>

<p style="margin-top: 1em">fsck start <br>
Start (or resume) background fsck from the last checked fid.
If you want to check every fid, you must call fsck reset
before calling start.</p>

<p style="margin-top: 1em">fsck status <br>
Show the status of the presently active (or last if none
active) fsck. This includes what FIDs are being checked,
time statistics, check type as well as a summary of <br>
problems encountered so far.</p>

<p style="margin-top: 1em">fsck stop <br>
Stop (pause) background fsck</p>

<p style="margin-top: 1em">settings list <br>
Display all present MogileFS settings.</p>

<p style="margin-top: 1em">settings set &lt;key&gt;
&lt;value&gt; <br>
Set the server setting for &rsquo;key&rsquo; to
&rsquo;value&rsquo;.</p>

<p style="margin-top: 1em">The current settings are
&lt;enable_rebalance&gt; (set to 1 to start rebalance mode
to move files to under-used devices) and
&lt;memcache_servers&gt; (enable memcached caching in the
<br>
tracker).</p>

<p style="margin-top: 1em">HOST OPTIONS <br>
--ip=&lt;ip of host&gt; <br>
--port=&lt;port of mogstored on host&gt; <br>
Contact information for the host. This is the minimum set of
information needed to setup a host.</p>

<p style="margin-top: 1em">--getport=&lt;alternate
retrieval part on host&gt; <br>
If provided, causes the tracker to use this port for
retrieving files. Uploads are still processed at the
standard port.</p>

<p style="margin-top: 1em">--altip=&lt;alternate IP&gt;
<br>
--altmask=&lt;mask to activate alternate IP&gt; <br>
If a client request comes in from an IP that matches the
alternate mask, then the host IP is treated as the alternate
IP instead of the standard IP. This can be used, <br>
for example, if you have two networks and you need to return
one IP to reach the node on one network, but a second IP to
reach it on the alternate network.</p>

<p style="margin-top: 1em">--status=&lt;host status&gt;
<br>
Valid host statuses are one of: alive, down, dead.</p>

<p style="margin-top: 1em">DEVICE OPTIONS <br>
--status=&lt;device status&gt; <br>
Valid device statuses are one of: alive, dead, down, drain,
readonly.</p>

<p style="margin-top: 1em">--weight=&lt;device
weight&lt;gt&gt; <br>
The weight used in calculation of preferred paths. It must
be a positive integer.</p>

<p style="margin-top: 1em">CLASS OPTIONS <br>
--mindevcount=&lt;value&gt; <br>
Number of devices the files in this class should be
replicated across. Can be set to anything &gt;= 1.</p>

<p style="margin-top: 1em">--replpolicy=&lt;value&gt; <br>
Stringified replication policy. ie
&quot;MultipleHosts(3)&quot; is equivalent to a
--mindevcount=3. See documentation or plugins on alternative
policies.</p>

<p style="margin-top: 1em">--hashtype=&lt;value&gt; <br>
Name of the hash algorithm used for checksumming.
&quot;MD5&quot; or &quot;NONE&quot; for no checksumming.</p>

<p style="margin-top: 1em">FSCK OPTIONS <br>
--policy-only <br>
Check replication policy (assumed locations) only;
don&rsquo;t stat storage nodes for actual file presence.</p>

<p style="margin-top: 1em">EXAMPLES <br>
Host manipulation:</p>

<p style="margin-top: 1em">$ mogadm host list <br>
$ mogadm host add foo.local <br>
$ mogadm host add foo.local --status=down --ip=10.0.0.34
--port=7900 <br>
$ mogadm host mark foo.local down <br>
$ mogadm host modify foo.local --port=7500 <br>
$ mogadm host delete foo.local</p>

<p style="margin-top: 1em">Device manipulation:</p>

<p style="margin-top: 1em">$ mogadm device list <br>
$ mogadm device summary <br>
$ mogadm device summary --status=dead,down <br>
$ mogadm device next <br>
$ mogadm device add foo.local 16 <br>
$ mogadm device add foo.local 17 --status=alive <br>
$ mogadm device mark foo.local 17 down <br>
$ mogadm device modify foo.local 17 --status=alive
--weight=10 <br>
$ mogadm device delete foo.local 17</p>

<p style="margin-top: 1em">Domain manipulation:</p>

<p style="margin-top: 1em">$ mogadm domain list <br>
$ mogadm domain add first.domain <br>
$ mogadm domain delete first.domain</p>

<p style="margin-top: 1em">Class manipulation</p>

<p style="margin-top: 1em">$ mogadm class list <br>
$ mogadm class add first.domain my.class <br>
$ mogadm class add first.domain my.class --mindevcount=3
<br>
$ mogadm class add first.domain my.class
--replpolicy=&quot;MultipleHosts(3)&quot; <br>
$ mogadm class modify first.domain my.class --mindevcount=2
<br>
$ mogadm class modify first.domain my.class
--replpolicy=&quot;MultipleHosts(3)&quot; <br>
$ mogadm class delete first.domain my.class</p>

<p style="margin-top: 1em">Check the status of your entire
MogileFS system:</p>

<p style="margin-top: 1em">$ mogadm check</p>

<p style="margin-top: 1em">Check every file in the entire
MogileFS system:</p>

<p style="margin-top: 1em">$ mogadm fsck reset <br>
$ mogadm fsck start <br>
$ mogadm fsck status <br>
$ mogadm fsck printlog</p>

<p style="margin-top: 1em">See all the things mogadm can
do:</p>

<p style="margin-top: 1em">$ mogadm</p>

<p style="margin-top: 1em">Get help on a sub-command:</p>

<p style="margin-top: 1em">$ mogadm device</p>

<p style="margin-top: 1em">CONFIGURATION <br>
It is recommended that you create a configuration file such
as &quot;/etc/mogilefs/mogilefs.conf&quot; (or at
&quot;~/.mogilefs.conf&quot;) to be used for configuration
information. Basically all <br>
you need is something like:</p>

<p style="margin-top: 1em">trackers = 10.0.0.23:7001,
10.0.0.15:7001</p>

<p style="margin-top: 1em"># if MogileFS::Admin files
aren&rsquo;t installed in standard places: <br>
lib = /home/mogilefs/cgi-bin</p>

<p style="margin-top: 1em">Note that these can also be
specified on the command line, as per above.</p>

<p style="margin-top: 1em">AUTHOR <br>
Brad Fitzpatrick &lt;brad@danga.com&gt;</p>

<p style="margin-top: 1em">Mark Smith
&lt;junior@danga.com&gt;</p>

<p style="margin-top: 1em">Leon Brocard
&lt;acme@astray.com&gt;, open sourced permissions from
Foxtons Ltd.</p>

<p style="margin-top: 1em">Robin H. Johnson
&lt;robbat2@orbis-terrarum.net&gt;</p>

<p style="margin-top: 1em">BUGS <br>
Please report any on the MogileFS mailing list:
&lt;http://groups.google.com/group/mogile/&gt;.</p>

<p style="margin-top: 1em">LICENSE <br>
Licensed for use and redistribution under the same terms as
Perl itself.</p>

<p style="margin-top: 1em">perl v5.24.1 2014-12-16
MOGADM(1)</p>
<hr>
</body>
</html>
