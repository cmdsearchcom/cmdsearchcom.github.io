<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>INNOTOP(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">INNOTOP(1)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">INNOTOP(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
innotop - MySQL and InnoDB transaction/status monitor.
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
To monitor servers normally:
<div class="Pp"></div>
<pre>
 innotop
</pre>
<div class="Pp"></div>
To monitor InnoDB status information from a file:
<div class="Pp"></div>
<pre>
 innotop /var/log/mysql/mysqld.err
</pre>
<div class="Pp"></div>
To run innotop non-interactively in a pipe-and-filter configuration:
<div class="Pp"></div>
<pre>
 innotop --count 5 -d 1 -n
</pre>
<div class="Pp"></div>
To monitor a database on another system using a particular username and
  password:
<div class="Pp"></div>
<pre>
 innotop -u &lt;username&gt; -p &lt;password&gt; -h &lt;hostname&gt;
</pre>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
innotop monitors MySQL servers. Each of its modes shows you a different aspect
  of what's happening in the server. For example, there's a mode for monitoring
  replication, one for queries, and one for transactions. innotop refreshes its
  data periodically, so you see an updating view.
<div class="Pp"></div>
innotop has lots of features for power users, but you can start and run it with
  virtually no configuration. If you're just getting started, see
  &quot;QUICK-START&quot;. Press '?' at any time while running innotop for
  context-sensitive help.
<h1 class="Sh" title="Sh" id="QUICK-START"><a class="selflink" href="#QUICK-START">QUICK-START</a></h1>
To start innotop, open a terminal or command prompt. If you have installed
  innotop on your system, you should be able to just type &quot;innotop&quot;
  and press Enter; otherwise, you will need to change to innotop's directory and
  type &quot;perl innotop&quot;.
<div class="Pp"></div>
With no options specified, innotop will attempt to connect to a MySQL server on
  localhost using mysql_read_default_group=client for other connection
  parameters. If you need to specify a different username and password, use the
  -u and -p options, respectively. To monitor a MySQL database on another host,
  use the -h option.
<div class="Pp"></div>
After you've connected, innotop should show you something like the following:
<div class="Pp"></div>
<pre>
 [RO] Query List (? for help) localhost, 01:11:19, 449.44 QPS, 14/7/163 con/run
 
 CXN        When   Load  QPS    Slow  QCacheHit  KCacheHit  BpsIn    BpsOut 
 localhost  Total  0.00  1.07k   697      0.00%     98.17%  476.83k  242.83k
 CXN        Cmd    ID         User  Host      DB   Time   Query
 localhost  Query  766446598  test  10.0.0.1  foo  00:02  INSERT INTO table (
</pre>
<div class="Pp"></div>
(This sample is truncated at the right so it will fit on a terminal when running
  'man innotop')
<div class="Pp"></div>
If your server is busy, you'll see more output. Notice the first line on the
  screen, which tells you that readonly is set to true ([RO]), what mode you're
  in and what server you're connected to. You can change to other modes with
  keystrokes; press 'T' to switch to a list of InnoDB transactions, for example.
<div class="Pp"></div>
Press the '?' key to see what keys are active in the current mode. You can press
  any of these keys and innotop will either take the requested action or prompt
  you for more input. If your system has Term::ReadLine support, you can use TAB
  and other keys to auto-complete and edit input.
<div class="Pp"></div>
To quit innotop, press the 'q' key.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
innotop is mostly configured via its configuration file, but some of the
  configuration options can come from the command line. You can also specify a
  file to monitor for InnoDB status output; see &quot;MONITORING A FILE&quot;
  for more details.
<div class="Pp"></div>
You can negate some options by prefixing the option name with --no. For example,
  --noinc (or --no-inc) negates &quot;--inc&quot;.
<dl class="Bl-tag">
  <dt class="It-tag">--color</dt>
  <dd class="It-tag">Enable or disable terminal coloring. Corresponds to the
      &quot;color&quot; config file setting.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--config</dt>
  <dd class="It-tag">Specifies a configuration file to read. This option is
      non-sticky, that is to say it does not persist to the configuration file
      itself.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--count</dt>
  <dd class="It-tag">Refresh only the specified number of times (ticks) before
      exiting. Each refresh is a pause for &quot;interval&quot; seconds,
      followed by requesting data from MySQL connections and printing it to the
      terminal.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--delay</dt>
  <dd class="It-tag">Specifies the amount of time to pause between ticks
      (refreshes). Corresponds to the configuration option
    &quot;interval&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--help</dt>
  <dd class="It-tag">Print a summary of command-line usage and exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--host</dt>
  <dd class="It-tag">Host to connect to.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--inc</dt>
  <dd class="It-tag">Specifies whether innotop should display absolute numbers
      or relative numbers (offsets from their previous values). Corresponds to
      the configuration option &quot;status_inc&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--mode</dt>
  <dd class="It-tag">Specifies the mode in which innotop should start.
      Corresponds to the configuration option &quot;mode&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--nonint</dt>
  <dd class="It-tag">Enable non-interactive operation. See &quot;NON-INTERACTIVE
      OPERATION&quot; for more.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--password</dt>
  <dd class="It-tag">Password to use for connection.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--port</dt>
  <dd class="It-tag">Port to use for connection.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--skipcentral</dt>
  <dd class="It-tag">Don't read the central configuration file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--user</dt>
  <dd class="It-tag">User to use for connection.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--version</dt>
  <dd class="It-tag">Output version information and exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--write</dt>
  <dd class="It-tag">Sets the configuration option &quot;readonly&quot; to 0,
      making innotop write the running configuration to ~/.innotop/innotop.conf
      on exit, if no configuration file was loaded at start-up.</dd>
</dl>
<h1 class="Sh" title="Sh" id="HOTKEYS"><a class="selflink" href="#HOTKEYS">HOTKEYS</a></h1>
innotop is interactive, and you control it with key-presses.
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Uppercase keys switch between modes.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Lowercase keys initiate some action within the current
      mode.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Other keys do something special like change configuration
      or show the innotop license.</dd>
</dl>
<div class="Pp"></div>
Press '?' at any time to see the currently active keys and what they do.
<h1 class="Sh" title="Sh" id="MODES"><a class="selflink" href="#MODES">MODES</a></h1>
Each of innotop's modes retrieves and displays a particular type of data from
  the servers you're monitoring. You switch between modes with uppercase keys.
  The following is a brief description of each mode, in alphabetical order. To
  switch to the mode, press the key listed in front of its heading in the
  following list:
<dl class="Bl-tag">
  <dt class="It-tag">B: InnoDB Buffers</dt>
  <dd class="It-tag">This mode displays information about the InnoDB buffer
      pool, page statistics, insert buffer, and adaptive hash index. The data
      comes from SHOW INNODB STATUS.
    <div style="height: 1.00em;">&#x00A0;</div>
    This mode contains the &quot;buffer_pool&quot;, &quot;page_statistics&quot;,
      &quot;insert_buffers&quot;, and &quot;adaptive_hash_index&quot; tables by
      default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">C: Command Summary</dt>
  <dd class="It-tag">This mode is similar to mytop's Command Summary mode. It
      shows the &quot;cmd_summary&quot; table, which looks something like the
      following:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
 Command Summary (? for help) localhost, 25+07:16:43, 2.45 QPS, 3 thd, 5.0.40
 _____________________ Command Summary _____________________
 Name                    Value    Pct     Last Incr  Pct    
 Select_scan             3244858  69.89%          2  100.00%
 Select_range            1354177  29.17%          0    0.00%
 Select_full_join          39479   0.85%          0    0.00%
 Select_full_range_join     4097   0.09%          0    0.00%
 Select_range_check            0   0.00%          0    0.00%
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    The command summary table is built by extracting variables from
      &quot;STATUS_VARIABLES&quot;. The variables must be numeric and must match
      the prefix given by the &quot;cmd_filter&quot; configuration variable. The
      variables are then sorted by value descending and compared to the last
      variable, as shown above. The percentage columns are percentage of the
      total of all variables in the table, so you can see the relative weight of
      the variables.
    <div style="height: 1.00em;">&#x00A0;</div>
    The example shows what you see if the prefix is &quot;Select_&quot;. The
      default prefix is &quot;Com_&quot;. You can choose a prefix with the 's'
      key.
    <div style="height: 1.00em;">&#x00A0;</div>
    It's rather like running SHOW VARIABLES LIKE &quot;prefix%&quot; with memory
      and nice formatting.
    <div style="height: 1.00em;">&#x00A0;</div>
    Values are aggregated across all servers. The Pct columns are not correctly
      aggregated across multiple servers. This is a known limitation of the
      grouping algorithm that may be fixed in the future.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">D: InnoDB Deadlocks</dt>
  <dd class="It-tag">This mode shows the transactions involved in the last
      InnoDB deadlock. A second table shows the locks each transaction held and
      waited for. A deadlock is caused by a cycle in the waits-for graph, so
      there should be two locks held and one waited for unless the deadlock
      information is truncated.
    <div style="height: 1.00em;">&#x00A0;</div>
    InnoDB puts deadlock information before some other information in the SHOW
      INNODB STATUS output. If there are a lot of locks, the deadlock
      information can grow very large, and there is a limit on the size of the
      SHOW INNODB STATUS output. A large deadlock can fill the entire output, or
      even be truncated, and prevent you from seeing other information at all.
      If you are running innotop in another mode, for example T mode, and
      suddenly you don't see anything, you might want to check and see if a
      deadlock has wiped out the data you need.
    <div style="height: 1.00em;">&#x00A0;</div>
    If it has, you can create a small deadlock to replace the large one. Use the
      'w' key to 'wipe' the large deadlock with a small one. This will not work
      unless you have defined a deadlock table for the connection (see
      &quot;SERVER CONNECTIONS&quot;).
    <div style="height: 1.00em;">&#x00A0;</div>
    You can also configure innotop to automatically detect when a large deadlock
      needs to be replaced with a small one (see &quot;auto_wipe_dl&quot;).
    <div style="height: 1.00em;">&#x00A0;</div>
    This mode displays the &quot;deadlock_transactions&quot; and
      &quot;deadlock_locks&quot; tables by default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">F: InnoDB Foreign Key Errors</dt>
  <dd class="It-tag">This mode shows the last InnoDB foreign key error
      information, such as the table where it happened, when and who and what
      query caused it, and so on.
    <div style="height: 1.00em;">&#x00A0;</div>
    InnoDB has a huge variety of foreign key error messages, and many of them
      are just hard to parse. innotop doesn't always do the best job here, but
      there's so much code devoted to parsing this messy, unparseable output
      that innotop is likely never to be perfect in this regard. If innotop
      doesn't show you what you need to see, just look at the status text
      directly.
    <div style="height: 1.00em;">&#x00A0;</div>
    This mode displays the &quot;fk_error&quot; table by default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">I: InnoDB I/O Info</dt>
  <dd class="It-tag">This mode shows InnoDB's I/O statistics, including the I/O
      threads, pending I/O, file I/O miscellaneous, and log statistics. It
      displays the &quot;io_threads&quot;, &quot;pending_io&quot;,
      &quot;file_io_misc&quot;, and &quot;log_statistics&quot; tables by
      default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">L: Locks</dt>
  <dd class="It-tag">This mode shows information about current locks. At the
      moment only InnoDB locks are supported, and by default you'll only see
      locks for which transactions are waiting. This information comes from the
      TRANSACTIONS section of the InnoDB status text. If you have a very busy
      server, you may have frequent lock waits; it helps to be able to see which
      tables and indexes are the &quot;hot spot&quot; for locks. If your server
      is running pretty well, this mode should show nothing.
    <div style="height: 1.00em;">&#x00A0;</div>
    You can configure MySQL and innotop to monitor not only locks for which a
      transaction is waiting, but those currently held, too. You can do this
      with the InnoDB Lock Monitor
      (&lt;http://dev.mysql.com/doc/en/innodb-monitor.html&gt;). It's not
      documented in the MySQL manual, but creating the lock monitor with the
      following statement also affects the output of SHOW INNODB STATUS, which
      innotop uses:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  CREATE TABLE innodb_lock_monitor(a int) ENGINE=INNODB;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    This causes InnoDB to print its output to the MySQL file every 16 seconds or
      so, as stated in the manual, but it also makes the normal SHOW INNODB
      STATUS output include lock information, which innotop can parse and
      display (that's the undocumented feature).
    <div style="height: 1.00em;">&#x00A0;</div>
    This means you can do what may have seemed impossible: to a limited extent
      (InnoDB truncates some information in the output), you can see which
      transaction holds the locks something else is waiting for. You can also
      enable and disable the InnoDB Lock Monitor with the key mappings in this
      mode.
    <div style="height: 1.00em;">&#x00A0;</div>
    This mode displays the &quot;innodb_locks&quot; table by default. Here's a
      sample of the screen when one connection is waiting for locks another
      connection holds:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
 _________________________________ InnoDB Locks __________________________
 CXN        ID  Type    Waiting  Wait   Active  Mode  DB    Table  Index
 localhost  12  RECORD        1  00:10   00:10  X     test  t1     PRIMARY
 localhost  12  TABLE         0  00:10   00:10  IX    test  t1
 localhost  12  RECORD        1  00:10   00:10  X     test  t1     PRIMARY
 localhost  11  TABLE         0  00:00   00:25  IX    test  t1
 localhost  11  RECORD        0  00:00   00:25  X     test  t1     PRIMARY
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    You can see the first connection, ID 12, is waiting for a lock on the
      PRIMARY key on test.t1, and has been waiting for 10 seconds. The second
      connection isn't waiting, because the Waiting column is 0, but it holds
      locks on the same index. That tells you connection 11 is blocking
      connection 12.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">M: Master/Slave Replication Status</dt>
  <dd class="It-tag">This mode shows the output of SHOW SLAVE STATUS and SHOW
      MASTER STATUS in three tables. The first two divide the slave's status
      into SQL and I/O thread status, and the last shows master status. Filters
      are applied to eliminate non-slave servers from the slave tables, and
      non-master servers from the master table.
    <div style="height: 1.00em;">&#x00A0;</div>
    This mode displays the &quot;slave_sql_status&quot;,
      &quot;slave_io_status&quot;, and &quot;master_status&quot; tables by
      default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">O: Open Tables</dt>
  <dd class="It-tag">This section comes from MySQL's SHOW OPEN TABLES command.
      By default it is filtered to show tables which are in use by one or more
      queries, so you can get a quick look at which tables are 'hot'. You can
      use this to guess which tables might be locked implicitly.
    <div style="height: 1.00em;">&#x00A0;</div>
    This mode displays the &quot;open_tables&quot; mode by default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Q: Query List</dt>
  <dd class="It-tag">This mode displays the output from SHOW FULL PROCESSLIST,
      much like <b>mytop</b>'s query list mode. This mode does <b>not</b> show
      InnoDB-related information. This is probably one of the most useful modes
      for general usage.
    <div style="height: 1.00em;">&#x00A0;</div>
    There is an informative header that shows general status information about
      your server. You can toggle it on and off with the 'h' key. By default,
      innotop hides inactive processes and its own process. You can toggle these
      on and off with the 'i' and 'a' keys.
    <div style="height: 1.00em;">&#x00A0;</div>
    You can EXPLAIN a query from this mode with the 'e' key. This displays the
      query's full text, the results of EXPLAIN, and in newer MySQL versions,
      even the optimized query resulting from EXPLAIN EXTENDED. innotop also
      tries to rewrite certain queries to make them EXPLAIN-able. For example,
      INSERT/SELECT statements are rewritable.
    <div style="height: 1.00em;">&#x00A0;</div>
    This mode displays the &quot;q_header&quot; and &quot;processlist&quot;
      tables by default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">R: InnoDB Row Operations and Semaphores</dt>
  <dd class="It-tag">This mode shows InnoDB row operations, row operation
      miscellaneous, semaphores, and information from the wait array. It
      displays the &quot;row_operations&quot;, &quot;row_operation_misc&quot;,
      &quot;semaphores&quot;, and &quot;wait_array&quot; tables by default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">S: Variables &amp; Status</dt>
  <dd class="It-tag">This mode calculates statistics, such as queries per
      second, and prints them out in several different styles. You can show
      absolute values, or incremental values between ticks.
    <div style="height: 1.00em;">&#x00A0;</div>
    You can switch between the views by pressing a key. The 's' key prints a
      single line each time the screen updates, in the style of <b>vmstat</b>.
      The 'g' key changes the view to a graph of the same numbers, sort of like
      <b>tload</b>. The 'v' key changes the view to a pivoted table of variable
      names on the left, with successive updates scrolling across the screen
      from left to right. You can choose how many updates to put on the screen
      with the &quot;num_status_sets&quot; configuration variable.
    <div style="height: 1.00em;">&#x00A0;</div>
    Headers may be abbreviated to fit on the screen in interactive operation.
      You choose which variables to display with the 'c' key, which selects from
      predefined sets, or lets you create your own sets. You can edit the
      current set with the 'e' key.
    <div style="height: 1.00em;">&#x00A0;</div>
    This mode doesn't really display any tables like other modes. Instead, it
      uses a table definition to extract and format the data, but it then
      transforms the result in special ways before outputting it. It uses the
      &quot;var_status&quot; table definition for this.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">T: InnoDB Transactions</dt>
  <dd class="It-tag">This mode shows transactions from the InnoDB monitor's
      output, in <b>top</b>-like format. This mode is the reason I wrote
      innotop.
    <div style="height: 1.00em;">&#x00A0;</div>
    You can kill queries or processes with the 'k' and 'x' keys, and EXPLAIN a
      query with the 'e' or 'f' keys. InnoDB doesn't print the full query in
      transactions, so explaining may not work right if the query is truncated.
    <div style="height: 1.00em;">&#x00A0;</div>
    The informational header can be toggled on and off with the 'h' key. By
      default, innotop hides inactive transactions and its own transaction. You
      can toggle this on and off with the 'i' and 'a' keys.
    <div style="height: 1.00em;">&#x00A0;</div>
    This mode displays the &quot;t_header&quot; and
      &quot;innodb_transactions&quot; tables by default.</dd>
</dl>
<h1 class="Sh" title="Sh" id="INNOTOP_STATUS"><a class="selflink" href="#INNOTOP_STATUS">INNOTOP
  STATUS</a></h1>
The first line innotop displays is a &quot;status bar&quot; of sorts. What it
  contains depends on the mode you're in, and what servers you're monitoring.
  The first few words are always [RO] (if readonly is set to 1), the innotop
  mode, such as &quot;InnoDB Txns&quot; for T mode, followed by a reminder to
  press '?' for help at any time.
<h2 class="Ss" title="Ss" id="ONE_SERVER"><a class="selflink" href="#ONE_SERVER">ONE
  SERVER</a></h2>
The simplest case is when you're monitoring a single server. In this case, the
  name of the connection is next on the status line. This is the name you gave
  when you created the connection -- most likely the MySQL server's hostname.
  This is followed by the server's uptime.
<div class="Pp"></div>
If you're in an InnoDB mode, such as T or B, the next word is &quot;InnoDB&quot;
  followed by some information about the SHOW INNODB STATUS output used to
  render the screen. The first word is the number of seconds since the last SHOW
  INNODB STATUS, which InnoDB uses to calculate some per-second statistics. The
  next is a smiley face indicating whether the InnoDB output is truncated. If
  the smiley face is a :-), all is well; there is no truncation. A :^| means the
  transaction list is so long, InnoDB has only printed out some of the
  transactions. Finally, a frown :-( means the output is incomplete, which is
  probably due to a deadlock printing too much lock information (see &quot;D:
  InnoDB Deadlocks&quot;).
<div class="Pp"></div>
The next two words indicate the server's queries per second (QPS) and how many
  threads (connections) exist. Finally, the server's version number is the last
  thing on the line.
<h2 class="Ss" title="Ss" id="MULTIPLE_SERVERS"><a class="selflink" href="#MULTIPLE_SERVERS">MULTIPLE
  SERVERS</a></h2>
If you are monitoring multiple servers (see &quot;SERVER CONNECTIONS&quot;), the
  status line does not show any details about individual servers. Instead, it
  shows the names of the connections that are active. Again, these are
  connection names you specified, which are likely to be the server's hostname.
  A connection that has an error is prefixed with an exclamation point.
<div class="Pp"></div>
If you are monitoring a group of servers (see &quot;SERVER GROUPS&quot;), the
  status line shows the name of the group. If any connection in the group has an
  error, the group's name is followed by the fraction of the connections that
  don't have errors.
<div class="Pp"></div>
See &quot;ERROR HANDLING&quot; for more details about innotop's error handling.
<h2 class="Ss" title="Ss" id="MONITORING_A_FILE"><a class="selflink" href="#MONITORING_A_FILE">MONITORING
  A FILE</a></h2>
If you give a filename on the command line, innotop will not connect to ANY
  servers at all. It will watch the specified file for InnoDB status output and
  use that as its data source. It will always show a single connection called
  'file'. And since it can't connect to a server, it can't determine how long
  the server it's monitoring has been up; so it calculates the server's uptime
  as time since innotop started running.
<h1 class="Sh" title="Sh" id="SERVER_ADMINISTRATION"><a class="selflink" href="#SERVER_ADMINISTRATION">SERVER
  ADMINISTRATION</a></h1>
While innotop is primarily a monitor that lets you watch and analyze your
  servers, it can also send commands to servers. The most frequently useful
  commands are killing queries and stopping or starting slaves.
<div class="Pp"></div>
You can kill a connection, or in newer versions of MySQL kill a query but not a
  connection, from &quot;Q: Query List&quot; and &quot;T: InnoDB
  Transactions&quot; modes. Press 'k' to issue a KILL command, or 'x' to issue a
  KILL QUERY command. innotop will prompt you for the server and/or connection
  ID to kill (innotop does not prompt you if there is only one possible choice
  for any input). innotop pre-selects the longest-running query, or the oldest
  connection. Confirm the command with 'y'.
<div class="Pp"></div>
In &quot;Slave Replication Status&quot;&quot; in &quot;M: Master mode, you can
  start and stop slaves with the 'a' and 'o' keys, respectively. You can send
  these commands to many slaves at once. innotop fills in a default command of
  START SLAVE or STOP SLAVE for you, but you can actually edit the command and
  send anything you wish, such as SET GLOBAL SQL_SLAVE_SKIP_COUNTER=1 to make
  the slave skip one binlog event when it starts.
<div class="Pp"></div>
You can also ask innotop to calculate the earliest binlog in use by any slave
  and issue a PURGE MASTER LOGS on the master. Use the 'b' key for this. innotop
  will prompt you for a master to run the command on, then prompt you for the
  connection names of that master's slaves (there is no way for innotop to
  determine this reliably itself). innotop will find the minimum binlog in use
  by these slave connections and suggest it as the argument to PURGE MASTER
  LOGS.
<h1 class="Sh" title="Sh" id="SERVER_CONNECTIONS"><a class="selflink" href="#SERVER_CONNECTIONS">SERVER
  CONNECTIONS</a></h1>
When you create a server connection using '@', innotop asks you for a series of
  inputs, as follows:
<dl class="Bl-tag">
  <dt class="It-tag">DSN</dt>
  <dd class="It-tag">A DSN is a Data Source Name, which is the initial argument
      passed to the DBI module for connecting to a server. It is usually of the
      form
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
 DBI:mysql:;mysql_read_default_group=mysql;host=HOSTNAME
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Since this DSN is passed to the DBD::mysql driver, you should read the
      driver's documentation at
      &quot;/search.cpan.org/dist/DBD-mysql/lib/DBD/mysql.pm&quot;&quot; in
      &quot;http: for the exact details on all the options you can pass the
      driver in the DSN. You can read more about DBI at
      &lt;http://dbi.perl.org/docs/&gt;, and especially at
      &lt;http://search.cpan.org/~timb/DBI/DBI.pm&gt;.
    <div style="height: 1.00em;">&#x00A0;</div>
    The mysql_read_default_group=mysql option lets the DBD driver read your
      MySQL options files, such as ~/.my.cnf on UNIX-ish systems. You can use
      this to avoid specifying a username or password for the connection.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">InnoDB Deadlock Table</dt>
  <dd class="It-tag">This optional item tells innotop a table name it can use to
      deliberately create a small deadlock (see &quot;D: InnoDB
      Deadlocks&quot;). If you specify this option, you just need to be sure the
      table doesn't exist, and that innotop can create and drop the table with
      the InnoDB storage engine. You can safely omit or just accept the default
      if you don't intend to use this.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Username</dt>
  <dd class="It-tag">innotop will ask you if you want to specify a username. If
      you say 'y', it will then prompt you for a user name. If you have a MySQL
      option file that specifies your username, you don't have to specify a
      username.
    <div style="height: 1.00em;">&#x00A0;</div>
    The username defaults to your login name on the system you're running
      innotop on.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Password</dt>
  <dd class="It-tag">innotop will ask you if you want to specify a password.
      Like the username, the password is optional, but there's an additional
      prompt that asks if you want to save the password in the innotop
      configuration file. If you don't save it in the configuration file,
      innotop will prompt you for a password each time it starts. Passwords in
      the innotop configuration file are saved in plain text, not encrypted in
      any way.</dd>
</dl>
<div class="Pp"></div>
Once you finish answering these questions, you should be connected to a server.
  But innotop isn't limited to monitoring a single server; you can define many
  server connections and switch between them by pressing the '@' key. See
  &quot;SWITCHING BETWEEN CONNECTIONS&quot;.
<h1 class="Sh" title="Sh" id="SERVER_GROUPS"><a class="selflink" href="#SERVER_GROUPS">SERVER
  GROUPS</a></h1>
If you have multiple MySQL instances, you can put them into named groups, such
  as 'all', 'masters', and 'slaves', which innotop can monitor all together.
<div class="Pp"></div>
You can choose which group to monitor with the '#' key, and you can press the
  TAB key to switch to the next group. If you're not currently monitoring a
  group, pressing TAB selects the first group.
<div class="Pp"></div>
To create a group, press the '#' key and type the name of your new group, then
  type the names of the connections you want the group to contain.
<h1 class="Sh" title="Sh" id="SWITCHING_BETWEEN_CONNECTIONS"><a class="selflink" href="#SWITCHING_BETWEEN_CONNECTIONS">SWITCHING
  BETWEEN CONNECTIONS</a></h1>
innotop lets you quickly switch which servers you're monitoring. The most basic
  way is by pressing the '@' key and typing the name(s) of the connection(s) you
  want to use. This setting is per-mode, so you can monitor different
  connections in each mode, and innotop remembers which connections you choose.
<div class="Pp"></div>
You can quickly switch to the 'next' connection in alphabetical order with the
  'n' key. If you're monitoring a server group (see &quot;SERVER GROUPS&quot;)
  this will switch to the first connection.
<div class="Pp"></div>
You can also type many connection names, and innotop will fetch and display data
  from them all. Just separate the connection names with spaces, for example
  &quot;server1 server2.&quot; Again, if you type the name of a connection that
  doesn't exist, innotop will prompt you for connection information and create
  the connection.
<div class="Pp"></div>
Another way to monitor multiple connections at once is with server groups. You
  can use the TAB key to switch to the 'next' group in alphabetical order, or if
  you're not monitoring any groups, TAB will switch to the first group.
<div class="Pp"></div>
innotop does not fetch data in parallel from connections, so if you are
  monitoring a large group or many connections, you may notice increased delay
  between ticks.
<div class="Pp"></div>
When you monitor more than one connection, innotop's status bar changes. See
  &quot;INNOTOP STATUS&quot;.
<h1 class="Sh" title="Sh" id="ERROR_HANDLING"><a class="selflink" href="#ERROR_HANDLING">ERROR
  HANDLING</a></h1>
Error handling is not that important when monitoring a single connection, but is
  crucial when you have many active connections. A crashed server or lost
  connection should not crash innotop. As a result, innotop will continue to run
  even when there is an error; it just won't display any information from the
  connection that had an error. Because of this, innotop's behavior might
  confuse you. It's a feature, not a bug!
<div class="Pp"></div>
innotop does not continue to query connections that have errors, because they
  may slow innotop and make it hard to use, especially if the error is a problem
  connecting and causes a long time-out. Instead, innotop retries the connection
  occasionally to see if the error still exists. If so, it will wait until some
  point in the future. The wait time increases in ticks as the Fibonacci series,
  so it tries less frequently as time passes.
<div class="Pp"></div>
Since errors might only happen in certain modes because of the SQL commands
  issued in those modes, innotop keeps track of which mode caused the error. If
  you switch to a different mode, innotop will retry the connection instead of
  waiting.
<div class="Pp"></div>
By default innotop will display the problem in red text at the bottom of the
  first table on the screen. You can disable this behavior with the
  &quot;show_cxn_errors_in_tbl&quot; configuration option, which is enabled by
  default. If the &quot;debug&quot; option is enabled, innotop will display the
  error at the bottom of every table, not just the first. And if
  &quot;show_cxn_errors&quot; is enabled, innotop will print the error text to
  STDOUT as well. Error messages might only display in the mode that caused the
  error, depending on the mode and whether innotop is avoiding querying that
  connection.
<h1 class="Sh" title="Sh" id="NON-INTERACTIVE_OPERATION"><a class="selflink" href="#NON-INTERACTIVE_OPERATION">NON-INTERACTIVE
  OPERATION</a></h1>
You can run innotop in non-interactive mode, in which case it is entirely
  controlled from the configuration file and command-line options. To start
  innotop in non-interactive mode, give the L&quot;&lt;--nonint&quot;&gt;
  command-line option. This changes innotop's behavior in the following ways:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Certain Perl modules are not loaded. Term::Readline is not
      loaded, since innotop doesn't prompt interactively. Term::ANSIColor and
      Win32::Console::ANSI modules are not loaded. Term::ReadKey is still used,
      since innotop may have to prompt for connection passwords when starting
      up.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">innotop does not clear the screen after each tick.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">innotop does not persist any changes to the configuration
      file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">If &quot;--count&quot; is given and innotop is in
      incremental mode (see &quot;status_inc&quot; and &quot;--inc&quot;),
      innotop actually refreshes one more time than specified so it can print
      incremental statistics. This suppresses output during the first tick, so
      innotop may appear to hang.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">innotop only displays the first table in each mode. This is
      so the output can be easily processed with other command-line utilities
      such as awk and sed. To change which tables display in each mode, see
      &quot;TABLES&quot;. Since &quot;Q: Query List&quot; mode is so important,
      innotop automatically disables the &quot;q_header&quot; table. This
      ensures you'll see the &quot;processlist&quot; table, even if you have
      innotop configured to show the q_header table during interactive
      operation. Similarly, in &quot;T: InnoDB Transactions&quot; mode, the
      &quot;t_header&quot; table is suppressed so you see only the
      &quot;innodb_transactions&quot; table.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">All output is tab-separated instead of being column-aligned
      with whitespace, and innotop prints the full contents of each table
      instead of only printing one screenful at a time.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">innotop only prints column headers once instead of every
      tick (see &quot;hide_hdr&quot;). innotop does not print table captions
      (see &quot;display_table_captions&quot;). innotop ensures there are no
      empty lines in the output.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">innotop does not honor the &quot;shorten&quot;
      transformation, which normally shortens some numbers to human-readable
      formats.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">innotop does not print a status line (see &quot;INNOTOP
      STATUS&quot;).</dd>
</dl>
<h1 class="Sh" title="Sh" id="CONFIGURING"><a class="selflink" href="#CONFIGURING">CONFIGURING</a></h1>
Nearly everything about innotop is configurable. Most things are possible to
  change with built-in commands, but you can also edit the configuration file.
<div class="Pp"></div>
While running innotop, press the '$' key to bring up the configuration editing
  dialog. Press another key to select the type of data you want to edit:
<dl class="Bl-tag">
  <dt class="It-tag">S: Statement Sleep Times</dt>
  <dd class="It-tag">Edits SQL statement sleep delays, which make innotop pause
      for the specified amount of time after executing a statement. See
      &quot;SQL STATEMENTS&quot; for a definition of each statement and what it
      does. By default innotop does not delay after any statements.
    <div style="height: 1.00em;">&#x00A0;</div>
    This feature is included so you can customize the side-effects caused by
      monitoring your server. You may not see any effects, but some innotop
      users have noticed that certain MySQL versions under very high load with
      InnoDB enabled take longer than usual to execute SHOW GLOBAL STATUS. If
      innotop calls SHOW FULL PROCESSLIST immediately afterward, the processlist
      contains more queries than the machine actually averages at any given
      moment. Configuring innotop to pause briefly after calling SHOW GLOBAL
      STATUS alleviates this effect.
    <div style="height: 1.00em;">&#x00A0;</div>
    Sleep times are stored in the &quot;stmt_sleep_times&quot; section of the
      configuration file. Fractional-second sleeps are supported, subject to
      your hardware's limitations.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">c: Edit Columns</dt>
  <dd class="It-tag">Starts the table editor on one of the displayed tables. See
      &quot;TABLE EDITOR&quot;. An alternative way to start the table editor
      without entering the configuration dialog is with the '^' key.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">g: General Configuration</dt>
  <dd class="It-tag">Starts the configuration editor to edit global and
      mode-specific configuration variables (see &quot;MODES&quot;). innotop
      prompts you to choose a variable from among the global and mode-specific
      ones depending on the current mode.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">k: Row-Coloring Rules</dt>
  <dd class="It-tag">Starts the row-coloring rules editor on one of the
      displayed table(s). See &quot;COLORS&quot; for details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">p: Manage Plugins</dt>
  <dd class="It-tag">Starts the plugin configuration editor. See
      &quot;PLUGINS&quot; for details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">s: Server Groups</dt>
  <dd class="It-tag">Lets you create and edit server groups. See &quot;SERVER
      GROUPS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">t: Choose Displayed Tables</dt>
  <dd class="It-tag">Lets you choose which tables to display in this mode. See
      &quot;MODES&quot; and &quot;TABLES&quot;.</dd>
</dl>
<h1 class="Sh" title="Sh" id="CONFIGURATION_FILE"><a class="selflink" href="#CONFIGURATION_FILE">CONFIGURATION
  FILE</a></h1>
innotop's default configuration file locations are $HOME/.innotop and
  /etc/innotop/innotop.conf, and they are looked for in that order. If the first
  configuration file exists, the second will not be processed. Those can be
  overridden with the &quot;--config&quot; command-line option. You can edit it
  by hand safely, however innotop reads the configuration file when it starts,
  and, if readonly is set to 0, writes it out again when it exits. Thus, if
  readonly is set to 0, any changes you make by hand while innotop is running
  will be lost.
<div class="Pp"></div>
innotop doesn't store its entire configuration in the configuration file. It has
  a huge set of default configuration values that it holds only in memory, and
  the configuration file only overrides these defaults. When you customize a
  default setting, innotop notices, and then stores the customizations into the
  file. This keeps the file size down, makes it easier to edit, and makes
  upgrades easier.
<div class="Pp"></div>
A configuration file is read-only be default. You can override that with
  &quot;--write&quot;. See &quot;readonly&quot;.
<div class="Pp"></div>
The configuration file is arranged into sections like an INI file. Each section
  begins with [section-name] and ends with [/section-name]. Each section's
  entries have a different syntax depending on the data they need to store. You
  can put comments in the file; any line that begins with a # character is a
  comment. innotop will not read the comments, so it won't write them back out
  to the file when it exits. Comments in read-only configuration files are still
  useful, though.
<div class="Pp"></div>
The first line in the file is innotop's version number. This lets innotop notice
  when the file format is not backwards-compatible, and upgrade smoothly without
  destroying your customized configuration.
<div class="Pp"></div>
The following list describes each section of the configuration file and the data
  it contains:
<dl class="Bl-tag">
  <dt class="It-tag">general</dt>
  <dd class="It-tag">The 'general' section contains global configuration
      variables and variables that may be mode-specific, but don't belong in any
      other section. The syntax is a simple key=value list. innotop writes a
      comment above each value to help you edit the file by hand.</dd>
</dl>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">S_func</dt>
  <dd class="It-tag">Controls S mode presentation (see &quot;S: Variables &amp;
      Status&quot;). If g, values are graphed; if s, values are like vmstat; if
      p, values are in a pivoted table.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">S_set</dt>
  <dd class="It-tag">Specifies which set of variables to display in &quot;S:
      Variables &amp; Status&quot; mode. See &quot;VARIABLE SETS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">auto_wipe_dl</dt>
  <dd class="It-tag">Instructs innotop to automatically wipe large deadlocks
      when it notices them. When this happens you may notice a slight delay. At
      the next tick, you will usually see the information that was being
      truncated by the large deadlock.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">charset</dt>
  <dd class="It-tag">Specifies what kind of characters to allow through the
      &quot;no_ctrl_char&quot; transformation. This keeps non-printable
      characters from confusing a terminal when you monitor queries that contain
      binary data, such as images.
    <div style="height: 1.00em;">&#x00A0;</div>
    The default is 'ascii', which considers anything outside normal ASCII to be
      a control character. The other allowable values are 'unicode' and 'none'.
      'none' considers every character a control character, which can be useful
      for collapsing ALL text fields in queries.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">cmd_filter</dt>
  <dd class="It-tag">This is the prefix that filters variables in &quot;C:
      Command Summary&quot; mode.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">color</dt>
  <dd class="It-tag">Whether terminal coloring is permitted.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">cxn_timeout</dt>
  <dd class="It-tag">On MySQL versions 4.0.3 and newer, this variable is used to
      set the connection's timeout, so MySQL doesn't close the connection if it
      is not used for a while. This might happen because a connection isn't
      monitored in a particular mode, for example.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">debug</dt>
  <dd class="It-tag">This option enables more verbose errors and makes innotop
      more strict in some places. It can help in debugging filters and other
      user-defined code. It also makes innotop write a lot of information to
      &quot;debugfile&quot; when there is a crash.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">debugfile</dt>
  <dd class="It-tag">A file to which innotop will write information when there
      is a crash. See &quot;FILES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">display_table_captions</dt>
  <dd class="It-tag">innotop displays a table caption above most tables. This
      variable suppresses or shows captions on all tables globally. Some tables
      are configured with the hide_caption property, which overrides this.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">global</dt>
  <dd class="It-tag">Whether to show GLOBAL variables and status. innotop only
      tries to do this on servers which support the GLOBAL option to SHOW
      VARIABLES and SHOW STATUS. In some MySQL versions, you need certain
      privileges to do this; if you don't have them, innotop will not be able to
      fetch any variable and status data. This configuration variable lets you
      run innotop and fetch what data you can even without the elevated
      privileges.
    <div style="height: 1.00em;">&#x00A0;</div>
    I can no longer find or reproduce the situation where GLOBAL wasn't allowed,
      but I know there was one.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">graph_char</dt>
  <dd class="It-tag">Defines the character to use when drawing graphs in
      &quot;S: Variables &amp; Status&quot; mode.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">header_highlight</dt>
  <dd class="It-tag">Defines how to highlight column headers. This only works if
      Term::ANSIColor is available. Valid values are 'bold' and
    'underline'.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">hide_hdr</dt>
  <dd class="It-tag">Hides column headers globally.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">interval</dt>
  <dd class="It-tag">The interval at which innotop will refresh its data
      (ticks). The interval is implemented as a sleep time between ticks, so the
      true interval will vary depending on how long it takes innotop to fetch
      and render data.
    <div style="height: 1.00em;">&#x00A0;</div>
    This variable accepts fractions of a second.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">mode</dt>
  <dd class="It-tag">The mode in which innotop should start. Allowable arguments
      are the same as the key presses that select a mode interactively. See
      &quot;MODES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">num_digits</dt>
  <dd class="It-tag">How many digits to show in fractional numbers and percents.
      This variable's range is between 0 and 9 and can be set directly from
      &quot;S: Variables &amp; Status&quot; mode with the '+' and '-' keys. It
      is used in the &quot;set_precision&quot;, &quot;shorten&quot;, and
      &quot;percent&quot; transformations.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">num_status_sets</dt>
  <dd class="It-tag">Controls how many sets of status variables to display in
      pivoted &quot;S: Variables &amp; Status&quot; mode. It also controls the
      number of old sets of variables innotop keeps in its memory, so the larger
      this variable is, the more memory innotop uses.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">plugin_dir</dt>
  <dd class="It-tag">Specifies where plugins can be found. By default, innotop
      stores plugins in the 'plugins' subdirectory of your innotop configuration
      directory.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">readonly</dt>
  <dd class="It-tag">Whether the configuration file is readonly. This cannot be
      set interactively.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">show_cxn_errors</dt>
  <dd class="It-tag">Makes innotop print connection errors to STDOUT. See
      &quot;ERROR HANDLING&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">show_cxn_errors_in_tbl</dt>
  <dd class="It-tag">Makes innotop display connection errors as rows in the
      first table on screen. See &quot;ERROR HANDLING&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">show_percent</dt>
  <dd class="It-tag">Adds a '%' character after the value returned by the
      &quot;percent&quot; transformation.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">show_statusbar</dt>
  <dd class="It-tag">Controls whether to show the status bar in the display. See
      &quot;INNOTOP STATUS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">skip_innodb</dt>
  <dd class="It-tag">Disables fetching SHOW INNODB STATUS, in case your
      server(s) do not have InnoDB enabled and you don't want innotop to try to
      fetch it. This can also be useful when you don't have the SUPER privilege,
      required to run SHOW INNODB STATUS.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">status_inc</dt>
  <dd class="It-tag">Whether to show absolute or incremental values for status
      variables. Incremental values are calculated as an offset from the last
      value innotop saw for that variable. This is a global setting, but will
      probably become mode-specific at some point. Right now it is honored a bit
      inconsistently; some modes don't pay attention to it.</dd>
</dl>
</div>
<div style="margin-left: 4.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag">plugins</dt>
  <dd class="It-tag">This section holds a list of package names of active
      plugins. If the plugin exists, innotop will activate it. See
      &quot;PLUGINS&quot; for more information.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">filters</dt>
  <dd class="It-tag">This section holds user-defined filters (see
      &quot;FILTERS&quot;). Each line is in the format filter_name=text='filter
      text' tbls='table list'.
    <div style="height: 1.00em;">&#x00A0;</div>
    The filter text is the text of the subroutine's code. The table list is a
      list of tables to which the filter can apply. By default, user-defined
      filters apply to the table for which they were created, but you can
      manually override that by editing the definition in the configuration
      file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">active_filters</dt>
  <dd class="It-tag">This section stores which filters are active on each table.
      Each line is in the format table_name=filter_list.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">tbl_meta</dt>
  <dd class="It-tag">This section stores user-defined or user-customized columns
      (see &quot;COLUMNS&quot;). Each line is in the format col_name=properties,
      where the properties are a name=quoted-value list.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">connections</dt>
  <dd class="It-tag">This section holds the server connections you have defined.
      Each line is in the format name=properties, where the properties are a
      name=value list. The properties are self-explanatory, and the only one
      that is treated specially is 'pass' which is only present if 'savepass' is
      set. This section of the configuration file will be skipped if any DSN,
      username, or password command-line options are used. See &quot;SERVER
      CONNECTIONS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">active_connections</dt>
  <dd class="It-tag">This section holds a list of which connections are active
      in each mode. Each line is in the format mode_name=connection_list.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">server_groups</dt>
  <dd class="It-tag">This section holds server groups. Each line is in the
      format name=connection_list. See &quot;SERVER GROUPS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">active_server_groups</dt>
  <dd class="It-tag">This section holds a list of which server group is active
      in each mode. Each line is in the format mode_name=server_group.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">max_values_seen</dt>
  <dd class="It-tag">This section holds the maximum values seen for variables.
      This is used to scale the graphs in &quot;S: Variables &amp; Status&quot;
      mode. Each line is in the format name=value.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">active_columns</dt>
  <dd class="It-tag">This section holds table column lists. Each line is in the
      format tbl_name=column_list. See &quot;COLUMNS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">sort_cols</dt>
  <dd class="It-tag">This section holds the sort definition. Each line is in the
      format tbl_name=column_list. If a column is prefixed with '-', that column
      sorts descending. See &quot;SORTING&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">visible_tables</dt>
  <dd class="It-tag">This section defines which tables are visible in each mode.
      Each line is in the format mode_name=table_list. See
    &quot;TABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">varsets</dt>
  <dd class="It-tag">This section defines variable sets for use in &quot;S:
      Status &amp; Variables&quot; mode. Each line is in the format
      name=variable_list. See &quot;VARIABLE SETS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">colors</dt>
  <dd class="It-tag">This section defines colorization rules. Each line is in
      the format tbl_name=property_list. See &quot;COLORS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">stmt_sleep_times</dt>
  <dd class="It-tag">This section contains statement sleep times. Each line is
      in the format statement_name=sleep_time. See &quot;S: Statement Sleep
      Times&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">group_by</dt>
  <dd class="It-tag">This section contains column lists for table group_by
      expressions. Each line is in the format tbl_name=column_list. See
      &quot;GROUPING&quot;.</dd>
</dl>
<h1 class="Sh" title="Sh" id="CUSTOMIZING"><a class="selflink" href="#CUSTOMIZING">CUSTOMIZING</a></h1>
You can customize innotop a great deal. For example, you can:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Choose which tables to display, and in what order.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Choose which columns are in those tables, and create new
      columns.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Filter which rows display with built-in filters,
      user-defined filters, and quick-filters.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Sort the rows to put important data first or group together
      related rows.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Highlight rows with color.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Customize the alignment, width, and formatting of columns,
      and apply transformations to columns to extract parts of their values or
      format the values as you wish (for example, shortening large numbers to
      familiar units).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Design your own expressions to extract and combine data as
      you need. This gives you unlimited flexibility.</dd>
</dl>
<div class="Pp"></div>
All these and more are explained in the following sections.
<h2 class="Ss" title="Ss" id="TABLES"><a class="selflink" href="#TABLES">TABLES</a></h2>
A table is what you'd expect: a collection of columns. It also has some other
  properties, such as a caption. Filters, sorting rules, and colorization rules
  belong to tables and are covered in later sections.
<div class="Pp"></div>
Internally, table meta-data is defined in a data structure called %tbl_meta.
  This hash holds all built-in table definitions, which contain a lot of default
  instructions to innotop. The meta-data includes the caption, a list of columns
  the user has customized, a list of columns, a list of visible columns, a list
  of filters, color rules, a sort-column list, sort direction, and some
  information about the table's data sources. Most of this is customizable via
  the table editor (see &quot;TABLE EDITOR&quot;).
<div class="Pp"></div>
You can choose which tables to show by pressing the '$' key. See
  &quot;MODES&quot; and &quot;TABLES&quot;.
<div class="Pp"></div>
The table life-cycle is as follows:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Each table begins with a data source, which is an array of
      hashes. See below for details on data sources.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Each element of the data source becomes a row in the final
      table.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">For each element in the data source, innotop extracts
      values from the source and creates a row. This row is another hash, which
      later steps will refer to as $set. The values innotop extracts are
      determined by the table's columns. Each column has an extraction
      subroutine, compiled from an expression (see &quot;EXPRESSIONS&quot;). The
      resulting row is a hash whose keys are named the same as the column
    name.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">innotop filters the rows, removing those that don't need to
      be displayed. See &quot;FILTERS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">innotop sorts the rows. See &quot;SORTING&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">innotop groups the rows together, if specified. See
      &quot;GROUPING&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">innotop colorizes the rows. See &quot;COLORS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">innotop transforms the column values in each row. See
      &quot;TRANSFORMATIONS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">innotop optionally pivots the rows (see
      &quot;PIVOTING&quot;), then filters and sorts them.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">innotop formats and justifies the rows as a table. During
      this step, innotop applies further formatting to the column values,
      including alignment, maximum and minimum widths. innotop also does final
      error checking to ensure there are no crashes due to undefined values.
      innotop then adds a caption if specified, and the table is ready to
    print.</dd>
</dl>
<div class="Pp"></div>
The lifecycle is slightly different if the table is pivoted, as noted above. To
  clarify, if the table is pivoted, the process is extract, group, transform,
  pivot, filter, sort, create. If it's not pivoted, the process is extract,
  filter, sort, group, color, transform, create. This slightly convoluted
  process doesn't map all that well to SQL, but pivoting complicates things
  pretty thoroughly. Roughly speaking, filtering and sorting happen as late as
  needed to effect the final result as you might expect, but as early as
  possible for efficiency.
<div class="Pp"></div>
Each built-in table is described below:
<dl class="Bl-tag">
  <dt class="It-tag">adaptive_hash_index</dt>
  <dd class="It-tag">Displays data about InnoDB's adaptive hash index. Data
      source: &quot;STATUS_VARIABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">buffer_pool</dt>
  <dd class="It-tag">Displays data about InnoDB's buffer pool. Data source:
      &quot;STATUS_VARIABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">cmd_summary</dt>
  <dd class="It-tag">Displays weighted status variables. Data source:
      &quot;STATUS_VARIABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">deadlock_locks</dt>
  <dd class="It-tag">Shows which locks were held and waited for by the last
      detected deadlock. Data source: &quot;DEADLOCK_LOCKS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">deadlock_transactions</dt>
  <dd class="It-tag">Shows transactions involved in the last detected deadlock.
      Data source: &quot;DEADLOCK_TRANSACTIONS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">explain</dt>
  <dd class="It-tag">Shows the output of EXPLAIN. Data source:
      &quot;EXPLAIN&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">file_io_misc</dt>
  <dd class="It-tag">Displays data about InnoDB's file and I/O operations. Data
      source: &quot;STATUS_VARIABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">fk_error</dt>
  <dd class="It-tag">Displays various data about InnoDB's last foreign key
      error. Data source: &quot;STATUS_VARIABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">innodb_locks</dt>
  <dd class="It-tag">Displays InnoDB locks. Data source:
      &quot;INNODB_LOCKS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">innodb_transactions</dt>
  <dd class="It-tag">Displays data about InnoDB's current transactions. Data
      source: &quot;INNODB_TRANSACTIONS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">insert_buffers</dt>
  <dd class="It-tag">Displays data about InnoDB's insert buffer. Data source:
      &quot;STATUS_VARIABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">io_threads</dt>
  <dd class="It-tag">Displays data about InnoDB's I/O threads. Data source:
      &quot;IO_THREADS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">log_statistics</dt>
  <dd class="It-tag">Displays data about InnoDB's logging system. Data source:
      &quot;STATUS_VARIABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">master_status</dt>
  <dd class="It-tag">Displays replication master status. Data source:
      &quot;STATUS_VARIABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">open_tables</dt>
  <dd class="It-tag">Displays open tables. Data source:
    &quot;OPEN_TABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">page_statistics</dt>
  <dd class="It-tag">Displays InnoDB page statistics. Data source:
      &quot;STATUS_VARIABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">pending_io</dt>
  <dd class="It-tag">Displays InnoDB pending I/O operations. Data source:
      &quot;STATUS_VARIABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">processlist</dt>
  <dd class="It-tag">Displays current MySQL processes (threads/connections).
      Data source: &quot;PROCESSLIST&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">q_header</dt>
  <dd class="It-tag">Displays various status values. Data source:
      &quot;STATUS_VARIABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">row_operation_misc</dt>
  <dd class="It-tag">Displays data about InnoDB's row operations. Data source:
      &quot;STATUS_VARIABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">row_operations</dt>
  <dd class="It-tag">Displays data about InnoDB's row operations. Data source:
      &quot;STATUS_VARIABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">semaphores</dt>
  <dd class="It-tag">Displays data about InnoDB's semaphores and mutexes. Data
      source: &quot;STATUS_VARIABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">slave_io_status</dt>
  <dd class="It-tag">Displays data about the slave I/O thread. Data source:
      &quot;STATUS_VARIABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">slave_sql_status</dt>
  <dd class="It-tag">Displays data about the slave SQL thread. Data source:
      &quot;STATUS_VARIABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">t_header</dt>
  <dd class="It-tag">Displays various InnoDB status values. Data source:
      &quot;STATUS_VARIABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">var_status</dt>
  <dd class="It-tag">Displays user-configurable data. Data source:
      &quot;STATUS_VARIABLES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">wait_array</dt>
  <dd class="It-tag">Displays data about InnoDB's OS wait array. Data source:
      &quot;OS_WAIT_ARRAY&quot;.</dd>
</dl>
<h2 class="Ss" title="Ss" id="COLUMNS"><a class="selflink" href="#COLUMNS">COLUMNS</a></h2>
Columns belong to tables. You can choose a table's columns by pressing the '^'
  key, which starts the &quot;TABLE EDITOR&quot; and lets you choose and edit
  columns. Pressing 'e' from within the table editor lets you edit the column's
  properties:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">hdr: a column header. This appears in the first row of the
      table.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">just: justification. '-' means left-justified and '' means
      right-justified, just as with printf formatting codes (not a
    coincidence).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">dec: whether to further align the column on the decimal
      point.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">num: whether the column is numeric. This affects how values
      are sorted (lexically or numerically).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">label: a small note about the column, which appears in
      dialogs that help the user choose columns.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">src: an expression that innotop uses to extract the
      column's data from its source (see &quot;DATA SOURCES&quot;). See
      &quot;EXPRESSIONS&quot; for more on expressions.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">minw: specifies a minimum display width. This helps
      stabilize the display, which makes it easier to read if the data is
      changing frequently.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">maxw: similar to minw.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">trans: a list of column transformations. See
      &quot;TRANSFORMATIONS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">agg: an aggregate function. See &quot;GROUPING&quot;. The
      default is &quot;first&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">aggonly: controls whether the column only shows when
      grouping is enabled on the table (see &quot;GROUPING&quot;). By default,
      this is disabled. This means columns will always be shown by default,
      whether grouping is enabled or not. If a column's aggonly is set true, the
      column will appear when you toggle grouping on the table. Several columns
      are set this way, such as the count column on &quot;processlist&quot; and
      &quot;innodb_transactions&quot;, so you don't see a count when the
      grouping isn't enabled, but you do when it is.</dd>
</dl>
<h2 class="Ss" title="Ss" id="FILTERS"><a class="selflink" href="#FILTERS">FILTERS</a></h2>
Filters remove rows from the display. They behave much like a WHERE clause in
  SQL. innotop has several built-in filters, which remove irrelevant information
  like inactive queries, but you can define your own as well. innotop also lets
  you create quick-filters, which do not get saved to the configuration file,
  and are just an easy way to quickly view only some rows.
<div class="Pp"></div>
You can enable or disable a filter on any table. Press the '%' key (mnemonic: %
  looks kind of like a line being filtered between two circles) and choose which
  table you want to filter, if asked. You'll then see a list of possible filters
  and a list of filters currently enabled for that table. Type the names of
  filters you want to apply and press Enter.
<div class="Pp"></div>
<i>USER-DEFINED FILTERS</i>
<div class="Pp"></div>
If you type a name that doesn't exist, innotop will prompt you to create the
  filter. Filters are easy to create if you know Perl, and not hard if you
  don't. What you're doing is creating a subroutine that returns true if the row
  should be displayed. The row is a hash reference passed to your subroutine as
  $set.
<div class="Pp"></div>
For example, imagine you want to filter the processlist table so you only see
  queries that have been running more than five minutes. Type a new name for
  your filter, and when prompted for the subroutine body, press TAB to initiate
  your terminal's auto-completion. You'll see the names of the columns in the
  &quot;processlist&quot; table (innotop generally tries to help you with
  auto-completion lists). You want to filter on the 'time' column. Type the text
  &quot;$set-&gt;{time} &gt; 300&quot; to return true when the query is more
  than five minutes old. That's all you need to do.
<div class="Pp"></div>
In other words, the code you're typing is surrounded by an implicit context,
  which looks like this:
<div class="Pp"></div>
<pre>
 sub filter {
    my ( $set ) = @_;
    # YOUR CODE HERE
 }
</pre>
<div class="Pp"></div>
If your filter doesn't work, or if something else suddenly behaves differently,
  you might have made an error in your filter, and innotop is silently catching
  the error. Try enabling &quot;debug&quot; to make innotop throw an error
  instead.
<div class="Pp"></div>
<i>QUICK-FILTERS</i>
<div class="Pp"></div>
innotop's quick-filters are a shortcut to create a temporary filter that doesn't
  persist when you restart innotop. To create a quick-filter, press the '/' key.
  innotop will prompt you for the column name and filter text. Again, you can
  use auto-completion on column names. The filter text can be just the text you
  want to &quot;search for.&quot; For example, to filter the
  &quot;processlist&quot; table on queries that refer to the products table,
  type '/' and then 'info product'.
<div class="Pp"></div>
The filter text can actually be any Perl regular expression, but of course a
  literal string like 'product' works fine as a regular expression.
<div class="Pp"></div>
Behind the scenes innotop compiles the quick-filter into a specially tagged
  filter that is otherwise like any other filter. It just isn't saved to the
  configuration file.
<div class="Pp"></div>
To clear quick-filters, press the '\' key and innotop will clear them all at
  once.
<h2 class="Ss" title="Ss" id="SORTING"><a class="selflink" href="#SORTING">SORTING</a></h2>
innotop has sensible built-in defaults to sort the most important rows to the
  top of the table. Like anything else in innotop, you can customize how any
  table is sorted.
<div class="Pp"></div>
To start the sort dialog, start the &quot;TABLE EDITOR&quot; with the '^' key,
  choose a table if necessary, and press the 's' key. You'll see a list of
  columns you can use in the sort expression and the current sort expression, if
  any. Enter a list of columns by which you want to sort and press Enter. If you
  want to reverse sort, prefix the column name with a minus sign. For example,
  if you want to sort by column a ascending, then column b descending, type 'a
  -b'. You can also explicitly add a + in front of columns you want to sort
  ascending, but it's not required.
<div class="Pp"></div>
Some modes have keys mapped to open this dialog directly, and to quickly reverse
  sort direction. Press '?' as usual to see which keys are mapped in any mode.
<h2 class="Ss" title="Ss" id="GROUPING"><a class="selflink" href="#GROUPING">GROUPING</a></h2>
innotop can group, or aggregate, rows together (the terms are used
  interchangeably). This is quite similar to an SQL GROUP BY clause. You can
  specify to group on certain columns, or if you don't specify any, the entire
  set of rows is treated as one group. This is quite like SQL so far, but unlike
  SQL, you can also select un-grouped columns. innotop actually aggregates every
  column. If you don't explicitly specify a grouping function, the default is
  'first'. This is basically a convenience so you don't have to specify an
  aggregate function for every column you want in the result.
<div class="Pp"></div>
You can quickly toggle grouping on a table with the '=' key, which toggles its
  aggregate property. This property doesn't persist to the config file.
<div class="Pp"></div>
The columns by which the table is grouped are specified in its group_by
  property. When you turn grouping on, innotop places the group_by columns at
  the far left of the table, even if they're not supposed to be visible. The
  rest of the visible columns appear in order after them.
<div class="Pp"></div>
Two tables have default group_by lists and a count column built in:
  &quot;processlist&quot; and &quot;innodb_transactions&quot;. The grouping is
  by connection and status, so you can quickly see how many queries or
  transactions are in a given status on each server you're monitoring. The time
  columns are aggregated as a sum; other columns are left at the default 'first'
  aggregation.
<div class="Pp"></div>
By default, the table shown in &quot;S: Variables &amp; Status&quot; mode also
  uses grouping so you can monitor variables and status across many servers. The
  default aggregation function in this mode is 'avg'.
<div class="Pp"></div>
Valid grouping functions are defined in the %agg_funcs hash. They include
<dl class="Bl-tag">
  <dt class="It-tag">first</dt>
  <dd class="It-tag">Returns the first element in the group.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">count</dt>
  <dd class="It-tag">Returns the number of elements in the group, including
      undefined elements, much like SQL's COUNT(*).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">avg</dt>
  <dd class="It-tag">Returns the average of defined elements in the group.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">sum</dt>
  <dd class="It-tag">Returns the sum of elements in the group.</dd>
</dl>
<div class="Pp"></div>
Here's an example of grouping at work. Suppose you have a very busy server with
  hundreds of open connections, and you want to see how many connections are in
  what status. Using the built-in grouping rules, you can press 'Q' to enter
  &quot;Q: Query List&quot; mode. Press '=' to toggle grouping (if necessary,
  select the &quot;processlist&quot; table when prompted).
<div class="Pp"></div>
Your display might now look like the following:
<div class="Pp"></div>
<pre>
 Query List (? for help) localhost, 32:33, 0.11 QPS, 1 thd, 5.0.38-log
 
 CXN        Cmd        Cnt  ID      User   Host           Time   Query       
 localhost  Query      49    12933  webusr localhost      19:38  SELECT * FROM
 localhost  Sending Da 23     2383  webusr localhost      12:43  SELECT col1,
 localhost  Sleep      120     140  webusr localhost    5:18:12
 localhost  Statistics 12    19213  webusr localhost      01:19  SELECT * FROM
</pre>
<div class="Pp"></div>
That's actually quite a worrisome picture. You've got a lot of idle connections
  (Sleep), and some connections executing queries (Query and Sending Data).
  That's okay, but you also have a lot in Statistics status, collectively
  spending over a minute. That means the query optimizer is having a really hard
  time optimizing your statements. Something is wrong; it should normally take
  milliseconds to optimize queries. You might not have seen this pattern if you
  didn't look at your connections in aggregate. (This is a made-up example, but
  it can happen in real life).
<h2 class="Ss" title="Ss" id="PIVOTING"><a class="selflink" href="#PIVOTING">PIVOTING</a></h2>
innotop can pivot a table for more compact display, similar to a Pivot Table in
  a spreadsheet (also known as a crosstab). Pivoting a table makes columns into
  rows. Assume you start with this table:
<div class="Pp"></div>
<pre>
 foo bar
 === ===
 1   3
 2   4
</pre>
<div class="Pp"></div>
After pivoting, the table will look like this:
<div class="Pp"></div>
<pre>
 name set0 set1
 ==== ==== ====
 foo  1    2
 bar  3    4
</pre>
<div class="Pp"></div>
To get reasonable results, you might need to group as well as pivoting. innotop
  currently does this for &quot;S: Variables &amp; Status&quot; mode.
<h2 class="Ss" title="Ss" id="COLORS"><a class="selflink" href="#COLORS">COLORS</a></h2>
By default, innotop highlights rows with color so you can see at a glance which
  rows are more important. You can customize the colorization rules and add your
  own to any table. Open the table editor with the '^' key, choose a table if
  needed, and press 'o' to open the color editor dialog.
<div class="Pp"></div>
The color editor dialog displays the rules applied to the table, in the order
  they are evaluated. Each row is evaluated against each rule to see if the rule
  matches the row; if it does, the row gets the specified color, and no further
  rules are evaluated. The rules look like the following:
<div class="Pp"></div>
<pre>
 state  eq  Locked       black on_red
 cmd    eq  Sleep        white       
 user   eq  system user  white       
 cmd    eq  Connect      white       
 cmd    eq  Binlog Dump  white       
 time   &gt;   600          red         
 time   &gt;   120          yellow      
 time   &gt;   60           green       
 time   &gt;   30           cyan
</pre>
<div class="Pp"></div>
This is the default rule set for the &quot;processlist&quot; table. In order of
  priority, these rules make locked queries black on a red background,
  &quot;gray out&quot; connections from replication and sleeping queries, and
  make queries turn from cyan to red as they run longer.
<div class="Pp"></div>
(For some reason, the ANSI color code &quot;white&quot; is actually a light
  gray. Your terminal's display may vary; experiment to find colors you like).
<div class="Pp"></div>
You can use keystrokes to move the rules up and down, which re-orders their
  priority. You can also delete rules and add new ones. If you add a new rule,
  innotop prompts you for the column, an operator for the comparison, a value
  against which to compare the column, and a color to assign if the rule
  matches. There is auto-completion and prompting at each step.
<div class="Pp"></div>
The value in the third step needs to be correctly quoted. innotop does not try
  to quote the value because it doesn't know whether it should treat the value
  as a string or a number. If you want to compare the column against a string,
  as for example in the first rule above, you should enter 'Locked' surrounded
  by quotes. If you get an error message about a bareword, you probably should
  have quoted something.
<h2 class="Ss" title="Ss" id="EXPRESSIONS"><a class="selflink" href="#EXPRESSIONS">EXPRESSIONS</a></h2>
Expressions are at the core of how innotop works, and are what enables you to
  extend innotop as you wish. Recall the table lifecycle explained in
  &quot;TABLES&quot;. Expressions are used in the earliest step, where it
  extracts values from a data source to form rows.
<div class="Pp"></div>
It does this by calling a subroutine for each column, passing it the source data
  set, a set of current values, and a set of previous values. These are all
  needed so the subroutine can calculate things like the difference between this
  tick and the previous tick.
<div class="Pp"></div>
The subroutines that extract the data from the set are compiled from
  expressions. This gives significantly more power than just naming the values
  to fill the columns, because it allows the column's value to be calculated
  from whatever data is necessary, but avoids the need to write complicated and
  lengthy Perl code.
<div class="Pp"></div>
innotop begins with a string of text that can look as simple as a value's name
  or as complicated as a full-fledged Perl expression. It looks at each
  'bareword' token in the string and decides whether it's supposed to be a key
  into the $set hash. A bareword is an unquoted value that isn't already
  surrounded by code-ish things like dollar signs or curly brackets. If innotop
  decides that the bareword isn't a function or other valid Perl code, it
  converts it into a hash access. After the whole string is processed, innotop
  compiles a subroutine, like this:
<div class="Pp"></div>
<pre>
 sub compute_column_value {
    my ( $set, $cur, $pre ) = @_;
    my $val = # EXPANDED STRING GOES HERE
    return $val;
 }
</pre>
<div class="Pp"></div>
Here's a concrete example, taken from the header table &quot;q_header&quot; in
  &quot;Q: Query List&quot; mode. This expression calculates the qps, or Queries
  Per Second, column's values, from the values returned by SHOW STATUS:
<div class="Pp"></div>
<pre>
 Questions/Uptime_hires
</pre>
<div class="Pp"></div>
innotop decides both words are barewords, and transforms this expression into
  the following Perl code:
<div class="Pp"></div>
<pre>
 $set-&gt;{Questions}/$set-&gt;{Uptime_hires}
</pre>
<div class="Pp"></div>
When surrounded by the rest of the subroutine's code, this is executable Perl
  that calculates a high-resolution queries-per-second value.
<div class="Pp"></div>
The arguments to the subroutine are named $set, $cur, and $pre. In most cases,
  $set and $cur will be the same values. However, if &quot;status_inc&quot; is
  set, $cur will not be the same as $set, because $set will already contain
  values that are the incremental difference between $cur and $pre.
<div class="Pp"></div>
Every column in innotop is computed by subroutines compiled in the same fashion.
  There is no difference between innotop's built-in columns and user-defined
  columns. This keeps things consistent and predictable.
<h2 class="Ss" title="Ss" id="TRANSFORMATIONS"><a class="selflink" href="#TRANSFORMATIONS">TRANSFORMATIONS</a></h2>
Transformations change how a value is rendered. For example, they can take a
  number of seconds and display it in H:M:S format. The following
  transformations are defined:
<dl class="Bl-tag">
  <dt class="It-tag">commify</dt>
  <dd class="It-tag">Adds commas to large numbers every three decimal
    places.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">dulint_to_int</dt>
  <dd class="It-tag">Accepts two unsigned integers and converts them into a
      single longlong. This is useful for certain operations with InnoDB, which
      uses two integers as transaction identifiers, for example.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">no_ctrl_char</dt>
  <dd class="It-tag">Removes quoted control characters from the value. This is
      affected by the &quot;charset&quot; configuration variable.
    <div style="height: 1.00em;">&#x00A0;</div>
    This transformation only operates within quoted strings, for example, values
      to a SET clause in an UPDATE statement. It will not alter the UPDATE
      statement, but will collapse the quoted string to [BINARY] or [TEXT],
      depending on the charset.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">percent</dt>
  <dd class="It-tag">Converts a number to a percentage by multiplying it by two,
      formatting it with &quot;num_digits&quot; digits after the decimal point,
      and optionally adding a percent sign (see &quot;show_percent&quot;).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">secs_to_time</dt>
  <dd class="It-tag">Formats a number of seconds as time in
      days+hours:minutes:seconds format.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">set_precision</dt>
  <dd class="It-tag">Formats numbers with &quot;num_digits&quot; number of
      digits after the decimal point.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">shorten</dt>
  <dd class="It-tag">Formats a number as a unit of 1024 (k/M/G/T) and with
      &quot;num_digits&quot; number of digits after the decimal point.</dd>
</dl>
<h2 class="Ss" title="Ss" id="TABLE_EDITOR"><a class="selflink" href="#TABLE_EDITOR">TABLE
  EDITOR</a></h2>
The innotop table editor lets you customize tables with keystrokes. You start
  the table editor with the '^' key. If there's more than one table on the
  screen, it will prompt you to choose one of them. Once you do, innotop will
  show you something like this:
<div class="Pp"></div>
<pre>
 Editing table definition for Buffer Pool.  Press ? for help, q to quit.
 
 name               hdr          label                  src          
 cxn                CXN          Connection from which  cxn          
 buf_pool_size      Size         Buffer pool size       IB_bp_buf_poo
 buf_free           Free Bufs    Buffers free in the b  IB_bp_buf_fre
 pages_total        Pages        Pages total            IB_bp_pages_t
 pages_modified     Dirty Pages  Pages modified (dirty  IB_bp_pages_m
 buf_pool_hit_rate  Hit Rate     Buffer pool hit rate   IB_bp_buf_poo
 total_mem_alloc    Memory       Total memory allocate  IB_bp_total_m
 add_pool_alloc     Add'l Pool   Additonal pool alloca  IB_bp_add_poo
</pre>
<div class="Pp"></div>
The first line shows which table you're editing, and reminds you again to press
  '?' for a list of key mappings. The rest is a tabular representation of the
  table's columns, because that's likely what you're trying to edit. However,
  you can edit more than just the table's columns; this screen can start the
  filter editor, color rule editor, and more.
<div class="Pp"></div>
Each row in the display shows a single column in the table you're editing, along
  with a couple of its properties such as its header and source expression (see
  &quot;EXPRESSIONS&quot;).
<div class="Pp"></div>
The key mappings are Vim-style, as in many other places. Pressing 'j' and 'k'
  moves the highlight up or down. You can then (d)elete or (e)dit the
  highlighted column. You can also (a)dd a column to the table. This actually
  just activates one of the columns already defined for the table; it prompts
  you to choose from among the columns available but not currently displayed.
  Finally, you can re-order the columns with the '+' and '-' keys.
<div class="Pp"></div>
You can do more than just edit the columns with the table editor, you can also
  edit other properties, such as the table's sort expression and group-by
  expression. Press '?' to see the full list, of course.
<div class="Pp"></div>
If you want to really customize and create your own column, as opposed to just
  activating a built-in one that's not currently displayed, press the (n)ew key,
  and innotop will prompt you for the information it needs:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The column name: this needs to be a word without any funny
      characters, e.g. just letters, numbers and underscores.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The column header: this is the label that appears at the
      top of the column, in the table header. This can have spaces and funny
      characters, but be careful not to make it too wide and waste space
      on-screen.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The column's data source: this is an expression that
      determines what data from the source (see &quot;TABLES&quot;) innotop will
      put into the column. This can just be the name of an item in the source,
      or it can be a more complex expression, as described in
      &quot;EXPRESSIONS&quot;.</dd>
</dl>
<div class="Pp"></div>
Once you've entered the required data, your table has a new column. There is no
  difference between this column and the built-in ones; it can have all the same
  properties and behaviors. innotop will write the column's definition to the
  configuration file, so it will persist across sessions.
<div class="Pp"></div>
Here's an example: suppose you want to track how many times your slaves have
  retried transactions. According to the MySQL manual, the
  Slave_retried_transactions status variable gives you that data: &quot;The
  total number of times since startup that the replication slave SQL thread has
  retried transactions. This variable was added in version 5.0.4.&quot; This is
  appropriate to add to the &quot;slave_sql_status&quot; table.
<div class="Pp"></div>
To add the column, switch to the replication-monitoring mode with the 'M' key,
  and press the '^' key to start the table editor. When prompted, choose
  slave_sql_status as the table, then press 'n' to create the column. Type
  'retries' as the column name, 'Retries' as the column header, and
  'Slave_retried_transactions' as the source. Now the column is created, and you
  see the table editor screen again. Press 'q' to exit the table editor, and
  you'll see your column at the end of the table.
<h1 class="Sh" title="Sh" id="VARIABLE_SETS"><a class="selflink" href="#VARIABLE_SETS">VARIABLE
  SETS</a></h1>
Variable sets are used in &quot;S: Variables &amp; Status&quot; mode to define
  more easily what variables you want to monitor. Behind the scenes they are
  compiled to a list of expressions, and then into a column list so they can be
  treated just like columns in any other table, in terms of data extraction and
  transformations. However, you're protected from the tedious details by a
  syntax that ought to feel very natural to you: a SQL SELECT list.
<div class="Pp"></div>
The data source for variable sets, and indeed the entire S mode, is the
  combination of SHOW STATUS, SHOW VARIABLES, and SHOW INNODB STATUS. Imagine
  that you had a huge table with one column per variable returned from those
  statements. That's the data source for variable sets. You can now query this
  data source just like you'd expect. For example:
<div class="Pp"></div>
<pre>
 Questions, Uptime, Questions/Uptime as QPS
</pre>
<div class="Pp"></div>
Behind the scenes innotop will split that variable set into three expressions,
  compile them and turn them into a table definition, then extract as usual.
  This becomes a &quot;variable set,&quot; or a &quot;list of variables you want
  to monitor.&quot;
<div class="Pp"></div>
innotop lets you name and save your variable sets, and writes them to the
  configuration file. You can choose which variable set you want to see with the
  'c' key, or activate the next and previous sets with the '&gt;' and '&lt;'
  keys. There are many built-in variable sets as well, which should give you a
  good start for creating your own. Press 'e' to edit the current variable set,
  or just to see how it's defined. To create a new one, just press 'c' and type
  its name.
<div class="Pp"></div>
You may want to use some of the functions listed in &quot;TRANSFORMATIONS&quot;
  to help format the results. In particular, &quot;set_precision&quot; is often
  useful to limit the number of digits you see. Extending the above example,
  here's how:
<div class="Pp"></div>
<pre>
 Questions, Uptime, set_precision(Questions/Uptime) as QPS
</pre>
<div class="Pp"></div>
Actually, this still needs a little more work. If your &quot;interval&quot; is
  less than one second, you might be dividing by zero because Uptime is
  incremental in this mode by default. Instead, use Uptime_hires:
<div class="Pp"></div>
<pre>
 Questions, Uptime, set_precision(Questions/Uptime_hires) as QPS
</pre>
<div class="Pp"></div>
This example is simple, but it shows how easy it is to choose which variables
  you want to monitor.
<h1 class="Sh" title="Sh" id="PLUGINS"><a class="selflink" href="#PLUGINS">PLUGINS</a></h1>
innotop has a simple but powerful plugin mechanism by which you can extend or
  modify its existing functionality, and add new functionality. innotop's plugin
  functionality is event-based: plugins register themselves to be called when
  events happen. They then have a chance to influence the event.
<div class="Pp"></div>
An innotop plugin is a Perl module placed in innotop's &quot;plugin_dir&quot;
  directory. On UNIX systems, you can place a symbolic link to the module
  instead of putting the actual file there. innotop automatically discovers the
  file. If there is a corresponding entry in the &quot;plugins&quot;
  configuration file section, innotop loads and activates the plugin.
<div class="Pp"></div>
The module must conform to innotop's plugin interface. Additionally, the source
  code of the module must be written in such a way that innotop can inspect the
  file and determine the package name and description.
<h2 class="Ss" title="Ss" id="Package_Source_Convention"><a class="selflink" href="#Package_Source_Convention">Package
  Source Convention</a></h2>
innotop inspects the plugin module's source to determine the Perl package name.
  It looks for a line of the form &quot;package Foo;&quot; and if found,
  considers the plugin's package name to be Foo. Of course the package name can
  be a valid Perl package name, with double semicolons and so on.
<div class="Pp"></div>
It also looks for a description in the source code, to make the plugin editor
  more human-friendly. The description is a comment line of the form &quot;#
  description: Foo&quot;, where &quot;Foo&quot; is the text innotop will
  consider to be the plugin's description.
<h2 class="Ss" title="Ss" id="Plugin_Interface"><a class="selflink" href="#Plugin_Interface">Plugin
  Interface</a></h2>
The innotop plugin interface is quite simple: innotop expects the plugin to be
  an object-oriented module it can call certain methods on. The methods are
<dl class="Bl-tag">
  <dt class="It-tag">new(%variables)</dt>
  <dd class="It-tag">This is the plugin's constructor. It is passed a hash of
      innotop's variables, which it can manipulate (see &quot;Plugin
      Variables&quot;). It must return a reference to the newly created plugin
      object.
    <div style="height: 1.00em;">&#x00A0;</div>
    At construction time, innotop has only loaded the general configuration and
      created the default built-in variables with their default contents (which
      is quite a lot). Therefore, the state of the program is exactly as in the
      innotop source code, plus the configuration variables from the
      &quot;general&quot; section in the config file.
    <div style="height: 1.00em;">&#x00A0;</div>
    If your plugin manipulates the variables, it is changing global data, which
      is shared by innotop and all plugins. Plugins are loaded in the order
      they're listed in the config file. Your plugin may load before or after
      another plugin, so there is a potential for conflict or interaction
      between plugins if they modify data other plugins use or modify.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>register_for_events()</i></dt>
  <dd class="It-tag">This method must return a list of events in which the
      plugin is interested, if any. See &quot;Plugin Events&quot; for the
      defined events. If the plugin returns an event that's not defined, the
      event is ignored.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">event handlers</dt>
  <dd class="It-tag">The plugin must implement a method named the same as each
      event for which it has registered. In other words, if the plugin returns
      qw(foo bar) from <i>register_for_events()</i>, it must have <i>foo()</i>
      and <i>bar()</i> methods. These methods are callbacks for the events. See
      &quot;Plugin Events&quot; for more details about each event.</dd>
</dl>
<h2 class="Ss" title="Ss" id="Plugin_Variables"><a class="selflink" href="#Plugin_Variables">Plugin
  Variables</a></h2>
The plugin's constructor is passed a hash of innotop's variables, which it can
  manipulate. It is probably a good idea if the plugin object saves a copy of it
  for later use. The variables are defined in the innotop variable
  %pluggable_vars, and are as follows:
<dl class="Bl-tag">
  <dt class="It-tag">action_for</dt>
  <dd class="It-tag">A hashref of key mappings. These are innotop's global
      hot-keys.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">agg_funcs</dt>
  <dd class="It-tag">A hashref of functions that can be used for grouping. See
      &quot;GROUPING&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">config</dt>
  <dd class="It-tag">The global configuration hash.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">connections</dt>
  <dd class="It-tag">A hashref of connection specifications. These are just
      specifications of how to connect to a server.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">dbhs</dt>
  <dd class="It-tag">A hashref of innotop's database connections. These are
      actual DBI connection objects.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">filters</dt>
  <dd class="It-tag">A hashref of filters applied to table rows. See
      &quot;FILTERS&quot; for more.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">modes</dt>
  <dd class="It-tag">A hashref of modes. See &quot;MODES&quot; for more.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">server_groups</dt>
  <dd class="It-tag">A hashref of server groups. See &quot;SERVER
    GROUPS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">tbl_meta</dt>
  <dd class="It-tag">A hashref of innotop's table meta-data, with one entry per
      table (see &quot;TABLES&quot; for more information).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">trans_funcs</dt>
  <dd class="It-tag">A hashref of transformation functions. See
      &quot;TRANSFORMATIONS&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">var_sets</dt>
  <dd class="It-tag">A hashref of variable sets. See &quot;VARIABLE
    SETS&quot;.</dd>
</dl>
<h2 class="Ss" title="Ss" id="Plugin_Events"><a class="selflink" href="#Plugin_Events">Plugin
  Events</a></h2>
Each event is defined somewhere in the innotop source code. When innotop runs
  that code, it executes the callback function for each plugin that expressed
  its interest in the event. innotop passes some data for each event. The events
  are defined in the %event_listener_for variable, and are as follows:
<dl class="Bl-tag">
  <dt class="It-tag">extract_values($set, $cur, $pre, $tbl)</dt>
  <dd class="It-tag">This event occurs inside the function that extracts values
      from a data source. The arguments are the set of values, the current
      values, the previous values, and the table name.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">set_to_tbl</dt>
  <dd class="It-tag">Events are defined at many places in this subroutine, which
      is responsible for turning an arrayref of hashrefs into an arrayref of
      lines that can be printed to the screen. The events all pass the same
      data: an arrayref of rows and the name of the table being created. The
      events are set_to_tbl_pre_filter,
      set_to_tbl_pre_sort,set_to_tbl_pre_group, set_to_tbl_pre_colorize,
      set_to_tbl_pre_transform, set_to_tbl_pre_pivot, set_to_tbl_pre_create,
      set_to_tbl_post_create.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">draw_screen($lines)</dt>
  <dd class="It-tag">This event occurs inside the subroutine that prints the
      lines to the screen. $lines is an arrayref of strings.</dd>
</dl>
<h2 class="Ss" title="Ss" id="Simple_Plugin_Example"><a class="selflink" href="#Simple_Plugin_Example">Simple
  Plugin Example</a></h2>
The easiest way to explain the plugin functionality is probably with a simple
  example. The following module adds a column to the beginning of every table
  and sets its value to 1.
<div class="Pp"></div>
<pre>
 use strict;
 use warnings FATAL =&gt; 'all';
 
 package Innotop::Plugin::Example;
 # description: Adds an 'example' column to every table
 
 sub new {
    my ( $class, %vars ) = @_;
    # Store reference to innotop's variables in $self
    my $self = bless { %vars }, $class;
 
    # Design the example column
    my $col = {
       hdr   =&gt; 'Example',
       just  =&gt; '',
       dec   =&gt; 0,
       num   =&gt; 1,
       label =&gt; 'Example',
       src   =&gt; 'example', # Get data from this column in the data source
       tbl   =&gt; '',
       trans =&gt; [],
    };
 
    # Add the column to every table.
    my $tbl_meta = $vars{tbl_meta};
    foreach my $tbl ( values %$tbl_meta ) {
       # Add the column to the list of defined columns
       $tbl-&gt;{cols}-&gt;{example} = $col;
       # Add the column to the list of visible columns
       unshift @{$tbl-&gt;{visible}}, 'example';
    }
 
    # Be sure to return a reference to the object.
    return $self;
 }
 
 # I'd like to be called when a data set is being rendered into a table, please.
 sub register_for_events {
    my ( $self ) = @_;
    return qw(set_to_tbl_pre_filter);
 }
 
 # This method will be called when the event fires.
 sub set_to_tbl_pre_filter {
    my ( $self, $rows, $tbl ) = @_;
    # Set the example column's data source to the value 1.
    foreach my $row ( @$rows ) {
       $row-&gt;{example} = 1;
    }
 }
 
 1;
</pre>
<h2 class="Ss" title="Ss" id="Plugin_Editor"><a class="selflink" href="#Plugin_Editor">Plugin
  Editor</a></h2>
The plugin editor lets you view the plugins innotop discovered and activate or
  deactivate them. Start the editor by pressing $ to start the configuration
  editor from any mode. Press the 'p' key to start the plugin editor. You'll see
  a list of plugins innotop discovered. You can use the 'j' and 'k' keys to move
  the highlight to the desired one, then press the * key to toggle it active or
  inactive. Exit the editor and restart innotop for the changes to take effect.
<h1 class="Sh" title="Sh" id="SQL_STATEMENTS"><a class="selflink" href="#SQL_STATEMENTS">SQL
  STATEMENTS</a></h1>
innotop uses a limited set of SQL statements to retrieve data from MySQL for
  display. The statements are customized depending on the server version against
  which they are executed; for example, on MySQL 5 and newer, INNODB_STATUS
  executes &quot;SHOW ENGINE INNODB STATUS&quot;, while on earlier versions it
  executes &quot;SHOW INNODB STATUS&quot;. The statements are as follows:
<div class="Pp"></div>
<pre>
 Statement           SQL executed
 =================== ===============================
 INNODB_STATUS       SHOW [ENGINE] INNODB STATUS
 KILL_CONNECTION     KILL
 KILL_QUERY          KILL QUERY
 OPEN_TABLES         SHOW OPEN TABLES
 PROCESSLIST         SHOW FULL PROCESSLIST
 SHOW_MASTER_LOGS    SHOW MASTER LOGS
 SHOW_MASTER_STATUS  SHOW MASTER STATUS
 SHOW_SLAVE_STATUS   SHOW SLAVE STATUS
 SHOW_STATUS         SHOW [GLOBAL] STATUS
 SHOW_VARIABLES      SHOW [GLOBAL] VARIABLES
</pre>
<h1 class="Sh" title="Sh" id="DATA_SOURCES"><a class="selflink" href="#DATA_SOURCES">DATA
  SOURCES</a></h1>
Each time innotop extracts values to create a table (see &quot;EXPRESSIONS&quot;
  and &quot;TABLES&quot;), it does so from a particular data source. Largely
  because of the complex data extracted from SHOW INNODB STATUS, this is
  slightly messy. SHOW INNODB STATUS contains a mixture of single values and
  repeated values that form nested data sets.
<div class="Pp"></div>
Whenever innotop fetches data from MySQL, it adds two extra bits to each set:
  cxn and Uptime_hires. cxn is the name of the connection from which the data
  came. Uptime_hires is a high-resolution version of the server's Uptime status
  variable, which is important if your &quot;interval&quot; setting is
  sub-second.
<div class="Pp"></div>
Here are the kinds of data sources from which data is extracted:
<dl class="Bl-tag">
  <dt class="It-tag">STATUS_VARIABLES</dt>
  <dd class="It-tag">This is the broadest category, into which the most kinds of
      data fall. It begins with the combination of SHOW STATUS and SHOW
      VARIABLES, but other sources may be included as needed, for example, SHOW
      MASTER STATUS and SHOW SLAVE STATUS, as well as many of the non-repeated
      values from SHOW INNODB STATUS.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">DEADLOCK_LOCKS</dt>
  <dd class="It-tag">This data is extracted from the transaction list in the
      LATEST DETECTED DEADLOCK section of SHOW INNODB STATUS. It is nested two
      levels deep: transactions, then locks.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">DEADLOCK_TRANSACTIONS</dt>
  <dd class="It-tag">This data is from the transaction list in the LATEST
      DETECTED DEADLOCK section of SHOW INNODB STATUS. It is nested one level
      deep.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">EXPLAIN</dt>
  <dd class="It-tag">This data is from the result set returned by EXPLAIN.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">INNODB_TRANSACTIONS</dt>
  <dd class="It-tag">This data is from the TRANSACTIONS section of SHOW INNODB
      STATUS.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">IO_THREADS</dt>
  <dd class="It-tag">This data is from the list of threads in the the FILE I/O
      section of SHOW INNODB STATUS.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">INNODB_LOCKS</dt>
  <dd class="It-tag">This data is from the TRANSACTIONS section of SHOW INNODB
      STATUS and is nested two levels deep.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">OPEN_TABLES</dt>
  <dd class="It-tag">This data is from SHOW OPEN TABLES.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">PROCESSLIST</dt>
  <dd class="It-tag">This data is from SHOW FULL PROCESSLIST.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">OS_WAIT_ARRAY</dt>
  <dd class="It-tag">This data is from the SEMAPHORES section of SHOW INNODB
      STATUS and is nested one level deep. It comes from the lines that look
      like this:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
 --Thread 1568861104 has waited at btr0cur.c line 424 ....
    </pre>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="MYSQL_PRIVILEGES"><a class="selflink" href="#MYSQL_PRIVILEGES">MYSQL
  PRIVILEGES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">You must connect to MySQL as a user who has the SUPER
      privilege for many of the functions.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">If you don't have the SUPER privilege, you can still run
      some functions, but you won't necessarily see all the same data.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">You need the PROCESS privilege to see the list of currently
      running queries in Q mode.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">You need special privileges to start and stop slave
      servers.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">You need appropriate privileges to create and drop the
      deadlock tables if needed (see &quot;SERVER CONNECTIONS&quot;).</dd>
</dl>
<h1 class="Sh" title="Sh" id="SYSTEM_REQUIREMENTS"><a class="selflink" href="#SYSTEM_REQUIREMENTS">SYSTEM
  REQUIREMENTS</a></h1>
You need Perl to run innotop, of course. You also need a few Perl modules: DBI,
  DBD::mysql, Term::ReadKey, and Time::HiRes. These should be included with most
  Perl distributions, but in case they are not, I recommend using versions
  distributed with your operating system or Perl distribution, not from CPAN.
  Term::ReadKey in particular has been known to cause problems if installed from
  CPAN.
<div class="Pp"></div>
If you have Term::ANSIColor, innotop will use it to format headers more readably
  and compactly. (Under Microsoft Windows, you also need Win32::Console::ANSI
  for terminal formatting codes to be honored). If you install Term::ReadLine,
  preferably Term::ReadLine::Gnu, you'll get nice auto-completion support.
<div class="Pp"></div>
I run innotop on Gentoo GNU/Linux, Debian and Ubuntu, and I've had feedback from
  people successfully running it on Red Hat, CentOS, Solaris, and Mac OSX. I
  don't see any reason why it won't work on other UNIX-ish operating systems,
  but I don't know for sure. It also runs on Windows under ActivePerl without
  problem.
<div class="Pp"></div>
innotop has been used on MySQL versions 3.23.58, 4.0.27, 4.1.0, 4.1.22, 5.0.26,
  5.1.15, and 5.2.3. If it doesn't run correctly for you, that is a bug that
  should be reported.
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
$HOMEDIR/.innotop and/or /etc/innotop are used to store configuration
  information. Files include the configuration file innotop.conf, the core_dump
  file which contains verbose error messages if &quot;debug&quot; is enabled,
  and the plugins/ subdirectory.
<h1 class="Sh" title="Sh" id="GLOSSARY_OF_TERMS"><a class="selflink" href="#GLOSSARY_OF_TERMS">GLOSSARY
  OF TERMS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag">tick</dt>
  <dd class="It-tag">A tick is a refresh event, when innotop re-fetches data
      from connections and displays it.</dd>
</dl>
<h1 class="Sh" title="Sh" id="ACKNOWLEDGEMENTS"><a class="selflink" href="#ACKNOWLEDGEMENTS">ACKNOWLEDGEMENTS</a></h1>
The following people and organizations are acknowledged for various reasons.
  Hopefully no one has been forgotten.
<div class="Pp"></div>
Allen K. Smith, Aurimas Mikalauskas, Bartosz Fenski, Brian Miezejewski,
  Christian Hammers, Cyril Scetbon, Dane Miller, David Multer, Dr. Frank
  Ullrich, Giuseppe Maxia, Google.com Site Reliability Engineers, Google Code,
  Jan Pieter Kunst, Jari Aalto, Jay Pipes, Jeremy Zawodny, Johan Idren, Kristian
  Kohntopp, Lenz Grimmer, Maciej Dobrzanski, Michiel Betel, MySQL AB, Paul
  McCullagh, Sebastien Estienne, Sourceforge.net, Steven Kreuzer, The Gentoo
  MySQL Team, Trevor Price, Yaar Schnitman, and probably more people that have
  not been included.
<div class="Pp"></div>
(If your name has been misspelled, it's probably out of fear of putting
  international characters into this documentation; earlier versions of Perl
  might not be able to compile it then).
<h1 class="Sh" title="Sh" id="COPYRIGHT,_LICENSE_AND_WARRANTY"><a class="selflink" href="#COPYRIGHT,_LICENSE_AND_WARRANTY">COPYRIGHT,
  LICENSE AND WARRANTY</a></h1>
This program is copyright (c) 2006 Baron Schwartz. Feedback and improvements are
  welcome.
<div class="Pp"></div>
THIS PROGRAM IS PROVIDED &quot;AS IS&quot; AND WITHOUT ANY EXPRESS OR IMPLIED
  WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF
  MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.
<div class="Pp"></div>
This program is free software; you can redistribute it and/or modify it under
  the terms of the GNU General Public License as published by the Free Software
  Foundation, version 2; OR the Perl Artistic License. On UNIX and similar
  systems, you can issue `man perlgpl' or `man perlartistic' to read these
  licenses.
<div class="Pp"></div>
You should have received a copy of the GNU General Public License along with
  this program; if not, write to the Free Software Foundation, Inc., 59 Temple
  Place, Suite 330, Boston, MA 02111-1307 USA.
<div class="Pp"></div>
Execute innotop and press '!' to see this information at any time.
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Originally written by Baron Schwartz; currently maintained by Aaron Racine.
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
You can report bugs, ask for improvements, and get other help and support at
  &lt;http://code.google.com/p/innotop/&gt;. There are mailing lists, a source
  code browser, a bug tracker, etc. Please use these instead of contacting the
  maintainer or author directly, as it makes our job easier and benefits others
  if the discussions are permanent and public. Of course, if you need to contact
  us in private, please do.</div>
<table class="foot">
  <tr>
    <td class="foot-date">2009-03-09</td>
    <td class="foot-os">perl v5.10.0</td>
  </tr>
</table>
</body>
</html>
