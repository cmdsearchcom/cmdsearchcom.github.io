<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:31:35 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>PIDL(1) Samba Documentation PIDL(1)</p>

<p style="margin-top: 1em">NAME <br>
pidl - An IDL compiler written in Perl</p>

<p style="margin-top: 1em">SYNOPSIS <br>
pidl --help</p>

<p style="margin-top: 1em">pidl [--outputdir[=OUTNAME]]
[--includedir DIR...] [--parse-idl-tree] [--dump-idl-tree]
[--dump-ndr-tree] [--header[=OUTPUT]] [--python[=OUTPUT]]
[--ndr-parser[=OUTPUT]] <br>
[--client] [--server] [--warn-compat] [--quiet] [--verbose]
[--template] [--ws-parser[=OUTPUT]] [--diff] [--dump-idl]
[--tdr-parser[=OUTPUT]] [--samba3-ndr-client[=OUTPUT]] <br>
[--samba3-ndr-server[=OUTPUT]] [--typelib=[OUTPUT]]
[&lt;idlfile&gt;.idl]...</p>

<p style="margin-top: 1em">DESCRIPTION <br>
pidl is an IDL compiler written in Perl that aims to be
somewhat compatible with the midl compiler. IDL is short for
&quot;Interface Definition Language&quot;.</p>

<p style="margin-top: 1em">pidl can generate stubs for
DCE/RPC server code, DCE/RPC client code and Wireshark
dissectors for DCE/RPC traffic.</p>

<p style="margin-top: 1em">IDL compilers like pidl take a
description of an interface as their input and use it to
generate C (though support for other languages may be added
later) code that can use these <br>
interfaces, pretty print data sent using these interfaces,
or even generate Wireshark dissectors that can parse data
sent over the wire by these interfaces.</p>

<p style="margin-top: 1em">pidl takes IDL files in the same
format as is used by midl, converts it to a .pidl file
(which contains pidl&rsquo;s internal representation of the
interface) and can then generate <br>
whatever output you need. .pidl files should be used for
debugging purposes only. Write your interface definitions in
.idl format.</p>

<p style="margin-top: 1em">The goal of pidl is to implement
a IDL compiler that can be used while developing the RPC
subsystem in Samba (for both marshalling/unmarshalling and
debugging purposes).</p>

<p style="margin-top: 1em">OPTIONS <br>
--help <br>
Show list of available options.</p>

<p style="margin-top: 1em">--version <br>
Show pidl version</p>

<p style="margin-top: 1em">--outputdir OUTNAME <br>
Write output files to the specified directory. Defaults to
the current directory.</p>

<p style="margin-top: 1em">--includedir DIR <br>
Add DIR to the search path used by the preprocessor. This
option can be specified multiple times.</p>

<p style="margin-top: 1em">--parse-idl-tree <br>
Read internal tree structure from input files rather than
assuming they contain IDL.</p>

<p style="margin-top: 1em">--dump-idl <br>
Generate a new IDL file. File will be named OUTNAME.idl.</p>

<p style="margin-top: 1em">--header <br>
Generate a C header file for the specified interface.
Filename defaults to OUTNAME.h.</p>

<p style="margin-top: 1em">--ndr-parser <br>
Generate a C file and C header containing NDR parsers. The
filename for the parser defaults to ndr_OUTNAME.c. The
header filename will be the parser filename with the <br>
extension changed from .c to .h.</p>

<p style="margin-top: 1em">--tdr-parser <br>
Generate a C file and C header containing TDR parsers. The
filename for the parser defaults to tdr_OUTNAME.c. The
header filename will be the parser filename with the <br>
extension changed from .c to .h.</p>

<p style="margin-top: 1em">--typelib <br>
Write type information to the specified file.</p>

<p style="margin-top: 1em">--server <br>
Generate boilerplate for the RPC server that implements the
interface. Filename defaults to ndr_OUTNAME_s.c.</p>

<p style="margin-top: 1em">--template <br>
Generate stubs for a RPC server that implements the
interface. Output will be written to stdout.</p>

<p style="margin-top: 1em">--ws-parser <br>
Generate an Wireshark dissector (in C) and header file. The
dissector filename defaults to packet-dcerpc-OUTNAME.c while
the header filename defaults to <br>
packet-dcerpc-OUTNAME.h.</p>

<p style="margin-top: 1em">Pidl will read additional data
from an Wireshark conformance file if present. Such a file
should have the same location as the IDL file but with the
extension cnf rather <br>
than idl. See Parse::Pidl::Wireshark::Conformance for
details on the format of this file.</p>

<p style="margin-top: 1em">--diff <br>
Parse an IDL file, generate a new IDL file based on the
internal data structures and see if there are any
differences with the original IDL file. Useful for debugging
pidl.</p>

<p style="margin-top: 1em">--dump-idl-tree <br>
Tell pidl to dump the internal tree representation of an IDL
file the to disk. Useful for debugging pidl.</p>

<p style="margin-top: 1em">--dump-ndr-tree <br>
Tell pidl to dump the internal NDR information tree it
generated from the IDL file to disk. Useful for debugging
pidl.</p>

<p style="margin-top: 1em">--samba3-ndr-client <br>
Generate client calls for Samba3, to be placed in
rpc_client/. Instead of calling out to the code in
Samba3&rsquo;s rpc_parse/, this will call out to
Samba4&rsquo;s NDR code instead.</p>

<p style="margin-top: 1em">--samba3-ndr-server <br>
Generate server calls for Samba3, to be placed in
rpc_server/. Instead of calling out to the code in
Samba3&rsquo;s rpc_parse/, this will call out to
Samba4&rsquo;s NDR code instead.</p>

<p style="margin-top: 1em">IDL SYNTAX <br>
IDL files are always preprocessed using the C
preprocessor.</p>

<p style="margin-top: 1em">Pretty much everything in an
interface (the interface itself, functions, parameters) can
have attributes (or properties whatever name you give them).
Attributes always prepend <br>
the element they apply to and are surrounded by square
brackets ([]). Multiple attributes are separated by
comma&rsquo;s; arguments to attributes are specified between
parentheses.</p>

<p style="margin-top: 1em">See the section COMPATIBILITY
for the list of attributes that pidl supports.</p>

<p style="margin-top: 1em">C-style comments can be
used.</p>

<p style="margin-top: 1em">CONFORMANT ARRAYS <br>
A conformant array is one with that ends in [*] or []. The
strange things about conformant arrays are that they can
only appear as the last element of a structure (unless there
<br>
is a pointer to the conformant array, of course) and the
array size appears before the structure itself on the
wire.</p>

<p style="margin-top: 1em">So, in this example:</p>

<p style="margin-top: 1em">typedef struct { <br>
long abc; <br>
long count; <br>
long foo; <br>
[size_is(count)] long s[*]; <br>
} Struct1;</p>

<p style="margin-top: 1em">it appears like this:</p>

<p style="margin-top: 1em">[size_is] [abc] [count] [foo]
[s...]</p>

<p style="margin-top: 1em">the first [size_is] field is the
allocation size of the array, and occurs before the array
elements and even before the structure alignment.</p>

<p style="margin-top: 1em">Note that size_is() can refer to
a constant, but that doesn&rsquo;t change the wire
representation. It does not make the array a fixed
array.</p>

<p style="margin-top: 1em">midl.exe would write the above
array as the following C header:</p>

<p style="margin-top: 1em">typedef struct { <br>
long abc; <br>
long count; <br>
long foo; <br>
long s[1]; <br>
} Struct1;</p>

<p style="margin-top: 1em">pidl takes a different approach,
and writes it like this:</p>

<p style="margin-top: 1em">typedef struct { <br>
long abc; <br>
long count; <br>
long foo; <br>
long *s; <br>
} Struct1;</p>

<p style="margin-top: 1em">VARYING ARRAYS <br>
A varying array looks like this:</p>

<p style="margin-top: 1em">typedef struct { <br>
long abc; <br>
long count; <br>
long foo; <br>
[size_is(count)] long *s; <br>
} Struct1;</p>

<p style="margin-top: 1em">This will look like this on the
wire:</p>

<p style="margin-top: 1em">[abc] [count] [foo] [PTR_s]
[count] [s...]</p>

<p style="margin-top: 1em">FIXED ARRAYS <br>
A fixed array looks like this:</p>

<p style="margin-top: 1em">typedef struct { <br>
long s[10]; <br>
} Struct1;</p>

<p style="margin-top: 1em">The NDR representation looks
just like 10 separate long declarations. The array size is
not encoded on the wire.</p>

<p style="margin-top: 1em">pidl also supports
&quot;inline&quot; arrays, which are not part of the IDL/NDR
standard. These are declared like this:</p>

<p style="margin-top: 1em">typedef struct { <br>
uint32 foo; <br>
uint32 count; <br>
uint32 bar; <br>
long s[count]; <br>
} Struct1;</p>

<p style="margin-top: 1em">This appears like this:</p>

<p style="margin-top: 1em">[foo] [count] [bar] [s...]</p>

<p style="margin-top: 1em">Fixed arrays are an extension
added to support some of the strange embedded structures in
security descriptors and spoolss.</p>

<p style="margin-top: 1em">This section is by no means
complete. See the OpenGroup and MSDN documentation for
additional information.</p>

<p style="margin-top: 1em">COMPATIBILITY WITH MIDL <br>
Missing features in pidl <br>
The following MIDL features are not (yet) implemented in
pidl or are implemented with an incompatible interface:</p>

<p style="margin-top: 1em">&Acirc;&middot; Asynchronous
communication</p>

<p style="margin-top: 1em">&Acirc;&middot; Typelibs (.tlb
files)</p>

<p style="margin-top: 1em">&Acirc;&middot; Datagram support
(ncadg_*)</p>

<p style="margin-top: 1em">Supported attributes and
statements <br>
in, out, ref, length_is, switch_is, size_is, uuid, case,
default, string, unique, ptr, pointer_default, v1_enum,
object, helpstring, range, local, call_as, endpoint,
switch_type, <br>
progid, coclass, iid_is, represent_as, transmit_as, import,
include, cpp_quote.</p>

<p style="margin-top: 1em">PIDL Specific properties <br>
public <br>
The [public] property on a structure or union is a pidl
extension that forces the generated pull/push functions to
be non-static. This allows you to declare types that can be
<br>
used between modules. If you don&rsquo;t specify [public]
then pull/push functions for other than top-level functions
are declared static.</p>

<p style="margin-top: 1em">noprint <br>
The [noprint] property is a pidl extension that allows you
to specify that pidl should not generate a ndr_print_*()
function for that structure or union. This is used when <br>
you wish to define your own print function that prints a
structure in a nicer manner. A good example is the use of
[noprint] on dom_sid, which allows the pretty-printing of
<br>
SIDs.</p>

<p style="margin-top: 1em">value <br>
The [value(expression)] property is a pidl extension that
allows you to specify the value of a field when it is put on
the wire. This allows fields that always have a well- <br>
known value to be automatically filled in, thus making the
API more programmer friendly. The expression can be any C
expression.</p>

<p style="margin-top: 1em">relative <br>
The [relative] property can be supplied on a pointer. When
it is used it declares the pointer as a spoolss style
&quot;relative&quot; pointer, which means it appears on the
wire as an <br>
offset within the current encapsulating structure. This is
not part of normal IDL/NDR, but it is a very useful
extension as it avoids the manual encoding of many complex
<br>
structures.</p>

<p style="margin-top: 1em">subcontext(length) <br>
Specifies that a size of length bytes should be read,
followed by a blob of that size, which will be parsed as
NDR.</p>

<p style="margin-top: 1em">subcontext() is deprecated now,
and should not be used in new code. Instead, use
represent_as() or transmit_as().</p>

<p style="margin-top: 1em">flag <br>
Specify boolean options, mostly used for low-level NDR
options. Several options can be specified using the |
character. Note that flags are inherited by
substructures!</p>

<p style="margin-top: 1em">nodiscriminant <br>
The [nodiscriminant] property on a union means that the
usual uint16 discriminent field at the start of the union on
the wire is omitted. This is not normally allowed in <br>
IDL/NDR, but is used for some spoolss structures.</p>

<p style="margin-top: 1em">charset(name) <br>
Specify that the array or string uses the specified charset.
If this attribute is specified, pidl will take care of
converting the character data from this format to the host
<br>
format. Commonly used values are UCS2, DOS and UTF8.</p>

<p style="margin-top: 1em">Unsupported MIDL properties or
statements <br>
aggregatable, appobject, async_uuid, bindable, control,
defaultbind, defaultcollelem, defaultvalue, defaultvtable,
dispinterface, displaybind, dual, entry, first_is,
helpcontext, <br>
helpfile, helpstringcontext, helpstringdll, hidden,
idl_module, idl_quote, id, immediatebind, importlib,
includelib, last_is, lcid, licensed, max_is, module,
ms_union, <br>
no_injected_text, nonbrowsable, noncreatable, nonextensible,
odl, oleautomation, optional, pragma, propget, propputref,
propput, readonly, requestedit, restricted, retval, <br>
source, uidefault, usesgetlasterror, vararg, vi_progid,
wire_marshal.</p>

<p style="margin-top: 1em">EXAMPLES <br>
# Generating an Wireshark parser <br>
$ ./pidl --ws-parser -- atsvc.idl</p>

<p style="margin-top: 1em"># Generating a TDR parser and
header <br>
$ ./pidl --tdr-parser --header -- regf.idl</p>

<p style="margin-top: 1em"># Generating a Samba3 client and
server <br>
$ ./pidl --samba3-ndr-client --samba3-ndr-server --
dfs.idl</p>

<p style="margin-top: 1em"># Generating a Samba4 NDR
parser, client and server <br>
$ ./pidl --ndr-parser --ndr-client --ndr-server --
samr.idl</p>

<p style="margin-top: 1em">SEE ALSO <br>

&lt;http://msdn.microsoft.com/library/en-us/rpc/rpc/field_attributes.asp&gt;,
&lt;http://wiki.wireshark.org/DCE/RPC&gt;,
&lt;http://www.samba.org/&gt;, yapp(1)</p>

<p style="margin-top: 1em">LICENSE <br>
pidl is licensed under the GNU General Public License
&lt;http://www.gnu.org/licenses/gpl.html&gt;.</p>

<p style="margin-top: 1em">AUTHOR <br>
pidl was written by Andrew Tridgell, Stefan Metzmacher, Tim
Potter and Jelmer Vernooij. The current maintainer is Jelmer
Vernooij.</p>

<p style="margin-top: 1em">This manpage was written by
Jelmer Vernooij, partially based on the original pidl README
by Andrew Tridgell.</p>

<p style="margin-top: 1em">perl v5.16.3 2016-01-26
PIDL(1)</p>
<hr>
</body>
</html>
