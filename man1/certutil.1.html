<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>CERTUTIL(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">CERTUTIL(1)</td>
    <td class="head-vol">NSS Security Tools</td>
    <td class="head-rtitle">CERTUTIL(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
certutil - Manage keys and certificate in both NSS databases and other NSS
  tokens
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div class="Pp" style="margin-left: 9.00ex; text-indent: -9.00ex;"><b>certutil</b>
  [ <i>options</i>] [[<i>arguments</i>]]</div>
<h1 class="Sh" title="Sh" id="STATUS"><a class="selflink" href="#STATUS">STATUS</a></h1>
This documentation is still work in progress. Please contribute to the initial
  review in <b>Mozilla NSS bug 836477</b>[1]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The Certificate Database Tool, <b>certutil</b>, is a command-line utility that
  can create and modify certificate and key databases. It can specifically list,
  generate, modify, or delete certificates, create or change the password,
  generate new public and private key pairs, display the contents of the key
  database, or delete key pairs within the key database.
<div class="Pp"></div>
Certificate issuance, part of the key and certificate management process,
  requires that keys and certificates be created in the key database. This
  document discusses certificate and key database management. For information on
  the security module database management, see the <b>modutil</b> manpage.
<h1 class="Sh" title="Sh" id="COMMAND_OPTIONS_AND_ARGUMENTS"><a class="selflink" href="#COMMAND_OPTIONS_AND_ARGUMENTS">COMMAND
  OPTIONS AND ARGUMENTS</a></h1>
Running <b>certutil</b> always requires one and only one command option to
  specify the type of certificate operation. Each command option may take zero
  or more arguments. The command option <b>-H</b> will list all the command
  options and their relevant arguments.
<div class="Pp"></div>
<b>Command Options</b>
<div class="Pp"></div>
-A
<div style="margin-left: 4.00ex;">Add an existing certificate to a certificate
  database. The certificate database should already exist; if one is not
  present, this command option will initialize one by default.</div>
<div class="Pp"></div>
-B
<div style="margin-left: 4.00ex;">Run a series of commands from the specified
  batch file. This requires the <b>-i</b> argument.</div>
<div class="Pp"></div>
-C
<div style="margin-left: 4.00ex;">Create a new binary certificate file from a
  binary certificate request file. Use the <b>-i</b> argument to specify the
  certificate request file. If this argument is not used, <b>certutil</b>
  prompts for a filename.</div>
<div class="Pp"></div>
-D
<div style="margin-left: 4.00ex;">Delete a certificate from the certificate
  database.</div>
<div class="Pp"></div>
--rename
<div style="margin-left: 4.00ex;">Change the database nickname of a
  certificate.</div>
<div class="Pp"></div>
-E
<div style="margin-left: 4.00ex;">Add an email certificate to the certificate
  database.</div>
<div class="Pp"></div>
-F
<div style="margin-left: 4.00ex;">Delete a private key from a key database.
  Specify the key to delete with the -n argument. Specify the database from
  which to delete the key with the <b>-d</b> argument. Use the <b>-k</b>
  argument to specify explicitly whether to delete a DSA, RSA, or ECC key. If
  you don't use the <b>-k</b> argument, the option looks for an RSA key matching
  the specified nickname.
<div style="height: 1.00em;">&#x00A0;</div>
When you delete keys, be sure to also remove any certificates associated with
  those keys from the certificate database, by using -D. Some smart cards do not
  let you remove a public key you have generated. In such a case, only the
  private key is deleted from the key pair. You can display the public key with
  the command certutil -K -h tokenname.</div>
<div class="Pp"></div>
-G
<div style="margin-left: 4.00ex;">Generate a new public and private key pair
  within a key database. The key database should already exist; if one is not
  present, this command option will initialize one by default. Some smart cards
  can store only one key pair. If you create a new key pair for such a card, the
  previous pair is overwritten.</div>
<div class="Pp"></div>
-H
<div style="margin-left: 4.00ex;">Display a list of the command options and
  arguments.</div>
<div class="Pp"></div>
-K
<div style="margin-left: 4.00ex;">List the key ID of keys in the key database. A
  key ID is the modulus of the RSA key or the publicValue of the DSA key. IDs
  are displayed in hexadecimal (&quot;0x&quot; is not shown).</div>
<div class="Pp"></div>
-L
<div style="margin-left: 4.00ex;">List all the certificates, or display
  information about a named certificate, in a certificate database. Use the -h
  tokenname argument to specify the certificate database on a particular
  hardware or software token.</div>
<div class="Pp"></div>
-M
<div style="margin-left: 4.00ex;">Modify a certificate's trust attributes using
  the values of the -t argument.</div>
<div class="Pp"></div>
-N
<div style="margin-left: 4.00ex;">Create new certificate and key
  databases.</div>
<div class="Pp"></div>
-O
<div style="margin-left: 4.00ex;">Print the certificate chain.</div>
<div class="Pp"></div>
-R
<div style="margin-left: 4.00ex;">Create a certificate request file that can be
  submitted to a Certificate Authority (CA) for processing into a finished
  certificate. Output defaults to standard out unless you use -o output-file
  argument. Use the -a argument to specify ASCII output.</div>
<div class="Pp"></div>
-S
<div style="margin-left: 4.00ex;">Create an individual certificate and add it to
  a certificate database.</div>
<div class="Pp"></div>
-T
<div style="margin-left: 4.00ex;">Reset the key database or token.</div>
<div class="Pp"></div>
-U
<div style="margin-left: 4.00ex;">List all available modules or print a single
  named module.</div>
<div class="Pp"></div>
-V
<div style="margin-left: 4.00ex;">Check the validity of a certificate and its
  attributes.</div>
<div class="Pp"></div>
-W
<div style="margin-left: 4.00ex;">Change the password to a key database.</div>
<div class="Pp"></div>
--merge
<div style="margin-left: 4.00ex;">Merge two databases into one.</div>
<div class="Pp"></div>
--upgrade-merge
<div style="margin-left: 4.00ex;">Upgrade an old database and merge it into a
  new database. This is used to migrate legacy NSS databases (cert8.db and
  key3.db) into the newer SQLite databases (cert9.db and key4.db).</div>
<div class="Pp"></div>
<b>Arguments</b>
<div class="Pp"></div>
Arguments modify a command option and are usually lower case, numbers, or
  symbols.
<div class="Pp"></div>
-a
<div style="margin-left: 4.00ex;">Use ASCII format or allow the use of ASCII
  format for input or output. This formatting follows RFC 1113. For certificate
  requests, ASCII output defaults to standard output unless redirected.</div>
<div class="Pp"></div>
-b validity-time
<div style="margin-left: 4.00ex;">Specify a time at which a certificate is
  required to be valid. Use when checking certificate validity with the
  <b>-V</b> option. The format of the <i>validity-time</i> argument is
  <i>YYMMDDHHMMSS[+HHMM|-HHMM|Z]</i>, which allows offsets to be set relative to
  the validity end time. Specifying seconds ( <i>SS</i>) is optional. When
  specifying an explicit time, use a Z at the end of the term,
  <i>YYMMDDHHMMSSZ</i>, to close it. When specifying an offset time, use
  <i>YYMMDDHHMMSS+HHMM</i> or <i>YYMMDDHHMMSS-HHMM</i> for adding or subtracting
  time, respectively.
<div style="height: 1.00em;">&#x00A0;</div>
If this option is not used, the validity check defaults to the current system
  time.</div>
<div class="Pp"></div>
-c issuer
<div style="margin-left: 4.00ex;">Identify the certificate of the CA from which
  a new certificate will derive its authenticity. Use the exact nickname or
  alias of the CA certificate, or use the CA's email address. Bracket the issuer
  string with quotation marks if it contains spaces.</div>
<div class="Pp"></div>
-d [prefix]directory
<div style="margin-left: 4.00ex;">Specify the database directory containing the
  certificate and key database files.
<div style="height: 1.00em;">&#x00A0;</div>
<b>certutil</b> supports two types of databases: the legacy security databases
  (cert8.db, key3.db, and secmod.db) and new SQLite databases (cert9.db,
  key4.db, and pkcs11.txt).
<div style="height: 1.00em;">&#x00A0;</div>
NSS recognizes the following prefixes:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>sql:</b> requests the newer
  database</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>dbm:</b> requests the legacy
  database</div>
<div style="height: 1.00em;">&#x00A0;</div>
If no prefix is specified the default type is retrieved from
  NSS_DEFAULT_DB_TYPE. If NSS_DEFAULT_DB_TYPE is not set then <b>dbm:</b> is the
  default.</div>
<div class="Pp"></div>
--dump-ext-val OID
<div style="margin-left: 4.00ex;">For single cert, print binary DER encoding of
  extension OID.</div>
<div class="Pp"></div>
-e
<div style="margin-left: 4.00ex;">Check a certificate's signature during the
  process of validating a certificate.</div>
<div class="Pp"></div>
--email email-address
<div style="margin-left: 4.00ex;">Specify the email address of a certificate to
  list. Used with the -L command option.</div>
<div class="Pp"></div>
--extGeneric OID:critical-flag:filename[,OID:critical-flag:filename]...
<div style="margin-left: 4.00ex;">Add one or multiple extensions that certutil
  cannot encode yet, by loading their encodings from external files.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;OID (example): 1.2.3.4</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;critical-flag: critical or
  not-critical</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;filename: full path to a file
  containing an encoded extension</div>
</div>
<div class="Pp"></div>
-f password-file
<div style="margin-left: 4.00ex;">Specify a file that will automatically supply
  the password to include in a certificate or to access a certificate database.
  This is a plain-text file containing one password. Be sure to prevent
  unauthorized access to this file.</div>
<div class="Pp"></div>
-g keysize
<div style="margin-left: 4.00ex;">Set a key size to use when generating new
  public and private key pairs. The minimum is 512 bits and the maximum is 16384
  bits. The default is 2048 bits. Any size between the minimum and maximum is
  allowed.</div>
<div class="Pp"></div>
-h tokenname
<div style="margin-left: 4.00ex;">Specify the name of a token to use or act on.
  If not specified the default token is the internal database slot.</div>
<div class="Pp"></div>
-i input_file
<div style="margin-left: 4.00ex;">Pass an input file to the command. Depending
  on the command option, an input file can be a specific certificate, a
  certificate request file, or a batch file of commands.</div>
<div class="Pp"></div>
-k key-type-or-id
<div style="margin-left: 4.00ex;">Specify the type or specific ID of a key.
<div style="height: 1.00em;">&#x00A0;</div>
The valid key type options are rsa, dsa, ec, or all. The default value is rsa.
  Specifying the type of key can avoid mistakes caused by duplicate nicknames.
  Giving a key type generates a new key pair; giving the ID of an existing key
  reuses that key pair (which is required to renew certificates).</div>
<div class="Pp"></div>
-l
<div style="margin-left: 4.00ex;">Display detailed information when validating a
  certificate with the -V option.</div>
<div class="Pp"></div>
-m serial-number
<div style="margin-left: 4.00ex;">Assign a unique serial number to a certificate
  being created. This operation should be performed by a CA. If no serial number
  is provided a default serial number is made from the current time. Serial
  numbers are limited to integers</div>
<div class="Pp"></div>
-n nickname
<div style="margin-left: 4.00ex;">Specify the nickname of a certificate or key
  to list, create, add to a database, modify, or validate. Bracket the nickname
  string with quotation marks if it contains spaces.</div>
<div class="Pp"></div>
-o output-file
<div style="margin-left: 4.00ex;">Specify the output file name for new
  certificates or binary certificate requests. Bracket the output-file string
  with quotation marks if it contains spaces. If this argument is not used the
  output destination defaults to standard output.</div>
<div class="Pp"></div>
-P dbPrefix
<div style="margin-left: 4.00ex;">Specify the prefix used on the certificate and
  key database file. This argument is provided to support legacy servers. Most
  applications do not use a database prefix.</div>
<div class="Pp"></div>
-p phone
<div style="margin-left: 4.00ex;">Specify a contact telephone number to include
  in new certificates or certificate requests. Bracket this string with
  quotation marks if it contains spaces.</div>
<div class="Pp"></div>
-q pqgfile or curve-name
<div style="margin-left: 4.00ex;">Read an alternate PQG value from the specified
  file when generating DSA key pairs. If this argument is not used,
  <b>certutil</b> generates its own PQG value. PQG files are created with a
  separate DSA utility.
<div style="height: 1.00em;">&#x00A0;</div>
Elliptic curve name is one of the ones from nistp256, nistp384, nistp521,
  curve25519.
<div style="height: 1.00em;">&#x00A0;</div>
If a token is available that supports more curves, the foolowing curves are
  supported as well: sect163k1, nistk163, sect163r1, sect163r2, nistb163,
  sect193r1, sect193r2, sect233k1, nistk233, sect233r1, nistb233, sect239k1,
  sect283k1, nistk283, sect283r1, nistb283, sect409k1, nistk409, sect409r1,
  nistb409, sect571k1, nistk571, sect571r1, nistb571, secp160k1, secp160r1,
  secp160r2, secp192k1, secp192r1, nistp192, secp224k1, secp224r1, nistp224,
  secp256k1, secp256r1, secp384r1, secp521r1, prime192v1, prime192v2,
  prime192v3, prime239v1, prime239v2, prime239v3, c2pnb163v1, c2pnb163v2,
  c2pnb163v3, c2pnb176v1, c2tnb191v1, c2tnb191v2, c2tnb191v3, c2pnb208w1,
  c2tnb239v1, c2tnb239v2, c2tnb239v3, c2pnb272w1, c2pnb304w1, c2tnb359w1,
  c2pnb368w1, c2tnb431r1, secp112r1, secp112r2, secp128r1, secp128r2, sect113r1,
  sect113r2, sect131r1, sect131r2</div>
<div class="Pp"></div>
-r
<div style="margin-left: 4.00ex;">Display a certificate's binary DER encoding
  when listing information about that certificate with the -L option.</div>
<div class="Pp"></div>
-s subject
<div style="margin-left: 4.00ex;">Identify a particular certificate owner for
  new certificates or certificate requests. Bracket this string with quotation
  marks if it contains spaces. The subject identification format follows RFC
  #1485.</div>
<div class="Pp"></div>
-t trustargs
<div style="margin-left: 4.00ex;">Specify the trust attributes to modify in an
  existing certificate or to apply to a certificate when creating it or adding
  it to a database. There are three available trust categories for each
  certificate, expressed in the order <i>SSL, email, object signing</i> for each
  trust setting. In each category position, use none, any, or all of the
  attribute codes:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>p</b> - Valid peer</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>P</b> - Trusted peer (implies
  p)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>c</b> - Valid CA</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>C</b> - Trusted CA (implies
  c)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>T</b> - trusted CA for client
  authentication (ssl server only)</div>
<div style="height: 1.00em;">&#x00A0;</div>
The attribute codes for the categories are separated by commas, and the entire
  set of attributes enclosed by quotation marks. For example:
<div style="height: 1.00em;">&#x00A0;</div>
<b>-t &quot;TC,C,T&quot;</b>
<div style="height: 1.00em;">&#x00A0;</div>
Use the -L option to see a list of the current certificates and trust attributes
  in a certificate database.
<div style="height: 1.00em;">&#x00A0;</div>
Note that the output of the -L option may include &quot;u&quot; flag, which
  means that there is a private key associated with the certificate. It is a
  dynamic flag and you cannot set it with certutil.</div>
<div class="Pp"></div>
-u certusage
<div style="margin-left: 4.00ex;">Specify a usage context to apply when
  validating a certificate with the -V option.
<div style="height: 1.00em;">&#x00A0;</div>
The contexts are the following:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>C</b> (as an SSL client)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>V</b> (as an SSL server)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>L</b> (as an SSL CA)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>A</b> (as Any CA)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>Y</b> (Verify CA)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>S</b> (as an email signer)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>R</b> (as an email recipient)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>O</b> (as an OCSP status
  responder)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>J</b> (as an object signer)</div>
</div>
<div class="Pp"></div>
-v valid-months
<div style="margin-left: 4.00ex;">Set the number of months a new certificate
  will be valid. The validity period begins at the current system time unless an
  offset is added or subtracted with the <b>-w</b> option. If this argument is
  not used, the default validity period is three months.</div>
<div class="Pp"></div>
-w offset-months
<div style="margin-left: 4.00ex;">Set an offset from the current system time, in
  months, for the beginning of a certificate's validity period. Use when
  creating the certificate or adding it to a database. Express the offset in
  integers, using a minus sign (-) to indicate a negative offset. If this
  argument is not used, the validity period begins at the current system time.
  The length of the validity period is set with the -v argument.</div>
<div class="Pp"></div>
-X
<div style="margin-left: 4.00ex;">Force the key and certificate database to open
  in read-write mode. This is used with the <b>-U</b> and <b>-L</b> command
  options.</div>
<div class="Pp"></div>
-x
<div style="margin-left: 4.00ex;">Use <b>certutil</b> to generate the signature
  for a certificate being created or added to a database, rather than obtaining
  a signature from a separate CA.</div>
<div class="Pp"></div>
-y exp
<div style="margin-left: 4.00ex;">Set an alternate exponent value to use in
  generating a new RSA public key for the database, instead of the default value
  of 65537. The available alternate values are 3 and 17.</div>
<div class="Pp"></div>
-z noise-file
<div style="margin-left: 4.00ex;">Read a seed value from the specified file to
  generate a new private and public key pair. This argument makes it possible to
  use hardware-generated seed values or manually create a value from the
  keyboard. The minimum file size is 20 bytes.</div>
<div class="Pp"></div>
-Z hashAlg
<div style="margin-left: 4.00ex;">Specify the hash algorithm to use with the -C,
  -S or -R command options. Possible keywords:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;MD2</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;MD4</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;MD5</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;SHA1</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;SHA224</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;SHA256</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;SHA384</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;SHA512</div>
</div>
<div class="Pp"></div>
-0 SSO_password
<div style="margin-left: 4.00ex;">Set a site security officer password on a
  token.</div>
<div class="Pp"></div>
-1 | --keyUsage keyword,keyword
<div style="margin-left: 4.00ex;">Set an X.509 V3 Certificate Type Extension in
  the certificate. There are several available keywords:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;digitalSignature</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;nonRepudiation</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;keyEncipherment</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;dataEncipherment</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;keyAgreement</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;certSigning</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;crlSigning</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;critical</div>
</div>
<div class="Pp"></div>
-2
<div style="margin-left: 4.00ex;">Add a basic constraint extension to a
  certificate that is being created or added to a database. This extension
  supports the certificate chain verification process. <b>certutil</b> prompts
  for the certificate constraint extension to select.
<div style="height: 1.00em;">&#x00A0;</div>
X.509 certificate extensions are described in RFC 5280.</div>
<div class="Pp"></div>
-3
<div style="margin-left: 4.00ex;">Add an authority key ID extension to a
  certificate that is being created or added to a database. This extension
  supports the identification of a particular certificate, from among multiple
  certificates associated with one subject name, as the correct issuer of a
  certificate. The Certificate Database Tool will prompt you to select the
  authority key ID extension.
<div style="height: 1.00em;">&#x00A0;</div>
X.509 certificate extensions are described in RFC 5280.</div>
<div class="Pp"></div>
-4
<div style="margin-left: 4.00ex;">Add a CRL distribution point extension to a
  certificate that is being created or added to a database. This extension
  identifies the URL of a certificate's associated certificate revocation list
  (CRL). <b>certutil</b> prompts for the URL.
<div style="height: 1.00em;">&#x00A0;</div>
X.509 certificate extensions are described in RFC 5280.</div>
<div class="Pp"></div>
-5 | --nsCertType keyword,keyword
<div style="margin-left: 4.00ex;">Add an X.509 V3 certificate type extension to
  a certificate that is being created or added to the database. There are
  several available keywords:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;sslClient</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;sslServer</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;smime</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;objectSigning</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;sslCA</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;smimeCA</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;objectSigningCA</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;critical</div>
<div style="height: 1.00em;">&#x00A0;</div>
X.509 certificate extensions are described in RFC 5280.</div>
<div class="Pp"></div>
-6 | --extKeyUsage keyword,keyword
<div style="margin-left: 4.00ex;">Add an extended key usage extension to a
  certificate that is being created or added to the database. Several keywords
  are available:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;serverAuth</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;clientAuth</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;codeSigning</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;emailProtection</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;timeStamp</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;ocspResponder</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;stepUp</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;msTrustListSign</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;critical</div>
<div style="height: 1.00em;">&#x00A0;</div>
X.509 certificate extensions are described in RFC 5280.</div>
<div class="Pp"></div>
-7 emailAddrs
<div style="margin-left: 4.00ex;">Add a comma-separated list of email addresses
  to the subject alternative name extension of a certificate or certificate
  request that is being created or added to the database. Subject alternative
  name extensions are described in Section 4.2.1.7 of RFC 3280.</div>
<div class="Pp"></div>
-8 dns-names
<div style="margin-left: 4.00ex;">Add a comma-separated list of DNS names to the
  subject alternative name extension of a certificate or certificate request
  that is being created or added to the database. Subject alternative name
  extensions are described in Section 4.2.1.7 of RFC 3280.</div>
<div class="Pp"></div>
--extAIA
<div style="margin-left: 4.00ex;">Add the Authority Information Access extension
  to the certificate. X.509 certificate extensions are described in RFC
  5280.</div>
<div class="Pp"></div>
--extSIA
<div style="margin-left: 4.00ex;">Add the Subject Information Access extension
  to the certificate. X.509 certificate extensions are described in RFC
  5280.</div>
<div class="Pp"></div>
--extCP
<div style="margin-left: 4.00ex;">Add the Certificate Policies extension to the
  certificate. X.509 certificate extensions are described in RFC 5280.</div>
<div class="Pp"></div>
--extPM
<div style="margin-left: 4.00ex;">Add the Policy Mappings extension to the
  certificate. X.509 certificate extensions are described in RFC 5280.</div>
<div class="Pp"></div>
--extPC
<div style="margin-left: 4.00ex;">Add the Policy Constraints extension to the
  certificate. X.509 certificate extensions are described in RFC 5280.</div>
<div class="Pp"></div>
--extIA
<div style="margin-left: 4.00ex;">Add the Inhibit Any Policy Access extension to
  the certificate. X.509 certificate extensions are described in RFC 5280.</div>
<div class="Pp"></div>
--extSKID
<div style="margin-left: 4.00ex;">Add the Subject Key ID extension to the
  certificate. X.509 certificate extensions are described in RFC 5280.</div>
<div class="Pp"></div>
--extNC
<div style="margin-left: 4.00ex;">Add a Name Constraint extension to the
  certificate. X.509 certificate extensions are described in RFC 5280.</div>
<div class="Pp"></div>
--extSAN type:name[,type:name]...
<div style="margin-left: 4.00ex;">Create a Subject Alt Name extension with one
  or multiple names.
<div style="height: 1.00em;">&#x00A0;</div>
-type: directory, dn, dns, edi, ediparty, email, ip, ipaddr, other, registerid,
  rfc822, uri, x400, x400addr</div>
<div class="Pp"></div>
--empty-password
<div style="margin-left: 4.00ex;">Use empty password when creating new
  certificate database with -N.</div>
<div class="Pp"></div>
--keyAttrFlags attrflags
<div style="margin-left: 4.00ex;">PKCS #11 key Attributes. Comma separated list
  of key attribute flags, selected from the following list of choices: {token |
  session} {public | private} {sensitive | insensitive} {modifiable |
  unmodifiable} {extractable | unextractable}</div>
<div class="Pp"></div>
--keyOpFlagsOn opflags, --keyOpFlagsOff opflags
<div style="margin-left: 4.00ex;">PKCS #11 key Operation Flags. Comma separated
  list of one or more of the following: {token | session} {public | private}
  {sensitive | insensitive} {modifiable | unmodifiable} {extractable |
  unextractable}</div>
<div class="Pp"></div>
--new-n nickname
<div style="margin-left: 4.00ex;">A new nickname, used when renaming a
  certificate.</div>
<div class="Pp"></div>
--source-dir certdir
<div style="margin-left: 4.00ex;">Identify the certificate database directory to
  upgrade.</div>
<div class="Pp"></div>
--source-prefix certdir
<div style="margin-left: 4.00ex;">Give the prefix of the certificate and key
  databases to upgrade.</div>
<div class="Pp"></div>
--upgrade-id uniqueID
<div style="margin-left: 4.00ex;">Give the unique ID of the database to
  upgrade.</div>
<div class="Pp"></div>
--upgrade-token-name name
<div style="margin-left: 4.00ex;">Set the name of the token to use while it is
  being upgraded.</div>
<div class="Pp"></div>
-@ pwfile
<div style="margin-left: 4.00ex;">Give the name of a password file to use for
  the database being upgraded.</div>
<h1 class="Sh" title="Sh" id="USAGE_AND_EXAMPLES"><a class="selflink" href="#USAGE_AND_EXAMPLES">USAGE
  AND EXAMPLES</a></h1>
Most of the command options in the examples listed here have more arguments
  available. The arguments included in these examples are the most common ones
  or are used to illustrate a specific scenario. Use the <b>-H</b> option to
  show the complete list of arguments for each command option.
<div class="Pp"></div>
<b>Creating New Security Databases</b>
<div class="Pp"></div>
Certificates, keys, and security modules related to managing certificates are
  stored in three related databases:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;cert8.db or cert9.db</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;key3.db or key4.db</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;secmod.db or pkcs11.txt</div>
<div class="Pp"></div>
These databases must be created before certificates or keys can be generated.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
certutil -N -d [sql:]directory
</pre>
</div>
<div class="Pp"></div>
<b>Creating a Certificate Request</b>
<div class="Pp"></div>
A certificate request contains most or all of the information that is used to
  generate the final certificate. This request is submitted separately to a
  certificate authority and is then approved by some mechanism (automatically or
  by human review). Once the request is approved, then the certificate is
  generated.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -R -k key-type-or-id [-q pqgfile|curve-name] -g key-size -s subject [-h tokenname] -d [sql:]directory [-p phone] [-o output-file] [-a]
</pre>
</div>
<div class="Pp"></div>
The <b>-R</b> command options requires four arguments:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>-k</b> to specify either the key
  type to generate or, when renewing a certificate, the existing key pair to
  use</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>-g</b> to set the keysize of the
  key to generate</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>-s</b> to set the subject name of
  the certificate</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>-d</b> to give the security
  database directory</div>
<div class="Pp"></div>
The new certificate request can be output in ASCII format ( <b>-a</b>) or can be
  written to a specified file ( <b>-o</b>).
<div class="Pp"></div>
For example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -R -k rsa -g 1024 -s &quot;CN=John Smith,O=Example Corp,L=Mountain View,ST=California,C=US&quot; -d sql:$HOME/nssdb -p 650-555-0123 -a -o cert.cer
<div class="Pp"></div>
Generating key.  This may take a few moments...
<div class="Pp"></div>
</pre>
</div>
<div class="Pp"></div>
<b>Creating a Certificate</b>
<div class="Pp"></div>
A valid certificate must be issued by a trusted CA. This can be done by
  specifying a CA certificate ( <b>-c</b>) that is stored in the certificate
  database. If a CA key pair is not available, you can create a self-signed
  certificate using the <b>-x</b> argument with the <b>-S</b> command option.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -S -k rsa|dsa|ec -n certname -s subject [-c issuer |-x] -t trustargs -d [sql:]directory [-m serial-number] [-v valid-months] [-w offset-months] [-p phone] [-1] [-2] [-3] [-4] [-5 keyword] [-6 keyword] [-7 emailAddress] [-8 dns-names] [--extAIA] [--extSIA] [--extCP] [--extPM] [--extPC] [--extIA] [--extSKID]
</pre>
</div>
<div class="Pp"></div>
The series of numbers and <b>--ext*</b> options set certificate extensions that
  can be added to the certificate when it is generated by the CA. Interactive
  prompts will result.
<div class="Pp"></div>
For example, this creates a self-signed certificate:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -S -s &quot;CN=Example CA&quot; -n my-ca-cert -x -t &quot;C,C,C&quot; -1 -2 -5 -m 3650
</pre>
</div>
<div class="Pp"></div>
The interative prompts for key usage and whether any extensions are critical and
  responses have been ommitted for brevity.
<div class="Pp"></div>
From there, new certificates can reference the self-signed certificate:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -S -s &quot;CN=My Server Cert&quot; -n my-server-cert -c &quot;my-ca-cert&quot; -t &quot;,,&quot; -1 -5 -6 -8 -m 730
</pre>
</div>
<div class="Pp"></div>
<b>Generating a Certificate from a Certificate Request</b>
<div class="Pp"></div>
When a certificate request is created, a certificate can be generated by using
  the request and then referencing a certificate authority signing certificate
  (the <i>issuer</i> specified in the <b>-c</b> argument). The issuing
  certificate must be in the certificate database in the specified directory.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
certutil -C -c issuer -i cert-request-file -o output-file [-m serial-number] [-v valid-months] [-w offset-months] -d [sql:]directory [-1] [-2] [-3] [-4] [-5 keyword] [-6 keyword] [-7 emailAddress] [-8 dns-names]
</pre>
</div>
<div class="Pp"></div>
For example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -C -c &quot;my-ca-cert&quot; -i /home/certs/cert.req -o cert.cer -m 010 -v 12 -w 1 -d sql:$HOME/nssdb -1 nonRepudiation,dataEncipherment -5 sslClient -6 clientAuth -7 jsmith@example.com
</pre>
</div>
<div class="Pp"></div>
<b>Listing Certificates</b>
<div class="Pp"></div>
The <b>-L</b> command option lists all of the certificates listed in the
  certificate database. The path to the directory ( <b>-d</b>) is required.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -L -d sql:/home/my/sharednssdb
<div class="Pp"></div>
Certificate Nickname                                         Trust Attributes
                                                             SSL,S/MIME,JAR/XPI
<div class="Pp"></div>
CA Administrator of Instance pki-ca1's Example Domain ID     u,u,u
TPS Administrator's Example Domain ID                        u,u,u
Google Internet Authority                                    ,,   
Certificate Authority - Example Domain                       CT,C,C
</pre>
</div>
<div class="Pp"></div>
Using additional arguments with <b>-L</b> can return and print the information
  for a single, specific certificate. For example, the <b>-n</b> argument passes
  the certificate name, while the <b>-a</b> argument prints the certificate in
  ASCII format:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -L -d sql:$HOME/nssdb -a -n my-ca-cert
-----BEGIN CERTIFICATE-----
MIIB1DCCAT2gAwIBAgICDkIwDQYJKoZIhvcNAQEFBQAwFTETMBEGA1UEAxMKRXhh
bXBsZSBDQTAeFw0xMzAzMTMxOTEwMjlaFw0xMzA2MTMxOTEwMjlaMBUxEzARBgNV
BAMTCkV4YW1wbGUgQ0EwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAJ4Kzqvz
JyBVgFqDXRYSyTBNw1DrxUU/3GvWA/ngjAwHEv0Cul/6sO/gsCvnABHiH6unns6x
XRzPORlC2WY3gkk7vmlsLvYpyecNazAi/NAwVnU/66HOsaoVFWE+gBQo99UrN2yk
0BiK/GMFlLm5dXQROgA9ZKKyFdI0LIXtf6SbAgMBAAGjMzAxMBEGCWCGSAGG+EIB
AQQEAwIHADAMBgNVHRMEBTADAQH/MA4GA1UdDwEB/wQEAwICBDANBgkqhkiG9w0B
AQUFAAOBgQA6chkzkACN281d1jKMrc+RHG2UMaQyxiteaLVZO+Ro1nnRUvseDf09
XKYFwPMJjWCihVku6bw/ihZfuMHhxK22Nue6inNQ6eDu7WmrqL8z3iUrQwxs+WiF
ob2rb8XRVVJkzXdXxlk4uo3UtNvw8sAz7sWD71qxKaIHU5q49zijfg==
-----END CERTIFICATE-----
</pre>
</div>
<div class="Pp"></div>
For a human-readable display
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -L -d sql:$HOME/nssdb -n my-ca-cert
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 3650 (0xe42)
        Signature Algorithm: PKCS #1 SHA-1 With RSA Encryption
        Issuer: &quot;CN=Example CA&quot;
        Validity:
            Not Before: Wed Mar 13 19:10:29 2013
            Not After : Thu Jun 13 19:10:29 2013
        Subject: &quot;CN=Example CA&quot;
        Subject Public Key Info:
            Public Key Algorithm: PKCS #1 RSA Encryption
            RSA Public Key:
                Modulus:
                    9e:0a:ce:ab:f3:27:20:55:80:5a:83:5d:16:12:c9:30:
                    4d:c3:50:eb:c5:45:3f:dc:6b:d6:03:f9:e0:8c:0c:07:
                    12:fd:02:ba:5f:fa:b0:ef:e0:b0:2b:e7:00:11:e2:1f:
                    ab:a7:9e:ce:b1:5d:1c:cf:39:19:42:d9:66:37:82:49:
                    3b:be:69:6c:2e:f6:29:c9:e7:0d:6b:30:22:fc:d0:30:
                    56:75:3f:eb:a1:ce:b1:aa:15:15:61:3e:80:14:28:f7:
                    d5:2b:37:6c:a4:d0:18:8a:fc:63:05:94:b9:b9:75:74:
                    11:3a:00:3d:64:a2:b2:15:d2:34:2c:85:ed:7f:a4:9b
                Exponent: 65537 (0x10001)
        Signed Extensions:
            Name: Certificate Type
            Data: none
<div class="Pp"></div>
            Name: Certificate Basic Constraints
            Data: Is a CA with no maximum path length.
<div class="Pp"></div>
            Name: Certificate Key Usage
            Critical: True
            Usages: Certificate Signing
<div class="Pp"></div>
    Signature Algorithm: PKCS #1 SHA-1 With RSA Encryption
    Signature:
        3a:72:19:33:90:00:8d:db:cd:5d:d6:32:8c:ad:cf:91:
        1c:6d:94:31:a4:32:c6:2b:5e:68:b5:59:3b:e4:68:d6:
        79:d1:52:fb:1e:0d:fd:3d:5c:a6:05:c0:f3:09:8d:60:
        a2:85:59:2e:e9:bc:3f:8a:16:5f:b8:c1:e1:c4:ad:b6:
        36:e7:ba:8a:73:50:e9:e0:ee:ed:69:ab:a8:bf:33:de:
        25:2b:43:0c:6c:f9:68:85:a1:bd:ab:6f:c5:d1:55:52:
        64:cd:77:57:c6:59:38:ba:8d:d4:b4:db:f0:f2:c0:33:
        ee:c5:83:ef:5a:b1:29:a2:07:53:9a:b8:f7:38:a3:7e
    Fingerprint (MD5):
        86:D8:A5:8B:8A:26:BE:9E:17:A8:7B:66:10:6B:27:80
    Fingerprint (SHA1):
        48:78:09:EF:C5:D4:0C:BD:D2:64:45:59:EB:03:13:15:F7:A9:D6:F7
<div class="Pp"></div>
    Certificate Trust Flags:
        SSL Flags:
            Valid CA
            Trusted CA
            User
        Email Flags:
            Valid CA
            Trusted CA
            User
        Object Signing Flags:
            Valid CA
            Trusted CA
            User
<div class="Pp"></div>
</pre>
</div>
<div class="Pp"></div>
<b>Listing Keys</b>
<div class="Pp"></div>
Keys are the original material used to encrypt certificate data. The keys
  generated for certificates are stored separately, in the key database.
<div class="Pp"></div>
To list all keys in the database, use the <b>-K</b> command option and the
  (required) <b>-d</b> argument to give the path to the directory.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -K -d sql:$HOME/nssdb
certutil: Checking token &quot;NSS Certificate DB&quot; in slot &quot;NSS User Private Key and Certificate Services                  &quot;
&lt; 0&gt; rsa      455a6673bde9375c2887ec8bf8016b3f9f35861d   Thawte Freemail Member's Thawte Consulting (Pty) Ltd. ID
&lt; 1&gt; rsa      40defeeb522ade11090eacebaaf1196a172127df   Example Domain Administrator Cert
&lt; 2&gt; rsa      1d0b06f44f6c03842f7d4f4a1dc78b3bcd1b85a5   John Smith user cert
</pre>
</div>
<div class="Pp"></div>
There are ways to narrow the keys listed in the search results:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;To return a specific key, use the
  <b>-n</b> <i>name</i> argument with the name of the key.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;If there are multiple security devices
  loaded, then the <b>-h</b><i>tokenname</i> argument can search a specific
  token or all tokens.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;If there are multiple key types
  available, then the <b>-k</b><i>key-type</i> argument can search a specific
  type of key, like RSA, DSA, or ECC.</div>
<div class="Pp"></div>
<b>Listing Security Modules</b>
<div class="Pp"></div>
The devices that can be used to store certificates -- both internal databases
  and external devices like smart cards -- are recognized and used by loading
  security modules. The <b>-U</b> command option lists all of the security
  modules listed in the secmod.db database. The path to the directory (
  <b>-d</b>) is required.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -U -d sql:/home/my/sharednssdb
<div class="Pp"></div>
    slot: NSS User Private Key and Certificate Services                  
   token: NSS Certificate DB
<div class="Pp"></div>
    slot: NSS Internal Cryptographic Services                            
   token: NSS Generic Crypto Services
</pre>
</div>
<div class="Pp"></div>
<b>Adding Certificates to the Database</b>
<div class="Pp"></div>
Existing certificates or certificate requests can be added manually to the
  certificate database, even if they were generated elsewhere. This uses the
  <b>-A</b> command option.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
certutil -A -n certname -t trustargs -d [sql:]directory [-a] [-i input-file]
</pre>
</div>
<div class="Pp"></div>
For example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -A -n &quot;CN=My SSL Certificate&quot; -t &quot;,,&quot; -d sql:/home/my/sharednssdb -i /home/example-certs/cert.cer
</pre>
</div>
<div class="Pp"></div>
A related command option, <b>-E</b>, is used specifically to add email
  certificates to the certificate database. The <b>-E</b> command has the same
  arguments as the <b>-A</b> command. The trust arguments for certificates have
  the format <i>SSL,S/MIME,Code-signing</i>, so the middle trust settings relate
  most to email certificates (though the others can be set). For example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -E -n &quot;CN=John Smith Email Cert&quot; -t &quot;,P,&quot; -d sql:/home/my/sharednssdb -i /home/example-certs/email.cer
</pre>
</div>
<div class="Pp"></div>
<b>Deleting Certificates to the Database</b>
<div class="Pp"></div>
Certificates can be deleted from a database using the <b>-D</b> option. The only
  required options are to give the security database directory and to identify
  the certificate nickname.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
certutil -D -d [sql:]directory -n &quot;nickname&quot;
</pre>
</div>
<div class="Pp"></div>
For example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -D -d sql:/home/my/sharednssdb -n &quot;my-ssl-cert&quot;
</pre>
</div>
<div class="Pp"></div>
<b>Validating Certificates</b>
<div class="Pp"></div>
A certificate contains an expiration date in itself, and expired certificates
  are easily rejected. However, certificates can also be revoked before they hit
  their expiration date. Checking whether a certificate has been revoked
  requires validating the certificate. Validation can also be used to ensure
  that the certificate is only used for the purposes it was initially issued
  for. Validation is carried out by the <b>-V</b> command option.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
certutil -V -n certificate-name [-b time] [-e] [-u cert-usage] -d [sql:]directory
</pre>
</div>
<div class="Pp"></div>
For example, to validate an email certificate:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -V -n &quot;John Smith's Email Cert&quot; -e -u S,R -d sql:/home/my/sharednssdb
</pre>
</div>
<div class="Pp"></div>
<b>Modifying Certificate Trust Settings</b>
<div class="Pp"></div>
The trust settings (which relate to the operations that a certificate is allowed
  to be used for) can be changed after a certificate is created or added to the
  database. This is especially useful for CA certificates, but it can be
  performed for any type of certificate.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
certutil -M -n certificate-name -t trust-args -d [sql:]directory
</pre>
</div>
<div class="Pp"></div>
For example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -M -n &quot;My CA Certificate&quot; -d sql:/home/my/sharednssdb -t &quot;CT,CT,CT&quot;
</pre>
</div>
<div class="Pp"></div>
<b>Printing the Certificate Chain</b>
<div class="Pp"></div>
Certificates can be issued in <i>chains</i> because every certificate authority
  itself has a certificate; when a CA issues a certificate, it essentially
  stamps that certificate with its own fingerprint. The <b>-O</b> prints the
  full chain of a certificate, going from the initial CA (the root CA) through
  ever intermediary CA to the actual certificate. For example, for an email
  certificate with two CAs in the chain:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -d sql:/home/my/sharednssdb -O -n &quot;jsmith@example.com&quot;
&quot;Builtin Object Token:Thawte Personal Freemail CA&quot; [E=personal-freemail@thawte.com,CN=Thawte Personal Freemail CA,OU=Certification Services Division,O=Thawte Consulting,L=Cape Town,ST=Western Cape,C=ZA]
<div class="Pp"></div>
  &quot;Thawte Personal Freemail Issuing CA - Thawte Consulting&quot; [CN=Thawte Personal Freemail Issuing CA,O=Thawte Consulting (Pty) Ltd.,C=ZA]
<div class="Pp"></div>
    &quot;(null)&quot; [E=jsmith@example.com,CN=Thawte Freemail Member]
</pre>
</div>
<div class="Pp"></div>
<b>Resetting a Token</b>
<div class="Pp"></div>
The device which stores certificates -- both external hardware devices and
  internal software databases -- can be blanked and reused. This operation is
  performed on the device which stores the data, not directly on the security
  databases, so the location must be referenced through the token name (
  <b>-h</b>) as well as any directory path. If there is no external token used,
  the default value is internal.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
certutil -T -d [sql:]directory -h token-name -0 security-officer-password
</pre>
</div>
<div class="Pp"></div>
Many networks have dedicated personnel who handle changes to security tokens
  (the security officer). This person must supply the password to access the
  specified token. For example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -T -d sql:/home/my/sharednssdb -h nethsm -0 secret
</pre>
</div>
<div class="Pp"></div>
<b>Upgrading or Merging the Security Databases</b>
<div class="Pp"></div>
Many networks or applications may be using older BerkeleyDB versions of the
  certificate database (cert8.db). Databases can be upgraded to the new SQLite
  version of the database (cert9.db) using the <b>--upgrade-merge</b> command
  option or existing databases can be merged with the new cert9.db databases
  using the <b>---merge</b> command.
<div class="Pp"></div>
The <b>--upgrade-merge</b> command must give information about the original
  database and then use the standard arguments (like <b>-d</b>) to give the
  information about the new databases. The command also requires information
  that the tool uses for the process to upgrade and write over the original
  database.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
certutil --upgrade-merge -d [sql:]directory [-P dbprefix] --source-dir directory --source-prefix dbprefix --upgrade-id id --upgrade-token-name name [-@ password-file]
</pre>
</div>
<div class="Pp"></div>
For example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil --upgrade-merge -d sql:/home/my/sharednssdb --source-dir /opt/my-app/alias/ --source-prefix serverapp- --upgrade-id 1 --upgrade-token-name internal
</pre>
</div>
<div class="Pp"></div>
The <b>--merge</b> command only requires information about the location of the
  original database; since it doesn't change the format of the database, it can
  write over information without performing interim step.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
certutil --merge -d [sql:]directory [-P dbprefix] --source-dir directory --source-prefix dbprefix [-@ password-file]
</pre>
</div>
<div class="Pp"></div>
For example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil --merge -d sql:/home/my/sharednssdb --source-dir /opt/my-app/alias/ --source-prefix serverapp-
</pre>
</div>
<div class="Pp"></div>
<b>Running certutil Commands from a Batch File</b>
<div class="Pp"></div>
A series of commands can be run sequentially from a text file with the <b>-B</b>
  command option. The only argument for this specifies the input file.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -B -i /path/to/batch-file
</pre>
</div>
<h1 class="Sh" title="Sh" id="NSS_DATABASE_TYPES"><a class="selflink" href="#NSS_DATABASE_TYPES">NSS
  DATABASE TYPES</a></h1>
NSS originally used BerkeleyDB databases to store security information. The last
  versions of these <i>legacy</i> databases are:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;cert8.db for certificates</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;key3.db for keys</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;secmod.db for PKCS #11 module
  information</div>
<div class="Pp"></div>
BerkeleyDB has performance limitations, though, which prevent it from being
  easily used by multiple applications simultaneously. NSS has some flexibility
  that allows applications to use their own, independent database engine while
  keeping a shared database and working around the access issues. Still, NSS
  requires more flexibility to provide a truly shared security database.
<div class="Pp"></div>
In 2009, NSS introduced a new set of databases that are SQLite databases rather
  than BerkeleyDB. These new databases provide more accessibility and
  performance:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;cert9.db for certificates</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;key4.db for keys</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;pkcs11.txt, a listing of all of the
  PKCS #11 modules, contained in a new subdirectory in the security databases
  directory</div>
<div class="Pp"></div>
Because the SQLite databases are designed to be shared, these are the
  <i>shared</i> database type. The shared database type is preferred; the legacy
  format is included for backward compatibility.
<div class="Pp"></div>
By default, the tools ( <b>certutil</b>, <b>pk12util</b>, <b>modutil</b>) assume
  that the given security databases follow the more common legacy type. Using
  the SQLite databases must be manually specified by using the <b>sql:</b>
  prefix with the given security directory. For example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
$ certutil -L -d sql:/home/my/sharednssdb
</pre>
</div>
<div class="Pp"></div>
To set the shared database type as the default type for the tools, set the
  <b>NSS_DEFAULT_DB_TYPE</b> environment variable to <b>sql</b>:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
export NSS_DEFAULT_DB_TYPE=&quot;sql&quot;
</pre>
</div>
<div class="Pp"></div>
This line can be set added to the ~/.bashrc file to make the change permanent.
<div class="Pp"></div>
Most applications do not use the shared database by default, but they can be
  configured to use them. For example, this how-to article covers how to
  configure Firefox and Thunderbird to use the new shared NSS databases:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;https://wiki.mozilla.org/NSS_Shared_DB_Howto</div>
<div class="Pp"></div>
For an engineering draft on the changes in the shared NSS databases, see the NSS
  project wiki:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;https://wiki.mozilla.org/NSS_Shared_DB</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
pk12util (1)
<div class="Pp"></div>
modutil (1)
<div class="Pp"></div>
<b>certutil</b> has arguments or operations that use features defined in several
  IETF RFCs.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;http://tools.ietf.org/html/rfc5280</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;http://tools.ietf.org/html/rfc1113</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;http://tools.ietf.org/html/rfc1485</div>
<div class="Pp"></div>
The NSS wiki has information on the new database design and how to configure
  applications to use it.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;https://wiki.mozilla.org/NSS_Shared_DB_Howto</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;https://wiki.mozilla.org/NSS_Shared_DB</div>
<h1 class="Sh" title="Sh" id="ADDITIONAL_RESOURCES"><a class="selflink" href="#ADDITIONAL_RESOURCES">ADDITIONAL
  RESOURCES</a></h1>
For information about NSS and other tools related to NSS (like JSS), check out
  the NSS project wiki at
  <b>http://www.mozilla.org/projects/security/pki/nss/</b>. The NSS site relates
  directly to NSS code changes and releases.
<div class="Pp"></div>
Mailing lists: https://lists.mozilla.org/listinfo/dev-tech-crypto
<div class="Pp"></div>
IRC: Freenode at #dogtag-pki
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
The NSS tools were written and maintained by developers with Netscape, Red Hat,
  Sun, Oracle, Mozilla, and Google.
<div class="Pp"></div>
Authors: Elio Maldonado &lt;emaldona@redhat.com&gt;, Deon Lackey
  &lt;dlackey@redhat.com&gt;.
<h1 class="Sh" title="Sh" id="LICENSE"><a class="selflink" href="#LICENSE">LICENSE</a></h1>
Licensed under the Mozilla Public License, v. 2.0. If a copy of the MPL was not
  distributed with this file, You can obtain one at http://mozilla.org/MPL/2.0/.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"> 1.</dt>
  <dd class="It-tag">Mozilla NSS bug 836477</dd>
</dl>
<div style="margin-left: 4.00ex;">https://bugzilla.mozilla.org/show_bug.cgi?id=836477</div>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">8 September 2016</td>
    <td class="foot-os">nss-tools</td>
  </tr>
</table>
</body>
</html>
