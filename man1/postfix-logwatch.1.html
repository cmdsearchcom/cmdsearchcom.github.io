<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>POSTFIX-LOGWATCH(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">POSTFIX-LOGWATCH(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">POSTFIX-LOGWATCH(1)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
postfix-logwatch - A Postfix log parser and analysis utility
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<br/>
<b>postfix-logwatch</b> [<i>options</i>] [<i>logfile ...</i>]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<br/>
The <b>postfix-logwatch</b>(1) utility is a Postfix MTA log parser that produces
  summaries, details, and statistics regarding the operation of Postfix.
<div class="Pp"></div>
This utility can be used as a standalone program, or as a Logwatch filter module
  to produce Postfix summary and detailed reports from within Logwatch.
<div class="Pp"></div>
<b>Postfix-logwatch</b> is able to produce a wide range of reports with data
  grouped and sorted as much as possible to reduce noise and highlight patterns.
  Brief summary reports provide a quick overview of general Postfix operations
  and message delivery, calling out warnings that may require attention.
  Detailed reports provide easy to scan, hierarchically-arranged and organized
  information, with as much or little detail as desired.
<div class="Pp"></div>
<b>Postfix-logwatch</b> outputs two principal sections: a <b>Summary</b> section
  and a <b>Detailed</b> section. For readability and quick scanning, all event
  or hit counts appear in the left column, followed by brief description of the
  event type, and finally additional statistics or count representations may
  appear in the rightmost column.
<div style="height: 1.00em;">&#x00A0;</div>
The following segment from a sample Summary report illustrates:
<div style="margin-left: 4.00ex;">
<pre>
<div class="Pp"></div>
****** Summary ********************************************
<div class="Pp"></div>
      81   *Warning: Connection rate limit reached (anvil)
     146   Warned
<div class="Pp"></div>
  68.310M  Bytes accepted                        71,628,177
  97.645M  Bytes delivered                      102,388,245
========   ================================================
<div class="Pp"></div>
    3464   Accepted                                  41.44%
    4895   Rejected                                  58.56%
--------   ------------------------------------------------
    8359   Total                                    100.00%
========   ================================================
<div class="Pp"></div>
</pre>
</div>
The report warns that anvil's connection rate was hit 81 times, a Postfix access
  check WARN action was logged 146 times, and a total of 68.310 megabytes
  (71,628,177 bytes) were accepted into the Postfix system, delivering 97.645
  megabytes of data (due to multiple recipients). The Accepted and Rejected
  lines show that Postfix accepted 3464 (41.44% of the total messages) and
  rejected 4895 (the remaining 58.56%) of the 8359 total messages (temporary
  rejects show up elsewhere).
<div class="Pp"></div>
There are dozens of sub-sections available in the <b>Detailed</b> report, each
  of whose output can be controlled in various ways. Each sub-section attempts
  to group and present the most meaningful data at superior levels, while
  pushing less useful or <i>noisy</i> data towards inferior levels. The goal is
  to provide as much benefit as possible from smart grouping of data, to allow
  faster report scanning, pattern identification, and problem solving. Data is
  always sorted in descending order by count, and then numerically by IP address
  or alphabetically as appropriate.
<div class="Pp"></div>
The following MX errors segment from a sample <b>Detailed</b> report illustrates
  the basic hierarchical level structure of <b>postfix-logwatch</b>:
<div style="margin-left: 4.00ex;">
<pre>
<div class="Pp"></div>
****** Detailed *******************************************
<div class="Pp"></div>
     261   MX errors --------------------------------------
     261      Unable to look up MX host
     222         Host not found
      73            foolishspammer.local
      60            completely.bogus.domain.example
      11            friend.example.com
      39         No address associated with hostname
      23            dummymx.sample.net
      16            pushn.spam.sample.com
<div class="Pp"></div>
</pre>
</div>
<div class="Pp"></div>
The <b>postfix-logwatch</b> utility reads from STDIN or from the named Postfix
  <i>logfile</i>. Multiple <i>logfile</i> arguments may be specified, each
  processed in order. The user running <b>postfix-logwatch</b> must have read
  permission on each named log file.
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
The options listed below affect the operation of <b>postfix-logwatch</b>.
  Options specified later on the command line override earlier ones. Any option
  may be abbreviated to an unambiguous length.
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f </b><i>config_file</i></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--config_file </b><i>config_file</i></dt>
  <dd class="It-tag">Use an alternate configuration file <i>config_file</i>
      instead of the default. This option may be used more than once. Multiple
      configuration files will be processed in the order presented on the
      command line. See <b>CONFIGURATION FILE</b> below.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--debug </b><i>keywords</i></dt>
  <dd class="It-tag">Output debug information during the operation of
      <b>postfix-logwatch</b>. The parameter <i>keywords</i> is one or more
      comma or space separated keywords. To obtain the list of valid keywords,
      use --debug xxx where xxx is any invalid keyword.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--[no]delays</b></dt>
  <dd class="It-tag">Enables (disables) output of the message delays percentiles
      report. The delays percentiles report shows percentiles for each of the 4
      delivery latency times reported by Postfix (available in version 2.3 and
      later) in the form <b>delays=</b><i>a</i>/<i>b</i>/<i>c</i>/<i>d</i>,
      where <i>a</i> is the amount of time before the active queue (includes
      time for previous delivery attempts and time in the deferred queue),
      <i>b</i> is the amount of time in the active queue up to delivery agent
      handoff, <i>c</i> is the amount of time spent making connections
      (including DNS, HELO and TLS) and <i>d</i> is the amount of time spent
      delivering the message. The total delay shown comes from the <b>delay=</b>
      field in a message delivery log line.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>Note:</b> This report may consume a large amount of memory; if you have
      no use for it, disable the delays report.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--delays_percentiles </b><i>p1 [p2 ...]</i></dt>
  <dd class="It-tag">Specifies the percentiles to be used in the message delays
      percentiles report. The percentiles <i>p1</i>, <i>p2</i>, <i>...</i> range
      from 0 to 100, inclusively. The order of the list is not sorted - the
      report will output the percentiles columns in the order you specify.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--detail </b><i>level</i></dt>
  <dd class="It-tag">Sets the maximum detail level for <b>postfix-logwatch</b>
      to <i>level</i>. This option is global, overriding any other output
      limiters described below.
    <div style="height: 1.00em;">&#x00A0;</div>
    The <b>postfix-logwatch</b> utility produces a <b>Summary</b> section, a
      <b>Detailed</b> section, and additional report sections. With <i>level</i>
      less than 5, <b>postfix-logwatch</b> will produce only the <b>Summary</b>
      section. At <i>level</i> 5 and above, the <b>Detailed</b> section, and any
      additional report sections are candidates for output. Each incremental
      increase in <i>level</i> generates one additional hierarchical sub-level
      of output in the <b>Detailed</b> section of the report. At <i>level</i>
      10, all levels are output. Lines that exceed the maximum report width
      (specified with <b>max_report_width</b>) will be cut. Setting <i>level</i>
      to 11 will prevent lines in the report from being cut (see also
      <b>--line_style</b>).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">Print usage information and a brief description about
      command line options.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ignore_service </b><i>pattern</i></dt>
  <dd class="It-tag">Ignore log lines that contain the postfix service name
      <b>postfix/</b> <i>service</i>. The parameter <i>service</i> is a regular
      expression.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>Note:</b> if you use parenthesis in your regular expression, be sure
      they are cloistering and not capturing: use
      <b>(?:</b><i>pattern</i><b>)</b> instead of
      <b>(</b><i>pattern</i><b>)</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ipaddr_width </b><i>width</i></dt>
  <dd class="It-tag">Specifies that IP addresses in address/hostname pairs
      should be printed with a field width of <i>width</i> characters.
      Increasing the default may be useful for systems using long IPv6
      addresses.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l limiter=levelspec</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--limit limiter=levelspec</b></dt>
  <dd class="It-tag">Sets the level limiter <i>limiter</i> with the
      specification <i>levelspec</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--line_style </b><i>style</i></dt>
  <dd class="It-tag">Specifies how to handle long report lines. Three styles are
      available: <b>full</b>, <b>truncate</b>, and <b>wrap</b>. Setting
      <i>style</i> to <b>full</b> will prevent cutting lines to
      <b>max_report_width</b>; this is what occurs when <b>detail</b> is 11 or
      higher. When <i>style</i> is <b>truncate</b> (the default), long lines
      will be truncated according to <b>max_report_width</b>. Setting
      <i>style</i> to <b>wrap</b> will wrap lines longer than
      <b>max_report_width</b> such that left column hit counts are not obscured.
      This option takes precedence over the line style implied by the
      <b>detail</b> level. The options <b>--full</b>, <b>--truncate</b>, and
      <b>--wrap</b> are synonyms.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--[no]long_queue_ids</b></dt>
  <dd class="It-tag">Enables (disables) interpretation of long queue IDs in
      Postfix (&gt;= 2.9) logs.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--nodetail</b></dt>
  <dd class="It-tag">Disables the <b>Detailed</b> section of the report, and all
      supplemental reports. This option provides a convenient mechanism to
      quickly disable all sections under the <b>Detailed</b> report, where
      subsequent command line options may re-enable one or more sections to
      create specific reports.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--[no]summary</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--show_summary</b></dt>
  <dd class="It-tag">Enables (disables) displaying of the the <b>Summary</b>
      section of the report. The variable Posfix_Show_Summary in used in a
      configuration file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--recipient_delimiter </b><i>delimiter</i></dt>
  <dd class="It-tag">Split email delivery addresses using the recipient
      delimiter character <i>delimiter</i>. This should generally match the
      <b>recipient_delimiter</b> specified in the Postfix parameter file
      <b>main.cf</b>, or the default value indicated in <b>postconf -d
      recipient_delimiter</b>. This is very useful for obtaining per-alias
      statistics when a recipient delimeter is used for mail delivery.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--reject_reply_patterns </b><i>r1 [r2 ...]</i></dt>
  <dd class="It-tag">Specifies the list of reject reply patterns used to create
      reject groups. Each entry in the list <i>r1 [r2 ...]</i> must be either a
      three character regular expression reply code of the form
      [45][0-9.][0-9.], or the word &quot;Warn&quot;. The &quot;.&quot; in the
      regular expression is a literal dot which matches any reject reply
      subcode; this wildcarding allows creation of broad rejects groups. List
      order is preserved, in that reject reports will be output in the same
      order as the entries in the list. Specific reject reply codes will take
      priority over wildcard patterns, regardless of the list order.
    <div style="height: 1.00em;">&#x00A0;</div>
    The default list is &quot;5.. 4.. Warn&quot;, which creates three groups of
      rejects: permanent rejects, temporary reject failures, and reject warnings
      (as in warn_if_reject).
    <div style="height: 1.00em;">&#x00A0;</div>
    This feature allows, for example, distinguishing 421 transmission channel
      closures from 45x errors (eg. 450 mailbox unavailable, 451 local
      processing errors, 452 insufficient storage). Such a grouping would be
      configured with the list: &quot;421 4.. 5.. Warn&quot;. See RFC 2821 for
      more information about reply codes.
    <div style="height: 1.00em;">&#x00A0;</div>
    See also <b>CONFIGURATION FILE</b> regarding using
      <b>reject_reply_patterns</b> within a configuration file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--[no]sect_vars</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--show_sect_vars </b><i>boolean</i></dt>
  <dd class="It-tag">Enables (disables) supplementing each <b>Detailed</b>
      section title with the name of that section's level limiter. The name
      displayed is the command line option (or configuration file variable) used
      to limit that section's output. With the large number of level limiters
      available in <b>postfix-logwatch</b>, this a convenient mechanism for
      determining exactly which level limiter affects a section.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--syslog_name </b><i>namepat</i></dt>
  <dd class="It-tag">Specifies the syslog service name that
      <b>postfix-logwatch</b> uses to match syslog lines. Only log lines whose
      service name matches the perl regular expression <i>namepat</i> will be
      used by <b>postfix-logwatch</b>; all non-matching lines are silently
      ignored. This is useful when a pre-installed Postfix package uses a name
      other than the default ( <b>postfix</b>), or when multiple Postfix
      instances are in use and per-instance reporting is desired.
    <div style="height: 1.00em;">&#x00A0;</div>
    The pattern <i>namepat</i> should match the <b>syslog_name</b> configuration
      parameter specified in the Postfix parameter file <b>main.cf</b>, the
      master control file <b>master.cf</b>, or the default value as indicated by
      the output of <b>postconf -d syslog_name</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>Note:</b> if you use parenthesis in your regular expression, be sure
      they are cloistering and not capturing: use
      <b>(?:</b><i>pattern</i><b>)</b> instead of
      <b>(</b><i>pattern</i><b>)</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--[no]unknown</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--show_unknown </b><i>boolean</i></dt>
  <dd class="It-tag">Enables (disables) display of the postfix-generated name of
      'unknown' in formated IP/hostname pairs in <b>Detailed</b> reports.
      Default: enabled.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--version</b></dt>
  <dd class="It-tag">Print <b>postfix-logwatch</b> version information.</dd>
</dl>
<h2 class="Ss" title="Ss" id="Level_Limiters"><a class="selflink" href="#Level_Limiters">Level
  Limiters</a></h2>
The output of every section in the <b>Detailed</b> report is controlled by a
  level limiter. The name of the level limiter variable will be output when the
  <b>sect_vars</b> option is set. Level limiters are set either via command line
  in standalone mode with <b>--limit </b><i>limiter</i><b>=</b><i>levelspec</i>
  option, or via configuration file variable
  <b>$postfix_</b><i>limiter</i><b>=</b> <i>levelspec</i>. Each limiter requires
  a <i>levelspec</i> argument, which is described below in <b>LEVEL CONTROL</b>.
<div style="height: 1.00em;">&#x00A0;</div>
The list of level limiters is shown below.
<div style="height: 1.00em;">&#x00A0;</div>
There are several level limiters that control reject sub-sections (eg.
  <b>rejectbody</b>, <b>rejectsender</b>, etc.). Because the list of reject
  variants is not known until runtime after <b>reject_reply_patterns</b> is
  seen, these reject limiters are shown below generically, with the prefix
  <b>###</b>. To use one of these reject limiters, substitute <b>###</b> with
  one of the reject reply codes in effect, replacing each dot with an <b>x</b>
  character. For example, using the default <b>reject_reply_patterns</b> list of
  &quot;5.. 4.. Warn&quot;, three <b>rejectbody</b> variants are valid:
  <b>--limit 5xxrejectbody</b>, <b>--limit 4xxrejectbody</b> and <b>--limit
  warnrejectbody</b>. As a convenience, you may entirely eliminate the
  <b>###</b> prefix, and instead use the bare <b>reject</b><i>XXX</i> option,
  and all reject level limiter variations will be auto-generated based on the
  <b>reject_reply_patterns</b> list. For example, the command line segment:
<pre>
<div class="Pp"></div>
    ... --reject_reply_patterns &quot;421 5..&quot; \
            --limit rejectrbl=&quot;1:10:&quot;
<div class="Pp"></div>
</pre>
would automatically become:
<pre>
<div class="Pp"></div>
    ... --reject_reply_patterns &quot;421 5..&quot; \
            --limit 421rejectrbl=&quot;1:10:&quot; --limit 5xxrejectrbl=&quot;1:10:&quot;
<div class="Pp"></div>
</pre>
See <b>reject_reply_patterns</b> above, and comments in the configuration file
  <b>postfix-logwatch.conf</b>.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
[ THIS SECTION IS NOT YET COMPLETE ]
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>AttrError</b></dt>
  <dd class="It-tag">Errors obtaining attribute data from service.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BCCed</b></dt>
  <dd class="It-tag">Messages that triggered access, header_checks or
      body_checks BCC action. (postfix 2.6 experimental branch)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BounceLocal</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BounceRemote</b></dt>
  <dd class="It-tag">Local and remote bounces. A bounce is considered a local
      bounce if the relay was one of none, local, virtual, avcheck, maildrop or
      127.0.0.1.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ByIpRejects</b></dt>
  <dd class="It-tag">Regrouping by client host IP address of all 5xx (permanent)
      reject variants.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CommunicationError</b></dt>
  <dd class="It-tag">Postfix errors talking to one of its services.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Anvil</b></dt>
  <dd class="It-tag">Anvil rate or concurrency limits.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ConnectionInbound</b></dt>
  <dd class="It-tag">Connections made to the <b>smtpd</b> server.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ConnectionLostInbound</b></dt>
  <dd class="It-tag">Connections lost to the <b>smtpd</b> server.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ConnectionLostOutbound</b></dt>
  <dd class="It-tag">Connections lost during <b>smtp</b> communications with
      remote MTA.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ConnectToFailure</b></dt>
  <dd class="It-tag">Failures reported by <b>smtp</b> when connecting to remote
      MTA.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>DatabaseGeneration</b></dt>
  <dd class="It-tag">Warnings noted when binary database map file requires
      <b>postmap</b> update from newer source file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Deferrals</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Deferred</b></dt>
  <dd class="It-tag">Message delivery deferrals. A single <b>deferred</b>
      message will have one or more <b>deferrals</b> many times.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Deliverable</b></dt>
  <dd class="It-tag">Address verification indicates recipient address is
      deliverable.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Delivered</b></dt>
  <dd class="It-tag">Number of messages handed-off to a delivery agent such as
      local or virtual.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Discarded</b></dt>
  <dd class="It-tag">Messages that triggered access, header_checks or
      body_checks DISCARD action.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>DNSError</b></dt>
  <dd class="It-tag">Any one of several errors encounted during DNS
    lookups.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>EnvelopeSenderDomains</b></dt>
  <dd class="It-tag">List of sending domains. (2 levels: envelope sender domain,
      localpart)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>EnvelopeSenders</b></dt>
  <dd class="It-tag">List of envelope senders. (1 level: envelope sender)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Error</b></dt>
  <dd class="It-tag">Postfix general <b>error</b> messages.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>FatalConfigError</b></dt>
  <dd class="It-tag">Fatal main.cf or master.cf configuration errors.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>FatalError</b></dt>
  <dd class="It-tag">Postfix general <b>fatal</b> messages.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Filtered</b></dt>
  <dd class="It-tag">Messages that triggered access, header_checks or
      body_checks FILTER action.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Forwarded</b></dt>
  <dd class="It-tag">Messages forwarded by MDA for one address class to another
      (eg. local -&gt; virtual).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>HeloError</b></dt>
  <dd class="It-tag">XXXXXXXXXXX</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Hold</b></dt>
  <dd class="It-tag">Messages that were placed on hold by postsuper, or
      triggered by access, header_checks or body_checks HOLD action.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>HostnameValidationError</b></dt>
  <dd class="It-tag">Invalid hostname detected.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>HostnameVerification</b></dt>
  <dd class="It-tag">Lookup of hostname does not map back to the IP of the peer
      (ie. the remote system connecting to <b>smtpd</b>). Also known as
      forward-confirmed reverse DNS (FCRDNS). When the reverse name has no DNS
      entry, the message &quot;host not found, try again&quot; is included;
      otherwise, it is not (e.g. when the reverse has some IP address, but not
      the one Postfix expects).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>IllegalAddrSyntax</b></dt>
  <dd class="It-tag">Illegal syntax in an email address provided during the MAIL
      FROM or RCPT TO dialog.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>LdapError</b></dt>
  <dd class="It-tag">Any LDAP errors during LDAP lookup.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MailerLoop</b></dt>
  <dd class="It-tag">An MX lookup for the best mailer to use to deliver mail
      would result in a sending to ourselves.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MapProblem</b></dt>
  <dd class="It-tag">Problem with an access table map that needs
    correcting.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MessageWriteError</b></dt>
  <dd class="It-tag">Postfix encountered an error when trying to create a
      message file somewhere in the spool directory.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>NumericHostname</b></dt>
  <dd class="It-tag">A hostname was found that was numeric, instead of
      alphabetic.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>PanicError</b></dt>
  <dd class="It-tag">Postfix general <b>panic</b> messages.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>PixWorkaround</b></dt>
  <dd class="It-tag">Workarounds were enabled to avoid remote Cisco PIX SMTP
      &quot;fixups&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>PolicydWeight</b></dt>
  <dd class="It-tag">Summarization of policyweight/policydweight results.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>PolicySpf</b></dt>
  <dd class="It-tag">Summarization of PolicySPF results.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Postgrey</b></dt>
  <dd class="It-tag">Summarization of Postgrey results.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Postscreen</b></dt>
  <dd class="It-tag">Summarization of 2.7's postscreen and verify services.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>DNSBLog</b></dt>
  <dd class="It-tag">Summarization of 2.7's dnsblog service.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Prepended</b></dt>
  <dd class="It-tag">Messages that triggered header_checks or body_checks
      PREPEND action.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ProcessExit</b></dt>
  <dd class="It-tag">Postfix services that exited unexpectedly.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ProcessLimit</b></dt>
  <dd class="It-tag">A Postfix service has reached or exceeded the maximum
      number of processes allowed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>QueueWriteError</b></dt>
  <dd class="It-tag">Problems writing a Postfix queue file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>RblError</b></dt>
  <dd class="It-tag">Lookup errors for RBLs.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Redirected</b></dt>
  <dd class="It-tag">Messages that triggered access, header_checks or
      body_checks REDIRECT action.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectBody</b></dt>
  <dd class="It-tag">Messages that triggered body_checks REJECT action.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectClient</b></dt>
  <dd class="It-tag">Messages rejected by client access controls
      (smtpd_client_restrictions).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectConfigError</b></dt>
  <dd class="It-tag">Message rejected due to server configuration errors.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectContent</b></dt>
  <dd class="It-tag">Messages rejected by message_reject_characters.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectData</b></dt>
  <dd class="It-tag">Messages rejected at DATA stage in SMTP conversation
      (smtpd_data_restrictions).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectEtrn</b></dt>
  <dd class="It-tag">Messages rejected at ETRN stage in SMTP conversation
      (smtpd_etrn_restrictions).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectHeader</b></dt>
  <dd class="It-tag">Messages that triggered header_checks REJECT action.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectHelo</b></dt>
  <dd class="It-tag">Messages rejected at HELO/EHLO stage in SMTP conversation
      (smtpd_helo_restrictions).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectInsufficientSpace</b></dt>
  <dd class="It-tag">Messages rejected due to insufficient storage space.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectLookupFailure</b></dt>
  <dd class="It-tag">Messages rejected due to temporary DNS lookup
    failures.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectMilter</b></dt>
  <dd class="It-tag">Milter rejects. No reject reply code is available for these
      rejects, but an extended 5.7.1 DSN is provided. These rejects are forced
      into the generic 5xx rejects group. If you redefine
      <b>reject_reply_patterns</b> such that it does not contain the pattern
      <b>5..</b>, milter rejects will not be output.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectRbl</b></dt>
  <dd class="It-tag">Messages rejected by an RBL hit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectRecip</b></dt>
  <dd class="It-tag">Messages rejected by recipient access controls
      (smtpd_recipient_restrictions).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectRelay</b></dt>
  <dd class="It-tag">Messages rejected by relay access controls.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectSender</b></dt>
  <dd class="It-tag">Messages rejected by sender access controls
      (smtpd_sender_restrictions).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectSize</b></dt>
  <dd class="It-tag">Messages rejected due to excessive message size.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectUnknownClient</b></dt>
  <dd class="It-tag">Messages rejected by unknown client access controls.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectUnknownReverseClient</b></dt>
  <dd class="It-tag">Messages rejected by unknown reverse client access
      controls.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectUnknownUser</b></dt>
  <dd class="It-tag">Messages rejected by unknown user access controls.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectUnverifiedClient</b></dt>
  <dd class="It-tag">Messages rejected by unverified client access
    controls.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>###RejectVerify</b></dt>
  <dd class="It-tag">Messages rejected dueo to address verification
    failures.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Replaced</b></dt>
  <dd class="It-tag">Messages that triggered header_checks or body_checks
      REPLACE action.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ReturnedToSender</b></dt>
  <dd class="It-tag">Messages returned to sender due to exceeding queue lifetime
      (maximal_queue_lifetime).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SaslAuth</b></dt>
  <dd class="It-tag">SASL authentication successes, includes SASL method,
      username, and sender when present.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SaslAuthFail</b></dt>
  <dd class="It-tag">SASL authentication failures.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Sent</b></dt>
  <dd class="It-tag">Messages sent via the SMTP delivery agent.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SentLmtp</b></dt>
  <dd class="It-tag">Messages sent via the LMTP delivery agent.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SmtpConversationError</b></dt>
  <dd class="It-tag">Errors during the SMTP/ESMTP dialog.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SmtpProtocolViolation</b></dt>
  <dd class="It-tag">Protocol violation during the SMTP/ESMTP dialog.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>StartupError</b></dt>
  <dd class="It-tag">Errors during Postfix server startup.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>TimeoutInbound</b></dt>
  <dd class="It-tag">Connections to <b>smtpd</b> that timed out.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>TlsClientConnect</b></dt>
  <dd class="It-tag">TLS client connections.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>TlsOffered</b></dt>
  <dd class="It-tag">TLS communication offerred.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>TlsServerConnect</b></dt>
  <dd class="It-tag">TLS server connections.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>TlsUnverified</b></dt>
  <dd class="It-tag">Unverified TLS connections.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Undeliverable</b></dt>
  <dd class="It-tag">Address verification indicates recipient address is
      undeliverable.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Warn</b></dt>
  <dd class="It-tag">Messages that triggered access, header_checks or
      body_checks WARN action.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>WarnConfigError</b></dt>
  <dd class="It-tag">Warnings regarding Postfix configuration errors.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>WarningsOther</b></dt>
  <dd class="It-tag">Postfix general <b>warning</b> messages.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="LEVEL_CONTROL"><a class="selflink" href="#LEVEL_CONTROL">LEVEL
  CONTROL</a></h1>
<br/>
The <b>Detailed</b> section of the report consists of a number of sub-sections,
  each of which is controlled both globally and independently. Two settings
  influence the output provided in the <b>Detailed</b> report: a global detail
  level (specified with <b>--detail</b>) which has final (big hammer)
  output-limiting control over the <b>Detailed</b> section, and sub-section
  specific detail settings (small hammer), which allow further limiting of the
  output for a sub-section. Each sub-section may be limited to a specific depth
  level, and each sub-level may be limited with top N or threshold limits. The
  <i>levelspec</i> argument to each of the level limiters listed above is used
  to accomplish this.
<div style="height: 1.00em;">&#x00A0;</div>
It is probably best to continue explanation of sub-level limiting with the
  following well-known outline-style hierarchy, and some basic examples:
<pre>
<div class="Pp"></div>
    level 0
       level 1
          level 2
             level 3
                level 4
                level 4
          level 2
             level 3
                level 4
                level 4
                level 4
             level 3
                level 4
             level 3
       level 1
          level 2
             level 3
                level 4
</pre>
<div class="Pp"></div>
The simplest form of output limiting suppresses all output below a specified
  level. For example, a <i>levelspec</i> set to &quot;2&quot; shows only data in
  levels 0 through 2. Think of this as collapsing each sub-level 2 item, thus
  hiding all inferior levels (3, 4, ...), to yield:
<pre>
<div class="Pp"></div>
    level 0
       level 1
          level 2
          level 2
       level 1
          level 2
</pre>
<div class="Pp"></div>
Sometimes the volume of output in a section is too great, and it is useful to
  suppress any data that does not exceed a certain threshold value. Consider a
  dictionary spam attack, which produces very lengthy lists of hit-once
  recipient email or IP addresses. Each sub-level in the hierarchy can be
  threshold-limited by setting the <i>levelspec</i> appropriately. Setting
  <i>levelspec</i> to the value &quot;2::5&quot; will suppress any data at level
  2 that does not exceed a hit count of 5.
<div class="Pp"></div>
Perhaps producing a top N list, such as top 10 senders, is desired. A
  <i>levelspec</i> of &quot;3:10:&quot; limits level 3 data to only the top 10
  hits.
<div class="Pp"></div>
With those simple examples out of the way, a <i>levelspec</i> is defined as a
  whitespace- or comma-separated list of one or more of the following:
<dl class="Bl-tag">
  <dt class="It-tag"><i>l</i></dt>
  <dd class="It-tag">Specifies the maximum level to be output for this
      sub-section, with a range from 0 to 10. if <i>l</i> is 0, no levels will
      be output, effectively disabling the sub-section (level 0 data is already
      provided in the Summary report, so level 1 is considered the first useful
      level in the <b>Detailed</b> report). Higher values will produce output up
      to and including the specified level.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>l</i><b>.</b><i>n</i></dt>
  <dd class="It-tag">Same as above, with the addition that <i>n</i> limits this
      section's level 1 output to the top <i>n</i> items. The value for <i>n</i>
      can be any integer greater than 1. (This form of limiting has less utility
      than the syntax shown below. It is provided for backwards compatibility;
      users are encouraged to use the syntax below).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>l</i><b>:</b><i>n</i><b>:</b><i>t</i></dt>
  <dd class="It-tag">This triplet specifies level <i>l</i>, top <i>n</i>, and
      minimum threshold <i>t</i>. Each of the values are integers, with <i>l</i>
      being the level limiter as described above, <i>n</i> being a top <i>n</i>
      limiter for the level <i>l</i>, and <i>t</i> being the threshold limiter
      for level <i>l</i>. When both <i>n</i> and <i>t</i> are specified,
      <i>n</i> has priority, allowing top <i>n</i> lists (regardless of
      threshold value). If the value of <i>l</i> is omitted, the specified
      values for <i>n</i> and/or <i>t</i> are used for all levels available in
      the sub-section. This permits a simple form of wildcarding (eg. place
      minimum threshold limits on all levels). However, specific limiters always
      override wildcard limiters. The first form of level limiter may be
      included in <i>levelspec</i> to restrict output, regardless of how many
      triplets are present.</dd>
</dl>
<div class="Pp"></div>
All three forms of limiters are effective only when <b>postfix-logwatch</b>'s
  detail level is 5 or greater (the <b>Detailed</b> section is not activated
  until detail is at least 5).
<div class="Pp"></div>
See the <b>EXAMPLES</b> section for usage scenarios.
<h1 class="Sh" title="Sh" id="CONFIGURATION_FILE"><a class="selflink" href="#CONFIGURATION_FILE">CONFIGURATION
  FILE</a></h1>
<b>Postfix-logwatch</b> can read configuration settings from a configuration
  file. Essentially, any command line option can be placed into a configuration
  file, and these settings are read upon startup.
<div style="height: 1.00em;">&#x00A0;</div>
Because <b>postfix-logwatch</b> can run either standalone or within Logwatch, to
  minimize confusion, <b>postfix-logwatch</b> inherits Logwatch's configuration
  file syntax requirements and conventions. These are:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">White space lines are ignored.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Lines beginning with <b>#</b> are ignored</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Settings are of the form:
    <pre>
<div class="Pp"></div>
         <i>option</i><b> = </b><i>value</i>
<div class="Pp"></div>
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Spaces or tabs on either side of the <b>=</b> character are
      ignored.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Any <i>value</i> protected in double quotes will be
      case-preserved.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">All other content is reduced to lowercase (non-preserving,
      case insensitive).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">All <b>postfix-logwatch</b> configuration settings must be
      prefixed with &quot; <b>$postfix_</b>&quot; or <b>postfix-logwatch</b>
      will ignore them.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">When running under Logwatch, any values not prefixed with
      &quot; <b>$postfix_</b>&quot; are consumed by Logwatch; it only passes to
      <b>postfix-logwatch</b> (via environment variable) settings it considers
      valid.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The values <b>True</b> and <b>Yes</b> are converted to 1,
      and <b>False</b> and <b>No</b> are converted to 0.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Order of settings is not preserved within a configuration
      file (since settings are passed by Logwatch via environment variables,
      which have no defined order).</dd>
</dl>
<div class="Pp"></div>
To include a command line option in a configuration file, prefix the command
  line option name with the word &quot; <b>$postfix_</b>&quot;. The following
  configuration file setting and command line option are equivalent:
<pre>
<div class="Pp"></div>
         <b>$postfix_Line_Style = Truncate</b>
<div class="Pp"></div>
         <b>--line_style Truncate</b>
<div class="Pp"></div>
</pre>
Level limiters are also prefixed with <b>$postfix_</b>, but on the command line
  are specified with the <b>--limit</b> option:
<pre>
<div class="Pp"></div>
         <b>$postfix_Sent = 2</b>
<div class="Pp"></div>
         <b>--limit Sent=2</b>
<div class="Pp"></div>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
The order of command line options and configuration file processing occurs as
  follows: 1) The default configuration file is read if it exists and no
  <b>--config_file</b> was specified on a command line. 2) Configuration files
  are read and processed in the order found on the command line. 3) Command line
  options override any options already set either via command line or from any
  configuration file.
<div style="height: 1.00em;">&#x00A0;</div>
Command line options are interpreted when they are seen on the command line, and
  later options will override previously set options. The notable exception is
  with limiter variables, which are interpreted in the order found, but only
  after all other options have been processed. This allows
  <b>--reject_reply_patterns</b> to determine the dynamic list of the various
  reject limiters.
<div style="height: 1.00em;">&#x00A0;</div>
See also <b>--reject_reply_patterns</b>.
<h1 class="Sh" title="Sh" id="EXIT_STATUS"><a class="selflink" href="#EXIT_STATUS">EXIT
  STATUS</a></h1>
<br/>
The <b>postfix-logwatch</b> utility exits with a status code of 0, unless an
  error occurred, in which case a non-zero exit status is returned.
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<br/>
<h2 class="Ss" title="Ss" id="Running_Standalone"><a class="selflink" href="#Running_Standalone">Running
  Standalone</a></h2>
<b>Note:</b> <b>postfix-logwatch</b> reads its log data from one or more named
  Postfix log files, or from STDIN. For brevity, where required, the examples
  below use the word <i>file</i> as the command line argument meaning
  <i>/path/to/postfix.log</i>. Obviously you will need to substitute <i>file</i>
  with the appropriate path.
<div class="Pp"></div>
<pre>
To run  <b>postfix-logwatch</b> in standalone mode, simply run:
</pre>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>postfix-logwatch </b><i>file</i>
</pre>
</div>
<div class="Pp"></div>
<pre>
A complete list of options and basic usage is available via:
</pre>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>postfix-logwatch --help</b>
</pre>
</div>
<div class="Pp"></div>
<pre>
To print a summary only report of Postfix log data:
</pre>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>postfix-logwatch --detail 1 </b><i>file</i>
</pre>
</div>
<br/>
<div class="Pp"></div>
To produce a summary report and a one-level detail report for May 25th:
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>grep 'May 25' </b><i>file</i><b> | postfix-logwatch --detail 5</b>
</pre>
</div>
<br/>
<div class="Pp"></div>
To produce only a top 10 list of Sent email domains, the summary report and
  detailed reports are first disabled. Since commands line options are read and
  enabled left-to-right, the Sent section is re-enabled to level 1 with a level
  1 top 10 limiter:
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>postfix-logwatch --nosummary --nodetail --limit sent='1 1:10:' </b><i>file</i>
</pre>
</div>
<br/>
<div class="Pp"></div>
The following command and its sample output shows a more complex level limiter
  example. The command gives the top 3 Sent email addresses from the top 5
  domains, in addition, all level 3 items with a hit count of 2 or less are
  suppressed (in the Sent sub-section, this happens to be email's Original To
  address). Ellipses indicate top N or threshold-limited data:
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>postfix-logwatch --nosummary --nodetail \</b>
<b>        --limit sent '1:5: 2:3: 3::2' </b><i>file</i>
<div class="Pp"></div>
1762   Sent via SMTP -----------------------------------
 352      example.com
 310         joe
 255            joe.bob@virtdomain.example.com
   7            info@virtdomain.example.com
  21         pooryoda3
  11         hot93uh
             ...
 244      sample.net
  97         buzz
  26         leroyjones
  14         sally
             ...
 152      example.net
  40         jim_jameson
  23         sam_sampson
  19         paul_paulson
             ...
  83      sample.us
  44         root
  39         jenny1
  69      dom3.example.us
  10         kay
   7         ron
   6         mrsmith
             ...
          ...
</pre>
</div>
<br/>
<div class="Pp"></div>
The next command uses both <b>reject_reply_patterns</b> and level limiters to
  see 421 RBL rejects, threshold-limiting level 2 output to hits greater than 5
  (level 2 in the Reject RBL sub-section is the client's IP address / hostname
  pair). This makes for a very nice RBL offenders list, shown in the sample
  output (note the use of the unambiguous, abbreviated command line option
  reject_reply_pat):
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>postfix-logwatch --reject_reply_pat '421 4.. 5.. Warn' \</b>
<b>        --nosummary --nodetail --limit 421rejectrbl='2 2::5' </b><i>file</i>
<div class="Pp"></div>
300   421 Reject RBL ---------------------------------------
243      zen.spamhaus.org=127.0.0.2
106         10.0.0.129       129.0.0.example.com
 41         192.168.10.70    hostx10.sample.net
 40         192.168.42.39    hostz42.sample.net
 15         10.1.1.152       dsl-10-1-1-152.example.us
 14         10.10.10.122     mail122.sample.com
  7         192.168.3.44     smalltime-spammer.example.com
            ...
 48      zen.spamhaus.org=127.0.0.4
 17         10.29.124.92     10-29-124-92.adsl-static.sample.us
            ...
  8      zen.spamhaus.org=127.0.0.11
            ...
  1      zen.spamhaus.org=127.0.0.10
            ...
</pre>
</div>
<h2 class="Ss" title="Ss" id="Running_within_Logwatch"><a class="selflink" href="#Running_within_Logwatch">Running
  within Logwatch</a></h2>
<b>Note:</b> Logwatch versions prior to 7.3.6, unless configured otherwise,
  required the <b>--print</b> option to print to STDOUT instead of sending
  reports via email. Since version 7.3.6, STDOUT is the default output
  destination, and the <b>--print</b> option has been replaced by <b>--output
  stdout</b>. Check your configuration to determine where report output will be
  directed, and add the appropriate option to the commands below.
<div class="Pp"></div>
To print a summary report for today's Postfix log data:
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>logwatch --service postfix --range today --detail 1</b>
</pre>
</div>
<div class="Pp"></div>
<pre>
To print a report for today's Postfix log data, with one level
of detail in the  <b>Detailed</b> section:
</pre>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>logwatch --service postfix --range today --detail 5</b>
</pre>
</div>
<br/>
<div class="Pp"></div>
To print a report for yesterday, with two levels of detail in the
  <b>Detailed</b> section:
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>logwatch --service postfix --range yesterday --detail 6</b>
</pre>
</div>
<br/>
<div class="Pp"></div>
To print a report from Dec 12th through Dec 14th, with four levels of detail in
  the <b>Detailed</b> section:
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>logwatch --service postfix --range \</b>
<b>        'between 12/12 and 12/14' --detail 8</b>
</pre>
</div>
<div class="Pp"></div>
<pre>
To print a report for today, with all levels of detail:
</pre>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>logwatch --service postfix --range today --detail 10</b>
</pre>
</div>
<div class="Pp"></div>
<pre>
Same as above, but leaves long lines uncut:
</pre>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>logwatch --service postfix --range today --detail 11</b>
</pre>
</div>
<pre>
<div class="Pp"></div>
</pre>
<h1 class="Sh" title="Sh" id="ENVIRONMENT"><a class="selflink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
<br/>
The <b>postfix-logwatch</b> program uses the following (automatically set)
  environment variables when running under Logwatch:
<dl class="Bl-tag">
  <dt class="It-tag"><b>LOGWATCH_DETAIL_LEVEL</b></dt>
  <dd class="It-tag">This is the detail level specified with the Logwatch
      command line argument <b>--detail</b> or the <b>Detail</b> setting in the
      ...conf/services/postfix.conf configuration file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>LOGWATCH_DEBUG</b></dt>
  <dd class="It-tag">This is the debug level specified with the Logwatch command
      line argument <b>--debug</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>postfix_</b><i>xxx</i></dt>
  <dd class="It-tag">The Logwatch program passes all settings
      <b>postfix_</b><i>xxx</i> in the configuration file
      ...conf/services/postfix.conf to the <b>postfix</b> filter (which is
      actually named .../scripts/services/postfix) via environment
    variable.</dd>
</dl>
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
<h2 class="Ss" title="Ss" id="Standalone_mode"><a class="selflink" href="#Standalone_mode">Standalone
  mode</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag">/usr/local/bin/postfix-logwatch</dt>
  <dd class="It-tag">The <b>postfix-logwatch</b> program</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">/usr/local/etc/postfix-logwatch.conf</dt>
  <dd class="It-tag">The <b>postfix-logwatch</b> configuration file in
      standalone mode</dd>
</dl>
<h2 class="Ss" title="Ss" id="Logwatch_mode"><a class="selflink" href="#Logwatch_mode">Logwatch
  mode</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag">/etc/logwatch/scripts/services/postfix</dt>
  <dd class="It-tag">The Logwatch <b>postfix</b> filter</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">/etc/logwatch/conf/services/postfix.conf</dt>
  <dd class="It-tag">The Logwatch <b>postfix</b> filter configuration file</dd>
</dl>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<pre>
logwatch(8), system log analyzer and reporter
</pre>
<h1 class="Sh" title="Sh" id="README_FILES"><a class="selflink" href="#README_FILES">README
  FILES</a></h1>
<pre>
README, an overview of  <b>postfix-logwatch</b>
Changes, the version change list history
Bugs, a list of the current bugs or other inadequacies
Makefile, the rudimentary installer
LICENSE, the usage and redistribution licensing terms
</pre>
<h1 class="Sh" title="Sh" id="LICENSE"><a class="selflink" href="#LICENSE">LICENSE</a></h1>
<pre>
Covered under the included MIT/X-Consortium License:
http://www.opensource.org/licenses/mit-license.php
</pre>
<h1 class="Sh" title="Sh" id="AUTHOR(S)"><a class="selflink" href="#AUTHOR(S)">AUTHOR(S)</a></h1>
<pre>
Mike Cappella
<div class="Pp"></div>
</pre>
The original <b>postfix</b> Logwatch filter was written by Kenneth Porter, and
  has had many contributors over the years. They are entirely not responsible
  for any errors, problems or failures since the current author's hands have
  touched the source code.</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
