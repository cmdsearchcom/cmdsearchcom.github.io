<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 15:57:13 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>CALAMARIS(1) Calamaris Manual CALAMARIS(1)</p>

<p style="margin-top: 1em">NAME <br>
calamaris - generate text and graphical statistics out of
log files from Proxy-Cache-Servers</p>

<p style="margin-top: 1em">SYNOPSIS <br>
cat log | calamaris [ --config-file .../calamaris.conf ] [
switches ]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Calamaris is used to produce statistical output from Squid,
NetCache, Inktomi Traffic Server, Oops! proxy server, Compaq
Tasksmart, Cisco Content Engines or related Proxy log <br>
files. The resulting output can be ascii or html with or
without graphic and with or without frames. It is possible
to cache calculated data in a file to use them in later
runs.</p>

<p style="margin-top: 1em">This manual page describes the
options of Calamaris and gives a few examples.</p>

<p style="margin-top: 1em">OPTIONS <br>
Configuration File <br>
--config-file file</p>

<p style="margin-top: 1em">Not all reports and modification
can be made through command-line-switches. To use all
options of Calamaris you&Acirc;&acute;ll have to use the
configuration file. You&rsquo;ll find the <br>
configuration-directives below, always inside of braces.
Examples are in the calamaris.conf which should come with
this package.</p>

<p style="margin-top: 1em">Reports <br>
--all-useful-reports|-a <br>
extracts all useful reports available, --all-useful-reports
equals --size-distribution-report 10 --domain-report 20
--performance-report 60 --requester-report 20 --status- <br>
report --type-report 20 --response-time-report
--errorcode-distribution-report</p>

<p style="margin-top: 1em">--domain-report|-d n
($domain_report) <br>
switches the top level and the second level report on. The
data is derived from the URL. The output is limited by n.
(-1 is unlimited)</p>

<p style="margin-top: 1em">--domain-report-limit n
($domain_report_limit) <br>
limit the domain-report to lines which have n or more
requests.</p>

<p style="margin-top: 1em">--domain-report-n-level|-N n
($domain_report_n_level) <br>
All URL-Host reports will be switched from 2nd-level to
n-level-reports. (-1 shows a full urlhost-report)</p>

<p style="margin-top: 1em">Note: This option is only useful
with activated domain-report.</p>

<p style="margin-top: 1em">--errorcode-distribution-report
($errorcode_distribution_report) <br>
shows the Response code distribution over all objects</p>

<p style="margin-top: 1em">($object_freshness_report) <br>
shows the freshness of objects in your cache. Calamaris
looks for freshness tags like &rsquo;TCP_HIT&rsquo;,
&rsquo;TCP_REFRESH_MISS&rsquo;, ... and make statistics on
it. With this information <br>
you can optimize the caching behaviour of your cache
depending on the objects content type. E.g. squid admins
could use this information to configure the refresh_pattern.
<br>
This option needs more configuration in the
configuration-file.</p>

<p style="margin-top: 1em">--peak-report|-p type
($peak_report) <br>
Measures the peaks of the Proxy usage in requests per
second, per minute and per hour. It reports peaks for TCP,
UDP and ALL requests. If set to &rsquo;old&rsquo; these
values were <br>
calculated with the old slow method, if set to
&rsquo;new&rsquo; the new faster (but still slow) method is
used.</p>

<p style="margin-top: 1em">--performance-report|-P n
($performance_report) <br>
Shows the throughput of TCP requests for every n
minutes.</p>

<p style="margin-top: 1em">--performance-report-adjust|-T n
($performance_report_adjust) <br>
Time: Adjust the Performancereport in minutes for non
GMT-Timezoners.</p>

<p style="margin-top: 1em">--requester-report|-r n
($requester_report) <br>
Switches the UDP and TCP requester reports on. The output is
limited by n. (-1 is unlimited)</p>


<p style="margin-top: 1em">--requester-report-no-dns-lookup|-n
($requester_report_no_dns_lookup) <br>
Switches the IP lookup for the requesters off.</p>


<p style="margin-top: 1em">--requester-report-use-user-info|-u
($requester_report_use_user_info) <br>
Switches the usage of eventually available ident information
for requester reports on.</p>

<p style="margin-top: 1em">Warning: This breaks the privacy
of your users! (see PRIVACY-Section below)</p>


<p style="margin-top: 1em">--requester-report-with-targets|-R
n ($requester_report_with_targets) <br>
adds to each line of the requester report the requested
URLs. The output is limited by n. (-1 is unlimited, and can
result in very very long reports.)</p>

<p style="margin-top: 1em">Warning: Using this option
breaks the privacy of your users! (see PRIVACY-Section
below)</p>

<p style="margin-top: 1em">--response-time-report
($response_time_report) <br>
sums up the time distribution over all objects</p>


<p style="margin-top: 1em">(@response_time_report_interval)
<br>
This array defines the time steps, which should be reported
in the response-time-report.</p>

<p style="margin-top: 1em">--size-distribution-report|-D n
($size_distribution_report) <br>
shows size-based distribution of requested objects, smaller
numbers result in more verbose reports. (choose 2, 10 or 100
for useful output.)</p>

<p style="margin-top: 1em">--status-report|-s
($status_report) <br>
alters the default behaviour of Calamaris and makes the
status reports more verbose.</p>

<p style="margin-top: 1em">--type-report|-t n
($type_report) <br>
switches the content type and the file extension report on.
The output is limited by n. (-1 is unlimited)</p>

<p style="margin-top: 1em">--type-report-ignore-case|-c
($type_report_ignore_case) <br>
Switch to case-insensitive. This is useful for the
&rsquo;Requested extensions&rsquo; report.</p>

<p style="margin-top: 1em">Input <br>
--input-format|-f type ($input_format) <br>
sets the type of input logfiles. If set to</p>

<p style="margin-top: 1em">&rsquo;auto&rsquo; Calamaris
tries to guess the input file format. This is the
Default.</p>

<p style="margin-top: 1em">Note: If the first line of your
input file is corrupted, Calamaris will stop with an
error.</p>

<p style="margin-top: 1em">&rsquo;squid&rsquo; Calamaris
expects native logfile derived from Squid V1.1.beta26-V2.x
or OOPS.</p>

<p style="margin-top: 1em">&rsquo;squid-extended&rsquo;
Calamaris expects native logfile derived from Squid
V1.1.alpha1-V2.x with log_mime_hdrs enabled or Squid with
Smartfilter-Patch or squid-style logfiles <br>
out of Cisco Content Engines. (This only enables parsing of
these kind of logfile, the additional data will be
ignored.)</p>

<p style="margin-top: 1em">(Logging of MIME-Headers breaks
the privacy of your users! (see PRIVACY-Section below)</p>

<p style="margin-top: 1em">&rsquo;squid-old&rsquo;
Calamaris expects native logfile derived from Squid
V1.1.alpha1-V1.1.beta25.</p>

<p style="margin-top: 1em">&rsquo;nc&rsquo; Calamaris
expects Logfiles from NetCache up to V4.x. (Please see the
README on this.)</p>

<p style="margin-top: 1em">&rsquo;its&rsquo; Calamaris
expects Logfiles from Inktomi Traffic Server.</p>

<p style="margin-top: 1em">&rsquo;elff&rsquo; Calamaris
expects Logfiles in Extended Logfile Format (i.e. from
Compaq Tasksmart, Novell Internet Caching System or NetCache
V5.x)</p>

<p style="margin-top: 1em">&rsquo;nse&rsquo; Calamaris
expects Logfiles in Netscape Extended-1 or Netscape
Extended-2 Logfile Format (from Netscape/iPlanet/SunOne
Proxy-Server )</p>

<p style="margin-top: 1em">--ipfilter-exclude IP/range
($ipfilter_exclude) <br>
all IPs are analyzed, except IP/range. Format:
1.1.1.1/32:1.1.2.0/24 or
1.1.1.1/255.255.255.255:1.1.2.0/255.255.255.0</p>

<p style="margin-top: 1em">IP list separated by
&rsquo;:&rsquo; This switch needs the perl Module
NetAddr::IP.</p>

<p style="margin-top: 1em">Warning: This breaks the privacy
of your users! (see PRIVACY-Section below)</p>

<p style="margin-top: 1em">--ipfilter-include IP/range
($ipfilter_include) <br>
no IPs are analyzed, except IP/range. Format: see
--ipfilter-exclude</p>

<p style="margin-top: 1em">Warning: This breaks the privacy
of your users! (see PRIVACY-Section below)</p>

<p style="margin-top: 1em">--no-input|-z ($no_input) <br>
Switches reading from standard input off. You can use this
to merge many cache files to one (see --cache-input-file and
--cache-output-file) or to generate a report out <br>
of cache files.</p>

<p style="margin-top: 1em">--time-interval|-I t-t
($time_interval) <br>
defines which time-interval should be parsed. t has to be
the format yyyymmddhhmmss (localtime)</p>

<p style="margin-top: 1em">Note: omitting the beginning or
ending date is allowed.</p>

<p style="margin-top: 1em">Output <br>
Standard output format is plain ascii with 80 chars
width.</p>

<p style="margin-top: 1em">($column1_color) <br>
($column2_color) defines the colors for the columns in
graphics. (only useful with --output-format graph)</p>

<p style="margin-top: 1em">($formats[n]) <br>
Through the config-file you are able to modify the width of
the report and alter the culomns that are displayed in the
reports. n is the number of the report, as displayed <br>
by --help in the --show-reports-option.</p>

<p style="margin-top: 1em">--hostname|-H name ($hostname)
<br>
The name for the title or subject of the output. If set to
&rsquo;lookup&rsquo; Calamaris looks up the host name of the
system its been run on.</p>

<p style="margin-top: 1em">--image-type ($image_type) <br>
Sets the image type to gif, png, jpeg, gd or gd2. Only
useful when --output-format graph is set. The available
images types are dependend on your GD::Graph installation.
<br>
Default is &rsquo;png&rsquo;.</p>

<p style="margin-top: 1em">--logo|-l string ($logo) <br>
add a custom string to a HTML-Report. It&rsquo;ll be added
to a table on the top of the output. -l &rsquo;&lt;A
HREF=&quot;http://cord.de/&quot;&gt;&lt;IMG BORDER=0 <br>
SRC=&quot;http://cord.de/Images/cord/cordlog2n.gif&quot;
ALT=&quot;Cord&quot;&gt;&lt;/A&gt;&rsquo; will add my logo
with a link to the Report.</p>

<p style="margin-top: 1em">Note: --logo works only in
combination with --output-format html or html-frame</p>

<p style="margin-top: 1em">--meta|-M string ($meta) <br>
Meta: adds a custom string or the content of a file into the
&lt;HEAD&gt; of a HTML-Report. Useful if you want to add
Stylesheets or something to the Report.</p>

<p style="margin-top: 1em">Note: --meta works only in
combination with --output-format html or html-frame</p>

<p style="margin-top: 1em">--output-format|-F
type[,type[,type[,...]]] ($output_format) <br>
Format: sets the format of the output-report. If set to</p>

<p style="margin-top: 1em">&rsquo;mail&rsquo; adds a
subject header to the beginning of the report.</p>

<p style="margin-top: 1em">&rsquo;html&rsquo; all output is
given in html with tables. Can be combined with
&rsquo;mail&rsquo; to send html mails.</p>

<p style="margin-top: 1em">&rsquo;html-frame&rsquo; all
output is given in html frames with tables.</p>

<p style="margin-top: 1em">&rsquo;html-embed&rsquo; all
output is given in html with tables without HTML-Headers.
Useful for Server-Side-Includes.</p>

<p style="margin-top: 1em">&rsquo;graph&rsquo; enables
graphics for html, html-embed or html-frame.</p>

<p style="margin-top: 1em">&rsquo;unformatted&rsquo; gives
out the raw numbers separated by spaces. Useful for re-using
the output in other scripts. If you use this along with -U,
the byte values are calculated <br>
in the given Unit, and displayed without indication along
with the numbers. the indication moves up to the header of
the report.</p>

<p style="margin-top: 1em">--output-path ($output_path)
<br>
output calamaris statistics to /path. In case of graph
output, the graphics destination is /path and the filename
is index.html, else it is calamaris.txt. If --output- <br>
path is not given, all graphics are written to the working
directory.</p>

<p style="margin-top: 1em">--output-file ($output_file)
<br>
alter the filename of --output-path.</p>

<p style="margin-top: 1em">--output-file-prefix
($output_file_prefix) <br>
adds a prefix to --output-file %t is replaced by the
timerange of the report, %h by the hostname (see --hostname
)</p>

<p style="margin-top: 1em">--show-reports|-S
n[,n[,n[,...]]] ($show_reports) <br>
Show: Shows only the defined reports in the specified order.
Default is to display the reports as they are defined
through the report-switches above. The following numbers
<br>
are defined:</p>

<p style="margin-top: 1em">0 Summary <br>
1 Incoming request peak per protocol <br>
2 Incoming transfer volume peak per protocol <br>
3 Incoming requests by method <br>
4 Incoming UDP-requests by status <br>
5 Incoming TCP-requests by status <br>
6 Outgoing requests by status <br>
7 Outgoing requests by destination <br>
8 Request-destinations by 2ndlevel-domain <br>
9 Request-destinations by toplevel-domain <br>
10 TCP-Request-protocol <br>
11 Requested content-type <br>
12 Requested extensions <br>
13 Incoming UDP-requests by host <br>
14 Incoming TCP-requests by host <br>
15 Size Distribution Diagram <br>
16 Performance in n minute steps <br>
17 UDP-Request duration distribution in msec <br>
18 TCP-Request duration distribution in msec <br>
19 UDP Response code distribution <br>
20 TCP Response code distribution</p>

<p style="margin-top: 1em">Note: Using this doesn&rsquo;t
make Calamaris any faster, the internal calculations will be
done as the report-switches were set (see above).</p>

<p style="margin-top: 1em">--sort-order|-O ($sort_order)
<br>
Changes the sort order in the reports to request size,
default is sorting by number of requests.</p>

<p style="margin-top: 1em">($text_color) <br>
defines the colors for text/axis/legend/labels in graphics.
(only useful with --output-format graph )</p>

<p style="margin-top: 1em">--unit|-U string ($unit) <br>
You can define this to K(ilo), M(ega), G(iga) or T(era) for
the Byte-units.</p>

<p style="margin-top: 1em">($width) <br>
defines the width of the graphics. height is calculated from
this with a 3:2-ratio. (only useful with --output-format
graph )</p>

<p style="margin-top: 1em">($x_scale) <br>
defines how many datasets should be drawn on the graph. 30
is a good value, but you can play with this. if $x_scale
gets to big, you&rsquo;re on your own ;-)</p>

<p style="margin-top: 1em">--generate-index
($generate_index) <br>
generates an index for all reports that match
--output-file-prefix.</p>

<p style="margin-top: 1em">Caching <br>
--cache-input-file|-i file ($cache_input_file) <br>
You can reuse a cache file generated with
--cache-output-file file to add old data to a new report.
Several files can be separated with a &rsquo;:&rsquo;.</p>

<p style="margin-top: 1em">Note: if you use more than one
cache file, make sure they are chronologicaly ordered
(oldest first).</p>

<p style="margin-top: 1em">Note: if you reuse cache-files,
which were not created with -d -1 -r -1 -t -1 -R -1 the
number of &rsquo;others&rsquo; would be wrong everywhere. In
this case the number of &rsquo;others&rsquo; <br>
are omitted.</p>

<p style="margin-top: 1em">--cache-output-file|-o file
($cache_output_file) <br>
Calamaris stores a summary of the computed information in
file and you can reuse it at a later time with
--cache-input-file</p>

<p style="margin-top: 1em">Note: The output file can be the
same as the input file: it is simply overwritten after
reading the data. It is not recommended to change the
options between different <br>
runs if you include older data as this can result in strange
measurements.</p>

<p style="margin-top: 1em">Misc <br>
--benchmark|-b n ($benchmark) <br>
benchmark: A switch for the impatient as it prints a
&rsquo;#&rsquo; for every n parsed lines.</p>

<p style="margin-top: 1em">--copyright|-C <br>
Prints the copyright information of Calamaris</p>

<p style="margin-top: 1em">--help|-h <br>
Prints a brief description of the command line options.</p>

<p style="margin-top: 1em">--version|-V <br>
Prints out the Version-Number.</p>

<p style="margin-top: 1em">Debug <br>
--dump-loop|-L <br>
prints the internal loop to STDERR. (for Debugging)</p>

<p style="margin-top: 1em">($test) <br>
activates some small tests for the programmer.</p>

<p style="margin-top: 1em">--verbose|-v ($verbose) <br>
print more information about what is Calamaris is doing and
believing.</p>

<p style="margin-top: 1em">EXAMPLES <br>
This example mails the daily statistics to root: <br>
cat /var/log/squid/access.log | nice -39 calamaris
--all-useful-reports --hostname &quot;daily worf&quot;
--output-format mail | mail root</p>

<p style="margin-top: 1em">This one only caches a summary
for later use: <br>
cat /var/log/squid/access.log | calamaris
--all-useful-reports --cache-output-file daily.&lsquo;date
+&quot;%w&quot;&lsquo; &gt; /dev/null</p>

<p style="margin-top: 1em">You can then use the caches to
have weekly statistics:</p>

<p style="margin-top: 1em">if [ $DAYOFWEEK = &quot;0&quot;
]; then <br>
calamaris --all-useful-reports --cache-input-file
daily.1:daily.2:daily.3:daily.4:daily.5:daily.6:daily.0
--no-input --output-format mail --hostname &quot;weekly
worf&quot; | mail <br>
root ;</p>

<p style="margin-top: 1em">fi</p>

<p style="margin-top: 1em">BUGS <br>
If you have a problem with Calamaris , please make sure that
you use the recent version of Calamaris (see VERSION below).
Also check that your proxy works correctly and doesn&rsquo;t
<br>
produce invalid Logfiles. (see the README for buglist and
pointers.)</p>

<p style="margin-top: 1em">If you&rsquo;re sure that
you&rsquo;ve encountered a bug in Calamaris please report it
to Calamaris-bug@cord.de. This also applies if Calamaris
itself says &rsquo;please report this&rsquo;.</p>

<p style="margin-top: 1em">PRIVACY <br>
Calamaris can be (mis-)used to track what users are
requesting.</p>

<p style="margin-top: 1em">So please read the following and
think about it, before using Calamaris to be the Big
Brother.</p>

<p style="margin-top: 1em">- If you don&rsquo;t trust your
users than there is something more wrong than the loss of
productivity.</p>

<p style="margin-top: 1em">- Squid has some nice
acl-mechanisms. If you think that your users don&rsquo;t use
the net properly, don&rsquo;t let them use it. (You can also
open the net at specific times or to spe&acirc; <br>
cific sites, if you want.)</p>

<p style="margin-top: 1em">- If you still want to use
Calamaris that way, let your vict^Wusers know, that
they&rsquo;ll be monitored. (in Germany you have to let them
know!)</p>

<p style="margin-top: 1em">SEE ALSO <br>
squid(8)</p>

<p style="margin-top: 1em">AUTHOR <br>
Cord Beermann &lt;Cord@Wunder-Nett.org&gt;, Michael Pophal
&lt;michael.pophal@nefkom.net&gt;. There are also a lot of
people who contributed code, gave ideas or requested
features. Look <br>
them up in the executable.</p>

<p style="margin-top: 1em">This man page was written by
Philipp Frauenfelder &lt;pfrauenf@debian.org&gt;, maintainer
of the Debian package. Maintenance is now taken over by Cord
Beermann.</p>

<p style="margin-top: 1em">VERSION <br>
Version of this manpage: $Id: calamaris.1,v 3.1 2006-03-19
17:52:48 cord Exp $</p>

<p style="margin-top: 1em">It describes the usage of
Calamaris V3.0 and later.</p>

<p style="margin-top: 1em">Information about new releases,
mailing lists, and other related issues can be found from
the Calamaris home page at URL http://Calamaris.Cord.de/</p>

<p style="margin-top: 1em">WARRANTY <br>
Calamaris comes with &quot;absolutely no warranty&quot;.</p>

<p style="margin-top: 1em">COPYRIGHT <br>
Copyright (C) 1997-2006, 2013, 2015 Cord Beermann</p>

<p style="margin-top: 1em">This program is free software;
you can redistribute it and/or modify it under the terms of
the GNU General Public License as published by the Free
Software Foundation; either <br>
version 2 of the License, or (at your option) any later
version.</p>

<p style="margin-top: 1em">(If you modify and want to
publish it under the name Calamaris , please ask me. I
don&rsquo;t want to confuse the &rsquo;audience&rsquo; with
many different versions of the same name and/or Ver&acirc;
<br>
sion number. (This is not part of the license, it is only a
favour i asked of you.))</p>

<p style="margin-top: 1em">This program is distributed in
the hope that it will be useful, but WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR PUR&acirc; <br>
POSE. See the GNU General Public License for more
details.</p>

<p style="margin-top: 1em">You should have received a copy
of the GNU General Public License along with this program;
if not, write to the Free Software Foundation, Inc., 59
Temple Place - Suite 330, Bos&acirc; <br>
ton, MA 02111-1307, USA.</p>

<p style="margin-top: 1em">Handmade $Date: 2006-03-19
17:52:48 $ CALAMARIS(1)</p>
<hr>
</body>
</html>
