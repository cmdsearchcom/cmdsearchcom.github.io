<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:38:41 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>SPFQUERY(1) User Contributed Perl Documentation
SPFQUERY(1)</p>

<p style="margin-top: 1em">NAME <br>
spfquery - (Mail::SPF) - Checks if a given set of e-mail
parameters matches a domain&rsquo;s SPF policy</p>

<p style="margin-top: 1em">VERSION <br>
2.501</p>

<p style="margin-top: 1em">SYNOPSIS <br>
Preferred usage: <br>
spfquery [--versions|-v 1|2|1,2] [--scope|-s helo|mfrom|pra]
--identity|--id identity --ip-address|--ip ip-address
[--helo-identity|--helo-id helo-identity] [OPTIONS]</p>

<p style="margin-top: 1em">spfquery [--versions|-v 1|2|1,2]
[--scope|-s helo|mfrom|pra] --file|-f filename|-
[OPTIONS]</p>

<p style="margin-top: 1em">Legacy usage: <br>
spfquery --helo helo-identity --ip-address|--ip ip-address
[OPTIONS]</p>

<p style="margin-top: 1em">spfquery --mfrom mfrom-identity
--ip-address|--ip ip-address [--helo helo-identity]
[OPTIONS]</p>

<p style="margin-top: 1em">spfquery --pra pra-identity
--ip-address|--ip ip-address [OPTIONS]</p>

<p style="margin-top: 1em">Other usage: <br>
spfquery --version|-V</p>

<p style="margin-top: 1em">spfquery --help</p>

<p style="margin-top: 1em">DESCRIPTION <br>
spfquery checks if a given set of e-mail parameters (e.g.,
the SMTP sender&rsquo;s IP address) matches the responsible
domain&rsquo;s Sender Policy Framework (SPF) policy. For
more <br>
information on SPF see &lt;http://www.openspf.org&gt;.</p>

<p style="margin-top: 1em">Preferred Usage <br>
The following usage forms are preferred over the legacy
forms used by older spfquery versions:</p>

<p style="margin-top: 1em">The --identity form checks if
the given ip-address is an authorized SMTP sender for the
given &quot;helo&quot; hostname, &quot;mfrom&quot; envelope
sender e-mail address, or &quot;pra&quot; (so-called <br>
purported resonsible address) e-mail address, depending on
the value of the --scope option (which defaults to mfrom if
omitted).</p>

<p style="margin-top: 1em">The --file form reads
&quot;ip-address identity [helo-identity]&quot; tuples from
the file with the specified filename, or from standard input
if filename is -, and checks them against the <br>
specified scope (mfrom by default).</p>

<p style="margin-top: 1em">Both forms support an optional
--versions option, which specifies a comma-separated list of
the SPF version numbers of SPF records that may be used. 1
means that &quot;v=spf1&quot; <br>
records should be used. 2 means that &quot;spf2.0&quot;
records should be used. Defaults to 1,2, i.e., uses any SPF
records that are available. Records of a higher version are
<br>
preferred.</p>

<p style="margin-top: 1em">Legacy Usage <br>
spfquery versions before 2.500 featured the following usage
forms, which are discouraged but still supported for
backwards compatibility:</p>

<p style="margin-top: 1em">The --helo form checks if the
given ip-address is an authorized SMTP sender for the
&quot;HELO&quot; hostname given as the identity (so-called
&quot;HELO&quot; check).</p>

<p style="margin-top: 1em">The --mfrom form checks if the
given ip-address is an authorized SMTP sender for the
envelope sender email-address (or domain) given as the
identity (so-called &quot;MAIL FROM&quot; <br>
check). If a domain is given instead of an e-mail address,
&quot;postmaster&quot; will be substituted for the
localpart.</p>

<p style="margin-top: 1em">The --pra form checks if the
given ip-address is an authorized SMTP sender for the PRA
(Purported Responsible Address) e-mail address given as the
identity.</p>

<p style="margin-top: 1em">Other Usage <br>
The --version form prints version information of spfquery.
The --help form prints usage information for spfquery.</p>

<p style="margin-top: 1em">OPTIONS <br>
Standard Options <br>
The preferred and legacy forms optionally take any of the
following OPTIONS:</p>

<p style="margin-top: 1em">--default-explanation string
<br>
--def-exp string <br>
Use the specified string as the default explanation if the
authority domain does not specify an explanation string of
its own.</p>

<p style="margin-top: 1em">--hostname hostname <br>
Use hostname as the host name of the local system instead of
auto-detecting it.</p>

<p style="margin-top: 1em">--keep-comments <br>
--no-keep-comments <br>
Do (not) print any comments found when reading from a file
or from standard input.</p>

<p style="margin-top: 1em">--sanitize (currently ignored)
<br>
--no-sanitize (currently ignored) <br>
Do (not) sanitize the output by condensing consecutive
white-space into a single space and replacing non-printable
characters with question marks. Enabled by default.</p>

<p style="margin-top: 1em">--debug (currently ignored) <br>
Print out debug information.</p>

<p style="margin-top: 1em">Black Magic Options <br>
Several options that were supported by earlier versions of
spfquery are considered black magic (i.e. potentially
dangerous for the innocent user) and are thus disabled by
<br>
default. If the Mail::SPF::BlackMagic Perl module is
installed, they may be enabled by specifying
--enable-black-magic.</p>

<p style="margin-top: 1em">--max-dns-interactive-terms n
<br>
Evaluate a maximum of n DNS-interactive mechanisms and
modifiers per SPF check. Defaults to 10. Do not override the
default unless you know what you are doing!</p>

<p style="margin-top: 1em">--max-name-lookups-per-term n
<br>
Perform a maximum of n DNS name look-ups per mechanism or
modifier. Defaults to 10. Do not override the default unless
you know what you are doing!</p>

<p style="margin-top: 1em">--authorize-mxes-for
email-address|domain,... <br>
Consider all the MXes of the comma-separated list of
email-addresses and domains as inherently authorized.</p>

<p style="margin-top: 1em">--tfwl <br>
Perform &quot;trusted-forwarder.org&quot; accreditation
checking.</p>

<p style="margin-top: 1em">--guess spf-terms <br>
Use spf-terms as a default record if no SPF record is
found.</p>

<p style="margin-top: 1em">--local spf-terms <br>
Process spf-terms as local policy before resorting to a
default result (the implicit or explicit &quot;all&quot;
mechanism at the end of the domain&rsquo;s SPF record). For
example, this <br>
could be used for white-listing one&rsquo;s secondary MXes:
&quot;mx:mydomain.example.org&quot;.</p>

<p style="margin-top: 1em">--override domain=spf-record
<br>
--fallback domain=spf-record <br>
Set overrides and fallbacks. Each option can be specified
multiple times. For example:</p>

<p style="margin-top: 1em">--override
example.org=&rsquo;v=spf1 -all&rsquo; <br>
--override &rsquo;*.example.net&rsquo;=&rsquo;v=spf1 a mx
-all&rsquo; <br>
--fallback example.com=&rsquo;v=spf1 -all&rsquo;</p>

<p style="margin-top: 1em">RESULT CODES <br>
pass The specified IP address is an authorized SMTP sender
for the identity.</p>

<p style="margin-top: 1em">fail The specified IP address is
not an authorized SMTP sender for the identity.</p>

<p style="margin-top: 1em">softfail The specified IP
address is not an authorized SMTP sender for the identity,
however the authority domain is still testing out its SPF
policy.</p>

<p style="margin-top: 1em">neutral The identity&rsquo;s
authority domain makes no assertion about the status of the
IP address.</p>

<p style="margin-top: 1em">permerror A permanent error
occurred while evaluating the authority domain&rsquo;s
policy (e.g., a syntax error in the SPF record). Manual
intervention is required from the <br>
authority domain.</p>

<p style="margin-top: 1em">temperror A temporary error
occurred while evaluating the authority domain&rsquo;s
policy (e.g., a DNS error). Try again later.</p>

<p style="margin-top: 1em">none There is no applicable SPF
policy for the identity domain.</p>

<p style="margin-top: 1em">EXIT CODES <br>
Result | Exit code <br>
-----------+----------- <br>
pass | 0 <br>
fail | 1 <br>
softfail | 2 <br>
neutral | 3 <br>
permerror | 4 <br>
temperror | 5 <br>
none | 6</p>

<p style="margin-top: 1em">EXAMPLES <br>
spfquery --scope mfrom --id user@example.com --ip 1.2.3.4
<br>
spfquery --file test_data <br>
echo &quot;127.0.0.1 user@example.com
helohost.example.com&quot; | spfquery -f -</p>

<p style="margin-top: 1em">COMPATIBILITY <br>
spfquery has undergone the following interface changes
compared to earlier versions:</p>

<p style="margin-top: 1em">2.500 <br>
&Acirc;&middot; A new preferred usage style for performing
individual SPF checks has been introduced. The new style
accepts a unified --identity option and an optional --scope
option <br>
that specifies the type (scope) of the identity. In
contrast, the legacy usage style requires a separate usage
form for every supported scope. See &quot;Preferred
usage&quot; and <br>
&quot;Legacy usage&quot; for details.</p>

<p style="margin-top: 1em">&Acirc;&middot; The former
&quot;unknown&quot; and &quot;error&quot; result codes have
been renamed to &quot;permerror&quot; and
&quot;temperror&quot;, respectively, in order to comply with
RFC 4408 terminology.</p>

<p style="margin-top: 1em">&Acirc;&middot; SPF checks with
an empty identity are no longer supported. In the case of an
empty &quot;MAIL FROM&quot; SMTP transaction parameter,
perform a check with the &quot;helo&quot; scope <br>
directly.</p>

<p style="margin-top: 1em">&Acirc;&middot; The --debug and
--(no-)sanitize options are currently ignored by this
version of spfquery. They will again be supported in the
future.</p>

<p style="margin-top: 1em">&Acirc;&middot; Several features
that were supported by earlier versions of spfquery are
considered black magic and thus are now disabled by default.
See &quot;Black Magic Options&quot;.</p>

<p style="margin-top: 1em">&Acirc;&middot; Several option
names have been deprecated. This is a list of them and their
preferred synonyms:</p>

<p style="margin-top: 1em">Deprecated options | Preferred
options <br>
---------------------+----------------------------- <br>
--sender, -s | --mfrom <br>
--ipv4, -i | --ip-address, --ip <br>
--name | --hostname <br>
--max-lookup-count, | --max-dns-interactive-terms <br>
--max-lookup | <br>
--rcpt-to, -r | --authorize-mxes-for <br>
--trusted | --tfwl</p>

<p style="margin-top: 1em">SEE ALSO <br>
Mail::SPF, spfd(8)</p>


<p style="margin-top: 1em">&lt;http://tools.ietf.org/html/rfc4408&gt;</p>

<p style="margin-top: 1em">AUTHORS <br>
This version of spfquery is a complete rewrite by Julian
Mehnle &lt;julian@mehnle.net&gt;, based on an earlier
version written by Meng Weng Wong
&lt;mengwong+spf@pobox.com&gt; and Wayne <br>
Schlitt &lt;wayne@schlitt.net&gt;.</p>

<p style="margin-top: 1em">perl v5.24.1 2017-05-30
SPFQUERY(1)</p>
<hr>
</body>
</html>
