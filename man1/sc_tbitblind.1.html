<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>SC_TBITBLIND(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">SC_TBITBLIND(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">SC_TBITBLIND(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<b class="Nm" title="Nm">sc_tbitblind</b> &#x2014;
  <span class="Nd" title="Nd">scamper driver to test systems for resilience to
  blind TCP attacks.</span>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<table class="Nm">
  <tr>
    <td><b class="Nm" title="Nm">sc_tbitblind</b></td>
    <td>[<span class="Op"><b class="Fl" title="Fl">-r</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-a</b>&#x00A0;<var class="Ar" title="Ar">addressfile</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-A</b>&#x00A0;<var class="Ar" title="Ar">application</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-c</b>&#x00A0;<var class="Ar" title="Ar">completed-file</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-l</b>&#x00A0;<var class="Ar" title="Ar">limit-per-file</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-o</b>&#x00A0;<var class="Ar" title="Ar">output-file</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-O</b>&#x00A0;<var class="Ar" title="Ar">options</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-p</b>&#x00A0;<var class="Ar" title="Ar">scamper-port</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-t</b>&#x00A0;<var class="Ar" title="Ar">log-file</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-T</b>&#x00A0;<var class="Ar" title="Ar">ttl</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-w</b>&#x00A0;<var class="Ar" title="Ar">wait-between</var></span>]</td>
  </tr>
</table>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <b class="Nm" title="Nm">sc_tbitblind</b> utility provides the ability to
  connect to a running <a class="Xr" title="Xr">scamper(1)</a> instance and use
  that instance to test systems for resilience to blind TCP attacks, with the
  output written to a file in warts format. The utility tests a given system for
  regular TCP behavior, and then tests the system for response to reset, SYN,
  and data packets that could have come from a blind attacker because the
  sequence number is not the next sequence number value expected by the receiver
  (the reset and SYN cases) or the acknowledgment value covers data ahead or
  behind the receiver's point in their sequence number space (the data cases).
  The utility also tests the system's response to a connection that advertises
  support for window scaling, TCP timestamps, and Selective Acknowledgments
  (SACK).
<div class="Pp"></div>
The options are as follows:
<dl class="Bl-tag">
  <dt class="It-tag"><b class="Fl" title="Fl">-</b>?</dt>
  <dd class="It-tag">prints a list of command line options and a synopsis of
      each.</dd>
  <dt class="It-tag"><a class="selflink" href="#a"><b class="Fl" title="Fl" id="a">-a</b></a>
    <var class="Ar" title="Ar">addressfile</var></dt>
  <dd class="It-tag">specifies the name of the input file which constists of a
      sequence of systems to test, one system per line.</dd>
  <dt class="It-tag"><a class="selflink" href="#A"><b class="Fl" title="Fl" id="A">-A</b></a>
    <var class="Ar" title="Ar">application</var></dt>
  <dd class="It-tag">specifies the type of application to simulate while testing
      the system. Options are HTTP and BGP.</dd>
  <dt class="It-tag"><a class="selflink" href="#c"><b class="Fl" title="Fl" id="c">-c</b></a>
    <var class="Ar" title="Ar">completed-file</var></dt>
  <dd class="It-tag">specifies the name of a file to record IP addresses that
      have been tested.</dd>
  <dt class="It-tag"><a class="selflink" href="#l"><b class="Fl" title="Fl" id="l">-l</b></a>
    <var class="Ar" title="Ar">limit-per-file</var></dt>
  <dd class="It-tag">specifies the number of tbit objects to record per warts
      file, before opening a new file and placing new objects.</dd>
  <dt class="It-tag"><a class="selflink" href="#o"><b class="Fl" title="Fl" id="o">-o</b></a>
    <var class="Ar" title="Ar">output-file</var></dt>
  <dd class="It-tag">specifies the name of the file to be written. The output
      file will use the warts format.</dd>
  <dt class="It-tag"><a class="selflink" href="#O"><b class="Fl" title="Fl" id="O">-O</b></a>
    <var class="Ar" title="Ar">options</var></dt>
  <dd class="It-tag">allows the behavior of
      <b class="Nm" title="Nm">sc_tbitblind</b> to be further tailored. The
      current choices for this option are:
    <ul class="Bl-dash Bl-compact" style="margin-left: 2.00ex;">
      <li class="It-dash"><b class="Sy" title="Sy">noshuffle:</b> do not shuffle
          the order of the input list or the order of the tests.</li>
    </ul>
  </dd>
  <dt class="It-tag"><a class="selflink" href="#p"><b class="Fl" title="Fl" id="p">-p</b></a>
    <var class="Ar" title="Ar">scamper-port</var></dt>
  <dd class="It-tag">specifies the port on the local host where
      <a class="Xr" title="Xr">scamper(1)</a> is accepting control socket
      connections.</dd>
  <dt class="It-tag"><a class="selflink" href="#r"><b class="Fl" title="Fl" id="r">-r</b></a></dt>
  <dd class="It-tag">causes the random number generator used to shuffle tests be
      seeded.</dd>
  <dt class="It-tag"><a class="selflink" href="#t"><b class="Fl" title="Fl" id="t">-t</b></a>
    <var class="Ar" title="Ar">log-file</var></dt>
  <dd class="It-tag">specifies the name of a file to log progress output from
      <b class="Nm" title="Nm">sc_tbitblind</b> generated at run time.</dd>
  <dt class="It-tag"><a class="selflink" href="#T"><b class="Fl" title="Fl" id="T">-T</b></a>
    <var class="Ar" title="Ar">ttl</var></dt>
  <dd class="It-tag">specifies the IP-TTL to use with the blind TCP tests.</dd>
  <dt class="It-tag"><a class="selflink" href="#w"><b class="Fl" title="Fl" id="w">-w</b></a>
    <var class="Ar" title="Ar">wait-between</var></dt>
  <dd class="It-tag">specifies the length of time to wait between any two TCP
      tests to one system.</dd>
</dl>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
Use of this driver requires a scamper instance listening on a port for commands,
  which has been configured to use the IPFW firewall as follows:
<div class="Pp"></div>
<div class="D1"><code class="Li">scamper -P 31337 -F ipfw</code></div>
<div class="Pp"></div>
To test a set of web servers specified in a file named webservers.txt and
  formatted as follows:
<div class="Pp"></div>
1,example.com 1263 192.0.2.1 http://www.example.com/ 1,example.com 1263
  2001:DB8::1 http://www.example.com/ 1,example.com 1263 2001:DB8::2
  https://www.example.com/
<div class="Pp"></div>
the following command will test all servers for resilience to blind TCP attacks
  and record raw data into webservers_00.warts, webservers_01.warts, etc:
<div class="Pp"></div>
<div class="D1"><code class="Li">sc_tbitblind -a webservers.txt -p 31337 -o
  webservers</code></div>
<div class="Pp"></div>
The webservers.txt file is required to be formatted as above. The format is:
  numeric ID to pass to tbit, a label for the webserver, the size of the object
  to be fetched, the IP address to contact, and the URL to use.
<div class="Pp"></div>
To test a set of BGP routers specified in bgprouters.txt and formatted as
  follows:
<div class="Pp"></div>
192.0.2.2 65000 192.0.2.2 65001
<div class="Pp"></div>
the following command will test all BGP routers for resilience to blind TCP
  attacks, without shuffling the test order, waiting 180 seconds between tests,
  and record raw data into bgprouters_00.warts, bgprouters_01.warts, etc:
<div class="Pp"></div>
<div class="D1"><code class="Li">sc_tbitblind -a bgprouters.txt -p 31337 -o
  bgprouters -A bgp -O noshuffle -w 180</code></div>
<div class="Pp"></div>
The bgprouters.txt file is required to be formatted as above. The format of that
  file is: IP address to establish a BGP session with, and the ASN to use.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<cite class="Rs" title="Rs"><span class="RsA">M. Luckie</span>,
  <span class="RsA">R. Beverly</span>, <span class="RsA">T. Wu</span>,
  <span class="RsA">M. Allman</span>, and <span class="RsA">k. claffy</span>,
  <span class="RsT">Resilience of Deployed TCP to Blind Attacks</span>,
  <span class="RsO">Proc. ACM/SIGCOMM Internet Measurement Conference
  2015</span>.</cite> <a class="Xr" title="Xr">scamper(1)</a>,
  <a class="Xr" title="Xr">sc_wartsdump(1)</a>,
  <a class="Xr" title="Xr">sc_warts2json(1)</a>,
  <a class="Xr" title="Xr">warts(5)</a>
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
<b class="Nm" title="Nm">sc_tbitblind</b> was written by Matthew Luckie
  &lt;mjl@luckie.org.nz&gt;. Tiange Wu contributed an initial implementation of
  the blind in-window TBIT test to scamper, and Robert Beverly contributed
  support for testing BGP routers.</div>
<table class="foot">
  <tr>
    <td class="foot-date">September 19, 2015</td>
    <td class="foot-os">Linux 4.12.14-300.fc26.x86_64</td>
  </tr>
</table>
</body>
</html>
