<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>FRAG6(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">FRAG6(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">FRAG6(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
frag6 - A security assessment tool for IPv6 fragmentation
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>frag6</b> [<b>-i</b> <i>INTERFACE</i>] -d DST_ADDR [-S LINK_SRC_ADDR] [-D
  LINK-DST-ADDR] [-s SRC_ADDR[/LEN]] [-A HOP_LIMIT] [-u DST_OPT_HDR_SIZE] [-U
  DST_OPT_U_HDR_SIZE] [-H HBH_OPT_HDR_SIZE] [-P FRAG_SIZE] [-O FRAG_TYPE] [-o
  FRAG_OFFSET] [-I FRAG_ID] [-T] [-n] [-p | -W | -X | -F N_FRAGS] [-l] [-z
  SECONDS] [-v] [-h]
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>frag6</b> is a security assessment tool for attack vectors based on IPv6
  fragments. It is part of the SI6 Networks' IPv6 Toolkit: a security assessment
  and trouble-shooting suite for the IPv6 protocols.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<b>frag6</b> takes it parameters as command-line options. Each of the options
  can be specified with a short name (one character preceded with the hyphen
  character, as e.g. &quot;-i&quot;) or with a long name (a string preceded with
  two hyphen characters, as e.g. &quot;--interface&quot;).
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i&#x00A0;</b><i>INTERFACE</i><b>,&#x00A0;--interface&#x00A0;</b><i>INTERFACE</i></dt>
  <dd class="It-tag">This option specifies the network interface that the tool
      will use. If the destination address (&quot;-d&quot; option) is a
      link-local address, the interface must be explicitly specified. The
      interface may also be specified along with a destination address, with the
      &quot;-d&quot; option.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-S&#x00A0;</b><i>SRC_LINK_ADDR</i><b>,&#x00A0;--src-link-address&#x00A0;</b><i>SRC_LINK_ADDR</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies the link-layer Source Address of the probe packets. If
      left unspecified, the link-layer Source Address of the packets is set to
      the real link-layer address of the network interface.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-D&#x00A0;</b><i>DST_LINK_ADDR</i><b>,&#x00A0;--dst-link-address&#x00A0;</b><i>DST_LINK_ADDR</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies the link-layer Destination Address of the probe
      packets. By default, the link-layer Destination Address is automatically
      set to the link-layer address of the destination host (for on-link
      destinations) or to the link-layer address of the first-hop router.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s&#x00A0;</b><i>SRC_ADDR</i><b>,&#x00A0;--src-address&#x00A0;</b><i>SRC_ADDR</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies the IPv6 source address (or IPv6 prefix) to be used
      for the Source Address of the outgoing packets. If an IPv6 prefix is
      specified, the IPv6 Source Address of the outgoing packets will be
      randomized from that prefix.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d&#x00A0;</b><i>DST_ADDR</i><b>,&#x00A0;--dst-address&#x00A0;</b><i>DST_ADDR</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies the IPv6 Destination Address of the target node. This
      option cannot be left unspecified.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-A&#x00A0;</b><i>HOP_LIMIT</i><b>,&#x00A0;--hop-limit&#x00A0;</b><i>HOP_LIMIT</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies the Hop Limit to be used for the IPv6 packets. By
      default, the Hop Limit is randomized.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-u&#x00A0;</b><i>HDR_SIZE</i><b>,&#x00A0;--dst-opt-hdr&#x00A0;</b><i>HDR_SIZE</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies that a Destination Options header is to be included in
      the outgoing packet(s). The extension header size must be specified as an
      argument to this option (the header is filled with padding options).
      Multiple Destination Options headers may be specified by means of multiple
      &quot;-u&quot; options.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-U&#x00A0;</b><i>HDR_SIZE</i><b>,&#x00A0;--dst-opt-u-hdr&#x00A0;</b><i>HDR_SIZE</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies a Destination Options header to be included in the
      &quot;unfragmentable part&quot; of the outgoing packet(s). The header size
      must be specified as an argument to this option (the header is filled with
      padding options). Multiple Destination Options headers may be specified by
      means of multiple &quot;-U&quot; options.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-H&#x00A0;</b><i>HDR_SIZE</i><b>,&#x00A0;--hbh-opt-hdr&#x00A0;</b><i>HDR_SIZE</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies that a Hop-by-Hop Options header is to be included in
      the outgoing packet(s). The header size must be specified as an argument
      to this option (the header is filled with padding options). Multiple
      Hop-by-Hop Options headers may be specified by means of multiple
      &quot;-H&quot; options.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-P&#x00A0;</b><i>FRAG_SIZE</i><b>,&#x00A0;--frag-size&#x00A0;</b><i>FRAG_SIZE</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies the IPv6 fragment payload size.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-O&#x00A0;</b><i>FRAG_TYPE</i><b>,&#x00A0;--frag-type&#x00A0;</b><i>FRAG_TYPE</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies the fragment &quot;type&quot;. Possible types are
      &quot;first&quot;, &quot;middle&quot;, &quot;last&quot;, and
      &quot;atomic&quot;. If the selected fragment type is &quot;first&quot;,
      the Fragment Offset is automatically set to 0, and the &quot;M&quot;
      (&quot;More fragments&quot;) bit is set to 1. If the selected fragment
      type is &quot;middle&quot;, the Fragment Offset is set to a non-zero
      value, and the &quot;M&quot; bit is set to 1. If the selected fragment
      type is &quot;last&quot;, the Fragment Offset is set to a non-zero value,
      and the &quot;M&quot; bit is set to 0. Finally, if the selected fragment
      type is &quot;atomic&quot;, the Fragment Offset is set to 0, and the
      &quot;M&quot; bit is set to 0.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-o&#x00A0;</b><i>FRAG_OFFSET</i><b>,&#x00A0;--frag-offset&#x00A0;</b><i>FRAG_OFFSET</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies the Fragment Offset. The Fragment Offset specified by
      means of this option overrides the value implicitly specified by means of
      the &quot;-O&quot; option.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-I&#x00A0;</b><i>FRAG_ID</i><b>,&#x00A0;--frag-id&#x00A0;</b><i>FRAG_ID</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies the fragment &quot;Identification&quot; value. If left
      unspecified, the &quot;Identification&quot; value is randomized.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-T</b>,&#x00A0;<b>--no-timestamp</b></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    When assessing the fragment reassembly policy of a target, the fragment
      payload includes a timestamp value that is used to measure the fragment
      reassembly timeout. If this option is set, such timestamp will not be
      included in the payload (and the tool will not be able to measure the
      fragment reassembly timeout).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n</b>,&#x00A0;<b>--no-responses</b></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option instructs the frag6 tool not to display the responses to the
      fragments sent. This option is useful when performing a
      fragmentation-flooding attack, as multiple response packets (ICMPv6
      errors) might be received.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p</b>,&#x00A0;<b>--frag-reass-policy</b></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option instructs the tool to determine the IPv6 fragment reassembly
      policy of the target. In order to determine the aforementioned policy, the
      tool performs a number of tests to determine how the target node processes
      overlapping fragments. The following figures illustrate the sequence of
      packets that correspond to each of the tests.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b> Test #1</b></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<div style="margin-left: 4.00ex;">
<pre>
          Frag. #1:  AAAAAAAAAAA 
          Frag. #2:         BBBBBBBBBBB 
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<b> Test #2</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
          Frag. #1:  AAAAAAAAAA
          Frag. #2:                    BBBBBBBBBBB 
          Frag. #3:         CCCCCCCCCCC
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<b> Test #3</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
          Frag. #1:  AAAAAAAAAA
          Frag. #2:                    BBBBBBBBBBB
          Frag. #3:            CCCCCCCCCCC
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<b> Test #4</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
          Frag. #1:  AAAAAAAAAA
          Frag. #2:                    BBBBBBBBBBB
          Frag. #3:            CCCCCCCCCCCCCCCCCCCCCCCCCC
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<b> Test #5</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
          Frag. #1:  AAAAAAAAAA
          Frag. #2:                    BBBBBBBBBBB
          Frag. #3:                           CCCCCCCCCCC
          Frag. #4:            DDDDDDDD
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag">
  <br/>
   For each of the aforementioned tests, the tool reports which</dt>
  <dd class="It-tag">
    <br/>
     copy of the data is used by the target host. If there is no
    <br/>
     response from the host, the tool informs whether the host
    <br/>
     silently dropped the fragments, or sent an ICMPv6 Time
    <br/>
     Exceeded error message.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-W</b>,&#x00A0;<b>--frag-id-policy</b></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option instructs the tool to determine the fragment
      &quot;Identification&quot; generation policy. The tool sends a number of
      probe packets to the target node, and samples the
      &quot;Identification&quot; values of the corresponding response packets.
      Based on the sampled values, it tries to infer the fragment Identification
      generation policy of the target.
    <div style="height: 1.00em;">&#x00A0;</div>
    The tool will first send a number of fragments from single IPv6 address,
      such that the per-destination policy is determined. The tool will then
      send a number of fragments from random IPv6 addresses (from the same
      prefix as the first fragments) such that the &quot;global&quot; fragment
      Identification generation policy can be inferred.
    <div style="height: 1.00em;">&#x00A0;</div>
    The tool computes the expected value and the standard deviation of the
      difference between consecutive-sampled Identification values (IDn &#x2013;
      IDn-1), with the intent of inferring the fragment Identification algorithm
      at the target node.
    <div style="height: 1.00em;">&#x00A0;</div>
    For small values of the standard deviation, the fragment Identification is
      assumed to be a monotonically-increasing function with increments of the
      &quot;expected value&quot;. For large values of the standard deviation,
      the fragment Identification is assumed to be randomized, and the expected
      value and standard deviation are informed to the user, as indicators of
      the &quot;quality&quot; of the fragment Identification generation
      algorithm.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-X</b>,&#x00A0;<b>--pod-attack</b></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option instructs the tool to perform a &quot;Ping of Death&quot; attack
      against the specified target.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-F&#x00A0;</b><i>FRAG_NUMBER</i><b>,&#x00A0;--flood-frags&#x00A0;</b><i>FRAG_NUMBER</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option instructs the tool to send the specified number of fragments
      back-to-back to the target node. This option is likely to be used in
      conjunction with the &quot;-l&quot; option, such that the process is
      repeated in a loop.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l</b>,&#x00A0;<b>--loop</b></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option instructs the frag6 tool to periodically send IPv6 fragments to
      the target node. The amount of time to pause between sending a batch of
      fragments can be specified by means of the &quot;-z&quot; option, and
      defaults to 1 second.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-z&#x00A0;</b><i>SECONDS</i><b>,&#x00A0;--sleep&#x00A0;</b><i>SECONDS</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies the amount of time that the tool should pause between
      sending btaches of IPv6 fragments (when the &quot;--loop&quot; option is
      set). If left unspecified, it defaults to 1 second.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v</b>,&#x00A0;<b>--verbose</b></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option instructs the frag6 tool to be verbose. If this option is set
      twice and the -W option was set, the tool outputs the sampled Fragment
      Identification values (in addition to other information).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h</b>,&#x00A0;<b>--help</b></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    Print help information for the <b>frag6</b> tool.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
The following sections illustrate typical use cases of the <b>frag6</b> tool.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Example #1</b>
<div style="height: 1.00em;">&#x00A0;</div>
# frag6 --frag-id-policy -d fc00:1::1 -v
<div style="height: 1.00em;">&#x00A0;</div>
Assess the fragment Identification generation policy of the host
  &quot;fc00:1::1&quot;. Be verbose.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Example #2</b>
<div style="height: 1.00em;">&#x00A0;</div>
# frag6 --frag-reass-policy -d fc00:1::1 -v
<div style="height: 1.00em;">&#x00A0;</div>
Assess the fragment reassembly policy of the host &quot;fc00:1::1&quot;. Be
  verbose.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Example #3</b>
<div style="height: 1.00em;">&#x00A0;</div>
# frag6 --frag-type atomic -d fc00:1::1 -v
<div style="height: 1.00em;">&#x00A0;</div>
Send an IPv6 atomic fragment to the host &quot;fc00:1::1&quot;. Be verbose.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Example #4</b>
<div style="height: 1.00em;">&#x00A0;</div>
# frag6 -s ::/0 --flood-frags 100 -l -z 5 -d fc00:1::1 -v
<div style="height: 1.00em;">&#x00A0;</div>
Send 100 fragments (every 5 seconds) to the host fc00:1::1, using a forged IPv6
  Source Address from the prefix ::/0. The aforementioned fragments should have
  an offset of 0, and the M bit set (i.e., be first-fragments). Be verbose.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
The <b>frag6</b> tool and the corresponding manual pages were produced by
  Fernando Gont &lt;fgont@si6networks.com&gt; for SI6 Networks
  &lt;http://www.si6networks.com&gt;.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
Copyright (c) 2011-2013 Fernando Gont.
<div style="height: 1.00em;">&#x00A0;</div>
Permission is granted to copy, distribute and/or modify this document under the
  terms of the GNU Free Documentation License, Version 1.3 or any later version
  published by the Free Software Foundation; with no Invariant Sections, no
  Front-Cover Texts, and no Back-Cover Texts. A copy of the license is available
  at <i>&lt;http://www.gnu.org/licenses/fdl.html&gt;</i>.</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
