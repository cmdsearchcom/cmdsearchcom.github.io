<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>DOCKER(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DOCKER(1)</td>
    <td class="head-vol">JUNE 2014</td>
    <td class="head-rtitle">DOCKER(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
docker-update - Update configuration of one or more containers
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>docker update</b> [ <b>--blkio-weight</b>[=<i>[BLKIO-WEIGHT]</i>]] [
  <b>--cpu-shares</b>[= <i>0</i>]] [ <b>--cpu-period</b>[=<i>0</i>]] [
  <b>--cpu-quota</b>[= <i>0</i>]] [ <b>--cpu-rt-period</b>[=<i>0</i>]] [
  <b>--cpu-rt-runtime</b>[= <i>0</i>]] [
  <b>--cpuset-cpus</b>[=<i>CPUSET-CPUS</i>]] [
  <b>--cpuset-mems</b>[=<i>CPUSET-MEMS</i>]] [ <b>--help</b>] [
  <b>--kernel-memory</b>[= <i>KERNEL-MEMORY</i>]] [
  <b>-m</b>|<b>--memory</b>[=<i>MEMORY</i>]] [
  <b>--memory-reservation</b>[=<i>MEMORY-RESERVATION</i>]] [
  <b>--memory-swap</b>[= <i>MEMORY-SWAP</i>]] [
  <b>--restart</b>[=<i>&quot;&quot;</i>]] CONTAINER [CONTAINER...]
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <b>docker update</b> command dynamically updates container configuration.
  You can use this command to prevent containers from consuming too many
  resources from their Docker host. With a single command, you can place limits
  on a single container or on many. To specify more than one container, provide
  space-separated list of container names or IDs.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
With the exception of the <b>--kernel-memory</b> option, you can specify these
  options on a running or a stopped container. On kernel version older than 4.6,
  You can only update <b>--kernel-memory</b> on a stopped container or on a
  running container with kernel memory initialized.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<b>--blkio-weight</b>=0
<br/>
 Block IO weight (relative weight) accepts a weight value between 10 and 1000.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<b>--cpu-shares</b>=0
<br/>
 CPU shares (relative weight)
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<b>--cpu-period</b>=0
<br/>
 Limit the CPU CFS (Completely Fair Scheduler) period
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
Limit the container's CPU usage. This flag tell the kernel to restrict the
  container's CPU usage to the period you specify.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<b>--cpu-quota</b>=0
<br/>
 Limit the CPU CFS (Completely Fair Scheduler) quota
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<b>--cpu-rt-period</b>=0
<br/>
 Limit the CPU real-time period in microseconds
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
Limit the container's Real Time CPU usage. This flag tell the kernel to restrict
  the container's Real Time CPU usage to the period you specify.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<b>--cpu-rt-runtime</b>=0
<br/>
 Limit the CPU real-time runtime in microseconds
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
Limit the containers Real Time CPU usage. This flag tells the kernel to limit
  the amount of time in a given CPU period Real Time tasks may consume. Ex:
<br/>
 Period of 1,000,000us and Runtime of 950,000us means that this container could
  consume 95% of available CPU and leave the remaining 5% to normal priority
  tasks.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
The sum of all runtimes across containers cannot exceed the amount allotted to
  the parent cgroup.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<b>--cpuset-cpus</b>=&quot;&quot;
<br/>
 CPUs in which to allow execution (0-3, 0,1)
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<b>--cpuset-mems</b>=&quot;&quot;
<br/>
 Memory nodes(MEMs) in which to allow execution (0-3, 0,1). Only effective on
  NUMA systems.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<b>--help</b>
<br/>
 Print usage statement
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<b>--kernel-memory</b>=&quot;&quot;
<br/>
 Kernel memory limit (format: <b></b>&lt;number&gt;[&lt;unit&gt;], where unit =
  b, k, m or g)
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
Note that on kernel version older than 4.6, you can not update kernel memory on
<br/>
 a running container if the container is started without kernel memory
  initialized,
<br/>
 in this case, it can only be updated after it's stopped. The new setting takes
<br/>
 effect when the container is started.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<b>-m</b>, <b>--memory</b>=&quot;&quot;
<br/>
 Memory limit (format: &lt;number&gt;&lt;optional unit&gt;, where unit = b, k, m
  or g)
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
Note that the memory should be smaller than the already set swap memory limit.
<br/>
 If you want update a memory limit bigger than the already set swap memory
  limit,
<br/>
 you should update swap memory limit at the same time. If you don't set swap
  memory
<br/>
 limit on docker create/run but only memory limit, the swap memory is double
<br/>
 the memory limit.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<b>--memory-reservation</b>=&quot;&quot;
<br/>
 Memory soft limit (format: &lt;number&gt;[&lt;unit&gt;], where unit = b, k, m
  or g)
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<b>--memory-swap</b>=&quot;&quot;
<br/>
 Total memory limit (memory + swap)
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<b>--restart</b>=&quot;&quot;
<br/>
 Restart policy to apply when a container exits (no, on-failure[:max-retry],
  always, unless-stopped).
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
The following sections illustrate ways to use this command.
<div style="height: 1.00em;">&#x00A0;</div>
<h2 class="Ss" title="Ss" id="Update_a_container's_cpu-shares"><a class="selflink" href="#Update_a_container's_cpu-shares">Update
  a container's cpu-shares</a></h2>
To limit a container's cpu-shares to 512, first identify the container name or
  ID. You can use <b>docker ps</b> to find these values. You can also use the ID
  returned from the <b>docker run</b> command. Then, do the following:
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<div style="margin-left: 5.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ docker update --cpu-shares 512 abebf7571666
<div class="Pp"></div>
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h2 class="Ss" title="Ss" id="Update_a_container_with_cpu-shares_and_memory"><a class="selflink" href="#Update_a_container_with_cpu-shares_and_memory">Update
  a container with cpu-shares and memory</a></h2>
To update multiple resource configurations for multiple containers:
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<div style="margin-left: 5.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ docker update --cpu-shares 512 -m 300M abebf7571666 hopeful_morse
<div class="Pp"></div>
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h2 class="Ss" title="Ss" id="Update_a_container's_kernel_memory_constraints"><a class="selflink" href="#Update_a_container's_kernel_memory_constraints">Update
  a container's kernel memory constraints</a></h2>
You can update a container's kernel memory limit using the
  <b>--kernel-memory</b> option. On kernel version older than 4.6, this option
  can be updated on a running container only if the container was started with
  <b>--kernel-memory</b>. If the container was started <i>without</i>
  <b>--kernel-memory</b> you need to stop the container before updating kernel
  memory.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
For example, if you started a container with this command:
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<div style="margin-left: 5.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ docker run -dit --name test --kernel-memory 50M ubuntu bash
<div class="Pp"></div>
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
You can update kernel memory while the container is running:
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<div style="margin-left: 5.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ docker update --kernel-memory 80M test
<div class="Pp"></div>
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
If you started a container <i>without</i> kernel memory initialized:
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<div style="margin-left: 5.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ docker run -dit --name test2 --memory 300M ubuntu bash
<div class="Pp"></div>
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
Update kernel memory of running container <b></b>test2 will fail. You need to
  stop the container before updating the <b>--kernel-memory</b> setting. The
  next time you start it, the container uses the new value.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
Kernel version newer than (include) 4.6 does not have this limitation, you can
  use <b></b>--kernel-memory the same way as other options.
<div style="height: 1.00em;">&#x00A0;</div>
<h2 class="Ss" title="Ss" id="Update_a_container's_restart_policy"><a class="selflink" href="#Update_a_container's_restart_policy">Update
  a container's restart policy</a></h2>
You can change a container's restart policy on a running container. The new
  restart policy takes effect instantly after you run <b></b>docker update on a
  container.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
To update restart policy for one or more containers:
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<div style="margin-left: 5.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ docker update --restart=on-failure:3 abebf7571666 hopeful_morse
<div class="Pp"></div>
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
Note that if the container is started with &quot;--rm&quot; flag, you cannot
  update the restart policy for it. The <b></b>AutoRemove and
  <b></b>RestartPolicy are mutually exclusive for the container.</div>
<table class="foot">
  <tr>
    <td class="foot-date"> Docker User Manuals</td>
    <td class="foot-os">Docker Community</td>
  </tr>
</table>
</body>
</html>
