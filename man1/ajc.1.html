<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 15:48:11 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>ajc(1) General Commands Manual ajc(1)</p>

<p style="margin-top: 1em">NAME <br>
ajc &acirc; compiler and bytecode weaver for the AspectJ and
Java languages</p>

<p style="margin-top: 1em">SYNOPSIS <br>
ajc [Options] [file... | @file... | -argfile file... ]</p>

<p style="margin-top: 1em">Description <br>
The ajc command compiles and weaves AspectJ and Java source
and .class files, producing .class files compliant with any
Java VM (1.1 or later). It combines compilation and
byte&acirc; <br>
code weaving and supports incremental builds; you can also
weave bytecode at run-time using &quot;&quot; &gt;.</p>

<p style="margin-top: 1em">The arguments after the options
specify the source file(s) to compile. To specify source
classes, use -inpath (below). Files may be listed directly
on the command line or in a <br>
file. The -argfile file and @file forms are equivalent, and
are interpreted as meaning all the arguments listed in the
specified file.</p>

<p style="margin-top: 1em">Note: You must explicitly pass
ajc all necessary sources. Be sure to include the source not
only for the aspects or pointcuts but also for any affected
types. Specifying all <br>
sources is necessary because, unlike javac, ajc does not
search the sourcepath for classes. (For a discussion of what
affected types might be required, see The AspectJ
Program&acirc; <br>
ming Guide, Implementation Appendix
../progguide/implementation.html) .</p>

<p style="margin-top: 1em">To specify sources, you can list
source files as arguments or use the options -sourceroots or
-inpath. If there are multiple sources for any type, the
result is undefined since <br>
ajc has no way to determine which source is correct. (This
happens most often when users include the destination
directory on the inpath and rebuild.)</p>

<p style="margin-top: 1em">Options <br>
-injars JarList <br>
deprecated: since 1.2, use -inpath, which also takes
directories.</p>

<p style="margin-top: 1em">-inpath Path <br>
Accept as source bytecode any .class files in the The output
will include these classes, possibly as woven with any
applicable aspects. Path is a single argument con&acirc;
<br>
taining a list of paths to zip files or directories,
delimited by the platform-specific path delimiter.</p>

<p style="margin-top: 1em">-aspectpath Path <br>
Weave binary aspects from jar files and directories on path
into all sources. The aspects should have been output by the
same version of the compiler. When running <br>
the output classes, the run classpath should contain all
aspectpath entries. Path, like classpath, is a single
argument containing a list of paths to jar files,
delim&acirc; <br>
ited by the platform- specific classpath delimiter.</p>

<p style="margin-top: 1em">-argfile File <br>
The file contains a line-delimited list of arguments. Each
line in the file should contain one option, filename, or
argument string (e.g., a classpath or inpath). <br>
Arguments read from the file are inserted into the argument
list for the command. Relative paths in the file are
calculated from the directory containing the file (not <br>
the current working directory). Comments, as in Java, start
with // and extend to the end of the line. Options specified
in argument files may override rather than <br>
extending existing option values, so avoid specifying
options like -classpath in argument files unlike the
argument file is the only build specification. The <br>
form @file is the same as specifying -argfile file.</p>

<p style="margin-top: 1em">-outjar output.jar <br>
Put output classes in zip file output.jar.</p>

<p style="margin-top: 1em">-outxml Generate aop.xml file
for load-time weaving with default name.</p>

<p style="margin-top: 1em">-outxmlfile custom/aop.xml <br>
Generate aop.xml file for load-time weaving with custom
name.</p>

<p style="margin-top: 1em">-incremental <br>
Run the compiler continuously. After the initial
compilation, the compiler will wait to recompile until it
reads a newline from the standard input, and will quit when
<br>
it reads a &rsquo;q&rsquo;. It will only recompile necessary
components, so a recompile should be much faster than doing
a second compile. This requires -sourceroots.</p>

<p style="margin-top: 1em">-sourceroots DirPaths <br>
Find and build all .java or .aj source files under any
directory listed in DirPaths. DirPaths, like classpath, is a
single argument containing a list of paths to <br>
directories, delimited by the platform- specific classpath
delimiter. Required by -incremental.</p>

<p style="margin-top: 1em">-crossrefs <br>
Generate a build .ajsym file into the output directory. Used
for viewing crosscutting references by tools like the
AspectJ Browser.</p>

<p style="margin-top: 1em">-emacssym Generate .ajesym
symbol files for emacs support (deprecated).</p>

<p style="margin-top: 1em">-Xlint Same as -Xlint:warning
(enabled by default)</p>

<p style="margin-top: 1em">-Xlint:{level} <br>
Set default level for messages about potential programming
mistakes in crosscutting code. {level} may be ignore,
warning, or error. This overrides entries in <br>
org/aspectj/weaver/XlintDefault.properties from
aspectjtools.jar, but does not override levels set using the
-Xlintfile option.</p>

<p style="margin-top: 1em">-Xlintfile PropertyFile <br>
Specify properties file to set levels for specific
crosscutting messages. PropertyFile is a path to a Java
.properties file that takes the same property names and
val&acirc; <br>
ues as org/aspectj/weaver/XlintDefault.properties from
aspectjtools.jar, which it also overrides.</p>

<p style="margin-top: 1em">-help Emit information on
compiler options and usage</p>

<p style="margin-top: 1em">-version Emit the version of the
AspectJ compiler</p>

<p style="margin-top: 1em">-classpath Path <br>
Specify where to find user class files. Path is a single
argument containing a list of paths to zip files or
directories, delimited by the platform-specific path <br>
delimiter.</p>

<p style="margin-top: 1em">-bootclasspath Path <br>
Override location of VM&rsquo;s bootclasspath for purposes
of evaluating types when compiling. Path is a single
argument containing a list of paths to zip files or
directo&acirc; <br>
ries, delimited by the platform-specific path delimiter.</p>

<p style="margin-top: 1em">-extdirs Path <br>
Override location of VM&rsquo;s extension directories for
purposes of evaluating types when compiling. Path is a
single argument containing a list of paths to directories,
<br>
delimited by the platform-specific path delimiter.</p>

<p style="margin-top: 1em">-d Directory <br>
Specify where to place generated .class files. If not
specified, Directory defaults to the current working
dir.</p>

<p style="margin-top: 1em">-target [1.1 to 1.5] <br>
Specify classfile target setting (1.1 to 1.5, default is
1.2)</p>

<p style="margin-top: 1em">-1.3 Set compliance level to 1.3
This implies -source 1.3 and -target 1.1.</p>

<p style="margin-top: 1em">-1.4 Set compliance level to 1.4
(default) This implies -source 1.4 and -target 1.2.</p>

<p style="margin-top: 1em">-1.5 Set compliance level to
1.5. This implies -source 1.5 and -target 1.5.</p>

<p style="margin-top: 1em">-source [1.3|1.4|1.5] <br>
Toggle assertions (1.3, 1.4, or 1.5 - default is 1.4). When
using -source 1.3, an assert() statement valid under Java
1.4 will result in a compiler error. When using <br>
-source 1.4, treat assert as a keyword and implement
assertions according to the 1.4 language spec. When using
-source 1.5, Java 5 language features are permitted.</p>

<p style="margin-top: 1em">-nowarn Emit no warnings
(equivalent to &rsquo;-warn:none&rsquo;) This does not
suppress messages generated by declare warning or Xlint.</p>

<p style="margin-top: 1em">-warn: items <br>
Emit warnings for any instances of the comma-delimited list
of questionable code (eg
&rsquo;-warn:unusedLocals,deprecation&rsquo;):</p>

<p style="margin-top: 1em">constructorName method with
constructor name <br>
packageDefaultMethod attempt to override package-default
method <br>
deprecation usage of deprecated type or member <br>
maskedCatchBlocks hidden catch block <br>
unusedLocals local variable never read <br>
unusedArguments method argument never read <br>
unusedImports import statement not used by code in file <br>
none suppress all compiler warnings</p>

<p style="margin-top: 1em">-warn:none does not suppress
messages generated by declare warning or Xlint.</p>

<p style="margin-top: 1em">-deprecation <br>
Same as -warn:deprecation</p>

<p style="margin-top: 1em">-noImportError <br>
Emit no errors for unresolved imports</p>

<p style="margin-top: 1em">-proceedOnError <br>
Keep compiling after error, dumping class files with problem
methods</p>

<p style="margin-top: 1em">-g:[lines,vars,source] <br>
debug attributes level, that may take three forms:</p>

<p style="margin-top: 1em">-g all debug info
(&rsquo;-g:lines,vars,source&rsquo;) <br>
-g:none no debug info <br>
-g:{items} debug info for any/all of [lines, vars, source],
e.g., <br>
-g:lines,source</p>

<p style="margin-top: 1em">-preserveAllLocals <br>
Preserve all local variables during code generation (to
facilitate debugging).</p>

<p style="margin-top: 1em">-referenceInfo <br>
Compute reference information.</p>

<p style="margin-top: 1em">-encoding format <br>
Specify default source encoding format. Specify custom
encoding on a per file basis by suffixing each input source
file/folder name with &rsquo;[encoding]&rsquo;.</p>

<p style="margin-top: 1em">-verbose Emit messages about
accessed/processed compilation units</p>

<p style="margin-top: 1em">-showWeaveInfo <br>
Emit messages about weaving</p>

<p style="margin-top: 1em">-log file Specify a log file for
compiler messages.</p>

<p style="margin-top: 1em">-progress Show progress
(requires -log mode).</p>

<p style="margin-top: 1em">-time Display speed
information.</p>

<p style="margin-top: 1em">-noExit Do not call
System.exit(n) at end of compilation (n=0 if no error)</p>

<p style="margin-top: 1em">-repeat N Repeat compilation
process N times (typically to do performance analysis).</p>

<p style="margin-top: 1em">-XterminateAfterCompilation <br>
Causes compiler to terminate before weaving</p>

<p style="margin-top: 1em">-XaddSerialVersionUID <br>
Causes the compiler to calculate and add the
SerialVersionUID field to any type implementing Serializable
that is affected by an aspect. The field is calculated based
<br>
on the class before weaving has taken place.</p>

<p style="margin-top: 1em">-Xreweavable[:compress] <br>
(Experimental - deprecated as now default) Runs weaver in
reweavable mode which causes it to create woven classes that
can be rewoven, subject to the restriction that <br>
on attempting a reweave all the types that advised the woven
type must be accessible.</p>

<p style="margin-top: 1em">-XnoInline <br>
(Experimental) do not inline around advice</p>

<p style="margin-top: 1em">-XincrementalFile file <br>
(Experimental) This works like incremental mode, but using a
file rather than standard input to control the compiler. It
will recompile each time file is changed and <br>
and halt when file is deleted.</p>

<p style="margin-top: 1em">-XserializableAspects <br>
(Experimental) Normally it is an error to declare aspects
Serializable. This option removes that restriction.</p>

<p style="margin-top: 1em">-XnotReweavable <br>
(Experimental) Create class files that can&rsquo;t be
subsequently rewoven by AspectJ.</p>

<p style="margin-top: 1em">-Xajruntimelevel:1.2,
ajruntimelevel:1.5 <br>
(Experimental) Allows code to be generated that targets a
1.2 or a 1.5 level AspectJ runtime (default 1.5)</p>

<p style="margin-top: 1em">File names <br>
ajc accepts source files with either the .java extension or
the .aj extension. We normally use .java for all of our
files in an AspectJ system -- files that contain aspects
<br>
as well as files that contain classes. However, if you have
a need to mechanically distinguish files that use
AspectJ&rsquo;s additional functionality from those that are
pure Java we <br>
recommend using the .aj extension for those files.</p>

<p style="margin-top: 1em">We&rsquo;d like to discourage
other means of mechanical distinction such as naming
conventions or sub-packages in favor of the .aj
extension.</p>

<p style="margin-top: 1em">&Acirc;&middot; Filename
conventions are hard to enforce and lead to awkward names
for your aspects. Instead of TracingAspect.java we recommend
using Tracing.aj (or just Tracing.java) <br>
instead.</p>

<p style="margin-top: 1em">&Acirc;&middot; Sub-packages
move aspects out of their natural place in a system and can
create an artificial need for privileged aspects. Instead of
adding a sub-package like aspects we <br>
recommend using the .aj extension and including these files
in your existing packages instead.</p>

<p style="margin-top: 1em">Compatibility <br>
AspectJ is a compatible extension to the Java programming
language. The AspectJ compiler adheres to the The Java
Language Specfication, Second Edition (BOOK) <br>
http://java.sun.com/docs/books/jls/index.html and to the The
Java Virtual Machine Specification, Second Edition (BOOK)
http://java.sun.com/docs/books/vmspec/index.html and runs
<br>
on any Java 2 compatible platform. The code it generates
runs on any Java 1.1 or later compatible platform. For more
information on compatibility with Java and with previous
<br>
releases of AspectJ, see &quot;&quot; &gt;.</p>

<p style="margin-top: 1em">Examples <br>
A simple example</p>

<p style="margin-top: 1em">Compile two files:</p>

<p style="margin-top: 1em">ajc HelloWorld.java
Trace.java</p>

<p style="margin-top: 1em">An example using -argfile/@</p>

<p style="margin-top: 1em">To avoid specifying file names
on the command line, list source files in a line-delimited
text argfile. Source file paths may be absolute or relative
to the argfile, and may <br>
include other argfiles by @-reference. The following file
sources.lst contains absolute and relative files and
@-references:</p>

<p style="margin-top: 1em">Gui.java <br>
/home/user/src/Library.java <br>
data/Repository.java <br>
data/Access.java <br>
@../../common/common.lst <br>
@/home/user/src/lib.lst <br>
view/body/ArrayView.java</p>

<p style="margin-top: 1em">Compile the files using either
the -argfile or @ form:</p>

<p style="margin-top: 1em">ajc -argfile sources.lst <br>
ajc @sources.lst</p>

<p style="margin-top: 1em">Argfiles are also supported by
jikes and javac, so you can use the files in hybrid builds.
However, the support varies:</p>

<p style="margin-top: 1em">&Acirc;&middot; Only ajc accepts
command-line options</p>

<p style="margin-top: 1em">&Acirc;&middot; Jikes and Javac
do not accept internal @argfile references.</p>

<p style="margin-top: 1em">&Acirc;&middot; Jikes and Javac
only accept the @file form on the command line.</p>

<p style="margin-top: 1em">An example using -inpath and
-aspectpath</p>

<p style="margin-top: 1em">Bytecode weaving using -inpath:
AspectJ 1.2 supports weaving .class files in input zip/jar
files and directories. Using input jars is like compiling
the corresponding source <br>
files, and all binaries are emitted to output. Although
Java-compliant compilers may differ in their output, ajc
should take as input any class files produced by javac,
jikes, <br>
eclipse, and, of course, ajc. Aspects included in -inpath
will be woven into like other .class files, and they will
affect other types as usual.</p>

<p style="margin-top: 1em">Aspect libraries using
-aspectpath: AspectJ 1.1 supports weaving from read-only
libraries containing aspects. Like input jars, they affect
all input; unlike input jars, they <br>
themselves are not affected or emitted as output. Sources
compiled with aspect libraries must be run with the same
aspect libraries on their classpath.</p>

<p style="margin-top: 1em">The following example builds the
tracing example in a command-line environment; it creates a
read-only aspect library, compiles some classes for use as
input bytecode, and com&acirc; <br>
piles the classes and other sources with the aspect
library.</p>

<p style="margin-top: 1em">The tracing example is in the
AspectJ distribution ({aspectj}/doc/examples/tracing). This
uses the following files:</p>

<p style="margin-top: 1em">aspectj1.1/ <br>
bin/ <br>
ajc <br>
lib/ <br>
aspectjrt.jar <br>
examples/ <br>
tracing/ <br>
Circle.java <br>
ExampleMain.java <br>
lib/ <br>
AbstractTrace.java <br>
TraceMyClasses.java <br>
notrace.lst <br>
Square.java <br>
tracelib.lst <br>
tracev3.lst <br>
TwoDShape.java <br>
version3/ <br>
Trace.java <br>
TraceMyClasses.java</p>

<p style="margin-top: 1em">Below, the path separator is
taken as &quot;;&quot;, but file separators are
&quot;/&quot;. All commands are on one line. Adjust paths
and commands to your environment as needed.</p>

<p style="margin-top: 1em">Setup the path, classpath, and
current directory:</p>

<p style="margin-top: 1em">cd examples <br>
export ajrt=../lib/aspectjrt.jar <br>
export CLASSPATH=&quot;$ajrt&quot; <br>
export PATH=&quot;../bin:$PATH&quot;</p>

<p style="margin-top: 1em">Build a read-only tracing
library:</p>

<p style="margin-top: 1em">ajc -argfile
tracing/tracelib.lst -outjar tracelib.jar</p>

<p style="margin-top: 1em">Build the application with
tracing in one step:</p>

<p style="margin-top: 1em">ajc -aspectpath tracelib.jar
-argfile tracing/notrace.lst -outjar tracedapp.jar</p>

<p style="margin-top: 1em">Run the application with
tracing:</p>

<p style="margin-top: 1em">java -classpath
&quot;$ajrt;tracedapp.jar;tracelib.jar&quot;
tracing.ExampleMain</p>

<p style="margin-top: 1em">Build the application with
tracing from binaries in two steps:</p>

<p style="margin-top: 1em">&Acirc;&middot; (a) Build the
application classes (using javac for demonstration&rsquo;s
sake):</p>

<p style="margin-top: 1em">mkdir classes <br>
javac -d classes tracing/*.java <br>
jar cfM app.jar -C classes .</p>

<p style="margin-top: 1em">&Acirc;&middot; (b) Build the
application with tracing:</p>

<p style="margin-top: 1em">ajc -inpath app.jar -aspectpath
tracelib.jar -outjar tracedapp.jar</p>

<p style="margin-top: 1em">Run the application with tracing
(same as above):</p>

<p style="margin-top: 1em">java -classpath
&quot;$ajrt;tracedapp.jar;tracelib.jar&quot;
tracing.ExampleMain</p>

<p style="margin-top: 1em">Run the application without
tracing:</p>

<p style="margin-top: 1em">java -classpath
&quot;app.jar&quot; tracing.ExampleMain</p>

<p style="margin-top: 1em">The AspectJ compiler API <br>
The AspectJ compiler is implemented completely in Java and
can be called as a Java class. The only interface that
should be considered public are the public methods in <br>
org.aspectj.tools.ajc.Main. E.g., main(String[] args) takes
the the standard ajc command line arguments. This means that
an alternative way to run the compiler is</p>

<p style="margin-top: 1em">java org.aspectj.tools.ajc.Main
[option...] [file...]</p>

<p style="margin-top: 1em">To access compiler messages
programmatically, use the methods setHolder(IMessageHolder
holder) and/or run(String[] args, IMessageHolder holder).
ajc reports each message to the <br>
holder using IMessageHolder.handleMessage(..). If you just
want to collect the messages, use MessageHandler as your
IMessageHolder. For example, compile and run the <br>
following with aspectjtools.jar on the classpath:</p>

<p style="margin-top: 1em">import org.aspectj.bridge.*;
<br>
import org.aspectj.tools.ajc.Main; <br>
import java.util.Arrays;</p>

<p style="margin-top: 1em">public class WrapAjc { <br>
public static void main(String[] args) { <br>
Main compiler = new Main(); <br>
MessageHandler m = new MessageHandler(); <br>
compiler.run(args, m); <br>
IMessage[] ms = m.getMessages(null, true); <br>
System.out.println(&quot;messages: &quot; +
Arrays.asList(ms)); <br>
} <br>
}</p>

<p style="margin-top: 1em">Stack Traces and the SourceFile
attribute <br>
Unlike traditional java compilers, the AspectJ compiler may
in certain cases generate classfiles from multiple source
files. Unfortunately, the original Java class file format
<br>
does not support multiple SourceFile attributes. In order to
make sure all source file information is available, the
AspectJ compiler may in some cases encode multiple filenames
<br>
in the SourceFile attribute. When the Java VM generates
stack traces, it uses this attribute to specify the source
file.</p>

<p style="margin-top: 1em">(The AspectJ 1.0 compiler also
supports the .class file extensions of JSR-45. These permit
compliant debuggers (such as jdb in Java 1.4.1) to identify
the right file and line <br>
even given many source files for a single class. JSR-45
support is planned for ajc in AspectJ 1.1, but is not in the
initial release. To get fully debuggable .class files, use
<br>
the -XnoInline option.)</p>

<p style="margin-top: 1em">Probably the only time you may
see this format is when you view stack traces, where you may
encounter traces of the format</p>

<p style="margin-top: 1em">java.lang.NullPointerException
<br>
at
Main.new$constructor_call37(Main.java;SynchAspect.java[1k]:1030)</p>

<p style="margin-top: 1em">where instead of the usual</p>

<p style="margin-top: 1em">File:LineNumber</p>

<p style="margin-top: 1em">format, you see</p>


<p style="margin-top: 1em">File0;File1[Number1];File2[Number2]
... :LineNumber</p>

<p style="margin-top: 1em">In this case, LineNumber is the
usual offset in lines plus the &quot;start line&quot; of the
actual source file. That means you use LineNumber both to
identify the source file and to find <br>
the line at issue. The number in [brackets] after each file
tells you the virtual &quot;start line&quot; for that file
(the first file has a start of 0).</p>

<p style="margin-top: 1em">In our example from the null
pointer exception trace, the virtual start line is 1030.
Since the file SynchAspect.java &quot;starts&quot; at line
1000 [1k], the LineNumber points to line <br>
30 of SynchAspect.java.</p>

<p style="margin-top: 1em">So, when faced with such stack
traces, the way to find the actual source location is to
look through the list of &quot;start line&quot; numbers to
find the one just under the shown line <br>
number. That is the file where the source location can
actually be found. Then, subtract that &quot;start
line&quot; from the shown line number to find the actual
line number within that <br>
file.</p>

<p style="margin-top: 1em">In a class file that comes from
only a single source file, the AspectJ compiler generates
SourceFile attributes consistent with traditional Java
compilers.</p>
 
<p style="margin-top: 1em">ajc(1)</p>
<hr>
</body>
</html>
