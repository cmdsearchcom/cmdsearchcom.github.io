<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>CRASM(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">CRASM(1)</td>
    <td class="head-vol">Crasm-1.3</td>
    <td class="head-rtitle">CRASM(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
crasm - Cross assembler for 6800/6801/6803/6502/65C02/Z80
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>crasm [-o </b><i>codefile</i><b>] [-slx] </b><i>asmfile</i>
<div style="height: 1.00em;">&#x00A0;</div>
Assemble the microprocessor program <i>asmfile</i> and produce output file
  <i>codefile</i> in Intel HEX or Motorola S Code format. A program listing and
  a symbol table are also produced on the standard output. The current version
  of <b>crasm</b> can assemble programs for the <b>6800,</b> <b>6801,</b>
  <b>6803,</b> <b>6502,</b> <b>65C02,</b> and <b>Z80</b> processors. The full
  list is printed when you invoke <b>crasm</b> without arguments.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-o </b><i>codefile</i></dt>
  <dd class="It-tag">Specify the name of the output file. No output file is
      produced without this option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s</b></dt>
  <dd class="It-tag">Disable warnings.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l</b></dt>
  <dd class="It-tag">Disable program listing output.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-x</b></dt>
  <dd class="It-tag">Disable symbol table output.</dd>
</dl>
<h1 class="Sh" title="Sh" id="SYNTAX"><a class="selflink" href="#SYNTAX">SYNTAX</a></h1>
Each line of the assembly program should follow one of the following templates,
  where the brackets delimit optional parts.
<dl class="Bl-tag">
  <dt class="It-tag">
  <div class="Pp"></div>
  </dt>
  <dd class="It-tag"><b>[;</b><i>comment</i><b>]</b>
    <div>&#x00A0;</div>
    <b></b><i>label</i><b> = </b><i>expression</i><b>
      [;</b><i>comment</i><b>]</b>
    <div>&#x00A0;</div>
    <b>[</b><i>label</i><b>] </b><i>mnemonic</i><b> </b><i>operand</i><b>
      [;</b><i>comment</i><b>]</b></dd>
</dl>
<div class="Pp"></div>
Comments are introduced by a semicolon <b></b>(<b>;</b>) and extend to the end
  of the line. Labels are identifiers containing up to 36 alphanumeric
  characters (including period and underscore). Labels cannot start with a
  digit. The format of the mnemonics and operands field depends on the selected
  micro-processor. A few mnemonics are valid for all processors and are used to
  give directives to the assembled. These are known as
  &quot;pseudo-mnemonics&quot;.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="Labels"><a class="selflink" href="#Labels">&#x2002;&#x2002;&#x2002;Labels</a></h1>
Labels are identifiers representing
<div>&#x00A0;</div>
&#x2014; an absolute address,
<div>&#x00A0;</div>
&#x2014; a relative address (position independent code),
<div>&#x00A0;</div>
&#x2014; a register,
<div>&#x00A0;</div>
&#x2014; a list of registers,
<div>&#x00A0;</div>
&#x2014; a specific bit at a specific address,
<div>&#x00A0;</div>
&#x2014; or a mnemonic.
<div class="Pp"></div>
Most labels are composed of at most 36 alphanumeric characters, periods
  <b></b>(<b>.</b>) or underscores <b></b>(<b>_</b>). Labels cannot start with a
  digit. They are case insensitive.
<div class="Pp"></div>
Labels starting with a period <b></b>(<b>.</b>) are local labels whose scope is
  either limited to the macro in which they are defined, or to the code segment
  delimited by the pseudo-mnemonics <b>CODE</b> or <b>DUMMY</b>.
<div class="Pp"></div>
The predefined &quot;star&quot; label <b></b>(<b>*</b>) represents the current
  program counter, that is to say, the address where the next assembly code
  instruction will be encoded. Other predefined labels include all
  pseudo-mnemonics, micro-processor specific mnemonics and register names.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="Constants"><a class="selflink" href="#Constants">&#x2002;&#x2002;&#x2002;Constants</a></h1>
The assembled recognizes numerical constants expressed in decimal, hexadecimal,
  octal, binary, or ascii.
<table class="tbl">
  <colgroup>
    <col style="width: 11.00ex;"/>
    <col style="width: 18.00ex;"/>
    <col style="width: 61.00ex;"/>
  </colgroup>
  <tr>
    <td>Type</td>
    <td>Format</td>
    <td>Examples</td>
  </tr>
  <tr>
    <td colspan="0"></td>
  </tr>
  <tr>
    <td>decimal</td>
    <td><i>dddd</i></td>
    <td><i></i><b>1234</b>,<b> 675</b>,<b> 12</b>,<b> 1</b>, but not
      <b>0.12</b>.</td>
  </tr>
  <tr>
    <td colspan="0"></td>
  </tr>
  <tr>
    <td>hexadecimal</td>
    <td><b>$</b><i>dddd</i></td>
    <td><i></i><b>$fd12</b>,<b> $2AC</b>,<b> $0</b>.</td>
  </tr>
  <tr>
    <td></td>
    <td><i>dddd</i><b>H</b></td>
    <td><b>03H</b>,<b> 2da7H</b>,<b> 0FC84H</b>, but not <b>FC84H</b>.</td>
  </tr>
  <tr>
    <td></td>
    <td><b>0X</b><i>dddd</i></td>
    <td><i></i><b>0x03</b>,<b> 0x2AC</b>,<b> 0Xfc84</b>.</td>
  </tr>
  <tr>
    <td colspan="0"></td>
  </tr>
  <tr>
    <td>octal</td>
    <td><i>dddd</i><b>Q</b></td>
    <td><b>377Q</b>,<b> 012412Q</b>.</td>
  </tr>
  <tr>
    <td colspan="0"></td>
  </tr>
  <tr>
    <td>binary</td>
    <td><b>%</b><i>dddd</i></td>
    <td><i></i><b>%01110110</b>,<b> %1100</b>.</td>
  </tr>
  <tr>
    <td></td>
    <td><i>dddd</i><b>B</b></td>
    <td><b>01110110B</b>,<b> 1100B</b>.</td>
  </tr>
  <tr>
    <td></td>
    <td><b>0B</b><i>dddd</i></td>
    <td><i></i><b>0b1100</b></td>
  </tr>
  <tr>
    <td colspan="0"></td>
  </tr>
  <tr>
    <td>ascii</td>
    <td><b>'</b><i>cccc</i><b>'</b></td>
    <td><b>'a'</b>,<b> 'AB'</b>,<b> '&quot;'</b>,<b> '\n'</b>,<b> '\''</b>.</td>
  </tr>
  <tr>
    <td></td>
    <td><b>&quot;</b><i>cccc</i><b>&quot;</b></td>
    <td><b>&quot;\t&quot;</b>,<b> &quot;\&quot;&quot;</b>,<b>
      &quot;a'b&quot;</b>.</td>
  </tr>
</table>
<h1 class="Sh" title="Sh" id="Expressions"><a class="selflink" href="#Expressions">&#x2002;&#x2002;&#x2002;Expressions</a></h1>
Like labels, expressions can represent an absolute address (<i>abs</i>), a
  relative address for position independent code (<i>rel</i>), a register
  (<i>reg</i>), or a list of registers (<i>reglist</i>), or a reference to a
  specific bit at a specific address (<i>bspec</i>).
<div style="height: 1.00em;">&#x00A0;</div>
The following operators are recognized on expressions.
<table class="tbl">
  <colgroup>
    <col style="width: 27.00ex;"/>
    <col style="width: 13.00ex;"/>
    <col style="width: 32.00ex;"/>
  </colgroup>
  <tr>
    <td>Syntax</td>
    <td>Result</td>
    <td>Description</td>
  </tr>
  <tr>
    <td colspan="0"></td>
  </tr>
  <tr>
    <td> <i>abs</i><b>{</b><i>abs</i><b>}</b></td>
    <td><i>bspec</i></td>
    <td>bit reference, e.g. <b>pia{3}</b></td>
  </tr>
  <tr>
    <td> <b>ADDR(</b><i>abs</i><b>)</b></td>
    <td><i>abs</i></td>
    <td>address from a bit reference</td>
  </tr>
  <tr>
    <td> <b>BIT(</b><i>abs</i><b>)</b></td>
    <td><i>abs</i></td>
    <td>bit number from a bit reference</td>
  </tr>
  <tr>
    <td colspan="0"></td>
  </tr>
  <tr>
    <td> <b>- </b><i>abs</i></td>
    <td><i></i><i>abs</i></td>
    <td>two's complement</td>
  </tr>
  <tr>
    <td> <b>~ </b><i>abs</i></td>
    <td><i></i><i>abs</i></td>
    <td>one's complement</td>
  </tr>
  <tr>
    <td colspan="0"></td>
  </tr>
  <tr>
    <td> <i>abs</i><b> &lt;&lt; </b><i>abs</i></td>
    <td><i>abs</i></td>
    <td>left shift</td>
  </tr>
  <tr>
    <td> <i>abs</i><b> &gt;&gt; </b><i>abs</i></td>
    <td><i>abs</i></td>
    <td>right shift</td>
  </tr>
  <tr>
    <td colspan="0"></td>
  </tr>
  <tr>
    <td> <i>abs</i><b> | </b><i>abs</i></td>
    <td><i>abs</i></td>
    <td>bitwise or</td>
  </tr>
  <tr>
    <td> <i>abs</i><b> &amp; </b><i>abs</i></td>
    <td><i>abs</i></td>
    <td>bitwise and</td>
  </tr>
  <tr>
    <td> <i>abs</i><b> ^ </b><i>abs</i></td>
    <td><i>abs</i></td>
    <td>bitwise xor</td>
  </tr>
  <tr>
    <td colspan="0"></td>
  </tr>
  <tr>
    <td> <i>abs</i><b> * </b><i>abs</i></td>
    <td><i>abs</i></td>
    <td>multiplication</td>
  </tr>
  <tr>
    <td> <i>abs</i><b> * </b><i>abs</i></td>
    <td><i>abs</i></td>
    <td>division</td>
  </tr>
  <tr>
    <td colspan="0"></td>
  </tr>
  <tr>
    <td> <i>abs</i><b> + </b><i>abs</i></td>
    <td><i>abs</i></td>
    <td>addition</td>
  </tr>
  <tr>
    <td> <i>rel</i><b> + </b><i>abs</i></td>
    <td><i>rel</i></td>
    <td>addition</td>
  </tr>
  <tr>
    <td> <i>abs</i><b> - </b><i>abs</i></td>
    <td><i>abs</i></td>
    <td>subtraction</td>
  </tr>
  <tr>
    <td> <i>rel</i><b> - </b><i>abs</i></td>
    <td><i>rel</i></td>
    <td>subtraction</td>
  </tr>
  <tr>
    <td> <i>rel</i><b> - </b><i>rel</i></td>
    <td><i>abs</i></td>
    <td>subtraction</td>
  </tr>
  <tr>
    <td colspan="0"></td>
  </tr>
  <tr>
    <td> <i>reg</i><b> - </b><i>reg</i></td>
    <td><i>reglist</i></td>
    <td>register range</td>
  </tr>
  <tr>
    <td> <i>reglist</i><b> \ </b><i>reg</i></td>
    <td><i>reglist</i></td>
    <td>register list</td>
  </tr>
</table>
<div class="Pp"></div>
The table lists operators in order of decreasing precedence. Parenthesis can be
  used to avoid ambiguities. A warning is generated when an entire expression is
  surrounded with parenthesis and can be confused with a micro-processor
  addressing mode.
<div class="Pp"></div>
Examples:
<dl class="Bl-tag">
  <dt class="It-tag">
  <div class="Pp"></div>
  </dt>
  <dd class="It-tag"><b> (base+$12) &gt;&gt; 8 &amp; 0xff00 </b>
    <div>&#x00A0;</div>
     <b> 'A'-80H </b>
    <div>&#x00A0;</div>
     <b> (base+0x12) </b></dd>
</dl>
<div class="Pp"></div>
The last example causes a warning because the parenthesis were not necessary and
  might suggest a micro-processor addressing mode.
<div class="Pp"></div>
All arithmetic expressions are evaluated on 32 bits. Arithmetic operations
  overflow silently. The arithmetic values are then truncated to the size
  implied by the micro-processor mnemonic. This truncation might cause a warning
  message.
<div style="height: 1.00em;">&#x00A0;</div>
Examples: all the following instructions
<dl class="Bl-tag">
  <dt class="It-tag">
  <div class="Pp"></div>
  </dt>
  <dd class="It-tag">(6502)	<b>lda #$1234</b>
    <div>&#x00A0;</div>
    (6800)	 <b>ldaa $1234,x</b>
    <div>&#x00A0;</div>
    (Z80)	 <b>ld (ix+0C2H),b</b></dd>
</dl>
<div class="Pp"></div>
cause a warning
<dl class="Bl-tag">
  <dt class="It-tag">
  <div class="Pp"></div>
  </dt>
  <dd class="It-tag"><b>&gt;&gt;&gt; WARNING: Operand overflow</b></dd>
</dl>
<div class="Pp"></div>
However expression
<dl class="Bl-tag">
  <dt class="It-tag">
  <div class="Pp"></div>
  </dt>
  <dd class="It-tag"><b>$1123454 * 1298992</b></dd>
</dl>
<div class="Pp"></div>
overflows silently.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="Pseudo-mnemonics"><a class="selflink" href="#Pseudo-mnemonics">&#x2002;&#x2002;&#x2002;Pseudo-mnemonics</a></h1>
The following pseudo-mnemonics are always recognized.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<b>CPU </b><i>cpuname</i>
<br/>
Indicates the selected micro-processor type. This must appear before anu
  micro-processor specific instruction. The possible values of <i>cpuname</i>
  are listed when you invoke <b>crasm</b> without arguments. The current list
  includes <b>6800,</b> <b>6801,</b> <b>6803,</b> <b>6502,</b> <b>65C02,</b> and
  <b>Z80</b>
<br/>
<div class="Pp"></div>
<b>OUTPUT </b><i>binformat</i>
<br/>
Indicates the format of the output file. Argument <i>binformat</i> can take
  values <b>SCODE</b> for producing an output file using Motorola's S code, or
  <b>HEX</b> for Intel's Hex format. The default depends on the selected
  micro-processor.
<br/>
<div class="Pp"></div>
<b>CODE</b>
<br/>
Delimit the scope of local labels and introduce a program section.
<dl class="Bl-tag">
  <dt class="It-tag"><b>DUMMY</b></dt>
  <dd class="It-tag">Delimit the scope of local labels and introduce a fake
      program section whose sole effect is to define labels without generating
      code.
    <br/>
  </dd>
</dl>
<div class="Pp"></div>
<b></b><i>label</i><b> EQU </b><i>expression</i>
<div>&#x00A0;</div>
<b></b><i>label</i><b> = </b><i>expression</i>
<br/>
Define the value of label <i>label</i>. Labels defined using these directives
  can be redefined later in the program.
<br/>
<div class="Pp"></div>
<b>[</b><i>label</i><b>] DB
  </b><i>expression</i><b>[,...,</b><i>expression</i><b>]</b>
<br/>
Insert the specified data bytes (8 bits).
<br/>
<div class="Pp"></div>
<b>[</b><i>label</i><b>] DW
  </b><i>expression</i><b>[,...,</b><i>expression</i><b>]</b>
<br/>
Insert the specified data words (16 bits). The byte ordering depends on the
  selected micro-processor.
<br/>
<div class="Pp"></div>
<b>[</b><i>label</i><b>] DL
  </b><i>expression</i><b>[,...,</b><i>expression</i><b>]</b>
<br/>
Insert the specified data longs (32 bits). The byte ordering depends on the
  selected micro-processor.
<br/>
<div class="Pp"></div>
<b>[</b><i>label</i><b>] DDB
  </b><i>expression</i><b>[,...,</b><i>expression</i><b>]</b>
<br/>
Insert the specified double bytes (16 bits). The byte ordering is the opposite
  of the usual byte ordering for the selected micro-processor.
<br/>
<div class="Pp"></div>
<b>[</b><i>label</i><b>] ASC </b><i>stringconstant</i>
<br/>
Insert the ascii representation of the string <i>stringconstant .</i> The string
  must be delimited by double quotes. The C escape sequences <b>\r</b>,
  <b>\n</b>, <b>\t</b>, <b>\0</b>, <b>\'</b>, <b>\&quot;</b>, and <b>\\</b> are
  recognized.
<br/>
<div class="Pp"></div>
<b>[</b><i>label</i><b>] DS </b><i>countexpr</i><b>,[</b><i>valexpr</i><b>]</b>
<br/>
Insere <i>countexpr</i> bytes with value <i>valexpr</i>.	 The default value is
  zero.
<br/>
<div class="Pp"></div>
<b>[</b><i>label</i><b>] ALIGN EVEN</b>
<div>&#x00A0;</div>
<b>[</b><i>label</i><b>] ALIGN ODD</b>
<br/>
Insert a null byte in order to make the program counter even or odd.
<br/>
<div class="Pp"></div>
<b>IF </b><i>condexpr</i>
<div>&#x00A0;</div>
<br/>
 ...
<div>&#x00A0;</div>
<b>ELSE</b>
<div>&#x00A0;</div>
<br/>
 ...
<div>&#x00A0;</div>
<b>ENDC</b>
<br/>
Conditional assembly: If expression <i>condexpr</i> is non zero, process the
  lines located between the <b>IF</b> and the <b>ELSE</b> pseudo-mnemonics.
  Otherwise process the lines located between the <b>ELSE</b> and the
  <b>ENDC</b> pseudo-mnemonics. Conditional assembly instructions can be nested.
  The <b>ELSE</b> part can be omitted.
<br/>
<div class="Pp"></div>
<b></b><i>label</i><b> MACRO</b>
<div>&#x00A0;</div>
<br/>
 ...
<div>&#x00A0;</div>
<b> ENDM</b>
<div>&#x00A0;</div>
<br/>
Define a new mnemonic <i>label</i> equivalent to all the instructions located
  between the <b>MACRO</b> and <b>ENDM</b> pseudo-mnemonics. Invocations of the
  macro can specify a list of comma separated operands. The character sequences
  <b>\1</b>, <b>\2</b>, ... <b>\</b><i>N</i> in the macro definition are
  replaced by the supplied operands. The character sequence <b>\0</b> is
  replaced by the number of supplied operands.
<br/>
<div class="Pp"></div>
<b>EXITM</b>
<br/>
This pseudo mnemonic can be used inside a macro definition to exit the macro.
  This is useful in conjunction with the conditional assembly pseudo-mnemonics.
<br/>
<div class="Pp"></div>
<b>INCLUDE </b><i>filename</i>
<br/>
Force the assembler to process file named <i>filename</i> at the current point.
<br/>
<div class="Pp"></div>
<b>LIST ON</b>
<div>&#x00A0;</div>
<b>LIST OFF</b>
<br/>
Enable or disable the production of a listing (default is on.)
<br/>
<div class="Pp"></div>
<b>CLIST ON</b>
<div>&#x00A0;</div>
<b>CLIST OFF</b>
<br/>
Enable or disable the production of a listing for the non active branches of a
  conditional assembly construct (default is on.)
<br/>
<div class="Pp"></div>
<b>ILIST ON</b>
<div>&#x00A0;</div>
<b>ILIST OFF</b>
<br/>
Enable or disable the production of a listing for included files (default is
  off.)
<br/>
<div class="Pp"></div>
<b>MLIST ON</b>
<div>&#x00A0;</div>
<b>MLIST OFF</b>
<br/>
Enable or disable the production of a listing for the macro expansions (default
  is off.)
<br/>
<div class="Pp"></div>
<b>NAM </b>title
<br/>
Provide name <i>title</i> for the header of the listing pages.
<br/>
<div class="Pp"></div>
<b>PAGE</b>
<br/>
Start a new listing page.
<br/>
<div class="Pp"></div>
<b>PAGE </b>columns<b>,</b>rows
<br/>
Specify the size of a listing page.
<br/>
<div class="Pp"></div>
<b>SKIP </b>number
<br/>
Skip <i>number</i> lines.
<br/>
<div class="Pp"></div>
<b>FAIL </b>message
<br/>
Generate an error message <i>message</i>.
<br/>
<h1 class="Sh" title="Sh" id="EXAMPLE"><a class="selflink" href="#EXAMPLE">EXAMPLE</a></h1>
Here is a small 6502 program:
<dl class="Bl-tag">
  <dt class="It-tag">
  <div class="Pp"></div>
  </dt>
  <dd class="It-tag"><b></b>
    <br/>
    <b> cpu 6502</b>
    <div>&#x00A0;</div>
    <br/>
     cout = $fded ; display a character
    <div>&#x00A0;</div>
    <br/>
     * = $300 ; assemble at $300
    <div>&#x00A0;</div>
    <br/>
     code
    <div>&#x00A0;</div>
    <br/>
     pstring ldy #0
    <div>&#x00A0;</div>
    <br/>
     .1 lda message,y
    <div>&#x00A0;</div>
    <br/>
     beq .2
    <div>&#x00A0;</div>
    <br/>
     jsr cout
    <div>&#x00A0;</div>
    <br/>
     iny
    <div>&#x00A0;</div>
    <br/>
     .2 bne .1
    <div>&#x00A0;</div>
    <br/>
     rts
    <div>&#x00A0;</div>
    <br/>
     message asc &quot;This is the message&#x2002;&quot;
    <div>&#x00A0;</div>
    <br/>
     code </dd>
</dl>
<h1 class="Sh" title="Sh" id="CREDITS"><a class="selflink" href="#CREDITS">CREDITS</a></h1>
Leon Bottou, September 1987.
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">1/9/1987</td>
    <td class="foot-os">Crasm-1.3</td>
  </tr>
</table>
</body>
</html>
