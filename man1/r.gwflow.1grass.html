<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>r.gwflow(1grass)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">r.gwflow(1grass)</td>
    <td class="head-vol">Grass User's Manual</td>
    <td class="head-rtitle">r.gwflow(1grass)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<i></i><b>r.gwflow</b> - Numerical calculation program for transient, confined
  and unconfined groundwater flow in two dimensions.
<h1 class="Sh" title="Sh" id="KEYWORDS"><a class="selflink" href="#KEYWORDS">KEYWORDS</a></h1>
raster, groundwater flow, hydrology
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>r.gwflow</b>
<div>&#x00A0;</div>
<b>r.gwflow --help</b>
<div>&#x00A0;</div>
<b>r.gwflow</b> [-<b>f</b>] <b>phead</b>=<i>name</i> <b>status</b>=<i>name</i>
  <b>hc_x</b>=<i>name</i> <b>hc_y</b>=<i>name</i> [<b>q</b>=<i>name</i>]
  <b>s</b>= <i>name</i> [<b>recharge</b>=<i>name</i>] <b>top</b>=<i>name</i>
  <b>bottom</b>= <i>name</i> <b>output</b>=<i>name</i> [<b>vx</b>=<i>name</i>]
  [<b>vy</b>=<i>name</i>] [<b>budget</b>=<i>name</i>] <b>type</b>=<i>string</i>
  [ <b>river_bed</b>=<i>name</i>] [<b>river_head</b>=<i>name</i>]
  [<b>river_leak</b>= <i>name</i>] [<b>drain_bed</b>=<i>name</i>]
  [<b>drain_leak</b>= <i>name</i>] <b>dtime</b>=<i>float</i>
  [<b>maxit</b>=<i>integer</i>] [ <b>maxit</b>=<i>integer</i>]
  [<b>error</b>=<i>float</i>] [ <b>solver</b>=<i>name</i>] [--<b>overwrite</b>]
  [-- <b>help</b>] [--<b>verbose</b>] [--<b>quiet</b>] [--<b>ui</b>]
<h2 class="Ss" title="Ss" id="Flags:"><a class="selflink" href="#Flags:">Flags:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Allocate a full quadratic linear equation system, default is a sparse linear
      equation system.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--overwrite</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Allow output files to overwrite existing files</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Print usage summary</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verbose</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Verbose module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--quiet</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Quiet module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ui</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Force launching GUI dialog</dd>
</dl>
<h2 class="Ss" title="Ss" id="Parameters:"><a class="selflink" href="#Parameters:">Parameters:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>phead</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input raster map with initial piezometric head in [m]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>status</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input raster map providing boundary condition status: 0-inactive,
      1-active, 2-dirichlet</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>hc_x</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input raster map with x-part of the hydraulic conductivity tensor in
      [m/s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>hc_y</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input raster map with y-part of the hydraulic conductivity tensor in
      [m/s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>q</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input raster map with water sources and sinks in [m^3/s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>s</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input raster map with storativity for confined or effective porosity
      for unconfined groundwater flow booth in [-]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>recharge</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Recharge input raster map e.g: 6*10^-9 per cell in [m^3/s*m^2]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>top</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input raster map describing the top surface of the aquifer in
    [m]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>bottom</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input raster map describing the bottom surface of the aquifer in
    [m]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>output</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Output raster map storing the numerical result [m]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>vx</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Output raster map to store the groundwater filter velocity vector part in x
      direction [m/s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>vy</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Output raster map to store the groundwater filter velocity vector part in y
      direction [m/s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>budget</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Output raster map to store the groundwater budget for each cell [m^3/s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>type</b>=<i>string</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The type of groundwater flow
    <div>&#x00A0;</div>
    Options: <i>confined, unconfined</i>
    <div>&#x00A0;</div>
    Default: <i>confined</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>river_bed</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input raster map providing the height of the river bed in [m]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>river_head</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input raster map providing the water level (head) of the river with
      leakage connection in [m]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>river_leak</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input raster map providing the leakage coefficient of the river bed
      in [1/s].</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>drain_bed</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input raster map providing the height of the drainage bed in
    [m]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>drain_leak</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input raster map providing the leakage coefficient of the drainage
      bed in [1/s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>dtime</b>=<i>float</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The calculation time in seconds
    <div>&#x00A0;</div>
    Default: <i>86400</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>maxit</b>=<i>integer</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Maximum number of iteration used to solve the linear equation system
    <div>&#x00A0;</div>
    Default: <i>10000</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>maxit</b>=<i>integer</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The maximum number of iterations in the linearization approach
    <div>&#x00A0;</div>
    Default: <i>25</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>error</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Error break criteria for iterative solver
    <div>&#x00A0;</div>
    Default: <i>0.000001</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>solver</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The type of solver which should solve the symmetric linear equation system
    <div>&#x00A0;</div>
    Options: <i>cg, pcg, cholesky</i>
    <div>&#x00A0;</div>
    Default: <i>cg</i></dd>
</dl>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This numerical program calculates implicit transient, confined and unconfined
  groundwater flow in two dimensions based on raster maps and the current region
  settings. All initial and boundary conditions must be provided as raster maps.
  The unit in the location must be meters.
<div class="Pp"></div>
This module is sensitive to mask settings. All cells which are outside the mask
  are ignored and handled as no flow boundaries.
<table class="tbl">
  <colgroup>
    <col style="width: 60.00ex;"/>
  </colgroup>
  <tr>
    <td><i>Workflow of r.gwflow</i></td>
  </tr>
</table>
<div class="Pp"></div>
<i>r.gwflow</i> calculates the piezometric head and optionally the water budget
  and the filter velocity field, based on the hydraulic conductivity and the
  piezometric head. The vector components can be visualized with paraview if
  they are exported with <i>r.out.vtk</i>.
<div>&#x00A0;</div>
<div>&#x00A0;</div>
The groundwater flow will always be calculated transient. For stady state
  computation set the timestep to a large number (billions of seconds) or set
  the storativity/ effective porosity raster map to zero.
<div>&#x00A0;</div>
<div>&#x00A0;</div>
The water budget is calculated for each non inactive cell. The sum of the budget
  for each non inactive cell must be near zero. This is an indicator of the
  quality of the numerical result.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
The groundwater flow calculation is based on Darcy&#x2019;s law and a numerical
  implicit finite volume discretization. The discretization results in a
  symmetric and positive definit linear equation system in form of <i>Ax =
  b</i>, which must be solved. The groundwater flow partial differential
  equation is of the following form:
<div class="Pp"></div>
(dh/dt)*S = div (K grad h) + q
<div class="Pp"></div>
In detail for 2 dimensions:
<div class="Pp"></div>
(dh/dt)*S = Kxx * (d^2h/dx^2) + Kyy * (d^2h/dy^2) + q
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">h -- the piezometric head im [m]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">dt -- the time step for transient calculation in [s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">S -- the specific storage [1/m]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Kxx -- the hydraulic conductivity tensor part in x
      direction in [m/s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Kyy -- the hydraulic conductivity tensor part in y
      direction in [m/s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">q - inner source/sink in meter per second [1/s]</dd>
</dl>
</div>
<div class="Pp"></div>
Confined and unconfined groundwater flow is supported. Be aware that the
  storativity input parameter is handled differently in case of unconfined flow.
  Instead of the storativity, the effective porosity is expected.
<div class="Pp"></div>
To compute unconfined groundwater flow, a simple Picard based linearization
  scheme is used to solve the resulting non-linear equation system.
<div class="Pp"></div>
Two different boundary conditions are implemented, the Dirichlet and Neumann
  conditions. By default the calculation area is surrounded by homogeneous
  Neumann boundary conditions. The calculation and boundary status of single
  cells must be set with a status map, the following states are supportet:
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">0 == inactive - the cell with status 0 will not be
      calculated, active cells will have a no flow boundary to this cell</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">1 == active - this cell is used for groundwater floaw
      calculation, inner sources and recharge can be defined for those
    cells</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">2 == Dirichlet - cells of this type will have a fixed
      piezometric head value which do not change over the time</dd>
</dl>
</div>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
Note that all required raster maps are read into main memory. Additionally the
  linear equation system will be allocated, so the memory consumption of this
  module rapidely grow with the size of the input maps.
<div>&#x00A0;</div>
<div>&#x00A0;</div>
The resulting linear equation system <i>Ax = b</i> can be solved with several
  solvers. An iterative solvers with sparse and quadratic matrices support is
  implemented. The conjugate gradients method with (pcg) and without (cg)
  precondition. Additionally a direct Cholesky solver is available. This direct
  solver only work with normal quadratic matrices, so be careful using them with
  large maps (maps of size 10.000 cells will need more than one gigabyte of
  RAM). Always prefer a sparse matrix solver.
<h1 class="Sh" title="Sh" id="EXAMPLE"><a class="selflink" href="#EXAMPLE">EXAMPLE</a></h1>
Use this small script to create a working groundwater flow area and data. Make
  sure you are not in a lat/lon projection. It includes drainage and river input
  as well.
<div>&#x00A0;</div>
<pre>
# set the region accordingly
g.region res=25 res3=25 t=100 b=0 n=1000 s=0 w=0 e=1000 -p3
#now create the input raster maps for confined and unconfined aquifers
r.mapcalc expression=&quot;phead = if(row() == 1 , 50, 40)&quot;
r.mapcalc expression=&quot;status = if(row() == 1 , 2, 1)&quot;
r.mapcalc expression=&quot;well = if(row() == 20 &amp;&amp; col() == 20 , -0.01, 0)&quot;
r.mapcalc expression=&quot;hydcond = 0.00025&quot;
r.mapcalc expression=&quot;recharge = 0&quot;
r.mapcalc expression=&quot;top_conf = 20.0&quot;
r.mapcalc expression=&quot;top_unconf = 70.0&quot;
r.mapcalc expression=&quot;bottom = 0.0&quot;
r.mapcalc expression=&quot;null = 0.0&quot;
r.mapcalc expression=&quot;poros = 0.15&quot;
r.mapcalc expression=&quot;s = 0.0001&quot;
# The maps of the river
r.mapcalc expression=&quot;river_bed = if(col() == 35 , 48, null())&quot;
r.mapcalc expression=&quot;river_head = if(col() == 35 , 49, null())&quot;
r.mapcalc expression=&quot;river_leak = if(col() == 35 , 0.0001, null())&quot;
# The maps of the drainage
r.mapcalc expression=&quot;drain_bed = if(col() == 5 , 48, null())&quot;
r.mapcalc expression=&quot;drain_leak = if(col() == 5 , 0.01, null())&quot;
#confined groundwater flow with cg solver and sparse matrix, river and drain
#do not work with this confined aquifer (top == 20m)
r.gwflow solver=cg top=top_conf bottom=bottom phead=phead status=status \
  hc_x=hydcond hc_y=hydcond q=well s=s recharge=recharge output=gwresult_conf \
  dt=8640000 type=confined vx=gwresult_conf_velocity_x vy=gwresult_conf_velocity_y budget=budget_conf
#unconfined groundwater flow with cg solver and sparse matrix, river and drain are enabled
# We use the effective porosity as storativity parameter
r.gwflow solver=cg top=top_unconf bottom=bottom phead=phead \
  status=status hc_x=hydcond hc_y=hydcond q=well s=poros recharge=recharge \
  river_bed=river_bed river_head=river_head river_leak=river_leak \
  drain_bed=drain_bed drain_leak=drain_leak \
  output=gwresult_unconf dt=8640000 type=unconfined vx=gwresult_unconf_velocity_x \
  budget=budget_unconf vy=gwresult_unconf_velocity_y
# The data can be visulaized with paraview when exported with r.out.vtk
r.out.vtk -p in=gwresult_conf,status vector=gwresult_conf_velocity_x,gwresult_conf_velocity_y,null \
  out=/tmp/gwdata_conf2d.vtk
r.out.vtk -p elevation=gwresult_unconf in=gwresult_unconf,status vector=gwresult_unconf_velocity_x,gwresult_unconf_velocity_y,null \
  out=/tmp/gwdata_unconf2d.vtk
#now load the data into paraview
paraview --data=/tmp/gwdata_conf2d.vtk &amp;
paraview --data=/tmp/gwdata_unconf2d.vtk &amp;
</pre>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i></i> <i>r.solute.transport,</i> <i>r3.gwflow,</i> <i>r.out.vtk</i> <i></i>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
S&#x00F6;ren Gebbert
<div class="Pp"></div>
This work is based on the Diploma Thesis of S&#x00F6;ren Gebbert available here
  at Technical University Berlin in Germany.
<div class="Pp"></div>
<i>Last changed: $Date: 2013-06-16 05:00:25 +0200 (Sun, 16 Jun 2013) $</i>
<h1 class="Sh" title="Sh" id="SOURCE_CODE"><a class="selflink" href="#SOURCE_CODE">SOURCE
  CODE</a></h1>
Available at: r.gwflow source code (history)
<div class="Pp"></div>
Main index | Raster index | Topics index | Keywords index | Graphical index |
  Full index
<div class="Pp"></div>
&#x00A9; 2003-2016 GRASS Development Team, GRASS GIS 7.2.0 Reference
  Manual</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os">GRASS 7.2.0</td>
  </tr>
</table>
</body>
</html>
