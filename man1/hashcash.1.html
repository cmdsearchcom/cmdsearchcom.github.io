<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>HASHCASH(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">HASHCASH(1)</td>
    <td class="head-vol">hashcash</td>
    <td class="head-rtitle">HASHCASH(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
hashcash - hashcash anti-spam / denial of service counter-measure tool
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>Mint (create) stamps:</b>
<div class="Pp"></div>
<b>hashcash</b> <i>-m</i> [ [ <i>options</i> ] [ <i>resource</i> ... ] ... ]
<div>&#x00A0;</div>
<div class="Pp"></div>
<b>Check stamps:</b>
<div class="Pp"></div>
<b>hashcash</b> <i>-c</i> [ [ <i>options</i> ] <i>-r resource</i> ... ] [
  <i>stamp</i> ... ]
<div>&#x00A0;</div>
<div class="Pp"></div>
<b>Speed estimates:</b>
<div class="Pp"></div>
<b>hashcash</b> <i>-s</i> [ <i>options</i> ] [ <i>-b bits</i> ]
<div>&#x00A0;</div>
<div class="Pp"></div>
<b>Purge database:</b>
<div class="Pp"></div>
<b>hashcash</b> <i>-p now</i> [ <i>-j resource</i> ] [ <i>-k</i> ] [ <i>-t
  time</i> ] [ <i>-u</i> ]
<div>&#x00A0;</div>
<div class="Pp"></div>
<b>Count collision bits:</b>
<div class="Pp"></div>
<b>hashcash</b> <i>-w</i> [ <i>options</i> ] [ <i>stamp</i> ... ]
<div>&#x00A0;</div>
<div class="Pp"></div>
<b>Get resource name:</b>
<div class="Pp"></div>
<b>hashcash</b> <i>-n</i> [ <i>options</i> ] [ <i>stamp</i> ... ]
<div>&#x00A0;</div>
<div class="Pp"></div>
<b>Get time remaining until expiry</b>
<div class="Pp"></div>
<b>hashcash</b> <i>-l</i> [ <i>options</i> ] <i>-e period</i> [ <i>stamp</i> ...
  ]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
Hashcash is a denial-of-service counter measure tool. Its main current use is to
  help hashcash users avoid losing email due to content based and blacklist
  based anti-spam systems.
<div class="Pp"></div>
The hashcash tool allows you to create hashcash stamps to attach to emails you
  send, and to verify hashcash stamps attached to emails you receive. Email
  senders attach hashcash stamps with the X-Hashcash: header. Vendors and
  authors of anti-spam tools are encouraged to exempt mail sent with hashcash
  from their blacklists and content based filtering rules.
<div class="Pp"></div>
A hashcash stamp constitutes a proof-of-work which takes a parameterizable
  amount of work to compute for the sender. The recipient can verify received
  stamps efficiently.
<div class="Pp"></div>
The hashcash proof-of-work function is to compute partial hash collisions (the
  SHA1 hash function is used). By choosing the number of bits of collision, the
  work required to compute a collision can be made arbitrarily expensive -- from
  fractions of a second to minutes or hours. The verification is efficient
  requiring the same small cost whatever the collision size.
<div class="Pp"></div>
For more detailed discussion of other applications hashcash has been used for
  see http://www.hashcash.org/
<h1 class="Sh" title="Sh" id="USAGE_NOTES"><a class="selflink" href="#USAGE_NOTES">USAGE
  NOTES</a></h1>
In this man page a resource name is the name of the service or address the stamp
  is created for. In the case of email, the resource name is the recipient's
  email address in the form user@domain.com.
<div>&#x00A0;</div>
<div class="Pp"></div>
<b>Minting stamps</b>
<div class="Pp"></div>
The <i>-m</i> flag must be given to mint a stamp.
<div class="Pp"></div>
The resource name (recipient's email address) to mint the stamp against can be
  passed as an argument, or if omitted is read from stdin. If stdin is a tty the
  user is prompted, if stdin is a pipe the resource name is just silently read.
  The desired collision size can be specified with the -b option. If no
  collision size is specified, the default is 20 bits. See also the <i>-b
  default</i> option.
<div>&#x00A0;</div>
<div class="Pp"></div>
<b>Checking stamps</b>
<div class="Pp"></div>
The <i>-c</i> flag must be given to check a stamps expiry. The stamp to check
  can be given as an argument to &quot;hashcash&quot;. If no stamp is given the
  stamp is read from stdin. If stdin is a tty the user will be prompted, if
  stdin is a pipe the stamp is just silently read. A resource name (the
  recipient's email address) can be given with the <i>-r</i> option. If a
  resource name is given the resource name is compared to the resource name in
  the stamp, if they do not match, the stamp is rejected.
<div class="Pp"></div>
Note: if no resource name is given the stamp is anyway checked to see if it is
  otherwise valid, but it could be minted for a different resource, which would
  allow stamps to be reused across different resources, so hashcash will return
  unchecked exit code on exit.
<div class="Pp"></div>
Stamps are by default considered to be valid for 28 days. The validity period
  can be changed using the <i>-e</i> flag.
<div class="Pp"></div>
If the stamp has expired or has a date in the future the stamp is rejected and
  the program exits immediately.
<div class="Pp"></div>
If a required collision size is given with the <i>-b</i> flag, the stamps value
  is computed and compared, if the stamp has insufficent value it is rejected,
  and the program exits immediately. If the <i>-b</i> flag is not given, the
  stamp is checked to see if it is otherwise valid, but hashcash will return
  unchecked exit code on exit.
<div class="Pp"></div>
If the stamp is double spent the stamp is rejected. Double spending protection
  is discussed in more detail below in &quot;Double Spending Protection&quot;.
  If double spending protection is not enabled, the stamp could be double spent,
  so hashcash will return unchecked exit code (exit code 2) on exit.
<div class="Pp"></div>
The <i>-w</i> flag can be used to request that the number of bits of the
  collision are counted and displayed. The <i>-n</i> flag can be used to request
  that the resource name in the stamp is parsed out and displayed. The <i>-l</i>
  flag can be used to request the number of seconds until expiry of the stamp is
  output.
<div class="Pp"></div>
The program will only return exit codes valid or invalid if the <i>-c</i> flag
  is used, the <i>-b</i> flag is used, <i>-d</i>, <i>-r resource</i> are used.
  These are the minimum set of options necessary to fully check the validty of a
  stamp. If these criteria are not met, the program will return exit code
  unchecked (exit code 2) on exit. (See also the <i>-y</i> flag.)
<div>&#x00A0;</div>
<div class="Pp"></div>
<b>Double Spending Protection</b>
<div class="Pp"></div>
If the <i>-d</i> flag is used when checking stamps, a database of spent stamps
  is kept.
<div class="Pp"></div>
By default stamps expire after 28 days, without expiry the database would grow
  indefinately. You can specify an alternate expiry period with the <i>-e</i>
  flag. The recommended (and default) expiry period for email is 28 days. After
  the expiry period amount of time, the stamp is anyway considered expired and
  may be purged from the database to save space. (See &quot;Purging Periodically
  vs on Next Access&quot; for how to purge stamps.)
<div class="Pp"></div>
For efficiency reasons a stamp is verified before it is checked in the database;
  if it is otherwise invalid no database activity will occur.
<div class="Pp"></div>
Note: The decision about how long the stamp should be considered valid is up to
  the verifier. If it is too short it is possible for some applications that the
  stamp will expire before arriving at the recipient (eg with email.) The
  suggested value of 28 days should be safe for normal email delivery delays.
  The choice is a trade-off between database size and risk of expiry prior to
  arrival, and depends on the application.
<div class="Pp"></div>
Note: Different stamps in the same database can have different validity periods,
  so for example stamps for different resources with different validity periods
  can be stored in the same database, or the recipient may change the validity
  period for future stamps without affecting the validity of old stamps.
<div>&#x00A0;</div>
<div class="Pp"></div>
<b>Purging Periodically vs on Next Access</b>
<div class="Pp"></div>
To purge old stamps periodically while checking stamps use the <i>-p</i>
  <i>period</i> option to purge no sooner than the given time period since the
  last purge. Purging can be used with the <i>-k</i> option to purge unexpired
  stamps also, and with the <i>-j resource</i> flag to purge only stamps for the
  given resource.
<div class="Pp"></div>
There are circumstances where it may be inconvenient to purge stamps on the next
  access, for example if there is a large double spend database which takes some
  time to purge, and the response time of the hashcash checker is important. To
  avoid this problem, purging can be done separately using just the <i>-p
  now</i> option to request just the purge operation. On unix for example you
  could call &quot;hashcash -p now&quot; in a cron job once per day, or on
  demand when disk was running low.
<div>&#x00A0;</div>
<div class="Pp"></div>
<b>Speed Estimates</b>
<div class="Pp"></div>
The <i>-s</i> flag requests measurement of how many collisions can be tested per
  second. No stamp is minted, or verified.
<div class="Pp"></div>
If the <i>-b</i> flag is used with this option, instead an estimate of how many
  seconds it would take to mint a stamp of the given size in bits is computed.
  To find out how much time it will take to mint a default sized stamp use <i>-s
  -b default</i>.
<div>&#x00A0;</div>
<div class="Pp"></div>
<b>Notes</b>
<div class="Pp"></div>
All informational output is printed on stderr. Minted stamps, and results of
  stamp verification and timing are printed on stdout. The quiet flag <i>-q</i>
  suppresses all informational output. The <i>-v</i> flag requests more
  informational output. The requested output, which is the only information that
  is output in quiet mode (when <i>-q</i> is specified) is printed on standard
  output. If stdout is a pipe, or when quiet mode is in effect the output is
  printed without description (ie just bits, just seconds, just resource).
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-c</i></dt>
  <dd class="It-tag">Check the expiry information of stamps given as an argument
      or on stdin. (Use with <i>-b</i>, <i>-d</i> and <i>-r resource</i> to
      fully check stamps).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-m</i></dt>
  <dd class="It-tag">Mint stamps with the resources given as arguments or on
      stdin.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-b bits</i></dt>
  <dd class="It-tag">When minting a stamp, create a collision of at least this
      many bits. When verifying a stamp require that it have a collision of at
      minimum this many bits, otherwise reject it. If omitted the default is
      used.
    <div style="height: 1.00em;">&#x00A0;</div>
    When checking stamps, require that the stamps have this many bits.
    <div style="height: 1.00em;">&#x00A0;</div>
    The default number of bits can be specified with <i>-b default</i>. Bits
      relative to the default can also be specified with <i>-b +n</i> for n bits
      more than the default and <i>-b -n</i> for n bits less than the default.
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>-b default</i>, <i>-b +0</i> and <i>-b -0</i> are all equivalent.
    <div style="height: 1.00em;">&#x00A0;</div>
    When doing the speed test <i>-s</i>, can to measure speed of default token
      with <i>-s -b default</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-r resource</i></dt>
  <dd class="It-tag">When minting stamps, the resource name (recipient's email
      address) to mint the stamp against can be given either with <i>-r
      resource</i> or as an argument to &quot;hashcash&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    When checking stamps, the resource name (your own email address) is given
      with the <i>-r</i> option. If the resource name is given it is checked
      against the resource name in the stamp, and if they do not match the stamp
      is rejected. Note if the resource name is not given, stamps for other
      resources would be accepted, and therefore hashcash returns exit code
      unchecked (exit code 2) on exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-o</i></dt>
  <dd class="It-tag">When verifying stamps multiple resources can be given. By
      default the resources are just checked one by one until a matching valid
      resource is found. However when you use wildcards or regular expressions
      (see <i>-E</i>), it is useful to be able to specify that one resource
      overrides another. For example this: <i>-b15 -r adam@dev.null -o -b10
      *@dev.null</i> states that mail to address <i>adam@dev.null</i> requires
      15 bits, but mail to <i>*@dev.null</i> requires only 10 bits. If we
      omitted the <i>-o</i> override relationship between the two resources, a
      stamp of 10 bits would be accepted for address <i>adam@dev.null</i>
      because while it would be rejected as having insufficient bits under the
      first rule, it would be accepted under the 2nd rule. The <i>-o</i> option
      allows you avoid this problem.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-e time</i></dt>
  <dd class="It-tag">Expiry period for spent stamps. While checking stamps
      (using the <i>-c</i> flag), if the stamp was minted more than the
      specified amount of time ago, it is considered expired. If this option is
      not used, by default stamps expire after 28 days. The expiry period is
      given in seconds by default (an argument of 0 means forever). A single
      character suffix can be used to specify alternate units (m = minutes, h =
      hours, d = days, M = months, y = Y = years, and s = seconds).
    <div style="height: 1.00em;">&#x00A0;</div>
    If used with the <i>-d</i> option, the spent stamp and its expiry period is
      recorded in the database. See the <i>-p</i> option for description of how
      to purge stamps from the database.
    <div style="height: 1.00em;">&#x00A0;</div>
    While minting stamps, the <i>-e</i> flag can have an effect on the
      resolution of time created in the stamp. Without the <i>-e</i> option, the
      default resolution is days (time format: YYMMDD). Alternate formats based
      on range of expiry period are as follows:
    <div style="height: 1.00em;">&#x00A0;</div>
    While minting you can also given an explicit time width with the <i>-z</i>
      option instead. ( <i>-z</i> overrides <i>-e</i> if both are given. If
      neither are given the default is 6 chars (time format: YYMMDD)).
    <div style="height: 1.00em;">&#x00A0;</div>
    The rules for automatically determining appropriate time width from
      <i>-e</i> if no <i>-z</i> option is given are:</dd>
</dl>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">* period &gt;= 2 years then time format YY is used rounded
    down to the nearest year start;</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">* 2 years &lt; period &lt;= 2 months then time format YYMM
    is used rounded down to the nearest month start;</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">* 2 months &lt; period &lt;= 2 days then time format YYMMDD
    is used rounded down to the begining of the nearest day;</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">* 2 days &lt; period &lt;= 2 minutes then time format
    YYMMDDhhmm is used rounded down to the begining of the nearest minute;</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">* period &lt; 2 minutes then time format YYMMDDhhmmss is
    used in seconds.</dt>
  <dd class="It-tag"></dd>
</dl>
</div>
<div style="margin-left: 4.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
Note the rounding down is based on UTC time, not local time. This can lead to
  initially suprising results when rounding down to eg days in time zones other
  than GMT (UTC = GMT). It may be clearer to understand if you use the <i>-u</i>
  option.</div>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-z width</i></dt>
  <dd class="It-tag">The <i>-z</i> option is for use during minting and allows
      user choice of width of time width field. See also the <i>-e</i> option
      given in combination with <i>-m</i> to specify an implicit time field
      width under the description of the <i>-e</i> flag. Valid widths are 6,10
      or 12 chars corresponding respectively to: YYMMDD, YYMMDDhhmm, and
      YYMMDDhhmmss rounded down to the nearest day, or minute respectively.
    <div style="height: 1.00em;">&#x00A0;</div>
    Note the rounding down is based on UTC time, not local time. This can lead
      to initially suprising results when rounding down to eg days in time zones
      other than GMT (UTC = GMT). It may be clearer to understand if you use the
      <i>-u</i> option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-g period</i></dt>
  <dd class="It-tag">The <i>-g</i> option is for use when checking hashcash
      stamps with the <i>-c</i> option and specifies a grace period for clock
      skew, ie if a hashcash stamp arrives with a date in the future or in the
      past it will not be rejected as having a futuristic date (or as being
      expired) unless it is more futuristic (or has been expired for longer)
      than this period. The default is 2 days, which means as long as the
      sending system's clock is no more than 2 days ahead (or 2 days behind) of
      the receiving system's clock, the hashcash stamp will still be accepted.
    <div style="height: 1.00em;">&#x00A0;</div>
    The default units for grace period are seconds. A single character suffix
      can be used to specify alternate units (m = minutes, h = hours, d = days,
      M = months, y = Y = years, and s = seconds).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-d</i></dt>
  <dd class="It-tag">Store stamps in a double spend database. If stamp has been
      seen before it will be rejected even if it is otherwise valid. The default
      database file is <i>database.sdb</i> in the current directory. Only
      otherwise valid stamps will be stored in the database. Only fully
      validated stamps will be stored in the database, unless the <i>-y</i>
      option is given.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-f dbname</i></dt>
  <dd class="It-tag">Use <i>dbname</i> instead of default filename for double
      spend database.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-p period</i></dt>
  <dd class="It-tag">Purges the database of expired stamps if the given time
      period has passed since the last time it was purged. As a convenience
      <i>-p now</i> is equivalent to <i>-p 0</i> both of which mean purge now,
      regardless of when the database was last purged.
    <div style="height: 1.00em;">&#x00A0;</div>
    If used in combination with <i>-j resource</i> only the stamps minted for
      the given resource are purged.
    <div style="height: 1.00em;">&#x00A0;</div>
    If used in combination with <i>-k</i> all stamps even un-expired stamps are
      purged. Can be used in combination with <i>-t time</i> to expire as if the
      current time were the given time.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-k</i></dt>
  <dd class="It-tag">Use with option <i>-p</i> to request all stamps are purged
      rather than just expired ones.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-j resource</i></dt>
  <dd class="It-tag">Use with option <i>-p</i> to request that just stamps
      matching the given resource name are to be purged, rather than the default
      which is to purge all expired stamps. If the resource name is the empty
      string, all stamps are matched (this is equivalent to omitting the
      <i>-j</i> option).
    <div style="height: 1.00em;">&#x00A0;</div>
    Note the <i>-E</i>, <i>-M</i> and <i>-S</i> type of match flags also apply
      to resources given with the <i>-j resource</i> flag.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-s</i></dt>
  <dd class="It-tag">Print timing information only, and don't proceed to create
      a stamp. If combined with <i>-b bits</i> flag print estimate of how long
      the requested collision size would take to compute, if <i>-s</i> given by
      itself, just prints speed of the collision finder. To print an estimate of
      how long the default number of bits would take use <i>-b</i>
      <i>default</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-h</i></dt>
  <dd class="It-tag">Print short usage information.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-v</i></dt>
  <dd class="It-tag">Print more verbose informational output about the stamp
      minting or verification. (If -v is the only argument, prints the tool
      version number.)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-V</i></dt>
  <dd class="It-tag">Prints tool version number.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-q</i></dt>
  <dd class="It-tag">Batch mode. Prints no information other than output. This
      option overrides the <i>-v</i> option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-X</i></dt>
  <dd class="It-tag">When minting, prints the hashcash email X-header
      'X-Hashcash: ' before the stamp. Without this option just the bare stamp
      is printed.
    <div style="height: 1.00em;">&#x00A0;</div>
    When checking, after scanning stamps given as arguments, scans stdin for
      lines starting with the string 'X-Hashcash:', and uses the rest of the
      matching line as the stamp. Only the lines up to and ending at the first
      blank line are scanned (see also <i>-i</i> flag which can be used to
      override this). A blank line is the separator used to separate the headers
      from the body of a mail message or USENET article. This is meant to make
      it convenient to pipe a mail message or USENET article to hashcash on
      stdin.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-x extension</i></dt>
  <dd class="It-tag">An extension string composed of name value sets. The
      extension format is described below in the section on the hashcash stamp
      format. This allows users to define their own stamp extensions which are
      hashed into the stamp, verified by recipients that support them, and
      ignored by recipients that don't support them. Note the extension hook
      mechanism has not yet been implemented. This will come in a subsequent
      release.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-i</i></dt>
  <dd class="It-tag">When checking and using the <i>-X</i> flag, ignore the
      blank line boundary between headers and body of the message, and check for
      collision in the body too if one is not found in the headers.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-t time</i></dt>
  <dd class="It-tag">Pretend the current time is the time given for purposes of
      minting stamps, verifying stamps and purging old stamps from the database.
      Time is given in a format based on UTCTIME format YYMMDD[hhmm[ss]].
    <div style="height: 1.00em;">&#x00A0;</div>
    Time is expressed in local time by default. Use with <i>-u</i> flag to give
      time in UTC (GMT).
    <div style="height: 1.00em;">&#x00A0;</div>
    You can also give time relative to the current time by prefixing the
      argument with + or -. The default units for relative time are seconds. A
      single character suffix can be used to specify alternate units (m =
      minutes, h = hours, d = days, M = months, y = Y = years, and s = seconds).
    <div style="height: 1.00em;">&#x00A0;</div>
    Note: when time is expressed in local time, if there is daylight savings in
      your timezone, there are one or two ambiguous hours per year at the time
      of change from daylight savings time to normal time.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-u</i></dt>
  <dd class="It-tag">Input and output absolute times in UTC (GMT) instead of
      local time.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-a period</i></dt>
  <dd class="It-tag">Add (or subtract if number is negative) a random value from
      the current time before minting the stamp. This hides the time the stamp
      was created, which may be useful for anonymous users. Note adding (rather
      than subtracting) a random time may be risky if the stamp takes less than
      the added time to arrive as the recipient will reject stamps with time
      stamps in the future.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-n</i></dt>
  <dd class="It-tag">Print resource name parsed from stamp being verified.
      Returns exit code unchecked on exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-l</i></dt>
  <dd class="It-tag">Print number of seconds left before stamp expires. Returns
      exit code unchecked on exit.
    <div style="height: 1.00em;">&#x00A0;</div>
    Note: the calculation includes the grace period, so can be up to 2 times
      grace period longer than you might otherwise expect (clock fast but system
      has to presume it could be slow). If you want to exclude the grace period
      add <i>-g0</i> to set grace period to 0 for the calculation.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-w</i></dt>
  <dd class="It-tag">Print number of bits of collision of stamp. Returns exit
      code unchecked on exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-y</i></dt>
  <dd class="It-tag">Returns success if the stamp is valid even if it is not
      fully checked. Use with <i>-c</i> where not all of <i>-d</i>, <i>-r</i>
      are specified to get success exit code on valid but partially checked
      stamp. Similarly can use with <i>-n</i>, <i>-l</i>, <i>-w</i> with same
      effect.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-M</i></dt>
  <dd class="It-tag">When checking stamps, allow wildcard <i>*</i> matching in
      the resource name to make it simpler to specify multiple email addresses
      and to allow matching catch-all addresses and addresses including
      subdomains. This is the default. See also <i>-S</i>, <i>-E</i> and
      <i>-C</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-S</i></dt>
  <dd class="It-tag">When checking stamps use simple text compare to compare
      resource names to those in stamps. See also <i>-M</i>, <i>-E</i> and
      <i>-C</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-E</i></dt>
  <dd class="It-tag">When checking stamps use regular expressions to specify
      resource names to make it simpler to specify multiple email addresses,
      catch-all addresses, classes of extension addresses and addresses
      including subdomains. Note regular expression syntax is POSIX style:
      special characters do not need to be quoted to have their special meaning;
      but they do have to be quoted with \ to that character in the searched
      string. The regular expression automatically has ^ added at the beginning
      and $ added at the end, if they are not specified. The special characters
      ^ matches the beginning of the resouce, and $ matches the end of resource.
    <div style="height: 1.00em;">&#x00A0;</div>
    (Note even if compiled with BSD regular expressions, POSIX style syntax is
      used; also note BSD regular expressions do not support ranges {}.)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-C</i></dt>
  <dd class="It-tag">By default resources are canonicalized to lower case on
      minting and on checking. The <i>-C</i> flag overrides this so that
      resources are treated as case sensitive on checking, and not canonizalized
      on minting.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-P</i></dt>
  <dd class="It-tag">Print progress info (number of iterations, expected
      iterations, percentage done, best stamp size found so far).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-O core</i></dt>
  <dd class="It-tag">Select hashcash core with that number. Currently 0-9 are
      valid cores. Not all cores work on all architectures. Eg some are x86
      specific assembler, others PPC specific assembler. If a core is not valid
      hashcash returns failure and explains what happened.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-Z n</i></dt>
  <dd class="It-tag">Compress the stamp. This is a time vs space trade off.
      Larger stamps are faster, but arguably slightly ugly. For fastest stamps
      (the default) use -Z 0; for partly compressed stamps use -Z 1; for very
      compressed, but somewhat slow stamps use -Z 2. (Note: due to a late
      discovered bug, -Z2 is the same as -Z1 for now until I can fix that.)</dd>
</dl>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<b>Creating stamps</b>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -s&quot;</dt>
  <dd class="It-tag">Print timing information about how many collisions the
      machine can try per second.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -sv&quot;</dt>
  <dd class="It-tag">More accurate but quite slow benchmarking of different
      processor specific minting cores.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -s -b default&quot;</dt>
  <dd class="It-tag">Print how long it would take the machine to compute a
      default sized collision (but don't actually compute a collision).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -s -b 32&quot;</dt>
  <dd class="It-tag">Print how long it would take the machine to compute a 32
      bit collision (but don't actually compute a collision).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -m&quot;</dt>
  <dd class="It-tag">Mint a stamp. Will prompt for resource name and mint with
      default value (number of collision bits).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -m foo&quot;</dt>
  <dd class="It-tag">Compute collision on resource foo. Will mint with default
      value (number of collision bits).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -m foo -b 10&quot;</dt>
  <dd class="It-tag">Compute 10 bit collision on resource foo.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -a -3d&quot;</dt>
  <dd class="It-tag">Subtract a random time of between 0 days and 3 days from
      the stamp's creation time. This is the same fuzz factor used by mixmaster
      to reduce risk of timing-correlations.
    <div>&#x00A0;</div>
  </dd>
</dl>
<div class="Pp"></div>
<b>Examining Stamps</b>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -w
    1:24:040806:foo::511801694b4cd6b0:1e7297a&quot;</dt>
  <dd class="It-tag">Report the value of the stamp (how many bits of collision)
      there are. The example is a 24 bit collision, which takes on average 25
      seconds to create on a 3Ghz P4.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -mq -b 10 foo &#x23AA; hashcash
    -w&quot;</dt>
  <dd class="It-tag">Create a stamp in batch mode, pass to hashcash on stdin to
      verify, have it print how many bits there were.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -n
    1:24:040806:foo::511801694b4cd6b0:1e7297a&quot;</dt>
  <dd class="It-tag">Report the resource name from the stamp. The resource name
      in the example is foo.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -l -e 30y
    1:24:040806:foo::511801694b4cd6b0:1e7297a&quot;</dt>
  <dd class="It-tag">Report how long until the stamp expires if it expires in 30
      years from its creation date. (Note dates too far into the future run into
      the 2038 end of Epoch, which is the unix time analog of the y2k bug).
    <div>&#x00A0;</div>
  </dd>
</dl>
<div class="Pp"></div>
<b>Verifying Stamps</b>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -c
    1:24:040806:foo::511801694b4cd6b0:1e7297a&quot;</dt>
  <dd class="It-tag">Check if the stamp is valid. Note as we are not checking
      the stamp in a double spend database, and did not specify a resource name
      or required number of bits of collision and hashcash will consider the
      stamp not fully checked, and it will report it as valid but not fully
      unchecked, or as invalid if there is any problem with the stamp.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -c -b24
    1:24:040806:foo::511801694b4cd6b0:1e7297a&quot;</dt>
  <dd class="It-tag">Check that the value of the stamp is greater or equal to 24
      bits. This example has 24 bit value. If you increase the requested number
      of bits or replace the stamp with one with less than 24 bit collision the
      stamp will be rejected.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -c -b24 -r foo
    1:24:040806:foo::511801694b4cd6b0:1e7297a&quot;</dt>
  <dd class="It-tag">As above check if the stamp has sufficient value, but in
      addition check that the resource name given matches the resource name in
      the stamp.
    <div>&#x00A0;</div>
  </dd>
</dl>
<div class="Pp"></div>
<b>Double Spending Prevention</b>
<div class="Pp"></div>
The examples given in &quot;Verifying Stamps&quot; can be modified to keep a
  double spend database so that the same stamp will not be accepted twice. Note
  a stamp will only be checked in and added to the database if it is otherwise
  valid and fully checked (a required number of bits of collision has been
  specified and a resource has been specified).
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -cd -b 10 -r foo
    1:24:040806:foo::511801694b4cd6b0:1e7297a&quot;</dt>
  <dd class="It-tag">Check the stamp and add to double spent database if it's
      valid (has correct resource name and sufficient value).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -cd -b 10 -r foo
    1:24:040806:foo::511801694b4cd6b0:1e7297a&quot;</dt>
  <dd class="It-tag">Try to double spend the stamp. It will be rejected as
      double spent.
    <div>&#x00A0;</div>
  </dd>
</dl>
<div class="Pp"></div>
<b>Stamp Expiry</b>
<div class="Pp"></div>
To prevent the double spend database growing indefinately, the recipient can
  request that stamps be no older than a specified period. After expiry old
  stamps can dropped from the double spend database as they will no longer be
  needed -- expired stamps can be rejected based purely on their old date, so
  the space taken by expired stamps in the double spend database can be saved
  without risk of accepting an expired though otherwise valid stamp.
<div class="Pp"></div>
The third field of the stamp is the UTC time since 1st January 1970. The default
  time format is YYMMDD, time rounded down to the nearest day. The default
  validity period is 28 days.
<div class="Pp"></div>
You can provide an alternative validity period with the <i>-e</i> option.
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -cd -b 10 -e 2d -r foo
    1:24:040806:foo::511801694b4cd6b0:1e7297a&quot;</dt>
  <dd class="It-tag">Try verifying an old stamp, the above stamp was created 11
      Aug 2002.
    <div style="height: 1.00em;">&#x00A0;</div>
    We gave option <i>-e 2d</i> so the stamps expiry date is 2 days after
      creation, which is now in the past.
    <div style="height: 1.00em;">&#x00A0;</div>
    Note: if the creation time is expressed in the stamp in days, the precise
      creation date is the begining of the specified day in UTC time (similarly
      for alternate units the creation time is rounded down to the begining of
      the unit it is expressed in). For units in days, for example, this may
      mean depending on your time zone that the stamp appears to be considered
      invalid in under the specified expiry period in days relative to your
      relative view of what day it is, as the calculation is based on current
      time in UTC, and the creation time of the stamp is expressed in UTC
    time.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -cd -b 10 -r foo
    1:24:040806:foo::511801694b4cd6b0:1e7297a&quot;</dt>
  <dd class="It-tag">Test whether the stamp is otherwise valid, apart from
      having expired. Omitting the <i>-e</i> tells hashcash that the stamp will
      never expire. An expiry period of forever can also be given explitly like
      this: <i>-e</i> <i>0</i>, where an expiry period of 0 means forever.
    <div>&#x00A0;</div>
  </dd>
</dl>
<div class="Pp"></div>
<b>Purging old stamps</b>
<div class="Pp"></div>
If the <i>-c</i>, <i>-d</i> options are used together, each time a stamp is
  checked, if it is valid and all of the mandatory aspects of the stamp are
  verified (collision bits check, resource name check) then the stamp and its
  expiry period is written to the database file. The default expiry period if an
  expiry period is not given explicitly with the <i>-e</i> option is 28 days (ie
  stamps expire after 4 weeks).
<div class="Pp"></div>
First mint and then add a stamp:
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -m -b 10 foo -e 1m &gt; stamp&quot;</dt>
  <dd class="It-tag">Note: we specified an expiry on minting in this example, to
      ensure that the stamp creation time is given in high enough resolution in
      the stamp that the stamp will not be considered expired at time of
      creation. (Recall the default resolution is in days, a stamp created with
      a creation time rounded down to the beginging of the day is unlikely to be
      considered valid 1 minute later unless you mint it at midnight UTC
    time.)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -cd -e 1m -b 10 -r foo &lt; stamp&quot;</dt>
  <dd class="It-tag">The stamp expires in 1 minute. Wait 1 minute and then
      explicitly request that expired stamps be purged:</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -p now&quot;</dt>
  <dd class="It-tag">Then try resubmitting the same stamp:</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -cd -e 1m -b 10 -r foo &lt; stamp&quot;</dt>
  <dd class="It-tag">and the stamp will be rejected anyway as it has expired,
      illustrating why it was not necessary to keep this stamp in the database.
    <div style="height: 1.00em;">&#x00A0;</div>
    With the default database (the sdb format) the database contents are human
      readable, so you can view their contents by cating them to the
    terminal:</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;cat hashcash.sdb&quot;</dt>
  <dd class="It-tag">to see that the stamp really is added and then after puring
      subsequently purged due to expiry.
    <div>&#x00A0;</div>
  </dd>
</dl>
<div class="Pp"></div>
<b>Purging old stamps on Demand</b>
<div class="Pp"></div>
As a convenience you can purge at the same time as checking stamps by using the
  <i>-p</i> option with the <i>-c</i> option.
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -m -b 10 foo &gt; stamp&quot;</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -cd -p now -e 1 -b 10 -r foo &lt;
    stamp&quot;</dt>
  <dd class="It-tag">It may be inefficient to purge stamps on every use as the
      entire database has to be scanned for expired stamps. By giving a time
      period to the <i>-p</i> option, you can tell &quot;hashcash&quot; to purge
      no more frequently than that time period since the previous purge.
    <div style="height: 1.00em;">&#x00A0;</div>
    For example:</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -cd -p 1d -e 1 -b 10 -r foo &lt;
    stamp&quot;</dt>
  <dd class="It-tag">tells &quot;hashcash&quot; to purge any expired stamps no
      more than once per day.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -p 1M -j foo&quot;</dt>
  <dd class="It-tag">tells &quot;hashcash&quot; to purge only expired stamps
      matching resource foo once per month.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&quot;hashcash -p now -k&quot;</dt>
  <dd class="It-tag">tells &quot;hashcash&quot; to purge all stamps (expired and
      unexpired) now.</dd>
</dl>
<h1 class="Sh" title="Sh" id="stamp_format_(version_1)"><a class="selflink" href="#stamp_format_(version_1)">stamp
  format (version 1)</a></h1>
The current stamp format is version 1. This tool can verify hashcash version 0
  stamps also, but version 0 stamps are no longer created as they are being
  phased out in favor of the more extensible v1 stamp format.
<dl class="Bl-tag">
  <dt class="It-tag"><i>ver</i>:<i>bits</i>:<i>date</i>:<i>resource</i>:[<i>ext</i>]:<i>rand</i>:<i>counter</i></dt>
  <dd class="It-tag"></dd>
</dl>
<div class="Pp"></div>
where
<dl class="Bl-tag">
  <dt class="It-tag"><i>ver</i> = 1</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>bits</i> = how many bits of partial-collision the stamp
    is claimed to have</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>date</i> = YYMMDD[hhmm[ss]]</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>resource</i> = resource string (eg IP address, email
    address)</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>ext</i> = extension -- ignored in the current
    version</dt>
  <dd class="It-tag">Format of extension:</dd>
</dl>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">[name1[=val1[,val2...]];[name2[=val1[,val2...]]...]]</dt>
  <dd class="It-tag">Note the value can also contain =. Example extension (not a
      real one):
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
        name1=2,3;name2;name3=var1=2,var2=3,2,val
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Which would be extension name1 has values 2 and 3; extension name2 has no
      values; extension name3 has 3 values &quot;var1=2&quot;,
      &quot;var2=3&quot;, &quot;2&quot; and &quot;val&quot;. The hashcash
      extension may interpret the values as it sees fit eg &quot;var1=2&quot;
      could be the value of an option to the extension name3.</dd>
</dl>
</div>
<div style="margin-left: 4.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><i>rand</i> = string of random characters from alphabet
    a-zA-Z0-9+/= to avoid collisions with other sender's stamps</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>counter</i> = to find a stamp with the desired number of
    collision bits need to try lots of different strings this counter is
    incremented on each try. The Counter is also composed of characters from the
    alphabet a-zA-Z0-9+/=. (Note an implementation is not required to count
    sequentially).</dt>
  <dd class="It-tag"></dd>
</dl>
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><i>hashcash.sdb</i></dt>
  <dd class="It-tag">default double spend database</dd>
</dl>
<h1 class="Sh" title="Sh" id="EXIT_STATUS"><a class="selflink" href="#EXIT_STATUS">EXIT
  STATUS</a></h1>
&quot;hashcash&quot; returns success (exit code 0) after successfully minting a
  stamp, after fully checking a stamp and finding it valid, and after a timing
  test.
<div class="Pp"></div>
If when checking a stamp it is found to be invalid (due to being malformed,
  being expired, having insufficient value, having a date in the future, or
  being double spent), &quot;hashcash&quot; returns failure (exit code 1).
<div class="Pp"></div>
If insufficient options are given to fully check a stamp, if the stamp is
  otherwise valid return unchecked (exit code 2). If the <i>-y</i> flag is given
  and hashcash would normally return unchecked, exit code success is returned
  instead.
<div class="Pp"></div>
If any exception occurs (file read failure for database checking or corrupted
  database contents) an exit status of 3 is returned.
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Written by Adam Back &lt;adam@cypherspace.org&gt;
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i>sha1sum</i>(1), <i>sha1</i>(1), http://www.hashcash.org/</div>
<table class="foot">
  <tr>
    <td class="foot-date">2005-12-22</td>
    <td class="foot-os">1.20</td>
  </tr>
</table>
</body>
</html>
