<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 15:55:39 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>BORG(1) Borg - Deduplicating Archiver BORG(1)</p>

<p style="margin-top: 1em">NAME <br>
borg - BorgBackup is a deduplicating backup program with
optional compression and authenticated encryption.</p>

<p style="margin-top: 1em">Borg consists of a number of
commands. Each command accepts a number of arguments and
options. The following sections will describe each command
in detail.</p>

<p style="margin-top: 1em">GENERAL <br>
Repository URLs <br>
Local filesystem (or locally mounted network
filesystem):</p>

<p style="margin-top: 1em">/path/to/repo - filesystem path
to repo directory, absolute path</p>

<p style="margin-top: 1em">path/to/repo - filesystem path
to repo directory, relative path</p>

<p style="margin-top: 1em">Also, stuff like ~/path/to/repo
or ~other/path/to/repo works (this is expanded by your
shell).</p>

<p style="margin-top: 1em">Note: you may also prepend a
file:// to a filesystem path to get URL style.</p>

<p style="margin-top: 1em">Remote repositories accessed via
ssh user@host:</p>

<p style="margin-top: 1em">user@host:/path/to/repo - remote
repo, absolute path</p>


<p style="margin-top: 1em">ssh://user@host:port/path/to/repo
- same, alternative syntax, port can be given</p>

<p style="margin-top: 1em">Remote repositories with
relative pathes can be given using this syntax:</p>

<p style="margin-top: 1em">user@host:path/to/repo - path
relative to current directory</p>

<p style="margin-top: 1em">user@host:~/path/to/repo - path
relative to user&rsquo;s home directory</p>

<p style="margin-top: 1em">user@host:~other/path/to/repo -
path relative to other&rsquo;s home directory</p>

<p style="margin-top: 1em">Note: giving
user@host:/./path/to/repo or user@host:/~/path/to/repo or
user@host:/~other/path/to/repo is also supported, but not
required here.</p>

<p style="margin-top: 1em">Remote repositories with
relative pathes, alternative syntax with port:</p>


<p style="margin-top: 1em">ssh://user@host:port/./path/to/repo
- path relative to current directory</p>


<p style="margin-top: 1em">ssh://user@host:port/~/path/to/repo
- path relative to user&rsquo;s home directory</p>


<p style="margin-top: 1em">ssh://user@host:port/~other/path/to/repo
- path relative to other&rsquo;s home directory</p>

<p style="margin-top: 1em">If you frequently need the same
repo URL, it is a good idea to set the BORG_REPO environment
variable to set a default for the repo URL:</p>

<p style="margin-top: 1em">export
BORG_REPO=&rsquo;ssh://user@host:port/path/to/repo&rsquo;</p>

<p style="margin-top: 1em">Then just leave away the repo
URL if only a repo URL is needed and you want to use the
default - it will be read from BORG_REPO then.</p>

<p style="margin-top: 1em">Use :: syntax to give the repo
URL when syntax requires giving a positional argument for
the repo (e.g. borg mount :: /mnt).</p>

<p style="margin-top: 1em">Repository / Archive Locations
<br>
Many commands want either a repository (just give the repo
URL, see above) or an archive location, which is a repo URL
followed by ::archive_name.</p>

<p style="margin-top: 1em">Archive names must not contain
the / (slash) character. For simplicity, maybe also avoid
blanks or other characters that have special meaning on the
shell or in a filesystem <br>
(borg mount will use the archive name as directory
name).</p>

<p style="margin-top: 1em">If you have set BORG_REPO (see
above) and an archive location is needed, use ::archive_name
- the repo URL part is then read from BORG_REPO.</p>

<p style="margin-top: 1em">Type of log output <br>
The log level of the builtin logging configuration defaults
to WARNING. This is because we want Borg to be mostly silent
and only output warnings, errors and critical messages.</p>

<p style="margin-top: 1em">Log levels: DEBUG &lt; INFO &lt;
WARNING &lt; ERROR &lt; CRITICAL</p>

<p style="margin-top: 1em">Use --debug to set DEBUG log
level - to get debug, info, warning, error and critical
level output.</p>

<p style="margin-top: 1em">Use --info (or -v or --verbose)
to set INFO log level - to get info, warning, error and
critical level output.</p>

<p style="margin-top: 1em">Use --warning (default) to set
WARNING log level - to get warning, error and critical level
output.</p>

<p style="margin-top: 1em">Use --error to set ERROR log
level - to get error and critical level output.</p>

<p style="margin-top: 1em">Use --critical to set CRITICAL
log level - to get critical level output.</p>

<p style="margin-top: 1em">While you can set misc. log
levels, do not expect that every command will give different
output on different log levels - it&rsquo;s just a
possibility.</p>

<p style="margin-top: 1em">WARNING: <br>
Options --critical and --error are provided for
completeness, their usage is not recommended as you might
miss important information.</p>

<p style="margin-top: 1em">WARNING: <br>
While some options (like --stats or --list) will emit more
informational messages, you have to use INFO (or lower) log
level to make them show up in log output. Use -v or a <br>
logging configuration.</p>

<p style="margin-top: 1em">Return codes <br>
Borg can exit with the following return codes (rc):</p>

<p style="margin-top: 1em">0 = success (logged as INFO)
<br>
1 = warning (operation reached its normal end, but there
were warnings - <br>
you should check the log, logged as WARNING) <br>
2 = error (like a fatal error, a local or remote exception,
the operation <br>
did not reach its normal end, logged as ERROR) <br>
128+N = killed by signal N (e.g. 137 == kill -9)</p>

<p style="margin-top: 1em">If you use --show-rc, the return
code is also logged at the indicated level as the last log
entry.</p>

<p style="margin-top: 1em">Environment Variables <br>
Borg uses some environment variables for automation:</p>

<p style="margin-top: 1em">General:</p>

<p style="margin-top: 1em">BORG_REPO <br>
When set, use the value to give the default repository
location. If a command needs an archive parameter, you can
abbreviate as ::archive. If a command needs a <br>
repository parameter, you can either leave it away or
abbreviate as ::, if a positional parameter is required.</p>

<p style="margin-top: 1em">BORG_PASSPHRASE <br>
When set, use the value to answer the passphrase question
for encrypted repositories.</p>

<p style="margin-top: 1em">BORG_DISPLAY_PASSPHRASE <br>
When set, use the value to answer the &quot;display the
passphrase for verification&quot; question when defining a
new passphrase for encrypted repositories.</p>

<p style="margin-top: 1em">BORG_LOGGING_CONF <br>
When set, use the given filename as INI-style logging
configuration.</p>

<p style="margin-top: 1em">BORG_RSH <br>
When set, use this command instead of ssh. This can be used
to specify ssh options, such as a custom identity file ssh
-i /path/to/private/key. See man ssh for <br>
other options.</p>

<p style="margin-top: 1em">BORG_REMOTE_PATH <br>
When set, use the given path/filename as remote path
(default is &quot;borg&quot;). Using --remote-path PATH
commandline option overrides the environment variable.</p>

<p style="margin-top: 1em">BORG_FILES_CACHE_TTL <br>
When set to a numeric value, this determines the maximum
&quot;time to live&quot; for the files cache entries
(default: 20). The files cache is used to quickly determine
<br>
whether a file is unchanged. The FAQ explains this more
detailed in: always_chunking</p>

<p style="margin-top: 1em">TMPDIR where temporary files are
stored (might need a lot of temporary space for some
operations)</p>

<p style="margin-top: 1em">Some automatic answerers (if
set, they automatically answer confirmation questions):</p>


<p style="margin-top: 1em">BORG_UNKNOWN_UNENCRYPTED_REPO_ACCESS_IS_OK=no
(or =yes) <br>
For &quot;Warning: Attempting to access a previously unknown
unencrypted repository&quot;</p>


<p style="margin-top: 1em">BORG_RELOCATED_REPO_ACCESS_IS_OK=no
(or =yes) <br>
For &quot;Warning: The repository at location ... was
previously located at ...&quot;</p>


<p style="margin-top: 1em">BORG_CHECK_I_KNOW_WHAT_I_AM_DOING=NO
(or =YES) <br>
For &quot;Warning: &rsquo;check --repair&rsquo; is an
experimental feature that might result in data
loss.&quot;</p>


<p style="margin-top: 1em">BORG_DELETE_I_KNOW_WHAT_I_AM_DOING=NO
(or =YES) <br>
For &quot;You requested to completely DELETE the repository
including all archives it contains:&quot;</p>

<p style="margin-top: 1em">Note: answers are case
sensitive. setting an invalid answer value might either give
the default answer or ask you interactively, depending on
whether retries are allowed <br>
(they by default are allowed). So please test your scripts
interactively before making them a non-interactive
script.</p>

<p style="margin-top: 1em">Directories:</p>

<p style="margin-top: 1em">BORG_KEYS_DIR <br>
Default to &rsquo;~/.config/borg/keys&rsquo;. This directory
contains keys for encrypted repositories.</p>

<p style="margin-top: 1em">BORG_SECURITY_DIR <br>
Default to &rsquo;~/.config/borg/security&rsquo;. This
directory is used by Borg to track various pieces of
security-related data.</p>

<p style="margin-top: 1em">BORG_CACHE_DIR <br>
Default to &rsquo;~/.cache/borg&rsquo;. This directory
contains the local cache and might need a lot of space for
dealing with big repositories).</p>

<p style="margin-top: 1em">Building:</p>

<p style="margin-top: 1em">BORG_OPENSSL_PREFIX <br>
Adds given OpenSSL header file directory to the default
locations (setup.py).</p>

<p style="margin-top: 1em">BORG_LZ4_PREFIX <br>
Adds given LZ4 header file directory to the default
locations (setup.py).</p>

<p style="margin-top: 1em">Please note:</p>

<p style="margin-top: 1em">&Acirc;&middot; be very careful
when using the &quot;yes&quot; sayers, the warnings with
prompt exist for your / your data&rsquo;s
security/safety</p>

<p style="margin-top: 1em">&Acirc;&middot; also be very
careful when putting your passphrase into a script, make
sure it has appropriate file permissions (e.g. mode 600,
root:root).</p>

<p style="margin-top: 1em">Resource Usage <br>
Borg might use a lot of resources depending on the size of
the data set it is dealing with.</p>

<p style="margin-top: 1em">If one uses Borg in a
client/server way (with a ssh: repository), the resource
usage occurs in part on the client and in another part on
the server.</p>

<p style="margin-top: 1em">If one uses Borg as a single
process (with a filesystem repo), all the resource usage
occurs in that one process, so just add up client + server
to get the approximate resource <br>
usage.</p>

<p style="margin-top: 1em">CPU client: <br>
borg create: does chunking, hashing, compression, crypto
(high CPU usage) chunks cache sync: quite heavy on CPU,
doing lots of hashtable operations. borg extract: crypto,
<br>
decompression (medium to high CPU usage) borg check: similar
to extract, but depends on options given. borg prune / borg
delete archive: low to medium CPU usage borg <br>
delete repo: done on the server It won&rsquo;t go beyond
100% of 1 core as the code is currently single-threaded.
Especially higher zlib and lzma compression levels use
signif&acirc; <br>
icant amounts of CPU cycles. Crypto might be cheap on the
CPU (if hardware accelerated) or expensive (if not).</p>

<p style="margin-top: 1em">CPU server: <br>
It usually doesn&rsquo;t need much CPU, it just deals with
the key/value store (repository) and uses the repository
index for that.</p>

<p style="margin-top: 1em">borg check: the repository check
computes the checksums of all chunks (medium CPU usage) borg
delete repo: low CPU usage</p>

<p style="margin-top: 1em">CPU (only for client/server
operation): <br>
When using borg in a client/server way with a ssh:-type
repo, the ssh processes used for the transport layer will
need some CPU on the client and on the server due to the
<br>
crypto they are doing - esp. if you are pumping big amounts
of data.</p>

<p style="margin-top: 1em">Memory (RAM) client: <br>
The chunks index and the files index are read into memory
for performance reasons. Might need big amounts of memory
(see below). Compression, esp. lzma compression with <br>
high levels might need substantial amounts of memory.</p>

<p style="margin-top: 1em">Memory (RAM) server: <br>
The server process will load the repository index into
memory. Might need considerable amounts of memory, but less
than on the client (see below).</p>

<p style="margin-top: 1em">Chunks index (client only): <br>
Proportional to the amount of data chunks in your repo. Lots
of chunks in your repo imply a big chunks index. It is
possible to tweak the chunker params (see create <br>
options).</p>

<p style="margin-top: 1em">Files index (client only): <br>
Proportional to the amount of files in your last backups.
Can be switched off (see create options), but next backup
might be much slower if you do. The speed benefit of <br>
using the files cache is proportional to file size.</p>

<p style="margin-top: 1em">Repository index (server only):
<br>
Proportional to the amount of data chunks in your repo. Lots
of chunks in your repo imply a big repository index. It is
possible to tweak the chunker params (see create <br>
options) to influence the amount of chunks being
created.</p>

<p style="margin-top: 1em">Temporary files (client): <br>
Reading data and metadata from a FUSE mounted repository
will consume up to the size of all deduplicated, small
chunks in the repository. Big chunks won&rsquo;t be locally
<br>
cached.</p>

<p style="margin-top: 1em">Temporary files (server): <br>
None.</p>

<p style="margin-top: 1em">Cache files (client only): <br>
Contains the chunks index and files index (plus a collection
of single- archive chunk indexes which might need huge
amounts of disk space, depending on archive count and <br>
size - see FAQ about how to reduce).</p>

<p style="margin-top: 1em">Network (only for client/server
operation): <br>
If your repository is remote, all deduplicated (and
optionally compressed/ encrypted) data of course has to go
over the connection (ssh: repo url). If you use a locally
<br>
mounted network filesystem, additionally some copy
operations used for transaction support also go over the
connection. If you backup multiple sources to one target
repos&acirc; <br>
itory, additional traffic happens for cache
resynchronization.</p>

<p style="margin-top: 1em">In case you are interested in
more details (like formulas), please see internals.</p>

<p style="margin-top: 1em">Units <br>
To display quantities, Borg takes care of respecting the
usual conventions of scale. Disk sizes are displayed in
decimal, using powers of ten (so kB means 1000 bytes). For
memory <br>
usage, binary prefixes are used, and are indicated using the
IEC binary prefixes, using powers of two (so KiB means 1024
bytes).</p>

<p style="margin-top: 1em">Date and Time <br>
We format date and time conforming to ISO-8601, that is:
YYYY-MM-DD and HH:MM:SS (24h clock).</p>

<p style="margin-top: 1em">For more information about that,
see: https://xkcd.com/1179/</p>

<p style="margin-top: 1em">Unless otherwise noted, we
display local date and time. Internally, we store and
process date and time as UTC.</p>

<p style="margin-top: 1em">BORG INIT <br>
usage: borg init [-h] [--critical] [--error] [--warning]
[--info] [--debug] <br>
[--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
<br>
[--remote-path PATH] [-e {none,keyfile,repokey}] [-a] <br>
[REPOSITORY]</p>

<p style="margin-top: 1em">Initialize an empty
repository</p>

<p style="margin-top: 1em">positional arguments: <br>
REPOSITORY repository to create</p>

<p style="margin-top: 1em">optional arguments: <br>
-h, --help show this help message and exit <br>
--critical work on log level CRITICAL <br>
--error work on log level ERROR <br>
--warning work on log level WARNING (default) <br>
--info, -v, --verbose <br>
work on log level INFO <br>
--debug work on log level DEBUG <br>
--lock-wait N wait for the lock, but max. N seconds
(default: 1). <br>
--show-rc show/log the return code (rc) <br>
--no-files-cache do not load/update the file metadata cache
used to <br>
detect unchanged files <br>
--umask M set umask to M (local and remote, default: 0077)
<br>
--remote-path PATH set remote path to executable (default:
&quot;borg&quot;) <br>
-e {none,keyfile,repokey}, --encryption
{none,keyfile,repokey} <br>
select encryption key mode (default: &quot;repokey&quot;)
<br>
-a, --append-only create an append-only mode repository</p>

<p style="margin-top: 1em">Description <br>
This command initializes an empty repository. A repository
is a filesystem directory containing the deduplicated data
from zero or more archives. Encryption can be enabled at
<br>
repository init time.</p>

<p style="margin-top: 1em">Examples <br>
# Local repository (default is to use encryption in repokey
mode) <br>
$ borg init /path/to/repo</p>

<p style="margin-top: 1em"># Local repository (no
encryption) <br>
$ borg init --encryption=none /path/to/repo</p>

<p style="margin-top: 1em"># Remote repository (accesses a
remote borg via ssh) <br>
$ borg init user@hostname:backup</p>

<p style="margin-top: 1em"># Remote repository (store the
key your home dir) <br>
$ borg init --encryption=keyfile user@hostname:backup</p>

<p style="margin-top: 1em">Important notes about
encryption:</p>

<p style="margin-top: 1em">It is not recommended to disable
encryption. Repository encryption protects you e.g. against
the case that an attacker has access to your backup
repository.</p>

<p style="margin-top: 1em">But be careful with the key /
the passphrase:</p>

<p style="margin-top: 1em">If you want
&quot;passphrase-only&quot; security, use the repokey mode.
The key will be stored inside the repository (in its
&quot;config&quot; file). In above mentioned attack
scenario, the <br>
attacker will have the key (but not the passphrase).</p>

<p style="margin-top: 1em">If you want &quot;passphrase and
having-the-key&quot; security, use the keyfile mode. The key
will be stored in your home directory (in
.config/borg/keys). In the attack scenario, the <br>
attacker who has just access to your repo won&rsquo;t have
the key (and also not the passphrase).</p>

<p style="margin-top: 1em">Make a backup copy of the key
file (keyfile mode) or repo config file (repokey mode) and
keep it at a safe place, so you still have the key in case
it gets corrupted or lost. <br>
Also keep the passphrase at a safe place. The backup that is
encrypted with that key won&rsquo;t help you with that, of
course.</p>

<p style="margin-top: 1em">Make sure you use a good
passphrase. Not too short, not too simple. The real
encryption / decryption key is encrypted with / locked by
your passphrase. If an attacker gets your <br>
key, he can&rsquo;t unlock and use it without knowing the
passphrase.</p>

<p style="margin-top: 1em">Be careful with special or
non-ascii characters in your passphrase:</p>

<p style="margin-top: 1em">&Acirc;&middot; Borg processes
the passphrase as unicode (and encodes it as utf-8), so it
does not have problems dealing with even the strangest
characters.</p>

<p style="margin-top: 1em">&Acirc;&middot; BUT: that does
not necessarily apply to your OS / VM / keyboard
configuration.</p>

<p style="margin-top: 1em">So better use a long passphrase
made from simple ascii chars than one that includes
non-ascii stuff or characters that are hard/impossible to
enter on a different keyboard lay&acirc; <br>
out.</p>

<p style="margin-top: 1em">You can change your passphrase
for existing repos at any time, it won&rsquo;t affect the
encryption/decryption key or other secrets.</p>

<p style="margin-top: 1em">BORG CREATE <br>
usage: borg create [-h] [--critical] [--error] [--warning]
[--info] [--debug] <br>
[--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
<br>
[--remote-path PATH] [-s] [-p] [--list] <br>
[--filter STATUSCHARS] [-e PATTERN] <br>
[--exclude-from EXCLUDEFILE] [--exclude-caches] <br>
[--exclude-if-present FILENAME] [--keep-tag-files] <br>
[-c SECONDS] [-x] [--numeric-owner] [--noatime] [--noctime]
<br>
[--timestamp yyyy-mm-ddThh:mm:ss] <br>
[--chunker-params
CHUNK_MIN_EXP,CHUNK_MAX_EXP,HASH_MASK_BITS,HASH_WINDOW_SIZE]
<br>
[--ignore-inode] [-C COMPRESSION] [--read-special] [-n] <br>
ARCHIVE PATH [PATH ...]</p>

<p style="margin-top: 1em">Create new archive</p>

<p style="margin-top: 1em">positional arguments: <br>
ARCHIVE name of archive to create (must be also a valid <br>
directory name) <br>
PATH paths to archive</p>

<p style="margin-top: 1em">optional arguments: <br>
-h, --help show this help message and exit <br>
--critical work on log level CRITICAL <br>
--error work on log level ERROR <br>
--warning work on log level WARNING (default) <br>
--info, -v, --verbose <br>
work on log level INFO <br>
--debug work on log level DEBUG <br>
--lock-wait N wait for the lock, but max. N seconds
(default: 1). <br>
--show-rc show/log the return code (rc) <br>
--no-files-cache do not load/update the file metadata cache
used to <br>
detect unchanged files <br>
--umask M set umask to M (local and remote, default: 0077)
<br>
--remote-path PATH set remote path to executable (default:
&quot;borg&quot;) <br>
-s, --stats print statistics for the created archive <br>
-p, --progress show progress display while creating the
archive, <br>
showing Original, Compressed and Deduplicated sizes, <br>
followed by the Number of files seen and the path <br>
being processed, default: False <br>
--list output verbose list of items (files, dirs, ...) <br>
--filter STATUSCHARS only display items with the given
status characters <br>
-e PATTERN, --exclude PATTERN <br>
exclude paths matching PATTERN <br>
--exclude-from EXCLUDEFILE <br>
read exclude patterns from EXCLUDEFILE, one per line <br>
--exclude-caches exclude directories that contain a
CACHEDIR.TAG file <br>
(http://www.brynosaurus.com/cachedir/spec.html) <br>
--exclude-if-present FILENAME <br>
exclude directories that contain the specified file <br>
--keep-tag-files keep tag files of excluded
caches/directories <br>
-c SECONDS, --checkpoint-interval SECONDS <br>
write checkpoint every SECONDS seconds (Default: 300) <br>
-x, --one-file-system <br>
stay in same file system <br>
--numeric-owner only store numeric user and group
identifiers <br>
--noatime do not store atime into archive <br>
--noctime do not store ctime into archive <br>
--timestamp yyyy-mm-ddThh:mm:ss <br>
manually specify the archive creation date/time (UTC). <br>
alternatively, give a reference file/directory. <br>
--chunker-params
CHUNK_MIN_EXP,CHUNK_MAX_EXP,HASH_MASK_BITS,HASH_WINDOW_SIZE
<br>
specify the chunker parameters. default: 19,23,21,4095 <br>
--ignore-inode ignore inode data in the file metadata cache
used to <br>
detect unchanged files. <br>
-C COMPRESSION, --compression COMPRESSION <br>
select compression algorithm (and level): none == no <br>
compression (default), lz4 == lz4, zlib == zlib <br>
(default level 6), zlib,0 .. zlib,9 == zlib (with <br>
level 0..9), lzma == lzma (default level 6), lzma,0 .. <br>
lzma,9 == lzma (with level 0..9). <br>
--read-special open and read block and char device files as
well as <br>
FIFOs as if they were regular files. Also follows <br>
symlinks pointing to these kinds of files. <br>
-n, --dry-run do not create a backup archive</p>

<p style="margin-top: 1em">Description <br>
This command creates a backup archive containing all files
found while recursively traversing all paths specified. When
giving &rsquo;-&rsquo; as path, borg will read data from
standard <br>
input and create a file &rsquo;stdin&rsquo; in the created
archive from that data.</p>

<p style="margin-top: 1em">The archive will consume almost
no disk space for files or parts of files that have already
been stored in other archives.</p>

<p style="margin-top: 1em">The archive name needs to be
unique. It must not end in &rsquo;.checkpoint&rsquo; or
&rsquo;.checkpoint.N&rsquo; (with N being a number), because
these names are used for checkpoints and treated in
spe&acirc; <br>
cial ways.</p>

<p style="margin-top: 1em">In the archive name, you may use
the following placeholders: {now}, {utcnow}, {fqdn},
{hostname}, {user} and some others.</p>

<p style="margin-top: 1em">To speed up pulling backups over
sshfs and similar network file systems which do not provide
correct inode information the --ignore-inode flag can be
used. This potentially <br>
decreases reliability of change detection, while avoiding
always reading all files on these file systems.</p>

<p style="margin-top: 1em">See the output of the &quot;borg
help patterns&quot; command for more help on exclude
patterns. See the output of the &quot;borg help
placeholders&quot; command for more help on
placeholders.</p>

<p style="margin-top: 1em">Examples <br>
# Backup ~/Documents into an archive named
&quot;my-documents&quot; <br>
$ borg create /path/to/repo::my-documents ~/Documents</p>

<p style="margin-top: 1em"># same, but verbosely list all
files as we process them <br>
$ borg create -v --list /path/to/repo::my-documents
~/Documents</p>

<p style="margin-top: 1em"># Backup ~/Documents and ~/src
but exclude pyc files <br>
$ borg create /path/to/repo::my-files ~/Documents ~/src
--exclude &rsquo;*.pyc&rsquo;</p>

<p style="margin-top: 1em"># Backup home directories
excluding image thumbnails (i.e. only <br>
# /home/*/.thumbnails is excluded, not
/home/*/*/.thumbnails) <br>
$ borg create /path/to/repo::my-files /home --exclude
&rsquo;re:^/home/[^/]+/.thumbnails/&rsquo;</p>

<p style="margin-top: 1em"># Do the same using a
shell-style pattern <br>
$ borg create /path/to/repo::my-files /home --exclude
&rsquo;sh:/home/*/.thumbnails&rsquo;</p>

<p style="margin-top: 1em"># Backup the root filesystem
into an archive named &quot;root-YYYY-MM-DD&quot; <br>
# use zlib compression (good, but slow) - default is no
compression <br>
$ borg create -C zlib,6 /path/to/repo::root-{now:%Y-%m-%d} /
--one-file-system</p>

<p style="margin-top: 1em"># Make a big effort in fine
granular deduplication (big chunk management <br>
# overhead, needs a lot of RAM and disk space, see formula
in internals <br>
# docs - same parameters as borg &lt; 1.0 or attic): <br>
$ borg create --chunker-params 10,23,16,4095
/path/to/repo::small /smallstuff</p>

<p style="margin-top: 1em"># Backup a raw device (must not
be active/in use/mounted at that time) <br>
$ dd if=/dev/sdx bs=10M | borg create /path/to/repo::my-sdx
-</p>

<p style="margin-top: 1em"># No compression (default) <br>
$ borg create /path/to/repo::arch ~</p>

<p style="margin-top: 1em"># Super fast, low compression
<br>
$ borg create --compression lz4 /path/to/repo::arch ~</p>

<p style="margin-top: 1em"># Less fast, higher compression
(N = 0..9) <br>
$ borg create --compression zlib,N /path/to/repo::arch ~</p>

<p style="margin-top: 1em"># Even slower, even higher
compression (N = 0..9) <br>
$ borg create --compression lzma,N /path/to/repo::arch ~</p>

<p style="margin-top: 1em"># Use short hostname, user name
and current time in archive name <br>
$ borg create /path/to/repo::{hostname}-{user}-{now} ~ <br>
# Similar, use the same datetime format as borg 1.1 will
have as default <br>
$ borg create
/path/to/repo::{hostname}-{user}-{now:%Y-%m-%dT%H:%M:%S} ~
<br>
# As above, but add nanoseconds <br>
$ borg create
/path/to/repo::{hostname}-{user}-{now:%Y-%m-%dT%H:%M:%S.%f}
~</p>

<p style="margin-top: 1em">Notes <br>
&Acirc;&middot; the --exclude patterns are not like tar. In
tar --exclude .bundler/gems will exclude foo/.bundler/gems.
In borg it will not, you need to use --exclude
&rsquo;*/.bundler/gems&rsquo; to get <br>
the same effect. See borg help patterns for more
information.</p>

<p style="margin-top: 1em">BORG EXTRACT <br>
usage: borg extract [-h] [--critical] [--error] [--warning]
[--info] [--debug] <br>
[--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
<br>
[--remote-path PATH] [--list] [-n] [-e PATTERN] <br>
[--exclude-from EXCLUDEFILE] [--numeric-owner] <br>
[--strip-components NUMBER] [--stdout] [--sparse] <br>
ARCHIVE [PATH [PATH ...]]</p>

<p style="margin-top: 1em">Extract archive contents</p>

<p style="margin-top: 1em">positional arguments: <br>
ARCHIVE archive to extract <br>
PATH paths to extract; patterns are supported</p>

<p style="margin-top: 1em">optional arguments: <br>
-h, --help show this help message and exit <br>
--critical work on log level CRITICAL <br>
--error work on log level ERROR <br>
--warning work on log level WARNING (default) <br>
--info, -v, --verbose <br>
work on log level INFO <br>
--debug work on log level DEBUG <br>
--lock-wait N wait for the lock, but max. N seconds
(default: 1). <br>
--show-rc show/log the return code (rc) <br>
--no-files-cache do not load/update the file metadata cache
used to <br>
detect unchanged files <br>
--umask M set umask to M (local and remote, default: 0077)
<br>
--remote-path PATH set remote path to executable (default:
&quot;borg&quot;) <br>
--list output verbose list of items (files, dirs, ...) <br>
-n, --dry-run do not actually change any files <br>
-e PATTERN, --exclude PATTERN <br>
exclude paths matching PATTERN <br>
--exclude-from EXCLUDEFILE <br>
read exclude patterns from EXCLUDEFILE, one per line <br>
--numeric-owner only obey numeric user and group identifiers
<br>
--strip-components NUMBER <br>
Remove the specified number of leading path elements. <br>
Pathnames with fewer elements will be silently <br>
skipped. <br>
--stdout write all extracted data to stdout <br>
--sparse create holes in output sparse file from all-zero
<br>
chunks</p>

<p style="margin-top: 1em">Description <br>
This command extracts the contents of an archive. By default
the entire archive is extracted but a subset of files and
directories can be selected by passing a list of PATHs as
<br>
arguments. The file selection can further be restricted by
using the --exclude option.</p>

<p style="margin-top: 1em">See the output of the &quot;borg
help patterns&quot; command for more help on exclude
patterns.</p>

<p style="margin-top: 1em">Examples <br>
# Extract entire archive <br>
$ borg extract /path/to/repo::my-files</p>

<p style="margin-top: 1em"># Extract entire archive and
list files while processing <br>
$ borg extract -v --list /path/to/repo::my-files</p>

<p style="margin-top: 1em"># Extract the &quot;src&quot;
directory <br>
$ borg extract /path/to/repo::my-files home/USERNAME/src</p>

<p style="margin-top: 1em"># Extract the &quot;src&quot;
directory but exclude object files <br>
$ borg extract /path/to/repo::my-files home/USERNAME/src
--exclude &rsquo;*.o&rsquo;</p>

<p style="margin-top: 1em"># Restore a raw device (must not
be active/in use/mounted at that time) <br>
$ borg extract --stdout /path/to/repo::my-sdx | dd
of=/dev/sdx bs=10M</p>

<p style="margin-top: 1em">Note: currently, extract always
writes into the current working directory (&quot;.&quot;),
<br>
so make sure you cd to the right place before calling borg
extract.</p>

<p style="margin-top: 1em">BORG CHECK <br>
usage: borg check [-h] [--critical] [--error] [--warning]
[--info] [--debug] <br>
[--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
<br>
[--remote-path PATH] [--repository-only] [--archives-only]
<br>
[--repair] [--save-space] [--last N] [-P PREFIX] <br>
[REPOSITORY_OR_ARCHIVE]</p>

<p style="margin-top: 1em">Check repository consistency</p>

<p style="margin-top: 1em">positional arguments: <br>
REPOSITORY_OR_ARCHIVE <br>
repository or archive to check consistency of</p>

<p style="margin-top: 1em">optional arguments: <br>
-h, --help show this help message and exit <br>
--critical work on log level CRITICAL <br>
--error work on log level ERROR <br>
--warning work on log level WARNING (default) <br>
--info, -v, --verbose <br>
work on log level INFO <br>
--debug work on log level DEBUG <br>
--lock-wait N wait for the lock, but max. N seconds
(default: 1). <br>
--show-rc show/log the return code (rc) <br>
--no-files-cache do not load/update the file metadata cache
used to <br>
detect unchanged files <br>
--umask M set umask to M (local and remote, default: 0077)
<br>
--remote-path PATH set remote path to executable (default:
&quot;borg&quot;) <br>
--repository-only only perform repository checks <br>
--archives-only only perform archives checks <br>
--repair attempt to repair any inconsistencies found <br>
--save-space work slower, but using less space <br>
--last N only check last N archives (Default: all) <br>
-P PREFIX, --prefix PREFIX <br>
only consider archive names starting with this prefix</p>

<p style="margin-top: 1em">Description <br>
The check command verifies the consistency of a repository
and the corresponding archives.</p>

<p style="margin-top: 1em">First, the underlying repository
data files are checked:</p>

<p style="margin-top: 1em">&Acirc;&middot; For all segments
the segment magic (header) is checked</p>

<p style="margin-top: 1em">&Acirc;&middot; For all objects
stored in the segments, all metadata (e.g. crc and size) and
all data is read. The read data is checked by size and CRC.
Bit rot and other types of accidental <br>
damage can be detected this way.</p>

<p style="margin-top: 1em">&Acirc;&middot; If we are in
repair mode and a integrity error is detected for a segment,
we try to recover as many objects from the segment as
possible.</p>

<p style="margin-top: 1em">&Acirc;&middot; In repair mode,
it makes sure that the index is consistent with the data
stored in the segments.</p>

<p style="margin-top: 1em">&Acirc;&middot; If you use a
remote repo server via ssh:, the repo check is executed on
the repo server without causing significant network
traffic.</p>

<p style="margin-top: 1em">&Acirc;&middot; The repository
check can be skipped using the --archives-only option.</p>

<p style="margin-top: 1em">Second, the consistency and
correctness of the archive metadata is verified:</p>

<p style="margin-top: 1em">&Acirc;&middot; Is the repo
manifest present? If not, it is rebuilt from archive
metadata chunks (this requires reading and decrypting of all
metadata and data).</p>

<p style="margin-top: 1em">&Acirc;&middot; Check if archive
metadata chunk is present. if not, remove archive from
manifest.</p>

<p style="margin-top: 1em">&Acirc;&middot; For all files
(items) in the archive, for all chunks referenced by these
files, check if chunk is present. If a chunk is not present
and we are in repair mode, replace it with <br>
a same-size replacement chunk of zeros. If a previously lost
chunk reappears (e.g. via a later backup) and we are in
repair mode, the all-zero replacement chunk will be <br>
replaced by the correct chunk. This requires reading of
archive and file metadata, but not data.</p>

<p style="margin-top: 1em">&Acirc;&middot; If we are in
repair mode and we checked all the archives: delete orphaned
chunks from the repo.</p>

<p style="margin-top: 1em">&Acirc;&middot; if you use a
remote repo server via ssh:, the archive check is executed
on the client machine (because if encryption is enabled, the
checks will require decryption and this is <br>
always done client-side, because key access will be
required).</p>

<p style="margin-top: 1em">&Acirc;&middot; The archive
checks can be time consuming, they can be skipped using the
--repository-only option.</p>

<p style="margin-top: 1em">BORG RENAME <br>
usage: borg rename [-h] [--critical] [--error] [--warning]
[--info] [--debug] <br>
[--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
<br>
[--remote-path PATH] <br>
ARCHIVE NEWNAME</p>

<p style="margin-top: 1em">Rename an existing archive</p>

<p style="margin-top: 1em">positional arguments: <br>
ARCHIVE archive to rename <br>
NEWNAME the new archive name to use</p>

<p style="margin-top: 1em">optional arguments: <br>
-h, --help show this help message and exit <br>
--critical work on log level CRITICAL <br>
--error work on log level ERROR <br>
--warning work on log level WARNING (default) <br>
--info, -v, --verbose <br>
work on log level INFO <br>
--debug work on log level DEBUG <br>
--lock-wait N wait for the lock, but max. N seconds
(default: 1). <br>
--show-rc show/log the return code (rc) <br>
--no-files-cache do not load/update the file metadata cache
used to <br>
detect unchanged files <br>
--umask M set umask to M (local and remote, default: 0077)
<br>
--remote-path PATH set remote path to executable (default:
&quot;borg&quot;)</p>

<p style="margin-top: 1em">Description <br>
This command renames an archive in the repository.</p>

<p style="margin-top: 1em">Examples <br>
$ borg create /path/to/repo::archivename ~ <br>
$ borg list /path/to/repo <br>
archivename Mon, 2016-02-15 19:50:19</p>

<p style="margin-top: 1em">$ borg rename
/path/to/repo::archivename newname <br>
$ borg list /path/to/repo <br>
newname Mon, 2016-02-15 19:50:19</p>

<p style="margin-top: 1em">BORG LIST <br>
usage: borg list [-h] [--critical] [--error] [--warning]
[--info] [--debug] <br>
[--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
<br>
[--remote-path PATH] [--short] [--list-format LISTFORMAT]
<br>
[-P PREFIX] <br>
[REPOSITORY_OR_ARCHIVE]</p>

<p style="margin-top: 1em">List archive or repository
contents</p>

<p style="margin-top: 1em">positional arguments: <br>
REPOSITORY_OR_ARCHIVE <br>
repository/archive to list contents of</p>

<p style="margin-top: 1em">optional arguments: <br>
-h, --help show this help message and exit <br>
--critical work on log level CRITICAL <br>
--error work on log level ERROR <br>
--warning work on log level WARNING (default) <br>
--info, -v, --verbose <br>
work on log level INFO <br>
--debug work on log level DEBUG <br>
--lock-wait N wait for the lock, but max. N seconds
(default: 1). <br>
--show-rc show/log the return code (rc) <br>
--no-files-cache do not load/update the file metadata cache
used to <br>
detect unchanged files <br>
--umask M set umask to M (local and remote, default: 0077)
<br>
--remote-path PATH set remote path to executable (default:
&quot;borg&quot;) <br>
--short only print file/directory names, nothing else <br>
--list-format LISTFORMAT <br>
specify format for archive file listing (default: <br>
&quot;{mode} {user:6} {group:6} {size:8d} {isomtime} <br>
{path}{extra}{NEWLINE}&quot;) Special
&quot;{formatkeys}&quot; exists <br>
to list available keys <br>
-P PREFIX, --prefix PREFIX <br>
only consider archive names starting with this prefix</p>

<p style="margin-top: 1em">Description <br>
This command lists the contents of a repository or an
archive.</p>

<p style="margin-top: 1em">Examples <br>
$ borg list /path/to/repo <br>
Monday Mon, 2016-02-15 19:15:11 <br>
repo Mon, 2016-02-15 19:26:54 <br>
root-2016-02-15 Mon, 2016-02-15 19:36:29 <br>
newname Mon, 2016-02-15 19:50:19 <br>
...</p>

<p style="margin-top: 1em">$ borg list
/path/to/repo::root-2016-02-15 <br>
drwxr-xr-x root root 0 Mon, 2016-02-15 17:44:27 . <br>
drwxrwxr-x root root 0 Mon, 2016-02-15 19:04:49 bin <br>
-rwxr-xr-x root root 1029624 Thu, 2014-11-13 00:08:51
bin/bash <br>
lrwxrwxrwx root root 0 Fri, 2015-03-27 20:24:26 bin/bzcmp
-&gt; bzdiff <br>
-rwxr-xr-x root root 2140 Fri, 2015-03-27 20:24:22
bin/bzdiff <br>
...</p>

<p style="margin-top: 1em">$ borg list
/path/to/repo::archiveA --list-format=&quot;{mode} {user:6}
{group:6} {size:8d} {isomtime} {path}{extra}{NEWLINE}&quot;
<br>
drwxrwxr-x user user 0 Sun, 2015-02-01 11:00:00 . <br>
drwxrwxr-x user user 0 Sun, 2015-02-01 11:00:00 code <br>
drwxrwxr-x user user 0 Sun, 2015-02-01 11:00:00
code/myproject <br>
-rw-rw-r-- user user 1416192 Sun, 2015-02-01 11:00:00
code/myproject/file.ext <br>
...</p>

<p style="margin-top: 1em"># see what is changed between
archives, based on file modification time, size and file
path <br>
$ borg list /path/to/repo::archiveA
--list-format=&quot;{mtime:%s}{TAB}{size}{TAB}{path}{LF}&quot;
|sort -n &gt; /tmp/list.archiveA <br>
$ borg list /path/to/repo::archiveB
--list-format=&quot;{mtime:%s}{TAB}{size}{TAB}{path}{LF}&quot;
|sort -n &gt; /tmp/list.archiveB <br>
$ diff -y /tmp/list.archiveA /tmp/list.archiveB <br>
1422781200 0 . 1422781200 0 . <br>
1422781200 0 code 1422781200 0 code <br>
1422781200 0 code/myproject 1422781200 0 code/myproject <br>
1422781200 1416192 code/myproject/file.ext | 1454664653
1416192 code/myproject/file.ext <br>
...</p>

<p style="margin-top: 1em">BORG DELETE <br>
usage: borg delete [-h] [--critical] [--error] [--warning]
[--info] [--debug] <br>
[--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
<br>
[--remote-path PATH] [-p] [-s] [-c] [--force] <br>
[--save-space] <br>
[TARGET]</p>

<p style="margin-top: 1em">Delete an existing repository or
archive</p>

<p style="margin-top: 1em">positional arguments: <br>
TARGET archive or repository to delete</p>

<p style="margin-top: 1em">optional arguments: <br>
-h, --help show this help message and exit <br>
--critical work on log level CRITICAL <br>
--error work on log level ERROR <br>
--warning work on log level WARNING (default) <br>
--info, -v, --verbose <br>
work on log level INFO <br>
--debug work on log level DEBUG <br>
--lock-wait N wait for the lock, but max. N seconds
(default: 1). <br>
--show-rc show/log the return code (rc) <br>
--no-files-cache do not load/update the file metadata cache
used to <br>
detect unchanged files <br>
--umask M set umask to M (local and remote, default: 0077)
<br>
--remote-path PATH set remote path to executable (default:
&quot;borg&quot;) <br>
-p, --progress show progress display while deleting a single
archive <br>
-s, --stats print statistics for the deleted archive <br>
-c, --cache-only delete only the local cache for the given
repository <br>
--force force deletion of corrupted archives <br>
--save-space work slower, but using less space</p>

<p style="margin-top: 1em">Description <br>
This command deletes an archive from the repository or the
complete repository. Disk space is reclaimed accordingly. If
you delete the complete repository, the local cache for <br>
it (if any) is also deleted.</p>

<p style="margin-top: 1em">Examples <br>
# delete a single backup archive: <br>
$ borg delete /path/to/repo::Monday</p>

<p style="margin-top: 1em"># delete the whole repository
and the related local cache: <br>
$ borg delete /path/to/repo <br>
You requested to completely DELETE the repository
*including* all archives it contains: <br>
repo Mon, 2016-02-15 19:26:54 <br>
root-2016-02-15 Mon, 2016-02-15 19:36:29 <br>
newname Mon, 2016-02-15 19:50:19 <br>
Type &rsquo;YES&rsquo; if you understand this and want to
continue: YES</p>

<p style="margin-top: 1em">BORG PRUNE <br>
usage: borg prune [-h] [--critical] [--error] [--warning]
[--info] [--debug] <br>
[--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
<br>
[--remote-path PATH] [-n] [--force] [-s] [--list] <br>
[--keep-within WITHIN] [-H HOURLY] [-d DAILY] [-w WEEKLY]
<br>
[-m MONTHLY] [-y YEARLY] [-P PREFIX] [--save-space] <br>
[REPOSITORY]</p>

<p style="margin-top: 1em">Prune repository archives
according to specified rules</p>

<p style="margin-top: 1em">positional arguments: <br>
REPOSITORY repository to prune</p>

<p style="margin-top: 1em">optional arguments: <br>
-h, --help show this help message and exit <br>
--critical work on log level CRITICAL <br>
--error work on log level ERROR <br>
--warning work on log level WARNING (default) <br>
--info, -v, --verbose <br>
work on log level INFO <br>
--debug work on log level DEBUG <br>
--lock-wait N wait for the lock, but max. N seconds
(default: 1). <br>
--show-rc show/log the return code (rc) <br>
--no-files-cache do not load/update the file metadata cache
used to <br>
detect unchanged files <br>
--umask M set umask to M (local and remote, default: 0077)
<br>
--remote-path PATH set remote path to executable (default:
&quot;borg&quot;) <br>
-n, --dry-run do not change repository <br>
--force force pruning of corrupted archives <br>
-s, --stats print statistics for the deleted archive <br>
--list output verbose list of archives it keeps/prunes <br>
--keep-within WITHIN keep all archives within this time
interval <br>
-H HOURLY, --keep-hourly HOURLY <br>
number of hourly archives to keep <br>
-d DAILY, --keep-daily DAILY <br>
number of daily archives to keep <br>
-w WEEKLY, --keep-weekly WEEKLY <br>
number of weekly archives to keep <br>
-m MONTHLY, --keep-monthly MONTHLY <br>
number of monthly archives to keep <br>
-y YEARLY, --keep-yearly YEARLY <br>
number of yearly archives to keep <br>
-P PREFIX, --prefix PREFIX <br>
only consider archive names starting with this prefix <br>
--save-space work slower, but using less space</p>

<p style="margin-top: 1em">Description <br>
The prune command prunes a repository by deleting all
archives not matching any of the specified retention
options. This command is normally used by automated backup
scripts <br>
wanting to keep a certain number of historic backups.</p>

<p style="margin-top: 1em">As an example, &quot;-d 7&quot;
means to keep the latest backup on each day, up to 7 most
recent days with backups (days without backups do not
count). The rules are applied from hourly <br>
to yearly, and backups selected by previous rules do not
count towards those of later rules. The time that each
backup starts is used for pruning purposes. Dates and times
are <br>
interpreted in the local timezone, and weeks go from Monday
to Sunday. Specifying a negative number of archives to keep
means that there is no limit.</p>

<p style="margin-top: 1em">The &quot;--keep-within&quot;
option takes an argument of the form
&quot;&lt;int&gt;&lt;char&gt;&quot;, where char is
&quot;H&quot;, &quot;d&quot;, &quot;w&quot;, &quot;m&quot;,
&quot;y&quot;. For example, &quot;--keep-within 2d&quot;
means to keep all archives that <br>
were created within the past 48 hours. &quot;1m&quot; is
taken to mean &quot;31d&quot;. The archives kept with this
option do not count towards the totals specified by any
other options.</p>

<p style="margin-top: 1em">If a prefix is set with -P, then
only archives that start with the prefix are considered for
deletion and only those archives count towards the totals
specified by the rules. <br>
Otherwise, all archives in the repository are candidates for
deletion! There is no automatic distinction between archives
representing different contents. These need to be dis&acirc;
<br>
tinguished by specifying matching prefixes.</p>

<p style="margin-top: 1em">Examples <br>
Be careful, prune is a potentially dangerous command, it
will remove backup archives.</p>

<p style="margin-top: 1em">The default of prune is to apply
to all archives in the repository unless you restrict its
operation to a subset of the archives using --prefix. When
using --prefix, be careful <br>
to choose a good prefix - e.g. do not use a prefix
&quot;foo&quot; if you do not also want to match
&quot;foobar&quot;.</p>

<p style="margin-top: 1em">It is strongly recommended to
always run prune -v --list --dry-run ... first so you will
see what it would do without it actually doing anything.</p>

<p style="margin-top: 1em">There is also a visualized prune
example in docs/misc/prune-example.txt.</p>

<p style="margin-top: 1em"># Keep 7 end of day and 4
additional end of week archives. <br>
# Do a dry-run without actually deleting anything. <br>
$ borg prune -v --list --dry-run --keep-daily=7
--keep-weekly=4 /path/to/repo</p>

<p style="margin-top: 1em"># Same as above but only apply
to archive names starting with the hostname <br>
# of the machine followed by a &quot;-&quot; character: <br>
$ borg prune -v --list --keep-daily=7 --keep-weekly=4
--prefix=&rsquo;{hostname}-&rsquo; /path/to/repo</p>

<p style="margin-top: 1em"># Keep 7 end of day, 4
additional end of week archives, <br>
# and an end of month archive for every month: <br>
$ borg prune -v --list --keep-daily=7 --keep-weekly=4
--keep-monthly=-1 /path/to/repo</p>

<p style="margin-top: 1em"># Keep all backups in the last
10 days, 4 additional end of week archives, <br>
# and an end of month archive for every month: <br>
$ borg prune -v --list --keep-within=10d --keep-weekly=4
--keep-monthly=-1 /path/to/repo</p>

<p style="margin-top: 1em">BORG INFO <br>
usage: borg info [-h] [--critical] [--error] [--warning]
[--info] [--debug] <br>
[--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
<br>
[--remote-path PATH] <br>
ARCHIVE</p>

<p style="margin-top: 1em">Show archive details such as
disk space used</p>

<p style="margin-top: 1em">positional arguments: <br>
ARCHIVE archive to display information about</p>

<p style="margin-top: 1em">optional arguments: <br>
-h, --help show this help message and exit <br>
--critical work on log level CRITICAL <br>
--error work on log level ERROR <br>
--warning work on log level WARNING (default) <br>
--info, -v, --verbose <br>
work on log level INFO <br>
--debug work on log level DEBUG <br>
--lock-wait N wait for the lock, but max. N seconds
(default: 1). <br>
--show-rc show/log the return code (rc) <br>
--no-files-cache do not load/update the file metadata cache
used to <br>
detect unchanged files <br>
--umask M set umask to M (local and remote, default: 0077)
<br>
--remote-path PATH set remote path to executable (default:
&quot;borg&quot;)</p>

<p style="margin-top: 1em">Description <br>
This command displays some detailed information about the
specified archive.</p>

<p style="margin-top: 1em">Please note that the
deduplicated sizes of the individual archives do not add up
to the deduplicated size of the repository (&quot;all
archives&quot;), because the two are meaning differ&acirc;
<br>
ent things:</p>

<p style="margin-top: 1em">This archive / deduplicated size
= amount of data stored ONLY for this archive <br>
= unique chunks of this archive.</p>

<p style="margin-top: 1em">All archives / deduplicated size
= amount of data stored in the repo <br>
= all chunks in the repository.</p>

<p style="margin-top: 1em">Examples <br>
$ borg info /path/to/repo::root-2016-02-15 <br>
Name: root-2016-02-15 <br>
Fingerprint:
57c827621f21b000a8d363c1e163cc55983822b3afff3a96df595077a660be50
<br>
Hostname: myhostname <br>
Username: root <br>
Time (start): Mon, 2016-02-15 19:36:29 <br>
Time (end): Mon, 2016-02-15 19:39:26 <br>
Command line: /usr/local/bin/borg create -v --list -C zlib,6
/path/to/repo::root-2016-02-15 / --one-file-system <br>
Number of files: 38100</p>

<p style="margin-top: 1em">Original size Compressed size
Deduplicated size <br>
This archive: 1.33 GB 613.25 MB 571.64 MB <br>
All archives: 1.63 GB 853.66 MB 584.12 MB</p>

<p style="margin-top: 1em">Unique chunks Total chunks <br>
Chunk index: 36858 48844</p>

<p style="margin-top: 1em">BORG MOUNT <br>
usage: borg mount [-h] [--critical] [--error] [--warning]
[--info] [--debug] <br>
[--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
<br>
[--remote-path PATH] [-f] [-o OPTIONS] <br>
REPOSITORY_OR_ARCHIVE MOUNTPOINT</p>

<p style="margin-top: 1em">Mount archive or an entire
repository as a FUSE filesystem</p>

<p style="margin-top: 1em">positional arguments: <br>
REPOSITORY_OR_ARCHIVE <br>
repository/archive to mount <br>
MOUNTPOINT where to mount filesystem</p>

<p style="margin-top: 1em">optional arguments: <br>
-h, --help show this help message and exit <br>
--critical work on log level CRITICAL <br>
--error work on log level ERROR <br>
--warning work on log level WARNING (default) <br>
--info, -v, --verbose <br>
work on log level INFO <br>
--debug work on log level DEBUG <br>
--lock-wait N wait for the lock, but max. N seconds
(default: 1). <br>
--show-rc show/log the return code (rc) <br>
--no-files-cache do not load/update the file metadata cache
used to <br>
detect unchanged files <br>
--umask M set umask to M (local and remote, default: 0077)
<br>
--remote-path PATH set remote path to executable (default:
&quot;borg&quot;) <br>
-f, --foreground stay in foreground, do not daemonize <br>
-o OPTIONS Extra mount options</p>

<p style="margin-top: 1em">Description <br>
This command mounts an archive as a FUSE filesystem. This
can be useful for browsing an archive or restoring
individual files. Unless the --foreground option is given
the command <br>
will run in the background until the filesystem is
umounted.</p>

<p style="margin-top: 1em">The
BORG_MOUNT_DATA_CACHE_ENTRIES environment variable is meant
for advanced users to tweak the performance. It sets the
number of cached data chunks; additional memory usage can
<br>
be up to ~8 MiB times this number. The default is the number
of CPU cores.</p>

<p style="margin-top: 1em">For mount options, see the
fuse(8) manual page. Additional mount options supported by
borg:</p>

<p style="margin-top: 1em">&Acirc;&middot;
allow_damaged_files: by default damaged files (where missing
chunks were replaced with runs of zeros by borg check
--repair) are not readable and return EIO (I/O error). Set
<br>
this option to read such files.</p>

<p style="margin-top: 1em">When the daemonized process
receives a signal or crashes, it does not unmount.
Unmounting in these cases could cause an active rsync or
similar process to unintentionally delete <br>
data.</p>

<p style="margin-top: 1em">When running in the foreground
^C/SIGINT unmounts cleanly, but other signals or crashes do
not.</p>

<p style="margin-top: 1em">BORG UMOUNT <br>
usage: borg umount [-h] [--critical] [--error] [--warning]
[--info] [--debug] <br>
[--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
<br>
[--remote-path PATH] <br>
MOUNTPOINT</p>

<p style="margin-top: 1em">un-mount the FUSE filesystem</p>

<p style="margin-top: 1em">positional arguments: <br>
MOUNTPOINT mountpoint of the filesystem to umount</p>

<p style="margin-top: 1em">optional arguments: <br>
-h, --help show this help message and exit <br>
--critical work on log level CRITICAL <br>
--error work on log level ERROR <br>
--warning work on log level WARNING (default) <br>
--info, -v, --verbose <br>
work on log level INFO <br>
--debug work on log level DEBUG <br>
--lock-wait N wait for the lock, but max. N seconds
(default: 1). <br>
--show-rc show/log the return code (rc) <br>
--no-files-cache do not load/update the file metadata cache
used to <br>
detect unchanged files <br>
--umask M set umask to M (local and remote, default: 0077)
<br>
--remote-path PATH set remote path to executable (default:
&quot;borg&quot;)</p>

<p style="margin-top: 1em">Description <br>
This command un-mounts a FUSE filesystem that was mounted
with borg mount.</p>

<p style="margin-top: 1em">This is a convenience wrapper
that just calls the platform-specific shell command -
usually this is either umount or fusermount -u.</p>

<p style="margin-top: 1em">Examples <br>
$ borg mount /path/to/repo::root-2016-02-15
/tmp/mymountpoint <br>
$ ls /tmp/mymountpoint <br>
bin boot etc home lib lib64 lost+found media mnt opt root
sbin srv tmp usr var <br>
$ borg umount /tmp/mymountpoint</p>

<p style="margin-top: 1em">BORG KEY EXPORT <br>
usage: borg key export [-h] [--critical] [--error]
[--warning] [--info] <br>
[--debug] [--lock-wait N] [--show-rc] <br>
[--no-files-cache] [--umask M] [--remote-path PATH] <br>
[--paper] [--qr-html] <br>
[REPOSITORY] [PATH]</p>

<p style="margin-top: 1em">Export the repository key for
backup</p>

<p style="margin-top: 1em">positional arguments: <br>
REPOSITORY <br>
PATH where to store the backup</p>

<p style="margin-top: 1em">optional arguments: <br>
-h, --help show this help message and exit <br>
--critical work on log level CRITICAL <br>
--error work on log level ERROR <br>
--warning work on log level WARNING (default) <br>
--info, -v, --verbose <br>
work on log level INFO <br>
--debug work on log level DEBUG <br>
--lock-wait N wait for the lock, but max. N seconds
(default: 1). <br>
--show-rc show/log the return code (rc) <br>
--no-files-cache do not load/update the file metadata cache
used to <br>
detect unchanged files <br>
--umask M set umask to M (local and remote, default: 0077)
<br>
--remote-path PATH set remote path to executable (default:
&quot;borg&quot;) <br>
--paper Create an export suitable for printing and later
type- <br>
in <br>
--qr-html Create an html file suitable for printing and
later <br>
type-in or qr scan</p>

<p style="margin-top: 1em">Description <br>
If repository encryption is used, the repository is
inaccessible without the key. This command allows to backup
this essential key.</p>

<p style="margin-top: 1em">There are two backup formats.
The normal backup format is suitable for digital storage as
a file. The --paper backup format is optimized for printing
and typing in while import&acirc; <br>
ing, with per line checks to reduce problems with manual
input.</p>

<p style="margin-top: 1em">For repositories using keyfile
encryption the key is saved locally on the system that is
capable of doing backups. To guard against loss of this key,
the key needs to be backed <br>
up independently of the main data backup.</p>

<p style="margin-top: 1em">For repositories using the
repokey encryption the key is saved in the repository in the
config file. A backup is thus not strictly needed, but
guards against the repository <br>
becoming inaccessible if the file is damaged for some
reason.</p>

<p style="margin-top: 1em">BORG KEY IMPORT <br>
usage: borg key import [-h] [--critical] [--error]
[--warning] [--info] <br>
[--debug] [--lock-wait N] [--show-rc] <br>
[--no-files-cache] [--umask M] [--remote-path PATH] <br>
[--paper] <br>
[REPOSITORY] [PATH]</p>

<p style="margin-top: 1em">Import the repository key from
backup</p>

<p style="margin-top: 1em">positional arguments: <br>
REPOSITORY <br>
PATH path to the backup</p>

<p style="margin-top: 1em">optional arguments: <br>
-h, --help show this help message and exit <br>
--critical work on log level CRITICAL <br>
--error work on log level ERROR <br>
--warning work on log level WARNING (default) <br>
--info, -v, --verbose <br>
work on log level INFO <br>
--debug work on log level DEBUG <br>
--lock-wait N wait for the lock, but max. N seconds
(default: 1). <br>
--show-rc show/log the return code (rc) <br>
--no-files-cache do not load/update the file metadata cache
used to <br>
detect unchanged files <br>
--umask M set umask to M (local and remote, default: 0077)
<br>
--remote-path PATH set remote path to executable (default:
&quot;borg&quot;) <br>
--paper interactively import from a backup done with
--paper</p>

<p style="margin-top: 1em">Description <br>
This command allows to restore a key previously backed up
with the export command.</p>

<p style="margin-top: 1em">If the --paper option is given,
the import will be an interactive process in which each line
is checked for plausibility before proceeding to the next
line. For this format PATH <br>
must not be given.</p>

<p style="margin-top: 1em">BORG CHANGE-PASSPHRASE <br>
usage: borg change-passphrase [-h] [--critical] [--error]
[--warning] [--info] <br>
[--debug] [--lock-wait N] [--show-rc] <br>
[--no-files-cache] [--umask M] <br>
[--remote-path PATH] <br>
[REPOSITORY]</p>

<p style="margin-top: 1em">Change repository key file
passphrase</p>

<p style="margin-top: 1em">positional arguments: <br>
REPOSITORY</p>

<p style="margin-top: 1em">optional arguments: <br>
-h, --help show this help message and exit <br>
--critical work on log level CRITICAL <br>
--error work on log level ERROR <br>
--warning work on log level WARNING (default) <br>
--info, -v, --verbose <br>
work on log level INFO <br>
--debug work on log level DEBUG <br>
--lock-wait N wait for the lock, but max. N seconds
(default: 1). <br>
--show-rc show/log the return code (rc) <br>
--no-files-cache do not load/update the file metadata cache
used to <br>
detect unchanged files <br>
--umask M set umask to M (local and remote, default: 0077)
<br>
--remote-path PATH set remote path to executable (default:
&quot;borg&quot;)</p>

<p style="margin-top: 1em">Description <br>
The key files used for repository encryption are optionally
passphrase protected. This command can be used to change
this passphrase.</p>

<p style="margin-top: 1em">Examples <br>
# Create a key file protected repository <br>
$ borg init --encryption=keyfile -v /path/to/repo <br>
Initializing repository at &quot;/path/to/repo&quot; <br>
Enter new passphrase: <br>
Enter same passphrase again: <br>
Remember your passphrase. Your data will be inaccessible
without it. <br>
Key in &quot;/root/.config/borg/keys/mnt_backup&quot;
created. <br>
Keep this key safe. Your data will be inaccessible without
it. <br>
Synchronizing chunks cache... <br>
Archives: 0, w/ cached Idx: 0, w/ outdated Idx: 0, w/o
cached Idx: 0. <br>
Done.</p>

<p style="margin-top: 1em"># Change key file passphrase
<br>
$ borg change-passphrase -v /path/to/repo <br>
Enter passphrase for key /root/.config/borg/keys/mnt_backup:
<br>
Enter new passphrase: <br>
Enter same passphrase again: <br>
Remember your passphrase. Your data will be inaccessible
without it. <br>
Key updated</p>

<p style="margin-top: 1em">BORG SERVE <br>
usage: borg serve [-h] [--critical] [--error] [--warning]
[--info] [--debug] <br>
[--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
<br>
[--remote-path PATH] [--restrict-to-path PATH] <br>
[--append-only]</p>

<p style="margin-top: 1em">Start in server mode. This
command is usually not used manually.</p>

<p style="margin-top: 1em">optional arguments: <br>
-h, --help show this help message and exit <br>
--critical work on log level CRITICAL <br>
--error work on log level ERROR <br>
--warning work on log level WARNING (default) <br>
--info, -v, --verbose <br>
work on log level INFO <br>
--debug work on log level DEBUG <br>
--lock-wait N wait for the lock, but max. N seconds
(default: 1). <br>
--show-rc show/log the return code (rc) <br>
--no-files-cache do not load/update the file metadata cache
used to <br>
detect unchanged files <br>
--umask M set umask to M (local and remote, default: 0077)
<br>
--remote-path PATH set remote path to executable (default:
&quot;borg&quot;) <br>
--restrict-to-path PATH <br>
restrict repository access to PATH. Can be specified <br>
multiple times to allow the client access to several <br>
directories. Access to all sub-directories is granted <br>
implicitly; PATH doesn&rsquo;t need to directly point to a
<br>
repository. <br>
--append-only only allow appending to repository segment
files</p>

<p style="margin-top: 1em">Description <br>
This command starts a repository server process. This
command is usually not used manually.</p>

<p style="margin-top: 1em">Examples <br>
borg serve has special support for ssh forced commands (see
authorized_keys example below): it will detect that you use
such a forced command and extract the value of the <br>
--restrict-to-path option(s). It will then parse the
original command that came from the client, makes sure that
it is also borg serve and enforce path restriction(s) as
given <br>
by the forced command. That way, other options given by the
client (like --info or --umask) are preserved (and are not
fixed by the forced command).</p>

<p style="margin-top: 1em"># Allow an SSH keypair to only
run borg, and only have access to /path/to/repo. <br>
# Use key options to disable unneeded and potentially
dangerous SSH functionality. <br>
# This will help to secure an automated remote backup
system. <br>
$ cat ~/.ssh/authorized_keys <br>
command=&quot;borg serve --restrict-to-path
/path/to/repo&quot;,no-pty,no-agent-forwarding,no-port-forwarding,no-X11-forwarding,no-user-rc
ssh-rsa AAAAB3[...]</p>

<p style="margin-top: 1em">BORG UPGRADE <br>
usage: borg upgrade [-h] [--critical] [--error] [--warning]
[--info] [--debug] <br>
[--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
<br>
[--remote-path PATH] [-p] [-n] [-i] [--force] [--tam] <br>
[--disable-tam] <br>
[REPOSITORY]</p>

<p style="margin-top: 1em">upgrade a repository from a
previous version</p>

<p style="margin-top: 1em">positional arguments: <br>
REPOSITORY path to the repository to be upgraded</p>

<p style="margin-top: 1em">optional arguments: <br>
-h, --help show this help message and exit <br>
--critical work on log level CRITICAL <br>
--error work on log level ERROR <br>
--warning work on log level WARNING (default) <br>
--info, -v, --verbose <br>
work on log level INFO <br>
--debug work on log level DEBUG <br>
--lock-wait N wait for the lock, but max. N seconds
(default: 1). <br>
--show-rc show/log the return code (rc) <br>
--no-files-cache do not load/update the file metadata cache
used to <br>
detect unchanged files <br>
--umask M set umask to M (local and remote, default: 0077)
<br>
--remote-path PATH set remote path to executable (default:
&quot;borg&quot;) <br>
-p, --progress show progress display while upgrading the
repository <br>
-n, --dry-run do not change repository <br>
-i, --inplace rewrite repository in place, with no chance of
going <br>
back to older versions of the repository. <br>
--force Force upgrade <br>
--tam Enable manifest authentication (in key and cache) <br>
(Borg 1.0.9 and later) <br>
--disable-tam Disable manifest authentication (in key and
cache)</p>

<p style="margin-top: 1em">Description <br>
Upgrade an existing Borg repository.</p>

<p style="margin-top: 1em">Borg 1.x.y upgrades <br>
Use borg upgrade --tam REPO to require manifest
authentication introduced with Borg 1.0.9 to address
security issues. This means that modifying the repository
after doing this <br>
with a version prior to 1.0.9 will raise a validation error,
so only perform this upgrade after updating all clients
using the repository to 1.0.9 or newer.</p>

<p style="margin-top: 1em">This upgrade should be done on
each client for safety reasons.</p>

<p style="margin-top: 1em">If a repository is accidentally
modified with a pre-1.0.9 client after this upgrade, use
borg upgrade --tam --force REPO to remedy it.</p>

<p style="margin-top: 1em">If you routinely do this you
might not want to enable this upgrade (which will leave you
exposed to the security issue). You can reverse the upgrade
by issuing borg upgrade <br>
--disable-tam REPO.</p>

<p style="margin-top: 1em">See
https://borgbackup.readthedocs.io/en/stable/changes.html#pre-1-0-9-manifest-spoofing-vulnerability
for details.</p>

<p style="margin-top: 1em">Attic and Borg 0.xx to Borg 1.x
<br>
This currently supports converting an Attic repository to
Borg and also helps with converting Borg 0.xx to 1.0.</p>

<p style="margin-top: 1em">Currently, only LOCAL
repositories can be upgraded (issue #465).</p>

<p style="margin-top: 1em">It will change the magic strings
in the repository&rsquo;s segments to match the new Borg
magic strings. The keyfiles found in $ATTIC_KEYS_DIR or
~/.attic/keys/ will also be converted <br>
and copied to $BORG_KEYS_DIR or ~/.config/borg/keys.</p>

<p style="margin-top: 1em">The cache files are converted,
from $ATTIC_CACHE_DIR or ~/.cache/attic to $BORG_CACHE_DIR
or ~/.cache/borg, but the cache layout between Borg and
Attic changed, so it is possible <br>
the first backup after the conversion takes longer than
expected due to the cache resync.</p>

<p style="margin-top: 1em">Upgrade should be able to resume
if interrupted, although it will still iterate over all
segments. If you want to start from scratch, use borg delete
over the copied repository <br>
to make sure the cache files are also removed: <br>
borg delete borg</p>

<p style="margin-top: 1em">Unless --inplace is specified,
the upgrade process first creates a backup copy of the
repository, in REPOSITORY.upgrade-DATETIME, using hardlinks.
This takes longer than in place <br>
upgrades, but is much safer and gives progress information
(as opposed to cp -al). Once you are satisfied with the
conversion, you can safely destroy the backup copy.</p>

<p style="margin-top: 1em">WARNING: Running the upgrade in
place will make the current copy unusable with older
version, with no way of going back to previous versions.
This can PERMANENTLY DAMAGE YOUR <br>
REPOSITORY! Attic CAN NOT READ BORG REPOSITORIES, as the
magic strings have changed. You have been warned.</p>

<p style="margin-top: 1em">Examples <br>
# Upgrade the borg repository to the most recent version.
<br>
$ borg upgrade -v /path/to/repo <br>
making a hardlink copy in
/path/to/repo.upgrade-2016-02-15-20:51:55 <br>
opening attic repository with borg and converting <br>
no key file found for repository <br>
converting repo index /path/to/repo/index.0 <br>
converting 1 segments... <br>
converting borg 0.xx to borg current <br>
no key file found for repository</p>

<p style="margin-top: 1em">Upgrading a passphrase encrypted
attic repo <br>
attic offered a &quot;passphrase&quot; encryption mode, but
this was removed in borg 1.0 and replaced by the
&quot;repokey&quot; mode (which stores the
passphrase-protected encryption key into the <br>
repository config).</p>

<p style="margin-top: 1em">Thus, to upgrade a
&quot;passphrase&quot; attic repo to a &quot;repokey&quot;
borg repo, 2 steps are needed, in this order:</p>

<p style="margin-top: 1em">&Acirc;&middot; borg upgrade
repo</p>

<p style="margin-top: 1em">&Acirc;&middot; borg
migrate-to-repokey repo</p>

<p style="margin-top: 1em">BORG BREAK-LOCK <br>
usage: borg break-lock [-h] [--critical] [--error]
[--warning] [--info] <br>
[--debug] [--lock-wait N] [--show-rc] <br>
[--no-files-cache] [--umask M] [--remote-path PATH] <br>
[REPOSITORY]</p>

<p style="margin-top: 1em">Break the repository lock (e.g.
in case it was left by a dead borg.</p>

<p style="margin-top: 1em">positional arguments: <br>
REPOSITORY repository for which to break the locks</p>

<p style="margin-top: 1em">optional arguments: <br>
-h, --help show this help message and exit <br>
--critical work on log level CRITICAL <br>
--error work on log level ERROR <br>
--warning work on log level WARNING (default) <br>
--info, -v, --verbose <br>
work on log level INFO <br>
--debug work on log level DEBUG <br>
--lock-wait N wait for the lock, but max. N seconds
(default: 1). <br>
--show-rc show/log the return code (rc) <br>
--no-files-cache do not load/update the file metadata cache
used to <br>
detect unchanged files <br>
--umask M set umask to M (local and remote, default: 0077)
<br>
--remote-path PATH set remote path to executable (default:
&quot;borg&quot;)</p>

<p style="margin-top: 1em">Description <br>
This command breaks the repository and cache locks. Please
use carefully and only while no borg process (on any
machine) is trying to access the Cache or the
Repository.</p>

<p style="margin-top: 1em">MISCELLANEOUS HELP <br>
borg help patterns <br>
Exclusion patterns support four separate styles, fnmatch,
shell, regular expressions and path prefixes. By default,
fnmatch is used. If followed by a colon (&rsquo;:&rsquo;)
the first two <br>
characters of a pattern are used as a style selector.
Explicit style selection is necessary when a non-default
style is desired or when the desired pattern starts with two
<br>
alphanumeric characters followed by a colon (i.e.
aa:something/*).</p>

<p style="margin-top: 1em">Fnmatch, selector fm: <br>
This is the default style. These patterns use a variant of
shell pattern syntax, with &rsquo;*&rsquo; matching any
number of characters, &rsquo;?&rsquo; matching any single
character, &rsquo;[...]&rsquo; match&acirc; <br>
ing any single character specified, including ranges, and
&rsquo;[!...]&rsquo; matching any character not specified.
For the purpose of these patterns, the path separator
(&rsquo;&rsquo; for Windows <br>
and &rsquo;/&rsquo; on other systems) is not treated
specially. Wrap meta-characters in brackets for a literal
match (i.e. [?] to match the literal character ?). For a
path to match a <br>
pattern, it must completely match from start to end, or must
match from the start to just before a path separator. Except
for the root path, paths will never end in the path <br>
separator when matching is attempted. Thus, if a given
pattern ends in a path separator, a &rsquo;*&rsquo; is
appended before matching is attempted.</p>

<p style="margin-top: 1em">Shell-style patterns, selector
sh: <br>
Like fnmatch patterns these are similar to shell patterns.
The difference is that the pattern may include **/ for
matching zero or more directory levels, * for matching zero
<br>
or more arbitrary characters with the exception of any path
separator.</p>

<p style="margin-top: 1em">Regular expressions, selector
re: <br>
Regular expressions similar to those found in Perl are
supported. Unlike shell patterns regular expressions are not
required to match the complete path and any substring match
<br>
is sufficient. It is strongly recommended to anchor patterns
to the start (&rsquo;^&rsquo;), to the end (&rsquo;$&rsquo;)
or both. Path separators (&rsquo;&rsquo; for Windows and
&rsquo;/&rsquo; on other systems) in paths <br>
are always normalized to a forward slash (&rsquo;/&rsquo;)
before applying a pattern. The regular expression syntax is
described in the Python documentation for the re module.</p>

<p style="margin-top: 1em">Prefix path, selector pp: <br>
This pattern style is useful to match whole sub-directories.
The pattern pp:/data/bar matches /data/bar and everything
therein.</p>

<p style="margin-top: 1em">Exclusions can be passed via the
command line option --exclude. When used from within a shell
the patterns should be quoted to protect them from
expansion.</p>

<p style="margin-top: 1em">The --exclude-from option
permits loading exclusion patterns from a text file with one
pattern per line. Lines empty or starting with the number
sign (&rsquo;#&rsquo;) after removing white&acirc; <br>
space on both ends are ignored. The optional style selector
prefix is also supported for patterns loaded from a file.
Due to whitespace removal paths with whitespace at the <br>
beginning or end can only be excluded using regular
expressions.</p>

<p style="margin-top: 1em">Examples:</p>

<p style="margin-top: 1em"># Exclude
&rsquo;/home/user/file.o&rsquo; but not
&rsquo;/home/user/file.odt&rsquo;: <br>
$ borg create -e &rsquo;*.o&rsquo; backup /</p>

<p style="margin-top: 1em"># Exclude
&rsquo;/home/user/junk&rsquo; and
&rsquo;/home/user/subdir/junk&rsquo; but <br>
# not &rsquo;/home/user/importantjunk&rsquo; or
&rsquo;/etc/junk&rsquo;: <br>
$ borg create -e &rsquo;/home/*/junk&rsquo; backup /</p>

<p style="margin-top: 1em"># Exclude the contents of
&rsquo;/home/user/cache&rsquo; but not the directory itself:
<br>
$ borg create -e /home/user/cache/ backup /</p>

<p style="margin-top: 1em"># The file
&rsquo;/home/user/cache/important&rsquo; is *not* backed up:
<br>
$ borg create -e /home/user/cache/ backup /
/home/user/cache/important</p>

<p style="margin-top: 1em"># The contents of directories in
&rsquo;/home&rsquo; are not backed up when their name <br>
# ends in &rsquo;.tmp&rsquo; <br>
$ borg create --exclude &rsquo;re:^/home/[^/]+.tmp/&rsquo;
backup /</p>

<p style="margin-top: 1em"># Load exclusions from file <br>
$ cat &gt;exclude.txt &lt;&lt;EOF <br>
# Comment line <br>
/home/*/junk <br>
*.tmp <br>
fm:aa:something/* <br>
re:^/home/[^/].tmp/ <br>
sh:/home/*/.thumbnails <br>
EOF <br>
$ borg create --exclude-from exclude.txt backup /</p>

<p style="margin-top: 1em">borg help placeholders <br>
Repository (or Archive) URLs, --prefix and --remote-path
values support these placeholders:</p>

<p style="margin-top: 1em">{hostname} <br>
The (short) hostname of the machine.</p>

<p style="margin-top: 1em">{fqdn} <br>
The full name of the machine.</p>

<p style="margin-top: 1em">{now} <br>
The current local date and time.</p>

<p style="margin-top: 1em">{utcnow} <br>
The current UTC date and time.</p>

<p style="margin-top: 1em">{user} <br>
The user name (or UID, if no name is available) of the user
running borg.</p>

<p style="margin-top: 1em">{pid} <br>
The current process ID.</p>

<p style="margin-top: 1em">{borgversion} <br>
The version of borg, e.g.: 1.0.8rc1</p>

<p style="margin-top: 1em">{borgmajor} <br>
The version of borg, only the major version, e.g.: 1</p>

<p style="margin-top: 1em">{borgminor} <br>
The version of borg, only major and minor version, e.g.:
1.0</p>

<p style="margin-top: 1em">{borgpatch} <br>
The version of borg, only major, minor and patch version,
e.g.: 1.0.8</p>

<p style="margin-top: 1em">Examples:</p>

<p style="margin-top: 1em">borg create
/path/to/repo::{hostname}-{user}-{utcnow} ... <br>
borg create
/path/to/repo::{hostname}-{now:%Y-%m-%d_%H:%M:%S} ... <br>
borg prune --prefix &rsquo;{hostname}-&rsquo; ...</p>

<p style="margin-top: 1em">DEBUG COMMANDS <br>
There are some more commands (all starting with
&quot;debug-&quot;) which are all not intended for normal
use and potentially very dangerous if used incorrectly.</p>

<p style="margin-top: 1em">For example, borg debug-put-obj
and borg debug-delete-obj will only do what their name
suggests: put objects into repo / delete objects from
repo.</p>

<p style="margin-top: 1em">Please note:</p>

<p style="margin-top: 1em">&Acirc;&middot; they will not
update the chunks cache (chunks index) about the object</p>

<p style="margin-top: 1em">&Acirc;&middot; they will not
update the manifest (so no automatic chunks index resync is
triggered)</p>

<p style="margin-top: 1em">&Acirc;&middot; they will not
check whether the object is in use (e.g. before
delete-obj)</p>

<p style="margin-top: 1em">&Acirc;&middot; they will not
update any metadata which may point to the object</p>

<p style="margin-top: 1em">They exist to improve debugging
capabilities without direct system access, e.g. in case you
ever run into some severe malfunction. Use them only if you
know what you are doing <br>
or if a trusted Borg developer tells you what to do.</p>

<p style="margin-top: 1em">ADDITIONAL NOTES <br>
Here are misc. notes about topics that are maybe not covered
in enough detail in the usage section.</p>

<p style="margin-top: 1em">Item flags <br>
borg create -v --list outputs a verbose list of all files,
directories and other file system items it considered (no
matter whether they had content changes or not). For each
<br>
item, it prefixes a single-letter flag that indicates type
and/or status of the item.</p>

<p style="margin-top: 1em">If you are interested only in a
subset of that output, you can give e.g. --filter=AME and it
will only show regular files with A, M or E status (see
below).</p>

<p style="margin-top: 1em">A uppercase character represents
the status of a regular file relative to the
&quot;files&quot; cache (not relative to the repo -- this is
an issue if the files cache is not used). Meta&acirc; <br>
data is stored in any case and for &rsquo;A&rsquo; and
&rsquo;M&rsquo; also new data chunks are stored. For
&rsquo;U&rsquo; all data chunks refer to already existing
chunks.</p>

<p style="margin-top: 1em">&Acirc;&middot; &rsquo;A&rsquo;
= regular file, added (see also a_status_oddity in the
FAQ)</p>

<p style="margin-top: 1em">&Acirc;&middot; &rsquo;M&rsquo;
= regular file, modified</p>

<p style="margin-top: 1em">&Acirc;&middot; &rsquo;U&rsquo;
= regular file, unchanged</p>

<p style="margin-top: 1em">&Acirc;&middot; &rsquo;E&rsquo;
= regular file, an error happened while accessing/reading
this file</p>

<p style="margin-top: 1em">A lowercase character means a
file type other than a regular file, borg usually just
stores their metadata:</p>

<p style="margin-top: 1em">&Acirc;&middot; &rsquo;d&rsquo;
= directory</p>

<p style="margin-top: 1em">&Acirc;&middot; &rsquo;b&rsquo;
= block device</p>

<p style="margin-top: 1em">&Acirc;&middot; &rsquo;c&rsquo;
= char device</p>

<p style="margin-top: 1em">&Acirc;&middot; &rsquo;h&rsquo;
= regular file, hardlink (to already seen inodes)</p>

<p style="margin-top: 1em">&Acirc;&middot; &rsquo;s&rsquo;
= symlink</p>

<p style="margin-top: 1em">&Acirc;&middot; &rsquo;f&rsquo;
= fifo</p>

<p style="margin-top: 1em">Other flags used include:</p>

<p style="margin-top: 1em">&Acirc;&middot; &rsquo;i&rsquo;
= backup data was read from standard input (stdin)</p>

<p style="margin-top: 1em">&Acirc;&middot; &rsquo;-&rsquo;
= dry run, item was not backed up</p>

<p style="margin-top: 1em">&Acirc;&middot; &rsquo;?&rsquo;
= missing status code (if you see this, please file a bug
report!)</p>

<p style="margin-top: 1em">--chunker-params <br>
The chunker params influence how input files are cut into
pieces (chunks) which are then considered for deduplication.
They also have a big impact on resource usage (RAM and disk
<br>
space) as the amount of resources needed is (also)
determined by the total amount of chunks in the repository
(see Indexes / Caches memory usage for details).</p>

<p style="margin-top: 1em">--chunker-params=10,23,16,4095
results in a fine-grained deduplication and creates a big
amount of chunks and thus uses a lot of resources to manage
them. This is good for rela&acirc; <br>
tively small data volumes and if the machine has a good
amount of free RAM and disk space.</p>

<p style="margin-top: 1em">--chunker-params=19,23,21,4095
(default) results in a coarse-grained deduplication and
creates a much smaller amount of chunks and thus uses less
resources. This is good for rel&acirc; <br>
atively big data volumes and if the machine has a relatively
low amount of free RAM and disk space.</p>

<p style="margin-top: 1em">If you already have made some
archives in a repository and you then change chunker params,
this of course impacts deduplication as the chunks will be
cut differently.</p>

<p style="margin-top: 1em">In the worst case (all files are
big and were touched in between backups), this will store
all content into the repository again.</p>

<p style="margin-top: 1em">Usually, it is not that bad
though:</p>

<p style="margin-top: 1em">&Acirc;&middot; usually most
files are not touched, so it will just re-use the old chunks
it already has in the repo</p>

<p style="margin-top: 1em">&Acirc;&middot; files smaller
than the (both old and new) minimum chunksize result in only
one chunk anyway, so the resulting chunks are same and
deduplication will apply</p>

<p style="margin-top: 1em">If you switch chunker params to
save resources for an existing repo that already has some
backup archives, you will see an increasing effect over
time, when more and more files <br>
have been touched and stored again using the bigger
chunksize and all references to the smaller older chunks
have been removed (by deleting / pruning archives).</p>

<p style="margin-top: 1em">If you want to see an immediate
big effect on resource usage, you better start a new
repository when changing chunker params.</p>

<p style="margin-top: 1em">For more details, see
chunker_details.</p>

<p style="margin-top: 1em">--umask <br>
If you use --umask, make sure that all repository-modifying
borg commands (create, delete, prune) that access the
repository in question use the same --umask value.</p>

<p style="margin-top: 1em">If multiple machines access the
same repository, this should hold true for all of them.</p>

<p style="margin-top: 1em">--read-special <br>
The --read-special option is special - you do not want to
use it for normal full-filesystem backups, but rather after
carefully picking some targets for it.</p>

<p style="margin-top: 1em">The option --read-special
triggers special treatment for block and char device files
as well as FIFOs. Instead of storing them as such a device
(or FIFO), they will get opened, <br>
their content will be read and in the backup archive they
will show up like a regular file.</p>

<p style="margin-top: 1em">Symlinks will also get special
treatment if (and only if) they point to such a special
file: instead of storing them as a symlink, the target
special file will get processed as <br>
described above.</p>

<p style="margin-top: 1em">One intended use case of this is
backing up the contents of one or multiple block devices,
like e.g. LVM snapshots or inactive LVs or disk
partitions.</p>

<p style="margin-top: 1em">You need to be careful about
what you include when using --read-special, e.g. if you
include /dev/zero, your backup will never terminate.</p>

<p style="margin-top: 1em">Restoring such files&rsquo;
content is currently only supported one at a time via
--stdout option (and you have to redirect stdout to where
ever it shall go, maybe directly into an <br>
existing device file of your choice or indirectly via
dd).</p>

<p style="margin-top: 1em">To some extent, mounting a
backup archive with the backups of special files via borg
mount and then loop-mounting the image files from inside the
mount point will work. If you <br>
plan to access a lot of data in there, it likely will scale
and perform better if you do not work via the FUSE
mount.</p>

<p style="margin-top: 1em">Example <br>
Imagine you have made some snapshots of logical volumes
(LVs) you want to backup.</p>

<p style="margin-top: 1em">NOTE: <br>
For some scenarios, this is a good method to get
&quot;crash-like&quot; consistency (I call it crash-like
because it is the same as you would get if you just hit the
reset button or <br>
your machine would abrubtly and completely crash). This is
better than no consistency at all and a good method for some
use cases, but likely not good enough if you have <br>
databases running.</p>

<p style="margin-top: 1em">Then you create a backup archive
of all these snapshots. The backup process will see a
&quot;frozen&quot; state of the logical volumes, while the
processes working in the original volumes <br>
continue changing the data stored there.</p>

<p style="margin-top: 1em">You also add the output of
lvdisplay to your backup, so you can see the LV sizes in
case you ever need to recreate and restore them.</p>

<p style="margin-top: 1em">After the backup has completed,
you remove the snapshots again.</p>

<p style="margin-top: 1em">$ # create snapshots here <br>
$ lvdisplay &gt; lvdisplay.txt <br>
$ borg create --read-special /path/to/repo::arch
lvdisplay.txt /dev/vg0/*-snapshot <br>
$ # remove snapshots here</p>

<p style="margin-top: 1em">Now, let&rsquo;s see how to
restore some LVs from such a backup.</p>

<p style="margin-top: 1em">$ borg extract
/path/to/repo::arch lvdisplay.txt <br>
$ # create empty LVs with correct sizes here (look into
lvdisplay.txt). <br>
$ # we assume that you created an empty root and home LV and
overwrite it now: <br>
$ borg extract --stdout /path/to/repo::arch
dev/vg0/root-snapshot &gt; /dev/vg0/root <br>
$ borg extract --stdout /path/to/repo::arch
dev/vg0/home-snapshot &gt; /dev/vg0/home</p>

<p style="margin-top: 1em">Append-only mode <br>
A repository can be made &quot;append-only&quot;, which
means that Borg will never overwrite or delete committed
data. This is useful for scenarios where multiple machines
back up to a <br>
central backup server using borg serve, since a hacked
machine cannot delete backups permanently.</p>

<p style="margin-top: 1em">To activate append-only mode,
edit the repository config file and add a line append_only=1
to the [repository] section (or edit the line if it
exists).</p>

<p style="margin-top: 1em">In append-only mode Borg will
create a transaction log in the transactions file, where
each line is a transaction and a UTC timestamp.</p>

<p style="margin-top: 1em">In addition, borg serve can act
as if a repository is in append-only mode with its option
--append-only. This can be very useful for fine-tuning
access control in .ssh/autho&acirc; <br>
rized_keys</p>

<p style="margin-top: 1em">command=&quot;borg serve
--append-only ...&quot; ssh-rsa &lt;key used for
not-always-trustable backup clients&gt; <br>
command=&quot;borg serve ...&quot; ssh-rsa &lt;key used for
backup management&gt;</p>

<p style="margin-top: 1em">Example <br>
Suppose an attacker remotely deleted all backups, but your
repository was in append-only mode. A transaction log in
this situation might look like this:</p>

<p style="margin-top: 1em">transaction 1, UTC time
2016-03-31T15:53:27.383532 <br>
transaction 5, UTC time 2016-03-31T15:53:52.588922 <br>
transaction 11, UTC time 2016-03-31T15:54:23.887256 <br>
transaction 12, UTC time 2016-03-31T15:55:54.022540 <br>
transaction 13, UTC time 2016-03-31T15:55:55.472564</p>

<p style="margin-top: 1em">From your security logs you
conclude the attacker gained access at 15:54:00 and all the
backups where deleted or replaced by compromised backups.
From the log you know that <br>
transactions 11 and later are compromised. Note that the
transaction ID is the name of the last file in the
transaction. For example, transaction 11 spans files 6 to
11.</p>

<p style="margin-top: 1em">In a real attack you&rsquo;ll
likely want to keep the compromised repository intact to
analyze what the attacker tried to achieve. It&rsquo;s also
a good idea to make this copy just in case <br>
something goes wrong during the recovery. Since recovery is
done by deleting some files, a hard link copy (cp -al) is
sufficient.</p>

<p style="margin-top: 1em">The first step to reset the
repository to transaction 5, the last uncompromised
transaction, is to remove the hints.N and index.N files in
the repository (these two files are <br>
always expendable). In this example N is 13.</p>

<p style="margin-top: 1em">Then remove or move all segment
files from the segment directories in data/ starting with
file 6:</p>

<p style="margin-top: 1em">rm data/**/{6..13}</p>

<p style="margin-top: 1em">That&rsquo;s all to it.</p>

<p style="margin-top: 1em">Drawbacks <br>
As data is only appended, and nothing removed, commands like
prune or delete won&rsquo;t free disk space, they merely tag
data as deleted in a new transaction.</p>

<p style="margin-top: 1em">Be aware that as soon as you
write to the repo in non-append-only mode (e.g. prune,
delete or create archives from an admin machine), it will
remove the deleted objects perma&acirc; <br>
nently (including the ones that were already marked as
deleted, but not removed, in append-only mode).</p>

<p style="margin-top: 1em">Note that you can go
back-and-forth between normal and append-only operation by
editing the configuration file, it&rsquo;s not a &quot;one
way trip&quot;.</p>

<p style="margin-top: 1em">Further considerations <br>
Append-only mode is not respected by tools other than Borg.
rm still works on the repository. Make sure that backup
client machines only get to access the repository via borg
<br>
serve.</p>

<p style="margin-top: 1em">Ensure that no remote access is
possible if the repository is temporarily set to normal mode
for e.g. regular pruning.</p>

<p style="margin-top: 1em">Further protections can be
implemented, but are outside of Borgs scope. For example,
file system snapshots or wrapping borg serve to set special
permissions or ACLs on new data <br>
files.</p>

<p style="margin-top: 1em">AUTHOR <br>
The Borg Collective (see AUTHORS file)</p>

<p style="margin-top: 1em">COPYRIGHT <br>
2010-2017 Jonas Borgstr&Atilde;&para;m, 2015-2016 The Borg
Collective (see AUTHORS file)</p>

<p style="margin-top: 1em">1.0.10 2017-02-21 BORG(1)</p>
<hr>
</body>
</html>
