<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>BORG(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">BORG(1)</td>
    <td class="head-vol">Borg - Deduplicating Archiver</td>
    <td class="head-rtitle">BORG(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
borg - BorgBackup is a deduplicating backup program with optional compression
  and authenticated encryption.
<div style="height: 1.00em;">&#x00A0;</div>
Borg consists of a number of commands. Each command accepts a number of
  arguments and options. The following sections will describe each command in
  detail.
<h1 class="Sh" title="Sh" id="GENERAL"><a class="selflink" href="#GENERAL">GENERAL</a></h1>
<h2 class="Ss" title="Ss" id="Repository_URLs"><a class="selflink" href="#Repository_URLs">Repository
  URLs</a></h2>
<b>Local filesystem</b> (or locally mounted network filesystem):
<div style="height: 1.00em;">&#x00A0;</div>
<b>/path/to/repo</b> - filesystem path to repo directory, absolute path
<div style="height: 1.00em;">&#x00A0;</div>
<b>path/to/repo</b> - filesystem path to repo directory, relative path
<div style="height: 1.00em;">&#x00A0;</div>
Also, stuff like <b>~/path/to/repo</b> or <b>~other/path/to/repo</b> works (this
  is expanded by your shell).
<div style="height: 1.00em;">&#x00A0;</div>
Note: you may also prepend a <b>file://</b> to a filesystem path to get URL
  style.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Remote repositories</b> accessed via ssh <i>user@host</i>:
<div style="height: 1.00em;">&#x00A0;</div>
<b>user@host:/path/to/repo</b> - remote repo, absolute path
<div style="height: 1.00em;">&#x00A0;</div>
<b>ssh://user@host:port/path/to/repo</b> - same, alternative syntax, port can be
  given
<div style="height: 1.00em;">&#x00A0;</div>
<b>Remote repositories with relative pathes</b> can be given using this syntax:
<div style="height: 1.00em;">&#x00A0;</div>
<b>user@host:path/to/repo</b> - path relative to current directory
<div style="height: 1.00em;">&#x00A0;</div>
<b>user@host:~/path/to/repo</b> - path relative to user's home directory
<div style="height: 1.00em;">&#x00A0;</div>
<b>user@host:~other/path/to/repo</b> - path relative to other's home directory
<div style="height: 1.00em;">&#x00A0;</div>
Note: giving <b>user@host:/./path/to/repo</b> or
  <b>user@host:/~/path/to/repo</b> or <b>user@host:/~other/path/to/repo</b> is
  also supported, but not required here.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Remote repositories with relative pathes, alternative syntax with port</b>:
<div style="height: 1.00em;">&#x00A0;</div>
<b>ssh://user@host:port/./path/to/repo</b> - path relative to current directory
<div style="height: 1.00em;">&#x00A0;</div>
<b>ssh://user@host:port/~/path/to/repo</b> - path relative to user's home
  directory
<div style="height: 1.00em;">&#x00A0;</div>
<b>ssh://user@host:port/~other/path/to/repo</b> - path relative to other's home
  directory
<div style="height: 1.00em;">&#x00A0;</div>
If you frequently need the same repo URL, it is a good idea to set the
  <b>BORG_REPO</b> environment variable to set a default for the repo URL:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
export BORG_REPO='ssh://user@host:port/path/to/repo'
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Then just leave away the repo URL if only a repo URL is needed and you want to
  use the default - it will be read from BORG_REPO then.
<div style="height: 1.00em;">&#x00A0;</div>
Use <b>::</b> syntax to give the repo URL when syntax requires giving a
  positional argument for the repo (e.g. <b>borg mount :: /mnt</b>).
<h2 class="Ss" title="Ss" id="Repository_/_Archive_Locations"><a class="selflink" href="#Repository_/_Archive_Locations">Repository
  / Archive Locations</a></h2>
Many commands want either a repository (just give the repo URL, see above) or an
  archive location, which is a repo URL followed by <b>::archive_name</b>.
<div style="height: 1.00em;">&#x00A0;</div>
Archive names must not contain the <b>/</b> (slash) character. For simplicity,
  maybe also avoid blanks or other characters that have special meaning on the
  shell or in a filesystem (borg mount will use the archive name as directory
  name).
<div style="height: 1.00em;">&#x00A0;</div>
If you have set BORG_REPO (see above) and an archive location is needed, use
  <b>::archive_name</b> - the repo URL part is then read from BORG_REPO.
<h2 class="Ss" title="Ss" id="Type_of_log_output"><a class="selflink" href="#Type_of_log_output">Type
  of log output</a></h2>
The log level of the builtin logging configuration defaults to WARNING. This is
  because we want Borg to be mostly silent and only output warnings, errors and
  critical messages.
<div style="height: 1.00em;">&#x00A0;</div>
Log levels: DEBUG &lt; INFO &lt; WARNING &lt; ERROR &lt; CRITICAL
<div style="height: 1.00em;">&#x00A0;</div>
Use <b>--debug</b> to set DEBUG log level - to get debug, info, warning, error
  and critical level output.
<div style="height: 1.00em;">&#x00A0;</div>
Use <b>--info</b> (or <b>-v</b> or <b>--verbose</b>) to set INFO log level - to
  get info, warning, error and critical level output.
<div style="height: 1.00em;">&#x00A0;</div>
Use <b>--warning</b> (default) to set WARNING log level - to get warning, error
  and critical level output.
<div style="height: 1.00em;">&#x00A0;</div>
Use <b>--error</b> to set ERROR log level - to get error and critical level
  output.
<div style="height: 1.00em;">&#x00A0;</div>
Use <b>--critical</b> to set CRITICAL log level - to get critical level output.
<div style="height: 1.00em;">&#x00A0;</div>
While you can set misc. log levels, do not expect that every command will give
  different output on different log levels - it's just a possibility.
<div style="height: 1.00em;">&#x00A0;</div>
<b>WARNING:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">Options --critical and --error are provided
  for completeness, their usage is not recommended as you might miss important
  information.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<b>WARNING:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">While some options (like <b>--stats</b> or
  <b>--list</b>) will emit more informational messages, you have to use INFO (or
  lower) log level to make them show up in log output. Use <b>-v</b> or a
  logging configuration.</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Return_codes"><a class="selflink" href="#Return_codes">Return
  codes</a></h2>
Borg can exit with the following return codes (rc):
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
0 = success (logged as INFO)
1 = warning (operation reached its normal end, but there were warnings -
    you should check the log, logged as WARNING)
2 = error (like a fatal error, a local or remote exception, the operation
    did not reach its normal end, logged as ERROR)
128+N = killed by signal N (e.g. 137 == kill -9)
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
If you use <b>--show-rc</b>, the return code is also logged at the indicated
  level as the last log entry.
<h2 class="Ss" title="Ss" id="Environment_Variables"><a class="selflink" href="#Environment_Variables">Environment
  Variables</a></h2>
Borg uses some environment variables for automation:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>General:</b></dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>BORG_REPO</b></dt>
  <dd class="It-tag">When set, use the value to give the default repository
      location. If a command needs an archive parameter, you can abbreviate as
      <i>::archive</i>. If a command needs a repository parameter, you can
      either leave it away or abbreviate as <i>::</i>, if a positional parameter
      is required.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BORG_PASSPHRASE</b></dt>
  <dd class="It-tag">When set, use the value to answer the passphrase question
      for encrypted repositories.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BORG_DISPLAY_PASSPHRASE</b></dt>
  <dd class="It-tag">When set, use the value to answer the &quot;display the
      passphrase for verification&quot; question when defining a new passphrase
      for encrypted repositories.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BORG_LOGGING_CONF</b></dt>
  <dd class="It-tag">When set, use the given filename as <i>INI</i>-style
      logging configuration.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BORG_RSH</b></dt>
  <dd class="It-tag">When set, use this command instead of <b>ssh</b>. This can
      be used to specify ssh options, such as a custom identity file <b>ssh -i
      /path/to/private/key</b>. See <b>man ssh</b> for other options.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BORG_REMOTE_PATH</b></dt>
  <dd class="It-tag">When set, use the given path/filename as remote path
      (default is &quot;borg&quot;). Using <b>--remote-path PATH</b> commandline
      option overrides the environment variable.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BORG_FILES_CACHE_TTL</b></dt>
  <dd class="It-tag">When set to a numeric value, this determines the maximum
      &quot;time to live&quot; for the files cache entries (default: 20). The
      files cache is used to quickly determine whether a file is unchanged. The
      FAQ explains this more detailed in: always_chunking</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>TMPDIR</b></dt>
  <dd class="It-tag">where temporary files are stored (might need a lot of
      temporary space for some operations)</dd>
</dl>
</div>
<br/>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Some automatic answerers (if set, they automatically
    answer confirmation questions):</b></dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>BORG_UNKNOWN_UNENCRYPTED_REPO_ACCESS_IS_OK=no (or
    =yes)</b></dt>
  <dd class="It-tag">For &quot;Warning: Attempting to access a previously
      unknown unencrypted repository&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BORG_RELOCATED_REPO_ACCESS_IS_OK=no (or =yes)</b></dt>
  <dd class="It-tag">For &quot;Warning: The repository at location ... was
      previously located at ...&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BORG_CHECK_I_KNOW_WHAT_I_AM_DOING=NO (or =YES)</b></dt>
  <dd class="It-tag">For &quot;Warning: 'check --repair' is an experimental
      feature that might result in data loss.&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BORG_DELETE_I_KNOW_WHAT_I_AM_DOING=NO (or =YES)</b></dt>
  <dd class="It-tag">For &quot;You requested to completely DELETE the repository
      <i>including</i> all archives it contains:&quot;</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Note: answers are case sensitive. setting an invalid answer value might either
  give the default answer or ask you interactively, depending on whether retries
  are allowed (they by default are allowed). So please test your scripts
  interactively before making them a non-interactive script.
<dl class="Bl-tag">
  <dt class="It-tag"><b>Directories:</b></dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>BORG_KEYS_DIR</b></dt>
  <dd class="It-tag">Default to '~/.config/borg/keys'. This directory contains
      keys for encrypted repositories.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BORG_SECURITY_DIR</b></dt>
  <dd class="It-tag">Default to '~/.config/borg/security'. This directory is
      used by Borg to track various pieces of security-related data.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BORG_CACHE_DIR</b></dt>
  <dd class="It-tag">Default to '~/.cache/borg'. This directory contains the
      local cache and might need a lot of space for dealing with big
      repositories).</dd>
</dl>
</div>
<br/>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Building:</b></dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>BORG_OPENSSL_PREFIX</b></dt>
  <dd class="It-tag">Adds given OpenSSL header file directory to the default
      locations (setup.py).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BORG_LZ4_PREFIX</b></dt>
  <dd class="It-tag">Adds given LZ4 header file directory to the default
      locations (setup.py).</dd>
</dl>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Please note:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">be very careful when using the &quot;yes&quot; sayers, the
      warnings with prompt exist for your / your data's security/safety</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">also be very careful when putting your passphrase into a
      script, make sure it has appropriate file permissions (e.g. mode 600,
      root:root).</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Resource_Usage"><a class="selflink" href="#Resource_Usage">Resource
  Usage</a></h2>
Borg might use a lot of resources depending on the size of the data set it is
  dealing with.
<div style="height: 1.00em;">&#x00A0;</div>
If one uses Borg in a client/server way (with a ssh: repository), the resource
  usage occurs in part on the client and in another part on the server.
<div style="height: 1.00em;">&#x00A0;</div>
If one uses Borg as a single process (with a filesystem repo), all the resource
  usage occurs in that one process, so just add up client + server to get the
  approximate resource usage.
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>CPU client:</b></dt>
  <dd class="It-tag">borg create: does chunking, hashing, compression, crypto
      (high CPU usage) chunks cache sync: quite heavy on CPU, doing lots of
      hashtable operations. borg extract: crypto, decompression (medium to high
      CPU usage) borg check: similar to extract, but depends on options given.
      borg prune / borg delete archive: low to medium CPU usage borg delete
      repo: done on the server It won't go beyond 100% of 1 core as the code is
      currently single-threaded. Especially higher zlib and lzma compression
      levels use significant amounts of CPU cycles. Crypto might be cheap on the
      CPU (if hardware accelerated) or expensive (if not).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CPU server:</b></dt>
  <dd class="It-tag">It usually doesn't need much CPU, it just deals with the
      key/value store (repository) and uses the repository index for that.
    <div style="height: 1.00em;">&#x00A0;</div>
    borg check: the repository check computes the checksums of all chunks
      (medium CPU usage) borg delete repo: low CPU usage</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CPU (only for client/server operation):</b></dt>
  <dd class="It-tag">When using borg in a client/server way with a
      <i>ssh:-type</i> repo, the ssh processes used for the transport layer will
      need some CPU on the client and on the server due to the crypto they are
      doing - esp. if you are pumping big amounts of data.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Memory (RAM) client:</b></dt>
  <dd class="It-tag">The chunks index and the files index are read into memory
      for performance reasons. Might need big amounts of memory (see below).
      Compression, esp. lzma compression with high levels might need substantial
      amounts of memory.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Memory (RAM) server:</b></dt>
  <dd class="It-tag">The server process will load the repository index into
      memory. Might need considerable amounts of memory, but less than on the
      client (see below).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Chunks index (client only):</b></dt>
  <dd class="It-tag">Proportional to the amount of data chunks in your repo.
      Lots of chunks in your repo imply a big chunks index. It is possible to
      tweak the chunker params (see create options).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Files index (client only):</b></dt>
  <dd class="It-tag">Proportional to the amount of files in your last backups.
      Can be switched off (see create options), but next backup might be much
      slower if you do. The speed benefit of using the files cache is
      proportional to file size.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Repository index (server only):</b></dt>
  <dd class="It-tag">Proportional to the amount of data chunks in your repo.
      Lots of chunks in your repo imply a big repository index. It is possible
      to tweak the chunker params (see create options) to influence the amount
      of chunks being created.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Temporary files (client):</b></dt>
  <dd class="It-tag">Reading data and metadata from a FUSE mounted repository
      will consume up to the size of all deduplicated, small chunks in the
      repository. Big chunks won't be locally cached.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Temporary files (server):</b></dt>
  <dd class="It-tag">None.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Cache files (client only):</b></dt>
  <dd class="It-tag">Contains the chunks index and files index (plus a
      collection of single- archive chunk indexes which might need huge amounts
      of disk space, depending on archive count and size - see FAQ about how to
      reduce).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Network (only for client/server operation):</b></dt>
  <dd class="It-tag">If your repository is remote, all deduplicated (and
      optionally compressed/ encrypted) data of course has to go over the
      connection (ssh: repo url). If you use a locally mounted network
      filesystem, additionally some copy operations used for transaction support
      also go over the connection. If you backup multiple sources to one target
      repository, additional traffic happens for cache resynchronization.</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
In case you are interested in more details (like formulas), please see
  internals.
<h2 class="Ss" title="Ss" id="Units"><a class="selflink" href="#Units">Units</a></h2>
To display quantities, Borg takes care of respecting the usual conventions of
  scale. Disk sizes are displayed in <i>decimal</i>, using powers of ten (so
  <b>kB</b> means 1000 bytes). For memory usage, <i>binary prefixes</i> are
  used, and are indicated using the <i>IEC binary prefixes</i>, using powers of
  two (so <b>KiB</b> means 1024 bytes).
<h2 class="Ss" title="Ss" id="Date_and_Time"><a class="selflink" href="#Date_and_Time">Date
  and Time</a></h2>
We format date and time conforming to ISO-8601, that is: YYYY-MM-DD and HH:MM:SS
  (24h clock).
<div style="height: 1.00em;">&#x00A0;</div>
For more information about that, see: <i>https://xkcd.com/1179/</i>
<div style="height: 1.00em;">&#x00A0;</div>
Unless otherwise noted, we display local date and time. Internally, we store and
  process date and time as UTC.
<h1 class="Sh" title="Sh" id="BORG_INIT"><a class="selflink" href="#BORG_INIT">BORG
  INIT</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
usage: borg init [-h] [--critical] [--error] [--warning] [--info] [--debug]
                 [--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
                 [--remote-path PATH] [-e {none,keyfile,repokey}] [-a]
                 [REPOSITORY]
<div class="Pp"></div>
Initialize an empty repository
<div class="Pp"></div>
positional arguments:
  REPOSITORY            repository to create
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  --critical            work on log level CRITICAL
  --error               work on log level ERROR
  --warning             work on log level WARNING (default)
  --info, -v, --verbose
                        work on log level INFO
  --debug               work on log level DEBUG
  --lock-wait N         wait for the lock, but max. N seconds (default: 1).
  --show-rc             show/log the return code (rc)
  --no-files-cache      do not load/update the file metadata cache used to
                        detect unchanged files
  --umask M             set umask to M (local and remote, default: 0077)
  --remote-path PATH    set remote path to executable (default: &quot;borg&quot;)
  -e {none,keyfile,repokey}, --encryption {none,keyfile,repokey}
                        select encryption key mode (default: &quot;repokey&quot;)
  -a, --append-only     create an append-only mode repository
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
This command initializes an empty repository. A repository is a filesystem
  directory containing the deduplicated data from zero or more archives.
  Encryption can be enabled at repository init time.
<h2 class="Ss" title="Ss" id="Examples"><a class="selflink" href="#Examples">Examples</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
# Local repository (default is to use encryption in repokey mode)
$ borg init /path/to/repo
<div class="Pp"></div>
# Local repository (no encryption)
$ borg init --encryption=none /path/to/repo
<div class="Pp"></div>
# Remote repository (accesses a remote borg via ssh)
$ borg init user@hostname:backup
<div class="Pp"></div>
# Remote repository (store the key your home dir)
$ borg init --encryption=keyfile user@hostname:backup
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Important notes about encryption:
<div style="height: 1.00em;">&#x00A0;</div>
It is not recommended to disable encryption. Repository encryption protects you
  e.g. against the case that an attacker has access to your backup repository.
<div style="height: 1.00em;">&#x00A0;</div>
But be careful with the key / the passphrase:
<div style="height: 1.00em;">&#x00A0;</div>
If you want &quot;passphrase-only&quot; security, use the <b>repokey</b> mode.
  The key will be stored inside the repository (in its &quot;config&quot; file).
  In above mentioned attack scenario, the attacker will have the key (but not
  the passphrase).
<div style="height: 1.00em;">&#x00A0;</div>
If you want &quot;passphrase and having-the-key&quot; security, use the
  <b>keyfile</b> mode. The key will be stored in your home directory (in
  <b>.config/borg/keys</b>). In the attack scenario, the attacker who has just
  access to your repo won't have the key (and also not the passphrase).
<div style="height: 1.00em;">&#x00A0;</div>
Make a backup copy of the key file ( <b>keyfile</b> mode) or repo config file (
  <b>repokey</b> mode) and keep it at a safe place, so you still have the key in
  case it gets corrupted or lost. Also keep the passphrase at a safe place. The
  backup that is encrypted with that key won't help you with that, of course.
<div style="height: 1.00em;">&#x00A0;</div>
Make sure you use a good passphrase. Not too short, not too simple. The real
  encryption / decryption key is encrypted with / locked by your passphrase. If
  an attacker gets your key, he can't unlock and use it without knowing the
  passphrase.
<div style="height: 1.00em;">&#x00A0;</div>
Be careful with special or non-ascii characters in your passphrase:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Borg processes the passphrase as unicode (and encodes it as
      utf-8), so it does not have problems dealing with even the strangest
      characters.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">BUT: that does not necessarily apply to your OS / VM /
      keyboard configuration.</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
So better use a long passphrase made from simple ascii chars than one that
  includes non-ascii stuff or characters that are hard/impossible to enter on a
  different keyboard layout.
<div style="height: 1.00em;">&#x00A0;</div>
You can change your passphrase for existing repos at any time, it won't affect
  the encryption/decryption key or other secrets.
<h1 class="Sh" title="Sh" id="BORG_CREATE"><a class="selflink" href="#BORG_CREATE">BORG
  CREATE</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
usage: borg create [-h] [--critical] [--error] [--warning] [--info] [--debug]
                   [--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
                   [--remote-path PATH] [-s] [-p] [--list]
                   [--filter STATUSCHARS] [-e PATTERN]
                   [--exclude-from EXCLUDEFILE] [--exclude-caches]
                   [--exclude-if-present FILENAME] [--keep-tag-files]
                   [-c SECONDS] [-x] [--numeric-owner] [--noatime] [--noctime]
                   [--timestamp yyyy-mm-ddThh:mm:ss]
                   [--chunker-params CHUNK_MIN_EXP,CHUNK_MAX_EXP,HASH_MASK_BITS,HASH_WINDOW_SIZE]
                   [--ignore-inode] [-C COMPRESSION] [--read-special] [-n]
                   ARCHIVE PATH [PATH ...]
<div class="Pp"></div>
Create new archive
<div class="Pp"></div>
positional arguments:
  ARCHIVE               name of archive to create (must be also a valid
                        directory name)
  PATH                  paths to archive
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  --critical            work on log level CRITICAL
  --error               work on log level ERROR
  --warning             work on log level WARNING (default)
  --info, -v, --verbose
                        work on log level INFO
  --debug               work on log level DEBUG
  --lock-wait N         wait for the lock, but max. N seconds (default: 1).
  --show-rc             show/log the return code (rc)
  --no-files-cache      do not load/update the file metadata cache used to
                        detect unchanged files
  --umask M             set umask to M (local and remote, default: 0077)
  --remote-path PATH    set remote path to executable (default: &quot;borg&quot;)
  -s, --stats           print statistics for the created archive
  -p, --progress        show progress display while creating the archive,
                        showing Original, Compressed and Deduplicated sizes,
                        followed by the Number of files seen and the path
                        being processed, default: False
  --list                output verbose list of items (files, dirs, ...)
  --filter STATUSCHARS  only display items with the given status characters
  -e PATTERN, --exclude PATTERN
                        exclude paths matching PATTERN
  --exclude-from EXCLUDEFILE
                        read exclude patterns from EXCLUDEFILE, one per line
  --exclude-caches      exclude directories that contain a CACHEDIR.TAG file
                        (http://www.brynosaurus.com/cachedir/spec.html)
  --exclude-if-present FILENAME
                        exclude directories that contain the specified file
  --keep-tag-files      keep tag files of excluded caches/directories
  -c SECONDS, --checkpoint-interval SECONDS
                        write checkpoint every SECONDS seconds (Default: 300)
  -x, --one-file-system
                        stay in same file system
  --numeric-owner       only store numeric user and group identifiers
  --noatime             do not store atime into archive
  --noctime             do not store ctime into archive
  --timestamp yyyy-mm-ddThh:mm:ss
                        manually specify the archive creation date/time (UTC).
                        alternatively, give a reference file/directory.
  --chunker-params CHUNK_MIN_EXP,CHUNK_MAX_EXP,HASH_MASK_BITS,HASH_WINDOW_SIZE
                        specify the chunker parameters. default: 19,23,21,4095
  --ignore-inode        ignore inode data in the file metadata cache used to
                        detect unchanged files.
  -C COMPRESSION, --compression COMPRESSION
                        select compression algorithm (and level): none == no
                        compression (default), lz4 == lz4, zlib == zlib
                        (default level 6), zlib,0 .. zlib,9 == zlib (with
                        level 0..9), lzma == lzma (default level 6), lzma,0 ..
                        lzma,9 == lzma (with level 0..9).
  --read-special        open and read block and char device files as well as
                        FIFOs as if they were regular files. Also follows
                        symlinks pointing to these kinds of files.
  -n, --dry-run         do not create a backup archive
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
This command creates a backup archive containing all files found while
  recursively traversing all paths specified. When giving '-' as path, borg will
  read data from standard input and create a file 'stdin' in the created archive
  from that data.
<div style="height: 1.00em;">&#x00A0;</div>
The archive will consume almost no disk space for files or parts of files that
  have already been stored in other archives.
<div style="height: 1.00em;">&#x00A0;</div>
The archive name needs to be unique. It must not end in '.checkpoint' or
  '.checkpoint.N' (with N being a number), because these names are used for
  checkpoints and treated in special ways.
<div style="height: 1.00em;">&#x00A0;</div>
In the archive name, you may use the following placeholders: {now}, {utcnow},
  {fqdn}, {hostname}, {user} and some others.
<div style="height: 1.00em;">&#x00A0;</div>
To speed up pulling backups over sshfs and similar network file systems which do
  not provide correct inode information the --ignore-inode flag can be used.
  This potentially decreases reliability of change detection, while avoiding
  always reading all files on these file systems.
<div style="height: 1.00em;">&#x00A0;</div>
See the output of the &quot;borg help patterns&quot; command for more help on
  exclude patterns. See the output of the &quot;borg help placeholders&quot;
  command for more help on placeholders.
<h2 class="Ss" title="Ss" id="Examples"><a class="selflink" href="#Examples">Examples</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
# Backup ~/Documents into an archive named &quot;my-documents&quot;
$ borg create /path/to/repo::my-documents ~/Documents
<div class="Pp"></div>
# same, but verbosely list all files as we process them
$ borg create -v --list /path/to/repo::my-documents ~/Documents
<div class="Pp"></div>
# Backup ~/Documents and ~/src but exclude pyc files
$ borg create /path/to/repo::my-files \
    ~/Documents                       \
    ~/src                             \
    --exclude '*.pyc'
<div class="Pp"></div>
# Backup home directories excluding image thumbnails (i.e. only
# /home/*/.thumbnails is excluded, not /home/*/*/.thumbnails)
$ borg create /path/to/repo::my-files /home \
    --exclude 're:^/home/[^/]+/\.thumbnails/'
<div class="Pp"></div>
# Do the same using a shell-style pattern
$ borg create /path/to/repo::my-files /home \
    --exclude 'sh:/home/*/.thumbnails'
<div class="Pp"></div>
# Backup the root filesystem into an archive named &quot;root-YYYY-MM-DD&quot;
# use zlib compression (good, but slow) - default is no compression
$ borg create -C zlib,6 /path/to/repo::root-{now:%Y-%m-%d} / --one-file-system
<div class="Pp"></div>
# Make a big effort in fine granular deduplication (big chunk management
# overhead, needs a lot of RAM and disk space, see formula in internals
# docs - same parameters as borg &lt; 1.0 or attic):
$ borg create --chunker-params 10,23,16,4095 /path/to/repo::small /smallstuff
<div class="Pp"></div>
# Backup a raw device (must not be active/in use/mounted at that time)
$ dd if=/dev/sdx bs=10M | borg create /path/to/repo::my-sdx -
<div class="Pp"></div>
# No compression (default)
$ borg create /path/to/repo::arch ~
<div class="Pp"></div>
# Super fast, low compression
$ borg create --compression lz4 /path/to/repo::arch ~
<div class="Pp"></div>
# Less fast, higher compression (N = 0..9)
$ borg create --compression zlib,N /path/to/repo::arch ~
<div class="Pp"></div>
# Even slower, even higher compression (N = 0..9)
$ borg create --compression lzma,N /path/to/repo::arch ~
<div class="Pp"></div>
# Use short hostname, user name and current time in archive name
$ borg create /path/to/repo::{hostname}-{user}-{now} ~
# Similar, use the same datetime format as borg 1.1 will have as default
$ borg create /path/to/repo::{hostname}-{user}-{now:%Y-%m-%dT%H:%M:%S} ~
# As above, but add nanoseconds
$ borg create /path/to/repo::{hostname}-{user}-{now:%Y-%m-%dT%H:%M:%S.%f} ~
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Notes"><a class="selflink" href="#Notes">Notes</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">the --exclude patterns are not like tar. In tar --exclude
      .bundler/gems will exclude foo/.bundler/gems. In borg it will not, you
      need to use --exclude '*/.bundler/gems' to get the same effect. See
      <b>borg help patterns</b> for more information.</dd>
</dl>
</div>
<br/>
<h1 class="Sh" title="Sh" id="BORG_EXTRACT"><a class="selflink" href="#BORG_EXTRACT">BORG
  EXTRACT</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
usage: borg extract [-h] [--critical] [--error] [--warning] [--info] [--debug]
                    [--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
                    [--remote-path PATH] [--list] [-n] [-e PATTERN]
                    [--exclude-from EXCLUDEFILE] [--numeric-owner]
                    [--strip-components NUMBER] [--stdout] [--sparse]
                    ARCHIVE [PATH [PATH ...]]
<div class="Pp"></div>
Extract archive contents
<div class="Pp"></div>
positional arguments:
  ARCHIVE               archive to extract
  PATH                  paths to extract; patterns are supported
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  --critical            work on log level CRITICAL
  --error               work on log level ERROR
  --warning             work on log level WARNING (default)
  --info, -v, --verbose
                        work on log level INFO
  --debug               work on log level DEBUG
  --lock-wait N         wait for the lock, but max. N seconds (default: 1).
  --show-rc             show/log the return code (rc)
  --no-files-cache      do not load/update the file metadata cache used to
                        detect unchanged files
  --umask M             set umask to M (local and remote, default: 0077)
  --remote-path PATH    set remote path to executable (default: &quot;borg&quot;)
  --list                output verbose list of items (files, dirs, ...)
  -n, --dry-run         do not actually change any files
  -e PATTERN, --exclude PATTERN
                        exclude paths matching PATTERN
  --exclude-from EXCLUDEFILE
                        read exclude patterns from EXCLUDEFILE, one per line
  --numeric-owner       only obey numeric user and group identifiers
  --strip-components NUMBER
                        Remove the specified number of leading path elements.
                        Pathnames with fewer elements will be silently
                        skipped.
  --stdout              write all extracted data to stdout
  --sparse              create holes in output sparse file from all-zero
                        chunks
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
This command extracts the contents of an archive. By default the entire archive
  is extracted but a subset of files and directories can be selected by passing
  a list of <b>PATHs</b> as arguments. The file selection can further be
  restricted by using the <b>--exclude</b> option.
<div style="height: 1.00em;">&#x00A0;</div>
See the output of the &quot;borg help patterns&quot; command for more help on
  exclude patterns.
<h2 class="Ss" title="Ss" id="Examples"><a class="selflink" href="#Examples">Examples</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
# Extract entire archive
$ borg extract /path/to/repo::my-files
<div class="Pp"></div>
# Extract entire archive and list files while processing
$ borg extract -v --list /path/to/repo::my-files
<div class="Pp"></div>
# Extract the &quot;src&quot; directory
$ borg extract /path/to/repo::my-files home/USERNAME/src
<div class="Pp"></div>
# Extract the &quot;src&quot; directory but exclude object files
$ borg extract /path/to/repo::my-files home/USERNAME/src --exclude '*.o'
<div class="Pp"></div>
# Restore a raw device (must not be active/in use/mounted at that time)
$ borg extract --stdout /path/to/repo::my-sdx | dd of=/dev/sdx bs=10M
</pre>
</div>
<br/>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>Note: currently, extract always writes into the current
    working directory (&quot;.&quot;),</b></dt>
  <dd class="It-tag">so make sure you <b>cd</b> to the right place before
      calling <b>borg extract</b>.</dd>
</dl>
</div>
<br/>
<h1 class="Sh" title="Sh" id="BORG_CHECK"><a class="selflink" href="#BORG_CHECK">BORG
  CHECK</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
usage: borg check [-h] [--critical] [--error] [--warning] [--info] [--debug]
                  [--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
                  [--remote-path PATH] [--repository-only] [--archives-only]
                  [--repair] [--save-space] [--last N] [-P PREFIX]
                  [REPOSITORY_OR_ARCHIVE]
<div class="Pp"></div>
Check repository consistency
<div class="Pp"></div>
positional arguments:
  REPOSITORY_OR_ARCHIVE
                        repository or archive to check consistency of
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  --critical            work on log level CRITICAL
  --error               work on log level ERROR
  --warning             work on log level WARNING (default)
  --info, -v, --verbose
                        work on log level INFO
  --debug               work on log level DEBUG
  --lock-wait N         wait for the lock, but max. N seconds (default: 1).
  --show-rc             show/log the return code (rc)
  --no-files-cache      do not load/update the file metadata cache used to
                        detect unchanged files
  --umask M             set umask to M (local and remote, default: 0077)
  --remote-path PATH    set remote path to executable (default: &quot;borg&quot;)
  --repository-only     only perform repository checks
  --archives-only       only perform archives checks
  --repair              attempt to repair any inconsistencies found
  --save-space          work slower, but using less space
  --last N              only check last N archives (Default: all)
  -P PREFIX, --prefix PREFIX
                        only consider archive names starting with this prefix
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
The check command verifies the consistency of a repository and the corresponding
  archives.
<div style="height: 1.00em;">&#x00A0;</div>
First, the underlying repository data files are checked:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">For all segments the segment magic (header) is checked</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">For all objects stored in the segments, all metadata (e.g.
      crc and size) and all data is read. The read data is checked by size and
      CRC. Bit rot and other types of accidental damage can be detected this
      way.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">If we are in repair mode and a integrity error is detected
      for a segment, we try to recover as many objects from the segment as
      possible.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">In repair mode, it makes sure that the index is consistent
      with the data stored in the segments.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">If you use a remote repo server via ssh:, the repo check is
      executed on the repo server without causing significant network
    traffic.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The repository check can be skipped using the
      --archives-only option.</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Second, the consistency and correctness of the archive metadata is verified:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Is the repo manifest present? If not, it is rebuilt from
      archive metadata chunks (this requires reading and decrypting of all
      metadata and data).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Check if archive metadata chunk is present. if not, remove
      archive from manifest.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">For all files (items) in the archive, for all chunks
      referenced by these files, check if chunk is present. If a chunk is not
      present and we are in repair mode, replace it with a same-size replacement
      chunk of zeros. If a previously lost chunk reappears (e.g. via a later
      backup) and we are in repair mode, the all-zero replacement chunk will be
      replaced by the correct chunk. This requires reading of archive and file
      metadata, but not data.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">If we are in repair mode and we checked all the archives:
      delete orphaned chunks from the repo.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">if you use a remote repo server via ssh:, the archive check
      is executed on the client machine (because if encryption is enabled, the
      checks will require decryption and this is always done client-side,
      because key access will be required).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The archive checks can be time consuming, they can be
      skipped using the --repository-only option.</dd>
</dl>
</div>
<br/>
<h1 class="Sh" title="Sh" id="BORG_RENAME"><a class="selflink" href="#BORG_RENAME">BORG
  RENAME</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
usage: borg rename [-h] [--critical] [--error] [--warning] [--info] [--debug]
                   [--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
                   [--remote-path PATH]
                   ARCHIVE NEWNAME
<div class="Pp"></div>
Rename an existing archive
<div class="Pp"></div>
positional arguments:
  ARCHIVE               archive to rename
  NEWNAME               the new archive name to use
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  --critical            work on log level CRITICAL
  --error               work on log level ERROR
  --warning             work on log level WARNING (default)
  --info, -v, --verbose
                        work on log level INFO
  --debug               work on log level DEBUG
  --lock-wait N         wait for the lock, but max. N seconds (default: 1).
  --show-rc             show/log the return code (rc)
  --no-files-cache      do not load/update the file metadata cache used to
                        detect unchanged files
  --umask M             set umask to M (local and remote, default: 0077)
  --remote-path PATH    set remote path to executable (default: &quot;borg&quot;)
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
This command renames an archive in the repository.
<h2 class="Ss" title="Ss" id="Examples"><a class="selflink" href="#Examples">Examples</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ borg create /path/to/repo::archivename ~
$ borg list /path/to/repo
archivename                          Mon, 2016-02-15 19:50:19
<div class="Pp"></div>
$ borg rename /path/to/repo::archivename newname
$ borg list /path/to/repo
newname                              Mon, 2016-02-15 19:50:19
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="BORG_LIST"><a class="selflink" href="#BORG_LIST">BORG
  LIST</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
usage: borg list [-h] [--critical] [--error] [--warning] [--info] [--debug]
                 [--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
                 [--remote-path PATH] [--short] [--list-format LISTFORMAT]
                 [-P PREFIX]
                 [REPOSITORY_OR_ARCHIVE]
<div class="Pp"></div>
List archive or repository contents
<div class="Pp"></div>
positional arguments:
  REPOSITORY_OR_ARCHIVE
                        repository/archive to list contents of
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  --critical            work on log level CRITICAL
  --error               work on log level ERROR
  --warning             work on log level WARNING (default)
  --info, -v, --verbose
                        work on log level INFO
  --debug               work on log level DEBUG
  --lock-wait N         wait for the lock, but max. N seconds (default: 1).
  --show-rc             show/log the return code (rc)
  --no-files-cache      do not load/update the file metadata cache used to
                        detect unchanged files
  --umask M             set umask to M (local and remote, default: 0077)
  --remote-path PATH    set remote path to executable (default: &quot;borg&quot;)
  --short               only print file/directory names, nothing else
  --list-format LISTFORMAT
                        specify format for archive file listing (default:
                        &quot;{mode} {user:6} {group:6} {size:8d} {isomtime}
                        {path}{extra}{NEWLINE}&quot;) Special &quot;{formatkeys}&quot; exists
                        to list available keys
  -P PREFIX, --prefix PREFIX
                        only consider archive names starting with this prefix
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
This command lists the contents of a repository or an archive.
<h2 class="Ss" title="Ss" id="Examples"><a class="selflink" href="#Examples">Examples</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ borg list /path/to/repo
Monday                               Mon, 2016-02-15 19:15:11
repo                                 Mon, 2016-02-15 19:26:54
root-2016-02-15                      Mon, 2016-02-15 19:36:29
newname                              Mon, 2016-02-15 19:50:19
...
<div class="Pp"></div>
$ borg list /path/to/repo::root-2016-02-15
drwxr-xr-x root   root          0 Mon, 2016-02-15 17:44:27 .
drwxrwxr-x root   root          0 Mon, 2016-02-15 19:04:49 bin
-rwxr-xr-x root   root    1029624 Thu, 2014-11-13 00:08:51 bin/bash
lrwxrwxrwx root   root          0 Fri, 2015-03-27 20:24:26 bin/bzcmp -&gt; bzdiff
-rwxr-xr-x root   root       2140 Fri, 2015-03-27 20:24:22 bin/bzdiff
...
<div class="Pp"></div>
$ borg list /path/to/repo::archiveA --list-format=&quot;{mode} {user:6} {group:6} {size:8d} {isomtime} {path}{extra}{NEWLINE}&quot;
drwxrwxr-x user   user          0 Sun, 2015-02-01 11:00:00 .
drwxrwxr-x user   user          0 Sun, 2015-02-01 11:00:00 code
drwxrwxr-x user   user          0 Sun, 2015-02-01 11:00:00 code/myproject
-rw-rw-r-- user   user    1416192 Sun, 2015-02-01 11:00:00 code/myproject/file.ext
...
<div class="Pp"></div>
# see what is changed between archives, based on file modification time, size and file path
$ borg list /path/to/repo::archiveA --list-format=&quot;{mtime:%s}{TAB}{size}{TAB}{path}{LF}&quot; |sort -n &gt; /tmp/list.archiveA
$ borg list /path/to/repo::archiveB --list-format=&quot;{mtime:%s}{TAB}{size}{TAB}{path}{LF}&quot; |sort -n &gt; /tmp/list.archiveB
$ diff -y /tmp/list.archiveA /tmp/list.archiveB
1422781200      0       .                                       1422781200      0       .
1422781200      0       code                                    1422781200      0       code
1422781200      0       code/myproject                          1422781200      0       code/myproject
1422781200      1416192 code/myproject/file.ext               | 1454664653      1416192 code/myproject/file.ext
...
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="BORG_DELETE"><a class="selflink" href="#BORG_DELETE">BORG
  DELETE</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
usage: borg delete [-h] [--critical] [--error] [--warning] [--info] [--debug]
                   [--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
                   [--remote-path PATH] [-p] [-s] [-c] [--force]
                   [--save-space]
                   [TARGET]
<div class="Pp"></div>
Delete an existing repository or archive
<div class="Pp"></div>
positional arguments:
  TARGET                archive or repository to delete
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  --critical            work on log level CRITICAL
  --error               work on log level ERROR
  --warning             work on log level WARNING (default)
  --info, -v, --verbose
                        work on log level INFO
  --debug               work on log level DEBUG
  --lock-wait N         wait for the lock, but max. N seconds (default: 1).
  --show-rc             show/log the return code (rc)
  --no-files-cache      do not load/update the file metadata cache used to
                        detect unchanged files
  --umask M             set umask to M (local and remote, default: 0077)
  --remote-path PATH    set remote path to executable (default: &quot;borg&quot;)
  -p, --progress        show progress display while deleting a single archive
  -s, --stats           print statistics for the deleted archive
  -c, --cache-only      delete only the local cache for the given repository
  --force               force deletion of corrupted archives
  --save-space          work slower, but using less space
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
This command deletes an archive from the repository or the complete repository.
  Disk space is reclaimed accordingly. If you delete the complete repository,
  the local cache for it (if any) is also deleted.
<h2 class="Ss" title="Ss" id="Examples"><a class="selflink" href="#Examples">Examples</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
# delete a single backup archive:
$ borg delete /path/to/repo::Monday
<div class="Pp"></div>
# delete the whole repository and the related local cache:
$ borg delete /path/to/repo
You requested to completely DELETE the repository *including* all archives it contains:
repo                                 Mon, 2016-02-15 19:26:54
root-2016-02-15                      Mon, 2016-02-15 19:36:29
newname                              Mon, 2016-02-15 19:50:19
Type 'YES' if you understand this and want to continue: YES
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="BORG_PRUNE"><a class="selflink" href="#BORG_PRUNE">BORG
  PRUNE</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
usage: borg prune [-h] [--critical] [--error] [--warning] [--info] [--debug]
                  [--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
                  [--remote-path PATH] [-n] [--force] [-s] [--list]
                  [--keep-within WITHIN] [-H HOURLY] [-d DAILY] [-w WEEKLY]
                  [-m MONTHLY] [-y YEARLY] [-P PREFIX] [--save-space]
                  [REPOSITORY]
<div class="Pp"></div>
Prune repository archives according to specified rules
<div class="Pp"></div>
positional arguments:
  REPOSITORY            repository to prune
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  --critical            work on log level CRITICAL
  --error               work on log level ERROR
  --warning             work on log level WARNING (default)
  --info, -v, --verbose
                        work on log level INFO
  --debug               work on log level DEBUG
  --lock-wait N         wait for the lock, but max. N seconds (default: 1).
  --show-rc             show/log the return code (rc)
  --no-files-cache      do not load/update the file metadata cache used to
                        detect unchanged files
  --umask M             set umask to M (local and remote, default: 0077)
  --remote-path PATH    set remote path to executable (default: &quot;borg&quot;)
  -n, --dry-run         do not change repository
  --force               force pruning of corrupted archives
  -s, --stats           print statistics for the deleted archive
  --list                output verbose list of archives it keeps/prunes
  --keep-within WITHIN  keep all archives within this time interval
  -H HOURLY, --keep-hourly HOURLY
                        number of hourly archives to keep
  -d DAILY, --keep-daily DAILY
                        number of daily archives to keep
  -w WEEKLY, --keep-weekly WEEKLY
                        number of weekly archives to keep
  -m MONTHLY, --keep-monthly MONTHLY
                        number of monthly archives to keep
  -y YEARLY, --keep-yearly YEARLY
                        number of yearly archives to keep
  -P PREFIX, --prefix PREFIX
                        only consider archive names starting with this prefix
  --save-space          work slower, but using less space
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
The prune command prunes a repository by deleting all archives not matching any
  of the specified retention options. This command is normally used by automated
  backup scripts wanting to keep a certain number of historic backups.
<div style="height: 1.00em;">&#x00A0;</div>
As an example, &quot;-d 7&quot; means to keep the latest backup on each day, up
  to 7 most recent days with backups (days without backups do not count). The
  rules are applied from hourly to yearly, and backups selected by previous
  rules do not count towards those of later rules. The time that each backup
  starts is used for pruning purposes. Dates and times are interpreted in the
  local timezone, and weeks go from Monday to Sunday. Specifying a negative
  number of archives to keep means that there is no limit.
<div style="height: 1.00em;">&#x00A0;</div>
The &quot;--keep-within&quot; option takes an argument of the form
  &quot;&lt;int&gt;&lt;char&gt;&quot;, where char is &quot;H&quot;,
  &quot;d&quot;, &quot;w&quot;, &quot;m&quot;, &quot;y&quot;. For example,
  &quot;--keep-within 2d&quot; means to keep all archives that were created
  within the past 48 hours. &quot;1m&quot; is taken to mean &quot;31d&quot;. The
  archives kept with this option do not count towards the totals specified by
  any other options.
<div style="height: 1.00em;">&#x00A0;</div>
If a prefix is set with -P, then only archives that start with the prefix are
  considered for deletion and only those archives count towards the totals
  specified by the rules. Otherwise, <i>all</i> archives in the repository are
  candidates for deletion! There is no automatic distinction between archives
  representing different contents. These need to be distinguished by specifying
  matching prefixes.
<h2 class="Ss" title="Ss" id="Examples"><a class="selflink" href="#Examples">Examples</a></h2>
Be careful, prune is a potentially dangerous command, it will remove backup
  archives.
<div style="height: 1.00em;">&#x00A0;</div>
The default of prune is to apply to <b>all archives in the repository</b> unless
  you restrict its operation to a subset of the archives using <b>--prefix</b>.
  When using <b>--prefix</b>, be careful to choose a good prefix - e.g. do not
  use a prefix &quot;foo&quot; if you do not also want to match
  &quot;foobar&quot;.
<div style="height: 1.00em;">&#x00A0;</div>
It is strongly recommended to always run <b>prune -v --list --dry-run ...</b>
  first so you will see what it would do without it actually doing anything.
<div style="height: 1.00em;">&#x00A0;</div>
There is also a visualized prune example in <b>docs/misc/prune-example.txt</b>.
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
# Keep 7 end of day and 4 additional end of week archives.
# Do a dry-run without actually deleting anything.
$ borg prune -v --list --dry-run --keep-daily=7 --keep-weekly=4 /path/to/repo
<div class="Pp"></div>
# Same as above but only apply to archive names starting with the hostname
# of the machine followed by a &quot;-&quot; character:
$ borg prune -v --list --keep-daily=7 --keep-weekly=4 --prefix='{hostname}-' /path/to/repo
<div class="Pp"></div>
# Keep 7 end of day, 4 additional end of week archives,
# and an end of month archive for every month:
$ borg prune -v --list --keep-daily=7 --keep-weekly=4 --keep-monthly=-1 /path/to/repo
<div class="Pp"></div>
# Keep all backups in the last 10 days, 4 additional end of week archives,
# and an end of month archive for every month:
$ borg prune -v --list --keep-within=10d --keep-weekly=4 --keep-monthly=-1 /path/to/repo
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="BORG_INFO"><a class="selflink" href="#BORG_INFO">BORG
  INFO</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
usage: borg info [-h] [--critical] [--error] [--warning] [--info] [--debug]
                 [--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
                 [--remote-path PATH]
                 ARCHIVE
<div class="Pp"></div>
Show archive details such as disk space used
<div class="Pp"></div>
positional arguments:
  ARCHIVE               archive to display information about
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  --critical            work on log level CRITICAL
  --error               work on log level ERROR
  --warning             work on log level WARNING (default)
  --info, -v, --verbose
                        work on log level INFO
  --debug               work on log level DEBUG
  --lock-wait N         wait for the lock, but max. N seconds (default: 1).
  --show-rc             show/log the return code (rc)
  --no-files-cache      do not load/update the file metadata cache used to
                        detect unchanged files
  --umask M             set umask to M (local and remote, default: 0077)
  --remote-path PATH    set remote path to executable (default: &quot;borg&quot;)
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
This command displays some detailed information about the specified archive.
<div style="height: 1.00em;">&#x00A0;</div>
Please note that the deduplicated sizes of the individual archives do not add up
  to the deduplicated size of the repository (&quot;all archives&quot;), because
  the two are meaning different things:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>This archive / deduplicated size = amount of data stored
    ONLY for this archive</b></dt>
  <dd class="It-tag">= unique chunks of this archive.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>All archives / deduplicated size = amount of data stored
    in the repo</b></dt>
  <dd class="It-tag">= all chunks in the repository.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Examples"><a class="selflink" href="#Examples">Examples</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ borg info /path/to/repo::root-2016-02-15
Name: root-2016-02-15
Fingerprint: 57c827621f21b000a8d363c1e163cc55983822b3afff3a96df595077a660be50
Hostname: myhostname
Username: root
Time (start): Mon, 2016-02-15 19:36:29
Time (end):   Mon, 2016-02-15 19:39:26
Command line: /usr/local/bin/borg create -v --list -C zlib,6 /path/to/repo::root-2016-02-15 / --one-file-system
Number of files: 38100
<div class="Pp"></div>
                       Original size      Compressed size    Deduplicated size
This archive:                1.33 GB            613.25 MB            571.64 MB
All archives:                1.63 GB            853.66 MB            584.12 MB
<div class="Pp"></div>
                       Unique chunks         Total chunks
Chunk index:                   36858                48844
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="BORG_MOUNT"><a class="selflink" href="#BORG_MOUNT">BORG
  MOUNT</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
usage: borg mount [-h] [--critical] [--error] [--warning] [--info] [--debug]
                  [--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
                  [--remote-path PATH] [-f] [-o OPTIONS]
                  REPOSITORY_OR_ARCHIVE MOUNTPOINT
<div class="Pp"></div>
Mount archive or an entire repository as a FUSE filesystem
<div class="Pp"></div>
positional arguments:
  REPOSITORY_OR_ARCHIVE
                        repository/archive to mount
  MOUNTPOINT            where to mount filesystem
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  --critical            work on log level CRITICAL
  --error               work on log level ERROR
  --warning             work on log level WARNING (default)
  --info, -v, --verbose
                        work on log level INFO
  --debug               work on log level DEBUG
  --lock-wait N         wait for the lock, but max. N seconds (default: 1).
  --show-rc             show/log the return code (rc)
  --no-files-cache      do not load/update the file metadata cache used to
                        detect unchanged files
  --umask M             set umask to M (local and remote, default: 0077)
  --remote-path PATH    set remote path to executable (default: &quot;borg&quot;)
  -f, --foreground      stay in foreground, do not daemonize
  -o OPTIONS            Extra mount options
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
This command mounts an archive as a FUSE filesystem. This can be useful for
  browsing an archive or restoring individual files. Unless the
  <b>--foreground</b> option is given the command will run in the background
  until the filesystem is <b>umounted</b>.
<div style="height: 1.00em;">&#x00A0;</div>
The BORG_MOUNT_DATA_CACHE_ENTRIES environment variable is meant for advanced
  users to tweak the performance. It sets the number of cached data chunks;
  additional memory usage can be up to ~8 MiB times this number. The default is
  the number of CPU cores.
<div style="height: 1.00em;">&#x00A0;</div>
For mount options, see the fuse(8) manual page. Additional mount options
  supported by borg:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">allow_damaged_files: by default damaged files (where
      missing chunks were replaced with runs of zeros by borg check --repair)
      are not readable and return EIO (I/O error). Set this option to read such
      files.</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
When the daemonized process receives a signal or crashes, it does not unmount.
  Unmounting in these cases could cause an active rsync or similar process to
  unintentionally delete data.
<div style="height: 1.00em;">&#x00A0;</div>
When running in the foreground ^C/SIGINT unmounts cleanly, but other signals or
  crashes do not.
<h1 class="Sh" title="Sh" id="BORG_UMOUNT"><a class="selflink" href="#BORG_UMOUNT">BORG
  UMOUNT</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
usage: borg umount [-h] [--critical] [--error] [--warning] [--info] [--debug]
                   [--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
                   [--remote-path PATH]
                   MOUNTPOINT
<div class="Pp"></div>
un-mount the FUSE filesystem
<div class="Pp"></div>
positional arguments:
  MOUNTPOINT            mountpoint of the filesystem to umount
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  --critical            work on log level CRITICAL
  --error               work on log level ERROR
  --warning             work on log level WARNING (default)
  --info, -v, --verbose
                        work on log level INFO
  --debug               work on log level DEBUG
  --lock-wait N         wait for the lock, but max. N seconds (default: 1).
  --show-rc             show/log the return code (rc)
  --no-files-cache      do not load/update the file metadata cache used to
                        detect unchanged files
  --umask M             set umask to M (local and remote, default: 0077)
  --remote-path PATH    set remote path to executable (default: &quot;borg&quot;)
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
This command un-mounts a FUSE filesystem that was mounted with <b>borg
  mount</b>.
<div style="height: 1.00em;">&#x00A0;</div>
This is a convenience wrapper that just calls the platform-specific shell
  command - usually this is either umount or fusermount -u.
<h2 class="Ss" title="Ss" id="Examples"><a class="selflink" href="#Examples">Examples</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ borg mount /path/to/repo::root-2016-02-15 /tmp/mymountpoint
$ ls /tmp/mymountpoint
bin  boot  etc      home  lib  lib64  lost+found  media  mnt  opt  root  sbin  srv  tmp  usr  var
$ borg umount /tmp/mymountpoint
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="BORG_KEY_EXPORT"><a class="selflink" href="#BORG_KEY_EXPORT">BORG
  KEY EXPORT</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
usage: borg key export [-h] [--critical] [--error] [--warning] [--info]
                       [--debug] [--lock-wait N] [--show-rc]
                       [--no-files-cache] [--umask M] [--remote-path PATH]
                       [--paper] [--qr-html]
                       [REPOSITORY] [PATH]
<div class="Pp"></div>
Export the repository key for backup
<div class="Pp"></div>
positional arguments:
  REPOSITORY
  PATH                  where to store the backup
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  --critical            work on log level CRITICAL
  --error               work on log level ERROR
  --warning             work on log level WARNING (default)
  --info, -v, --verbose
                        work on log level INFO
  --debug               work on log level DEBUG
  --lock-wait N         wait for the lock, but max. N seconds (default: 1).
  --show-rc             show/log the return code (rc)
  --no-files-cache      do not load/update the file metadata cache used to
                        detect unchanged files
  --umask M             set umask to M (local and remote, default: 0077)
  --remote-path PATH    set remote path to executable (default: &quot;borg&quot;)
  --paper               Create an export suitable for printing and later type-
                        in
  --qr-html             Create an html file suitable for printing and later
                        type-in or qr scan
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
If repository encryption is used, the repository is inaccessible without the
  key. This command allows to backup this essential key.
<div style="height: 1.00em;">&#x00A0;</div>
There are two backup formats. The normal backup format is suitable for digital
  storage as a file. The <b>--paper</b> backup format is optimized for printing
  and typing in while importing, with per line checks to reduce problems with
  manual input.
<div style="height: 1.00em;">&#x00A0;</div>
For repositories using keyfile encryption the key is saved locally on the system
  that is capable of doing backups. To guard against loss of this key, the key
  needs to be backed up independently of the main data backup.
<div style="height: 1.00em;">&#x00A0;</div>
For repositories using the repokey encryption the key is saved in the repository
  in the config file. A backup is thus not strictly needed, but guards against
  the repository becoming inaccessible if the file is damaged for some reason.
<h1 class="Sh" title="Sh" id="BORG_KEY_IMPORT"><a class="selflink" href="#BORG_KEY_IMPORT">BORG
  KEY IMPORT</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
usage: borg key import [-h] [--critical] [--error] [--warning] [--info]
                       [--debug] [--lock-wait N] [--show-rc]
                       [--no-files-cache] [--umask M] [--remote-path PATH]
                       [--paper]
                       [REPOSITORY] [PATH]
<div class="Pp"></div>
Import the repository key from backup
<div class="Pp"></div>
positional arguments:
  REPOSITORY
  PATH                  path to the backup
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  --critical            work on log level CRITICAL
  --error               work on log level ERROR
  --warning             work on log level WARNING (default)
  --info, -v, --verbose
                        work on log level INFO
  --debug               work on log level DEBUG
  --lock-wait N         wait for the lock, but max. N seconds (default: 1).
  --show-rc             show/log the return code (rc)
  --no-files-cache      do not load/update the file metadata cache used to
                        detect unchanged files
  --umask M             set umask to M (local and remote, default: 0077)
  --remote-path PATH    set remote path to executable (default: &quot;borg&quot;)
  --paper               interactively import from a backup done with --paper
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
This command allows to restore a key previously backed up with the export
  command.
<div style="height: 1.00em;">&#x00A0;</div>
If the <b>--paper</b> option is given, the import will be an interactive process
  in which each line is checked for plausibility before proceeding to the next
  line. For this format PATH must not be given.
<h1 class="Sh" title="Sh" id="BORG_CHANGE-PASSPHRASE"><a class="selflink" href="#BORG_CHANGE-PASSPHRASE">BORG
  CHANGE-PASSPHRASE</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
usage: borg change-passphrase [-h] [--critical] [--error] [--warning] [--info]
                              [--debug] [--lock-wait N] [--show-rc]
                              [--no-files-cache] [--umask M]
                              [--remote-path PATH]
                              [REPOSITORY]
<div class="Pp"></div>
Change repository key file passphrase
<div class="Pp"></div>
positional arguments:
  REPOSITORY
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  --critical            work on log level CRITICAL
  --error               work on log level ERROR
  --warning             work on log level WARNING (default)
  --info, -v, --verbose
                        work on log level INFO
  --debug               work on log level DEBUG
  --lock-wait N         wait for the lock, but max. N seconds (default: 1).
  --show-rc             show/log the return code (rc)
  --no-files-cache      do not load/update the file metadata cache used to
                        detect unchanged files
  --umask M             set umask to M (local and remote, default: 0077)
  --remote-path PATH    set remote path to executable (default: &quot;borg&quot;)
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
The key files used for repository encryption are optionally passphrase
  protected. This command can be used to change this passphrase.
<h2 class="Ss" title="Ss" id="Examples"><a class="selflink" href="#Examples">Examples</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
# Create a key file protected repository
$ borg init --encryption=keyfile -v /path/to/repo
Initializing repository at &quot;/path/to/repo&quot;
Enter new passphrase:
Enter same passphrase again:
Remember your passphrase. Your data will be inaccessible without it.
Key in &quot;/root/.config/borg/keys/mnt_backup&quot; created.
Keep this key safe. Your data will be inaccessible without it.
Synchronizing chunks cache...
Archives: 0, w/ cached Idx: 0, w/ outdated Idx: 0, w/o cached Idx: 0.
Done.
<div class="Pp"></div>
# Change key file passphrase
$ borg change-passphrase -v /path/to/repo
Enter passphrase for key /root/.config/borg/keys/mnt_backup:
Enter new passphrase:
Enter same passphrase again:
Remember your passphrase. Your data will be inaccessible without it.
Key updated
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="BORG_SERVE"><a class="selflink" href="#BORG_SERVE">BORG
  SERVE</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
usage: borg serve [-h] [--critical] [--error] [--warning] [--info] [--debug]
                  [--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
                  [--remote-path PATH] [--restrict-to-path PATH]
                  [--append-only]
<div class="Pp"></div>
Start in server mode. This command is usually not used manually.
<div class="Pp"></div>
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  --critical            work on log level CRITICAL
  --error               work on log level ERROR
  --warning             work on log level WARNING (default)
  --info, -v, --verbose
                        work on log level INFO
  --debug               work on log level DEBUG
  --lock-wait N         wait for the lock, but max. N seconds (default: 1).
  --show-rc             show/log the return code (rc)
  --no-files-cache      do not load/update the file metadata cache used to
                        detect unchanged files
  --umask M             set umask to M (local and remote, default: 0077)
  --remote-path PATH    set remote path to executable (default: &quot;borg&quot;)
  --restrict-to-path PATH
                        restrict repository access to PATH. Can be specified
                        multiple times to allow the client access to several
                        directories. Access to all sub-directories is granted
                        implicitly; PATH doesn't need to directly point to a
                        repository.
  --append-only         only allow appending to repository segment files
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
This command starts a repository server process. This command is usually not
  used manually.
<h2 class="Ss" title="Ss" id="Examples"><a class="selflink" href="#Examples">Examples</a></h2>
borg serve has special support for ssh forced commands (see
  <b>authorized_keys</b> example below): it will detect that you use such a
  forced command and extract the value of the <b>--restrict-to-path</b>
  option(s). It will then parse the original command that came from the client,
  makes sure that it is also <b>borg serve</b> and enforce path restriction(s)
  as given by the forced command. That way, other options given by the client
  (like <b>--info</b> or <b>--umask</b>) are preserved (and are not fixed by the
  forced command).
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
# Allow an SSH keypair to only run borg, and only have access to /path/to/repo.
# Use key options to disable unneeded and potentially dangerous SSH functionality.
# This will help to secure an automated remote backup system.
$ cat ~/.ssh/authorized_keys
command=&quot;borg serve --restrict-to-path /path/to/repo&quot;,no-pty,no-agent-forwarding,no-port-forwarding,no-X11-forwarding,no-user-rc ssh-rsa AAAAB3[...]
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="BORG_UPGRADE"><a class="selflink" href="#BORG_UPGRADE">BORG
  UPGRADE</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
usage: borg upgrade [-h] [--critical] [--error] [--warning] [--info] [--debug]
                    [--lock-wait N] [--show-rc] [--no-files-cache] [--umask M]
                    [--remote-path PATH] [-p] [-n] [-i] [--force] [--tam]
                    [--disable-tam]
                    [REPOSITORY]
<div class="Pp"></div>
upgrade a repository from a previous version
<div class="Pp"></div>
positional arguments:
  REPOSITORY            path to the repository to be upgraded
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  --critical            work on log level CRITICAL
  --error               work on log level ERROR
  --warning             work on log level WARNING (default)
  --info, -v, --verbose
                        work on log level INFO
  --debug               work on log level DEBUG
  --lock-wait N         wait for the lock, but max. N seconds (default: 1).
  --show-rc             show/log the return code (rc)
  --no-files-cache      do not load/update the file metadata cache used to
                        detect unchanged files
  --umask M             set umask to M (local and remote, default: 0077)
  --remote-path PATH    set remote path to executable (default: &quot;borg&quot;)
  -p, --progress        show progress display while upgrading the repository
  -n, --dry-run         do not change repository
  -i, --inplace         rewrite repository in place, with no chance of going
                        back to older versions of the repository.
  --force               Force upgrade
  --tam                 Enable manifest authentication (in key and cache)
                        (Borg 1.0.9 and later)
  --disable-tam         Disable manifest authentication (in key and cache)
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
Upgrade an existing Borg repository.
<h2 class="Ss" title="Ss" id="Borg_1.x.y_upgrades"><a class="selflink" href="#Borg_1.x.y_upgrades">Borg
  1.x.y upgrades</a></h2>
Use <b>borg upgrade --tam REPO</b> to require manifest authentication introduced
  with Borg 1.0.9 to address security issues. This means that modifying the
  repository after doing this with a version prior to 1.0.9 will raise a
  validation error, so only perform this upgrade after updating all clients
  using the repository to 1.0.9 or newer.
<div style="height: 1.00em;">&#x00A0;</div>
This upgrade should be done on each client for safety reasons.
<div style="height: 1.00em;">&#x00A0;</div>
If a repository is accidentally modified with a pre-1.0.9 client after this
  upgrade, use <b>borg upgrade --tam --force REPO</b> to remedy it.
<div style="height: 1.00em;">&#x00A0;</div>
If you routinely do this you might not want to enable this upgrade (which will
  leave you exposed to the security issue). You can reverse the upgrade by
  issuing <b>borg upgrade --disable-tam REPO</b>.
<div style="height: 1.00em;">&#x00A0;</div>
See
  <i>https://borgbackup.readthedocs.io/en/stable/changes.html#pre-1-0-9-manifest-spoofing-vulnerability</i>
  for details.
<h2 class="Ss" title="Ss" id="Attic_and_Borg_0.xx_to_Borg_1.x"><a class="selflink" href="#Attic_and_Borg_0.xx_to_Borg_1.x">Attic
  and Borg 0.xx to Borg 1.x</a></h2>
This currently supports converting an Attic repository to Borg and also helps
  with converting Borg 0.xx to 1.0.
<div style="height: 1.00em;">&#x00A0;</div>
Currently, only LOCAL repositories can be upgraded (issue #465).
<div style="height: 1.00em;">&#x00A0;</div>
It will change the magic strings in the repository's segments to match the new
  Borg magic strings. The keyfiles found in $ATTIC_KEYS_DIR or ~/.attic/keys/
  will also be converted and copied to $BORG_KEYS_DIR or ~/.config/borg/keys.
<div style="height: 1.00em;">&#x00A0;</div>
The cache files are converted, from $ATTIC_CACHE_DIR or ~/.cache/attic to
  $BORG_CACHE_DIR or ~/.cache/borg, but the cache layout between Borg and Attic
  changed, so it is possible the first backup after the conversion takes longer
  than expected due to the cache resync.
<div style="height: 1.00em;">&#x00A0;</div>
Upgrade should be able to resume if interrupted, although it will still iterate
  over all segments. If you want to start from scratch, use <i>borg delete</i>
  over the copied repository to make sure the cache files are also removed:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">borg delete borg</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Unless <b>--inplace</b> is specified, the upgrade process first creates a backup
  copy of the repository, in REPOSITORY.upgrade-DATETIME, using hardlinks. This
  takes longer than in place upgrades, but is much safer and gives progress
  information (as opposed to <b>cp -al</b>). Once you are satisfied with the
  conversion, you can safely destroy the backup copy.
<div style="height: 1.00em;">&#x00A0;</div>
WARNING: Running the upgrade in place will make the current copy unusable with
  older version, with no way of going back to previous versions. This can
  PERMANENTLY DAMAGE YOUR REPOSITORY! Attic CAN NOT READ BORG REPOSITORIES, as
  the magic strings have changed. You have been warned.
<h2 class="Ss" title="Ss" id="Examples"><a class="selflink" href="#Examples">Examples</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
# Upgrade the borg repository to the most recent version.
$ borg upgrade -v /path/to/repo
making a hardlink copy in /path/to/repo.upgrade-2016-02-15-20:51:55
opening attic repository with borg and converting
no key file found for repository
converting repo index /path/to/repo/index.0
converting 1 segments...
converting borg 0.xx to borg current
no key file found for repository
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Upgrading_a_passphrase_encrypted_attic_repo"><a class="selflink" href="#Upgrading_a_passphrase_encrypted_attic_repo">Upgrading
  a passphrase encrypted attic repo</a></h2>
attic offered a &quot;passphrase&quot; encryption mode, but this was removed in
  borg 1.0 and replaced by the &quot;repokey&quot; mode (which stores the
  passphrase-protected encryption key into the repository config).
<div style="height: 1.00em;">&#x00A0;</div>
Thus, to upgrade a &quot;passphrase&quot; attic repo to a &quot;repokey&quot;
  borg repo, 2 steps are needed, in this order:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">borg upgrade repo</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">borg migrate-to-repokey repo</dd>
</dl>
</div>
<br/>
<h1 class="Sh" title="Sh" id="BORG_BREAK-LOCK"><a class="selflink" href="#BORG_BREAK-LOCK">BORG
  BREAK-LOCK</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
usage: borg break-lock [-h] [--critical] [--error] [--warning] [--info]
                       [--debug] [--lock-wait N] [--show-rc]
                       [--no-files-cache] [--umask M] [--remote-path PATH]
                       [REPOSITORY]
<div class="Pp"></div>
Break the repository lock (e.g. in case it was left by a dead borg.
<div class="Pp"></div>
positional arguments:
  REPOSITORY            repository for which to break the locks
<div class="Pp"></div>
optional arguments:
  -h, --help            show this help message and exit
  --critical            work on log level CRITICAL
  --error               work on log level ERROR
  --warning             work on log level WARNING (default)
  --info, -v, --verbose
                        work on log level INFO
  --debug               work on log level DEBUG
  --lock-wait N         wait for the lock, but max. N seconds (default: 1).
  --show-rc             show/log the return code (rc)
  --no-files-cache      do not load/update the file metadata cache used to
                        detect unchanged files
  --umask M             set umask to M (local and remote, default: 0077)
  --remote-path PATH    set remote path to executable (default: &quot;borg&quot;)
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
This command breaks the repository and cache locks. Please use carefully and
  only while no borg process (on any machine) is trying to access the Cache or
  the Repository.
<h1 class="Sh" title="Sh" id="MISCELLANEOUS_HELP"><a class="selflink" href="#MISCELLANEOUS_HELP">MISCELLANEOUS
  HELP</a></h1>
<h2 class="Ss" title="Ss" id="borg_help_patterns"><a class="selflink" href="#borg_help_patterns">borg
  help patterns</a></h2>
Exclusion patterns support four separate styles, fnmatch, shell, regular
  expressions and path prefixes. By default, fnmatch is used. If followed by a
  colon (':') the first two characters of a pattern are used as a style
  selector. Explicit style selection is necessary when a non-default style is
  desired or when the desired pattern starts with two alphanumeric characters
  followed by a colon (i.e. <i>aa:something/*</i>).
<div style="height: 1.00em;">&#x00A0;</div>
<i>Fnmatch</i>, selector <i>fm:</i>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">This is the default style. These patterns use
  a variant of shell pattern syntax, with '*' matching any number of characters,
  '?' matching any single character, '[...]' matching any single character
  specified, including ranges, and '[!...]' matching any character not
  specified. For the purpose of these patterns, the path separator ('' for
  Windows and '/' on other systems) is not treated specially. Wrap
  meta-characters in brackets for a literal match (i.e. <i>[?]</i> to match the
  literal character <i>?</i>). For a path to match a pattern, it must completely
  match from start to end, or must match from the start to just before a path
  separator. Except for the root path, paths will never end in the path
  separator when matching is attempted. Thus, if a given pattern ends in a path
  separator, a '*' is appended before matching is attempted.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Shell-style patterns, selector <i>sh:</i>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">Like fnmatch patterns these are similar to
  shell patterns. The difference is that the pattern may include <i>**/</i> for
  matching zero or more directory levels, <i>*</i> for matching zero or more
  arbitrary characters with the exception of any path separator.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Regular expressions, selector <i>re:</i>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">Regular expressions similar to those found in
  Perl are supported. Unlike shell patterns regular expressions are not required
  to match the complete path and any substring match is sufficient. It is
  strongly recommended to anchor patterns to the start ('^'), to the end ('$')
  or both. Path separators ('' for Windows and '/' on other systems) in paths
  are always normalized to a forward slash ('/') before applying a pattern. The
  regular expression syntax is described in the <i>Python documentation for</i>
  <i>the re module</i>.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Prefix path, selector <i>pp:</i>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">This pattern style is useful to match whole
  sub-directories. The pattern <i>pp:/data/bar</i> matches <i>/data/bar</i> and
  everything therein.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Exclusions can be passed via the command line option <i>--exclude</i>. When used
  from within a shell the patterns should be quoted to protect them from
  expansion.
<div style="height: 1.00em;">&#x00A0;</div>
The <i>--exclude-from</i> option permits loading exclusion patterns from a text
  file with one pattern per line. Lines empty or starting with the number sign
  ('#') after removing whitespace on both ends are ignored. The optional style
  selector prefix is also supported for patterns loaded from a file. Due to
  whitespace removal paths with whitespace at the beginning or end can only be
  excluded using regular expressions.
<div style="height: 1.00em;">&#x00A0;</div>
Examples:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
# Exclude '/home/user/file.o' but not '/home/user/file.odt':
$ borg create -e '*.o' backup /
<div class="Pp"></div>
# Exclude '/home/user/junk' and '/home/user/subdir/junk' but
# not '/home/user/importantjunk' or '/etc/junk':
$ borg create -e '/home/*/junk' backup /
<div class="Pp"></div>
# Exclude the contents of '/home/user/cache' but not the directory itself:
$ borg create -e /home/user/cache/ backup /
<div class="Pp"></div>
# The file '/home/user/cache/important' is *not* backed up:
$ borg create -e /home/user/cache/ backup / /home/user/cache/important
<div class="Pp"></div>
# The contents of directories in '/home' are not backed up when their name
# ends in '.tmp'
$ borg create --exclude 're:^/home/[^/]+\.tmp/' backup /
<div class="Pp"></div>
# Load exclusions from file
$ cat &gt;exclude.txt &lt;&lt;EOF
# Comment line
/home/*/junk
*.tmp
fm:aa:something/*
re:^/home/[^/]\.tmp/
sh:/home/*/.thumbnails
EOF
$ borg create --exclude-from exclude.txt backup /
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="borg_help_placeholders"><a class="selflink" href="#borg_help_placeholders">borg
  help placeholders</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">Repository (or Archive) URLs, --prefix and
  --remote-path values support these placeholders:
<div style="height: 1.00em;">&#x00A0;</div>
{hostname}
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The (short) hostname of the machine.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
{fqdn}
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The full name of the machine.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
{now}
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The current local date and time.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
{utcnow}
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The current UTC date and time.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
{user}
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The user name (or UID, if no name is
  available) of the user running borg.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
{pid}
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The current process ID.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
{borgversion}
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The version of borg, e.g.: 1.0.8rc1</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
{borgmajor}
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The version of borg, only the major version,
  e.g.: 1</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
{borgminor}
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The version of borg, only major and minor
  version, e.g.: 1.0</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
{borgpatch}
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The version of borg, only major, minor and
  patch version, e.g.: 1.0.8</div>
<br/>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Examples:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
borg create /path/to/repo::{hostname}-{user}-{utcnow} ...
borg create /path/to/repo::{hostname}-{now:%Y-%m-%d_%H:%M:%S} ...
borg prune --prefix '{hostname}-' ...
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="DEBUG_COMMANDS"><a class="selflink" href="#DEBUG_COMMANDS">DEBUG
  COMMANDS</a></h1>
There are some more commands (all starting with &quot;debug-&quot;) which are
  all <b>not intended for normal use</b> and <b>potentially very dangerous</b>
  if used incorrectly.
<div style="height: 1.00em;">&#x00A0;</div>
For example, <b>borg debug-put-obj</b> and <b>borg debug-delete-obj</b> will
  only do what their name suggests: put objects into repo / delete objects from
  repo.
<div style="height: 1.00em;">&#x00A0;</div>
Please note:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">they will not update the chunks cache (chunks index) about
      the object</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">they will not update the manifest (so no automatic chunks
      index resync is triggered)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">they will not check whether the object is in use (e.g.
      before delete-obj)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">they will not update any metadata which may point to the
      object</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
They exist to improve debugging capabilities without direct system access, e.g.
  in case you ever run into some severe malfunction. Use them only if you know
  what you are doing or if a trusted Borg developer tells you what to do.
<h1 class="Sh" title="Sh" id="ADDITIONAL_NOTES"><a class="selflink" href="#ADDITIONAL_NOTES">ADDITIONAL
  NOTES</a></h1>
Here are misc. notes about topics that are maybe not covered in enough detail in
  the usage section.
<h2 class="Ss" title="Ss" id="Item_flags"><a class="selflink" href="#Item_flags">Item
  flags</a></h2>
<b>borg create -v --list</b> outputs a verbose list of all files, directories
  and other file system items it considered (no matter whether they had content
  changes or not). For each item, it prefixes a single-letter flag that
  indicates type and/or status of the item.
<div style="height: 1.00em;">&#x00A0;</div>
If you are interested only in a subset of that output, you can give e.g.
  <b>--filter=AME</b> and it will only show regular files with A, M or E status
  (see below).
<div style="height: 1.00em;">&#x00A0;</div>
A uppercase character represents the status of a regular file relative to the
  &quot;files&quot; cache (not relative to the repo -- this is an issue if the
  files cache is not used). Metadata is stored in any case and for 'A' and 'M'
  also new data chunks are stored. For 'U' all data chunks refer to already
  existing chunks.
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">'A' = regular file, added (see also a_status_oddity in the
      FAQ)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">'M' = regular file, modified</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">'U' = regular file, unchanged</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">'E' = regular file, an error happened while
      accessing/reading <i>this</i> file</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
A lowercase character means a file type other than a regular file, borg usually
  just stores their metadata:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">'d' = directory</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">'b' = block device</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">'c' = char device</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">'h' = regular file, hardlink (to already seen inodes)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">'s' = symlink</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">'f' = fifo</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Other flags used include:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">'i' = backup data was read from standard input (stdin)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">'-' = dry run, item was <i>not</i> backed up</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">'?' = missing status code (if you see this, please file a
      bug report!)</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="--chunker-params"><a class="selflink" href="#--chunker-params">--chunker-params</a></h2>
The chunker params influence how input files are cut into pieces (chunks) which
  are then considered for deduplication. They also have a big impact on resource
  usage (RAM and disk space) as the amount of resources needed is (also)
  determined by the total amount of chunks in the repository (see <i>Indexes /
  Caches memory usage</i> for details).
<div style="height: 1.00em;">&#x00A0;</div>
<b>--chunker-params=10,23,16,4095</b> results in a fine-grained deduplication
  and creates a big amount of chunks and thus uses a lot of resources to manage
  them. This is good for relatively small data volumes and if the machine has a
  good amount of free RAM and disk space.
<div style="height: 1.00em;">&#x00A0;</div>
<b>--chunker-params=19,23,21,4095</b> (default) results in a coarse-grained
  deduplication and creates a much smaller amount of chunks and thus uses less
  resources. This is good for relatively big data volumes and if the machine has
  a relatively low amount of free RAM and disk space.
<div style="height: 1.00em;">&#x00A0;</div>
If you already have made some archives in a repository and you then change
  chunker params, this of course impacts deduplication as the chunks will be cut
  differently.
<div style="height: 1.00em;">&#x00A0;</div>
In the worst case (all files are big and were touched in between backups), this
  will store all content into the repository again.
<div style="height: 1.00em;">&#x00A0;</div>
Usually, it is not that bad though:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">usually most files are not touched, so it will just re-use
      the old chunks it already has in the repo</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">files smaller than the (both old and new) minimum chunksize
      result in only one chunk anyway, so the resulting chunks are same and
      deduplication will apply</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
If you switch chunker params to save resources for an existing repo that already
  has some backup archives, you will see an increasing effect over time, when
  more and more files have been touched and stored again using the bigger
  chunksize <b>and</b> all references to the smaller older chunks have been
  removed (by deleting / pruning archives).
<div style="height: 1.00em;">&#x00A0;</div>
If you want to see an immediate big effect on resource usage, you better start a
  new repository when changing chunker params.
<div style="height: 1.00em;">&#x00A0;</div>
For more details, see chunker_details.
<h2 class="Ss" title="Ss" id="--umask"><a class="selflink" href="#--umask">--umask</a></h2>
If you use <b>--umask</b>, make sure that all repository-modifying borg commands
  (create, delete, prune) that access the repository in question use the same
  <b>--umask</b> value.
<div style="height: 1.00em;">&#x00A0;</div>
If multiple machines access the same repository, this should hold true for all
  of them.
<h2 class="Ss" title="Ss" id="--read-special"><a class="selflink" href="#--read-special">--read-special</a></h2>
The --read-special option is special - you do not want to use it for normal
  full-filesystem backups, but rather after carefully picking some targets for
  it.
<div style="height: 1.00em;">&#x00A0;</div>
The option <b>--read-special</b> triggers special treatment for block and char
  device files as well as FIFOs. Instead of storing them as such a device (or
  FIFO), they will get opened, their content will be read and in the backup
  archive they will show up like a regular file.
<div style="height: 1.00em;">&#x00A0;</div>
Symlinks will also get special treatment if (and only if) they point to such a
  special file: instead of storing them as a symlink, the target special file
  will get processed as described above.
<div style="height: 1.00em;">&#x00A0;</div>
One intended use case of this is backing up the contents of one or multiple
  block devices, like e.g. LVM snapshots or inactive LVs or disk partitions.
<div style="height: 1.00em;">&#x00A0;</div>
You need to be careful about what you include when using <b>--read-special</b>,
  e.g. if you include <b>/dev/zero</b>, your backup will never terminate.
<div style="height: 1.00em;">&#x00A0;</div>
Restoring such files' content is currently only supported one at a time via
  <b>--stdout</b> option (and you have to redirect stdout to where ever it shall
  go, maybe directly into an existing device file of your choice or indirectly
  via <b>dd</b>).
<div style="height: 1.00em;">&#x00A0;</div>
To some extent, mounting a backup archive with the backups of special files via
  <b>borg mount</b> and then loop-mounting the image files from inside the mount
  point will work. If you plan to access a lot of data in there, it likely will
  scale and perform better if you do not work via the FUSE mount.
<h2 class="Ss" title="Ss" id="Example"><a class="selflink" href="#Example">Example</a></h2>
Imagine you have made some snapshots of logical volumes (LVs) you want to
  backup.
<div style="height: 1.00em;">&#x00A0;</div>
<b>NOTE:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">For some scenarios, this is a good method to
  get &quot;crash-like&quot; consistency (I call it crash-like because it is the
  same as you would get if you just hit the reset button or your machine would
  abrubtly and completely crash). This is better than no consistency at all and
  a good method for some use cases, but likely not good enough if you have
  databases running.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Then you create a backup archive of all these snapshots. The backup process will
  see a &quot;frozen&quot; state of the logical volumes, while the processes
  working in the original volumes continue changing the data stored there.
<div style="height: 1.00em;">&#x00A0;</div>
You also add the output of <b>lvdisplay</b> to your backup, so you can see the
  LV sizes in case you ever need to recreate and restore them.
<div style="height: 1.00em;">&#x00A0;</div>
After the backup has completed, you remove the snapshots again.
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ # create snapshots here
$ lvdisplay &gt; lvdisplay.txt
$ borg create --read-special /path/to/repo::arch lvdisplay.txt /dev/vg0/*-snapshot
$ # remove snapshots here
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Now, let's see how to restore some LVs from such a backup.
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ borg extract /path/to/repo::arch lvdisplay.txt
$ # create empty LVs with correct sizes here (look into lvdisplay.txt).
$ # we assume that you created an empty root and home LV and overwrite it now:
$ borg extract --stdout /path/to/repo::arch dev/vg0/root-snapshot &gt; /dev/vg0/root
$ borg extract --stdout /path/to/repo::arch dev/vg0/home-snapshot &gt; /dev/vg0/home
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Append-only_mode"><a class="selflink" href="#Append-only_mode">Append-only
  mode</a></h2>
A repository can be made &quot;append-only&quot;, which means that Borg will
  never overwrite or delete committed data. This is useful for scenarios where
  multiple machines back up to a central backup server using <b>borg serve</b>,
  since a hacked machine cannot delete backups permanently.
<div style="height: 1.00em;">&#x00A0;</div>
To activate append-only mode, edit the repository <b>config</b> file and add a
  line <b>append_only=1</b> to the <b>[repository]</b> section (or edit the line
  if it exists).
<div style="height: 1.00em;">&#x00A0;</div>
In append-only mode Borg will create a transaction log in the
  <b>transactions</b> file, where each line is a transaction and a UTC
  timestamp.
<div style="height: 1.00em;">&#x00A0;</div>
In addition, <b>borg serve</b> can act as if a repository is in append-only mode
  with its option <b>--append-only</b>. This can be very useful for fine-tuning
  access control in <b>.ssh/authorized_keys</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
command=&quot;borg serve --append-only ...&quot; ssh-rsa &lt;key used for not-always-trustable backup clients&gt;
command=&quot;borg serve ...&quot; ssh-rsa &lt;key used for backup management&gt;
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Example"><a class="selflink" href="#Example">Example</a></h2>
Suppose an attacker remotely deleted all backups, but your repository was in
  append-only mode. A transaction log in this situation might look like this:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
transaction 1, UTC time 2016-03-31T15:53:27.383532
transaction 5, UTC time 2016-03-31T15:53:52.588922
transaction 11, UTC time 2016-03-31T15:54:23.887256
transaction 12, UTC time 2016-03-31T15:55:54.022540
transaction 13, UTC time 2016-03-31T15:55:55.472564
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
From your security logs you conclude the attacker gained access at 15:54:00 and
  all the backups where deleted or replaced by compromised backups. From the log
  you know that transactions 11 and later are compromised. Note that the
  transaction ID is the name of the <i>last</i> file in the transaction. For
  example, transaction 11 spans files 6 to 11.
<div style="height: 1.00em;">&#x00A0;</div>
In a real attack you'll likely want to keep the compromised repository intact to
  analyze what the attacker tried to achieve. It's also a good idea to make this
  copy just in case something goes wrong during the recovery. Since recovery is
  done by deleting some files, a hard link copy ( <b>cp -al</b>) is sufficient.
<div style="height: 1.00em;">&#x00A0;</div>
The first step to reset the repository to transaction 5, the last uncompromised
  transaction, is to remove the <b>hints.N</b> and <b>index.N</b> files in the
  repository (these two files are always expendable). In this example N is 13.
<div style="height: 1.00em;">&#x00A0;</div>
Then remove or move all segment files from the segment directories in
  <b>data/</b> starting with file 6:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
rm data/**/{6..13}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
That's all to it.
<h2 class="Ss" title="Ss" id="Drawbacks"><a class="selflink" href="#Drawbacks">Drawbacks</a></h2>
As data is only appended, and nothing removed, commands like <b>prune</b> or
  <b>delete</b> won't free disk space, they merely tag data as deleted in a new
  transaction.
<div style="height: 1.00em;">&#x00A0;</div>
Be aware that as soon as you write to the repo in non-append-only mode (e.g.
  prune, delete or create archives from an admin machine), it will remove the
  deleted objects permanently (including the ones that were already marked as
  deleted, but not removed, in append-only mode).
<div style="height: 1.00em;">&#x00A0;</div>
Note that you can go back-and-forth between normal and append-only operation by
  editing the configuration file, it's not a &quot;one way trip&quot;.
<h2 class="Ss" title="Ss" id="Further_considerations"><a class="selflink" href="#Further_considerations">Further
  considerations</a></h2>
Append-only mode is not respected by tools other than Borg. <b>rm</b> still
  works on the repository. Make sure that backup client machines only get to
  access the repository via <b>borg serve</b>.
<div style="height: 1.00em;">&#x00A0;</div>
Ensure that no remote access is possible if the repository is temporarily set to
  normal mode for e.g. regular pruning.
<div style="height: 1.00em;">&#x00A0;</div>
Further protections can be implemented, but are outside of Borgs scope. For
  example, file system snapshots or wrapping <b>borg serve</b> to set special
  permissions or ACLs on new data files.
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
The Borg Collective (see AUTHORS file)
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
2010-2017 Jonas Borgstr&#x00F6;m, 2015-2016 The Borg Collective (see AUTHORS
  file)</div>
<table class="foot">
  <tr>
    <td class="foot-date">2017-02-21</td>
    <td class="foot-os">1.0.10</td>
  </tr>
</table>
</body>
</html>
