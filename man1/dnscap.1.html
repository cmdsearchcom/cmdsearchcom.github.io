<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>DNSCAP(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DNSCAP(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">DNSCAP(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<b class="Nm" title="Nm">dnscap</b> &#x2014; <span class="Nd" title="Nd">DNS
  network traffic capture utility</span>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<table class="Nm">
  <tr>
    <td><b class="Nm" title="Nm">dnscap</b></td>
    <td>[<span class="Op"><b class="Fl" title="Fl">-pd1g?6fT</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-i</b>
      <var class="Ar" title="Ar">if ...</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-r</b>
      <var class="Ar" title="Ar">file ...</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-l</b>
      <var class="Ar" title="Ar">vlan ...</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-L</b>
      <var class="Ar" title="Ar">vlan ...</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-x</b>
      <var class="Ar" title="Ar">pat ...</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-X</b>
      <var class="Ar" title="Ar">pat ...</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-m</b>
      [<span class="Op">qun</span>]</span>]
      [<span class="Op"><b class="Fl" title="Fl">-s</b>
      [<span class="Op">ir</span>]</span>]
      [<span class="Op"><b class="Fl" title="Fl">-h</b>
      [<span class="Op">ir</span>]</span>]
      [<span class="Op"><b class="Fl" title="Fl">-e</b>
      [<span class="Op">nytfsxir</span>]</span>]
      [<span class="Op"><b class="Fl" title="Fl">-a</b>
      <var class="Ar" title="Ar">host ...</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-z</b>
      <var class="Ar" title="Ar">host ...</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-A</b>
      <var class="Ar" title="Ar">host ...</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-Z</b>
      <var class="Ar" title="Ar">host ...</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-Y</b>
      <var class="Ar" title="Ar">host ...</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-u</b>
      <var class="Ar" title="Ar">port</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-w</b>
      <var class="Ar" title="Ar">base</var>
      [<span class="Op"><b class="Fl" title="Fl">-k</b>
      <var class="Ar" title="Ar">cmd</var></span>]</span>]
      [<span class="Op"><b class="Fl" title="Fl">-t</b>
      <var class="Ar" title="Ar">lim</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-c</b>
      <var class="Ar" title="Ar">lim</var></span>]</td>
  </tr>
</table>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b class="Nm" title="Nm">dnscap</b> is a network capture utility designed
  specifically for DNS traffic. It normally produces binary data in
  <a class="Xr" title="Xr">pcap(3)</a> format, either on standard output or in
  successive dump files (based on the <b class="Fl" title="Fl">-w</b> command
  line option). This utility is similar to
  <a class="Xr" title="Xr">tcpdump(1)</a>, but has finer grained packet
  recognition tailored to DNS transactions and protocol options.
  <b class="Nm" title="Nm">dnscap</b> is expected to be used for gathering
  continuous research or audit traces.
<div class="Pp"></div>
The following options are available:
<dl class="Bl-tag" style="margin-left: 15.00ex;">
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#p"><b class="Fl" title="Fl" id="p">-p</b></a></dt>
  <dd class="It-tag">Asks that the interface not be put into promiscuous mode.
      Note that even without this option, the interface could be in promiscuous
      mode for some other reason.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#d"><b class="Fl" title="Fl" id="d">-d</b></a></dt>
  <dd class="It-tag">Tells a verbose story of options and patterns chosen, files
      opened, and so on. (Multiple <b class="Fl" title="Fl">-d</b> options can
      be given to increase verbosity and frequency of trace messages.)</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#1"><b class="Fl" title="Fl" id="1">-1</b></a></dt>
  <dd class="It-tag">Flush the <a class="Xr" title="Xr">pcap(3)</a> packet dump
      after every packet. Mostly this is useful when the packet dump is standard
      output, and has been piped to
    <a class="Xr" title="Xr">tcpdump(1)</a>.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#g"><b class="Fl" title="Fl" id="g">-g</b></a></dt>
  <dd class="It-tag">Produce output on diagnostic output, showing the
      presentation form of DNS messages which passed through all of the filters.
      If <b class="Fl" title="Fl">-w</b> is also used, then every message will
      be dumped in both binary and presentation form.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><b class="Fl" title="Fl">-</b>?</dt>
  <dd class="It-tag">Prints some text to stdout describing the command line
      options, so that you won't have to refer back to this man page as often.
      Probably you will have to say &quot;-\?&quot; to get this option past your
      shell.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#6"><b class="Fl" title="Fl" id="6">-6</b></a></dt>
  <dd class="It-tag">Suppress the use of packet filter patterns that are known
      (as of 2007) to cause problems when processing IPv6 packets. Recommended
      when IPv6 traffic is expected to be present.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#f"><b class="Fl" title="Fl" id="f">-f</b></a></dt>
  <dd class="It-tag">Selects fragments (which could include unrelated flows
      since fragments do not contain port numbers), and includes fragments in
      the binary output. Necessary if you intend to do IP Reassembly. Note that
      all fragments will be collected, not just those using the DNS port number,
      since fragments don't have port numbers. Beware this option if you also
      handle a lot of NFS traffic.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#T"><b class="Fl" title="Fl" id="T">-T</b></a></dt>
  <dd class="It-tag">Selects TCP packets. SYN, FIN, and RST packets are
      collected if they pass the layer 2, port, and host filters (although hosts
      need not be in the correct direction); they are not tested against filter
      options that require a DNS header such as <b class="Fl" title="Fl">-m</b>,
      <b class="Fl" title="Fl">-s</b>, and <b class="Fl" title="Fl">-e</b>. The
      first DNS header in the stream is captured if it passes all filter
      options. All subsequent non-empty packets in the stream, regardless of DNS
      message boundaries, will be captured if and only if the first DNS header
      passed all filter options. TCP packets will usually not be printable with
      <b class="Fl" title="Fl">-g</b>.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#i"><b class="Fl" title="Fl" id="i">-i</b></a>
    <var class="Ar" title="Ar">if</var></dt>
  <dd class="It-tag">Select an interface to be monitored. On BSD systems, the
      default is the first interface that was configured at system boot time. On
      Linux systems, the default is to monitor all interfaces. More than one
      interface may be selected which will cause output to be interleaved from
      all selected interfaces.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#r"><b class="Fl" title="Fl" id="r">-r</b></a>
    <var class="Ar" title="Ar">file</var></dt>
  <dd class="It-tag">Select an offline <a class="Xr" title="Xr">pcap(3)</a> file
      produced by this utility or by <a class="Xr" title="Xr">tcpdump(1)</a> as
      the input packet source. Can be given as &quot;-&quot; to indicate
      standard input.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#l"><b class="Fl" title="Fl" id="l">-l</b></a>
    <var class="Ar" title="Ar">vlan</var></dt>
  <dd class="It-tag">Captures only 802.1Q encapsulated packets, and selects
      specific vlans to be monitored. Can be specified more than once to select
      multiple vlans. <b class="Fl" title="Fl">-l</b>
      <var class="Ar" title="Ar">0</var> means &quot;all vlans&quot;.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#L"><b class="Fl" title="Fl" id="L">-L</b></a>
    <var class="Ar" title="Ar">vlan</var></dt>
  <dd class="It-tag">Captures 802.1Q encapsulated packets matching the specified
      vlans AND packets without VLAN tags. Can be specified more than one to
      select multiple vlans. <b class="Fl" title="Fl">-L</b>
      <var class="Ar" title="Ar">0</var> means &quot;all vlans&quot;.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#u"><b class="Fl" title="Fl" id="u">-u</b></a>
    <var class="Ar" title="Ar">port</var></dt>
  <dd class="It-tag">Capture only packets on this UDP port, and treat as DNS
      traffic. The default port is 53. Note that there is no way to select
      multiple UDP ports, as would be necessary to capture both DNS (port 53)
      and mDNS (port 5353) traffic.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#x"><b class="Fl" title="Fl" id="x">-x</b></a>
    <var class="Ar" title="Ar">pat</var></dt>
  <dd class="It-tag">If one or more <b class="Fl" title="Fl">-x</b> options are
      provided, then DNS messages will only be selected if the printable
      representation of the QNAME or any RR matches at least one of the provided
      <var class="Ar" title="Ar">pat</var> patterns. See
      <a class="Xr" title="Xr">regex(3)</a> and
      <a class="Xr" title="Xr">re_format(7)</a> for more information about
      extended regular expression syntax.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#X"><b class="Fl" title="Fl" id="X">-X</b></a>
    <var class="Ar" title="Ar">pat</var></dt>
  <dd class="It-tag">If one or more <b class="Fl" title="Fl">-X</b> options are
      provided, then DNS messages matching these patterns will not be selected.
      See the description of <b class="Fl" title="Fl">-x</b> above.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#m"><b class="Fl" title="Fl" id="m">-m</b></a>
    [<span class="Op">qun</span>]</dt>
  <dd class="It-tag">Capture only messages of designated types (query, update,
      and notify). Default is query.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#s"><b class="Fl" title="Fl" id="s">-s</b></a>
    [<span class="Op">ir</span>]</dt>
  <dd class="It-tag">Select messages which are initiations and/or responses.
      Default is both.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#h"><b class="Fl" title="Fl" id="h">-h</b></a>
    [<span class="Op">ir</span>]</dt>
  <dd class="It-tag">Hide initiator or responder of each captured transaction.
      Hiding an initiator means wiping out the address and port number. Hiding a
      responder means to wipe out the address only. This wiping occurs on the
      copy of the packet sent to the <a class="Xr" title="Xr">pcap(3)</a> dump
      output, and both the IP and UDP checksums will be recomputed in that
    case.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#e"><b class="Fl" title="Fl" id="e">-e</b></a>
    [<span class="Op">nytfsxir</span>]</dt>
  <dd class="It-tag">Among responses, consider nonzero DNS TC or DNS RCODE to
      indicate an error, and select only responses which do not have (n), or
      which have (y), these conditions. The default is to only select nonerrors
      among responses. If both nonerror and error responses are to be selected,
      specify both the <var class="Ar" title="Ar">n</var> and
      <var class="Ar" title="Ar">y</var> options here. To be more specific, use
      one or more condition-specific options, as follows:
    <div style="height: 1.00em;">&#x00A0;</div>
    <div class="Bl-tag" style="margin-left: 6.00ex;">
    <dl class="Bl-tag Bl-compact">
      <dt class="It-tag"><var class="Va" title="Va">n</var></dt>
      <dd class="It-tag">no error</dd>
      <dt class="It-tag"><var class="Va" title="Va">y</var></dt>
      <dd class="It-tag">some error</dd>
      <dt class="It-tag"><var class="Va" title="Va">t</var></dt>
      <dd class="It-tag">truncated response (TC bit)</dd>
      <dt class="It-tag"><var class="Va" title="Va">f</var></dt>
      <dd class="It-tag">format error (rcode 1)</dd>
      <dt class="It-tag"><var class="Va" title="Va">s</var></dt>
      <dd class="It-tag">server failure (rcode 2)</dd>
      <dt class="It-tag"><var class="Va" title="Va">x</var></dt>
      <dd class="It-tag">no such name (rcode 3)</dd>
      <dt class="It-tag"><var class="Va" title="Va">i</var></dt>
      <dd class="It-tag">not implemented (rcode 4)</dd>
      <dt class="It-tag"><var class="Va" title="Va">r</var></dt>
      <dd class="It-tag">refusal (rcode 5)</dd>
    </dl>
    </div>
  </dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#a"><b class="Fl" title="Fl" id="a">-a</b></a>
    <var class="Ar" title="Ar">host</var></dt>
  <dd class="It-tag">Capture only transactions having these initiators. Can be
      specified more than once to select multiple initiators. If a host name is
      used, then all of that host's addresses whether IPv4 or IPv6 are added to
      the recognition pattern.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#z"><b class="Fl" title="Fl" id="z">-z</b></a>
    <var class="Ar" title="Ar">host</var></dt>
  <dd class="It-tag">Capture only transactions having these responders. Can be
      specified more than once to select multiple responders. If a host name is
      used, then all of that host's addresses whether IPv4 or IPv6 are added to
      the recognition pattern.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#A"><b class="Fl" title="Fl" id="A">-A</b></a>
    <var class="Ar" title="Ar">host</var></dt>
  <dd class="It-tag">Capture only transactions NOT having these initiators.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#Z"><b class="Fl" title="Fl" id="Z">-Z</b></a>
    <var class="Ar" title="Ar">host</var></dt>
  <dd class="It-tag">Capture only transactions NOT having these responders.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#Y"><b class="Fl" title="Fl" id="Y">-Y</b></a>
    <var class="Ar" title="Ar">host</var></dt>
  <dd class="It-tag">Drop responses having these responders. Similar to
      <b class="Fl" title="Fl">-Z</b> in spirit. However,
      <b class="Fl" title="Fl">-Y</b> applies only to responses and does not
      cause any additions to the BPF filter string.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#w"><b class="Fl" title="Fl" id="w">-w</b></a>
    <var class="Ar" title="Ar">base</var></dt>
  <dd class="It-tag">Dump the captured packets to successive binary files in
      <a class="Xr" title="Xr">pcap(3)</a> format with DLT_RAW datalink type.
      Each file will have a name like &quot;%s.%u.%06u&quot; where %s is
      <var class="Ar" title="Ar">base</var>, %u is the time in seconds, and %06u
      is the time in microseconds. The argument &quot;-&quot; may be given to
      send the binary output to standard output. In that case, the
      <b class="Fl" title="Fl">-c</b> and <b class="Fl" title="Fl">-t</b>
      options affect the total duration of the capture, and not merely the size
      and time limits of each individual dump file.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#k"><b class="Fl" title="Fl" id="k">-k</b></a>
    <var class="Ar" title="Ar">cmd</var></dt>
  <dd class="It-tag">After each dump file specified by
      <b class="Fl" title="Fl">-w</b> is closed, this command will be executed
      in a nonblocking subprocess with the file name as its one argument. It's
      expected that this command will be a shell script that submits the
      finished file to a batch processing analytics system. Note that without
      <b class="Fl" title="Fl">-k</b>, the program will exit at the first output
      closure due to <b class="Fl" title="Fl">-c</b> or
      <b class="Fl" title="Fl">-t</b>.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#t"><b class="Fl" title="Fl" id="t">-t</b></a>
    <var class="Ar" title="Ar">lim</var></dt>
  <dd class="It-tag">By default, <b class="Nm" title="Nm">dnscap</b> will close
      its packet dump file only when interrupted. A time limit can be specified
      with the <b class="Fl" title="Fl">-t</b> option. When writing to a file,
      the packet dump file will be closed when time() %
      <var class="Ar" title="Ar">lim</var> is zero and the first file will
      usually be shorter than <var class="Ar" title="Ar">lim</var> seconds. If
      the packet dump file is standard output, then after closing this file,
      <b class="Nm" title="Nm">dnscap</b> exits. This option is inclusive with
      <b class="Fl" title="Fl">-c</b>.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#c"><b class="Fl" title="Fl" id="c">-c</b></a>
    <var class="Ar" title="Ar">lim</var></dt>
  <dd class="It-tag">By default, <b class="Nm" title="Nm">dnscap</b> will close
      its packet dump file only when interrupted. A dump file size, measured in
      packets, can be specified with the <b class="Fl" title="Fl">-c</b> option.
      If the packet dump file is standard output, then after closing this file,
      <b class="Nm" title="Nm">dnscap</b> exits. This option is inclusive with
      <b class="Fl" title="Fl">-t</b>.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#B"><b class="Fl" title="Fl" id="B">-B</b></a>
    <var class="Ar" title="Ar">datetime</var></dt>
  <dd class="It-tag">When using <b class="Fl" title="Fl">-w</b>, the
      <b class="Fl" title="Fl">-B</b> option tells
      <b class="Nm" title="Nm">dnscap</b> to start collecting at a specific
      time. <var class="Ar" title="Ar">datetime</var> should be specified as
      YYYY-MM-DD HH:MM:SS. The program will
      <a class="Xr" title="Xr">sleep(3)</a> until the start time, and then begin
      capturing packets.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#E"><b class="Fl" title="Fl" id="E">-E</b></a>
    <var class="Ar" title="Ar">datetime</var></dt>
  <dd class="It-tag">When using <b class="Fl" title="Fl">-w</b> and
      <b class="Fl" title="Fl">-t</b>, the <b class="Fl" title="Fl">-E</b>
      option tells <b class="Nm" title="Nm">dnscap</b> to stop collecting at a
      specific time. <var class="Ar" title="Ar">datetime</var> should be
      specified as YYYY-MM-DD HH:MM:SS. The program will exit when it sees a
      packet with timestamp greater than
      <var class="Ar" title="Ar">datetime</var>.</dd>
  <dt class="It-tag" style="margin-left: -15.00ex;"><a class="selflink" href="#S"><b class="Fl" title="Fl" id="S">-S</b></a></dt>
  <dd class="It-tag">Causes <b class="Nm" title="Nm">dnscap</b> to print
      pcap_stats() counters on stderr when <b class="Fl" title="Fl">-t</b> or
      <b class="Fl" title="Fl">-c</b> limits are reached.</dd>
</dl>
<div class="Pp"></div>
If started with no options, <b class="Nm" title="Nm">dnscap</b> will exit with a
  complaint that without either the <b class="Fl" title="Fl">-w</b> or
  <b class="Fl" title="Fl">-g</b> options, it's pointless to run the program at
  all. In its simplest form, the output can be piped to
  <a class="Xr" title="Xr">tcpdump(1)</a> as in:
<div class="Pp"></div>
<div class="Bd" style="margin-left: 5.00ex;">
<pre class="Li">
dnscap -w - | tcpdump -r -
</pre>
</div>
<div class="Pp"></div>
You can safely add the <b class="Fl" title="Fl">-d</b> option since the output
  resulting from <b class="Fl" title="Fl">-d</b> goes to diagnostic output
  rather than standard output. And since everybody who's anybody always uses the
  <b class="Fl" title="Fl">-n</b> option to
  <a class="Xr" title="Xr">tcpdump(1)</a>, the minimum useful incantation is
  probably:
<div class="Pp"></div>
<div class="Bd" style="margin-left: 5.00ex;">
<pre class="Li">
dnscap -w - | tcpdump -r - -n
</pre>
</div>
<div class="Pp"></div>
The more interesting use for <b class="Nm" title="Nm">dnscap</b> is long term or
  continuous data collection. Assuming a shell script called
  <var class="Ar" title="Ar">dnscap-upload</var> whose function is to transfer a
  <a class="Xr" title="Xr">pcap(3)</a> - format file to an analytics system and
  then remove the local copy of it, then a name server operating system startup
  could invoke <b class="Nm" title="Nm">dnscap</b> for continuous DNS auditing
  using a command like:
<div class="Pp"></div>
<div class="Bd" style="margin-left: 5.00ex;">
<pre class="Li">
dnscap -m qun -h i -r f.root-servers.net \ 
       -b /var/local/dnscaps/f-root -t 1800 \ 
       -k /usr/local/sbin/dnscap-upload
</pre>
</div>
<div class="Pp"></div>
A bizarre but actual example which combines almost all features of
  <b class="Nm" title="Nm">dnscap</b> is:
<div class="Pp"></div>
<div class="Bd" style="margin-left: 5.00ex;">
<pre class="Li">
dnscap -d -w - -1 -i em0 -l 0 -x ^7 | \ 
       dnscap -d -r - -X spamhaus -g -l 0
</pre>
</div>
<div class="Pp"></div>
Here, we're looking for all messages having a QNAME or RR beginning with the
  decimal digit &quot;7&quot;, but we don't want to see anything containing
  &quot;spamhaus&quot;. The interface is tagged, and since only one interface is
  selected, the output stream from the first <b class="Nm" title="Nm">dnscap</b>
  will also be tagged, thus we need <b class="Fl" title="Fl">-l</b>
  <var class="Ar" title="Ar">0</var> on both <b class="Nm" title="Nm">dnscap</b>
  commands.
<h1 class="Sh" title="Sh" id="COMPATIBILITY_NOTES"><a class="selflink" href="#COMPATIBILITY_NOTES">COMPATIBILITY
  NOTES</a></h1>
If <b class="Nm" title="Nm">dnscap</b> produces no output, it's probably due to
  some kind of bug in your kernel's <a class="Xr" title="Xr">bpf(4)</a> module
  or in your <a class="Xr" title="Xr">pcap(3)</a> library. You may need the
  <b class="Fl" title="Fl">-6</b> or <b class="Fl" title="Fl">-l</b>
  <var class="Ar" title="Ar">0</var> options. To diagnose your way out of
  &quot;no output&quot; hell, use the <b class="Fl" title="Fl">-d</b> and
  <b class="Fl" title="Fl">-g</b> options to find out what BPF program is being
  internally generated, and then cut/paste this BPF program onto a
  <a class="Xr" title="Xr">tcpdump(1)</a> command line to see if it likewise
  produces no output.
<h1 class="Sh" title="Sh" id="DIAGNOSTICS"><a class="selflink" href="#DIAGNOSTICS">DIAGNOSTICS</a></h1>
The <b class="Nm" title="Nm">dnscap</b> utility exits&#x00A0;0 on success,
  and&#x00A0;&gt;0 if an error occurs.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<a class="Xr" title="Xr">tcpdump(1)</a>,
  <a class="Xr" title="Xr">ncaptool(1)</a>,
  <a class="Xr" title="Xr">pcap(3)</a>, <a class="Xr" title="Xr">bpf(4)</a>
<h1 class="Sh" title="Sh" id="HISTORY"><a class="selflink" href="#HISTORY">HISTORY</a></h1>
<b class="Nm" title="Nm">dnscap</b> was written by Paul Vixie (ISC) with help
  from Duane Wessels, Kevin Brintnall, and others too numerous to mention.
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Ought to handle fragmented UDP.
<div class="Pp"></div>
Ought to be re-implented as a <a class="Xr" title="Xr">ncap</a> client.
<div class="Pp"></div>
Too many design botches within <a class="Xr" title="Xr">bpf(4)</a> and
  <a class="Xr" title="Xr">pcap(3)</a> are made visible to the user of this
  utility.
<h1 class="Sh" title="Sh" id="LICENSE"><a class="selflink" href="#LICENSE">LICENSE</a></h1>
Copyright (c) 2007 by Internet Systems Consortium, Inc. (&quot;ISC&quot;)
<div class="Pp"></div>
Permission to use, copy, modify, and/or distribute this software for any purpose
  with or without fee is hereby granted, provided that the above copyright
  notice and this permission notice appear in all copies.
<div class="Pp"></div>
THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND ISC DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL ISC BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.</div>
<table class="foot">
  <tr>
    <td class="foot-date">April 25, 2007</td>
    <td class="foot-os">Linux 4.12.14-300.fc26.x86_64</td>
  </tr>
</table>
</body>
</html>
