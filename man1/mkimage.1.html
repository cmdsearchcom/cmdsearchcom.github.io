<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>MKIMAGE(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">MKIMAGE(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">MKIMAGE(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
mkimage - Generate image for U-Boot
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>mkimage</b> -l [<b>uimage file name</b>]
<div style="height: 1.00em;">&#x00A0;</div>
<b>mkimage</b> [ <i>options</i>]<b> -f [</b>image tree source file<b>]</b>
  [<b>uimage file name</b>]
<div style="height: 1.00em;">&#x00A0;</div>
<b>mkimage</b> [ <i>options</i>]<b> -F [</b>uimage file name<b>]</b>
<div style="height: 1.00em;">&#x00A0;</div>
<b>mkimage</b> [ <i>options</i>]<b> (legacy mode)</b>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <b>mkimage</b> command is used to create images for use with the U-Boot boot
  loader. These images can contain the linux kernel, device tree blob, root file
  system image, firmware images etc., either separate or combined.
<div style="height: 1.00em;">&#x00A0;</div>
<b>mkimage</b> supports two different formats:
<div style="height: 1.00em;">&#x00A0;</div>
The old <i>legacy image</i> format concatenates the individual parts (for
  example, kernel image, device tree blob and ramdisk image) and adds a 64 bytes
  header containing information about target architecture, operating system,
  image type, compression method, entry points, time stamp, checksums, etc.
<div style="height: 1.00em;">&#x00A0;</div>
The new <i>FIT (Flattened Image Tree) format</i> allows for more flexibility in
  handling images of various types and also enhances integrity protection of
  images with stronger checksums. It also supports verified boot.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<b>List image information:</b>
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l [</b><i>uimage file name</i><b>]</b></dt>
  <dd class="It-tag">mkimage lists the information contained in the header of an
      existing U-Boot image.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<div class="Pp"></div>
<b>Create old legacy image:</b>
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-A [</b><i>architecture</i><b>]</b></dt>
  <dd class="It-tag">Set architecture. Pass -h as the architecture to see the
      list of supported architectures.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-O [</b><i>os</i><b>]</b></dt>
  <dd class="It-tag">Set operating system. bootm command of u-boot changes boot
      method by os type. Pass -h as the OS to see the list of supported OS.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-T [</b><i>image type</i><b>]</b></dt>
  <dd class="It-tag">Set image type. Pass -h as the image to see the list of
      supported image type.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-C [</b><i>compression type</i><b>]</b></dt>
  <dd class="It-tag">Set compression type. Pass -h as the compression to see the
      list of supported compression type.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-a [</b><i>load address</i><b>]</b></dt>
  <dd class="It-tag">Set load address with a hex number.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-e [</b><i>entry point</i><b>]</b></dt>
  <dd class="It-tag">Set entry point with a hex number.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l</b></dt>
  <dd class="It-tag">List the contents of an image.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n [</b><i>image name</i><b>]</b></dt>
  <dd class="It-tag">Set image name to 'image name'.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d [</b><i>image data file</i><b>]</b></dt>
  <dd class="It-tag">Use image data from 'image data file'.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-x</b></dt>
  <dd class="It-tag">Set XIP (execute in place) flag.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<div class="Pp"></div>
<b>Create FIT image:</b>
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-b [</b><i>device tree file</i><b>]</b></dt>
  <dd class="It-tag">Appends the device tree binary file (.dtb) to the FIT.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c [</b><i>comment</i><b>]</b></dt>
  <dd class="It-tag">Specifies a comment to be added when signing. This is
      typically a useful message which describes how the image was signed or
      some other useful information.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-D [</b><i>dtc options</i><b>]</b></dt>
  <dd class="It-tag">Provide special options to the device tree compiler that is
      used to create the image.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-E</b></dt>
  <dd class="It-tag">After processing, move the image data outside the FIT and
      store a data offset in the FIT. Images will be placed one after the other
      immediately after the FIT, with each one aligned to a 4-byte boundary. The
      existing 'data' property in each image will be replaced with 'data-offset'
      and 'data-size' properties. A 'data-offset' of 0 indicates that it starts
      in the first (4-byte aligned) byte after the FIT.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f [</b><i>image tree source file</i><b> |
    </b><i>auto</i><b>]</b></dt>
  <dd class="It-tag">Image tree source file that describes the structure and
      contents of the FIT image.
    <div style="height: 1.00em;">&#x00A0;</div>
    This can be automatically generated for some simple cases. Use &quot;-f
      auto&quot; for this. In that case the arguments -d, -A, -O, -T, -C, -a and
      -e are used to specify the image to include in the FIT and its attributes.
      No .its file is required.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-F</b></dt>
  <dd class="It-tag">Indicates that an existing FIT image should be modified. No
      dtc compilation is performed and the -f flag should not be given. This can
      be used to sign images with additional keys after initial image creation.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i [</b><i>ramdisk_file</i><b>]</b></dt>
  <dd class="It-tag">Appends the ramdisk file to the FIT.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-k [</b><i>key_directory</i><b>]</b></dt>
  <dd class="It-tag">Specifies the directory containing keys to use for signing.
      This directory should contain a private key file &lt;name&gt;.key for use
      with signing and a certificate &lt;name&gt;.crt (containing the public
      key) for use with verification.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-K [</b><i>key_destination</i><b>]</b></dt>
  <dd class="It-tag">Specifies a compiled device tree binary file (typically
      .dtb) to write public key information into. When a private key is used to
      sign an image, the corresponding public key is written into this file for
      for run-time verification. Typically the file here is the device tree
      binary used by CONFIG_OF_CONTROL in U-Boot.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p [</b><i>external position</i><b>]</b></dt>
  <dd class="It-tag">Place external data at a static external position. See -E.
      Instead of writing a 'data-offset' property defining the offset from the
      end of the FIT, -p will use 'data-position' as the absolute position from
      the base of the FIT.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-r</b></dt>
  <dd class="It-tag">Specifies that keys used to sign the FIT are required. This
      means that they must be verified for the image to boot. Without this
      option, the verification will be optional (useful for testing but not for
      release).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
List image information:
<pre>
<b>mkimage -l uImage</b>
</pre>
<div class="Pp"></div>
Create legacy image with compressed PowerPC Linux kernel:
<pre>
<b>mkimage -A powerpc -O linux -T kernel -C gzip \</b>
<div>&#x00A0;</div>
<b>-a 0 -e 0 -n Linux -d vmlinux.gz uImage</b>
</pre>
<div class="Pp"></div>
Create FIT image with compressed PowerPC Linux kernel:
<pre>
<b>mkimage -f kernel.its kernel.itb</b>
</pre>
<div class="Pp"></div>
Create FIT image with compressed kernel and sign it with keys in the
  /public/signing-keys directory. Add corresponding public keys into u-boot.dtb,
  skipping those for which keys cannot be found. Also add a comment.
<pre>
<b>mkimage -f kernel.its -k /public/signing-keys -K u-boot.dtb \</b>
<div>&#x00A0;</div>
<b>-c &quot;Kernel 3.8 image for production devices&quot; kernel.itb</b>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
Update an existing FIT image, signing it with additional keys. Add corresponding
  public keys into u-boot.dtb. This will resign all images with keys that are
  available in the new directory. Images that request signing with unavailable
  keys are skipped.
<pre>
<b>mkimage -F -k /secret/signing-keys -K u-boot.dtb \</b>
<div>&#x00A0;</div>
<b>-c &quot;Kernel 3.8 image for production devices&quot; kernel.itb</b>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
Create a FIT image containing a kernel, using automatic mode. No .its file is
  required.
<pre>
<b>mkimage -f auto -A arm -O linux -T kernel -C none -a 43e00000 -e 0 \</b>
<div>&#x00A0;</div>
<b>-c &quot;Kernel 4.4 image for production devices&quot; -d vmlinuz kernel.itb</b>
</pre>
<div class="Pp"></div>
Create a FIT image containing a kernel and some device tree files, using
  automatic mode. No .its file is required.
<pre>
<b>mkimage -f auto -A arm -O linux -T kernel -C none -a 43e00000 -e 0 \</b>
<div>&#x00A0;</div>
<b>-c &quot;Kernel 4.4 image for production devices&quot; -d vmlinuz \</b>
<b>-b /path/to/rk3288-firefly.dtb -b /path/to/rk3288-jerry.dtb kernel.itb</b>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="HOMEPAGE"><a class="selflink" href="#HOMEPAGE">HOMEPAGE</a></h1>
http://www.denx.de/wiki/U-Boot/WebHome
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
This manual page was written by Nobuhiro Iwamatsu &lt;iwamatsu@nigauri.org&gt;
  and Wolfgang Denk &lt;wd@denx.de&gt;. It was updated for image signing by
  Simon Glass &lt;sjg@chromium.org&gt;.</div>
<table class="foot">
  <tr>
    <td class="foot-date">2010-05-16</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
