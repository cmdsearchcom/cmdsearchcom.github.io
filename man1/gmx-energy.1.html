<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:14:17 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>GMX-ENERGY(1) GROMACS GMX-ENERGY(1)</p>

<p style="margin-top: 1em">NAME <br>
gmx-energy - Writes energies to xvg files and display
averages</p>

<p style="margin-top: 1em">SYNOPSIS <br>
gmx energy [-f [&lt;.edr&gt;]] [-f2 [&lt;.edr&gt;]] [-s
[&lt;.tpr&gt;]] [-o [&lt;.xvg&gt;]] <br>
[-viol [&lt;.xvg&gt;]] [-pairs [&lt;.xvg&gt;]] [-ora
[&lt;.xvg&gt;]] <br>
[-ort [&lt;.xvg&gt;]] [-oda [&lt;.xvg&gt;]] [-odr
[&lt;.xvg&gt;]] <br>
[-odt [&lt;.xvg&gt;]] [-oten [&lt;.xvg&gt;]] [-corr
[&lt;.xvg&gt;]] <br>
[-vis [&lt;.xvg&gt;]] [-ravg [&lt;.xvg&gt;]] [-odh
[&lt;.xvg&gt;]] <br>
[-b &lt;time&gt;] [-e &lt;time&gt;] [-[no]w] [-xvg
&lt;enum&gt;] [-[no]fee] <br>
[-fetemp &lt;real&gt;] [-zero &lt;real&gt;] [-[no]sum]
[-[no]dp] <br>
[-nbmin &lt;int&gt;] [-nbmax &lt;int&gt;] [-[no]mutot]
[-skip &lt;int&gt;] <br>
[-[no]aver] [-nmol &lt;int&gt;] [-[no]fluct_props] <br>
[-[no]driftcorr] [-[no]fluc] [-[no]orinst] [-[no]ovec] <br>
[-acflen &lt;int&gt;] [-[no]normalize] [-P &lt;enum&gt;]
<br>
[-fitfn &lt;enum&gt;] [-beginfit &lt;real&gt;] [-endfit
&lt;real&gt;]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
gmx energy extracts energy components or distance restraint
data from an energy file. The user is prompted to
interactively select the desired energy terms.</p>

<p style="margin-top: 1em">Average, RMSD, and drift are
calculated with full precision from the simulation (see
printed manual). Drift is calculated by performing a
least-squares fit of the data to a <br>
straight line. The reported total drift is the difference of
the fit at the first and last point. An error estimate of
the average is given based on a block averages over 5 <br>
blocks using the full-precision averages. The error estimate
can be performed over multiple block lengths with the
options -nbmin and -nbmax. Note that in most cases the
energy <br>
files contains averages over all MD steps, or over many more
points than the number of frames in energy file. This makes
the gmx energy statistics output more accurate than the <br>
.xvg output. When exact averages are not present in the
energy file, the statistics mentioned above are simply over
the single, per-frame energy values.</p>

<p style="margin-top: 1em">The term fluctuation gives the
RMSD around the least-squares fit.</p>

<p style="margin-top: 1em">Some fluctuation-dependent
properties can be calculated provided the correct energy
terms are selected, and that the command line option
-fluct_props is given. The following <br>
properties will be computed:</p>


<p style="margin-top: 1em">&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&not;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;
<br>
&acirc;Property &acirc; Energy terms needed &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;Heat capacity C_p (NPT sims): &acirc; Enthalpy, Temp
&acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;Heat capacity C_v (NVT sims): &acirc; Etot, Temp
&acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;Thermal expansion coeff. (NPT): &acirc; Enthalpy,
Vol, Temp &acirc; <br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;Isothermal compressibility: &acirc; Vol, Temp &acirc;
<br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&frac14;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&curren;
<br>
&acirc;Adiabatic bulk modulus: &acirc; Vol, Temp &acirc;
<br>

&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acute;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;&acirc;</p>

<p style="margin-top: 1em">You always need to set the
number of molecules -nmol. The C_p/C_v computations do not
include any corrections for quantum effects. Use the gmx dos
program if you need that (and <br>
you do).</p>

<p style="margin-top: 1em">When the -viol option is set,
the time averaged violations are plotted and the running
time-averaged and instantaneous sum of violations are
recalculated. Additionally running <br>
time-averaged and instantaneous distances between selected
pairs can be plotted with the -pairs option.</p>

<p style="margin-top: 1em">Options -ora, -ort, -oda, -odr
and -odt are used for analyzing orientation restraint data.
The first two options plot the orientation, the last three
the deviations of the ori&acirc; <br>
entations from the experimental values. The options that end
on an &rsquo;a&rsquo; plot the average over time as a
function of restraint. The options that end on a
&rsquo;t&rsquo; prompt the user for <br>
restraint label numbers and plot the data as a function of
time. Option -odr plots the RMS deviation as a function of
restraint. When the run used time or ensemble averaged
ori&acirc; <br>
entation restraints, option -orinst can be used to analyse
the instantaneous, not ensemble-averaged orientations and
deviations instead of the time and ensemble averages.</p>

<p style="margin-top: 1em">Option -oten plots the
eigenvalues of the molecular order tensor for each
orientation restraint experiment. With option -ovec also the
eigenvectors are plotted.</p>

<p style="margin-top: 1em">Option -odh extracts and plots
the free energy data (Hamiltoian differences and/or the
Hamiltonian derivative dhdl) from the ener.edr file.</p>

<p style="margin-top: 1em">With -fee an estimate is
calculated for the free-energy difference with an ideal gas
state:</p>

<p style="margin-top: 1em">Delta A = A(N,V,T) -
A_idealgas(N,V,T) = kT ln(&lt;exp(U_pot/kT)&gt;) <br>
Delta G = G(N,p,T) - G_idealgas(N,p,T) = kT
ln(&lt;exp(U_pot/kT)&gt;)</p>

<p style="margin-top: 1em">where k is Boltzmann&rsquo;s
constant, T is set by -fetemp and the average is over the
ensemble (or time in a trajectory). Note that this is in
principle only correct when averaging <br>
over the whole (Boltzmann) ensemble and using the potential
energy. This also allows for an entropy estimate using:</p>

<p style="margin-top: 1em">Delta S(N,V,T) = S(N,V,T) -
S_idealgas(N,V,T) = (&lt;U_pot&gt; - Delta A)/T <br>
Delta S(N,p,T) = S(N,p,T) - S_idealgas(N,p,T) =
(&lt;U_pot&gt; + pV - Delta G)/T</p>

<p style="margin-top: 1em">When a second energy file is
specified (-f2), a free energy difference is calculated:</p>

<p style="margin-top: 1em">dF = -kT
ln(&lt;exp(-(E_B-E_A)/kT)&gt;_A) ,</p>

<p style="margin-top: 1em">where E_A and E_B are the
energies from the first and second energy files, and the
average is over the ensemble A. The running average of the
free energy difference is printed to <br>
a file specified by -ravg. Note that the energies must both
be calculated from the same trajectory.</p>

<p style="margin-top: 1em">OPTIONS <br>
Options to specify input files:</p>

<p style="margin-top: 1em">-f [&lt;.edr&gt;] (ener.edr)
<br>
Energy file</p>

<p style="margin-top: 1em">-f2 [&lt;.edr&gt;] (ener.edr)
(Optional) <br>
Energy file</p>

<p style="margin-top: 1em">-s [&lt;.tpr&gt;] (topol.tpr)
(Optional) <br>
Portable xdr run input file</p>

<p style="margin-top: 1em">Options to specify output
files:</p>

<p style="margin-top: 1em">-o [&lt;.xvg&gt;] (energy.xvg)
<br>
xvgr/xmgr file</p>

<p style="margin-top: 1em">-viol [&lt;.xvg&gt;]
(violaver.xvg) (Optional) <br>
xvgr/xmgr file</p>

<p style="margin-top: 1em">-pairs [&lt;.xvg&gt;]
(pairs.xvg) (Optional) <br>
xvgr/xmgr file</p>

<p style="margin-top: 1em">-ora [&lt;.xvg&gt;]
(orienta.xvg) (Optional) <br>
xvgr/xmgr file</p>

<p style="margin-top: 1em">-ort [&lt;.xvg&gt;]
(orientt.xvg) (Optional) <br>
xvgr/xmgr file</p>

<p style="margin-top: 1em">-oda [&lt;.xvg&gt;]
(orideva.xvg) (Optional) <br>
xvgr/xmgr file</p>

<p style="margin-top: 1em">-odr [&lt;.xvg&gt;]
(oridevr.xvg) (Optional) <br>
xvgr/xmgr file</p>

<p style="margin-top: 1em">-odt [&lt;.xvg&gt;]
(oridevt.xvg) (Optional) <br>
xvgr/xmgr file</p>

<p style="margin-top: 1em">-oten [&lt;.xvg&gt;]
(oriten.xvg) (Optional) <br>
xvgr/xmgr file</p>

<p style="margin-top: 1em">-corr [&lt;.xvg&gt;]
(enecorr.xvg) (Optional) <br>
xvgr/xmgr file</p>

<p style="margin-top: 1em">-vis [&lt;.xvg&gt;] (visco.xvg)
(Optional) <br>
xvgr/xmgr file</p>

<p style="margin-top: 1em">-ravg [&lt;.xvg&gt;]
(runavgdf.xvg) (Optional) <br>
xvgr/xmgr file</p>

<p style="margin-top: 1em">-odh [&lt;.xvg&gt;] (dhdl.xvg)
(Optional) <br>
xvgr/xmgr file</p>

<p style="margin-top: 1em">Other options:</p>

<p style="margin-top: 1em">-b &lt;time&gt; (0) <br>
First frame (ps) to read from trajectory</p>

<p style="margin-top: 1em">-e &lt;time&gt; (0) <br>
Last frame (ps) to read from trajectory</p>

<p style="margin-top: 1em">-[no]w (no) <br>
View output .xvg, .xpm, .eps and .pdb files</p>

<p style="margin-top: 1em">-xvg &lt;enum&gt; (xmgrace) <br>
xvg plot formatting: xmgrace, xmgr, none</p>

<p style="margin-top: 1em">-[no]fee (no) <br>
Do a free energy estimate</p>

<p style="margin-top: 1em">-fetemp &lt;real&gt; (300) <br>
Reference temperature for free energy calculation</p>

<p style="margin-top: 1em">-zero &lt;real&gt; (0) <br>
Subtract a zero-point energy</p>

<p style="margin-top: 1em">-[no]sum (no) <br>
Sum the energy terms selected rather than display them
all</p>

<p style="margin-top: 1em">-[no]dp (no) <br>
Print energies in high precision</p>

<p style="margin-top: 1em">-nbmin &lt;int&gt; (5) <br>
Minimum number of blocks for error estimate</p>

<p style="margin-top: 1em">-nbmax &lt;int&gt; (5) <br>
Maximum number of blocks for error estimate</p>

<p style="margin-top: 1em">-[no]mutot (no) <br>
Compute the total dipole moment from the components</p>

<p style="margin-top: 1em">-skip &lt;int&gt; (0) <br>
Skip number of frames between data points</p>

<p style="margin-top: 1em">-[no]aver (no) <br>
Also print the exact average and rmsd stored in the energy
frames (only when 1 term is requested)</p>

<p style="margin-top: 1em">-nmol &lt;int&gt; (1) <br>
Number of molecules in your sample: the energies are divided
by this number</p>

<p style="margin-top: 1em">-[no]fluct_props (no) <br>
Compute properties based on energy fluctuations, like heat
capacity</p>

<p style="margin-top: 1em">-[no]driftcorr (no) <br>
Useful only for calculations of fluctuation properties. The
drift in the observables will be subtracted before computing
the fluctuation properties.</p>

<p style="margin-top: 1em">-[no]fluc (no) <br>
Calculate autocorrelation of energy fluctuations rather than
energy itself</p>

<p style="margin-top: 1em">-[no]orinst (no) <br>
Analyse instantaneous orientation data</p>

<p style="margin-top: 1em">-[no]ovec (no) <br>
Also plot the eigenvectors with -oten</p>

<p style="margin-top: 1em">-acflen &lt;int&gt; (-1) <br>
Length of the ACF, default is half the number of frames</p>

<p style="margin-top: 1em">-[no]normalize (yes) <br>
Normalize ACF</p>

<p style="margin-top: 1em">-P &lt;enum&gt; (0) <br>
Order of Legendre polynomial for ACF (0 indicates none): 0,
1, 2, 3</p>

<p style="margin-top: 1em">-fitfn &lt;enum&gt; (none) <br>
Fit function: none, exp, aexp, exp_exp, exp5, exp7, exp9</p>

<p style="margin-top: 1em">-beginfit &lt;real&gt; (0) <br>
Time where to begin the exponential fit of the correlation
function</p>

<p style="margin-top: 1em">-endfit &lt;real&gt; (-1) <br>
Time where to end the exponential fit of the correlation
function, -1 is until the end</p>

<p style="margin-top: 1em">SEE ALSO <br>
gmx(1)</p>

<p style="margin-top: 1em">More information about GROMACS
is available at &lt;http://www.gromacs.org/&gt;.</p>

<p style="margin-top: 1em">COPYRIGHT <br>
2017, GROMACS development team</p>

<p style="margin-top: 1em">2016.3 Mar 13, 2017
GMX-ENERGY(1)</p>
<hr>
</body>
</html>
