<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>r.sun(1grass)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">r.sun(1grass)</td>
    <td class="head-vol">Grass User's Manual</td>
    <td class="head-rtitle">r.sun(1grass)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<i></i><b>r.sun</b> - Solar irradiance and irradiation model.
<div>&#x00A0;</div>
Computes direct (beam), diffuse and reflected solar irradiation raster maps for
  given day, latitude, surface and atmospheric conditions. Solar parameters
  (e.g. sunrise, sunset times, declination, extraterrestrial irradiance,
  daylight length) are saved in the map history file. Alternatively, a local
  time can be specified to compute solar incidence angle and/or irradiance
  raster maps. The shadowing effect of the topography is optionally
  incorporated.
<h1 class="Sh" title="Sh" id="KEYWORDS"><a class="selflink" href="#KEYWORDS">KEYWORDS</a></h1>
raster, solar, sun energy, shadow
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>r.sun</b>
<div>&#x00A0;</div>
<b>r.sun --help</b>
<div>&#x00A0;</div>
<b>r.sun</b> [-<b>pm</b>] <b>elevation</b>=<i>string</i>
  [<b>aspect</b>=<i>string</i>] [ <b>aspect_value</b>=<i>float</i>]
  [<b>slope</b>= <i>string</i>] [<b>slope_value</b>=<i>float</i>]
  [<b>linke</b>=<i>string</i>] [<b>linke_value</b>=<i>float</i>]
  [<b>albedo</b>=<i>string</i>] [<b>albedo_value</b>=<i>float</i>]
  [<b>lat</b>=<i>string</i>] [<b>long</b>=<i>string</i>]
  [<b>coeff_bh</b>=<i>string</i>] [ <b>coeff_dh</b>=<i>string</i>]
  [<b>horizon_basename</b>= <i>basename</i>] [<b>horizon_step</b>=<i>float</i>]
  [ <b>incidout</b>=<i>string</i>] [<b>beam_rad</b>=<i>string</i>]
  [<b>diff_rad</b>= <i>string</i>] [<b>refl_rad</b>=<i>string</i>]
  [<b>glob_rad</b>= <i>string</i>] [<b>insol_time</b>=<i>string</i>]
  <b>day</b>=<i>integer</i> [<b>step</b>=<i>float</i>]
  [<b>declination</b>=<i>float</i>] [ <b>time</b>=<i>float</i>]
  [<b>distance_step</b>= <i>float</i>] [<b>npartitions</b>=<i>integer</i>]
  [<b>civil_time</b>= <i>float</i>] [--<b>overwrite</b>] [--<b>help</b>]
  [--<b>verbose</b>] [-- <b>quiet</b>] [--<b>ui</b>]
<h2 class="Ss" title="Ss" id="Flags:"><a class="selflink" href="#Flags:">Flags:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Do not incorporate the shadowing effect of terrain</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-m</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Use the low-memory version of the program</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--overwrite</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Allow output files to overwrite existing files</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Print usage summary</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verbose</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Verbose module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--quiet</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Quiet module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ui</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Force launching GUI dialog</dd>
</dl>
<h2 class="Ss" title="Ss" id="Parameters:"><a class="selflink" href="#Parameters:">Parameters:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>elevation</b>=<i>string</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of the input elevation raster map [meters]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>aspect</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of the input aspect map (terrain aspect or azimuth of the solar panel)
      [decimal degrees]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>aspect_value</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    A single value of the orientation (aspect), 270 is south
    <div>&#x00A0;</div>
    Default: <i>270</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>slope</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of the input slope raster map (terrain slope or solar panel
      inclination) [decimal degrees]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>slope_value</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    A single value of inclination (slope)
    <div>&#x00A0;</div>
    Default: <i>0.0</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>linke</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of the Linke atmospheric turbidity coefficient input raster map
    [-]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>linke_value</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    A single value of the Linke atmospheric turbidity coefficient [-]
    <div>&#x00A0;</div>
    Default: <i>3.0</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>albedo</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of the ground albedo coefficient input raster map [-]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>albedo_value</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    A single value of the ground albedo coefficient [-]
    <div>&#x00A0;</div>
    Default: <i>0.2</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>lat</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input raster map containing latitudes [decimal degrees]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>long</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input raster map containing longitudes [decimal degrees]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>coeff_bh</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of real-sky beam radiation coefficient (thick cloud) input raster map
      [0-1]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>coeff_dh</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of real-sky diffuse radiation coefficient (haze) input raster map
    [0-1]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>horizon_basename</b>=<i>basename</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The horizon information input map basename</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>horizon_step</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Angle step size for multidirectional horizon [degrees]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>incidout</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Output incidence angle raster map (mode 1 only)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>beam_rad</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Output beam irradiance [W.m-2] (mode 1) or irradiation raster map
      [Wh.m-2.day-1] (mode 2)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>diff_rad</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Output diffuse irradiance [W.m-2] (mode 1) or irradiation raster map
      [Wh.m-2.day-1] (mode 2)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>refl_rad</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Output ground reflected irradiance [W.m-2] (mode 1) or irradiation raster
      map [Wh.m-2.day-1] (mode 2)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>glob_rad</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Output global (total) irradiance/irradiation [W.m-2] (mode 1) or
      irradiance/irradiation raster map [Wh.m-2.day-1] (mode 2)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>insol_time</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Output insolation time raster map [h] (mode 2 only)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>day</b>=<i>integer</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    No. of day of the year (1-365)
    <div>&#x00A0;</div>
    Options: <i>1-365</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>step</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Time step when computing all-day radiation sums [decimal hours]
    <div>&#x00A0;</div>
    Default: <i>0.5</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>declination</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Declination value (overriding the internally computed value) [radians]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>time</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Local (solar) time (to be set for mode 1 only) [decimal hours]
    <div>&#x00A0;</div>
    Options: <i>0-24</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>distance_step</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Sampling distance step coefficient (0.5-1.5)
    <div>&#x00A0;</div>
    Default: <i>1.0</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>npartitions</b>=<i>integer</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Read the input files in this number of chunks
    <div>&#x00A0;</div>
    Default: <i>1</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>civil_time</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Civil time zone value, if none, the time will be local solar time</dd>
</dl>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>r.sun</b> computes beam (direct), diffuse and ground reflected solar
  irradiation raster maps for given day, latitude, surface and atmospheric
  conditions. Solar parameters (e.g. time of sunrise and sunset, declination,
  extraterrestrial irradiance, daylight length) are stored in the resultant
  maps&#x2019; history files. Alternatively, the local time can be specified to
  compute solar incidence angle and/or irradiance raster maps. The shadowing
  effect of the topography is incorporated by default. This can be done either
  internally by calculatoion of the shadowing effect directly from the digital
  elevation model or by specifying raster maps of the horizon height which is
  much faster. These horizon raster maps can be calculated using r.horizon.
<div class="Pp"></div>
For latitude-longitude coordinates it requires that the elevation map is in
  meters. The rules are:
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">lat/lon coordinates: elevation in meters;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Other coordinates: elevation in the same unit as the
      easting-northing coordinates.</dd>
</dl>
</div>
The solar geometry of the model is based on the works of Krcho (1990), later
  improved by Jenco (1992). The equations describing Sun -- Earth position as
  well as an interaction of the solar radiation with atmosphere were originally
  based on the formulas suggested by Kitler and Mikler (1986). This component
  was considerably updated by the results and suggestions of the working group
  co-ordinated by Scharmer and Greif (2000) (this algorithm might be replaced by
  SOLPOS algorithm-library included in GRASS within r.sunmask command). The
  model computes all three components of global radiation (beam, diffuse and
  reflected) for the clear sky conditions, i.e. not taking into consideration
  the spatial and temporal variation of clouds. The extent and spatial
  resolution of the modelled area, as well as integration over time, are limited
  only by the memory and data storage resources. The model is built to fulfil
  user needs in various fields of science (hydrology, climatology, ecology and
  environmental sciences, photovoltaics, engineering, etc.) for continental,
  regional up to the landscape scales.
<div class="Pp"></div>
The model considers a shadowing effect of the local topography unless switched
  off with the <i>-p</i> flag. <b>r.sun</b> works in two modes: In the first
  mode it calculates for the set local time a solar incidence angle [degrees]
  and solar irradiance values [W.m-2]. In the second mode daily sums of solar
  radiation [Wh.m-2.day-1] are computed within a set day. By a scripting the two
  modes can be used separately or in a combination to provide estimates for any
  desired time interval. The model accounts for sky obstruction by local relief
  features. Several solar parameters are saved in the resultant maps&#x2019;
  history files, which may be viewed with the r.info command.
<div class="Pp"></div>
The solar incidence angle raster map <i>incidout</i> is computed specifying
  elevation raster map <i>elevation</i>, aspect raster map <i>aspect</i>, slope
  steepness raster map <i>slope,</i> given the day <i>day</i> and local time
  <i>time</i>. There is no need to define latitude for locations with known and
  defined projection/coordinate system (check it with the g.proj command). If
  you have undefined projection, (x,y) system, etc. then the latitude can be
  defined explicitly for large areas by input raster map <i>lat_in</i> with
  interpolated latitude values. All input raster maps must be floating point
  (FCELL) raster maps. Null data in maps are excluded from the computation (and
  also speeding-up the computation), so each output raster map will contain null
  data in cells according to all input raster maps. The user can use r.null
  command to create/reset null file for your input raster maps.
<div>&#x00A0;</div>
The specified day <i>day</i> is the number of the day of the general year where
  January 1 is day no.1 and December 31 is 365. Time <i>time</i> must be a local
  (solar) time (i.e. NOT a zone time, e.g. GMT, CET) in decimal system, e.g. 7.5
  (= 7h 30m A.M.), 16.1 = 4h 6m P.M..
<div class="Pp"></div>
The solar <i>declination</i> parameter is an option to override the value
  computed by the internal routine for the day of the year. The value of
  geographical latitude can be set as a constant for the whole computed region
  or, as an option, a grid representing spatially distributed values over a
  large region. The geographical latitude must be also in decimal system with
  positive values for northern hemisphere and negative for southern one. In
  similar principle the Linke turbidity factor ( <i>linke</i>, <i>lin</i> ) and
  ground albedo ( <i>albedo</i>, <i>alb</i>) can be set.
<div class="Pp"></div>
Besides clear-sky radiations, the user can compute a real-sky radiation (beam,
  diffuse) using <i>coeff_bh</i> and <i>coeff_dh</i> input raster maps defining
  the fraction of the respective clear-sky radiations reduced by atmospheric
  factors (e.g. cloudiness). The value is between 0-1. Usually these
  coefficients can be obtained from a long-terms meteorological measurements
  provided as raster maps with spatial distribution of these coefficients
  separately for beam and diffuse radiation (see Suri and Hofierka, 2004,
  section 3.2).
<div class="Pp"></div>
The solar irradiation or irradiance raster maps <i>beam_rad</i>,
  <i>diff_rad</i>, <i>refl_rad</i> are computed for a given day <i>day,</i>
  latitude <i>lat_in</i>, elevation <i>elevation</i>, slope <i>slope</i> and
  aspect <i>aspect</i> raster maps. For convenience, the output raster given as
  <i>glob_rad</i> will output the sum of the three radiation components. The
  program uses the Linke atmosphere turbidity factor and ground albedo
  coefficient. A default, single value of Linke factor is <i>lin</i>=3.0 and is
  near the annual average for rural-city areas. The Linke factor for an
  absolutely clear atmosphere is <i>lin</i>=1.0. See notes below to learn more
  about this factor. The incidence solar angle is the angle between horizon and
  solar beam vector.
<div class="Pp"></div>
The solar radiation maps for a given day are computed by integrating the
  relevant irradiance between sunrise and sunset times for that day. The user
  can set a finer or coarser time step used for all-day radiation calculations
  with the <i>step</i> option. The default value of <i>step</i> is 0.5 hour.
  Larger steps (e.g. 1.0-2.0) can speed-up calculations but produce less
  reliable (and more jagged) results. As the sun moves through approx.
  15&#x00B0; of the sky in an hour, the default <i>step</i> of half an hour will
  produce 7.5&#x00B0; steps in the data. For relatively smooth output with the
  sun placed for every degree of movement in the sky you should set the
  <i>step</i> to 4 minutes or less. <i>step</i>=0.05 is equivalent to every 3
  minutes. Of course setting the time step to be very fine proportionally
  increases the module&#x2019;s running time.
<div class="Pp"></div>
The output units are in Wh per squared meter per given day [Wh/(m*m)/day]. The
  incidence angle and irradiance/irradiation maps are computed with the
  shadowing influence of relief by default. It is also possible for them to be
  computed without this influence using the planar flag ( <i>-p</i>). In
  mountainous areas this can lead to very different results! The user should be
  aware that taking into account the shadowing effect of relief can slow down
  the speed of computation, especially when the sun altitude is low.
<div class="Pp"></div>
When considering the shadowing effect, speed and precision of computation can be
  controlled by the <i>distance_step</i> parameter, which defines the sampling
  density at which the visibility of a grid cell is computed in the direction of
  a path of the solar flow. It also defines the method by which the
  obstacle&#x2019;s altitude is computed. When choosing a <i>distance_step</i>
  less than 1.0 (i.e. sampling points will be computed at <i>distance_step</i> *
  cellsize distance), <i>r.sun</i> takes the altitude from the nearest grid
  point. Values above 1.0 will use the maximum altitude value found in the
  nearest 4 surrounding grid points. The default value <i>distance_step</i>=1.0
  should give reasonable results for most cases (e.g. on DEM). The
  <i>distance_step</i> value defines a multiplying coefficient for sampling
  distance. This basic sampling distance equals to the arithmetic average of
  both cell sizes. The reasonable values are in the range 0.5-1.5. The values
  below 0.5 will decrease and values above 1.0 will increase the computing
  speed. Values greater than 2.0 may produce estimates with lower accuracy in
  highly dissected relief. The fully shadowed areas are written to the output
  maps as zero values. Areas with NULL data are considered as no barrier with
  shadowing effect.
<div class="Pp"></div>
The maps&#x2019; history files are generated containing the following listed
  parameters used in the computation:
<div>&#x00A0;</div>
- Solar constant 1367 W.m-2
<div>&#x00A0;</div>
- Extraterrestrial irradiance on a plane perpendicular to the solar beam [W.m-2]
<div>&#x00A0;</div>
- Day of the year
<div>&#x00A0;</div>
- Declination [radians]
<div>&#x00A0;</div>
- Decimal hour (Alternative 1 only)
<div>&#x00A0;</div>
- Sunrise and sunset (min-max) over a horizontal plane
<div>&#x00A0;</div>
- Daylight lengths
<div>&#x00A0;</div>
- Geographical latitude (min-max)
<div>&#x00A0;</div>
- Linke turbidity factor (min-max)
<div>&#x00A0;</div>
- Ground albedo (min-max)
<div class="Pp"></div>
The user can use a nice shellcript with variable day to compute radiation for
  some time interval within the year (e.g. vegetation or winter period).
  Elevation, aspect and slope input values should not be reclassified into
  coarser categories. This could lead to incorrect results.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
Currently, there are two modes of r.sun. In the first mode it calculates solar
  incidence angle and solar irradiance raster maps using the set local time. In
  the second mode daily sums of solar irradiation [Wh.m-2.day-1] are computed
  for a specified day.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
Solar energy is an important input parameter in different models concerning
  energy industry, landscape, vegetation, evapotranspiration, snowmelt or remote
  sensing. Solar rays incidence angle maps can be effectively used in
  radiometric and topographic corrections in mountainous and hilly terrain where
  very accurate investigations should be performed.
<div class="Pp"></div>
The clear-sky solar radiation model applied in the r.sun is based on the work
  undertaken for development of European Solar Radiation Atlas (Scharmer and
  Greif 2000, Page et al. 2001, Rigollier 2001). The clear sky model estimates
  the global radiation from the sum of its beam, diffuse and reflected
  components. The main difference between solar radiation models for inclined
  surfaces in Europe is the treatment of the diffuse component. In the European
  climate this component is often the largest source of estimation error. Taking
  into consideration the existing models and their limitation the European Solar
  Radiation Atlas team selected the Muneer (1990) model as it has a sound
  theoretical basis and thus more potential for later improvement.
<div class="Pp"></div>
Details of underlying equations used in this program can be found in the
  reference literature cited below or book published by Neteler and Mitasova:
  Open Source GIS: A GRASS GIS Approach (published in Kluwer Academic Publishers
  in 2002).
<div class="Pp"></div>
Average monthly values of the Linke turbidity coefficient for a mild climate in
  the northern hemisphere (see reference literature for your study area):
<table class="tbl">
  <colgroup>
    <col style="width: 60.00ex;"/>
    <col style="width: 1.00ex;"/>
    <col style="width: 60.00ex;"/>
    <col style="width: 1.00ex;"/>
    <col style="width: 60.00ex;"/>
    <col style="width: 1.00ex;"/>
    <col style="width: 60.00ex;"/>
    <col style="width: 1.00ex;"/>
    <col style="width: 60.00ex;"/>
    <col style="width: 1.00ex;"/>
    <col style="width: 60.00ex;"/>
    <col style="width: 1.00ex;"/>
    <col style="width: 60.00ex;"/>
    <col style="width: 1.00ex;"/>
    <col style="width: 60.00ex;"/>
    <col style="width: 1.00ex;"/>
    <col style="width: 60.00ex;"/>
    <col style="width: 1.00ex;"/>
    <col style="width: 60.00ex;"/>
    <col style="width: 1.00ex;"/>
    <col style="width: 60.00ex;"/>
    <col style="width: 1.00ex;"/>
    <col style="width: 60.00ex;"/>
    <col style="width: 1.00ex;"/>
    <col style="width: 60.00ex;"/>
    <col style="width: 1.00ex;"/>
    <col style="width: 60.00ex;"/>
  </colgroup>
  <tr>
    <td>Month</td>
    <td> </td>
    <td>Jan</td>
    <td> </td>
    <td>Feb</td>
    <td> </td>
    <td>Mar</td>
    <td> </td>
    <td>Apr</td>
    <td> </td>
    <td>May</td>
    <td> </td>
    <td>Jun</td>
    <td> </td>
    <td>Jul</td>
    <td> </td>
    <td>Aug</td>
    <td> </td>
    <td>Sep</td>
    <td> </td>
    <td>Oct</td>
    <td> </td>
    <td>Nov</td>
    <td> </td>
    <td>Dec</td>
    <td> </td>
    <td>annual</td>
  </tr>
  <tr>
    <td>mountains</td>
    <td> </td>
    <td>1.5</td>
    <td> </td>
    <td>1.6</td>
    <td> </td>
    <td>1.8</td>
    <td> </td>
    <td>1.9</td>
    <td> </td>
    <td>2.0</td>
    <td> </td>
    <td>2.3</td>
    <td> </td>
    <td>2.3</td>
    <td> </td>
    <td>2.3</td>
    <td> </td>
    <td>2.1</td>
    <td> </td>
    <td>1.8</td>
    <td> </td>
    <td>1.6</td>
    <td> </td>
    <td>1.5</td>
    <td> </td>
    <td>1.90</td>
  </tr>
  <tr>
    <td>rural</td>
    <td> </td>
    <td>2.1</td>
    <td> </td>
    <td>2.2</td>
    <td> </td>
    <td>2.5</td>
    <td> </td>
    <td>2.9</td>
    <td> </td>
    <td>3.2</td>
    <td> </td>
    <td>3.4</td>
    <td> </td>
    <td>3.5</td>
    <td> </td>
    <td>3.3</td>
    <td> </td>
    <td>2.9</td>
    <td> </td>
    <td>2.6</td>
    <td> </td>
    <td>2.3</td>
    <td> </td>
    <td>2.2</td>
    <td> </td>
    <td>2.75</td>
  </tr>
  <tr>
    <td>city</td>
    <td> </td>
    <td>3.1</td>
    <td> </td>
    <td>3.2</td>
    <td> </td>
    <td>3.5</td>
    <td> </td>
    <td>4.0</td>
    <td> </td>
    <td>4.2</td>
    <td> </td>
    <td>4.3</td>
    <td> </td>
    <td>4.4</td>
    <td> </td>
    <td>4.3</td>
    <td> </td>
    <td>4.0</td>
    <td> </td>
    <td>3.6</td>
    <td> </td>
    <td>3.3</td>
    <td> </td>
    <td>3.1</td>
    <td> </td>
    <td>3.75</td>
  </tr>
  <tr>
    <td>industrial</td>
    <td> </td>
    <td>4.1</td>
    <td> </td>
    <td>4.3</td>
    <td> </td>
    <td>4.7</td>
    <td> </td>
    <td>5.3</td>
    <td> </td>
    <td>5.5</td>
    <td> </td>
    <td>5.7</td>
    <td> </td>
    <td>5.8</td>
    <td> </td>
    <td>5.7</td>
    <td> </td>
    <td>5.3</td>
    <td> </td>
    <td>4.9</td>
    <td> </td>
    <td>4.5</td>
    <td> </td>
    <td>4.2</td>
    <td> </td>
    <td>5.00</td>
  </tr>
</table>
<div class="Pp"></div>
Planned improvements include the use of the SOLPOS algorithm for solar geometry
  calculations and internal computation of aspect and slope.
<h2 class="Ss" title="Ss" id="Solar_time"><a class="selflink" href="#Solar_time">Solar
  time</a></h2>
By default r.sun calculates times as true solar time, whereby solar noon is
  always exactly 12 o&#x2019;clock everywhere in the current region. Depending
  on where the zone of interest is located in the related time zone, this may
  cause differences of up to an hour, in some cases (like Western Spain) even
  more. On top of this, the offset varies during the year according to the
  Equation of Time.
<div class="Pp"></div>
To overcome this problem, the user can use the option
  <i>civil_time=&lt;timezone_offset&gt;</i> in r.sun to make it use real-world
  (wall clock) time. For example, for Central Europe the timezone offset is +1,
  +2 when daylight saving time is in effect.
<h2 class="Ss" title="Ss" id="Extraction_of_shadow_maps"><a class="selflink" href="#Extraction_of_shadow_maps">Extraction
  of shadow maps</a></h2>
A map of shadows can be extracted from the solar incidence angle map (incidout).
  Areas with zero values are shadowed. This will not work if the <i>-p</i> flag
  has been used.
<h2 class="Ss" title="Ss" id="Large_maps_and_out_of_memory_problems"><a class="selflink" href="#Large_maps_and_out_of_memory_problems">Large
  maps and out of memory problems</a></h2>
With a large number or columns and rows, <b>r.sun</b> can consume significant
  amount of memory. While output raster maps are not partitionable, the input
  raster maps are using the <i>npartitions</i> parameter. In case of out of
  memory error (ERROR: G_malloc: out of memory), the <i>npartitions</i>
  parameter can be used to run a segmented calculation which consumes less
  memory during the computations. The amount of memory by <b>r.sun</b> is
  estimated as follows:
<div>&#x00A0;</div>
<pre>
# without input raster map partitioning:
#  memory requirements: 4 bytes per raster cell
#  rows,cols: rows and columns of current region (find out with g.region)
#  IR: number of input raster maps without horizon maps
#  OR: number of output raster maps
memory_bytes = rows*cols*(IR*4 + horizon_steps + OR*4)
# with input raster map partitioning:
memory_bytes = rows*cols*((IR*4+horizon_steps)/npartitions  + OR*4)
</pre>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
North Carolina example (considering also cast shadows):
<div>&#x00A0;</div>
<pre>
g.region raster=elevation -p
# calculate horizon angles (to speed up the subsequent r.sun calculation)
r.horizon elevation=elevation step=30 bufferzone=200 basename=horangle \
    maxdistance=5000
# slope + aspect
r.slope.aspect elevation=elevation aspect=aspect.dem slope=slope.dem
# calculate global radiation for day 180 at 2p.m., using r.horizon output
r.sun elevation=elevation horizon_basename=horangle horizon_step=30 \
      aspect=aspect.dem slope=slope.dem glob_rad=global_rad day=180 time=14
# result: output global (total) irradiance/irradiation [W.m-2] for given day/time
r.univar global_rad
</pre>
<div class="Pp"></div>
Calculation of the integrated daily irradiation for a region in North-Carolina
  for a given day of the year at 30m resolution. Here day 172 (i.e., 21 June in
  non-leap years):
<div>&#x00A0;</div>
<pre>
g.region raster=elev_ned_30m -p
# considering cast shadows
r.sun elevation=elev_ned_30m linke_value=2.5 albedo_value=0.2 day=172 \
      beam_rad=b172 diff_rad=d172 \
      refl_rad=r172 insol_time=it172
d.mon wx0
# show irradiation raster map [Wh.m-2.day-1]
d.rast.leg b172
# show insolation time raster map [h]
d.rast.leg it172
</pre>
We can compute the day of year from a specific date in Python:
<div>&#x00A0;</div>
<pre>
&gt;&gt;&gt; import datetime
&gt;&gt;&gt; datetime.datetime(2014, 6, 21).timetuple().tm_yday
172
</pre>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i></i> <i>r.horizon,</i> <i>r.slope.aspect,</i> <i>r.sunhours,</i>
  <i>r.sunmask,</i> <i>g.proj,</i> <i>r.null,</i> <i>v.surf.rst</i> <i></i>
<h1 class="Sh" title="Sh" id="REFERENCES"><a class="selflink" href="#REFERENCES">REFERENCES</a></h1>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Hofierka, J., Suri, M. (2002): The solar radiation model
      for Open source GIS: implementation and applications. International GRASS
      users conference in Trento, Italy, September 2002. (PDF)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Hofierka, J. (1997). Direct solar radiation modelling
      within an open GIS environment. Proceedings of JEC-GI&#x2019;97 conference
      in Vienna, Austria, IOS Press Amsterdam, 575-584.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Jenco, M. (1992). Distribution of direct solar radiation on
      georelief and its modelling by means of complex digital model of terrain
      (in Slovak). Geograficky casopis, 44, 342-355.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Kasten, F. (1996). The Linke turbidity factor based on
      improved values of the integral Rayleigh optical thickness. Solar Energy,
      56 (3), 239-244.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Kasten, F., Young, A. T. (1989). Revised optical air mass
      tables and approximation formula. Applied Optics, 28, 4735-4738.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Kittler, R., Mikler, J. (1986): Basis of the utilization of
      solar radiation (in Slovak). VEDA, Bratislava, p. 150.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Krcho, J. (1990). Morfometrick&#x00E1; analza a
      digit&#x00E1;lne modely georeli&#x00E9;fu (Morphometric analysis and
      digital models of georelief, in Slovak). VEDA, Bratislava.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Muneer, T. (1990). Solar radiation model for Europe.
      Building services engineering research and technology, 11, 4,
    153-163.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Neteler, M., Mitasova, H. (2002): Open Source GIS: A GRASS
      GIS Approach, Kluwer Academic Publishers. (Appendix explains formula;
      r.sun script download)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Page, J. ed. (1986). Prediction of solar radiation on
      inclined surfaces. Solar energy R&amp;D in the European Community, series
      F - Solar radiation data, Dordrecht (D. Reidel), 3, 71, 81-83.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Page, J., Albuisson, M., Wald, L. (2001). The European
      solar radiation atlas: a valuable digital tool. Solar Energy, 71,
    81-83.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Rigollier, Ch., Bauer, O., Wald, L. (2000). On the clear
      sky model of the ESRA - European Solar radiation Atlas - with respect to
      the Heliosat method. Solar energy, 68, 33-48.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Scharmer, K., Greif, J., eds., (2000). The European solar
      radiation atlas, Vol. 2: Database and exploitation software. Paris (Les
      Presses de l&#x2019;&#x00C9;cole des Mines).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Joint Research Centre: GIS solar radiation database for
      Europe and Solar radiation and GIS</dd>
</dl>
</div>
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
Jaroslav Hofierka, GeoModel, s.r.o. Bratislava, Slovakia
<div>&#x00A0;</div>
Marcel Suri, GeoModel, s.r.o. Bratislava, Slovakia
<div>&#x00A0;</div>
Thomas Huld, JRC, Italy
<div>&#x00A0;</div>
&#x00A9; 2007, Jaroslav Hofierka, Marcel Suri. This program is free software
  under the GNU General Public License (&gt;=v2) hofierka@geomodel.sk
  suri@geomodel.sk
<div class="Pp"></div>
<i>Last changed: $Date: 2016-02-19 02:42:11 +0100 (Fri, 19 Feb 2016) $</i>
<h1 class="Sh" title="Sh" id="SOURCE_CODE"><a class="selflink" href="#SOURCE_CODE">SOURCE
  CODE</a></h1>
Available at: r.sun source code (history)
<div class="Pp"></div>
Main index | Raster index | Topics index | Keywords index | Graphical index |
  Full index
<div class="Pp"></div>
&#x00A9; 2003-2016 GRASS Development Team, GRASS GIS 7.2.0 Reference
  Manual</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os">GRASS 7.2.0</td>
  </tr>
</table>
</body>
</html>
