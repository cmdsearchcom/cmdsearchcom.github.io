<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>dpa(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">dpa(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">dpa(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
dpa - DNS Packet Analyzer. Analyze DNS packets in ip trace files
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>dpa</b> [ <i>OPTION</i> ] <i>TRACEFILE</i>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>dpa</b> is used to analyze dns packets in trace files. It has 3 main options:
  count, filter, and count uniques (i.e. count all different occurences).
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c</b> <i>expressionlist</i></dt>
  <dd class="It-tag">Count occurrences of matching expressions
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b> <i>expression</i></dt>
  <dd class="It-tag">Filter: only process packets that match the expression
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h</b></dt>
  <dd class="It-tag">Show usage
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p</b></dt>
  <dd class="It-tag">Show the total number of correct DNS packets, and
      percentage of -u and -c values (of the total of matching on the -f filter.
      if no filter is given, percentages are on all correct dns packets)
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-of</b> <i>file</i></dt>
  <dd class="It-tag">Write all packets that match the -f flag to file, as pcap
      data.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-ofh</b> <i>file</i></dt>
  <dd class="It-tag">Write all packets that match the -f flag to file, in
      hexadecimal format, readable by drill.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s</b></dt>
  <dd class="It-tag">Show possible match names
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s</b> <i>matchname</i></dt>
  <dd class="It-tag">show possible match operators and values for name
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-sf</b></dt>
  <dd class="It-tag">Only evaluate packets (in representation format) that match
      the -f filter. If no -f was given, evaluate all correct dns packets.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-u</b> <i>matchnamelist</i></dt>
  <dd class="It-tag">Count every occurence of every value of the matchname (for
      instance, count all packetsizes, see EXAMPLES in ldns-dpa(1) ).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-ua</b></dt>
  <dd class="It-tag">For every matchname in -u, show the average value of all
      matches. Behaviour for match types that do not have an integer value is
      undefined.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-uac</b></dt>
  <dd class="It-tag">For every matchname in -u, show the average number of times
      this value was encountered.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-um</b> <i>number</i></dt>
  <dd class="It-tag">Only show the results from -u for values that occurred more
      than &lt;number&gt; times.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v</b> <i>level</i></dt>
  <dd class="It-tag">Set verbosity to level (1-5, 5 being the highest). Mostly
      used for debugging.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-notip</b> <i>file</i></dt>
  <dd class="It-tag">Write packets that were not recognized as IP packets to
      file (as pcap data).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-baddns</b> <i>file</i></dt>
  <dd class="It-tag">Write dns packets that were too mangled to parse to file
      (as pcap data).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-version</b></dt>
  <dd class="It-tag">Show version and exit
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="LIST_AND_MATCHES"><a class="selflink" href="#LIST_AND_MATCHES">LIST
  AND MATCHES</a></h1>
A &lt;matchnamelist&gt; is a comma separated list of match names (use -s to see
  possible match names). A &lt;expressionlist&gt; is a comma separated list of
  expressions.
<div style="height: 1.00em;">&#x00A0;</div>
An expression has the following form: &lt;expr&gt;: (&lt;expr&gt;)
<br/>
 &lt;expr&gt; | &lt;expr&gt;
<br/>
 &lt;expr&gt; &amp; &lt;expr&gt;
<br/>
 &lt;match&gt;
<div style="height: 1.00em;">&#x00A0;</div>
&lt;match&gt;: &lt;matchname&gt; &lt;operator&gt; &lt;value&gt;
<div style="height: 1.00em;">&#x00A0;</div>
&lt;operator&gt;: 	=	equal to &lt;value&gt; 	!=	not equal to &lt;value&gt;
  	&gt;	greater than &lt;value&gt; 	&lt;	lesser than &lt;value&gt;
  	&gt;=	greater than or equal to &lt;value&gt; 	&lt;=	lesser than or equal to
  &lt;value&gt; 	~=	contains &lt;value&gt;
<div style="height: 1.00em;">&#x00A0;</div>
See the -s option for possible matchnames, operators and values.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag">ldns-dpa -u packetsize -p test.tr</dt>
  <dd class="It-tag">Count all different packetsizes in test.tr and show the
      precentages.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">ldns-dpa -f &quot;edns=1&amp;qr=0&quot; -of edns.tr
    test.tr</dt>
  <dd class="It-tag">Filter out all edns enable queries in test.tr and put them
      in edns.tr
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">ldns-dpa -f edns=1 -c tc=1 -u rcode test.tr</dt>
  <dd class="It-tag">For all edns packets, count the number of truncated packets
      and all their rcodes in test.tr.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">ldns-dpa -c tc=1,qr=0,qr=1,opcode=QUERY test.tr</dt>
  <dd class="It-tag">For all packets, count the number of truncated packets, the
      number of packets with qr=0, the number of packets with qr=1 and the
      number of queries in test.tr.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">ldns-dpa -u packetsize -ua test.tr</dt>
  <dd class="It-tag">Show all packet sizes and the average packet size per
      packet.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">ldns-dpa -u srcaddress -uac test.tr</dt>
  <dd class="It-tag">Show all packet source addresses and the average number of
      packets sent from this address.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">sudo tcpdump -i eth0 -s 0 -U -w - port 53 | ldns-dpa -f
    qr=0 -sf</dt>
  <dd class="It-tag">Print all query packets seen on the specified interface.
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Written by Jelte Jansen for NLnetLabs.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="REPORTING_BUGS"><a class="selflink" href="#REPORTING_BUGS">REPORTING
  BUGS</a></h1>
Report bugs to &lt;jelte@nlnetlabs.nl&gt;.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
Copyright (C) 2005 NLnet Labs. This is free software. There is NO warranty; not
  even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</div>
<table class="foot">
  <tr>
    <td class="foot-date">1 Nov 2005</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
