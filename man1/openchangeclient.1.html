<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:28:35 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>OPENCHANGECLIENT(1) OpenChange Users&rsquo; Manual
OPENCHANGECLIENT(1)</p>

<p style="margin-top: 1em">NAME <br>
openchangeclient - MAPI command line messaging tool</p>

<p style="margin-top: 1em">SYNOPSIS <br>
openchangeclient [-?SFmDV] [-?|--help] [--usage]
[-f|--database STRING] [--pf] <br>
[-p|--profile STRING] [-P|--password STRING] [-S|--sendmail]
[--sendappointment] <br>
[--sendcontact] [--sendtask] [--sendnote] [-F|--fetchmail]
[-G|--storemail STRING] <br>
[-i|--fetch-items STRING] [--freebusy=STRING] [--force]
[--delete=STRING] <br>
[-u|--update STRING] [-m|--mailbox] [-D|--deletemail]
[-A|--attachments STRING] <br>
[-I|--html-inline STRING] [-W|--html-file STRING] [-t|--to
STRING] [-c|--cc STRING] <br>
[-b|--bcc STRING] [-s|--subject STRING] [-B|--body STRING]
[--location=STRING] <br>
[--label=STRING] [--dtstart=STRING] [--dtend=STRING]
[--busystatus=STRING] <br>
[--taskstatus=STRING] [--importance=STRING] [--email=STRING]
[--fullname=STRING] <br>
[--cardname=STRING] [--color=STRING] [--notifications]
[--folder=STRING] [--mkdir] <br>
[--rmdir] [--userlist] [--folder-name=STRING]
[--folder-comment=STRING] <br>
[-d|--debuglevel STRING] [--dump-data] [--private]
[--ocpf-file=STRING] <br>
[--ocpf-dump=STRING] [--ocpf-syntax] [--ocpf-sender]
[-V|--version]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
openchangeclient is a MAPI command line tool designed to
facilitate mail send, receive and delete operations using
the MAPI protocol. It also provides operations on tasks,
con&acirc; <br>
tacts (address book) and calendar operations.</p>

<p style="margin-top: 1em">COMMANDS <br>
--fetchmail</p>

<p style="margin-top: 1em">-F Fetch Exchange user mails
from the inbox and display general information from the
mails on the standard output.</p>

<p style="margin-top: 1em">--storemail=DIRECTORY</p>

<p style="margin-top: 1em">-G Store mail attachments to the
local filesystem in the specified directory. This is the
normal way to retrieve attachments.</p>

<p style="margin-top: 1em">--fetch-items=STRING</p>

<p style="margin-top: 1em">-i Retrieve specific items from
Exchange default folders. Possible value for STRING are
Mail, Appointment, Contact, Task, Note.</p>

<p style="margin-top: 1em">--mkdir <br>
Create a folder within the mailbox or public folders store
hierarchy. This command requires that the --folder-name
option be used to specify the name of the folder to
cre&acirc; <br>
ate.</p>

<p style="margin-top: 1em">--rmdir <br>
Deletes a folder within the mailbox or public folders store
hierarchy. This option requires that the --folder-name
option be used to specify the name of the folder to <br>
delete.</p>

<p style="margin-top: 1em">--mailbox</p>

<p style="margin-top: 1em">-m Display the user mailbox
folder hierarchy with folder names, folder comments, the
folder type, number of unread items in the folder and total
number of items in the <br>
folder.</p>

<p style="margin-top: 1em">--notifications <br>
Monitor NEWMAIL notifications in the Inbox folder and
display summary on standard output.</p>

<p style="margin-top: 1em">--sendmail</p>

<p style="margin-top: 1em">-S Send a mail to a user
belonging to the Exchange organization. This requires
specifying one or more recipients (see the --to, --cc and
--bcc options), a subject (see the <br>
--subject option) and a body (see the --body, --html-file
and --html-inline options).</p>

<p style="margin-top: 1em">--sendappointment <br>
Create an appointment in the default calendar folder.</p>

<p style="margin-top: 1em">--sendcontact <br>
Create a contact in the default contact folder.</p>

<p style="margin-top: 1em">--sendtask <br>
Create a task in the default task folder.</p>

<p style="margin-top: 1em">--sendnote <br>
Create a note in the default notes folder.</p>

<p style="margin-top: 1em">--deletemail</p>

<p style="margin-top: 1em">-D Delete a mail from the
exchange user mailbox. This requires use of the --subject
option to specify the mail to be deleted.</p>

<p style="margin-top: 1em">--userlist <br>
Display the users listed in the address book.</p>

<p style="margin-top: 1em">--delete=STRING <br>
Delete a specified item from the store by ID number.</p>

<p style="margin-top: 1em">--ocpf-dump=STRING <br>
Download a message (specified by the argument, which must be
the folder ID and unique message ID for the message) as OCPF
format. The message will be saved to a file <br>
given by the message ID, followed by a suffix of .ocpf</p>

<p style="margin-top: 1em">See the separate (HTML)
documentation for libocpf for more information on the OCPF
format.</p>

<p style="margin-top: 1em">--ocpf-sender <br>
Send a message given in OCPF format to the server. This
requires use of the --ocpf-file option to specify the file
to load from.</p>

<p style="margin-top: 1em">See the separate (HTML)
documentation for libocpf for more information on the OCPF
format.</p>

<p style="margin-top: 1em">--ocpf-syntax <br>
Check the syntax of an OCPF file. This does not perform any
network operations. This requires use of the --ocpf-file
option to specify the file to load from.</p>

<p style="margin-top: 1em">See the separate (HTML)
documentation for libocpf for more information on the OCPF
format.</p>

<p style="margin-top: 1em">--freebusy=STRING <br>
Fetch the free / busy status for the user specified by the
string. You will usually need to use the --pf option (see
below) since free / busy status is normally obtained <br>
from the public folder store.</p>

<p style="margin-top: 1em">OPTIONS <br>
--database=DATABASE</p>

<p style="margin-top: 1em">-f Set the MAPI profile
database. If no database is specified, then openchangeclient
tries to load the default one:
$HOME/.openchange/profiles.ldb</p>

<p style="margin-top: 1em">--profile=PROFILE</p>

<p style="margin-top: 1em">-p Set the profile to use. If a
profile is not specified, and one of the profiles has been
set as the default in the profile database (for example,
using mapiprofile -S), <br>
then that default profile will be used.</p>

<p style="margin-top: 1em">--password</p>

<p style="margin-top: 1em">-P Specify the password for the
profile to be used. This can be omitted if the password is
stored in the profile.</p>

<p style="margin-top: 1em">--pf Perform operations against
the Public Folders store, rather than the normal operations
against a user&rsquo;s private folders.</p>

<p style="margin-top: 1em">--folder <br>
Specify the folder name we want to work with want to open.
This option is mandatory for public folders, but can also be
used to open specific folders in the mailbox store.</p>


<p style="margin-top: 1em">--attachments=&quot;ATTACHMENT1;ATTACHMENT2&quot;</p>

<p style="margin-top: 1em">-A Set attachments to send when
sending a mail. Attached filenames need to be separated with
semi-colons as specified in the description above. This is
only meaningful with <br>
--sendmail</p>

<p style="margin-top: 1em">--subject=STRING</p>

<p style="margin-top: 1em">-s Specify the mail subject. If
no subject is specified, the mail subject will be empty.
This is only meaningful with --sendmail</p>

<p style="margin-top: 1em">--body=STRING</p>

<p style="margin-top: 1em">-B Set the body of the mail to
be the UTF8 text only content specified on the command line.
This is only meaningful with --sendmail</p>

<p style="margin-top: 1em">--html-inline=STRING</p>

<p style="margin-top: 1em">-I Set the body of the mail to
be the HTML content specified on command line. This is only
meaningful with --sendmail</p>

<p style="margin-top: 1em">--html-file=FILENAME</p>

<p style="margin-top: 1em">-W Set the body of the mail to
be the content of the specified file. This is only
meaningful with --sendmail</p>


<p style="margin-top: 1em">--to=&quot;USERNAME1,USERNAME2&quot;</p>

<p style="margin-top: 1em">-t Specify To recipients for the
mail. Usernames need to be separated with commas as
specified in the example above. This is only meaningful with
--sendmail</p>


<p style="margin-top: 1em">--cc=&quot;USERNAME1,USERNAME2&quot;</p>

<p style="margin-top: 1em">-c Specify Cc recipients for the
mail. Usernames need to be separated with commas as
specified in the example above. This is only meaningful with
--sendmail</p>


<p style="margin-top: 1em">--bcc=&quot;USERNAME1,USERNAME2&quot;</p>

<p style="margin-top: 1em">-b Specify Bcc recipients for
the mail. Usernames need to be separated with commas as
specified in the example above. This is only meaningful with
--sendmail</p>

<p style="margin-top: 1em">--location=STRING <br>
Specify the appointment location. This is only meaningful
with --sendappointment</p>

<p style="margin-top: 1em">--dtstart=STRING <br>
Specify the start date of an event. The following date
format needs to be used: %Y-%m-%d %H:%M:%S e.g: 2007-06-01
14:59:00. This is only meaningful with --sendappointment
<br>
and --sendtask</p>

<p style="margin-top: 1em">--dtend=STRING <br>
Specify either the end date or due date of an event. The
following date format needs to be used: %Y-%m-%d %H:%M:%S
e.g: 2007-06-01 14:59:00 When no dtend parameter is <br>
specified, default value is set to dtstart This is only
meaningful with --sendappointment and --sendtask</p>

<p style="margin-top: 1em">--force <br>
Add appointment to the calendar, even if it would overlap
with an existing appointment. This is only meaningful with
--sendappointment</p>

<p style="margin-top: 1em">--private <br>
Mark the appointment as private event. This is only
meaningful with --sendappointment</p>

<p style="margin-top: 1em">--busystatus=STRING <br>
Set the busy status of an appointment. Possible values are
FREE, TENTATIVE, BUSY or OUTOFOFFICE. This is only
meaningful with --sendappointment</p>

<p style="margin-top: 1em">--label=STRING <br>
Set the type of appointment. Possible values are NONE,
IMPORTANT, BUSINESS, PERSONAL, VACATION, MUST_ATTEND,
TRAVEL_REQUIRED, NEEDS_PREPARATION, BIRTHDAY, ANNIVERSARY
and <br>
PHONE_CALL. This is only meaningful with
--sendappointment</p>

<p style="margin-top: 1em">--taskstatus=STRING <br>
Set the status of a task. Possible values are NOTSTARTED,
PROGRESS, COMPLETED, WAITING, DEFERRED. This is only
meaningful with --sendtask</p>

<p style="margin-top: 1em">--fullname=STRING <br>
Set the full name in a contact message. This is only
meaningful with --sendcontact</p>

<p style="margin-top: 1em">--cardname=STRING <br>
Set the card name of a task or contact message. This is only
meaningful with --sendcontact or --sendtask</p>

<p style="margin-top: 1em">--email=STRING <br>
Set the email address in a contact message. This is only
meaningful with --sendcontact</p>

<p style="margin-top: 1em">--importance=STRING <br>
Set the relative importance of a task. Possible values are
LOW, NORMAL and HIGH. This is only meaningful with
--sendtask</p>

<p style="margin-top: 1em">--color=STRING <br>
Set the color of the note. The default color is Yellow.
Other options are Blue, Green, Pink and White. This is only
meaningful with --sendnote</p>

<p style="margin-top: 1em">--folder-name=STRING <br>
Set the folder name to create. This is only meaningful with
--mkdir or --rmdir</p>

<p style="margin-top: 1em">--folder-comment=STRING <br>
Set the folder comment. This is only meaningful with
--mkdir</p>

<p style="margin-top: 1em">--update=STRING</p>

<p style="margin-top: 1em">-u Change (update) an existing
item, rather than creating a new one. This is only
meaningful with --sendtask , --sendnote , --sendappointment
and --sendcontact</p>

<p style="margin-top: 1em">--ocpf-file=STRING <br>
Specify the file to load OCPF data from. This is only
meaningful with --ocpf-sender and --ocpf-syntax</p>

<p style="margin-top: 1em">--dump-data <br>
Display raw format data associated with the operation. You
normally only need this when debugging.</p>

<p style="margin-top: 1em">--debug-level=LEVEL <br>
Display debugging information at the specified level (or
higher). Level 10 is a lot of debug information.</p>

<p style="margin-top: 1em">EXAMPLES <br>
Fetching emails: <br>
openchangeclient --database=/tmp/profiles.ldb --profile=2000
--fetchmail</p>

<p style="margin-top: 1em">Fetch emails and store
attachments: <br>
openchangeclient --database=/tmp/profiles.ldb --profile=2000
--fetchmail --storemail=test</p>

<p style="margin-top: 1em">All attachments from any mails
will be stored in the test directory. If the specified
directory does not exist, it will automatically be created.
Note that if the attachment name <br>
is not unique amongst all emails, some attachments may be
overwritten.</p>

<p style="margin-top: 1em">Send a basic email: <br>
openchangeclient --database=/tmp/profiles.ldb --profile=2000
<br>
--to=&quot;Adm,jker&quot; --cc=Paul --bcc=Bill <br>
--subject=&quot;It is working&quot; <br>
--body=&quot;This is a sample body&quot; --sendmail</p>

<p style="margin-top: 1em">A mail with UTF8 (text only)
content will be sent with the following recipients:</p>

<p style="margin-top: 1em">to = Administrator and
jkerihuel</p>

<p style="margin-top: 1em">cc = Paul</p>

<p style="margin-top: 1em">bcc = Bill</p>

<p style="margin-top: 1em">Send an inline HTML email: <br>
openchangeclient --database=/tmp/profiles.ldb --profile=2000
<br>
--to=Adm --subject=&quot;Inline HTML sample email&quot; <br>
--html-inline=&quot;&lt;body bgcolor=yellow&gt;&lt;h1&gt;My
first HTML email&lt;/h1&gt;&lt;/body&gt;&quot; <br>
--sendmail</p>

<p style="margin-top: 1em">Administrator will receive a
mail with HTML body - yellow background and a title.</p>

<p style="margin-top: 1em">Send a HTML mail using a file:
<br>
openchangeclient --database=/tmp/profiles.ldb --profile=2000
<br>
--to=Adm --subject=&quot;HTML file email&quot; <br>
--html-file=/tmp/myfile.html <br>
--sendmail</p>

<p style="margin-top: 1em">The content of /tmp/myfile.html
will be used to fill the HTML body. If the HTML file exceed
a fixed size (0x4000 bytes), then PR_HTML content will be
sent using MAPI streams.</p>

<p style="margin-top: 1em">Send email with attachments:
<br>
openchangeclient --database=/tmp/profiles.ldb --profile=2000
<br>
--to=Adm --subject=&quot;Attachments&quot; <br>

--attachments=&quot;/tmp/file1.jpg;/tmp/file2.jpg;tmp/file2.jpg&quot;
<br>
--body=&quot;These are sample attachments&quot; <br>
--sendmail</p>

<p style="margin-top: 1em">The example above will send a
UTF8 body mail to Administrator and attach file1,jpg,
file2.jpg and file3.jpg to the email.</p>

<p style="margin-top: 1em">Display the users in the address
book <br>
openchangeclient --userlist</p>

<p style="margin-top: 1em">Fetch calendar items: <br>
openchangeclient --fetch-items=Appointment</p>

<p style="margin-top: 1em">Fetch contact items: <br>
openchangeclient --fetch-items=Contact</p>

<p style="margin-top: 1em">Fetch task items: <br>
openchangeclient --fetch-items=Task</p>

<p style="margin-top: 1em">Create appointment: <br>
openchangeclient --sendappointment
--dtstart=&quot;2007-06-01 22:00:00&quot;
--dtend=&quot;2007-06-01 22:35:00&quot; --busystatus=FREE
--location=&quot;Home&quot; --subject=&quot;Check the Junk
folder&quot;</p>

<p style="margin-top: 1em">Create Task: <br>
openchangeclient --sendtask --dtstart=&quot;2008-11-01
18:00:00&quot; --cardname=&quot;openchangeclient&quot;
--importance=HIGH --taskstatus=COMPLETED --body=&quot;my new
task&quot;</p>

<p style="margin-top: 1em">Create contact: <br>
openchangeclient --sendcontact
--cardname=&quot;openchangeclient&quot;
--fullname=&quot;OpenChange Client 3rd&quot;
--email=&quot;openchangeclient@nonexistentdomain.com&quot;</p>

<p style="margin-top: 1em">Create folder: <br>
openchangeclient --mkdir
--folder-name=&quot;openchange&quot;
--folder-comment=&quot;comment&quot;</p>

<p style="margin-top: 1em">This example will create a
generic folder named openchange under the Inbox folder.</p>

<p style="margin-top: 1em">Delete folder: <br>
openchangeclient --rmdir
--folder-name=&quot;openchange&quot;</p>

<p style="margin-top: 1em">This example will delete the
generic folder named openchange under Inbox folder.</p>

<p style="margin-top: 1em">List Mailbox hierarchy: <br>
openchangeclient --mailbox</p>

<p style="margin-top: 1em">Obtain free / busy status <br>
openchangeclient --pf --freebusy=&quot;test user3&quot;</p>

<p style="margin-top: 1em">AUTHOR <br>
Julien Kerihuel &lt;j.kerihuel at openchange dot org&gt;</p>

<p style="margin-top: 1em">OpenChange 2.0 QUADRANT
2013-01-24 OPENCHANGECLIENT(1)</p>
<hr>
</body>
</html>
