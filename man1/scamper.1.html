<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:36:54 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>SCAMPER(1) BSD General Commands Manual SCAMPER(1)</p>

<p style="margin-top: 1em">NAME <br>
scamper &acirc; parallel Internet measurement utility</p>

<p style="margin-top: 1em">SYNOPSIS <br>
scamper [-?Dv] [-c command] [-p pps] [-w window] [-M
monitorname] [-l listname] [-L listid] [-C cycleid] [-o
outfile] [-F firewall] [-d debugfile] [-e pidfile] [-O
options] <br>
[-i IPs | -I cmds | -f file | -P [ip:]port | -U
unix-dom]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
The scamper utility provides the ability to execute Internet
measurement techniques to IPv4 and IPv6 addresses, in
parallel, to fill a specified packets-per-second rate.
Cur&acirc; <br>
rently, scamper supports the well-known traceroute and ping
techniques, as well as MDA traceroute, alias resolution,
some parts of tbit, sting, and neighbour discovery.</p>

<p style="margin-top: 1em">scamper has four modes of
operation. First, scamper can be supplied a list of
addresses on the command line with the -i option. scamper
will then execute a command with each of <br>
the supplied addresses, in parallel, and output the results
as each task completes. Second, scamper can be supplied a
list of addresses in a listfile, one address per line, using
<br>
the -f option. Third, scamper can be supplied a list of
complete commands on the command line with the -I option.
Finally, scamper can be instructed to listen on an IP
address <br>
and port specified with the -P option, or on a unix domain
socket specified with the -U option, where it can take
commands dynamically.</p>

<p style="margin-top: 1em">The options are as follows:</p>

<p style="margin-top: 1em">-? prints a list of command line
options and a synopsis of each.</p>

<p style="margin-top: 1em">-v causes scamper to output
version information and exit.</p>

<p style="margin-top: 1em">-D With this option set, scamper
will detach and become a daemon. Use with the -P or -U
options.</p>

<p style="margin-top: 1em">-c command <br>
specifies the command for scamper to use by default. The
current choices for this option are: <br>
- dealias <br>
- neighbourdisc <br>
- ping <br>
- trace <br>
- tracelb <br>
- sniff <br>
- sting <br>
- tbit <br>
scamper uses trace by default. The available commands and
their options are documented below.</p>

<p style="margin-top: 1em">-p pps specifies the target
packets-per-second rate for scamper to reach. By default,
this value is 20.</p>

<p style="margin-top: 1em">-w window <br>
specifies the maximum number of tasks that may be probed in
parallel. A value of zero places no upper limit. By default,
zero is used.</p>

<p style="margin-top: 1em">-M monitorname <br>
specifies the canonical name of machine where scamper is
run. This value is used when recording the output in a warts
output file.</p>

<p style="margin-top: 1em">-l listname <br>
specifies the name of the list when run from the command
line. This value is used when recording the output in a
warts output file.</p>

<p style="margin-top: 1em">-L listid <br>
specifies the numerical id of the list when run from the
command line. This value is used when recording the output
in a warts output file.</p>

<p style="margin-top: 1em">-C cycleid <br>
specifies the numerical cycle id to begin with when run from
the command line. This value is used when recording the
output in a warts output file.</p>

<p style="margin-top: 1em">-o outfile <br>
specifies the default output file to write measurement
results to. By default, stdout is used.</p>

<p style="margin-top: 1em">-F firewall <br>
specifies that scamper may use the firewall in measurements
that require it (tbit and sting). scamper supports two
firewall types: IPFW, and PF. To use the IPFW firewall, <br>
pass ipfw:&lt;start&gt;-&lt;end&gt;, where &lt;start&gt; is
the first rule scamper can use, and &lt;end&gt; is the last.
To use the PF firewall, pass pf:&lt;anchor&gt;:&lt;num&gt;,
where &lt;anchor&gt; is the <br>
anchor for scamper to use, and &lt;num&gt; specifies the
number of rules scamper is allowed to use.</p>

<p style="margin-top: 1em">-d debugfile <br>
specifies a filename to write debugging messages to. By
default, no debugfile is used, though debugging output is
sent to stderr if scamper is built for debugging.</p>

<p style="margin-top: 1em">-e pidfile <br>
specifies a file to write scamper&rsquo;s process ID to. If
scamper is built with privilege separation, the ID of the
unprivileged process is written.</p>

<p style="margin-top: 1em">-O options <br>
allows scamper&rsquo;s behaviour to be further tailored. The
current choices for this option are: <br>
- text: output results in plain text. Suitable for
interactive use. <br>
- warts: output results in warts format. Suitable for
archiving measurement results and for use by researchers as
it records details that cannot be easily represented <br>
with the text option. <br>
- json: output results in json format. Suitable for
processing measurement results with a scripting language. A
better approach is to output results in warts format, <br>
and to use sc_warts2json(1). <br>
- planetlab: tell scamper it is running on a planetlab
system. Necessary to use planetlab&rsquo;s safe raw sockets.
<br>
- rawtcp: tell scamper to use IPPROTO_RAW socket to send
IPv4 TCP probes, rather than a datalink socket. <br>
- select: tell scamper to use select(2) rather than poll(2)
<br>
- kqueue: tell scamper to use kqueue(2) rather than poll(2)
on systems where kqueue(2) is available. <br>
- epoll: tell scamper to use epoll(7) rather than poll(2) on
systems where epoll(7) is available. <br>
- tsps: the input file consists of a sequence of IP
addresses for pre-specified IP timestamps. <br>
- cmdfile: the input file consists of complete commands.
<br>
- noinitndc: do not initialise the neighbour discovery
cache. <br>
- outcopy: write a copy of all data written by scamper with
the default output method. <br>
- debugfileappend: append to the debugfile specified with
the -d option. The default is to truncate the debugfile.
<br>
- notls: do not use TLS anywhere in scamper, including
tbit.</p>

<p style="margin-top: 1em">-i IP 1..N <br>
specifies the addresses to probe, on the command line, using
the command specified with the -c option.</p>

<p style="margin-top: 1em">-f listfile <br>
specifies the input file to read for target addresses, one
per line, and uses the command specified with the -c option
on each.</p>

<p style="margin-top: 1em">-I cmds. <br>
specifies complete commands, including target addresses, for
scamper to execute.</p>

<p style="margin-top: 1em">-P [ip:]port <br>
specifies that scamper provide a control socket listening on
the specified IP address and port on the local host. If an
IP address is not specified, scamper will bind to <br>
the port specified on the loopback address.</p>

<p style="margin-top: 1em">-U unix domain socket <br>
specifies that scamper provide a control socket listening on
the specified socket in the unix domain.</p>

<p style="margin-top: 1em">TRACE OPTIONS <br>
The trace command is used for conducting traceroute. The
following variations of the traceroute(8) options are
available:</p>

<p style="margin-top: 1em">trace [-MQT] [-c confidence] [-d
dport] [-f firsthop] [-g gaplimit] [-G gapaction] [-l loops]
[-m maxttl] [-o offset] [-O option] [-p payload] [-P method]
[-q attempts] [-s sport] <br>
[-S srcaddr] [-t tos] [-U userid] [-w wait] [-W wait-probe]
[-z gss-entry] [-Z lss-name]</p>

<p style="margin-top: 1em">-c confidence <br>
specifies that a hop should be probed to a specified
confidence level (95% or 99%) to be sure the trace has seen
all interfaces that will reply for that hop.</p>

<p style="margin-top: 1em">-d dport <br>
specifies the base destination port value to use for
UDP-based and TCP-based traceroute methods. For ICMP-paris,
this option sets the ICMP checksum value.</p>

<p style="margin-top: 1em">-f firsthop <br>
specifies the TTL or HLIM value to begin probing with. By
default, a first hop of one is used.</p>

<p style="margin-top: 1em">-g gaplimit <br>
specifies the number of unresponsive hops permitted until a
check is made to see if the destination will respond. By
default, a gap limit of 5 hops is used. Setting the <br>
gap limit to 0 disables the gap limit, but doing this is not
recommended.</p>

<p style="margin-top: 1em">-G gapaction <br>
specifies what should happen if the gaplimit condition is
met. A value of 1 (default) means halt probing, while a
value of 2 means send last-ditch probes.</p>

<p style="margin-top: 1em">-m maxttl <br>
specifies the maximum TTL or HLIM value that will be probed.
By default, there is no restriction, apart from the 255 hops
that the Internet protocols allow.</p>

<p style="margin-top: 1em">-M specifies that path MTU
discovery (PMTUD) should be attempted for the path when the
initial traceroute completes. scamper will not conduct PMTUD
unless it is probing a <br>
responsive destination, as otherwise there is no way to
distinguish all packets being lost from just big packets
(larger than MTU) being lost.</p>

<p style="margin-top: 1em">-l loops <br>
specifies the maximum number of loops permitted until
probing stops. By default, a value of one is used. A value
of zero disables loop checking.</p>

<p style="margin-top: 1em">-o offset <br>
specifies the fragmentation offset to use in probes. By
default, no offset is used.</p>

<p style="margin-top: 1em">-O option <br>
specifies optional arguments to use. The current choices for
this option are: <br>
- dl specifies that the datalink socket should be used to
timestamp packets, and to receive certain packets. <br>
- dtree-noback specifies that the traceroute should not do
backwards probing when using doubletree.</p>

<p style="margin-top: 1em">-p payload <br>
specifies the payload of the probe to use as a base. The
payload is specified in hexadecimal. Note that the payload
supplied is merely a base; the first 2 bytes may be <br>
modified to accomplish ICMP-Paris and UDP-Paris
traceroute.</p>

<p style="margin-top: 1em">-P method <br>
specifies the traceroute method to use. scamper currently
supports five different probe methods: UDP, ICMP, UDP-paris,
ICMP-paris, TCP, and TCP-ACK. By default, UDP-paris <br>
is used.</p>

<p style="margin-top: 1em">-q attempts <br>
specifies the maximum number of attempts to obtain a
response per hop. By default, a value of two is used.</p>

<p style="margin-top: 1em">-Q specifies that all allocated
probes are sent, regardless of how many responses have been
received.</p>

<p style="margin-top: 1em">-s sport <br>
specifies the source port value to use. For ICMP-based
methods, this option specifies the ICMP identifier to
use.</p>

<p style="margin-top: 1em">-S srcaddr <br>
specifies the source address to use in probes. The address
cannot be spoofed.</p>

<p style="margin-top: 1em">-t tos specifies the value to
set in the IP ToS/DSCP + ECN byte. By default, this byte is
set to zero.</p>

<p style="margin-top: 1em">-T specifies that time exceeded
messages from the destination do not cause the trace to be
defined as reaching the destination.</p>

<p style="margin-top: 1em">-U userid <br>
specifies an unsigned integer to include with the data
collected; the meaning of the user-id is entirely up to the
user and has no effect on the behaviour of traceroute.</p>

<p style="margin-top: 1em">-w wait <br>
specifies how long to wait, in seconds, for a reply. By
default, a value of 5 is used.</p>

<p style="margin-top: 1em">-W wait-probe <br>
specifies the minimum time to wait, in 10s of milliseconds,
between sending consecutive probes. By default the next
probe is sent as soon as possible.</p>

<p style="margin-top: 1em">-z gss-entry <br>
specifies an IP address to halt probing when encountered;
used with the double-tree algorithm.</p>

<p style="margin-top: 1em">-Z lss-name <br>
specifies the name of the local stop set to use when
determining when to halt probing backwards; used with the
double-tree algorithm.</p>

<p style="margin-top: 1em">PING OPTIONS <br>
The ping command is used for conducting ping. The following
variations of the ping(8) options are available:</p>

<p style="margin-top: 1em">ping [-R] [-B payload] [-c
probecount] [-C icmp-sum] [-d dport] [-F sport] [-i wait]
[-m ttl] [-M MTU] [-o replycount] [-O options] [-p pattern]
[-P method] [-s size] [-S srcaddr] <br>
[-T timestamp] [-U userid] [-W timeout] [-z tos]</p>

<p style="margin-top: 1em">-B payload <br>
specifies, in a hexadecimal string, the payload to include
in each probe.</p>

<p style="margin-top: 1em">-c probecount <br>
specifies the number of probes to send before exiting. By
default, a value of 4 is used.</p>

<p style="margin-top: 1em">-C icmp-sum <br>
specifies the ICMP checksum to use when sending a probe. The
payload of each probe will be manipulated so that the
checksum is valid.</p>

<p style="margin-top: 1em">-d dport <br>
specifies the destination port to use in each TCP/UDP probe,
and the first ICMP sequence number to use in ICMP
probes.</p>

<p style="margin-top: 1em">-F sport <br>
specifies the source port to use in each TCP/UDP probe, and
the ICMP ID to use in ICMP probes.</p>

<p style="margin-top: 1em">-i wait <br>
specifies the length of time to wait, in seconds, between
probes. By default, a value of 1 is used.</p>

<p style="margin-top: 1em">-m ttl specifies the TTL value
to use for outgoing packets. By default, a value of 64 is
used.</p>

<p style="margin-top: 1em">-M MTU specifies a pseudo MTU
value. If the response packet is larger than the pseudo MTU,
an ICMP packet too big (PTB) message is sent.</p>

<p style="margin-top: 1em">-o replycount <br>
specifies the number of replies required at which time
probing may cease. By default, all probes are sent.</p>

<p style="margin-top: 1em">-O options <br>
The current choices for this option are: <br>
- dl specifies that the ping should use datalink sockets,
rather than raw sockets. <br>
- spoof specifies that the source address is to be spoofed
according to the address specified with the -S option. The
address scamper would otherwise use as the source <br>
address is embedded in the payload of the probe. <br>
- tbt specifies that the goal of the ping is to obtain
fragmented responses, so that the -c option specifies how
many packets to send, and the -o option specifies how <br>
many fragmented responses are desired.</p>

<p style="margin-top: 1em">-p pattern <br>
specifies the pattern, in hex, to use in probes. Up to 16
bytes may be specified. By default, each probe&rsquo;s bytes
are zeroed.</p>

<p style="margin-top: 1em">-P method <br>
specifies the type of ping packets to send. By default, ICMP
echo requests are sent. Choices are: icmp-echo, icmp-time,
tcp-syn, tcp-ack, tcp-ack-sport, udp, and udp- <br>
dport.</p>

<p style="margin-top: 1em">-R specifies that the record
route IP option should be used.</p>

<p style="margin-top: 1em">-s size <br>
specifies the size of the probes to send. The probe size
includes the length of the IP and ICMP headers. By default,
a probe size of 84 bytes is used for IPv4 pings, and <br>
56 bytes for IPv6 pings.</p>

<p style="margin-top: 1em">-S srcaddr <br>
specifies the source address to use in probes. The address
can be spoofed if -O spoof is included.</p>

<p style="margin-top: 1em">-T timestamp <br>
specifies that an IP timestamp option be included. The
timestamp option can either be: tsprespec where IP addresses
of devices of interest can be specified; tsonly, where <br>
timestamps are embedded by devices but no IP addresses are
included; and tsandaddr, where timestamps and IP addresses
are included by devices in the path. See the examples <br>
section for more information.</p>

<p style="margin-top: 1em">-U userid <br>
specifies an unsigned integer to include with the data
collected; the meaning of the user-id is entirely up to the
user and has no effect on the behaviour of ping.</p>

<p style="margin-top: 1em">-W timeout <br>
specifies how long to wait for responses after the last ping
is sent. By default this is one second.</p>

<p style="margin-top: 1em">-z tos specifies the value to
use in the IPv4 ToS/DSCP + ECN byte. By default, this byte
is set to zero.</p>

<p style="margin-top: 1em">DEALIAS OPTIONS <br>
The dealias command is used to send probes for the purpose
of alias resolution. It supports the mercator technique,
where aliases are inferred if a router uses a different
address <br>
when sending an ICMP response; the ally technique, where
aliases are inferred if a sequence of probes sent to
alternating IP addresses yields responses with incrementing,
inter&acirc; <br>
leaved IP-ID values; radargun, where probes are sent to a
set of IP addresses in multiple rounds and aliases are
inferred by post-processing the results; prefixscan, where
an alias <br>
is searched in a prefix for a specified IP address; and
bump, where two addresses believed to be aliases are probed
in an effort to force their IP-ID values out of sequence.
The <br>
following options are available for the scamper dealias
command:</p>

<p style="margin-top: 1em">dealias [-d dport] [-f fudge]
[-m method] [-o replyc] [-O option] [-p probe-options] [-q
attempts] [-r wait-round] [-s sport] [-t ttl] [-U userid]
[-w wait-timeout] [-W wait-probe] <br>
[-x exclude]</p>

<p style="margin-top: 1em">-d dport <br>
specifies the destination port to use when sending probes.
Only valid for the mercator technique; destination ports can
be specified in probedefs defined with -p for other <br>
alias resolution methods.</p>

<p style="margin-top: 1em">-f fudge <br>
specifies a fudge factor for alias matching. Defaults to
200. Only valid for ally and bump.</p>

<p style="margin-top: 1em">-m method <br>
specifies which method to use for alias resolution. Valid
options are: ally, bump, mercator, prefixscan, and
radargun.</p>

<p style="margin-top: 1em">-o replyc <br>
specifies how many replies to wait for. Only valid for
prefixscan.</p>

<p style="margin-top: 1em">-O option <br>
allows alias resolution behaviour to be further tailored.
The current choices for this option are: <br>
- inseq where IP-ID values are required to be strictly in
sequence (with no tolerance for packet reordering) <br>
- shuffle randomise the order of probes sent each round;
only valid for radargun probing. <br>
- nobs do not allow for byte swapped IP-ID values in
responses. Valid for ally and prefixscan.</p>

<p style="margin-top: 1em">-p probedef <br>
specifies a definition for a probe. Possible options
are:</p>

<p style="margin-top: 1em">-c sum specifies what ICMP
checksum to use for ICMP probes. The payload of the probe
will be altered appropriately.</p>

<p style="margin-top: 1em">-d dst-port <br>
specifies the destination port of the probe. Defaults to
33435.</p>

<p style="margin-top: 1em">-F src-port <br>
specifies the source port of the probe. Defaults to (pid
&amp; 0x7fff) + 0x8000.</p>

<p style="margin-top: 1em">-i IP specifies the destination
IP address of the probe.</p>

<p style="margin-top: 1em">-M mtu specifies the pseudo MTU
to use when soliciting fragmented responses.</p>

<p style="margin-top: 1em">-P method <br>
specifies which method to use for the probe. Valid options
are: udp, udp-dport, tcp-ack, tcp-ack-sport, tcp-syn-sport,
and icmp-echo.</p>

<p style="margin-top: 1em">-s size <br>
specifies the size of the probes to send.</p>

<p style="margin-top: 1em">-t ttl specifies the IP time to
live of the probe. <br>
The ally method accepts up to two probe definitions; the
prefixscan method expects one probe definition; radargun
expects at least one probe definition; bump expects two <br>
probe definitions.</p>

<p style="margin-top: 1em">-q attempts <br>
specifies how many times a probe should be retried if it
does not obtain a useful response.</p>

<p style="margin-top: 1em">-r wait-round <br>
specifies how many milliseconds to wait between probing
rounds with radargun.</p>

<p style="margin-top: 1em">-s sport <br>
specifies the source port to use when sending probes. Only
valid for mercator.</p>

<p style="margin-top: 1em">-t ttl specifies the
time-to-live of probes sent. Only valid for mercator.</p>

<p style="margin-top: 1em">-U userid <br>
specifies an unsigned integer to include with the data
collected; the meaning of the user-id is entirely up to the
user and has no effect on the behaviour of dealias.</p>

<p style="margin-top: 1em">-w wait-timeout <br>
specifies how long to wait in seconds for a reply from the
remote host.</p>

<p style="margin-top: 1em">-W wait-probe <br>
specifies how long to wait in milliseconds between
probes.</p>

<p style="margin-top: 1em">-x exclude <br>
specifies an IP address to exclude when using the prefixscan
method. May be specified multiple times to exclude multiple
addresses.</p>

<p style="margin-top: 1em">NEIGHBOUR DISCOVERY OPTIONS <br>
The neighbourdisc command attempts to find the layer-2
address of a given IP address using IPv4 ARP or IPv6
Neighbour Discovery. The following options are available for
the <br>
scamper neighbourdisc command:</p>

<p style="margin-top: 1em">neighbourdisc [-FQ] [-i
interface] [-o reply-count] [-q attempts] [-w wait]</p>

<p style="margin-top: 1em">-F specifies that we only want
the first response.</p>

<p style="margin-top: 1em">-Q specifies that we want to
send all attempts.</p>

<p style="margin-top: 1em">-i interface <br>
specifies the name of the interface to use for neighbour
discovery.</p>

<p style="margin-top: 1em">-o reply-count <br>
specifies how many replies we wait for.</p>

<p style="margin-top: 1em">-q attempts <br>
specifies how many probes we send out.</p>

<p style="margin-top: 1em">-w wait <br>
specifies how long to wait between probes in milliseconds.
Defaults to 1000.</p>

<p style="margin-top: 1em">TBIT OPTIONS <br>
The tbit command can be used to infer TCP behaviour of a
specified host. At present, it implements tests to check the
ability of the host to respond to ICMP Packet Too Big
mes&acirc; <br>
sages, and respond to Explicit Congestion Notification. The
following options are available for the scamper tbit
command:</p>

<p style="margin-top: 1em">tbit [-t type] [-p app] [-d
dport] [-s sport] [-b ASN] [-f cookie] [-m mss] [-M mtu] [-o
offset] [-O option] [-P ptbsrc] [-q attempts] [-S srcaddr]
[-T ttl] [-u url] [-U userid] <br>
[-w wscale]</p>

<p style="margin-top: 1em">-t type specifies which type of
testing to use. Valid options are: pmtud, ecn, null,
sack-rcvr, icw, blind-rst, blind-syn, blind-data.</p>

<p style="margin-top: 1em">-p app specifies what kind of
traffic to generate for testing. Destination port defaults
the application standard port. Valid applications are: http,
bgp.</p>

<p style="margin-top: 1em">-d dport specifies the
destination port for the packets being sent. Defaults are
application-specific.</p>

<p style="margin-top: 1em">-s sport specifies the source
port for the packets being sent. Default is based of the
scamper process id.</p>

<p style="margin-top: 1em">-b ASN specifies the autonomous
system number (ASN) that should be used when establishing a
BGP session.</p>

<p style="margin-top: 1em">-f cookie specifies the TCP fast
open cookie that should be used when establishing a TCP
connection.</p>

<p style="margin-top: 1em">-m mss specifies the maximum
segment size to advertise to the remote host.</p>

<p style="margin-top: 1em">-M mtu specifies the MTU to use
in a Packet Too Big message.</p>

<p style="margin-top: 1em">-o offset specifies the sequence
number offset to use when conducting blind-syn and blind-rst
tests, and the acknowledgement number offset to use when
conducting a blind-data <br>
test.</p>

<p style="margin-top: 1em">-O option allows tbit behaviour
to be further tailored. The current choices for this option
are: <br>
- blackhole: for PMTUD testing, do not send Packet Too Big
messages; this tests to ability of a host to infer a PMTUD
blackhole and work around it. <br>
- tcpts: advertise support for TCP timestamps when
establishing a TCP connection. If the peer supports TCP
timestamps, embed timestamps in data packets. <br>
- ipts-syn: use the timestamp IP option in a SYN packet when
attempting to establish a TCP connection. <br>
- iprr-syn: use the record-route IP option in a SYN packet
when attempting to establish a TCP connection. <br>
- ipqs-syn: use the quick-start IP option in a SYN packet
when attempting to establish a TCP connection. <br>
- sack: advertise support for TCP selective acknowledgements
(SACK) when establishing a TCP connection. <br>
- fo: advertise support for TCP fast open using the official
IANA number assigned for fast open. <br>
- fo-exp: advertise support for TCP fast open using the
testing number assigned by IANA for fast open.</p>

<p style="margin-top: 1em">-P ptbsrc specifies the source
address that should be used to send Packet Too Big messages
in the pmtud test.</p>

<p style="margin-top: 1em">-q attempts specifies the number
of attempts to make with each packet to reduce false
inferences caused by packet loss.</p>

<p style="margin-top: 1em">-S srcaddr specifies the source
address that should be used in TCP packets sent by the tbit
test.</p>

<p style="margin-top: 1em">-T ttl specifies the IP
time-to-live value that should be used in TCP packets sent
by the tbit test.</p>

<p style="margin-top: 1em">-u url specifies a url for the
http application.</p>

<p style="margin-top: 1em">-U userid specifies an unsigned
integer to include with the data collected; the meaning of
the user-id is entirely up to the user and has no effect on
the behaviour of tbit.</p>

<p style="margin-top: 1em">-w wscale specifies the window
scale option to use when establishing the TCP
connection.</p>

<p style="margin-top: 1em">TRACELB OPTIONS <br>
The tracelb command is used to infer all per-flow
load-balanced paths between a source and destination. The
following options are available for the scamper tracelb
command:</p>

<p style="margin-top: 1em">tracelb [-c confidence] [-d
dport] [-f firsthop] [-g gaplimit] [-P method] [-q attempts]
[-Q maxprobec] [-s sport] [-t tos] [-U userid] [-w
wait-timeout] [-W wait-probe]</p>

<p style="margin-top: 1em">-c confidence <br>
specifies the level of confidence we want to attain that
there are no more parallel load balanced paths at a given
hop. Valid values are 95 (default) and 99, for 95% <br>
confidence and 99% confidence respectively.</p>

<p style="margin-top: 1em">-d dport specifies the base
destination port to use. Defaults to 33435, the default used
by traceroute(8).</p>

<p style="margin-top: 1em">-f firsthop specifies how many
hops away we should start probing.</p>

<p style="margin-top: 1em">-g gaplimit specifies how many
consecutive unresponsive hops are permitted before probing
down a branch halts. Defaults to three.</p>

<p style="margin-top: 1em">-P method specifies which method
we should use to do the probing. Valid options are:
&quot;udp-dport&quot;, &quot;icmp-echo&quot;,
&quot;udp-sport&quot;, &quot;tcp-sport&quot;, and
&quot;tcp-ack-sport&quot;. Defaults to <br>
&quot;udp-dport&quot;.</p>

<p style="margin-top: 1em">-q attempts specifies how many
probes we should send in an attempt to receive a reply.
Defaults to 2.</p>

<p style="margin-top: 1em">-Q maxprobec specifies the
maximum number of probes we ever want to send. Defaults to
3000.</p>

<p style="margin-top: 1em">-s sport specifies to the source
port to use when sending probes. Default based on process
ID.</p>

<p style="margin-top: 1em">-t tos specifies the value for
the IP Type-of-service field for outgoing probes. Defaults
to 0.</p>

<p style="margin-top: 1em">-U userid specifies an unsigned
integer to include with the data collected; the meaning of
the user-id is entirely up to the user and has no effect on
the behaviour of tracelb.</p>

<p style="margin-top: 1em">-w wait-timeout <br>
specifies in seconds how long to wait for a reply to a
probe. Defaults to 5.</p>

<p style="margin-top: 1em">-W wait-probe <br>
specifies in 1/100ths of seconds how long to wait between
probes. Defaults to 25 (i.e. 250ms).</p>

<p style="margin-top: 1em">STING OPTIONS <br>
The sting command is used to infer one-way loss using an
algorithm with TCP probes. It requires the firewall be
enabled in scamper using the -F option. The following
options are <br>
available for the scamper sting command:</p>

<p style="margin-top: 1em">sting [-c count] [-d dport] [-f
distribution] [-h request] [-H hole] [-i inter] [-m mean]
[-s sport]</p>

<p style="margin-top: 1em">-c count specifies the number of
samples to make. By default 48 samples are sent, as this
value is the current default of the FreeBSD TCP reassembly
queue length. Sting 0.7 <br>
uses 100 samples.</p>

<p style="margin-top: 1em">-d dport specifies the base
destination port to use. Defaults to 80, the default port
used by the HTTP protocol.</p>

<p style="margin-top: 1em">-f distribution <br>
specifies the delay distribution of samples. By default a
uniform distribution is constructed. Other distributions are
currently not implemented in scamper&rsquo;s imple&acirc;
<br>
mentation of sting.</p>

<p style="margin-top: 1em">-h request specifies the default
request to make. Currently not implemented.</p>

<p style="margin-top: 1em">-H hole specifies the size of
the initial hole left in the request. The default is 3
bytes, the same as sting-0.7.</p>

<p style="margin-top: 1em">-i inter specifies the
inter-phase delay between data seeding and hole filling, in
milliseconds. By default, sting waits 2000ms between
phases.</p>

<p style="margin-top: 1em">-m mean specifies the mean rate
to send packets in the data phase, in milliseconds. By
default, sting waits 100ms between probes.</p>

<p style="margin-top: 1em">-s sport specifies to the source
port to use when sending probes. Default is based on the
process ID.</p>

<p style="margin-top: 1em">SNIFF OPTIONS <br>
The sniff command is used to capture packets matching a
specific signature. At present, the only supported signature
is ICMP echo packets with a specific ID value, or packets
con&acirc; <br>
taining such a quote. The following options are available
for the scamper sniff command:</p>

<p style="margin-top: 1em">sting [-c limit-pktc] [-G
limit-time] [-S ipaddr] [-U userid] &lt;expression&gt;</p>

<p style="margin-top: 1em">-c limit-pktc <br>
specifies the maximum number of packets to capture.</p>

<p style="margin-top: 1em">-G limit-time <br>
specifies the maximum time, in seconds, to capture
packets.</p>

<p style="margin-top: 1em">-S ipaddr specifies the IP
address that packets must arrive using. scamper uses the IP
address to identify the appropriate interface to listen for
packets.</p>

<p style="margin-top: 1em">-U userid specifies an unsigned
integer to include with the data collected; the meaning of
the user-id is entirely up to the user and has no effect on
the behaviour of sniff.</p>

<p style="margin-top: 1em">The sole supported expression is
icmp[icmpid] == X, where X is the ICMP-ID to select.</p>

<p style="margin-top: 1em">DATA COLLECTION FEATURES <br>
scamper has two data output formats. The first is a
human-readable format suitable for one-off data collection
and measurement. The second, known as warts, is a binary
format <br>
that records much more meta-data and is more precise than
the human-readable format.</p>

<p style="margin-top: 1em">scamper is designed for
Internet-scale measurement, where large lists of targets are
supplied for probing. scamper has the ability to probe
multiple lists simultaneously, with <br>
each having a mix rate that specifies the priority of the
list. scamper can also make multiple cycles over a list of
addresses.</p>

<p style="margin-top: 1em">When writing output to a warts
file, scamper records details of the list and cycle that
each measurement task belongs to.</p>

<p style="margin-top: 1em">CONTROL SOCKET <br>
When started with the -P option, scamper allows
inter-process communication via a TCP socket bound to the
supplied port on the local host. This socket is useful for
controlling <br>
the operation of a long-lived scamper process. A client may
interact with scamper by using telnet(1) to open a
connection to the supplied port.</p>

<p style="margin-top: 1em">The following control socket
commands are available.</p>

<p style="margin-top: 1em">exit <br>
The exit command closes the current control socket
connection.</p>

<p style="margin-top: 1em">attach <br>
The attach command changes how scamper accepts and replies
to commands, returning results straight over the control
socket. See ATTACH section below for details on which
com&acirc; <br>
mands are accepted.</p>

<p style="margin-top: 1em">get argument <br>
The get command returns the current setting for the supplied
argument. Valid argument values are: holdtime, monitorname,
pid, pps, sport, version.</p>

<p style="margin-top: 1em">set argument ... <br>
The set command sets the current setting for the supplied
argument. Valid argument values are: holdtime, monitorname,
pps.</p>

<p style="margin-top: 1em">source argument ...</p>

<p style="margin-top: 1em">add arguments <br>
The source add command allows a new input source to be
added. It accepts the following arguments:</p>

<p style="margin-top: 1em">name string <br>
The name of the source. This parameter is mandatory.</p>

<p style="margin-top: 1em">descr string <br>
An optional string describing the source.</p>

<p style="margin-top: 1em">command string <br>
The command to execute for each address supplied. If not
supplied, the default command is used.</p>

<p style="margin-top: 1em">list_id uint32_t <br>
An optional numeric list identifier, assigned by a human. If
not supplied, a value of zero is used.</p>

<p style="margin-top: 1em">cycle_id uint32_t <br>
An optional numeric initial cycle identifier to use,
assigned by a human. If not supplied, a value of one is
used.</p>

<p style="margin-top: 1em">priority uint32_t <br>
An optional numeric value that specifies the mix rate of
measurements from the source compared to other sources. If
not supplied, a mix rate of one is used. A <br>
value of zero causes the source to be created, but not
actively used.</p>

<p style="margin-top: 1em">outfile string <br>
The name of the output file to write results to, previously
defined with outfile open. If not supplied, the default
output file is used.</p>

<p style="margin-top: 1em">file string <br>
The name of the input file to read target addresses from.
This parameter is mandatory if the source is a managed
source.</p>

<p style="margin-top: 1em">cycles integer <br>
The number of cycles to make over the target address file.
If zero, scamper will loop indefinitely over the file. This
parameter is ignored unless a managed source <br>
is defined.</p>

<p style="margin-top: 1em">autoreload [on | off] <br>
This parameter specifies if the target address file should
be re-read whenever a cycle is completed, or if the same set
of target addresses as the previous cycle <br>
should be used. If not specified, the file is not
automatically reloaded at cycle time.</p>

<p style="margin-top: 1em">update name arguments <br>
The source update command allows some properties of an
existing source to be modified. The source to update is
specified with the name parameter. Valid parameters are:
<br>
autoreload, cycles, and priority.</p>

<p style="margin-top: 1em">list ... <br>
The source list command provides a listing of all currently
defined sources. The optional third name parameter restricts
the listing to the source specified.</p>

<p style="margin-top: 1em">cycle name <br>
The source cycle command manually inserts a cycle marker in
an adhoc source.</p>

<p style="margin-top: 1em">delete name <br>
The source delete command deletes the named source, if
possible.</p>

<p style="margin-top: 1em">outfile argument ... <br>
The outfile commands provide the ability to manage output
files. It accepts the following arguments:</p>

<p style="margin-top: 1em">open ... <br>
The outfile open command allows a new output file to be
defined. It accepts the following parameters:</p>

<p style="margin-top: 1em">name alias <br>
The alias of the output file. This parameter is
mandatory.</p>

<p style="margin-top: 1em">file string <br>
The filename of the output file. This parameter is
mandatory.</p>

<p style="margin-top: 1em">mode [truncate | append] <br>
How the file will be opened. If the append mode is used, any
existing file with the specified name will be appended to.
If the truncate mode is used, any existing <br>
file will be truncated when it is opened.</p>

<p style="margin-top: 1em">close alias <br>
The outfile close command allows an existing output file to
be closed. The mandatory alias parameter specifies which
output file to close. An output file that is cur&acirc; <br>
rently referenced is not able to be closed. To close a file
that is currently referenced, a new outfile must be opened,
and then the outfile swap command be used.</p>

<p style="margin-top: 1em">swap alias1 alias2 <br>
The outfile swap command swaps the file associated with each
output file.</p>

<p style="margin-top: 1em">list <br>
The outfile list command outputs a list of the existing
outfiles.</p>

<p style="margin-top: 1em">observe sources <br>
This command allows for monitoring of source events. When
executed, the control socket will then supply event notices
whenever a source is added, updated, deleted, finished, <br>
or cycled. Each event is prefixed with a count of the number
of seconds elapsed since the Unix epoch. The following
examples illustrate the event monitoring capabilities:</p>

<p style="margin-top: 1em">EVENT 1169065640 source add name
&rsquo;foo&rsquo; list_id 5 priority 1 <br>
EVENT 1169065641 source update &rsquo;foo&rsquo; priority 15
<br>
EVENT 1169065642 source cycle &rsquo;bar&rsquo; id 2 <br>
EVENT 1169065650 source finish &rsquo;bar&rsquo; <br>
EVENT 1169065661 source delete &rsquo;foo&rsquo;</p>

<p style="margin-top: 1em">shutdown argument <br>
The shutdown argument allows the scamper process to be
exited cleanly. The following arguments are supported</p>

<p style="margin-top: 1em">done <br>
The shutdown done command requests that scamper shuts down
when the current tasks, as well as all remaining cycles,
have completed.</p>

<p style="margin-top: 1em">flush <br>
The shutdown flush command requests that scamper flushes all
remaining tasks queued with each list, finishes all current
tasks, and then shuts down.</p>

<p style="margin-top: 1em">now The shutdown now command
causes scamper to shutdown immediately. Unfinished tasks are
purged.</p>

<p style="margin-top: 1em">cancel <br>
The shutdown cancel command cancels any pending
shutdown.</p>

<p style="margin-top: 1em">ATTACH MODE <br>
In attach mode, none of the usual interactive mode commands
are usable. Instead, commands may be entered directly and
results will be sent back directly over the control socket.
<br>
Commands are specified just as they would be with the -I
flag for a command-line invocation of scamper. Replies are
split into lines by single characters and have one of the
<br>
following formats:</p>

<p style="margin-top: 1em">ERR ... <br>
A line starting with the 3 characters &quot;ERR&quot;
indicates an error has occurred. The rest of the line will
contain an error message.</p>

<p style="margin-top: 1em">OK id-num <br>
A line with the 2 characters &quot;OK&quot; indicates that
scamper has accepted the command. scamper versions after
20110623 return an id number associated with the command,
which <br>
allow the task to be halted by subsequently issuing a
&quot;halt&quot; instruction.</p>

<p style="margin-top: 1em">MORE <br>
A line with just the 4 characters &quot;MORE&quot; indicates
that scamper has the capacity to accept more probing
commands to run in parallel.</p>

<p style="margin-top: 1em">DATA length <br>
A line starting with the 4 characters &quot;DATA&quot;
follow by a space then a base-10 number indicates the start
of result. length specifies the number of characters of the
data, <br>
including newlines. The data is in binary warts format and
uuencoded before transmission.</p>

<p style="margin-top: 1em">To exit attached mode the client
must send a single line containing &quot;done&quot;. To halt
a command that has not yet completed, issue a
&quot;halt&quot; instruction with the id number returned
<br>
when the command was accepted as the sole parameter.</p>

<p style="margin-top: 1em">EXAMPLES <br>
To use the default traceroute command to trace the path to
192.0.2.1:</p>

<p style="margin-top: 1em">scamper -i 192.0.2.1</p>

<p style="margin-top: 1em">To infer Path MTU changes in the
network and associate them with a traceroute path:</p>

<p style="margin-top: 1em">scamper -I &quot;trace -P
udp-paris -M 192.0.2.1&quot;</p>

<p style="margin-top: 1em">To use paris traceroute with
ICMP probes, using 3 probes per hop, sending all probes,
writing to a specified warts file:</p>

<p style="margin-top: 1em">scamper -O warts -o file.warts
-I &quot;trace -P icmp-paris -q 3 -Q 192.0.2.1&quot;</p>

<p style="margin-top: 1em">To ping a series of addresses
defined in filename, probing each address 10 times:</p>

<p style="margin-top: 1em">scamper -c &quot;ping -c
10&quot; filename</p>

<p style="margin-top: 1em">Care must be taken with shell
quoting when using commands with multiple levels of quoting,
such as when giving a probe description with a dealias
command. The following sends UDP <br>
probes to alternating IP addresses, one second apart, and
requires the IP-ID values returned to be strictly in
sequence.</p>

<p style="margin-top: 1em">scamper -O warts -o ally.warts
-I &quot;dealias -O inseq -W 1000 -m ally -p &rsquo;-P udp
-i 192.0.2.1&rsquo; -p &rsquo;-P udp -i
192.0.2.4&rsquo;&quot;</p>

<p style="margin-top: 1em">Alternatively, the following
accomplishes the same, but without specifying the UDP probe
method twice.</p>

<p style="margin-top: 1em">scamper -O warts -o ally.warts
-I &quot;dealias -O inseq -W 1000 -m ally -p &rsquo;-P
udp&rsquo; 192.0.2.1 192.0.2.4&quot;</p>

<p style="margin-top: 1em">The following command scans
198.51.100.0/28 for a matching alias to 192.0.2.4, but skips
198.51.100.3.</p>

<p style="margin-top: 1em">scamper -O warts -o
prefixscan.warts -I &quot;dealias -O inseq -W 1000 -m
prefixscan -p &rsquo;-P udp&rsquo; -x 198.51.100.3 192.0.2.4
198.51.100.0/28&quot;</p>

<p style="margin-top: 1em">The following uses UDP probes to
enumerate all per-flow load-balanced paths towards 192.0.2.6
to 99% confidence; it varies the source port with each
probe.</p>

<p style="margin-top: 1em">scamper -I &quot;tracelb -P
udp-sport -c 99 192.0.2.6&quot;</p>

<p style="margin-top: 1em">SEE ALSO <br>
ping(8), traceroute(8), libscamperfile(3), sc_ally(1),
sc_analysis_dump(1), sc_attach(1), sc_ipiddump(1),
sc_filterpolicy(1), sc_speedtrap(1), sc_tbitblind(1),
sc_tracediff(1), <br>
sc_wartscat(1), sc_wartsdump(1), sc_warts2json(1),
sc_warts2pcap(1), sc_warts2text(1),</p>

<p style="margin-top: 1em">S. Savage, Sting: a TCP-based
Network Measurement Tool, 1999 USENIX Symposium on Internet
Technologies and Systems.</p>

<p style="margin-top: 1em">R. Govindan and H.
Tangmunarunkit, Heuristics for Internet Map Discovery, Proc.
IEEE INFOCOM 2000.</p>

<p style="margin-top: 1em">N. Spring, R. Mahajan, and D.
Wetherall, Measuring ISP topologies with Rocketfuel, Proc.
ACM SIGCOMM 2002.</p>

<p style="margin-top: 1em">A. Medina, M. Allman, and S.
Floyd, Measuring the evolution of transport protocols in the
Internet, Proc. ACM/SIGCOMM Internet Measurement Conference
2004.</p>

<p style="margin-top: 1em">M. Luckie, K. Cho, and B. Owens,
Inferring and Debugging Path MTU Discovery Failures, Proc.
ACM/SIGCOMM Internet Measurement Conference 2005.</p>

<p style="margin-top: 1em">B. Donnet, P. Raoult, T.
Friedman, and M. Crovella, Efficient algorithms for
large-scale topology discovery, Proc. ACM SIGMETRICS
2005.</p>

<p style="margin-top: 1em">B. Augustin, X. Cuvellier, B.
Orgogozo, F. Viger, T. Friedman, M. Latapy, C. Magnien, and
R. Teixeira, Avoiding traceroute anomalies with Paris
traceroute, Proc. ACM/SIGCOMM <br>
Internet Measurement Conference 2006.</p>

<p style="margin-top: 1em">B. Augustin, T. Friedman, and R.
Teixeira, Measuring Load-balanced Paths in the Internet,
Proc. ACM/SIGCOMM Internet Measurement Conference 2007.</p>

<p style="margin-top: 1em">A. Bender, R. Sherwood, and N.
Spring, Fixing Ally&rsquo;s growing pains with velocity
modeling, Proc. ACM/SIGCOMM Internet Measurement Conference
2008.</p>

<p style="margin-top: 1em">M. Luckie, Scamper: a Scalable
and Extensible Packet Prober for Active Measurement of the
Internet, Proc. ACM/SIGCOMM Internet Measurement Conference
2010.</p>

<p style="margin-top: 1em">R. Beverly, W. Brinkmeyer, M.
Luckie, and J.P. Rohrer, IPv6 Alias Resolution via Induced
Fragmentation, Proc. Passive and Active Measurement
Conference 2013.</p>

<p style="margin-top: 1em">M. Luckie, R. Beverly, W.
Brinkmeyer, and k claffy, Speedtrap: Internet-scale IPv6
Alias Resolution, Proc. ACM/SIGCOMM Internet Measurement
Conference 2013.</p>

<p style="margin-top: 1em">M. Luckie, R. Beverly, T. Wu, M.
Allman, and k. claffy, Resilience of Deployed TCP to Blind
Attacks, Proc. ACM/SIGCOMM Internet Measurement Conference
2015.</p>

<p style="margin-top: 1em">J. Czyz, M. Luckie, M. Allman,
and M. Bailey, Don&rsquo;t Forget to Lock the Back Door! A
Characterization of IPv6 Network Security Policy, Proc.
Network and Distributed Systems Security <br>
(NDSS) Conference 2016.</p>

<p style="margin-top: 1em">AUTHORS <br>
scamper was written by Matthew Luckie
&lt;mjl@luckie.org.nz&gt;. Alistair King contributed an
initial implementation of Doubletree; Ben Stasiewicz
contributed an initial implementation <br>
of TBIT&rsquo;s PMTUD test; Stephen Eichler contributed an
initial implementation of TBIT&rsquo;s ECN test; Boris
Pfahringer adapted scamper to use GNU autotools, modularised
the tests, and <br>
updated this man page. Brian Hammond of Internap Network
Services Corporation provided an initial implementation of
scamper&rsquo;s json output format. Tiange Wu contributed an
initial <br>
implementation of the blind in-window TBIT test, and Robert
Beverly contributed BGP protocol support for TBIT.</p>

<p style="margin-top: 1em">ACKNOWLEDGEMENTS <br>
scamper development was initially funded by the WIDE project
in association with CAIDA. Boris&rsquo; work was funded by
the University of Waikato&rsquo;s Centre for Open Source
Innovation.</p>

<p style="margin-top: 1em">BSD August 8, 2016 BSD</p>
<hr>
</body>
</html>
