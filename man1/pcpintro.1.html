<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:30:12 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>PCPINTRO(1) General Commands Manual PCPINTRO(1)</p>

<p style="margin-top: 1em">NAME <br>
PCPIntro - introduction to the Performance Co-Pilot
(PCP)</p>

<p style="margin-top: 1em">INTRODUCTION <br>
The Performance Co-Pilot (PCP) is a toolkit designed for
monitoring and managing system-level performance. These
services are distributed and scalable to accommodate the
most <br>
complex system configurations and performance problems.</p>

<p style="margin-top: 1em">PCP supports many different
platforms, including (but not limited to) Linux, MacOSX,
Solaris and Windows. From a high-level PCP can be considered
to contain two classes of soft&acirc; <br>
ware utility:</p>

<p style="margin-top: 1em">PCP Collectors <br>
These are the parts of PCP that collect and extract
performance data from various sources, e.g. the operating
system kernel.</p>

<p style="margin-top: 1em">PCP Monitors <br>
These are the parts of PCP that display data collected from
hosts (or archives) that have the PCP Collector installed.
Many monitor tools are available as part of the <br>
core PCP release, while other (typically graphical)
monitoring tools are available separately in the PCP GUI
package.</p>

<p style="margin-top: 1em">This manual entry describes the
high-level features and options common to most PCP utilities
available on all platforms.</p>

<p style="margin-top: 1em">OVERVIEW <br>
The PCP architecture is distributed in the sense that any
PCP tool may be executing remotely. On the host (or hosts)
being monitored, each domain of performance metrics, whether
<br>
the kernel, a service layer, a database management system, a
web server, an application, etc. requires a Performance
Metrics Domain Agent (PMDA) which is responsible for
col&acirc; <br>
lecting performance measurements from that domain. All PMDAs
are controlled by the Performance Metrics Collector Daemon
(pmcd(1)) on the same host.</p>

<p style="margin-top: 1em">Client applications (the
monitoring tools) connect to pmcd(1), which acts as a router
for requests, by forwarding requests to the appropriate PMDA
and returning the responses to <br>
the clients. Clients may also access performance data from
sets of PCP archives (created using pmlogger(1)) for
retrospective analysis.</p>

<p style="margin-top: 1em">Security philosophy <br>
PCP redistributes a wealth of performance information within
a host and across its networks. The following security
philosophy underlies the setting of several defaults that
<br>
control how much information is sent and received.</p>

<p style="margin-top: 1em">By default, the information
exposed by PMCD about a host is approximately of the same
level of confidentiality as available to a completely
unprivileged user on that host. So, <br>
performance data that is available to be read completely
freely on a machine may be made available by PMCD to the
network.</p>

<p style="margin-top: 1em">However, the host running PMCD
and its network is not assumed to run only friendly
applications. Therefore, write type operations, including
from the local host, are not permit&acirc; <br>
ted by default.</p>

<p style="margin-top: 1em">These defaults may be overridden
(expanded or reduced) in several ways, including by
specifying network ACLs in pmcd.conf, activating non-default
PMDAs, or by using PMCD connec&acirc; <br>
tions that pass user credentials. For example, some PMDAs
automatically provide greater information for particular
credentialed users or groups.</p>

<p style="margin-top: 1em">Applications <br>
The following performance monitoring applications are
primarily console based, typically run directly from the
command line, and are just a small subset of the tools
available as <br>
part of the base PCP package.</p>

<p style="margin-top: 1em">Each tool or command is
documented completely in its own reference page.</p>

<p style="margin-top: 1em">pmstat Outputs an ASCII
high-level summary of system performance.</p>

<p style="margin-top: 1em">pmie An inference engine that
can evaluate predicate-action rules to perform alarms and
automate system management tasks.</p>

<p style="margin-top: 1em">pminfo Interrogate specific
performance metrics and the metadata that describes
them.</p>

<p style="margin-top: 1em">pmlogger <br>
Generates PCP archives of performance metrics suitable for
replay by most PCP tools.</p>

<p style="margin-top: 1em">pmrep Highly customizable
performance metrics reporter with support for various
different output modes.</p>

<p style="margin-top: 1em">pmval Simple periodic reporting
for some or all instances of a performance metric, with
optional VCR time control.</p>

<p style="margin-top: 1em">If the PCP GUI package is
installed then the following additional tools are
available.</p>

<p style="margin-top: 1em">pmchart <br>
Displays trends over time of arbitrarily selected
performance metrics from one or more hosts.</p>

<p style="margin-top: 1em">pmtime Time control utility for
coordinating the time between multiple tools (including
pmchart and pmval).</p>

<p style="margin-top: 1em">pmdumptext <br>
Produce ASCII reports for arbitrary combinations of
performance metrics.</p>

<p style="margin-top: 1em">COMMON COMMAND LINE ARGUMENTS
<br>
There is a set of common command line arguments that are
used consistently by most PCP tools.</p>

<p style="margin-top: 1em">-a archive <br>
Performance metric information is retrospectively retrieved
from the set of Performance Co-Pilot (PCP) archives
identified by archive, previously generated by pmlog&acirc;
<br>
ger(1).See pcp-archive(5) for format documentation. The -a
and -h options are mutually exclusive.</p>

<p style="margin-top: 1em">archive is a comma-separated
list of names, each of which may be the name of a directory
containing one or more archives, the base name common to all
of the physical files <br>
created by an instance of pmlogger(1), or any one of the
physical files, e.g. /path/to/myarchives (directory) or
myarchive (base name) or myarchive.meta (the metadata <br>
file) or myarchive.index (the temporal index) or myarchive.0
(the first data volume of archive) or myarchive.0.bz2 or
myarchive.0.bz (the first data volume compressed with <br>
bzip2(1)) or myarchive.0.gz or myarchive.0.Z or
myarchive.0.z (the first data volume compressed with
gzip(1)), myarchive.1 or myarchive.3.bz2 or myarchive.42.gz
etc.</p>

<p style="margin-top: 1em">-h hostname <br>
Unless directed to another host by the -h option, or to a
set of archives by the -a option, the source of performance
metrics will be the Performance Metrics Collector <br>
Daemon (PMCD) on the local host. Refer to the PMCD HOST
SPECIFICATION section later for further details on the many
options available when forming the hostname specifica&acirc;
<br>
tion, as well as a detailed description of the default local
host connection. The -a and -h options are mutually
exclusive.</p>

<p style="margin-top: 1em">-s samples <br>
The argument samples defines the number of samples to be
retrieved and reported. If samples is 0 or -s is not
specified, the application will sample and report
continu&acirc; <br>
ously (in real time mode) or until the end of the set of PCP
archives (in archive mode).</p>

<p style="margin-top: 1em">-z Change the reporting timezone
to the local timezone at the host that is the source of the
performance metrics, as identified via either the -h or -a
options.</p>

<p style="margin-top: 1em">-Z timezone <br>
By default, applications report the time of day according to
the local timezone on the system where the application is
executed. The -Z option changes the timezone to <br>
timezone in the format of the environment variable TZ as
described in environ(7).</p>

<p style="margin-top: 1em">INTERVAL SPECIFICATION AND
ALIGNMENT <br>
Most PCP tools operate with periodic sampling or reporting,
and the -t and -A options may be used to control the
duration of the sample interval and the alignment of the
sample <br>
times.</p>

<p style="margin-top: 1em">-t interval <br>
Set the update or reporting interval.</p>

<p style="margin-top: 1em">The interval argument is
specified as a sequence of one or more elements of the form
<br>
number[units] <br>
where number is an integer or floating point constant
(parsed using strtod(3)) and the optional units is one of:
seconds, second, secs, sec, s, minutes, minute, mins, min,
<br>
m, hours, hour, h, days, day and d. If the unit is empty,
second is assumed.</p>

<p style="margin-top: 1em">In addition, the upper case (or
mixed case) version of any of the above is also
acceptable.</p>

<p style="margin-top: 1em">Spaces anywhere in the interval
are ignored, so 4 days 6 hours 30 minutes, 4day6hour30min,
4d6h30m and 4d6.5h are all equivalent.</p>

<p style="margin-top: 1em">Multiple specifications are
additive, e.g. &lsquo;&lsquo;1hour 15mins
30secs&rsquo;&rsquo; is interpreted as 3600+900+30
seconds.</p>

<p style="margin-top: 1em">-A align <br>
By default samples are not necessarily aligned on any
natural unit of time. The -A option may be used to force the
initial sample to be aligned on the boundary of a
natu&acirc; <br>
ral time unit. For example -A 1sec, -A 30min and -A 1hour
specify alignment on whole seconds, half and whole hours
respectively.</p>

<p style="margin-top: 1em">The align argument follows the
syntax for an interval argument described above for the -t
option.</p>

<p style="margin-top: 1em">Note that alignment occurs by
advancing the time as required, and that -A acts as a
modifier to advance both the start of the time window (see
the next section) and the <br>
origin time (if the -O option is specified).</p>

<p style="margin-top: 1em">TIME WINDOW SPECIFICATION <br>
Many PCP tools are designed to operate in some time window
of interest, e.g. to define a termination time for real-time
monitoring or to define a start and end time within a set
<br>
of PCP archive logs.</p>

<p style="margin-top: 1em">In the absence of the -O and -A
options to specify an initial sample time origin and time
alignment (see above), the PCP application will retrieve the
first sample at the start <br>
of the time window.</p>

<p style="margin-top: 1em">The following options may be
used to specify a time window of interest.</p>

<p style="margin-top: 1em">-S starttime <br>
By default the time window commences immediately in
real-time mode, or coincides with time at the start of the
set of PCP archive logs in archive mode. The -S option may
<br>
be used to specify a later time for the start of the time
window.</p>

<p style="margin-top: 1em">The starttime parameter may be
given in one of three forms (interval is the same as for the
-t option as described above, datetime is described
below):</p>

<p style="margin-top: 1em">interval <br>
To specify an offset from the current time (in real-time
mode) or the beginning of a set of PCP archives (in archive
mode) simply specify the interval of time as <br>
the argument. For example -S 30min will set the start of the
time window to be exactly 30 minutes from now in real-time
mode, or exactly 30 minutes from the start <br>
of a set of PCP archives.</p>

<p style="margin-top: 1em">-interval <br>
To specify an offset from the end of a set of PCP archive
logs, prefix the interval argument with a minus sign. In
this case, the start of the time window precedes <br>
the time at the end of the set of archives by the given
interval. For example -S -1hour will set the start of the
time window to be exactly one hour before the <br>
time of the last sample in a set of PCP archive logs.</p>

<p style="margin-top: 1em">@datetime <br>
To specify the calendar date and time (local time in the
reporting timezone) for the start of the time window, use
the datetime syntax preceded by an at sign. <br>
Refer to the datetime description below for detailed
information.</p>

<p style="margin-top: 1em">-T endtime <br>
By default the end of the time window is unbounded (in
real-time mode) or aligned with the time at the end of a set
of PCP archive logs (in archive mode). The -T option <br>
may be used to specify an earlier time for the end of the
time window.</p>

<p style="margin-top: 1em">The endtime parameter may be
given in one of three forms (interval is the same as for the
-t option as described above, datetime is described
below):</p>

<p style="margin-top: 1em">interval <br>
To specify an offset from the start of the time window
simply use the interval of time as the argument. For example
-T 2h30m will set the end of the time window to <br>
be 2 hours and 30 minutes after the start of the time
window.</p>

<p style="margin-top: 1em">-interval <br>
To specify an offset back from the time at the end of a set
of PCP archive logs, prefix the interval argument with a
minus sign. For example -T -90m will set the <br>
end of the time window to be 90 minutes before the time of
the last sample in a set of PCP archive logs.</p>

<p style="margin-top: 1em">@datetime <br>
To specify the calendar date and time (local time in the
reporting timezone) for the end of the time window, use the
datetime syntax preceded by an at sign. Refer <br>
to the datetime description below for detailed
information.</p>

<p style="margin-top: 1em">-O origin <br>
By default samples are fetched from the start of the time
window (see description of -S option) to the end of the time
window (see description of -T option). The -O <br>
option allows the specification of an origin within the time
window to be used as the initial sample time. This is useful
for interactive use of a PCP tool with the <br>
pmtime(1) VCR replay facility.</p>

<p style="margin-top: 1em">The origin argument accepted by
-O conforms to the same syntax and semantics as the
starttime argument for the -T option.</p>

<p style="margin-top: 1em">For example -O -0 specifies that
the initial position should be at the end of the time
window; this is most useful when wishing to replay
&lsquo;&lsquo;backwards&rsquo;&rsquo; within the time <br>
window.</p>

<p style="margin-top: 1em">The datetime argument for the
-O, -S and -T options consists of: <br>
date time zone day relative <br>
A date can be one of: YY-MM-DD, MM/DD/YY, DD Month YYYY, or
Month DD YYYY. A time can be one of: HH:MM:SS, HH:MM. HH:MM
can use either the 12 hour (via an am or pm suffix) or <br>
24 hour convention. A day of the week can be a spelled out
day of the week, optionally preceded by an ordinal number
such as second tuesday. A zone is a time zone value as <br>
specified by the tzselect(1) command. A relative time can be
a time unit that is: preceded by a cardinal number such as 1
year or 2 months, preceded by one of the time words <br>
this or last, or succeeded by the time word ago. A relative
time can also be one of the time words: yesterday, today,
tomorrow, now. Examples of datetime strings are: <br>
1996-03-04 13:07:47 EST Mon, 1996-03-05 14:07:47 EST -1hour,
Mon Mar 4 13:07:47 1996, Mar 4 1996, Mar 4, Mar, 13:07:50 or
13:08.</p>

<p style="margin-top: 1em">For any missing low order
fields, the default value of 0 is assumed for hours, minutes
and seconds, 1 for day of the month and Jan for months.
Hence, the following are equiva&acirc; <br>
lent: -S &rsquo;@ Mar 1996&rsquo; and -S &rsquo;@ Mar 1
00:00:00 1996&rsquo;.</p>

<p style="margin-top: 1em">If any high order fields are
missing, they are filled in by starting with the year, month
and day from the current time (real-time mode) or the time
at the beginning of the set <br>
of PCP archive logs (archive mode) and advancing the time
until it matches the fields that are specified. So, for
example if the time window starts by default at
&lsquo;&lsquo;Mon Mar 4 <br>
13:07:47 1996&rsquo;&rsquo;, then -S @13:10 corresponds to
13:10:00 on Mon Mar 4, 1996, while -S @10:00 corresponds to
10:00:00 on Tue Mar 5, 1996 (note this is the following
day).</p>

<p style="margin-top: 1em">For greater precision than
afforded by datetime(3), the seconds component may be a
floating point number.</p>

<p style="margin-top: 1em">If a timezone is not included in
a datetime then there ares several interpretations available
depending on the other command line options used. The
default is to use the local <br>
timezone on the system where the PCP tool is being run. A -Z
option specifies an explicit timezone, else a -z option
changes the timezone to the local timezone at the host that
<br>
is the source of the performance metrics.</p>

<p style="margin-top: 1em">PERFORMANCE METRICS - NAMES AND
IDENTIFIERS <br>
The number of performance metric names supported by PCP on
most platforms ranges from many hundreds to several
thousand. The PCP libraries and applications use an internal
iden&acirc; <br>
tification scheme that unambiguously associates a single
integer with each known performance metric. This integer is
known as the Performance Metric Identifier, or PMID. <br>
Although not a requirement, PMIDs tend to have global
consistency across all systems, so a particular performance
metric usually has the same PMID.</p>

<p style="margin-top: 1em">For all users and most
applications, direct use of the PMIDs would be inappropriate
(e.g. this would limit the range of accessible metrics, make
the code hard to maintain, force <br>
the user interface to be particularly baroque, etc.). Hence
a Performance Metrics Name Space (PMNS) is used to provide
external names and a hierarchic classification for
perfor&acirc; <br>
mance metrics. A PMNS is represented as a tree, with each
node having a label, a pointer to either a PMID (for leaf
nodes) or a set of descendent nodes in the PMNS (for
non-leaf <br>
nodes).</p>

<p style="margin-top: 1em">A node label must begin with an
alphabetic character, followed by zero or more characters
drawn from the alphabetics, the digits and character
&lsquo;_&Acirc;&acute; (underscore). For alphabetic <br>
characters in a node label, upper and lower case are
distinguished.</p>

<p style="margin-top: 1em">By convention, the name of a
performance metric is constructed by concatenation of the
node labels on a path through the PMNS from the root node to
a leaf node, with a &lsquo;&lsquo;.&rsquo;&rsquo; as a <br>
separator. The root node in the PMNS is unlabeled, so all
names begin with the label associated with one of the
descendent nodes below the root node of the PMNS, e.g.
ker&acirc; <br>
nel.percpu.syscall. Typically (although this is not a
requirement) there would be at most one name for each PMID
in a PMNS. For example kernel.all.cpu.idle and disk.dev.read
<br>
are the unique names for two distinct performance metrics,
each with a unique PMID.</p>

<p style="margin-top: 1em">Groups of related PMIDs may be
named by naming a non-leaf node in the PMNS tree, e.g.
disk.</p>

<p style="margin-top: 1em">The default local PMNS used by
pmcd is located at $PCP_VAR_DIR/pmns/root however the
environment variable PMNS_DEFAULT may be set to the full
pathname of a different PMNS which <br>
will then be used as the default local PMNS.</p>

<p style="margin-top: 1em">Most applications do not use the
local PMNS directly, but rather import parts of the PMNS as
required from the same place that performance metrics are
fetched, i.e. from pmcd(1) <br>
for live monitoring or from a set of PCP archives for
retrospective monitoring.</p>

<p style="margin-top: 1em">To explore the PMNS use
pminfo(1), or if the PCP GUI package is installed the New
Chart and Metric Search windows within pmchart(1).</p>

<p style="margin-top: 1em">PERFORMANCE METRIC
SPECIFICATIONS <br>
In configuration files and (to a lesser extent) command line
options, metric specifications adhere to the following
syntax rules.</p>

<p style="margin-top: 1em">If the source of performance
metrics is real-time from pmcd(1) then the accepted syntax
is <br>
host:metric[instance1,instance2,...]</p>

<p style="margin-top: 1em">If the source of performance
metrics is a set of PCP archive logs then the accepted
syntax is <br>
archive/metric[instance1,instance2,...]</p>

<p style="margin-top: 1em">The host:, archive/ and
[instance1,instance2,...] components are all optional.</p>

<p style="margin-top: 1em">The , delimiter in the list of
instance names may be replaced by white space.</p>

<p style="margin-top: 1em">Special characters in instance
names may be escaped by surrounding the name in double
quotes or preceding the character with a backslash.</p>

<p style="margin-top: 1em">White space is ignored
everywhere except within a quoted instance name.</p>

<p style="margin-top: 1em">An empty instance is silently
ignored, and in particular &lsquo;&lsquo;[]&rsquo;&rsquo; is
the same as no instance, while
&lsquo;&lsquo;[one,,,two]&rsquo;&rsquo; is parsed as
specifying just the two instances
&lsquo;&lsquo;one&rsquo;&rsquo; and <br>
&lsquo;&lsquo;two&rsquo;&rsquo;.</p>

<p style="margin-top: 1em">As a special case, if the host
is the single character &lsquo;&lsquo;@&rsquo;&rsquo; then
this refers to a PM_CONTEXT_LOCAL source, see
pmNewContext(3).</p>

<p style="margin-top: 1em">SECURE PMCD CONNECTIONS <br>
Since PCP version 3.6.11, a monitor can explicitly request a
secure connection to a collector host running pmcd(1) or
pmproxy(1) using the PM_CTXFLAG_SECURE context flag. If the
<br>
PCP Collector host supports this feature - refer to the
pmcd.feature.secure metric for confirmation of this - a
TLS/SSL (Transport Layer Security or Secure Sockets Layer)
connec&acirc; <br>
tion can be established which uses public key cryptography
and related techniques. These features aim to prevent
eavesdropping and data tampering from a malicious third
party, <br>
as well as providing server-side authentication (confident
identification of a server by a client) which can be used to
guard against man-in-the-middle attacks.</p>

<p style="margin-top: 1em">A secure pmcd connection
requires use of certificate-based authentication. The
security features offered by pmcd and pmproxy are
implemented using the Network Security Services <br>
(NSS) APIs and utilities. The NSS certutil tool can be used
to create certificates suitable for establishing trust
between PCP monitor and collector hosts.</p>

<p style="margin-top: 1em">A complete description is beyond
the scope of this document, refer to the PCP ENVIRONMENT,
FILES and SEE ALSO sections for detailed information. This
includes links to tutorials <br>
on the steps involved in setting up the available security
features.</p>

<p style="margin-top: 1em">PMCD HOST SPECIFICATION <br>
In the absence of an explicit host name specification, most
tools will default to the local host in live update mode. In
PCP releases since 3.8.4 onward, this results in an <br>
efficient local protocol being selected - typically a Unix
domain socket. If this option is used (which can also be
explicitly requested via the unix: host specification <br>
described below), it is important to note that all
connections will be automatically authenticated. In other
words, the credentials of the user invoking a client tool
will auto&acirc; <br>
matically be made available to pmcd(1) and all of its PMDAs,
on the users behalf, such that results can be customized to
the privilege levels of individual users.</p>

<p style="margin-top: 1em">Names of remote hosts running
the pmcd(1) daemon can of course also be provided to request
a remote host be used. The most basic form of pmcd host
specification is a simple host <br>
name, possibly including the domain name if necessary.
However, this can be extended in a number of ways to further
refine attributes of the connection made to pmcd.</p>

<p style="margin-top: 1em">The pmcd port number and also
optional pmproxy(1) hostname and its port number, can be
given as part of the host specification, since PCP version
3.0. These supersede (and over&acirc; <br>
ride) the old-style PMCD_PORT, PMPROXY_HOST and PMPROXY_PORT
environment variables.</p>

<p style="margin-top: 1em">The following are valid hostname
specifications that specify connections to pmcd on host
nas1.servers.com with/without a list of ports, with/without
a pmproxy(1) connection <br>
through a firewall, and with IPv6 and IPv4 addresses as
shown.</p>

<p style="margin-top: 1em">$ pcp -h
nas1.servers.com:44321,4321@firewall.servers.com:44322 <br>
$ pcp -h nas1.servers.com:44321@firewall.servers.com:44322
<br>
$ pcp -h nas1.servers.com:44321@firewall.servers.com <br>
$ pcp -h nas1.servers.com@firewall.servers.com <br>
$ pcp -h nas1.servers.com:44321 <br>
$ pcp -h [fe80::2ad2:44ff:fe88:e4f1%p2p1] <br>
$ pcp -h 192.168.0.103</p>

<p style="margin-top: 1em">In addition,
&lsquo;&lsquo;connection attributes&rsquo;&rsquo; can also
be specified. These include username, password (can be given
interactively and may depend on the authentication mechanism
<br>
employed), whether to target a specific running container,
whether to use secure (encrypted) or native (naked)
protocol, and so on. The previous examples all default to
native <br>
protocol, and use no authentication. This can be altered, as
in the following examples.</p>

<p style="margin-top: 1em">$ pcp -h
pcps://app2.servers.com?container=cae8e6edc0d5 <br>
$ pcp -h
pcps://nas1.servers.com:44321?username=tanya&amp;method=gssapi
<br>
$ pcp -h pcps://nas2.servers.com@firewalls.r.us?method=plain
<br>
$ pcp -h pcp://nas3.servers.com <br>
$ pcp -h
192.168.0.103?container=cae8e6edc0d5,method=digest-md5 <br>
$ pcp -h unix: <br>
$ pcp -h local:</p>

<p style="margin-top: 1em">The choice of authentication
method, and other resulting parameters like username,
optionally password, etc, depends on the SASL2 configuration
used by each (remote) pmcd. Tuto&acirc; <br>
rials are available specifying various aspects of
configuring the authentication module(s) used, these fine
details are outside the scope of this document.</p>

<p style="margin-top: 1em">In all situations, host names
can be used interchangeably with IPv4 or IPv6 addressing
(directly), as shown above. In the case of an IPv6 address,
the full address must be <br>
enclosed by square brackets and the scope (interface) must
also be specified.</p>

<p style="margin-top: 1em">The final local: example above
is now the default for most tools. This connection is an
automatically authenticated local host connection on all
platforms that support Unix <br>
domain sockets. No password is required and authentication
is automatic. This is also the most efficient (lowest
overhead) communication channel available.</p>

<p style="margin-top: 1em">The difference between unix: and
local: is that the former is a strict Unix domain socket
specification (connection fails if it cannot connect that
way), whereas the latter has a <br>
more forgiving fallback to using localhost (i.e. a regular
Inet socket connection is used when Unix domain socket
connections are unavailable).</p>

<p style="margin-top: 1em">ENVIRONMENT <br>
In addition to the PCP run-time environment and
configuration variables described in the PCP ENVIRONMENT
section below, the following environment variables apply to
all installa&acirc; <br>
tions.</p>

<p style="margin-top: 1em">Note that most uses of these
environment variables are optimized to check the environment
only the first time the variable might be used. As the
environment usually is not <br>
checked again, the only safe strategy is to ensure all
PCP-related environment variables are set before the first
call into any of the PCP libraries.</p>

<p style="margin-top: 1em">PCP_ALLOW_BAD_CERT_DOMAIN <br>
When set, allow clients to accept certificates with
mismatched domain names with no prompt when they are sent by
pmcd or other server components. See PCP_SECURE_SOCKETS.</p>

<p style="margin-top: 1em">PCP_ALLOW_SERVER_SELF_CERT <br>
When set, allow clients to accept self-signed certificates
with no prompt when they are sent by pmcd or other server
components. See PCP_SECURE_SOCKETS.</p>

<p style="margin-top: 1em">PCP_CONSOLE <br>
When set, this changes the default console from /dev/tty (on
Unix) or CON: (on Windows) to be the specified console. The
special value of none can be used to indicate no <br>
console is available for use. This is used in places where
console-based tools need to interact with the user, and in
particular is used when authentication is being per&acirc;
<br>
formed.</p>

<p style="margin-top: 1em">PCP_DEBUG <br>
When set, this variable provides an alternate way to
initialize the value used to control diagnostic and debug
output (the default value is 0 to suppress this output).
<br>
The value for $PCP_DEBUG should be a decimal integer, see
pmdbg(1) for a description of the supported values.</p>

<p style="margin-top: 1em">PCP_DERIVED_CONFIG <br>
When set, this variable defines a colon separated list of
files and/or directories (the syntax is the same as for the
$PATH variable for sh(1)). The components are <br>
expanded into a list of files as follows: if a component of
$PCP_DERIVED_CONFIG is a file, then that file is added to
the list, else if a component is a directory then <br>
recursive descent is used to enumerate all files below that
directory and these are added to the list.</p>

<p style="margin-top: 1em">Each file in the resulting list
is assumed to contain definitions of derived metrics as per
the syntax described in pmLoadDerivedConfig(3), and these
are loaded in order.</p>

<p style="margin-top: 1em">Derived metrics may be used to
extend the available metrics with new (derived) metrics
using simple arithmetic expressions.</p>

<p style="margin-top: 1em">If PCP_DERIVED_CONFIG is set,
the derived metric definitions are processed automatically
as each new source of performance metrics is established
(i.e. each time a pmNew&acirc; <br>
Context(3) is called) or when requests are made against the
PMNS.</p>

<p style="margin-top: 1em">Any component in the
$PCP_DERIVED_CONFIG list or the expanded list of files that
is not a file, or is not a directory or is not accessible
(due to permissions or a bad <br>
symbolic link) will be silently ignored.</p>

<p style="margin-top: 1em">PCP_SECURE_SOCKETS <br>
When set, this variable forces any monitor tool connections
to be established using the certificate-based secure sockets
feature. If the connections cannot be established <br>
securely, they will fail.</p>

<p style="margin-top: 1em">PCP_SECURE_DB_METHOD <br>
With secure socket connections, the certificate and key
database is stored using the sql: method by default. Use
PCP_SECURE_DB_METHOD to override the default, most
usu&acirc; <br>
ally setting the value to the empty string (for the older
database methods).</p>

<p style="margin-top: 1em">PCP_SECURE_DB_PATH <br>
When set, this variable specifies an alternate certficate
database path for client tools. Similar to the action of the
-C option for pmcd(1) and pmproxy(1).</p>

<p style="margin-top: 1em">PCP_STDERR <br>
Many PCP tools support the environment variable PCP_STDERR,
which can be used to control where error messages are sent.
When unset, the default behavior is that
&lsquo;&lsquo;usage&rsquo;&rsquo; <br>
messages and option parsing errors are reported on standard
error, other messages after initial startup are sent to the
default destination for the tool, i.e. standard <br>
error for ASCII tools, or a dialog for GUI tools.</p>

<p style="margin-top: 1em">If PCP_STDERR is set to the
literal value DISPLAY then all messages will be displayed in
a dialog. This is used for any tools launched from the a
Desktop environment.</p>

<p style="margin-top: 1em">If PCP_STDERR is set to any
other value, the value is assumed to be a filename, and all
messages will be written there.</p>

<p style="margin-top: 1em">PMCD_CONNECT_TIMEOUT <br>
When attempting to connect to a remote pmcd(1) on a machine
that is booting, the connection attempt could potentially
block for a long time until the remote machine fin&acirc;
<br>
ishes its initialization. Most PCP applications and some of
the PCP library routines will abort and return an error if
the connection has not been established after some <br>
specified interval has elapsed. The default interval is 5
seconds. This may be modified by setting
PMCD_CONNECT_TIMEOUT in the environment to a real number of
seconds <br>
for the desired timeout. This is most useful in cases where
the remote host is at the end of a slow network, requiring
longer latencies to establish the connection cor&acirc; <br>
rectly.</p>

<p style="margin-top: 1em">PMCD_RECONNECT_TIMEOUT <br>
When a monitor or client application loses a connection to a
pmcd(1), the connection may be re-established by calling a
service routine in the PCP library. However, <br>
attempts to reconnect are controlled by a back-off strategy
to avoid flooding the network with reconnection requests. By
default, the back-off delays are 5, 10, 20, 40 <br>
and 80 seconds for consecutive reconnection requests from a
client (the last delay will be repeated for any further
attempts after the fifth). Setting the environment <br>
variable PMCD_RECONNECT_TIMEOUT to a comma separated list of
positive integers will re-define the back-off delays, e.g.
setting PMCD_RECONNECT_TIMEOUT to
&lsquo;&lsquo;1,2&rsquo;&rsquo; will <br>
back-off for 1 second, then attempt another connection
request every 2 seconds thereafter.</p>

<p style="margin-top: 1em">PMCD_REQUEST_TIMEOUT <br>
For monitor or client applications connected to pmcd(1),
there is a possibility of the application
&quot;hanging&quot; on a request for performance metrics or
metadata or help text. <br>
These delays may become severe if the system running pmcd
crashes, or the network connection is lost. By setting the
environment variable PMCD_REQUEST_TIMEOUT to a number <br>
of seconds, requests to pmcd will timeout after this number
of seconds. The default behavior is to be willing to wait 10
seconds for a response from every pmcd for all <br>
applications.</p>

<p style="margin-top: 1em">PMCD_WAIT_TIMEOUT <br>
When pmcd(1) is started from $PCP_RC_DIR/pcp then the
primary instance of pmlogger(1) will be started if the
configuration flag pmlogger is chkconfig(8) enabled and pmcd
<br>
is running and accepting connections.</p>

<p style="margin-top: 1em">The check on pmcd&rsquo;s
readiness will wait up to PMCD_WAIT_TIMEOUT seconds. If pmcd
has a long startup time (such as on a very large system),
then PMCD_WAIT_TIMEOUT can be <br>
set to provide a maximum wait longer than the default 60
seconds.</p>

<p style="margin-top: 1em">PMNS_DEFAULT <br>
If set, then interpreted as the full pathname to be used as
the default local PMNS for pmLoadNameSpace(3). Otherwise,
the default local PMNS is located at <br>
$PCP_VAR_DIR/pcp/pmns/root for base PCP installations.</p>

<p style="margin-top: 1em">PCP_COUNTER_WRAP <br>
Many of the performance metrics exported from PCP agents
have the semantics of counter meaning they are expected to
be monotonically increasing. Under some circumstances, <br>
one value of these metrics may smaller than the previously
fetched value. This can happen when a counter of finite
precision overflows, or when the PCP agent has been <br>
reset or restarted, or when the PCP agent is exporting
values from some underlying instrumentation that is subject
to some asynchronous discontinuity.</p>

<p style="margin-top: 1em">The environment variable
PCP_COUNTER_WRAP may be set to indicate that all such cases
of a decreasing &lsquo;&lsquo;counter&rsquo;&rsquo; should
be treated as a counter overflow, and hence the <br>
values are assumed to have wrapped once in the interval
between consecutive samples. This
&lsquo;&lsquo;wrapping&rsquo;&rsquo; behavior was the
default in earlier PCP versions, but by default <br>
has been disabled in PCP release from version 1.3 on.</p>

<p style="margin-top: 1em">PMDA_PATH <br>
The PMDA_PATH environment variable may be used to modify the
search path used by pmcd(1) and pmNewContext(3) (for
PM_CONTEXT_LOCAL contexts) when searching for a daemon or
<br>
DSO PMDA. The syntax follows that for PATH in sh(1), i.e. a
colon separated list of directories, and the default search
path is
&lsquo;&lsquo;/var/pcp/lib:/usr/pcp/lib&rsquo;&rsquo;, (or
<br>
&lsquo;&lsquo;/var/lib/pcp/lib&rsquo;&rsquo; on Linux,
depending on the value of the $PCP_VAR_DIR environment
variable).</p>

<p style="margin-top: 1em">PMCD_PORT <br>
The TPC/IP port(s) used by pmcd(1) to create the socket for
incoming connections and requests, was historically 4321 and
more recently the officially registered port <br>
44321; in the current release, both port numbers are used by
default as a transitional arrangement. This may be
over-ridden by setting PMCD_PORT to a different port
num&acirc; <br>
ber, or a comma-separated list of port numbers. If a
non-default port is used when pmcd is started, then every
monitoring application connecting to that pmcd must also
<br>
have PMCD_PORT set in their environment before attempting a
connection.</p>

<p style="margin-top: 1em">The following environment
variables are relevant to installations in which
pmlogger(1), the PCP archive logger, is used.</p>

<p style="margin-top: 1em">PMLOGGER_PORT <br>
The environment variable PMLOGGER_PORT may be used to change
the base TCP/IP port number used by pmlogger(1) to create
the socket to which pmlc(1) instances will try and <br>
connect. The default base port number is 4330. When used,
PMLOGGER_PORT should be set in the environment before
pmlogger is executed.</p>

<p style="margin-top: 1em">PMLOGGER_REQUEST_TIMEOUT <br>
When pmlc(1) connects to pmlogger(1), there is a remote
possibility of pmlc &quot;hanging&quot; on a request for
information as a consequence of a failure of the network or
pmlog&acirc; <br>
ger. By setting the environment variable
PMLOGGER_REQUEST_TIMEOUT to a number of seconds, requests to
pmlogger will timeout after this number of seconds. The
default <br>
behavior is to be willing to wait forever for a response
from each request to a pmlogger. When used,
PMLOGGER_REQUEST_TIMEOUT should be set in the environment
before pmlc <br>
is executed.</p>

<p style="margin-top: 1em">If you have the PCP product
installed, then the following environment variables are
relevant to the Performance Metrics Domain Agents
(PMDAs).</p>

<p style="margin-top: 1em">PMDA_LOCAL_PROC <br>
Use this variable has been deprecated and it is now ignored.
If the &lsquo;&lsquo;proc&rsquo;&rsquo; PMDA is configured
as a DSO for use with pmcd(1) on the local host then all of
the &lsquo;&lsquo;proc&rsquo;&rsquo; <br>
metrics will be available to applications using a
PM_CONTEXT_LOCAL context.</p>

<p style="margin-top: 1em">The previous behaviour was that
if this variable was set, then a context established with
the type of PM_CONTEXT_LOCAL will have access to the
&lsquo;&lsquo;proc&rsquo;&rsquo; PMDA to retrieve <br>
performance metrics about individual processes.</p>

<p style="margin-top: 1em">PMDA_LOCAL_SAMPLE <br>
Use this variable has been deprecated and it is now ignored.
If the &lsquo;&lsquo;sample&rsquo;&rsquo; PMDA is configured
as a DSO for use with pmcd(1) on the local host then all of
the &lsquo;&lsquo;sam&acirc; <br>
ple&rsquo;&rsquo; metrics will be available to applications
using a PM_CONTEXT_LOCAL context.</p>

<p style="margin-top: 1em">The previous behaviour was that
if this variable was set, then a context established with
the type of PM_CONTEXT_LOCAL will have access to the
&lsquo;&lsquo;sample&rsquo;&rsquo; PMDA if this <br>
optional PMDA has been installed locally.</p>

<p style="margin-top: 1em">PMIECONF_PATH <br>
If set, pmieconf(1) will form its pmieconf(5) specification
(set of parameterized pmie(1) rules) using all valid
pmieconf files found below each subdirectory in this <br>
colon-separated list of subdirectories. If not set, the
default is $PCP_VAR_DIR/config/pmieconf.</p>

<p style="margin-top: 1em">FILES <br>
/etc/pcp.conf <br>
Configuration file for the PCP runtime environment, see
pcp.conf(5). <br>
/etc/pki/nssdb <br>
Optionally contains a Network Security Services database
with a &quot;PCP Collector&quot; certificate providing
trusted identification for the collector host. <br>
$HOME/.pcp <br>
User-specific directories containing configuration files for
customisation of the various monitor tools, such as
pmchart(1). <br>
$HOME/.pki/nssdb <br>
A shared Network Security Services (NSS) database directory
containing per-user certificates identifying known valid
remote pmcd collector hosts. The NSS certutil tool <br>
is one of several that can be used to maintain this
database. <br>
$PCP_RC_DIR/pcp <br>
Script for starting and stopping pmcd(1). <br>
$PCP_PMCDCONF_PATH <br>
Control file for pmcd(1). <br>
$PCP_PMCDOPTIONS_PATH <br>
Command line options passed to pmcd(1) when it is started
from $PCP_RC_DIR/pcp. All the command line option lines
should start with a hyphen as the first character. <br>
This file can also contain environment variable settings of
the form &quot;VARIABLE=value&quot;. <br>
$PCP_BINADM_DIR <br>
Location of PCP utilities for collecting and maintaining PCP
archives, PMDA help text, PMNS files etc. <br>
$PCP_PMDAS_DIR <br>
Parent directory of the installation directory for Dynamic
Shared Object (DSO) PMDAs. <br>
$PCP_RUN_DIR/pmcd.pid <br>
If pmcd is running, this file contains an ascii decimal
representation of its process ID. <br>
$PCP_LOG_DIR/pmcd <br>
Default location of log files for pmcd(1), current directory
for running PMDAs. Archives generated by pmlogger(1) are
generally below $PCP_LOG_DIR/pmlogger. <br>
$PCP_LOG_DIR/pmcd/pmcd.log <br>
Diagnostic and status log for the current running pmcd(1)
process. The first place to look when there are problems
associated with pmcd. <br>
$PCP_LOG_DIR/pmcd/pmcd.log.prev <br>
Diagnostic and status log for the previous pmcd(1) instance.
<br>
$PCP_LOG_DIR/NOTICES <br>
Log of pmcd(1) and PMDA starts, stops, additions and
removals. <br>
$PCP_VAR_DIR/config <br>
Contains directories of configuration files for several PCP
tools. <br>
$PCP_SYSCONF_DIR/pmcd/rc.local <br>
Local script for controlling PCP boot, shutdown and restart
actions. <br>
$PCP_VAR_DIR/pmns <br>
Directory containing the set of PMNS files for all installed
PMDAs. <br>
$PCP_VAR_DIR/pmns/root <br>
The ASCII pmns(5) exported by pmcd(1) by default. This PMNS
is be the super set of all other PMNS files installed in
$PCP_VAR_DIR/pmns. <br>
In addition, if the PCP product is installed the following
files and directories are relevant. <br>
$PCP_LOG_DIR/NOTICES <br>
In addition to the pmcd(1) and PMDA activity, may be used to
log alarms and notices from pmie(1) via pmpost(1). <br>
$PCP_PMLOGGERCONTROL_PATH <br>
Control file for pmlogger(1) instances launched from
$PCP_RC_DIR/pcp and/or managed by pmlogger_check(1) and
pmlogger_daily(1) as part of a production PCP archive
collec&acirc; <br>
tion setup.</p>

<p style="margin-top: 1em">PCP ENVIRONMENT <br>
Environment variables with the prefix PCP_ are used to
parameterize the file and directory names used by PCP. On
each installation, the file /etc/pcp.conf contains the local
<br>
values for these variables. The $PCP_CONF variable may be
used to specify an alternative configuration file, as
described in pcp.conf(5).</p>

<p style="margin-top: 1em">SEE ALSO <br>
pmcd(1), pmie(1), pmie_daily(1), pminfo(1), pmlc(1),
pmlogger(1), pmlogger_daily(1), pmrep(1), pmstat(1),
pmval(1), pcp(1), pcp.conf(5), pcp.env(5), pmns(5) and
chkconfig(8).</p>

<p style="margin-top: 1em">If the PCP GUI package is
installed, then the following entries are also relevant:
<br>
pmchart(1), pmtime(1), and pmdumptext(1).</p>

<p style="margin-top: 1em">If the secure sockets extensions
have been enabled, then the following references are also
relevant: <br>
http://www.pcp.io/documentation.html <br>

http://www.mozilla.org/projects/security/pki/nss/#documentation
<br>

http://www.mozilla.org/projects/security/pki/nss/tools/certutil.html</p>

<p style="margin-top: 1em">Also refer to the books
Performance Co-Pilot User&rsquo;s and Administrator&rsquo;s
Guide and Performance Co-Pilot Programmer&rsquo;s Guide
which can be found at http://www.pcp.io/</p>

<p style="margin-top: 1em">Performance Co-Pilot PCP
PCPINTRO(1)</p>
<hr>
</body>
</html>
