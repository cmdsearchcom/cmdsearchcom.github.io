<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>MYSQLPROCGREP(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">MYSQLPROCGREP(1)</td>
    <td class="head-vol">MySQL Utilities</td>
    <td class="head-rtitle">MYSQLPROCGREP(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
mysqlprocgrep - Search Server Process Lists
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div class="Pp" style="margin-left: 24.00ex; text-indent: -24.00ex;"><b>mysqlprocgrep
  [</b> <b></b><i>options</i><b>]</b></div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This utility scans the process lists for the servers specified using instances
  of the <b>--server</b> option and selects those that match the conditions
  specified using the <b>--age</b> and --match-xxx options. For a process to
  match, all conditions given must match. The utility then either prints the
  selected processes (the default) or executes certain actions on them.
<div class="Pp"></div>
If no <b>--age</b> or --match-xxx options are given, the utility selects all
  processes.
<div class="Pp"></div>
The --match-xxx options correspond to the columns in the
  <b>INFORMATION_SCHEMA.PROCESSLIST</b> table. For example,
  <b>--match-command</b> specifies a matching condition for
  <b>PROCESSLIST.COMMAND</b> column values. There is no --match-time option. To
  specify a condition based on process time, use <b>--age</b>.
<div class="Pp"></div>
Processes that can be seen and killed are subject to whether the account used to
  connect to the server has the <b>PROCESS</b> and <b>SUPER</b> privileges.
  Without <b>PROCESS</b>, the account cannot see processes belonging to other
  accounts Without <b>SUPER</b>, the account cannot kill processes belonging to
  other accounts
<div class="Pp"></div>
To specify how to display output, use one of the following values with the
  <b>--format</b> option:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>grid</b> (default)
<div style="height: 1.00em;">&#x00A0;</div>
Display output in grid or table format like that of the <b>mysql</b> client
  command-line tool.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>csv</b>
<div style="height: 1.00em;">&#x00A0;</div>
Display output in comma-separated values format.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>tab</b>
<div style="height: 1.00em;">&#x00A0;</div>
Display output in tab-separated format.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>vertical</b>
<div style="height: 1.00em;">&#x00A0;</div>
Display output in single-column format like that of the \G command for the
  <b>mysql</b> client command-line tool.</div>
Options.PP <b>mysqlprocgrep</b> accepts the following command-line options:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--help
<div style="height: 1.00em;">&#x00A0;</div>
Display a help message and exit.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--license
<div style="height: 1.00em;">&#x00A0;</div>
Display license information and exit.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--age=&lt;time&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Select only processes that have been in the current state more than a given
  time. The time value can be specified in two formats: either using the
  hh:mm:ss format, with hours and minutes optional, or as a sequence of numbers
  with a suffix giving the period size.
<div style="height: 1.00em;">&#x00A0;</div>
The permitted suffixes are <b>s</b> (second), <b>m</b> (minute), <b>h</b>
  (hour), <b>d</b> (day), and <b>w</b> (week). For example, <b>4h15m</b>
  represents 4 hours and 15 minutes.
<div style="height: 1.00em;">&#x00A0;</div>
For both formats, the specification can optionally be preceded by + or -, where
  + means older than the given time, and - means younger than the given
  time.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--character-set=&lt;charset&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Sets the client character set. The default is retrieved from the server variable
  character_set_client.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--format=&lt;format&gt;,
  -f&lt;format&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Specify the output display format. Permitted format values are <b>grid</b>
  (default), <b>csv</b>, <b>tab</b>, and <b>vertical</b>.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--kill-connection
<div style="height: 1.00em;">&#x00A0;</div>
Kill the connection for all matching processes (like the KILL CONNECTION
  statement).</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--kill-query
<div style="height: 1.00em;">&#x00A0;</div>
Kill the query for all matching processes (like the KILL QUERY statement).</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--match-command=&lt;pattern&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Match all processes where the <b>Command</b> field matches the pattern.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--match-db=&lt;pattern&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Match all processes where the <b>Db</b> field matches the pattern.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--match-host=&lt;pattern&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Match all processes where the <b>Host</b> field matches the pattern.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--match-id=&lt;pattern&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Match all processes where the <b>ID</b> field matches the pattern.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--match-info=&lt;pattern&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Match all processes where the <b>Info</b> field matches the pattern.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--match-state=&lt;pattern&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Match all processes where the <b>State</b> field matches the pattern.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--match-user=&lt;pattern&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Match all processes where the <b>User</b> field matches the pattern.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--print
<div style="height: 1.00em;">&#x00A0;</div>
Print information about the matching processes. This is the default if no
  <b>--kill-connection</b> or <b>--kill-query</b> option is given. If a kill
  option is given, <b>--print</b> prints information about the processes before
  killing them.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--regexp, --basic-regexp, -G
<div style="height: 1.00em;">&#x00A0;</div>
Perform pattern matches using the <b>REGEXP</b> operator. The default is to use
  <b>LIKE</b> for matching. This affects the --match-xxx options.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--server=&lt;source&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Connection information for a server. Use this option multiple times to search
  multiple servers.
<div style="height: 1.00em;">&#x00A0;</div>
To connect to a server, it is necessary to specify connection parameters such as
  user name, host name, password, and either a port or socket. MySQL Utilities
  provides a number of ways to provide this information. All of the methods
  require specifying your choice via a command-line option such as --server,
  --master, --slave, etc. The methods include the following in order of most
  secure to least secure.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Use login-paths from your .mylogin.cnf
  file (encrypted, not visible). Example : &lt;
  <i>login-path</i>&gt;[:&lt;<i>port</i>&gt;][:&lt; <i>socket</i>&gt;]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Use a configuration file (unencrypted,
  not visible) Note: available in release-1.5.0. Example : &lt;
  <i>configuration-file-path</i>&gt;[:&lt; <i>section</i>&gt;]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Specify the data on the command-line
  (unencrypted, visible). Example : &lt;
  <i>user</i>&gt;[:&lt;<i>passwd</i>&gt;]@&lt;
  <i>host</i>&gt;[:&lt;<i>port</i>&gt;][:&lt; <i>socket</i>&gt;]</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--sql, --print-sql, -Q
<div style="height: 1.00em;">&#x00A0;</div>
Instead of displaying the selected processes, emit the <b>SELECT</b> statement
  that retrieves information about them. If the <b>--kill-connection</b> or
  <b>--kill-query</b> option is given, the utility generates a stored procedure
  named kill_processes() for killing the queries rather than a <b>SELECT</b>
  statement.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--sql-body
<div style="height: 1.00em;">&#x00A0;</div>
Like <b>--sql</b>, but produces the output as the body of a stored procedure
  without the <b>CREATE PROCEDURE</b> part of the definition. This could be
  used, for example, to generate an event for the server Event Manager.
<div style="height: 1.00em;">&#x00A0;</div>
When used with a kill option, code for killing the matching queries is
  generated. Note that it is not possible to execute the emitted code unless it
  is put in a stored routine, event, or trigger. For example, the following code
  could be generated to kill all idle connections for user www-data:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
shell&gt;  <b>mysqlprocgrep --kill-connection --sql-body \</b>
           <b>--match-user=www-data --match-state=sleep</b>
DECLARE kill_done INT;
DECLARE kill_cursor CURSOR FOR
  SELECT
        Id, User, Host, Db, Command, Time, State, Info
      FROM
        INFORMATION_SCHEMA.PROCESSLIST
      WHERE
          user LIKE 'www-data'
        AND
          State LIKE 'sleep'
OPEN kill_cursor;
BEGIN
   DECLARE id BIGINT;
   DECLARE EXIT HANDLER FOR NOT FOUND SET kill_done = 1;
   kill_loop: LOOP
      FETCH kill_cursor INTO id;
      KILL CONNECTION id;
   END LOOP kill_loop;
END;
CLOSE kill_cursor;
</pre>
</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--ssl-ca
<div style="height: 1.00em;">&#x00A0;</div>
The path to a file that contains a list of trusted SSL CAs.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--ssl-cert
<div style="height: 1.00em;">&#x00A0;</div>
The name of the SSL certificate file to use for establishing a secure
  connection.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--ssl-cert
<div style="height: 1.00em;">&#x00A0;</div>
The name of the SSL key file to use for establishing a secure connection.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--ssl
<div style="height: 1.00em;">&#x00A0;</div>
Specifies if the server connection requires use of SSL. If an encrypted
  connection cannot be established, the connection attempt fails. Default
  setting is 0 (SSL not required).</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--verbose, -v
<div style="height: 1.00em;">&#x00A0;</div>
Specify how much information to display. Use this option multiple times to
  increase the amount of information. For example, <b>-v</b> = verbose,
  <b>-vv</b> = more verbose, <b>-vvv</b> = debug.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;--version
<div style="height: 1.00em;">&#x00A0;</div>
Display version information and exit.</div>
NOTES.PP For the <b>--format</b> option, the permitted values are not case
  sensitive. In addition, values may be specified as any unambiguous prefix of a
  valid value. For example, <b>--format=g</b> specifies the grid format. An
  error occurs if a prefix matches more than one valid value.
<div class="Pp"></div>
The path to the MySQL client tools should be included in the PATH environment
  variable in order to use the authentication mechanism with login-paths. This
  will allow the utility to use the <b>my_print_defaults</b> tools which is
  required to read the login-path values from the login configuration file
  (.mylogin.cnf). EXAMPLES.PP For each example, assume that the root user on
  localhost has sufficient privileges to kill queries and connections.
<div class="Pp"></div>
Kill all queries created by user john that are less than 1 minute:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
shell&gt;  <b>mysqlprocgrep --server=root@localhost \</b>
           <b>--match-user=john --age=-1m --kill-query</b>
</pre>
</div>
<div class="Pp"></div>
Kill all connections that have been idle for more than 1 hour:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
shell&gt;  <b>mysqlprocgrep --server=root@localhost \</b>
           <b>--match-command=sleep --age=1h --kill-connection</b>
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
PERMISSIONS REQUIRED.PP The user must have the SELECT privilege on the mysql
  database.
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
Copyright &#x00A9; 2006, 2015, Oracle and/or its affiliates. All rights
  reserved.
<div class="Pp"></div>
This documentation is free software; you can redistribute it and/or modify it
  only under the terms of the GNU General Public License as published by the
  Free Software Foundation; version 2 of the License.
<div class="Pp"></div>
This documentation is distributed in the hope that it will be useful, but
  WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more
  details.
<div class="Pp"></div>
You should have received a copy of the GNU General Public License along with the
  program; if not, write to the Free Software Foundation, Inc., 51 Franklin
  Street, Fifth Floor, Boston, MA 02110-1301 USA or see
  http://www.gnu.org/licenses/.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
For more information, please refer to the MySQL Utilities and Fabric
  documentation, which is available online at
  http://dev.mysql.com/doc/index-utils-fabric.html
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Oracle Corporation (http://dev.mysql.com/).</div>
<table class="foot">
  <tr>
    <td class="foot-date">09/15/2015</td>
    <td class="foot-os">MySQL 1.5.6</td>
  </tr>
</table>
</body>
</html>
