<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 15:55:21 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>BLHC(1) User Contributed Perl Documentation BLHC(1)</p>

<p style="margin-top: 1em">NAME <br>
blhc - build log hardening check, checks build logs for
missing hardening flags</p>

<p style="margin-top: 1em">SYNOPSIS <br>
blhc [options] &lt;dpkg-buildpackage build log
file&gt;..</p>

<p style="margin-top: 1em">DESCRIPTION <br>
blhc is a small tool which checks build logs for missing
hardening flags. It&rsquo;s licensed under the GPL 3 or
later.</p>

<p style="margin-top: 1em">It&rsquo;s designed to check
build logs generated by Debian&rsquo;s dpkg-buildpackage (or
tools using dpkg-buildpackage like pbuilder or sbuild (which
is used for the official buildd build <br>
logs)) to help maintainers detect missing hardening flags in
their packages.</p>

<p style="margin-top: 1em">Only gcc is detected as compiler
at the moment. If other compilers support hardening flags as
well, please report them.</p>

<p style="margin-top: 1em">If there&rsquo;s no output, no
flags are missing and the build log is fine.</p>

<p style="margin-top: 1em">See README for details about
performed checks, auto-detection and limitations.</p>

<p style="margin-top: 1em">OPTIONS <br>
--all Force check for all +all (+pie, +bindnow) hardening
flags. By default it&rsquo;s auto detected.</p>

<p style="margin-top: 1em">--arch architecture <br>
Set the specific architecture (e.g. amd64, armel, etc.),
automatically disables hardening flags not available on this
architecture. Is detected automatically if dpkg- <br>
buildpackage is used.</p>

<p style="margin-top: 1em">--bindnow <br>
Force check for all +bindnow hardening flags. By default
it&rsquo;s auto detected.</p>

<p style="margin-top: 1em">--buildd <br>
Special mode for buildds when automatically parsing log
files. The following changes are in effect:</p>

<p style="margin-top: 1em">&Acirc;&middot; Print tags
instead of normal warnings, see &quot;BUILDD TAGS&quot; for
a list of possible tags.</p>

<p style="margin-top: 1em">&Acirc;&middot; Don&rsquo;t
check hardening flags in old log files (if dpkg-dev &lt;&lt;
1.16.1 is detected).</p>

<p style="margin-top: 1em">&Acirc;&middot; Don&rsquo;t
require Term::ANSIColor.</p>

<p style="margin-top: 1em">&Acirc;&middot; Return exit code
0, unless there was a error (-I, -W messages don&rsquo;t
count as error).</p>

<p style="margin-top: 1em">--color Use colored (ANSI)
output for warning messages.</p>

<p style="margin-top: 1em">--ignore-arch arch <br>
Ignore build logs from architectures matching arch. arch is
a string.</p>

<p style="margin-top: 1em">Used to prevent false positives.
This option can be specified multiple times.</p>

<p style="margin-top: 1em">--ignore-arch-flag arch:flag
<br>
Like --ignore-flag, but only ignore flag on arch.</p>

<p style="margin-top: 1em">--ignore-arch-line arch:line
<br>
Like --ignore-line, but only ignore line on arch.</p>

<p style="margin-top: 1em">--ignore-flag flag <br>
Don&rsquo;t print an error when the specific flag is missing
in a compiler line. flag is a string.</p>

<p style="margin-top: 1em">Used to prevent false positives.
This option can be specified multiple times.</p>

<p style="margin-top: 1em">--ignore-line regex <br>
Ignore lines matching the given Perl regex. regex is
automatically anchored at the beginning and end of the line
to prevent false negatives.</p>

<p style="margin-top: 1em">NOTE: Not the input lines are
checked, but the lines which are displayed in warnings
(which have line continuation resolved).</p>

<p style="margin-top: 1em">Used to prevent false positives.
This option can be specified multiple times.</p>

<p style="margin-top: 1em">--pie Force check for all +pie
hardening flags. By default it&rsquo;s auto detected.</p>

<p style="margin-top: 1em">-h -? --help <br>
Print available options.</p>

<p style="margin-top: 1em">--version <br>
Print version number and license.</p>

<p style="margin-top: 1em">Auto detection for --pie and
--bindnow only works if at least one command uses the
required hardening flag (e.g. -fPIE). Then it&rsquo;s
required for all other commands as well.</p>

<p style="margin-top: 1em">EXAMPLES <br>
Normal usage, parse a single log file.</p>

<p style="margin-top: 1em">blhc path/to/log/file</p>

<p style="margin-top: 1em">If there&rsquo;s no output, no
flags are missing and the build log is fine.</p>

<p style="margin-top: 1em">Parse multiple log files. The
exit code is ORed over all files.</p>

<p style="margin-top: 1em">blhc
path/to/directory/with/log/files/*</p>

<p style="margin-top: 1em">Don&rsquo;t treat missing
&quot;-g&quot; as error:</p>

<p style="margin-top: 1em">blhc --ignore-flag -g
path/to/log/file</p>

<p style="margin-top: 1em">Don&rsquo;t treat missing
&quot;-pie&quot; on kfreebsd-amd64 as error:</p>

<p style="margin-top: 1em">blhc --ignore-arch-flag
kfreebsd-amd64:-pie path/to/log/file</p>

<p style="margin-top: 1em">Ignore lines consisting exactly
of &quot;./script gcc file&quot; which would cause a false
positive.</p>

<p style="margin-top: 1em">blhc --ignore-line
&rsquo;./script gcc file&rsquo; path/to/log/file</p>

<p style="margin-top: 1em">Ignore lines matching
&quot;./script gcc file&quot; somewhere in the line.</p>

<p style="margin-top: 1em">blhc --ignore-line
&rsquo;.*./script gcc file.*&rsquo; path/to/log/file</p>

<p style="margin-top: 1em">Use blhc with pbuilder.</p>

<p style="margin-top: 1em">pbuilder path/to/package.dsc |
tee path/log/file <br>
blhc path/to/file || echo flags missing</p>

<p style="margin-top: 1em">BUILDD TAGS <br>
The following tags are used in --buildd mode. In braces the
additional data which is displayed.</p>

<p style="margin-top: 1em">I-hardening-wrapper-used <br>
The package uses hardening-wrapper which intercepts calls to
gcc and adds hardening flags. The build log doesn&rsquo;t
contain any hardening flags and thus can&rsquo;t be checked
by blhc.</p>

<p style="margin-top: 1em">W-compiler-flags-hidden (summary
of hidden lines) <br>
Build log contains lines which hide the real compiler flags.
For example:</p>

<p style="margin-top: 1em">CC test-a.c <br>
CC test-b.c <br>
CC test-c.c <br>
LD test</p>

<p style="margin-top: 1em">Most of the time either
&quot;export V=1&quot; or &quot;export verbose=1&quot; in
debian/rules fixes builds with hidden compiler flags.
Sometimes &quot;.SILENT&quot; in a Makefile must be removed.
And as <br>
last resort the Makefile must be patched to remove the
&quot;@&quot;s hiding the real compiler commands.</p>

<p style="margin-top: 1em">W-dpkg-buildflags-missing
(summary of missing flags) <br>
CPPFLAGS, CFLAGS, CXXFLAGS, LDFLAGS missing.</p>

<p style="margin-top: 1em">I-invalid-cmake-used (version)
<br>
By default CMake ignores CPPFLAGS thus missing those
hardening flags. Debian patched CMake in versions 2.8.7-1
and 2.8.7-2 to respect CPPFLAGS, but this patch was rejected
by <br>
upstream and later reverted in Debian. Thus those two
versions show correct usage of CPPFLAGS even if the package
doesn&rsquo;t correctly handle them (for example by passing
them to <br>
CFLAGS). To prevent false negatives just blacklist those two
versions.</p>

<p style="margin-top: 1em">I-no-compiler-commands <br>
No compiler commands were detected. Either the log contains
none or they were not correctly detected by blhc (please
report the bug in this case).</p>

<p style="margin-top: 1em">EXIT STATUS <br>
The exit status is a &quot;bit mask&quot;, each listed
status is ORed when the error condition occurs to get the
result.</p>

<p style="margin-top: 1em">0 Success.</p>

<p style="margin-top: 1em">1 No compiler commands were
found.</p>

<p style="margin-top: 1em">2 Invalid arguments/options
given to blhc.</p>

<p style="margin-top: 1em">4 Non verbose build.</p>

<p style="margin-top: 1em">8 Missing hardening flags.</p>

<p style="margin-top: 1em">16 Hardening wrapper detected,
no tests performed.</p>

<p style="margin-top: 1em">32 Invalid CMake version used.
See I-invalid-cmake-used under &quot;BUILDD TAGS&quot; for a
detailed explanation.</p>

<p style="margin-top: 1em">AUTHOR <br>
Simon Ruderich, &lt;simon@ruderich.org&gt;</p>

<p style="margin-top: 1em">Thanks to to Bernhard R. Link
&lt;brlink@debian.org&gt; and Jaria Alto
&lt;jari.aalto@cante.net&gt; for their valuable input and
suggestions.</p>

<p style="margin-top: 1em">LICENSE AND COPYRIGHT <br>
Copyright (C) 2012-2016 by Simon Ruderich</p>

<p style="margin-top: 1em">This program is free software:
you can redistribute it and/or modify it under the terms of
the GNU General Public License as published by the Free
Software Foundation, either <br>
version 3 of the License, or (at your option) any later
version.</p>

<p style="margin-top: 1em">This program is distributed in
the hope that it will be useful, but WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR <br>
PURPOSE. See the GNU General Public License for more
details.</p>

<p style="margin-top: 1em">You should have received a copy
of the GNU General Public License along with this program.
If not, see &lt;http://www.gnu.org/licenses/&gt;.</p>

<p style="margin-top: 1em">SEE ALSO <br>
hardening-check(1), dpkg-buildflags(1)</p>

<p style="margin-top: 1em">perl v5.24.1 2017-01-08
BLHC(1)</p>
<hr>
</body>
</html>
