<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:30:54 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>PERLHACK(1) Perl Programmers Reference Guide
PERLHACK(1)</p>

<p style="margin-top: 1em">NAME <br>
perlhack - How to hack on Perl</p>

<p style="margin-top: 1em">DESCRIPTION <br>
This document explains how Perl development works. It
includes details about the Perl 5 Porters email list, the
Perl repository, the Perlbug bug tracker, patch guidelines,
and <br>
commentary on Perl development philosophy.</p>

<p style="margin-top: 1em">SUPER QUICK PATCH GUIDE <br>
If you just want to submit a single small patch like a pod
fix, a test for a bug, comment fixes, etc., it&rsquo;s easy!
Here&rsquo;s how:</p>

<p style="margin-top: 1em">&Acirc;&middot; Check out the
source repository</p>

<p style="margin-top: 1em">The perl source is in a git
repository. You can clone the repository with the following
command:</p>

<p style="margin-top: 1em">% git clone
git://perl5.git.perl.org/perl.git perl</p>

<p style="margin-top: 1em">&Acirc;&middot; Make your
change</p>

<p style="margin-top: 1em">Hack, hack, hack.</p>

<p style="margin-top: 1em">&Acirc;&middot; Test your
change</p>

<p style="margin-top: 1em">You can run all the tests with
the following commands:</p>

<p style="margin-top: 1em">% ./Configure -des -Dusedevel
<br>
% make test</p>

<p style="margin-top: 1em">Keep hacking until the tests
pass.</p>

<p style="margin-top: 1em">&Acirc;&middot; Commit your
change</p>

<p style="margin-top: 1em">Committing your work will save
the change on your local system:</p>

<p style="margin-top: 1em">% git commit -a -m &rsquo;Commit
message goes here&rsquo;</p>

<p style="margin-top: 1em">Make sure the commit message
describes your change in a single sentence. For example,
&quot;Fixed spelling errors in perlhack.pod&quot;.</p>

<p style="margin-top: 1em">&Acirc;&middot; Send your change
to perlbug</p>

<p style="margin-top: 1em">The next step is to submit your
patch to the Perl core ticket system via email.</p>

<p style="margin-top: 1em">Assuming your patch consists of
a single git commit, the following writes the file as a MIME
attachment, and sends it with a meaningful subject:</p>

<p style="margin-top: 1em">% git format-patch -1 --attach
<br>
% perlbug -s &quot;[PATCH] $(git log -1 --oneline
HEAD)&quot; -f 0001-*.patch</p>

<p style="margin-top: 1em">The perlbug program will ask you
a few questions about your email address and the patch
you&rsquo;re submitting. Once you&rsquo;ve answered them it
will submit your patch via email.</p>

<p style="margin-top: 1em">&Acirc;&middot; Thank you</p>

<p style="margin-top: 1em">The porters appreciate the time
you spent helping to make Perl better. Thank you!</p>

<p style="margin-top: 1em">BUG REPORTING <br>
If you want to report a bug in Perl, you must use the
perlbug command line tool. This tool will ensure that your
bug report includes all the relevant system and
configuration <br>
information.</p>

<p style="margin-top: 1em">To browse existing Perl bugs and
patches, you can use the web interface at
&lt;http://rt.perl.org/&gt;.</p>

<p style="margin-top: 1em">Please check the archive of the
perl5-porters list (see below) and/or the bug tracking
system before submitting a bug report. Often, you&rsquo;ll
find that the bug has been reported <br>
already.</p>

<p style="margin-top: 1em">You can log in to the bug
tracking system and comment on existing bug reports. If you
have additional information regarding an existing bug,
please add it. This will help the <br>
porters fix the bug.</p>

<p style="margin-top: 1em">PERL 5 PORTERS <br>
The perl5-porters (p5p) mailing list is where the Perl
standard distribution is maintained and developed. The
people who maintain Perl are also referred to as the
&quot;Perl 5 <br>
Porters&quot;, &quot;p5p&quot; or just the
&quot;porters&quot;.</p>

<p style="margin-top: 1em">A searchable archive of the list
is available at
http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/
&lt;http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/&gt;.
There is also <br>
another archive at
http://archive.develooper.com/perl5-porters@perl.org/
&lt;http://archive.develooper.com/perl5-porters@perl.org/&gt;.</p>

<p style="margin-top: 1em">perl-changes mailing list <br>
The perl5-changes mailing list receives a copy of each patch
that gets submitted to the maintenance and development
branches of the perl repository. See <br>
http://lists.perl.org/list/perl5-changes.html
&lt;http://lists.perl.org/list/perl5-changes.html&gt; for
subscription and archive information.</p>

<p style="margin-top: 1em">#p5p on IRC <br>
Many porters are also active on the
&lt;irc://irc.perl.org/#p5p&gt; channel. Feel free to join
the channel and ask questions about hacking on the Perl
core.</p>

<p style="margin-top: 1em">GETTING THE PERL SOURCE <br>
All of Perl&rsquo;s source code is kept centrally in a Git
repository at perl5.git.perl.org. The repository contains
many Perl revisions from Perl 1 onwards and all the
revisions from <br>
Perforce, the previous version control system.</p>

<p style="margin-top: 1em">For much more detail on using
git with the Perl repository, please see perlgit.</p>

<p style="margin-top: 1em">Read access via Git <br>
You will need a copy of Git for your computer. You can fetch
a copy of the repository using the git protocol:</p>

<p style="margin-top: 1em">% git clone
git://perl5.git.perl.org/perl.git perl</p>

<p style="margin-top: 1em">This clones the repository and
makes a local copy in the perl directory.</p>

<p style="margin-top: 1em">If you cannot use the git
protocol for firewall reasons, you can also clone via http,
though this is much slower:</p>

<p style="margin-top: 1em">% git clone
http://perl5.git.perl.org/perl.git perl</p>

<p style="margin-top: 1em">Read access via the web <br>
You may access the repository over the web. This allows you
to browse the tree, see recent commits, subscribe to RSS
feeds for the changes, search for particular commits and
<br>
more. You may access it at
&lt;http://perl5.git.perl.org/perl.git&gt;. A mirror of the
repository is found at
&lt;http://github.com/mirrors/perl&gt;.</p>

<p style="margin-top: 1em">Read access via rsync <br>
You can also choose to use rsync to get a copy of the
current source tree for the bleadperl branch and all
maintenance branches:</p>

<p style="margin-top: 1em">% rsync -avz
rsync://perl5.git.perl.org/perl-current . <br>
% rsync -avz rsync://perl5.git.perl.org/perl-5.12.x . <br>
% rsync -avz rsync://perl5.git.perl.org/perl-5.10.x . <br>
% rsync -avz rsync://perl5.git.perl.org/perl-5.8.x . <br>
% rsync -avz rsync://perl5.git.perl.org/perl-5.6.x . <br>
% rsync -avz rsync://perl5.git.perl.org/perl-5.005xx .</p>

<p style="margin-top: 1em">(Add the &quot;--delete&quot;
option to remove leftover files.)</p>

<p style="margin-top: 1em">To get a full list of the
available sync points:</p>

<p style="margin-top: 1em">% rsync perl5.git.perl.org::</p>

<p style="margin-top: 1em">Write access via git <br>
If you have a commit bit, please see perlgit for more
details on using git.</p>

<p style="margin-top: 1em">PATCHING PERL <br>
If you&rsquo;re planning to do more extensive work than a
single small fix, we encourage you to read the documentation
below. This will help you focus your work and make your
patches <br>
easier to incorporate into the Perl source.</p>

<p style="margin-top: 1em">Submitting patches <br>
If you have a small patch to submit, please submit it via
perlbug. You can also send email directly to
perlbug@perl.org. Please note that messages sent to perlbug
may be held in <br>
a moderation queue, so you won&rsquo;t receive a response
immediately.</p>

<p style="margin-top: 1em">You&rsquo;ll know your
submission has been processed when you receive an email from
our ticket tracking system. This email will give you a
ticket number. Once your patch has made it to <br>
the ticket tracking system, it will also be sent to the
perl5-porters@perl.org list.</p>

<p style="margin-top: 1em">Patches are reviewed and
discussed on the p5p list. Simple, uncontroversial patches
will usually be applied without any discussion. When the
patch is applied, the ticket will be <br>
updated and you will receive email. In addition, an email
will be sent to the p5p list.</p>

<p style="margin-top: 1em">In other cases, the patch will
need more work or discussion. That will happen on the p5p
list.</p>

<p style="margin-top: 1em">You are encouraged to
participate in the discussion and advocate for your patch.
Sometimes your patch may get lost in the shuffle. It&rsquo;s
appropriate to send a reminder email to <br>
p5p if no action has been taken in a month. Please remember
that the Perl 5 developers are all volunteers, and be
polite.</p>

<p style="margin-top: 1em">Changes are always applied
directly to the main development branch, called
&quot;blead&quot;. Some patches may be backported to a
maintenance branch. If you think your patch is <br>
appropriate for the maintenance branch, please explain why
when you submit it.</p>

<p style="margin-top: 1em">Getting your patch accepted <br>
If you are submitting a code patch there are several things
that you can do to help the Perl 5 Porters accept your
patch.</p>

<p style="margin-top: 1em">Patch style</p>

<p style="margin-top: 1em">If you used git to check out the
Perl source, then using &quot;git format-patch&quot; will
produce a patch in a style suitable for Perl. The
&quot;format-patch&quot; command produces one patch file
<br>
for each commit you made. If you prefer to send a single
patch for all commits, you can use &quot;git diff&quot;.</p>

<p style="margin-top: 1em">% git checkout blead <br>
% git pull <br>
% git diff blead my-branch-name</p>

<p style="margin-top: 1em">This produces a patch based on
the difference between blead and your current branch.
It&rsquo;s important to make sure that blead is up to date
before producing the diff, that&rsquo;s why we <br>
call &quot;git pull&quot; first.</p>

<p style="margin-top: 1em">We strongly recommend that you
use git if possible. It will make your life easier, and ours
as well.</p>

<p style="margin-top: 1em">However, if you&rsquo;re not
using git, you can still produce a suitable patch.
You&rsquo;ll need a pristine copy of the Perl source to diff
against. The porters prefer unified diffs. Using <br>
GNU &quot;diff&quot;, you can produce a diff like this:</p>

<p style="margin-top: 1em">% diff -Npurd perl.pristine
perl.mine</p>

<p style="margin-top: 1em">Make sure that you &quot;make
realclean&quot; in your copy of Perl to remove any build
artifacts, or you may get a confusing result.</p>

<p style="margin-top: 1em">Commit message</p>

<p style="margin-top: 1em">As you craft each patch you
intend to submit to the Perl core, it&rsquo;s important to
write a good commit message. This is especially important if
your submission will consist of a <br>
series of commits.</p>

<p style="margin-top: 1em">The first line of the commit
message should be a short description without a period. It
should be no longer than the subject line of an email, 50
characters being a good rule of <br>
thumb.</p>

<p style="margin-top: 1em">A lot of Git tools (Gitweb,
GitHub, git log --pretty=oneline, ...) will only display the
first line (cut off at 50 characters) when presenting commit
summaries.</p>

<p style="margin-top: 1em">The commit message should
include a description of the problem that the patch corrects
or new functionality that the patch adds.</p>

<p style="margin-top: 1em">As a general rule of thumb, your
commit message should help a programmer who knows the Perl
core quickly understand what you were trying to do, how you
were trying to do it, and <br>
why the change matters to Perl.</p>

<p style="margin-top: 1em">&Acirc;&middot; Why</p>

<p style="margin-top: 1em">Your commit message should
describe why the change you are making is important. When
someone looks at your change in six months or six years,
your intent should be clear.</p>

<p style="margin-top: 1em">If you&rsquo;re deprecating a
feature with the intent of later simplifying another bit of
code, say so. If you&rsquo;re fixing a performance problem
or adding a new feature to support <br>
some other bit of the core, mention that.</p>

<p style="margin-top: 1em">&Acirc;&middot; What</p>

<p style="margin-top: 1em">Your commit message should
describe what part of the Perl core you&rsquo;re changing
and what you expect your patch to do.</p>

<p style="margin-top: 1em">&Acirc;&middot; How</p>

<p style="margin-top: 1em">While it&rsquo;s not necessary
for documentation changes, new tests or trivial patches,
it&rsquo;s often worth explaining how your change works.
Even if it&rsquo;s clear to you today, it may <br>
not be clear to a porter next month or next year.</p>

<p style="margin-top: 1em">A commit message isn&rsquo;t
intended to take the place of comments in your code. Commit
messages should describe the change you made, while code
comments should describe the current <br>
state of the code.</p>

<p style="margin-top: 1em">If you&rsquo;ve just implemented
a new feature, complete with doc, tests and well-commented
code, a brief commit message will often suffice. If,
however, you&rsquo;ve just changed a single <br>
character deep in the parser or lexer, you might need to
write a small novel to ensure that future readers understand
what you did and why you did it.</p>

<p style="margin-top: 1em">Comments, Comments, Comments</p>

<p style="margin-top: 1em">Be sure to adequately comment
your code. While commenting every line is unnecessary,
anything that takes advantage of side effects of operators,
that creates changes that will be <br>
felt outside of the function being patched, or that others
may find confusing should be documented. If you are going to
err, it is better to err on the side of adding too many <br>
comments than too few.</p>

<p style="margin-top: 1em">The best comments explain why
the code does what it does, not what it does.</p>

<p style="margin-top: 1em">Style</p>

<p style="margin-top: 1em">In general, please follow the
particular style of the code you are patching.</p>

<p style="margin-top: 1em">In particular, follow these
general guidelines for patching Perl sources:</p>

<p style="margin-top: 1em">&Acirc;&middot; 8-wide tabs (no
exceptions!)</p>

<p style="margin-top: 1em">&Acirc;&middot; 4-wide indents
for code, 2-wide indents for nested CPP #defines</p>

<p style="margin-top: 1em">&Acirc;&middot; Try hard not to
exceed 79-columns</p>

<p style="margin-top: 1em">&Acirc;&middot; ANSI C
prototypes</p>

<p style="margin-top: 1em">&Acirc;&middot; Uncuddled elses
and &quot;K&amp;R&quot; style for indenting control
constructs</p>

<p style="margin-top: 1em">&Acirc;&middot; No C++ style
(//) comments</p>

<p style="margin-top: 1em">&Acirc;&middot; Mark places that
need to be revisited with XXX (and revisit often!)</p>

<p style="margin-top: 1em">&Acirc;&middot; Opening brace
lines up with &quot;if&quot; when conditional spans multiple
lines; should be at end-of-line otherwise</p>

<p style="margin-top: 1em">&Acirc;&middot; In function
definitions, name starts in column 0 (return value is on
previous line)</p>

<p style="margin-top: 1em">&Acirc;&middot; Single space
after keywords that are followed by parens, no space between
function name and following paren</p>

<p style="margin-top: 1em">&Acirc;&middot; Avoid
assignments in conditionals, but if they&rsquo;re
unavoidable, use extra paren, e.g. &quot;if (a &amp;&amp; (b
= c)) ...&quot;</p>

<p style="margin-top: 1em">&Acirc;&middot; &quot;return
foo;&quot; rather than &quot;return(foo);&quot;</p>

<p style="margin-top: 1em">&Acirc;&middot; &quot;if (!foo)
...&quot; rather than &quot;if (foo == FALSE) ...&quot;
etc.</p>

<p style="margin-top: 1em">Test suite</p>

<p style="margin-top: 1em">If your patch changes code
(rather than just changing documentation), you should also
include one or more test cases which illustrate the bug
you&rsquo;re fixing or validate the new <br>
functionality you&rsquo;re adding. In general, you should
update an existing test file rather than create a new
one.</p>

<p style="margin-top: 1em">Your test suite additions should
generally follow these guidelines (courtesy of Gurusamy
Sarathy &lt;gsar@activestate.com&gt;):</p>

<p style="margin-top: 1em">&Acirc;&middot; Know what
you&rsquo;re testing. Read the docs, and the source.</p>

<p style="margin-top: 1em">&Acirc;&middot; Tend to fail,
not succeed.</p>

<p style="margin-top: 1em">&Acirc;&middot; Interpret
results strictly.</p>

<p style="margin-top: 1em">&Acirc;&middot; Use unrelated
features (this will flush out bizarre interactions).</p>

<p style="margin-top: 1em">&Acirc;&middot; Use non-standard
idioms (otherwise you are not testing TIMTOWTDI).</p>

<p style="margin-top: 1em">&Acirc;&middot; Avoid using
hardcoded test numbers whenever possible (the EXPECTED/GOT
found in t/op/tie.t is much more maintainable, and gives
better failure reports).</p>

<p style="margin-top: 1em">&Acirc;&middot; Give meaningful
error messages when a test fails.</p>

<p style="margin-top: 1em">&Acirc;&middot; Avoid using qx//
and system() unless you are testing for them. If you do use
them, make sure that you cover _all_ perl platforms.</p>

<p style="margin-top: 1em">&Acirc;&middot; Unlink any
temporary files you create.</p>

<p style="margin-top: 1em">&Acirc;&middot; Promote
unforeseen warnings to errors with $SIG{__WARN__}.</p>

<p style="margin-top: 1em">&Acirc;&middot; Be sure to use
the libraries and modules shipped with the version being
tested, not those that were already installed.</p>

<p style="margin-top: 1em">&Acirc;&middot; Add comments to
the code explaining what you are testing for.</p>

<p style="margin-top: 1em">&Acirc;&middot; Make updating
the &rsquo;1..42&rsquo; string unnecessary. Or make sure
that you update it.</p>

<p style="margin-top: 1em">&Acirc;&middot; Test _all_
behaviors of a given operator, library, or function.</p>

<p style="margin-top: 1em">Test all optional arguments.</p>

<p style="margin-top: 1em">Test return values in various
contexts (boolean, scalar, list, lvalue).</p>

<p style="margin-top: 1em">Use both global and lexical
variables.</p>

<p style="margin-top: 1em">Don&rsquo;t forget the
exceptional, pathological cases.</p>

<p style="margin-top: 1em">Patching a core module <br>
This works just like patching anything else, with one extra
consideration.</p>

<p style="margin-top: 1em">Modules in the cpan/ directory
of the source tree are maintained outside of the Perl core.
When the author updates the module, the updates are simply
copied into the core. See <br>
that module&rsquo;s documentation or its listing on
&lt;http://search.cpan.org/&gt; for more information on
reporting bugs and submitting patches.</p>

<p style="margin-top: 1em">In most cases, patches to
modules in cpan/ should be sent upstream and should not be
applied to the Perl core individually. If a patch to a file
in cpan/ absolutely cannot wait <br>
for the fix to be made upstream, released to CPAN and copied
to blead, you must add (or update) a &quot;CUSTOMIZED&quot;
entry in the &quot;Porting/Maintainers.pl&quot; file to flag
that a local <br>
modification has been made. See
&quot;Porting/Maintainers.pl&quot; for more details.</p>

<p style="margin-top: 1em">In contrast, modules in the
dist/ directory are maintained in the core.</p>

<p style="margin-top: 1em">Updating perldelta <br>
For changes significant enough to warrant a
pod/perldelta.pod entry, the porters will greatly appreciate
it if you submit a delta entry along with your actual
change. Significant <br>
changes include, but are not limited to:</p>

<p style="margin-top: 1em">&Acirc;&middot; Adding,
deprecating, or removing core features</p>

<p style="margin-top: 1em">&Acirc;&middot; Adding,
deprecating, removing, or upgrading core or dual-life
modules</p>

<p style="margin-top: 1em">&Acirc;&middot; Adding new core
tests</p>

<p style="margin-top: 1em">&Acirc;&middot; Fixing security
issues and user-visible bugs in the core</p>

<p style="margin-top: 1em">&Acirc;&middot; Changes that
might break existing code, either on the perl or C level</p>

<p style="margin-top: 1em">&Acirc;&middot; Significant
performance improvements</p>

<p style="margin-top: 1em">&Acirc;&middot; Adding,
removing, or significantly changing documentation in the
pod/ directory</p>

<p style="margin-top: 1em">&Acirc;&middot; Important
platform-specific changes</p>

<p style="margin-top: 1em">Please make sure you add the
perldelta entry to the right section within
pod/perldelta.pod. More information on how to write good
perldelta entries is available in the &quot;Style&quot; <br>
section of Porting/how_to_write_a_perldelta.pod.</p>

<p style="margin-top: 1em">What makes for a good patch?
<br>
New features and extensions to the language can be
contentious. There is no specific set of criteria which
determine what features get added, but here are some
questions to <br>
consider when developing a patch:</p>

<p style="margin-top: 1em">Does the concept match the
general goals of Perl?</p>

<p style="margin-top: 1em">Our goals include, but are not
limited to:</p>

<p style="margin-top: 1em">1. Keep it fast, simple, and
useful.</p>

<p style="margin-top: 1em">2. Keep features/concepts as
orthogonal as possible.</p>

<p style="margin-top: 1em">3. No arbitrary limits
(platforms, data sizes, cultures).</p>

<p style="margin-top: 1em">4. Keep it open and exciting to
use/patch/advocate Perl everywhere.</p>

<p style="margin-top: 1em">5. Either assimilate new
technologies, or build bridges to them.</p>

<p style="margin-top: 1em">Where is the implementation?</p>

<p style="margin-top: 1em">All the talk in the world is
useless without an implementation. In almost every case, the
person or people who argue for a new feature will be
expected to be the ones who <br>
implement it. Porters capable of coding new features have
their own agendas, and are not available to implement your
(possibly good) idea.</p>

<p style="margin-top: 1em">Backwards compatibility</p>

<p style="margin-top: 1em">It&rsquo;s a cardinal sin to
break existing Perl programs. New warnings can be
contentious--some say that a program that emits warnings is
not broken, while others say it is. Adding <br>
keywords has the potential to break programs, changing the
meaning of existing token sequences or functions might break
programs.</p>

<p style="margin-top: 1em">The Perl 5 core includes
mechanisms to help porters make backwards incompatible
changes more compatible such as the feature and deprecate
modules. Please use them when <br>
appropriate.</p>

<p style="margin-top: 1em">Could it be a module
instead?</p>

<p style="margin-top: 1em">Perl 5 has extension mechanisms,
modules and XS, specifically to avoid the need to keep
changing the Perl interpreter. You can write modules that
export functions, you can give <br>
those functions prototypes so they can be called like
built-in functions, you can even write XS code to mess with
the runtime data structures of the Perl interpreter if you
want <br>
to implement really complicated things.</p>

<p style="margin-top: 1em">Whenever possible, new features
should be prototyped in a CPAN module before they will be
considered for the core.</p>

<p style="margin-top: 1em">Is the feature generic
enough?</p>

<p style="margin-top: 1em">Is this something that only the
submitter wants added to the language, or is it broadly
useful? Sometimes, instead of adding a feature with a tight
focus, the porters might <br>
decide to wait until someone implements the more generalized
feature.</p>

<p style="margin-top: 1em">Does it potentially introduce
new bugs?</p>

<p style="margin-top: 1em">Radical rewrites of large chunks
of the Perl interpreter have the potential to introduce new
bugs.</p>

<p style="margin-top: 1em">How big is it?</p>

<p style="margin-top: 1em">The smaller and more localized
the change, the better. Similarly, a series of small patches
is greatly preferred over a single large patch.</p>

<p style="margin-top: 1em">Does it preclude other desirable
features?</p>

<p style="margin-top: 1em">A patch is likely to be rejected
if it closes off future avenues of development. For
instance, a patch that placed a true and final
interpretation on prototypes is likely to be <br>
rejected because there are still options for the future of
prototypes that haven&rsquo;t been addressed.</p>

<p style="margin-top: 1em">Is the implementation
robust?</p>

<p style="margin-top: 1em">Good patches (tight code,
complete, correct) stand more chance of going in. Sloppy or
incorrect patches might be placed on the back burner until
the pumpking has time to fix, or <br>
might be discarded altogether without further notice.</p>

<p style="margin-top: 1em">Is the implementation generic
enough to be portable?</p>

<p style="margin-top: 1em">The worst patches make use of
system-specific features. It&rsquo;s highly unlikely that
non-portable additions to the Perl language will be
accepted.</p>

<p style="margin-top: 1em">Is the implementation
tested?</p>

<p style="margin-top: 1em">Patches which change behaviour
(fixing bugs or introducing new features) must include
regression tests to verify that everything works as
expected.</p>

<p style="margin-top: 1em">Without tests provided by the
original author, how can anyone else changing perl in the
future be sure that they haven&rsquo;t unwittingly broken
the behaviour the patch implements? <br>
And without tests, how can the patch&rsquo;s author be
confident that his/her hard work put into the patch
won&rsquo;t be accidentally thrown away by someone in the
future?</p>

<p style="margin-top: 1em">Is there enough
documentation?</p>

<p style="margin-top: 1em">Patches without documentation
are probably ill-thought out or incomplete. No features can
be added or changed without documentation, so submitting a
patch for the appropriate pod <br>
docs as well as the source code is important.</p>

<p style="margin-top: 1em">Is there another way to do
it?</p>

<p style="margin-top: 1em">Larry said &quot;Although the
Perl Slogan is There&rsquo;s More Than One Way to Do It, I
hesitate to make 10 ways to do something&quot;. This is a
tricky heuristic to navigate, though--one man&rsquo;s <br>
essential addition is another man&rsquo;s pointless
cruft.</p>

<p style="margin-top: 1em">Does it create too much
work?</p>

<p style="margin-top: 1em">Work for the pumpking, work for
Perl programmers, work for module authors, ... Perl is
supposed to be easy.</p>

<p style="margin-top: 1em">Patches speak louder than
words</p>

<p style="margin-top: 1em">Working code is always preferred
to pie-in-the-sky ideas. A patch to add a feature stands a
much higher chance of making it to the language than does a
random feature request, no <br>
matter how fervently argued the request might be. This ties
into &quot;Will it be useful?&quot;, as the fact that
someone took the time to make the patch demonstrates a
strong desire for <br>
the feature.</p>

<p style="margin-top: 1em">TESTING <br>
The core uses the same testing style as the rest of Perl, a
simple &quot;ok/not ok&quot; run through Test::Harness, but
there are a few special considerations.</p>

<p style="margin-top: 1em">There are three ways to write a
test in the core. Test::More, t/test.pl and ad hoc
&quot;print $test ? &quot;ok 420 : &quot;not ok 420&quot;.
The decision of which to use depends on what part of <br>
the test suite you&rsquo;re working on. This is a measure to
prevent a high-level failure (such as Config.pm breaking)
from causing basic functionality tests to fail.</p>

<p style="margin-top: 1em">The t/test.pl library provides
some of the features of Test::More, but avoids loading most
modules and uses as few core features as possible.</p>

<p style="margin-top: 1em">If you write your own test, use
the Test Anything Protocol
&lt;http://testanything.org&gt;.</p>

<p style="margin-top: 1em">&Acirc;&middot; t/base and
t/comp</p>

<p style="margin-top: 1em">Since we don&rsquo;t know if
require works, or even subroutines, use ad hoc tests for
these two. Step carefully to avoid using the feature being
tested.</p>

<p style="margin-top: 1em">&Acirc;&middot; t/cmd, t/run,
t/io and t/op</p>

<p style="margin-top: 1em">Now that basic require() and
subroutines are tested, you can use the t/test.pl
library.</p>

<p style="margin-top: 1em">You can also use certain
libraries like Config conditionally, but be sure to skip the
test gracefully if it&rsquo;s not there.</p>

<p style="margin-top: 1em">&Acirc;&middot; Everything
else</p>

<p style="margin-top: 1em">Now that the core of Perl is
tested, Test::More can and should be used. You can also use
the full suite of core modules in the tests.</p>

<p style="margin-top: 1em">When you say &quot;make
test&quot;, Perl uses the t/TEST program to run the test
suite (except under Win32 where it uses t/harness instead).
All tests are run from the t/ directory, not <br>
the directory which contains the test. This causes some
problems with the tests in lib/, so here&rsquo;s some
opportunity for some patching.</p>

<p style="margin-top: 1em">You must be triply conscious of
cross-platform concerns. This usually boils down to using
File::Spec and avoiding things like &quot;fork()&quot; and
&quot;system()&quot; unless absolutely necessary.</p>

<p style="margin-top: 1em">Special &quot;make test&quot;
targets <br>
There are various special make targets that can be used to
test Perl slightly differently than the standard
&quot;test&quot; target. Not all them are expected to give a
100% success rate. <br>
Many of them have several aliases, and many of them are not
available on certain operating systems.</p>

<p style="margin-top: 1em">&Acirc;&middot; test_porting</p>

<p style="margin-top: 1em">This runs some basic sanity
tests on the source tree and helps catch basic errors before
you submit a patch.</p>

<p style="margin-top: 1em">&Acirc;&middot; coretest</p>

<p style="margin-top: 1em">Run perl on all core tests (t/*
and lib/[a-z]* pragma tests).</p>

<p style="margin-top: 1em">(Not available on Win32)</p>

<p style="margin-top: 1em">&Acirc;&middot; test.deparse</p>

<p style="margin-top: 1em">Run all the tests through
B::Deparse. Not all tests will succeed.</p>

<p style="margin-top: 1em">(Not available on Win32)</p>

<p style="margin-top: 1em">&Acirc;&middot;
test.taintwarn</p>

<p style="margin-top: 1em">Run all tests with the -t
command-line switch. Not all tests are expected to succeed
(until they&rsquo;re specifically fixed, of course).</p>

<p style="margin-top: 1em">(Not available on Win32)</p>

<p style="margin-top: 1em">&Acirc;&middot; minitest</p>

<p style="margin-top: 1em">Run miniperl on t/base, t/comp,
t/cmd, t/run, t/io, t/op, t/uni and t/mro tests.</p>

<p style="margin-top: 1em">&Acirc;&middot; test.valgrind
check.valgrind utest.valgrind ucheck.valgrind</p>

<p style="margin-top: 1em">(Only in Linux) Run all the
tests using the memory leak + naughty memory access tool
&quot;valgrind&quot;. The log files will be named
testname.valgrind.</p>

<p style="margin-top: 1em">&Acirc;&middot; test.torture
torturetest</p>

<p style="margin-top: 1em">Run all the usual tests and some
extra tests. As of Perl 5.8.0, the only extra tests are
Abigail&rsquo;s JAPHs, t/japh/abigail.t.</p>

<p style="margin-top: 1em">You can also run the torture
test with t/harness by giving &quot;-torture&quot; argument
to t/harness.</p>

<p style="margin-top: 1em">&Acirc;&middot; utest ucheck
test.utf8 check.utf8</p>

<p style="margin-top: 1em">Run all the tests with -Mutf8.
Not all tests will succeed.</p>

<p style="margin-top: 1em">(Not available on Win32)</p>

<p style="margin-top: 1em">&Acirc;&middot; minitest.utf16
test.utf16</p>

<p style="margin-top: 1em">Runs the tests with UTF-16
encoded scripts, encoded with different versions of this
encoding.</p>

<p style="margin-top: 1em">&quot;make utest.utf16&quot;
runs the test suite with a combination of &quot;-utf8&quot;
and &quot;-utf16&quot; arguments to t/TEST.</p>

<p style="margin-top: 1em">(Not available on Win32)</p>

<p style="margin-top: 1em">&Acirc;&middot; test_harness</p>

<p style="margin-top: 1em">Run the test suite with the
t/harness controlling program, instead of t/TEST. t/harness
is more sophisticated, and uses the Test::Harness module,
thus using this test target <br>
supposes that perl mostly works. The main advantage for our
purposes is that it prints a detailed summary of failed
tests at the end. Also, unlike t/TEST, it doesn&rsquo;t
redirect <br>
stderr to stdout.</p>

<p style="margin-top: 1em">Note that under Win32 t/harness
is always used instead of t/TEST, so there is no special
&quot;test_harness&quot; target.</p>

<p style="margin-top: 1em">Under Win32&rsquo;s
&quot;test&quot; target you may use the TEST_SWITCHES and
TEST_FILES environment variables to control the behaviour of
t/harness. This means you can say</p>

<p style="margin-top: 1em">nmake test
TEST_FILES=&quot;op/*.t&quot; <br>
nmake test TEST_SWITCHES=&quot;-torture&quot;
TEST_FILES=&quot;op/*.t&quot;</p>

<p style="margin-top: 1em">&Acirc;&middot; test-notty
test_notty</p>

<p style="margin-top: 1em">Sets PERL_SKIP_TTY_TEST to true
before running normal test.</p>

<p style="margin-top: 1em">Parallel tests <br>
The core distribution can now run its regression tests in
parallel on Unix-like platforms. Instead of running
&quot;make test&quot;, set &quot;TEST_JOBS&quot; in your
environment to the number of <br>
tests to run in parallel, and run &quot;make
test_harness&quot;. On a Bourne-like shell, this can be done
as</p>

<p style="margin-top: 1em">TEST_JOBS=3 make test_harness #
Run 3 tests in parallel</p>

<p style="margin-top: 1em">An environment variable is used,
rather than parallel make itself, because TAP::Harness needs
to be able to schedule individual non-conflicting test
scripts itself, and there is <br>
no standard interface to &quot;make&quot; utilities to
interact with their job schedulers.</p>

<p style="margin-top: 1em">Note that currently some test
scripts may fail when run in parallel (most notably
ext/IO/t/io_dir.t). If necessary, run just the failing
scripts again sequentially and see if the <br>
failures go away.</p>

<p style="margin-top: 1em">Running tests by hand <br>
You can run part of the test suite by hand by using one of
the following commands from the t/ directory:</p>

<p style="margin-top: 1em">./perl -I../lib TEST
list-of-.t-files</p>

<p style="margin-top: 1em">or</p>

<p style="margin-top: 1em">./perl -I../lib harness
list-of-.t-files</p>

<p style="margin-top: 1em">(If you don&rsquo;t specify test
scripts, the whole test suite will be run.)</p>

<p style="margin-top: 1em">Using t/harness for testing <br>
If you use &quot;harness&quot; for testing, you have several
command line options available to you. The arguments are as
follows, and are in the order that they must appear if used
<br>
together.</p>

<p style="margin-top: 1em">harness -v -torture -re=pattern
LIST OF FILES TO TEST <br>
harness -v -torture -re LIST OF PATTERNS TO MATCH</p>

<p style="margin-top: 1em">If &quot;LIST OF FILES TO
TEST&quot; is omitted, the file list is obtained from the
manifest. The file list may include shell wildcards which
will be expanded out.</p>

<p style="margin-top: 1em">&Acirc;&middot; -v</p>

<p style="margin-top: 1em">Run the tests under verbose mode
so you can see what tests were run, and debug output.</p>

<p style="margin-top: 1em">&Acirc;&middot; -torture</p>

<p style="margin-top: 1em">Run the torture tests as well as
the normal set.</p>

<p style="margin-top: 1em">&Acirc;&middot; -re=PATTERN</p>

<p style="margin-top: 1em">Filter the file list so that all
the test files run match PATTERN. Note that this form is
distinct from the -re LIST OF PATTERNS form below in that it
allows the file list to <br>
be provided as well.</p>

<p style="margin-top: 1em">&Acirc;&middot; -re LIST OF
PATTERNS</p>

<p style="margin-top: 1em">Filter the file list so that all
the test files run match /(LIST|OF|PATTERNS)/. Note that
with this form the patterns are joined by &rsquo;|&rsquo;
and you cannot supply a list of files, <br>
instead the test files are obtained from the MANIFEST.</p>

<p style="margin-top: 1em">You can run an individual test
by a command similar to</p>

<p style="margin-top: 1em">./perl -I../lib
path/to/foo.t</p>

<p style="margin-top: 1em">except that the harnesses set up
some environment variables that may affect the execution of
the test:</p>

<p style="margin-top: 1em">&Acirc;&middot; PERL_CORE=1</p>

<p style="margin-top: 1em">indicates that we&rsquo;re
running this test as part of the perl core test suite. This
is useful for modules that have a dual life on CPAN.</p>

<p style="margin-top: 1em">&Acirc;&middot;
PERL_DESTRUCT_LEVEL=2</p>

<p style="margin-top: 1em">is set to 2 if it isn&rsquo;t
set already (see &quot;PERL_DESTRUCT_LEVEL&quot; in
perlhacktips).</p>

<p style="margin-top: 1em">&Acirc;&middot; PERL</p>

<p style="margin-top: 1em">(used only by t/TEST) if set,
overrides the path to the perl executable that should be
used to run the tests (the default being ./perl).</p>

<p style="margin-top: 1em">&Acirc;&middot;
PERL_SKIP_TTY_TEST</p>

<p style="margin-top: 1em">if set, tells to skip the tests
that need a terminal. It&rsquo;s actually set automatically
by the Makefile, but can also be forced artificially by
running &rsquo;make test_notty&rsquo;.</p>

<p style="margin-top: 1em">Other environment variables that
may influence tests</p>

<p style="margin-top: 1em">&Acirc;&middot;
PERL_TEST_Net_Ping</p>

<p style="margin-top: 1em">Setting this variable runs all
the Net::Ping modules tests, otherwise some tests that
interact with the outside world are skipped. See
perl58delta.</p>

<p style="margin-top: 1em">&Acirc;&middot;
PERL_TEST_NOVREXX</p>

<p style="margin-top: 1em">Setting this variable skips the
vrexx.t tests for OS2::REXX.</p>

<p style="margin-top: 1em">&Acirc;&middot;
PERL_TEST_NUMCONVERTS</p>

<p style="margin-top: 1em">This sets a variable in
op/numconvert.t.</p>

<p style="margin-top: 1em">See also the documentation for
the Test and Test::Harness modules, for more environment
variables that affect testing.</p>

<p style="margin-top: 1em">MORE READING FOR GUTS HACKERS
<br>
To hack on the Perl guts, you&rsquo;ll need to read the
following things:</p>

<p style="margin-top: 1em">&Acirc;&middot; perlsource</p>

<p style="margin-top: 1em">An overview of the Perl source
tree. This will help you find the files you&rsquo;re looking
for.</p>

<p style="margin-top: 1em">&Acirc;&middot; perlinterp</p>

<p style="margin-top: 1em">An overview of the Perl
interpreter source code and some details on how Perl does
what it does.</p>

<p style="margin-top: 1em">&Acirc;&middot; perlhacktut</p>

<p style="margin-top: 1em">This document walks through the
creation of a small patch to Perl&rsquo;s C code. If
you&rsquo;re just getting started with Perl core hacking,
this will help you understand how it works.</p>

<p style="margin-top: 1em">&Acirc;&middot; perlhacktips</p>

<p style="margin-top: 1em">More details on hacking the Perl
core. This document focuses on lower level details such as
how to write tests, compilation issues, portability,
debugging, etc.</p>

<p style="margin-top: 1em">If you plan on doing serious C
hacking, make sure to read this.</p>

<p style="margin-top: 1em">&Acirc;&middot; perlguts</p>

<p style="margin-top: 1em">This is of paramount importance,
since it&rsquo;s the documentation of what goes where in the
Perl source. Read it over a couple of times and it might
start to make sense - don&rsquo;t <br>
worry if it doesn&rsquo;t yet, because the best way to study
it is to read it in conjunction with poking at Perl source,
and we&rsquo;ll do that later on.</p>

<p style="margin-top: 1em">Gisle Aas&rsquo;s
&quot;illustrated perlguts&quot;, also known as illguts, has
very helpful pictures:</p>


<p style="margin-top: 1em">&lt;http://search.cpan.org/dist/illguts/&gt;</p>

<p style="margin-top: 1em">&Acirc;&middot; perlxstut and
perlxs</p>

<p style="margin-top: 1em">A working knowledge of XSUB
programming is incredibly useful for core hacking; XSUBs use
techniques drawn from the PP code, the portion of the guts
that actually executes a <br>
Perl program. It&rsquo;s a lot gentler to learn those
techniques from simple examples and explanation than from
the core itself.</p>

<p style="margin-top: 1em">&Acirc;&middot; perlapi</p>

<p style="margin-top: 1em">The documentation for the Perl
API explains what some of the internal functions do, as well
as the many macros used in the source.</p>

<p style="margin-top: 1em">&Acirc;&middot;
Porting/pumpkin.pod</p>

<p style="margin-top: 1em">This is a collection of words of
wisdom for a Perl porter; some of it is only useful to the
pumpkin holder, but most of it applies to anyone wanting to
go about Perl <br>
development.</p>

<p style="margin-top: 1em">&Acirc;&middot; The
perl5-porters FAQ</p>

<p style="margin-top: 1em">This should be available from
http://dev.perl.org/perl5/docs/p5p-faq.html . It contains
hints on reading perl5-porters, information on how
perl5-porters works and how Perl <br>
development in general works.</p>

<p style="margin-top: 1em">CPAN TESTERS AND PERL SMOKERS
<br>
The CPAN testers ( http://testers.cpan.org/ ) are a group of
volunteers who test CPAN modules on a variety of
platforms.</p>

<p style="margin-top: 1em">Perl Smokers (
http://www.nntp.perl.org/group/perl.daily-build/ and
http://www.nntp.perl.org/group/perl.daily-build.reports/ )
automatically test Perl source releases on <br>
platforms with various configurations.</p>

<p style="margin-top: 1em">Both efforts welcome volunteers.
In order to get involved in smoke testing of the perl itself
visit http://search.cpan.org/dist/Test-Smoke/
&lt;http://search.cpan.org/dist/Test- <br>
Smoke/&gt;. In order to start smoke testing CPAN modules
visit http://search.cpan.org/dist/CPANPLUS-YACSmoke/
&lt;http://search.cpan.org/dist/CPANPLUS-YACSmoke/&gt; or
<br>
&lt;http://search.cpan.org/dist/minismokebox/&gt; or
http://search.cpan.org/dist/CPAN-Reporter/
&lt;http://search.cpan.org/dist/CPAN-Reporter/&gt;.</p>

<p style="margin-top: 1em">WHAT NEXT? <br>
If you&rsquo;ve read all the documentation in the document
and the ones listed above, you&rsquo;re more than ready to
hack on Perl.</p>

<p style="margin-top: 1em">Here&rsquo;s some more
recommendations</p>

<p style="margin-top: 1em">&Acirc;&middot; Subscribe to
perl5-porters, follow the patches and try and understand
them; don&rsquo;t be afraid to ask if there&rsquo;s a
portion you&rsquo;re not clear on - who knows, you may
unearth a bug <br>
in the patch...</p>

<p style="margin-top: 1em">&Acirc;&middot; Do read the
README associated with your operating system, e.g.
README.aix on the IBM AIX OS. Don&rsquo;t hesitate to supply
patches to that README if you find anything missing or <br>
changed over a new OS release.</p>

<p style="margin-top: 1em">&Acirc;&middot; Find an area of
Perl that seems interesting to you, and see if you can work
out how it works. Scan through the source, and step over it
in the debugger. Play, poke, <br>
investigate, fiddle! You&rsquo;ll probably get to understand
not just your chosen area but a much wider range of
perl&rsquo;s activity as well, and probably sooner than
you&rsquo;d think.</p>

<p style="margin-top: 1em">&quot;The Road goes ever on and
on, down from the door where it began.&quot; <br>
If you can do these things, you&rsquo;ve started on the long
road to Perl porting. Thanks for wanting to help make Perl
better - and happy hacking!</p>

<p style="margin-top: 1em">Metaphoric Quotations <br>
If you recognized the quote about the Road above,
you&rsquo;re in luck.</p>

<p style="margin-top: 1em">Most software projects begin
each file with a literal description of each file&rsquo;s
purpose. Perl instead begins each with a literary allusion
to that file&rsquo;s purpose.</p>

<p style="margin-top: 1em">Like chapters in many books, all
top-level Perl source files (along with a few others here
and there) begin with an epigrammatic inscription that
alludes, indirectly and <br>
metaphorically, to the material you&rsquo;re about to
read.</p>

<p style="margin-top: 1em">Quotations are taken from
writings of J.R.R. Tolkien pertaining to his Legendarium,
almost always from The Lord of the Rings. Chapters and page
numbers are given using the <br>
following editions:</p>

<p style="margin-top: 1em">&Acirc;&middot; The Hobbit, by
J.R.R. Tolkien. The hardcover, 70th-anniversary edition of
2007 was used, published in the UK by Harper Collins
Publishers and in the US by the Houghton <br>
Mifflin Company.</p>

<p style="margin-top: 1em">&Acirc;&middot; The Lord of the
Rings, by J.R.R. Tolkien. The hardcover, 50th-anniversary
edition of 2004 was used, published in the UK by Harper
Collins Publishers and in the US by the <br>
Houghton Mifflin Company.</p>

<p style="margin-top: 1em">&Acirc;&middot; The Lays of
Beleriand, by J.R.R. Tolkien and published posthumously by
his son and literary executor, C.J.R. Tolkien, being the 3rd
of the 12 volumes in Christopher&rsquo;s mammoth <br>
History of Middle Earth. Page numbers derive from the
hardcover edition, first published in 1983 by George Allen
&amp; Unwin; no page numbers changed for the special
3-volume <br>
omnibus edition of 2002 or the various trade-paper editions,
all again now by Harper Collins or Houghton Mifflin.</p>

<p style="margin-top: 1em">Other JRRT books fair game for
quotes would thus include The Adventures of Tom Bombadil,
The Silmarillion, Unfinished Tales, and The Tale of the
Children of Hurin, all but the <br>
first posthumously assembled by CJRT. But The Lord of the
Rings itself is perfectly fine and probably best to quote
from, provided you can find a suitable quote there.</p>

<p style="margin-top: 1em">So if you were to supply a new,
complete, top-level source file to add to Perl, you should
conform to this peculiar practice by yourself selecting an
appropriate quotation from <br>
Tolkien, retaining the original spelling and punctuation and
using the same format the rest of the quotes are in.
Indirect and oblique is just fine; remember, it&rsquo;s a
metaphor, so <br>
being meta is, after all, what it&rsquo;s for.</p>

<p style="margin-top: 1em">AUTHOR <br>
This document was originally written by Nathan Torkington,
and is maintained by the perl5-porters mailing list.</p>

<p style="margin-top: 1em">perl v5.16.3 2013-03-04
PERLHACK(1)</p>
<hr>
</body>
</html>
