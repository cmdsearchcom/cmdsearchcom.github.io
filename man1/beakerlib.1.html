<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>BEAKERLIB(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">BEAKERLIB(1)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">BEAKERLIB(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
BeakerLib - a shell-level integration testing library
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
BeakerLib is a shell-level integration testing library, providing convenience
  functions which simplify writing, running and analysis of integration and
  blackbox tests.
<div class="Pp"></div>
The essential features include:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>Journal</b> - uniform logging mechanism (logs &amp;
      results saved in flexible XML format, easy to compare results &amp;
      generate reports)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>Phases</b> - logical grouping of test actions, clear
      separation of setup / test / cleanup (preventing false fails)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>Asserts</b> - common checks affecting the overall
      results of the individual phases (checking for exit codes, file existence
      &amp; content...)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>Helpers</b> - convenience functions for common
      operations such as managing services, backup &amp; restore</dd>
</dl>
<div class="Pp"></div>
The main script sets the &quot;BEAKERLIB&quot; variable and sources other
  scripts where the actual functions are defined. You should source it at the
  beginning of your test with:
<div class="Pp"></div>
<pre>
    . /usr/share/beakerlib/beakerlib.sh
</pre>
<div class="Pp"></div>
See the EXAMPLES section for quick start inspiration.
<div class="Pp"></div>
See the BKRDOC section for more information about Automated documentation
  generator for BeakerLib tests.
<h1 class="Sh" title="Sh" id="FUNCTIONS"><a class="selflink" href="#FUNCTIONS">FUNCTIONS</a></h1>
<h2 class="Ss" title="Ss" id="Journalling"><a class="selflink" href="#Journalling">Journalling</a></h2>
<i>rlJournalStart</i>
<div class="Pp"></div>
Initialize the journal file.
<div class="Pp"></div>
<pre>
    rlJournalStart
</pre>
<div class="Pp"></div>
Run on the very beginning of your script to initialize journalling
  functionality.
<div class="Pp"></div>
<i>rlJournalEnd</i>
<div class="Pp"></div>
Summarize the test run and upload the journal file.
<div class="Pp"></div>
<pre>
    rlJournalEnd
</pre>
<div class="Pp"></div>
Run on the very end of your script to print summary of the whole test run,
  generate OUTPUTFILE and include journal in Beaker logs.
<div class="Pp"></div>
<i>rlJournalPrint</i>
<div class="Pp"></div>
Print the content of the journal in pretty xml format.
<div class="Pp"></div>
<pre>
    rlJournalPrint [type]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">type</dt>
  <dd class="It-tag">Can be either 'raw' or 'pretty', with the latter as a
      default. Raw: xml is in raw form, no indentation etc Pretty: xml is pretty
      printed, indented, with one record per line</dd>
</dl>
<div class="Pp"></div>
Example:
<div class="Pp"></div>
<pre>
    &lt;?xml version=&quot;1.0&quot;?&gt;
    &lt;BEAKER_TEST&gt;
      &lt;test_id&gt;debugging&lt;/test_id&gt;
      &lt;package&gt;setup&lt;/package&gt;
      &lt;pkgdetails&gt;setup-2.8.9-1.fc12.noarch&lt;/pkgdetails&gt;
      &lt;starttime&gt;2010-02-08 15:17:47&lt;/starttime&gt;
      &lt;endtime&gt;2010-02-08 15:17:47&lt;/endtime&gt;
      &lt;testname&gt;/examples/beakerlib/Sanity/simple&lt;/testname&gt;
      &lt;release&gt;Fedora release 12 (Constantine)&lt;/release&gt;
      &lt;hostname&gt;localhost&lt;/hostname&gt;
      &lt;arch&gt;i686&lt;/arch&gt;
      &lt;purpose&gt;PURPOSE of /examples/beakerlib/Sanity/simple
        Description: Minimal BeakerLib sanity test
        Author: Petr Splichal &amp;lt;psplicha@redhat.com&amp;gt;
        This is a minimal sanity test for BeakerLib. It contains a single
        phase with a couple of asserts. We Just check that the &quot;setup&quot;
        package is installed and that there is a sane /etc/passwd file.
      &lt;/purpose&gt;
      &lt;log&gt;
        &lt;phase endtime=&quot;2010-02-08 15:17:47&quot; name=&quot;Test&quot; result=&quot;PASS&quot;
                score=&quot;0&quot; starttime=&quot;2010-02-08 15:17:47&quot; type=&quot;FAIL&quot;&gt;
          &lt;test message=&quot;Checking for the presence of setup rpm&quot;&gt;PASS&lt;/test&gt;
          &lt;test message=&quot;File /etc/passwd should exist&quot;&gt;PASS&lt;/test&gt;
          &lt;test message=&quot;File '/etc/passwd' should contain 'root'&quot;&gt;PASS&lt;/test&gt;
        &lt;/phase&gt;
      &lt;/log&gt;
    &lt;/BEAKER_TEST&gt;
</pre>
<div class="Pp"></div>
<i>rlJournalPrintText</i>
<div class="Pp"></div>
Print the content of the journal in pretty text format.
<div class="Pp"></div>
<pre>
    rlJournalPrintText [--full-journal]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">--full-journal</dt>
  <dd class="It-tag">With this option, additional items like some HW information
      will be printed in the journal.</dd>
</dl>
<div class="Pp"></div>
Example:
<div class="Pp"></div>
<pre>
    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    :: [   LOG    ] :: TEST PROTOCOL
    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    :: [   LOG    ] :: Test run ID   : debugging
    :: [   LOG    ] :: Package       : debugging
    :: [   LOG    ] :: Test started  : 2010-02-08 14:45:57
    :: [   LOG    ] :: Test finished : 2010-02-08 14:45:58
    :: [   LOG    ] :: Test name     :
    :: [   LOG    ] :: Distro:       : Fedora release 12 (Constantine)
    :: [   LOG    ] :: Hostname      : localhost
    :: [   LOG    ] :: Architecture  : i686
    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    :: [   LOG    ] :: Test description
    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    PURPOSE of /examples/beakerlib/Sanity/simple
    Description: Minimal BeakerLib sanity test
    Author: Petr Splichal &lt;psplicha@redhat.com&gt;
    This is a minimal sanity test for BeakerLib. It contains a single
    phase with a couple of asserts. We Just check that the &quot;setup&quot;
    package is installed and that there is a sane /etc/passwd file.
    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    :: [   LOG    ] :: Test
    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    :: [   PASS   ] :: Checking for the presence of setup rpm
    :: [   PASS   ] :: File /etc/passwd should exist
    :: [   PASS   ] :: File '/etc/passwd' should contain 'root'
    :: [   LOG    ] :: Duration: 1s
    :: [   LOG    ] :: Assertions: 3 good, 0 bad
    :: [   PASS   ] :: RESULT: Test
</pre>
<div class="Pp"></div>
<i>rlGetTestState</i>
<div class="Pp"></div>
Returns number of failed asserts in so far, 255 if there are more then 255
  failures.
<div class="Pp"></div>
<pre>
    rlGetTestState
</pre>
<div class="Pp"></div>
<i>rlGetPhaseState</i>
<div class="Pp"></div>
Returns number of failed asserts in current phase so far, 255 if there are more
  then 255 failures.
<div class="Pp"></div>
<pre>
    rlGetPhaseState
</pre>
<h2 class="Ss" title="Ss" id="Logging"><a class="selflink" href="#Logging">Logging</a></h2>
<i>rlLog</i>
<div class="Pp"></div>
<i>rlLogDebug</i>
<div class="Pp"></div>
<i>rlLogInfo</i>
<div class="Pp"></div>
<i>rlLogWarning</i>
<div class="Pp"></div>
<i>rlLogError</i>
<div class="Pp"></div>
<i>rlLogFatal</i>
<div class="Pp"></div>
Create a time/priority-labelled message in the log. There is a bunch of aliases
  which can create messages formated as DEBUG/INFO/WARNING/ERROR or FATAL (but
  you would probably want to use rlDie instead of the last one).
<div class="Pp"></div>
<pre>
    rlLog message [logfile] [priority] [label]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">message</dt>
  <dd class="It-tag">Message you want to show (use quotes when invoking).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">logfile</dt>
  <dd class="It-tag">Log file. If not supplied, OUTPUTFILE is assumed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">priority</dt>
  <dd class="It-tag">Priority of the log.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">label</dt>
  <dd class="It-tag">Print this text instead of time in log label.</dd>
</dl>
<div class="Pp"></div>
<i>rlDie</i>
<div class="Pp"></div>
Create a time-labelled message in the log, report test result, upload logs,
  close unfinished phase and terminate the test.
<div class="Pp"></div>
<pre>
    rlDie message [file...]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">message</dt>
  <dd class="It-tag">Message you want to show (use quotes when invoking) - this
      option is mandatory.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">file</dt>
  <dd class="It-tag">Files (logs) you want to upload as well.
      &quot;rlBundleLogs&quot; will be used for it. Files which are not readable
      will be excluded before calling &quot;rlBundleLogs&quot;, so it is safe to
      call even with possibly not existent logs and it will succeed.</dd>
</dl>
<div class="Pp"></div>
<i>rlBundleLogs</i>
<div class="Pp"></div>
Create a tarball of files (e.g. logs) and attach them to the test result.
<div class="Pp"></div>
<pre>
    rlBundleLogs package file [file...]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">package</dt>
  <dd class="It-tag">Name of the package. Will be used as a part of the tar-ball
      name.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">file</dt>
  <dd class="It-tag">File(s) to be packed and submitted.</dd>
</dl>
<div class="Pp"></div>
Returns result of submiting the tarball.
<div class="Pp"></div>
<i>rlFileSubmit</i>
<div class="Pp"></div>
Resolves absolute path to the file, replaces / for - and uploads this renamed
  file using rhts-submit-log. It also allows you to specify your custom name for
  the uploaded file.
<div class="Pp"></div>
<pre>
    rlFileSubmit [-s sep] path_to_file [required_name]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">-s sep</dt>
  <dd class="It-tag">Sets separator (i.e. the replacement of the /) to sep.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">path_to_file</dt>
  <dd class="It-tag">Either absolute or relative path to file. Relative path is
      converted to absolute.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">required_name</dt>
  <dd class="It-tag">Default behavior renames file to full_path_to_file with /
      replaced for -, if this does not suit your needs, you can specify the name
      using this option.
    <div style="height: 1.00em;">&#x00A0;</div>
    Examples:
    <div style="height: 1.00em;">&#x00A0;</div>
    rlFileSubmit logfile.txt -&gt; logfile.txt cd /etc; rlFileSubmit ./passwd
      -&gt; etc-passwd rlFileSubmit /etc/passwd -&gt; etc-passwd rlFileSubmit
      /etc/passwd my-top-secret_file -&gt; my-top-secret-file rlFileSubmit -s
      '_' /etc/passwd -&gt; etc_passwd</dd>
</dl>
<h2 class="Ss" title="Ss" id="Info"><a class="selflink" href="#Info">Info</a></h2>
<i>rlShowPackageVersion</i>
<div class="Pp"></div>
Shows a message about version of packages.
<div class="Pp"></div>
<pre>
    rlShowPackageVersion package [package...]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">package</dt>
  <dd class="It-tag">Name of a package(s) you want to log.</dd>
</dl>
<div class="Pp"></div>
<i>rlGetArch</i>
<div class="Pp"></div>
This function is deprecated. Use rlGetPrimaryArch or rlGetSecondaryArch instead,
  or use uname. This function will be only kept for compatibility.
<div class="Pp"></div>
Return base arch for the current system (good when you need base arch on a
  multilib system).
<div class="Pp"></div>
<pre>
    rlGetArch
</pre>
<div class="Pp"></div>
On an i686 system you will get i386, on a ppc64 you will get ppc.
<div class="Pp"></div>
<i>rlGetPrimaryArch</i>
<div class="Pp"></div>
Return primary arch for the current system (good when you need base arch on a
  multilib system).
<div class="Pp"></div>
<pre>
    rlGetPrimaryArch
</pre>
<div class="Pp"></div>
<i>rlGetSecondaryArch</i>
<div class="Pp"></div>
Return base arch for the current system (good when you need base arch on a
  multilib system).
<div class="Pp"></div>
<pre>
    rlGetSecondaryArch
</pre>
<div class="Pp"></div>
<i>rlGetDistroRelease</i>
<div class="Pp"></div>
<i>rlGetDistroVariant</i>
<div class="Pp"></div>
Return release or variant of the distribution on the system.
<div class="Pp"></div>
<pre>
    rlGetDistroRelease
    rlGetDistroVariant
</pre>
<div class="Pp"></div>
For example on the RHEL-4-AS you will get release 4 and variant AS, on the
  RHEL-5-Client you will get release 5 and variant Client.
<div class="Pp"></div>
<i>rlShowRunningKernel</i>
<div class="Pp"></div>
Log a message with version of the currently running kernel.
<div class="Pp"></div>
<pre>
    rlShowRunningKernel
</pre>
<h2 class="Ss" title="Ss" id="Phases"><a class="selflink" href="#Phases">Phases</a></h2>
<i>rlPhaseStart</i>
<div class="Pp"></div>
Starts a phase of a specific type. The final phase result is based on all
  asserts included in the phase. Do not forget to end phase with
  &quot;rlPhaseEnd&quot; when you are done.
<div class="Pp"></div>
<pre>
    rlPhaseStart type [name]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">type</dt>
  <dd class="It-tag">Type of the phase, one of the following:</dd>
</dl>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">FAIL</dt>
  <dd class="It-tag">When assert fails here, phase will report a FAIL.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">WARN</dt>
  <dd class="It-tag">When assert fails here, phase will report a WARN.</dd>
</dl>
</div>
<div style="margin-left: 4.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag">name</dt>
  <dd class="It-tag">Optional name of the phase (if not provided, one will be
      generated).</dd>
</dl>
<div class="Pp"></div>
If all asserts included in the phase pass, phase reports PASS.
<div class="Pp"></div>
<i>rlPhaseEnd</i>
<div class="Pp"></div>
End current phase, summarize asserts included and report phase result.
<div class="Pp"></div>
<pre>
    rlPhaseEnd
</pre>
<div class="Pp"></div>
Final phase result is based on included asserts and phase type.
<div class="Pp"></div>
<i>rlPhaseStartSetup</i>
<div class="Pp"></div>
<i>rlPhaseStartTest</i>
<div class="Pp"></div>
<i>rlPhaseStartCleanup</i>
<div class="Pp"></div>
Start a phase of the specified type: Setup -&gt; WARN, Test -&gt; FAIL, Cleanup
  -&gt; WARN.
<div class="Pp"></div>
<pre>
    rlPhaseStartSetup [name]
    rlPhaseStartTest [name]
    rlPhaseStartCleanup [name]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">name</dt>
  <dd class="It-tag">Optional name of the phase. If not specified, default
      Setup/Test/Cleanup are used.</dd>
</dl>
<div class="Pp"></div>
If you do not want these shortcuts, use plain &quot;rlPhaseStart&quot; function.
<h2 class="Ss" title="Ss" id="Metric"><a class="selflink" href="#Metric">Metric</a></h2>
<i>rlLogMetricLow</i>
<div class="Pp"></div>
Log a metric, which should be as low as possible to the journal. (Example:
  memory consumption, run time)
<div class="Pp"></div>
<pre>
    rlLogMetricLow name value [tolerance]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">name</dt>
  <dd class="It-tag">Name of the metric. It has to be unique in a phase.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value</dt>
  <dd class="It-tag">Value of the metric.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">tolerance</dt>
  <dd class="It-tag">It is used when comparing via rcw. It means how larger can
      the second value be to not trigger a FAIL. Default is 0.2</dd>
</dl>
<div class="Pp"></div>
When comparing FIRST, SECOND, then:
<div class="Pp"></div>
<pre>
    FIRST &gt;= SECOND means PASS
    FIRST+FIRST*tolerance &gt;= SECOND means WARN
    FIRST+FIRST*tolerance &lt; SECOND means FAIL
</pre>
<div class="Pp"></div>
<b>Example:</b> Simple benchmark is compared via this metric type in rcw. It has
  a tolerance of 0.2. First run had 1 second. So:
<div class="Pp"></div>
<pre>
    For PASS, second run has to be better or equal to first.
            So any value of second or less is a PASS.
    For WARN, second run can be a little worse than first.
            Tolerance is 0.2, so anything lower than 1.2 means WARN.
    For FAIL, anything worse than 1.2 means FAIL.
</pre>
<div class="Pp"></div>
<i>rlLogMetricHigh</i>
<div class="Pp"></div>
Log a metric, which should be as high as possible to the journal. (Example:
  number of executions per second)
<div class="Pp"></div>
<pre>
    rlLogMetricHigh name value [tolerance]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">name</dt>
  <dd class="It-tag">Name of the metric. It has to be unique in a phase.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value</dt>
  <dd class="It-tag">Value of the metric.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">tolerance</dt>
  <dd class="It-tag">It is used when comparing via rcw. It means how lower can
      the second value be to not trigger a FAIL. Default is 0.2</dd>
</dl>
<div class="Pp"></div>
When comparing FIRST, SECOND, then:
<div class="Pp"></div>
<pre>
    FIRST &lt;= SECOND means PASS
    FIRST+FIRST*tolerance &lt;= SECOND means WARN
    FIRST+FIRST*tolerance &gt; SECOND means FAIL
</pre>
<h2 class="Ss" title="Ss" id="Manual_Asserts"><a class="selflink" href="#Manual_Asserts">Manual
  Asserts</a></h2>
<i>rlPass</i>
<div class="Pp"></div>
Manual assertion, asserts and logs PASS.
<div class="Pp"></div>
<pre>
    rlPass comment
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short test summary.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS.
<div class="Pp"></div>
<i>rlFail</i>
<div class="Pp"></div>
Manual assertion, asserts and logs FAIL.
<div class="Pp"></div>
<pre>
    rlFail comment
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short test summary.</dd>
</dl>
<div class="Pp"></div>
Returns 1 and asserts FAIL.
<h2 class="Ss" title="Ss" id="Arithmetic_Asserts"><a class="selflink" href="#Arithmetic_Asserts">Arithmetic
  Asserts</a></h2>
<i>rlAssert0</i>
<div class="Pp"></div>
Assertion checking for the equality of parameter to zero.
<div class="Pp"></div>
<pre>
    rlAssert0 comment value
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short test summary, e.g. &quot;Test if compilation ended
      successfully&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value</dt>
  <dd class="It-tag">Integer value (usually return code of a command).</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;value == 0&quot;.
<div class="Pp"></div>
<i>rlAssertEquals</i>
<div class="Pp"></div>
Assertion checking for the equality of two parameters.
<div class="Pp"></div>
<pre>
    rlAssertEquals comment value1 value2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short test summary, e.g. &quot;Test if all 3 packages have
      been downloaded&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value1</dt>
  <dd class="It-tag">First parameter to compare, can be a number or a
    string</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value2</dt>
  <dd class="It-tag">Second parameter to compare, can be a number or a
    string</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;value1 == value2&quot;.
<div class="Pp"></div>
<i>rlAssertNotEquals</i>
<div class="Pp"></div>
Assertion checking for the non-equality of two parameters.
<div class="Pp"></div>
<pre>
    rlAssertNotEquals comment value1 value2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short test summary, e.g. &quot;Test if return code is not
      139&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value1</dt>
  <dd class="It-tag">First parameter to compare, can be a number or a
    string</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value2</dt>
  <dd class="It-tag">Second parameter to compare, can be a number or a
    string</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;value1 != value2&quot;.
<div class="Pp"></div>
<i>rlAssertGreater</i>
<div class="Pp"></div>
Assertion checking whether first parameter is greater than the second one.
<div class="Pp"></div>
<pre>
    rlAssertGreater comment value1 value2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short test summary, e.g. &quot;Test whether there are
      running more instances of program.&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value1</dt>
  <dd class="It-tag">Integer value.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value2</dt>
  <dd class="It-tag">Integer value.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;value1 &gt; value2&quot;.
<div class="Pp"></div>
<i>rlAssertGreaterOrEqual</i>
<div class="Pp"></div>
Assertion checking whether first parameter is greater or equal to the second
  one.
<div class="Pp"></div>
<pre>
    rlAssertGreaterOrEqual comment value1 value2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short test summary (e.g. &quot;There should present at
      least one...&quot;)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value1</dt>
  <dd class="It-tag">Integer value.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value2</dt>
  <dd class="It-tag">Integer value.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;value1 X= value2&quot;.
<div class="Pp"></div>
<i>rlAssertLesser</i>
<div class="Pp"></div>
Assertion checking whether first parameter is lesser than the second one.
<div class="Pp"></div>
<pre>
    rlAssertLesser comment value1 value2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short test summary, e.g. &quot;Test whether there are
      running more instances of program.&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value1</dt>
  <dd class="It-tag">Integer value.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value2</dt>
  <dd class="It-tag">Integer value.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;value1 X value2&quot;.
<div class="Pp"></div>
<i>rlAssertLesserOrEqual</i>
<div class="Pp"></div>
Assertion checking whether first parameter is lesser or equal to the second one.
<div class="Pp"></div>
<pre>
    rlAssertLesserOrEqual comment value1 value2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short test summary (e.g. &quot;There should present at
      least one...&quot;)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value1</dt>
  <dd class="It-tag">Integer value.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">value2</dt>
  <dd class="It-tag">Integer value.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;value1 X= value2&quot;.
<h2 class="Ss" title="Ss" id="File_Asserts"><a class="selflink" href="#File_Asserts">File
  Asserts</a></h2>
<i>rlAssertExists</i>
<div class="Pp"></div>
Assertion checking for the existence of a file or a directory.
<div class="Pp"></div>
<pre>
    rlAssertExists file|directory
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">file|directory</dt>
  <dd class="It-tag">Path to the file or directory.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;file&quot; exists.
<div class="Pp"></div>
<i>rlAssertNotExists</i>
<div class="Pp"></div>
Assertion checking for the non-existence of a file or a directory.
<div class="Pp"></div>
<pre>
    rlAssertNotExists file|directory
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">file|directory</dt>
  <dd class="It-tag">Path to the file or directory.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;file&quot; does not exist.
<div class="Pp"></div>
<i>rlAssertGrep</i>
<div class="Pp"></div>
Assertion checking if the file contains a pattern.
<div class="Pp"></div>
<pre>
    rlAssertGrep pattern file [options]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">pattern</dt>
  <dd class="It-tag">Regular expression to be searched for.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">file</dt>
  <dd class="It-tag">Path to the file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">options</dt>
  <dd class="It-tag">Optional parameters to be passed to grep, default is
      &quot;-q&quot;. Can be used to perform case insensitive matches (-i), or
      using extended (-E) or perl (-P) regular expressions.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;file&quot; exists and contains given
  &quot;pattern&quot;.
<div class="Pp"></div>
<i>rlAssertNotGrep</i>
<div class="Pp"></div>
Assertion checking that the file does not contain a pattern.
<div class="Pp"></div>
<pre>
    rlAssertNotGrep pattern file [options]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">pattern</dt>
  <dd class="It-tag">Regular expression to be searched for.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">file</dt>
  <dd class="It-tag">Path to the file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">options</dt>
  <dd class="It-tag">Optional parameters to be passed to grep, default is
      &quot;-q&quot;. Can be used to perform case insensitive matches (-i), or
      using extended (-E) or perl (-P) regular expressions.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;file&quot; exists and does not contain
  given &quot;pattern&quot;.
<div class="Pp"></div>
<i>rlAssertDiffer</i>
<div class="Pp"></div>
Assertion checking that two files differ (are not identical).
<div class="Pp"></div>
<pre>
    rlAssertDiffer file1 file2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">file1</dt>
  <dd class="It-tag">Path to first file1</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">file2</dt>
  <dd class="It-tag">Path to second file</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;file1&quot; and &quot;file2&quot; differs.
<div class="Pp"></div>
<i>rlAssertNotDiffer</i>
<div class="Pp"></div>
Assertion checking that two files do not differ (are identical).
<div class="Pp"></div>
<pre>
    rlAssertNotDiffer file1 file2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">file1</dt>
  <dd class="It-tag">Path to first file1</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">file2</dt>
  <dd class="It-tag">Path to second file</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS when &quot;file1&quot; and &quot;file2&quot; do not
  differ.
<h2 class="Ss" title="Ss" id="Run,_Watch,_Report"><a class="selflink" href="#Run,_Watch,_Report">Run,
  Watch, Report</a></h2>
<i>rlRun</i>
<div class="Pp"></div>
Run command with optional comment and make sure its exit code matches
  expectations.
<div class="Pp"></div>
<pre>
    rlRun [-t] [-l] [-c] [-s] command [status[,status...]] [comment]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">-t</dt>
  <dd class="It-tag">If specified, stdout and stderr of the command output will
      be tagged with strigs 'STDOUT: ' and 'STDERR: '.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-l</dt>
  <dd class="It-tag">If specified, output of the command (tagged, if -t was
      specified) is logged using rlLog function. This is intended for short
      outputs, and therefore only last 50 lines are logged this way. Longer
      outputs should be analysed separately, or uploaded via rlFileSubmit or
      rlBundleLogs.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-c</dt>
  <dd class="It-tag">Same as &quot;-l&quot;, but only log the commands output if
      it failed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-s</dt>
  <dd class="It-tag">Store stdout and stderr to a file (mixed together, as the
      user would see it on a terminal) and set $rlRun_LOG variable to name of
      the file. Caller is responsible for removing the file. When -t option is
      used, the content of the file becomes tagged too.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the -s option is not used, $rlRun_LOG is not modified and keeps its
      content from the last &quot;rlRun -s&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">command</dt>
  <dd class="It-tag">Command to run.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">status</dt>
  <dd class="It-tag">Expected exit code(s). Optional, default 0. If you expect
      more exit codes, separate them with comma (e.g. &quot;0,1&quot; when both
      0 and 1 are OK and expected), or use from-to notation (i.e.
      &quot;2-5&quot; for &quot;2,3,4,5&quot;), or combine them (e.g.
      &quot;2-4,26&quot; for &quot;2,3,4,26&quot;).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">comment</dt>
  <dd class="It-tag">Short summary describing the action (optional, but
      recommended - explain what are you doing here).</dd>
</dl>
<div class="Pp"></div>
Returns the exit code of the command run. Asserts PASS when command\'s exit
  status is in the list of expected exit codes.
<div class="Pp"></div>
Note:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The output of rlRun is buffered when using &quot;-t&quot;,
      &quot;-l&quot; or &quot;-s&quot; option (they use unix pipes, which are
      buffered by nature). If you need an unbuffered output just make sure that
      &quot;expect&quot; package is installed on your system (its
      &quot;unbuffer&quot; tool will automatically be used to produce unbuffered
      output).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Be aware that there are some variables which can collide
      with your code executed within rlRun. You should avoid using
      __INTERNAL_rlRun_* variables.</dd>
</dl>
<div class="Pp"></div>
<b>Warning:</b> using &quot;unbuffer&quot; tool is now disabled because of bug
  547686.
<div class="Pp"></div>
<i>rlWatchdog</i>
<div class="Pp"></div>
Run &quot;command&quot;. If it does not finish in specified time, then kill it
  using &quot;signal&quot;.
<div class="Pp"></div>
<pre>
    rlWatchdog command timeout [signal] [callback]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">command</dt>
  <dd class="It-tag">Command to run.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">timeout</dt>
  <dd class="It-tag">Timeout to wait, in seconds.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">signal</dt>
  <dd class="It-tag">Signal to use (optional, default KILL).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">callback</dt>
  <dd class="It-tag">Callback function to be called before the signal is send
      (optional, none by default). The callback function will have one argument
      available -- PGID of the process group.</dd>
</dl>
<div class="Pp"></div>
Returns 0 if the command ends normally, without need to be killed.
<div class="Pp"></div>
<i>rlReport</i>
<div class="Pp"></div>
Report test result to the test harness. The command to be used for reporting is
  set by the respective plugin. You can also use the
  $BEAKERLIB_COMMAND_REPORT_RESULT variable to use your custom command.
<div class="Pp"></div>
<pre>
    rlReport name result [score] [log]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">name</dt>
  <dd class="It-tag">Name of the test result.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">result</dt>
  <dd class="It-tag">Result (one of PASS, WARN, FAIL). If called with something
      else, will use WARN.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">score</dt>
  <dd class="It-tag">Test score (optional).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">log</dt>
  <dd class="It-tag">Optional log file to be submitted instead of default
      &quot;OUTPUTFILE&quot;.</dd>
</dl>
<div class="Pp"></div>
<i>rlCmpVersion</i>
<div class="Pp"></div>
Compare two given versions composed by numbers and letters divided by dot (.),
  underscore (_), or dash (-).
<div class="Pp"></div>
<pre>
    rlCmpVersion ver1 ver2
</pre>
<div class="Pp"></div>
If ver1 = ver2, sign '=' is printed to stdout and 0 is returned. If ver1 &gt;
  ver2, sign '&gt;' is printed to stdout and 1 is returned. If ver1 &lt; ver2,
  sign '&lt;' is printed to stdout and 2 is returned.
<div class="Pp"></div>
<i>rlTestVersion</i>
<div class="Pp"></div>
Test releation between two given versions based on given operator.
<div class="Pp"></div>
<pre>
    rlTestVersion ver1 op ver2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">op</dt>
  <dd class="It-tag">Operator definitng the logical expression. It can be '=',
      '==', '!=', '&lt;', '&lt;=', '=&lt;', '&gt;', '&gt;=', or '=&gt;'.</dd>
</dl>
<div class="Pp"></div>
Returns 0 if the expresison ver1 op ver2 is true; 1 if the expression is false
  and 2 if something went wrong.
<h2 class="Ss" title="Ss" id="Release_Info"><a class="selflink" href="#Release_Info">Release
  Info</a></h2>
<i>rlIsRHEL</i>
<div class="Pp"></div>
Check whether we're running on RHEL. With given number of version as parameter
  returns 0 if the particular RHEL version is running. Multiple arguments can be
  passed separated with space as well as any particular release (5.1 5.2 5.3).
  Each version can have a prefix consisting of '&lt;', '&lt;=', '=', '&gt;=',
  '&gt;', matching whenever the currently installed version is lesser, lesser or
  equal, equal, equal or greater, greater than the version specified as
  argument. Note that ie. '=5' (unlike just '5') matches exactly 5 (5.0), not
  5.N, where N &gt; 0.
<div class="Pp"></div>
<pre>
    rlIsRHEL
</pre>
<div class="Pp"></div>
Returns 0 if we are running on RHEL.
<div class="Pp"></div>
<pre>
    rlIsRHEL 4.8 5
</pre>
<div class="Pp"></div>
Returns 0 if we are running RHEL 4.8 or any RHEL 5.
<div class="Pp"></div>
<i>rlIsFedora</i>
<div class="Pp"></div>
Check whether we're running on Fedora. With given number of version as parameter
  returns 0 if the particular Fedora version is running. Range matching can be
  used in the form used by rlIsRHEL.
<div class="Pp"></div>
<pre>
    rlIsFedora
</pre>
<div class="Pp"></div>
Returns 0 if we are running on Fedora.
<div class="Pp"></div>
<pre>
    rlIsFedora 9 10
</pre>
<div class="Pp"></div>
Returns 0 if we are running Fedora 9 or 10.
<h2 class="Ss" title="Ss" id="Release_Info"><a class="selflink" href="#Release_Info">Release
  Info</a></h2>
<i>rlIsCentOS</i>
<div class="Pp"></div>
Check whether we're running on CentOS. With given number of version as parameter
  returns 0 if the particular CentOS version is running. Multiple arguments can
  be passed separated with space as well as any particular release (5.1 5.2
  5.3). Each version can have a prefix consisting of '&lt;', '&lt;=', '=',
  '&gt;=', '&gt;', matching whenever the currently installed version is lesser,
  lesser or equal, equal, equal or greater, greater than the version specified
  as argument. Note that ie. '=5' (unlike just '5') matches exactly 5 (5.0), not
  5.N, where N &gt; 0.
<div class="Pp"></div>
<pre>
    rlIsCentOS
</pre>
<div class="Pp"></div>
Returns 0 if we are running on CentOS.
<div class="Pp"></div>
<pre>
    rlIsCentOS 7.1 6
</pre>
<div class="Pp"></div>
Returns 0 if we are running CentOS 7.1 or any CentOS 6.
<h2 class="Ss" title="Ss" id="Rpm_Handling"><a class="selflink" href="#Rpm_Handling">Rpm
  Handling</a></h2>
<i>rlCheckRpm</i>
<div class="Pp"></div>
Check whether a package is installed.
<div class="Pp"></div>
<pre>
    rlCheckRpm name [version] [release] [arch]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">name</dt>
  <dd class="It-tag">Package name like &quot;kernel&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">version</dt>
  <dd class="It-tag">Package version like 2.6.25.6</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">release</dt>
  <dd class="It-tag">Package release like &quot;55.fc9&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">arch</dt>
  <dd class="It-tag">Package architucture like &quot;i386&quot;</dd>
</dl>
<div class="Pp"></div>
Returns 0 if the specified package is installed.
<div class="Pp"></div>
<i>rlAssertRpm</i>
<div class="Pp"></div>
Assertion making sure that a package is installed.
<div class="Pp"></div>
<pre>
    rlAssertRpm name [version] [release] [arch]&gt;
    rlAssertRpm --all
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">name</dt>
  <dd class="It-tag">Package name like &quot;kernel&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">version</dt>
  <dd class="It-tag">Package version like 2.6.25.6</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">release</dt>
  <dd class="It-tag">Package release like &quot;55.fc9&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">arch</dt>
  <dd class="It-tag">Package architucture like &quot;i386&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--all</dt>
  <dd class="It-tag">Assert all packages listed in the $PACKAGES $REQUIRES and
      $COLLECTIONS environment variables.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS if the specified package is installed.
<div class="Pp"></div>
<i>rlAssertNotRpm</i>
<div class="Pp"></div>
Assertion making sure that a package is not installed. This is just inverse of
  &quot;rlAssertRpm&quot;.
<div class="Pp"></div>
<pre>
    rlAssertNotRpm name [version] [release] [arch]&gt;
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">name</dt>
  <dd class="It-tag">Package name like &quot;kernel&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">version</dt>
  <dd class="It-tag">Package version like 2.6.25.6</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">release</dt>
  <dd class="It-tag">Package release like &quot;55.fc9&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">arch</dt>
  <dd class="It-tag">Package architucture like &quot;i386&quot;</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS if the specified package is not installed.
<div class="Pp"></div>
<i>Example</i>
<div class="Pp"></div>
Function &quot;rlAssertRpm&quot; is useful especially in prepare phase where it
  causes abort if a package is missing, while &quot;rlCheckRpm&quot; is handy
  when doing something like:
<div class="Pp"></div>
<pre>
    if ! rlCheckRpm package; then
         yum install package
         rlAssertRpm package
    fi
</pre>
<div class="Pp"></div>
<i>rlAssertBinaryOrigin</i>
<div class="Pp"></div>
Assertion making sure that given binary is owned by (one of) the given
  package(s).
<div class="Pp"></div>
<pre>
    rlAssertBinaryOrigin binary package [package2 [...]]
    PACKAGES=... rlAssertBinaryOrigin binary
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">binary</dt>
  <dd class="It-tag">Binary name like &quot;ksh&quot; or
    &quot;/bin/ksh&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">package</dt>
  <dd class="It-tag">List of packages like &quot;ksh mksh&quot;. The parameter
      is optional. If missing, contents of environment variable $PACKAGES are
      taken into account.</dd>
</dl>
<div class="Pp"></div>
Returns 0 and asserts PASS if the specified binary belongs to (one of) the given
  package(s). Returns 1 and asserts FAIL if the specified binary does not belong
  to (any of) the given package(s). Returns 2 and asserts FAIL if the specified
  binary is not found. Returns 3 and asserts FAIL if no packages are given.
  Returns 100 and asserts FAIL if invoked with no parameters.
<div class="Pp"></div>
<i>Example</i>
<div class="Pp"></div>
Function &quot;rlAssertBinaryOrigin&quot; is useful especially in prepare phase
  where it causes abort if a binary is missing or is owned by different package:
<div class="Pp"></div>
<pre>
    PACKAGES=mksh rlAssertBinaryOrigin ksh
    or
    rlAssertBinaryOrigin ksh mksh
</pre>
<div class="Pp"></div>
Returns true if ksh is owned by the mksh package (in this case: /bin/ksh is a
  symlink pointing to /bin/mksh).
<div class="Pp"></div>
<i>rlGetMakefileRequires</i>
<div class="Pp"></div>
Prints comma separated list of requirements defined in Makefile using 'Requires'
  attribute.
<div class="Pp"></div>
Return 0 if success.
<div class="Pp"></div>
<i>rlCheckRequirements</i>
<div class="Pp"></div>
Check that all given requirements are covered eigther by installed package or by
  binary available in PATHs or by some package's provides.
<div class="Pp"></div>
<pre>
    rlRun &quot;rlCheckRequirements REQ...&quot;
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">REQ</dt>
  <dd class="It-tag">Requirement to be checked. It can be package name, provides
      string or binary name.</dd>
</dl>
<div class="Pp"></div>
Returns number of unsatisfied requirements.
<div class="Pp"></div>
<i>rlCheckMakefileRequires</i>
<div class="Pp"></div>
This is just a bit smarted wrapper of
<div class="Pp"></div>
&quot;rlCheckRequirements $(rlGetMakefileRequires)&quot;
<div class="Pp"></div>
<i>Example</i>
<div class="Pp"></div>
<pre>
    rlRun &quot;rlCheckMakefileRequires&quot;
</pre>
<div class="Pp"></div>
Return 255 if requirements could not be retrieved, 0 if all requirements are
  satisfied or number of unsatisfied requirements.
<div class="Pp"></div>
<i>rlAssertRequired</i>
<div class="Pp"></div>
Ensures that all Requires, specified in beakerlib-style beaker-wizard layout
  Makefile, are installed.
<div class="Pp"></div>
<pre>
    rlAssertRequired
</pre>
<div class="Pp"></div>
Prints out a verbose list of installed/missing packages during operation.
<div class="Pp"></div>
Returns 0 if all required packages are installed, 1 if one or more packages are
  missing or if no Makefile is present.
<h2 class="Ss" title="Ss" id="Getting_RPMs"><a class="selflink" href="#Getting_RPMs">Getting
  RPMs</a></h2>
<i>Download methods</i>
<div class="Pp"></div>
Functions handling rpm downloading/installing can use more methods for actual
  download of the rpm.
<div class="Pp"></div>
Currently there are two download methonds available:
<dl class="Bl-tag">
  <dt class="It-tag">direct</dt>
  <dd class="It-tag">Use use dirct download from build system (brew).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">yum</dt>
  <dd class="It-tag">Use yumdownloader.</dd>
</dl>
<div class="Pp"></div>
The methods and their order are defined by BEAKERLIB_RPM_DOWNLOAD_METHODS
  variable as space separated list. By default it is 'direct yum'. This can be
  overridden by user. There may be done also additions or changes to the
  original value, e.g. BEAKERLIB_RPM_DOWNLOAD_METHODS='yum
  ${BEAKERLIB_RPM_DOWNLOAD_METHODS/yum/}'
<div class="Pp"></div>
<i></i>
<div class="Pp"></div>
Beakerlib is prepared for more Koji-based sources of packages while usigng
  direct download method. By default packages are fetched from Koji,
  particularly from https://kojipkgs.fedoraproject.org/packages.
<div class="Pp"></div>
<i>rlRpmInstall</i>
<div class="Pp"></div>
Try to install specified package from local Red Hat sources.
<div class="Pp"></div>
<pre>
    rlRpmInstall package version release arch
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">package</dt>
  <dd class="It-tag">Package name like &quot;kernel&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">version</dt>
  <dd class="It-tag">Package version like 2.6.25.6</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">release</dt>
  <dd class="It-tag">Package release like &quot;55.fc9&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">arch</dt>
  <dd class="It-tag">Package arch like &quot;i386&quot;</dd>
</dl>
<div class="Pp"></div>
Returns 0 if specified package was installed succesfully.
<div class="Pp"></div>
<i>rlRpmDownload</i>
<div class="Pp"></div>
Try to download specified package.
<div class="Pp"></div>
<pre>
    rlRpmDownload package version release arch
    rlRpmDownload --source package version release
    rlRpmDownload N-V-R.A
    rlRpmDownload --source N-V-R
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">package</dt>
  <dd class="It-tag">Package name like &quot;kernel&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">version</dt>
  <dd class="It-tag">Package version like 2.6.25.6</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">release</dt>
  <dd class="It-tag">Package release like &quot;55.fc9&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">arch</dt>
  <dd class="It-tag">Package arch like &quot;i386&quot;</dd>
</dl>
<div class="Pp"></div>
Returns 0 if specified package was downloaded succesfully.
<div class="Pp"></div>
<i>rlFetchSrcForInstalled</i>
<div class="Pp"></div>
Tries various ways to download source rpm for specified installed rpm.
<div class="Pp"></div>
<pre>
    rlFetchSrcForInstalled package
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">package</dt>
  <dd class="It-tag">Installed package name like &quot;kernel&quot;. It accepts
      in-direct names. Eg for the package name &quot;krb5-libs&quot; will the
      function download the &quot;krb5&quot; source rpm.</dd>
</dl>
<div class="Pp"></div>
Returns 0 if the source package was succesfully downloaded.
<h2 class="Ss" title="Ss" id="Mounting"><a class="selflink" href="#Mounting">Mounting</a></h2>
<i>rlMount</i>
<div class="Pp"></div>
Create mount point (if neccessary) and mount a NFS share.
<div class="Pp"></div>
<pre>
    rlMount [-o MOUNT_OPTS] server share mountpoint
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">server</dt>
  <dd class="It-tag">NFS server hostname.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">share</dt>
  <dd class="It-tag">Shared directory name.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">mountpoint</dt>
  <dd class="It-tag">Local mount point.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">MOUNT_OPTS</dt>
  <dd class="It-tag">Mount options.</dd>
</dl>
<div class="Pp"></div>
Returns 0 if mounting the share was successful.
<div class="Pp"></div>
<i>rlCheckMount</i>
<div class="Pp"></div>
Check either if a directory is a mountpoint, if it is a mountpoint to a specific
  server, or if it is a mountpoint to a specific export on a specific server and
  if it uses specific mount options.
<div class="Pp"></div>
<pre>
    rlCheckMount [-o MOUNT_OPTS] mountpoint
    rlCheckMount [-o MOUNT_OPTS] server mountpoint
    rlCheckMount [-o MOUNT_OPTS] server share mountpoint
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">mountpoint</dt>
  <dd class="It-tag">Local mount point.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">server</dt>
  <dd class="It-tag">NFS server hostname</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">share</dt>
  <dd class="It-tag">Shared directory name</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">MOUNT_OPTS</dt>
  <dd class="It-tag">Mount options to check (comma separated list)</dd>
</dl>
<div class="Pp"></div>
With one parameter, returns 0 when specified directory exists and is a
  mountpoint. With two parameters, returns 0 when specific directory exists, is
  a mountpoint and an export from specific server is mounted there. With three
  parameters, returns 0 if a specific shared directory is mounted on a given
  server on a given mountpoint
<div class="Pp"></div>
If the -o option is provided, returns 0 if the mountpoint uses all the given
  options, 2 otherwise.
<div class="Pp"></div>
<i>rlAssertMount</i>
<div class="Pp"></div>
Assertion making sure that given directory is a mount point, if it is a
  mountpoint to a specific server, or if it is a mountpoint to a specific export
  on a specific server and if it uses specific mount options.
<div class="Pp"></div>
<pre>
    rlAssertMount [-o MOUNT_OPTS]  mountpoint
    rlAssertMount [-o MOUNT_OPTS]  server mountpoint
    rlAssertMount [-o MOUNT_OPTS]  server share mountpoint
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">mountpoint</dt>
  <dd class="It-tag">Local mount point.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">server</dt>
  <dd class="It-tag">NFS server hostname</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">share</dt>
  <dd class="It-tag">Shared directory name</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">MOUNT_OPTS</dt>
  <dd class="It-tag">Mount options to check (comma separated list)</dd>
</dl>
<div class="Pp"></div>
With one parameter, returns 0 when specified directory exists and is a
  mountpoint. With two parameters, returns 0 when specific directory exists, is
  a mountpoint and an export from specific server is mounted there. With three
  parameters, returns 0 if a specific shared directory is mounted on a given
  server on a given mountpoint. Asserts PASS when the condition is true.
<div class="Pp"></div>
If the -o option is provided, asserts PASS if the above conditions are met and
  the mountpoint uses all the given options.
<div class="Pp"></div>
<i>rlHash, rlUnhash</i>
<div class="Pp"></div>
Hashes/Unhashes given string.
<div class="Pp"></div>
<pre>
    rlHash [--decode] [--algorithm HASH_ALG] --stdin|STRING
    rlUnhash [--algorithm HASH_ALG] --stdin|STRING
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">--decode</dt>
  <dd class="It-tag">Unhash given string.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--algorithm</dt>
  <dd class="It-tag">Use given hash algorithm. Currently supported algorithms:
    <br/>
     base64
    <br/>
     base64_ - this is standard base64 where '=' is replaced by '_'
    <br/>
     hex
    <div style="height: 1.00em;">&#x00A0;</div>
    Defaults to hex. Default algorithm can be override using global variable
      rlHashAlgorithm.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--stdin</dt>
  <dd class="It-tag">Get the string from stdin.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">STRING</dt>
  <dd class="It-tag">String to be hashed/unhashed.</dd>
</dl>
<div class="Pp"></div>
Returns 0 if success.
<div class="Pp"></div>
Example with --clean:
<div class="Pp"></div>
<pre>
    hash=rlHash &quot;text&quot;
</pre>
<h2 class="Ss" title="Ss" id="Backup_and_Restore"><a class="selflink" href="#Backup_and_Restore">Backup
  and Restore</a></h2>
<i>rlFileBackup</i>
<div class="Pp"></div>
Create a backup of files or directories (recursive). Can be used multiple times
  to add more files to backup. Backing up an already backed up file overwrites
  the original backup.
<div class="Pp"></div>
<pre>
    rlFileBackup [--clean] [--namespace name] [--missing-ok|--no-missing-ok] file [file...]
</pre>
<div class="Pp"></div>
You can use &quot;rlRun&quot; for asserting the result but keep in mind meaning
  of exit codes, especialy exit code 8, if using without --clean option.
<dl class="Bl-tag">
  <dt class="It-tag">--clean</dt>
  <dd class="It-tag">If this option is provided (have to be first option of the
      command), then file/dir backuped using this command (provided in next
      options) will be (recursively) removed before we will restore it. This
      option implies --missing-ok, this can be overridden by
    --no-missing-ok.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--namespace name</dt>
  <dd class="It-tag">Specifies the namespace to use. Namespaces can be used to
      separate backups and their restoration.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--missing-ok</dt>
  <dd class="It-tag">Do not raise an error in case of missing file to
    backup.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--no-missing-ok</dt>
  <dd class="It-tag">Do raise an error in case of missing file to backup. This
      is useful with --clean. This behaviour can be globally set by global
      variable BEAKERLIB_FILEBACKUP_MISSING_OK=false.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">file</dt>
  <dd class="It-tag">Files and/or directories to be backed up.</dd>
</dl>
<div class="Pp"></div>
Returns 0 if the backup was successful. Returns 1 if parsing of parameters was
  not successful. Returns 2 if no files specification was provided. Returns 3 if
  BEAKERLIB_DIR variable is not set, e.g. rlJournalStart was not executed.
  Returns 4 if creating of main backup destination directories was not
  successful. Returns 5 if creating of file specific backup destination
  directories was not successful. Returns 6 if the copy of backed up files was
  not successful. Returns 7 if attributes of backedup files were not successfuly
  copied. Returns 8 if backed up files does not exist. This can be suppressed
  based on other options.
<div class="Pp"></div>
Example with --clean:
<div class="Pp"></div>
<pre>
    touch cleandir/aaa
    rlRun &quot;rlFileBackup --clean cleandir/&quot;
    touch cleandir/bbb
    ls cleandir/
    aaa   bbb
    rlRun &quot;rlFileRestore&quot;
    ls cleandir/
    aaa
</pre>
<div class="Pp"></div>
<i>rlFileRestore</i>
<div class="Pp"></div>
Restore backed up files to their original location. &quot;rlFileRestore&quot;
  does not remove new files appearing after backup has been made. If you don't
  want to leave anything behind just remove the whole original tree before
  running &quot;rlFileRestore&quot;, or see &quot;--clean&quot; option of
  &quot;rlFileBackup&quot;.
<div class="Pp"></div>
<pre>
    rlFileRestore [--namespace name]
</pre>
<div class="Pp"></div>
You can use &quot;rlRun&quot; for asserting the result.
<dl class="Bl-tag">
  <dt class="It-tag">--namespace name</dt>
  <dd class="It-tag">Specifies the namespace to use. Namespaces can be used to
      separate backups and their restoration.</dd>
</dl>
<div class="Pp"></div>
Returns 0 if backup dir is found and files are restored successfully.
<div class="Pp"></div>
Return code bits meaning XXXXX
<br/>
 |||||
<br/>
 ||||\_ error parsing parameters
<br/>
 |||\__ could not find backup directory
<br/>
 ||\___ files cleanup failed
<br/>
 |\____ files restore failed
<br/>
 \_____ no files were restored nor cleaned
<h2 class="Ss" title="Ss" id="Services"><a class="selflink" href="#Services">Services</a></h2>
Following routines implement comfortable way how to start/stop system services
  with the possibility to restore them to their original state after testing.
<div class="Pp"></div>
<i>rlServiceStart</i>
<div class="Pp"></div>
Make sure the given &quot;service&quot; is running with fresh configuration.
  (Start it if it is stopped and restart if it is already running.) In addition,
  when called for the first time, the current state is saved so that the
  &quot;service&quot; can be restored to its original state when testing is
  finished, see &quot;rlServiceRestore&quot;.
<div class="Pp"></div>
<pre>
    rlServiceStart service [service...]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">service</dt>
  <dd class="It-tag">Name of the service(s) to start.</dd>
</dl>
<div class="Pp"></div>
Returns number of services which failed to start/restart; thus zero is returned
  when everything is OK.
<div class="Pp"></div>
<i>rlServiceStop</i>
<div class="Pp"></div>
Make sure the given &quot;service&quot; is stopped. Stop it if it is running and
  do nothing when it is already stopped. In addition, when called for the first
  time, the current state is saved so that the &quot;service&quot; can be
  restored to its original state when testing is finished, see
  &quot;rlServiceRestore&quot;.
<div class="Pp"></div>
<pre>
    rlServiceStop service [service...]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">service</dt>
  <dd class="It-tag">Name of the service(s) to stop.</dd>
</dl>
<div class="Pp"></div>
Returns number of services which failed to become stopped; thus zero is returned
  when everything is OK.
<div class="Pp"></div>
<i>rlServiceRestore</i>
<div class="Pp"></div>
Restore given &quot;service&quot; into its original state (before the first
  &quot;rlServiceStart&quot; or &quot;rlServiceStop&quot; was called).
<div class="Pp"></div>
<pre>
    rlServiceRestore [service...]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">service</dt>
  <dd class="It-tag">Name of the service(s) to restore to original state. All
      services will be restored in reverse order if no service name is
    given.</dd>
</dl>
<div class="Pp"></div>
Returns number of services which failed to get back to their original state;
  thus zero is returned when everything is OK.
<div class="Pp"></div>
<i>rlServiceEnable</i>
<div class="Pp"></div>
Enables selected services if needed, or does nothing if already enabled. In
  addition, when called for the first time, the current state is saved so that
  the &quot;service&quot; can be restored to its original state when testing is
  finished, see &quot;rlServiceRestore&quot;.
<div class="Pp"></div>
<pre>
    rlServiceEnable service [service...]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">service</dt>
  <dd class="It-tag">Name of the service(s) to enable.</dd>
</dl>
<div class="Pp"></div>
Returns number of services which failed enablement; thus zero is returned when
  everything is OK.
<div class="Pp"></div>
<i>rlServiceDisable</i>
<div class="Pp"></div>
Disables selected services if needed, or does nothing if already disabled. In
  addition, when called for the first time, the current state is saved so that
  the &quot;service&quot; can be restored to its original state when testing is
  finished, see &quot;rlServiceRestore&quot;.
<div class="Pp"></div>
<pre>
    rlServiceDisable service [service...]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">service</dt>
  <dd class="It-tag">Name of the service(s) to disable.</dd>
</dl>
<div class="Pp"></div>
Returns number of services which failed disablement; thus zero is returned when
  everything is OK.
<h2 class="Ss" title="Ss" id="Sockets"><a class="selflink" href="#Sockets">Sockets</a></h2>
Following routines implement comfortable way how to start/stop system sockets
  with the possibility to restore them to their original state after testing.
<div class="Pp"></div>
<i>rlSocketStart</i>
<div class="Pp"></div>
Make sure the given &quot;socket&quot; is running. (Start it if stopped, leave
  it if already running.) In addition, when called for the first time, the
  current state is saved so that the &quot;socket&quot; can be restored to its
  original state when testing is finished, see &quot;rlSocketRestore&quot;.
<div class="Pp"></div>
<pre>
    rlSocketStart socket [socket...]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">socket</dt>
  <dd class="It-tag">Name of the socket(s) to start.</dd>
</dl>
<div class="Pp"></div>
Returns number of sockets which failed to start/restart; thus zero is returned
  when everything is OK.
<div class="Pp"></div>
<i>rlSocketStop</i>
<div class="Pp"></div>
Make sure the given &quot;socket&quot; is stopped. Stop it if it is running and
  do nothing when it is already stopped. In addition, when called for the first
  time, the current state is saved so that the &quot;socket&quot; can be
  restored to its original state when testing is finished, see
  &quot;rlSocketRestore&quot;.
<div class="Pp"></div>
<pre>
    rlSocketStop socket [socket...]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">socket</dt>
  <dd class="It-tag">Name of the socket(s) to stop.</dd>
</dl>
<div class="Pp"></div>
Returns number of sockets which failed to become stopped; thus zero is returned
  when everything is OK.
<div class="Pp"></div>
<i>rlSocketRestore</i>
<div class="Pp"></div>
Restore given &quot;socket&quot; into its original state (before the first
  &quot;rlSocketStart&quot; or &quot;rlSocketStop&quot; was called).
<div class="Pp"></div>
Warning !!! Xinetd process [even though it might have been used] is NOT
  restored. It is recommended to call rlServiceRestore xinetd as well.
<div class="Pp"></div>
<pre>
    rlSocketRestore socket [socket...]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">socket</dt>
  <dd class="It-tag">Name of the socket(s) to restore to original state.</dd>
</dl>
<div class="Pp"></div>
Returns number of sockets which failed to get back to their original state; thus
  zero is returned when everything is OK.
<h2 class="Ss" title="Ss" id="Cleanup_management"><a class="selflink" href="#Cleanup_management">Cleanup
  management</a></h2>
Cleanup management works with a so-called cleanup buffer, which is a temporary
  representation of what should be run at cleanup time, and a final cleanup
  script (executable), which is generated from this buffer and wraps it using
  BeakerLib essentials (journal initialization, cleanup phase, ...). The cleanup
  script must always be updated on an atomic basis (filesystem-wise) to allow an
  asynchronous execution by a third party (ie. test watcher).
<div class="Pp"></div>
The test watcher usage is mandatory for the cleanup management system to work
  properly as it is the test watcher that executes the actual cleanup script.
  Limited, catastrophe-avoiding mechanism is in place even when the test is not
  run in test watcher, but that should be seen as a backup and such situation is
  to be avoided whenever possible.
<div class="Pp"></div>
The cleanup script shares all environment (variables, exported or not, and
  functions) with the test itself - the cleanup append/prepend functions
  &quot;sample&quot; or &quot;snapshot&quot; the environment at the time of
  their call, IOW any changes to the test environment are synchronized to the
  cleanup script only upon calling append/prepend. When the append/prepend
  functions are called within a function which has local variables, these will
  appear as global in the cleanup.
<div class="Pp"></div>
While the cleanup script receives $PWD from the test, its working dir is set to
  the initial test execution dir even if $PWD contains something else. It is
  impossible to use relative paths inside cleanup reliably - certain parts of
  the cleanup might have been added under different current directories (CWDs).
  Therefore always use absolute paths in append/prepend cleanup or make sure you
  never 'cd' elsewhere (ie. to a TmpDir).
<div class="Pp"></div>
<i>rlCleanupAppend</i>
<div class="Pp"></div>
Appends a string to the cleanup buffer and recreates the cleanup script.
<div class="Pp"></div>
<pre>
    rlCleanupAppend string
</pre>
<div class="Pp"></div>
Returns 0 if the operation was successful, 1 otherwise.
<div class="Pp"></div>
<i>rlCleanupPrepend</i>
<div class="Pp"></div>
Prepends a string to the cleanup buffer and recreates the cleanup script.
<div class="Pp"></div>
<pre>
    rlCleanupPrepend string
</pre>
<div class="Pp"></div>
Returns 0 if the operation was successful, 1 otherwise.
<h2 class="Ss" title="Ss" id="Time_Performance"><a class="selflink" href="#Time_Performance">Time
  Performance</a></h2>
<i>rlPerfTime_RunsInTime</i>
<div class="Pp"></div>
Measures, how many runs of some commands can be done in specified time. This
  approach is suitable for short-time running tasks (up to few seconds), where
  averaging few runs is not precise. This is done several times, and the final
  result is the average of all runs. It prints the number on stdout, so it has
  to be captured.
<div class="Pp"></div>
<pre>
    rlPerfTime_RunsInTime command [time] [runs]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">command</dt>
  <dd class="It-tag">Command to run.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">time</dt>
  <dd class="It-tag">Time in seconds (optional, default=30).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">runs</dt>
  <dd class="It-tag">Number of averaged runs (optional, default=3).</dd>
</dl>
<div class="Pp"></div>
<i>rlPerfTime_AvgFromRuns</i>
<div class="Pp"></div>
Measures the average time of running some task. This approach is suitable for
  long-time running tasks (tens of seconds and more), where it is precise
  enough. Measured runs can be preceded by dry run, which is not measured and
  it's purpose is to warm up various caches. It prints the number on stdout, so
  it has to be captured. Or, result is then stored in special rl_retval
  variable.
<div class="Pp"></div>
<pre>
    rlPerfTime_AvgFromRuns command [count] [warmup]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">command</dt>
  <dd class="It-tag">Command to run.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">count</dt>
  <dd class="It-tag">Times to run (optional, default=3).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">warmup</dt>
  <dd class="It-tag">Warm-up run, run if this option is not &quot;warmup&quot;
      (optional, default=&quot;warmup&quot;)</dd>
</dl>
<h2 class="Ss" title="Ss" id="Analyze"><a class="selflink" href="#Analyze">Analyze</a></h2>
<i>rlDejaSum</i>
<div class="Pp"></div>
TODO description
<div class="Pp"></div>
<pre>
    rlDejaSum par1 par2
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">par1</dt>
  <dd class="It-tag">TODO description</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">par2</dt>
  <dd class="It-tag">TODO description</dd>
</dl>
<div class="Pp"></div>
Return 0 if... TODO
<div class="Pp"></div>
<i>rlImport</i>
<div class="Pp"></div>
Imports code provided by one or more libraries into the test namespace. The
  library search mechanism is based on Beaker test hierarchy system, i.e.:
<div class="Pp"></div>
/component/type/test-name/test-file
<div class="Pp"></div>
When test-file calls rlImport with 'foo/bar' parameter, the directory path is
  traversed upwards, and a check for presence of the test /foo/Library/bar/ will
  be performed. This means this function needs to be called from the test
  hierarchy, not e.g. the /tmp directory.
<div class="Pp"></div>
Once library is found, it is sourced and a verifier function is called. The
  verifier function is cunstructed by composing the library prefix and
  LibraryLoaded. Library prefix can be defined in the library itself. If the
  verifier passes the library is ready to use. Also variable
  <b>&lt;PREFIX&gt;LibraryDir</b> is created and it points to the library
  folder.
<div class="Pp"></div>
Usage:
<div class="Pp"></div>
<pre>
    rlImport --all
    rlImport LIBRARY [LIBRARY2...]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">--all</dt>
  <dd class="It-tag">Read Makefile in current/original directory, pick library
      requirements up and import them all.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">LIBRARY</dt>
  <dd class="It-tag">Must have 'component/library' format. Identifies the
      library to import.</dd>
</dl>
<div class="Pp"></div>
Returns 0 if the import of all libraries was successful. Returns non-zero if one
  or more library failed to import.
<h2 class="Ss" title="Ss" id="Process_Synchronisation"><a class="selflink" href="#Process_Synchronisation">Process
  Synchronisation</a></h2>
<i>rlWaitForCmd</i>
<div class="Pp"></div>
Pauses script execution until command exit status is the expeced value. Logs a
  WARNING and returns 1 if the command didn't exit successfully before timeout
  elapsed or a maximum number of invocations has been reached.
<div class="Pp"></div>
<pre>
    rlWaitForCmd command [-p PID] [-t time] [-m count] [-d delay] [-r retval]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">command</dt>
  <dd class="It-tag">Command that will be executed until its return code is
      equal 0 or value speciefied as option to `-r'.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-t time</dt>
  <dd class="It-tag">Timeout in seconds, default=120. If the command doesn't
      return 0 before time elapses, the command will be killed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-p PID</dt>
  <dd class="It-tag">PID of the process to check before running command. If the
      process exits before the socket is opened, the command will log a
    WARNING.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-m count</dt>
  <dd class="It-tag">Maximum number of `command' executions before continuing
      anyway. Default is infite. Returns 1 if the maximum was reached.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-d delay</dt>
  <dd class="It-tag">Delay between `command' invocations. Default 1.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-r retval</dt>
  <dd class="It-tag">Expected return value of command. Default 0.</dd>
</dl>
<div class="Pp"></div>
<i>rlWaitForFile</i>
<div class="Pp"></div>
Pauses script execution until specified file or directory starts existing.
  Returns 0 if file started existing, 1 if timeout was reached or PID exited.
  Return code is greater than 1 in case of error.
<div class="Pp"></div>
<pre>
    rlWaitForFile path [-p PID] [-t time] [-d delay]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">path</dt>
  <dd class="It-tag">Path to file that should start existing.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-t time</dt>
  <dd class="It-tag">Timeout in seconds (optional, default=120). If the file
      isn't opened before the time elapses the command returns 1.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-p PID</dt>
  <dd class="It-tag">PID of the process that should also be running. If the
      process exits before the file is created, the command returns with status
      code of 1.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-d delay</dt>
  <dd class="It-tag">Delay between subsequent checks for existence of file.
      Default 1.</dd>
</dl>
<div class="Pp"></div>
<i>rlWaitForSocket</i>
<div class="Pp"></div>
Pauses script execution until socket starts listening. Returns 0 if socket
  started listening, 1 if timeout was reached or PID exited. Return code is
  greater than 1 in case of error.
<div class="Pp"></div>
<pre>
    rlWaitForSocket {port|path} [-p PID] [-t time] [-d delay] [--close]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">port|path</dt>
  <dd class="It-tag">Network port to wait for opening or a path to UNIX socket.
      Regular expressions are also supported.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-t time</dt>
  <dd class="It-tag">Timeout in seconds (optional, default=120). If the socket
      isn't opened before the time elapses the command returns 1.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-p PID</dt>
  <dd class="It-tag">PID of the process that should also be running. If the
      process exits before the socket is opened, the command returns with status
      code of 1.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-d delay</dt>
  <dd class="It-tag">Delay between subsequent checks for availability of socket.
      Default 1.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--close</dt>
  <dd class="It-tag">Wait for the socket to stop listening.</dd>
</dl>
<div class="Pp"></div>
<i>rlWait</i>
<div class="Pp"></div>
Wrapper around bash builtin `wait' command. See <i>bash_builtins</i>(1) man
  page. Kills the process and all its children if the timeout elapses.
<div class="Pp"></div>
<pre>
    rlWaitFor [n ...] [-s SIGNAL] [-t time]
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">n</dt>
  <dd class="It-tag">List of PIDs to wait for. They need to be background tasks
      of current shell. See <i>bash_builtins</i>(1) section for `wait'
    command/</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-t time</dt>
  <dd class="It-tag">Timeout in seconds (optional, default=30). If the wait
      isn't successful before the time elapses then all specified tasks are
      killed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-s SIGNAL</dt>
  <dd class="It-tag">Signal used to kill the process, optional SIGTERM by
      default.</dd>
</dl>
<h2 class="Ss" title="Ss" id="Virtual_X_Server"><a class="selflink" href="#Virtual_X_Server">Virtual
  X Server</a></h2>
Functions providing simple way how to start and stop virtual X server.
<div class="Pp"></div>
<i>rlVirtualXStart</i>
<div class="Pp"></div>
Start a virtual X server on a first free display. Tries only first N displays,
  so you can run out of them.
<div class="Pp"></div>
<pre>
    rlVirtualXStart name
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">name</dt>
  <dd class="It-tag">String identifying the X server.</dd>
</dl>
<div class="Pp"></div>
Returns 0 when the server is started successfully.
<div class="Pp"></div>
<i>rlVirtualXGetDisplay</i>
<div class="Pp"></div>
Get the DISPLAY variable for specified virtual X server.
<div class="Pp"></div>
<pre>
    rlVirtualXGetDisplay name
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">name</dt>
  <dd class="It-tag">String identifying the X server.</dd>
</dl>
<div class="Pp"></div>
Displays the number of display where specified virtual X server is running to
  standard output. Returns 0 on success.
<div class="Pp"></div>
<i>rlVirtualXStop</i>
<div class="Pp"></div>
Kill the specified X server.
<div class="Pp"></div>
<pre>
    rlVirtualXStop name
</pre>
<dl class="Bl-tag">
  <dt class="It-tag">name</dt>
  <dd class="It-tag">String identifying the X server.</dd>
</dl>
<div class="Pp"></div>
Returns 0 when the server is stopped successfully.
<div class="Pp"></div>
<i>Example</i>
<div class="Pp"></div>
Below is a simple example of usage. Note that a lot of usefull debugging
  information is reported on the DEBUG level, so you can run your test with
  &quot;DEBUG=1 make run&quot; to get them.
<div class="Pp"></div>
<pre>
    rlVirtualXStart $TEST
    rlAssert0 &quot;Virtual X server started&quot; $?
    export DISPLAY=&quot;$( rlVirtualXGetDisplay $TEST )&quot;
    # ...your test which needs X...
    rlVirtualXStop $TEST
    rlAssert0 &quot;Virtual X server killed&quot; $?
</pre>
<div class="Pp"></div>
These are &quot;Requires&quot; lines for your scripts - note different package
  names for different RHEL versions:
<div class="Pp"></div>
<pre>
    @echo &quot;Requires: xorg-x11-server-Xvfb&quot; &gt;&gt; $(METADATA) # RHEL-5
    @echo &quot;Requires: xorg-x11-Xvfb&quot;        &gt;&gt; $(METADATA) # RHEL-4
    @echo &quot;Requires: XFree86-Xvfb&quot;         &gt;&gt; $(METADATA) # RHEL-3
</pre>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<h2 class="Ss" title="Ss" id="Simple"><a class="selflink" href="#Simple">Simple</a></h2>
A minimal BeakerLib test can look like this:
<div class="Pp"></div>
<pre>
    . /usr/share/beakerlib/beakerlib.sh
    rlJournalStart
        rlPhaseStartTest
            rlAssertRpm &quot;setup&quot;
            rlAssertExists &quot;/etc/passwd&quot;
            rlAssertGrep &quot;root&quot; &quot;/etc/passwd&quot;
        rlPhaseEnd
    rlJournalEnd
</pre>
<h2 class="Ss" title="Ss" id="Phases"><a class="selflink" href="#Phases">Phases</a></h2>
Here comes a bit more interesting example of a test which sets all the
  recommended variables and makes use of the phases:
<div class="Pp"></div>
<pre>
    # Include the BeakerLib environment
    . /usr/share/beakerlib/beakerlib.sh
    # Set the full test name
    TEST=&quot;/examples/beakerlib/Sanity/phases&quot;
    # Package being tested
    PACKAGE=&quot;coreutils&quot;
    rlJournalStart
        # Setup phase: Prepare test directory
        rlPhaseStartSetup
            rlAssertRpm $PACKAGE
            rlRun 'TmpDir=$(mktemp -d)' 0 'Creating tmp directory' # no-reboot
            rlRun &quot;pushd $TmpDir&quot;
        rlPhaseEnd
        # Test phase: Testing touch, ls and rm commands
        rlPhaseStartTest
            rlRun &quot;touch foo&quot; 0 &quot;Creating the foo test file&quot;
            rlAssertExists &quot;foo&quot;
            rlRun &quot;ls -l foo&quot; 0 &quot;Listing the foo test file&quot;
            rlRun &quot;rm foo&quot; 0 &quot;Removing the foo test file&quot;
            rlAssertNotExists &quot;foo&quot;
            rlRun &quot;ls -l foo&quot; 2 &quot;Listing foo should now report an error&quot;
        rlPhaseEnd
        # Cleanup phase: Remove test directory
        rlPhaseStartCleanup
            rlRun &quot;popd&quot;
            rlRun &quot;rm -r $TmpDir&quot; 0 &quot;Removing tmp directory&quot;
        rlPhaseEnd
    rlJournalEnd
    # Print the test report
    rlJournalPrintText
</pre>
<div class="Pp"></div>
The ouput of the rlJournalPrintText command would produce an output similar to
  the following:
<div class="Pp"></div>
<pre>
    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    :: [   LOG    ] :: TEST PROTOCOL
    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    :: [   LOG    ] :: Test run ID   : debugging
    :: [   LOG    ] :: Package       : coreutils
    :: [   LOG    ] :: Installed:    : coreutils-7.6-9.fc12.i686
    :: [   LOG    ] :: Test started  : 2010-02-08 14:55:44
    :: [   LOG    ] :: Test finished : 2010-02-08 14:55:50
    :: [   LOG    ] :: Test name     : /examples/beakerlib/Sanity/phases
    :: [   LOG    ] :: Distro:       : Fedora release 12 (Constantine)
    :: [   LOG    ] :: Hostname      : localhost
    :: [   LOG    ] :: Architecture  : i686
    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    :: [   LOG    ] :: Test description
    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    PURPOSE of /examples/beakerlib/Sanity/phases
    Description: Testing BeakerLib phases
    Author: Petr Splichal &lt;psplicha@redhat.com&gt;
    This example shows how the phases work in the BeakerLib on a
    trivial smoke test for the &quot;touch&quot;, &quot;ls&quot; and &quot;rm&quot; commands from
    the coreutils package.
    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    :: [   LOG    ] :: Setup
    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    :: [   PASS   ] :: Checking for the presence of coreutils rpm
    :: [   PASS   ] :: Creating tmp directory
    :: [   PASS   ] :: Running 'pushd /tmp/tmp.IcluQu5GVS' # no-reboot
    :: [   LOG    ] :: Duration: 0s
    :: [   LOG    ] :: Assertions: 3 good, 0 bad
    :: [   PASS   ] :: RESULT: Setup
    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    :: [   LOG    ] :: Test
    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    :: [   PASS   ] :: Creating the foo test file
    :: [   PASS   ] :: File foo should exist
    :: [   PASS   ] :: Listing the foo test file
    :: [   PASS   ] :: Removing the foo test file
    :: [   PASS   ] :: File foo should not exist
    :: [   PASS   ] :: Listing foo should now report an error
    :: [   LOG    ] :: Duration: 1s
    :: [   LOG    ] :: Assertions: 6 good, 0 bad
    :: [   PASS   ] :: RESULT: Test
    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    :: [   LOG    ] :: Cleanup
    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    :: [   PASS   ] :: Running 'popd'
    :: [   PASS   ] :: Removing tmp directory
    :: [   LOG    ] :: Duration: 1s
    :: [   LOG    ] :: Assertions: 2 good, 0 bad
    :: [   PASS   ] :: RESULT: Cleanup
</pre>
<div class="Pp"></div>
Note that the detailed test description is read from a separate file PURPOSE
  placed in the same directory as the test itself.
<div class="Pp"></div>
A lot of useful debugging information is reported on the DEBUG level. You can
  run your test with &quot;DEBUG=1 make run&quot; to get them.
<div class="Pp"></div>
Verbosity of the test logging may be altered also by setting the LOG_LEVEL
  variable. Possible values are &quot;ERROR&quot;, &quot;WARNING&quot;,
  &quot;INFO&quot; and &quot;DEBUG&quot;. You will see messages like the ones
  below.
<div class="Pp"></div>
<pre>
    :: [ WARNING  ] :: rlGetArch: Update test to use rlGetPrimaryArch/rlGetSecondaryArch
    :: [  DEBUG   ] :: rlGetArch: This is architecture 'x86_64'
    :: [  ERROR   ] :: this function was dropped as its development is completely moved to the beaker library
    :: [   INFO   ] :: if you realy on this function and you really need to have it present in core beakerlib, file a RFE, please
</pre>
<div class="Pp"></div>
Setting LOG_LEVEL=&quot;DEBUG&quot; is equivalent to DEBUG=1.
<h1 class="Sh" title="Sh" id="BKRDOC"><a class="selflink" href="#BKRDOC">BKRDOC</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag">Description</dt>
  <dd class="It-tag">Bkrdoc is a documentation generator from tests written
      using BeakerLib library. This generator makes documentation from test code
      with and also without any documentation markup.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">What it's good for</dt>
  <dd class="It-tag">For fast, brief and reliable documentation creation. It`s
      good for quick start with unknown BeakerLib test. Created documentations
      provides information about the documentation credibility. Also created
      documentations shows environmental variables and helps reader to run test
      script from which was documentation created.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Bkrdoc project page</dt>
  <dd class="It-tag">https://github.com/rh-lab-q/bkrdoc</dd>
</dl>
<h1 class="Sh" title="Sh" id="LINKS"><a class="selflink" href="#LINKS">LINKS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag">Project Page</dt>
  <dd class="It-tag">https://github.com/beakerlib</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Manual</dt>
  <dd class="It-tag">https://github.com/beakerlib/beakerlib/wiki/man</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Issues list</dt>
  <dd class="It-tag">https://github.com/beakerlib/beakerlib/issues</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Reporting issues</dt>
  <dd class="It-tag">https://github.com/beakerlib/beakerlib/issues/new</dd>
</dl>
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Petr Muller &lt;pmuller@redhat.com&gt;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Ondrej Hudlicky &lt;ohudlick@redhat.com&gt;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Jan Hutar &lt;jhutar@redhat.com&gt;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Petr Splichal &lt;psplicha@redhat.com&gt;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Ales Zelinka &lt;azelinka@redhat.com&gt;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Dalibor Pospisil &lt;dapospis@redhat.com&gt;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Martin Kyral &lt;mkyral@redhat.com&gt;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Jakub Prokes &lt;jprokes@redhat.com&gt;</dd>
</dl>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2017-05-23</td>
    <td class="foot-os">perl v5.24.1</td>
  </tr>
</table>
</body>
</html>
