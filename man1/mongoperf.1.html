<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>MONGOPERF(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">MONGOPERF(1)</td>
    <td class="head-vol">mongodb-manual</td>
    <td class="head-rtitle">MONGOPERF(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
mongoperf - MongoDB Performance Utility
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>mongoperf</b> is a utility to check disk I/O performance independently of
  MongoDB.
<div style="height: 1.00em;">&#x00A0;</div>
It times tests of random disk I/O and presents the results. You can use
  <b>mongoperf</b> for any case apart from MongoDB. The <b>mmf</b> <b>true</b>
  mode is completely generic. In that mode it is somewhat analogous to tools
  such as <i>bonnie++</i> (albeit mongoperf is simpler).
<div style="height: 1.00em;">&#x00A0;</div>
Specify options to <b>mongoperf</b> using a JavaScript document.
<div style="height: 1.00em;">&#x00A0;</div>
<b>SEE ALSO:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><i>bonnie</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><i>bonnie++</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><i>Output from an example run</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><i>Checking Disk Performance with the mongoperf
    Utility</i></dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>mongoperf</b></dt>
  <dd class="It-tag"></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>mongoperf</b></dt>
  <dd class="It-tag"></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help, -h</b></dt>
  <dd class="It-tag">Returns information on the options and use of
      <b>mongoperf</b>.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>&lt;jsonconfig&gt;</b></dt>
  <dd class="It-tag"><b>mongoperf</b> accepts configuration options in the form
      of a file that holds a <i>JSON</i> document. You must stream the content
      of this file into <b>mongoperf</b>, as in the following operation:</dd>
</dl>
<div style="margin-left: 7.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
mongoperf &lt; config
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
In this example <b>config</b> is the name of a file that holds a JSON document
  that resembles the following example:
<div style="margin-left: 7.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
  nThreads:&lt;n&gt;,
  fileSizeMB:&lt;n&gt;,
  sleepMicros:&lt;n&gt;,
  mmf:&lt;bool&gt;,
  r:&lt;bool&gt;,
  w:&lt;bool&gt;,
  recSizeKB:&lt;n&gt;,
  syncDelay:&lt;n&gt;
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
See the <i>Configuration Fields</i> section for documentation of each of these
  fields.</div>
<br/>
<h1 class="Sh" title="Sh" id="CONFIGURATION_FIELDS"><a class="selflink" href="#CONFIGURATION_FIELDS">CONFIGURATION
  FIELDS</a></h1>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>mongoperf.nThreads</b></dt>
  <dd class="It-tag"><i>Type:</i> Integer.
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>Default:</i> 1
    <div style="height: 1.00em;">&#x00A0;</div>
    Defines the number of threads <b>mongoperf</b> will use in the test. To
      saturate your system's storage system you will need multiple threads.
      Consider setting <b>nThreads</b> to <b>16</b>.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>mongoperf.fileSizeMB</b></dt>
  <dd class="It-tag"><i>Type:</i> Integer.
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>Default:</i> 1 megabyte (i.e. 10242 bytes)
    <div style="height: 1.00em;">&#x00A0;</div>
    Test file size.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>mongoperf.sleepMicros</b></dt>
  <dd class="It-tag"><i>Type:</i> Integer.
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>Default:</i> 0
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>mongoperf</b> will pause for the number of specified <b>sleepMicros</b>
      divided by the <b>nThreads</b> between each operation.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>mongoperf.mmf</b></dt>
  <dd class="It-tag"><i>Type:</i> Boolean.
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>Default:</i> <b>false</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    Set <b>mmf</b> to <b>true</b> to use memory mapped files for the tests.
    <div style="height: 1.00em;">&#x00A0;</div>
    Generally:</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">when <b>mmf</b> is <b>false</b>, <b>mongoperf</b> tests
      direct, physical, I/O, without caching. Use a large file size to test
      heavy random I/O load and to avoid I/O coalescing.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">when <b>mmf</b> is <b>true</b>, <b>mongoperf</b> runs tests
      of the caching system, and can use normal file system cache. Use
      <b>mmf</b> in this mode to test file system cache behavior with memory
      mapped files.</dd>
</dl>
</div>
<br/>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>mongoperf.r</b></dt>
  <dd class="It-tag"><i>Type:</i> Boolean.
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>Default:</i> <b>false</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    Set <b>r</b> to <b>true</b> to perform reads as part of the tests.
    <div style="height: 1.00em;">&#x00A0;</div>
    Either <b>r</b> or <b>w</b> must be <b>true</b>.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>mongoperf.w</b></dt>
  <dd class="It-tag"><i>Type:</i> Boolean.
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>Default:</i> <b>false</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    Set <b>w</b> to <b>true</b> to perform writes as part of the tests.
    <div style="height: 1.00em;">&#x00A0;</div>
    Either <b>r</b> or <b>w</b> must be <b>true</b>.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>mongoperf.recSizeKB</b></dt>
  <dd class="It-tag">New in version 2.4.
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>Type:</i> Integer.
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>Default:</i> 4 kb
    <div style="height: 1.00em;">&#x00A0;</div>
    The size of each write operation.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>mongoperf.syncDelay</b></dt>
  <dd class="It-tag"><i>Type:</i> Integer.
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>Default:</i> 0
    <div style="height: 1.00em;">&#x00A0;</div>
    Seconds between disk flushes. <b>mongoperf.syncDelay</b> is similar to
      <i>--syncdelay</i> for <b>mongod</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
    The <b>syncDelay</b> controls how frequently <b>mongoperf</b> performs an
      asynchronous disk flush of the memory mapped file used for testing. By
      default, <b>mongod</b> performs this operation every 60 seconds. Use
      <b>syncDelay</b> to test basic system performance of this type of
      operation.
    <div style="height: 1.00em;">&#x00A0;</div>
    Only use <b>syncDelay</b> in conjunction with <b>mmf</b> set to <b>true</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
    The default value of <b>0</b> disables this.</dd>
</dl>
</div>
<br/>
<h1 class="Sh" title="Sh" id="USE"><a class="selflink" href="#USE">USE</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
mongoperf &lt; jsonconfigfile
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Replace <b>jsonconfigfile</b> with the path to the <b>mongoperf</b>
  configuration. You may also invoke <b>mongoperf</b> in the following form:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
echo &quot;{nThreads:16,fileSizeMB:10000,r:true,w:true}&quot; | mongoperf
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
In this operation:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>mongoperf</b> tests direct physical random read and
      write io's, using 16 concurrent reader threads.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>mongoperf</b> uses a 10 gigabyte test file.</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Consider using <b>iostat</b>, as invoked in the following example to monitor I/O
  performance during the test.
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
iostat -xtm 1
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
MongoDB Documentation Project
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
2011-2015</div>
<table class="foot">
  <tr>
    <td class="foot-date">January 30, 2015</td>
    <td class="foot-os">3.0</td>
  </tr>
</table>
</body>
</html>
