<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:28:18 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>ocsptool(1) User Commands ocsptool(1)</p>

<p style="margin-top: 1em">NAME <br>
ocsptool - GnuTLS OCSP tool</p>

<p style="margin-top: 1em">SYNOPSIS <br>
ocsptool [-flags] [-flag [value]] [--option-name[[=|
]value]]</p>

<p style="margin-top: 1em">All arguments must be
options.</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Ocsptool is a program that can parse and print information
about OCSP requests/responses, generate requests and verify
responses.</p>

<p style="margin-top: 1em">OPTIONS <br>
-d number, --debug=number <br>
Enable debugging. This option takes an integer number as its
argument. The value of number is constrained to being: <br>
in the range 0 through 9999</p>

<p style="margin-top: 1em">Specifies the debug level.</p>

<p style="margin-top: 1em">-V, --verbose <br>
More verbose output. This option may appear an unlimited
number of times.</p>

<p style="margin-top: 1em">--infile=file <br>
Input file.</p>

<p style="margin-top: 1em">--outfile=string <br>
Output file.</p>

<p style="margin-top: 1em">--ask [=server name|url] <br>
Ask an OCSP/HTTP server on a certificate validity. This
option must appear in combination with the following
options: load-cert, load-issuer.</p>

<p style="margin-top: 1em">Connects to the specified HTTP
OCSP server and queries on the validity of the loaded
certificate.</p>

<p style="margin-top: 1em">-e, --verify-response <br>
Verify response.</p>

<p style="margin-top: 1em">-i, --request-info <br>
Print information on a OCSP request.</p>

<p style="margin-top: 1em">-j, --response-info <br>
Print information on a OCSP response.</p>

<p style="margin-top: 1em">-q, --generate-request <br>
Generate an OCSP request.</p>

<p style="margin-top: 1em">--nonce, - Fl -no-nonce <br>
Use (or not) a nonce to OCSP request. The no-nonce form will
disable the option.</p>

<p style="margin-top: 1em">--load-issuer=file <br>
Read issuer certificate from file.</p>

<p style="margin-top: 1em">--load-cert=file <br>
Read certificate to check from file.</p>

<p style="margin-top: 1em">--load-trust=file <br>
Read OCSP trust anchors from file. This option must not
appear in combination with any of the following options:
load-signer.</p>

<p style="margin-top: 1em">--load-signer=file <br>
Read OCSP response signer from file. This option must not
appear in combination with any of the following options:
load-trust.</p>

<p style="margin-top: 1em">--inder, - Fl -no-inder <br>
Use DER format for input certificates and private keys. The
no-inder form will disable the option.</p>

<p style="margin-top: 1em">-Q file, --load-request=file
<br>
Read DER encoded OCSP request from file.</p>

<p style="margin-top: 1em">-S file, --load-response=file
<br>
Read DER encoded OCSP response from file.</p>

<p style="margin-top: 1em">-h, --help <br>
Display usage information and exit.</p>

<p style="margin-top: 1em">-!, --more-help <br>
Pass the extended usage information through a pager.</p>

<p style="margin-top: 1em">-v [{v|c|n --version [{v|c|n}]}]
<br>
Output version of program and exit. The default mode is
&lsquo;v&rsquo;, a simple version. The &lsquo;c&rsquo; mode
will print copyright information and &lsquo;n&rsquo; will
print the full copyright <br>
notice.</p>

<p style="margin-top: 1em">EXAMPLES <br>
Print information about an OCSP request</p>

<p style="margin-top: 1em">To parse an OCSP request and
print information about the content, the -i or
--request-info parameter may be used as follows. The -Q
parameter specify the name of the file con&acirc; <br>
taining the OCSP request, and it should contain the OCSP
request in binary DER format.</p>

<p style="margin-top: 1em">$ ocsptool -i -Q
ocsp-request.der</p>

<p style="margin-top: 1em">The input file may also be sent
to standard input like this:</p>

<p style="margin-top: 1em">$ cat ocsp-request.der |
ocsptool --request-info</p>

<p style="margin-top: 1em">Print information about an OCSP
response</p>

<p style="margin-top: 1em">Similar to parsing OCSP
requests, OCSP responses can be parsed using the -j or
--response-info as follows.</p>

<p style="margin-top: 1em">$ ocsptool -j -Q
ocsp-response.der <br>
$ cat ocsp-response.der | ocsptool --response-info</p>

<p style="margin-top: 1em">Generate an OCSP request</p>

<p style="margin-top: 1em">The -q or --generate-request
parameters are used to generate an OCSP request. By default
the OCSP request is written to standard output in binary DER
format, but can be stored <br>
in a file using --outfile. To generate an OCSP request the
issuer of the certificate to check needs to be specified
with --load-issuer and the certificate to check with <br>
--load-cert. By default PEM format is used for these files,
although --inder can be used to specify that the input files
are in DER format.</p>

<p style="margin-top: 1em">$ ocsptool -q --load-issuer
issuer.pem --load-cert client.pem --outfile
ocsp-request.der</p>

<p style="margin-top: 1em">When generating OCSP requests,
the tool will add an OCSP extension containing a nonce. This
behaviour can be disabled by specifying --no-nonce.</p>

<p style="margin-top: 1em">Verify signature in OCSP
response</p>

<p style="margin-top: 1em">To verify the signature in an
OCSP response the -e or --verify-response parameter is used.
The tool will read an OCSP response in DER format from
standard input, or from the <br>
file specified by --load-response. The OCSP response is
verified against a set of trust anchors, which are specified
using --load-trust. The trust anchors are concatenated
cer&acirc; <br>
tificates in PEM format. The certificate that signed the
OCSP response needs to be in the set of trust anchors, or
the issuer of the signer certificate needs to be in the set
of <br>
trust anchors and the OCSP Extended Key Usage bit has to be
asserted in the signer certificate.</p>

<p style="margin-top: 1em">$ ocsptool -e --load-trust
issuer.pem --load-response ocsp-response.der</p>

<p style="margin-top: 1em">The tool will print status of
verification.</p>

<p style="margin-top: 1em">Verify signature in OCSP
response against given certificate</p>

<p style="margin-top: 1em">It is possible to override the
normal trust logic if you know that a certain certificate is
supposed to have signed the OCSP response, and you want to
use it to check the signa&acirc; <br>
ture. This is achieved using --load-signer instead of
--load-trust. This will load one certificate and it will be
used to verify the signature in the OCSP response. It will
<br>
not check the Extended Key Usage bit.</p>

<p style="margin-top: 1em">$ ocsptool -e --load-signer
ocsp-signer.pem --load-response ocsp-response.der</p>

<p style="margin-top: 1em">This approach is normally only
relevant in two situations. The first is when the OCSP
response does not contain a copy of the signer certificate,
so the --load-trust code would <br>
fail. The second is if you want to avoid the indirect mode
where the OCSP response signer certificate is signed by a
trust anchor.</p>

<p style="margin-top: 1em">Real-world example</p>

<p style="margin-top: 1em">Here is an example of how to
generate an OCSP request for a certificate and to verify the
response. For illustration we&rsquo;ll use the
blog.josefsson.org host, which (as of writing) <br>
uses a certificate from CACert. First we&rsquo;ll use
gnutls-cli to get a copy of the server certificate chain.
The server is not required to send this information, but
this particu&acirc; <br>
lar one is configured to do so.</p>

<p style="margin-top: 1em">$ echo | gnutls-cli -p 443
blog.josefsson.org --print-cert &gt; chain.pem</p>

<p style="margin-top: 1em">Use a text editor on chain.pem
to create three files for each separate certificates, called
cert.pem for the first certificate for the domain itself,
secondly issuer.pem for the <br>
intermediate certificate and root.pem for the final root
certificate.</p>

<p style="margin-top: 1em">The domain certificate normally
contains a pointer to where the OCSP responder is located,
in the Authority Information Access Information extension.
For example, from certtool <br>
-i &lt; cert.pem there is this information:</p>

<p style="margin-top: 1em">Authority Information Access
Information (not critical): <br>
Access Method: 1.3.6.1.5.5.7.48.1 (id-ad-ocsp) <br>
Access Location URI: http://ocsp.CAcert.org/</p>

<p style="margin-top: 1em">This means the CA support OCSP
queries over HTTP. We are now ready to create a OCSP request
for the certificate.</p>

<p style="margin-top: 1em">$ ocsptool --ask ocsp.CAcert.org
--load-issuer issuer.pem --load-cert cert.pem --outfile
ocsp-response.der</p>

<p style="margin-top: 1em">The request is sent via HTTP to
the OCSP server address specified. If the address is ommited
ocsptool will use the address stored in the certificate.</p>

<p style="margin-top: 1em">EXIT STATUS <br>
One of the following exit values will be returned:</p>

<p style="margin-top: 1em">0 (EXIT_SUCCESS) <br>
Successful program execution.</p>

<p style="margin-top: 1em">1 (EXIT_FAILURE) <br>
The operation failed or the command syntax was not
valid.</p>

<p style="margin-top: 1em">70 (EX_SOFTWARE) <br>
libopts had an internal operational error. Please report it
to autogen-users@lists.sourceforge.net. Thank you.</p>

<p style="margin-top: 1em">SEE ALSO <br>
certtool (1)</p>

<p style="margin-top: 1em">AUTHORS <br>
Nikos Mavrogiannopoulos, Simon Josefsson and others; see
/usr/share/doc/gnutls/AUTHORS for a complete list.</p>

<p style="margin-top: 1em">COPYRIGHT <br>
Copyright (C) 2000-2016 Free Software Foundation, and others
all rights reserved. This program is released under the
terms of the GNU General Public License, version 3 or
later.</p>

<p style="margin-top: 1em">BUGS <br>
Please send bug reports to: bugs@gnutls.org</p>

<p style="margin-top: 1em">NOTES <br>
This manual page was AutoGen-erated from the ocsptool option
definitions.</p>

<p style="margin-top: 1em">3.3.24 06 Jul 2016
ocsptool(1)</p>
<hr>
</body>
</html>
