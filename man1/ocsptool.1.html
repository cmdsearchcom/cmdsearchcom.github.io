<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>ocsptool(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">ocsptool(1)</td>
    <td class="head-vol">User Commands</td>
    <td class="head-rtitle">ocsptool(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<b>ocsptool</b> - GnuTLS OCSP tool
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>ocsptool</b> [ <b>-flags</b>] [ <b>-flag</b> [<i>value</i>]] [
  <b>--option-name</b>[[=| ] <i>value</i>]]
<div style="height: 0.00ex;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
All arguments must be options.
<div style="height: 0.00ex;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
Ocsptool is a program that can parse and print information about OCSP
  requests/responses, generate requests and verify responses.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d</b> <i>number</i>, <b>--debug</b>=<i>number</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Enable debugging. This option takes an integer number as its argument. The
      value of <i>number</i> is constrained to being:
    <br/>
    <pre>
in the range  0 through 9999
    </pre>
    <br/>
    <div style="height: 1.00em;">&#x00A0;</div>
    Specifies the debug level.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-V</b>, <b>--verbose</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    More verbose output. This option may appear an unlimited number of times.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--infile</b>=<i>file</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Input file.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--outfile</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Output file.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ask</b> [=<i>server</i> <i>name|url</i>]</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Ask an OCSP/HTTP server on a certificate validity. This option must appear
      in combination with the following options: load-cert, load-issuer.
    <div style="height: 1.00em;">&#x00A0;</div>
    Connects to the specified HTTP OCSP server and queries on the validity of
      the loaded certificate.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-e</b>, <b>--verify-response</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Verify response.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i</b>, <b>--request-info</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Print information on a OCSP request.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-j</b>, <b>--response-info</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Print information on a OCSP response.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-q</b>, <b>--generate-request</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Generate an OCSP request.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--nonce</b>, <b>- Fl -no-nonce</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Use (or not) a nonce to OCSP request. The <i>no-nonce</i> form will disable
      the option.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--load-issuer</b>=<i>file</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Read issuer certificate from file.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--load-cert</b>=<i>file</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Read certificate to check from file.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--load-trust</b>=<i>file</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Read OCSP trust anchors from file. This option must not appear in
      combination with any of the following options: load-signer.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--load-signer</b>=<i>file</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Read OCSP response signer from file. This option must not appear in
      combination with any of the following options: load-trust.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--inder</b>, <b>- Fl -no-inder</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Use DER format for input certificates and private keys. The <i>no-inder</i>
      form will disable the option.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-Q</b> <i>file</i>,
    <b>--load-request</b>=<i>file</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Read DER encoded OCSP request from file.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-S</b> <i>file</i>,
    <b>--load-response</b>=<i>file</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Read DER encoded OCSP response from file.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h</b>, <b>--help</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Display usage information and exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-!</b>, <b>--more-help</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Pass the extended usage information through a pager.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v</b> [{<i>v|c|n</i> <b>--version</b>
    [{<i>v|c|n</i>}]}]</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Output version of program and exit. The default mode is `v', a simple
      version. The `c' mode will print copyright information and `n' will print
      the full copyright notice.</dd>
</dl>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<b>Print information about an OCSP request</b>
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
To parse an OCSP request and print information about the content, the <b>-i</b>
  or <b>--request-info</b> parameter may be used as follows. The <b>-Q</b>
  parameter specify the name of the file containing the OCSP request, and it
  should contain the OCSP request in binary DER format.
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<br/>
<pre>
$ ocsptool -i -Q ocsp-request.der
<br/>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
The input file may also be sent to standard input like this:
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<br/>
<pre>
$ cat ocsp-request.der | ocsptool --request-info
<br/>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>Print information about an OCSP response</b>
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
Similar to parsing OCSP requests, OCSP responses can be parsed using the
  <b>-j</b> or <b>--response-info</b> as follows.
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<br/>
<pre>
$ ocsptool -j -Q ocsp-response.der
$ cat ocsp-response.der | ocsptool --response-info
<br/>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>Generate an OCSP request</b>
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
The <b>-q</b> or <b>--generate-request</b> parameters are used to generate an
  OCSP request. By default the OCSP request is written to standard output in
  binary DER format, but can be stored in a file using <b>--outfile</b>. To
  generate an OCSP request the issuer of the certificate to check needs to be
  specified with <b>--load-issuer</b> and the certificate to check with
  <b>--load-cert</b>. By default PEM format is used for these files, although
  <b>--inder</b> can be used to specify that the input files are in DER format.
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<br/>
<pre>
$ ocsptool -q --load-issuer issuer.pem --load-cert client.pem            --outfile ocsp-request.der
<br/>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
When generating OCSP requests, the tool will add an OCSP extension containing a
  nonce. This behaviour can be disabled by specifying <b>--no-nonce</b>.
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>Verify signature in OCSP response</b>
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
To verify the signature in an OCSP response the <b>-e</b> or
  <b>--verify-response</b> parameter is used. The tool will read an OCSP
  response in DER format from standard input, or from the file specified by
  <b>--load-response</b>. The OCSP response is verified against a set of trust
  anchors, which are specified using <b>--load-trust</b>. The trust anchors are
  concatenated certificates in PEM format. The certificate that signed the OCSP
  response needs to be in the set of trust anchors, or the issuer of the signer
  certificate needs to be in the set of trust anchors and the OCSP Extended Key
  Usage bit has to be asserted in the signer certificate.
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<br/>
<pre>
$ ocsptool -e --load-trust issuer.pem            --load-response ocsp-response.der
<br/>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
The tool will print status of verification.
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>Verify signature in OCSP response against given certificate</b>
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
It is possible to override the normal trust logic if you know that a certain
  certificate is supposed to have signed the OCSP response, and you want to use
  it to check the signature. This is achieved using <b>--load-signer</b> instead
  of <b>--load-trust</b>. This will load one certificate and it will be used to
  verify the signature in the OCSP response. It will not check the Extended Key
  Usage bit.
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<br/>
<pre>
$ ocsptool -e --load-signer ocsp-signer.pem            --load-response ocsp-response.der
<br/>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
This approach is normally only relevant in two situations. The first is when the
  OCSP response does not contain a copy of the signer certificate, so the
  <b>--load-trust</b> code would fail. The second is if you want to avoid the
  indirect mode where the OCSP response signer certificate is signed by a trust
  anchor.
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>Real-world example</b>
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
Here is an example of how to generate an OCSP request for a certificate and to
  verify the response. For illustration we'll use the <b>blog.josefsson.org</b>
  host, which (as of writing) uses a certificate from CACert. First we'll use
  <b>gnutls-cli</b> to get a copy of the server certificate chain. The server is
  not required to send this information, but this particular one is configured
  to do so.
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<br/>
<pre>
$ echo | gnutls-cli -p 443 blog.josefsson.org --print-cert &gt; chain.pem
<br/>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
Use a text editor on <b>chain.pem</b> to create three files for each separate
  certificates, called <b>cert.pem</b> for the first certificate for the domain
  itself, secondly <b>issuer.pem</b> for the intermediate certificate and
  <b>root.pem</b> for the final root certificate.
<div style="height: 1.00em;">&#x00A0;</div>
The domain certificate normally contains a pointer to where the OCSP responder
  is located, in the Authority Information Access Information extension. For
  example, from <b>certtool -i &lt; cert.pem</b> there is this information:
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<br/>
<pre>
Authority Information Access Information (not critical):
Access Method: 1.3.6.1.5.5.7.48.1 (id-ad-ocsp)
Access Location URI: http://ocsp.CAcert.org/
<br/>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
This means the CA support OCSP queries over HTTP. We are now ready to create a
  OCSP request for the certificate.
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<br/>
<pre>
$ ocsptool --ask ocsp.CAcert.org --load-issuer issuer.pem            --load-cert cert.pem --outfile ocsp-response.der
<br/>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
The request is sent via HTTP to the OCSP server address specified. If the
  address is ommited ocsptool will use the address stored in the certificate.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="EXIT_STATUS"><a class="selflink" href="#EXIT_STATUS">EXIT
  STATUS</a></h1>
One of the following exit values will be returned:
<dl class="Bl-tag">
  <dt class="It-tag">0 (EXIT_SUCCESS)</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Successful program execution.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">1 (EXIT_FAILURE)</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The operation failed or the command syntax was not valid.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">70 (EX_SOFTWARE)</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    libopts had an internal operational error. Please report it to
      autogen-users@lists.sourceforge.net. Thank you.</dd>
</dl>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<br/>
 certtool (1)
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
Nikos Mavrogiannopoulos, Simon Josefsson and others; see
  /usr/share/doc/gnutls/AUTHORS for a complete list.
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
Copyright (C) 2000-2016 Free Software Foundation, and others all rights
  reserved. This program is released under the terms of the GNU General Public
  License, version 3 or later.
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Please send bug reports to: bugs@gnutls.org
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
This manual page was <i>AutoGen</i>-erated from the <b>ocsptool</b> option
  definitions.</div>
<table class="foot">
  <tr>
    <td class="foot-date">06 Jul 2016</td>
    <td class="foot-os">3.3.24</td>
  </tr>
</table>
</body>
</html>
