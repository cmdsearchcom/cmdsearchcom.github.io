<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>DCHROOT-DSA(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DCHROOT-DSA(1)</td>
    <td class="head-vol">Debian sbuild</td>
    <td class="head-rtitle">DCHROOT-DSA(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
dchroot-dsa - enter a chroot environment
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>dchroot-dsa</b> [<b>-h</b>|<b>--help</b> | <b>-V</b>|<b>--version</b> |
  <b>-l</b>|<b>--list</b> | <b>-i</b>|<b>--info</b> | <b>--config</b> |
  <b>-p</b>|<b>--listpaths</b>] [<b>-d
  <i>directory</i></b>|<b>--directory=<i>directory</i></b>]
  [<b>-q</b>|<b>--quiet</b> | <b>-v</b>|<b>--verbose</b>] [<b>-c
  <i>chroot</i></b>|<b>--chroot=<i>chroot</i></b> | <b>--all</b> |
  <b>CHROOT]</b> [<b>COMMAND</b>]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>dchroot-dsa</b> allows the user to run a command or a login shell in a chroot
  environment. If no command is specified, a login shell will be started in the
  user's home directory inside the chroot.
<div class="Pp"></div>
The user's environment will be preserved inside the chroot.
<div class="Pp"></div>
The command is a single argument which must be an absolute path to the program.
  Additional options are not permitted.
<div class="Pp"></div>
The directory the command or login shell is run in depends upon the context. See
  <i>--directory</i> option below for a complete description.
<div class="Pp"></div>
This version of dchroot-dsa is a compatibility wrapper around the
  <b>schroot</b>(1) program. It is provided for backward compatibility with the
  dchroot-dsa command-line options, but schroot is recommended for future use.
  See the section &#x201C; <i>Incompatibilities</i>&#x201D; below for known
  incompatibilities with older versions of dchroot-dsa.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<b>dchroot-dsa</b> accepts the following options:
<h2 class="Ss" title="Ss" id="Basic_options"><a class="selflink" href="#Basic_options">Basic
  options</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h</b>, <b>--help</b></dt>
  <dd class="It-tag">Show help summary.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-a</b>, <b>--all</b></dt>
  <dd class="It-tag">Select all chroots. Note that earlier versions of
      dchroot-dsa did not include this option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c</b>, <b>--chroot=<i>chroot</i></b></dt>
  <dd class="It-tag">Specify a chroot to use. This option may be used multiple
      times to specify more than one chroot, in which case its effect is similar
      to <i>--all</i>. If this option is not used, the first non-option argument
      specified the chroot to use. Note that earlier versions of dchroot-dsa did
      not include this option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l</b>, <b>--list</b></dt>
  <dd class="It-tag">List all available chroots.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i</b>, <b>--info</b></dt>
  <dd class="It-tag">Print detailed information about the available chroots.
      Note that earlier versions of dchroot-dsa did not include this
    option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p</b>, <b>--listpaths</b></dt>
  <dd class="It-tag">Print absolute locations (paths) of the available
    chroots.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--config</b></dt>
  <dd class="It-tag">Print configuration of the available chroots. This is
      useful for testing that the configuration in use is the same as the
      configuration file. Any comments in the original file will be missing.
      Note that earlier versions of dchroot-dsa did not include this
    option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d</b>, <b>--directory=<i>directory</i></b></dt>
  <dd class="It-tag">Change to <i>directory</i> inside the chroot before running
      the command or login shell. If <i>directory</i> is not available,
      dchroot-dsa will exit with an error status.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">The default behaviour (all directory paths are inside the
      chroot) is to run the login shell or command in the user's home directory,
      or <i>/</i> if the home directory is not available. If none of the
      directories are available, dchroot-dsa will exit with an error
    status.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-q</b>, <b>--quiet</b></dt>
  <dd class="It-tag">Print only essential messages. Note that earlier versions
      of dchroot-dsa did not include this option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v</b>, <b>--verbose</b></dt>
  <dd class="It-tag">Print all messages. Note that earlier versions of
      dchroot-dsa did not include this option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-V</b>, <b>--version</b></dt>
  <dd class="It-tag">Print version information.</dd>
</dl>
<h1 class="Sh" title="Sh" id="CONFIGURATION"><a class="selflink" href="#CONFIGURATION">CONFIGURATION</a></h1>
<h1 class="Sh" title="Sh" id="INCOMPATIBILITIES"><a class="selflink" href="#INCOMPATIBILITIES">INCOMPATIBILITIES</a></h1>
<h2 class="Ss" title="Ss" id="Debian_dchroot_prior_to_version_1.5.1"><a class="selflink" href="#Debian_dchroot_prior_to_version_1.5.1">Debian
  dchroot prior to version 1.5.1</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">This version of dchroot-dsa uses <i>schroot.conf</i> to
      store the configuration for available chroots, rather than the
      <i>dchroot.conf</i> file used historically. dchroot-dsa supported
      automatic migration of <i>dchroot.conf</i> to the <i>schroot.conf</i>
      keyfile format with its <i>--config</i> option from versions 0.2.2 to
      1.5.0; support for the old format is now no longer available.</dd>
</dl>
<h2 class="Ss" title="Ss" id="DSA_dchroot"><a class="selflink" href="#DSA_dchroot">DSA
  dchroot</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Log messages are worded and formatted differently.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">dchroot-dsa provides a restricted subset of the
      functionality implemented by <b>schroot</b>, but is still schroot
      underneath. Thus dchroot-dsa is still subject to schroot security
      checking, including PAM authentication and authorisation, and session
      management, for example, and hence may behave slightly differently to
      earlier versions of dchroot-dsa in some circumstances.</dd>
</dl>
<h2 class="Ss" title="Ss" id="Debian_dchroot"><a class="selflink" href="#Debian_dchroot">Debian
  dchroot</a></h2>
A <b>dchroot</b> package provides an alternative dchroot implementation.
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">All the above incompatibilities apply.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">This version of dchroot has incompatible command-line
      options, and while some of those options are supported or have equivalent
      options by a different name, the <i>-c</i> option is required to specify a
      chroot. It also allows a shell script to be used as the option instead of
      a single absolute path, and allows multiple command options instead of a
      single option.</dd>
</dl>
<h1 class="Sh" title="Sh" id="DIRECTORY_FALLBACKS"><a class="selflink" href="#DIRECTORY_FALLBACKS">DIRECTORY
  FALLBACKS</a></h1>
dchroot-dsa will select an appropriate directory to use within the chroot based
  upon whether the <i>--directory</i> option is used. When explicitly specifying
  a directory, only one directory will be used for safety and consistency, while
  for a login shell or command several possibilities may be tried. Note that due
  to multiple fallbacks being considered for commands, it is dangerous to run
  commands using dchroot-dsa; use schroot instead. The following subsections
  list the fallback sequence for each case. CWD is the current working
  directory, DIR is the directory specified with <i>--directory</i>.
<h2 class="Ss" title="Ss" id="Login_shell_or_command"><a class="selflink" href="#Login_shell_or_command">Login
  shell or command</a></h2>
<table class="tbl">
  <colgroup>
    <col style="width: 23.00ex;"/>
    <col style="width: 40.00ex;"/>
  </colgroup>
  <tr>
    <td>Transition</td>
    <td></td>
  </tr>
  <tr>
    <td>(Host &#x2192; Chroot)</td>
    <td>Comment</td>
  </tr>
  <tr>
    <td colspan="0"></td>
  </tr>
  <tr>
    <td>CWD &#x2192; passwd pw_dir</td>
    <td>Normal behaviour (if --directory is not used)</td>
  </tr>
  <tr>
    <td>CWD &#x2192; /</td>
    <td>If passwd pw_dir is nonexistent</td>
  </tr>
  <tr>
    <td><b>FAIL</b></td>
    <td>If / is nonexistent</td>
  </tr>
</table>
<h2 class="Ss" title="Ss" id="--directory_used"><a class="selflink" href="#--directory_used">--directory
  used</a></h2>
<table class="tbl">
  <colgroup>
    <col style="width: 19.00ex;"/>
    <col style="width: 40.00ex;"/>
  </colgroup>
  <tr>
    <td>Transition</td>
    <td></td>
  </tr>
  <tr>
    <td>(Host &#x2192; Chroot)</td>
    <td>Comment</td>
  </tr>
  <tr>
    <td colspan="0"></td>
  </tr>
  <tr>
    <td>CWD &#x2192; DIR</td>
    <td>Normal behaviour</td>
  </tr>
  <tr>
    <td><b>FAIL</b></td>
    <td>If DIR is nonexistent</td>
  </tr>
</table>
<div class="Pp"></div>
No fallbacks should exist under any circumstances.
<h2 class="Ss" title="Ss" id="Debugging"><a class="selflink" href="#Debugging">Debugging</a></h2>
Note that <i>--debug=notice</i> will show the internal fallback list computed
  for the session.
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<pre>
$  <b>dchroot-dsa -l</b>&#x21B5;
Available chroots: sarge, sid
<div class="Pp"></div>
$  <b>dchroot-dsa --listpaths</b>&#x21B5;
/srv/chroot/sarge
/srv/chroot/sid
<div class="Pp"></div>
$  <b>dchroot-dsa -q sid -- /bin/uname</b>&#x21B5;
Linux
<div class="Pp"></div>
$  <b>dchroot-dsa sid</b>&#x21B5;
I: [sid chroot] Running login shell: &#x201C;/bin/bash&#x201D;
$
</pre>
<div class="Pp"></div>
Note that the top line was echoed to standard error, and the remaining lines to
  standard output. This is intentional, so that program output from commands run
  in the chroot may be piped and redirected as required; the data will be the
  same as if the command was run directly on the host system.
<h1 class="Sh" title="Sh" id="TROUBLESHOOTING"><a class="selflink" href="#TROUBLESHOOTING">TROUBLESHOOTING</a></h1>
If something is not working, and it's not clear from the error messages what is
  wrong, try using the <b>--debug=</b><i>level</i> option to turn on debugging
  messages. This gives a great deal more information. Valid debug levels are
  &#x2018;none&#x2019;, and &#x2018;notice&#x2019;, &#x2018;info&#x2019;,
  &#x2018;warning&#x2019; and &#x2018;critical&#x2019; in order of increasing
  severity. The lower the severity level, the more output.
<div class="Pp"></div>
If you are still having trouble, the developers may be contacted on the mailing
  list:
<div>&#x00A0;</div>
Debian&#x00A0;buildd-tools&#x00A0;Developers
<div>&#x00A0;</div>
&lt;buildd-tools-devel@lists.alioth.debian.org&gt;
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
On the <b>mips</b> and <b>mipsel</b> architectures, Linux kernels up to and
  including at least version 2.6.17 have broken <b>personality</b>(2) support,
  which results in a failure to set the personality. This will be seen as an
  &#x201C;Operation not permitted&#x201D; (EPERM) error. To work around this
  problem, set <i>personality</i> to &#x2018;undefined&#x2019;, or upgrade to a
  more recent kernel.
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b><i>/etc/schroot/schroot.conf</i></b></dt>
  <dd class="It-tag">The system-wide <b>schroot</b> definition file. This file
      must be owned by the root user, and not be writable by other.</dd>
</dl>
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
Roger Leigh.
<div class="Pp"></div>
This implementation of dchroot-dsa uses the same command-line options as the
  <b>dchroot</b> found on machines run by the Debian System Administrators for
  the Debian Project. These machines have a <b>dchroot-dsa</b> source package
  which provides a <b>dchroot-dsa</b> package, written by Ben Collins
  &lt;bcollins@debian.org&gt; and Martin Schulze &lt;joey@debian.org&gt;.
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
Copyright &#x00A9; 2005-2012 Roger Leigh &lt;rleigh@debian.org&gt;
<div class="Pp"></div>
<b>dchroot-dsa</b> is free software: you can redistribute it and/or modify it
  under the terms of the GNU General Public License as published by the Free
  Software Foundation, either version 3 of the License, or (at your option) any
  later version.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>schroot</b>(1), <b>sbuild</b>(1), <b>chroot</b>(2), <b>schroot-setup</b>(5),
  <b>schroot.conf</b>(5).</div>
<table class="foot">
  <tr>
    <td class="foot-date">05 May 2014</td>
    <td class="foot-os">Version 1.6.10</td>
  </tr>
</table>
</body>
</html>
