<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>USBGUARD(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">USBGUARD(1)</td>
    <td class="head-vol"></td>
    <td class="head-rtitle">USBGUARD(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<b>usbguard</b> -- USBGuard command-line interface
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
usbguard&#x00A0;[
  <i>OPTIONS</i>]&#x00A0;<i>command</i>&#x00A0;[<i>COMMAND-OPTIONS</i>]&#x00A0;...
<div class="Pp"></div>
usbguard&#x00A0; <b>list-devices</b>
<div class="Pp"></div>
usbguard&#x00A0; <b>allow-device</b>&#x00A0;&lt;<i>id</i>&gt;
<div class="Pp"></div>
usbguard&#x00A0; <b>block-device</b>&#x00A0;&lt;<i>id</i>&gt;
<div class="Pp"></div>
usbguard&#x00A0; <b>reject-device</b>&#x00A0;&lt;<i>id</i>&gt;
<div class="Pp"></div>
usbguard&#x00A0; <b>list-rules</b>
<div class="Pp"></div>
usbguard&#x00A0; <b>append-rule</b>&#x00A0;&lt;<i>rule</i>&gt;
<div class="Pp"></div>
usbguard&#x00A0; <b>remove-rule</b>&#x00A0;&lt;<i>id</i>&gt;
<div class="Pp"></div>
usbguard&#x00A0; <b>generate-policy</b>
<div class="Pp"></div>
usbguard&#x00A0; <b>watch</b>
<div class="Pp"></div>
usbguard <b>read-descriptor</b> &lt;<i>file</i>&gt;
<div class="Pp"></div>
usbguard <b>add-user</b> &lt;<i>name</i>&gt;
<div class="Pp"></div>
usbguard <b>remove-user</b> &lt;<i>name</i>&gt;
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <b>usbguard</b> command provides a command-line interface (CLI) to the
  <b>usbguard-daemon</b>(8) instance and provides a tool for generating initial
  USBGuard policies.
<h1 class="Sh" title="Sh" id="SUBCOMMANDS"><a class="selflink" href="#SUBCOMMANDS">SUBCOMMANDS</a></h1>
<b>list-devices</b>
<div class="Pp"></div>
List all USB devices recognized by the USBGuard daemon.
<div class="Pp"></div>
Available options:
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-a</b>, <b>--allowed</b></b></dt>
  <dd class="It-tag">List allowed devices.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-b</b>, <b>--blocked</b></b></dt>
  <dd class="It-tag">List blocked devices.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-h</b>, <b>--help</b></b></dt>
  <dd class="It-tag">Show help.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
~ ~ ~
<div style="margin-left: 5.00ex;"></div>
<div class="Pp"></div>
<b>allow-device</b> [<i>OPTIONS</i>] &lt;<i>id</i>&gt;
<div class="Pp"></div>
Authorize a device identified by the device <i>id</i> to interact with the
  system.
<div class="Pp"></div>
Available options:
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-p</b>, <b>--permanent</b></b></dt>
  <dd class="It-tag">Make the decision permanent. A device specific allow rule
      will be appended to the current policy.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-h</b>, <b>--help</b></b></dt>
  <dd class="It-tag">Show help.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
~ ~ ~
<div style="margin-left: 5.00ex;"></div>
<div class="Pp"></div>
<b>block-device</b> [<i>OPTIONS</i>] &lt;<i>id</i>&gt;
<div class="Pp"></div>
Deauthorize a device identified by the device <i>id</i>.
<div class="Pp"></div>
Available options:
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-p</b>, <b>--permanent</b></b></dt>
  <dd class="It-tag">Make the decision permanent. A device specific block rule
      will be appended to the current policy.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-h</b>, <b>--help</b></b></dt>
  <dd class="It-tag">Show help.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
~ ~ ~
<div style="margin-left: 5.00ex;"></div>
<div class="Pp"></div>
<b>reject-device</b> [<i>OPTIONS</i>] &lt;<i>id</i>&gt;
<div class="Pp"></div>
Deauthorize and remove a device identified by the device <i>id</i>.
<div class="Pp"></div>
Available options:
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-p</b>, <b>--permanent</b></b></dt>
  <dd class="It-tag">Make the decision permanent. A device specific reject rule
      will be appended to the current policy.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-h</b>, <b>--help</b></b></dt>
  <dd class="It-tag">Show help.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
~ ~ ~
<div style="margin-left: 5.00ex;"></div>
<div class="Pp"></div>
<b>list-rules</b> [<i>OPTIONS</i>]
<div class="Pp"></div>
List the rule set (policy) used by the USBGuard daemon.
<div class="Pp"></div>
Available options:
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-h</b>, <b>--help</b></b></dt>
  <dd class="It-tag">Show help.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
~ ~ ~
<div style="margin-left: 5.00ex;"></div>
<div class="Pp"></div>
<b>append-rule</b> [<i>OPTIONS</i>] &lt;<i>rule</i>&gt;
<div class="Pp"></div>
Append the <i>rule</i> to the current rule set.
<div class="Pp"></div>
Available options:
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-a</b>, <b>--after</b> &lt;<i>id</i>&gt;</b></dt>
  <dd class="It-tag">Append the new rule after a rule with the specified rule
      <i>id</i>.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-h</b>, <b>--help</b></b></dt>
  <dd class="It-tag">Show help.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
~ ~ ~
<div style="margin-left: 5.00ex;"></div>
<div class="Pp"></div>
<b>remove-rule</b> [<i>OPTIONS</i>] &lt;<i>id</i>&gt;
<div class="Pp"></div>
Remove a rule identified by the rule <i>id</i> from the rule set.
<div class="Pp"></div>
Available options:
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-h</b>, <b>--help</b></b></dt>
  <dd class="It-tag">Show help.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
~ ~ ~
<div style="margin-left: 5.00ex;"></div>
<div class="Pp"></div>
<b>generate-policy</b> [<i>OPTIONS</i>]
<div class="Pp"></div>
Generate a rule set (policy) which authorizes the currently connected USB
  devices.
<div class="Pp"></div>
Available options:
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-p</b>, <b>--with-ports</b></b></dt>
  <dd class="It-tag">Generate port specific rules for all devices. By default,
      port specific rules are generated only for devices which do not export an
      iSerial value.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-P</b>, <b>--no-ports-sn</b></b></dt>
  <dd class="It-tag">Don't generate port specific rules for devices without an
      iSerial value. Without this option, the tool will add a via-port attribute
      to any device that doesn't provide a serial number. This is a security
      measure to limit devices that cannot be uniquely identified to connect
      only via a specific port. This makes it harder to bypass the policy since
      the real device will occupy the allowed USB port most of the time.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-t</b>, <b>--target</b>
    &lt;<i>target</i>&gt;</b></dt>
  <dd class="It-tag">Generate an explicit &quot;catch all&quot; rule with the
      specified target. The target can be one of the following values:
      <b>allow</b>, <b>block</b>, <b>reject</b></dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-X</b>, <b>--no-hashes</b></b></dt>
  <dd class="It-tag">Don't generate a hash attribute for each device.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-H</b>, <b>--hash-only</b></b></dt>
  <dd class="It-tag">Generate a hash-only policy.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-h</b>, <b>--help</b></b></dt>
  <dd class="It-tag">Show help.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
~ ~ ~
<div style="margin-left: 5.00ex;"></div>
<div class="Pp"></div>
<b>watch</b> [<i>OPTIONS</i>]
<div class="Pp"></div>
Watch the IPC interface events and print them to stdout.
<div class="Pp"></div>
Available options:
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-h</b>, <b>--help</b></b></dt>
  <dd class="It-tag">Show help.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
~ ~ ~
<div style="margin-left: 5.00ex;"></div>
<div class="Pp"></div>
<b>read-descriptor</b> [<i>OPTIONS</i>] &lt;<i>file</i>&gt;
<div class="Pp"></div>
Read a USB descriptor from a file and print it in human-readable form.
<div class="Pp"></div>
Available options:
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-h</b>, <b>--help</b></b></dt>
  <dd class="It-tag">Show help.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
~ ~ ~
<div style="margin-left: 5.00ex;"></div>
<div class="Pp"></div>
<b>add-user</b> &lt;<i>name</i>&gt; [<i>OPTIONS</i>]
<div class="Pp"></div>
Create an IPC access control file allowing the user/group identified by
  <i>name</i> to use the USBGuard IPC bus. The change takes effect only after
  restarting the <b>usbguard-daemon</b>(8) instance.
<div class="Pp"></div>
Available options:
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-u</b>, <b>--user</b></b></dt>
  <dd class="It-tag">The specified <i>name</i> represents a username or UID
      (default).</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-g</b>, <b>--group</b></b></dt>
  <dd class="It-tag">The specified <i>name</i> represents a groupname or
    GID.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-p</b>, <b>--policy</b>
    &lt;<i>privileges</i>&gt;</b></dt>
  <dd class="It-tag">Policy related privileges.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-d</b>, <b>--devices</b>
    &lt;<i>privileges</i>&gt;</b></dt>
  <dd class="It-tag">Device related privileges.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-e</b>, <b>--exceptions</b>
    &lt;<i>privileges</i>&gt;</b></dt>
  <dd class="It-tag">Exceptions related privileges.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-P</b>, <b>--parameters</b>
    &lt;<i>privileges</i>&gt;</b></dt>
  <dd class="It-tag">Run-time parameter related privileges.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-h</b>, <b>--help</b></b></dt>
  <dd class="It-tag">Show help.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<div class="Pp"></div>
Privileges:
<div class="Pp"></div>
When specifying <i>privileges</i>, they are expected to be in the form of a list
  separated by a colon:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">
    <pre>
&#x00A0;&#x00A0;&#x00A0;&#x00A0;$&#x00A0;sudo&#x00A0;usbguard&#x00A0;add-user&#x00A0;joe&#x00A0;--devices=listen,modify
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Consult the <b>usbguard-daemon.conf</b>(5) man-page for
    a detailed list of available privileges in each section.</b></dt>
  <dd class="It-tag">~ ~ ~</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<div class="Pp"></div>
<b>remove-user</b> &lt;<i>name</i>&gt; [<i>OPTIONS</i>]
<div class="Pp"></div>
Remove an IPC access control file associated with the user/group identified by
  <i>name</i>. The change takes effect only after restarting the
  <b>usbguard-daemon</b>(8) instance.
<div class="Pp"></div>
Available options:
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-u</b>, <b>--user</b></b></dt>
  <dd class="It-tag">The specified <i>name</i> represents a username or UID
      (default).</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-g</b>, <b>--group</b></b></dt>
  <dd class="It-tag">The specified <i>name</i> represents a groupname or
    GID.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>-h</b>, <b>--help</b></b></dt>
  <dd class="It-tag">Show help.</dd>
</dl>
<div style="margin-left: 5.00ex;"></div>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<b>Creating an initial policy</b>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">
    <pre>
&#x00A0;&#x00A0;&#x00A0;&#x00A0;$&#x00A0;sudo&#x00A0;usbguard&#x00A0;generate-policy&#x00A0;&gt;&#x00A0;rules.conf
&#x00A0;&#x00A0;&#x00A0;&#x00A0;$&#x00A0;vi&#x00A0;rules.conf
&#x00A0;&#x00A0;&#x00A0;&#x00A0;(review/modify&#x00A0;the&#x00A0;rule&#x00A0;set)
&#x00A0;&#x00A0;&#x00A0;&#x00A0;$&#x00A0;sudo&#x00A0;install&#x00A0;-m&#x00A0;0600&#x00A0;-o&#x00A0;root&#x00A0;-g&#x00A0;root&#x00A0;\
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;rules.conf&#x00A0;/etc/usbguard/rules.conf
    </pre>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
If you find a bug in this software or if you'd like to request a feature to be
  implemented, please file a ticket at
  &lt;https://github.com/dkopecek/usbguard/issues/new&gt;.
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
Copyright &#x00A9; 2017 Red Hat, Inc. License GPLv2+: GNU GPL version 2 or later
  &lt;http://gnu.org/licenses/gpl.html&gt;. This is free software: you are free
  to change and redistribute it. There is NO WARRANTY, to the extent permitted
  by law.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>usbguard-rules.conf</b>(5), <b>usbguard-daemon</b>(8),
  <b>usbguard-daemon.conf</b>(5)
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
Daniel Kope&#x010D;ek &lt;dkopecek@redhat.com&gt;.</div>
<table class="foot">
  <tr>
    <td class="foot-date">April 2017</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
