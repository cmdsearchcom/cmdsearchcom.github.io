<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>RT-SERIALIZER(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">RT-SERIALIZER(1)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">RT-SERIALIZER(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
rt-serializer - Serialize an RT database to disk
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>
    rt-validator --check &amp;&amp; rt-serializer
</pre>
<div class="Pp"></div>
This script is used to write out the entire RT database to disk, for later
  import into a different RT instance. It requires that the data in the database
  be self-consistent, in order to do so; please make sure that the database
  being exported passes validation by rt-validator before attempting to use
  &quot;rt-serializer&quot;.
<div class="Pp"></div>
While running, it will attempt to estimate the number of remaining objects to be
  serialized; these estimates are pessimistic, and will be incorrect if
  &quot;--no-users&quot;, &quot;--no-groups&quot;, or &quot;--no-tickets&quot;
  are used.
<div class="Pp"></div>
If the controlling terminal is large enough (more than 25 columns high) and the
  &quot;gnuplot&quot; program is installed, it will also show a textual graph of
  the queue size over time.
<h2 class="Ss" title="Ss" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--directory</b> <i>name</i></dt>
  <dd class="It-tag">The name of the output directory to write data files to,
      which should not exist yet; it is a fatal error if it does. Defaults to
      &quot;./ <i>$Organization</i>:<i>Date</i>/&quot;, where
      <i></i><i>$Organization</i> <i></i> is as set in <i>RT_SiteConfig.pm</i>,
      and <i>Date</i> is today's date.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--force</b></dt>
  <dd class="It-tag">Remove the output directory before starting.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--size</b> <i>megabytes</i></dt>
  <dd class="It-tag">By default, &quot;rt-serializer&quot; chunks its output
      into data files which are around 32Mb in size; this option is used to set
      a different threshold size, in megabytes. Note that this is the threshold
      after which it rotates to writing a new file, and is as such the <i>lower
      bound</i> on the size of each output file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--no-users</b></dt>
  <dd class="It-tag">By default, all privileged users are serialized; passing
      &quot;--no-users&quot; limits it to only those users which are referenced
      by serialized tickets and history, and are thus necessary for internal
      consistency.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--no-groups</b></dt>
  <dd class="It-tag">By default, all groups are serialized; passing
      &quot;--no-groups&quot; limits it to only system-internal groups, which
      are needed for internal consistency.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--no-deleted</b></dt>
  <dd class="It-tag">By default, all tickets, including deleted tickets, are
      serialized; passing &quot;--no-deleted&quot; skips deleted tickets during
      serialization.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--scrips</b></dt>
  <dd class="It-tag">No scrips or templates are serialized by default; this
      option forces all scrips and templates to be serialized.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--acls</b></dt>
  <dd class="It-tag">No ACLs are serialized by default; this option forces all
      ACLs to be serialized.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--no-tickets</b></dt>
  <dd class="It-tag">Skip serialization of all ticket data.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--clone</b></dt>
  <dd class="It-tag">Serializes your entire database, creating a clone. This
      option should be used if you want to migrate your RT database from one
      database type to another (e.g. MySQL to Postgres). It is an error to
      combine &quot;--clone&quot; with any option that limits object types
      serialized. No dependency walking is performed when cloning.
      &quot;rt-importer&quot; will detect that your serialized data set was
      generated by a clone.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--incremental</b></dt>
  <dd class="It-tag">Will generate an incremenal serialized dataset using the
      data stored in your IncrementalRecords database table. This assumes that
      you have created that table and run RT using the Record_Local.pm shim as
      documented in &quot;docs/incremental-export/&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--gc</b> <i>n</i></dt>
  <dd class="It-tag">Adjust how often the garbage collection sweep is done;
      lower numbers are more frequent. See &quot;GARBAGE COLLECTION&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--page</b> <i>n</i></dt>
  <dd class="It-tag">Adjust how many rows are pulled from the database in a
      single query. Disable paging by setting this to 0. Defaults to 100.
    <div style="height: 1.00em;">&#x00A0;</div>
    Keep in mind that rows from RT's Attachments table are the limiting factor
      when determining page size. You should likely be aiming for 60-75% of your
      total memory on an otherwise unloaded box.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--quiet</b></dt>
  <dd class="It-tag">Do not show graphical progress UI.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verbose</b></dt>
  <dd class="It-tag">Do not show graphical progress UI, but rather log was each
      row is written out.</dd>
</dl>
<h1 class="Sh" title="Sh" id="GARBAGE_COLLECTION"><a class="selflink" href="#GARBAGE_COLLECTION">GARBAGE
  COLLECTION</a></h1>
&quot;rt-serializer&quot; maintains a priority queue of objects to serialize, or
  searches which may result in objects to serialize. When inserting into this
  queue, it does no checking if the object in question is already in the queue,
  or if the search will contain any results. These checks are done when the
  object reaches the front of the queue, or during periodic garbage collection.
<div class="Pp"></div>
During periodic garbage collection, the entire queue is swept for objects which
  have already been serialized, occur more than once in the queue, and searches
  which contain no results in the database. This is done to reduce the memory
  footprint of the serialization process, and is triggered when enough new
  objects have been placed in the queue. This parameter is tunable via the
  &quot;--gc&quot; parameter, which defaults to running garbage collection every
  5,000 objects inserted into the queue; smaller numbers will result in more
  frequent garbage collection.
<div class="Pp"></div>
The default of 5,000 is roughly tuned based on a database with several thousand
  tickets, but optimal values will vary wildly depending on database
  configuration and size. Values as low as 25 have provided speedups with
  smaller databases; if speed is a factor, experimenting with different
  &quot;--gc&quot; values may be helpful. Note that there are significant
  boundary condition changes in serialization rate, as the queue empties and
  fills, causing the time estimates to be rather imprecise near the start and
  end of the process.
<div class="Pp"></div>
Setting &quot;--gc&quot; to 0 turns off all garbage collection. Be aware that
  this will bloat the memory usage of the serializer. Any negative value for
  &quot;--gc&quot; turns off periodic garbage collection and instead objects
  already serialized or in the queue are checked for at the time they would be
  inserted.</div>
<table class="foot">
  <tr>
    <td class="foot-date">2017-07-26</td>
    <td class="foot-os">perl v5.24.2</td>
  </tr>
</table>
</body>
</html>
