<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:39:02 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>SSLDUMP(1) General Commands Manual SSLDUMP(1)</p>

<p style="margin-top: 1em">NAME <br>
ssldump - dump SSL traffic on a network</p>

<p style="margin-top: 1em">SYNOPSIS <br>
ssldump [ -vTshVq -aAdeHnNqTxXvy ] [ -i interface ] <br>
[ -k keyfile ] [ -p password ] [ -r dumpfile ] <br>
[ -S [crypto|d|ht|H|nroff] ] [ expression ]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
ssldump is an SSL/TLS network protocol analyzer. It
identifies TCP connections on the chosen network interface
and attempts to interpret them as SSL/TLS traffic. When it
identi&acirc; <br>
fies SSL/TLS traffic, it decodes the records and displays
them in a textual form to stdout. If provided with the
appropriate keying material, it will also decrypt the
connections <br>
and display the application data traffic.</p>

<p style="margin-top: 1em">ssldump has been tested on
FreeBSD, Linux, Solaris, and HP/UX. Since it&rsquo;s based
on PCAP, it should work on most platforms. However, unlike
tcpdump, ssldump needs to be able to <br>
see both sides of the data transmission so you may have
trouble using it with network taps such as SunOS nit that
don&rsquo;t permit you to see transmitted data. Under SunOS
with nit <br>
or bpf: To run tcpdump you must have read access to /dev/nit
or /dev/bpf*. Under Solaris with dlpi: You must have read
access to the network pseudo device, e.g. /dev/le. Under
<br>
HP-UX with dlpi: You must be root or it must be installed
setuid to root. Under IRIX with snoop: You must be root or
it must be installed setuid to root. Under Linux: You must
<br>
be root or it must be installed setuid to root. Under Ultrix
and Digital UNIX: Once the super-user has enabled
promiscuous-mode operation using pfconfig(8), any user may
run <br>
ssldump Under BSD: You must have read access to
/dev/bpf*.</p>

<p style="margin-top: 1em">OPTIONS <br>
-a Print bare TCP ACKs (useful for observing Nagle
behavior)</p>

<p style="margin-top: 1em">-A Print all record fields (by
default ssldump chooses the most interesting fields)</p>

<p style="margin-top: 1em">-d Display the application data
traffic. This usually means decrypting it, but when -d is
used ssldump will also decode application data traffic
before the SSL session initi&acirc; <br>
ates. This allows you to see HTTPS CONNECT behavior as well
as SMTP STARTTLS. As a side effect, since ssldump
can&rsquo;t tell whether plaintext is traffic before the
initia&acirc; <br>
tion of an SSL connection or just a regular TCP connection,
this allows you to use ssldump to sniff any TCP connection.
ssldump will automatically detect ASCII data and <br>
display it directly to the screen. non-ASCII data is
displayed as hex dumps. See also -X.</p>

<p style="margin-top: 1em">-e Print absolute timestamps
instead of relative timestamps</p>

<p style="margin-top: 1em">-H Print the full SSL packet
header.</p>

<p style="margin-top: 1em">-n Don&rsquo;t try to resolve
host names from IP addresses</p>

<p style="margin-top: 1em">-N Attempt to parse ASN.1 when
it appears, such as in certificates and DNs.</p>

<p style="margin-top: 1em">-p Use password as the SSL
keyfile password.</p>

<p style="margin-top: 1em">-P Don&rsquo;t put the interface
into promiscuous mode.</p>

<p style="margin-top: 1em">-q Don&rsquo;t decode any record
fields beyond a single summary line. (quiet mode).</p>

<p style="margin-top: 1em">-T Print the TCP headers.</p>

<p style="margin-top: 1em">-v Display version and copyright
information.</p>

<p style="margin-top: 1em">-x Print each record in hex, as
well as decoding it.</p>

<p style="margin-top: 1em">-X When the -d option is used,
binary data is automatically printed in two columns with a
hex dump on the left and the printable characters on the
right. -X suppresses the <br>
display of the printable characters, thus making it easier
to cut and paste the hex data into some other program.</p>

<p style="margin-top: 1em">-y Decorate the output for
processing with nroff/troff. Not very useful for the average
user.</p>

<p style="margin-top: 1em">-i interface <br>
Use interface as the network interface on which to sniff
SSL/TLS traffic.</p>

<p style="margin-top: 1em">-k keyfile <br>
Use keyfile as the location of the SSL keyfile (OpenSSL
format) Previous versions of ssldump automatically looked in
./server.pem. Now you must specify your keyfile every <br>
time.</p>

<p style="margin-top: 1em">-p password <br>
Use password as the SSL keyfile password.</p>

<p style="margin-top: 1em">-r file <br>
Read data from file instead of from the network. The old -f
option still works but is deprecated and will probably be
removed with the next version.</p>

<p style="margin-top: 1em">-S [ crypto | d | ht | H ] <br>
Specify SSL flags to ssldump. These flags include:</p>

<p style="margin-top: 1em">crypto Print cryptographic
information.</p>

<p style="margin-top: 1em">d Print fields as decoded.</p>

<p style="margin-top: 1em">ht Print the handshake type.</p>

<p style="margin-top: 1em">H Print handshake type and
highlights.</p>

<p style="margin-top: 1em">expression <br>
Selects what packets ssldump will examine. Technically
speaking, ssldump supports the full expression syntax from
PCAP and tcpdump. In fact, the description here is <br>
cribbed from the tcpdump man page. However, since ssldump
needs to examine full TCP streams, most of the tcpdump
expressions will select traffic mixes that ssldump will <br>
simply ignore. Only the expressions which don&rsquo;t result
in incomplete TCP streams are listed here.</p>

<p style="margin-top: 1em">The expression consists of one
or more primitives. Primitives usually consist of an id
(name or number) preceded by one or more qualifiers. There
are three different <br>
kinds of qualifier:</p>

<p style="margin-top: 1em">type qualifiers say what kind of
thing the id name or number refers to. Possible types are
host, net and port. E.g., &lsquo;host foo&rsquo;, &lsquo;net
128.3&rsquo;, &lsquo;port 20&rsquo;. If there is <br>
no type qualifier, host is assumed.</p>

<p style="margin-top: 1em">dir qualifiers specify a
particular transfer direction to and/or from id. Possible
directions are src, dst, src or dst and src and dst. E.g.,
&lsquo;src foo&rsquo;, &lsquo;dst net <br>
128.3&rsquo;, &lsquo;src or dst port ftp-data&rsquo;. If
there is no dir qualifier, src or dst is assumed. For
&lsquo;null&rsquo; link layers (i.e. point to point
protocols such as slip) the <br>
inbound and outbound qualifiers can be used to specify a
desired direction.</p>

<p style="margin-top: 1em">More complex filter expressions
are built up by using the words and, or and not to combine
primitives. E.g., &lsquo;host foo and not port ftp and not
port ftp-data&rsquo;. To save <br>
typing, identical qualifier lists can be omitted. E.g.,
&lsquo;tcp dst port ftp or ftp-data or domain&rsquo; is
exactly the same as &lsquo;tcp dst port ftp or tcp dst port
ftp-data or tcp <br>
dst port domain&rsquo;.</p>

<p style="margin-top: 1em">Allowable primitives are:</p>

<p style="margin-top: 1em">dst host host <br>
True if the IPv4/v6 destination field of the packet is host,
which may be either an address or a name.</p>

<p style="margin-top: 1em">src host host <br>
True if the IPv4/v6 source field of the packet is host.</p>

<p style="margin-top: 1em">host host <br>
True if either the IPv4/v6 source or destination of the
packet is host. Any of the above host expressions can be
prepended with the keywords, ip, arp, rarp, or ip6 <br>
as in: <br>
ip host host <br>
which is equivalent to: <br>
ether proto ip and host host <br>
If host is a name with multiple IP addresses, each address
will be checked for a match.</p>

<p style="margin-top: 1em">ether dst ehost <br>
True if the ethernet destination address is ehost. Ehost may
be either a name from /etc/ethers or a number (see
ethers(3N) for numeric format).</p>

<p style="margin-top: 1em">ether src ehost <br>
True if the ethernet source address is ehost.</p>

<p style="margin-top: 1em">ether host ehost <br>
True if either the ethernet source or destination address is
ehost.</p>

<p style="margin-top: 1em">gateway host <br>
True if the packet used host as a gateway. I.e., the
ethernet source or destination address was host but neither
the IP source nor the IP destination was host. <br>
Host must be a name and must be found in both /etc/hosts and
/etc/ethers. (An equivalent expression is <br>
ether host ehost and not host host <br>
which can be used with either names or numbers for host /
ehost.) This syntax does not work in IPv6-enabled
configuration at this moment.</p>

<p style="margin-top: 1em">dst net net <br>
True if the IPv4/v6 destination address of the packet has a
network number of net. Net may be either a name from
/etc/networks or a network number (see networks(4) <br>
for details).</p>

<p style="margin-top: 1em">src net net <br>
True if the IPv4/v6 source address of the packet has a
network number of net.</p>

<p style="margin-top: 1em">net net <br>
True if either the IPv4/v6 source or destination address of
the packet has a network number of net.</p>

<p style="margin-top: 1em">net net mask mask <br>
True if the IP address matches net with the specific
netmask. May be qualified with src or dst. Note that this
syntax is not valid for IPv6 net.</p>

<p style="margin-top: 1em">net net/len <br>
True if the IPv4/v6 address matches net a netmask len bits
wide. May be qualified with src or dst.</p>

<p style="margin-top: 1em">dst port port <br>
True if the packet is ip/tcp, ip/udp, ip6/tcp or ip6/udp and
has a destination port value of port. The port can be a
number or a name used in /etc/services (see <br>
tcp(4P) and udp(4P)). If a name is used, both the port
number and protocol are checked. If a number or ambiguous
name is used, only the port number is checked <br>
(e.g., dst port 513 will print both tcp/login traffic and
udp/who traffic, and port domain will print both tcp/domain
and udp/domain traffic).</p>

<p style="margin-top: 1em">src port port <br>
True if the packet has a source port value of port.</p>

<p style="margin-top: 1em">port port <br>
True if either the source or destination port of the packet
is port. Any of the above port expressions can be prepended
with the keywords, tcp or udp, as in: <br>
tcp src port port <br>
which matches only tcp packets whose source port is
port.</p>

<p style="margin-top: 1em">Primitives may be combined
using:</p>

<p style="margin-top: 1em">A parenthesized group of
primitives and operators (parentheses are special to the
Shell and must be escaped).</p>

<p style="margin-top: 1em">Negation (&lsquo;!&rsquo; or
&lsquo;not&rsquo;).</p>

<p style="margin-top: 1em">Concatenation
(&lsquo;&amp;&amp;&rsquo; or &lsquo;and&rsquo;).</p>

<p style="margin-top: 1em">Alternation (&lsquo;||&rsquo; or
&lsquo;or&rsquo;).</p>

<p style="margin-top: 1em">Negation has highest precedence.
Alternation and concatenation have equal precedence and
associate left to right. Note that explicit and tokens, not
juxtaposition, are <br>
now required for concatenation.</p>

<p style="margin-top: 1em">If an identifier is given
without a keyword, the most recent keyword is assumed. For
example, <br>
not host vs and ace <br>
is short for <br>
not host vs and host ace <br>
which should not be confused with <br>
not ( host vs or ace )</p>

<p style="margin-top: 1em">Expression arguments can be
passed to ssldump as either a single argument or as multiple
arguments, whichever is more convenient. Generally, if the
expression contains <br>
Shell metacharacters, it is easier to pass it as a single,
quoted argument. Multiple arguments are concatenated with
spaces before being parsed.</p>

<p style="margin-top: 1em">EXAMPLES <br>
To listen to traffic on interface le0 port 443 <br>
ssldump -i le0 port 443</p>

<p style="margin-top: 1em">To listen to traffic to the
server romeo on port 443. <br>
ssldump -i le0 port 443 and host romeo</p>

<p style="margin-top: 1em">To decrypt traffic to to host
romeo server.pem and the password foobar <br>
ssldump -Ad -k ~/server.pem -p foobar -i le0 host romeo</p>

<p style="margin-top: 1em">OUTPUT FORMAT <br>
All output is printed to standard out.</p>

<p style="margin-top: 1em">ssldump prints an indication of
every new TCP connection using a line like the following</p>

<p style="margin-top: 1em">New TCP connection #2:
iromeo.rtfm.com(2302) &lt;-&gt; sr1.rtfm.com(4433)</p>

<p style="margin-top: 1em">The host which send the first
SYN is printed on the left and the host which responded is
printed on the right. Ordinarily, this means that the SSL
client will be printed on the <br>
left with the SSL server on the right. In this case we have
a connection from iromeo.rtfm.com (port 2303) to
sr1.rtfm.com (port 4433). To allow the user to disentangle
traffic <br>
from different connections, each connection is numbered.
This is connection 2.</p>

<p style="margin-top: 1em">The printout of each SSL record
begins with a record line. This line contains the connection
and record number, a timestamp, and the record type, as in
the following:</p>

<p style="margin-top: 1em">2 3 0.2001 (0.0749) S&gt;C
Handshake Certificate</p>

<p style="margin-top: 1em">This is record 3 on connection
2. The first timestamp is the time since the beginning of
the connection. The second is the time since the previous
record. Both are in seconds.</p>

<p style="margin-top: 1em">The next field in the record
line is the direction that the record was going. C&gt;S
indicates records transmitted from client to server and
S&gt;C indicates records transmitted from <br>
server to client. ssldump assumes that the host to transmit
the first SYN is the SSL client (this is nearly always
correct).</p>

<p style="margin-top: 1em">The next field is the record
type, one of Handshake, IAlert, ChangeCipherSpec, or
application_data. Finally, ssldump may print record-specific
data on the rest of the line. For <br>
Handshake records, it prints the handshake message. Thus,
this record is a Certificate message.</p>

<p style="margin-top: 1em">ssldump chooses certain record
types for further decoding. These are the ones that have
proven to be most useful for debugging:</p>

<p style="margin-top: 1em">ClientHello - version, offered
cipher suites, session id <br>
if provided) <br>
ServerHello - version, session_id, chosen cipher suite, <br>
compression method <br>
Alert - type and level (if obtainable)</p>

<p style="margin-top: 1em">Fuller decoding of the various
records can be obtained by using the -A , -d , -k and -p
flags.</p>

<p style="margin-top: 1em">DECRYPTION <br>
ssldump can decrypt traffic between two hosts if the
following two conditions are met: <br>
1. ssldump has the keys. <br>
2. Static RSA was used. <br>
In any other case, once encryption starts, ssldump will only
be able to determine the record type. Consider the following
section of a trace.</p>

<p style="margin-top: 1em">1 5 0.4129 (0.1983) C&gt;S
Handshake ClientKeyExchange <br>
1 6 0.4129 (0.0000) C&gt;S ChangeCipherSpec <br>
1 7 0.4129 (0.0000) C&gt;S Handshake <br>
1 8 0.5585 (0.1456) S&gt;C ChangeCipherSpec <br>
1 9 0.6135 (0.0550) S&gt;C Handshake <br>
1 10 2.3121 (1.6986) C&gt;S application_data <br>
1 11 2.5336 (0.2214) C&gt;S application_data <br>
1 12 2.5545 (0.0209) S&gt;C application_data <br>
1 13 2.5592 (0.0046) S&gt;C application_data <br>
1 14 2.5592 (0.0000) S&gt;C Alert</p>

<p style="margin-top: 1em">Note that the ClientKeyExchange
message type is printed but the rest of the Handshake
messages do not have types. These are the Finished messages,
but because they are encrypted <br>
ssldump only knows that they are of type Handshake.
Similarly, had the Alert in record 14 happened during the
handshake, it&rsquo;s type and level would have been
printed. However, <br>
since it is encrypted we can only tell that it is an
alert.</p>

<p style="margin-top: 1em">BUGS <br>
Please send bug reports to ssldump@rtfm.com.</p>

<p style="margin-top: 1em">The TCP reassembler is not
perfect. No attempt is made to reassemble IP fragments and
the 3-way handshake and close handshake are imperfectly
implemented. In practice, this turns <br>
out not to be much of a problem.</p>

<p style="margin-top: 1em">Support is provided for only for
Ethernet and loopback interfaces because that&rsquo;s all
that I have. If you have another kind of network you will
need to modify pcap_cb in <br>
base/pcap-snoop.c. If you have direct experience with
ssldump on other networks, please send me patches.</p>

<p style="margin-top: 1em">ssldump doesn&rsquo;t implement
session caching and therefore can&rsquo;t decrypt resumed
sessions.</p>

<p style="margin-top: 1em">SEE ALSO <br>
tcpdump(1)</p>

<p style="margin-top: 1em">AUTHOR <br>
ssldump was written by Eric Rescorla
&lt;ekr@rtfm.com&gt;.</p>

<p style="margin-top: 1em">28 September 2001 SSLDUMP(1)</p>
<hr>
</body>
</html>
