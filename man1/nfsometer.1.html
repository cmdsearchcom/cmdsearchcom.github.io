<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:27:13 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>man(1) General Commands Manual man(1)</p>

<p style="margin-top: 1em">NAME <br>
nfsometer - NFS performance measurement tool</p>

<p style="margin-top: 1em">SYNOPSIS <br>
nfsometer [options] [mode] [[&lt;server:path&gt;]
[workloads...]]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
nfsometer is a performance measurement framework for running
workloads and reporting results across NFS protocol
versions, NFS options and Linux NFS client
implementations</p>

<p style="margin-top: 1em">MODES <br>
Basic usage (no mode specified):</p>

<p style="margin-top: 1em">nfsometer &lt;server:path&gt;
[workloads...]</p>

<p style="margin-top: 1em">This will fetch needed files,
run traces, and generate reports, <br>
same as running the the &rsquo;fetch&rsquo;,
&rsquo;trace&rsquo; and &rsquo;report&rsquo; stages.</p>

<p style="margin-top: 1em">Advanced usage (specify
modes):</p>

<p style="margin-top: 1em">nfsometer list</p>

<p style="margin-top: 1em">List the contents of the results
directory.</p>

<p style="margin-top: 1em">nfsometer workloads</p>

<p style="margin-top: 1em">List available and unavailable
workloads.</p>

<p style="margin-top: 1em">nfsometer notes</p>

<p style="margin-top: 1em">Edit the notes file of the
results directory. These notes will <br>
be displayed in report headers.</p>

<p style="margin-top: 1em">nfsometer loadgen
&lt;server:path&gt; &lt;workload&gt;</p>

<p style="margin-top: 1em">Run in loadgen mode: don&rsquo;t
record any stats, just loop over <br>
&lt;workload&gt; against &lt;server:path&gt;. Only one -o
option is allowed. <br>
Use the -n option to run multuple instances of the loadgen
workload. <br>
When running more than one instance, the intial start times
are <br>
staggered.</p>

<p style="margin-top: 1em">nfsometer fetch
[workloads...]</p>

<p style="margin-top: 1em">Fetch all needed files for the
specified workload(s). If no <br>
workloads are specified, all workloads are fetched. <br>
Fetched files are only downloaded once and are cached for
<br>
future runs.</p>

<p style="margin-top: 1em">nfsometer trace
&lt;server:path&gt; [workloads...]</p>

<p style="margin-top: 1em">Run traces against
&lt;server:path&gt;. The traces run will be: <br>
(options + always options + tags) X (workloads) X (num runs)
<br>
This will only run traces that don&rsquo;t already exist in
the results <br>
directory.</p>

<p style="margin-top: 1em">nfsometer report</p>

<p style="margin-top: 1em">Generate all reports available
from the results directory.</p>

<p style="margin-top: 1em">nfsometer example</p>

<p style="margin-top: 1em">Show examples from man page</p>

<p style="margin-top: 1em">OPTIONS <br>
-r &lt;dir&gt;, --resultdir=&lt;dir&gt; <br>
The directory used to save results. default:
&rsquo;/home/dros/nfsometer_results&rsquo;</p>

<p style="margin-top: 1em">-o &lt;mount.nfs options&gt;,
--options=&lt;mount.nfs options&gt; <br>
Mount options to iterate through. This option may be used
multiple times. Each mount option must have a version
specified.</p>

<p style="margin-top: 1em">-a &lt;mount.nfs options&gt;,
--always-options=&lt;mount.nfs options&gt; <br>
Options added to every trace. This option may be used
multiple times.</p>

<p style="margin-top: 1em">-t &lt;tags&gt;,
--tag=&lt;tags&gt; <br>
Tag all new traces with &rsquo;tags&rsquo;. This option may
be used multiple times.</p>

<p style="margin-top: 1em">-n &lt;num runs&gt;,
--num-runs=&lt;num runs&gt; <br>
Number of runs for each trace of &lt;options&gt; X
&lt;tags&gt; X &lt;workloads&gt; default: 1</p>

<p style="margin-top: 1em">--serial-graphs <br>
Generate graphs inline while generating reports. Useful for
debugging graphing issues.</p>

<p style="margin-top: 1em">--rand <br>
Randomize the order of traces</p>

<p style="margin-top: 1em">-h, --help <br>
Show the help message</p>

<p style="margin-top: 1em">EXAMPLES <br>
Example 1: See what workloads are available</p>

<p style="margin-top: 1em">$ nfsometer workloads</p>

<p style="margin-top: 1em">This command lists available
workloads and will tell you why <br>
workloads are unavailable (if any exist).</p>

<p style="margin-top: 1em">Example 2: Compare cthon,
averaged over 3 runs, <br>
across nfs protocol versions</p>

<p style="margin-top: 1em">nfsometer -n 3 server:/export
cthon</p>

<p style="margin-top: 1em">This example uses the default
for -o: &quot;-o v3 -o v4 -o v4.1&quot;. <br>
To see the results, open results/index.html in a web
browser.</p>

<p style="margin-top: 1em">Example 3: Compare cthon,
averaged over 3 runs, <br>
between v3 and v4.0 only</p>

<p style="margin-top: 1em">nfsometer -n 3 -o v3 -o v4
server:/export cthon</p>

<p style="margin-top: 1em">This example specifies v3 and v4
only. <br>
To see the results, open results/index.html in a web
browser.</p>

<p style="margin-top: 1em">Example 4: Compare two kernels
running iozone workload, averaged <br>
over 2 runs, across all nfs protocol versions</p>

<p style="margin-top: 1em">nfsometer can compare two (or
more) kernel versions, but <br>
has no way of building, installing or booting new kernels.
<br>
It&rsquo;s up to the user to install new kernels. <br>
In order for these kernels to be differentiated,
&rsquo;uname -a&rsquo; <br>
must be different.</p>

<p style="margin-top: 1em">1) boot into kernel #1</p>

<p style="margin-top: 1em">2) nfsometer -n 2 server:/export
iozone</p>

<p style="margin-top: 1em">3) boot into kernel #2</p>

<p style="margin-top: 1em">4) nfsometer -n 2 server:/export
iozone</p>

<p style="margin-top: 1em">5) open results/index.html in a
web browser</p>

<p style="margin-top: 1em">To see the results, open
results/index.html in a web browser.</p>

<p style="margin-top: 1em">Example 5: Using tags</p>

<p style="margin-top: 1em">Tags (the -t option) can be used
to mark nfsometer runs as <br>
occurring with some configuration not captured by mount
options <br>
or detectable tags, such as different sysctl settings
(client side), <br>
different server side options, or different network
conditions.</p>

<p style="margin-top: 1em">1) set server value foo to
2.3</p>

<p style="margin-top: 1em">2) nfsometer -o v4 -o v4.1 -t
foo=2.3</p>

<p style="margin-top: 1em">3) set server value foo to
10</p>

<p style="margin-top: 1em">4) nfsometer -o v4 -o v4.1 -t
foo=10</p>

<p style="margin-top: 1em">What is passed to -t is entirely
up to the user - it will not be <br>
interpreted or checked by nfsometer at all, so be
careful!</p>

<p style="margin-top: 1em">To see the results, open
results/index.html in a web browser.</p>

<p style="margin-top: 1em">Example 6: Always options</p>

<p style="margin-top: 1em">The -o flag specifies distinct
option sets to run, but sometimes <br>
there are options that should be present in each. Instead of
<br>
writing each one out, you can use the -a option:</p>

<p style="margin-top: 1em">nfsometer -o v3 -o v4 -a
sec=krb5 server:/export iozone</p>

<p style="margin-top: 1em">this is equivalent to:</p>

<p style="margin-top: 1em">nfsometer -o v3,sec=krb5 -o
v4,sec=krb5 server:/export iozone</p>

<p style="margin-top: 1em">Example 7: Using the
&quot;custom&quot; workload</p>

<p style="margin-top: 1em">A main use case of nfsometer is
the &quot;custom&quot; workload - it allows <br>
the user to specify the command that nfsometer is to
run.</p>

<p style="margin-top: 1em">NOTE: the command&rsquo;s cwd
(current working directory) is the runroot <br>
created on the server.</p>

<p style="margin-top: 1em">export NFSOMETER_CMD=&quot;echo
foo &gt; bar&quot; <br>
export NFSOMETER_NAME=&quot;echo&quot; <br>
export NFSOMETER_DESC=&quot;Writes 4 bytes to a file&quot;
<br>
nfsometer server:/export custom</p>

<p style="margin-top: 1em">This will run 3 traces (v3, v4,
v4.1) against server:/export of <br>
the command: echo foo &gt; bar.</p>

<p style="margin-top: 1em">Example 8: Using the loadgen
mode</p>

<p style="margin-top: 1em">Loadgen runs several instances
of a workload without capturing <br>
traces. The idea is that you use several clients to generate
<br>
load, then another client to measure performance of a loaded
<br>
server. The &quot;real&quot; run of nfsometer (not loadgen)
should mark <br>
the traces using the -t option.</p>

<p style="margin-top: 1em">1) On client A, run the cthon
workload to get a baseline of <br>
a server without any load.</p>

<p style="margin-top: 1em">nfsometer trace server:/export
cthon</p>

<p style="margin-top: 1em">2) When that&rsquo;s done, start
loadgen on client B:</p>

<p style="margin-top: 1em">nfsometer -n 10 loadgen
server:/export dd_100m_1k</p>

<p style="margin-top: 1em">This runs 10 instances of
dd_100m_1k workload on server:/export. <br>
It can take several minutes to start in an attempt to
stagger <br>
all the workload instances.</p>

<p style="margin-top: 1em">3) once all instances are
started, run the &quot;real&quot; nfsometer <br>
trace on client A. Use the -t option to mark the traces <br>
as having run under load conditions:</p>

<p style="margin-top: 1em">nfsometer -t &quot;10_dd&quot;
trace server:/export cthon</p>

<p style="margin-top: 1em">4) Explain how the tests were
set up in the result notes. <br>
This should be run on client A (which has the traces:</p>

<p style="margin-top: 1em">nfsometer notes</p>

<p style="margin-top: 1em">5) Now generate the reports:</p>

<p style="margin-top: 1em">nfsometer report</p>

<p style="margin-top: 1em">Example 8: Long running
nfsometer trace</p>

<p style="margin-top: 1em">The nfsometer.py script
currently runs in the foreground. As <br>
such, it will be killed if the tty gets a hangup or the
connection <br>
to the client is closed.</p>

<p style="margin-top: 1em">For the time being, nfsometer
should be run in a screen <br>
session, or run with nohup and the output redirected to a
file.</p>

<p style="margin-top: 1em">1) screen -RD <br>
2) nfsometer -n 2 server:/export iozone <br>
3) close terminal window (or ^A^D) <br>
... <br>
4) reattach later with screen -RD <br>
5) once nfsometer.py is done, results will be in
results/index.html</p>

<p style="margin-top: 1em">SEE ALSO <br>
mountstats, nfsstats</p>

<p style="margin-top: 1em">BUGS <br>
No known bugs.</p>

<p style="margin-top: 1em">AUTHOR <br>
Weston Andros Adamson (dros@netapp.com)</p>

<p style="margin-top: 1em">nfsometer 1.7 man(1)</p>
<hr>
</body>
</html>
