<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>MK-QUERY-DIGEST(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">MK-QUERY-DIGEST(1)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">MK-QUERY-DIGEST(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
mk-query-digest - Analyze query execution logs and generate a query report,
  filter, replay, or transform queries for MySQL, PostgreSQL, memcached, and
  more.
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
Usage: mk-query-digest [OPTION...] [FILE]
<div class="Pp"></div>
mk-query-digest parses and analyzes MySQL log files. With no FILE, or when FILE
  is -, it read standard input.
<div class="Pp"></div>
Analyze, aggregate, and report on a slow query log:
<div class="Pp"></div>
<pre>
 mk-query-digest /path/to/slow.log
</pre>
<div class="Pp"></div>
Review a slow log, saving results to the test.query_review table in a MySQL
  server running on host1. See &quot;--review&quot; for more on reviewing
  queries:
<div class="Pp"></div>
<pre>
 mk-query-digest --review h=host1,D=test,t=query_review /path/to/slow.log
</pre>
<div class="Pp"></div>
Filter out everything but SELECT queries, replay the queries against another
  server, then use the timings from replaying them to analyze their performance:
<div class="Pp"></div>
<pre>
 mk-query-digest /path/to/slow.log --execute h=another_server \
   --filter '$event-&gt;{fingerprint} =~ m/^select/'
</pre>
<div class="Pp"></div>
Print the structure of events so you can construct a complex
  &quot;--filter&quot;:
<div class="Pp"></div>
<pre>
 mk-query-digest /path/to/slow.log --no-report \
   --filter 'print Dumper($event)'
</pre>
<div class="Pp"></div>
Watch SHOW FULL PROCESSLIST and output a log in slow query log format:
<div class="Pp"></div>
<pre>
 mk-query-digest --processlist h=host1 --print --no-report
</pre>
<div class="Pp"></div>
The default aggregation and analysis is CPU and memory intensive. Disable it if
  you don't need the default report:
<div class="Pp"></div>
<pre>
 mk-query-digest &lt;arguments&gt; --no-report
</pre>
<h1 class="Sh" title="Sh" id="RISKS"><a class="selflink" href="#RISKS">RISKS</a></h1>
The following section is included to inform users about the potential risks,
  whether known or unknown, of using this tool. The two main categories of risks
  are those created by the nature of the tool (e.g. read-only tools vs.
  read-write tools) and those created by bugs.
<div class="Pp"></div>
By default mk-query-digest merely collects and aggregates data from the files
  specified. It is designed to be as efficient as possible, but depending on the
  input you give it, it can use a lot of CPU and memory. Practically speaking,
  it is safe to run even on production systems, but you might want to monitor it
  until you are satisfied that the input you give it does not cause undue load.
<div class="Pp"></div>
Various options will cause mk-query-digest to insert data into tables, execute
  SQL queries, and so on. These include the &quot;--execute&quot; option and
  &quot;--review&quot;.
<div class="Pp"></div>
At the time of this release, we know of no bugs that could cause serious harm to
  users.
<div class="Pp"></div>
The authoritative source for updated information is always the online issue
  tracking system. Issues that affect this tool will be marked as such. You can
  see a list of such issues at the following URL:
  &lt;http://www.maatkit.org/bugs/mk-query-digest&gt;.
<div class="Pp"></div>
See also &quot;BUGS&quot; for more information on filing bugs and getting help.
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This tool was formerly known as mk-log-parser.
<div class="Pp"></div>
&quot;mk-query-digest&quot; is a framework for doing things with events from a
  query source such as the slow query log or PROCESSLIST. By default it acts as
  a very sophisticated log analysis tool. You can group and sort queries in many
  different ways simultaneously and find the most expensive queries, or create a
  timeline of queries in the log, for example. It can also do a &quot;query
  review,&quot; which means to save a sample of each type of query into a MySQL
  table so you can easily see whether you've reviewed and analyzed a query
  before. The benefit of this is that you can keep track of changes to your
  server's queries and avoid repeated work. You can also save other information
  with the queries, such as comments, issue numbers in your ticketing system,
  and so on.
<div class="Pp"></div>
Note that this is a work in *very* active progress and you should expect
  incompatible changes in the future.
<h1 class="Sh" title="Sh" id="ATTRIBUTES"><a class="selflink" href="#ATTRIBUTES">ATTRIBUTES</a></h1>
mk-query-digest works on events, which are a collection of key/value pairs
  called attributes. You'll recognize most of the attributes right away:
  Query_time, Lock_time, and so on. You can just look at a slow log and see
  them. However, there are some that don't exist in the slow log, and slow logs
  may actually include different kinds of attributes (for example, you may have
  a server with the Percona patches).
<div class="Pp"></div>
For a full list of attributes, see
  &lt;http://code.google.com/p/maatkit/wiki/EventAttributes&gt;.
<div class="Pp"></div>
With creative use of &quot;--filter&quot;, you can create new attributes derived
  from existing attributes. For example, to create an attribute called
  &quot;Row_ratio&quot; for examining the ratio of &quot;Rows_sent&quot; to
  &quot;Rows_examined&quot;, specify a filter like:
<div class="Pp"></div>
<pre>
  --filter '($event-&gt;{Row_ratio} = $event-&gt;{Rows_sent} / ($event-&gt;{Rows_examined})) &amp;&amp; 1'
</pre>
<div class="Pp"></div>
The &quot;&amp;&amp; 1&quot; trick is needed to create a valid one-line syntax
  that is always true, even if the assignment happens to evaluate false. The new
  attribute will automatically appears in the output:
<div class="Pp"></div>
<pre>
  # Row ratio           1.00    0.00       1    0.50       1    0.71    0.50
</pre>
<div class="Pp"></div>
Attributes created this way can be specified for &quot;--order-by&quot; or any
  option that requires an attribute.
<h2 class="Ss" title="Ss" id="memcached"><a class="selflink" href="#memcached">memcached</a></h2>
memcached events have additional attributes related to the memcached protocol:
  cmd, key, res (result) and val. Also, boolean attributes are created for the
  various commands, misses and errors: Memc_CMD where CMD is a memcached command
  (get, set, delete, etc.), Memc_error and Memc_miss.
<div class="Pp"></div>
These attributes are no different from slow log attributes, so you can use them
  with &quot;--[no]report&quot;, &quot;--group-by&quot;, in a
  &quot;--filter&quot;, etc.
<div class="Pp"></div>
These attributes and more are documented at
  &lt;http://code.google.com/p/maatkit/wiki/EventAttributes&gt;.
<h1 class="Sh" title="Sh" id="OUTPUT"><a class="selflink" href="#OUTPUT">OUTPUT</a></h1>
The default output is a query analysis report. The &quot;--[no]report&quot;
  option controls whether or not this report is printed. Sometimes you may wish
  to parse all the queries but suppress the report, for example when using
  &quot;--print&quot;, &quot;--review&quot; or &quot;--save-results&quot;.
<div class="Pp"></div>
There is one paragraph for each class of query analyzed. A &quot;class&quot; of
  queries all have the same value for the &quot;--group-by&quot; attribute which
  is &quot;fingerprint&quot; by default. (See &quot;ATTRIBUTES&quot;.) A
  fingerprint is an abstracted version of the query text with literals removed,
  whitespace collapsed, and so forth. The report is formatted so it's easy to
  paste into emails without wrapping, and all non-query lines begin with a
  comment, so you can save it to a .sql file and open it in your favorite
  syntax-highlighting text editor. There is a response-time profile at the
  beginning.
<div class="Pp"></div>
The output described here is controlled by &quot;--report-format&quot;. That
  option allows you to specify what to print and in what order. The default
  output in the default order is described here.
<div class="Pp"></div>
The report, by default, begins with a paragraph about the entire analysis run
  The information is very similar to what you'll see for each class of queries
  in the log, but it doesn't have some information that would be too expensive
  to keep globally for the analysis. It also has some statistics about the
  code's execution itself, such as the CPU and memory usage, the local date and
  time of the run, and a list of input file read/parsed.
<div class="Pp"></div>
Following this is the response-time profile over the events. This is a highly
  summarized view of the unique events in the detailed query report that
  follows. It contains the following columns:
<div class="Pp"></div>
<pre>
 Column        Meaning
 ============  ==========================================================
 Rank          The query's rank within the entire set of queries analyzed
 Query ID      The query's fingerprint
 Response time The total response time, and percentage of overall total
 Calls         The number of times this query was executed
 R/Call        The mean response time per execution
 Apdx          The Apdex score; see --apdex-threshold for details
 V/M           The Variance-to-mean ratio of response time
 EXPLAIN       If --explain was specified, a sparkline; see --explain
 Item          The distilled query
</pre>
<div class="Pp"></div>
A final line whose rank is shown as MISC contains aggregate statistics on the
  queries that were not included in the report, due to options such as
  &quot;--limit&quot; and &quot;--outliers&quot;. For details on the
  variance-to-mean ratio, please see
  http://en.wikipedia.org/wiki/Index_of_dispersion.
<div class="Pp"></div>
Next, the detailed query report is printed. Each query appears in a paragraph.
  Here is a sample, slightly reformatted so 'perldoc' will not wrap lines in a
  terminal. The following will all be one paragraph, but we'll break it up for
  commentary.
<div class="Pp"></div>
<pre>
 # Query 2: 0.01 QPS, 0.02x conc, ID 0xFDEA8D2993C9CAF3 at byte 160665
</pre>
<div class="Pp"></div>
This line identifies the sequential number of the query in the sort order
  specified by &quot;--order-by&quot;. Then there's the queries per second, and
  the approximate concurrency for this query (calculated as a function of the
  timespan and total Query_time). Next there's a query ID. This ID is a hex
  version of the query's checksum in the database, if you're using
  &quot;--review&quot;. You can select the reviewed query's details from the
  database with a query like &quot;SELECT .... WHERE
  checksum=0xFDEA8D2993C9CAF3&quot;.
<div class="Pp"></div>
If you are investigating the report and want to print out every sample of a
  particular query, then the following &quot;--filter&quot; may be helpful:
  &quot;mk-query-digest slow-log.log --no-report --print --filter
  '$event-&quot;{fingerprint} &amp;&amp; make_checksum($event-&gt;{fingerprint})
  eq &quot;FDEA8D2993C9CAF3&quot;'&gt;.
<div class="Pp"></div>
Notice that you must remove the 0x prefix from the checksum in order for this to
  work.
<div class="Pp"></div>
Finally, in case you want to find a sample of the query in the log file, there's
  the byte offset where you can look. (This is not always accurate, due to some
  silly anomalies in the slow-log format, but it's usually right.) The position
  refers to the worst sample, which we'll see more about below.
<div class="Pp"></div>
Next is the table of metrics about this class of queries.
<div class="Pp"></div>
<pre>
 #           pct   total    min    max     avg     95%  stddev  median
 # Count       0       2
 # Exec time  13   1105s   552s   554s    553s    554s      2s    553s
 # Lock time   0   216us   99us  117us   108us   117us    12us   108us
 # Rows sent  20   6.26M  3.13M  3.13M   3.13M   3.13M   12.73   3.13M
 # Rows exam   0   6.26M  3.13M  3.13M   3.13M   3.13M   12.73   3.13M
</pre>
<div class="Pp"></div>
The first line is column headers for the table. The percentage is the percent of
  the total for the whole analysis run, and the total is the actual value of the
  specified metric. For example, in this case we can see that the query executed
  2 times, which is 13% of the total number of queries in the file. The min, max
  and avg columns are self-explanatory. The 95% column shows the 95th
  percentile; 95% of the values are less than or equal to this value. The
  standard deviation shows you how tightly grouped the values are. The standard
  deviation and median are both calculated from the 95th percentile, discarding
  the extremely large values.
<div class="Pp"></div>
The stddev, median and 95th percentile statistics are approximate. Exact
  statistics require keeping every value seen, sorting, and doing some
  calculations on them. This uses a lot of memory. To avoid this, we keep 1000
  buckets, each of them 5% bigger than the one before, ranging from .000001 up
  to a very big number. When we see a value we increment the bucket into which
  it falls. Thus we have fixed memory per class of queries. The drawback is the
  imprecision, which typically falls in the 5 percent range.
<div class="Pp"></div>
Next we have statistics on the users, databases and time range for the query.
<div class="Pp"></div>
<pre>
 # Users       1   user1
 # Databases   2     db1(1), db2(1)
 # Time range 2008-11-26 04:55:18 to 2008-11-27 00:15:15
</pre>
<div class="Pp"></div>
The users and databases are shown as a count of distinct values, followed by the
  values. If there's only one, it's shown alone; if there are many, we show each
  of the most frequent ones, followed by the number of times it appears.
<div class="Pp"></div>
<pre>
 # Query_time distribution
 #   1us
 #  10us
 # 100us
 #   1ms
 #  10ms
 # 100ms
 #    1s
 #  10s+  #############################################################
</pre>
<div class="Pp"></div>
The execution times show a logarithmic chart of time clustering. Each query goes
  into one of the &quot;buckets&quot; and is counted up. The buckets are powers
  of ten. The first bucket is all values in the &quot;single microsecond
  range&quot; -- that is, less than 10us. The second is &quot;tens of
  microseconds,&quot; which is from 10us up to (but not including) 100us; and so
  on. The charted attribute can be changed by specifying
  &quot;--report-histogram&quot; but is limited to time-based attributes.
<div class="Pp"></div>
<pre>
 # Tables
 #    SHOW TABLE STATUS LIKE 'table1'\G
 #    SHOW CREATE TABLE `table1`\G
 # EXPLAIN
 SELECT * FROM table1\G
</pre>
<div class="Pp"></div>
This section is a convenience: if you're trying to optimize the queries you see
  in the slow log, you probably want to examine the table structure and size.
  These are copy-and-paste-ready commands to do that.
<div class="Pp"></div>
Finally, we see a sample of the queries in this class of query. This is not a
  random sample. It is the query that performed the worst, according to the sort
  order given by &quot;--order-by&quot;. You will normally see a commented
  &quot;# EXPLAIN&quot; line just before it, so you can copy-paste the query to
  examine its EXPLAIN plan. But for non-SELECT queries that isn't possible to
  do, so the tool tries to transform the query into a roughly equivalent SELECT
  query, and adds that below.
<div class="Pp"></div>
If you want to find this sample event in the log, use the offset mentioned
  above, and something like the following:
<div class="Pp"></div>
<pre>
  tail -c +&lt;offset&gt; /path/to/file | head
</pre>
<div class="Pp"></div>
See also &quot;--report-format&quot;.
<h2 class="Ss" title="Ss" id="SPARKLINES"><a class="selflink" href="#SPARKLINES">SPARKLINES</a></h2>
The output also contains sparklines. Sparklines are &quot;data-intense,
  design-simple, word-sized graphics&quot;
  (&lt;http://en.wikipedia.org/wiki/Sparkline&gt;).There is a sparkline for
  &quot;--report-histogram&quot; and for &quot;--explain&quot;. See each of
  those options for details about interpreting their sparklines.
<h1 class="Sh" title="Sh" id="QUERY_REVIEWS"><a class="selflink" href="#QUERY_REVIEWS">QUERY
  REVIEWS</a></h1>
A &quot;query review&quot; is the process of storing all the query fingerprints
  analyzed. This has several benefits:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">You can add meta-data to classes of queries, such as
      marking them for follow-up, adding notes to queries, or marking them with
      an issue ID for your issue tracking system.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">You can refer to the stored values on subsequent runs so
      you'll know whether you've seen a query before. This can help you cut down
      on duplicated work.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">You can store historical data such as the row count, query
      times, and generally anything you can see in the report.</dd>
</dl>
<div class="Pp"></div>
To use this feature, you run mk-query-digest with the &quot;--review&quot;
  option. It will store the fingerprints and other information into the table
  you specify. Next time you run it with the same option, it will do the
  following:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">It won't show you queries you've already reviewed. A query
      is considered to be already reviewed if you've set a value for the
      &quot;reviewed_by&quot; column. (If you want to see queries you've already
      reviewed, use the &quot;--report-all&quot; option.)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Queries that you've reviewed, and don't appear in the
      output, will cause gaps in the query number sequence in the first line of
      each paragraph. And the value you've specified for &quot;--limit&quot;
      will still be honored. So if you've reviewed all queries in the top 10 and
      you ask for the top 10, you won't see anything in the output.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">If you want to see the queries you've already reviewed, you
      can specify &quot;--report-all&quot;. Then you'll see the normal analysis
      output, but you'll also see the information from the review table, just
      below the execution time graph. For example,
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  # Review information
  #      comments: really bad IN() subquery, fix soon!
  #    first_seen: 2008-12-01 11:48:57
  #   jira_ticket: 1933
  #     last_seen: 2008-12-18 11:49:07
  #      priority: high
  #   reviewed_by: xaprb
  #   reviewed_on: 2008-12-18 15:03:11
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    You can see how useful this meta-data is -- as you analyze your queries, you
      get your comments integrated right into the report.
    <div style="height: 1.00em;">&#x00A0;</div>
    If you add the &quot;--review-history&quot; option, it will also store
      information into a separate database table, so you can keep historical
      trending information on classes of queries.</dd>
</dl>
<h1 class="Sh" title="Sh" id="FINGERPRINTS"><a class="selflink" href="#FINGERPRINTS">FINGERPRINTS</a></h1>
A query fingerprint is the abstracted form of a query, which makes it possible
  to group similar queries together. Abstracting a query removes literal values,
  normalizes whitespace, and so on. For example, consider these two queries:
<div class="Pp"></div>
<pre>
  SELECT name, password FROM user WHERE id='12823';
  select name,   password from user
     where id=5;
</pre>
<div class="Pp"></div>
Both of those queries will fingerprint to
<div class="Pp"></div>
<pre>
  select name, password from user where id=?
</pre>
<div class="Pp"></div>
Once the query's fingerprint is known, we can then talk about a query as though
  it represents all similar queries.
<div class="Pp"></div>
What &quot;mk-query-digest&quot; does is analogous to a GROUP BY statement in
  SQL. (But note that &quot;multiple columns&quot; doesn't define a multi-column
  grouping; it defines multiple reports!) If your command-line looks like this,
<div class="Pp"></div>
<pre>
  mk-query-digest /path/to/slow.log --select Rows_read,Rows_sent \
      --group-by fingerprint --order-by Query_time:sum --limit 10
</pre>
<div class="Pp"></div>
The corresponding pseudo-SQL looks like this:
<div class="Pp"></div>
<pre>
  SELECT WORST(query BY Query_time), SUM(Query_time), ...
  FROM /path/to/slow.log
  GROUP BY FINGERPRINT(query)
  ORDER BY SUM(Query_time) DESC
  LIMIT 10
</pre>
<div class="Pp"></div>
You can also use the value &quot;distill&quot;, which is a kind of
  super-fingerprint. See &quot;--group-by&quot; for more.
<div class="Pp"></div>
When parsing memcached input (&quot;--type&quot; memcached), the fingerprint is
  an abstracted version of the command and key, with placeholders removed. For
  example, &quot;get user_123_preferences&quot; fingerprints to &quot;get
  user_?_preferences&quot;. There is also a &quot;key_print&quot; which a
  fingerprinted version of the key. This example's key_print is
  &quot;user_?_preferences&quot;.
<div class="Pp"></div>
Query fingerprinting accommodates a great many special cases, which have proven
  necessary in the real world. For example, an IN list with 5 literals is really
  equivalent to one with 4 literals, so lists of literals are collapsed to a
  single one. If you want to understand more about how and why all of these
  cases are handled, please review the test cases in the Subversion repository.
  If you find something that is not fingerprinted properly, please submit a bug
  report with a reproducible test case. Here is a list of transformations during
  fingerprinting, which might not be exhaustive:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Group all SELECT queries from mysqldump together, even if
      they are against different tables. Ditto for all of mk-table-checksum's
      checksum queries.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Shorten multi-value INSERT statements to a single
      <i>VALUES()</i> list.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Strip comments.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Abstract the databases in USE statements, so all USE
      statements are grouped together.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Replace all literals, such as quoted strings. For
      efficiency, the code that replaces literal numbers is somewhat
      non-selective, and might replace some things as numbers when they really
      are not. Hexadecimal literals are also replaced. NULL is treated as a
      literal. Numbers embedded in identifiers are also replaced, so tables
      named similarly will be fingerprinted to the same values (e.g. users_2009
      and users_2010 will fingerprint identically).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Collapse all whitespace into a single space.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Lowercase the entire query.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Replace all literals inside of <i>IN()</i> and
      <i>VALUES()</i> lists with a single placeholder, regardless of
      cardinality.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Collapse multiple identical UNION queries into a single
      one.</dd>
</dl>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
DSN values in &quot;--review-history&quot; default to values in
  &quot;--review&quot; if COPY is yes.
<div class="Pp"></div>
This tool accepts additional command-line arguments. Refer to the
  &quot;SYNOPSIS&quot; and usage information for details.
<dl class="Bl-tag">
  <dt class="It-tag">--apdex-threshold</dt>
  <dd class="It-tag">type: float; default: 1.0
    <div style="height: 1.00em;">&#x00A0;</div>
    Set Apdex target threshold (T) for query response time. The Application
      Performance Index (Apdex) Technical Specification V1.1 defines T as
      &quot;a positive decimal value in seconds, having no more than two
      significant digits of granularity.&quot; This value only applies to query
      response time (Query_time).
    <div style="height: 1.00em;">&#x00A0;</div>
    Options can be abbreviated so specifying &quot;--apdex-t&quot; also works.
    <div style="height: 1.00em;">&#x00A0;</div>
    See &lt;http://www.apdex.org/&gt;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--ask-pass</dt>
  <dd class="It-tag">Prompt for a password when connecting to MySQL.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--attribute-aliases</dt>
  <dd class="It-tag">type: array; default: db|Schema
    <div style="height: 1.00em;">&#x00A0;</div>
    List of attribute|alias,etc.
    <div style="height: 1.00em;">&#x00A0;</div>
    Certain attributes have multiple names, like db and Schema. If an event does
      not have the primary attribute, mk-query-digest looks for an alias
      attribute. If it finds an alias, it creates the primary attribute with the
      alias attribute's value and removes the alias attribute.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the event has the primary attribute, all alias attributes are deleted.
    <div style="height: 1.00em;">&#x00A0;</div>
    This helps simplify event attributes so that, for example, there will not be
      report lines for both db and Schema.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--attribute-value-limit</dt>
  <dd class="It-tag">type: int; default: 4294967296
    <div style="height: 1.00em;">&#x00A0;</div>
    A sanity limit for attribute values.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option deals with bugs in slow-logging functionality that causes large
      values for attributes. If the attribute's value is bigger than this, the
      last-seen value for that class of query is used instead.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--aux-dsn</dt>
  <dd class="It-tag">type: DSN
    <div style="height: 1.00em;">&#x00A0;</div>
    Auxiliary DSN used for special options.
    <div style="height: 1.00em;">&#x00A0;</div>
    The following options may require a DSN even when only parsing a slow log
      file:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  * --since
  * --until
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    See each option for why it might require a DSN.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--charset</dt>
  <dd class="It-tag">short form: -A; type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Default character set. If the value is utf8, sets Perl's binmode on STDOUT
      to utf8, passes the mysql_enable_utf8 option to DBD::mysql, and runs SET
      NAMES UTF8 after connecting to MySQL. Any other value sets binmode on
      STDOUT without the utf8 layer, and runs SET NAMES after connecting to
      MySQL.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--check-attributes-limit</dt>
  <dd class="It-tag">type: int; default: 1000
    <div style="height: 1.00em;">&#x00A0;</div>
    Stop checking for new attributes after this many events.
    <div style="height: 1.00em;">&#x00A0;</div>
    For better speed, mk-query-digest stops checking events for new attributes
      after a certain number of events. Any new attributes after this number
      will be ignored and will not be reported.
    <div style="height: 1.00em;">&#x00A0;</div>
    One special case is new attributes for pre-existing query classes (see
      &quot;--group-by&quot; about query classes). New attributes will not be
      added to pre-existing query classes even if the attributes are detected
      before the &quot;--check-attributes-limit&quot; limit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--config</dt>
  <dd class="It-tag">type: Array
    <div style="height: 1.00em;">&#x00A0;</div>
    Read this comma-separated list of config files; if specified, this must be
      the first option on the command line.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--[no]continue-on-error</dt>
  <dd class="It-tag">default: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Continue parsing even if there is an error.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--create-review-history-table</dt>
  <dd class="It-tag">Create the &quot;--review-history&quot; table if it does
      not exist.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option causes the table specified by &quot;--review-history&quot; to be
      created with the default structure shown in the documentation for that
      option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--create-review-table</dt>
  <dd class="It-tag">Create the &quot;--review&quot; table if it does not exist.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option causes the table specified by &quot;--review&quot; to be created
      with the default structure shown in the documentation for that
    option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--daemonize</dt>
  <dd class="It-tag">Fork to the background and detach from the shell. POSIX
      operating systems only.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--defaults-file</dt>
  <dd class="It-tag">short form: -F; type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Only read mysql options from the given file. You must give an absolute
      pathname.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--embedded-attributes</dt>
  <dd class="It-tag">type: array
    <div style="height: 1.00em;">&#x00A0;</div>
    Two Perl regex patterns to capture pseudo-attributes embedded in queries.
    <div style="height: 1.00em;">&#x00A0;</div>
    Embedded attributes might be special attribute-value pairs that you've
      hidden in comments. The first regex should match the entire set of
      attributes (in case there are multiple). The second regex should match and
      capture attribute-value pairs from the first regex.
    <div style="height: 1.00em;">&#x00A0;</div>
    For example, suppose your query looks like the following:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  SELECT * from users -- file: /login.php, line: 493;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    You might run mk-query-digest with the following option:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  mk-query-digest --embedded-attributes ' -- .*','(\w+): ([^\,]+)'
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    The first regular expression captures the whole comment:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  &quot; -- file: /login.php, line: 493;&quot;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    The second one splits it into attribute-value pairs and adds them to the
      event:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
   ATTRIBUTE  VALUE
   =========  ==========
   file       /login.php
   line       493
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>NOTE</b>: All commas in the regex patterns must be escaped with \
      otherwise the pattern will break.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--execute</dt>
  <dd class="It-tag">type: DSN
    <div style="height: 1.00em;">&#x00A0;</div>
    Execute queries on this DSN.
    <div style="height: 1.00em;">&#x00A0;</div>
    Adds a callback into the chain, after filters but before the reports. Events
      are executed on this DSN. If they are successful, the time they take to
      execute overwrites the event's Query_time attribute and the original
      Query_time value (from the log) is saved as the Exec_orig_time attribute.
      If unsuccessful, the callback returns false and terminates the chain.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the connection fails, mk-query-digest tries to reconnect once per second.
    <div style="height: 1.00em;">&#x00A0;</div>
    See also &quot;--mirror&quot; and &quot;--execute-throttle&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--execute-throttle</dt>
  <dd class="It-tag">type: array
    <div style="height: 1.00em;">&#x00A0;</div>
    Throttle values for &quot;--execute&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    By default &quot;--execute&quot; runs without any limitations or concerns
      for the amount of time that it takes to execute the events. The
      &quot;--execute-throttle&quot; allows you to limit the amount of time
      spent doing &quot;--execute&quot; relative to the other processes that
      handle events. This works by marking some events with a
      &quot;Skip_exec&quot; attribute when &quot;--execute&quot; begins to take
      too much time. &quot;--execute&quot; will not execute an event if this
      attribute is true. This indirectly decreases the time spent doing
      &quot;--execute&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    The &quot;--execute-throttle&quot; option takes at least two comma-separated
      values: max allowed &quot;--execute&quot; time as a percentage and a check
      interval time. An optional third value is a percentage step for increasing
      and decreasing the probability that an event will be marked
      &quot;Skip_exec&quot; true. 5 (percent) is the default step.
    <div style="height: 1.00em;">&#x00A0;</div>
    For example: &quot;--execute-throttle&quot; &quot;70,60,10&quot;. This will
      limit &quot;--execute&quot; to 70% of total event processing time, checked
      every minute (60 seconds) and probability stepped up and down by 10%. When
      &quot;--execute&quot; exceeds 70%, the probability that events will be
      marked &quot;Skip_exec&quot; true increases by 10%. &quot;--execute&quot;
      time is checked again after another minute. If it's still above 70%, then
      the probability will increase another 10%. Or, if it's dropped below 70%,
      then the probability will decrease by 10%.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--expected-range</dt>
  <dd class="It-tag">type: array; default: 5,10
    <div style="height: 1.00em;">&#x00A0;</div>
    Explain items when there are more or fewer than expected.
    <div style="height: 1.00em;">&#x00A0;</div>
    Defines the number of items expected to be seen in the report given by
      &quot;--[no]report&quot;, as controlled by &quot;--limit&quot; and
      &quot;--outliers&quot;. If there are more or fewer items in the report,
      each one will explain why it was included.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--explain</dt>
  <dd class="It-tag">type: DSN
    <div style="height: 1.00em;">&#x00A0;</div>
    Run EXPLAIN for the sample query with this DSN and print results.
    <div style="height: 1.00em;">&#x00A0;</div>
    This works only when &quot;--group-by&quot; includes fingerprint. It causes
      mk-query-digest to run EXPLAIN and include the output into the report. For
      safety, queries that appear to have a subquery that EXPLAIN will execute
      won't be EXPLAINed. Those are typically &quot;derived table&quot; queries
      of the form
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  select ... from ( select .... ) der;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    The EXPLAIN results are printed in three places: a sparkline in the event
      header, a full vertical format in the event report, and a sparkline in the
      profile.
    <div style="height: 1.00em;">&#x00A0;</div>
    The full format appears at the end of each event report in vertical style
      (&quot;\G&quot;) just like MySQL prints it.
    <div style="height: 1.00em;">&#x00A0;</div>
    The sparklines (see &quot;SPARKLINES&quot;) are compact representations of
      the access type for each table and whether or not &quot;Using
      temporary&quot; or &quot;Using filesort&quot; appear in EXPLAIN. The
      sparklines look like:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  nr&gt;TF
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    That sparkline means that there are two tables, the first uses a range (n)
      access, the second uses a ref access, and both &quot;Using temporary&quot;
      (T) and &quot;Using filesort&quot; (F) appear. The greater-than character
      just separates table access codes from T and/or F.
    <div style="height: 1.00em;">&#x00A0;</div>
    The abbreviated table access codes are:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  a  ALL
  c  const
  e  eq_ref
  f  fulltext
  i  index
  m  index_merge
  n  range
  o  ref_or_null
  r  ref
  s  system
  u  unique_subquery
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    A capitalized access code means that &quot;Using index&quot; appears in
      EXPLAIN for that table.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--filter</dt>
  <dd class="It-tag">type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Discard events for which this Perl code doesn't return true.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option is a string of Perl code or a file containing Perl code that
      gets compiled into a subroutine with one argument: $event. This is a
      hashref. If the given value is a readable file, then mk-query-digest reads
      the entire file and uses its contents as the code. The file should not
      contain a shebang (#!/usr/bin/perl) line.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the code returns true, the chain of callbacks continues; otherwise it
      ends. The code is the last statement in the subroutine other than
      &quot;return $event&quot;. The subroutine template is:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  sub { $event = shift; filter &amp;&amp; return $event; }
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Filters given on the command line are wrapped inside parentheses like like
      &quot;( filter )&quot;. For complex, multi-line filters, you must put the
      code inside a file so it will not be wrapped inside parentheses. Either
      way, the filter must produce syntactically valid code given the template.
      For example, an if-else branch given on the command line would not be
      valid:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  --filter 'if () { } else { }'  # WRONG
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Since it's given on the command line, the if-else branch would be wrapped
      inside parentheses which is not syntactically valid. So to accomplish
      something more complex like this would require putting the code in a file,
      for example filter.txt:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  my $event_ok; if (...) { $event_ok=1; } else { $event_ok=0; } $event_ok
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Then specify &quot;--filter filter.txt&quot; to read the code from
      filter.txt.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the filter code won't compile, mk-query-digest will die with an error. If
      the filter code does compile, an error may still occur at runtime if the
      code tries to do something wrong (like pattern match an undefined value).
      mk-query-digest does not provide any safeguards so code carefully!
    <div style="height: 1.00em;">&#x00A0;</div>
    An example filter that discards everything but SELECT statements:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  --filter '$event-&gt;{arg} =~ m/^select/i'
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    This is compiled into a subroutine like the following:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  sub { $event = shift; ( $event-&gt;{arg} =~ m/^select/i ) &amp;&amp; return $event; }
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    It is permissible for the code to have side effects (to alter $event).
    <div style="height: 1.00em;">&#x00A0;</div>
    You can find an explanation of the structure of $event at
      &lt;http://code.google.com/p/maatkit/wiki/EventAttributes&gt;.
    <div style="height: 1.00em;">&#x00A0;</div>
    Here are more examples of filter code:</dd>
</dl>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">Host/IP matches domain.com</dt>
  <dd class="It-tag">--filter '($event-&gt;{host} || $event-&gt;{ip} ||
      &quot;&quot;) =~ m/domain.com/'
    <div style="height: 1.00em;">&#x00A0;</div>
    Sometimes MySQL logs the host where the IP is expected. Therefore, we check
      both.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">User matches john</dt>
  <dd class="It-tag">--filter '($event-&gt;{user} || &quot;&quot;) =~
    m/john/'</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">More than 1 warning</dt>
  <dd class="It-tag">--filter '($event-&gt;{Warning_count} || 0) &gt; 1'</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Query does full table scan or full join</dt>
  <dd class="It-tag">--filter '(($event-&gt;{Full_scan} || &quot;&quot;) eq
      &quot;Yes&quot;) || (($event-&gt;{Full_join} || &quot;&quot;) eq
      &quot;Yes&quot;)'</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Query was not served from query cache</dt>
  <dd class="It-tag">--filter '($event-&gt;{QC_Hit} || &quot;&quot;) eq
      &quot;No&quot;'</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Query is 1 MB or larger</dt>
  <dd class="It-tag">--filter '$event-&gt;{bytes} &gt;= 1_048_576'</dd>
</dl>
</div>
<div style="margin-left: 4.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
Since &quot;--filter&quot; allows you to alter $event, you can use it to do
  other things, like create new attributes. See &quot;ATTRIBUTES&quot; for an
  example.</div>
<dl class="Bl-tag">
  <dt class="It-tag">--fingerprints</dt>
  <dd class="It-tag">Add query fingerprints to the standard query analysis
      report. This is mostly useful for debugging purposes.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--[no]for-explain</dt>
  <dd class="It-tag">default: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Print extra information to make analysis easy.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option adds code snippets to make it easy to run SHOW CREATE TABLE and
      SHOW TABLE STATUS for the query's tables. It also rewrites non-SELECT
      queries into a SELECT that might be helpful for determining the non-SELECT
      statement's index usage.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--group-by</dt>
  <dd class="It-tag">type: Array; default: fingerprint
    <div style="height: 1.00em;">&#x00A0;</div>
    Which attribute of the events to group by.
    <div style="height: 1.00em;">&#x00A0;</div>
    In general, you can group queries into classes based on any attribute of the
      query, such as &quot;user&quot; or &quot;db&quot;, which will by default
      show you which users and which databases get the most
      &quot;Query_time&quot;. The default attribute, &quot;fingerprint&quot;,
      groups similar, abstracted queries into classes; see below and see also
      &quot;FINGERPRINTS&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    A report is printed for each &quot;--group-by&quot; value (unless
      &quot;--no-report&quot; is given). Therefore, &quot;--group-by
      user,db&quot; means &quot;report on queries with the same user and report
      on queries with the same db&quot;--it does not mean &quot;report on
      queries with the same user and db.&quot; See also &quot;OUTPUT&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    Every value must have a corresponding value in the same position in
      &quot;--order-by&quot;. However, adding values to &quot;--group-by&quot;
      will automatically add values to &quot;--order-by&quot;, for your
      convenience.
    <div style="height: 1.00em;">&#x00A0;</div>
    There are several magical values that cause some extra data mining to happen
      before the grouping takes place:</dd>
</dl>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">fingerprint</dt>
  <dd class="It-tag">This causes events to be fingerprinted to abstract queries
      into a canonical form, which is then used to group events together into a
      class. See &quot;FINGERPRINTS&quot; for more about fingerprinting.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">tables</dt>
  <dd class="It-tag">This causes events to be inspected for what appear to be
      tables, and then aggregated by that. Note that a query that contains two
      or more tables will be counted as many times as there are tables; so a
      join against two tables will count the Query_time against both
    tables.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">distill</dt>
  <dd class="It-tag">This is a sort of super-fingerprint that collapses queries
      down into a suggestion of what they do, such as &quot;INSERT SELECT table1
      table2&quot;.</dd>
</dl>
</div>
<div style="margin-left: 4.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
If parsing memcached input (&quot;--type&quot; memcached), there are other
  attributes which you can group by: key_print (see memcached section in
  &quot;FINGERPRINTS&quot;), cmd, key, res and val (see memcached section in
  &quot;ATTRIBUTES&quot;).</div>
<dl class="Bl-tag">
  <dt class="It-tag">--[no]gzip</dt>
  <dd class="It-tag">default: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Gzip &quot;--save-results&quot; files; requires IO::Compress::Gzip.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--help</dt>
  <dd class="It-tag">Show help and exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--host</dt>
  <dd class="It-tag">short form: -h; type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Connect to host.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--ignore-attributes</dt>
  <dd class="It-tag">type: array; default: arg, cmd, insert_id, ip, port,
      Thread_id, timestamp, exptime, flags, key, res, val, server_id, offset,
      end_log_pos, Xid
    <div style="height: 1.00em;">&#x00A0;</div>
    Do not aggregate these attributes when auto-detecting &quot;--select&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    If you do not specify &quot;--select&quot; then mk-query-digest auto-detects
      and aggregates every attribute that it finds in the slow log. Some
      attributes, however, should not be aggregated. This option allows you to
      specify a list of attributes to ignore. This only works when no explicit
      &quot;--select&quot; is given.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--inherit-attributes</dt>
  <dd class="It-tag">type: array; default: db,ts
    <div style="height: 1.00em;">&#x00A0;</div>
    If missing, inherit these attributes from the last event that had them.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option sets which attributes are inherited or carried forward to events
      which do not have them. For example, if one event has the db attribute
      equal to &quot;foo&quot;, but the next event doesn't have the db
      attribute, then it inherits &quot;foo&quot; for its db attribute.
    <div style="height: 1.00em;">&#x00A0;</div>
    Inheritance is usually desirable, but in some cases it might confuse things.
      If a query inherits a database that it doesn't actually use, then this
      could confuse &quot;--execute&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--interval</dt>
  <dd class="It-tag">type: float; default: .1
    <div style="height: 1.00em;">&#x00A0;</div>
    How frequently to poll the processlist, in seconds.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--iterations</dt>
  <dd class="It-tag">type: int; default: 1
    <div style="height: 1.00em;">&#x00A0;</div>
    How many times to iterate through the collect-and-report cycle. If 0,
      iterate to infinity. Each iteration runs for &quot;--run-time&quot; amount
      of time. An iteration is usually determined by an amount of time and a
      report is printed when that amount of time elapses. With
      &quot;--run-time-mode&quot; &quot;interval&quot;, an interval is instead
      determined by the interval time you specify with &quot;--run-time&quot;.
      See &quot;--run-time&quot; and &quot;--run-time-mode&quot; for more
      information.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--limit</dt>
  <dd class="It-tag">type: Array; default: 95%:20
    <div style="height: 1.00em;">&#x00A0;</div>
    Limit output to the given percentage or count.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the argument is an integer, report only the top N worst queries. If the
      argument is an integer followed by the &quot;%&quot; sign, report that
      percentage of the worst queries. If the percentage is followed by a colon
      and another integer, report the top percentage or the number specified by
      that integer, whichever comes first.
    <div style="height: 1.00em;">&#x00A0;</div>
    The value is actually a comma-separated array of values, one for each item
      in &quot;--group-by&quot;. If you don't specify a value for any of those
      items, the default is the top 95%.
    <div style="height: 1.00em;">&#x00A0;</div>
    See also &quot;--outliers&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--log</dt>
  <dd class="It-tag">type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Print all output to this file when daemonized.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--mirror</dt>
  <dd class="It-tag">type: float
    <div style="height: 1.00em;">&#x00A0;</div>
    How often to check whether connections should be moved, depending on
      &quot;read_only&quot;. Requires &quot;--processlist&quot; and
      &quot;--execute&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option causes mk-query-digest to check every N seconds whether it is
      reading from a read-write server and executing against a read-only server,
      which is a sensible way to set up two servers if you're doing something
      like master-master replication. The
      &lt;http://code.google.com/p/mysql-master-master/&gt; master-master
      toolkit does this. The aim is to keep the passive server ready for
      failover, which is impossible without putting it under a realistic
      workload.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--order-by</dt>
  <dd class="It-tag">type: Array; default: Query_time:sum
    <div style="height: 1.00em;">&#x00A0;</div>
    Sort events by this attribute and aggregate function.
    <div style="height: 1.00em;">&#x00A0;</div>
    This is a comma-separated list of order-by expressions, one for each
      &quot;--group-by&quot; attribute. The default &quot;Query_time:sum&quot;
      is used for &quot;--group-by&quot; attributes without explicitly given
      &quot;--order-by&quot; attributes (that is, if you specify more
      &quot;--group-by&quot; attributes than corresponding
      &quot;--order-by&quot; attributes). The syntax is
      &quot;attribute:aggregate&quot;. See &quot;ATTRIBUTES&quot; for valid
      attributes. Valid aggregates are:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
   Aggregate Meaning
   ========= ============================
   sum       Sum/total attribute value
   min       Minimum attribute value
   max       Maximum attribute value
   cnt       Frequency/count of the query
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    For example, the default &quot;Query_time:sum&quot; means that queries in
      the query analysis report will be ordered (sorted) by their total query
      execution time (&quot;Exec time&quot;). &quot;Query_time:max&quot; orders
      the queries by their maximum query execution time, so the query with the
      single largest &quot;Query_time&quot; will be list first. &quot;cnt&quot;
      refers more to the frequency of the query as a whole, how often it
      appears; &quot;Count&quot; is its corresponding line in the query analysis
      report. So any attribute and &quot;cnt&quot; should yield the same report
      wherein queries are sorted by the number of times they appear.
    <div style="height: 1.00em;">&#x00A0;</div>
    When parsing general logs (&quot;--type&quot; &quot;genlog&quot;), the
      default &quot;--order-by&quot; becomes &quot;Query_time:cnt&quot;. General
      logs do not report query times so only the &quot;cnt&quot; aggregate makes
      sense because all query times are zero.
    <div style="height: 1.00em;">&#x00A0;</div>
    If you specify an attribute that doesn't exist in the events, then
      mk-query-digest falls back to the default &quot;Query_time:sum&quot; and
      prints a notice at the beginning of the report for each query class. You
      can create attributes with &quot;--filter&quot; and order by them; see
      &quot;ATTRIBUTES&quot; for an example.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--outliers</dt>
  <dd class="It-tag">type: array; default: Query_time:1:10
    <div style="height: 1.00em;">&#x00A0;</div>
    Report outliers by attribute:percentile:count.
    <div style="height: 1.00em;">&#x00A0;</div>
    The syntax of this option is a comma-separated list of colon-delimited
      strings. The first field is the attribute by which an outlier is defined.
      The second is a number that is compared to the attribute's 95th
      percentile. The third is optional, and is compared to the attribute's cnt
      aggregate. Queries that pass this specification are added to the report,
      regardless of any limits you specified in &quot;--limit&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    For example, to report queries whose 95th percentile Query_time is at least
      60 seconds and which are seen at least 5 times, use the following
      argument:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  --outliers Query_time:60:5
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    You can specify an --outliers option for each value in
      &quot;--group-by&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--password</dt>
  <dd class="It-tag">short form: -p; type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Password to use when connecting.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--pid</dt>
  <dd class="It-tag">type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Create the given PID file when daemonized. The file contains the process ID
      of the daemonized instance. The PID file is removed when the daemonized
      instance exits. The program checks for the existence of the PID file when
      starting; if it exists and the process with the matching PID exists, the
      program exits.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--pipeline-profile</dt>
  <dd class="It-tag">Print a profile of the pipeline processes.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--port</dt>
  <dd class="It-tag">short form: -P; type: int
    <div style="height: 1.00em;">&#x00A0;</div>
    Port number to use for connection.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--print</dt>
  <dd class="It-tag">Print log events to STDOUT in standard slow-query-log
      format.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--print-iterations</dt>
  <dd class="It-tag">Print the start time for each &quot;--iterations&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option causes a line like the following to be printed at the start of
      each &quot;--iterations&quot; report:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  # Iteration 2 started at 2009-11-24T14:39:48.345780
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    This line will print even if &quot;--no-report&quot; is specified. If
      &quot;--iterations 0&quot; is specified, each iteration number will be
    0.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--processlist</dt>
  <dd class="It-tag">type: DSN
    <div style="height: 1.00em;">&#x00A0;</div>
    Poll this DSN's processlist for queries, with &quot;--interval&quot; sleep
      between.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the connection fails, mk-query-digest tries to reopen it once per second.
      See also &quot;--mirror&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--progress</dt>
  <dd class="It-tag">type: array; default: time,30
    <div style="height: 1.00em;">&#x00A0;</div>
    Print progress reports to STDERR. The value is a comma-separated list with
      two parts. The first part can be percentage, time, or iterations; the
      second part specifies how often an update should be printed, in
      percentage, seconds, or number of iterations.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--read-timeout</dt>
  <dd class="It-tag">type: time; default: 0
    <div style="height: 1.00em;">&#x00A0;</div>
    Wait this long for an event from the input; 0 to wait forever.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option sets the maximum time to wait for an event from the input. It
      applies to all types of input except &quot;--processlist&quot;. If an
      event is not received after the specified time, the script stops reading
      the input and prints its reports. If &quot;--iterations&quot; is 0 or
      greater than 1, the next iteration will begin, else the script will exit.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option requires the Perl POSIX module.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--[no]report</dt>
  <dd class="It-tag">default: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Print out reports on the aggregate results from &quot;--group-by&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    This is the standard slow-log analysis functionality. See &quot;OUTPUT&quot;
      for the description of what this does and what the results look like.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--report-all</dt>
  <dd class="It-tag">Include all queries, even if they have already been
      reviewed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--report-format</dt>
  <dd class="It-tag">type: Array; default:
      rusage,date,hostname,files,header,profile,query_report,prepared
    <div style="height: 1.00em;">&#x00A0;</div>
    Print these sections of the query analysis report.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  SECTION      PRINTS
  ============ ======================================================
  rusage       CPU times and memory usage reported by ps
  date         Current local date and time
  hostname     Hostname of machine on which mk-query-digest was run
  files        Input files read/parse
  header       Summary of the entire analysis run
  profile      Compact table of queries for an overview of the report
  query_report Detailed information about each unique query
  prepared     Prepared statements
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    The sections are printed in the order specified. The rusage, date, files and
      header sections are grouped together if specified together; other sections
      are separated by blank lines.
    <div style="height: 1.00em;">&#x00A0;</div>
    See &quot;OUTPUT&quot; for more information on the various parts of the
      query report.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--report-histogram</dt>
  <dd class="It-tag">type: string; default: Query_time
    <div style="height: 1.00em;">&#x00A0;</div>
    Chart the distribution of this attribute's values.
    <div style="height: 1.00em;">&#x00A0;</div>
    The distribution chart is limited to time-based attributes, so charting
      &quot;Rows_examined&quot;, for example, will produce a useless chart.
      Charts look like:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  # Query_time distribution
  #   1us
  #  10us
  # 100us
  #   1ms
  #  10ms  ################################
  # 100ms  ################################################################
  #    1s  ########
  #  10s+
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    A sparkline (see &quot;SPARKLINES&quot;) of the full chart is also printed
      in the header for each query event. The sparkline of that full chart is:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  # Query_time sparkline: |    .^_ |
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    The sparkline itself is the 8 characters between the pipes (&quot;|&quot;),
      one character for each of the 8 buckets (1us, 10us, etc.) Four character
      codes are used to represent the approximate relation between each bucket's
      value:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  _ . - ^
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    The caret &quot;^&quot; represents peaks (buckets with the most values), and
      the underscore &quot;_&quot; represents lows (buckets with the least or at
      least one value). The period &quot;.&quot; and the hyphen &quot;-&quot;
      represent buckets with values between these two extremes. If a bucket has
      no values, a space is printed. So in the example above, the period
      represents the 10ms bucket, the caret the 100ms bucket, and the underscore
      the 1s bucket.
    <div style="height: 1.00em;">&#x00A0;</div>
    See &quot;OUTPUT&quot; for more information.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--review</dt>
  <dd class="It-tag">type: DSN
    <div style="height: 1.00em;">&#x00A0;</div>
    Store a sample of each class of query in this DSN.
    <div style="height: 1.00em;">&#x00A0;</div>
    The argument specifies a table to store all unique query fingerprints in.
      The table must have at least the following columns. You can add more
      columns for your own special purposes, but they won't be used by
      mk-query-digest. The following CREATE TABLE definition is also used for
      &quot;--create-review-table&quot;. MAGIC_create_review:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  CREATE TABLE query_review (
     checksum     BIGINT UNSIGNED NOT NULL PRIMARY KEY,
     fingerprint  TEXT NOT NULL,
     sample       TEXT NOT NULL,
     first_seen   DATETIME,
     last_seen    DATETIME,
     reviewed_by  VARCHAR(20),
     reviewed_on  DATETIME,
     comments     TEXT
  )
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    The columns are as follows:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  COLUMN       MEANING
  ===========  ===============
  checksum     A 64-bit checksum of the query fingerprint
  fingerprint  The abstracted version of the query; its primary key
  sample       The query text of a sample of the class of queries
  first_seen   The smallest timestamp of this class of queries
  last_seen    The largest timestamp of this class of queries
  reviewed_by  Initially NULL; if set, query is skipped thereafter
  reviewed_on  Initially NULL; not assigned any special meaning
  comments     Initially NULL; not assigned any special meaning
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Note that the &quot;fingerprint&quot; column is the true primary key for a
      class of queries. The &quot;checksum&quot; is just a cryptographic hash of
      this value, which provides a shorter value that is very likely to also be
      unique.
    <div style="height: 1.00em;">&#x00A0;</div>
    After parsing and aggregating events, your table should contain a row for
      each fingerprint. This option depends on &quot;--group-by
      fingerprint&quot; (which is the default). It will not work otherwise.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--review-history</dt>
  <dd class="It-tag">type: DSN
    <div style="height: 1.00em;">&#x00A0;</div>
    The table in which to store historical values for review trend analysis.
    <div style="height: 1.00em;">&#x00A0;</div>
    Each time you review queries with &quot;--review&quot;, mk-query-digest will
      save information into this table so you can see how classes of queries
      have changed over time.
    <div style="height: 1.00em;">&#x00A0;</div>
    This DSN inherits unspecified values from &quot;--review&quot;. It should
      mention a table in which to store statistics about each class of queries.
      mk-query-digest verifies the existence of the table, and your privileges
      to insert, delete and update on that table.
    <div style="height: 1.00em;">&#x00A0;</div>
    mk-query-digest then inspects the columns in the table. The table must have
      at least the following columns:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  CREATE TABLE query_review_history (
    checksum     BIGINT UNSIGNED NOT NULL,
    sample       TEXT NOT NULL
  );
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Any columns not mentioned above are inspected to see if they follow a
      certain naming convention. The column is special if the name ends with an
      underscore followed by any of these MAGIC_history_cols values:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  pct|avt|cnt|sum|min|max|pct_95|stddev|median|rank
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    If the column ends with one of those values, then the prefix is interpreted
      as the event attribute to store in that column, and the suffix is
      interpreted as the metric to be stored. For example, a column named
      Query_time_min will be used to store the minimum Query_time for the class
      of events. The presence of this column will also add Query_time to the
      &quot;--select&quot; list.
    <div style="height: 1.00em;">&#x00A0;</div>
    The table should also have a primary key, but that is up to you, depending
      on how you want to store the historical data. We suggest adding ts_min and
      ts_max columns and making them part of the primary key along with the
      checksum. But you could also just add a ts_min column and make it a DATE
      type, so you'd get one row per class of queries per day.
    <div style="height: 1.00em;">&#x00A0;</div>
    The default table structure follows. The following
      MAGIC_create_review_history table definition is used for
      &quot;--create-review-history-table&quot;:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
 CREATE TABLE query_review_history (
   checksum             BIGINT UNSIGNED NOT NULL,
   sample               TEXT NOT NULL,
   ts_min               DATETIME,
   ts_max               DATETIME,
   ts_cnt               FLOAT,
   Query_time_sum       FLOAT,
   Query_time_min       FLOAT,
   Query_time_max       FLOAT,
   Query_time_pct_95    FLOAT,
   Query_time_stddev    FLOAT,
   Query_time_median    FLOAT,
   Lock_time_sum        FLOAT,
   Lock_time_min        FLOAT,
   Lock_time_max        FLOAT,
   Lock_time_pct_95     FLOAT,
   Lock_time_stddev     FLOAT,
   Lock_time_median     FLOAT,
   Rows_sent_sum        FLOAT,
   Rows_sent_min        FLOAT,
   Rows_sent_max        FLOAT,
   Rows_sent_pct_95     FLOAT,
   Rows_sent_stddev     FLOAT,
   Rows_sent_median     FLOAT,
   Rows_examined_sum    FLOAT,
   Rows_examined_min    FLOAT,
   Rows_examined_max    FLOAT,
   Rows_examined_pct_95 FLOAT,
   Rows_examined_stddev FLOAT,
   Rows_examined_median FLOAT,
   -- Percona extended slowlog attributes 
   -- http://www.percona.com/docs/wiki/patches:slow_extended
   Rows_affected_sum             FLOAT,
   Rows_affected_min             FLOAT,
   Rows_affected_max             FLOAT,
   Rows_affected_pct_95          FLOAT,
   Rows_affected_stddev          FLOAT,
   Rows_affected_median          FLOAT,
   Rows_read_sum                 FLOAT,
   Rows_read_min                 FLOAT,
   Rows_read_max                 FLOAT,
   Rows_read_pct_95              FLOAT,
   Rows_read_stddev              FLOAT,
   Rows_read_median              FLOAT,
   Merge_passes_sum              FLOAT,
   Merge_passes_min              FLOAT,
   Merge_passes_max              FLOAT,
   Merge_passes_pct_95           FLOAT,
   Merge_passes_stddev           FLOAT,
   Merge_passes_median           FLOAT,
   InnoDB_IO_r_ops_min           FLOAT,
   InnoDB_IO_r_ops_max           FLOAT,
   InnoDB_IO_r_ops_pct_95        FLOAT,
   InnoDB_IO_r_ops_stddev        FLOAT,
   InnoDB_IO_r_ops_median        FLOAT,
   InnoDB_IO_r_bytes_min         FLOAT,
   InnoDB_IO_r_bytes_max         FLOAT,
   InnoDB_IO_r_bytes_pct_95      FLOAT,
   InnoDB_IO_r_bytes_stddev      FLOAT,
   InnoDB_IO_r_bytes_median      FLOAT,
   InnoDB_IO_r_wait_min          FLOAT,
   InnoDB_IO_r_wait_max          FLOAT,
   InnoDB_IO_r_wait_pct_95       FLOAT,
   InnoDB_IO_r_wait_stddev       FLOAT,
   InnoDB_IO_r_wait_median       FLOAT,
   InnoDB_rec_lock_wait_min      FLOAT,
   InnoDB_rec_lock_wait_max      FLOAT,
   InnoDB_rec_lock_wait_pct_95   FLOAT,
   InnoDB_rec_lock_wait_stddev   FLOAT,
   InnoDB_rec_lock_wait_median   FLOAT,
   InnoDB_queue_wait_min         FLOAT,
   InnoDB_queue_wait_max         FLOAT,
   InnoDB_queue_wait_pct_95      FLOAT,
   InnoDB_queue_wait_stddev      FLOAT,
   InnoDB_queue_wait_median      FLOAT,
   InnoDB_pages_distinct_min     FLOAT,
   InnoDB_pages_distinct_max     FLOAT,
   InnoDB_pages_distinct_pct_95  FLOAT,
   InnoDB_pages_distinct_stddev  FLOAT,
   InnoDB_pages_distinct_median  FLOAT,
   -- Boolean (Yes/No) attributes.  Only the cnt and sum are needed for these.
   -- cnt is how many times is attribute was recorded and sum is how many of
   -- those times the value was Yes.  Therefore sum/cnt * 100 = % of recorded
   -- times that the value was Yes.
   QC_Hit_cnt          FLOAT,
   QC_Hit_sum          FLOAT,
   Full_scan_cnt       FLOAT,
   Full_scan_sum       FLOAT,
   Full_join_cnt       FLOAT,
   Full_join_sum       FLOAT,
   Tmp_table_cnt       FLOAT,
   Tmp_table_sum       FLOAT,
   Disk_tmp_table_cnt  FLOAT,
   Disk_tmp_table_sum  FLOAT,
   Filesort_cnt        FLOAT,
   Filesort_sum        FLOAT,
   Disk_filesort_cnt   FLOAT,
   Disk_filesort_sum   FLOAT,
   PRIMARY KEY(checksum, ts_min, ts_max)
 );
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Note that we store the count (cnt) for the ts attribute only; it will be
      redundant to store this for other attributes.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--run-time</dt>
  <dd class="It-tag">type: time
    <div style="height: 1.00em;">&#x00A0;</div>
    How long to run for each &quot;--iterations&quot;. The default is to run
      forever (you can interrupt with CTRL-C). Because &quot;--iterations&quot;
      defaults to 1, if you only specify &quot;--run-time&quot;, mk-query-digest
      runs for that amount of time and then exits. The two options are specified
      together to do collect-and-report cycles. For example, specifying
      &quot;--iterations&quot; 4 &quot;--run-time&quot; &quot;15m&quot; with a
      continuous input (like STDIN or &quot;--processlist&quot;) will cause
      mk-query-digest to run for 1 hour (15 minutes x 4), reporting four times,
      once at each 15 minute interval.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--run-time-mode</dt>
  <dd class="It-tag">type: string; default: clock
    <div style="height: 1.00em;">&#x00A0;</div>
    Set what the value of &quot;--run-time&quot; operates on. Following are the
      possible values for this option:</dd>
</dl>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">clock</dt>
  <dd class="It-tag">&quot;--run-time&quot; specifies an amount of real clock
      time during which the tool should run for each
    &quot;--iterations&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">event</dt>
  <dd class="It-tag">&quot;--run-time&quot; specifies an amount of log time. Log
      time is determined by timestamps in the log. The first timestamp seen is
      remembered, and each timestamp after that is compared to the first to
      determine how much log time has passed. For example, if the first
      timestamp seen is &quot;12:00:00&quot; and the next is
      &quot;12:01:30&quot;, that is 1 minute and 30 seconds of log time. The
      tool will read events until the log time is greater than or equal to the
      specified &quot;--run-time&quot; value.
    <div style="height: 1.00em;">&#x00A0;</div>
    Since timestamps in logs are not always printed, or not always printed
      frequently, this mode varies in accuracy.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">interval</dt>
  <dd class="It-tag">&quot;--run-time&quot; specifies interval boundaries of log
      time into which events are divided and reports are generated. This mode is
      different from the others because it doesn't specify how long to run. The
      value of &quot;--run-time&quot; must be an interval that divides evenly
      into minutes, hours or days. For example, &quot;5m&quot; divides evenly
      into hours (60/5=12, so 12 5 minutes intervals per hour) but
      &quot;7m&quot; does not (60/7=8.6).
    <div style="height: 1.00em;">&#x00A0;</div>
    Specifying &quot;--run-time-mode interval --run-time 30m --iterations
      0&quot; is similar to specifying &quot;--run-time-mode clock --run-time
      30m --iterations 0&quot;. In the latter case, mk-query-digest will run
      forever, producing reports every 30 minutes, but this only works
      effectively with continuous inputs like STDIN and the processlist. For
      fixed inputs, like log files, the former example produces multiple reports
      by dividing the log into 30 minutes intervals based on timestamps.
    <div style="height: 1.00em;">&#x00A0;</div>
    Intervals are calculated from the zeroth second/minute/hour in which a
      timestamp occurs, not from whatever time it specifies. For example, with
      30 minute intervals and a timestamp of &quot;12:10:30&quot;, the interval
      is <i>not</i> &quot;12:10:30&quot; to &quot;12:40:30&quot;, it is
      &quot;12:00:00&quot; to &quot;12:29:59&quot;. Or, with 1 hour intervals,
      it is &quot;12:00:00&quot; to &quot;12:59:59&quot;. When a new timestamp
      exceeds the interval, a report is printed, and the next interval is
      recalculated based on the new timestamp.
    <div style="height: 1.00em;">&#x00A0;</div>
    Since &quot;--iterations&quot; is 1 by default, you probably want to specify
      a new value else mk-query-digest will only get and report on the first
      interval from the log since 1 interval = 1 iteration. If you want to get
      and report every interval in a log, specify &quot;--iterations&quot;
    0.</dd>
</dl>
</div>
<div style="margin-left: 4.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag">--sample</dt>
  <dd class="It-tag">type: int
    <div style="height: 1.00em;">&#x00A0;</div>
    Filter out all but the first N occurrences of each query. The queries are
      filtered on the first value in &quot;--group-by&quot;, so by default, this
      will filter by query fingerprint. For example, &quot;--sample 2&quot; will
      permit two sample queries for each fingerprint. Useful in conjunction with
      &quot;--print&quot; to print out the queries. You probably want to set
      &quot;--no-report&quot; to avoid the overhead of aggregating and reporting
      if you're just using this to print out samples of queries. A complete
      example:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  mk-query-digest --sample 2 --no-report --print slow.log
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--save-results</dt>
  <dd class="It-tag">type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Save results to the specified file.
    <div style="height: 1.00em;">&#x00A0;</div>
    If &quot;--[no]gzip&quot; is true (by default it is) then .gz is appended to
      the file name.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--select</dt>
  <dd class="It-tag">type: Array
    <div style="height: 1.00em;">&#x00A0;</div>
    Compute aggregate statistics for these attributes.
    <div style="height: 1.00em;">&#x00A0;</div>
    By default mk-query-digest auto-detects, aggregates and prints metrics for
      every query attribute that it finds in the slow query log. This option
      specifies a list of only the attributes that you want. You can specify an
      alternative attribute with a colon. For example, &quot;db:Schema&quot;
      uses db if it's available, and Schema if it's not.
    <div style="height: 1.00em;">&#x00A0;</div>
    Previously, mk-query-digest only aggregated these attributes:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  Query_time,Lock_time,Rows_sent,Rows_examined,user,db:Schema,ts
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Attributes specified in the &quot;--review-history&quot; table will always
      be selected even if you do not specify &quot;--select&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    See also &quot;--ignore-attributes&quot; and &quot;ATTRIBUTES&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--set-vars</dt>
  <dd class="It-tag">type: string; default: wait_timeout=10000
    <div style="height: 1.00em;">&#x00A0;</div>
    Set these MySQL variables. Immediately after connecting to MySQL, this
      string will be appended to SET and executed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--shorten</dt>
  <dd class="It-tag">type: int; default: 1024
    <div style="height: 1.00em;">&#x00A0;</div>
    Shorten long statements in reports.
    <div style="height: 1.00em;">&#x00A0;</div>
    Shortens long statements, replacing the omitted portion with a &quot;/*...
      omitted ...*/&quot; comment. This applies only to the output in reports,
      not to information stored for &quot;--review&quot; or other places. It
      prevents a large statement from causing difficulty in a report. The
      argument is the preferred length of the shortened statement. Not all
      statements can be shortened, but very large INSERT and similar statements
      often can; and so can <i>IN()</i> lists, although only the first such list
      in the statement will be shortened.
    <div style="height: 1.00em;">&#x00A0;</div>
    If it shortens something beyond recognition, you can find the original
      statement in the log, at the offset shown in the report header (see
      &quot;OUTPUT&quot;).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--show-all</dt>
  <dd class="It-tag">type: Hash
    <div style="height: 1.00em;">&#x00A0;</div>
    Show all values for these attributes.
    <div style="height: 1.00em;">&#x00A0;</div>
    By default mk-query-digest only shows as many of an attribute's value that
      fit on a single line. This option allows you to specify attributes for
      which all values will be shown (line width is ignored). This only works
      for attributes with string values like user, host, db, etc. Multiple
      attributes can be specified, comma-separated.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--since</dt>
  <dd class="It-tag">type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Parse only queries newer than this value (parse queries since this date).
    <div style="height: 1.00em;">&#x00A0;</div>
    This option allows you to ignore queries older than a certain value and
      parse only those queries which are more recent than the value. The value
      can be several types:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  * Simple time value N with optional suffix: N[shmd], where
    s=seconds, h=hours, m=minutes, d=days (default s if no suffix
    given); this is like saying &quot;since N[shmd] ago&quot;
  * Full date with optional hours:minutes:seconds:
    YYYY-MM-DD [HH:MM::SS]
  * Short, MySQL-style date:
    YYMMDD [HH:MM:SS]
  * Any time expression evaluated by MySQL:
    CURRENT_DATE - INTERVAL 7 DAY
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    If you give a MySQL time expression, then you must also specify a DSN so
      that mk-query-digest can connect to MySQL to evaluate the expression. If
      you specify &quot;--execute&quot;, &quot;--explain&quot;,
      &quot;--processlist&quot;, &quot;--review&quot; or
      &quot;--review-history&quot;, then one of these DSNs will be used
      automatically. Otherwise, you must specify an &quot;--aux-dsn&quot; or
      mk-query-digest will die saying that the value is invalid.
    <div style="height: 1.00em;">&#x00A0;</div>
    The MySQL time expression is wrapped inside a query like &quot;SELECT
      UNIX_TIMESTAMP(&lt;expression&gt;)&quot;, so be sure that the expression
      is valid inside this query. For example, do not use
      <i>UNIX_TIMESTAMP()</i> because UNIX_TIMESTAMP( <i>UNIX_TIMESTAMP()</i>)
      returns 0.
    <div style="height: 1.00em;">&#x00A0;</div>
    Events are assumed to be in chronological--older events at the beginning of
      the log and newer events at the end of the log. &quot;--since&quot; is
      strict: it ignores all queries until one is found that is new enough.
      Therefore, if the query events are not consistently timestamped, some may
      be ignored which are actually new enough.
    <div style="height: 1.00em;">&#x00A0;</div>
    See also &quot;--until&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--socket</dt>
  <dd class="It-tag">short form: -S; type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Socket file to use for connection.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--statistics</dt>
  <dd class="It-tag">Print statistics about internal counters. This option is
      mostly for development and debugging. The statistics report is printed for
      each iteration after all other reports, even if no events are processed or
      &quot;--no-report&quot; is specified. The statistics report looks like:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
   # No events processed.
   # Statistic                                        Count  %/Events
   # ================================================ ====== ========
   # events_read                                      142030   100.00
   # events_parsed                                     50430    35.51
   # events_aggregated                                     0     0.00
   # ignored_midstream_server_response                 18111    12.75
   # no_tcp_data                                       91600    64.49
   # pipeline_restarted_after_MemcachedProtocolParser 142030   100.00
   # pipeline_restarted_after_TcpdumpParser                1     0.00
   # unknown_client_command                                1     0.00
   # unknown_client_data                               32318    22.75
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    The first column is the internal counter name; the second column is
      counter's count; and the third column is the count as a percentage of
      &quot;events_read&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    In this case, it shows why no events were processed/aggregated: 100% of
      events were rejected by the &quot;MemcachedProtocolParser&quot;. Of those,
      35.51% were data packets, but of these 12.75% of ignored mid-stream server
      response, one was an unknown client command, and 22.75% were unknown
      client data. The other 64.49% were TCP control packets (probably most
      ACKs).
    <div style="height: 1.00em;">&#x00A0;</div>
    Since mk-query-digest is complex, you will probably need someone familiar
      with its code to decipher the statistics report.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--table-access</dt>
  <dd class="It-tag">Print a table access report.
    <div style="height: 1.00em;">&#x00A0;</div>
    The table access report shows which tables are accessed by all the queries
      and if the access is a read or write. The report looks like:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  write `baz`.`tbl`
  read `baz`.`new_tbl`
  write `baz`.`tbl3`
  write `db6`.`tbl6`
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    If you pipe the output to sort, the read and write tables will be grouped
      together and sorted alphabetically:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  read `baz`.`new_tbl`
  write `baz`.`tbl`
  write `baz`.`tbl3`
  write `db6`.`tbl6`
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--tcpdump-errors</dt>
  <dd class="It-tag">type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Write the tcpdump data to this file on error. If mk-query-digest doesn't
      parse the stream correctly for some reason, the session's packets since
      the last query event will be written out to create a usable test case. If
      this happens, mk-query-digest will not raise an error; it will just
      discard the session's saved state and permit the tool to continue working.
      See &quot;tcpdump&quot; for more information about parsing tcpdump
    output.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--timeline</dt>
  <dd class="It-tag">Show a timeline of events.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option makes mk-query-digest print another kind of report: a timeline
      of the events. Each query is still grouped and aggregate into classes
      according to &quot;--group-by&quot;, but then they are printed in
      chronological order. The timeline report prints out the timestamp,
      interval, count and value of each classes.
    <div style="height: 1.00em;">&#x00A0;</div>
    If all you want is the timeline report, then specify &quot;--no-report&quot;
      to suppress the default query analysis report. Otherwise, the timeline
      report will be printed at the end before the response-time profile (see
      &quot;--report-format&quot; and &quot;OUTPUT&quot;).
    <div style="height: 1.00em;">&#x00A0;</div>
    For example, this:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  mk-query-digest /path/to/log --group-by distill --timeline
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    will print something like:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  # ########################################################
  # distill report
  # ########################################################
  # 2009-07-25 11:19:27 1+00:00:01   2 SELECT foo
  # 2009-07-27 11:19:30      00:01   2 SELECT bar
  # 2009-07-27 11:30:00 1+06:30:00   2 SELECT foo
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--type</dt>
  <dd class="It-tag">type: Array
    <div style="height: 1.00em;">&#x00A0;</div>
    The type of input to parse (default slowlog). The permitted types are</dd>
</dl>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">binlog</dt>
  <dd class="It-tag">Parse a binary log file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">genlog</dt>
  <dd class="It-tag">Parse a MySQL general log file. General logs lack a lot of
      &quot;ATTRIBUTES&quot;, notably &quot;Query_time&quot;. The default
      &quot;--order-by&quot; for general logs changes to
      &quot;Query_time:cnt&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">http</dt>
  <dd class="It-tag">Parse HTTP traffic from tcpdump.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">pglog</dt>
  <dd class="It-tag">Parse a log file in PostgreSQL format. The parser will
      automatically recognize logs sent to syslog and transparently parse the
      syslog format, too. The recommended configuration for logging in your
      postgresql.conf is as follows.
    <div style="height: 1.00em;">&#x00A0;</div>
    The log_destination setting can be set to either syslog or stderr. Syslog
      has the added benefit of not interleaving log messages from several
      sessions concurrently, which the parser cannot handle, so this might be
      better than stderr. CSV-formatted logs are not supported at this time.
    <div style="height: 1.00em;">&#x00A0;</div>
    The log_min_duration_statement setting should be set to 0 to capture all
      statements with their durations. Alternatively, the parser will also
      recognize and handle various combinations of log_duration and
      log_statement.
    <div style="height: 1.00em;">&#x00A0;</div>
    You may enable log_connections and log_disconnections, but this is optional.
    <div style="height: 1.00em;">&#x00A0;</div>
    It is highly recommended to set your log_line_prefix to the following:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  log_line_prefix = '%m c=%c,u=%u,D=%d '
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    This lets the parser find timestamps with milliseconds, session IDs, users,
      and databases from the log. If these items are missing, you'll simply get
      less information to analyze. For compatibility with other log analysis
      tools such as PQA and pgfouine, various log line prefix formats are
      supported. The general format is as follows: a timestamp can be detected
      and extracted (the syslog timestamp is NOT parsed), and a name=value list
      of properties can also. Although the suggested format is as shown above,
      any name=value list will be captured and interpreted by using the first
      letter of the 'name' part, lowercased, to determine the meaning of the
      item. The lowercased first letter is interpreted to mean the same thing as
      PostgreSQL's built-in %-codes for the log_line_prefix format string. For
      example, u means user, so unicorn=fred will be interpreted as user=fred; d
      means database, so D=john will be interpreted as database=john. The
      pgfouine-suggested formatting is user=%u and db=%d, so it should Just Work
      regardless of which format you choose. The main thing is to add as much
      information as possible into the log_line_prefix to permit richer
      analysis.
    <div style="height: 1.00em;">&#x00A0;</div>
    Currently, only English locale messages are supported, so if your server's
      locale is set to something else, the log won't be parsed properly. (Log
      messages with &quot;duration:&quot; and &quot;statement:&quot; won't be
      recognized.)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">slowlog</dt>
  <dd class="It-tag">Parse a log file in any variation of MySQL slow-log
    format.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">tcpdump</dt>
  <dd class="It-tag">Inspect network packets and decode the MySQL client
      protocol, extracting queries and responses from it.
    <div style="height: 1.00em;">&#x00A0;</div>
    mk-query-digest does not actually watch the network (i.e. it does NOT
      &quot;sniff packets&quot;). Instead, it's just parsing the output of
      tcpdump. You are responsible for generating this output; mk-query-digest
      does not do it for you. Then you send this to mk-query-digest as you would
      any log file: as files on the command line or to STDIN.
    <div style="height: 1.00em;">&#x00A0;</div>
    The parser expects the input to be formatted with the following options:
      &quot;-x -n -q -tttt&quot;. For example, if you want to capture output
      from your local machine, you can do something like the following (the port
      must come last on FreeBSD):
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  tcpdump -s 65535 -x -nn -q -tttt -i any -c 1000 port 3306 \
    &gt; mysql.tcp.txt
  mk-query-digest --type tcpdump mysql.tcp.txt
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    The other tcpdump parameters, such as -s, -c, and -i, are up to you. Just
      make sure the output looks like this (there is a line break in the first
      line to avoid man-page problems):
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  2009-04-12 09:50:16.804849 IP 127.0.0.1.42167
         &gt; 127.0.0.1.3306: tcp 37
      0x0000:  4508 0059 6eb2 4000 4006 cde2 7f00 0001
      0x0010:  ....
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Remember tcpdump has a handy -c option to stop after it captures some number
      of packets! That's very useful for testing your tcpdump command. Note that
      tcpdump can't capture traffic on a Unix socket. Read
      &lt;http://bugs.mysql.com/bug.php?id=31577&gt; if you're confused about
      this.
    <div style="height: 1.00em;">&#x00A0;</div>
    Devananda Van Der Veen explained on the MySQL Performance Blog how to
      capture traffic without dropping packets on busy servers. Dropped packets
      cause mk-query-digest to miss the response to a request, then see the
      response to a later request and assign the wrong execution time to the
      query. You can change the filter to something like the following to help
      capture a subset of the queries. (See
      &lt;http://www.mysqlperformanceblog.com/?p=6092&gt; for details.)
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  tcpdump -i any -s 65535 -x -n -q -tttt \
     'port 3306 and tcp[1] &amp; 7 == 2 and tcp[3] &amp; 7 == 2'
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    All MySQL servers running on port 3306 are automatically detected in the
      tcpdump output. Therefore, if the tcpdump out contains packets from
      multiple servers on port 3306 (for example, 10.0.0.1:3306, 10.0.0.2:3306,
      etc.), all packets/queries from all these servers will be analyzed
      together as if they were one server.
    <div style="height: 1.00em;">&#x00A0;</div>
    If you're analyzing traffic for a MySQL server that is not running on port
      3306, see &quot;--watch-server&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    Also note that mk-query-digest may fail to report the database for queries
      when parsing tcpdump output. The database is discovered only in the
      initial connect events for a new client or when &lt;USE db&gt; is
      executed. If the tcpdump output contains neither of these, then
      mk-query-digest cannot discover the database.
    <div style="height: 1.00em;">&#x00A0;</div>
    Server-side prepared statements are supported. SSL-encrypted traffic cannot
      be inspected and decoded.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">memcached</dt>
  <dd class="It-tag">Similar to tcpdump, but the expected input is memcached
      packets instead of MySQL packets. For example:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  tcpdump -i any port 11211 -s 65535 -x -nn -q -tttt \
    &gt; memcached.tcp.txt
  mk-query-digest --type memcached memcached.tcp.txt
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    memcached uses port 11211 by default.</dd>
</dl>
</div>
<div style="margin-left: 4.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag">--until</dt>
  <dd class="It-tag">type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    Parse only queries older than this value (parse queries until this date).
    <div style="height: 1.00em;">&#x00A0;</div>
    This option allows you to ignore queries newer than a certain value and
      parse only those queries which are older than the value. The value can be
      one of the same types listed for &quot;--since&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    Unlike &quot;--since&quot;, &quot;--until&quot; is not strict: all queries
      are parsed until one has a timestamp that is equal to or greater than
      &quot;--until&quot;. Then all subsequent queries are ignored.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--user</dt>
  <dd class="It-tag">short form: -u; type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    User for login if not current user.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--variations</dt>
  <dd class="It-tag">type: Array
    <div style="height: 1.00em;">&#x00A0;</div>
    Report the number of variations in these attributes' values.
    <div style="height: 1.00em;">&#x00A0;</div>
    Variations show how many distinct values an attribute had within a class.
      The usual value for this option is &quot;arg&quot; which shows how many
      distinct queries were in the class. This can be useful to determine a
      query's cacheability.
    <div style="height: 1.00em;">&#x00A0;</div>
    Distinct values are determined by CRC32 checksums of the attributes' values.
      These checksums are reported in the query report for attributes specified
      by this option, like:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  # arg crc      109 (1/25%), 144 (1/25%)... 2 more
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    In that class there were 4 distinct queries. The checksums of the first two
      variations are shown, and each one occurred once (or, 25% of the time).
    <div style="height: 1.00em;">&#x00A0;</div>
    The counts of distinct variations is approximate because only 1,000
      variations are saved. The mod (%) 1000 of the full CRC32 checksum is
      saved, so some distinct checksums are treated as equal.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--version</dt>
  <dd class="It-tag">Show version and exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--watch-server</dt>
  <dd class="It-tag">type: string
    <div style="height: 1.00em;">&#x00A0;</div>
    This option tells mk-query-digest which server IP address and port (like
      &quot;10.0.0.1:3306&quot;) to watch when parsing tcpdump (for
      &quot;--type&quot; tcpdump and memcached); all other servers are ignored.
      If you don't specify it, mk-query-digest watches all servers by looking
      for any IP address using port 3306 or &quot;mysql&quot;. If you're
      watching a server with a non-standard port, this won't work, so you must
      specify the IP address and port to watch.
    <div style="height: 1.00em;">&#x00A0;</div>
    If you want to watch a mix of servers, some running on standard port 3306
      and some running on non-standard ports, you need to create separate
      tcpdump outputs for the non-standard port servers and then specify this
      option for each. At present mk-query-digest cannot auto-detect servers on
      port 3306 and also be told to watch a server on a non-standard port.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--[no]zero-admin</dt>
  <dd class="It-tag">default: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Zero out the Rows_XXX properties for administrator command events.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--[no]zero-bool</dt>
  <dd class="It-tag">default: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Print 0% boolean values in report.</dd>
</dl>
<h1 class="Sh" title="Sh" id="DSN_OPTIONS"><a class="selflink" href="#DSN_OPTIONS">DSN
  OPTIONS</a></h1>
These DSN options are used to create a DSN. Each option is given like
  &quot;option=value&quot;. The options are case-sensitive, so P and p are not
  the same option. There cannot be whitespace before or after the &quot;=&quot;
  and if the value contains whitespace it must be quoted. DSN options are
  comma-separated. See the maatkit manpage for full details.
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">A
    <div style="height: 1.00em;">&#x00A0;</div>
    dsn: charset; copy: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Default character set.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">D
    <div style="height: 1.00em;">&#x00A0;</div>
    dsn: database; copy: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Database that contains the query review table.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">F
    <div style="height: 1.00em;">&#x00A0;</div>
    dsn: mysql_read_default_file; copy: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Only read default options from the given file</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">h
    <div style="height: 1.00em;">&#x00A0;</div>
    dsn: host; copy: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Connect to host.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">p
    <div style="height: 1.00em;">&#x00A0;</div>
    dsn: password; copy: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Password to use when connecting.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">P
    <div style="height: 1.00em;">&#x00A0;</div>
    dsn: port; copy: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Port number to use for connection.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">S
    <div style="height: 1.00em;">&#x00A0;</div>
    dsn: mysql_socket; copy: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    Socket file to use for connection.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">t
    <div style="height: 1.00em;">&#x00A0;</div>
    Table to use as the query review table.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">u
    <div style="height: 1.00em;">&#x00A0;</div>
    dsn: user; copy: yes
    <div style="height: 1.00em;">&#x00A0;</div>
    User for login if not current user.</dd>
</dl>
<h1 class="Sh" title="Sh" id="DOWNLOADING"><a class="selflink" href="#DOWNLOADING">DOWNLOADING</a></h1>
You can download Maatkit from Google Code at
  &lt;http://code.google.com/p/maatkit/&gt;, or you can get any of the tools
  easily with a command like the following:
<div class="Pp"></div>
<pre>
   wget http://www.maatkit.org/get/toolname
   or
   wget http://www.maatkit.org/trunk/toolname
</pre>
<div class="Pp"></div>
Where &quot;toolname&quot; can be replaced with the name (or fragment of a name)
  of any of the Maatkit tools. Once downloaded, they're ready to run; no
  installation is needed. The first URL gets the latest released version of the
  tool, and the second gets the latest trunk code from Subversion.
<h1 class="Sh" title="Sh" id="ENVIRONMENT"><a class="selflink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
The environment variable &quot;MKDEBUG&quot; enables verbose debugging output in
  all of the Maatkit tools:
<div class="Pp"></div>
<pre>
   MKDEBUG=1 mk-....
</pre>
<h1 class="Sh" title="Sh" id="SYSTEM_REQUIREMENTS"><a class="selflink" href="#SYSTEM_REQUIREMENTS">SYSTEM
  REQUIREMENTS</a></h1>
You need Perl and some core packages that ought to be installed in any
  reasonably new version of Perl.
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
For a list of known bugs see
  &lt;http://www.maatkit.org/bugs/mk-query-digest&gt;.
<div class="Pp"></div>
Please use Google Code Issues and Groups to report bugs or request support:
  &lt;http://code.google.com/p/maatkit/&gt;. You can also join #maatkit on
  Freenode to discuss Maatkit.
<div class="Pp"></div>
Please include the complete command-line used to reproduce the problem you are
  seeing, the version of all MySQL servers involved, the complete output of the
  tool when run with &quot;--version&quot;, and if possible, debugging output
  produced by running with the &quot;MKDEBUG=1&quot; environment variable.
<h1 class="Sh" title="Sh" id="COPYRIGHT,_LICENSE_AND_WARRANTY"><a class="selflink" href="#COPYRIGHT,_LICENSE_AND_WARRANTY">COPYRIGHT,
  LICENSE AND WARRANTY</a></h1>
This program is copyright 2007-2011 Baron Schwartz. Feedback and improvements
  are welcome.
<div class="Pp"></div>
THIS PROGRAM IS PROVIDED &quot;AS IS&quot; AND WITHOUT ANY EXPRESS OR IMPLIED
  WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF
  MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
<div class="Pp"></div>
This program is free software; you can redistribute it and/or modify it under
  the terms of the GNU General Public License as published by the Free Software
  Foundation, version 2; OR the Perl Artistic License. On UNIX and similar
  systems, you can issue `man perlgpl' or `man perlartistic' to read these
  licenses.
<div class="Pp"></div>
You should have received a copy of the GNU General Public License along with
  this program; if not, write to the Free Software Foundation, Inc., 59 Temple
  Place, Suite 330, Boston, MA 02111-1307 USA.
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Baron Schwartz, Daniel Nichter
<h1 class="Sh" title="Sh" id="ABOUT_MAATKIT"><a class="selflink" href="#ABOUT_MAATKIT">ABOUT
  MAATKIT</a></h1>
This tool is part of Maatkit, a toolkit for power users of MySQL. Maatkit was
  created by Baron Schwartz; Baron and Daniel Nichter are the primary code
  contributors. Both are employed by Percona. Financial support for Maatkit
  development is primarily provided by Percona and its clients.
<h1 class="Sh" title="Sh" id="VERSION"><a class="selflink" href="#VERSION">VERSION</a></h1>
This manual page documents Ver 0.9.29 Distrib 7540 $Revision: 7531 $.</div>
<table class="foot">
  <tr>
    <td class="foot-date">2011-06-08</td>
    <td class="foot-os">perl v5.24.1</td>
  </tr>
</table>
</body>
</html>
