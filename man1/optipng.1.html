<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>OPTIPNG(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">OPTIPNG(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">OPTIPNG(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<b>OptiPNG</b> - Optimize Portable Network Graphics files
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>optipng</b> [ <b>-?</b> | <b>-h</b> | <b>-help</b>]
<div>&#x00A0;</div>
<b>optipng</b> [ <i>options...</i>] <i>files...</i>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <b>OptiPNG</b> program shall attempt to <i>optimize</i> PNG files, i.e.
  reduce their size to a minimum, without losing semantic information. In
  addition, this program shall perform a suite of auxiliary functions like
  integrity checks, metadata recovery and pixmap-to-PNG conversion.
<div class="Pp"></div>
The optimization attempts are not guaranteed to succeed. Valid PNG files that
  cannot be optimized by this program are normally left intact; their size will
  not grow. The user may request to override this default behavior.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
The input files are raster image files encoded either in PNG format (the native
  format), or in an external format. The currently supported external formats
  are GIF, BMP, PNM and TIFF.
<div class="Pp"></div>
<b>OptiPNG</b> processes each image file given in the command line as follows:
<div class="Pp"></div>
- If the image is in PNG format:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Attempts to optimize the given file in-place. If
      optimization is successful, or if the option <b>-force</b> is enabled,
      replaces the original file with its optimized version. The original file
      is backed up if the option <b>-keep</b> is enabled.</dd>
</dl>
<div class="Pp"></div>
- If the image is in an external format:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Creates an optimized PNG version of the given file. The
      output file name is composed from the original file name and the .png
      extension.</dd>
</dl>
<div class="Pp"></div>
Existing files are <i>not</i> overwritten, unless the option <b>-clobber</b> is
  enabled.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<h2 class="Ss" title="Ss" id="General_options"><a class="selflink" href="#General_options">General
  options</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-?</b>, <b>-h</b>, <b>-help</b></dt>
  <dd class="It-tag">Show a complete summary of options.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-backup</b>, <b>-keep</b></dt>
  <dd class="It-tag">Keep a backup of the modified files.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-clobber</b></dt>
  <dd class="It-tag">Overwrite the existing output and backup files.
    <div>&#x00A0;</div>
    Under this option, if the option <b>-backup</b> is not enabled, the old
      backups of the overwritten files are deleted.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-dir</b> <i>directory</i></dt>
  <dd class="It-tag">Write the output files to <i>directory</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-fix</b></dt>
  <dd class="It-tag">Enable error recovery. This option has no effect on valid
      input files.
    <div>&#x00A0;</div>
    The program will spend a reasonable amount of effort to recover as much data
      as possible, without increasing the output file size, but the success
      cannot be generally guaranteed. The program may even increase the file
      size, e.g., by reconstructing missing critical data. Under this option,
      integrity shall take precedence over file size.
    <div>&#x00A0;</div>
    When this option is not used, the invalid input files are left
    unprocessed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-force</b></dt>
  <dd class="It-tag">Enforce writing of a new output file.
    <div>&#x00A0;</div>
    This option overrides the program's decision not to write such file, e.g.
      when the PNG input is digitally signed (using dSIG), or when the PNG
      output becomes larger than the PNG input.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-log</b> <i>file</i></dt>
  <dd class="It-tag">Log messages to <i>file</i>. For safety reasons,
      <i>file</i> must have the extension .log.
    <div>&#x00A0;</div>
    This option is deprecated and will be removed eventually. Use shell
      redirection.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-out</b> <i>file</i></dt>
  <dd class="It-tag">Write output file to <i>file</i>. The command line must
      contain exactly one input file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-preserve</b></dt>
  <dd class="It-tag">Preserve file attributes (time stamps, file access rights,
      etc.) where applicable.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-quiet</b>, <b>-silent</b></dt>
  <dd class="It-tag">Run in quiet mode.
    <div>&#x00A0;</div>
    The messages are still written to the log file if the option <b>-log</b> is
      enabled.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-simulate</b></dt>
  <dd class="It-tag">Run in simulation mode: perform the trials, but do not
      create output files.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v</b></dt>
  <dd class="It-tag">Enable the options <b>-verbose</b> and
    <b>-version</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-verbose</b></dt>
  <dd class="It-tag">Run in verbose mode.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-version</b></dt>
  <dd class="It-tag">Show copyright, version and build info.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--</b></dt>
  <dd class="It-tag">Stop option switch parsing.</dd>
</dl>
<h2 class="Ss" title="Ss" id="PNG_encoding_and_optimization_options"><a class="selflink" href="#PNG_encoding_and_optimization_options">PNG
  encoding and optimization options</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-o</b> <i>level</i></dt>
  <dd class="It-tag">Select the optimization level.
    <div>&#x00A0;</div>
    The optimization level 0 enables a set of optimization operations that
      require minimal effort. There will be no changes to image attributes like
      bit depth or color type, and no recompression of existing IDAT
      datastreams.
    <div>&#x00A0;</div>
    The optimization level 1 enables a single IDAT compression trial. The trial
      chosen is what <b>OptiPNG</b> <i>thinks</i> it's probably the most
      effective.
    <div>&#x00A0;</div>
    The optimization levels 2 and higher enable multiple IDAT compression
      trials; the higher the level, the more trials.
    <div>&#x00A0;</div>
    The behavior and the default value of this option may change across
      different program versions. Use the option <b>-h</b> to see the details
      pertaining to your specific version.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b> <i>filters</i></dt>
  <dd class="It-tag">Select the PNG delta filters.
    <div>&#x00A0;</div>
    The <i>filters</i> argument is specified as a rangeset (e.g. <b>-f0-5</b>),
      and the default <i>filters</i> value depends on the optimization level set
      by the option <b>-o</b>.
    <div>&#x00A0;</div>
    The filter values 0, 1, 2, 3 and 4 indicate static filtering, and correspond
      to the standard PNG filter codes ( <i>None</i>, <i>Left</i>, <i>Up</i>,
      <i>Average</i> and <i>Paeth</i>, respectively). The filter value 5
      indicates adaptive filtering, whose effect is defined by the
      <b>libpng</b>(3) library used by <b>OptiPNG</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-full</b></dt>
  <dd class="It-tag">Produce a full report on IDAT. This option might slow down
      the trials.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i</b> <i>type</i></dt>
  <dd class="It-tag">Select the interlace type (0-1).
    <div>&#x00A0;</div>
    If the interlace type 0 is selected, the output image shall be
      non-interlaced (i.e. progressive-scanned). If the interlace type 1 is
      selected, the output image shall be interlaced using the <i>Adam7</i>
      method.
    <div>&#x00A0;</div>
    By default, the output shall have the same interlace type as the input.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-nb</b></dt>
  <dd class="It-tag">Do not apply bit depth reduction.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-nc</b></dt>
  <dd class="It-tag">Do not apply color type reduction.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-np</b></dt>
  <dd class="It-tag">Do not apply palette reduction.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-nx</b></dt>
  <dd class="It-tag">Do not apply any lossless image reduction: enable the
      options <b>-nb</b>, <b>-nc</b> and <b>-np</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-nz</b></dt>
  <dd class="It-tag">Do not recode IDAT datastreams.
    <div>&#x00A0;</div>
    The IDAT optimization operations that do not require recoding (e.g. IDAT
      chunk concatenation) are still performed.
    <div>&#x00A0;</div>
    This option has effect on PNG input files only.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-zc</b> <i>levels</i></dt>
  <dd class="It-tag">Select the zlib compression levels used in IDAT
      compression.
    <div>&#x00A0;</div>
    The <i>levels</i> argument is specified as a rangeset (e.g. <b>-zc6-9</b>),
      and the default <i>levels</i> value depends on the optimization level set
      by the option <b>-o</b>.
    <div>&#x00A0;</div>
    The effect of this option is defined by the <b>zlib</b>(3) library used by
      <b>OptiPNG</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-zm</b> <i>levels</i></dt>
  <dd class="It-tag">Select the zlib memory levels used in IDAT compression.
    <div>&#x00A0;</div>
    The <i>levels</i> argument is specified as a rangeset (e.g. <b>-zm8-9</b>),
      and the default <i>levels</i> value depends on the optimization level set
      by the option <b>-o</b>.
    <div>&#x00A0;</div>
    The effect of this option is defined by the <b>zlib</b>(3) library used by
      <b>OptiPNG</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-zs</b> <i>strategies</i></dt>
  <dd class="It-tag">Select the zlib compression strategies used in IDAT
      compression.
    <div>&#x00A0;</div>
    The <i>strategies</i> argument is specified as a rangeset (e.g.
      <b>-zs0-3</b>), and the default <i>strategies</i> value depends on the
      optimization level set by the option <b>-o</b>.
    <div>&#x00A0;</div>
    The effect of this option is defined by the <b>zlib</b>(3) library used by
      <b>OptiPNG</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-zw</b> <i>size</i></dt>
  <dd class="It-tag">Select the zlib window size (32k,16k,8k,4k,2k,1k,512,256)
      used in IDAT compression.
    <div>&#x00A0;</div>
    The <i>size</i> argument can be specified either in bytes (e.g. 16384) or
      kilobytes (e.g. 16k). The default <i>size</i> value is set to the lowest
      window size that yields an IDAT output as big as if yielded by the value
      32768.
    <div>&#x00A0;</div>
    The effect of this option is defined by the <b>zlib</b>(3) library used by
      <b>OptiPNG</b>.</dd>
</dl>
<h2 class="Ss" title="Ss" id="Editing_options"><a class="selflink" href="#Editing_options">Editing
  options</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-snip</b></dt>
  <dd class="It-tag">Cut one image out of multi-image, animation or video files.
    <div>&#x00A0;</div>
    Depending on the input format, this may be either the first or the most
      relevant (e.g. the largest) image.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-strip</b> <i>objects</i></dt>
  <dd class="It-tag">Strip metadata objects from a PNG file.
    <div>&#x00A0;</div>
    PNG metadata is the information stored in any ancillary chunk except tRNS.
      (tRNS represents the alpha channel, which, even if ignored in rendering,
      is still a proper image channel in the RGBA color space.)
    <div>&#x00A0;</div>
    The only option currently supported is <b>-strip all</b>.</dd>
</dl>
<h2 class="Ss" title="Ss" id="Notes"><a class="selflink" href="#Notes">Notes</a></h2>
Options may come in any order (except for <b>--</b>), before, after, or
  alternating with file names. Option names are case-insensitive and may be
  abbreviated to their shortest unique prefix.
<div class="Pp"></div>
Some options may have arguments that follow the option name, separated by
  whitespace or the equal sign (' <b>=</b>'). If the option argument is a number
  or a rangeset, the separator may be omitted. For example:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><b>-out</b> newfile.png &#x00A0;&lt;=&gt;
      &#x00A0;<b>-out=</b>newfile.png
    <div>&#x00A0;</div>
     <b>-o3</b> &#x00A0;&lt;=&gt; &#x00A0;<b>-o 3</b> &#x00A0;&lt;=&gt;
      &#x00A0;<b>-o=3</b>
    <div>&#x00A0;</div>
     <b>-f0,3-5</b> &#x00A0;&lt;=&gt; &#x00A0;<b>-f 0,3-5</b> &#x00A0;&lt;=&gt;
      &#x00A0; <b>-f=0,3-5</b></dd>
</dl>
<div class="Pp"></div>
Rangeset arguments are cumulative; e.g.
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><b>-f0 -f3-5</b> &#x00A0;&lt;=&gt; &#x00A0;<b>-f0,3-5</b>
    <div>&#x00A0;</div>
     <b>-zs0 -zs1 -zs2-3</b> &#x00A0;&lt;=&gt; &#x00A0;<b>-zs0,1,2,3</b>
      &#x00A0;&lt;=&gt; &#x00A0; <b>-zs0-3</b>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="EXTENDED_DESCRIPTION"><a class="selflink" href="#EXTENDED_DESCRIPTION">EXTENDED
  DESCRIPTION</a></h1>
The PNG optimization algorithm consists of the following steps:
<dl class="Bl-tag">
  <dt class="It-tag">1.</dt>
  <dd class="It-tag">Reduce the bit depth, the color type and the color palette
      of the image. This step may reduce the size of the uncompressed image,
      which, indirectly, may reduce the size of the compressed image (i.e. the
      size of the output PNG file).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">2.</dt>
  <dd class="It-tag">Run a suite of compression methods and strategies and
      select the compression parameters that yield the smallest output
    file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">3.</dt>
  <dd class="It-tag">Store all IDAT contents into a single chunk, eliminating
      the overhead incurred by repeated IDAT headers and CRCs.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">4.</dt>
  <dd class="It-tag">Set the zlib window size inside IDAT to a mininum that does
      not affect the compression ratio, reducing the memory requirements of PNG
      decoders.</dd>
</dl>
<div class="Pp"></div>
Not all of the above steps need to be executed. The behavior depends on the
  actual input files and user options.
<div class="Pp"></div>
Step 1 may be customized via the no-reduce options <b>-nb</b>, <b>-nc</b>,
  <b>-np</b> and <b>-nx</b>. Step 2 may be customized via the <b>-o</b> option,
  and may be fine-tuned via the options <b>-zc</b>, <b>-zm</b>, <b>-zs</b> and
  <b>-zw</b>. Step 3 is always executed. Step 4 is executed only if a new IDAT
  is being created, and may be fine-tuned via the option <b>-zw</b>.
<div class="Pp"></div>
Extremely exhaustive searches are not generally expected to yield significant
  improvements in compression ratio, and are recommended to advanced users only.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
optipng file.png &#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;# default speed
<div>&#x00A0;</div>
optipng -o5 file.png &#x00A0;# slow
<div>&#x00A0;</div>
optipng -o7 file.png &#x00A0;# very slow
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Lossless image reductions are not completely implemented. (This does <i>not</i>
  affect the integrity of the output files.) Here are the missing pieces:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">- The color palette reductions are implemented only
      partially.
    <div>&#x00A0;</div>
    - The bit depth reductions below 8, for grayscale images, are not
      implemented yet.</dd>
</dl>
<div class="Pp"></div>
Encoding of images whose total IDAT size exceeds 2GB is not supported.
<div class="Pp"></div>
TIFF support is limited to uncompressed, PNG-compatible (grayscale, RGB and
  RGBA) images.
<div class="Pp"></div>
Metadata is not imported from the external image formats.
<div class="Pp"></div>
There is no support for pipes or streams.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>png</b>(5), <b>libpng</b>(3), <b>zlib</b>(3), <b>pngcrush</b>(1),
  <b>pngrewrite</b>(1).
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="STANDARDS"><a class="selflink" href="#STANDARDS">STANDARDS</a></h1>
The files produced by <b>OptiPNG</b> are compliant with <b>PNG-2003</b>:
<div>&#x00A0;</div>
Glenn Randers-Pehrson et al. <i>Portable Network Graphics (PNG) Specification,
  Second Edition</i>.
<div>&#x00A0;</div>
W3C Recommendation 10 November 2003; ISO/IEC IS 15948:2003 (E).
<div>&#x00A0;</div>
http://www.w3.org/TR/PNG/
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
<b>OptiPNG</b> is written and maintained by Cosmin Truta.
<div class="Pp"></div>
This manual page was originally written by Nelson A. de Oliveira for the Debian
  Project. It was later updated by Cosmin Truta, and is now part of the
  <b>OptiPNG</b> distribution.</div>
<table class="foot">
  <tr>
    <td class="foot-date">2012-Oct-21</td>
    <td class="foot-os">OptiPNG version 0.7.4</td>
  </tr>
</table>
</body>
</html>
