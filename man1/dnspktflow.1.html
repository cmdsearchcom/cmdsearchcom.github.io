<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:04:35 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>DNSPKTFLOW(1) User Contributed Perl Documentation
DNSPKTFLOW(1)</p>

<p style="margin-top: 1em">NAME <br>
dnspktflow - Analyze and draw DNS flow diagrams from a
tcpdump file</p>

<p style="margin-top: 1em">SYNOPSIS <br>
dnspktflow -o output.png file.tcpdump</p>

<p style="margin-top: 1em">dnspktflow -o output.png -x -a
-t -q file.tcpdump</p>

<p style="margin-top: 1em">DESCRIPTION <br>
The dnspktflow application takes a tcpdump network traffic
dump file, passes it through the tshark application and then
displays the resulting DNS packet flows in a &quot;flow-
<br>
diagram&quot; image. dnspktflow can output a single image or
a series of images which can then be shown in sequence as an
animation.</p>

<p style="margin-top: 1em">dnspktflow was written as a
debugging utility to help trace DNS queries and responses,
especially as they apply to DNSSEC-enabled lookups.</p>

<p style="margin-top: 1em">REQUIREMENTS <br>
This application requires the following Perl modules and
software components to work:</p>

<p style="margin-top: 1em">graphviz
(http://www.graphviz.org/) <br>
GraphViz (Perl module) <br>
tshark (http://www.wireshark.org/)</p>

<p style="margin-top: 1em">The following is required for
outputting screen presentations:</p>

<p style="margin-top: 1em">MagicPoint
(http://member.wide.ad.jp/wg/mgp/)</p>

<p style="margin-top: 1em">If the following modules are
installed, a GUI interface will be enabled for communication
with dnspktflow:</p>

<p style="margin-top: 1em">QWizard (Perl module) <br>
Getopt::GUI::Long (Perl module)</p>

<p style="margin-top: 1em">OPTIONS <br>
dnspktflow takes a wide variety of command-line options.
These options are described below in the following
functional groups: input packet selection, output file
options, <br>
output visualization options, graphical options, and
debugging.</p>

<p style="margin-top: 1em">Input Packet Selection <br>
These options determine the packets that will be selected by
dnspktflow.</p>

<p style="margin-top: 1em">-i STRING <br>
--ignore-hosts=STRING <br>
A regular expression of host names to ignore in the
query/response fields.</p>

<p style="margin-top: 1em">-r STRING <br>
--only-hosts=STRING <br>
A regular expression of host names to analyze in the
query/response fields.</p>

<p style="margin-top: 1em">-f <br>
--show-frame-num <br>
Display the packet frame numbers.</p>

<p style="margin-top: 1em">-b INTEGER <br>
--begin-frame=INTEGER <br>
Begin at packet frame NUMBER.</p>

<p style="margin-top: 1em">Output File Options <br>
These options determine the type and location of
dnspktflow&rsquo;s output.</p>

<p style="margin-top: 1em">-o STRING <br>
--output-file=STRING <br>
Output file name (default: out%03d.png as PNG format.)</p>

<p style="margin-top: 1em">--fig <br>
Output format should be fig.</p>

<p style="margin-top: 1em">-O STRING <br>
--tshark-out=STRING <br>
Save tshark output to this file.</p>

<p style="margin-top: 1em">-m <br>
--multiple-outputs <br>
One picture per request (use %03d in the filename.)</p>

<p style="margin-top: 1em">-M STRING <br>
--magic-point=STRING <br>
Saves a MagicPoint presentation for the output.</p>

<p style="margin-top: 1em">Output Visualization Options:
<br>
These options determine specifics of dnspktflow&rsquo;s
output.</p>

<p style="margin-top: 1em">--layout-style <br>
Selects the graphviz layout style to use (dot, neato, twopi,
circo, or fdp).</p>

<p style="margin-top: 1em">-L <br>
--last-line-labels-only <br>
Only show data on the last line drawn.</p>

<p style="margin-top: 1em">-z INTEGER <br>
--most-lines=INTEGER <br>
Only show at most INTEGER connections.</p>

<p style="margin-top: 1em">-T <br>
--input-is-tshark-out <br>
The input file is already processed by tshark.</p>

<p style="margin-top: 1em">Graphical Options: <br>
These options determine fields included in
dnspktflow&rsquo;s output.</p>

<p style="margin-top: 1em">-t <br>
--show-type <br>
Shows message type in result image.</p>

<p style="margin-top: 1em">-q <br>
--show-queries <br>
Shows query questions in result image.</p>

<p style="margin-top: 1em">-a <br>
--show-answers <br>
Shows query answers in result image.</p>

<p style="margin-top: 1em">-A <br>
--show-authoritative <br>
Shows authoritative information in result image.</p>

<p style="margin-top: 1em">-x <br>
--show-additional <br>
Shows additional information in result image.</p>

<p style="margin-top: 1em">-l <br>
--show-label-lines <br>
Shows lines attaching labels to lines.</p>

<p style="margin-top: 1em">--fontsize=INTEGER <br>
Font Size</p>

<p style="margin-top: 1em">Debugging: <br>
These options may assist in debugging dnspktflow.</p>

<p style="margin-top: 1em">-d <br>
--dump-pkts <br>
Dump data collected from the packets.</p>

<p style="margin-top: 1em">-h <br>
--help <br>
Show help for command line options.</p>

<p style="margin-top: 1em">COPYRIGHT <br>
Copyright 2004-2013 SPARTA, Inc. All rights reserved. See
the COPYING file included with the DNSSEC-Tools package for
details.</p>

<p style="margin-top: 1em">AUTHOR <br>
Wes Hardaker &lt;hardaker@users.sourceforge.net&gt;</p>

<p style="margin-top: 1em">SEE ALSO <br>
Getopt::GUI::Long(3) Net::DNS(3) QWizard.pm(3)</p>


<p style="margin-top: 1em">http://dnssec-tools.sourceforge.net/</p>

<p style="margin-top: 1em">perl v5.24.0 2015-06-30
DNSPKTFLOW(1)</p>
<hr>
</body>
</html>
