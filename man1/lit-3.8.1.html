<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>LIT(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">LIT(1)</td>
    <td class="head-vol">LLVM</td>
    <td class="head-rtitle">LIT(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
lit - LLVM Integrated Tester
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>lit</b> [<i>options</i>] [<i>tests</i>]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>lit</b> is a portable tool for executing LLVM and Clang style test suites,
  summarizing their results, and providing indication of failures. <b>lit</b> is
  designed to be a lightweight testing tool with as simple a user interface as
  possible.
<div style="height: 1.00em;">&#x00A0;</div>
<b>lit</b> should be run with one or more <i>tests</i> to run specified on the
  command line. Tests can be either individual test files or directories to
  search for tests (see <i>TEST DISCOVERY</i>).
<div style="height: 1.00em;">&#x00A0;</div>
Each specified test will be executed (potentially in parallel) and once all
  tests have been run <b>lit</b> will print summary information on the number of
  tests which passed or failed (see <i>TEST STATUS RESULTS</i>). The <b>lit</b>
  program will execute with a non-zero exit code if any tests fail.
<div style="height: 1.00em;">&#x00A0;</div>
By default <b>lit</b> will use a succinct progress display and will only print
  summary information for test failures. See <i>OUTPUT OPTIONS</i> for options
  controlling the <b>lit</b> progress display and output.
<div style="height: 1.00em;">&#x00A0;</div>
<b>lit</b> also includes a number of options for controlling how tests are
  executed (specific features may depend on the particular test format). See
  <i>EXECUTION OPTIONS</i> for more information.
<div style="height: 1.00em;">&#x00A0;</div>
Finally, <b>lit</b> also supports additional options for only running a subset
  of the options specified on the command line, see <i>SELECTION OPTIONS</i> for
  more information.
<div style="height: 1.00em;">&#x00A0;</div>
Users interested in the <b>lit</b> architecture or designing a <b>lit</b>
  testing implementation should see <i>LIT INFRASTRUCTURE</i>.
<h1 class="Sh" title="Sh" id="GENERAL_OPTIONS"><a class="selflink" href="#GENERAL_OPTIONS">GENERAL
  OPTIONS</a></h1>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h, --help</b></dt>
  <dd class="It-tag">Show the <b>lit</b> help message.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-j N, --threads=N</b></dt>
  <dd class="It-tag">Run <b>N</b> tests in parallel. By default, this is
      automatically chosen to match the number of detected available CPUs.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--config-prefix=NAME</b></dt>
  <dd class="It-tag">Search for <b></b><i>NAME</i><b></b><i></i><b>.cfg</b><i>
      and </i> <b></b><i>NAME</i><b></b><i></i><b>.site.cfg</b><i> when
      searching for</i> <i>test suites, instead of </i><b>lit.cfg</b><i> and
      </i> <b>lit.site.cfg</b><i>.</i></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-D NAME, -D NAME=VALUE, --param NAME, --param
    NAME=VALUE</b></dt>
  <dd class="It-tag">Add a user defined parameter <b>NAME</b> with the given
      <b>VALUE</b> (or the empty string if not given). The meaning and use of
      these parameters is test suite dependent.</dd>
</dl>
</div>
<br/>
<h1 class="Sh" title="Sh" id="OUTPUT_OPTIONS"><a class="selflink" href="#OUTPUT_OPTIONS">OUTPUT
  OPTIONS</a></h1>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-q, --quiet</b></dt>
  <dd class="It-tag">Suppress any output except for test failures.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s, --succinct</b></dt>
  <dd class="It-tag">Show less output, for example don't show information on
      tests that pass.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v, --verbose</b></dt>
  <dd class="It-tag">Show more information on test failures, for example the
      entire test output instead of just the test result.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-a, --show-all</b></dt>
  <dd class="It-tag">Show more information about all tests, for example the
      entire test commandline and output.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--no-progress-bar</b></dt>
  <dd class="It-tag">Do not use curses based progress bar.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--show-unsupported</b></dt>
  <dd class="It-tag">Show the names of unsupported tests.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--show-xfail</b></dt>
  <dd class="It-tag">Show the names of tests that were expected to fail.</dd>
</dl>
</div>
<br/>
<h1 class="Sh" title="Sh" id="EXECUTION_OPTIONS"><a class="selflink" href="#EXECUTION_OPTIONS">EXECUTION
  OPTIONS</a></h1>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--path=PATH</b></dt>
  <dd class="It-tag">Specify an additional <b>PATH</b> to use when searching for
      executables in tests.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--vg</b></dt>
  <dd class="It-tag">Run individual tests under valgrind (using the memcheck
      tool). The <b>--error-exitcode</b> argument for valgrind is used so that
      valgrind failures will cause the program to exit with a non-zero status.
    <div style="height: 1.00em;">&#x00A0;</div>
    When this option is enabled, <b>lit</b> will also automatically provide a
      &quot; <b>valgrind</b>&quot; feature that can be used to conditionally
      disable (or expect failure in) certain tests.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--vg-arg=ARG</b></dt>
  <dd class="It-tag">When <i>--vg</i> is used, specify an additional argument to
      pass to <b>valgrind</b> itself.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--vg-leak</b></dt>
  <dd class="It-tag">When <i>--vg</i> is used, enable memory leak checks. When
      this option is enabled, <b>lit</b> will also automatically provide a
      &quot; <b>vg_leak</b>&quot; feature that can be used to conditionally
      disable (or expect failure in) certain tests.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--time-tests</b></dt>
  <dd class="It-tag">Track the wall time individual tests take to execute and
      includes the results in the summary output. This is useful for determining
      which tests in a test suite take the most time to execute. Note that this
      option is most useful with <b>-j 1</b>.</dd>
</dl>
</div>
<br/>
<h1 class="Sh" title="Sh" id="SELECTION_OPTIONS"><a class="selflink" href="#SELECTION_OPTIONS">SELECTION
  OPTIONS</a></h1>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--max-tests=N</b></dt>
  <dd class="It-tag">Run at most <b>N</b> tests and then terminate.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--max-time=N</b></dt>
  <dd class="It-tag">Spend at most <b>N</b> seconds (approximately) running
      tests and then terminate.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--shuffle</b></dt>
  <dd class="It-tag">Run the tests in a random order.</dd>
</dl>
</div>
<br/>
<h1 class="Sh" title="Sh" id="ADDITIONAL_OPTIONS"><a class="selflink" href="#ADDITIONAL_OPTIONS">ADDITIONAL
  OPTIONS</a></h1>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--debug</b></dt>
  <dd class="It-tag">Run <b>lit</b> in debug mode, for debugging configuration
      issues and <b>lit</b> itself.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--show-suites</b></dt>
  <dd class="It-tag">List the discovered test suites and exit.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--show-tests</b></dt>
  <dd class="It-tag">List all of the discovered tests and exit.</dd>
</dl>
</div>
<br/>
<h1 class="Sh" title="Sh" id="EXIT_STATUS"><a class="selflink" href="#EXIT_STATUS">EXIT
  STATUS</a></h1>
<b>lit</b> will exit with an exit code of 1 if there are any FAIL or XPASS
  results. Otherwise, it will exit with the status 0. Other exit codes are used
  for non-test related failures (for example a user error or an internal program
  error).
<h1 class="Sh" title="Sh" id="TEST_DISCOVERY"><a class="selflink" href="#TEST_DISCOVERY">TEST
  DISCOVERY</a></h1>
The inputs passed to <b>lit</b> can be either individual tests, or entire
  directories or hierarchies of tests to run. When <b>lit</b> starts up, the
  first thing it does is convert the inputs into a complete list of tests to run
  as part of <i>test discovery</i>.
<div style="height: 1.00em;">&#x00A0;</div>
In the <b>lit</b> model, every test must exist inside some <i>test suite</i>.
  <b>lit</b> resolves the inputs specified on the command line to test suites by
  searching upwards from the input path until it finds a <b>lit.cfg</b> or
  <b>lit.site.cfg</b> file. These files serve as both a marker of test suites
  and as configuration files which <b>lit</b> loads in order to understand how
  to find and run the tests inside the test suite.
<div style="height: 1.00em;">&#x00A0;</div>
Once <b>lit</b> has mapped the inputs into test suites it traverses the list of
  inputs adding tests for individual files and recursively searching for tests
  in directories.
<div style="height: 1.00em;">&#x00A0;</div>
This behavior makes it easy to specify a subset of tests to run, while still
  allowing the test suite configuration to control exactly how tests are
  interpreted. In addition, <b>lit</b> always identifies tests by the test suite
  they are in, and their relative path inside the test suite. For appropriately
  configured projects, this allows <b>lit</b> to provide convenient and flexible
  support for out-of-tree builds.
<h1 class="Sh" title="Sh" id="TEST_STATUS_RESULTS"><a class="selflink" href="#TEST_STATUS_RESULTS">TEST
  STATUS RESULTS</a></h1>
Each test ultimately produces one of the following six results:
<div style="height: 1.00em;">&#x00A0;</div>
<b>PASS</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The test succeeded.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<b>XFAIL</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The test failed, but that is expected. This is
  used for test formats which allow specifying that a test does not currently
  work, but wish to leave it in the test suite.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<b>XPASS</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The test succeeded, but it was expected to
  fail. This is used for tests which were specified as expected to fail, but are
  now succeeding (generally because the feature they test was broken and has
  been fixed).</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<b>FAIL</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The test failed.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<b>UNRESOLVED</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The test result could not be determined. For
  example, this occurs when the test could not be run, the test itself is
  invalid, or the test was interrupted.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<b>UNSUPPORTED</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The test is not supported in this environment.
  This is used by test formats which can report unsupported tests.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Depending on the test format tests may produce additional information about
  their status (generally only for failures). See the <i>OUTPUT OPTIONS</i>
  section for more information.
<h1 class="Sh" title="Sh" id="LIT_INFRASTRUCTURE"><a class="selflink" href="#LIT_INFRASTRUCTURE">LIT
  INFRASTRUCTURE</a></h1>
This section describes the <b>lit</b> testing architecture for users interested
  in creating a new <b>lit</b> testing implementation, or extending an existing
  one.
<div style="height: 1.00em;">&#x00A0;</div>
<b>lit</b> proper is primarily an infrastructure for discovering and running
  arbitrary tests, and to expose a single convenient interface to these tests.
  <b>lit</b> itself doesn't know how to run tests, rather this logic is defined
  by <i>test suites</i>.
<h2 class="Ss" title="Ss" id="TEST_SUITES"><a class="selflink" href="#TEST_SUITES">TEST
  SUITES</a></h2>
As described in <i>TEST DISCOVERY</i>, tests are always located inside a
  <i>test</i> <i>suite</i>. Test suites serve to define the format of the tests
  they contain, the logic for finding those tests, and any additional
  information to run the tests.
<div style="height: 1.00em;">&#x00A0;</div>
<b>lit</b> identifies test suites as directories containing <b>lit.cfg</b> or
  <b>lit.site.cfg</b> files (see also <i>--config-prefix</i>). Test suites are
  initially discovered by recursively searching up the directory hierarchy for
  all the input files passed on the command line. You can use
  <i>--show-suites</i> to display the discovered test suites at startup.
<div style="height: 1.00em;">&#x00A0;</div>
Once a test suite is discovered, its config file is loaded. Config files
  themselves are Python modules which will be executed. When the config file is
  executed, two important global variables are predefined:
<div style="height: 1.00em;">&#x00A0;</div>
<b>lit_config</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The global <b>lit</b> configuration object (a
  <i>LitConfig</i> instance), which defines the builtin test formats, global
  configuration parameters, and other helper routines for implementing test
  configurations.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<b>config</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">This is the config object (a
  <i>TestingConfig</i> instance) for the test suite, which the config file is
  expected to populate. The following variables are also available on the
  <i>config</i> object, some of which must be set by the config and others are
  optional or predefined:
<div style="height: 1.00em;">&#x00A0;</div>
<b>name</b> <i>[required]</i> The name of the test suite, for use in reports and
  diagnostics.
<div style="height: 1.00em;">&#x00A0;</div>
<b>test_format</b> <i>[required]</i> The test format object which will be used
  to discover and run tests in the test suite. Generally this will be a builtin
  test format available from the <i>lit.formats</i> module.
<div style="height: 1.00em;">&#x00A0;</div>
<b>test_source_root</b> The filesystem path to the test suite root. For
  out-of-dir builds this is the directory that will be scanned for tests.
<div style="height: 1.00em;">&#x00A0;</div>
<b>test_exec_root</b> For out-of-dir builds, the path to the test suite root
  inside the object directory. This is where tests will be run and temporary
  output files placed.
<div style="height: 1.00em;">&#x00A0;</div>
<b>environment</b> A dictionary representing the environment to use when
  executing tests in the suite.
<div style="height: 1.00em;">&#x00A0;</div>
<b>suffixes</b> For <b>lit</b> test formats which scan directories for tests,
  this variable is a list of suffixes to identify test files. Used by:
  <i>ShTest</i>.
<div style="height: 1.00em;">&#x00A0;</div>
<b>substitutions</b> For <b>lit</b> test formats which substitute variables into
  a test script, the list of substitutions to perform. Used by: <i>ShTest</i>.
<div style="height: 1.00em;">&#x00A0;</div>
<b>unsupported</b> Mark an unsupported directory, all tests within it will be
  reported as unsupported. Used by: <i>ShTest</i>.
<div style="height: 1.00em;">&#x00A0;</div>
<b>parent</b> The parent configuration, this is the config object for the
  directory containing the test suite, or None.
<div style="height: 1.00em;">&#x00A0;</div>
<b>root</b> The root configuration. This is the top-most <b>lit</b>
  configuration in the project.
<div style="height: 1.00em;">&#x00A0;</div>
<b>pipefail</b> Normally a test using a shell pipe fails if any of the commands
  on the pipe fail. If this is not desired, setting this variable to false makes
  the test fail only if the last command in the pipe fails.</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="TEST_DISCOVERY"><a class="selflink" href="#TEST_DISCOVERY">TEST
  DISCOVERY</a></h2>
Once test suites are located, <b>lit</b> recursively traverses the source
  directory (following <i>test_source_root</i>) looking for tests. When
  <b>lit</b> enters a sub-directory, it first checks to see if a nested test
  suite is defined in that directory. If so, it loads that test suite
  recursively, otherwise it instantiates a local test config for the directory
  (see <i>LOCAL CONFIGURATION FILES</i>).
<div style="height: 1.00em;">&#x00A0;</div>
Tests are identified by the test suite they are contained within, and the
  relative path inside that suite. Note that the relative path may not refer to
  an actual file on disk; some test formats (such as <i>GoogleTest</i>) define
  &quot;virtual tests&quot; which have a path that contains both the path to the
  actual test file and a subpath to identify the virtual test.
<h2 class="Ss" title="Ss" id="LOCAL_CONFIGURATION_FILES"><a class="selflink" href="#LOCAL_CONFIGURATION_FILES">LOCAL
  CONFIGURATION FILES</a></h2>
When <b>lit</b> loads a subdirectory in a test suite, it instantiates a local
  test configuration by cloning the configuration for the parent directory ---
  the root of this configuration chain will always be a test suite. Once the
  test configuration is cloned <b>lit</b> checks for a <i>lit.local.cfg</i> file
  in the subdirectory. If present, this file will be loaded and can be used to
  specialize the configuration for each individual directory. This facility can
  be used to define subdirectories of optional tests, or to change other
  configuration parameters --- for example, to change the test format, or the
  suffixes which identify test files.
<h2 class="Ss" title="Ss" id="TEST_RUN_OUTPUT_FORMAT"><a class="selflink" href="#TEST_RUN_OUTPUT_FORMAT">TEST
  RUN OUTPUT FORMAT</a></h2>
The <b>lit</b> output for a test run conforms to the following schema, in both
  short and verbose modes (although in short mode no PASS lines will be shown).
  This schema has been chosen to be relatively easy to reliably parse by a
  machine (for example in buildbot log scraping), and for other tools to
  generate.
<div style="height: 1.00em;">&#x00A0;</div>
Each test result is expected to appear on a line that matches:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
&lt;result code&gt;: &lt;test name&gt; (&lt;progress info&gt;)
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
where <b>&lt;result-code&gt;</b> is a standard test result such as PASS, FAIL,
  XFAIL, XPASS, UNRESOLVED, or UNSUPPORTED. The performance result codes of
  IMPROVED and REGRESSED are also allowed.
<div style="height: 1.00em;">&#x00A0;</div>
The <b>&lt;test name&gt;</b> field can consist of an arbitrary string containing
  no newline.
<div style="height: 1.00em;">&#x00A0;</div>
The <b>&lt;progress info&gt;</b> field can be used to report progress
  information such as (1/300) or can be empty, but even when empty the
  parentheses are required.
<div style="height: 1.00em;">&#x00A0;</div>
Each test result may include additional (multiline) log information in the
  following format:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
&lt;log delineator&gt; TEST '(&lt;test name&gt;)' &lt;trailing delineator&gt;
... log message ...
&lt;log delineator&gt;
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
where <b>&lt;test name&gt;</b> should be the name of a preceding reported test,
  <b>&lt;log</b> <b>delineator&gt;</b> is a string of &quot;*&quot; characters
  <i>at least</i> four characters long (the recommended length is 20), and
  <b>&lt;trailing delineator&gt;</b> is an arbitrary (unparsed) string.
<div style="height: 1.00em;">&#x00A0;</div>
The following is an example of a test run output which consists of four tests A,
  B, C, and D, and a log message for the failing test C:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
PASS: A (1 of 4)
PASS: B (2 of 4)
FAIL: C (3 of 4)
******************** TEST 'C' FAILED ********************
Test 'C' failed as a result of exit code 1.
********************
PASS: D (4 of 4)
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="LIT_EXAMPLE_TESTS"><a class="selflink" href="#LIT_EXAMPLE_TESTS">LIT
  EXAMPLE TESTS</a></h2>
The <b>lit</b> distribution contains several example implementations of test
  suites in the <i>ExampleTests</i> directory.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
valgrind(1)
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Maintained by The LLVM Team (http://llvm.org/).
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
2003-2017, LLVM Project</div>
<table class="foot">
  <tr>
    <td class="foot-date">2017-03-13</td>
    <td class="foot-os">3.8</td>
  </tr>
</table>
</body>
</html>
