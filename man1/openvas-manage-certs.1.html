<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>OPENVAS-MANAGE-CERTS(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">OPENVAS-MANAGE-CERTS(1)</td>
    <td class="head-vol">User manual for the Open Vulnerability Assessment
      System (OpenVAS)</td>
    <td class="head-rtitle">OPENVAS-MANAGE-CERTS(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
openvas-manage-certs - manage certificate infrastructure for an OpenVAS
  installation
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>openvas-manage-certs</b> [ <i>OPTION</i>]...
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>openvas-manage-certs</b> manages the certificate infrastructure for an
  OpenVAS installation. The certificate infrastructure enables OpenVAS daemons
  to communicate in a secure manner and is used for authentication and
  authorization before establishing TLS connections between the daemons.
<div class="Pp"></div>
The OpenVAS certificate infrastructure consists of a certificate authority (CA)
  which is trusted by all OpenVAS daemons. This CA is then used to sign
  certificates used by the various daemons. The certificates can be divided into
  two use cases:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Server certificates, primarily used for authentication</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Client certificates, primarily used for authorization</dd>
</dl>
<div class="Pp"></div>
<b>openvas-manage-certs</b> can perform an automatic creation of a default
  certificate infrastructure for a standard OpenVAS installation. It can also
  verify an existing infrastructure and perform various certificate related
  tasks to support the setup of a more complex infrastructure.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<h2 class="Ss" title="Ss" id="Certificate_infrastructure_management"><a class="selflink" href="#Certificate_infrastructure_management">Certificate
  infrastructure management</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-a</b></dt>
  <dd class="It-tag">Automatically set up default infrastructure for
    OpenVAS</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-V</b></dt>
  <dd class="It-tag">Verify existing OpenVAS certificate infrastructure</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-C</b></dt>
  <dd class="It-tag">Create a certificate authority (CA)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-R</b></dt>
  <dd class="It-tag">Create a certificate request for a CA</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-r</b></dt>
  <dd class="It-tag">Create a certificate request for a CA and sign it</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-C</b></dt>
  <dd class="It-tag">Create a certificate authority (CA)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-I</b></dt>
  <dd class="It-tag">Install a CA certificate</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c</b></dt>
  <dd class="It-tag">Create a certificate request and sign it</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i</b></dt>
  <dd class="It-tag">Install a certificate</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-S</b></dt>
  <dd class="It-tag">Sign a certificate request</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b></dt>
  <dd class="It-tag">Force overwriting of existing files</dd>
</dl>
<h2 class="Ss" title="Ss" id="Certificate_options"><a class="selflink" href="#Certificate_options">Certificate
  options</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-E</b></dt>
  <dd class="It-tag">Create a server certificate. This sets the appropriate key
      usage constraints for a server certificate.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-L</b></dt>
  <dd class="It-tag">Create a client certificate. This sets the appropriate key
      usage constraints for a client certificate.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-A</b></dt>
  <dd class="It-tag">Skip CA generation in automatic mode. This automatically
      (re-)generates server and client certificates, but keeps the CA
      certificate.</dd>
</dl>
<h2 class="Ss" title="Ss" id="Configuration"><a class="selflink" href="#Configuration">Configuration</a></h2>
<b>-e</b> <i>file</i> Read configuration from <i>file</i> (see below for
  configuration details)
<h2 class="Ss" title="Ss" id="Output_control"><a class="selflink" href="#Output_control">Output
  control</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d</b></dt>
  <dd class="It-tag">Print debug output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v</b></dt>
  <dd class="It-tag">Print verbose messages</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-q</b></dt>
  <dd class="It-tag">Be quiet, only print error messages</dd>
</dl>
<h2 class="Ss" title="Ss" id="Other_options"><a class="selflink" href="#Other_options">Other
  options</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h</b></dt>
  <dd class="It-tag">Print help</dd>
</dl>
<h1 class="Sh" title="Sh" id="EXIT_STATUS"><a class="selflink" href="#EXIT_STATUS">EXIT
  STATUS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>0</b></dt>
  <dd class="It-tag">The requested operation was successfully performed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>1</b></dt>
  <dd class="It-tag">An error occurred, the requested operation could not be
      performed.</dd>
</dl>
<h1 class="Sh" title="Sh" id="ENVIRONMENT"><a class="selflink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
All certificate generation options can be set either through the configuration
  file or through environment variables like the following:
<dl class="Bl-tag">
  <dt class="It-tag">OPENVAS_CERTIFICATE_LIFETIME</dt>
  <dd class="It-tag">Days until the certificate will expire</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">OPENVAS_CERTIFICATE_HOSTNAME</dt>
  <dd class="It-tag">Name to use for the certificate</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">OPENVAS_CERTIFICATE_SIGNALG</dt>
  <dd class="It-tag">Hash algorithm to use for signing</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">OPENVAS_CERTIFICATE_KEYSIZE</dt>
  <dd class="It-tag">Size in bits of the generated key</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">OPENVAS_CERTIFICATE_SECPARAM</dt>
  <dd class="It-tag">GnuTLS security level [low|medium|high|ultra]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">OPENVAS_CERT_DIR</dt>
  <dd class="It-tag">Directory where keys and certificates are stored before
      installation</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">OPENVAS_CERT_PREFIX</dt>
  <dd class="It-tag">Prefix for certificate filename (e.g.
    &quot;server&quot;)</dd>
</dl>
<div class="Pp"></div>
For a complete list of options, please refer to the example configuration file
  included in the documentation.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>openvassd</b>(8), <b>openvasmd</b>(8), <b>gsad</b>(8)</div>
<table class="foot">
  <tr>
    <td class="foot-date">2015-09-21</td>
    <td class="foot-os">The OpenVAS Project</td>
  </tr>
</table>
</body>
</html>
