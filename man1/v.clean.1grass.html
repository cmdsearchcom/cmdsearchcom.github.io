<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>v.clean(1grass)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">v.clean(1grass)</td>
    <td class="head-vol">Grass User's Manual</td>
    <td class="head-rtitle">v.clean(1grass)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<i></i><b>v.clean</b> - Toolset for cleaning topology of vector map.
<h1 class="Sh" title="Sh" id="KEYWORDS"><a class="selflink" href="#KEYWORDS">KEYWORDS</a></h1>
vector, topology, geometry, snapping
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>v.clean</b>
<div>&#x00A0;</div>
<b>v.clean --help</b>
<div>&#x00A0;</div>
<b>v.clean</b> [-<b>bc</b>] <b>input</b>=<i>name</i>
  [<b>layer</b>=<i>string</i>] [ <b>type</b>=<i>string</i>[,<i>string</i>,...]]
  <b>output</b>=<i>name</i> [<b>error</b>=<i>name</i>]
  <b>tool</b>=<i>string</i>[, <i>string</i>,...]
  [<b>threshold</b>=<i>float</i>[, <i>float</i>,...]] [--<b>overwrite</b>]
  [--<b>help</b>] [--<b>verbose</b>] [--<b>quiet</b>] [--<b>ui</b>]
<h2 class="Ss" title="Ss" id="Flags:"><a class="selflink" href="#Flags:">Flags:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-b</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Do not build topology for the output vector</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Combine tools with recommended follow-up tools</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--overwrite</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Allow output files to overwrite existing files</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Print usage summary</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verbose</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Verbose module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--quiet</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Quiet module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ui</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Force launching GUI dialog</dd>
</dl>
<h2 class="Ss" title="Ss" id="Parameters:"><a class="selflink" href="#Parameters:">Parameters:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>input</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input vector map
    <div>&#x00A0;</div>
    Or data source for direct OGR access</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>layer</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Layer number or name (&#x2019;-1&#x2019; for all layers)
    <div>&#x00A0;</div>
    A single vector map can be connected to multiple database tables. This
      number determines which table to use. When used with direct OGR access
      this is the layer name.
    <div>&#x00A0;</div>
    Default: <i>-1</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>type</b>=<i>string[,</i><i>string</i>,...]</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Input feature type
    <div>&#x00A0;</div>
    Options: <i>point, line, boundary, centroid, area, face, kernel</i>
    <div>&#x00A0;</div>
    Default: <i>point,line,boundary,centroid,area,face,kernel</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>output</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name for output vector map</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>error</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of output map where errors are written</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>tool</b>=<i>string[,</i><i>string</i>,...]
    <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Cleaning tool
    <div>&#x00A0;</div>
    Options: <i>break, snap, rmdangle, chdangle, rmbridge, chbridge, rmdupl,
      rmdac, bpol, prune, rmarea, rmline, rmsa</i>
    <div>&#x00A0;</div>
     <b>break</b>: break lines at each intersection
    <div>&#x00A0;</div>
     <b>snap</b>: snap lines to vertex in threshold
    <div>&#x00A0;</div>
     <b>rmdangle</b>: remove dangles, threshold ignored if &lt; 0
    <div>&#x00A0;</div>
     <b>chdangle</b>: change the type of boundary dangle to line, threshold
      ignored if &lt; 0, input line type is ignored
    <div>&#x00A0;</div>
     <b>rmbridge</b>: remove bridges connecting area and island or 2 islands
    <div>&#x00A0;</div>
     <b>chbridge</b>: change the type of bridges connecting area and island or 2
      islands from boundary to line
    <div>&#x00A0;</div>
     <b>rmdupl</b>: remove duplicate geometry features (pay attention to
      categories!)
    <div>&#x00A0;</div>
     <b>rmdac</b>: remove duplicate area centroids (&#x2019;type&#x2019; option
      ignored)
    <div>&#x00A0;</div>
     <b>bpol</b>: break (topologically clean) polygons (imported from non
      topological format, like ShapeFile). Boundaries are broken on each point
      shared between 2 and more polygons where angles of segments are different
    <div>&#x00A0;</div>
     <b>prune</b>: remove vertices in threshold from lines and boundaries,
      boundary is pruned only if topology is not damaged (new intersection,
      changed attachment of centroid), first and last segment of the boundary is
      never changed
    <div>&#x00A0;</div>
     <b>rmarea</b>: remove small areas, the longest boundary with adjacent area
      is removed
    <div>&#x00A0;</div>
     <b>rmline</b>: remove all lines or boundaries of zero length, threshold is
      ignored
    <div>&#x00A0;</div>
     <b>rmsa</b>: remove small angles between lines at nodes</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>threshold</b>=<i>float[,</i><i>float</i>,...]</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Threshold in map units, one value for each tool
    <div>&#x00A0;</div>
    Default: 0.0[,0.0,...])</dd>
</dl>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<i>v.clean</i> allows the user to automatically fix topology of vector maps.
  Several tools may be listed to be executed sequentially. In this case, also
  the threshold parameter requires several values to be listed accordingly. An
  error map is optionally written which stores the erroneous geometries.
<h2 class="Ss" title="Ss" id="Break_lines/boundaries"><a class="selflink" href="#Break_lines/boundaries">Break
  lines/boundaries</a></h2>
<i>tool=break</i>
<div class="Pp"></div>
The <i>break</i> tool breaks lines/boundaries at intersections and it also
  breaks lines/boundaries forming a collapsed loop. For example, 0.0;1.0;0.0 is
  broken at 1.0.
<div class="Pp"></div>
Threshold does not apply (it is ignored), use an arbitrary value (e.g., 0) if
  <i>v.clean</i> is run with several tools.
<div class="Pp"></div>
Hint: Breaking lines should be followed by removing duplicates, e.g. <i>v.clean
  ... tool=break,rmdupl</i>. If the <i>-c</i> flag is used with <i>v.clean ...
  tool=break</i>, duplicates are automatically removed.
<h2 class="Ss" title="Ss" id="Remove_duplicate_geometry_features"><a class="selflink" href="#Remove_duplicate_geometry_features">Remove
  duplicate geometry features</a></h2>
<i>tool=rmdupl</i>
<div class="Pp"></div>
The <i>rmdupl</i> tool removes geometry features with identical coordinates.
  Categories are merged. If a point and a centroid have identical coordinates,
  one of them will be removed if both points and centroids are selected with
  <i>v.clean ... type=point,centroid</i>. The same applies for lines and
  boundaries.
<div class="Pp"></div>
Threshold does not apply (it is ignored), use an arbitrary value (e.g., 0) if
  <i>v.clean</i> is run with several tools.
<div class="Pp"></div>
The <i>rmdupl</i> tool should be used after breaking lines and breaking
  polygons.
<h2 class="Ss" title="Ss" id="Remove_dangles_or_change_boundary_dangles_to_type_line"><a class="selflink" href="#Remove_dangles_or_change_boundary_dangles_to_type_line">Remove
  dangles or change boundary dangles to type line</a></h2>
<i>tool=rmdangle</i> and <i>tool=chdangle</i>
<div class="Pp"></div>
A line/boundary is considered to be a dangle if no other line of given
  <i>type</i> is on at least one end node. If a dangle is formed by several
  lines, such a string of lines is taken as one dangle and line lengths are
  summarized. The <i>rmdangle</i> tool deletes a dangle if the (combined) length
  is shorter than <i>thresh</i> or <i>thresh</i> &lt; 0. If the combined length
  is larger than <i>thresh</i>, nothing is deleted.
<div class="Pp"></div>
Threshold has to be given as maximum line/boundary length in map units; for
  latitude-longitude locations in degree. Dangles shorter than <i>thresh</i> are
  removed sequentially. All dangles will be removed if <i>thresh</i> &lt; 0.
<div class="Pp"></div>
With <i>thresh</i> &lt; 0, only closed loops and lines connecting loops will
  remain. This is useful to remove all incorrect boundaries after other cleaning
  operations with <i>thres</i> is &lt; 0. Areas can then be successfully built.
<div class="Pp"></div>
To preferentially remove shortest dangles first, a first pass with a small
  <i>thresh</i> value can be followed by subsequent passes with higher
  <i>thresh</i> values. This can be done as one <i>v.clean</i> job by listing
  the tool several times and by defining a list of increasing <i>thresh</i>
  values.
<div class="Pp"></div>
The <i>chdangle</i> tool is similar to the <i>rmdangle</i> tool, but works only
  on boundaries and changes dangling boundaries to lines instead of removing
  them.
<h2 class="Ss" title="Ss" id="Remove_or_change_bridges_connecting_an_area_and_an_island_or_two_islands"><a class="selflink" href="#Remove_or_change_bridges_connecting_an_area_and_an_island_or_two_islands">Remove
  or change bridges connecting an area and an island or two islands</a></h2>
<i>tool=rmbridge</i> and <i>tool=chbridge</i>
<div class="Pp"></div>
A bridge is an area type connection of an island (polygon in a polygon) to the
  outer polygon. This is topologically incorrect (but OGC Simple Features allow
  it). The <i>rmbridge</i> tool removes bridges and the <i>chbridge</i> tool
  changes bridges to type line:
<div>&#x00A0;</div>
<pre>
    +-------------+             +-------------+   +-------------+
    |            P|  P: polygon |            P|   |            P|
    |    +---+    |  I: island  |    +---+    |   |    +---+    |
    |    | I |    |  B: bridge  |    | I |    |   |    | I |    |
    |    |   |    |  L: line    |    |   |    |   |    |   |    |
    |    +-+-+    |             |    +---+    |   |    +-.-+    |
    |      |      |             |             |   |      .      |
    |      | B    |             |             |   |      . L    |
    |      |      |             |             |   |      .      |
    +------+------+             +-------------+   +-------------+
</pre>
<div class="Pp"></div>
Islands and areas must be already clean, i.e. without dangles or small angles,
  e.g. <i>v.clean ... type=boundary tool=rmdangle,rmsa,break,rmdupl,rmbridge</i>
  <i>thresh=-1,0,0,0,0</i>.
<div class="Pp"></div>
Threshold does not apply (it is ignored), use an arbitrary value (e.g., 0) if
  <i>v.clean</i> is run with several tools.
<h2 class="Ss" title="Ss" id="Snap_lines_to_vertex_in_threshold"><a class="selflink" href="#Snap_lines_to_vertex_in_threshold">Snap
  lines to vertex in threshold</a></h2>
<i>tool=snap</i>
<div class="Pp"></div>
The <i>snap</i> tool snaps vertices to another vertex not farther away than
  <i>thresh</i>. If there is no other vertex within <i>thresh</i>, no snapping
  will be done. The <i>type</i> option can have a strong influence on the
  result. A too large threshold and <i>type=boundary</i> can severely damage
  area topology, beyond repair.
<div class="Pp"></div>
Threshold gives maximum distance to another vertex in map units, for
  latitude-longitude locations in degree.
<div class="Pp"></div>
Snapped boundaries may need to be cleaned with <i>break,rmdupl,rmsa</i>. If the
  <i>-c</i> flag is used with <i>v.clean tool=snap</i>, the sequence of
  <i>break,rmdupl,rmsa</i> is automatically repeated after snapping until no
  more small angles a left. Additional cleaning with e.g.
  <i>tool=rmdangle</i>may be necessary.
<h2 class="Ss" title="Ss" id="Remove_duplicate_area_centroids"><a class="selflink" href="#Remove_duplicate_area_centroids">Remove
  duplicate area centroids</a></h2>
<i>tool=rmdac</i>
<div class="Pp"></div>
The <i>rmdac</i> tool removes duplicate area centroids that can result from
  deleting boundaries.
<div class="Pp"></div>
Threshold does not apply (it is ignored), use an arbitrary value (e.g., 0) if
  <i>v.clean</i> is run with several tools.
<h2 class="Ss" title="Ss" id="Break_(topologically_clean)_areas_(imported_from_a_non_topological"><a class="selflink" href="#Break_(topologically_clean)_areas_(imported_from_a_non_topological">Break
  (topologically clean) areas (imported from a non topological</a></h2>
format like ShapeFile) <i>tool=bpol</i>
<div class="Pp"></div>
The <i>bpol</i> tool breaks boundaries on each point shared between 2 and more
  areas where angles of boundary segments are different and on all boundary
  nodes (start and end points of each boundary). The <i>bpol</i> tool behaves
  similar to <i>break</i> for boundaries, but does not break collapsed loops.
  The <i>bpol</i> tool is faster than the <i>break</i> tool but needs more
  memory.
<div class="Pp"></div>
Threshold does not apply (it is ignored), use an arbitrary value (e.g., 0) if
  <i>v.clean</i> is run with several tools.
<div class="Pp"></div>
The <i>bpol</i> tool should be followed by <i>rmdupl</i>. If the <i>-c</i> flag
  is used with <i>v.clean ... tool=bpol</i>, duplicates are automatically
  removed.
<h2 class="Ss" title="Ss" id="Remove_vertices_in_threshold_from_lines_and_boundaries"><a class="selflink" href="#Remove_vertices_in_threshold_from_lines_and_boundaries">Remove
  vertices in threshold from lines and boundaries</a></h2>
<i>tool=prune</i>
<div class="Pp"></div>
The <i>prune</i> tool simplifies lines and boundaries by removing vertices
  according to threshold. This tool preserves area topology, areas are never
  deleted and centroid attachment is never changed. <i>v.generalize</i> offers
  much more functionality for line simplification but does not preserve area
  topology.
<h2 class="Ss" title="Ss" id="Remove_small_areas"><a class="selflink" href="#Remove_small_areas">Remove
  small areas</a></h2>
<i>tool=rmarea</i>
<div class="Pp"></div>
The <i>rmarea</i> tool removes all areas &lt;= <i>thresh</i>. The longest
  boundary with an adjacent area is removed or all boundaries if there is no
  adjacent area. Area categories are not combined when a small area is merged
  with a larger area.
<div class="Pp"></div>
Threshold must always be in square meters, also for latitude-longitude locations
  or locations with units other than meters.
<h2 class="Ss" title="Ss" id="Remove_all_lines_or_boundaries_of_zero_length"><a class="selflink" href="#Remove_all_lines_or_boundaries_of_zero_length">Remove
  all lines or boundaries of zero length</a></h2>
<i>tool=rmline</i>
<div class="Pp"></div>
The <i>rmline</i> tool removes all lines or boundaries of zero length that may
  have resulted from other cleaning operations. Zero length boundaries are
  redundant and do not influence area topology.
<div class="Pp"></div>
Threshold does not apply (it is ignored), use an arbitrary value (e.g., 0) if
  <i>v.clean</i> is run with several tools.
<h2 class="Ss" title="Ss" id="Remove_small_angles_between_lines_at_nodes"><a class="selflink" href="#Remove_small_angles_between_lines_at_nodes">Remove
  small angles between lines at nodes</a></h2>
<i>tool=rmsa</i>
<div class="Pp"></div>
The <i>rmsa</i> tool only concerns angles which are so small that the calculated
  angle is 0. The following figure should help demonstrate what the tool does.
<div class="Pp"></div>
Threshold does not apply, use dummy value if <i>v.clean</i> is run with several
  tools.
<table class="tbl">
  <colgroup>
    <col style="width: 60.00ex;"/>
  </colgroup>
  <tr>
    <td></td>
  </tr>
  <tr>
    <td><i>tool=rmsa</i></td>
  </tr>
</table>
<div class="Pp"></div>
The <i>rmsa</i> tool should be followed by <i>break,rmdupl</i>. The <i>rmsa</i>
  tool followed by <i>break,rmdupl</i> may need to be run more than once to
  remove all small angles. If the <i>-c</i> flag is used with <i>v.clean ...
  tool=rmsa</i>, the sequence of <i>rmsa,break,rmdupl</i> is automatically
  repeated until no more small angles a left.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
The user does <b>not</b> have to run <i>v.build</i> on the <i>output</i> vector,
  unless the <i>-b</i> flag was used. The <i>-b</i> flag affects <b>only</b> the
  <i>output</i> vector - topology is always built for <i>error</i> vector.
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<h2 class="Ss" title="Ss" id="Snap_lines_to_vertex_in_threshold"><a class="selflink" href="#Snap_lines_to_vertex_in_threshold">Snap
  lines to vertex in threshold</a></h2>
<pre>
v.clean input=testmap output=cleanmap tool=snap threshold=1
</pre>
<h2 class="Ss" title="Ss" id="Cleaning_OGR_imported_data_(Simple_Feature_data)_such_as_SHAPE_file"><a class="selflink" href="#Cleaning_OGR_imported_data_(Simple_Feature_data)_such_as_SHAPE_file">Cleaning
  OGR imported data (Simple Feature data) such as SHAPE file</a></h2>
The import of areas with <i>v.in.ogr -c</i> (no cleaning) requires a subsequent
  run of <i>v.clean</i> to update the map to a topologically valid structure
  (removal of duplicate collinear lines etc). The tools used for that are
  <i>bpol</i> and <i>rmdupl</i>:
<div>&#x00A0;</div>
<pre>
v.clean input=areamap output=areamap_clean tool=bpol,rmdupl type=boundary
</pre>
<h2 class="Ss" title="Ss" id="Extracting_intersection_points_of_vector_lines"><a class="selflink" href="#Extracting_intersection_points_of_vector_lines">Extracting
  intersection points of vector lines</a></h2>
<pre>
v.clean input=lines1 output=lines2 err=points tool=break type=line
</pre>
Intersection points are written to &#x2019;points&#x2019; map.
<h2 class="Ss" title="Ss" id="Break_lines"><a class="selflink" href="#Break_lines">Break
  lines</a></h2>
<i>v.clean</i> will break the lines where they cross, creating new node if
  needed. Example:
<div>&#x00A0;</div>
<pre>
v.in.ascii -n out=crossed_lines format=standard &lt;&lt; EOF
L 2
 0 5
 10 5
L 2
 5 0
 5 10
EOF
v.clean in=crossed_lines out=crossed_lines_brk \
        error=intersection tool=break type=line
</pre>
<h2 class="Ss" title="Ss" id="Remove_all_lines_of_zero_length"><a class="selflink" href="#Remove_all_lines_of_zero_length">Remove
  all lines of zero length</a></h2>
<pre>
v.out.ascii zero format=standard
L  2 1
 -819832.09065589 -987825.2187231
 -806227.28362601 -971104.80702988
 1     1
L  2 1
 -799165.24638913 -972974.16982788
 -799165.24638913 -972974.16982788
 1     2
v.clean input=zero output=zero_clean tool=rmline type=line
v.out.ascii zero_clean format=standard
L  2 1
 -819832.09065589 -987825.2187231
 -806227.28362601 -971104.80702988
 1     1
</pre>
v.clean type=boundary would remove nothing.
<h2 class="Ss" title="Ss" id="Repeatedly_remove_dangling_lines_up_to_50m_length"><a class="selflink" href="#Repeatedly_remove_dangling_lines_up_to_50m_length">Repeatedly
  remove dangling lines up to 50m length</a></h2>
<pre>
v.clean input=testmap output=cleanmap type=line \
        tool=rmdangle,rmdangle,rmdangle,rmdangle threshold=5,10,20,50
</pre>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i></i> <i>v.info,</i> <i>v.build,</i> <i>g.gui.vdigit,</i> <i>v.edit</i>
  <i></i>
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
David Gerdes, U.S. Army Construction Engineering Research Laboratory
<div>&#x00A0;</div>
Radim Blazek, ITC-irst, Trento, Italy
<div>&#x00A0;</div>
Martin Landa, FBK-irst (formerly ITC-irst), Trento, Italy
<div class="Pp"></div>
<i>Last changed: $Date: 2016-03-08 09:06:33 +0100 (Tue, 08 Mar 2016) $</i>
<h1 class="Sh" title="Sh" id="SOURCE_CODE"><a class="selflink" href="#SOURCE_CODE">SOURCE
  CODE</a></h1>
Available at: v.clean source code (history)
<div class="Pp"></div>
Main index | Vector index | Topics index | Keywords index | Graphical index |
  Full index
<div class="Pp"></div>
&#x00A9; 2003-2016 GRASS Development Team, GRASS GIS 7.2.0 Reference
  Manual</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os">GRASS 7.2.0</td>
  </tr>
</table>
</body>
</html>
