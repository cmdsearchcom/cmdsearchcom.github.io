<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:34:43 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>QSHAPE(1) General Commands Manual QSHAPE(1)</p>

<p style="margin-top: 1em">NAME <br>
qshape - Print Postfix queue domain and age distribution</p>

<p style="margin-top: 1em">SYNOPSIS <br>
qshape [-s] [-p] [-m min_subdomains] <br>
[-b bucket_count] [-t bucket_time] <br>
[-l] [-w terminal_width] <br>
[-N batch_msg_count] [-n batch_top_domains] <br>
[-c config_directory] [queue_name ...]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
The qshape program helps the administrator understand the
Postfix queue message distribution in time and by sender
domain or recipient domain. The program needs read access to
<br>
the queue directories and queue files, so it must run as the
superuser or the mail_owner specified in main.cf (typically
postfix).</p>

<p style="margin-top: 1em">Options:</p>

<p style="margin-top: 1em">-s Display the sender domain
distribution instead of the recipient domain distribution.
By default the recipient distribution is displayed. There
can be more recipients than <br>
messages, but as each message has only one sender, the
sender distribution is a message distribution.</p>

<p style="margin-top: 1em">-p Generate aggregate statistics
for parent domains. Top level domains are not shown, nor are
domains with fewer than min_subdomains subdomains. The names
of parent domains <br>
are shown with a leading dot, (e.g. .example.com).</p>

<p style="margin-top: 1em">-m min_subdomains <br>
When used with the -p option, sets the minimum subdomain
count needed to show a separate line for a parent domain.
The default is 5.</p>

<p style="margin-top: 1em">-b bucket_count <br>
The age distribution is broken up into a sequence of
geometrically increasing intervals. This option sets the
number of intervals or &quot;buckets&quot;. Each bucket has
a maximum <br>
queue age that is twice as large as that of the previous
bucket. The last bucket has no age limit.</p>

<p style="margin-top: 1em">-t bucket_time <br>
The age limit in minutes for the first time bucket. The
default value is 5, meaning that the first bucket counts
messages between 0 and 5 minutes old.</p>

<p style="margin-top: 1em">-l Instead of using a geometric
age sequence, use a linear age sequence, in other words
simple multiples of bucket_time.</p>

<p style="margin-top: 1em">This feature is available in
Postfix 2.2 and later.</p>

<p style="margin-top: 1em">-w terminal_width <br>
The output is right justified, with the counts for the last
bucket shown on the 80th column, the terminal_width can be
adjusted for wider screens allowing more buckets to <br>
be displayed without truncating the domain names on the
left. When a row for a full domain name and its counters
does not fit in the specified number of columns, only the
<br>
last 17 bytes of the domain name are shown with the prefix
replaced by a &rsquo;+&rsquo; character. Truncated parent
domain rows are shown as &rsquo;.+&rsquo; followed by the
last 16 bytes of the <br>
domain name. If this is still too narrow to show the domain
name and all the counters, the terminal_width limit is
violated.</p>

<p style="margin-top: 1em">-N batch_msg_count <br>
When the output device is a terminal, intermediate results
are shown each &quot;batch_msg_count&quot; messages. This
produces usable results in a reasonable time even when the
<br>
deferred queue is large. The default is to show intermediate
results every 1000 messages.</p>

<p style="margin-top: 1em">-n batch_top_domains <br>
When reporting intermediate or final results to a termainal,
report only the top &quot;batch_top_domains&quot; domains.
The default limit is 20 domains.</p>

<p style="margin-top: 1em">-c config_directory <br>
The main.cf configuration file is in the named directory
instead of the default configuration directory.</p>

<p style="margin-top: 1em">Arguments:</p>

<p style="margin-top: 1em">queue_name <br>
By default qshape displays the combined distribution of the
incoming and active queues. To display a different set of
queues, just list their directory names on the com&acirc;
<br>
mand line. Absolute paths are used as is, other paths are
taken relative to the main.cf queue_directory parameter
setting. While main.cf supports the use of $variable <br>
expansion in the definition of the queue_directory
parameter, the qshape program does not. If you must use
variable expansions in the queue_directory setting, you must
<br>
specify an explicit absolute path for each queue
subdirectory even if you want the default incoming and
active queue distribution.</p>

<p style="margin-top: 1em">SEE ALSO <br>
mailq(1), List all messages in the queue. <br>
QSHAPE_README Examples and background material.</p>

<p style="margin-top: 1em">FILES <br>
$config_directory/main.cf, Postfix installation parameters.
<br>
$queue_directory/maildrop/, local submission directory. <br>
$queue_directory/incoming/, new message queue. <br>
$queue_directory/hold/, messages waiting for tech support.
<br>
$queue_directory/active/, messages scheduled for delivery.
<br>
$queue_directory/deferred/, messages postponed for later
delivery.</p>

<p style="margin-top: 1em">LICENSE <br>
The Secure Mailer license must be distributed with this
software.</p>

<p style="margin-top: 1em">AUTHOR(S) <br>
Victor Duchovni <br>
Morgan Stanley</p>
 
<p style="margin-top: 1em">QSHAPE(1)</p>
<hr>
</body>
</html>
