<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 15:53:28 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>avenger(1) Mail Avenger 0.8.4 avenger(1)</p>

<p style="margin-top: 1em">NAME <br>
avenger - Mail Avenger</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Mail Avenger is a highly-configurable MTA-independent SMTP
(Simple Mail Transport Protocol) server designed to let you
filter and fight SPAM before accepting incoming mail from a
<br>
client machine. avenger is the script run on behalf of each
user to decide whether to accept incoming mail.</p>

<p style="margin-top: 1em">When a client attempts to send
mail to a user on the system, the avenger SMTP daemon,
asmtpd, runs avenger to process the file .avenger/rcpt in
the user&rsquo;s home directory. That <br>
file, a shell script with access to special functions,
determines how the SMTP server should proceed. The possible
outcomes are:</p>

<p style="margin-top: 1em">&Acirc;&middot; Provisionally
accept the mail, falling back to system-default rules</p>

<p style="margin-top: 1em">&Acirc;&middot; Accept the mail
immediately with no further checks</p>

<p style="margin-top: 1em">&Acirc;&middot; Reject the mail
immediately</p>

<p style="margin-top: 1em">&Acirc;&middot; Defer the mail,
telling the client to re-send it later</p>

<p style="margin-top: 1em">&Acirc;&middot; Redirect the
processing to another local name. The name can be another
email address belonging to the current user, or an email
address belonging to the special AvengerUser <br>
user. In the later case, avenger will be re-run with a
different user ID, and hence can, for example, employ
utilities that maintain state across multiple users
(assuming <br>
they all redirect processing the same way).</p>

<p style="margin-top: 1em">&Acirc;&middot; Run a
&quot;bodytest&quot; rule. With this outcome, the the SMTP
transaction continues on to receive the entire contents of
the mail message, after which a program is run on the <br>
contents of the mail message. That program can decide, based
on the contents, whether to accept, reject, defer, or
silently discard the message.</p>

<p style="margin-top: 1em">Mail Avenger should typically be
configured to have a Separator character, allowing each user
to maintain multiple email addresses. With sendmail,
Separator is typically &quot;+&quot;, <br>
with qmail it is typically &quot;-&quot;. If the separator
is &quot;+&quot;, then any email sent to user+ext@your-host
will be processed by files in user&rsquo;s .avenger
directory.</p>

<p style="margin-top: 1em">Avenger first checks for a file
named rcpt+ext in a user&rsquo;s .avenger directory, then
for rcpt+default. If ext itself contains the separator
character, for example <br>
user+ext1+ext2@your-host, avenger will check first for
rcpt+ext1+ext2, then for rcpt+ext1+default, then for
rcpt+default. The same algorithm is extended for arbitrarily
many <br>
separator characters. (If separator is &quot;-&quot;, simply
replace &quot;+&quot; with &quot;-&quot; throughout the
above description, including in the names of files such as
rcpt-default.)</p>

<p style="margin-top: 1em">If mail is rejected by the
recipient checks but the sender address of a message is
local and UserMail is 1 in asmtpd.conf (which is not the
default), then before rejecting mail, <br>
avenger will be run on behalf of the sending user. In this
case, the address will be parsed as above, but avenger will
look for rules in files beginning mail instead of rcpt. <br>
This mechanism can be used by local users who want to relay
mail through the server from an untrusted IP address.</p>

<p style="margin-top: 1em">Using the mail configuration
files, each user can, for instance, configure a mail+...
file to accept mail from an IP address he or she trusts,
even if that address is not trusted <br>
by all users. (Alternatively, using tools such as macutil, a
user might set up relaying of mail in which the envelope
sender contains a cryptographic code, checked by the <br>
mail+... script.)</p>

<p style="margin-top: 1em">Error output of an avenger
script rcpt+ext or mail+ext is redirected to a file called
log+ext in the same directory, for use in debugging.</p>

<p style="margin-top: 1em">AVENGER SYNTAX <br>
Avenger configuration files are simply shell scripts, using
the syntax described in sh(1). Each line of the file
contains a variable assignment, command, or function to run.
<br>
Scripts can additionally make use of a number of
avenger-specific functions and variables. This section
describes avenger functions. The next two sections describe
variables.</p>

<p style="margin-top: 1em">errcheck <br>
Certain error conditions result in Mail Avenger rejecting
mail by default, unless the message is explicitly accepted
through an accept or successful bodytest check. These <br>
conditions are indicated by the MAIL_ERROR environment
variable described below. If your script either rejects mail
or falls through to the default behavior, there is often
<br>
no reason to run tests on a message that will end up being
rejected either way. errcheck exits immediately with the
default error if the default would be to reject or defer
<br>
the mail.</p>

<p style="margin-top: 1em">accept [message] <br>
Immediately accepts the message (without falling back to any
default rules). If message is supplied, it will be returned
to the SMTP client. The default message is
&quot;ok&quot;.</p>

<p style="margin-top: 1em">reject [message] <br>
Reject the mail, with message. (The default message is
&quot;command rejected for policy reasons&quot;).</p>

<p style="margin-top: 1em">defer [message] <br>
Reject the mail with a temporary error code, so that a
legitimate mail client will attempt to re-send it later. The
default for message is &quot;temporary error in
processing&quot;.</p>

<p style="margin-top: 1em">bodytest command [arg ...] <br>
Accept the current SMTP &quot;RCPT&quot; command. However,
once the whole mail message has been received with the SMTP
&quot;DATA&quot; command, run command with the message as
its standard <br>
input. Depending on the exit status of command return to the
client&rsquo;s &quot;DATA&quot; command either success,
temporary, or permanent failure. Exit code 0 means accept
the mail, 100 <br>
means reject, 111 means reject with a temporary error code
(i.e., defer the mail). See the description of bodytest in
the asmtpd/avenger interface description for more <br>
information on bodytest (since this function directly
invokes bodytest in asmtpd).</p>

<p style="margin-top: 1em">Error output from command will
be redirected to the same log file as output from the
rcpt+... avenger script invoking the bodytest function.
Standard output of command will <br>
be included as a diagnostic the bounce message if the exit
code defers or rejects the mail.</p>

<p style="margin-top: 1em">Note that command and the
arguments passed to bodytest will be run by the shell. Thus,
it is important not to pass any arguments that might contain
shell metacharacters such <br>
as &quot;&gt;&quot; and &quot;$&quot;.</p>

<p style="margin-top: 1em">redirect local <br>
Finish processing, and re-run avenger as if mail were being
sent to a different username local (possibly belonging to
the special AvengerUser user). See the description of <br>
redirect in the asmtpd/avenger interface description for
more information on redirect (since this function directly
invokes redirect in asmtpd).</p>

<p style="margin-top: 1em">greylist [sender-key] <br>
This command defers mail the first time mail is received
from a particular sender at a particular IP address.
However, after a certain interval, greylist_delay, if the
<br>
client re-sends the mail, it will be accepted. Furthermore,
from that point on, all mail will be immediately accepted
from that sender and IP address, unless the sender <br>
stops sending mail for a period of greylist_ttl2 or more.
If, however, after sending the initial, defered piece of
mail, the client does not try again within a period of <br>
greylist_ttl1, then any record of the client will be erased,
and the next time it tries to send mail it will be defered
again.</p>

<p style="margin-top: 1em">The parameters can be tuned by
setting variables in the script. The default values are:</p>

<p style="margin-top: 1em">greylist_delay=30m # Time to
wait before allowing message <br>
greylist_ttl1=5h # How long to remember first-time senders
<br>
greylist_ttl2=36D # How long to remember ok senders</p>

<p style="margin-top: 1em">m means minutes, h hours, and D
days. For a complete list of allowed suffixes, see the
documentation for dbutil(1) (in particular for the --expire
option).</p>

<p style="margin-top: 1em">sender-key, if supplied, is used
to identify the sender. The default value is
&quot;$CLIENT_IP $RECIPIENT $SENDER&quot;. If, for example,
you wanted to record only the first 24-bits <br>
of IP address and didn&rsquo;t care about the recipient, you
could use the command:</p>

<p style="margin-top: 1em">greylist &quot;${CLIENT_IP%.*}
$SENDER&quot;</p>

<p style="margin-top: 1em">setvars <br>
All functions that set a variable by means of an external
query to asmtpd are performed asynchronously. setvars
actually waits for results and sets the values of those <br>
variables. In this way, a number of potentially slow
requests (such as DNS lookups) can be initiated
concurrently, and their latencies overlapped. However, one
must <br>
remember to call setvars, or else variables that should
contain the results of operations will remain unset.</p>

<p style="margin-top: 1em">dns var type domain-name <br>
Performs a DNS lookup of domain-name for records of type
type, and assigns the result to variable var when you call
setvars. type must be one of a, mx, ptr, or txt (lower- <br>
case only).</p>

<p style="margin-top: 1em">rbl [-ipf] var domain <br>
Looks up the current mail sender in a real-time blackhole
list (RBL). domain is the domain name of the RBL (e.g.,
&quot;bl.spamcop.net&quot;). If the sender is listed, set
var to the <br>
result of the DNS lookup when you next call setvars. -i
looks up the sender&rsquo;s IP address (the default if no
options are specified). -p looks up the sender&rsquo;s
domain name <br>
(verified DNS PTR record). -f looks up the envelope sender
domain name in the RBL.</p>

<p style="margin-top: 1em">spf0 var [spf-mechanism ...]
<br>
spf var [spf-mechanism ...] <br>
Tests the sender against an arbitrary query formulated in
the SPF language. This is a powerful way to whitelist or
blacklist particular senders. For example, suppose you <br>
want to accept any mail from machines in the list maintained
by trusted-forwarder.org, accept mail from any machine name
ending &quot;yahoo.com&quot; reject any mail from users in
the <br>
spamcop RBL, and for other users fall back to the default
system-wide rules. You might use the following rcpt
file:</p>

<p style="margin-top: 1em">spf MYSPF
+include:spf.trusted-forwarder.org +ptr:yahoo.com
-exists:%{ir}.bl.spamcop.net ?all <br>
setvars <br>
case &quot;$MYSPF&quot; in <br>
pass) <br>
accept &quot;I like you&quot; <br>
;; <br>
fail) <br>
reject &quot;I don&rsquo;t like you&quot; <br>
;; <br>
error) <br>
# Note, could instead fall through to default here <br>
defer &quot;Temporary DNS error&quot; <br>
;; <br>
esac</p>

<p style="margin-top: 1em">Note that commands spf0 and spf
are synonymous, but spf is deprecated, because in a later
release of Mail Avenger spf will become synonymous with
spf1.</p>

<p style="margin-top: 1em">spf1 var [spf-mechanism ...]
<br>
Performs the same tests as the spf directive, but returns
the result strings None, Neutral, Pass, Fail, SoftFail,
TempError, and PermError instead of none, neutral, pass,
<br>
fail, softfail, error, and unknown.</p>

<p style="margin-top: 1em">AVENGER VARIABLES <br>
These variables are set by the avenger script. In addition,
asmtpd sets a number of environment variables before running
avenger. These are documented in the next section, <br>
ENVIRONMENT.</p>

<p style="margin-top: 1em">FILEX <br>
The extension on the file currently being processed. For
example, if file rcpt+ext is being processed, will be set to
&quot;+ext&quot;. Empty when processing just rcpt (or mail).
<br>
May also contain default when a default rule file for some
suffix is being run.</p>

<p style="margin-top: 1em">PREFIX <br>
SUFFIX <br>
Assuming the separator is &quot;+&quot;, when processing a
file rcpt+base+default or mail+base+default, PREFIX is set
to base, while SUFFIX is set to the portion of the name for
which <br>
default was substituted. When the file does not end with
default, SUFFIX is empty. When the file is just rcpt with no
extension, both PREFIX and SUFFIX are empty. When <br>
SUFFIX itself contains a &quot;+&quot; character, SUFFIX1
contains to the part of SUFFIX after the first &quot;+&quot;
character, SUFFIX2 contains the part after the second
&quot;+&quot;, and so on for <br>
each &quot;+&quot; character in suffix.</p>

<p style="margin-top: 1em">ENVIRONMENT <br>
AUTH_USER <br>
If Mail Avenger was compiled with SASL support (which is not
the default, unless you supplied the --enable-sasl argument
to &quot;configure&quot;), and if the client successfully
<br>
authenticates to the server using SASL, then AUTH_USER will
be set to the name of the authenticated user.</p>

<p style="margin-top: 1em">AVENGER_MODE <br>
Set to &quot;rcpt&quot; when testing whether a recipient
should receive mail. Set to &quot;mail&quot; (possibly after
an &quot;rcpt&quot; check fails) when checking whether to
relay mail (possibly on <br>
behalf of a local user).</p>

<p style="margin-top: 1em">AVUSER <br>
The effective local username for which avenger is being run.
Ordinarily, this will be the same as:</p>


<p style="margin-top: 1em">$USER${PREFIX+$SEPARATOR}$PREFIX
${SUFFIX+$SEPARATOR}$SUFFIX</p>

<p style="margin-top: 1em">However, for special avenger
files like unknown and default, it can contain useful
information, because unlike the RECIPIENT_LOCAL environment
variable, AVUSER reflects <br>
substitutions from the Mail Avenger domains and aliases
files.</p>

<p style="margin-top: 1em">CLIENT <br>
This variable contains the name of the client machine, as
typically reported in &quot;Received:&quot; headers. Its
value has the form:</p>

<p style="margin-top: 1em">[user@]host</p>

<p style="margin-top: 1em">user is the user name for the
connection reported by the client, if the client supports
the RFC 1413 identification protocol, otherwise it is
omitted. host is a verified DNS <br>
hostname for the IP, if asmtpd could find one. Otherwise, it
is simply the numeric IP address.</p>

<p style="margin-top: 1em">CLIENT_COLONSPACE <br>
Set to 1 if the client included a space between the colon in
the command &quot;MAIL FROM:&quot; or &quot;RCPT TO:&quot;
and the subsequent &quot;&lt;&quot; that begins an email
address.</p>

<p style="margin-top: 1em">CLIENT_DNSFAIL <br>
If AllowDNSFail is set to 1 in the asmtpd.conf file and
resolving the client&rsquo;s IP to a hostname returns a
temporary error, then this variable will be set to a
description of <br>
the error.</p>

<p style="margin-top: 1em">CLIENT_HELO <br>
Set to the argument the client supplied to the SMTP
&quot;HELO&quot; or &quot;EHLO&quot; command.</p>

<p style="margin-top: 1em">CLIENT_IP <br>
Set to the IP address of the client.</p>

<p style="margin-top: 1em">CLIENT_NAME <br>
Set to the verified DNS name of the client, if asmtpd can
find one.</p>

<p style="margin-top: 1em">CLIENT_NETHOPS <br>
Set to the number of network hops between the server and the
client, if asmtpd can get the client or its firewall to
return an ICMP destination unreachable (type 3 packet) in
<br>
response to a UDP probe. Whether or not this is set will
depend on firewall configurations.</p>

<p style="margin-top: 1em">CLIENT_NETPATH <br>
Set to as many intermediary network hops as asmtpd can
determine between the server and the client. How close to
the client asmtpd can probe will depend on firewalls.</p>

<p style="margin-top: 1em">CLIENT_PIPELINING <br>
Set to 1 if the client wrote data after the SMTP HELO or
EHLO command, before receiving its response. A correct SMTP
client should not &quot;pipeline&quot; commands until after
<br>
receiving the result of the HELO command and verifying that
the server accepts pipelined commands.</p>

<p style="margin-top: 1em">CLIENT_PORT <br>
The TCP port number of the client.</p>

<p style="margin-top: 1em">CLIENT_POST <br>
Set to 1 if the client sent a &quot;POST&quot; command at
some point during the SMTP session. &quot;POST&quot; is not
a valid SMTP command; it is an HTTP command. However, one
technique for <br>
sending spam involves exploiting an open web proxy to
&quot;post&quot; an SMTP session to a mail server. The
initial HTTP headers (including the HTTP post command)
simply cause SMTP <br>
syntax errors, while the body of the POST command contains
SMTP commands. By checking the CLIENT_POST environment
variable, you to reject mail sent in this way.</p>

<p style="margin-top: 1em">CLIENT_REVIP <br>
The value of CLIENT_IP with the order of the bytes reversed.
Suitable for prepending to &quot;.in-addr.arpa&quot; or an
RBL domain to perform a DNS lookup based on IP address.</p>

<p style="margin-top: 1em">CLIENT_SYNFP <br>
Contains a fingerprint, abstracting the contents of the
initial TCP SYN packet the client sent to establish the TCP
connection. The exact contents of SYN packets depends on
<br>
the operating system and version of the client, and can
therefore reveal interesting information about the type of
client connecting to your mail server. The format of the
<br>
fingerprint is:</p>

<p style="margin-top: 1em">wwww:ttt:D:ss:OOO</p>

<p style="margin-top: 1em">Where the fields are as
follows:</p>

<p style="margin-top: 1em">wwww <br>
the initial TCP window size</p>

<p style="margin-top: 1em">ttt the IP ttl of the received
packet</p>

<p style="margin-top: 1em">D the IP &quot;don&rsquo;t
fragment&quot; bit</p>

<p style="margin-top: 1em">ss total size of the SYN packet
(including IP header)</p>

<p style="margin-top: 1em">OOO a comma-separated list of
TCP options, as follows:</p>

<p style="margin-top: 1em">N NOP option</p>

<p style="margin-top: 1em">Wnnn <br>
window scaling option with value nnn</p>

<p style="margin-top: 1em">Mnnn <br>
maximum segment size value nnn</p>

<p style="margin-top: 1em">S Selective ACK OK</p>

<p style="margin-top: 1em">T timestamp option</p>

<p style="margin-top: 1em">T0 timestamp option with value
zero</p>

<p style="margin-top: 1em">CLIENT_SYNOS <br>
If asmtpd can guess the client&rsquo;s operating system
based on CLIENT_SYNFP, it will set CLIENT_SYNOS to the value
of that guess. For example, to greylist mail from Windows
<br>
machines, you can run:</p>

<p style="margin-top: 1em">match -q &quot;*Windows*&quot;
&quot;$CLIENT_SYNOS&quot; &amp;&amp; greylist</p>

<p style="margin-top: 1em">DATA_BYTES <br>
This variable is not really an avenger variable, as it is
only available in bodytest commands. It specifies the number
of bytes of message transfered in the SMTP DATA <br>
command, but after converting CR NL sequences to NL. Roughly
speaking this is how many bytes are in the message including
all headers after the X-Avenger:, SPF-Received, or <br>
Received: header.</p>

<p style="margin-top: 1em">ETCDIR <br>
The value of EtcDir from the asmtpd configuration file (or
/etc/avenger by default).</p>

<p style="margin-top: 1em">EXT When avenger runs on behalf
of a user EXT is set to the part of the address that
determines the suffix of the rcpt or mail file. For example,
suppose Separator is &quot;-&quot; and <br>
the recipient is list-subscribe@host, where host is not a
virtual domain. If the AliasFile contains:</p>

<p style="margin-top: 1em">list: user-mylist</p>

<p style="margin-top: 1em">Then avenger will be run on
behalf of &quot;user&quot; (because alias expansion yields
user-mylist-subscribe). EXT will be set to
mylist-subscribe.</p>

<p style="margin-top: 1em">Note that EXT is empty when
there is no suffix, and that it is equal to the name of the
system file being processed when avenger is run on a system
file. Like RECIPIENT, <br>
this variable is not set for bodytest commands.</p>

<p style="margin-top: 1em">HOST <br>
Set to the name of the local host, as specified by the
HostName directive in avenger.conf.</p>

<p style="margin-top: 1em">MAIL_ERROR <br>
This variable is set when the SPF disposition of the sender
is fail, or when asmtpd is unable to send a bounce message
to the sender address. In either case, Mail Avenger <br>
will reject the mail if the script falls through to the
default.</p>

<p style="margin-top: 1em">MSGID <br>
A randomly generated string for this message, which can be
useful to correlate calls to rcpt scripts with bodytest
scripts. Note this is unrelated to the Message-ID header
<br>
in the message, but does show up in the Received header that
Mail Avenger inserts.</p>

<p style="margin-top: 1em">MYIP <br>
IP address of local end of SMTP TCP connection.</p>

<p style="margin-top: 1em">MYPORT <br>
TCP port number of local end of SMTP TCP connection.
Ordinarily this will be 25.</p>

<p style="margin-top: 1em">RECIPIENT <br>
The envelope recipient of the message. Note that this
environment variable is not present for bodytest programs,
since such programs may be run on behalf of multiple
users.</p>

<p style="margin-top: 1em">RECIPIENT_HOST <br>
The domain part of RECIPIENT, folded to lower-case--i.e.,
host when RECIPIENT is local@host. Not present for bodytest
programs, as noted in the description of RECIPIENT.</p>

<p style="margin-top: 1em">RECIPIENT_LOCAL <br>
The local part of RECIPIENT, folded to lower-case--i.e.,
local when RECIPIENT is local@host. Not present for bodytest
programs, as noted in the description of RECIPIENT.</p>

<p style="margin-top: 1em">SENDER <br>
The envolope sender of this mail message (i.e., the argument
supplied by the client to the &quot;MAIL FROM:&quot; SMTP
command.)</p>

<p style="margin-top: 1em">SENDER_HOST <br>
The hostname part of SENDER, converted to lower-case (i.e.,
host in user@host).</p>

<p style="margin-top: 1em">SENDER_LOCAL <br>
The local part of SENDER, converted to lower-case (i.e.,
user in user@host).</p>

<p style="margin-top: 1em">SENDER_MXES <br>
A list of DNS MX records for SENDER_HOST, if that hostname
has any MX records.</p>

<p style="margin-top: 1em">SENDER_BOUNCERES <br>
For non-empty envelope senders, asmtpd attempts to see if it
is possible to deliver bounce messages for the sender. If
not, SENDER_BOUNCERES is set to a three-digit SMTP <br>
error code. If the first digit is 4, the error was
temporary. If the first digit is 5, the error was permanent.
Note that failure to accept bounce messages is considered a
<br>
MAIL_ERROR as described above, and will cause mail to be
rejected by default.</p>

<p style="margin-top: 1em">SEPARATOR <br>
The value of Separator from the asmtpd configuration file.
There is no default (SEPARATOR will not be set if no
Separator is specified in the configuration file). However,
<br>
it should be configured for &quot;+&quot; with sendmail and
&quot;-&quot; with qmail.</p>

<p style="margin-top: 1em">SPF0 <br>
SPF The result of performing an SPF check on the message.
Will be one of: none, neutral, pass, fail, softfail, error,
or unknown. Note that SPF0 and SPF are synonymous, but SPF
<br>
is deprecated as a future release of Mail Avenger will make
SPF synonymous with SPF1.</p>

<p style="margin-top: 1em">SPF1 <br>
Also the result of performing an SPF check on the message,
but returns different names for the results, to be
compatible with newer revisions of the SPF protocol <br>
specification. The new names are None, Neutral, Pass, Fail,
SoftFail, TempError, and PermError.</p>

<p style="margin-top: 1em">SPF_EXPL <br>
The explanation string that goes along with a bad SPF
status.</p>

<p style="margin-top: 1em">SSL_CIPHER <br>
If the Mail Avenger has been compiled with support for the
STARTTLS command (using the --enable-ssl option to
&quot;configure&quot;), and the client is communicating over
SSL/TLS, this <br>
variable will contain a textual description of the
algorithm.</p>

<p style="margin-top: 1em">SSL_CIPHER_BITS <br>
SSL_ALG_BITS <br>
SSL_CIPHER_BITS contains the number of secret key bits used
by the SSL/TLS ciphers. SSL_ALG_BITS is the number of bits
used by the algorithm. For example, if you are using <br>
128-bit RC4 with 88 bits sent in cleartext, SSL_CIPHER_BITS
will only be 40, since that is the effective security, while
SSL_ALG_BITS will be 128.</p>

<p style="margin-top: 1em">SSL_ISSUER <br>
SSL_ISSUER_DN <br>
If the client has successfully authenticated itself using an
SSL certificate, SSL_ISSUER will be set to the certificate
signer&rsquo;s common name, while SSL_ISSUER_DN will be set
<br>
to a compact representation of the signer&rsquo;s full
distinguished name. The full distinguished name is in the
form output by the command:</p>

<p style="margin-top: 1em">openssl x509 -noout -issuer -in
cert.pem</p>

<p style="margin-top: 1em">Note that this variable is
mostly useful if the SSLCAcert file you have given to Mail
Avenger contains more than one certificate authority, or
signs other CA certificates. <br>
Mail Avenger will not accept client certificates if it does
not recognize the signer of the certificate.</p>

<p style="margin-top: 1em">SSL_SUBJECT <br>
SSL_SUBJECT_DN <br>
If the client has successfully authenticated itself using an
SSL certificate, SSL_SUBJECT will be set to the
client&rsquo;s common name in the certificate, while
SSL_SUBJECT_DN <br>
will be set to a compact representation of the
client&rsquo;s full distinguished name. The full
distinguished name is in the form output by the command:</p>

<p style="margin-top: 1em">openssl x509 -noout -subject -in
cert.pem</p>

<p style="margin-top: 1em">SSL_VERSION <br>
The version of the SSL/TLS protocol in use.</p>

<p style="margin-top: 1em">UFLINE <br>
An mbox &quot;From &quot; line suitable for prepending to
the message before passing the message to a delivery
program. (This is mostly useful for bodytest rules.)</p>

<p style="margin-top: 1em">USER <br>
The name of the user under which avenger is running.</p>

<p style="margin-top: 1em">AVENGER/ASMTPD INTERFACE <br>
avenger is just a simple shell script. You can inspect the
file to see what it is doing. Most of the interesting
operations happen in either asmtpd, or in external programs
<br>
spawned from avenger. This section documents the interface
between asmtpd and avenger.</p>

<p style="margin-top: 1em">avenger inherits a unix-domain
socket connected to asmtpd on its standard input and output.
It sends commands to asmtpd over this socket, and similarly
reads replies from it. <br>
In order to avoid mixing messages to and from asmtpd with
the output of other programs you run, however, the avenger
shell script reorganizes its file descriptors so that all
<br>
communication to and from asmtpd happens over file
descriptor number 3.</p>

<p style="margin-top: 1em">Each command consists of a
single line, followed by a newline (except the return
command, which can optionally take multiple lines). There
may or may not be a reply, possibly <br>
depending on the outcome of the command. Most replies
consist of zero or more lines of the form</p>

<p style="margin-top: 1em">VARIABLE=value</p>

<p style="margin-top: 1em">VARIABLE is typically a variable
name that was supplied as part of the command. The avenger
shell script records results by setting the environment
variable VARIABLE to value, <br>
so that it can be accessed by subsequent lines of the
script.</p>

<p style="margin-top: 1em">Replies are sent in the order in
which the corresponding commands were received. However,
asmtpd executes requests asynchronously. Thus, one can
perform several concurrent <br>
operations (such as DNS requests or SPF tests) by simply
writing multiple commands to asmtpd before receiving any of
the responses.</p>

<p style="margin-top: 1em">The &quot;.&quot; command is a
no-op, but asmtpd echoes the &quot;.&quot; back to avenger
as the reply. This allows one to synchronize the avenger
process&rsquo;s state after issuing one or more <br>
commands. For example, one might issue several DNS lookups
to check various RBLs (real-time blackhole lists), then
issue a . command, then wait for replies. When the . comes
<br>
back, all previous commands will also have completed. The
avenger setvars command simply sends a &quot;.&quot;, then
loops until it reads back the &quot;.&quot;, setting
variables from any previous <br>
commands whose replies it reads in the process.</p>

<p style="margin-top: 1em">The following commands are
available:</p>

<p style="margin-top: 1em">. The . command is simply echoed
back by asmtpd.</p>

<p style="margin-top: 1em">bodytest command <br>
Ends the current avenger script. Specifies that asmtpd
should receive the entire body of the message, then run
command (under the same user ID as the current avenger
script) <br>
with the entire mail message as its standard input. asmtpd
then replies to the SMTP &quot;DATA&quot; command based on
the exit status of command as follows:</p>

<p style="margin-top: 1em">0 If command exits with status
0, asmtpd will reply to the &quot;DATA&quot; command with
success (SMTP code 250), and will pass the message to
sendmail (or whatever you have <br>
configured as Sendmail in asmtpd.conf) for delivery.</p>

<p style="margin-top: 1em">99 If command exits with status
99, asmtpd will still reply to the &quot;DATA&quot; command
with a successful 250 reply code, but will not spool the
data. Either command must have <br>
done something with the data, or the message will be
lost.</p>

<p style="margin-top: 1em">100 (also 64, 65, 70, 76, 77,
78, 112) <br>
If command exits with status 100 (or any of the above exit
statuses), avenger will reject the mail with a hard SMTP
error (code 554). If command wrote output to its <br>
standard output, this output will be passed back to the mail
client. Otherwise, asmtpd will supply the text &quot;message
contents rejected.&quot;</p>

<p style="margin-top: 1em">111 (or any other exit status)
<br>
If command exits with status 111, the result is the same as
exit status 100, except that asmtpd will use a temporary
error code (451) instead of 554.</p>

<p style="margin-top: 1em">signal <br>
If command exits abnormally because of a signal, asmtpd will
also use 451, but in this case will not pass the
program&rsquo;s output back to the client. It will instead
pass <br>
back a description of the problem.</p>

<p style="margin-top: 1em">Note that asmtpd can only run
one bodytest command per message. If there are multiple
recipients of a message, all must run the same bodytest
under the same user ID. If two <br>
users wish to run different bodytest commands, or even run
the same command under different user IDs, asmtpd will defer
the second SMTP &quot;RCPT&quot; command with the
message:</p>

<p style="margin-top: 1em">452 send a separate copy of the
message to this user</p>

<p style="margin-top: 1em">This will cause the mail client
to re-send the message later to the second user. To avoid
forcing clients to send multiple copies of messages, you can
place bodytest <br>
commands in system wide files (such as the default rule
file), or use a redirect command to redirect to the
AvengerUser, so that commands for multiple users can be run
under <br>
the AvengerUser user ID.</p>

<p style="margin-top: 1em">Note that file descriptor 0
inherited by command is opened for both reading and writing.
Thus, it is possible to modify the message before it is
spooled by the local MTA. <br>
The command edinplace(1) is useful for running messages
through spam filters that annotate messages before spooling
them.</p>

<p style="margin-top: 1em">dns-a VARIABLE domain-name <br>
Requests that asmtpd perform a DNS lookup for A (IPv4
address) records on domain-name. If such an A record exists,
the reply is a list of one or more IP addresses:</p>

<p style="margin-top: 1em">VARIABLE=IP-address ...</p>

<p style="margin-top: 1em">If no such A record exists, the
reply is simply:</p>

<p style="margin-top: 1em">VARIABLE=</p>

<p style="margin-top: 1em">With the standard avenger
script, this sets VARIABLE to the empty string. If there is
a temporary error in DNS name resolution, there is no reply,
and hence with the default <br>
avenger script VARIABLE will remain unset.</p>

<p style="margin-top: 1em">When checking such things as
RBLs, it is advisable not to reject mail because of a
temporary DNS error. You can use the shell construct
${VARIABLE-default}$ to return <br>
$VARIABLE when VARIABLE is set, and default when VARIABLE is
not set. Similarly ${VARIABLE+set} returns set if VARIABLE
is set, and the empty string otherwise.</p>

<p style="margin-top: 1em">For example, if bad-senders.org
contained an RBL of undesirable sender hosts:</p>

<p style="margin-top: 1em">echo dns-a BADSENDER
&quot;$SENDER_HOST&quot;.bad-senders.org &gt;&amp;3 <br>
setvars <br>
test -n &quot;$BADSENDER&quot; &amp;&amp; reject
&quot;$SENDER_HOST is a bad sender&quot; <br>
test -z &quot;${BADSENDER+set}&quot; &amp;&amp; defer
&quot;$SENDER_HOST.bad-senders.org: DNS error&quot;</p>

<p style="margin-top: 1em">Note that when using the avenger
script, there is already a function rbl to check RBLs.</p>

<p style="margin-top: 1em">dns-mx VARIABLE domain-name <br>
Similar to dns-a, but looks up MX records. A successful
reply is of the form:</p>

<p style="margin-top: 1em">VARIABLE=priority-1:host-1
[priority-2:host-2 ...]</p>

<p style="margin-top: 1em">Where priority-1 is the MX
priority of host-1. As before, an empty string indicates no
MX records exist, and no reply indicates an error.</p>

<p style="margin-top: 1em">dns-ptr VARIABLE IP-address <br>
Returns a list of verified DNS hostnames for IP-address. As
before, an empty string for VARIABLE indicates no PTR
records exist, and no reply indicates an error.</p>

<p style="margin-top: 1em">dns-txt VARIABLE domain-name
<br>
Similar to the other dns commands, but looks up a record of
type TXT. If multiple TXT records exist, returns only one.
Places some restrictions on the TXT records, for <br>
example will not return one that contains a newline
character.</p>

<p style="margin-top: 1em">netpath VARIABLE IP-address <br>
Maps out the network hops to IP-address (this is similar to
the traceroute system utility, but more efficient). The
reply is of the form:</p>

<p style="margin-top: 1em">VARIABLE=#hops hop1 hop2 ...</p>

<p style="margin-top: 1em">#hops is the total number of
network hops to IP-address if asmtpd can figure this out.
(It won&rsquo;t always be able to if IP-address is behind a
firewall.) If asmtpd cannot <br>
figure this out, the value is -1. hop1 and the remaining
arguments are the addresses of routers along the way to
IP-address.</p>

<p style="margin-top: 1em">redirect local <br>
Terminates the current avenger process, and instead
processes the mail as though it is being sent to local. This
command is only available in &quot;rcpt&quot; mode, as
opposed to <br>
&quot;mail&quot; mode (in which asmtpd runs avenger to see
if it should relay mail for a local user on a non-local
client machine).</p>

<p style="margin-top: 1em">local can be a local user name,
or a local user name followed by the separator character and
an extension. The name is mapped using the aliases
(specified by AliasFile in <br>
asmtpd.conf).</p>

<p style="margin-top: 1em">Note that while the AvengerUser
user can redirect to other users, ordinary users can only
redirect to themselves or the AvengerUser.</p>

<p style="margin-top: 1em">return code explanation <br>
or <br>
return code-explanation <br>
code-explanation <br>
code explanation <br>
Specifies the SMTP reponse desired. Also avoids further
processing of the message with system-wide default rulesets
(as typically happens when avenger simply exits with <br>
status 0). code must be a three digit number beginning 2, 4,
or 5. (usually 250 for success, 451 to defer mail, and 554
to reject mail).</p>

<p style="margin-top: 1em">The first form of this command
(with a space between code and explanation) gives a single
line explanation along with the result code. In the second
form, avenger specifies <br>
a multi-line response. In this case all but the last line
must contain a - between the code and explanation, while the
last line must contain a space. (Note that the return <br>
keyword only appears on the first line; after starting to
issue a return command, no further commands can be
issued.)</p>

<p style="margin-top: 1em">spf VARIABLE SPF-mechanism ...
<br>
spf0 VARIABLE SPF-mechanism ... <br>
spf1 VARIABLE SPF-mechanism ... <br>
Evaluates the mail client based on SPF mechanisms. It will
return:</p>

<p style="margin-top: 1em">VARIABLE=disposition</p>

<p style="margin-top: 1em">where, for spf0, disposition is
one of: none, neutral, pass, fail, softfail, error, or
unknown (though the disposition none is actually
impossible). For spf1, the <br>
equivalent disposition names are None, Neutral, Pass, Fail,
SoftFail, TempError, PermError. (Currently spf is a synonym
for spf0, but it is recommended that you avoid using <br>
spf as in a future release it may become an alias for
spf1.)</p>

<p style="margin-top: 1em">As an example, suppose that your
username is &quot;joe&quot;, Separator is &quot;+&quot;, and
you have subscribed to a number of yahoo mailing lists using
email address &quot;joe+yahoo&quot;. If spammers <br>
started sending mail to &quot;joe+yahoo&quot;, you would
want to reject all mail to that address except that
originating from yahoo&rsquo;s computers. Yahoo&rsquo;s
computers might correspond to <br>
anything ending &quot;.yahoo.com&quot; or sharing a 24-bit
IP-address prefix with any of yahoo.com&rsquo;s MX records.
This can be accomplished with the following script in <br>
$HOME/.avenger/rcpt+yahoo:</p>

<p style="margin-top: 1em">echo spf YAHOO ptr:yahoo.com
mx:yahoo.com/24 -all &gt;&amp;3 <br>
setvars <br>
case &quot;$YAHOO&quot; in <br>
fail) <br>
reject &quot;Sorry, this private alias for Yahoo lists
only&quot; <br>
;; <br>
error) <br>
defer &quot;Sorry, temporary DNS error&quot; <br>
;; <br>
esac</p>

<p style="margin-top: 1em">EXAMPLES <br>
If you never use your email address as an envelope sender,
you can reject all bounces to that address with these
commands in your rcpt file:</p>

<p style="margin-top: 1em">test -z &quot;$SENDER&quot;
&amp;&amp; reject &quot;&lt;$RECIPIENT&gt; not a valid
sender;&quot; &quot; should not receive bounces&quot;</p>

<p style="margin-top: 1em">The following script runs
spamassassin (a popular spam filter, available from
&lt;http://www.spamassassin.org/&gt;) on the body of a
message, unless the sender of the message has an <br>
SPF disposition of pass or is already going to be rejected
by default.</p>

<p style="margin-top: 1em"># The next line immediately
falls through to the default reject <br>
# disposition when mail has an SPF disposition of fail or
the <br>
# sender does not accept bounce messages. <br>
errcheck</p>

<p style="margin-top: 1em">test &quot;$SPF&quot; = pass ||
bodytest edinplace -x 111 spamassassin -e 100</p>

<p style="margin-top: 1em">The following script immediately
accepts any mail from any machine at MIT or NYU (provided
MAIL_ERROR is not set), &quot;greylists&quot; machines not
in one of those domains, and if the <br>
greylist passes, falls through to the the default,
system-wide rules:</p>

<p style="margin-top: 1em">errcheck</p>

<p style="margin-top: 1em">spf TRUSTED ptr:nyu.edu
ptr:mit.edu ?all <br>
setvars <br>
test pass = &quot;$TRUSTED&quot; &amp;&amp; accept Trusted
sender OK</p>

<p style="margin-top: 1em">greylist_delay=5m <br>
greylist</p>

<p style="margin-top: 1em">The following script rejects
mail from clients that have issued an SMTP &quot;POST&quot;
command (which doesn&rsquo;t exist) or used aggressive,
premature pipelining of commands. If the client <br>
put a space after the colon in the MAIL FROM: or RCPT TO:
SMTP commands, it greylists the message using a key that
includes the SYN fingerprint and first 24-bits of the IP
<br>
address. If the SPF disposition of the message is error, it
defers the message. If the SPF disposition of the message is
softfail or none, it runs the body of the message <br>
through spamassassin.</p>

<p style="margin-top: 1em">errcheck</p>

<p style="margin-top: 1em">test -n &quot;$CLIENT_POST&quot;
-o -n &quot;$CLIENT_PIPELINING&quot; &amp;&amp; reject
&quot;no spam please&quot;</p>

<p style="margin-top: 1em">test -n
&quot;$CLIENT_COLONSPACE&quot; &amp;&amp; greylist
&quot;${CLIENT_IP%.*} $CLIENT_SYNFP $SENDER&quot;</p>

<p style="margin-top: 1em">case &quot;$SPF&quot; in <br>
error) <br>
defer &quot;Temporary error in SPF record processing&quot;
<br>
;; <br>
softfail|none) <br>
bodytest edinplace -x 111 spamassassin -e 100 <br>
;; <br>
esac</p>

<p style="margin-top: 1em">If you set your MACUTIL_SENDER
environment variable to be
&quot;user+bounce+*@your.host.com&quot; and send mail with
macutil --sendmail, you can create the following
rcpt+bounce+default to <br>
accept mail only to valid bounce addresses.</p>

<p style="margin-top: 1em">macutil --check
&quot;$SUFFIX&quot; &gt; /dev/null || reject
&quot;&lt;$RECIPIENT&gt;.. user unknown&quot;</p>

<p style="margin-top: 1em">In conjunction with this script,
you may want to reject bounce messages to your regular email
addresss with your rcpt script, as described in the first
example.</p>

<p style="margin-top: 1em">This example is slightly more
complicated, and shows how to use a bodytest to reject mail
based on message contents. The goal of this set-up is to
check each message with the <br>
ClamAV anti-virus software (from
&lt;http://www.clamav.net/&gt;) and the spamassassin mail
filter. If the message contains a virus or is flagged as
spam, it should be rejected with an <br>
explanation of the problem. We construct a shell script,
$HOME/.avenger/body, to run these tests on message bodies.
The script can be invoked with the line</p>

<p style="margin-top: 1em">bodytest $HOME/.avenger/body</p>

<p style="margin-top: 1em">in your $HOME/.avenger/rcpt
file. Or, alternatively the script could be configured to
run in the system-wide /etc/avenger/default file (in which
case you want to make sure that <br>
the AvengerUser can write its own home directory, so as to
store spamassassin files). The script is as follows:</p>

<p style="margin-top: 1em">#!/bin/sh <br>
out=&quot;&lsquo;clamscan -i --no-summary --mbox -
2&gt;&amp;1&lsquo;&quot; <br>
if test &quot;$?&quot; = 1; then <br>
echo This message appears to be infected with a virus <br>
printf &quot;%s0 &quot;$out&quot; | sed -e
&rsquo;/Warning:/d&rsquo; -e &rsquo;s/^[^:]*: //&rsquo; |
sort -u <br>
exit 100 <br>
fi</p>

<p style="margin-top: 1em">out=&quot;&lsquo;edinplace -x
111 spamassassin -e 100&lsquo;&quot; <br>
case &quot;$?&quot; in <br>
0) <br>
exit 0 <br>
;; <br>
100) <br>
echo Sorry, spamassassin has flagged your message as spam
<br>
while read a b c; do <br>
test &quot;$a $b&quot; = &quot;Content analysis&quot;
&amp;&amp; break <br>
done <br>
read a <br>
read a <br>
read a <br>
while read a b c; do <br>
case &quot;$a&quot; in <br>
&quot;&quot;) <br>
break <br>
;; <br>
-*) <br>
;; <br>
[0-9]*) <br>
printf &quot; %s0 &quot;$c&quot; <br>
;; <br>
*) <br>
printf &quot; %s0 &quot;$a $b $c&quot; <br>
;; <br>
esac <br>
done <br>
exit 100 <br>
;; <br>
*) <br>
if test -n &quot;$out&quot;; then <br>
echo spamassassin failure: <br>
printf &quot;%s0 &quot;$out&quot; <br>
else <br>
echo system error in spamassassin <br>
fi <br>
exit 111 <br>
;; <br>
esac</p>

<p style="margin-top: 1em">The first half of this script
runs the clamscan virus checker, storing the output in
variable out. clamscan exits with code 1 when a virus is
found, exits 0 on success, and uses <br>
other error codes to indicate various system errors. We only
want to reject mail if clamscan exits with code 1. When this
happens, we take the output of clamscan, format it in <br>
a more pleasing way (stripping out warnings), and send it to
standard output. An example of an SMTP transaction using
this bodytest and detecting a virus will look like this <br>
(tested with the special EICAR test string that flags a
positive with most virus checkers):</p>

<p style="margin-top: 1em">DATA <br>
354 enter mail, end with &quot;.&quot; on a line by itself
<br>
Subject: eicar test</p>


<p style="margin-top: 1em">X5O!P%@AP[4PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*
<br>
. <br>
554-This message appears to be infected with a virus <br>
554 Eicar-Test-Signature FOUND</p>

<p style="margin-top: 1em">If the virus check fails, the
script runs the message through spamassassin to check for
spam. Note that spamassassin modifies the mail message, so
that we must run it with <br>
edinplace. Note also that clamscan will read to the end of
the input file, but this is okay since edinplace rewinds its
standard input. We use the -e flag to tell spamassassin <br>
to exit 100 on spam. Then, if spamassassin exits 0, we
accept the mail. If it exits with anything but 100,
something went wrong and we temporarily defer the mail. Note
that it <br>
might also be possible to accept the mail at this point, but
since spamassassin edits the file in place, the message may
be truncated if spamassassin exits unexpectedly.</p>

<p style="margin-top: 1em">If spamassassin exits 100, we
reject the mail. We also report on why spamassassin has
rejected the mail. Here again we take advantage of the fact
that edinplace rewinds its <br>
standard input both before and after processing a message.
Because the file descriptor has been rewound, we can start
processing the message one line at a time with the shell
<br>
script. Spamassassin by default (if you have not configred
it with &quot;report_safe 0&quot;) contains a spam report
like this:</p>

<p style="margin-top: 1em">Content analysis details: (11.7
points, 5.0 required)</p>

<p style="margin-top: 1em">pts rule name description <br>
---- ---------------
-------------------------------------------------- <br>
1.0 RATWARE_RCVD_AT Bulk email fingerprint (Received @)
found <br>
4.2 X_MESSAGE_INFO Bulk email fingerprint (X-Message-Info)
found <br>
0.0 MONEY_BACK BODY: Money back guarantee <br>
0.5 BIZ_TLD URI: Contains a URL in the BIZ top-level domain
<br>
0.6 URIBL_SBL Contains a URL listed in the SBL blocklist
<br>
[URIs: crocpeptide.biz] <br>
0.5 URIBL_WS_SURBL Contains a URL listed in the WS SURBL
blocklist <br>
[URIs: crocpeptide.biz] <br>
...</p>

<p style="margin-top: 1em">We skip over the headers, and
for each result, print it to the SMTP session.
Negative/whitelist results (those starting -), we do not
report, and comment lines (not starting <br>
with a number) we print indented. A typical SMTP session
looks like this (using the special GTUBE test line that
triggers spam filters):</p>

<p style="margin-top: 1em">DATA <br>
354 enter mail, end with &quot;.&quot; on a line by itself
<br>
Subject: gtube test</p>


<p style="margin-top: 1em">XJS*C4JDBQADN1.NSBN3*2IDNEN*GTUBE-STANDARD-ANTI-UBE-TEST-EMAIL*C.34X
<br>
. <br>
554-Sorry, spamassassin has flagged your message as spam
<br>
554- Missing Date: header <br>
554 BODY: Generic Test for Unsolicited Bulk Email</p>

<p style="margin-top: 1em">Here&rsquo;s an example of how
to use SSL client certificates for authentication. If you
have a private CA with common name &quot;My CA&quot; that
signs the certificates of all your authorized <br>
mail clients, you can place the following in
/etc/avenger/relay to permit those clients to relay:</p>

<p style="margin-top: 1em">test &quot;My CA&quot; =
&quot;$SSL_ISSUER&quot; &amp;&amp; accept &quot;Relaying
permitted for client $SSL_SUBJECT&quot; <br>
reject &quot;relaying denied&quot;</p>

<p style="margin-top: 1em">FILES <br>
/usr/local/libexec/avenger, /etc/avenger/default,
$HOME/.avenger/rcpt, $HOME/.avenger/rcpt*
$HOME/.avenger/mail, $HOME/.avenger/mail*</p>

<p style="margin-top: 1em">SEE ALSO <br>
dbutil(1), deliver(1), edinplace(1), escape(1), macutil(1),
match(1), synos(1), asmtpd.conf(5), asmtpd(8),
avenger.local(8)</p>

<p style="margin-top: 1em">The Mail Avenger home page:
&lt;http://www.mailavenger.org/&gt;.</p>

<p style="margin-top: 1em">BUGS <br>
avenger (and the configuration files it reads) are shell
scripts. In a shell script, it is sometimes tempting to use
&quot;echo ...&quot; where one should instead use the
command &quot;printf <br>
&rsquo;%s0 ...&quot;. (The later just prints its argument to
standard output, while the former interprets various
&quot;</p>

<p style="margin-top: 1em">In shell scripts, one must be
careful about variables containing shell metacharacters. For
example, it is not safe to run something like:</p>

<p style="margin-top: 1em">bodytest &quot;echo $VAR &gt;
$PWD/log&quot;</p>

<p style="margin-top: 1em">if variable &quot;VAR&quot; has
untrusted contents that might contain characters like
&quot;&gt;&quot; or &quot;;&quot;. The reason is that $VAR
will be expanded and sent back to the SMTP server, which
will <br>
then pass the expansion to the shell to execute the
bodytest. ($VAR effectively gets expanded twice.) The escape
utility can be used to avoid these problems. For
example:</p>

<p style="margin-top: 1em">bodytest echo &lsquo;escape
&quot;$VAR&quot;&lsquo; &quot;&gt;&quot; $PWD/log</p>

<p style="margin-top: 1em">It is easy to forget to call
setvars after a dns, rbl, or spf command.</p>

<p style="margin-top: 1em">AUTHOR <br>
David Mazieres</p>

<p style="margin-top: 1em">Mail Avenger 0.8.4 2013-07-13
avenger(1)</p>
<hr>
</body>
</html>
