<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:11:23 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>fwbedit(1) Firewall Builder fwbedit(1)</p>

<p style="margin-top: 1em">NAME <br>
fwbedit - General purpose object tree editing tool</p>

<p style="margin-top: 1em">SYNOPSIS <br>
fwbedit command [options]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
fwbedit is a general purpose object tree editing tool for
Firewall Builder (see fwbuilder(1)). This tool can be used
in the shell scripts written for batch-processing of the
<br>
Firewall Builder data files. Fwbedit can perform the
following operations on the objects and the tree: create new
object, delete existing object, modify attributes of an
object, <br>
add a reference to the given object to a group, remove
reference to an object from a group, upgrade data file and
check object tree in the file and repair it if necessary.
Both <br>
object and a group can be defined by their ID or by their
name and a full path in the tree (see section EXAMPLES
below).</p>

<p style="margin-top: 1em">COMMANDS AND OPTIONS: <br>
new -f file.fwb -t objtype -n name -p parent [-c comment]
[-a attrs]</p>

<p style="margin-top: 1em">Creates new object.</p>

<p style="margin-top: 1em">-f file.fwb data file <br>
-t objtype create new object of this type <br>
-p parent create new object as a child of this object. <br>
This parameter is mandatory. If you are adding an address
<br>
to an interface, corresponding interface onkect must be <br>
specified as the parent. Similarly if you need to add an
<br>
interface to a host or a firewall, corresponding host or
<br>
firewall object is the parent. If you are adding an <br>
object to one of the standard folders, the parent is the
<br>
library you want to add the object to or correct full <br>
path to the folder in the tree. <br>
-n name the name of the new object <br>
-c txt specify comment for the new object <br>
-a attribute1[,attribute2...] : specify attributes that <br>
define parameters of the new object (see below)</p>

<p style="margin-top: 1em">delete -f file.fwb -o object</p>

<p style="margin-top: 1em">Deletes object specified by its
full path in the tree or object ID.</p>

<p style="margin-top: 1em">-f file.fwb data file <br>
-o object object to be deleted, full path or ID</p>

<p style="margin-top: 1em">modify -f file.fwb -o object -c
comment [-a attrs]</p>

<p style="margin-top: 1em">Modifies object specified by its
full path in the tree or object ID. Object can not be
renamed using this operation.</p>

<p style="margin-top: 1em">-f file.fwb data file <br>
-o object object to be deleted, full path or ID <br>
-c txt specify comment for the new object <br>
-a attribute1[,attribute2...] : specify attributes that <br>
define parameters of the new object (see below)</p>

<p style="margin-top: 1em">list -f file.fwb -o object
[-r|-c] [-d|-Fformat]</p>

<p style="margin-top: 1em">Prints name and ID of an
object.</p>

<p style="margin-top: 1em">-f file.fwb data file <br>
-o object object to print, full path or ID <br>
-r print specified object and all objects under it in the
tree <br>
-c print only children objects of the given object but do
not <br>
print the object itself. <br>
-d print full dump of all object&rsquo;s attributes
including internal <br>
debugging information if available, this can be very <br>
verbose. <br>
-Fformat_string Program recognizes macros in the format
string <br>
and replaces them with values of corresponding
object&rsquo;s <br>
attributes. Macro is the name of the attribute surrounded
<br>
with &rsquo;%&rsquo;, such as &rsquo;%name%&rsquo; or
&rsquo;%address%&rsquo;. Here is the <br>
list of some attribute names: &quot;id&quot;,
&quot;name&quot;, &quot;path&quot;, <br>
&quot;comment&quot;, &quot;type&quot;, &quot;address&quot;,
&quot;netmask&quot;, &quot;dnsname&quot;. TCP <br>
and UDP service objects provide attributes <br>
&quot;src_range_start&quot;, &quot;src_range_end&quot;,
&quot;dst_range_start&quot;, <br>
&quot;dst_range_end&quot; for the source and destination
port <br>
ranges. ICMP and ICMP6 service objects have attributes <br>
&quot;icmp_type&quot; and &quot;icmp_code&quot;.</p>

<p style="margin-top: 1em">add -f file.fwb -g group -o
object</p>

<p style="margin-top: 1em">Adds object specified by path or
ID to a group, also specified by its path or ID.</p>

<p style="margin-top: 1em">-f file.fwb data file <br>
-g group group the object should be added to, <br>
full path or ID <br>
-o object object to be deleted, full path or ID</p>

<p style="margin-top: 1em">remove -f file.fwb -g group -o
object</p>

<p style="margin-top: 1em">Removes object from a group.</p>

<p style="margin-top: 1em">-f file.fwb data file <br>
-g group group the object should be removed from, <br>
full path or ID <br>
-o object object to be deleted, full path or ID</p>

<p style="margin-top: 1em">upgrade -f file.fwb</p>

<p style="margin-top: 1em">Upgrades data file to the latest
data format version.</p>

<p style="margin-top: 1em">-f file.fwb data file</p>

<p style="margin-top: 1em">checktree -f file.fwb</p>

<p style="margin-top: 1em">Checks consistency and
correctness of the object tree in the given data file and
repairs it if necessary.</p>

<p style="margin-top: 1em">-f file.fwb data file</p>

<p style="margin-top: 1em">merge -f file1.fwb -i
file2.fwb</p>

<p style="margin-top: 1em">Objects from the file2.fwb are
merged with objects in file1 and combined object tree saved
in file1.fwb</p>

<p style="margin-top: 1em">-f file.fwb data file #1 <br>
-i file.fwb data file #2</p>

<p style="margin-top: 1em">import -f file1.fwb -i
firewall_config.txt -o path_to_firewall_object [-d]</p>

<p style="margin-top: 1em">Firewall configuration from file
firewall_config.txt is parsed and imported into data file
file1.fwb. The program creates new firewall object located
in the library and with the <br>
name defined by its path path_to_firewall_object.</p>

<p style="margin-top: 1em">-f file.fwb data file #1 <br>
-i config.txt firewall configuration file <br>
-o object_path full path to the firewall object that will be
<br>
created. This has to be full path, beginning <br>
with the library name, such as <br>
&quot;/User/Firewalls/my_new_firewall&quot; <br>
-d avoid creating duplicate objects on import</p>

<p style="margin-top: 1em">currently (as of v4.2.0)
fwbuilder supports import of iptables configuration saved
with iptables-save command, as well as import of Cisco
router IOS configuration, Cisco PIX, ASA <br>
and FWSM firewalls saved with &quot;show run&quot;
command.</p>

<p style="margin-top: 1em">ATTRIBUTES FOR THE NEW OBJECTS,
BY TYPE <br>
-t Firewall -a platform, host OS</p>

<p style="margin-top: 1em">-t IPv4 -a IP address
[,netmask]</p>

<p style="margin-top: 1em">-t IPv6 -a IPv6 address
[,masklen]</p>

<p style="margin-top: 1em">-t DNSName -a DNS record,run
time</p>

<p style="margin-top: 1em">-t AddressRange -a start
address, end address</p>

<p style="margin-top: 1em">-t ObjectGroup</p>

<p style="margin-top: 1em">-t Network -a
address,netmask</p>

<p style="margin-top: 1em">-t NetworkIPv6 -a
ipv6_address,netmask_length</p>

<p style="margin-top: 1em">-t Interval -a start time,start
date,start day,end time, end date, end day</p>

<p style="margin-top: 1em">-t Interface -a security
level,address type (dynamic or unnumbered),management</p>

<p style="margin-top: 1em">-t Host</p>

<p style="margin-top: 1em">-t TCPService -a source port
range start,end,destination port range
start,end,UAPRSF,UAPRSF</p>

<p style="margin-top: 1em">-t UDPService -a source port
range start,end,Destination port range start,end</p>

<p style="margin-top: 1em">-t ICMPService -a ICMP type,ICMP
code</p>

<p style="margin-top: 1em">-t IPService -a protocol
number,lsrr/ssrr/rr/ts/fragm/short_fragm</p>

<p style="margin-top: 1em">EXAMPLES <br>
Print contents of the object /User/Firewalls/firewall/eth0
according to the provided format. Note that object of the
type &quot;Interface&quot; does not have attribute that
would define <br>
its address, IP address is defined by its child object of
the type IPv4 or IPv6.</p>

<p style="margin-top: 1em">fwbedit list -f x.fwb -o
/User/Firewalls/firewall/eth0 -F &quot;type=%type%
name=%name% id=%id% %comment%&quot;</p>

<p style="margin-top: 1em">Print contents of the object
/User/Firewalls/firewall/eth0 and all its child objects.
This is the way to see addresses and netmasks. Interface
object does not have attribiute <br>
&quot;address&quot; so the program ignores macro
&quot;%address%&quot; when it prints interface.</p>

<p style="margin-top: 1em">fwbedit list -f x.fwb -o
/User/Firewalls/firewall/eth0 -F &quot;type=%type%
name=%name% id=%id% %comment% %address%&quot; -r</p>

<p style="margin-top: 1em">Print group object
/User/Objects/Addresses</p>

<p style="margin-top: 1em">fwbedit list -f x.fwb -o
/User/Objects/Addresses -F &quot;type=%type% name=%name%
id=%id% %comment%&quot;</p>

<p style="margin-top: 1em">Print group object
/User/Objects/Addresses and all address objects inside of
it:</p>

<p style="margin-top: 1em">fwbedit list -f x.fwb -o
/User/Objects/Addresses -F &quot;type=%type% name=%name%
id=%id% %comment%&quot; -r</p>

<p style="margin-top: 1em">Print address objects inside
group /User/Objects/Addresses but do not print the group
object itself:</p>

<p style="margin-top: 1em">fwbedit list -f x.fwb -o
/User/Objects/Addresses -F &quot;type=%type% name=%name%
id=%id% %comment%&quot; -c</p>

<p style="margin-top: 1em">Print addresses and netmasks of
all interfaces of all firewalls in the form of their full
object tree path, followed by the type, id, address and
netmask:</p>

<p style="margin-top: 1em">fwbedit list -f x.fwb -o
/User/Firewalls -F &quot;%path% %type% %id% %address%
%netmask%&quot; -r | grep IP</p>

<p style="margin-top: 1em">Print names, platform and
version information for all firewall objects defined in the
data file:</p>

<p style="margin-top: 1em">fwbedit list -f x.fwb -o
/User/Firewalls -F &quot;%name% platform: %platform%
version: %version%&quot; -c</p>

<p style="margin-top: 1em">Print name, source and
destination port ranges for all TCP services in the folder
TCP of the user-defined group User:</p>

<p style="margin-top: 1em">fwbedit list -f x.fwb -o
/User/Services/TCP -c -F &quot;name=&rsquo;%name%&rsquo;
est=%established% %src_range_start%-%src_range_end% :
%dst_range_start%-%dst_range_end%&quot;</p>

<p style="margin-top: 1em">Print icmp type and code for all
ICMP services in the folder ICMP of the user-defined group
User:</p>

<p style="margin-top: 1em">fwbedit list -f x.fwb -o
/User/Services/ICMP -c -F &quot;name=&rsquo;%name%&rsquo;
icmp_type=%icmp_type% icmp_code=%icmp_code%&quot;</p>

<p style="margin-top: 1em">Add IPv6 address to one of the
interfaces of firewall object &quot;firewall&quot;:</p>

<p style="margin-top: 1em">fwbedit new -f x.fwb -p
/User/Firewalls/firewall/eth3 -t IPv6 -n eth3-v6-addr -a
2001:470:1f05:590::2,64</p>

<p style="margin-top: 1em">Add reference to the Host object
&rsquo;A&rsquo; to the group &rsquo;B&rsquo;:</p>

<p style="margin-top: 1em">fwbedit add -f x.fwb -g
/User/Objects/Groups/B -o /User/Objects/Hosts/A</p>

<p style="margin-top: 1em">Add reference to the object with
ID id3D71A1BA to the group with ID id3D151943. If objects
with given IDs do not exist, fwbedit prints an error message
and does not make any <br>
changes in the data file.</p>

<p style="margin-top: 1em">fwbedit add -f x.fwb -o
id3D71A1BA -g id3D151943</p>

<p style="margin-top: 1em">Add reference to the object with
ID id3D71A1BA to the group &rsquo;testgroup&rsquo;:</p>

<p style="margin-top: 1em">fwbedit add -f x.fwb -o
id3D71A1BA -g /User/Objects/Groups/testgroup</p>

<p style="margin-top: 1em">The following script uses
fwbedit &quot;list&quot; command to print IDs of all Address
objects in the folder /User/Objects/Addresses , then cycles
through the obtained list and uses fwbe&acirc; <br>
dit to add them to the group &quot;group1&quot;.</p>

<p style="margin-top: 1em">fwbedit list -f x.fwb -o
/User/Objects/Addresses -F &quot;%id%&quot; -c | while read
id; do fwbedit add -f x.fwb -g /User/Objects/Groups/group1
-o $id; done</p>

<p style="margin-top: 1em">Here is slightly more complex
example. The following script uses fwbedit &quot;list&quot;
command to print types and IDs of all Address objects in the
folder /User/Objects/Addresses , then <br>
filters them using grep to get only IPv6 objects and finally
cycles through the obtained list and uses fwbedit to add
them to the group &quot;group1&quot;.</p>

<p style="margin-top: 1em">fwbedit list -f x.fwb -o
/User/Objects/Addresses -F &quot;%type% %id%&quot; -c | grep
IPv6 | while read type id; do fwbedit add -f x.fwb -g
/User/Objects/Groups/group1 -o $id; done</p>

<p style="margin-top: 1em">URL <br>
Firewall Builder home page is located at the following URL:
http://www.fwbuilder.org/</p>

<p style="margin-top: 1em">BUGS <br>
Please report bugs using bug tracking system on
SourceForge:</p>


<p style="margin-top: 1em">http://sourceforge.net/tracker/?group_id=5314&amp;atid=105314</p>

<p style="margin-top: 1em">SEE ALSO <br>
fwbuilder(1),</p>

<p style="margin-top: 1em">FWB fwbedit(1)</p>
<hr>
</body>
</html>
