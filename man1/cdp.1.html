<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>CDP(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">CDP(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">CDP(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
cdp - cdp packet generator
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>cdp</b> -i &lt;interface&gt; [-v -n x -l x -c c -r] [-D &lt;string&gt; -P
  &lt;string&gt; -L &lt;string&gt; -S &lt;string&gt; -F &lt;ip address&gt; -C
  &lt;capabilities&gt;]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This manual page documents briefly the <b>cdp</b> command. This manual page was
  written for the Debian distribution because the original program does not have
  a manual page.
<div class="Pp"></div>
CDP is a layer 2 protocol used by Cisco routers to discover each other on the
  same link (segment). This protocol is not routed and therefore this tool is
  just useful in the local segment.
<div class="Pp"></div>
CDP messages contain information about the sending Cisco router. These include
  the device ID (hostname), port ID (which port was the sender), the platform
  running on, the software incl. version, what the box is capable of and which
  network address (IP address) the interface has. If not configured otherwise,
  Cisco routers send these messages out every 30 seconds. In our case
  (ethernet), they are send to a special MAC address (01:00:0C:CC:CC:CC) and
  therefore are received from every Cisco router in the same segment. Other
  routers store the data and hold it for a time defined in the message (the tool
  uses the maximum of 255 seconds).
<div class="Pp"></div>
Very interesting is, that Cisco IOS uses the device ID as key to find out if the
  received message is an update and the neighbor is already known or not. If the
  device ID is to long, this test seems to fail and you constantly fill up the
  routers memory.
<div class="Pp"></div>
The CDP tool can be used in two different modi:
<div class="Pp"></div>
The flood mode is used to send garbage CDP messages to the wire, which has
  different effects to the routers depending on their IOS version. It is not
  tested very well, which version of IOS reacts in which way on which kind of
  Cisco hardware. So if you come across something, please report it. IOS 11.1(1)
  was tested and the router could match even long device id&#x00B4;s but
  rebooted after receiving three or four random device id names. Most other IOS
  versions just store the message and fill up the memory. When you try to debug
  CDP events, all IOS we tested crashed and reboot.
<div class="Pp"></div>
To use CDP, you have to specify the ethernet interface you will be working on:
  -i eth0
<div class="Pp"></div>
Everything else is optional.
<div class="Pp"></div>
-v verbose
<div class="Pp"></div>
-n x send x packets
<div class="Pp"></div>
-l x length of the device id string. Keep in mind, that the
<br/>
 whole ethernet frame has to be smaller the 1514 bytes.
<br/>
 The maximum length is therefore 1480 for the device id
<br/>
 (default is 1400)
<div class="Pp"></div>
-c c fills the device id with the char 'c' (default is 'A')
<div class="Pp"></div>
-r makes the device id a random string of characters, which
<br/>
 leads to no matching on the receiver Cisco and to memory fillup
<br/>
 or crash
<div class="Pp"></div>
Example:
<div class="Pp"></div>
 cdp -i eth0 -n 10000 -l 1480 -r
<div class="Pp"></div>
Hint: if you want to flood the routers completely, start two processes of cdp
  with different sizes. One of them running on full size (1480) to fill up the
  major part of the memory and another to fill up the rest with a length of 10
  octets.
<div class="Pp"></div>
The second mode for CDP is spoofing. You can enable this mode with the command
  line option -m 1. It has no actuall use for attacking router and is mostly
  targeted fro social engineering or just to confuse the local administrator. It
  is used to send out 100% valid CDP information packets which look like
  generated by other Cisco routers. Here, you can specify any part of a CDP
  message yourself.
<div class="Pp"></div>
-i &lt;interface&gt; ethernet interface
<div class="Pp"></div>
-v verbose
<div class="Pp"></div>
-D &lt;string&gt; device id string
<div class="Pp"></div>
-P &lt;string&gt; port id string
<div class="Pp"></div>
-L &lt;string&gt; platform string
<div class="Pp"></div>
-S &lt;string&gt; software string
<div class="Pp"></div>
-F &lt;ip address&gt; ip address of the interface
<div class="Pp"></div>
-C &lt;capabilities&gt; the capabilities of the device you are claiming to be:
<br/>
 R - Router, T - Trans Bridge, B - Source Route Bridge,
<br/>
 S - Switch, H - Host, I - IGMP, r - Repeater
<br/>
 Combine the letters to a string: RI means Router and IGMP
<div class="Pp"></div>
Example:
<div class="Pp"></div>
 cdp -v -i eth0 -m 1 -D 'Linuxfirewall' -P 'Ethernet0' -C R -L 'Intel' -S
  &quot;`uname -a`&quot; \
<br/>
 -F '10.1.1.1'
<div class="Pp"></div>
Which results on the cisco router in the following information:
<div class="Pp"></div>
cisco#sh cdp neig detail
<div class="Pp"></div>
-------------------------
<div class="Pp"></div>
Device ID: Linuxfirewall
<div class="Pp"></div>
Entry address(es):
<div class="Pp"></div>
IP address: 10.1.1.1
<div class="Pp"></div>
Platform: Intel, Capabilities: Router
<div class="Pp"></div>
Interface: Ethernet0, Port ID (outgoing port): Ethernet0
<div class="Pp"></div>
Holdtime : 238 sec
<div class="Pp"></div>
Version :
<div class="Pp"></div>
Linux vince 2.4.18-686 #1 Sun Apr 14 11:32:47 EST 2002 i686 unknown unknown
  GNU/Linux
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
This manual page was written by Vince Mulhollon &lt;vlm@debian.org&gt;, for the
  Debian GNU/Linux system (but may be used by others).</div>
<table class="foot">
  <tr>
    <td class="foot-date">January 1, 2003</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
