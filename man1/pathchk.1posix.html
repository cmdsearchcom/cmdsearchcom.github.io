<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:30:01 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>PATHCHK(1POSIX) POSIX Programmer&rsquo;s Manual
PATHCHK(1POSIX)</p>

<p style="margin-top: 1em">PROLOG <br>
This manual page is part of the POSIX Programmer&rsquo;s
Manual. The Linux implementation of this interface may
differ (consult the corresponding Linux manual page for
details of <br>
Linux behavior), or the interface may not be implemented on
Linux.</p>

<p style="margin-top: 1em">NAME <br>
pathchk &acirc; check pathnames</p>

<p style="margin-top: 1em">SYNOPSIS <br>
pathchk [&acirc;p] [&acirc;P] pathname...</p>

<p style="margin-top: 1em">DESCRIPTION <br>
The pathchk utility shall check that one or more pathnames
are valid (that is, they could be used to access or create a
file without causing syntax errors) and portable (that is,
<br>
no filename truncation results). More extensive portability
checks are provided by the &acirc;p and &acirc;P
options.</p>

<p style="margin-top: 1em">By default, the pathchk utility
shall check each component of each pathname operand based on
the underlying file system. A diagnostic shall be written
for each pathname operand <br>
that:</p>

<p style="margin-top: 1em">* Is longer than {PATH_MAX}
bytes (see Pathname Variable Values in the Base Definitions
volume of POSIX.1&acirc;2008, &lt;limits.h&gt;)</p>

<p style="margin-top: 1em">* Contains any component longer
than {NAME_MAX} bytes in its containing directory</p>

<p style="margin-top: 1em">* Contains any component in a
directory that is not searchable</p>

<p style="margin-top: 1em">* Contains any byte sequence
that is not valid in its containing directory</p>

<p style="margin-top: 1em">The format of the diagnostic
message is not specified, but shall indicate the error
detected and the corresponding pathname operand.</p>

<p style="margin-top: 1em">It shall not be considered an
error if one or more components of a pathname operand do not
exist as long as a file matching the pathname specified by
the missing components could <br>
be created that does not violate any of the checks specified
above.</p>

<p style="margin-top: 1em">OPTIONS <br>
The pathchk utility shall conform to the Base Definitions
volume of POSIX.1&acirc;2008, Section 12.2, Utility Syntax
Guidelines.</p>

<p style="margin-top: 1em">The following option shall be
supported:</p>

<p style="margin-top: 1em">&acirc;p Instead of performing
checks based on the underlying file system, write a
diagnostic for each pathname operand that:</p>

<p style="margin-top: 1em">* Is longer than
{_POSIX_PATH_MAX} bytes (see Minimum Values in the Base
Definitions volume of POSIX.1&acirc;2008,
&lt;limits.h&gt;)</p>

<p style="margin-top: 1em">* Contains any component longer
than {_POSIX_NAME_MAX} bytes</p>

<p style="margin-top: 1em">* Contains any character in any
component that is not in the portable filename character
set</p>

<p style="margin-top: 1em">&acirc;P Write a diagnostic for
each pathname operand that:</p>

<p style="margin-top: 1em">* Contains a component whose
first character is the &lt;hyphen&gt; character</p>

<p style="margin-top: 1em">* Is empty</p>

<p style="margin-top: 1em">OPERANDS <br>
The following operand shall be supported:</p>

<p style="margin-top: 1em">pathname A pathname to be
checked.</p>

<p style="margin-top: 1em">STDIN <br>
Not used.</p>

<p style="margin-top: 1em">INPUT FILES <br>
None.</p>

<p style="margin-top: 1em">ENVIRONMENT VARIABLES <br>
The following environment variables shall affect the
execution of pathchk:</p>

<p style="margin-top: 1em">LANG Provide a default value for
the internationalization variables that are unset or null.
(See the Base Definitions volume of POSIX.1&acirc;2008,
Section 8.2, Internationaliza&acirc; <br>
tion Variables the precedence of internationalization
variables used to determine the values of locale
categories.)</p>

<p style="margin-top: 1em">LC_ALL If set to a non-empty
string value, override the values of all the other
internationalization variables.</p>

<p style="margin-top: 1em">LC_CTYPE Determine the locale
for the interpretation of sequences of bytes of text data as
characters (for example, single-byte as opposed to
multi-byte characters in argu&acirc; <br>
ments).</p>

<p style="margin-top: 1em">LC_MESSAGES <br>
Determine the locale that should be used to affect the
format and contents of diagnostic messages written to
standard error.</p>

<p style="margin-top: 1em">NLSPATH Determine the location
of message catalogs for the processing of LC_MESSAGES.</p>

<p style="margin-top: 1em">ASYNCHRONOUS EVENTS <br>
Default.</p>

<p style="margin-top: 1em">STDOUT <br>
Not used.</p>

<p style="margin-top: 1em">STDERR <br>
The standard error shall be used only for diagnostic
messages.</p>

<p style="margin-top: 1em">OUTPUT FILES <br>
None.</p>

<p style="margin-top: 1em">EXTENDED DESCRIPTION <br>
None.</p>

<p style="margin-top: 1em">EXIT STATUS <br>
The following exit values shall be returned:</p>

<p style="margin-top: 1em">0 All pathname operands passed
all of the checks.</p>

<p style="margin-top: 1em">&gt;0 An error occurred.</p>

<p style="margin-top: 1em">CONSEQUENCES OF ERRORS <br>
Default.</p>

<p style="margin-top: 1em">The following sections are
informative.</p>

<p style="margin-top: 1em">APPLICATION USAGE <br>
The test utility can be used to determine whether a given
pathname names an existing file; it does not, however, give
any indication of whether or not any component of the
path&acirc; <br>
name was truncated in a directory where the _POSIX_NO_TRUNC
feature is not in effect. The pathchk utility does not check
for file existence; it performs checks to determine <br>
whether a pathname does exist or could be created with no
pathname component truncation.</p>

<p style="margin-top: 1em">The noclobber option in the
shell (see the set special built-in) can be used to
atomically create a file. As with all file creation
semantics in the System Interfaces volume of <br>
POSIX.1&acirc;2008, it guarantees atomic creation, but still
depends on applications to agree on conventions and
cooperate on the use of files after they have been
created.</p>

<p style="margin-top: 1em">To verify that a pathname meets
the requirements of filename portability, applications
should use both the &acirc;p and &acirc;P options
together.</p>

<p style="margin-top: 1em">EXAMPLES <br>
To verify that all pathnames in an imported data interchange
archive are legitimate and unambiguous on the current
system:</p>

<p style="margin-top: 1em"># This example assumes that no
pathnames in the archive <br>
# contain &lt;newline&gt; characters. <br>
pax &acirc;f archive | sed &acirc;e
&rsquo;s/[^[:alnum:]]/\&amp;/g&rsquo; | xargs pathchk
&acirc;&acirc; <br>
if [ $? &acirc;eq 0 ] <br>
then <br>
pax &acirc;r &acirc;f archive <br>
else <br>
echo Investigate problems before importing files. <br>
exit 1 <br>
fi</p>

<p style="margin-top: 1em">To verify that all files in the
current directory hierarchy could be moved to any system
conforming to the System Interfaces volume of
POSIX.1&acirc;2008 that also supports the pax <br>
utility:</p>

<p style="margin-top: 1em">find . &acirc;exec pathchk
&acirc;p &acirc;P {} + <br>
if [ $? &acirc;eq 0 ] <br>
then <br>
pax &acirc;w &acirc;f ../archive . <br>
else <br>
echo Portable archive cannot be created. <br>
exit 1 <br>
fi</p>

<p style="margin-top: 1em">To verify that a user-supplied
pathname names a readable file and that the application can
create a file extending the given path without truncation
and without overwriting any <br>
existing file:</p>

<p style="margin-top: 1em">case $&acirc; in <br>
*C*) reset=&quot;&quot;;; <br>
*) reset=&quot;set +C&quot; <br>
set &acirc;C;; <br>
esac <br>
test &acirc;r &quot;$path&quot; &amp;&amp; pathchk
&quot;$path.out&quot; &amp;&amp; <br>
rm &quot;$path.out&quot; &gt; &quot;$path.out&quot; <br>
if [ $? &acirc;ne 0 ]; then <br>
printf &quot;%s: %s not found or %s.out fails creation
checks.0 $0 &quot;$path$path&quot; <br>
$reset # Reset the noclobber option in case a trap <br>
# on EXIT depends on it. <br>
exit 1 <br>
fi <br>
$reset <br>
PROCESSING &lt; &quot;$path&quot; &gt;
&quot;$path.out&quot;</p>

<p style="margin-top: 1em">The following assumptions are
made in this example:</p>

<p style="margin-top: 1em">1. PROCESSING represents the
code that is used by the application to use $path once it is
verified that $path.out works as intended.</p>

<p style="margin-top: 1em">2. The state of the noclobber
option is unknown when this code is invoked and should be
set on exit to the state it was in when this code was
invoked. (The reset variable is <br>
used in this example to restore the initial state.)</p>

<p style="margin-top: 1em">3. Note the usage of:</p>

<p style="margin-top: 1em">rm &quot;$path.out&quot; &gt;
&quot;$path.out&quot;</p>

<p style="margin-top: 1em">a. The pathchk command has
already verified, at this point, that $path.out is not
truncated.</p>

<p style="margin-top: 1em">b. With the noclobber option
set, the shell verifies that $path.out does not already
exist before invoking rm.</p>

<p style="margin-top: 1em">c. If the shell succeeded in
creating $path.out, rm removes it so that the application
can create the file again in the PROCESSING step.</p>

<p style="margin-top: 1em">d. If the PROCESSING step wants
the file to exist already when it is invoked, the:</p>

<p style="margin-top: 1em">rm &quot;$path.out&quot; &gt;
&quot;$path.out&quot;</p>

<p style="margin-top: 1em">should be replaced with:</p>

<p style="margin-top: 1em">&gt; &quot;$path.out&quot;</p>

<p style="margin-top: 1em">which verifies that the file did
not already exist, but leaves $path.out in place for use by
PROCESSING.</p>

<p style="margin-top: 1em">RATIONALE <br>
The pathchk utility was new for the ISO POSIX&acirc;2:1993
standard. It, along with the set &acirc;C(noclobber) option
added to the shell, replaces the mktemp, validfnam, and
create utili&acirc; <br>
ties that appeared in early proposals. All of these
utilities were attempts to solve several common
problems:</p>

<p style="margin-top: 1em">* Verify the validity (for
several different definitions of
&lsquo;&lsquo;valid&rsquo;&rsquo;) of a pathname supplied by
a user, generated by an application, or imported from an
external source.</p>

<p style="margin-top: 1em">* Atomically create a file.</p>

<p style="margin-top: 1em">* Perform various string
handling functions to generate a temporary filename.</p>

<p style="margin-top: 1em">The create utility, included in
an early proposal, provided checking and atomic creation in
a single invocation of the utility; these are orthogonal
issues and need not be <br>
grouped into a single utility. Note that the noclobber
option also provides a way of creating a lock for process
synchronization; since it provides an atomic create, there
is no <br>
race between a test for existence and the following creation
if it did not exist.</p>

<p style="margin-top: 1em">Having a function like tmpnam()
in the ISO C standard is important in many high-level
languages. The shell programming language, however, has
built-in string manipulation facili&acirc; <br>
ties, making it very easy to construct temporary filenames.
The names needed obviously depend on the application, but
are frequently of a form similar to:</p>


<p style="margin-top: 1em">$TMPDIR/application_abbreviation$$.suffix</p>

<p style="margin-top: 1em">In cases where there is likely
to be contention for a given suffix, a simple shell for or
while loop can be used with the shell noclobber option to
create a file without risk of <br>
collisions, as long as applications trying to use the same
filename name space are cooperating on the use of files
after they have been created.</p>

<p style="margin-top: 1em">For historical purposes,
&acirc;p does not check for the use of the &lt;hyphen&gt;
character as the first character in a component of the
pathname, or for an empty pathname operand.</p>

<p style="margin-top: 1em">FUTURE DIRECTIONS <br>
None.</p>

<p style="margin-top: 1em">SEE ALSO <br>
Section 2.7, Redirection, set, test</p>

<p style="margin-top: 1em">The Base Definitions volume of
POSIX.1&acirc;2008, Chapter 8, Environment Variables,
Section 12.2, Utility Syntax Guidelines,
&lt;limits.h&gt;</p>

<p style="margin-top: 1em">COPYRIGHT <br>
Portions of this text are reprinted and reproduced in
electronic form from IEEE Std 1003.1, 2013 Edition, Standard
for Information Technology -- Portable Operating System
Inter&acirc; <br>
face (POSIX), The Open Group Base Specifications Issue 7,
Copyright (C) 2013 by the Institute of Electrical and
Electronics Engineers, Inc and The Open Group. (This is <br>
POSIX.1-2008 with the 2013 Technical Corrigendum 1 applied.)
In the event of any discrepancy between this version and the
original IEEE and The Open Group Standard, the original <br>
IEEE and The Open Group Standard is the referee document.
The original Standard can be obtained online at
http://www.unix.org/online.html .</p>

<p style="margin-top: 1em">Any typographical or formatting
errors that appear in this page are most likely to have been
introduced during the conversion of the source files to man
page format. To report <br>
such errors, see
https://www.kernel.org/doc/man-pages/reporting_bugs.html
.</p>

<p style="margin-top: 1em">IEEE/The Open Group 2013
PATHCHK(1POSIX)</p>
<hr>
</body>
</html>
