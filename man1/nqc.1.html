<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>nqc(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">nqc(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">nqc(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
nqc - A simple C-like language for Lego's RCX programmable brick
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>nqc</b> [ <i>options</i> ] [ <i>actions</i> ] [ <b>-</b> | <i>filename</i> ]
  [ <i>actions</i> ]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
NQC stands for Not Quite C, and is a simple language for programming the LEGO
  RCX. The preprocessor and control structures of NQC are very similar to C. NQC
  is not a general purpose language -- there are many restrictions that stem
  from limitations of the standard RCX firmware.
<div class="Pp"></div>
This man page does not attempt to describe the NQC programming language or the
  RCX API, merely the options of the nqc command-line program. References to
  more complete documentation are given at the end of this man page.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
nqc is normally used to process a single source file given as <i>filename</i>.
  You can also read from stdin by using <b>-</b> instead. If the filename ends
  in <i>.rcx</i>, it is assumed to be a RCX image file from a previous compile,
  and will be used as is (for downloading or listing).
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-1</b></dt>
  <dd class="It-tag">use NQC 1.x compatibility mode. The RCX API changed
      significantly with version 2.0. This flag makes the compiler grok old
      code.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-T</b><i>target</i><b></b></dt>
  <dd class="It-tag">generate code and use communications methods for
      &quot;smart bricks&quot; other than the RCX. Currently, can be either
      <b>CM</b> or <b>Scout</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d</b></dt>
  <dd class="It-tag">download program to the RCX. When this option is given,
      code is sent directly over the serial port to the brick and no output file
      is generated by default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n</b></dt>
  <dd class="It-tag">prevent the standard <i>nqc.h</i> file from being
      automatically included.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-D</b><i>sym</i>[=<i>value</i>]</dt>
  <dd class="It-tag">define macro <i>sym</i> as <i>value</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-E</b>[<i>filename</i>]</dt>
  <dd class="It-tag">write compiler errors to <i>filename</i> (or to stdout, if
      no name specified) instead of to stderr.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-I</b><i>path</i></dt>
  <dd class="It-tag">search <i>path</i> for include files. Multiple directories
      should be seperated as normal for the platform (under Linux / Unix, that'd
      be &quot; <b></b>&quot;). Can also be set with the NQC_INCLUDE environment
      variable.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-L</b>[<i>filename</i>]</dt>
  <dd class="It-tag">generate a human-readable bytecode listing to
      <i>filename</i> (or to stdout) instead of generating a binary file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-O</b><i>outfile</i></dt>
  <dd class="It-tag">output code to <i>outfile</i>. This option causes a file to
      be written even if <b>-d</b> or <b>-L</b> is also given. If no filename is
      specified, the output file will have the same basename as the input file
      but an extension of <i>.rcx</i> instead of <i>.nqc</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-S</b><i>portname</i></dt>
  <dd class="It-tag">use serial port <i>portname</i>. Under Linux,
      <i>/dev/ttyS0</i> is the default. (This will differ on other platforms.)
      The port can also be specified via the RCX_PORT environment variable, but
      the command line option takes precedence.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-U</b><i>sym</i></dt>
  <dd class="It-tag">undefine macro <i>sym</i>.</dd>
</dl>
<h1 class="Sh" title="Sh" id="ACTIONS"><a class="selflink" href="#ACTIONS">ACTIONS</a></h1>
Actions look similar to options, but they have some subtle differences. In
  general, options set up things (such as a serial port) for later use, while
  actions cause something to happen. Actions are executed in the order that they
  appear on the command line. In addition, actions appearing before the source
  file happen before compilation, while actions after the source file happen
  after compilation. For historical reasons, downloading the compiled file (
  <b>-d</b>) works as an option and not an action.
<dl class="Bl-tag">
  <dt class="It-tag"><b>-run</b></dt>
  <dd class="It-tag">run the current program. This causes the program selected
      on the RCX to execute.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-pgm</b> <i>number</i></dt>
  <dd class="It-tag">select program number. This changes the program slot on the
      RCX.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-datalog</b></dt>
  <dd class="It-tag">get the datalog from the RCX and print it to stdout.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-datalog-full</b></dt>
  <dd class="It-tag">same as <b>-datalog</b> but with more verbose output.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-near</b></dt>
  <dd class="It-tag">set the IR port to short-range mode.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-far</b></dt>
  <dd class="It-tag">set the IR port to long-range mode.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-watch</b> <i>time</i></dt>
  <dd class="It-tag">set the RCX's clock to the specified time. If you use
      <b>now</b>, then the host's current time is used.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-firmware</b> <i>filename</i></dt>
  <dd class="It-tag">downloads the firmware to the RCX. You'll need the official
      Lego RCX firmware from the CD-ROM -- the current (and so far only) file is
      called <i>firm0309.lgo</i>. This will probably be necessary the first time
      you use your RCX, and whenever it's been without batteries for more than a
      few minutes.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-firmfast</b> <i>filename</i></dt>
  <dd class="It-tag">same as <b>-firmware</b>, but at quad speed. Requires the
      tower to be in near mode (see <b>-near</b>). If you have trouble getting
      the fast download to work, please revert to the older (and slower)
    method.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-sleep</b> <i>timeout</i></dt>
  <dd class="It-tag">set RCX auto-shutoff timeout, in minutes.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-msg</b> <i>number</i></dt>
  <dd class="It-tag">send IR message to RCX. The brick will respond to this just
      as it would a communication from another RCX.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-raw</b> <i>data</i></dt>
  <dd class="It-tag">send an arbitrary packet to the RCX and print the reply (if
      any) to stdout. The data should be a hexadecimal string, with no spaces,
      zero-padded so that it is an even number of characters (although it may be
      an odd number of bytes). For example, to read the contents of variable 1,
      you could use <b>-raw 120001</b>. The bytecodes for raw messages can be
      found on web sites that document the RCX protocol.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-remote</b> <i>value</i> <i>repeat</i></dt>
  <dd class="It-tag">send a repeating remote command to the RCX.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-clear</b></dt>
  <dd class="It-tag">erase all programs and datalog from the RCX.</dd>
</dl>
<h1 class="Sh" title="Sh" id="ENVIRONMENT_VARIABLES"><a class="selflink" href="#ENVIRONMENT_VARIABLES">ENVIRONMENT
  VARIABLES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag">RCX_PORT</dt>
  <dd class="It-tag">sets the default serial port. See the <b>-S</b>
    option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">NQC_OPTIONS</dt>
  <dd class="It-tag">specifies extra options to be inserted into the command
      line. For example, setting NQC_OPTIONS to <b>-TScout</b> would cause nqc
      to target the Scout by default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">NQC_INCLUDE</dt>
  <dd class="It-tag">specifies additional paths to search for include files. See
      also the <b>-I</b> option.</dd>
</dl>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
To compile <i>foo.nqc</i>, download the bytecode to program slot three, and make
  the RCX start executing it immediately:
<div class="Pp"></div>
<br/>
<pre>
nqc -d -pgm 3 foo.nqc -run
<br/>
</pre>
<div class="Pp"></div>
To just compile <i>bar.nqc</i>, resulting in <i>bar.rcx</i>:
<div class="Pp"></div>
<br/>
<pre>
nqc bar.nqc
<br/>
</pre>
<div class="Pp"></div>
To download <i>bar.rcx</i> to the RCX:
<div class="Pp"></div>
<br/>
<pre>
nqc -d bar.rcx
<br/>
</pre>
<div class="Pp"></div>
To set the IR tower to short-range mode and download the firmware at high speed:
<div class="Pp"></div>
<br/>
<pre>
nqc -near -firmfast firm0309.lgo
<br/>
</pre>
<div class="Pp"></div>
To compile <i>/usr/doc/nqc-2.1.0/test.nqc</i> and print the resulting bytecode
  listing to the screen in human-readable format:
<div class="Pp"></div>
<br/>
<pre>
nqc -L /usr/doc/nqc-2.1.0/test.nqc
<br/>
</pre>
<div class="Pp"></div>
(This should result in the following output under nqc 2.1.0:
<div class="Pp"></div>
<br/>
<pre>
*** Task 0 = main
<br/>
</pre>
<br/>
<pre>
000 pwr        ABC, 7                13 07 02 07
<br/>
</pre>
<br/>
<pre>
004 dir        ABC, Fwd              e1 87
<br/>
</pre>
<br/>
<pre>
006 InType     0, Switch             32 00 01
<br/>
</pre>
<br/>
<pre>
009 InMode     0, Boolean            42 00 20
<br/>
</pre>
<br/>
<pre>
012 out        A, On                 21 81
<br/>
</pre>
<br/>
<pre>
014 chkl       1 != Input(0), 14     95 82 09 01 00 00 fa ff
<br/>
</pre>
<br/>
<pre>
022 plays      0                     51 00
<br/>
</pre>
<br/>
<pre>
024 out        A, Off                21 41
<br/>
</pre>
<div class="Pp"></div>
)
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
Older versions of nqc required a seperate <i>rcx.nqh</i> or <i>rcx2.nqh</i>
  file. This is now integrated into the binary and no longer necessary, but for
  reference, <i>rcx2.nqh</i> is included with the package. (If you installed the
  RPM, try <i>/usr/doc/nqc-2.1.0/rcx2.nqh</i>).
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><i>http://www.enteract.com/~dbaum/nqc/</i></dt>
  <dd class="It-tag">The main Not Quite C web site. You'll definitely want to
      look here. Notably, you'll find the <i>NQC Programmer's Guide</i>, which
      covers the NQC language itself.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>http://www.crynwr.com/lego-robotics/</i></dt>
  <dd class="It-tag">A great site for alternative RCX / Mindstorms
    development.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>http://graphics.stanford.edu/~kekoa/rcx/</i></dt>
  <dd class="It-tag">Details on the internals of the RCX and the RCX
    protocol.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>http://www.lugnet.com/robotics/rcx/nqc/</i></dt>
  <dd class="It-tag">Discussion group for NQC. Also available via NNTP at
      <i>lugnet.com</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>http://nqc.mattdm.org/</i></dt>
  <dd class="It-tag">Linux binaries and RPM-format packages for NQC, including
      source RPMs. Also has an RPM containing the NQC language documentation
      from Dave's site, in case you'd prefer to have it installed locally.</dd>
</dl>
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
None known. But be aware that Scout support is still preliminary and may change
  significantly.
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
nqc is Copyright (C) 1998-2000 David Baum and released under the terms of the
  Mozilla Public License. See the documentation included with the program for
  more details.
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
The Not Quite C programming language and the nqc program were written and are
  maintained by Dave Baum. Various contributions have been made by other people
  -- a full list of these can be found on Dave's web site.
<div class="Pp"></div>
This man page was written by Matthew Miller (mattdm@mattdm.org), with extremely
  large amounts of borrowing from other NQC documentation.</div>
<table class="foot">
  <tr>
    <td class="foot-date">Version 2.1 r1: 19 Feb 2000</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
