<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:29:38 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>OZ-INSTALL(1) General Commands Manual OZ-INSTALL(1)</p>

<p style="margin-top: 1em">NAME <br>
oz-install - tool to automatically install operating systems
into files</p>

<p style="margin-top: 1em">SYNOPSIS <br>
oz-install [OPTIONS] &lt;tdl-file&gt;</p>

<p style="margin-top: 1em">DESCRIPTION <br>
This is a tool to automatically install operating system
into files that represent disk images. The input is an XML
file representing the operating system and packages to be
<br>
installed. By default (and by design), the first stage of
the install only installs a JEOS (Just Enough Operating
System); customization, including the installation of
addi&acirc; <br>
tional packages can also be done, but requires additional
flags.</p>

<p style="margin-top: 1em">Note that oz-install does the
actual installation using a combination of KVM and libvirt,
so both of these must be available (and working) for
oz-install to have a chance to suc&acirc; <br>
ceed.</p>

<p style="margin-top: 1em">OPTIONS <br>
-a &lt;auto&gt; <br>
Use the user-provided auto installation file auto. By
default, Oz will use a hard-coded auto-installation file
(kickstart, preseed, sif, etc) to do a basic OS
installa&acirc; <br>
tion. Using this option, the user can provide an alternate
auto-installation file to do the install. The caveat is that
user-provided auto-installation files are more <br>
likely to cause installation errors, so this option should
be used with caution.</p>

<p style="margin-top: 1em">-b &lt;disk_bus&gt; <br>
Use disk_bus for the storage device while doing the install.
By default, Oz has built-in knowledge of the appropriate
disk bus to use while installing each guest operat&acirc;
<br>
ing system (ide or virtio). This option allows the user to
override that default with their own choice.</p>

<p style="margin-top: 1em">-c &lt;config&gt; <br>
Get the configuration from config file config, instead of
the default /etc/oz/oz.cfg. If neither one exists, Oz will
use sensible defaults. The config file is in stan&acirc;
<br>
dard ini format; for an explanation of the sections and
keys, see the CONFIGURATION FILE section.</p>

<p style="margin-top: 1em">-d &lt;loglevel&gt; <br>
Turn on debugging output to level loglevel. The log levels
are:</p>

<p style="margin-top: 1em">0 - errors only (this is the
default)</p>

<p style="margin-top: 1em">1 - errors and warnings</p>

<p style="margin-top: 1em">2 - errors, warnings, and
information</p>

<p style="margin-top: 1em">3 - all messages</p>

<p style="margin-top: 1em">4 - all messages, prepended with
the level and classname</p>

<p style="margin-top: 1em">-f Force the generation of new
installation media. By default, oz-install will always try
to use a locally cached version of the oz-modified install
media if it is avail&acirc; <br>
able. Failing that, oz-install will try to use a locally
cached version of the pristine install media if it is
available. You can use this flag to force it to always <br>
download and regenerate the oz-modified install media, even
if it has a local version available.</p>

<p style="margin-top: 1em">-g Generate the ICICLE (a
package manifest, with some additional metadata) after the
installation is complete.</p>

<p style="margin-top: 1em">-h Print a short help
message.</p>

<p style="margin-top: 1em">-i &lt;icicle&gt; <br>
If oz-install has been instructed to generate an ICICLE (see
the -g option), then it will normally write the ICICLE XML
to stdout. To have oz-install write the ICICLE to <br>
a file instead, use the -i option. Note that it is an error
to specify -i without -g.</p>

<p style="margin-top: 1em">-m &lt;mac_address&gt; <br>
Use mac_address for the network device while doing the
install. The default value is autogenerated by Oz. This
option allows the user to override this behaviour.</p>

<p style="margin-top: 1em">-n &lt;network_device&gt; <br>
Use network_device for the network device while doing the
install. By default, Oz has built-in knowledge of the
appropriate network device to use while installing each <br>
guest operating system (ne2k_pci, rtl8139, virtio). This
option allows the user to override that default with their
own choice.</p>

<p style="margin-top: 1em">-p Cleanup old guests before
installation. By default, if a guest with the same libvirt
UUID, libvirt name, or diskimage exists prior to Oz starting
installation, Oz will <br>
abort. If this option is used, then Oz will undefine the
libvirt guest with the same name or UUID and delete the
diskimage, so it should be used with caution.</p>

<p style="margin-top: 1em">-s &lt;disk&gt; <br>
Write the disk image to disk, rather than the default of the
TDL name.</p>

<p style="margin-top: 1em">-t &lt;timeout&gt; <br>
Terminate the installation of the guest in timeout seconds
rather than the oz default. This value should be increased
if running on slow storage or running multiple oz- <br>
install operations on the same machine.</p>

<p style="margin-top: 1em">Please note that there is a
separate termination action that occurs if 300 seconds
elapses with no disk activity to the operating system. This
timer value is not config&acirc; <br>
urable.</p>

<p style="margin-top: 1em">-u Customize the image after
installation. This generally installs additional packages
onto the disk image after installation.</p>

<p style="margin-top: 1em">-x &lt;xmlfile&gt; <br>
Oz will normally generate a libvirt XML file in the current
working directory suffixed with the date and time.
Specifying the -x option allows the filename to be
overrid&acirc; <br>
den.</p>

<p style="margin-top: 1em">CONFIGURATION FILE <br>
The Oz configuration file is in standard INI format with
several sections. If any section or configuration key is
missing, Oz will use a sensible default. For true/false
con&acirc; <br>
figuration keys, the values of &quot;true&quot;,
&quot;True&quot;, &quot;yes&quot;, or &quot;Yes&quot; can be
used to turn the option on, and &quot;false&quot;,
&quot;False&quot;, &quot;no&quot;, or &quot;No&quot; can be
used to turn the behavior off. The <br>
configuration file should have the following form:</p>

<p style="margin-top: 1em">[paths] <br>
output_dir = /var/lib/libvirt/images <br>
data_dir = /var/lib/oz <br>
screenshot_dir = . <br>
sshprivkey = /etc/oz/id_rsa-icicle-gen</p>

<p style="margin-top: 1em">[libvirt] <br>
uri = qemu:///system <br>
type = kvm <br>
bridge_name = virbr0 <br>
cpus = 1 <br>
memory = 1024 <br>
image_type = raw</p>

<p style="margin-top: 1em">[cache] <br>
original_media = yes <br>
modified_media = no <br>
jeos = no</p>

<p style="margin-top: 1em">[icicle] <br>
safe_generation = no</p>

<p style="margin-top: 1em">The paths section defines the
paths that Oz will use for storing data. The output_dir key
describes where to store the images after they are built,
and the data_dir key <br>
describes where to cache install media and use temporary
storage. Both locations must have a decent amount of free
disk space in order for Oz to work properly. The
screen&acirc; <br>
shot_dir key describes where to store screenshots of failed
installs. The sshprivkey key describes where the ssh keys
are stored, which are required by Oz to do customization of
<br>
the image.</p>

<p style="margin-top: 1em">The libvirt section allows some
manipulation of how Oz uses libvirt. The uri key describes
the libvirt URI to use to do the guest installation. The
type key defines what type <br>
of virtualization to use. The bridge_name key defines which
bridge Oz should place the guests that it launches on. The
cpus key defines how many cpus should be used inside the
<br>
virtual machine. The memory key defines how much memory (in
megabytes) should be used inside the virtual machine. The
image_type key defines which output disk type should be <br>
used; this can be any value that libvirt supports.</p>

<p style="margin-top: 1em">The cache section allows some
manipulation of how Oz caches data. The caching of data in
Oz is a tradeoff between installation time and storage
space. The original_media key <br>
tells Oz to cache the original installation media so that it
does not have to download it the next time an install for
the same operating system is requested. The modified_media
<br>
key tells Oz to cache the oz-modified installation media so
that it does not have to download and modify it the next
time an install for the same operating system is requested.
<br>
The jeos key tells Oz to cache the installed operating
system after installation. This can significantly speed up
subsequent installation of the same operating system, with
the <br>
additional downside of the operating system getting
out-of-date with respect to security updates. Use with
care.</p>

<p style="margin-top: 1em">The icicle section allows some
manipulation of how Oz generates ICICLE output. ICICLE is a
package manifest that can optionally be generated at the end
of installs. The <br>
safe_generation key controls whether Oz uses a throwaway
overlay file while generating the ICICLE. If it is set to
&quot;no&quot; (the default), then Oz will boot up the guest
at the end <br>
of the install and run the appropriate commands to generate
the ICICLE. If it is set to &quot;yes&quot;, then Oz will
use a throwaway overlay file while generating the ICICLE.
After the <br>
ICICLE is generated, Oz will delete the backing file,
leaving the original disk image pristine.</p>

<p style="margin-top: 1em">SEE ALSO <br>
oz-generate-icicle(1), oz-customize(1), oz-cleanup-cache(1),
oz-examples(1)</p>

<p style="margin-top: 1em">AUTHOR <br>
Chris Lalancette &lt;clalancette@gmail.com&gt;</p>

<p style="margin-top: 1em">oz-install Aug 2011
OZ-INSTALL(1)</p>
<hr>
</body>
</html>
