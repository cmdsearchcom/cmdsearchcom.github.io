<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:25:51 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>mock(1) mock(1)</p>

<p style="margin-top: 1em">NAME <br>
mock - build SRPMs in a chroot</p>

<p style="margin-top: 1em">SYNTAX <br>
mock [options] --rebuild SRPM [SRPM...]</p>

<p style="margin-top: 1em">mock [options] --buildsrpm
{--spec spec --sources src --symlink-dereference |
--scm-enable}</p>

<p style="margin-top: 1em">mock [options] --chroot
&lt;cmd&gt;</p>

<p style="margin-top: 1em">mock [options]
{--init|clean|shell}</p>

<p style="margin-top: 1em">mock [options] --installdeps
{SRPM|RPM}</p>

<p style="margin-top: 1em">mock [options] -i, --install
PACKAGE [PACKAGE...]</p>

<p style="margin-top: 1em">mock [options] --update
[PACKAGE...]</p>

<p style="margin-top: 1em">mock [options] --remove PACKAGE
[PACKAGE...]</p>

<p style="margin-top: 1em">mock [options] --orphanskill</p>

<p style="margin-top: 1em">mock [options] -p,
--print-root-path</p>

<p style="margin-top: 1em">mock [options] --copyin path
[path...] destination</p>

<p style="margin-top: 1em">mock [options] --copyout path
[path...] destination</p>

<p style="margin-top: 1em">mock [options] --scm-enable
[--scm-option key=value ...]</p>

<p style="margin-top: 1em">mock [options] -l,
--list-snapshots</p>

<p style="margin-top: 1em">mock [options] --snapshot
[snapshot-name]</p>

<p style="margin-top: 1em">mock [options] --rollback-to
[snapshot-name]</p>

<p style="margin-top: 1em">mock [options] --remove-snapshot
[snapshot-name]</p>

<p style="margin-top: 1em">mock [options] --umount</p>

<p style="margin-top: 1em">mock [options] --pm-cmd
[arguments ...]</p>

<p style="margin-top: 1em">mock [options] --yum-cmd
[arguments ...]</p>

<p style="margin-top: 1em">mock [options] --dnf-cmd
[arguments ...]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Mock is a simple program that will build source RPMs inside
a chroot. It doesn&rsquo;t do anything terribly fancy other
than populate a chroot with the contents specified by a
configu&acirc; <br>
ration file, then build any input SRPM(s) in that
chroot.</p>

<p style="margin-top: 1em">The content of a chroot is
specified by the configuration specified with the -r option.
The default configuration file is /etc/mock/default.cfg,
which is usually a symlink to one <br>
of the installed configurations.</p>

<p style="margin-top: 1em">There is a site-wide
configuration file, /etc/mock/site-defaults.cfg, which can
be used to specify site-wide options. The shipped version of
this file has no active options, but <br>
does have a list of all of the configuration options,
examples of how to set them, and their default values.</p>

<p style="margin-top: 1em">For backwards compatibility,
old-style commands, (&quot;rebuild&quot;, &quot;init&quot;,
&quot;clean&quot;, etc.) without leading &rsquo;--&rsquo;
are still accepted, but are deprecated. See COMMANDS
section, below, for <br>
detailed listing of all commands.</p>

<p style="margin-top: 1em">To use mock, a user should
become a member of the mock group by adding their username
to the mock line in /etc/group. This can be done with the
following command:</p>

<p style="margin-top: 1em">sudo /usr/sbin/usermod -a -G
mock $USER</p>

<p style="margin-top: 1em">Note that mock is not intended
to be run directly as root.</p>

<p style="margin-top: 1em">COMMANDS <br>
--buildsrpm <br>
Builds the specified SRPM either from a spec file and source
file/directory or from SCM. The chroot is cleaned first,
unless --no-clean is specified.</p>

<p style="margin-top: 1em">--clean <br>
Purge the chroot tree.</p>

<p style="margin-top: 1em">--copyin <br>
Copies the source paths (files or directory trees) into the
chroot at the specified destination path.</p>

<p style="margin-top: 1em">--copyout <br>
Copies the source paths (files or directory trees) from the
chroot to the specified destination path.</p>

<p style="margin-top: 1em">--chroot COMMAND [ARGS...] <br>
Run the specified command non-interactively within the
chroot (no &rsquo;clean&rsquo; is performed). Command output
will be sent to the log files. Note that COMMAND is shell
expanded <br>
only if there are no ARGS. Otherwise there is no shell
expansion.</p>

<p style="margin-top: 1em">--dnf-cmd <br>
Execute following arguments with DNF with installroot set to
the chroot path. DNF must be installed on the system. It
will use the binary which is specified in
&rsquo;dnf_com&acirc; <br>
mand&rsquo; option in site-defaults.cfg config, which by
default is /usr/bin/dnf. This option will enforce --dnf.</p>

<p style="margin-top: 1em">--init Initialize a chroot
(clean, install chroot packages, etc.)</p>

<p style="margin-top: 1em">-i, --install <br>
Do a yum install PACKAGE inside the chroot. No
&rsquo;clean&rsquo; is performed</p>

<p style="margin-top: 1em">--installdeps <br>
Find out deps for SRPM or RPM, and do a yum install to put
them in the chroot. No &rsquo;clean&rsquo; is performed</p>

<p style="margin-top: 1em">-l, --list-snapshots <br>
List all existing snapshots of the chroot belonging to
current configuration. Current base snapshot is marked with
an asterisk (*)</p>

<p style="margin-top: 1em">--mount <br>
Mount all everything mounted in the chroot path including
the root itself that might have been a LVM volume or
TMPFS.</p>

<p style="margin-top: 1em">--orphanskill <br>
No-op mode that simply checks that no stray processes are
running in the chroot. Kills any processes that it finds
using specified root.</p>

<p style="margin-top: 1em">--pm-cmd <br>
Execute following arguments with current package manager
with installroot set to the chroot path.</p>

<p style="margin-top: 1em">-p, --print-root-path <br>
Prints a path to the currently used chroot directory.</p>

<p style="margin-top: 1em">--rebuild <br>
If no command is specified, rebuild is assumed. Rebuilds the
specified SRPM(s). The chroot is cleaned first, unless
--no-clean is specified.</p>

<p style="margin-top: 1em">--remove <br>
Do a yum remove PACKAGE inside the chroot. No
&rsquo;clean&rsquo; is performed</p>

<p style="margin-top: 1em">--remove-snapshot <br>
Remove given snapshot freeing the space it occupied. This
action cannot be undone. This feature is available only when
lvm_root plugin is installed and enabled.</p>

<p style="margin-top: 1em">--rollback-to <br>
Return chroot to the state in specified snapshot and set it
as the current base to which clean actions will return. It
won&rsquo;t delete nor modify the snapshot that was set as
<br>
base previously. This feature is available only when
lvm_root plugin is installed and enabled.</p>

<p style="margin-top: 1em">--scm-enable <br>
Enable building from an SCM (CVS/Git/SVN). The SCM
repository must be configured in site-defaults.cfg before
SCM checkouts are possible. SCM package and branch can be
<br>
defined with --scm-option arguments, see site-defaults.cfg
for more information.</p>

<p style="margin-top: 1em">--scrub=TYPE <br>
Completely remove the specified chroot or cache dir or all
of the chroot and cache. TYPE is one of all, chroot, cache,
root-cache, c-cache, yum-cache or dnf-cache. In <br>
fact, dnf-cache is just alias for yum-cache and both removes
Dnf and Yum cache.</p>

<p style="margin-top: 1em">--shell [COMMAND [ARGS...]] <br>
Run the specified command interactively within the chroot
(no &rsquo;clean&rsquo; is performed). If no command
specified, /bin/sh is run. Note that COMMAND is shell
expanded using <br>
shell in chroot.</p>

<p style="margin-top: 1em">--sources=SOURCES <br>
Specifies sources (either a single file or a directory of
files) to use to build an SRPM (used only with
--buildsrpm).</p>

<p style="margin-top: 1em">--spec=SPEC <br>
Specifies spec file to use to build an SRPM (used only with
--buildsrpm).</p>

<p style="margin-top: 1em">--update [PACKAGE...] <br>
Do a package update inside the chroot. The package list is
optional, if omitted, all packages will be updated. No
&rsquo;clean&rsquo; is performed</p>

<p style="margin-top: 1em">--snapshot <br>
Make a snapshot of the current state of the chroot. That
snapshot will be set as the current base to which --clean
and implicit clean happening during rebuild command will
<br>
return. This feature is available only when lvm_root plugin
is installed and enabled.</p>

<p style="margin-top: 1em">--umount <br>
Umount all everything mounted in the chroot path including
the root itself that might have been a LVM volume or
TMPFS.</p>

<p style="margin-top: 1em">--yum-cmd <br>
Execute following arguments with YUM with installroot set to
the chroot path. Yum must be installed on the system. It
will use the binary which is specified in
&rsquo;yum_com&acirc; <br>
mand&rsquo; option in site-defaults.cfg config, which by
default is /usr/bin/yum. Note that in config files for
Fedora 22+ this value is overwriten in chroot config to
default <br>
to /usr/bin/yum-deprecated. This option will enforce
--yum.</p>

<p style="margin-top: 1em">Note: While you can specify more
commands on command line, only one can be executed. The last
command will win.</p>

<p style="margin-top: 1em">OPTIONS <br>
--arch=ARCH <br>
Calls the linux personality() syscall to tell the kernel to
emulate a secondary architecture. For example, building i386
packages on an x86_64 buildhost.</p>

<p style="margin-top: 1em">--cache-alterations <br>
Rebuild the root cache after making alterations to the
chroot (i.e. --install). Only useful when using tmpfs
plugin.</p>

<p style="margin-top: 1em">--cleanup-after <br>
Clean chroot after building. Use with --resultdir. Only
active for &rsquo;--rebuild&rsquo;.</p>

<p style="margin-top: 1em">--configdir=CONFIGDIR <br>
Change directory where config files are found</p>

<p style="margin-top: 1em">--cwd=DIR <br>
Change to the specified directory (relative to the chroot)
before running command when using --chroot</p>

<p style="margin-top: 1em">-D &quot;MACRO EXPR&quot;,
--define=&quot;MACRO EXPR&quot; <br>
Specify macro definitions used for the build. This option
may be used multiple times, just as the rpmbuild --define
option can be. For example:</p>

<p style="margin-top: 1em">--define &quot;with_extra_cheese
1&quot; --define=&quot;packager Monkey&quot;</p>

<p style="margin-top: 1em">--disable-plugin=PLUGIN <br>
Disable the specified plugin. This option may be used
multiple times.</p>

<p style="margin-top: 1em">--disablerepo=REPO <br>
Pass --disablerepo option to package manager to disable a
repository. It can be specified multiple times.</p>

<p style="margin-top: 1em">--dnf Use DNF as the current
package manager. You should have DNF (and dnf-plugins-core)
installed on your system.</p>

<p style="margin-top: 1em">--enable-plugin=PLUGIN <br>
Enable the specified plugin. This option may be used
multiple times.</p>

<p style="margin-top: 1em">--enablerepo=REPO <br>
Pass --enablerepo option to package manager to enable a
repository. It can be specified multiple times.</p>

<p style="margin-top: 1em">-h, --help <br>
Show usage information and exit.</p>

<p style="margin-top: 1em">--macro-file=FILE <br>
Use pre-defined rpm macro file. Macros passed to
&rsquo;--define&rsquo; override macros of the same name from
FILE.</p>

<p style="margin-top: 1em">--new-chroot <br>
use new chroot (systemd-nspawn) - this is experimental and
will break existing scripts.</p>

<p style="margin-top: 1em">-n, --no-clean <br>
Do not clean chroot before building package.</p>

<p style="margin-top: 1em">--nocheck <br>
Pass --nocheck to rpmbuild to skip &rsquo;make check&rsquo;
tests.</p>

<p style="margin-top: 1em">--no-cleanup-after <br>
Don&rsquo;t clean chroot after building. If automatic
cleanup is enabled, use this to disable.</p>

<p style="margin-top: 1em">--offline <br>
Run in &rsquo;offline&rsquo; mode where we tell
&rsquo;yum&rsquo; to run completely from local cache. Also
disables cache expiry for the mock yum cache.</p>

<p style="margin-top: 1em">--old-chroot <br>
use old chroot instead of systemd-nspawn.</p>

<p style="margin-top: 1em">--plugin-option PLUGIN:KEY=VALUE
<br>
Set plugin specific parameter. This option may be used
multiple times.</p>

<p style="margin-top: 1em">--postinstall <br>
Try to install built packages in the same buildroot right
after build.</p>

<p style="margin-top: 1em">-q, --quiet <br>
Be quiet.</p>

<p style="margin-top: 1em">-r CONFIG, --root=CONFIG <br>
Uses specified chroot configuration as defined in
/etc/mock/&lt;CONFIG&gt;.cfg. Optionally if CONFIG ends in
&rsquo;.cfg&rsquo;, it is interpreted as full path to config
file. If none spec&acirc; <br>
ified, uses the chroot config linked to by
/etc/mock/default.cfg.</p>

<p style="margin-top: 1em">--resultdir=RESULTDIR <br>
Change directory where resulting files (RPMs and build logs)
are written. Resultdir can contain python-string
substitutions for any variable in the chroot config. For
<br>
example:</p>


<p style="margin-top: 1em">--resultdir=./my/&quot;%(dist)s&quot;/&quot;%(target_arch)s&quot;/</p>

<p style="margin-top: 1em">This option enables automatic
cleanup, this can be changed in config file (by
cleanup_on_success, cleanup_on_failure configuration
options) or overridden by <br>
--no-cleanup-after/--cleanup-after arguments.</p>

<p style="margin-top: 1em">--rootdir=ROOTDIR <br>
Path for where the chroot should be built. By default it is
created in /var/lib/mock/&lt;CONFIG&gt;/root/.</p>

<p style="margin-top: 1em">--rpmbuild-opts=OPTIONS <br>
Pass additional options to rpmbuild. To pass more options,
put them in quotes.</p>

<p style="margin-top: 1em">--rpmbuild_timeout=SECONDS <br>
Fail build if rpmbuild takes longer than
&rsquo;timeout&rsquo; seconds</p>

<p style="margin-top: 1em">--scm-option=OPTIONS <br>
define an SCM option (may be used more than once).</p>

<p style="margin-top: 1em">--short-circuit=STAGE <br>
Use rpmbuild&rsquo;s short-circuit mechanism to skip already
executed stages of build. It doesn&rsquo;t produce RPMs,
it&rsquo;s useful only for debugging packaging. Implies
--no-clean. <br>
STAGE specifies which stage will be executed as the first.
Available values: prep, build, install, binary.</p>

<p style="margin-top: 1em">--symlink-dereference <br>
Follow symlinks in sources (used only with --buildsrpm).</p>

<p style="margin-top: 1em">--target=ARCH <br>
This argument is passed to rpmbuild to specify the target
arch to build. It defaults to whatever is specified for
--arch, or whatever is specified in the config file as <br>
config_opts[&rsquo;target_arch&rsquo;].</p>

<p style="margin-top: 1em">--trace <br>
Enables verbose tracing of function enter/exit with function
arguments and return codes. Useful for debugging mock
itself.</p>

<p style="margin-top: 1em">--uniqueext=text <br>
Arbitrary, unique extension to append to chroot directory
name</p>

<p style="margin-top: 1em">--unpriv <br>
Drop privileges before running command when using
--chroot</p>

<p style="margin-top: 1em">-v, --verbose <br>
Output verbose progress information.</p>

<p style="margin-top: 1em">--version <br>
Show version number and exit.</p>

<p style="margin-top: 1em">--with=OPTION <br>
Enable configure OPTION for build. This option may be used
multiple times. For example:</p>

<p style="margin-top: 1em">--with=extra_cheese</p>

<p style="margin-top: 1em">--without=OPTION <br>
Disable configure OPTION for build. This option may be used
multiple times. For example:</p>

<p style="margin-top: 1em">--without=anchovies</p>

<p style="margin-top: 1em">--yum Use yum as the current
package manager. This is the default.</p>

<p style="margin-top: 1em">FILES <br>
/etc/mock/ - default configuration directory</p>

<p style="margin-top: 1em">/var/lib/mock - directory where
chroots are created</p>

<p style="margin-top: 1em">EXAMPLES <br>
To rebuild test.src.rpm using the Fedora 14 configuration
for x86_64</p>

<p style="margin-top: 1em">mock -r fedora-14-x86_64
--rebuild /path/to/test.src.rpm</p>

<p style="margin-top: 1em">Note that the available
configurations are found in the /etc/mock directory with the
extension .cfg. To specify a configuration use the filename
without the trailing .cfg exten&acirc; <br>
sion.</p>

<p style="margin-top: 1em">To place the output RPMs and
logs in a specified location.</p>

<p style="margin-top: 1em">mock -r fedora-14-i386
--resultdir=./my-results /path/to/your.src.rpm</p>

<p style="margin-top: 1em">To build a package from the
default SCM repository configured in site-defaults.cfg use
the following arguments.</p>

<p style="margin-top: 1em">mock -r fedora-14-i386
--scm-enable --scm-option package=pkg</p>

<p style="margin-top: 1em">To build execute command inside
of chroot.</p>

<p style="margin-top: 1em">mock -r fedora-21-x86_64
--chroot -- rpm --eval %dist</p>

<p style="margin-top: 1em">mock -r fedora-21-x86_64
--chroot &rsquo;rpm --eval %dist&rsquo;</p>

<p style="margin-top: 1em">To build rawhide package using
yum:</p>

<p style="margin-top: 1em">mock -r fedora-rawhide-x86_64
--yum --rebuild your.src.rpm</p>

<p style="margin-top: 1em">Query rpm database inside chroot
using Yum:</p>

<p style="margin-top: 1em">mock -r fedora-rawhide-x86_64
--yum-cmd whatprovides foo</p>

<p style="margin-top: 1em">List package manager history
using package manager which is configured in chroot config
(can be either DNF or YUM):</p>

<p style="margin-top: 1em">mock -r fedora-rawhide-x86_64
--pm-cmd history list</p>

<p style="margin-top: 1em">BUGS <br>
To report bugs in mock, go to:</p>


<p style="margin-top: 1em">https://apps.fedoraproject.org/packages/mock/.</p>

<p style="margin-top: 1em">Select the Bugs tab. If there is
a bug similar to the one you are seeing, add your
information to the comments. If not, press Open A New Bug
and fill in the form.</p>

<p style="margin-top: 1em">AUTHORS <br>
Michael Brown &lt;mebrown@michaels-house.net&gt;</p>

<p style="margin-top: 1em">Clark Williams
&lt;williams@redhat.com&gt;</p>

<p style="margin-top: 1em">Seth Vidal
&lt;skvidal@linux.duke.edu&gt;</p>

<p style="margin-top: 1em">and a cast of...tens</p>

<p style="margin-top: 1em">SEE ALSO <br>
mockchain(1), rpmbuild(8), yum(8),
https://fedoraproject.org/wiki/Mock</p>

<p style="margin-top: 1em">Seth Vidal 1.2.17 mock(1)</p>
<hr>
</body>
</html>
