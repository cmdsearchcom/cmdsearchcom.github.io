<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:29:44 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>PAM_ABL(1) User Commands PAM_ABL(1)</p>

<p style="margin-top: 1em">NAME <br>
pam_abl - query or purge the databases used by the pam_abl
module.</p>

<p style="margin-top: 1em">SYNOPSIS <br>
pam_abl [OPTION] [CONFIG]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Provides a non-pam interface to the infomration stored in
the pam_abl module databases. CONFIG is the name of the
pam_abl config file (default: /etc/security/pam_abl.conf).
The <br>
config file is read to discover the names of the pam_abl
databases, the rules that control purging of old data from
them and commands to run when a user or host switches
state.</p>

<p style="margin-top: 1em">OPTIONS <br>
MAINTENANCE <br>
-h, --help <br>
See this message.</p>

<p style="margin-top: 1em">-d, --debugcommand <br>
Print the block/clear commands split in arguments.</p>

<p style="margin-top: 1em">-p, --purge <br>
Purge databases according to purge rules in config.</p>

<p style="margin-top: 1em">-r, --relative <br>
Display times relative to now.</p>

<p style="margin-top: 1em">-v, --verbose <br>
Verbose output.</p>

<p style="margin-top: 1em">NON-PAM INTERACTION <br>
-f, --fail <br>
Fail user or host.</p>

<p style="margin-top: 1em">-w, --whitelist <br>
Perform whitelisting (remove from blacklist, does not
provide immunity).</p>

<p style="margin-top: 1em">-c, --check <br>
Check status. Returns non-zero if currently blocked Prints
name: status if verboseness is specified. If more than one
host or user is given, checks only the first host/user <br>
pair.</p>

<p style="margin-top: 1em">-u, --update <br>
Update the state of all users/hosts in the db. This will
also cause the appropriate scripts to be called.</p>

<p style="margin-top: 1em">-s, --service <br>
Operate in context of specified service. Defaults to
none.</p>

<p style="margin-top: 1em">-U, --user <br>
Operate on user (wildcards are ok for whitelisting).</p>

<p style="margin-top: 1em">-H, --host <br>
Operate on host (wildcards are ok for whitelisting).</p>

<p style="margin-top: 1em">-R, --reason <br>
Only used when -f is provided (defaults to
&quot;AUTH&quot;). Specifies why the authentication failed.
Possible values are USER, HOST, BOTH, AUTH</p>

<p style="margin-top: 1em">If you specified commands to run
in your configuration, those commands will try to run if the
host or user switches state (blocked &lt;&acirc; clear)
since the last time it was checked. <br>
The command will only be able to run, however, if you supply
enough information to fill in the substitutions in the
command. For instance, if your host_clr_command uses the %s
<br>
parameter, you will need to specify the service with -s in
order for the command to actually run.</p>

<p style="margin-top: 1em">EXAMPLES <br>
Obtain a list of failed hosts and users:</p>

<p style="margin-top: 1em">$ pam_abl</p>

<p style="margin-top: 1em">Obtain a full list of failures
listing times relative to now:</p>

<p style="margin-top: 1em">$ pam_abl -rv $ pam_abl
--relative --verbose</p>

<p style="margin-top: 1em">Purge old data:</p>

<p style="margin-top: 1em">$ pam_abl -p $ pam_abl
--purge</p>

<p style="margin-top: 1em">Unblock all example.com,
somewhere.com hosts:</p>

<p style="margin-top: 1em">$ pam_abl -w -H *.example.com -H
somewhere.com</p>

<p style="margin-top: 1em">Fail the host badguy.com and the
user joe because the authentication failed:</p>

<p style="margin-top: 1em">$ pam_abl -f -H badguy.com -U
joe -R AUTH</p>

<p style="margin-top: 1em">Check whether joe is currently
allowed to use your neato service from somehost, running the
necessary commands if he switches state:</p>

<p style="margin-top: 1em">$ pam_abl -c -U joe -H somehost
-s neato</p>

<p style="margin-top: 1em">Because the user/host state is
only updated when an attempt is made, you can manually force
pam-abl to update the states and call the correct
scripts:</p>

<p style="margin-top: 1em">$ pam_abl -u</p>

<p style="margin-top: 1em">AUTHORS <br>
Lode Mertens &lt;pam-abl@danta.be&gt;</p>

<p style="margin-top: 1em">Andy Armstrong
&lt;andy@hexten.net&gt;</p>

<p style="margin-top: 1em">Chris Tasma
&lt;pam-abl@deksai.com&gt;</p>

<p style="margin-top: 1em">REPORTING BUGS <br>
Report bugs to &lt;pam-abl@deksai.com&gt; or using the
bugtracker on sourceforge.</p>

<p style="margin-top: 1em">SEE ALSO <br>
pam_abl.conf(5), pam_abl(8)</p>

<p style="margin-top: 1em">AUTHOR <br>
Chris Tasma <br>
Author.</p>

<p style="margin-top: 1em">GNU 05/19/2016 PAM_ABL(1)</p>
<hr>
</body>
</html>
