<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>CDIST(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">CDIST(1)</td>
    <td class="head-vol">cdist</td>
    <td class="head-rtitle">CDIST(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
cdist - Usable Configuration Management
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
cdist [-h] [-d] [-v] [-V] {banner,config,shell,install} ...
<div class="Pp"></div>
cdist banner [-h] [-d] [-v]
<div class="Pp"></div>
cdist config [-h] [-d] [-v] [-b] [-c CONF_DIR] [-f HOSTFILE]
             [-i MANIFEST] [-j [JOBS]] [-n] [-o OUT_PATH] [-p] [-s]
             [--remote-copy REMOTE_COPY] [--remote-exec REMOTE_EXEC]
             [host [host ...]]
<div class="Pp"></div>
cdist install [-h] [-d] [-v] [-b] [-c CONF_DIR] [-f HOSTFILE]
              [-i MANIFEST] [-j [JOBS]] [-n] [-o OUT_PATH] [-p] [-s]
              [--remote-copy REMOTE_COPY] [--remote-exec REMOTE_EXEC]
              [host [host ...]]
<div class="Pp"></div>
cdist shell [-h] [-d] [-v] [-s SHELL]
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
cdist is the frontend executable to the cdist configuration management. It
  supports different subcommands as explained below.
<div style="height: 1.00em;">&#x00A0;</div>
It is written in Python so it requires <b>python</b>(1) to be installed. It
  requires a minimal Python version 3.2.
<h1 class="Sh" title="Sh" id="GENERAL"><a class="selflink" href="#GENERAL">GENERAL</a></h1>
All commands accept the following options:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h, --help</b></dt>
  <dd class="It-tag">Show the help screen</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d, --debug</b></dt>
  <dd class="It-tag">Set log level to debug (deprecated, use -vvv instead)</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v, --verbose</b></dt>
  <dd class="It-tag">Increase log level, be more verbose. Use it more than once
      to increase log level. The order of levels from the lowest to the highest
      are: ERROR, WARNING, INFO, DEBUG.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-V, --version</b></dt>
  <dd class="It-tag">Show version and exit</dd>
</dl>
</div>
<br/>
<h1 class="Sh" title="Sh" id="BANNER"><a class="selflink" href="#BANNER">BANNER</a></h1>
Displays the cdist banner. Useful for printing cdist posters - a must have for
  every office.
<h1 class="Sh" title="Sh" id="CONFIG/INSTALL"><a class="selflink" href="#CONFIG/INSTALL">CONFIG/INSTALL</a></h1>
Configure/install one or more hosts.
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-b, --beta</b></dt>
  <dd class="It-tag">Enable beta functionalities.
    <div style="height: 1.00em;">&#x00A0;</div>
    Can also be enabled using CDIST_BETA env var.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c CONF_DIR, --conf-dir CONF_DIR</b></dt>
  <dd class="It-tag">Add a configuration directory. Can be specified multiple
      times. If configuration directories contain conflicting types, explorers
      or manifests, then the last one found is used. Additionally this can also
      be configured by setting the CDIST_PATH environment variable to a colon
      delimited list of config directories. Directories given with the
      --conf-dir argument have higher precedence over those set through the
      environment variable.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f HOSTFILE, --file HOSTFILE</b></dt>
  <dd class="It-tag">Read additional hosts to operate on from specified file or
      from stdin if '-' (each host on separate line). If no host or host file is
      specified then, by default, read hosts from stdin. For the file format see
      below.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i MANIFEST, --initial-manifest MANIFEST</b></dt>
  <dd class="It-tag">Path to a cdist manifest or - to read from stdin</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-j [JOBS], --jobs [JOBS]</b></dt>
  <dd class="It-tag">Specify the maximum number of parallel jobs; currently only
      global explorers are supported (currently in beta)</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n, --dry-run</b></dt>
  <dd class="It-tag">Do not execute code</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-o OUT_PATH, --out-dir OUT_PATH</b></dt>
  <dd class="It-tag">Directory to save cdist output in</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p, --parallel</b></dt>
  <dd class="It-tag">Operate on multiple hosts in parallel</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s, --sequential</b></dt>
  <dd class="It-tag">Operate on multiple hosts sequentially (default)</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--remote-copy REMOTE_COPY</b></dt>
  <dd class="It-tag">Command to use for remote copy (should behave like
    scp)</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--remote-exec REMOTE_EXEC</b></dt>
  <dd class="It-tag">Command to use for remote execution (should behave like
      ssh)</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="HOSTFILE_FORMAT"><a class="selflink" href="#HOSTFILE_FORMAT">HOSTFILE
  FORMAT</a></h2>
HOSTFILE contains hosts per line. All characters after and including '#' until
  the end of line is a comment. In a line, all leading and trailing whitespace
  characters are ignored. Empty lines are ignored/skipped.
<div style="height: 1.00em;">&#x00A0;</div>
Hostfile line is processed like the following. First, all comments are removed.
  Then all leading and trailing whitespace characters are stripped. If such a
  line results in empty line it is ignored/skipped. Otherwise, host string is
  used.
<h1 class="Sh" title="Sh" id="SHELL"><a class="selflink" href="#SHELL">SHELL</a></h1>
This command allows you to spawn a shell that enables access to the types as
  commands. It can be thought as an &quot;interactive manifest&quot;
  environment. See below for example usage. Its primary use is for debugging
  type parameters.
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s SHELL, --shell SHELL</b></dt>
  <dd class="It-tag">Select shell to use, defaults to current shell. Used shell
      should be POSIX compatible shell.</dd>
</dl>
</div>
<br/>
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>~/.cdist</b></dt>
  <dd class="It-tag">Your personal cdist config directory. If exists it will be
      automatically used.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>cdist/conf</b></dt>
  <dd class="It-tag">The distribution configuration directory. It contains
      official types and explorers. This path is relative to cdist installation
      directory.</dd>
</dl>
</div>
<br/>
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
cdist detects if host is specified by IPv6 address. If so then remote_copy
  command is executed with host address enclosed in square brackets (see
  <b>scp</b>(1)).
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
# Configure ikq05.ethz.ch with debug enabled
% cdist config -d ikq05.ethz.ch
<div class="Pp"></div>
# Configure hosts in parallel and use a different configuration directory
% cdist config -c ~/p/cdist-nutzung \
    -p ikq02.ethz.ch ikq03.ethz.ch ikq04.ethz.ch
<div class="Pp"></div>
# Use custom remote exec / copy commands
% cdist config --remote-exec /path/to/my/remote/exec \
    --remote-copy /path/to/my/remote/copy \
    -p ikq02.ethz.ch ikq03.ethz.ch ikq04.ethz.ch
<div class="Pp"></div>
# Configure hosts read from file loadbalancers
% cdist config -f loadbalancers
<div class="Pp"></div>
# Configure hosts read from file web.hosts using 16 parallel jobs
# (beta functionality)
% cdist config -b -j 16 -f web.hosts
<div class="Pp"></div>
# Display banner
cdist banner
<div class="Pp"></div>
# Show help
% cdist --help
<div class="Pp"></div>
# Show Version
% cdist --version
<div class="Pp"></div>
# Enter a shell that has access to emulated types
% cdist shell
% __git
usage: __git --source SOURCE [--state STATE] [--branch BRANCH]
             [--group GROUP] [--owner OWNER] [--mode MODE] object_id
<div class="Pp"></div>
# Install ikq05.ethz.ch with debug enabled
% cdist install -d ikq05.ethz.ch
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="ENVIRONMENT"><a class="selflink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>TMPDIR, TEMP, TMP</b></dt>
  <dd class="It-tag">Setup the base directory for the temporary directory. See
      <i>http://docs.python.org/py3k/library/tempfile.html</i> for more
      information. This is rather useful, if the standard directory used does
      not allow executables.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CDIST_PATH</b></dt>
  <dd class="It-tag">Colon delimited list of config directories.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CDIST_LOCAL_SHELL</b></dt>
  <dd class="It-tag">Selects shell for local script execution, defaults to
      /bin/sh.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CDIST_REMOTE_SHELL</b></dt>
  <dd class="It-tag">Selects shell for remote script execution, defaults to
      /bin/sh.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CDIST_OVERRIDE</b></dt>
  <dd class="It-tag">Allow overwriting type parameters.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CDIST_ORDER_DEPENDENCY</b></dt>
  <dd class="It-tag">Create dependencies based on the execution order.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CDIST_REMOTE_EXEC</b></dt>
  <dd class="It-tag">Use this command for remote execution (should behave like
      ssh).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CDIST_REMOTE_COPY</b></dt>
  <dd class="It-tag">Use this command for remote copy (should behave like
    scp).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CDIST_BETA</b></dt>
  <dd class="It-tag">Enable beta functionalities.</dd>
</dl>
</div>
<br/>
<h1 class="Sh" title="Sh" id="EXIT_STATUS"><a class="selflink" href="#EXIT_STATUS">EXIT
  STATUS</a></h1>
The following exit values shall be returned:
<div style="height: 1.00em;">&#x00A0;</div>
0 Successful completion.
<div style="height: 1.00em;">&#x00A0;</div>
1 One or more host configurations failed.
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
Originally written by Nico Schottelius &lt;
  <i>nico-cdist--@--schottelius.org</i>&gt; and Steven Armstrong &lt;
  <i>steven-cdist--@--armstrong.cc</i>&gt;.
<h1 class="Sh" title="Sh" id="CAVEATS"><a class="selflink" href="#CAVEATS">CAVEATS</a></h1>
When operating in parallel, either by operating in parallel for each host
  (-p/--parallel) or by parallel jobs within a host (-j/--jobs), and depending
  on target SSH server and its configuration you may encounter connection drops.
  This is controlled with sshd <b>MaxStartups</b> configuration options. You may
  also encounter session open refusal. This happens with ssh multiplexing when
  you reach maximum number of open sessions permitted per network connection. In
  this case ssh will disable multiplexing. This limit is controlled with sshd
  <b>MaxSessions</b> configuration options. For more details refer to
  <b>sshd_config</b>(5).
<div style="height: 1.00em;">&#x00A0;</div>
When requirements for the same object are defined in different manifests (see
  example below) in init manifest and in some other type manifest and they
  differs then dependency resolver cannot detect dependencies right. This
  happens because cdist cannot prepare all objects first and then run objects
  because some object can depend on the result of type explorer(s) and explorers
  are executed during object run. cdist will detect such case and write warning
  message. Example for such a case:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
init manifest:
    __a a
    require=&quot;__e/e&quot; __b b
    require=&quot;__f/f&quot; __c c
    __e e
    __f f
    require=&quot;__c/c&quot; __d d
    __g g
    __h h
<div class="Pp"></div>
type __g manifest:
    require=&quot;__c/c __d/d&quot; __a a
<div class="Pp"></div>
Warning message:
    WARNING: cdisttesthost: Object __a/a already exists with requirements:
    /usr/home/darko/ungleich/cdist/cdist/test/config/fixtures/manifest/init-deps-resolver /tmp/tmp.cdist.test.ozagkg54/local/759547ff4356de6e3d9e08522b0d0807/data/conf/type/__g/manifest: set()
    /tmp/tmp.cdist.test.ozagkg54/local/759547ff4356de6e3d9e08522b0d0807/data/conf/type/__g/manifest: {'__c/c', '__d/d'}
    Dependency resolver could not handle dependencies as expected.
</pre>
</div>
<br/>
</div>
<br/>
<h1 class="Sh" title="Sh" id="COPYING"><a class="selflink" href="#COPYING">COPYING</a></h1>
Copyright (C) 2011-2013 Nico Schottelius. Free use of this software is granted
  under the terms of the GNU General Public License v3 or later (GPLv3+).</div>
<table class="foot">
  <tr>
    <td class="foot-date">December 18, 2016</td>
    <td class="foot-os">4.4.1</td>
  </tr>
</table>
</body>
</html>
