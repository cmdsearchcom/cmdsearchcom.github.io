<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:21:16 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>LARCH(1) General Commands Manual LARCH(1)</p>

<p style="margin-top: 1em">NAME <br>
larch - copy messages from one IMAP server to another</p>

<p style="margin-top: 1em">SYNOPSIS <br>
larch [options]</p>

<p style="margin-top: 1em">larch [--from URI] [--to
URI]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Larch is a tool to copy messages from one IMAP server to
another quickly and safely. It&rsquo;s smart enough not to
copy messages that already exist on the destination and
robust <br>
enough to deal with interruptions caused by flaky
connections or misbehaving servers.</p>

<p style="margin-top: 1em">Larch is particularly
well-suited for copying email to, from, or between Gmail
accounts.</p>

<p style="margin-top: 1em">OPTIONS <br>
Server options <br>
--from, -f URI <br>
URI of the source IMAP server.</p>

<p style="margin-top: 1em">--from-folder, -F FOLDER <br>
Source folder to copy from. Default is INBOX.</p>

<p style="margin-top: 1em">--from-pass, -p PASSWD <br>
Source server password. Default is to prompt the user.</p>

<p style="margin-top: 1em">--from-user, -u USER <br>
Source server username. Default is to prompt the user.</p>

<p style="margin-top: 1em">--to, -t URI <br>
URI of the destination IMAP server.</p>

<p style="margin-top: 1em">--to-folder, -T FOLDER <br>
Destination folder to copy to. Default is INBOX.</p>

<p style="margin-top: 1em">--to-pass, -P PASSWD <br>
Destination server password. Default is to prompt the
user.</p>

<p style="margin-top: 1em">--to-user, -U USER <br>
Destination server username. Default is to prompt the
user.</p>

<p style="margin-top: 1em">Copy options <br>
--all, -a <br>
Copy all folders recursively.</p>

<p style="margin-top: 1em">--all-subscribed, -s <br>
Copy all subscribed folders recursively.</p>

<p style="margin-top: 1em">--delete, -d <br>
Delete messages from the source after copying them, or if
they already exist at the destination.</p>

<p style="margin-top: 1em">--exclude PATTERN [ PATTERN... ]
<br>
List of mailbox names/patterns that shouldn&rsquo;t be
copied.</p>

<p style="margin-top: 1em">--exclude-file FILE <br>
Filename containing mailbox names/patterns that
shouldn&rsquo;t be copied.</p>

<p style="margin-top: 1em">--expunge, -x <br>
Expunge deleted messages from the source.</p>

<p style="margin-top: 1em">--sync-flags, -S <br>
Sync message flags from the source to the destination for
messages that already exist at the destination.</p>

<p style="margin-top: 1em">General options <br>
--config, -c FILE <br>
Specify a non-default config file to use. Default is
~/.larch/config.yaml.</p>

<p style="margin-top: 1em">--database FILE <br>
Specify a non-default message database to use. Default is
~/.larch/larch.db.</p>

<p style="margin-top: 1em">--dry-run, -n <br>
Don&rsquo;t actually make any changes.</p>

<p style="margin-top: 1em">--max-retries NUM <br>
Maximum number of times to retry after a recoverable error.
Default is 3.</p>

<p style="margin-top: 1em">--no-create-folder <br>
Don&rsquo;t create destination folders that don&rsquo;t
already exist.</p>

<p style="margin-top: 1em">--ssl-certs FILE <br>
Path to a trusted certificate bundle to use to verify server
SSL certificates.</p>

<p style="margin-top: 1em">--ssl-verify <br>
Verify server SSL certificates.</p>

<p style="margin-top: 1em">--verbosity, -V STR <br>
Output verbosity: debug, info, warn, error, or fatal.
Default is info.</p>

<p style="margin-top: 1em">--version, -v <br>
Print version and exit.</p>

<p style="margin-top: 1em">--help, -h <br>
Show a help message.</p>

<p style="margin-top: 1em">CONFIGURATION <br>
While it&rsquo;s possible to control Larch entirely from the
command line, this can be inconvenient if you need to
specify a lot of options or if you run Larch frequently and
can&rsquo;t <br>
always remember which options to use. Using a configuration
file can simplify things.</p>

<p style="margin-top: 1em">By default, Larch looks for a
config file at ~/.larch/config.yaml and uses it if found.
You may specify a custom config file using the --config
command line option.</p>

<p style="margin-top: 1em">The Larch configuration file is
a simple YAML &acirc;&uml;http://yaml.org/&acirc;&copy; file
that may contain multiple sections, each with a different
set of options, as well as a special default sec&acirc; <br>
tion. The options in the default section will be used unless
they&rsquo;re overridden either in another config section or
on the command line.</p>

<p style="margin-top: 1em">Here&rsquo;s a sample Larch
config file:</p>

<p style="margin-top: 1em"># Copy all subscribed folders by
default <br>
default: <br>
all-subscribed: true</p>

<p style="margin-top: 1em"># Copy mail from Gmail to my
server, excluding stuff I don&rsquo;t want. <br>
gmail to my server: <br>
from: imaps://imap.gmail.com <br>
from-user: example <br>
from-pass: secret</p>

<p style="margin-top: 1em">to: imaps://mail.example.com
<br>
to-user: example <br>
to-pass: secret</p>

<p style="margin-top: 1em">exclude: <br>
- &quot;[Gmail]/Sent Mail&quot; <br>
- &quot;[Gmail]/Spam&quot; <br>
- &quot;[Gmail]/Trash&quot;</p>

<p style="margin-top: 1em"># Copy mail from my INBOX to
Gmail&rsquo;s INBOX <br>
my inbox to gmail inbox: <br>
all-subscribed: false</p>

<p style="margin-top: 1em">from: imaps://mail.example.com
<br>
from-folder: INBOX <br>
from-user: example <br>
from-pass: secret</p>

<p style="margin-top: 1em">to: imaps://imap.gmail.com <br>
to-folder: INBOX <br>
to-user: example <br>
to-pass: secret</p>

<p style="margin-top: 1em">This file contains three
sections. The options from default will be used in all other
sections as well unless they&rsquo;re overridden.</p>

<p style="margin-top: 1em">To specify which config section
you want Larch to use, just pass its name on the command
line (use quotes if the name contains spaces):</p>

<p style="margin-top: 1em">larch &rsquo;gmail to my
server&rsquo;</p>

<p style="margin-top: 1em">If you specify additional
command line options, they&rsquo;ll override options in the
config file:</p>

<p style="margin-top: 1em">larch &rsquo;gmail to my
server&rsquo; --from-user anotheruser</p>

<p style="margin-top: 1em">Running Larch with no command
line arguments will cause the default section to be used.
With the example above, this will result in an error since
the default section doesn&rsquo;t <br>
contain the required from and to options, but if you only
need to use Larch with a single configuration, you could use
the default section for everything and save yourself some
<br>
typing on the command line.</p>

<p style="margin-top: 1em">FILES <br>
~/.larch/config.yaml</p>

<p style="margin-top: 1em">NOTES <br>
Server compatibility <br>
Larch should work well with any server that properly
supports IMAP4rev1
&acirc;&uml;http://tools.ietf.org/html/rfc3501&acirc;&copy;
, and does its best to get along with servers that have
buggy, unre&acirc; <br>
liable, or incomplete IMAP implementations.</p>

<p style="margin-top: 1em">Larch has been tested on and is
known to work well with the following IMAP servers:</p>

<p style="margin-top: 1em">&Acirc;&middot; Dovecot</p>

<p style="margin-top: 1em">&Acirc;&middot; Gmail</p>

<p style="margin-top: 1em">&Acirc;&middot; Microsoft
Exchange 2003</p>

<p style="margin-top: 1em">The following servers are known
to work, but with caveats:</p>

<p style="margin-top: 1em">&Acirc;&middot; Yahoo! Mail</p>

<p style="margin-top: 1em">The following servers do not
work well with Larch:</p>

<p style="margin-top: 1em">&Acirc;&middot; BlitzMail Buggy
server implementation; fails to properly quote or escape
some IMAP responses, which can cause Net::IMAP to hang
waiting for a terminating character that <br>
will never arrive.</p>

<p style="margin-top: 1em">Gmail quirks <br>
Gmail&rsquo;s IMAP implementation is quirky. Larch does its
best to work around these quirks whenever possible, but here
are a few things to watch out for:</p>

<p style="margin-top: 1em">Some messages could not be
FETCHed error</p>

<p style="margin-top: 1em">This error indicates that a
message on Gmail is corrupt, and Gmail itself is unable to
read it. The message will continue to show up in the
mailbox, but all attempts to access <br>
it via IMAP, POP, or the Gmail web interface will result in
errors. Larch will try to skip these messages and continue
processing others if possible.</p>

<p style="margin-top: 1em">It&rsquo;s not clear how this
corruption occurs or exactly what kind of corruption causes
these errors, although in every case I&rsquo;m aware of, the
corrupt message has originated outside <br>
of Gmail (Gmail itself does not corrupt the message). There
is currently no known solution for this problem apart from
deleting the corrupted messages.</p>

<p style="margin-top: 1em">Folder names cannot contain
leading or trailing whitespace</p>

<p style="margin-top: 1em">Most IMAP servers allow folder
names to contain leading and trailing whitespace, such as
&quot; folder &quot;. Gmail does not. When copying folders
to Gmail, Larch will automatically <br>
remove leading and trailing whitespace in folder names to
prevent errors.</p>

<p style="margin-top: 1em">Yahoo! mail quirks <br>
Yahoo! doesn&rsquo;t officially support IMAP access for
general usage, but Larch is able to connect to
imap.mail.yahoo.com and imap-ssl.mail.yahoo.com by using a
fairly well-known <br>
trick. That said, as with anything tricky, there are
caveats.</p>

<p style="margin-top: 1em">No hierarchical folders</p>

<p style="margin-top: 1em">Similar to Gmail, Yahoo! Mail
doesn&rsquo;t allow hierarchical (nested) folders. If you
try to copy a folder hierarchy to Yahoo!, it will work, but
you&rsquo;ll end up with a set of folders <br>
named &quot;folder&quot; and &quot;folder.subfolder&quot;
rather than seeing &quot;subfolder&quot; as an actual
subfolder of &quot;folder&quot;.</p>

<p style="margin-top: 1em">No custom flags</p>

<p style="margin-top: 1em">Yahoo! Mail IMAP doesn&rsquo;t
support custom message flags, such as the tags and junk/not
junk flags used by Thunderbird. When transferring messages
with custom flags to a Yahoo! <br>
Mail IMAP account, the custom flags will be lost.</p>

<p style="margin-top: 1em">Here there be dragons</p>

<p style="margin-top: 1em">Larch&rsquo;s support for Yahoo!
Mail is very new and very lightly tested. Given its newness
and the fact that Yahoo!&rsquo;s IMAP gateway isn&rsquo;t
official, there are likely to be other <br>
quirks we&rsquo;re not yet aware of. There&rsquo;s also no
guarantee that Yahoo! won&rsquo;t shut down its IMAP
gateway, deprecate the trick Larch uses to connect, or just
outright block Larch. <br>
Use at your own risk.</p>

<p style="margin-top: 1em">BUGS <br>
Larch uses Ruby&rsquo;s Net::IMAP standard library for all
IMAP operations. While Net::IMAP is generally a very solid
library, it contains a bug that can cause a deadlock to
occur if <br>
a connection drops unexpectedly (either due to network
issues or because the server closed the connection without
warning) when the server has already begun sending a
response <br>
and Net::IMAP is waiting to receive more data. If this
happens, Net::IMAP will continue waiting forever without
passing control back to Larch, and you will need to manually
kill <br>
and restart Larch.</p>

<p style="margin-top: 1em">Net::IMAP in Ruby 1.8 has also
been known to hang when it can&rsquo;t parse a server
response, either because the response itself is malformed or
because of a bug in Net::IMAP&rsquo;s <br>
parser. This is rare, but it happens. Unfortunately
there&rsquo;s nothing Larch can do about this.</p>

<p style="margin-top: 1em">EXAMPLE <br>
Larch is run from the command line. The following examples
demonstrate how to run Larch using only command line
arguments, but you may also place these options in a config
file <br>
and run Larch without any arguments if you prefer.</p>

<p style="margin-top: 1em">At a minimum, you must specify a
source server and a destination server in the form of IMAP
URIs:</p>

<p style="margin-top: 1em">larch --from
imap://mail.example.com --to imap://imap.gmail.com</p>

<p style="margin-top: 1em">Larch will prompt you for the
necessary usernames and passwords, then sync the contents of
the source&rsquo;s INBOX folder to the destination&rsquo;s
INBOX folder.</p>

<p style="margin-top: 1em">To connect using SSL, specify a
URI beginning with imaps://:</p>

<p style="margin-top: 1em">larch --from
imaps://mail.example.com --to imaps://imap.gmail.com</p>

<p style="margin-top: 1em">If you&rsquo;d like to sync a
specific folder other than INBOX, specify the source and
destination folders using --from-folder and --to-folder.
Folder names containing spaces must be <br>
enclosed in quotes:</p>

<p style="margin-top: 1em">larch --from
imaps://mail.example.com --to imaps://imap.gmail.com
--from-folder &rsquo;Sent Mail&rsquo; --to-folder
&rsquo;Sent Mail&rsquo;</p>

<p style="margin-top: 1em">To sync all folders, use the
--all option (or --all-subscribed if you only want to sync
subscribed folders):</p>

<p style="margin-top: 1em">larch --from
imaps://mail.example.com --to imaps://imap.gmail.com
--all</p>

<p style="margin-top: 1em">By default Larch will create
folders on the destination server if they don&rsquo;t
already exist. To prevent this, add the --no-create-folder
option:</p>

<p style="margin-top: 1em">larch --from
imaps://mail.example.com --to imaps://imap.gmail.com --all
--no-create-folder</p>

<p style="margin-top: 1em">You can prevent Larch from
syncing one or more folders by using the --exclude option,
which accepts multiple arguments:</p>

<p style="margin-top: 1em">larch --from
imaps://mail.example.com --to imaps://imap.gmail.com --all
--exclude Spam Trash Drafts &quot;[Gmail]/*&quot;</p>

<p style="margin-top: 1em">If your exclusion list is long
or complex, create a text file with one exclusion pattern
per line and tell Larch to load it with the --exclude-file
option:</p>

<p style="margin-top: 1em">larch --from
imaps://mail.example.com --to imaps://imap.gmail.com --all
--exclude-file exclude.txt</p>

<p style="margin-top: 1em">The wildcard characters * and ?
are supported in exclusion lists. You may also use a regular
expression by enclosing a pattern in forward slashes, so the
previous example could <br>
be achieved with the pattern /(Spam|Trash|Drafts|.*)/</p>

<p style="margin-top: 1em">AUTHORS <br>
Adapted from the program&rsquo;s documentation for Debian by
Mart&Atilde;n Ferrari &lt;tincho@tincho.org&gt;.</p>
 
<p style="margin-top: 1em">LARCH(1)</p>
<hr>
</body>
</html>
