<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>CIRCUS(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">CIRCUS(1)</td>
    <td class="head-vol">Circus</td>
    <td class="head-rtitle">CIRCUS(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
circus - Circus Documentation [image]
<div style="height: 1.00em;">&#x00A0;</div>
Circus is a Python program which can be used to monitor and control processes
  and sockets.
<div style="height: 1.00em;">&#x00A0;</div>
Circus can be driven via a command-line interface, a web interface or
  programmatically through its python API.
<div style="height: 1.00em;">&#x00A0;</div>
To install it and try its features check out the examples, or read the rest of
  this page for a quick introduction.
<h1 class="Sh" title="Sh" id="RUNNING_A_CIRCUS_DAEMON"><a class="selflink" href="#RUNNING_A_CIRCUS_DAEMON">RUNNING
  A CIRCUS DAEMON</a></h1>
Circus provides a command-line script call <b>circusd</b> that can be used to
  manage processes organized in one or more watchers.
<div style="height: 1.00em;">&#x00A0;</div>
Circus' command-line tool is configurable using an ini-style configuration file.
<div style="height: 1.00em;">&#x00A0;</div>
Here's a very minimal example:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[watcher:program]
cmd = python myprogram.py
numprocesses = 5
<div class="Pp"></div>
[watcher:anotherprogram]
cmd = another_program
numprocesses = 2
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The file is then passed to <i>circusd</i>:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusd example.ini
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Besides processes, Circus can also bind sockets. Since every process managed by
  Circus is a child of the main Circus daemon, that means any program that's
  controlled by Circus can use those sockets.
<div style="height: 1.00em;">&#x00A0;</div>
Running a socket is as simple as adding a <i>socket</i> section in the config
  file:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[socket:mysocket]
host = localhost
port = 8080
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
To learn more about sockets, see sockets.
<div style="height: 1.00em;">&#x00A0;</div>
To understand why it's a killer feature, read whycircussockets.
<h1 class="Sh" title="Sh" id="CONTROLLING_CIRCUS"><a class="selflink" href="#CONTROLLING_CIRCUS">CONTROLLING
  CIRCUS</a></h1>
Circus provides two command-line tools to manage your running daemon:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><i>circusctl</i>, a management console you can use to
      perform actions such as adding or removing workers</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><i>circus-top</i>, a top-like console you can use to
      display the memory and cpu usage of your running Circus.</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
To learn more about these, see cli
<div style="height: 1.00em;">&#x00A0;</div>
Circus also offers a web dashboard that can connect to a running Circus daemon
  and let you monitor and interact with it.
<div style="height: 1.00em;">&#x00A0;</div>
To learn more about this feature, see circushttpd
<h2 class="Ss" title="Ss" id="What_now_?"><a class="selflink" href="#What_now_?">What
  now ?</a></h2>
If you are a developer and want to leverage Circus in your own project, write
  plugins or hooks, go to fordevs.
<div style="height: 1.00em;">&#x00A0;</div>
If you are an ops and want to manage your processes using Circus, go to forops.
<h2 class="Ss" title="Ss" id="Contributions_and_Feedback"><a class="selflink" href="#Contributions_and_Feedback">Contributions
  and Feedback</a></h2>
More on contributing: contribs.
<div style="height: 1.00em;">&#x00A0;</div>
Useful Links:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">There's a mailing-list for any feedback or question:
      <i>http://tech.groups.yahoo.com/group/circus-dev/</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The repository and issue tracker are on GitHub :
      <i>https://github.com/circus-tent/circus</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Join us on the IRC : Freenode, channel
    <b>#circus-tent</b></dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Documentation_index"><a class="selflink" href="#Documentation_index">Documentation
  index</a></h2>
<h2 class="Ss" title="Ss" id="Installing_Circus"><a class="selflink" href="#Installing_Circus">Installing
  Circus</a></h2>
Circus is a Python package which is published on PyPI - the Python Package
  Index.
<div style="height: 1.00em;">&#x00A0;</div>
The simplest way to install it is to use pip, a tool for installing and managing
  Python packages:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ pip install circus
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Or download the <i>archive on PyPI</i>, extract and install it manually with:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ python setup.py install
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
If you want to try out Circus, see the examples.
<div style="height: 1.00em;">&#x00A0;</div>
If you are using debian or any debian based distribution, you also can use the
  ppa to install circus, it's at
  <i>https://launchpad.net/~roman-imankulov/+archive/circus</i>
<h2 class="Ss" title="Ss" id="zc.buildout"><a class="selflink" href="#zc.buildout">zc.buildout</a></h2>
We provide a <i>zc.buildout</i> configuration, you can use it by simply running
  the bootstrap script, then calling buildout:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ python bootstrap.py
$ bin/buildout
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="More_on_Requirements"><a class="selflink" href="#More_on_Requirements">More
  on Requirements</a></h2>
Circus works with:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Python 2.6, 2.7, 3.2 or 3.3</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 2.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>zeromq &gt;= 2.1.10</b></dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The version of zeromq supported is ultimately determined by
      what version of <i>pyzmq</i> is installed by pip during circus
      installation.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Their current release supports 2.x (limited), 3.x, and 4.x
      ZeroMQ versions.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>Note</b>: If you are using PyPy instead of CPython, make
      sure to read their installation docs as ZeroMQ version support is not the
      same on PyPy.</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
When you install circus, the latest versions of the Python dependencies will be
  pulled out for you.
<div style="height: 1.00em;">&#x00A0;</div>
You can also install them manually using the pip-requirements.txt file we
  provide:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ pip install -r pip-requirements.txt
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
If you want to run the Web console you will need to install <b>circus-web</b>:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ pip install circus-web
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Tutorial"><a class="selflink" href="#Tutorial">Tutorial</a></h2>
<h2 class="Ss" title="Ss" id="Step-by-step_tutorial"><a class="selflink" href="#Step-by-step_tutorial">Step-by-step
  tutorial</a></h2>
The <i>examples directory</i> in the Circus repository contains many examples to
  get you started, but here's a full tutorial that gives you an overview of the
  features.
<div style="height: 1.00em;">&#x00A0;</div>
We're going to supervise a WSGI application.
<h2 class="Ss" title="Ss" id="Installation"><a class="selflink" href="#Installation">Installation</a></h2>
Circus is tested on Mac OS X and Linux with the latest Python 2.6, 2.7, 3.2 and
  3.3. To run a full Circus, you will also need <b>libzmq</b>, <b>libevent</b>
  &amp; <b>virtualenv</b>.
<div style="height: 1.00em;">&#x00A0;</div>
On Debian-based systems:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ sudo apt-get install libzmq-dev libevent-dev python-dev python-virtualenv
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Create a virtualenv and install <i>circus</i>, <i>circus-web</i> and
  <i>chaussette</i> in it
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ virtualenv /tmp/circus
$ cd /tmp/circus
$ bin/pip install circus
$ bin/pip install circus-web
$ bin/pip install chaussette
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Once this is done, you'll find a plethora of commands in the local bin dir.
<h2 class="Ss" title="Ss" id="Usage"><a class="selflink" href="#Usage">Usage</a></h2>
<i>Chaussette</i> comes with a default Hello world app, try to run it:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ bin/chaussette
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
You should be able to visit <i>http://localhost:8080</i> and see <i>hello
  world</i>.
<div style="height: 1.00em;">&#x00A0;</div>
Stop Chaussette and add a circus.ini file in the directory containing:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[circus]
statsd = 1
httpd = 1
<div class="Pp"></div>
[watcher:webapp]
cmd = bin/chaussette --fd $(circus.sockets.web)
numprocesses = 3
use_sockets = True
<div class="Pp"></div>
[socket:web]
host = 127.0.0.1
port = 9999
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
This config file tells Circus to bind a socket on port <i>9999</i> and run 3
  chaussettes workers against it. It also activates the Circus web dashboard and
  the statistics module.
<div style="height: 1.00em;">&#x00A0;</div>
Save it &amp; run it using <b>circusd</b>:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ bin/circusd --daemon circus.ini
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Now visit <i>http://127.0.0.1:9999</i>, you should see the hello world app. The
  difference now is that the socket is managed by Circus and there are several
  web workers that are accepting connections against it.
<div style="height: 1.00em;">&#x00A0;</div>
<b>NOTE:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The load balancing is operated by the
  operating system so you're getting the same speed as any other pre-fork web
  server like Apache or NGinx. Circus does not interfer with the data that goes
  through.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
You can also visit <i>http://localhost:8080/</i> and enjoy the Circus web
  dashboard.
<h2 class="Ss" title="Ss" id="Interaction"><a class="selflink" href="#Interaction">Interaction</a></h2>
Let's use the circusctl shell while the system is running:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ bin/circusctl
circusctl 0.7.1
circusd-stats: active
circushttpd: active
webapp: active
(circusctl)
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
You get into an interactive shell. Type <b>help</b> to get all commands:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
(circusctl) help
<div class="Pp"></div>
Documented commands (type help &lt;topic&gt;):
========================================
add     get            list         numprocesses  quit     rm      start   stop
decr    globaloptions  listen       numwatchers   reload   set     stats
dstats  incr           listsockets  options       restart  signal  status
<div class="Pp"></div>
Undocumented commands:
======================
EOF  help
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Let's try basic things. Let's list the web workers processes and add a new one:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
(circusctl) list webapp
13712,13713,13714
(circusctl) incr webapp
4
(circusctl) list webapp
13712,13713,13714,13973
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Congrats, you've interacted with your Circus! Get off the shell with Ctrl+D and
  now run circus-top:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ bin/circus-top
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
This is a top-like command to watch all your processes' memory and CPU usage in
  real time.
<div style="height: 1.00em;">&#x00A0;</div>
Hit Ctrl+C and now let's quit Circus completely via circus-ctl:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ bin/circusctl quit
ok
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Next_steps"><a class="selflink" href="#Next_steps">Next
  steps</a></h2>
You can plug your own WSGI application instead of Chaussette's hello world
  simply by pointing the application callable.
<div style="height: 1.00em;">&#x00A0;</div>
Chaussette also comes with many backends like Gevent or Meinheld.
<div style="height: 1.00em;">&#x00A0;</div>
Read <i>https://chaussette.readthedocs.org/</i> for all options.
<h2 class="Ss" title="Ss" id="Why_should_I_use_Circus_instead_of_X_?"><a class="selflink" href="#Why_should_I_use_Circus_instead_of_X_?">Why
  should I use Circus instead of X ?</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">1.</dt>
  <dd class="It-tag"><b>Circus simplifies your web stack process management</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    Circus knows how to manage processes <i>and</i> sockets, so you don't have
      to delegate web workers management to a WGSI server.
    <div style="height: 1.00em;">&#x00A0;</div>
    See whycircussockets</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">2.</dt>
  <dd class="It-tag"><b>Circus provides pub/sub and poll notifications via
      ZeroMQ</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">Circus has a pub/sub channel you can subscribe
  to. This channel receives all events happening in Circus. For example, you can
  be notified when a process is flapping, or build a client that triggers a
  warning when some processes are eating all the CPU or RAM.
<div style="height: 1.00em;">&#x00A0;</div>
These events are sent via a ZeroMQ channel, which makes it different from the
  stdin stream Supervisord uses:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Circus sends events in a fire-and-forget fashion, so
      there's no need to manually loop through <i>all</i> listeners and maintain
      their states.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Subscribers can be located on a remote host.</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Circus also provides ways to get status updates via one-time polls on a req/rep
  channel. This means you can get your information without having to subscribe
  to a stream. The cli command provided by Circus uses this channel.
<div style="height: 1.00em;">&#x00A0;</div>
See examples.</div>
<br/>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">3.</dt>
  <dd class="It-tag"><b>Circus is (Python) developer friendly</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">While Circus can be driven entirely by a
  config file and the <i>circusctl</i> / <i>circusd</i> commands, it is easy to
  reuse all or part of the system to build your own custom process watcher in
  Python.
<div style="height: 1.00em;">&#x00A0;</div>
Every layer of the system is isolated, so you can reuse independently:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">the process wrapper (<b>Process</b>)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">the processes manager (<b>Watcher</b>)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">the global manager that runs several processes managers
      (<b>Arbiter</b>)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">and so on&#x2026;</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">4.</dt>
  <dd class="It-tag"><b>Circus scales</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">One of the use cases of Circus is to manage
  thousands of processes without adding overhead -- we're dedicated to focusing
  on this.</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Coming_from_Supervisor"><a class="selflink" href="#Coming_from_Supervisor">Coming
  from Supervisor</a></h2>
Supervisor is a very popular solution in the Python world and we're often asked
  how Circus compares with it.
<div style="height: 1.00em;">&#x00A0;</div>
If you are coming from <i>Supervisor</i>, this page tries to give an overview of
  how the tools differ.
<h2 class="Ss" title="Ss" id="Differences_overview"><a class="selflink" href="#Differences_overview">Differences
  overview</a></h2>
Supervisor &amp; Circus have the same goals - they both manage processes and
  provide a command-line script &#x2014; respectively <b>supervisord</b> and
  <b>circusd</b> &#x2014; that reads a configuration file, forks new processes
  and keep them alive.
<div style="height: 1.00em;">&#x00A0;</div>
Circus has an extra feature: the ability to bind sockets and let the processes
  it manages use them. This &quot;pre-fork&quot; model is used by many web
  servers out there, like <i>Apache</i> or <i>Unicorn</i>. Having this option in
  Circus can simplify a web app stack: all processes and sockets are managed by
  a single tool.
<div style="height: 1.00em;">&#x00A0;</div>
Both projects provide a way to control a running daemon via another script.
  respectively <b>supervisorctl</b> and <b>circusctl</b>. They also both have
  events and a way to subscribe to them. The main difference is the underlying
  technology: Supervisor uses XML-RPC for interacting with the daemon, while
  Circus uses ZeroMQ.
<div style="height: 1.00em;">&#x00A0;</div>
Circus &amp; Supervisor both have a web interface to display what's going on.
  Circus' is more advanced because you can follow in real time what's going on
  and interact with the daemon. It uses web sockets and is developed in a
  separate project ( <i>circus-web</i>.)
<div style="height: 1.00em;">&#x00A0;</div>
There are many other subtle differences in the core design, we might list here
  one day&#x2026; In the meantime, you can learn more about circus internals in
  design.
<h2 class="Ss" title="Ss" id="Configuration"><a class="selflink" href="#Configuration">Configuration</a></h2>
Both systems use an ini-like file as a configuration.
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><i>Supervisor documentation</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><i>Circus documentation</i></dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Here's a small example of running an application with Supervisor. In this case,
  the application will be started and restarted in case it crashes
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[program:example]
command=npm start
directory=/home/www/my-server/
user=www-data
autostart=true
autorestart=true
redirect_stderr=True
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
In Circus, the same configuration is done by:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[watcher:example]
cmd=npm start
working_dir=/home/www/my-server/
user=www-data
stderr_stream.class=StdoutStream
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Notice that the stderr redirection is slightly different in Circus. The tool
  does not have a <b>tail</b> feature like in Supervisor, but will let you hook
  any piece of code to deal with the incoming stream. You can create your own
  stream hook (as a Class) and do whatever you want with the incoming stream.
  Circus provides some built-in stream classes like <b>StdoutStream</b>,
  <b>FileStream</b>, <b>WatchedFileStream</b>, or
  <b>TimedRotatingFileStream</b>.
<h2 class="Ss" title="Ss" id="Circus_for_Ops"><a class="selflink" href="#Circus_for_Ops">Circus
  for Ops</a></h2>
<b>WARNING:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">By default, Circus doesn't secure its messages
  when sending information through ZeroMQ. Before running Circus in a production
  environment, make sure to read the Security page.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The first step to manage a Circus daemon is to write its configuration file. See
  configuration. If you are deploying a web stack, have a look at sockets.
<div style="height: 1.00em;">&#x00A0;</div>
Circus can be deployed using Python 2.6, 2.7, 3.2 or 3.3 - most deployments out
  there are done in 2.7. To learn how to deploy Circus, check out deployment.
<div style="height: 1.00em;">&#x00A0;</div>
To manage a Circus daemon, you should get familiar with the list of commands you
  can use in <b>circusctl</b>. Notice that you can have the same help online
  when you run <b>circusctl</b> as a shell.
<div style="height: 1.00em;">&#x00A0;</div>
We also provide <b>circus-top</b>, see cli and a nice web dashboard. see
  circushttpd.
<div style="height: 1.00em;">&#x00A0;</div>
Last, to get the most out of Circus, make sure to check out how to use plugins
  and hooks. See plugins and hooks.
<h2 class="Ss" title="Ss" id="Ops_documentation_index"><a class="selflink" href="#Ops_documentation_index">Ops
  documentation index</a></h2>
<h2 class="Ss" title="Ss" id="Configuration"><a class="selflink" href="#Configuration">Configuration</a></h2>
Circus can be configured using an ini-style configuration file.
<div style="height: 1.00em;">&#x00A0;</div>
Example:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[circus]
check_delay = 5
endpoint = tcp://127.0.0.1:5555
pubsub_endpoint = tcp://127.0.0.1:5556
include = \*.more.config.ini
umask = 002
<div class="Pp"></div>
[watcher:myprogram]
cmd = python
args = -u myprogram.py $(circus.wid) $(CIRCUS.ENV.VAR)
warmup_delay = 0
numprocesses = 5
<div class="Pp"></div>
# hook
hooks.before_start = my.hooks.control_redis
<div class="Pp"></div>
# will push in test.log the stream every 300 ms
stdout_stream.class = FileStream
stdout_stream.filename = test.log
<div class="Pp"></div>
# optionally rotate the log file when it reaches 1 gb
# and save 5 copied of rotated files
stdout_stream.max_bytes = 1073741824
stdout_stream.backup_count = 5
<div class="Pp"></div>
[env:myprogram]
PATH = $PATH:/bin
CAKE = lie
<div class="Pp"></div>
[plugin:statsd]
use = circus.plugins.statsd.StatsdEmitter
host = localhost
port = 8125
sample_rate = 1.0
application_name = example
<div class="Pp"></div>
[socket:web]
host = localhost
port = 8080
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="circus_-_single_section"><a class="selflink" href="#circus_-_single_section">circus
  - single section</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>endpoint</b></b></dt>
  <dd class="It-tag">The ZMQ socket used to manage Circus via <b>circusctl</b>.
      (default: <i>tcp://127.0.0.1:5555</i>)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>endpoint_owner</b></b></dt>
  <dd class="It-tag">If set to a system username and the endpoint is an ipc
      socket like <i>ipc://var/run/circusd.sock</i>, then ownership of the
      socket file will be changed to that user at startup. For more details, see
      security. (default: None)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>pubsub_endpoint</b></b></dt>
  <dd class="It-tag">The ZMQ PUB/SUB socket receiving publications of events.
      (default: <i>tcp://127.0.0.1:5556</i>)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>papa_endpoint</b></b></dt>
  <dd class="It-tag">If using papa, you can specify the endpoint, such as
      <i>ipc://var/run/circusd.sock</i>. (default:
    <i>tcp://127.0.0.1:20202</i>)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>statsd</b></b></dt>
  <dd class="It-tag">If set to True, Circus runs the circusd-stats daemon.
      (default: False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>stats_endpoint</b></b></dt>
  <dd class="It-tag">The ZMQ PUB/SUB socket receiving publications of stats.
      (default: <i>tcp://127.0.0.1:5557</i>)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>statsd_close_outputs</b></b></dt>
  <dd class="It-tag">If True sends the circusd-stats stdout/stderr to /dev/null.
      (default: False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>check_delay</b></b></dt>
  <dd class="It-tag">The polling interval in seconds for the ZMQ socket.
      (default: 5)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>include</b></b></dt>
  <dd class="It-tag">List of config files to include. You can use wildcards (
      <i>*</i>) to include particular schemes for your files. The paths are
      absolute or relative to the config file. (default: None)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>include_dir</b></b></dt>
  <dd class="It-tag">List of config directories. All files matching <i>*.ini</i>
      under each directory will be included. The paths are absolute or relative
      to the config file. (default: None)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>stream_backend</b></b></dt>
  <dd class="It-tag">Defines the type of backend to use for the streaming.
      Possible values are <b>thread</b> or <b>gevent</b>. (default: thread)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>warmup_delay</b></b></dt>
  <dd class="It-tag">The interval in seconds between two watchers start. Must be
      an int. (default: 0)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>httpd</b></b></dt>
  <dd class="It-tag">If set to True, Circus runs the circushttpd daemon.
      (default: False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>httpd_host</b></b></dt>
  <dd class="It-tag">The host ran by the circushttpd daemon. (default:
      localhost)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>httpd_port</b></b></dt>
  <dd class="It-tag">The port ran by the circushttpd daemon. (default:
    8080)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>httpd_close_outputs</b></b></dt>
  <dd class="It-tag">If True, sends the circushttpd stdout/stderr to /dev/null.
      (default: False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>debug</b></b></dt>
  <dd class="It-tag">If set to True, all Circus stout/stderr daemons are
      redirected to circusd stdout/stderr (default: False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>debug_gc</b></b></dt>
  <dd class="It-tag">If set to True, circusd outputs additional log info from
      the garbage collector. This can be useful in tracking down memory leaks.
      (default: False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>pidfile</b></b></dt>
  <dd class="It-tag">The file that must be used to keep the daemon pid.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>umask</b></b></dt>
  <dd class="It-tag">Value for umask. If not set, circusd will not attempt to
      modify umask.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>loglevel</b></b></dt>
  <dd class="It-tag">The loglevel that we want to see (default: INFO)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>logoutput</b></b></dt>
  <dd class="It-tag">The logoutput file where we want to log (default: <b>-</b>
      to log on stdout). You can log to a remote syslog by using the following
      syntax: <b>syslog://host:port?facility</b> where host is your syslog
      server, port is optional and facility is the syslog facility to use. If
      you wish to log to a local syslog you can use
      <b>syslog:///path/to/syslog/socket?facility</b> instead.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>loggerconfig</b></b></dt>
  <dd class="It-tag">A path to an INI, JSON or YAML file to configure standard
      Python logging for the Arbiter. The special value &quot;default&quot; uses
      the builtin logging configuration based on the optional loglevel and
      logoutput options.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>Example YAML Configuration File</b></dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
version: 1
disable_existing_loggers: false
formatters:
  simple:
    format: '%(asctime)s - %(name)s - [%(levelname)s] %(message)s'
handlers:
  logfile:
    class: logging.FileHandler
    filename: logoutput.txt
    level: DEBUG
    formatter: simple
loggers:
  circus:
    level: DEBUG
    handlers: [logfile]
    propagate: no
root:
  level: DEBUG
  handlers: [logfile]
</pre>
</div>
<br/>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="watcher:NAME_-_as_many_sections_as_you_want"><a class="selflink" href="#watcher:NAME_-_as_many_sections_as_you_want">watcher:NAME
  - as many sections as you want</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>NAME</b></b></dt>
  <dd class="It-tag">The name of the watcher. This name is used in
      <b>circusctl</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>cmd</b></b></dt>
  <dd class="It-tag">The executable program to run.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>args</b></b></dt>
  <dd class="It-tag">Command-line arguments to pass to the program. You can use
      the python format syntax here to build the parameters. Environment
      variables are available, as well as the worker id and the environment
      variables that you passed, if any, with the &quot;env&quot; parameter. See
      <i>Formatting the commands and arguments with dynamic variables</i> for
      more information on this.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>shell</b></b></dt>
  <dd class="It-tag">If True, the processes are run in the shell (default:
      False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>shell_args</b></b></dt>
  <dd class="It-tag">Command-line arguments to pass to the shell command when
      <b>shell</b> is True. Works only for *nix system (default: None)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>working_dir</b></b></dt>
  <dd class="It-tag">The working dir for the processes (default: None)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>uid</b></b></dt>
  <dd class="It-tag">The user id or name the command should run with. (The
      current uid is the default).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>gid</b></b></dt>
  <dd class="It-tag">The group id or name the command should run with. (The
      current gid is the default).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>copy_env</b></b></dt>
  <dd class="It-tag">If set to true, the local environment variables will be
      copied and passed to the workers when spawning them. (Default: False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>copy_path</b></b></dt>
  <dd class="It-tag">If set to true, <b>sys.path</b> is passed in the subprocess
      environ using <i>PYTHONPATH</i>. <b>copy_env</b> has to be true. (Default:
      False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>warmup_delay</b></b></dt>
  <dd class="It-tag">The delay (in seconds) between running processes.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>autostart</b></b></dt>
  <dd class="It-tag">If set to false, the watcher will not be started
      automatically when the arbiter starts. The watcher can be started
      explicitly (example: <i>circusctrl start myprogram</i>). (Default:
    True)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>numprocesses</b></b></dt>
  <dd class="It-tag">The number of processes to run for this watcher.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>rlimit_LIMIT</b></b></dt>
  <dd class="It-tag">Set resource limit LIMIT for the watched processes. The
      config name should match the RLIMIT_* constants (not case sensitive)
      listed in the <i>Python resource module reference</i>. For example, the
      config line 'rlimit_nofile = 500' sets the maximum number of open files to
      500. To set a limit value to RLIM_INFINITY, do not set a value, like this
      config line: 'rlimit_nofile = '.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>stderr_stream.class</b></b></dt>
  <dd class="It-tag">A fully qualified Python class name that will be
      instanciated, and will receive the <b>stderr</b> stream of all processes
      in its <b>__call__()</b> method.
    <div style="height: 1.00em;">&#x00A0;</div>
    Circus provides some stream classes you can use without prefix:</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>FileStream</b>: writes in a file and can do automatic
      log rotation</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>WatchedFileStream</b>: writes in a file and relies on
      external log rotation</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>TimedRotatingFileStream</b>: writes in a file and can do
      rotate at certain timed intervals.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>QueueStream</b>: write in a memory Queue</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>StdoutStream</b>: writes in the stdout</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>FancyStdoutStream</b>: writes colored output with time
      prefixes in the stdout</dd>
</dl>
</div>
<br/>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>stderr_stream.*</b></b></dt>
  <dd class="It-tag">All options starting with <i>stderr_stream.</i> other than
      <i>class</i> will be passed the constructor when creating an instance of
      the class defined in <b>stderr_stream.class</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>stdout_stream.class</b></b></dt>
  <dd class="It-tag">A fully qualified Python class name that will be
      instanciated, and will receive the <b>stdout</b> stream of all processes
      in its <b>__call__()</b> method.
    <div style="height: 1.00em;">&#x00A0;</div>
    Circus provides some stream classes you can use without prefix:</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>FileStream</b>: writes in a file and can do automatic
      log rotation</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>WatchedFileStream</b>: writes in a file and relies on
      external log rotation</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>TimedRotatingFileStream</b>: writes in a file and can do
      rotate at certain timed intervals.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>QueueStream</b>: write in a memory Queue</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>StdoutStream</b>: writes in the stdout</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>FancyStdoutStream</b>: writes colored output with time
      prefixes in the stdout</dd>
</dl>
</div>
<br/>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>stdout_stream.*</b></b></dt>
  <dd class="It-tag">All options starting with <i>stdout_stream.</i> other than
      <i>class</i> will be passed the constructor when creating an instance of
      the class defined in <b>stdout_stream.class</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>close_child_stdout</b></b></dt>
  <dd class="It-tag">If set to True, the stdout stream of each process will be
      sent to /dev/null after the fork. Defaults to False.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>close_child_stderr</b></b></dt>
  <dd class="It-tag">If set to True, the stderr stream of each process will be
      sent to /dev/null after the fork. Defaults to False.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>send_hup</b></b></dt>
  <dd class="It-tag">If True, a process reload will be done by sending the
      SIGHUP signal. Defaults to False.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>stop_signal</b></b></dt>
  <dd class="It-tag">The signal to send when stopping the process. Can be
      specified as a number or a signal name. Signal names are case-insensitive
      and can include 'SIG' or not. So valid examples include <i>quit</i>,
      <i>INT</i>, <i>SIGTERM</i> and <i>3</i>. Defaults to SIGTERM.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>stop_children</b></b></dt>
  <dd class="It-tag">When sending the <i>stop_signal</i>, send it to the
      children as well. Defaults to False.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>max_retry</b></b></dt>
  <dd class="It-tag">The number of times we attempt to start a process, before
      we abandon and stop the whole watcher. Defaults to 5. Set to -1 to disable
      max_retry and retry indefinitely.</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>graceful_timeout</b></b></dt>
  <dd class="It-tag">The number of seconds to wait for a process to terminate
      gracefully before killing it.
    <div style="height: 1.00em;">&#x00A0;</div>
    When stopping a process, we first send it a <i>stop_signal</i>. A worker may
      catch this signal to perform clean up operations before exiting. If the
      worker is still active after graceful_timeout seconds, we send it a
      SIGKILL signal. It is not possible to catch SIGKILL signals so the worker
      will stop.
    <div style="height: 1.00em;">&#x00A0;</div>
    Defaults to 30s.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>priority</b></b></dt>
  <dd class="It-tag">Integer that defines a priority for the watcher. When the
      Arbiter do some operations on all watchers, it will sort them with this
      field, from the bigger number to the smallest. Defaults to 0.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>singleton</b></b></dt>
  <dd class="It-tag">If set to True, this watcher will have at the most one
      process. Defaults to False.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>use_sockets</b></b></dt>
  <dd class="It-tag">If set to True, this watcher will be able to access defined
      sockets via their file descriptors. If False, all parent fds are closed
      when the child process is forked. Defaults to False.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>max_age</b></b></dt>
  <dd class="It-tag">If set then the process will be restarted sometime after
      max_age seconds. This is useful when processes deal with pool of
      connectors: restarting processes improves the load balancing. Defaults to
      being disabled.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>max_age_variance</b></b></dt>
  <dd class="It-tag">If max_age is set then the process will live between
      max_age and max_age + random(0, max_age_variance) seconds. This avoids
      restarting all processes for a watcher at once. Defaults to 30
    seconds.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>on_demand</b></b></dt>
  <dd class="It-tag">If set to True, the processes will be started only after
      the first connection to one of the configured sockets (see below). If a
      restart is needed, it will be only triggered at the next socket
    event.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>hooks.*</b></b></dt>
  <dd class="It-tag">Available hooks: <b>before_start</b>, <b>after_start</b>,
      <b>before_spawn</b>, <b>after_spawn</b>, <b>before_stop</b>,
      <b>after_stop</b>, <b>before_signal</b>, <b>after_signal</b>,
      <b>extended_stats</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    Define callback functions that hook into the watcher startup/shutdown
      process.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the hook returns <b>False</b> and if the hook is one of
      <b>before_start</b>, <b>before_spawn</b>, <b>after_start</b> or
      <b>after_spawn</b>, the startup will be aborted.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the hook is <b>before_signal</b> and returns <b>False</b>, then the
      corresponding signal will not be sent (except SIGKILL which is always
      sent)
    <div style="height: 1.00em;">&#x00A0;</div>
    Notice that a hook that fails during the stopping process will not abort it.
    <div style="height: 1.00em;">&#x00A0;</div>
    The callback definition can be followed by a boolean flag separated by a
      comma. When the flag is set to <b>true</b>, any error occuring in the hook
      will be ignored. If set to <b>false</b> (the default), the hook will
      return <b>False</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
    More on hooks.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>virtualenv</b></b></dt>
  <dd class="It-tag">When provided, points to the root of a Virtualenv
      directory. The watcher will scan the local <b>site-packages</b> and loads
      its content into the execution environment. Must be used with
      <b>copy_env</b> set to True. Defaults to None.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>virtualenv_py_ver</b></b></dt>
  <dd class="It-tag">Specifies the python version of the virtualenv (e.g
      &quot;3.3&quot;). It's usefull if circus run with another python version
      (e.g &quot;2.7&quot;) The watcher will scan the local <b>site-packages</b>
      of the specified python version and load its content into the execution
      environment. Must be used with <b>virtualenv</b>. Defaults to None.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>respawn</b></b></dt>
  <dd class="It-tag">If set to False, the processes handled by a watcher will
      not be respawned automatically. The processes can be manually respawned
      with the <i>start</i> command. (default: True)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>use_papa</b></b></dt>
  <dd class="It-tag">Set to true to use the papa.</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="socket:NAME_-_as_many_sections_as_you_want"><a class="selflink" href="#socket:NAME_-_as_many_sections_as_you_want">socket:NAME
  - as many sections as you want</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>host</b></b></dt>
  <dd class="It-tag">The host of the socket. Defaults to 'localhost'</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>port</b></b></dt>
  <dd class="It-tag">The port. Defaults to 8080.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>family</b></b></dt>
  <dd class="It-tag">The socket family. Can be 'AF_UNIX', 'AF_INET' or
      'AF_INET6'. Defaults to 'AF_INET'.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>type</b></b></dt>
  <dd class="It-tag">The socket type. Can be 'SOCK_STREAM', 'SOCK_DGRAM',
      'SOCK_RAW', 'SOCK_RDM' or 'SOCK_SEQPACKET'. Defaults to
    'SOCK_STREAM'.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>interface</b></b></dt>
  <dd class="It-tag">When provided a network interface name like 'eth0', binds
      the socket to that particular device so that only packets received from
      that particular interface are processed by the socket. This can be used
      for example to limit which device to bind when binding on IN_ADDR_ANY
      (0.0.0.0) or IN_ADDR_BROADCAST (255.255.255.255). Note that this only
      works for some socket types, particularly AF_INET sockets.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>path</b></b></dt>
  <dd class="It-tag">When provided a path to a file that will be used as a unix
      socket file. If a path is provided, <b>family</b> is forced to AF_UNIX and
      <b>host</b> and <b>port</b> are ignored.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>umask</b></b></dt>
  <dd class="It-tag">When provided, sets the umask that will be used to create
      an AF_UNIX socket. For example, <i>umask=000</i> will produce a socket
      with permission <i>777</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>replace</b></b></dt>
  <dd class="It-tag">When creating Unix sockets ('AF_UNIX'), an existing file
      may indicate a problem so the default is to fail. Specify <i>True</i> to
      simply remove the old file if you are sure that the socket is managed only
      by Circus.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>so_reuseport</b></b></dt>
  <dd class="It-tag">If set to True and SO_REUSEPORT is available on target
      platform, circus will create and bind new SO_REUSEPORT socket(s) for every
      worker it starts which is a user of this socket(s).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>use_papa</b></b></dt>
  <dd class="It-tag">Set to true to use the papa.</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Once a socket is created, the <i>${circus.sockets.NAME}</i> string can be used
  in the command ( <i>cmd</i> or <i>args</i>) of a watcher. Circus will replace
  it by the FD value. The watcher must also have <i>use_sockets</i> set to
  <i>True</i> otherwise the socket will have been closed and you will get errors
  when the watcher tries to use it.
<div style="height: 1.00em;">&#x00A0;</div>
Example:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[watcher:webworker]
cmd = chaussette --fd $(circus.sockets.webapp) chaussette.util.bench_app
use_sockets = True
<div class="Pp"></div>
[socket:webapp]
host = 127.0.0.1
port = 8888
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="plugin:NAME_-_as_many_sections_as_you_want"><a class="selflink" href="#plugin:NAME_-_as_many_sections_as_you_want">plugin:NAME
  - as many sections as you want</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>use</b></b></dt>
  <dd class="It-tag">The fully qualified name that points to the plugin
    class.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>anything else</b></b></dt>
  <dd class="It-tag">Every other key found in the section is passed to the
      plugin constructor in the <b>config</b> mapping.
    <div style="height: 1.00em;">&#x00A0;</div>
    You can use all the watcher options, since a plugin is started like a
      watcher.</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Circus comes with a few pre-shipped plugins but you can also extend them easily
  by developing your own.
<h2 class="Ss" title="Ss" id="env_or_env[:WATCHERS]_-_as_many_sections_as_you_want"><a class="selflink" href="#env_or_env[:WATCHERS]_-_as_many_sections_as_you_want">env
  or env[:WATCHERS] - as many sections as you want</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>anything</b></b></dt>
  <dd class="It-tag">The name of an environment variable to assign value to.
      bash style environment substitutions are supported. for example, append
      /bin to <i>PATH</i> 'PATH = $PATH:/bin'</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Section responsible for delivering environment variable to run processes.
<div style="height: 1.00em;">&#x00A0;</div>
Example:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[watcher:worker1]
cmd = ping 127.0.0.1
<div class="Pp"></div>
[watcher:worker2]
cmd = ping 127.0.0.1
<div class="Pp"></div>
[env]
CAKE = lie
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The variable <i>CAKE</i> will propagated to all watchers defined in config file.
<div style="height: 1.00em;">&#x00A0;</div>
WATCHERS can be a comma separated list of watcher sections to apply this
  environment to. if multiple env sections match a watcher, they will be combine
  in the order they appear in the configuration file. later entries will take
  precedence.
<div style="height: 1.00em;">&#x00A0;</div>
Example:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[watcher:worker1]
cmd = ping 127.0.0.1
<div class="Pp"></div>
[watcher:worker2]
cmd = ping 127.0.0.1
<div class="Pp"></div>
[env:worker1,worker2]
PATH = /bin
<div class="Pp"></div>
[env:worker1]
PATH = $PATH
<div class="Pp"></div>
[env:worker2]
CAKE = lie
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<i>worker1</i> will be run with PATH = $PATH (expanded from the environment
  circusd was run in) <i>worker2</i> will be run with PATH = /bin and CAKE = lie
<div style="height: 1.00em;">&#x00A0;</div>
It's possible to use wildcards as well.
<div style="height: 1.00em;">&#x00A0;</div>
Example:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[watcher:worker1]
cmd = ping 127.0.0.1
<div class="Pp"></div>
[watcher:worker2]
cmd = ping 127.0.0.1
<div class="Pp"></div>
[env:worker*]
PATH = /bin
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Both <i>worker1</i> and <i>worker2</i> will be run with PATH = /bin
<h2 class="Ss" title="Ss" id="Using_environment_variables"><a class="selflink" href="#Using_environment_variables">Using
  environment variables</a></h2>
When writing your configuration file, you can use environment variables defined
  in the <i>env</i> section or in <i>os.environ</i> itself.
<div style="height: 1.00em;">&#x00A0;</div>
You just have to use the <i>circus.env.</i> prefix.
<div style="height: 1.00em;">&#x00A0;</div>
Example:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[watcher:worker1]
cmd = $(circus.env.shell)
<div class="Pp"></div>
[watcher:worker2]
baz = $(circus.env.user)
bar = $(circus.env.yeah)
sup = $(circus.env.oh)
<div class="Pp"></div>
[socket:socket1]
port = $(circus.env.port)
<div class="Pp"></div>
[plugin:plugin1]
use = some.path
parameter1 = $(circus.env.plugin_param)
<div class="Pp"></div>
[env]
yeah = boo
<div class="Pp"></div>
[env:worker2]
oh = ok
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
If a variable is defined in several places, the most specialized value has
  precedence: a variable defined in <i>env:XXX</i> will override a variable
  defined in <i>env</i>, which will override a variable defined in
  <i>os.environ</i>.
<div style="height: 1.00em;">&#x00A0;</div>
environment substitutions can be used in any section of the configuration in any
  section variable.
<h2 class="Ss" title="Ss" id="Formatting_the_commands_and_arguments_with_dynamic_variables"><a class="selflink" href="#Formatting_the_commands_and_arguments_with_dynamic_variables">Formatting
  the commands and arguments with dynamic variables</a></h2>
As you may have seen, it is possible to pass some information that are computed
  dynamically when running the processes. Among other things, you can get the
  worker id (WID) and all the options that are passed to the <b>Process</b>.
  Additionally, it is possible to access the options passed to the
  <b>Watcher</b> which instanciated the process.
<div style="height: 1.00em;">&#x00A0;</div>
<b>NOTE:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The worker id is different from the process
  id. It's a unique value, starting at 1, which is only unique for the
  watcher.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
For instance, if you want to access some variables that are contained in the
  environment, you would need to do it with a setting like this:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
cmd = &quot;make-me-a-coffee --sugar $(CIRCUS.ENV.SUGAR_AMOUNT)&quot;
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
This works with both <i>cmd</i> and <i>args</i>.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Important</b>:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">All variables are prefixed with <i>circus.</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The replacement is case insensitive.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Stream_configuration"><a class="selflink" href="#Stream_configuration">Stream
  configuration</a></h2>
Simple stream class like <i>QueueStream</i> and <i>StdoutStream</i> don't have
  specific attributes but some other stream class may have some:
<h2 class="Ss" title="Ss" id="FileStream"><a class="selflink" href="#FileStream">FileStream</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>filename</b></b></dt>
  <dd class="It-tag">The file path where log will be written.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>time_format</b></b></dt>
  <dd class="It-tag">The strftime format that will be used to prefix each time
      with a timestamp. By default they will be not prefixed.
    <div style="height: 1.00em;">&#x00A0;</div>
    i.e: %Y-%m-%d %H:%M:%S</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>max_bytes</b></b></dt>
  <dd class="It-tag">The max size of the log file before a new file is started.
      If not provided, the file is not rolled over.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>backup_count</b></b></dt>
  <dd class="It-tag">The number of log files that will be kept By default
      backup_count is null.</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<b>NOTE:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">Rollover occurs whenever the current log file
  is nearly max_bytes in length. If backup_count is &gt;= 1, the system will
  successively create new files with the same pathname as the base file, but
  with extensions &quot;.1&quot;, &quot;.2&quot; etc. appended to it. For
  example, with a backup_count of 5 and a base file name of &quot;app.log&quot;,
  you would get &quot;app.log&quot;, &quot;app.log.1&quot;,
  &quot;app.log.2&quot;, ... through to &quot;app.log.5&quot;. The file being
  written to is always &quot;app.log&quot; - when it gets filled up, it is
  closed and renamed to &quot;app.log.1&quot;, and if files
  &quot;app.log.1&quot;, &quot;app.log.2&quot; etc. exist, then they are renamed
  to &quot;app.log.2&quot;, &quot;app.log.3&quot; etc. respectively.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Example:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[watcher:myprogram]
cmd = python -m myapp.server
<div class="Pp"></div>
stdout_stream.class = FileStream
stdout_stream.filename = test.log
stdout_stream.time_format = %Y-%m-%d %H:%M:%S
stdout_stream.max_bytes = 1073741824
stdout_stream.backup_count = 5
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="WatchedFileStream"><a class="selflink" href="#WatchedFileStream">WatchedFileStream</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>filename</b></b></dt>
  <dd class="It-tag">The file path where log will be written.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>time_format</b></b></dt>
  <dd class="It-tag">The strftime format that will be used to prefix each time
      with a timestamp. By default they will be not prefixed.
    <div style="height: 1.00em;">&#x00A0;</div>
    i.e: %Y-%m-%d %H:%M:%S</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<b>NOTE:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">WatchedFileStream relies on an external log
  rotation tool to ensure that log files don't become too big. The output file
  will be monitored and if it is ever deleted or moved by the external log
  rotation tool, then the output file handle will be automatically
  reloaded.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Example:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[watcher:myprogram]
cmd = python -m myapp.server
<div class="Pp"></div>
stdout_stream.class = WatchedFileStream
stdout_stream.filename = test.log
stdout_stream.time_format = %Y-%m-%d %H:%M:%S
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="TimedRotatingFileStream"><a class="selflink" href="#TimedRotatingFileStream">TimedRotatingFileStream</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>filename</b></b></dt>
  <dd class="It-tag">The file path where log will be written.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>backup_count</b></b></dt>
  <dd class="It-tag">The number of log files that will be kept By default
      backup_count is null.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>time_format</b></b></dt>
  <dd class="It-tag">The strftime format that will be used to prefix each time
      with a timestamp. By default they will be not prefixed.
    <div style="height: 1.00em;">&#x00A0;</div>
    i.e: %Y-%m-%d %H:%M:%S</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>rotate_when</b></b></dt>
  <dd class="It-tag">The type of interval. The list of possible values is below.
      Note that they are not case sensitive.
    <table class="tbl">
      <colgroup>
        <col style="width: 22.00ex;"/>
        <col style="width: 21.00ex;"/>
      </colgroup>
      <tr>
        <td colspan="0"></td>
      </tr>
      <tr>
        <td>Value</td>
        <td>Type of interval</td>
      </tr>
      <tr>
        <td colspan="0"></td>
      </tr>
      <tr>
        <td>'S'</td>
        <td>Seconds</td>
      </tr>
      <tr>
        <td colspan="0"></td>
      </tr>
      <tr>
        <td>'M'</td>
        <td>Minutes</td>
      </tr>
      <tr>
        <td colspan="0"></td>
      </tr>
      <tr>
        <td>'H'</td>
        <td>Hours</td>
      </tr>
      <tr>
        <td colspan="0"></td>
      </tr>
      <tr>
        <td>'D'</td>
        <td>Days</td>
      </tr>
      <tr>
        <td colspan="0"></td>
      </tr>
      <tr>
        <td>'W0'-'W6'</td>
        <td>Weekday (0=Monday)</td>
      </tr>
      <tr>
        <td colspan="0"></td>
      </tr>
      <tr>
        <td>'midnight'</td>
        <td>Roll over at midnight</td>
      </tr>
      <tr>
        <td colspan="0"></td>
      </tr>
    </table>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>rotate_interval</b></b></dt>
  <dd class="It-tag">The rollover interval.</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<b>NOTE:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">TimedRotatingFileStream rotates logfiles at
  certain timed intervals. Rollover interval is determined by a combination of
  rotate_when and rotate_interval.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Example:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[watcher:myprogram]
cmd = python -m myapp.server
<div class="Pp"></div>
stdout_stream.class = TimedRotatingFileStream
stdout_stream.filename = test.log
stdout_stream.time_format = %Y-%m-%d %H:%M:%S
stdout_stream.utc = True
stdout_stream.rotate_when = H
stdout_stream.rotate_interval = 1
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="FancyStdoutStream"><a class="selflink" href="#FancyStdoutStream">FancyStdoutStream</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>color</b></b></dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>The name of an ascii color:</b></dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">red</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">green</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">yellow</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">blue</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">magenta</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">cyan</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">white</dd>
</dl>
</div>
<br/>
</div>
<br/>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>time_format</b></b></dt>
  <dd class="It-tag">The strftime format that each line will be prefixed with.
    <div style="height: 1.00em;">&#x00A0;</div>
    Default to: %Y-%m-%d %H:%M:%S</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Example:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[watcher:myprogram]
cmd = python -m myapp.server
stdout_stream.class = FancyStdoutStream
stdout_stream.color = green
stdout_stream.time_format = %Y/%m/%d | %H:%M:%S
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Commands"><a class="selflink" href="#Commands">Commands</a></h2>
At the epicenter of circus lives the command systems. <i>circusctl</i> is just a
  zeromq client, and if needed you can drive programmaticaly the Circus system
  by writing your own zmq client.
<div style="height: 1.00em;">&#x00A0;</div>
All messages are JSON mappings.
<div style="height: 1.00em;">&#x00A0;</div>
For each command below, we provide a usage example with circusctl but also the
  input / output zmq messages.
<h2 class="Ss" title="Ss" id="circus-ctl_commands"><a class="selflink" href="#circus-ctl_commands">circus-ctl
  commands</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>add</b>: <b>commands/add</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>decr</b>: <b>commands/decr</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>dstats</b>: <b>commands/dstats</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>get</b>: <b>commands/get</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>globaloptions</b>: <b>commands/globaloptions</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>incr</b>: <b>commands/incr</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>ipython</b>: <b>commands/ipython</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>list</b>: <b>commands/list</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>listen</b>: <b>commands/listen</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>listsockets</b>: <b>commands/listsockets</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>numprocesses</b>: <b>commands/numprocesses</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>numwatchers</b>: <b>commands/numwatchers</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>options</b>: <b>commands/options</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>quit</b>: <b>commands/quit</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>reload</b>: <b>commands/reload</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>reloadconfig</b>: <b>commands/reloadconfig</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>restart</b>: <b>commands/restart</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>rm</b>: <b>commands/rm</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>set</b>: <b>commands/set</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>signal</b>: <b>commands/signal</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>start</b>: <b>commands/start</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>stats</b>: <b>commands/stats</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>status</b>: <b>commands/status</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>stop</b>: <b>commands/stop</b></dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Add_a_watcher"><a class="selflink" href="#Add_a_watcher">Add
  a watcher</a></h2>
This command add a watcher dynamically to a arbiter.
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;add&quot;,
    &quot;properties&quot;: {
        &quot;cmd&quot;: &quot;/path/to/commandline --option&quot;
        &quot;name&quot;: &quot;nameofwatcher&quot;
        &quot;args&quot;: [],
        &quot;options&quot;: {},
        &quot;start&quot;: false
    }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
A message contains 2 properties:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">cmd: Full command line to execute in a process</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">args: array, arguments passed to the command
    (optional)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">name: name of watcher</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">options: options of a watcher</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">start: start the watcher after the creation</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response return a status &quot;ok&quot;.
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl add [--start] &lt;name&gt; &lt;cmd&gt;
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;name&gt;: name of the watcher to create</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;cmd&gt;: full command line to execute in a process</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">--start: start the watcher immediately</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Decrement_the_number_of_processes_in_a_watcher"><a class="selflink" href="#Decrement_the_number_of_processes_in_a_watcher">Decrement
  the number of processes in a watcher</a></h2>
This comment decrement the number of processes in a watcher by
  &lt;nbprocess&gt;, 1 being the default.
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;decr&quot;,
    &quot;propeties&quot;: {
        &quot;name&quot;: &quot;&lt;watchername&gt;&quot;
        &quot;nb&quot;: &lt;nbprocess&gt;
        &quot;waiting&quot;: False
    }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response return the number of processes in the 'numprocesses` property:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{ &quot;status&quot;: &quot;ok&quot;, &quot;numprocesses&quot;: &lt;n&gt;, &quot;time&quot;, &quot;timestamp&quot; }
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl decr &lt;name&gt; [&lt;nb&gt;] [--waiting]
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;name&gt;: name of the watcher</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;nb&gt;: the number of processes to remove.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Get_circusd_stats"><a class="selflink" href="#Get_circusd_stats">Get
  circusd stats</a></h2>
You can get at any time some statistics about circusd with the dstat command.
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
To get the circusd stats, simply run:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;dstats&quot;
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response returns a mapping the property &quot;infos&quot; containing some
  process informations:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
  &quot;info&quot;: {
    &quot;children&quot;: [],
    &quot;cmdline&quot;: &quot;python&quot;,
    &quot;cpu&quot;: 0.1,
    &quot;ctime&quot;: &quot;0:00.41&quot;,
    &quot;mem&quot;: 0.1,
    &quot;mem_info1&quot;: &quot;3M&quot;,
    &quot;mem_info2&quot;: &quot;2G&quot;,
    &quot;nice&quot;: 0,
    &quot;pid&quot;: 47864,
    &quot;username&quot;: &quot;root&quot;
  },
  &quot;status&quot;: &quot;ok&quot;,
  &quot;time&quot;: 1332265655.897085
}
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Command_Line"><a class="selflink" href="#Command_Line">Command
  Line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl dstats
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Get_the_value_of_specific_watcher_options"><a class="selflink" href="#Get_the_value_of_specific_watcher_options">Get
  the value of specific watcher options</a></h2>
This command can be used to query the current value of one or more watcher
  options.
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;get&quot;,
    &quot;properties&quot;: {
        &quot;keys&quot;: [&quot;key1, &quot;key2&quot;]
        &quot;name&quot;: &quot;nameofwatcher&quot;
    }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
A request message contains two properties:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">keys: list, The option keys for which you want to get the
      values</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">name: name of watcher</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response object has a property <b>options</b> which is a dictionary of
  option names and values.
<div style="height: 1.00em;">&#x00A0;</div>
eg:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;status&quot;: &quot;ok&quot;,
    &quot;options&quot;: {
        &quot;graceful_timeout&quot;: 300,
        &quot;send_hup&quot;: True,
    },
    time': 1332202594.754644
}
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl get &lt;name&gt; &lt;key1&gt; &lt;key2&gt;
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Get_the_arbiter_options"><a class="selflink" href="#Get_the_arbiter_options">Get
  the arbiter options</a></h2>
This command return the arbiter options
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;globaloptions&quot;,
    &quot;properties&quot;: {
        &quot;key1&quot;: &quot;val1&quot;,
        ..
    }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
A message contains 2 properties:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">keys: list, The option keys for which you want to get the
      values</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response return an object with a property &quot;options&quot; containing the
  list of key/value returned by circus.
<div style="height: 1.00em;">&#x00A0;</div>
eg:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;status&quot;: &quot;ok&quot;,
    &quot;options&quot;: {
        &quot;check_delay&quot;: 1,
        ...
    },
    time': 1332202594.754644
}
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl globaloptions
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
Options Keys are:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">endpoint: the controller ZMQ endpoint</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">pubsub_endpoint: the pubsub endpoint</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">check_delay: the delay between two controller points</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">multicast_endpoint: the multicast endpoint for circusd
      cluster auto-discovery</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Increment_the_number_of_processes_in_a_watcher"><a class="selflink" href="#Increment_the_number_of_processes_in_a_watcher">Increment
  the number of processes in a watcher</a></h2>
This comment increment the number of processes in a watcher by
  &lt;nbprocess&gt;, 1 being the default
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;incr&quot;,
    &quot;properties&quot;: {
        &quot;name&quot;: &quot;&lt;watchername&gt;&quot;,
        &quot;nb&quot;: &lt;nbprocess&gt;,
        &quot;waiting&quot;: False
    }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response return the number of processes in the 'numprocesses` property:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{ &quot;status&quot;: &quot;ok&quot;, &quot;numprocesses&quot;: &lt;n&gt;, &quot;time&quot;, &quot;timestamp&quot; }
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl incr &lt;name&gt; [&lt;nb&gt;] [--waiting]
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;name&gt;: name of the watcher.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;nb&gt;: the number of processes to add.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Create_shell_into_circusd_process"><a class="selflink" href="#Create_shell_into_circusd_process">Create
  shell into circusd process</a></h2>
This command is only useful if you have the ipython package installed.
<h2 class="Ss" title="Ss" id="Command_Line"><a class="selflink" href="#Command_Line">Command
  Line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl ipython
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Get_list_of_watchers_or_processes_in_a_watcher"><a class="selflink" href="#Get_list_of_watchers_or_processes_in_a_watcher">Get
  list of watchers or processes in a watcher</a></h2>
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
To get the list of all the watchers:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;list&quot;,
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
To get the list of active processes in a watcher:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;list&quot;,
    &quot;properties&quot;: {
        &quot;name&quot;: &quot;nameofwatcher&quot;,
    }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response return the list asked. the mapping returned can either be
  'watchers' or 'pids' depending the request.
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl list [&lt;name&gt;]
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Subscribe_to_a_watcher_event"><a class="selflink" href="#Subscribe_to_a_watcher_event">Subscribe
  to a watcher event</a></h2>
<h2 class="Ss" title="Ss" id="ZMQ"><a class="selflink" href="#ZMQ">ZMQ</a></h2>
At any moment you can subscribe to a circus event. Circus provides a PUB/SUB
  feed on which any clients can subscribe. The subscriber endpoint URI is set in
  the circus.ini configuration file.
<div style="height: 1.00em;">&#x00A0;</div>
Events are pubsub topics:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><i>watcher.&lt;watchername&gt;.reap</i>: when a process is
      reaped</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><i>watcher.&lt;watchername&gt;.spawn</i>: when a process is
      spawned</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><i>watcher.&lt;watchername&gt;.kill</i>: when a process is
      killed</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><i>watcher.&lt;watchername&gt;.updated</i>: when watcher
      configuration is updated</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><i>watcher.&lt;watchername&gt;.stop</i>: when a watcher is
      stopped</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><i>watcher.&lt;watchername&gt;.start</i>: when a watcher is
      started</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
All events messages are in a json struct.
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
The client has been updated to provide a simple way to listen on the events:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
circusctl listen [&lt;topic&gt;, ...]
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Example_of_result:"><a class="selflink" href="#Example_of_result:">Example
  of result:</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl listen tcp://127.0.0.1:5556
watcher.refuge.spawn: {u'process_id': 6, u'process_pid': 72976,
                       u'time': 1331681080.985104}
watcher.refuge.spawn: {u'process_id': 7, u'process_pid': 72995,
                       u'time': 1331681086.208542}
watcher.refuge.spawn: {u'process_id': 8, u'process_pid': 73014,
                       u'time': 1331681091.427005}
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Get_the_list_of_sockets"><a class="selflink" href="#Get_the_list_of_sockets">Get
  the list of sockets</a></h2>
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
To get the list of sockets:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;listsockets&quot;,
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response return a list of json mappings with keys for fd, name, host and
  port.
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl listsockets
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Get_the_number_of_processes"><a class="selflink" href="#Get_the_number_of_processes">Get
  the number of processes</a></h2>
Get the number of processes in a watcher or in a arbiter
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;numprocesses&quot;,
    &quot;propeties&quot;: {
        &quot;name&quot;: &quot;&lt;watchername&gt;&quot;
    }
<div class="Pp"></div>
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response return the number of processes in the 'numprocesses` property:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{ &quot;status&quot;: &quot;ok&quot;, &quot;numprocesses&quot;: &lt;n&gt;, &quot;time&quot;, &quot;timestamp&quot; }
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
If the property name isn't specified, the sum of all processes managed is
  returned.
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl numprocesses [&lt;name&gt;]
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;name&gt;: name of the watcher</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Get_the_number_of_watchers"><a class="selflink" href="#Get_the_number_of_watchers">Get
  the number of watchers</a></h2>
Get the number of watchers in a arbiter
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;numwatchers&quot;,
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response return the number of watchers in the 'numwatchers` property:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{ &quot;status&quot;: &quot;ok&quot;, &quot;numwatchers&quot;: &lt;n&gt;, &quot;time&quot;, &quot;timestamp&quot; }
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl numwatchers
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Get_the_value_of_all_options_for_a_watcher"><a class="selflink" href="#Get_the_value_of_all_options_for_a_watcher">Get
  the value of all options for a watcher</a></h2>
This command returns all option values for a given watcher.
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;options&quot;,
    &quot;properties&quot;: {
        &quot;name&quot;: &quot;nameofwatcher&quot;,
    }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
A message contains 1 property:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">name: name of watcher</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response object has a property <b>options</b> which is a dictionary of
  option names and values.
<div style="height: 1.00em;">&#x00A0;</div>
eg:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;status&quot;: &quot;ok&quot;,
    &quot;options&quot;: {
        &quot;graceful_timeout&quot;: 300,
        &quot;send_hup&quot;: True,
        ...
    },
    time': 1332202594.754644
}
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl options &lt;name&gt;
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;name&gt;: name of the watcher</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Options Keys are:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">numprocesses: integer, number of processes</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">warmup_delay: integer or number, delay to wait between
      process spawning in seconds</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">working_dir: string, directory where the process will be
      executed</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">uid: string or integer, user ID used to launch the
    process</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">gid: string or integer, group ID used to launch the
    process</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">send_hup: boolean, if TRU the signal HUP will be used on
      reload</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">shell: boolean, will run the command in the shell
      environment if true</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">cmd: string, The command line used to launch the
    process</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">env: object, define the environnement in which the process
      will be launch</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">retry_in: integer or number, time in seconds we wait before
      we retry to launch the process if the maximum number of attempts has been
      reach.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">max_retry: integer, The maximum of retries loops</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">graceful_timeout: integer or number, time we wait before we
      definitely kill a process.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">priority: used to sort watchers in the arbiter</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">singleton: if True, a singleton watcher.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">max_age: time a process can live before being
    restarted</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">max_age_variance: variable additional time to live, avoids
      stampeding herd.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Quit_the_arbiter_immediately"><a class="selflink" href="#Quit_the_arbiter_immediately">Quit
  the arbiter immediately</a></h2>
When the arbiter receive this command, the arbiter exit.
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;quit&quot;,
    &quot;waiting&quot;: False
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response return the status &quot;ok&quot;.
<div style="height: 1.00em;">&#x00A0;</div>
If <b>waiting</b> is False (default), the call will return immediately after
  calling <b>stop_signal</b> on each process.
<div style="height: 1.00em;">&#x00A0;</div>
If <b>waiting</b> is True, the call will return only when the stop process is
  completely ended. Because of the graceful_timeout option, it can take some
  time.
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl quit [--waiting]
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Reload_the_arbiter_or_a_watcher"><a class="selflink" href="#Reload_the_arbiter_or_a_watcher">Reload
  the arbiter or a watcher</a></h2>
This command reloads all the process in a watcher or all watchers. This will
  happen in one of 3 ways:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">If graceful is false, a simple restart occurs.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">If <i>send_hup</i> is true for the watcher, a HUP signal is
      sent to each process.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 2.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>Otherwise:</b></dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">If sequential is false, the arbiter will attempt to spawn
      <i>numprocesses</i> new processes. If the new processes are spawned
      successfully, the result is that all of the old processes are stopped,
      since by default the oldest processes are stopped when the actual number
      of processes for a watcher is greater than <i>numprocesses</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">If sequential is true, the arbiter will restart each
      process in a sequential way (with a <i>warmup_delay</i> pause between each
      step)</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;reload&quot;,
    &quot;properties&quot;: {
        &quot;name&quot;: '&lt;name&gt;&quot;,
        &quot;graceful&quot;: true,
        &quot;sequential&quot;: false,
        &quot;waiting&quot;: False
    }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response return the status &quot;ok&quot;. If the property graceful is set
  to true the processes will be exited gracefully.
<div style="height: 1.00em;">&#x00A0;</div>
If the property name is present, then the reload will be applied to the watcher.
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl reload [&lt;name&gt;] [--terminate] [--waiting]
                            [--sequential]
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;name&gt;: name of the watcher</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">--terminate; quit the node immediately</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Reload_the_configuration_file"><a class="selflink" href="#Reload_the_configuration_file">Reload
  the configuration file</a></h2>
This command reloads the configuration file, so changes in the configuration
  file will be reflected in the configuration of circus.
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;reloadconfig&quot;,
    &quot;waiting&quot;: False
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response return the status &quot;ok&quot;. If the property graceful is set
  to true the processes will be exited gracefully.
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl reloadconfig [--waiting]
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Restart_the_arbiter_or_a_watcher"><a class="selflink" href="#Restart_the_arbiter_or_a_watcher">Restart
  the arbiter or a watcher</a></h2>
This command restart all the process in a watcher or all watchers. This funtion
  simply stop a watcher then restart it.
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;restart&quot;,
    &quot;properties&quot;: {
        &quot;name&quot;: &quot;&lt;name&gt;&quot;,
        &quot;waiting&quot;: False,
        &quot;match&quot;: &quot;[simple|glob|regex]&quot;
    }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response return the status &quot;ok&quot;.
<div style="height: 1.00em;">&#x00A0;</div>
If the property name is present, then the reload will be applied to the watcher.
<div style="height: 1.00em;">&#x00A0;</div>
If <b>waiting</b> is False (default), the call will return immediately after
  calling <i>stop_signal</i> on each process.
<div style="height: 1.00em;">&#x00A0;</div>
If <b>waiting</b> is True, the call will return only when the restart process is
  completely ended. Because of the graceful_timeout option, it can take some
  time.
<div style="height: 1.00em;">&#x00A0;</div>
The <b>match</b> parameter can have the value <b>simple</b> for string compare,
  <b>glob</b> for wildcard matching (default) or <b>regex</b> for regex
  matching.
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl restart [name] [--waiting] [--match=simple|glob|regex]
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;name&gt;: name or pattern of the watcher(s)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;match&gt;: watcher match method</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Remove_a_watcher"><a class="selflink" href="#Remove_a_watcher">Remove
  a watcher</a></h2>
This command removes a watcher dynamically from the arbiter. The watchers are
  gracefully stopped by default.
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;rm&quot;,
    &quot;properties&quot;: {
        &quot;name&quot;: &quot;&lt;nameofwatcher&gt;&quot;,
        &quot;nostop&quot;: False,
        &quot;waiting&quot;: False
    }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response return a status &quot;ok&quot;.
<div style="height: 1.00em;">&#x00A0;</div>
If <b>nostop</b> is True (default: False), the processes for the watcher will
  not be stopped - instead the watcher will just be forgotten by circus and the
  watcher processes will be responsible for stopping themselves. If
  <b>nostop</b> is not specified or is False, then the watcher processes will be
  stopped gracefully.
<div style="height: 1.00em;">&#x00A0;</div>
If <b>waiting</b> is False (default), the call will return immediately after
  starting to remove and stop the corresponding watcher.
<div style="height: 1.00em;">&#x00A0;</div>
If <b>waiting</b> is True, the call will return only when the remove and stop
  process is completely ended. Because of the graceful_timeout option, it can
  take some time.
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl rm &lt;name&gt; [--waiting] [--nostop]
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;name&gt;: name of the watcher to remove</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">nostop: do not stop the watcher processes, just remove the
      watcher</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Set_a_watcher_option"><a class="selflink" href="#Set_a_watcher_option">Set
  a watcher option</a></h2>
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;set&quot;,
    &quot;properties&quot;: {
        &quot;name&quot;: &quot;nameofwatcher&quot;,
        &quot;options&quot;: {
            &quot;key1&quot;: &quot;val1&quot;,
            ..
        }
        &quot;waiting&quot;: False
    }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response return the status &quot;ok&quot;. See the command Options for a
  list of key to set.
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl set &lt;name&gt; &lt;key1&gt; &lt;value1&gt; &lt;key2&gt; &lt;value2&gt; --waiting
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Send_a_signal"><a class="selflink" href="#Send_a_signal">Send
  a signal</a></h2>
This command allows you to send a signal to all processes in a watcher, a
  specific process in a watcher or its children.
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
To send a signal to all the processes for a watcher:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;signal&quot;,
    &quot;property&quot;: {
        &quot;name&quot;: &lt;name&gt;,
        &quot;signum&quot;: &lt;signum&gt;
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
To send a signal to a process:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;signal&quot;,
    &quot;property&quot;: {
        &quot;name&quot;: &lt;name&gt;,
        &quot;pid&quot;: &lt;processid&gt;,
        &quot;signum&quot;: &lt;signum&gt;
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
An optional property &quot;children&quot; can be used to send the signal to all
  the children rather than the process itself:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;signal&quot;,
    &quot;property&quot;: {
        &quot;name&quot;: &lt;name&gt;,
        &quot;pid&quot;: &lt;processid&gt;,
        &quot;signum&quot;: &lt;signum&gt;,
        &quot;children&quot;: True
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
To send a signal to a process child:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;signal&quot;,
    &quot;property&quot;: {
        &quot;name&quot;: &lt;name&gt;,
        &quot;pid&quot;: &lt;processid&gt;,
        &quot;signum&quot;: &lt;signum&gt;,
        &quot;child_pid&quot;: &lt;childpid&gt;,
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
It is also possible to send a signal to all the children of the watcher:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;signal&quot;,
    &quot;property&quot;: {
        &quot;name&quot;: &lt;name&gt;,
        &quot;signum&quot;: &lt;signum&gt;,
        &quot;children&quot;: True
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Lastly, you can send a signal to the process <i>and</i> its children, with the
  <i>recursive</i> option:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;signal&quot;,
    &quot;property&quot;: {
        &quot;name&quot;: &lt;name&gt;,
        &quot;signum&quot;: &lt;signum&gt;,
        &quot;recursive&quot;: True
}
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl signal &lt;name&gt; [&lt;pid&gt;] [--children]
        [--recursive] &lt;signum&gt;
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Options:"><a class="selflink" href="#Options:">Options:</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;name&gt;: the name of the watcher</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;pid&gt;: integer, the process id.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;signum&gt;: the signal number (or name) to send.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;childpid&gt;: the pid of a child, if any</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;children&gt;: boolean, send the signal to all the
      children</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;recursive&gt;: boolean, send the signal to the process
      and its children</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Start_the_arbiter_or_a_watcher"><a class="selflink" href="#Start_the_arbiter_or_a_watcher">Start
  the arbiter or a watcher</a></h2>
This command starts all the processes in a watcher or all watchers.
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;start&quot;,
    &quot;properties&quot;: {
        &quot;name&quot;: '&lt;name&gt;&quot;,
        &quot;waiting&quot;: False,
        &quot;match&quot;: &quot;[simple|glob|regex]&quot;
    }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response return the status &quot;ok&quot;.
<div style="height: 1.00em;">&#x00A0;</div>
If the property name is present, the watcher will be started.
<div style="height: 1.00em;">&#x00A0;</div>
If <b>waiting</b> is False (default), the call will return immediately after
  calling <i>start</i> on each process.
<div style="height: 1.00em;">&#x00A0;</div>
If <b>waiting</b> is True, the call will return only when the start process is
  completely ended. Because of the graceful_timeout option, it can take some
  time.
<div style="height: 1.00em;">&#x00A0;</div>
The <b>match</b> parameter can have the value <b>simple</b> for string compare,
  <b>glob</b> for wildcard matching (default) or <b>regex</b> for regex
  matching.
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl restart [name] [--waiting] [--match=simple|glob|regex]
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;name&gt;: name or pattern of the watcher(s)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;match&gt;: watcher match method</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Get_process_infos"><a class="selflink" href="#Get_process_infos">Get
  process infos</a></h2>
You can get at any time some statistics about your processes with the stat
  command.
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
To get stats for all watchers:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;stats&quot;
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
To get stats for a watcher:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;stats&quot;,
    &quot;properties&quot;: {
        &quot;name&quot;: &lt;name&gt;
    }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
To get stats for a process:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;stats&quot;,
    &quot;properties&quot;: {
        &quot;name&quot;: &lt;name&gt;,
        &quot;process&quot;: &lt;processid&gt;
    }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Stats can be extended with the extended_stats hook but extended stats need to be
  requested:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;stats&quot;,
    &quot;properties&quot;: {
        &quot;name&quot;: &lt;name&gt;,
        &quot;process&quot;: &lt;processid&gt;,
        &quot;extended&quot;: True
    }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response retun an object per process with the property &quot;info&quot;
  containing some process informations:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
  &quot;info&quot;: {
    &quot;children&quot;: [],
    &quot;cmdline&quot;: &quot;python&quot;,
    &quot;cpu&quot;: 0.1,
    &quot;ctime&quot;: &quot;0:00.41&quot;,
    &quot;mem&quot;: 0.1,
    &quot;mem_info1&quot;: &quot;3M&quot;,
    &quot;mem_info2&quot;: &quot;2G&quot;,
    &quot;nice&quot;: 0,
    &quot;pid&quot;: 47864,
    &quot;username&quot;: &quot;root&quot;
  },
  &quot;process&quot;: 5,
  &quot;status&quot;: &quot;ok&quot;,
  &quot;time&quot;: 1332265655.897085
}
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Command_Line"><a class="selflink" href="#Command_Line">Command
  Line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl stats [--extended] [&lt;watchername&gt;] [&lt;processid&gt;]
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Get_the_status_of_a_watcher_or_all_watchers"><a class="selflink" href="#Get_the_status_of_a_watcher_or_all_watchers">Get
  the status of a watcher or all watchers</a></h2>
This command start get the status of a watcher or all watchers.
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;status&quot;,
    &quot;properties&quot;: {
        &quot;name&quot;: '&lt;name&gt;&quot;,
    }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response return the status &quot;active&quot; or &quot;stopped&quot; or the
  status / watchers.
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl status [&lt;name&gt;]
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;name&gt;: name of the watcher</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Example"><a class="selflink" href="#Example">Example</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl status dummy
active
$ circusctl status
dummy: active
dummy2: active
refuge: active
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Stop_watchers"><a class="selflink" href="#Stop_watchers">Stop
  watchers</a></h2>
This command stops a given watcher or all watchers.
<h2 class="Ss" title="Ss" id="ZMQ_Message"><a class="selflink" href="#ZMQ_Message">ZMQ
  Message</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
{
    &quot;command&quot;: &quot;stop&quot;,
    &quot;properties&quot;: {
        &quot;name&quot;: &quot;&lt;name&gt;&quot;,
        &quot;waiting&quot;: False,
        &quot;match&quot;: &quot;[simple|glob|regex]&quot;
    }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The response returns the status &quot;ok&quot;.
<div style="height: 1.00em;">&#x00A0;</div>
If the <b>name</b> property is present, then the stop will be applied to the
  watcher corresponding to that name. Otherwise, all watchers will get stopped.
<div style="height: 1.00em;">&#x00A0;</div>
If <b>waiting</b> is False (default), the call will return immediatly after
  calling <i>stop_signal</i> on each process.
<div style="height: 1.00em;">&#x00A0;</div>
If <b>waiting</b> is True, the call will return only when the stop process is
  completly ended. Because of the graceful_timeout option, it can take some
  time.
<div style="height: 1.00em;">&#x00A0;</div>
The <b>match</b> parameter can have the value <b>simple</b> for string compare,
  <b>glob</b> for wildcard matching (default) or <b>regex</b> for regex
  matching.
<h2 class="Ss" title="Ss" id="Command_line"><a class="selflink" href="#Command_line">Command
  line</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl stop [name] [--waiting] [--match=simple|glob|regex]
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;name&gt;: name or pattern of the watcher(s)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">&lt;match&gt;: watcher match method</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="CLI_tools"><a class="selflink" href="#CLI_tools">CLI
  tools</a></h2>
<h2 class="Ss" title="Ss" id="circus-top"><a class="selflink" href="#circus-top">circus-top</a></h2>
<i>circus-top</i> is a top-like console you can run to watch live your running
  Circus system. It will display the CPU, Memory usage and socket hits if you
  have some.
<div style="height: 1.00em;">&#x00A0;</div>
Example of output:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
-----------------------------------------------------------------------
circusd-stats
 PID                 CPU (%)             MEMORY (%)
14252                 0.8                 0.4
                      0.8 (avg)           0.4 (sum)
<div class="Pp"></div>
dummy
 PID                 CPU (%)             MEMORY (%)
14257                 78.6                0.1
14256                 76.6                0.1
14258                 74.3                0.1
14260                 71.4                0.1
14259                 70.7                0.1
                      74.32 (avg)         0.5 (sum)
<div class="Pp"></div>
----------------------------------------------------------------------
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<i>circus-top</i> is a read-only console. If you want to interact with the
  system, use <i>circusctl</i>.
<h2 class="Ss" title="Ss" id="circusctl"><a class="selflink" href="#circusctl">circusctl</a></h2>
<i>circusctl</i> can be used to run any command listed in commands . For
  example, you can get a list of all the watchers, you can do
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusctl list
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Besides supporting a handful of options you can also specify the endpoint
  <i>circusctl</i> should use using the <b>CIRCUSCTL_ENDPOINT</b> environment
  variable.
<h2 class="Ss" title="Ss" id="The_Web_Console"><a class="selflink" href="#The_Web_Console">The
  Web Console</a></h2>
Circus comes with a Web Console that can be used to manage the system.
<div style="height: 1.00em;">&#x00A0;</div>
The Web Console lets you:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Connect to any running Circus system</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Watch the processes CPU and Memory usage in real-time</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Add or kill processes</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Add new watchers</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<b>NOTE:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">The real-time CPU &amp; Memory usage feature
  uses the stats socket. If you want to activate it, make sure the Circus system
  you'll connect to has the stats enpoint enabled in its configuration:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[circus]
statsd = True
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
By default, this option is not activated.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The web console is its own package, you need to install:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ pip install circus-web
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
To enable the console, add a few options in the Circus ini file:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[circus]
httpd = True
httpd_host = localhost
httpd_port = 8080
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<i>httpd_host</i> and <i>httpd_port</i> are optional, and default to
  <i>localhost</i> and <i>8080</i>.
<div style="height: 1.00em;">&#x00A0;</div>
If you want to run the web app on its own, just run the <b>circushttpd</b>
  script:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circushttpd
Bottle server starting up...
Listening on http://localhost:8080/
Hit Ctrl-C to quit.
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
By default the script will run the Web Console on port 8080, but the --port
  option can be used to change it.
<h2 class="Ss" title="Ss" id="Using_the_console"><a class="selflink" href="#Using_the_console">Using
  the console</a></h2>
Once the script is running, you can open a browser and visit
  <i>http://localhost:8080</i>. You should get this screen: [image]
<div style="height: 1.00em;">&#x00A0;</div>
The Web Console is ready to be connected to a Circus system, given its
  <b>endpoint</b>. By default the endpoint is <i>tcp://127.0.0.1:5555</i>.
<div style="height: 1.00em;">&#x00A0;</div>
Once you hit <i>Connect</i>, the web application will connect to the Circus
  system.
<div style="height: 1.00em;">&#x00A0;</div>
With the Web Console logged in, you should get a list of watchers, and a
  real-time status of the two Circus processes (circusd and circusd-stats).
  <i></i>
<div style="height: 1.00em;">&#x00A0;</div>
You can click on the status of each watcher to toggle it from <b>Active</b>
  (green) to <b>Inactive</b> (red). This change is effective immediatly and let
  you start &amp; stop watchers.
<div style="height: 1.00em;">&#x00A0;</div>
If you click on the watcher name, you will get a web page for that particular
  watcher, with its processes: <i></i>
<div style="height: 1.00em;">&#x00A0;</div>
On this screen, you can add or remove processes, and kill existing ones.
<div style="height: 1.00em;">&#x00A0;</div>
Last but not least, you can add a brand new watcher by clicking on the <i>Add
  Watcher</i> link in the left menu: <i></i>.SS Running behind Nginx
<div style="height: 1.00em;">&#x00A0;</div>
Nginx can act as a proxy and security layer in front of circus-web.
<div style="height: 1.00em;">&#x00A0;</div>
<b>NOTE:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">To receive real-time status updates and graphs
  in circus-web, you must provide a Nginx proxy solution that has websocket
  support</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Nginx_&gt;=_1.3.13"><a class="selflink" href="#Nginx_&gt;=_1.3.13">Nginx
  &gt;= 1.3.13</a></h2>
As of Nginx&gt;=1.3.13 websocket support is built-in, so there is no need to
  combine Nginx with Varnish or HAProxy. An example Nginx config with websocket
  support:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
upstream circusweb_server {
  server 127.0.0.1:8080;
}
<div class="Pp"></div>
server {
 listen   80;
 server_name  _;
<div class="Pp"></div>
 location / {
   proxy_pass http://circusweb_server;
   proxy_http_version 1.1;
   proxy_set_header Upgrade $http_upgrade;
   proxy_set_header Connection &quot;upgrade&quot;;
   proxy_set_header Host $host;
   proxy_set_header X-Real-IP $remote_addr;
   proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
   proxy_set_header X-Forwarded-Proto http;
   proxy_redirect off;
  }
<div class="Pp"></div>
 location ~/media/\*(.png|.jpg|.css|.js|.ico)$ {
   alias /path_to_site-packages/circusweb/media/;
  }
}
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Nginx_&lt;_1.3.13"><a class="selflink" href="#Nginx_&lt;_1.3.13">Nginx
  &lt; 1.3.13</a></h2>
Nginx versions &lt; 1.3.13 do not have websocket support built-in.
<div style="height: 1.00em;">&#x00A0;</div>
To provide websocket support for circus-web when using Nginx &lt; 1.3.13, you
  can combine Nginx with Varnish or HAProxy. That is, Nginx in front of
  circus-web, with Varnish or HAProxy in front of Nginx.
<div style="height: 1.00em;">&#x00A0;</div>
The example below shows the combined Nginix and Varnish configuration required
  to proxy circus-web and provide websocket support.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Nginx configuration:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
upstream circusweb_server {
  server 127.0.0.1:8080;
}
<div class="Pp"></div>
server {
 listen   8001;
 server_name  _;
<div class="Pp"></div>
 location / {
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header Host $http_host;
    proxy_redirect off;
    proxy_pass http://circusweb_server;
  }
<div class="Pp"></div>
 location ~/media/\*(.png|.jpg|.css|.js|.ico)$ {
   alias /path_to_site-packages/circusweb/media/;
  }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
If you want more Nginx configuration options, see
  <i>http://wiki.nginx.org/HttpProxyModule</i>.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Varnish configuration:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
backend default {
    .host = &quot;127.0.0.1&quot;;
    .port = &quot;8001&quot;;
}
<div class="Pp"></div>
backend socket {
    .host = &quot;127.0.0.1&quot;;
    .port = &quot;8080&quot;;
    .connect_timeout = 1s;
    .first_byte_timeout = 2s;
    .between_bytes_timeout = 60s;
}
<div class="Pp"></div>
sub vcl_pipe {
     if (req.http.upgrade) {
         set bereq.http.upgrade = req.http.upgrade;
     }
}
<div class="Pp"></div>
sub vcl_recv {
    if (req.http.Upgrade ~ &quot;(?i)websocket&quot;) {
        set req.backend = socket;
      return (pipe);
    }
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
In the Varnish configuration example above two backends are defined. One serving
  the web console and one serving the socket connections. Web console requests
  are bound to port 8001. The Nginx 'server' directive should be configured to
  listen on port 8001.
<div style="height: 1.00em;">&#x00A0;</div>
Websocket connections are upgraded and piped directly to the circushttpd process
  listening on port 8080 by Varnish. i.e. bypassing the Nginx proxy.
<h2 class="Ss" title="Ss" id="Ubuntu"><a class="selflink" href="#Ubuntu">Ubuntu</a></h2>
Since the version 13.10 ( <i>Saucy</i>), Ubuntu includes Nginx with websocket
  support in its own repositories. For older versions, you can install
  Nginx&gt;=1.3.13 from the official Nginx stable PPA, as so:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
sudo apt-get install python-software-properties
sudo add-apt-repository ppa:nginx/stable
sudo apt-get update
sudo apt-get install nginx
nginx -v
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Password-protect_circushttpd"><a class="selflink" href="#Password-protect_circushttpd">Password-protect
  circushttpd</a></h2>
As explained in the Security page, running <i>circushttpd</i> is pretty unsafe.
  We don't provide any security in Circus itself, but you can protect your
  console at the NGinx level, by using
  <i>http://wiki.nginx.org/HttpAuthBasicModule</i>
<div style="height: 1.00em;">&#x00A0;</div>
Example:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
location / {
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header Host $http_host;
    proxy_set_header X-Forwarded-Host: $http_host;
    proxy_set_header X-Forwarded-Proto: $scheme;
    proxy_redirect off;
    proxy_pass http://127.0.0.1:8080;
    auth_basic            &quot;Restricted&quot;;
    auth_basic_user_file  /path/to/htpasswd;
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The <b>htpasswd</b> file contains users and their passwords, and a password
  prompt will pop when you access the console.
<div style="height: 1.00em;">&#x00A0;</div>
You can use Apache's htpasswd script to edit it, or the Python script they
  provide at: <i>http://trac.edgewall.org/browser/trunk/contrib/htpasswd.py</i>
<div style="height: 1.00em;">&#x00A0;</div>
However, there's no native support for the combined use of HTTP Authentication
  and WebSockets (the server will throw HTTP 401 error codes). A workaround is
  to disable such authentication for the socket.io server.
<div style="height: 1.00em;">&#x00A0;</div>
Example (needs to be added before the previous rule):
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
location /socket.io {
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header Host $http_host;
    proxy_set_header X-Forwarded-Host: $http_host;
    proxy_set_header X-Forwarded-Proto: $scheme;
    proxy_redirect off;
    proxy_pass http://127.0.0.1:8080;
}
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Of course that's just one way to protect your web console, you could use many
  other techniques.
<h2 class="Ss" title="Ss" id="Extending_the_web_console"><a class="selflink" href="#Extending_the_web_console">Extending
  the web console</a></h2>
We picked <i>bottle</i> to build the webconsole, mainly because it's a really
  tiny framework that doesn't do much. By having a look at the code of the web
  console, you'll eventually find out that it's really simple to understand.
<div style="height: 1.00em;">&#x00A0;</div>
Here is how it's split:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The <i>circushttpd.py</i> file contains the
      &quot;views&quot; definitions and some code to handle the socket
      connection (via socketio).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">the <i>controller.py</i> contains a single class which is
      in charge of doing the communication with the circus controller. It allows
      to have a nicer high level API when defining the web server.</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
If you want to add a feature in the web console you can reuse the code that's
  existing. A few tools are at your disposal to ease the process:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">There is a <i>render_template</i> function, which takes the
      named arguments you pass to it and pass them to the template renderer and
      return the resulting HTML. It also passes some additional variables, such
      as the session, the circus version and the client if defined.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">If you want to run commands and doa redirection depending
      the result of it, you can use the <i>run_command</i> function, which takes
      a callable as a first argument, a message in case of success and a
      redirection url.</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The <b>StatsNamespace</b> class is responsible for managing the websocket
  communication on the server side. Its documentation should help you to
  understand what it does.
<h2 class="Ss" title="Ss" id="Working_with_sockets"><a class="selflink" href="#Working_with_sockets">Working
  with sockets</a></h2>
Circus can bind network sockets and manage them as it does for processes.
<div style="height: 1.00em;">&#x00A0;</div>
The main idea is that a child process that's created by Circus to run one of the
  watcher's command can inherit from all the opened file descriptors.
<div style="height: 1.00em;">&#x00A0;</div>
That's how Apache or Unicorn works, and many other tools out there.
<h2 class="Ss" title="Ss" id="Goal"><a class="selflink" href="#Goal">Goal</a></h2>
The goal of having sockets managed by Circus is to be able to manage network
  applications in Circus exactly like other applications.
<div style="height: 1.00em;">&#x00A0;</div>
For example, if you use Circus with <i>Chaussette</i> -- a WGSI server, you can
  get a very fast web server running and manage <i>&quot;Web Workers&quot;</i>
  in Circus as you would do for any other process.
<div style="height: 1.00em;">&#x00A0;</div>
Splitting the socket managment from the network application itself offers a lot
  of opportunities to scale and manage your stack.
<h2 class="Ss" title="Ss" id="Design"><a class="selflink" href="#Design">Design</a></h2>
The gist of the feature is done by binding the socket and start listening to it
  in <b>circusd</b>:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
import socket
<div class="Pp"></div>
sock = socket.socket(FAMILY, TYPE)
sock.bind((HOST, PORT))
sock.listen(BACKLOG)
fd = sock.fileno()
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Circus then keeps track of all the opened fds, and let the processes it runs as
  children have access to them if they want.
<div style="height: 1.00em;">&#x00A0;</div>
If you create a small Python network script that you intend to run in Circus, it
  could look like this:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
import socket
import sys
<div class="Pp"></div>
fd = int(sys.argv[1])   # getting the FD from circus
sock = socket.fromfd(fd, FAMILY, TYPE)
<div class="Pp"></div>
# dealing with one request at a time
while True:
    conn, addr = sock.accept()
    request = conn.recv(1024)
    .. do something ..
    conn.sendall(response)
    conn.close()
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Then Circus could run like this:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[circus]
check_delay = 5
endpoint = tcp://127.0.0.1:5555
pubsub_endpoint = tcp://127.0.0.1:5556
stats_endpoint = tcp://127.0.0.1:5557
<div class="Pp"></div>
[watcher:dummy]
cmd = mycoolscript $(circus.sockets.foo)
use_sockets = True
warmup_delay = 0
numprocesses = 5
<div class="Pp"></div>
[socket:foo]
host = 127.0.0.1
port = 8888
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<i>$(circus.sockets.foo)</i> will be replaced by the FD value once the socket is
  created and bound on the 8888 <i>port</i>.
<div style="height: 1.00em;">&#x00A0;</div>
<b>NOTE:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">Starting at Circus 0.8 there's an alternate
  syntax to avoid some conflicts with some config parsers. You can write:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
((circus.sockets.foo))
</pre>
</div>
<br/>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Real-world_example"><a class="selflink" href="#Real-world_example">Real-world
  example</a></h2>
<i>Chaussette</i> is the perfect Circus companion if you want to run your WSGI
  application.
<div style="height: 1.00em;">&#x00A0;</div>
Once it's installed, running 5 <b>meinheld</b> workers can be done by creating a
  socket and calling the <b>chaussette</b> command in a worker, like this:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[circus]
endpoint = tcp://127.0.0.1:5555
pubsub_endpoint = tcp://127.0.0.1:5556
stats_endpoint = tcp://127.0.0.1:5557
<div class="Pp"></div>
[watcher:web]
cmd = chaussette --fd $(circus.sockets.web) --backend meinheld mycool.app
use_sockets = True
numprocesses = 5
<div class="Pp"></div>
[socket:web]
host = 0.0.0.0
port = 8000
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
We did not publish benchmarks yet, but a Web cluster managed by Circus with a
  Gevent or Meinheld backend is as fast as any pre-fork WSGI server out there.
<h2 class="Ss" title="Ss" id="Using_built-in_plugins"><a class="selflink" href="#Using_built-in_plugins">Using
  built-in plugins</a></h2>
Circus comes with a few built-in plugins. This section presents these plugins
  and their configuration options.
<h2 class="Ss" title="Ss" id="Statsd"><a class="selflink" href="#Statsd">Statsd</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>use</b></b></dt>
  <dd class="It-tag">set to 'circus.plugins.statsd.StatsdEmitter'</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>application_name</b></b></dt>
  <dd class="It-tag">the name used to identify the bucket prefix to emit the
      stats to (it will be prefixed with <b>circus.</b> and suffixed with
      <b>.watcher</b>)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>host</b></b></dt>
  <dd class="It-tag">the host to post the statds data to</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>port</b></b></dt>
  <dd class="It-tag">the port the statsd daemon listens on</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>sample_rate</b></b></dt>
  <dd class="It-tag">if you prefer a different sample rate than 1, you can set
      it here</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="FullStats"><a class="selflink" href="#FullStats">FullStats</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">An extension on the Statsd plugin that is also
  publishing the process stats. As such it has the same configuration options as
  Statsd and the following.
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>use</b></b></dt>
  <dd class="It-tag">set to <b>circus.plugins.statsd.FullStats</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>loop_rate</b></b></dt>
  <dd class="It-tag">the frequency the plugin should ask for the stats in
      seconds. Default: 60.</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="RedisObserver"><a class="selflink" href="#RedisObserver">RedisObserver</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">This services observers a redis process for
  you, publishes the information to statsd and offers to restart the watcher
  when it doesn't react in a given timeout. This plugin requires <i>redis-py</i>
  to run.
<div style="height: 1.00em;">&#x00A0;</div>
It has the same configuration as statsd and adds the following:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>use</b></b></dt>
  <dd class="It-tag">set to
    <b>circus.plugins.redis_observer.RedisObserver</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>loop_rate</b></b></dt>
  <dd class="It-tag">the frequency the plugin should ask for the stats in
      seconds. Default: 60.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>redis_url</b></b></dt>
  <dd class="It-tag">the database to check for as a redis url. Default:
      &quot;redis://localhost:6379/0&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>timeout</b></b></dt>
  <dd class="It-tag">the timeout in seconds the request can take before it is
      considered down. Defaults to 5.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>restart_on_timeout</b></b></dt>
  <dd class="It-tag">the name of the process to restart when the request timed
      out. No restart triggered when not given. Default: None.</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="HttpObserver"><a class="selflink" href="#HttpObserver">HttpObserver</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">This services observers a http process for you
  by pinging a certain website regularly. Similar to the redis observer it
  offers to restart the watcher on an error. It requires <i>tornado</i> to run.
<div style="height: 1.00em;">&#x00A0;</div>
It has the same configuration as statsd and adds the following:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>use</b></b></dt>
  <dd class="It-tag">set to
    <b>circus.plugins.http_observer.HttpObserver</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>loop_rate</b></b></dt>
  <dd class="It-tag">the frequency the plugin should ask for the stats in
      seconds. Default: 60.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>check_url</b></b></dt>
  <dd class="It-tag">the url to check for. Default:
    <b>http://localhost/</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>timeout</b></b></dt>
  <dd class="It-tag">the timeout in seconds the request can take before it is
      considered down. Defaults to 10.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>restart_on_error</b></b></dt>
  <dd class="It-tag">the name of the process to restart when the request timed
      out or returned any other kind of error. No restart triggered when not
      given. Default: None.</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="ResourceWatcher"><a class="selflink" href="#ResourceWatcher">ResourceWatcher</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">This services watches the resources of the
  given process and triggers a restart when they exceed certain limitations too
  often in a row.
<div style="height: 1.00em;">&#x00A0;</div>
It has the same configuration as statsd and adds the following:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>use</b></b></dt>
  <dd class="It-tag">set to
      <b>circus.plugins.resource_watcher.ResourceWatcher</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>loop_rate</b></b></dt>
  <dd class="It-tag">the frequency the plugin should ask for the stats in
      seconds. Default: 60.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>watcher</b></b></dt>
  <dd class="It-tag">the watcher this resource watcher should be looking after.
      (previously called <b>service</b> but <b>service</b> is now
    deprecated)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>max_cpu</b></b></dt>
  <dd class="It-tag">The maximum cpu one process is allowed to consume (in %).
      Default: 90</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>min_cpu</b></b></dt>
  <dd class="It-tag">The minimum cpu one process should consume (in %). Default:
      None (no minimum) You can set the min_cpu to 0 (zero), in this case if one
      process consume exactly 0% cpu, it will trigger an exceeded limit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>max_mem</b></b></dt>
  <dd class="It-tag">The amount of memory one process of this watcher is allowed
      to consume. Default: 90. If no unit is specified, the value is in %.
      Example: 50 If a unit is specified, the value is in bytes. Supported units
      are B, K, M, G, T, P, E, Z, Y. Example: 250M</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>min_mem</b></b></dt>
  <dd class="It-tag">The minimum memory one process of this watcher should
      consume. Default: None (no minimum). If no unit is specified, the value is
      in %. Example: 50 If a unit is specified, the value is in bytes. Supported
      units are B, K, M, G, T, P, E, Z, Y. Example: 250M</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>health_threshold</b></b></dt>
  <dd class="It-tag">The health is the average of cpu and memory (in %) the
      watchers processes are allowed to consume (in %). Default: 75</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>max_count</b></b></dt>
  <dd class="It-tag">How often these limits (each one is counted separately) are
      allowed to be exceeded before a restart will be triggered. Default: 3</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Example:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[circus]
; ...
<div class="Pp"></div>
[watcher:program]
cmd = sleep 120
<div class="Pp"></div>
[plugin:myplugin]
use = circus.plugins.resource_watcher.ResourceWatcher
watcher = program
min_cpu = 10
max_cpu = 70
min_mem = 0
max_mem = 20
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Watchdog"><a class="selflink" href="#Watchdog">Watchdog</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">Plugin that binds an udp socket and wait for
  watchdog messages. For &quot;watchdoged&quot; processes, the watchdog will
  kill them if they don't send a heartbeat in a certain period of time
  materialized by loop_rate * max_count. (circus will automatically restart the
  missing processes in the watcher)
<div style="height: 1.00em;">&#x00A0;</div>
Each monitored process should send udp message at least at the loop_rate. The
  udp message format is a line of text, decoded using <b>msg_regex</b>
  parameter. The heartbeat message MUST at least contain the pid of the process
  sending the message.
<div style="height: 1.00em;">&#x00A0;</div>
The list of monitored watchers are determined by the parameter
  <b>watchers_regex</b> in the configuration.
<div style="height: 1.00em;">&#x00A0;</div>
Configuration parameters:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>use</b></b></dt>
  <dd class="It-tag">set to <b>circus.plugins.watchdog.WatchDog</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>loop_rate</b></b></dt>
  <dd class="It-tag">watchdog loop rate in seconds. At each loop, WatchDog will
      looks for &quot;dead&quot; processes.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>watchers_regex</b></b></dt>
  <dd class="It-tag">regex for matching watcher names that should be monitored
      by the watchdog (default: <b>.*</b> all watchers are monitored)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>msg_regex</b></b></dt>
  <dd class="It-tag">regex for decoding the received heartbeat message in udp
      (default: <b>^(?P&lt;pid&gt;.*);(?P&lt;timestamp&gt;.*)$</b>) the default
      format is a simple text message: <b>pid;timestamp</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>max_count</b></b></dt>
  <dd class="It-tag">max number of passed loop without receiving any heartbeat
      before restarting process (default: 3)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>ip</b></b></dt>
  <dd class="It-tag">ip the watchdog will bind on (default: 127.0.0.1)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>port</b></b></dt>
  <dd class="It-tag">port the watchdog will bind on (default: 1664)</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Flapping"><a class="selflink" href="#Flapping">Flapping</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">When a worker restarts too often, we say that
  it is <i>flapping</i>. This plugin keeps track of worker restarts and stops
  the corresponding watcher in case it is flapping. This plugin may be used to
  automatically stop workers that get constantly restarted because they're not
  working properly.
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>use</b></b></dt>
  <dd class="It-tag">set to <b>circus.plugins.flapping.Flapping</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>attempts</b></b></dt>
  <dd class="It-tag">the number of times a process can restart, within
      <b>window</b> seconds, before we consider it flapping (default: 2)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>window</b></b></dt>
  <dd class="It-tag">the time window in seconds to test for flapping. If the
      process restarts more than <b>attempts</b> times within this time window,
      we consider it a flapping process. (default: 1)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>retry_in</b></b></dt>
  <dd class="It-tag">time in seconds to wait until we try to start again a
      process that has been flapping. (default: 7)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>max_retry</b></b></dt>
  <dd class="It-tag">the number of times we attempt to start a process that has
      been flapping, before we abandon and stop the whole watcher. (default: 5)
      Set to -1 to disable max_retry and retry indefinitely.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>active</b></b></dt>
  <dd class="It-tag">define if the plugin is active or not (default: True). If
      the global flag is set to False, the plugin is not started.</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Options can be overriden in the watcher section using a <b>flapping.</b> prefix.
  For instance, here is how you would configure a specific <b>max_retry</b>
  value for nginx:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[watcher:nginx]
cmd = /path/to/nginx
flapping.max_retry = 2
<div class="Pp"></div>
[watcher:myscript]
cmd = ./my_script.py
<div class="Pp"></div>
; ... other watchers
<div class="Pp"></div>
[plugin:flapping]
use = circus.plugins.flapping.Flapping
max_retry = 5
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="CommandReloader"><a class="selflink" href="#CommandReloader">CommandReloader</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">This plugin will restart watchers when their
  command file is modified. It works by checking the modification time and the
  path of the file pointed by the <b>cmd</b> option every <b>loop_rate</b>
  seconds. This may be useful while developing worker processes or even for hot
  code upgrade in production.
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>use</b></b></dt>
  <dd class="It-tag">set to
      <b>circus.plugins.command_reloader.CommandReloader</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>loop_rate</b></b></dt>
  <dd class="It-tag">the frequency the plugin should check for modification in
      seconds. Default: 1.</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Deployment"><a class="selflink" href="#Deployment">Deployment</a></h2>
Although the Circus daemon can be managed with the circusd command, it's easier
  to have it start on boot. If your system supports Upstart, you can create this
  Upstart script in /etc/init/circus.conf.
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
start on filesystem and net-device-up IFACE=lo
stop on runlevel [016]
<div class="Pp"></div>
respawn
exec /usr/local/bin/circusd /etc/circus/circusd.ini
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
This assumes that circusd.ini is located at /etc/circus/circusd.ini. After
  rebooting, you can control circusd with the service command:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
# service circus start/stop/restart
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
If your system supports systemd, you can create this systemd unit file under
  /etc/systemd/system/circus.service.
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[Unit]
Description=Circus process manager
After=syslog.target network.target nss-lookup.target
<div class="Pp"></div>
[Service]
Type=simple
ExecReload=/usr/bin/circusctl reload
ExecStart=/usr/bin/circusd /etc/circus/circus.ini
Restart=always
RestartSec=5
<div class="Pp"></div>
[Install]
WantedBy=default.target
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
A reboot isn't required if you run the daemon-reload command below:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
# systemctl --system daemon-reload
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Then circus can be managed via:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
# systemctl start/stop/status/reload circus
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Recipes"><a class="selflink" href="#Recipes">Recipes</a></h2>
This section will contain recipes to deploy Circus. Until then you can look at
  Pete's <i>Puppet recipe</i> or at Remy's <i>Chef recipe</i>
<h2 class="Ss" title="Ss" id="Papa_Process_Kernel"><a class="selflink" href="#Papa_Process_Kernel">Papa
  Process Kernel</a></h2>
One problem common to process managers is that you cannot restart the process
  manager without restarting all of the processes it manages. This makes it
  difficult to deploy a new version of Circus or new versions of any of the
  libraries on which it depends.
<div style="height: 1.00em;">&#x00A0;</div>
If you are on a Unix-type system, Circus can use the Papa process kernel. When
  used, Papa will create a long-lived daemon that will serve as the host for any
  processes and sockets you create with it. If circus is shutdown, Papa will
  maintain everything it is hosting.
<h2 class="Ss" title="Ss" id="Setup"><a class="selflink" href="#Setup">Setup</a></h2>
Start by installing the <i>papa</i> and <i>setproctitle</i> modules:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
pip install papa
pip install setproctitle
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The <i>setproctitle</i> module is optional. It will be used if present to rename
  the Papa daemon for <i>top</i> and <i>ps</i> to something like &quot;papa
  daemon from circusd&quot;. If you do not install the <i>setproctitle</i>
  module, that title will be the command line of the process that launched it.
  Very confusing.
<div style="height: 1.00em;">&#x00A0;</div>
Once Papa is installed, add <i>use_papa=true</i> to your critical processes and
  sockets. Generally you want to house all of the processes of your stack in
  Papa, and none of the Circus support processes such as the flapping and stats
  plugins.
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[circus]
loglevel = info
<div class="Pp"></div>
[watcher:nginx]
cmd = /usr/local/nginx/sbin/nginx -p /Users/scottmax/Source/service-framework/Common/conf/nginx -c /Users/scottmax/Source/service-framework/Common/conf/nginx/nginx.conf
warmup_delay = 3
graceful_timeout = 10
max_retry = 5
singleton = true
send_hup = true
stop_signal = QUIT
stdout_stream.class = FileStream
stdout_stream.filename = /var/logs/web-server.log
stdout_stream.max_bytes = 10000000
stdout_stream.backup_count = 10
stderr_stream.class = FileStream
stderr_stream.filename = /var/logs/web-server-error.log
stderr_stream.max_bytes = 1000000
stderr_stream.backup_count = 10
active = true
use_papa = true
<div class="Pp"></div>
[watcher:logger]
cmd = /my_service/env/bin/python logger.py run
working_dir = /my_service
graceful_timeout = 10
singleton = true
stop_signal = INT
stdout_stream.class = FileStream
stdout_stream.filename = /var/logs/logger.log
stdout_stream.max_bytes = 10000000
stdout_stream.backup_count = 10
stderr_stream.class = FileStream
stderr_stream.filename = /var/logs/logger.log
stderr_stream.max_bytes = 1000000
stderr_stream.backup_count = 10
priority = 50
use_papa = true
<div class="Pp"></div>
[watcher:web_app]
cmd = /my_service/env/bin/uwsgi --ini uwsgi-live.ini --socket fd://$(circus.sockets.web) --stats 127.0.0.1:809$(circus.wid)
working_dir = /my_service/web_app
graceful_timeout=10
stop_signal = QUIT
use_sockets = True
stdout_stream.class = FileStream
stdout_stream.filename = /var/logs/web_app.log
stdout_stream.max_bytes = 10000000
stdout_stream.backup_count = 10
stderr_stream.class = FileStream
stderr_stream.filename = /var/logs/web_app.log
stderr_stream.max_bytes = 1000000
stderr_stream.backup_count = 10
hooks.after_spawn = examples.uwsgi_lossless_reload.children_started
hooks.before_signal = examples.uwsgi_lossless_reload.clean_stop
hooks.extended_stats = examples.uwsgi_lossless_reload.extended_stats
priority = 40
use_papa = true
<div class="Pp"></div>
[socket:web]
path = /my_service/sock/uwsgi
use_papa = true
<div class="Pp"></div>
[plugin:flapping]
use = circus.plugins.flapping.Flapping
window = 10
priority = 1000
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<b>NOTE:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">If the Papa processes use any sockets, those
  sockets must also use papa.</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Design_Goal"><a class="selflink" href="#Design_Goal">Design
  Goal</a></h2>
Papa is designed to be very minimalist in features and requirements. It does:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Start and stop sockets</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Provide a key/value store</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Start processes and return stdout, stderr and the exit
    code</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
It does not:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Restart processes</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Provide a way to stop processes</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Provide any information about processes other than whether
      or not they are still running</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Papa requires no third-party libraries so it can run on just the standard Python
  library. It can make use of the <i>setproctitle</i> package but that is only
  used for making the title prettier for <i>ps</i> and <i>top</i> and is not
  essential.
<div style="height: 1.00em;">&#x00A0;</div>
The functionality has been kept to a minimum so that you should never need to
  restart the Papa daemon. As much of the functionality has been pushed to the
  client library as possible. That way you should be able to deploy a new copy
  of Papa for new client features without needing to restart the Papa daemon.
  Papa is meant to be a pillar of stability in a changing sea of 3rd party
  libraries.
<h2 class="Ss" title="Ss" id="Operation"><a class="selflink" href="#Operation">Operation</a></h2>
Most things remain unchanged whether you use Papa or not. You can still start
  and stop processes. You can still get status and stats for processes. The main
  thing that changes is that when you do <i>circusctl quit</i>, all of the Papa
  processes are left running. When you start <b>circusd</b> back up, those
  processes are recovered.
<div style="height: 1.00em;">&#x00A0;</div>
<b>NOTE:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">When processes are recovered,
  <i>before_start</i> and <i>before_spawn</i> hooks are skipped.</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Logging"><a class="selflink" href="#Logging">Logging</a></h2>
While Circus is shut down, Papa will store up to 2M of output per process. Then
  it will start dumping the oldest data. When you restart Circus, this cached
  output will be quickly retrieved and sent to the output streams. Papa requires
  that receipt of output be acknowledged, so you should not lose any output
  during a shutdown.
<div style="height: 1.00em;">&#x00A0;</div>
Not only that, but Papa saves the timestamp of the output. Circus has been
  enhanced to take advantage of timestamp data if present. So if you are writing
  the output to log files or somewhere, your timestamps should all be correct.
<h2 class="Ss" title="Ss" id="Problems"><a class="selflink" href="#Problems">Problems</a></h2>
If you use the <i>incr</i> or <i>decr</i> command to change the process count
  for a watcher, this will be reset to the level specified in the INI file when
  <b>circusd</b> is restarted.
<div style="height: 1.00em;">&#x00A0;</div>
Also, I have experienced problems with the combination of <i>copy_env</i> and
  <i>virtualenv</i>. You may note that the INI sample above circumvents this
  issue with explicit paths.
<h2 class="Ss" title="Ss" id="Telnet_Interface"><a class="selflink" href="#Telnet_Interface">Telnet
  Interface</a></h2>
Papa has a basic command-line interface that you can access through telnet:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
telnet localhost 20202
help
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Circus_for_developers"><a class="selflink" href="#Circus_for_developers">Circus
  for developers</a></h2>
<h2 class="Ss" title="Ss" id="Using_Circus_as_a_library"><a class="selflink" href="#Using_Circus_as_a_library">Using
  Circus as a library</a></h2>
Circus provides high-level classes and functions that will let you manage
  processes in your own applications.
<div style="height: 1.00em;">&#x00A0;</div>
For example, if you want to run four processes forever, you could write:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
from circus import get_arbiter
<div class="Pp"></div>
myprogram = {&quot;cmd&quot;: &quot;python myprogram.py&quot;, &quot;numprocesses&quot;: 4}
<div class="Pp"></div>
arbiter = get_arbiter([myprogram])
try:
    arbiter.start()
finally:
    arbiter.stop()
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
This snippet will run four instances of <i>myprogram</i> and watch them for you,
  restarting them if they die unexpectedly.
<div style="height: 1.00em;">&#x00A0;</div>
To learn more about this, see library
<h2 class="Ss" title="Ss" id="Extending_Circus"><a class="selflink" href="#Extending_Circus">Extending
  Circus</a></h2>
It's easy to extend Circus to create a more complex system, by listening to all
  the <b>circusd</b> events via its pub/sub channel, and driving it via
  commands.
<div style="height: 1.00em;">&#x00A0;</div>
That's how the flapping feature works for instance: it listens to all the
  processes dying, measures how often it happens, and stops the incriminated
  watchers after too many restarts attempts.
<div style="height: 1.00em;">&#x00A0;</div>
Circus comes with a plugin system to help you write such extensions, and a few
  built-in plugins you can reuse. See plugins.
<div style="height: 1.00em;">&#x00A0;</div>
You can also have a more subtile startup and shutdown behavior by using the
  <b>hooks</b> system that will let you run arbitrary code before and after some
  processes are started or stopped. See hooks.
<div style="height: 1.00em;">&#x00A0;</div>
Last but not least, you can also add new commands. See addingcmds.
<h2 class="Ss" title="Ss" id="Developers_Documentation_Index"><a class="selflink" href="#Developers_Documentation_Index">Developers
  Documentation Index</a></h2>
<h2 class="Ss" title="Ss" id="Circus_Library"><a class="selflink" href="#Circus_Library">Circus
  Library</a></h2>
The Circus package is composed of a high-level <b>get_arbiter()</b> function and
  many classes. In most cases, using the high-level function should be enough,
  as it creates everything that is needed for Circus to run.
<div style="height: 1.00em;">&#x00A0;</div>
You can subclass Circus' classes if you need more granularity than what is
  offered by the configuration.
<h2 class="Ss" title="Ss" id="The_get_arbiter_function"><a class="selflink" href="#The_get_arbiter_function">The
  get_arbiter function</a></h2>
<b>get_arbiter()</b> is just a convenience on top of the various circus classes.
  It creates a arbiter (class <b>Arbiter</b>) instance with the provided
  options, which in turn runs a single <b>Watcher</b> with a single
  <b>Process</b>.
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>circus.get_arbiter()</b></dt>
  <dd class="It-tag"></dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Example:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
from circus import get_arbiter
<div class="Pp"></div>
arbiter = get_arbiter([{&quot;cmd&quot;: &quot;myprogram&quot;, &quot;numprocesses&quot;: 3}])
try:
    arbiter.start()
finally:
    arbiter.stop()
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Classes"><a class="selflink" href="#Classes">Classes</a></h2>
Circus provides a series of classes you can use to implement your own process
  manager:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>Process</b>: wraps a running process and provides a few
      helpers on top of it.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>Watcher</b>: run several instances of <b>Process</b>
      against the same command. Manage the death and life of processes.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>Arbiter</b>: manages several <b>Watcher</b>.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>class circus.process.Process(name, wid, cmd, args=None,
    working_dir=None, shell=False, uid=None, gid=None, env=None, rlimits=None,
    executable=None, use_fds=False, watcher=None, spawn=True, pipe_stdout=True,
    pipe_stderr=True, close_child_stdout=False,
    close_child_stderr=False)</b></dt>
  <dd class="It-tag">Wraps a process.
    <div style="height: 1.00em;">&#x00A0;</div>
    Options:</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>wid</b>: the process unique identifier. This value will
      be used to replace the <i>$WID</i> string in the command line if
    present.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>cmd</b>: the command to run. May contain any of the
      variables available that are being passed to this class. They will be
      replaced using the python format syntax.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>args</b>: the arguments for the command to run. Can be a
      list or a string. If <b>args</b> is a string, it's splitted using
      <b>shlex.split()</b>. Defaults to None.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>executable</b>: When executable is given, the first item
      in the args sequence obtained from <b>cmd</b> is still treated by most
      programs as the command name, which can then be different from the actual
      executable name. It becomes the display name for the executing program in
      utilities such as <b>ps</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>working_dir</b>: the working directory to run the
      command in. If not provided, will default to the current working
      directory.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>shell</b>: if <i>True</i>, will run the command in the
      shell environment. <i>False</i> by default. <b>warning: this is a</b>
      <b>security hazard</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>uid</b>: if given, is the user id or name the command
      should run with. The current uid is the default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>gid</b>: if given, is the group id or name the command
      should run with. The current gid is the default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>env</b>: a mapping containing the environment variables
      the command will run with. Optional.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>rlimits</b>: a mapping containing rlimit names and
      values that will be set before the command runs.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>use_fds</b>: if True, will not close the fds in the
      subprocess. Must be be set to True on Windows if stdout or stderr are
      redirected. default: False.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>pipe_stdout</b>: if True, will open a PIPE on stdout.
      default: True.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>pipe_stderr</b>: if True, will open a PIPE on stderr.
      default: True.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>close_child_stdout</b>: If True, redirects the child
      process' stdout to /dev/null after the fork. default: False.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>close_child_stderr</b>: If True, redirects the child
      process' stdout to /dev/null after the fork. default: False.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>age()</b></dt>
  <dd class="It-tag">Return the age of the process in seconds.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>children()</b></dt>
  <dd class="It-tag">Return a list of children pids.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>info()</b></dt>
  <dd class="It-tag">Return process info.
    <div style="height: 1.00em;">&#x00A0;</div>
    The info returned is a mapping with these keys:</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>mem_info1</b>: Resident Set Size Memory in bytes
    (RSS)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>mem_info2</b>: Virtual Memory Size in bytes (VMS).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>cpu</b>: % of cpu usage.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>mem</b>: % of memory usage.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>ctime</b>: process CPU (user + system) time in
    seconds.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>pid</b>: process id.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>username</b>: user name that owns the process.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>nice</b>: process niceness (between -20 and 20)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>cmdline</b>: the command line the process was run
    with.</dd>
</dl>
</div>
<br/>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>is_child(pid)</b></dt>
  <dd class="It-tag">Return True is the given <i>pid</i> is a child of that
      process.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>pid</b></dt>
  <dd class="It-tag">Return the <i>pid</i></dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>send_signal(*args, **kw)</b></dt>
  <dd class="It-tag">Sends a signal <b>sig</b> to the process.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>send_signal_child(*args, **kw)</b></dt>
  <dd class="It-tag">Send signal <i>signum</i> to child <i>pid</i>.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>send_signal_children(*args, **kw)</b></dt>
  <dd class="It-tag">Send signal <i>signum</i> to all children.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>status</b></dt>
  <dd class="It-tag">Return the process status as a constant</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">RUNNING</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">DEAD_OR_ZOMBIE</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">UNEXISTING</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">OTHER</dd>
</dl>
</div>
<br/>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>stderr</b></dt>
  <dd class="It-tag">Return the <i>stdout</i> stream</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>stdout</b></dt>
  <dd class="It-tag">Return the <i>stdout</i> stream</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>stop(*args, **kw)</b></dt>
  <dd class="It-tag">Stop the process and close stdout/stderr
    <div style="height: 1.00em;">&#x00A0;</div>
    If the corresponding process is still here (normally it's already killed by
      the watcher), a SIGTERM is sent, then a SIGKILL after 1 second.
    <div style="height: 1.00em;">&#x00A0;</div>
    The shutdown process (SIGTERM then SIGKILL) is normally taken by the
      watcher. So if the process is still there here, it's a kind of bad
      behavior because the graceful timeout won't be respected here.</dd>
</dl>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Example:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
&gt;&gt;&gt; from circus.process import Process
&gt;&gt;&gt; process = Process('Top', 'top', shell=True)
&gt;&gt;&gt; process.age()
3.0107998847961426
&gt;&gt;&gt; process.info()
'Top: 6812  N/A tarek Zombie N/A N/A N/A N/A N/A'
&gt;&gt;&gt; process.status
1
&gt;&gt;&gt; process.stop()
&gt;&gt;&gt; process.status
2
&gt;&gt;&gt; process.info()
'No such process (stopped?)'
</pre>
</div>
<br/>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>class circus.watcher.Watcher(name, cmd, args=None,
    numprocesses=1, warmup_delay=0.0, working_dir=None, shell=False,
    shell_args=None, uid=None, max_retry=5, gid=None, send_hup=False,
    stop_signal=15, stop_children=False, env=None, graceful_timeout=30.0,
    prereload_fn=None, rlimits=None, executable=None, stdout_stream=None,
    stderr_stream=None, priority=0, loop=None, singleton=False,
    use_sockets=False, copy_env=False, copy_path=False, max_age=0,
    max_age_variance=30, hooks=None, respawn=True, autostart=True,
    on_demand=False, virtualenv=None, close_child_stdout=False,
    close_child_stderr=False, virtualenv_py_ver=None, use_papa=False,
    **options)</b></dt>
  <dd class="It-tag">Class managing a list of processes for a given command.
    <div style="height: 1.00em;">&#x00A0;</div>
    Options:</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>name</b>: name given to the watcher. Used to uniquely
      identify it.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>cmd</b>: the command to run. May contain <i>$WID</i>,
      which will be replaced by <b>wid</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>args</b>: the arguments for the command to run. Can be a
      list or a string. If <b>args</b> is a string, it's splitted using
      <b>shlex.split()</b>. Defaults to None.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>numprocesses</b>: Number of processes to run.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>working_dir</b>: the working directory to run the
      command in. If not provided, will default to the current working
      directory.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>shell</b>: if <i>True</i>, will run the command in the
      shell environment. <i>False</i> by default. <b>warning: this is a</b>
      <b>security hazard</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>uid</b>: if given, is the user id or name the command
      should run with. The current uid is the default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>gid</b>: if given, is the group id or name the command
      should run with. The current gid is the default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>send_hup</b>: if True, a process reload will be done by
      sending the SIGHUP signal. Defaults to False.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>stop_signal</b>: the signal to send when stopping the
      process. Defaults to SIGTERM.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>stop_children</b>: send the <b>stop_signal</b> to the
      children too. Defaults to False.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>env</b>: a mapping containing the environment variables
      the command will run with. Optional.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>rlimits</b>: a mapping containing rlimit names and
      values that will be set before the command runs.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>stdout_stream</b>: a mapping that defines the stream for
      the process stdout. Defaults to None.
    <div style="height: 1.00em;">&#x00A0;</div>
    Optional. When provided, <i>stdout_stream</i> is a mapping containing up to
      three keys:</dd>
</dl>
<div style="margin-left: 2.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>class</b>: the stream class. Defaults to
      <i>circus.stream.FileStream</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>filename</b>: the filename, if using a FileStream</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>max_bytes</b>: maximum file size, after which a new
      output file is opened. defaults to 0 which means no maximum size (only
      applicable with FileStream).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>backup_count</b>: how many backups to retain when
      rotating files according to the max_bytes parameter. defaults to 0 which
      means no backups are made (only applicable with FileStream)</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
This mapping will be used to create a stream callable of the specified class.
  Each entry received by the callable is a mapping containing:
<div style="margin-left: 2.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>pid</b> - the process pid</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>name</b> - the stream name (<i>stderr</i> or
      <i>stdout</i>)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>data</b> - the data</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
This is not supported on Windows.
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>stderr_stream</b>: a mapping that defines the stream for
      the process stderr. Defaults to None.
    <div style="height: 1.00em;">&#x00A0;</div>
    Optional. When provided, <i>stderr_stream</i> is a mapping containing up to
      three keys: - <b>class</b>: the stream class. Defaults to
      <i>circus.stream.FileStream</i> - <b>filename</b>: the filename, if using
      a FileStream - <b>max_bytes</b>: maximum file size, after which a new
      output file is</dd>
</dl>
<div style="margin-left: 2.00ex;">
<div style="margin-left: 3.50ex;">opened. defaults to 0 which means no maximum
  size (only applicable with FileStream)</div>
<br/>
</div>
<br/>
<div style="margin-left: 2.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>backup_count</b>: how many backups to retain when
      rotating files according to the max_bytes parameter. defaults to 0 which
      means no backups are made (only applicable with FileStream).</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
This mapping will be used to create a stream callable of the specified class.
<div style="height: 1.00em;">&#x00A0;</div>
Each entry received by the callable is a mapping containing:
<div style="margin-left: 2.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>pid</b> - the process pid</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>name</b> - the stream name (<i>stderr</i> or
      <i>stdout</i>)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>data</b> - the data</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
This is not supported on Windows.
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>priority</b> -- integer that defines a priority for the
      watcher. When the Arbiter do some operations on all watchers, it will sort
      them with this field, from the bigger number to the smallest. (default:
    0)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>singleton</b> -- If True, this watcher has a single
      process. (default:False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>use_sockets</b> -- If True, the processes will inherit
      the file descriptors, thus can reuse the sockets opened by circusd.
      (default: False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>on_demand</b> -- If True, the processes will be started
      only at the first connection to the socket (default: False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>copy_env</b> -- If True, the environment in which circus
      is running run will be reproduced for the workers. This defaults to True
      on Windows as you cannot run any executable without the <b>SYSTEMROOT</b>
      variable. (default: False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>copy_path</b> -- If True, circusd <i>sys.path</i> is
      sent to the process through <i>PYTHONPATH</i>. You must activate
      <b>copy_env</b> for <b>copy_path</b> to work. (default: False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>max_age</b>: If set after around max_age seconds, the
      process is replaced with a new one. (default: 0, Disabled)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>max_age_variance</b>: The maximum number of seconds that
      can be added to max_age. This extra value is to avoid restarting all
      processes at the same time. A process will live between max_age and
      max_age + max_age_variance seconds.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>hooks</b>: callback functions for hooking into the
      watcher startup and shutdown process. <b>hooks</b> is a dict where each
      key is the hook name and each value is a 2-tuple with the name of the
      callable or the callabled itself and a boolean flag indicating if an
      exception occuring in the hook should not be ignored. Possible values for
      the hook name: <i>before_start</i>, <i>after_start</i>,
      <i>before_spawn</i>, <i>after_spawn</i>, <i>before_stop</i>,
      <i>after_stop</i>., <i>before_signal</i>, <i>after_signal</i> or
      <i>extended_stats</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>options</b> -- extra options for the worker. All options
      found in the configuration file for instance, are passed in this mapping
      -- this can be used by plugins for watcher-specific options.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>respawn</b> -- If set to False, the processes handled by
      a watcher will not be respawned automatically. (default: True)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>virtualenv</b> -- The root directory of a virtualenv. If
      provided, the watcher will load the environment for its execution.
      (default: None)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>close_child_stdout</b>: If True, closes the stdout after
      the fork. default: False.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>close_child_stderr</b>: If True, closes the stderr after
      the fork. default: False.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>use_papa</b>: If True, use the papa process kernel for
      this process. default: False.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>kill_process(*args, **kwargs)</b></dt>
  <dd class="It-tag">Kill process (stop_signal, graceful_timeout then
    SIGKILL)</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>kill_processes(*args, **kwargs)</b></dt>
  <dd class="It-tag">Kill all processes (stop_signal, graceful_timeout then
      SIGKILL)</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>manage_processes(*args, **kwargs)</b></dt>
  <dd class="It-tag">Manage processes.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>notify_event(topic, msg)</b></dt>
  <dd class="It-tag">Publish a message on the event publisher channel</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>reap_and_manage_processes(*args, **kwargs)</b></dt>
  <dd class="It-tag">Reap &amp; manage processes.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>reap_processes(*args, **kw)</b></dt>
  <dd class="It-tag">Reap all the processes for this watcher.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>send_signal_child(*args, **kw)</b></dt>
  <dd class="It-tag">Send signal to a child.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>spawn_process(recovery_wid=None)</b></dt>
  <dd class="It-tag">Spawn process.
    <div style="height: 1.00em;">&#x00A0;</div>
    Return True if ok, False if the watcher must be stopped</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>spawn_processes(*args, **kwargs)</b></dt>
  <dd class="It-tag">Spawn processes.</dd>
</dl>
</div>
<br/>
</div>
<br/>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>class circus.arbiter.Arbiter(watchers, endpoint,
    pubsub_endpoint, check_delay=1.0, prereload_fn=None, context=None,
    loop=None, statsd=False, stats_endpoint=None, statsd_close_outputs=False,
    multicast_endpoint=None, plugins=None, sockets=None, warmup_delay=0,
    httpd=False, httpd_host='localhost', httpd_port=8080,
    httpd_close_outputs=False, debug=False, debug_gc=False, ssh_server=None,
    proc_name='circusd', pidfile=None, loglevel=None, logoutput=None,
    loggerconfig=None, fqdn_prefix=None, umask=None, endpoint_owner=None,
    papa_endpoint=None)</b></dt>
  <dd class="It-tag">Class used to control a list of watchers.
    <div style="height: 1.00em;">&#x00A0;</div>
    Options:</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>watchers</b> -- a list of Watcher objects</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>endpoint</b> -- the controller ZMQ endpoint</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>pubsub_endpoint</b> -- the pubsub endpoint</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>statsd</b> -- If True, a circusd-stats process is run
      (default: False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>stats_endpoint</b> -- the stats endpoint.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>statsd_close_outputs</b> -- if True sends the
      circusd-stats stdout/stderr to /dev/null (default: False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>multicast_endpoint</b> -- the multicast endpoint for
      circusd cluster auto-discovery (default: udp://237.219.251.97:12027)
      Multicast addr should be between 224.0.0.0 to 239.255.255.255 and the same
      for the all cluster.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>check_delay</b> -- the delay between two controller
      points (default: 1 s)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>prereload_fn</b> -- callable that will be executed on
      each reload (default: None)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>context</b> -- if provided, the zmq context to reuse.
      (default: None)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 2.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>loop</b>: if provided, a
    <b>zmq.eventloop.ioloop.IOLoop</b> instance</b></dt>
  <dd class="It-tag">to reuse. (default: None)</dd>
</dl>
</div>
<br/>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>plugins</b> -- a list of plugins. Each item is a mapping
      with:</dd>
</dl>
<div style="margin-left: 2.00ex;">
<div style="margin-left: 3.50ex;">
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>use</b> -- Fully qualified name that points to the
      plugin class</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">every other value is passed to the plugin in the
      <b>config</b> option</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>sockets</b> -- a mapping of sockets. Each key is the
      socket name, and each value a <b>CircusSocket</b> class. (default:
    None)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>warmup_delay</b> -- a delay in seconds between two
      watchers startup. (default: 0)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>httpd</b> -- If True, a circushttpd process is run
      (default: False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>httpd_host</b> -- the circushttpd host (default:
      localhost)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>httpd_port</b> -- the circushttpd port (default:
    8080)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>httpd_close_outputs</b> -- if True, sends circushttpd
      stdout/stderr to /dev/null. (default: False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>debug</b> -- if True, adds a lot of debug info in the
      stdout (default: False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>debug_gc</b> -- if True, does
      gc.set_debug(gc.DEBUG_LEAK) (default: False) to circusd to analyze
      problems (default: False)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>proc_name</b> -- the arbiter process name</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"></dd>
</dl>
<div style="margin-left: 2.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b><b>fqdn_prefix</b> -- a prefix for the unique identifier
    of the circus</b></dt>
  <dd class="It-tag">instance on the cluster.</dd>
</dl>
</div>
<br/>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>endpoint_owner</b> -- unix user to chown the endpoint to
      if using ipc.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>papa_endpoint</b> -- the papa process kernel
    endpoint</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>add_watcher(*args, **kwargs)</b></dt>
  <dd class="It-tag">Adds a watcher.
    <div style="height: 1.00em;">&#x00A0;</div>
    Options:</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>name</b>: name of the watcher to add</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>cmd</b>: command to run.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">all other options defined in the Watcher constructor.</dd>
</dl>
</div>
<br/>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>get_watcher(name)</b></dt>
  <dd class="It-tag">Return the watcher <i>name</i>.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>numprocesses()</b></dt>
  <dd class="It-tag">Return the number of processes running across all
    watchers.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>numwatchers()</b></dt>
  <dd class="It-tag">Return the number of watchers.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>reload(*args, **kwargs)</b></dt>
  <dd class="It-tag">Reloads everything.
    <div style="height: 1.00em;">&#x00A0;</div>
    Run the <b>prereload_fn()</b> callable if any, then gracefuly reload all
      watchers.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>start(*args, **kwargs)</b></dt>
  <dd class="It-tag">Starts all the watchers.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the ioloop has been provided during __init__() call, starts all watchers
      as a standard coroutine
    <div style="height: 1.00em;">&#x00A0;</div>
    If the ioloop hasn't been provided during __init__() call (default), starts
      all watchers and the eventloop (and blocks here). In this mode the method
      MUST NOT yield anything because it's called as a standard method.</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>Parameters</b></dt>
  <dd class="It-tag"><b>cb</b> -- Callback called after all the watchers have
      been started, when the loop hasn't been provided.</dd>
</dl>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Writing_plugins"><a class="selflink" href="#Writing_plugins">Writing
  plugins</a></h2>
Circus comes with a plugin system which lets you interact with <b>circusd</b>.
<div style="height: 1.00em;">&#x00A0;</div>
<b>NOTE:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">We might add circusd-stats support to plugins
  later on.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
A Plugin is composed of two parts:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">a ZMQ subscriber to all events published by
    <b>circusd</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">a ZMQ client to send commands to <b>circusd</b></dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Each plugin is run as a separate process under a custom watcher.
<div style="height: 1.00em;">&#x00A0;</div>
A few examples of some plugins you could create with this system:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">a notification system that sends e-mail alerts when a
      watcher is flapping</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">a logger</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">a tool that adds or removes processes depending on the
    load</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">etc.</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Circus itself comes with a few built-in plugins.
<h2 class="Ss" title="Ss" id="The_CircusPlugin_class"><a class="selflink" href="#The_CircusPlugin_class">The
  CircusPlugin class</a></h2>
Circus provides a base class to help you implement plugins:
  <i>circus.plugins.CircusPlugin</i>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>class circus.plugins.CircusPlugin(endpoint,
    pubsub_endpoint, check_delay, ssh_server=None, **config)</b></dt>
  <dd class="It-tag">Base class to write plugins.
    <div style="height: 1.00em;">&#x00A0;</div>
    Options:</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>context</b> -- the ZMQ context to use</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>endpoint</b> -- the circusd ZMQ endpoint</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>pubsub_endpoint</b> -- the circusd ZMQ pub/sub
    endpoint</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>check_delay</b> -- the configured check delay</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>config</b> -- free config mapping</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>call(command, **props)</b></dt>
  <dd class="It-tag">Sends the command to <b>circusd</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    Options:</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>command</b> -- the command to call</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>props</b> -- keyword arguments to add to the call</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Returns the JSON mapping sent back by <b>circusd</b></div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>cast(command, **props)</b></dt>
  <dd class="It-tag">Fire-and-forget a command to <b>circusd</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    Options:</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>command</b> -- the command to call</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>props</b> -- keyword arguments to add to the call</dd>
</dl>
</div>
<br/>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>handle_init()</b></dt>
  <dd class="It-tag">Called right before a plugin is started - in the thread
      context.</dd>
</dl>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>handle_recv(data)</b></dt>
  <dd class="It-tag">Receives every event published by <b>circusd</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    Options:</dd>
</dl>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>data</b> -- a tuple containing the topic and the
      message.</dd>
</dl>
</div>
<br/>
</div>
<br/>
<div style="margin-left: 7.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>handle_stop()</b></dt>
  <dd class="It-tag">Called right before the plugin is stopped by Circus.</dd>
</dl>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
When initialized by Circus, this class creates its own event loop that receives
  all <b>circusd</b> events and pass them to <b>handle_recv()</b>. The data
  received is a tuple containing the topic and the data itself.
<div style="height: 1.00em;">&#x00A0;</div>
<b>handle_recv()</b> <b>must</b> be implemented by the plugin.
<div style="height: 1.00em;">&#x00A0;</div>
The <b>call()</b> and <b>cast()</b> methods can be used to interact with
  <b>circusd</b> if you are building a Plugin that actively interacts with the
  daemon.
<div style="height: 1.00em;">&#x00A0;</div>
<b>handle_init()</b> and <b>handle_stop()</b> are just convenience methods you
  can use to initialize and clean up your code. <b>handle_init()</b> is called
  within the thread that just started. <b>handle_stop()</b> is called in the
  main thread just before the thread is stopped and joined.
<h2 class="Ss" title="Ss" id="Writing_a_plugin"><a class="selflink" href="#Writing_a_plugin">Writing
  a plugin</a></h2>
Let's write a plugin that logs in a file every event happening in
  <b>circusd</b>. It takes one argument which is the filename.
<div style="height: 1.00em;">&#x00A0;</div>
The plugin may look like this:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
from circus.plugins import CircusPlugin
<div class="Pp"></div>
<div class="Pp"></div>
class Logger(CircusPlugin):
<div class="Pp"></div>
    name = 'logger'
<div class="Pp"></div>
    def __init__(self, *args, **config):
        super(Logger, self).__init__(*args, **config)
        self.filename = config.get('filename')
        self.file = None
<div class="Pp"></div>
    def handle_init(self):
        self.file = open(self.filename, 'a+', buffering=1)
<div class="Pp"></div>
    def handle_stop(self):
        self.file.close()
<div class="Pp"></div>
    def handle_recv(self, data):
        watcher_name, action, msg = self.split_data(data)
        msg_dict = self.load_message(msg)
        self.file.write('%s %s::%r\n' % (action, watcher_name, msg_dict))
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
That's it ! This class can be saved in any package/module, as long as it can be
  seen by Python.
<div style="height: 1.00em;">&#x00A0;</div>
For example, <b>Logger</b> may be found in a <i>plugins</i> module within a
  <i>myproject</i> package.
<h2 class="Ss" title="Ss" id="Async_requests"><a class="selflink" href="#Async_requests">Async
  requests</a></h2>
In case you want to make any asynchronous operations (like a Tornado call or
  using periodicCall) make sure you are using the right loop. The loop you
  always want to be using is self.loop as it gets set up by the base class. The
  default loop often isn't the same and therefore code might not get executed as
  expected.
<h2 class="Ss" title="Ss" id="Trying_a_plugin"><a class="selflink" href="#Trying_a_plugin">Trying
  a plugin</a></h2>
You can run a plugin through the command line with the <b>circus-plugin</b>
  command, by specifying the plugin fully qualified name:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circus-plugin --endpoint tcp://127.0.0.1:5555 --pubsub tcp://127.0.0.1:5556 --config filename:circus-events.log myproject.plugins.Logger
[INFO] Loading the plugin...
[INFO] Endpoint: 'tcp://127.0.0.1:5555'
[INFO] Pub/sub: 'tcp://127.0.0.1:5556'
[INFO] Starting
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Another way to run a plugin is to let Circus handle its initialization. This is
  done by adding a <b>[plugin:NAME]</b> section in the configuration file, where
  <i>NAME</i> is a unique name for your plugin:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[plugin:logger]
use = myproject.plugins.Logger
filename = /var/myproject/circus.log
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<b>use</b> is mandatory and points to the fully qualified name of the plugin.
<div style="height: 1.00em;">&#x00A0;</div>
When Circus starts, it creates a watcher with one process that runs the pointed
  class, and pass any other variable contained in the section to the plugin
  constructor via the <b>config</b> mapping.
<div style="height: 1.00em;">&#x00A0;</div>
You can also programmatically add plugins when you create a
  <b>circus.arbiter.Arbiter</b> class or use <b>circus.get_arbiter()</b>, see
  library.
<h2 class="Ss" title="Ss" id="Performances"><a class="selflink" href="#Performances">Performances</a></h2>
Since every plugin is loaded in its own process, it should not impact the
  overall performances of the system as long as the work done by the plugin is
  not doing too many calls to the <b>circusd</b> process.
<h2 class="Ss" title="Ss" id="Hooks"><a class="selflink" href="#Hooks">Hooks</a></h2>
Circus provides hooks that can be used to trigger actions upon watcher events.
  Available hooks are:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>before_start</b>: called before the watcher is started.
      If the hook returns <b>False</b> the startup is aborted.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>after_start</b>: called after the watcher is started. If
      the hook returns <b>False</b> the watcher is immediately stopped and the
      startup is aborted.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>before_spawn</b>: called before the watcher spawns a new
      process. If the hook returns <b>False</b> the watcher is immediately
      stopped and the startup is aborted.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>after_spawn</b>: called after the watcher spawns a new
      process. If the hook returns <b>False</b> the watcher is immediately
      stopped and the startup is aborted.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>before_stop</b>: called before the watcher is stopped.
      The hook result is ignored.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>after_stop</b>: called after the watcher is stopped. The
      hook result is ignored.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>before_signal</b>: called before a signal is sent to a
      watcher's process. If the hook returns <b>False</b> the signal is not sent
      (except SIGKILL which is always sent)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>after_signal</b>: called after a signal is sent to a
      watcher's process.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>extended_stats</b>: called when stats are requested with
      extended=True. Used for adding process-specific stats to the regular stats
      output.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Example"><a class="selflink" href="#Example">Example</a></h2>
A typical use case is to control that all the conditions are met for a process
  to start. Let's say you have a watcher that runs <i>Redis</i> and a watcher
  that runs a Python script that works with <i>Redis</i>. With Circus you can
  order the startup by using the <b>priority</b> option:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[watcher:queue-worker]
cmd = python -u worker.py
priority = 1
<div class="Pp"></div>
[watcher:redis]
cmd = redis-server
priority = 2
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
With this setup, Circus will start <i>Redis</i> first and then it will start the
  queue worker. But Circus does not really control that <i>Redis</i> is up and
  running. It just starts the process it was asked to start. What we miss here
  is a way to control that <i>Redis</i> is started and fully functional. A
  function that controls this could be:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
import redis
import time
<div class="Pp"></div>
def check_redis(*args, **kw):
    time.sleep(.5)  # give it a chance to start
    r = redis.StrictRedis(host='localhost', port=6379, db=0)
    r.set('foo', 'bar')
    return r.get('foo') == 'bar'
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
This function can be plugged into Circus as an <b>before_start</b> hook:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[watcher:queue-worker]
cmd = python -u worker.py
hooks.before_start = mycoolapp.myplugins.check_redis
priority = 1
<div class="Pp"></div>
[watcher:redis]
cmd = redis-server
priority = 2
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Once Circus has started the <b>redis</b> watcher, it will start the
  <b>queue-worker</b> watcher, since it follows the <b>priority</b> ordering.
  Just before starting the second watcher, it will run the <b>check_redis</b>
  function, and in case it returns <b>False</b> will abort the watcher starting
  process.
<h2 class="Ss" title="Ss" id="Hook_signature"><a class="selflink" href="#Hook_signature">Hook
  signature</a></h2>
A hook must follow this signature:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
def hook(watcher, arbiter, hook_name, **kwargs):
    ...
    # If you don't return True, the hook can change
    # the behavior of circus (depending on the hook)
    return True
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Where <b>watcher</b> is the <b>Watcher</b> class instance, <b>arbiter</b> the
  <b>Arbiter</b> one, <b>hook_name</b> the hook name and <b>kwargs</b> some
  additional optional parameters (depending on the hook type).
<div style="height: 1.00em;">&#x00A0;</div>
The <b>after_spawn</b> hook adds the pid parameters:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
def after_spawn(watcher, arbiter, hook_name, pid, **kwargs):
    ...
    # If you don't return True, circus will kill the process
    return True
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Where <b>pid</b> is the PID of the corresponding process.
<div style="height: 1.00em;">&#x00A0;</div>
Likewise, <b>before_signal</b> and <b>after_signal</b> hooks add pid and signum:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
def before_signal_hook(watcher, arbiter, hook_name, pid, signum, **kwargs):
    ...
    # If you don't return True, circus won't send the signum signal
    # (SIGKILL is always sent)
    return True
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Where <b>pid</b> is the PID of the corresponding process and <b>signum</b> is
  the corresponding signal.
<div style="height: 1.00em;">&#x00A0;</div>
You can ignore those but being able to use the watcher and/or arbiter data and
  methods can be useful in some hooks.
<div style="height: 1.00em;">&#x00A0;</div>
Note that hooks are called with named arguments. So use the hook signature
  without changing argument names.
<div style="height: 1.00em;">&#x00A0;</div>
The <b>extended_stats</b> hook has its own additional parameters in
  <b>kwargs</b>:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
def extended_stats_hook(watcher, arbiter, hook_name, pid, stats, **kwargs):
    ...
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Where <b>pid</b> is the PID of the corresponding process and <b>stats</b> the
  regular stats to be returned. Add your own stats into <b>stats</b>. An example
  is in examples/uwsgi_lossless_reload.py.
<div style="height: 1.00em;">&#x00A0;</div>
As a last example, here is a super hook which can deal with all kind of signals:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
def super_hook(watcher, arbiter, hook_name, **kwargs):
    pid = None
    signum = None
    if hook_name in ('before_signal', 'after_signal'):
        pid = kwargs['pid']
        signum = kwargs['signum']
    ...
    return True
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Hook_events"><a class="selflink" href="#Hook_events">Hook
  events</a></h2>
Everytime a hook is run, its result is notified as an event in Circus.
<div style="height: 1.00em;">&#x00A0;</div>
There are two events related to hooks:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>hook_success</b>: a hook was successfully called. The
      event keys are <b>name</b> the name if the event, and <b>time</b>: the
      date of the events.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>hook_failure</b>: a hook has failed. The event keys are
      <b>name</b> the name if the event, <b>time</b>: the date of the events and
      <b>error</b>: the exception that occurred in the event, if any.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Adding_new_commands"><a class="selflink" href="#Adding_new_commands">Adding
  new commands</a></h2>
We tried to make adding new commands as simple as possible.
<div style="height: 1.00em;">&#x00A0;</div>
You need to do three things:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">1.</dt>
  <dd class="It-tag">create a <b>your_command.py</b> file under
      <b>circus/commands/</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">2.</dt>
  <dd class="It-tag">Implement a single class in there, with predefined
    methods</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">3.</dt>
  <dd class="It-tag">Add the new command in
    <b>circus/commands/__init__.py</b>.</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Let's say we want to add a command which returns the number of watchers
  currently in use, we would do something like this (extensively commented to
  allow you to follow more easily):
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
from circus.commands.base import Command
from circus.exc import ArgumentError, MessageError
class NumWatchers(Command):
    &quot;&quot;&quot;It is a good practice to describe what the class does here.
<div class="Pp"></div>
    Have a look at other commands to see how we are used to format
    this text. It will be automatically included in the documentation,
    so don't be affraid of being exhaustive, that's what it is made
    for.
    &quot;&quot;&quot;
    # all the commands inherit from `circus.commands.base.Command`
<div class="Pp"></div>
    # you need to specify a name so we find back the command somehow
    name = &quot;numwatchers&quot;
<div class="Pp"></div>
    # Set waiting to True or False to define your default behavior
    # - If waiting is True, the command is run synchronously, and the client may get
    #   back results.
    # - If waiting is False, the command is run asynchronously on the server and the client immediately
    #   gets back an 'ok' response
    #
    #   By default, commands are set to waiting = False
    waiting = True
<div class="Pp"></div>
    # options
    options = [('', 'optname', default_value, 'description')]
<div class="Pp"></div>
    properties = ['foo', 'bar']
    # properties list the command arguments that are mandatory. If they are
    # not provided, then an error will be thrown
<div class="Pp"></div>
    def execute(self, arbiter, props):
        # the execute method is the core of the command: put here all the
        # logic of the command and return a dict containing the values you
        # want to return, if any
        return {&quot;numwatchers&quot;: arbiter.numwatchers()}
<div class="Pp"></div>
    def console_msg(self, msg):
        # msg is what is returned by the execute method.
        # this method is used to format the response for a console (it is
        # used for instance by circusctl to print its messages)
        return &quot;a string that will be displayed&quot;
<div class="Pp"></div>
    def message(self, *args, **opts):
        # message handles console input.
        # this method is used to map console arguments to the command
        # options. (its is used for instance when calling the command via
        # circusctl)
        # NotImplementedError will be thrown if the function is missing
        numArgs = 1
        if not len(args) == numArgs:
            raise ArgumentError('Invalid number of arguments.')
        else:
            opts['optname'] = args[0]
        return self.make_message(**opts)
<div class="Pp"></div>
    def validate(self, props):
        # this method is used to validate that the arguments passed to the
        # command are correct. An ArgumentError should be thrown in case
        # there is an error in the passed arguments (for instance if they
        # do not match together.
        # In case there is a problem wrt their content, a MessageError
        # should be thrown. This method can modify the content of the props
        # dict, it will be passed to execute afterwards.
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Use_cases_examples"><a class="selflink" href="#Use_cases_examples">Use
  cases examples</a></h2>
This chapter presents a few use cases, to give you an idea on how to use Circus
  in your environment.
<h2 class="Ss" title="Ss" id="Running_a_WSGI_application"><a class="selflink" href="#Running_a_WSGI_application">Running
  a WSGI application</a></h2>
Running a WSGI application with Circus is quite interesting because you can
  watch &amp; manage your <i>web workers</i> using <i>circus-top</i>,
  <i>circusctl</i> or the Web interface.
<div style="height: 1.00em;">&#x00A0;</div>
This is made possible by using Circus sockets. See whycircussockets.
<div style="height: 1.00em;">&#x00A0;</div>
Let's take an example with a minimal <i>Pyramid</i> application:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
from pyramid.config import Configurator
from pyramid.response import Response
<div class="Pp"></div>
def hello_world(request):
    return Response('Hello %(name)s!' % request.matchdict)
<div class="Pp"></div>
config = Configurator()
config.add_route('hello', '/hello/{name}')
config.add_view(hello_world, route_name='hello')
application = config.make_wsgi_app()
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Save this script into an <b>app.py</b> file, then install those projects:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ pip install Pyramid
$ pip install chaussette
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Next, make sure you can run your Pyramid application using the <b>chaussette</b>
  console script:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ chaussette app.application
Application is &lt;pyramid.router.Router object at 0x10a4d4bd0&gt;
Serving on localhost:8080
Using &lt;class 'chaussette.backend._waitress.Server'&gt; as a backend
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
And check that you can reach it by visiting
  <b>http://localhost:8080/hello/tarek</b>
<div style="height: 1.00em;">&#x00A0;</div>
Now that your application is up and running, let's create a Circus configuration
  file:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[circus]
check_delay = 5
endpoint = tcp://127.0.0.1:5555
pubsub_endpoint = tcp://127.0.0.1:5556
stats_endpoint = tcp://127.0.0.1:5557
<div class="Pp"></div>
[watcher:webworker]
cmd = chaussette --fd $(circus.sockets.webapp) app.application
use_sockets = True
numprocesses = 3
<div class="Pp"></div>
[socket:webapp]
host = 127.0.0.1
port = 8080
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
This file tells Circus to bind a socket on port <i>8080</i> and run
  <i>chaussette</i> workers on that socket -- by passing its fd.
<div style="height: 1.00em;">&#x00A0;</div>
Save it to <i>server.ini</i> and try to run it using <b>circusd</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circusd server.ini
[INFO] Starting master on pid 8971
[INFO] sockets started
[INFO] circusd-stats started
[INFO] webapp started
[INFO] Arbiter now waiting for commands
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Make sure you still get the app on <b>http://localhost:8080/hello/tarek</b>.
<div style="height: 1.00em;">&#x00A0;</div>
Congrats ! you have a WSGI application running 3 workers.
<div style="height: 1.00em;">&#x00A0;</div>
You can run the circushttpd or the cli, and enjoy Circus management.
<h2 class="Ss" title="Ss" id="Running_a_Django_application"><a class="selflink" href="#Running_a_Django_application">Running
  a Django application</a></h2>
Running a Django application is done exactly like running a WSGI application.
  Use the <i>PYTHONPATH</i> to import the directory the project is in, the
  directory that contains the directory that has settings.py in it (with Django
  1.4+ this directory has manage.py in it) :
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[socket:dwebapp]
host = 127.0.0.1
port = 8080
<div class="Pp"></div>
[watcher:dwebworker]
cmd = chaussette --fd $(circus.sockets.dwebapp) dproject.wsgi.application
use_sockets = True
numprocesses = 2
<div class="Pp"></div>
[env:dwebworker]
PYTHONPATH = /path/to/parent-of-dproject
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
If you need to pass the <i>DJANGO_SETTINGS_MODULE</i> for a backend worker for
  example, you can pass that also though the <i>env</i> configation option:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[watcher:dbackend]
cmd = /path/to/script.py
numprocesses=3
<div class="Pp"></div>
[env:dbackend]
PYTHONPATH = /path/to/parent-of-dproject
DJANGO_SETTINGS_MODULE=dproject.settings
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
See <i>http://chaussette.readthedocs.org</i> for more about chaussette.
<h2 class="Ss" title="Ss" id="Design_decisions"><a class="selflink" href="#Design_decisions">Design
  decisions</a></h2>
<h2 class="Ss" title="Ss" id="Overall_architecture"><a class="selflink" href="#Overall_architecture">Overall
  architecture</a></h2>
[image]
<div style="height: 1.00em;">&#x00A0;</div>
Circus is composed of a main process called <b>circusd</b> which takes care of
  running all the processes. Each process managed by Circus is a child process
  of <b>circusd</b>.
<div style="height: 1.00em;">&#x00A0;</div>
Processes are organized in groups called <b>watchers</b>. A <b>watcher</b> is
  basically a command <b>circusd</b> runs on your system, and for each command
  you can configure how many processes you want to run.
<div style="height: 1.00em;">&#x00A0;</div>
The concept of <i>watcher</i> is useful when you want to manage all the
  processes running the same command -- like restart them, etc.
<div style="height: 1.00em;">&#x00A0;</div>
<b>circusd</b> binds two ZeroMQ sockets:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>REQ/REP</b> -- a socket used to control <b>circusd</b>
      using json-based <i>commands</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>PUB/SUB</b> -- a socket where <b>circusd</b> publishes
      events, like when a process is started or stopped.</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<b>NOTE:</b>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">Despite its name, ZeroMQ is not a queue
  management system. Think of it as an inter-process communication (IPC)
  library.</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
Another process called <b>circusd-stats</b> is run by <b>circusd</b> when the
  option is activated. <b>circusd-stats</b>'s job is to publish CPU/Memory usage
  statistics in a dedicated <b>PUB/SUB</b> channel.
<div style="height: 1.00em;">&#x00A0;</div>
This specialized channel is used by <b>circus-top</b> and <b>circus-httpd</b> to
  display a live stream of the activity.
<div style="height: 1.00em;">&#x00A0;</div>
<b>circus-top</b> is a console script that mimics <b>top</b> to display all the
  CPU and Memory usage of the processes managed by Circus.
<div style="height: 1.00em;">&#x00A0;</div>
<b>circus-httpd</b> is the web managment interface that will let you interact
  with Circus. It displays a live stream using web sockets and the
  <b>circusd-stats</b> channel, but also let you interact with <b>circusd</b>
  via its <b>REQ/REP</b> channel.
<div style="height: 1.00em;">&#x00A0;</div>
Last but not least, <b>circusctl</b> is a command-line tool that let you drive
  <b>circusd</b> via its <b>REQ/REP</b> channel.
<div style="height: 1.00em;">&#x00A0;</div>
You can also have plugins that subscribe to <b>circusd</b>'s <b>PUB/SUB</b>
  channel and let you send commands to the <b>REQ/REP</b> channel like
  <b>circusctl</b> would.
<h2 class="Ss" title="Ss" id="Security"><a class="selflink" href="#Security">Security</a></h2>
Circus is built on the top of the ZeroMQ library and comes with no security at
  all in its protocols. However, you can run a Circus system on a server and set
  up an SSH tunnel to access it from another machine.
<div style="height: 1.00em;">&#x00A0;</div>
This section explains what Circus does on your system when you run it, and ends
  up describing how to use an SSH tunnel.
<div style="height: 1.00em;">&#x00A0;</div>
You can also read <i>http://www.zeromq.org/area:faq#toc5</i>
<h2 class="Ss" title="Ss" id="TCP_ports"><a class="selflink" href="#TCP_ports">TCP
  ports</a></h2>
By default, Circus opens the following TCP ports on the local host:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>5555</b> -- the port used to control circus via
      <b>circusctl</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>5556</b> -- the port used for the Publisher/Subscriber
      channel.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>5557</b> -- the port used for the statistics channel --
      if activated.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><b>8080</b> -- the port used by the Web UI -- if
    activated.</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
These ports allow client apps to interact with your Circus system, and depending
  on how your infrastructure is organized, you may want to protect these ports
  via firewalls <b>or</b> configure Circus to run using <b>IPC</b> ports.
<div style="height: 1.00em;">&#x00A0;</div>
Here's an example of running Circus using only IPC entry points:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[circus]
check_delay = 5
endpoint = ipc:///var/circus/endpoint
pubsub_endpoint = ipc:///var/circus/pubsub
stats_endpoint = ipc:///var/circus/stats
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
When Configured using IPC, the commands must be run from the same box, but no
  one can access them from outside, unlike using TCP. The commands must also be
  run as a user that has write access to the ipc socket paths. You can modify
  the owner of the <b>endpoint</b> using the <b>endpoint_owner</b> config
  option. This allows you to run circusd as the root user, but allow non-root
  processes to send commands to <b>circusd</b>. Note that when using
  <b>endpoint_owner</b>, in order to prevent non-root processes from being able
  to start arbitrary processes that run with greater privileges, the add command
  will enforce that new Watchers must run as the <b>endpoint_owner</b> user.
  Watcher definitions in the local config files will not be restricted this way.
<div style="height: 1.00em;">&#x00A0;</div>
Of course, if you activate the Web UI, the <b>8080</b> port will still be open.
<h2 class="Ss" title="Ss" id="circushttpd"><a class="selflink" href="#circushttpd">circushttpd</a></h2>
When you run <b>circushttpd</b> manually, or when you use the <b>httpd</b>
  option in the ini file like this:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[circus]
check_delay = 5
endpoint = ipc:///var/circus/endpoint
pubsub_endpoint = ipc:///var/circus/pubsub
stats_endpoint = ipc:///var/circus/stats
httpd = 1
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
The web application will run on port <i>8080</i> and will let anyone accessing
  the web page manage the <b>circusd</b> daemon.
<div style="height: 1.00em;">&#x00A0;</div>
That includes creating new watchers that can run any command on your system !
<div style="height: 1.00em;">&#x00A0;</div>
<b>Do not make it publicly available</b>
<div style="height: 1.00em;">&#x00A0;</div>
If you want to protect the access to the web panel, you can serve it behind
  Nginx or Apache or any proxy-capable web server, that can take care of the
  security.
<h2 class="Ss" title="Ss" id="User_and_Group_Permissions"><a class="selflink" href="#User_and_Group_Permissions">User
  and Group Permissions</a></h2>
By default, all processes started with Circus will be running with the same user
  and group as <b>circusd</b>. Depending on the privileges the user has on the
  system, you may not have access to all the features Circus provides.
<div style="height: 1.00em;">&#x00A0;</div>
For instance, some statistics features on a running processes require extended
  privileges. Typically, if the CPU usage numbers you get using the <b>stats</b>
  command are <i>N/A</i>, it means your user can't access the proc files. This
  will be the case by default under Mac OS X.
<div style="height: 1.00em;">&#x00A0;</div>
You may run <b>circusd</b> as root to fix this, and set the <b>uid</b> and
  <b>gid</b> values for each watcher to get all the features.
<div style="height: 1.00em;">&#x00A0;</div>
But beware that running <b>circusd</b> as root exposes you to potential
  privilege escalation bugs. While we're doing our best to avoid any bugs,
  running as root and facing a bug that performs unwanted actions on your system
  may be dangerous.
<div style="height: 1.00em;">&#x00A0;</div>
The best way to prevent this is to make sure that the system running Circus is
  completely isolated (like a VM) <b>or</b> to run the whole system under a
  controlled user.
<h2 class="Ss" title="Ss" id="SSH_tunneling"><a class="selflink" href="#SSH_tunneling">SSH
  tunneling</a></h2>
Clients can connect to a <b>circusd</b> instance by creating an SSH tunnel. To
  do so, pass the command line option <b>--ssh</b> followed by
  <b>user@address</b>, where <b>user</b> is the user on the remote server and
  <b>address</b> is the server's address as seen by the client. The SSH protocol
  will require credentials to complete the login.
<div style="height: 1.00em;">&#x00A0;</div>
If <b>circusd</b> as seen by the SSH server is not at the default endpoint
  address <b>localhost:5555</b> then specify the <b>circusd</b> address using
  the option <b>--endpoint</b>
<h2 class="Ss" title="Ss" id="Secured_setup_example"><a class="selflink" href="#Secured_setup_example">Secured
  setup example</a></h2>
Setting up a secured Circus server can be done by:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Running an SSH Server</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Running Apache or Nginx on the <i>80</i> port, and doing a
      reverse-proxy on the <i>8080</i> port.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Blocking the <i>8080</i> port from outside access.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Running all ZMQ Circusd ports using IPC files instead of
      TCP ports, and tunneling all calls via SSH.</dd>
</dl>
</div>
<br/>
[image]
<h2 class="Ss" title="Ss" id="Contributing_to_Circus"><a class="selflink" href="#Contributing_to_Circus">Contributing
  to Circus</a></h2>
Circus has been started at Mozilla but its goal is not to stay only there. We're
  trying to build a tool that's useful for others, and easily extensible.
<div style="height: 1.00em;">&#x00A0;</div>
We really are open to any contributions, in the form of code, documentation,
  discussions, feature proposal etc.
<div style="height: 1.00em;">&#x00A0;</div>
You can start a topic in our mailing list :
  <i>http://tech.groups.yahoo.com/group/circus-dev/</i>
<div style="height: 1.00em;">&#x00A0;</div>
Or add an issue in our <i>bug tracker</i>
<h2 class="Ss" title="Ss" id="Fixing_typos_and_enhancing_the_documentation"><a class="selflink" href="#Fixing_typos_and_enhancing_the_documentation">Fixing
  typos and enhancing the documentation</a></h2>
It's totally possible that your eyes are bleeding while reading this
  half-english half-french documentation, don't hesitate to contribute any
  rephrasing / enhancement on the form in the documentation. You probably don't
  even need to understand how Circus works under the hood to do that.
<h2 class="Ss" title="Ss" id="Adding_new_features"><a class="selflink" href="#Adding_new_features">Adding
  new features</a></h2>
New features are of course very much appreciated. If you have the need and the
  time to work on new features, adding them to Circus shouldn't be that
  complicated. We tried very hard to have a clean and understandable API, hope
  it serves the purpose.
<div style="height: 1.00em;">&#x00A0;</div>
You will need to add documentation and tests alongside with the code of the new
  feature. Otherwise we'll not be able to accept the patch.
<h2 class="Ss" title="Ss" id="How_to_submit_your_changes"><a class="selflink" href="#How_to_submit_your_changes">How
  to submit your changes</a></h2>
We're using git as a DVCS. The best way to propose changes is to create a branch
  on your side (via <i>git checkout -b branchname</i>) and commit your changes
  there. Once you have something ready for prime-time, issue a pull request
  against this branch.
<div style="height: 1.00em;">&#x00A0;</div>
We are following this model to allow to have low coupling between the features
  you are proposing. For instance, we can accept one pull request while still
  being in discussion for another one.
<div style="height: 1.00em;">&#x00A0;</div>
Before proposing your changes, double check that they are not breaking anything!
  You can use the <i>tox</i> command to ensure this, it will run the testsuite
  under the different supported python versions.
<div style="height: 1.00em;">&#x00A0;</div>
Please use : <i>http://issue2pr.herokuapp.com/</i> to reference a commit to an
  existing circus issue, if any.
<h2 class="Ss" title="Ss" id="Avoiding_merge_commits"><a class="selflink" href="#Avoiding_merge_commits">Avoiding
  merge commits</a></h2>
Avoiding merge commits allows to have a clean and readable history. To do so,
  instead of doing &quot;git pull&quot; and letting git handling the merges for
  you, using git pull --rebase will put your changes after the changes that are
  commited in the branch, or when working on master.
<div style="height: 1.00em;">&#x00A0;</div>
That is, for us core developers, it's not possible anymore to use the handy
  github green button on pull requests if developers didn't rebased their work
  themselves or if we wait too much time between the request and the actual
  merge. Instead, the flow looks like this:
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
git remote add name repo-url
git fetch name
git checkout feature-branch
git rebase master
<div class="Pp"></div>
# check that everything is working properly and then merge on master
git checkout master
git merge feature-branch
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Discussing"><a class="selflink" href="#Discussing">Discussing</a></h2>
If you find yourself in need of any help while looking at the code of Circus,
  you can go and find us on irc at <i>#circus-tent on irc.freenode.org</i> (or
  if you don't have any IRC client, use <i>the webchat</i>)
<div style="height: 1.00em;">&#x00A0;</div>
You can also start a thread in our mailing list -
  <i>http://tech.groups.yahoo.com/group/circus-dev</i>
<h2 class="Ss" title="Ss" id="Frequently_Asked_Questions"><a class="selflink" href="#Frequently_Asked_Questions">Frequently
  Asked Questions</a></h2>
Here is a list of frequently asked questions about Circus:
<h2 class="Ss" title="Ss" id="How_does_Circus_stack_compare_to_a_classical_stack?"><a class="selflink" href="#How_does_Circus_stack_compare_to_a_classical_stack?">How
  does Circus stack compare to a classical stack?</a></h2>
In a classical WSGI stack, you have a server like Gunicorn that serves on a port
  or an unix socket and is usually deployed behind a web server like Nginx:
  [image]
<div style="height: 1.00em;">&#x00A0;</div>
Clients call Nginx, which reverse proxies all the calls to Gunicorn.
<div style="height: 1.00em;">&#x00A0;</div>
If you want to make sure the Gunicorn process stays up and running, you have to
  use a program like Supervisord or upstart.
<div style="height: 1.00em;">&#x00A0;</div>
Gunicorn in turn watches for its processes (&quot;workers&quot;).
<div style="height: 1.00em;">&#x00A0;</div>
In other words you are using two levels of process managment. One that you
  manage and control (supervisord), and a second one that you have to manage in
  a different UI, with a different philosophy and less control over what's going
  on (the wsgi server's one)
<div style="height: 1.00em;">&#x00A0;</div>
This is true for Gunicorn and most multi-processes WSGI servers out there I know
  about. uWsgi is a bit different as it offers plethoras of options.
<div style="height: 1.00em;">&#x00A0;</div>
But if you want to add a Redis server in your stack, you <i>will</i> end up with
  managing your stack processes in two different places.
<div style="height: 1.00em;">&#x00A0;</div>
Circus' approach on this is to manage processes <i>and</i> sockets.
<div style="height: 1.00em;">&#x00A0;</div>
A Circus stack can look like this: [image]
<div style="height: 1.00em;">&#x00A0;</div>
So, like Gunicorn, Circus is able to bind a socket that will be proxied by
  Nginx. Circus don't deal with the requests but simply binds the socket. It's
  then up to a web worker process to accept connections on the socket and do the
  work.
<div style="height: 1.00em;">&#x00A0;</div>
It provides equivalent features than Supervisord but will also let you manage
  all processes at the same level, wether they are web workers or Redis or
  whatever. Adding a new web worker is done exactly like adding a new Redis
  process.
<h2 class="Ss" title="Ss" id="Benches"><a class="selflink" href="#Benches">Benches</a></h2>
We did a few benches to compare Circus &amp; Chaussette with Gunicorn. To
  summarize, Circus is not adding any overhead and you can pick up many
  different backends for your web workers.
<div style="height: 1.00em;">&#x00A0;</div>
See:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><i>http://blog.ziade.org/2012/06/28/wgsi-web-servers-bench</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag"><i>http://blog.ziade.org/2012/07/03/wsgi-web-servers-bench-part-2</i></dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="How_to_troubleshoot_Circus?"><a class="selflink" href="#How_to_troubleshoot_Circus?">How
  to troubleshoot Circus?</a></h2>
By default, <i>circusd</i> keeps its logging to <i>stdout</i> rather sparse.
  This lack of output can make things hard to troubleshoot when processes seem
  to be having trouble starting.
<div style="height: 1.00em;">&#x00A0;</div>
To increase the logging <i>circusd</i> provides, try increasing the log level.
  To see the available log levels just use the <i>--help</i> flag.
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
$ circus --log-level debug test.ini
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
One word of warning. If a process is flapping and the debug log level is turned
  on, you will see messages for each start attempt. It might be helpful to
  configure the app that is flapping to use a <i>warmup_delay</i> to slow down
  the messages to a manageable pace.
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[watcher:webapp]
cmd = python -m myapp.wsgi
warmup_delay = 5
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
By default, <i>stdout</i> and <i>stderr</i> are captured by the <i>circusd</i>
  process. If you are testing your config and want to see the output in line
  with the circusd output, you can configure your watcher to use the
  <i>StdoutStream</i> class.
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
[watcher:webapp]
cmd = python -m myapp.wsgi
stdout_stream.class = StdoutStream
stderr_stream.class = StdoutStream
</pre>
</div>
<br/>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
If your application is producing a traceback or error when it is trying to start
  up you should be able to see it in the output.
<h2 class="Ss" title="Ss" id="Changelog_history"><a class="selflink" href="#Changelog_history">Changelog
  history</a></h2>
<h2 class="Ss" title="Ss" id="0.12.1_-_2015-08-05"><a class="selflink" href="#0.12.1_-_2015-08-05">0.12.1
  - 2015-08-05</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fix error when restarting a watcher with an output stream -
      #913</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Minor doc tweaks</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.12_-_2015-06-02"><a class="selflink" href="#0.12_-_2015-06-02">0.12
  - 2015-06-02</a></h2>
This release brings Python 3.4, Tornado 4 and Windows support, among several
  exciting features and fixes.
<div style="height: 1.00em;">&#x00A0;</div>
The Windows support is still experimental, and does not handle streams.
<div style="height: 1.00em;">&#x00A0;</div>
Major changes:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Compatibility with Python 3.4 - #768</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Experimental Windows support - #788</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Compatibility with Tornado 4 - #872</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Revamped Debian packaging - #896 - #903</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Add support for Papa process kernel - #850</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Add globing and regex matching for starting, stopping and
      restarting watchers - #829 - #902</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
More changes:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Optimization of the shutdown - #784 - #842</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Add possibility to specify virtualenv version for the
      watchers - #805</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Add --nostop option to the rmwatcher command - #777</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Add a callback to Arbiter.start - #840</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fix reloading watchers with uppercase letters - #823</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Remove leaking socket in stats daemon - #843</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fix multicast on SunOS - #876</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Close output streams when stopping a watcher - #885</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fix signal sending to grandchildren with --recursive -
    #888</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.11.1_-_2014-05-22"><a class="selflink" href="#0.11.1_-_2014-05-22">0.11.1
  - 2014-05-22</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fixed a regression that broke Circus on 2.6 - #782</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.11_-_2014-05-21"><a class="selflink" href="#0.11_-_2014-05-21">0.11
  - 2014-05-21</a></h2>
This release is not introducing a lot of features, and focused on making Circus
  more robust &amp; stable.
<div style="height: 1.00em;">&#x00A0;</div>
Major changes/fixes:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Make sure we cannot execute two conflictings commands on
      the arbiter simultanously.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">we have 2 new streams class: TimedRotatingFileStream,
      WatchedFileStream</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">we have one new hook: after_spawn hook</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">CircusPlugin is easier to use</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">fix autostart=False watchers during start (regression)</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
More changes:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">circus messages can be routed to syslog now - #748</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">endpoint_owner option added so we can define which user
      owns ipc socket files created by circus.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Started Windows support (just circusctl for now)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">fixed a lot of leaks in the tests</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Allow case sensitive environment variables</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The resource plugin now accepts absolute memory values -
      #609</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Add support to the add command for the 'singleton' option -
      #767</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Allow sending arbitrary signals to child procs via resource
      watcher - #756</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Allow INI/JSON/YAML configuration for logging</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Make sure we're compatible with psutil 2.x <i>and</i>
    3.x</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added more metrics to the statsd provider - #698</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fixed multicast discovery - #731</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Make start, restart and reload more uniform - #673</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Correctly initialize all use groups - #635</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">improved tests stability</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">many, many more things....</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.10_-_2013-11-04"><a class="selflink" href="#0.10_-_2013-11-04">0.10
  - 2013-11-04</a></h2>
Major changes:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Now Python 3.2 &amp; 3.3 compatible - #586</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Moved the core to a fully async model - #569</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Improved documentation - #622</dd>
</dl>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
More changes:
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added stop_signal &amp; stop_children - #594</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Make sure the watchdog plugin closes the sockets -
    #588</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Switched to ZMQ JSON parser</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">IN not supported on all platforms - #573</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Allow global environment substitutions in any config
      section - #560</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Allow dashes in sections names - #546</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Now variables are expanded everywhere in the config -
    #554</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added the CommandReloader plugin</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added before_signal &amp; after_signal hooks</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Allow flapping plugin to retry indefinitely</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Don't respawn procs when the watcher is stopping - #529 -
      #536</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added a unique id for each client message - #517</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">worker ids are now &quot;slots&quot; -</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fixed the graceful shutdown behavior - #515</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Make sure we can add watchers even if the arbiter is not
      started - #503</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Make sure make sure we pop expired process - #510</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Make sure the set command can set several hooks</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Correctly support ipv6 sockets - #507</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Allow custom options for stdout_stream and stderr_stream -
      #495</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added time_format for FileStream - #493</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added new socket config option to bind to a specific
      interface by name</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.9.3_-_2013-09-04"><a class="selflink" href="#0.9.3_-_2013-09-04">0.9.3
  - 2013-09-04</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Make sure we can add watchers even if the arbiter is not
      started</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Make sure we pop expired process</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Make sure the set command can set one or several hooks</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Correctly support ipv6 sockets and improvments of
      CircusSockets</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Give path default value to prevent UnboundLocalError</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added a test for multicast_endpoint existence in Controller
      initialization</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Not converting every string of digits to ints anymore</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Add tests</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">No need for special cases when converting stdout_stream
      options</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">also accept umask as an argument for consistency</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Allow custom options for stdout_stream and
    stderr_stream.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Add new socket config option to bind to a specific
      interface by name</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Add time_format for FileStream + tests</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Update circus.upstart</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.9.2_-_2013-07-17"><a class="selflink" href="#0.9.2_-_2013-07-17">0.9.2
  - 2013-07-17</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">When a PYTHONPATH is defined in a config file, it's loaded
      in sys.path so hooks can be located there - #477, #481</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Use a single argument for add_callback so it works with
      PyZMQ &lt; 13.1.x - see #478</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.9_-_2013-07-16"><a class="selflink" href="#0.9_-_2013-07-16">0.9
  - 2013-07-16</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added [env] sections wildcards</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added global [env] secrtion</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">fixed hidden exception when circus-web is not installed -
      #424</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">make sure incr/decr commands really us the nb option -
    #421</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fix watcher virtualenv site-packages not in PYTHONPATH</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">make sure we dont try to remove more processes than 0 -
      #429</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">updated bootstrap.py - #436</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">fixed multiplatform separator in pythonpath virtualenv
      watcher</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">refactored socket close function</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Ensure env sections are applied to all watchers - #437</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added the reloadconfig command</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added circus.green and removed gevent from the core - #441,
      #452</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">silenced spurious stdout &amp; warnings in the tests -
    #438</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">$(circus.env.*) can be used for all options in the config
      now</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added a before_spawn hook</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">correct the path of circusd in systemd service file -
    #450</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">make sure we can change hooks and set streams via CLI -
      #455</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">improved doc</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added a spawn_count stat in watcher</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added min_cpu and min_mem parameters in ResourceWatcher
      plugin</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added the FQDN information to the arbiter.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.8.1_-_2013-05-28"><a class="selflink" href="#0.8.1_-_2013-05-28">0.8.1
  - 2013-05-28</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">circusd-stats was choking on unix sockets - #415</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">circusd-stats &amp; circushttpd child processes
      stdout/stderr are now left open by default. Python &lt;= 2.7.5 would choke
      in the logging module in case the 2/3 fds were closed - #415</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Now redirecting to /dev/null in the child process instead
      of closing. #417</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.8_-_2013-05-24"><a class="selflink" href="#0.8_-_2013-05-24">0.8
  - 2013-05-24</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Integrated log handlers into zmq io loop.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Make redirector restartable and subsequently more
    robust.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Uses zmq.green.eventloop when gevent is detected</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added support for CIRCUSCTL_ENDPOINT environment variable
      to circusctl - #396</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">util: fix bug in to_uid function - #397</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Remove handler on ioloop error - #398.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Improved test coverage</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Deprecated the 'service' option for the ResourceWatcher
      plugin - #404</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">removed psutil.error usage</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added UDP discovery in circusd - #407</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Now allowing globs at arbitrary directory levels -
    #388</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added the 'statd' configuration option - #408</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Add pidfile, logoutput and loglevel option to circus
      configuration file - #379</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added a tutorial in the docs.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">make sure we're merging all sections when using include -
      #414</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added pipe_stdout, pipe_stderr, close_child_stderr &amp;
      close_child_stdout options to the Process class</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added close_child_stderr &amp; close_child_stdout options
      to the watcher</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.7.1_-_2013-05-02"><a class="selflink" href="#0.7.1_-_2013-05-02">0.7.1
  - 2013-05-02</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fixed the respawn option - #382</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Make sure we use an int for the timeout - #380</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">display the unix sockets as well - #381</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Make sure it works with the latest pyzmq</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">introduced a second syntax for the fd notation</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.7_-_2013-04-08"><a class="selflink" href="#0.7_-_2013-04-08">0.7
  - 2013-04-08</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fix get_arbiter example to use a dict for the watchers
      argument. #304</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Add some troubleshooting documentation #323</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Add python buildout support</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Removed the gevent and the thread redirectors. now using
      the ioloop - fixes #346. Relates #340</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">circus.web is now its own project</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">removed the pyzmq patching</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Allow the watcher to be configured but not started
    #283</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Add an option to load a virtualenv site dir</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added on_demand watchers</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added doc about nginx+websockets #371</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">now properly parsing the options list of each command
    #369</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fixed circusd-stats events handling #372</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">fixed the overflow issue in circus-top #378</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">many more things...</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.6_-_2012-12-18"><a class="selflink" href="#0.6_-_2012-12-18">0.6
  - 2012-12-18</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Patching protocols name for sockets - #248</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Don't autoscale graphs. #240</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">circusctl: add per command help, from docstrings #217</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added workers hooks</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added Debian package - #227</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added Redis, HTTP Observer, Full stats &amp; Resource
      plugins</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Now processes can have titles</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added autocompletion</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added process/watcher age in the webui</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added SSH tunnel support</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Now using pyzmq.green</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added upstart script &amp; Varnish doc</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added environment variables &amp; sections</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added unix sockets support</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added the <i>respawn</i> option to have single-run
    watchers</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Now using tox in the tests</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Allow socket substitution in args</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">New doc theme</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">New rotation options for streams:
    max_bytes/backup_count</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.5.2_-_2012-07-26"><a class="selflink" href="#0.5.2_-_2012-07-26">0.5.2
  - 2012-07-26</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">now patching the thread module from the stdlib to avoid
      some Python bugs - #203</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">better looking circusctl help screen</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">uses pustil get_nice() when available (nice was deprecated)
      - #208</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added max_age support - #221</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">only call listen() on SOCK_STREAM or SOCK_SEQPACKET
    sockets</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">make sure the controller empties the plugins list in
      update_watchers() - #220</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added --log-level and --log-output to circushttpd</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">fix the process killing via the web UI - #219</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">now circus is zc.buildout compatible for scripts.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">cleanup the websocket when the client disconnect -
    #225</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">fixed the default value for the endpoint - #199</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">splitted circushttpd in logical modules</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.5.1_-_2012-07-11"><a class="selflink" href="#0.5.1_-_2012-07-11">0.5.1
  - 2012-07-11</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fixed a bunch of typos in the documentation</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added the debug option</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Package web-requirements.txt properly</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added a errno error code in the messages - fixes #111</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.5_-_2012-07-06"><a class="selflink" href="#0.5_-_2012-07-06">0.5
  - 2012-07-06</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added socket support</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added a listsocket command</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">sockets have stats too !</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">fixed a lot of small bugs</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">removed the wid - now using pid everywhere</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">faster tests</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">changed the variables syntax</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">use pyzmq's ioloop in more places</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">now using iowait for all select() calls</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">incr/decr commands now have an nbprocess parameter</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Add a reproduce_env option to watchers</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Add a new UNEXISTING status to the processes</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added the global <i>httpd</i> option to run circushttpd as
      a watcher</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.4_-_2012-06-12"><a class="selflink" href="#0.4_-_2012-06-12">0.4
  - 2012-06-12</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added a plugin system</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added a &quot;singleton&quot; option for watchers</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fixed circus-top screen flickering</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Removed threads from circus.stats in favor of zmq periodic
      callbacks</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Enhanced the documentation</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Circus client now have a send_message api</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The flapping feature is now a plugin</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Every command line tool have a --version option</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added a statsd plugin (sends the events from circus to
      statsd)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The web UI now uses websockets (via socketio) to get the
      stats</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The web UI now uses sessions for &quot;flash messages&quot;
      in the web ui</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.3.4_-_2012-05-30"><a class="selflink" href="#0.3.4_-_2012-05-30">0.3.4
  - 2012-05-30</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fixed a race condition that prevented the controller to
      cleanly reap finished processes.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Now check_flapping can be controlled in the configuration.
      And activated/deactivated per watcher.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.3.3_-_2012-05-29"><a class="selflink" href="#0.3.3_-_2012-05-29">0.3.3
  - 2012-05-29</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fixed the regression on the uid handling</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.3.2_-_2012-05-24"><a class="selflink" href="#0.3.2_-_2012-05-24">0.3.2
  - 2012-05-24</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">allows optional args property to add_watcher command.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added circushttpd, circus-top and circusd-stats</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">allowing Arbiter.add_watcher() to set all Watcher
    option</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">make sure the redirectors are re-created on restarts</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.3.1_-_2012-04-18"><a class="selflink" href="#0.3.1_-_2012-04-18">0.3.1
  - 2012-04-18</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">fix: make sure watcher' defaults aren't overrided</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added a StdoutStream class.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.3_-_2012-04-18"><a class="selflink" href="#0.3_-_2012-04-18">0.3
  - 2012-04-18</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">added the streaming feature</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">now displaying coverage in the Sphinx doc</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">fixed the way the processes are killed (no more
    SIGQUIT)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">the configuration has been factored out</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">setproctitle support</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.2_-_2012-04-04"><a class="selflink" href="#0.2_-_2012-04-04">0.2
  - 2012-04-04</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Removed the <i>show</i> name. replaced by
    <i>watcher</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added support for setting process <b>rlimit</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Added support for include dirs in the config file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fixed a couple of leaking file descriptors.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fixed a core dump in the flapping</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Doc improvments</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Make sure circusd errors properly when another circusd is
      running on the same socket.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">get_arbiter now accepts several watchers.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fixed the cmd vs args vs executable in the process
    init.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Fixed --start on circusctl add</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="0.1_-_2012-03-20"><a class="selflink" href="#0.1_-_2012-03-20">0.1
  - 2012-03-20</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">initial release</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="man_pages"><a class="selflink" href="#man_pages">man
  pages</a></h2>
<h2 class="Ss" title="Ss" id="circusd_man_page"><a class="selflink" href="#circusd_man_page">circusd
  man page</a></h2>
<h2 class="Ss" title="Ss" id="Synopsis"><a class="selflink" href="#Synopsis">Synopsis</a></h2>
circusd [options] [config]
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
circusd is the main process of the Circus architecture. It takes care of running
  all the processes. Each process managed by Circus is a child process of
  <b>circusd</b>.
<h2 class="Ss" title="Ss" id="Arguments"><a class="selflink" href="#Arguments">Arguments</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>config</b></dt>
  <dd class="It-tag">configuration file</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h, --help</b></dt>
  <dd class="It-tag">Show the help message and exit</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--log-level <i>LEVEL</i></b></dt>
  <dd class="It-tag">Specify the log level. <i>LEVEL</i> can be <i>info</i>,
      <i>debug</i>, <i>critical</i>, <i>warning</i> or <i>error</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--log-output <i>LOGOUTPUT</i></b></dt>
  <dd class="It-tag">The location where the logs will be written. The default
      behavior is to write to stdout (you can force it by passing '-' to this
      option). Takes a filename otherwise.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--logger-config <i>LOGGERCONFIG</i></b></dt>
  <dd class="It-tag">The location where a standard Python logger configuration
      INI, JSON or YAML file can be found. This can be used to override the
      default logging configuration for the arbiter.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--daemon</b></dt>
  <dd class="It-tag">Start circusd in the background.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--pidfile <i>PIDFILE</i></b></dt>
  <dd class="It-tag">The location of the PID file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--version</b></dt>
  <dd class="It-tag">Displays Circus version and exits.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="See_also"><a class="selflink" href="#See_also">See
  also</a></h2>
<i>circus</i> (1), <i>circusctl</i> (1), <i>circusd-stats</i> (1),
  <i>circus-plugin</i> (1), <i>circus-top</i> (1).
<div style="height: 1.00em;">&#x00A0;</div>
Full Documentation is available at <i>http://circus.readthedocs.org</i>
<h2 class="Ss" title="Ss" id="circusctl_man_page"><a class="selflink" href="#circusctl_man_page">circusctl
  man page</a></h2>
<h2 class="Ss" title="Ss" id="Synopsis"><a class="selflink" href="#Synopsis">Synopsis</a></h2>
circusctl [options] command [args]
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
circusctl is front end to control the Circus daemon. It is designed to help the
  administrator control the functionning of the Circud <b>circusd</b> daemon.
<h2 class="Ss" title="Ss" id="Commands"><a class="selflink" href="#Commands">Commands</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>add</b></dt>
  <dd class="It-tag">Add a watcher</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>decr</b></dt>
  <dd class="It-tag">Decrement the number of processes in a watcher</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>dstats</b></dt>
  <dd class="It-tag">Get circusd stats</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>get</b></dt>
  <dd class="It-tag">Get the value of specific watcher options</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>globaloptions</b></dt>
  <dd class="It-tag">Get the arbiter options</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>incr</b></dt>
  <dd class="It-tag">Increment the number of processes in a watcher</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ipython</b></dt>
  <dd class="It-tag">Create shell into circusd process</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>list</b></dt>
  <dd class="It-tag">Get list of watchers or processes in a watcher</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>listen</b></dt>
  <dd class="It-tag">Subscribe to a watcher event</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>listsockets</b></dt>
  <dd class="It-tag">Get the list of sockets</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>numprocesses</b></dt>
  <dd class="It-tag">Get the number of processes</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>numwatchers</b></dt>
  <dd class="It-tag">Get the number of watchers</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>options</b></dt>
  <dd class="It-tag">Get the value of all options for a watcher</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>quit</b></dt>
  <dd class="It-tag">Quit the arbiter immediately</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>reload</b></dt>
  <dd class="It-tag">Reload the arbiter or a watcher</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>reloadconfig</b></dt>
  <dd class="It-tag">Reload the configuration file</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>restart</b></dt>
  <dd class="It-tag">Restart the arbiter or a watcher</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>rm</b></dt>
  <dd class="It-tag">Remove a watcher</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>set</b></dt>
  <dd class="It-tag">Set a watcher option</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>signal</b></dt>
  <dd class="It-tag">Send a signal</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>start</b></dt>
  <dd class="It-tag">Start the arbiter or a watcher</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>stats</b></dt>
  <dd class="It-tag">Get process infos</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>status</b></dt>
  <dd class="It-tag">Get the status of a watcher or all watchers</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>stop</b></dt>
  <dd class="It-tag">Stop watchers</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--endpoint <i>ENDPOINT</i></b></dt>
  <dd class="It-tag">connection endpoint</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h, --help</b></dt>
  <dd class="It-tag">Show the help message and exit</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--json</b></dt>
  <dd class="It-tag">output to JSON</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--prettify</b></dt>
  <dd class="It-tag">prettify output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ssh <i>SSH</i></b></dt>
  <dd class="It-tag">SSH Server in the format <b>user@host:port</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ssh_keyfile <i>SSH_KEYFILE</i></b></dt>
  <dd class="It-tag">path to the keyfile to authorise the user</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--timeout <i>TIMEOUT</i></b></dt>
  <dd class="It-tag">connection timeout</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--version</b></dt>
  <dd class="It-tag">Displays Circus version and exits.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="See_Also"><a class="selflink" href="#See_Also">See
  Also</a></h2>
<i>circus</i> (1), <i>circusd</i> (1), <i>circusd-stats</i> (1),
  <i>circus-plugin</i> (1), <i>circus-top</i> (1).
<div style="height: 1.00em;">&#x00A0;</div>
Full Documentation is available at <i>http://circus.readthedocs.org</i>
<h2 class="Ss" title="Ss" id="circus-plugin_man_page"><a class="selflink" href="#circus-plugin_man_page">circus-plugin
  man page</a></h2>
<h2 class="Ss" title="Ss" id="Synopsis"><a class="selflink" href="#Synopsis">Synopsis</a></h2>
circus-plugin [options] [plugin]
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
circus-plugin allows to launch a plugin from a running Circus daemon.
<h2 class="Ss" title="Ss" id="Arguments"><a class="selflink" href="#Arguments">Arguments</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>plugin</b></dt>
  <dd class="It-tag">Fully qualified name of the plugin class.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--endpoint <i>ENDPOINT</i></b></dt>
  <dd class="It-tag">Connection endpoint.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--pubsub <i>PUBSUB</i></b></dt>
  <dd class="It-tag">The circusd ZeroMQ pub/sub socket to connect to.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--config <i>CONFIG</i></b></dt>
  <dd class="It-tag">The plugin configuration file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--check-delay <i>CHECK_DELAY</i></b></dt>
  <dd class="It-tag">Check delay.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--log-level <i>LEVEL</i></b></dt>
  <dd class="It-tag">Specify the log level. <i>LEVEL</i> can be <i>info</i>,
      <i>debug</i>, <i>critical</i>, <i>warning</i> or <i>error</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--log-output <i>LOGOUTPUT</i></b></dt>
  <dd class="It-tag">The location where the logs will be written. The default
      behavior is to write to stdout (you can force it by passing '-' to this
      option). Takes a filename otherwise.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ssh <i>SSH</i></b></dt>
  <dd class="It-tag">SSH Server in the format <b>user@host:port</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h, --help</b></dt>
  <dd class="It-tag">Show the help message and exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--version</b></dt>
  <dd class="It-tag">Displays Circus version and exits.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="See_also"><a class="selflink" href="#See_also">See
  also</a></h2>
<i>circus</i> (1), <i>circusd</i> (1), <i>circusctl</i> (1),
  <i>circusd-stats</i> (1), <i>circus-top</i> (1).
<div style="height: 1.00em;">&#x00A0;</div>
Full Documentation is available at <i>http://circus.readthedocs.org</i>
<h2 class="Ss" title="Ss" id="circus-top_man_page"><a class="selflink" href="#circus-top_man_page">circus-top
  man page</a></h2>
<h2 class="Ss" title="Ss" id="Synopsis"><a class="selflink" href="#Synopsis">Synopsis</a></h2>
circus-top [options]
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
circus-top is a <i>top</i>-like command to display the Circus daemon and
  processes managed by circus.
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--endpoint <i>ENDPOINT</i></b></dt>
  <dd class="It-tag">Connection endpoint.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ssh <i>SSH</i></b></dt>
  <dd class="It-tag">SSH Server in the format <b>user@host:port</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--process-timeout <i>PROCESS_TIMEOUT</i></b></dt>
  <dd class="It-tag">After this delay of inactivity, a process will be
    removed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h, --help</b></dt>
  <dd class="It-tag">Show the help message and exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--version</b></dt>
  <dd class="It-tag">Displays Circus version and exits.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="See_also"><a class="selflink" href="#See_also">See
  also</a></h2>
<i>circus</i> (1), <i>circusctl</i> (1), <i>circusd</i> (1),
  <i>circusd-stats</i> (1), <i>circus-plugin</i> (1).
<div style="height: 1.00em;">&#x00A0;</div>
Full Documentation is available at <i>http://circus.readthedocs.org</i>
<h2 class="Ss" title="Ss" id="circusd-stats_man_page"><a class="selflink" href="#circusd-stats_man_page">circusd-stats
  man page</a></h2>
<h2 class="Ss" title="Ss" id="Synopsis"><a class="selflink" href="#Synopsis">Synopsis</a></h2>
circusd-stats [options]
<h2 class="Ss" title="Ss" id="Description"><a class="selflink" href="#Description">Description</a></h2>
circusd-stats runs the stats aggregator for Circus.
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--endpoint <i>ENDPOINT</i></b></dt>
  <dd class="It-tag">Connection endpoint.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--pubsub <i>PUBSUB</i></b></dt>
  <dd class="It-tag">The circusd ZeroMQ pub/sub socket to connect to.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--statspoint <i>STATSPOINT</i></b></dt>
  <dd class="It-tag">The ZeroMQ pub/sub socket to send data to.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--log-level <i>LEVEL</i></b></dt>
  <dd class="It-tag">Specify the log level. <i>LEVEL</i> can be <i>info</i>,
      <i>debug</i>, <i>critical</i>, <i>warning</i> or <i>error</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--log-output <i>LOGOUTPUT</i></b></dt>
  <dd class="It-tag">The location where the logs will be written. The default
      behavior is to write to stdout (you can force it by passing '-' to this
      option). Takes a filename otherwise.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ssh <i>SSH</i></b></dt>
  <dd class="It-tag">SSH Server in the format <b>user@host:port</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h, --help</b></dt>
  <dd class="It-tag">Show the help message and exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--version</b></dt>
  <dd class="It-tag">Displays Circus version and exits.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="See_also"><a class="selflink" href="#See_also">See
  also</a></h2>
<i>circus</i> (1), <i>circusd</i> (1), <i>circusctl</i> (1),
  <i>circus-plugin</i> (1), <i>circus-top</i> (1).
<div style="height: 1.00em;">&#x00A0;</div>
Full Documentation is available at <i>http://circus.readthedocs.org</i>
<h2 class="Ss" title="Ss" id="Glossary:_Circus-specific_terms"><a class="selflink" href="#Glossary:_Circus-specific_terms">Glossary:
  Circus-specific terms</a></h2>
<div style="margin-left: 0.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>arbiter</b></dt>
  <dd class="It-tag">The <i>arbiter</i> is responsible for managing all the
      watchers within circus, ensuring all processes run correctly.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>controller</b></dt>
  <dd class="It-tag">A <i>controller</i> contains the set of actions that can be
      performed on the arbiter.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>flapping</b></dt>
  <dd class="It-tag">The <i>flapping detection</i> subscribes to events and
      detects when some processes are constantly restarting.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>pub/sub</b></dt>
  <dd class="It-tag">Circus has a <i>pubsub</i> that receives events from the
      watchers and dispatches them to all subscribers.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>remote controller</b></dt>
  <dd class="It-tag">The <i>remote controller</i> allows you to communicate with
      the controller via ZMQ to control Circus.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>watcher, watchers</b></dt>
  <dd class="It-tag">A <i>watcher</i> is the program you tell Circus to run. A
      single Circus instance can run one or more watchers.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>worker, workers, process, processes</b></dt>
  <dd class="It-tag">A <i>process</i> is an independent OS process instance of
      your program. A single watcher can run one or more processes. We also call
      them workers.</dd>
</dl>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Copyright"><a class="selflink" href="#Copyright">Copyright</a></h2>
Circus was initiated by Tarek Ziade and is licenced under APLv2
<div style="height: 1.00em;">&#x00A0;</div>
Benoit Chesneau was an early contributor and did many things, like most of the
  circus.commands work.
<h2 class="Ss" title="Ss" id="Licence"><a class="selflink" href="#Licence">Licence</a></h2>
<div style="margin-left: 0.00ex;">
<div style="margin-left: 3.50ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
Copyright 2012 - Mozilla Foundation
Copyright 2012 - Benoit Chesneau
<div class="Pp"></div>
Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
<div class="Pp"></div>
    http://www.apache.org/licenses/LICENSE-2.0
<div class="Pp"></div>
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
</pre>
</div>
<br/>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Contributors"><a class="selflink" href="#Contributors">Contributors</a></h2>
See the full list at
  <i>https://github.com/circus-tent/circus/blob/master/CONTRIBUTORS.txt</i>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Mozilla Foundation, Benoit Chesneau</div>
<table class="foot">
  <tr>
    <td class="foot-date">November 30, 2015</td>
    <td class="foot-os">0.12.1</td>
  </tr>
</table>
</body>
</html>
