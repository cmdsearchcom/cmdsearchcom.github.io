<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>r.solute.transport(1grass)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">r.solute.transport(1grass)</td>
    <td class="head-vol">Grass User's Manual</td>
    <td class="head-rtitle">r.solute.transport(1grass)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<i></i><b>r.solute.transport</b> - Numerical calculation program for transient,
  confined and unconfined solute transport in two dimensions
<h1 class="Sh" title="Sh" id="KEYWORDS"><a class="selflink" href="#KEYWORDS">KEYWORDS</a></h1>
raster, hydrology, solute transport
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>r.solute.transport</b>
<div>&#x00A0;</div>
<b>r.solute.transport --help</b>
<div>&#x00A0;</div>
<b>r.solute.transport</b> [-<b>fc</b>] <b>c</b>=<i>name</i>
  <b>phead</b>=<i>name</i> <b>hc_x</b>=<i>name</i> <b>hc_y</b>=<i>name</i>
  <b>status</b>= <i>name</i> <b>diff_x</b>=<i>name</i> <b>diff_y</b>=<i>name</i>
  [ <b>q</b>=<i>name</i>] [<b>cin</b>=<i>name</i>] <b>cs</b>=<i>name</i>
  <b>rd</b>= <i>name</i> <b>nf</b>=<i>name</i> <b>top</b>=<i>name</i>
  <b>bottom</b>= <i>name</i> <b>output</b>=<i>name</i> [<b>vx</b>=<i>name</i>]
  [<b>vy</b>=<i>name</i>] <b>dtime</b>=<i>float</i>
  [<b>maxit</b>=<i>integer</i>] [ <b>error</b>=<i>float</i>]
  [<b>solver</b>=<i>name</i>] [ <b>relax</b>=<i>float</i>]
  [<b>al</b>=<i>float</i>] [ <b>at</b>=<i>float</i>] [<b>loops</b>=<i>float</i>]
  [ <b>stab</b>=<i>string</i>] [--<b>overwrite</b>] [--<b>help</b>]
  [--<b>verbose</b>] [-- <b>quiet</b>] [--<b>ui</b>]
<h2 class="Ss" title="Ss" id="Flags:"><a class="selflink" href="#Flags:">Flags:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Use a full filled quadratic linear equation system, default is a sparse
      linear equation system.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Use the Courant-Friedrichs-Lewy criteria for time step calculation</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--overwrite</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Allow output files to overwrite existing files</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Print usage summary</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verbose</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Verbose module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--quiet</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Quiet module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ui</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Force launching GUI dialog</dd>
</dl>
<h2 class="Ss" title="Ss" id="Parameters:"><a class="selflink" href="#Parameters:">Parameters:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>c</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The initial concentration in [kg/m^3]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>phead</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The piezometric head in [m]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>hc_x</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The x-part of the hydraulic conductivity tensor in [m/s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>hc_y</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The y-part of the hydraulic conductivity tensor in [m/s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>status</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The status for each cell, = 0 - inactive cell, 1 - active cell, 2 -
      dirichlet- and 3 - transfer boundary condition</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>diff_x</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The x-part of the diffusion tensor in [m^2/s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>diff_y</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The y-part of the diffusion tensor in [m^2/s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>q</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Groundwater sources and sinks in [m^3/s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>cin</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Concentration sources and sinks bounded to a water source or sink in
    [kg/s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>cs</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Concentration of inner sources and inner sinks in [kg/s] (i.e. a chemical
      reaction)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>rd</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Retardation factor [-]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>nf</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Effective porosity [-]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>top</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Top surface of the aquifer in [m]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>bottom</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Bottom surface of the aquifer in [m]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>output</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The resulting concentration of the numerical solute transport calculation
      will be written to this map. [kg/m^3]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>vx</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Calculate and store the groundwater filter velocity vector part in x
      direction [m/s]
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>vy</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Calculate and store the groundwater filter velocity vector part in y
      direction [m/s]
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>dtime</b>=<i>float</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The calculation time in seconds
    <div>&#x00A0;</div>
    Default: <i>86400</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>maxit</b>=<i>integer</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Maximum number of iteration used to solve the linear equation system
    <div>&#x00A0;</div>
    Default: <i>10000</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>error</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Error break criteria for iterative solver
    <div>&#x00A0;</div>
    Default: <i>0.000001</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>solver</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The type of solver which should solve the linear equation system
    <div>&#x00A0;</div>
    Options: <i>gauss, lu, jacobi, sor, bicgstab</i>
    <div>&#x00A0;</div>
    Default: <i>bicgstab</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>relax</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The relaxation parameter used by the jacobi and sor solver for speedup or
      stabilizing
    <div>&#x00A0;</div>
    Default: <i>1</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>al</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The longditudinal dispersivity length. [m]
    <div>&#x00A0;</div>
    Default: <i>0.0</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>at</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    The transversal dispersivity length. [m]
    <div>&#x00A0;</div>
    Default: <i>0.0</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>loops</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Use this number of time loops if the CFL flag is off. The timestep will
      become dt/loops.
    <div>&#x00A0;</div>
    Default: <i>1</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>stab</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Set the flow stabilizing scheme (full or exponential upwinding).
    <div>&#x00A0;</div>
    Options: <i>full, exp</i>
    <div>&#x00A0;</div>
    Default: <i>full</i></dd>
</dl>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This numerical program calculates numerical implicit transient and steady state
  solute transport in porous media in the saturated zone of an aquifer. The
  computation is based on raster maps and the current region settings. All
  initial- and boundary-conditions must be provided as raster maps. The unit in
  the location must be meters.
<div>&#x00A0;</div>
<div class="Pp"></div>
This module is sensitive to mask settings. All cells which are outside the mask
  are ignored and handled as no flow boundaries.
<div>&#x00A0;</div>
This module calculates the concentration of the solution and optional the
  velocity field, based on the hydraulic conductivity, the effective porosity
  and the initial piecometric heads. The vector components can be visualized
  with paraview if they are exported with r.out.vtk.
<div>&#x00A0;</div>
<div>&#x00A0;</div>
Use r.gwflow to compute the piezometric heights of the aquifer. The piezometric
  heights and the hydraulic conductivity are used to compute the flow direction
  and the mean velocity of the groundwater. This is the base of the solute
  transport computation.
<div>&#x00A0;</div>
<div>&#x00A0;</div>
The solute transport will always be calculated transient. For stady state
  computation set the timestep to a large number (billions of seconds).
<div>&#x00A0;</div>
<div>&#x00A0;</div>
To reduce the numerical dispersion, which is a consequence of the convection
  term and the finite volume discretization, you can use small time steps and
  choose between full and exponential upwinding.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
The solute transport calculation is based on a diffusion/convection partial
  differential equation and a numerical implicit finite volume discretization.
  Specific for this kind of differential equation is the combination of a
  diffusion/dispersion term and a convection term. The discretization results in
  an unsymmetric linear equation system in form of <i>Ax = b</i>, which must be
  solved. The solute transport partial differential equation is of the following
  form:
<div class="Pp"></div>
(dc/dt)*R = div ( D grad c - uc) + cs -q/nf(c - c_in)
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">c -- the concentration [kg/m^3]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">u -- vector of mean groundwater flow velocity</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">dt -- the time step for transient calculation in seconds
      [s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">R -- the linear retardation coefficient [-]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">D -- the diffusion and dispersion tensor [m^2/s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">cs -- inner concentration sources/sinks [kg/m^3]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">c_in -- the solute concentration of influent water
    [kg/m^3]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">q -- inner well sources/sinks [m^3/s]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">nf -- the effective porosity [-]</dd>
</dl>
</div>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
Three different boundary conditions are implemented, the Dirichlet, Transmission
  and Neumann conditions. The calculation and boundary status of single cells
  can be set with the status map. The following states are supportet:
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">0 == inactive - the cell with status 0 will not be
      calculated, active cells will have a no flow boundary to an inactive
    cell</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">1 == active - this cell is used for sloute transport
      calculation, inner sources can be defined for those cells</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">2 == Dirichlet - cells of this type will have a fixed
      concentration value which do not change over time</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">3 == Transmission - cells of this type should be placed on
      out-flow boundaries to assure the flow of the solute stream out</dd>
</dl>
</div>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
Note that all required raster maps are read into main memory. Additionally the
  linear equation system will be allocated, so the memory consumption of this
  module rapidely grow with the size of the input maps.
<div>&#x00A0;</div>
<div>&#x00A0;</div>
The resulting linear equation system <i>Ax = b</i> can be solved with several
  solvers. Several iterative solvers with unsymmetric sparse and quadratic
  matrices support are implemented. The jacobi method, the Gauss-Seidel method
  and the biconjugate gradients-stabilized (bicgstab) method. Additionally a
  direct Gauss solver and LU solver are available. Those direct solvers only
  work with quadratic matrices, so be careful using them with large maps (maps
  of size 10.000 cells will need more than one gigabyte of ram). Always prefer a
  sparse matrix solver.
<h1 class="Sh" title="Sh" id="EXAMPLE"><a class="selflink" href="#EXAMPLE">EXAMPLE</a></h1>
Use this small python script to create a working groundwater flow / solute
  transport area and data. Make sure you are not in a lat/lon projection.
<div>&#x00A0;</div>
<pre>
#!/usr/bin/env python
# This is an example script how groundwater flow and solute transport are
# computed within grass
import sys
import os
import grass.script as grass
# Overwrite existing maps
grass.run_command(&quot;g.gisenv&quot;, set=&quot;OVERWRITE=1&quot;)
grass.message(_(&quot;Set the region&quot;))
# The area is 200m x 100m with a cell size of 1m x 1m
grass.run_command(&quot;g.region&quot;, res=1, res3=1, t=10, b=0, n=100, s=0, w=0, e=200)
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;phead = if(col() == 1 , 50, 40)&quot;)
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;phead = if(col() ==200  , 45 + row()/40, phead)&quot;)
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;status = if(col() == 1 || col() == 200 , 2, 1)&quot;)
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;well = if((row() == 50 &amp;&amp; col() == 175) || (row() == 10 &amp;&amp; col() == 135) , -0.001, 0)&quot;)
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;hydcond = 0.00005&quot;)
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;recharge = 0&quot;)
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;top_conf = 20&quot;)
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;bottom = 0&quot;)
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;poros = 0.17&quot;)
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;syield = 0.0001&quot;)
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;null = 0.0&quot;)
grass.message(_(&quot;Compute a steady state groundwater flow&quot;))
grass.run_command(&quot;r.gwflow&quot;, solver=&quot;cg&quot;, top=&quot;top_conf&quot;, bottom=&quot;bottom&quot;, phead=&quot;phead&quot;,\
  status=&quot;status&quot;, hc_x=&quot;hydcond&quot;, hc_y=&quot;hydcond&quot;, q=&quot;well&quot;, s=&quot;syield&quot;,\
  recharge=&quot;recharge&quot;, output=&quot;gwresult_conf&quot;, dt=8640000000000, type=&quot;confined&quot;)
grass.message(_(&quot;generate the transport data&quot;))
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;c = if(col() == 15 &amp;&amp; row() == 75 , 500.0, 0.0)&quot;)
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;cs = if(col() == 15 &amp;&amp; row() == 75 , 0.0, 0.0)&quot;)
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;tstatus = if(col() == 1 || col() == 200 , 3, 1)&quot;)
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;diff = 0.0000001&quot;)
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;R = 1.0&quot;)
# Compute the initial state
grass.run_command(&quot;r.solute.transport&quot;, solver=&quot;bicgstab&quot;, top=&quot;top_conf&quot;,\
  bottom=&quot;bottom&quot;, phead=&quot;gwresult_conf&quot;, status=&quot;tstatus&quot;, hc_x=&quot;hydcond&quot;, hc_y=&quot;hydcond&quot;,\
  rd=&quot;R&quot;, cs=&quot;cs&quot;, q=&quot;well&quot;, nf=&quot;poros&quot;, output=&quot;stresult_conf_0&quot;, dt=3600, diff_x=&quot;diff&quot;,\
  diff_y=&quot;diff&quot;, c=&quot;c&quot;, al=0.1, at=0.01)
# Compute the solute transport for 300 days in 10 day steps
for dt in range(30):
    grass.run_command(&quot;r.solute.transport&quot;, solver=&quot;bicgstab&quot;, top=&quot;top_conf&quot;,\
    bottom=&quot;bottom&quot;, phead=&quot;gwresult_conf&quot;, status=&quot;tstatus&quot;, hc_x=&quot;hydcond&quot;, hc_y=&quot;hydcond&quot;,\
    rd=&quot;R&quot;, cs=&quot;cs&quot;, q=&quot;well&quot;, nf=&quot;poros&quot;, output=&quot;stresult_conf_&quot; + str(dt + 1), dt=864000, diff_x=&quot;diff&quot;,\
    diff_y=&quot;diff&quot;, c=&quot;stresult_conf_&quot; + str(dt), al=0.1, at=0.01)
</pre>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i>r.gwflow</i>
<div>&#x00A0;</div>
<i>r3.gwflow</i>
<div>&#x00A0;</div>
<i>r.out.vtk</i>
<div>&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
S&#x00F6;ren Gebbert
<div class="Pp"></div>
This work is based on the Diploma Thesis of S&#x00F6;ren Gebbert available here
  at Technical University Berlin in Germany.
<div class="Pp"></div>
<i>Last changed: $Date: 2016-04-09 18:43:25 +0200 (Sat, 09 Apr 2016) $</i>
<h1 class="Sh" title="Sh" id="SOURCE_CODE"><a class="selflink" href="#SOURCE_CODE">SOURCE
  CODE</a></h1>
Available at: r.solute.transport source code (history)
<div class="Pp"></div>
Main index | Raster index | Topics index | Keywords index | Graphical index |
  Full index
<div class="Pp"></div>
&#x00A9; 2003-2016 GRASS Development Team, GRASS GIS 7.2.0 Reference
  Manual</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os">GRASS 7.2.0</td>
  </tr>
</table>
</body>
</html>
