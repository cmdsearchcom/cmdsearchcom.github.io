<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:36:09 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>r.solute.transport(1grass) Grass User&rsquo;s Manual
r.solute.transport(1grass)</p>

<p style="margin-top: 1em">NAME <br>
r.solute.transport - Numerical calculation program for
transient, confined and unconfined solute transport in two
dimensions</p>

<p style="margin-top: 1em">KEYWORDS <br>
raster, hydrology, solute transport</p>

<p style="margin-top: 1em">SYNOPSIS <br>
r.solute.transport <br>
r.solute.transport --help <br>
r.solute.transport [-fc] c=name phead=name hc_x=name
hc_y=name status=name diff_x=name diff_y=name [q=name]
[cin=name] cs=name rd=name nf=name top=name bottom=name
out&acirc; <br>
put=name [vx=name] [vy=name] dtime=float [maxit=integer]
[error=float] [solver=name] [relax=float] [al=float]
[at=float] [loops=float] [stab=string] [--over&acirc; <br>
write] [--help] [--verbose] [--quiet] [--ui]</p>

<p style="margin-top: 1em">Flags: <br>
-f <br>
Use a full filled quadratic linear equation system, default
is a sparse linear equation system.</p>

<p style="margin-top: 1em">-c <br>
Use the Courant-Friedrichs-Lewy criteria for time step
calculation</p>

<p style="margin-top: 1em">--overwrite <br>
Allow output files to overwrite existing files</p>

<p style="margin-top: 1em">--help <br>
Print usage summary</p>

<p style="margin-top: 1em">--verbose <br>
Verbose module output</p>

<p style="margin-top: 1em">--quiet <br>
Quiet module output</p>

<p style="margin-top: 1em">--ui <br>
Force launching GUI dialog</p>

<p style="margin-top: 1em">Parameters: <br>
c=name [required] <br>
The initial concentration in [kg/m^3]</p>

<p style="margin-top: 1em">phead=name [required] <br>
The piezometric head in [m]</p>

<p style="margin-top: 1em">hc_x=name [required] <br>
The x-part of the hydraulic conductivity tensor in [m/s]</p>

<p style="margin-top: 1em">hc_y=name [required] <br>
The y-part of the hydraulic conductivity tensor in [m/s]</p>

<p style="margin-top: 1em">status=name [required] <br>
The status for each cell, = 0 - inactive cell, 1 - active
cell, 2 - dirichlet- and 3 - transfer boundary condition</p>

<p style="margin-top: 1em">diff_x=name [required] <br>
The x-part of the diffusion tensor in [m^2/s]</p>

<p style="margin-top: 1em">diff_y=name [required] <br>
The y-part of the diffusion tensor in [m^2/s]</p>

<p style="margin-top: 1em">q=name <br>
Groundwater sources and sinks in [m^3/s]</p>

<p style="margin-top: 1em">cin=name <br>
Concentration sources and sinks bounded to a water source or
sink in [kg/s]</p>

<p style="margin-top: 1em">cs=name [required] <br>
Concentration of inner sources and inner sinks in [kg/s]
(i.e. a chemical reaction)</p>

<p style="margin-top: 1em">rd=name [required] <br>
Retardation factor [-]</p>

<p style="margin-top: 1em">nf=name [required] <br>
Effective porosity [-]</p>

<p style="margin-top: 1em">top=name [required] <br>
Top surface of the aquifer in [m]</p>

<p style="margin-top: 1em">bottom=name [required] <br>
Bottom surface of the aquifer in [m]</p>

<p style="margin-top: 1em">output=name [required] <br>
The resulting concentration of the numerical solute
transport calculation will be written to this map.
[kg/m^3]</p>

<p style="margin-top: 1em">vx=name <br>
Calculate and store the groundwater filter velocity vector
part in x direction [m/s]</p>

<p style="margin-top: 1em">vy=name <br>
Calculate and store the groundwater filter velocity vector
part in y direction [m/s]</p>

<p style="margin-top: 1em">dtime=float [required] <br>
The calculation time in seconds <br>
Default: 86400</p>

<p style="margin-top: 1em">maxit=integer <br>
Maximum number of iteration used to solve the linear
equation system <br>
Default: 10000</p>

<p style="margin-top: 1em">error=float <br>
Error break criteria for iterative solver <br>
Default: 0.000001</p>

<p style="margin-top: 1em">solver=name <br>
The type of solver which should solve the linear equation
system <br>
Options: gauss, lu, jacobi, sor, bicgstab <br>
Default: bicgstab</p>

<p style="margin-top: 1em">relax=float <br>
The relaxation parameter used by the jacobi and sor solver
for speedup or stabilizing <br>
Default: 1</p>

<p style="margin-top: 1em">al=float <br>
The longditudinal dispersivity length. [m] <br>
Default: 0.0</p>

<p style="margin-top: 1em">at=float <br>
The transversal dispersivity length. [m] <br>
Default: 0.0</p>

<p style="margin-top: 1em">loops=float <br>
Use this number of time loops if the CFL flag is off. The
timestep will become dt/loops. <br>
Default: 1</p>

<p style="margin-top: 1em">stab=string <br>
Set the flow stabilizing scheme (full or exponential
upwinding). <br>
Options: full, exp <br>
Default: full</p>

<p style="margin-top: 1em">DESCRIPTION <br>
This numerical program calculates numerical implicit
transient and steady state solute transport in porous media
in the saturated zone of an aquifer. The computation is
based on <br>
raster maps and the current region settings. All initial-
and boundary-conditions must be provided as raster maps. The
unit in the location must be meters.</p>

<p style="margin-top: 1em">This module is sensitive to mask
settings. All cells which are outside the mask are ignored
and handled as no flow boundaries. <br>
This module calculates the concentration of the solution and
optional the velocity field, based on the hydraulic
conductivity, the effective porosity and the initial
piecometric <br>
heads. The vector components can be visualized with paraview
if they are exported with r.out.vtk. <br>
Use r.gwflow to compute the piezometric heights of the
aquifer. The piezometric heights and the hydraulic
conductivity are used to compute the flow direction and the
mean veloc&acirc; <br>
ity of the groundwater. This is the base of the solute
transport computation. <br>
The solute transport will always be calculated transient.
For stady state computation set the timestep to a large
number (billions of seconds). <br>
To reduce the numerical dispersion, which is a consequence
of the convection term and the finite volume discretization,
you can use small time steps and choose between full and
<br>
exponential upwinding.</p>

<p style="margin-top: 1em">NOTES <br>
The solute transport calculation is based on a
diffusion/convection partial differential equation and a
numerical implicit finite volume discretization. Specific
for this kind of <br>
differential equation is the combination of a
diffusion/dispersion term and a convection term. The
discretization results in an unsymmetric linear equation
system in form of Ax <br>
= b, which must be solved. The solute transport partial
differential equation is of the following form:</p>

<p style="margin-top: 1em">(dc/dt)*R = div ( D grad c - uc)
+ cs -q/nf(c - c_in)</p>

<p style="margin-top: 1em">&Acirc;&middot; c -- the
concentration [kg/m^3]</p>

<p style="margin-top: 1em">&Acirc;&middot; u -- vector of
mean groundwater flow velocity</p>

<p style="margin-top: 1em">&Acirc;&middot; dt -- the time
step for transient calculation in seconds [s]</p>

<p style="margin-top: 1em">&Acirc;&middot; R -- the linear
retardation coefficient [-]</p>

<p style="margin-top: 1em">&Acirc;&middot; D -- the
diffusion and dispersion tensor [m^2/s]</p>

<p style="margin-top: 1em">&Acirc;&middot; cs -- inner
concentration sources/sinks [kg/m^3]</p>

<p style="margin-top: 1em">&Acirc;&middot; c_in -- the
solute concentration of influent water [kg/m^3]</p>

<p style="margin-top: 1em">&Acirc;&middot; q -- inner well
sources/sinks [m^3/s]</p>

<p style="margin-top: 1em">&Acirc;&middot; nf -- the
effective porosity [-] <br>
Three different boundary conditions are implemented, the
Dirichlet, Transmission and Neumann conditions. The
calculation and boundary status of single cells can be set
with the <br>
status map. The following states are supportet:</p>

<p style="margin-top: 1em">&Acirc;&middot; 0 == inactive -
the cell with status 0 will not be calculated, active cells
will have a no flow boundary to an inactive cell</p>

<p style="margin-top: 1em">&Acirc;&middot; 1 == active -
this cell is used for sloute transport calculation, inner
sources can be defined for those cells</p>

<p style="margin-top: 1em">&Acirc;&middot; 2 == Dirichlet -
cells of this type will have a fixed concentration value
which do not change over time</p>

<p style="margin-top: 1em">&Acirc;&middot; 3 ==
Transmission - cells of this type should be placed on
out-flow boundaries to assure the flow of the solute stream
out <br>
Note that all required raster maps are read into main
memory. Additionally the linear equation system will be
allocated, so the memory consumption of this module rapidely
grow <br>
with the size of the input maps. <br>
The resulting linear equation system Ax = b can be solved
with several solvers. Several iterative solvers with
unsymmetric sparse and quadratic matrices support are
implemented. <br>
The jacobi method, the Gauss-Seidel method and the
biconjugate gradients-stabilized (bicgstab) method.
Additionally a direct Gauss solver and LU solver are
available. Those <br>
direct solvers only work with quadratic matrices, so be
careful using them with large maps (maps of size 10.000
cells will need more than one gigabyte of ram). Always
prefer a <br>
sparse matrix solver.</p>

<p style="margin-top: 1em">EXAMPLE <br>
Use this small python script to create a working groundwater
flow / solute transport area and data. Make sure you are not
in a lat/lon projection. <br>
#!/usr/bin/env python <br>
# This is an example script how groundwater flow and solute
transport are <br>
# computed within grass <br>
import sys <br>
import os <br>
import grass.script as grass <br>
# Overwrite existing maps <br>
grass.run_command(&quot;g.gisenv&quot;,
set=&quot;OVERWRITE=1&quot;) <br>
grass.message(_(&quot;Set the region&quot;)) <br>
# The area is 200m x 100m with a cell size of 1m x 1m <br>
grass.run_command(&quot;g.region&quot;, res=1, res3=1, t=10,
b=0, n=100, s=0, w=0, e=200) <br>
grass.run_command(&quot;r.mapcalc&quot;,
expression=&quot;phead = if(col() == 1 , 50, 40)&quot;) <br>
grass.run_command(&quot;r.mapcalc&quot;,
expression=&quot;phead = if(col() ==200 , 45 + row()/40,
phead)&quot;) <br>
grass.run_command(&quot;r.mapcalc&quot;,
expression=&quot;status = if(col() == 1 || col() == 200 , 2,
1)&quot;) <br>
grass.run_command(&quot;r.mapcalc&quot;,
expression=&quot;well = if((row() == 50 &amp;&amp; col() ==
175) || (row() == 10 &amp;&amp; col() == 135) , -0.001,
0)&quot;) <br>
grass.run_command(&quot;r.mapcalc&quot;,
expression=&quot;hydcond = 0.00005&quot;) <br>
grass.run_command(&quot;r.mapcalc&quot;,
expression=&quot;recharge = 0&quot;) <br>
grass.run_command(&quot;r.mapcalc&quot;,
expression=&quot;top_conf = 20&quot;) <br>
grass.run_command(&quot;r.mapcalc&quot;,
expression=&quot;bottom = 0&quot;) <br>
grass.run_command(&quot;r.mapcalc&quot;,
expression=&quot;poros = 0.17&quot;) <br>
grass.run_command(&quot;r.mapcalc&quot;,
expression=&quot;syield = 0.0001&quot;) <br>
grass.run_command(&quot;r.mapcalc&quot;,
expression=&quot;null = 0.0&quot;) <br>
grass.message(_(&quot;Compute a steady state groundwater
flow&quot;)) <br>
grass.run_command(&quot;r.gwflow&quot;,
solver=&quot;cg&quot;, top=&quot;top_conf&quot;,
bottom=&quot;bottom&quot;, phead=&quot;phead&quot;,
status=&quot;status&quot;, hc_x=&quot;hydcond&quot;,
hc_y=&quot;hydcond&quot;, q=&quot;well&quot;,
s=&quot;syield&quot;, recharge=&quot;recharge&quot;,
output=&quot;gwresult_conf&quot;, dt=8640000000000,
type=&quot;confined&quot;) <br>
grass.message(_(&quot;generate the transport data&quot;))
<br>
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;c
= if(col() == 15 &amp;&amp; row() == 75 , 500.0, 0.0)&quot;)
<br>
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;cs
= if(col() == 15 &amp;&amp; row() == 75 , 0.0, 0.0)&quot;)
<br>
grass.run_command(&quot;r.mapcalc&quot;,
expression=&quot;tstatus = if(col() == 1 || col() == 200 ,
3, 1)&quot;) <br>
grass.run_command(&quot;r.mapcalc&quot;,
expression=&quot;diff = 0.0000001&quot;) <br>
grass.run_command(&quot;r.mapcalc&quot;, expression=&quot;R
= 1.0&quot;) <br>
# Compute the initial state <br>
grass.run_command(&quot;r.solute.transport&quot;,
solver=&quot;bicgstab&quot;, top=&quot;top_conf&quot;,
bottom=&quot;bottom&quot;, phead=&quot;gwresult_conf&quot;,
status=&quot;tstatus&quot;, hc_x=&quot;hydcond&quot;,
hc_y=&quot;hydcond&quot;, rd=&quot;R&quot;,
cs=&quot;cs&quot;, q=&quot;well&quot;, nf=&quot;poros&quot;,
output=&quot;stresult_conf_0&quot;, dt=3600,
diff_x=&quot;diff&quot;, diff_y=&quot;diff&quot;,
c=&quot;c&quot;, al=0.1, at=0.01) <br>
# Compute the solute transport for 300 days in 10 day steps
<br>
for dt in range(30): <br>
grass.run_command(&quot;r.solute.transport&quot;,
solver=&quot;bicgstab&quot;, top=&quot;top_conf&quot;,
bottom=&quot;bottom&quot;, phead=&quot;gwresult_conf&quot;,
status=&quot;tstatus&quot;, hc_x=&quot;hydcond&quot;,
hc_y=&quot;hydcond&quot;, rd=&quot;R&quot;,
cs=&quot;cs&quot;, q=&quot;well&quot;, nf=&quot;poros&quot;,
output=&quot;stresult_conf_&quot; + str(dt + 1), dt=864000,
diff_x=&quot;diff&quot;, diff_y=&quot;diff&quot;,
c=&quot;stresult_conf_&quot; + str(dt), al=0.1, at=0.01)</p>

<p style="margin-top: 1em">SEE ALSO <br>
r.gwflow <br>
r3.gwflow <br>
r.out.vtk</p>

<p style="margin-top: 1em">AUTHOR <br>
S&Atilde;&para;ren Gebbert</p>

<p style="margin-top: 1em">This work is based on the
Diploma Thesis of S&Atilde;&para;ren Gebbert available here
at Technical University Berlin in Germany.</p>

<p style="margin-top: 1em">Last changed: $Date: 2016-04-09
18:43:25 +0200 (Sat, 09 Apr 2016) $</p>

<p style="margin-top: 1em">SOURCE CODE <br>
Available at: r.solute.transport source code (history)</p>

<p style="margin-top: 1em">Main index | Raster index |
Topics index | Keywords index | Graphical index | Full
index</p>

<p style="margin-top: 1em">&Acirc;&copy; 2003-2016 GRASS
Development Team, GRASS GIS 7.2.0 Reference Manual</p>

<p style="margin-top: 1em">GRASS 7.2.0
r.solute.transport(1grass)</p>
<hr>
</body>
</html>
