<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 15:47:00 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>ABIDIFF(1) Libabigail ABIDIFF(1)</p>

<p style="margin-top: 1em">NAME <br>
abidiff - compare ABIs of ELF files</p>

<p style="margin-top: 1em">abidiff compares the Application
Binary Interfaces (ABI) of two shared libraries in ELF
format. It emits a meaningful report describing the
differences between the two ABIs.</p>

<p style="margin-top: 1em">For a comprehensive ABI change
report that includes changes about function and variable
sub-types, the two input shared libraries must be
accompanied with their debug information <br>
in DWARF format. Otherwise, only ELF symbols that were added
or removed are reported.</p>

<p style="margin-top: 1em">INVOCATION <br>
abidiff [options] &lt;first-shared-library&gt;
&lt;second-shared-library&gt;</p>

<p style="margin-top: 1em">ENVIRONMENT <br>
abidiff loads two default suppression specifications files,
merges their content and use it to filter out ABI change
reports that might be considered as false positives to
users.</p>

<p style="margin-top: 1em">&Acirc;&middot; Default
system-wide suppression specification file</p>

<p style="margin-top: 1em">It&rsquo;s located by the
optional environment variable
LIBABIGAIL_DEFAULT_SYSTEM_SUPPRESSION_FILE. If that
environment variable is not set, then abidiff tries to load
the suppres&acirc; <br>
sion file $libdir/libabigail/libabigail-default.abignore. If
that file is not present, then no default system-wide
suppression specification file is loaded.</p>

<p style="margin-top: 1em">&Acirc;&middot; Default user
suppression specification file.</p>

<p style="margin-top: 1em">It&rsquo;s located by the
optional environment
LIBABIGAIL_DEFAULT_USER_SUPPRESSION_FILE. If that
environment variable is not set, then abidiff tries to load
the suppression file <br>
$HOME/.abignore. If that file is not present, then no
default user suppression specification is loaded.</p>

<p style="margin-top: 1em">OPTIONS <br>
&Acirc;&middot; --help | -h</p>

<p style="margin-top: 1em">Display a short help about the
command and exit.</p>

<p style="margin-top: 1em">&Acirc;&middot; --version |
-v</p>

<p style="margin-top: 1em">Display the version of the
program and exit.</p>

<p style="margin-top: 1em">&Acirc;&middot;
--debug-info-dir1 | --d1 &lt;di-path1&gt;</p>

<p style="margin-top: 1em">For cases where the debug
information for first-shared-library is split out into a
separate file, tells abidiff where to find that separate
debug information file.</p>

<p style="margin-top: 1em">Note that di-path must point to
the root directory under which the debug information is
arranged in a tree-like manner. Under Red Hat based systems,
that directory is usu&acirc; <br>
ally &lt;root&gt;/usr/lib/debug.</p>

<p style="margin-top: 1em">Note also that this option is
not mandatory for split debug information installed by your
system&rsquo;s package manager because then abidiff knows
where to find it.</p>

<p style="margin-top: 1em">&Acirc;&middot;
--debug-info-dir2 | --d2 &lt;di-path2&gt;</p>

<p style="margin-top: 1em">Like --debug-info-dir1, this
options tells abidiff where to find the split debug
information for the second-shared-library file.</p>

<p style="margin-top: 1em">&Acirc;&middot; --headers-dir1 |
--hd1 &lt;headers-directory-path-1&gt;</p>

<p style="margin-top: 1em">Specifies where to find the
public headers of the first shared library that the tool has
to consider. The tool will thus filter out ABI changes on
types that are not <br>
defined in public headers.</p>

<p style="margin-top: 1em">&Acirc;&middot; --headers-dir2 |
--hd2 &lt;headers-directory-path-1&gt;</p>

<p style="margin-top: 1em">Specifies where to find the
public headers of the second shared library that the tool
has to consider. The tool will thus filter out ABI changes
on types that are not <br>
defined in public headers.</p>

<p style="margin-top: 1em">&Acirc;&middot; --stat</p>

<p style="margin-top: 1em">Rather than displaying the
detailed ABI differences between first-shared-library and
second-shared-library, just display some summary statistics
about these differences.</p>

<p style="margin-top: 1em">&Acirc;&middot; --symtabs</p>

<p style="margin-top: 1em">Only display the symbol tables
of the first-shared-library and second-shared-library.</p>

<p style="margin-top: 1em">&Acirc;&middot;
--deleted-fns</p>

<p style="margin-top: 1em">In the resulting report about
the differences between first-shared-library and
second-shared-library, only display the globally defined
functions that got deleted from <br>
first-shared-library.</p>

<p style="margin-top: 1em">&Acirc;&middot;
--changed-fns</p>

<p style="margin-top: 1em">In the resulting report about
the differences between first-shared-library and
second-shared-library, only display the changes in sub-types
of the global functions defined <br>
in first-shared-library.</p>

<p style="margin-top: 1em">&Acirc;&middot; --added-fns</p>

<p style="margin-top: 1em">In the resulting report about
the differences between first-shared-library and
second-shared-library, only display the globally defined
functions that were added to sec&acirc; <br>
ond-shared-library.</p>

<p style="margin-top: 1em">&Acirc;&middot;
--deleted-vars</p>

<p style="margin-top: 1em">In the resulting report about
the differences between first-shared-library and
second-shared-library, only display the globally defined
variables that were deleted from <br>
first-shared-library.</p>

<p style="margin-top: 1em">&Acirc;&middot;
--changed-vars</p>

<p style="margin-top: 1em">In the resulting report about
the differences between first-shared-library and
second-shared-library, only display the changes in the
sub-types of the global variables <br>
defined in first-shared-library</p>

<p style="margin-top: 1em">&Acirc;&middot; --added-vars</p>

<p style="margin-top: 1em">In the resulting report about
the differences between first-shared-library and
second-shared-library, only display the global variables
that were added (defined) to sec&acirc; <br>
ond-shared-library.</p>

<p style="margin-top: 1em">&Acirc;&middot;
--no-linkage-name</p>

<p style="margin-top: 1em">In the resulting report, do not
display the linkage names of the added, removed, or changed
functions or variables.</p>

<p style="margin-top: 1em">&Acirc;&middot; --no-show-locs
<br>
Do not show information about where in the second shared
library the respective type was changed.</p>

<p style="margin-top: 1em">&Acirc;&middot;
--no-unreferenced-symbols</p>

<p style="margin-top: 1em">In the resulting report, do not
display change information about function and variable
symbols that are not referenced by any debug information.
Note that for these symbols <br>
not referenced by any debug information, the change
information displayed is either added or removed
symbols.</p>

<p style="margin-top: 1em">&Acirc;&middot;
--no-default-suppression</p>

<p style="margin-top: 1em">Do not load the default
suppression specification files.</p>

<p style="margin-top: 1em">&Acirc;&middot; --suppressions |
--suppr &lt;path-to-suppressions&gt;</p>

<p style="margin-top: 1em">Use a suppression specification
file located at path-to-suppressions. Note that this option
can appear multiple times on the command line. In that case,
all of the pro&acirc; <br>
vided suppression specification files are taken into
account.</p>

<p style="margin-top: 1em">Please note that, by default, if
this option is not provided, then the default suppression
specification files are loaded .</p>

<p style="margin-top: 1em">&Acirc;&middot; --drop
&lt;regex&gt;</p>

<p style="margin-top: 1em">When reading the
first-shared-library and second-shared-library ELF input
files, drop the globally defined functions and variables
which name match the regular expression <br>
regex. As a result, no change involving these functions or
variables will be emitted in the diff report.</p>

<p style="margin-top: 1em">&Acirc;&middot; --drop-fn
&lt;regex&gt;</p>

<p style="margin-top: 1em">When reading the
first-shared-library and second-shared-library ELF input
files, drop the globally defined functions which name match
the regular expression regex. As a <br>
result, no change involving these functions will be emitted
in the diff report.</p>

<p style="margin-top: 1em">&Acirc;&middot; --drop-var
&lt;regex&gt;</p>

<p style="margin-top: 1em">When reading the
first-shared-library and second-shared-library ELF input
files, drop the globally defined variables matching a the
regular expression regex.</p>

<p style="margin-top: 1em">&Acirc;&middot; --keep
&lt;regex&gt;</p>

<p style="margin-top: 1em">When reading the
first-shared-library and second-shared-library ELF input
files, keep the globally defined functions and variables
which names match the regular expression <br>
regex. All other functions and variables are dropped on the
floor and will thus not appear in the resulting diff
report.</p>

<p style="margin-top: 1em">&Acirc;&middot; --keep-fn
&lt;regex&gt;</p>

<p style="margin-top: 1em">When reading the
first-shared-library and second-shared-library ELF input
files, keep the globally defined functions which name match
the regular expression regex. All <br>
other functions are dropped on the floor and will thus not
appear in the resulting diff report.</p>

<p style="margin-top: 1em">&Acirc;&middot; --keep-var
&lt;regex&gt;</p>

<p style="margin-top: 1em">When reading the
first-shared-library and second-shared-library ELF input
files, keep the globally defined which names match the
regular expression regex. All other vari&acirc; <br>
ables are dropped on the floor and will thus not appear in
the resulting diff report.</p>

<p style="margin-top: 1em">&Acirc;&middot; --harmless</p>

<p style="margin-top: 1em">In the diff report, display only
the harmless changes. By default, the harmless changes are
filtered out of the diff report keep the clutter to a
minimum and have a greater <br>
change to spot real ABI issues.</p>

<p style="margin-top: 1em">&Acirc;&middot; --no-harmful</p>

<p style="margin-top: 1em">In the diff report, do not
display the harmful changes. By default, only the harmful
changes are displayed in diff report.</p>

<p style="margin-top: 1em">&Acirc;&middot; --redundant</p>

<p style="margin-top: 1em">In the diff report, do display
redundant changes. A redundant change is a change that has
been displayed elsewhere in the report.</p>

<p style="margin-top: 1em">&Acirc;&middot;
--no-redundant</p>

<p style="margin-top: 1em">In the diff report, do NOT
display redundant changes. A redundant change is a change
that has been displayed elsewhere in the report. This option
is switched on by <br>
default.</p>

<p style="margin-top: 1em">&Acirc;&middot;
--no-architecture</p>

<p style="margin-top: 1em">Do not take architecture in
account when comparing ABIs.</p>

<p style="margin-top: 1em">&Acirc;&middot; --dump-diff-tree
<br>
After the diff report, emit a textual representation of the
diff nodes tree used by the comparison engine to represent
the changed functions and variables. That represen&acirc;
<br>
tation is emitted to the error output for debugging
purposes. Note that this diff tree is relevant only to
functions and variables that have some sub-type changes.
Added <br>
or removed functions and variables do not have any diff
nodes tree associated to them.</p>

<p style="margin-top: 1em">&Acirc;&middot; --stats</p>

<p style="margin-top: 1em">Emit statistics about various
internal things.</p>

<p style="margin-top: 1em">&Acirc;&middot; --verbose</p>

<p style="margin-top: 1em">Emit verbose logs about the
progress of miscellaneous internal things.</p>

<p style="margin-top: 1em">RETURN VALUES <br>
The exit code of the abidiff command is either 0 if the ABI
of the binaries being compared are equal, or non-zero if
they differ or if the tool encountered an error.</p>

<p style="margin-top: 1em">In the later case, the exit code
is a 8-bits-wide bit field in which each bit has a specific
meaning.</p>

<p style="margin-top: 1em">The first bit, of value 1, named
ABIDIFF_ERROR means there was an error.</p>

<p style="margin-top: 1em">The second bit, of value 2,
named ABIDIFF_USAGE_ERROR means there was an error in the
way the user invoked the tool. It might be set, for
instance, if the user invoked the tool <br>
with an unknown command line switch, with a wrong number or
argument, etc. If this bit is set, then the ABIDIFF_ERROR
bit must be set as well.</p>

<p style="margin-top: 1em">The third bit, of value 4, named
ABIDIFF_ABI_CHANGE means the ABI of the binaries being
compared are different.</p>

<p style="margin-top: 1em">The fourth bit, of value 8,
named ABIDIFF_ABI_INCOMPATIBLE_CHANGE means the ABI of the
binaries compared are different in an incompatible way. If
this bit is set, then the ABID&acirc; <br>
IFF_ABI_CHANGE bit must be set as well. If the
ABIDIFF_ABI_CHANGE is set and the
ABIDIFF_INCOMPATIBLE_CHANGE is NOT set, then it means that
the ABIs being compared might or <br>
might not be compatible. In that case, a human being needs
to review the ABI changes to decide if they are compatible
or not.</p>

<p style="margin-top: 1em">Note that, at the moment, there
are only a few kinds of ABI changes that would result in
setting the flag ABIDIFF_ABI_INCOMPATIBLE_CHANGE. Those ABI
changes are either:</p>

<p style="margin-top: 1em">&Acirc;&middot; the removal of
the symbol of a function or variable that has been defined
and exported.</p>

<p style="margin-top: 1em">&Acirc;&middot; the modification
of the index of a member of a virtual function table (for
C++ programs and libraries).</p>

<p style="margin-top: 1em">With time, when more ABI change
patterns are found to always constitute incompatible ABI
changes, we will adapt the code to recognize those cases and
set the ABIDIFF_ABI_INCOM&acirc; <br>
PATIBLE_CHANGE accordingly. So, if you find such patterns,
please let us know.</p>

<p style="margin-top: 1em">The remaining bits are not used
for the moment.</p>

<p style="margin-top: 1em">USAGE EXAMPLES <br>
1. Detecting a change in a sub-type of a function:</p>

<p style="margin-top: 1em">$ cat -n test-v0.cc <br>
1 // Compile this with: <br>
2 // g++ -g -Wall -shared -o libtest-v0.so test-v0.cc <br>
3 <br>
4 struct S0 <br>
5 { <br>
6 int m0; <br>
7 }; <br>
8 <br>
9 void <br>
10 foo(S0* /*parameter_name*/) <br>
11 { <br>
12 // do something with parameter_name. <br>
13 } <br>
$ <br>
$ cat -n test-v1.cc <br>
1 // Compile this with: <br>
2 // g++ -g -Wall -shared -o libtest-v1.so test-v1.cc <br>
3 <br>
4 struct type_base <br>
5 { <br>
6 int inserted; <br>
7 }; <br>
8 <br>
9 struct S0 : public type_base <br>
10 { <br>
11 int m0; <br>
12 }; <br>
13 <br>
14 void <br>
15 foo(S0* /*parameter_name*/) <br>
16 { <br>
17 // do something with parameter_name. <br>
18 } <br>
$ <br>
$ g++ -g -Wall -shared -o libtest-v0.so test-v0.cc <br>
$ g++ -g -Wall -shared -o libtest-v1.so test-v1.cc <br>
$ <br>
$ ../build/tools/abidiff libtest-v0.so libtest-v1.so <br>
Functions changes summary: 0 Removed, 1 Changed, 0 Added
function <br>
Variables changes summary: 0 Removed, 0 Changed, 0 Added
variable</p>

<p style="margin-top: 1em">1 function with some indirect
sub-type change:</p>

<p style="margin-top: 1em">[C]&rsquo;function void
foo(S0*)&rsquo; has some indirect sub-type changes: <br>
parameter 0 of type &rsquo;S0*&rsquo; has sub-type changes:
<br>
in pointed to type &rsquo;struct S0&rsquo;: <br>
size changed from 32 to 64 bits <br>
1 base class insertion: <br>
struct type_base <br>
1 data member change: <br>
&rsquo;int S0::m0&rsquo; offset changed from 0 to 32 <br>
$</p>

<p style="margin-top: 1em">2. Detecting another change in a
sub-type of a function:</p>

<p style="margin-top: 1em">$ cat -n test-v0.cc <br>
1 // Compile this with: <br>
2 // g++ -g -Wall -shared -o libtest-v0.so test-v0.cc <br>
3 <br>
4 struct S0 <br>
5 { <br>
6 int m0; <br>
7 }; <br>
8 <br>
9 void <br>
10 foo(S0&amp; /*parameter_name*/) <br>
11 { <br>
12 // do something with parameter_name. <br>
13 } <br>
$ <br>
$ cat -n test-v1.cc <br>
1 // Compile this with: <br>
2 // g++ -g -Wall -shared -o libtest-v1.so test-v1.cc <br>
3 <br>
4 struct S0 <br>
5 { <br>
6 char inserted_member; <br>
7 int m0; <br>
8 }; <br>
9 <br>
10 void <br>
11 foo(S0&amp; /*parameter_name*/) <br>
12 { <br>
13 // do something with parameter_name. <br>
14 } <br>
$ <br>
$ g++ -g -Wall -shared -o libtest-v0.so test-v0.cc <br>
$ g++ -g -Wall -shared -o libtest-v1.so test-v1.cc <br>
$ <br>
$ ../build/tools/abidiff libtest-v0.so libtest-v1.so <br>
Functions changes summary: 0 Removed, 1 Changed, 0 Added
function <br>
Variables changes summary: 0 Removed, 0 Changed, 0 Added
variable</p>

<p style="margin-top: 1em">1 function with some indirect
sub-type change:</p>

<p style="margin-top: 1em">[C]&rsquo;function void
foo(S0&amp;)&rsquo; has some indirect sub-type changes: <br>
parameter 0 of type &rsquo;S0&amp;&rsquo; has sub-type
changes: <br>
in referenced type &rsquo;struct S0&rsquo;: <br>
size changed from 32 to 64 bits <br>
1 data member insertion: <br>
&rsquo;char S0::inserted_member&rsquo;, at offset 0 (in
bits) <br>
1 data member change: <br>
&rsquo;int S0::m0&rsquo; offset changed from 0 to 32</p>

<p style="margin-top: 1em">$</p>

<p style="margin-top: 1em">3. Detecting that functions got
removed or added to a library:</p>

<p style="margin-top: 1em">$ cat -n test-v0.cc <br>
1 // Compile this with: <br>
2 // g++ -g -Wall -shared -o libtest-v0.so test-v0.cc <br>
3 <br>
4 struct S0 <br>
5 { <br>
6 int m0; <br>
7 }; <br>
8 <br>
9 void <br>
10 foo(S0&amp; /*parameter_name*/) <br>
11 { <br>
12 // do something with parameter_name. <br>
13 } <br>
$ <br>
$ cat -n test-v1.cc <br>
1 // Compile this with: <br>
2 // g++ -g -Wall -shared -o libtest-v1.so test-v1.cc <br>
3 <br>
4 struct S0 <br>
5 { <br>
6 char inserted_member; <br>
7 int m0; <br>
8 }; <br>
9 <br>
10 void <br>
11 bar(S0&amp; /*parameter_name*/) <br>
12 { <br>
13 // do something with parameter_name. <br>
14 } <br>
$ <br>
$ g++ -g -Wall -shared -o libtest-v0.so test-v0.cc <br>
$ g++ -g -Wall -shared -o libtest-v1.so test-v1.cc <br>
$ <br>
$ ../build/tools/abidiff libtest-v0.so libtest-v1.so <br>
Functions changes summary: 1 Removed, 0 Changed, 1 Added
functions <br>
Variables changes summary: 0 Removed, 0 Changed, 0 Added
variable</p>

<p style="margin-top: 1em">1 Removed function: <br>
&rsquo;function void foo(S0&amp;)&rsquo; {_Z3fooR2S0}</p>

<p style="margin-top: 1em">1 Added function: <br>
&rsquo;function void bar(S0&amp;)&rsquo; {_Z3barR2S0}</p>

<p style="margin-top: 1em">$</p>

<p style="margin-top: 1em">AUTHOR <br>
Dodji Seketeli</p>

<p style="margin-top: 1em">COPYRIGHT <br>
2014-2016, Red Hat, Inc.</p>

<p style="margin-top: 1em">Nov 24, 2016 ABIDIFF(1)</p>
<hr>
</body>
</html>
