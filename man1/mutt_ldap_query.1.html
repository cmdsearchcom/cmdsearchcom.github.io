<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>MUTT_LDAP_QUERY(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">MUTT_LDAP_QUERY(1)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">MUTT_LDAP_QUERY(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
mutt_ldap_query - Query LDAP server for Mutt mail-reader
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
mutt_ldap_query.pl [options] &lt;name_to_query&gt;
  [[&lt;other_name_to_query&gt;] ...]
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--config=config_file</b> or <b>-c config_file</b></dt>
  <dd class="It-tag">specify an alternate resource file other than the system
      ones ( <i>/etc/lbdb_ldap.rc</i> or <i>/etc/mutt_ldap_query.rc</i>) or
      default personal ones ( <i></i><i>$HOME</i><i>/.lbdb/ldap.rc</i> or
      <i></i> <i>$HOME</i><i>/.mutt_ldap_query.rc</i>).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--server=ldap_server</b> or <b>-ls ldap_server</b></dt>
  <dd class="It-tag">hostname of your ldap server. You can also use an
      ldap://foo[:port] or ldaps://foo[:port] URL here to talk to different
      ports or SSL encrypted servers. Or use ldapi://%2fvar%2flib%2fldap_sock to
      access an ldap server via a socket (use %2f as as replacement for a slash
      in the file name).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--search_base=ldap_search_base</b> or <b>-sb
    ldap_search_base</b></dt>
  <dd class="It-tag">use &lt;search_base&gt; as the starting point for the
      search instead of the default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--search_fields=ldap_search_fields</b> or <b>-sf
    ldap_search_fields</b></dt>
  <dd class="It-tag">list of the fields on which the query will be
    performed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--expected_answers=ldap_expected_answers</b> or <b>-ea
    ldap_expected_answers</b></dt>
  <dd class="It-tag">list of the fields expected as the answer of the ldap
      server that will be used for composing the output of the script.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--format_email=result_format_email</b> or <b>-fe
    result_format_email</b></dt>
  <dd class="It-tag">format to be used for composing the email output result. It
      has to be based on the expected ldap server answers and can use variable
      containers of the form ${variable} where variable belongs to the
      &lt;ldap_expected_answers&gt; set.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--format_realname=result_format_realname</b> or <b>-fr
    result_format_realname</b></dt>
  <dd class="It-tag">format to be used for composing the realname output result.
      It has to be based on the expected ldap server answers and can use
      variable containers of the form ${variable} where variable belongs to the
      &lt;ldap_expected_answers&gt; set.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--format_comment=result_format_comment</b> or <b>-fc
    result_format_comment</b></dt>
  <dd class="It-tag">format to be used for composing the comment output result.
      It has to be based on the expected ldap server answers and can use
      variable containers of the form ${variable} where variable belongs to the
      &lt;ldap_expected_answers&gt; set.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--bind_dn=bind_distinguished_name</b> or <b>-bd
    bind_distinguished_name</b></dt>
  <dd class="It-tag">the destinguished name of the user who binds to the LDAP
      server. Leave it empty for an anonmyous bind.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--bind_password=secret</b> or <b>-bp secret</b></dt>
  <dd class="It-tag">the bind password for binding to the LDAP server. Leave it
      empty for an anonmyous bind.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tls=1</b> or <b>--tls=0</b></dt>
  <dd class="It-tag">enable or disable transport layer security (TLS).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--sasl_mech=mechanism</b> or <b>-sm mechanism</b></dt>
  <dd class="It-tag">the SASL mechanism, for example GSSAPI (empty string to
      turn off).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--nickname=ldap_server_nickname</b> or <b>-n
    ldap_server_nickname</b></dt>
  <dd class="It-tag">shortcut for avoiding to use all the previous options by
      using the script builtin or alternate config file table of common servers
      and associated options. All the required parameters are then derived by
      performing a &lt;lbdb_server_nickname&gt; lookup.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--debug</b> or <b>-d</b></dt>
  <dd class="It-tag">turn on debugging messages.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b> or <b>-?</b> or <b>-h</b> or <b>--man</b> or
    <b>-m</b></dt>
  <dd class="It-tag">generates this help message.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ignorant</b> or <b>-i</b></dt>
  <dd class="It-tag">ignorant mode: search using wildcard for *name_to_query*
      (requires a longer processing from LDAP server but is quite convenient
    :).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--lbdb_output</b> or <b>-l</b></dt>
  <dd class="It-tag">suppress number of matches output (suited for interfacing
      with little brother database http://www.spinnaker.de/lbdb/).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--version</b> or <b>-v</b></dt>
  <dd class="It-tag">show the version.</dd>
</dl>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>mutt_ldap_query</b> performs ldap queries using either ldapsearch command or
  the perl-ldap module and it outputs the required formatted data for feeding
  mutt when using its &quot;External Address Query&quot; feature.
<div class="Pp"></div>
The output of the script consists in 3 fields separated with tabs: the email
  address, the name of the person and a comment.
<h1 class="Sh" title="Sh" id="INTERFACING_WITH_MUTT"><a class="selflink" href="#INTERFACING_WITH_MUTT">INTERFACING
  WITH MUTT</a></h1>
This perl script can be interfaced with mutt by defining in your .muttrc:
<div class="Pp"></div>
<pre>
    set query_command = &quot;mutt_ldap_query.pl %s&quot;
</pre>
<div class="Pp"></div>
Multiple requests are supported: the &quot;Q&quot; command of mutt accepts as
  argument a list of queries (e.g. &quot;Gosse de\ Courville&quot;).
<div class="Pp"></div>
Alternatively mutt_ldap_query can be interfaced with the more generic little
  brother database query program (http://www.spinnaker.de/lbdb/) using:
<div class="Pp"></div>
<pre>
    set query_command = &quot;lbdbq %s&quot;
</pre>
<div class="Pp"></div>
and by specifying in your ~/.lbdb/lbdbrc file another method of query just
  adding to the METHODS variable the m_ldap module e.g.:
<div class="Pp"></div>
<pre>
    METHODS='m_inmail m_passwd m_ldap m_muttalias m_finger'
</pre>
<div class="Pp"></div>
and the right path to access m_ldap in MODULES_PATH, e.g. if you moved
  <i>m_ldap</i> in <i>~/.lbdb/modules</i>:
<div class="Pp"></div>
<pre>
    MODULES_PATH=&quot;/usr/local/lib $HOME/.lbdb/modules&quot;
</pre>
<div class="Pp"></div>
Just make sure to use the correct path for calling mutt_ldap_query in the m_ldap
  script.
<h1 class="Sh" title="Sh" id="RESOURCE_FILE_FORMAT"><a class="selflink" href="#RESOURCE_FILE_FORMAT">RESOURCE
  FILE FORMAT</a></h1>
mutt_ldap_query is now fully customizable using an external resource file. By
  default mutt_ldap_query parses the system definition file located generally at
  <i>/etc/mutt_ldap_query.rc</i> or <i>/usr/local/etc/mutt_ldap_query.rc</i> and
  also the user one: <i></i><i>$HOME</i><i>/.mutt_ldap_query.rc</i>.
<div class="Pp"></div>
Instead of using command line options, the user can redefine all the variables
  using the resource file by two manners in order to match his site
  configuration. A file example is provided below:
<div class="Pp"></div>
<pre>
    # The format of each entry of the ldap server database is the following:
    # LDAP_NICKNAME =&gt; ['LDAP_SERVER', 
    #                   'LDAP_SEARCH_BASE',
    #                   'LDAP_SEARCH_FIELDS',
    #                   'LDAP_EXPECTED_ANSWERS',
    #                   'LDAP_RESULT_EMAIL',
    #                   'LDAP_RESULT_REALNAME',
    #                   'LDAP_RESULT_COMMENT'],
    # a practical illustrating example being:
    #  debian   =&gt; ['db.debian.org',
    #               'ou=users,dc=debian,dc=org',
    #               'uid cn sn ircnick',
    #               'uid cn sn ircnick',
    #               '${uid}@debian.org',
    #               '${cn} ${sn}',
    #               '${ircnick}'],
    # the output of the query will be then: 
    # ${uid}@debian.org\t${cn} ${sn}\t${ircnick} (i.e.: email name comment)
    # warning this database will erase default script builtin
    %ldap_server_db = (
      'four11'          =&gt; ['ldap.four11.com',
                            'c=US',
                            'givenname sn cn mail',
                            'givenname cn sn mail o',
                            '${mail}',
                            '${givenname} ${sn}',
                            '${o}' ],
      'infospace'       =&gt; ['ldap.infospace.com',
                            'c=US',
                            'givenname sn cn mail',
                            'givenname cn sn mail o',
                            '${mail}',
                            '${givenname} ${sn}',
                            '${o}' ],
      'whowhere'        =&gt; ['ldap.whowhere.com',
                            'c=US',
                            'givenname sn cn mail',
                            'givenname cn sn mail o',
                            '${mail}',
                            '${givenname} ${sn}',
                            '${o}' ],
      'bigfoot'         =&gt; ['ldap.bigfoot.com',
                            'c=US',
                            'givenname sn cn mail'
                           , 'givenname cn sn mail o'
                           , '${mail}'
                           , '${givenname} ${sn}',
                            '${o}' ],
      'switchboard'     =&gt; ['ldap.switchboard.com',
                            'c=US',
                            'givenname sn cn mail'
                           , 'givenname cn sn mail o',
                            '${mail}',
                            '${givenname} ${sn}',
                            '${o}' ],
      'infospacebiz'    =&gt; ['ldapbiz.infospace.com',
                            'c=US',
                            'givenname sn cn mail',
                            'givenname cn sn mail o',
                            '${mail}',
                            '${givenname} ${sn}',
                            '${o}' ],
    );
    # hostname of your ldap server
    $ldap_server = 'ldap.four11.com';
    # ldap base search
    $search_base = 'c=US';
    # list of the fields that will be used for the query
    $ldap_search_fields = 'givenname sn cn mail';
    # list of the fields that will be used for composing the answer
    $ldap_expected_answers = 'givenname sn cn mail o';
    # format of the email result based on the expected answers of the ldap query
    $ldap_result_email = '${mail}';
    # format of the realname result based on the expected answers of the ldap query
    $ldap_result_realname = '${givenname} ${sn}';
    # format of the comment result based on the expected answers of the ldap query
    $ldap_result_comment = '(${o})';
</pre>
<h1 class="Sh" title="Sh" id="EXAMPLES_OF_QUERIES"><a class="selflink" href="#EXAMPLES_OF_QUERIES">EXAMPLES
  OF QUERIES</a></h1>
<pre>
    mutt_ldap_query.pl --ldap_server='ldap.mot.com' \
       --search_base='ou=employees, o=Motorola,c=US' \
       --ldap_search_fields='commonName gn sn cn uid' \
       --ldap_expected_answers='gn sn preferredRfc822Recipient ou c telephonenumber' \
       --ldap_result_email='${preferredRfc822Recipient}' \
       --ldap_result_realname='${gn} ${sn}' \
       --ldap_result_comment='(${telephonenumber}) ${ou} ${c}' \
       Gosse de\ Courville
</pre>
<div class="Pp"></div>
performs a query using the ldap server ldap.mot.com using the following
  searching base 'ou=employees, o=Motorola,c=US' and performing a search on the
  fields 'commonName gn sn cn uid' for 'Gosse' and then &quot;de Courville&quot;
  looking for the following answers 'gn sn preferredRfc822Recipient ou c
  telephonenumber'. Based on this answers, mutt_ldap_query will return a list of
  entries identified of the form:
<div class="Pp"></div>
<pre>
  &lt;${preferredRfc822Recipient}&gt;\t${gn} ${sn}\t(${telephonenumber}) ${ou} ${c}
</pre>
<div class="Pp"></div>
where ${} variables should be considered as containers that are replaced by the
  results of the query. The previous query can be greatly simplified by using
  the ldap server mini database feature of the resource file introducing for
  example a nickname.
<div class="Pp"></div>
<pre>
    mutt_ldap_query.pl --ldap_server_nickname='motorola' Gosse de\ Courville
</pre>
<div class="Pp"></div>
When not sure of the full name (i.e. it should contain Courville) the ignorant
  mode is useful since the query will be performed using wildcards, i.e.
  *Courville* in the following case:
<div class="Pp"></div>
<pre>
    mutt_ldap_query.pl --ignorant Courville
</pre>
<h1 class="Sh" title="Sh" id="WHERE_TO_GET_IT"><a class="selflink" href="#WHERE_TO_GET_IT">WHERE
  TO GET IT</a></h1>
The latest version can be retrieved at
<br/>
 ftp://ftp.mutt.org/pub/mutt/contrib or
<br/>
 http://www.courville.org/
<div class="Pp"></div>
Note that now the script is integrated in the latest version of the little
  brother database available at http://www.spinnaker.de/lbdb/. It is thus easier
  to use through this standard package than to hand customize it to fit your
  system/distribution needs.
<h1 class="Sh" title="Sh" id="REFERENCES"><a class="selflink" href="#REFERENCES">REFERENCES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag">-</dt>
  <dd class="It-tag">perl-ldap module
    <br/>
     http://perl-ldap.sourceforge.net/</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-</dt>
  <dd class="It-tag">mutt is the ultimate email client
    <br/>
     http://www.mutt.org/</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-</dt>
  <dd class="It-tag">historical Brandon Blong's &quot;External Address
      Query&quot; feature patch for mutt
    <br/>
     http://www.fiction.net/blong/programs/mutt/#query</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-</dt>
  <dd class="It-tag">little brother database is an interface query program for
      mutt that allow multiple searches for email addresses based on external
      query scripts just like this one 8-)
    <br/>
     http://www.spinnaker.de/lbdb/</dd>
</dl>
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
Marc de Courville &lt;marc@courville.org&gt; and the various other
  contributors... that kindly sent their patches.
<div class="Pp"></div>
Please report any bugs, or post any suggestions, to &lt;marc@courville.org&gt;.
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
Copyright (c) 1998-2003 Marc de Courville &lt;marc@courville.org&gt;. All rights
  reserved. This program is free software; you can redistribute it and/or modify
  it under the GNU General Public License (GPL). See
  http://www.opensource.org/gpl-license.html and
  http://www.opensource.org/.</div>
<table class="foot">
  <tr>
    <td class="foot-date">2016-12-11</td>
    <td class="foot-os">perl v5.24.1</td>
  </tr>
</table>
</body>
</html>
