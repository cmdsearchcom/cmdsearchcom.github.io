<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:31:42 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>PKCS12(1) OpenSSL PKCS12(1)</p>

<p style="margin-top: 1em">NAME <br>
pkcs12 - PKCS#12 file utility</p>

<p style="margin-top: 1em">SYNOPSIS <br>
openssl pkcs12 [-export] [-chain] [-inkey filename]
[-certfile filename] [-name name] [-caname name] [-in
filename] [-out filename] [-noout] [-nomacver] [-nocerts]
[-clcerts] <br>
[-cacerts] [-nokeys] [-info] [-des | -des3 | -idea | -aes128
| -aes192 | -aes256 | -camellia128 | -camellia192 |
-camellia256 | -nodes] [-noiter] [-maciter | -nomaciter |
-nomac] <br>
[-twopass] [-descert] [-certpbe cipher] [-keypbe cipher]
[-macalg digest] [-keyex] [-keysig] [-password arg] [-passin
arg] [-passout arg] [-rand file(s)] [-CAfile file] [-CApath
<br>
dir] [-CSP name]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
The pkcs12 command allows PKCS#12 files (sometimes referred
to as PFX files) to be created and parsed. PKCS#12 files are
used by several programs including Netscape, MSIE and MS
<br>
Outlook.</p>

<p style="margin-top: 1em">COMMAND OPTIONS <br>
There are a lot of options the meaning of some depends of
whether a PKCS#12 file is being created or parsed. By
default a PKCS#12 file is parsed. A PKCS#12 file can be
created by <br>
using the -export option (see below).</p>

<p style="margin-top: 1em">PARSING OPTIONS <br>
-in filename <br>
This specifies filename of the PKCS#12 file to be parsed.
Standard input is used by default.</p>

<p style="margin-top: 1em">-out filename <br>
The filename to write certificates and private keys to,
standard output by default. They are all written in PEM
format.</p>

<p style="margin-top: 1em">-pass arg, -passin arg <br>
the PKCS#12 file (i.e. input file) password source. For more
information about the format of arg see the PASS PHRASE
ARGUMENTS section in openssl(1).</p>

<p style="margin-top: 1em">-passout arg <br>
pass phrase source to encrypt any outputed private keys
with. For more information about the format of arg see the
PASS PHRASE ARGUMENTS section in openssl(1).</p>

<p style="margin-top: 1em">-noout <br>
this option inhibits output of the keys and certificates to
the output file version of the PKCS#12 file.</p>

<p style="margin-top: 1em">-clcerts <br>
only output client certificates (not CA certificates).</p>

<p style="margin-top: 1em">-cacerts <br>
only output CA certificates (not client certificates).</p>

<p style="margin-top: 1em">-nocerts <br>
no certificates at all will be output.</p>

<p style="margin-top: 1em">-nokeys <br>
no private keys will be output.</p>

<p style="margin-top: 1em">-info <br>
output additional information about the PKCS#12 file
structure, algorithms used and iteration counts.</p>

<p style="margin-top: 1em">-des <br>
use DES to encrypt private keys before outputting.</p>

<p style="margin-top: 1em">-des3 <br>
use triple DES to encrypt private keys before outputting,
this is the default.</p>

<p style="margin-top: 1em">-idea <br>
use IDEA to encrypt private keys before outputting.</p>

<p style="margin-top: 1em">-aes128, -aes192, -aes256 <br>
use AES to encrypt private keys before outputting.</p>

<p style="margin-top: 1em">-camellia128, -camellia192,
-camellia256 <br>
use Camellia to encrypt private keys before outputting.</p>

<p style="margin-top: 1em">-nodes <br>
don&rsquo;t encrypt the private keys at all.</p>

<p style="margin-top: 1em">-nomacver <br>
don&rsquo;t attempt to verify the integrity MAC before
reading the file.</p>

<p style="margin-top: 1em">-twopass <br>
prompt for separate integrity and encryption passwords: most
software always assumes these are the same so this option
will render such PKCS#12 files unreadable.</p>

<p style="margin-top: 1em">FILE CREATION OPTIONS <br>
-export <br>
This option specifies that a PKCS#12 file will be created
rather than parsed.</p>

<p style="margin-top: 1em">-out filename <br>
This specifies filename to write the PKCS#12 file to.
Standard output is used by default.</p>

<p style="margin-top: 1em">-in filename <br>
The filename to read certificates and private keys from,
standard input by default. They must all be in PEM format.
The order doesn&rsquo;t matter but one private key and its
<br>
corresponding certificate should be present. If additional
certificates are present they will also be included in the
PKCS#12 file.</p>

<p style="margin-top: 1em">-inkey filename <br>
file to read private key from. If not present then a private
key must be present in the input file.</p>

<p style="margin-top: 1em">-name friendlyname <br>
This specifies the &quot;friendly name&quot; for the
certificate and private key. This name is typically
displayed in list boxes by software importing the file.</p>

<p style="margin-top: 1em">-certfile filename <br>
A filename to read additional certificates from.</p>

<p style="margin-top: 1em">-caname friendlyname <br>
This specifies the &quot;friendly name&quot; for other
certificates. This option may be used multiple times to
specify names for all certificates in the order they appear.
Netscape <br>
ignores friendly names on other certificates whereas MSIE
displays them.</p>

<p style="margin-top: 1em">-pass arg, -passout arg <br>
the PKCS#12 file (i.e. output file) password source. For
more information about the format of arg see the PASS PHRASE
ARGUMENTS section in openssl(1).</p>

<p style="margin-top: 1em">-passin password <br>
pass phrase source to decrypt any input private keys with.
For more information about the format of arg see the PASS
PHRASE ARGUMENTS section in openssl(1).</p>

<p style="margin-top: 1em">-chain <br>
if this option is present then an attempt is made to include
the entire certificate chain of the user certificate. The
standard CA store is used for this search. If the <br>
search fails it is considered a fatal error.</p>

<p style="margin-top: 1em">-descert <br>
encrypt the certificate using triple DES, this may render
the PKCS#12 file unreadable by some &quot;export grade&quot;
software. By default the private key is encrypted using
triple <br>
DES and the certificate using 40 bit RC2.</p>

<p style="margin-top: 1em">-keypbe alg, -certpbe alg <br>
these options allow the algorithm used to encrypt the
private key and certificates to be selected. Any PKCS#5 v1.5
or PKCS#12 PBE algorithm name can be used (see NOTES <br>
section for more information). If a a cipher name (as output
by the list-cipher-algorithms command is specified then it
is used with PKCS#5 v2.0. For interoperability reasons <br>
it is advisable to only use PKCS#12 algorithms.</p>

<p style="margin-top: 1em">-keyex|-keysig <br>
specifies that the private key is to be used for key
exchange or just signing. This option is only interpreted by
MSIE and similar MS software. Normally &quot;export
grade&quot; <br>
software will only allow 512 bit RSA keys to be used for
encryption purposes but arbitrary length keys for signing.
The -keysig option marks the key for signing only. Signing
<br>
only keys can be used for S/MIME signing, authenticode
(ActiveX control signing) and SSL client authentication,
however due to a bug only MSIE 5.0 and later support the use
<br>
of signing only keys for SSL client authentication.</p>

<p style="margin-top: 1em">-macalg digest <br>
specify the MAC digest algorithm. If not included them SHA1
will be used.</p>

<p style="margin-top: 1em">-nomaciter, -noiter <br>
these options affect the iteration counts on the MAC and key
algorithms. Unless you wish to produce files compatible with
MSIE 4.0 you should leave these options alone.</p>

<p style="margin-top: 1em">To discourage attacks by using
large dictionaries of common passwords the algorithm that
derives keys from passwords can have an iteration count
applied to it: this causes a <br>
certain part of the algorithm to be repeated and slows it
down. The MAC is used to check the file integrity but since
it will normally have the same password as the keys and <br>
certificates it could also be attacked. By default both MAC
and encryption iteration counts are set to 2048, using these
options the MAC and encryption iteration counts can <br>
be set to 1, since this reduces the file security you should
not use these options unless you really have to. Most
software supports both MAC and key iteration counts. MSIE
<br>
4.0 doesn&rsquo;t support MAC iteration counts so it needs
the -nomaciter option.</p>

<p style="margin-top: 1em">-maciter <br>
This option is included for compatibility with previous
versions, it used to be needed to use MAC iterations counts
but they are now used by default.</p>

<p style="margin-top: 1em">-nomac <br>
don&rsquo;t attempt to provide the MAC integrity.</p>

<p style="margin-top: 1em">-rand file(s) <br>
a file or files containing random data used to seed the
random number generator, or an EGD socket (see RAND_egd(3)).
Multiple files can be specified separated by a OS- <br>
dependent character. The separator is ; for MS-Windows, ,
for OpenVMS, and : for all others.</p>

<p style="margin-top: 1em">-CAfile file <br>
CA storage as a file.</p>

<p style="margin-top: 1em">-CApath dir <br>
CA storage as a directory. This directory must be a standard
certificate directory: that is a hash of each subject name
(using x509 -hash) should be linked to each <br>
certificate.</p>

<p style="margin-top: 1em">-CSP name <br>
write name as a Microsoft CSP name.</p>

<p style="margin-top: 1em">NOTES <br>
Although there are a large number of options most of them
are very rarely used. For PKCS#12 file parsing only -in and
-out need to be used for PKCS#12 file creation -export and
<br>
-name are also used.</p>

<p style="margin-top: 1em">If none of the -clcerts,
-cacerts or -nocerts options are present then all
certificates will be output in the order they appear in the
input PKCS#12 files. There is no guarantee <br>
that the first certificate present is the one corresponding
to the private key. Certain software which requires a
private key and certificate and assumes the first
certificate in <br>
the file is the one corresponding to the private key: this
may not always be the case. Using the -clcerts option will
solve this problem by only outputting the certificate <br>
corresponding to the private key. If the CA certificates are
required then they can be output to a separate file using
the -nokeys -cacerts options to just output CA <br>
certificates.</p>

<p style="margin-top: 1em">The -keypbe and -certpbe
algorithms allow the precise encryption algorithms for
private keys and certificates to be specified. Normally the
defaults are fine but occasionally <br>
software can&rsquo;t handle triple DES encrypted private
keys, then the option -keypbe PBE-SHA1-RC2-40 can be used to
reduce the private key encryption to 40 bit RC2. A complete
<br>
description of all algorithms is contained in the pkcs8
manual page.</p>

<p style="margin-top: 1em">EXAMPLES <br>
Parse a PKCS#12 file and output it to a file:</p>

<p style="margin-top: 1em">openssl pkcs12 -in file.p12 -out
file.pem</p>

<p style="margin-top: 1em">Output only client certificates
to a file:</p>

<p style="margin-top: 1em">openssl pkcs12 -in file.p12
-clcerts -out file.pem</p>

<p style="margin-top: 1em">Don&rsquo;t encrypt the private
key:</p>

<p style="margin-top: 1em">openssl pkcs12 -in file.p12 -out
file.pem -nodes</p>

<p style="margin-top: 1em">Print some info about a PKCS#12
file:</p>

<p style="margin-top: 1em">openssl pkcs12 -in file.p12
-info -noout</p>

<p style="margin-top: 1em">Create a PKCS#12 file:</p>

<p style="margin-top: 1em">openssl pkcs12 -export -in
file.pem -out file.p12 -name &quot;My Certificate&quot;</p>

<p style="margin-top: 1em">Include some extra
certificates:</p>

<p style="margin-top: 1em">openssl pkcs12 -export -in
file.pem -out file.p12 -name &quot;My Certificate&quot;
-certfile othercerts.pem</p>

<p style="margin-top: 1em">BUGS <br>
Some would argue that the PKCS#12 standard is one big bug
:-)</p>

<p style="margin-top: 1em">Versions of OpenSSL before
0.9.6a had a bug in the PKCS#12 key generation routines.
Under rare circumstances this could produce a PKCS#12 file
encrypted with an invalid key. As a <br>
result some PKCS#12 files which triggered this bug from
other implementations (MSIE or Netscape) could not be
decrypted by OpenSSL and similarly OpenSSL could produce
PKCS#12 <br>
files which could not be decrypted by other implementations.
The chances of producing such a file are relatively small:
less than 1 in 256.</p>

<p style="margin-top: 1em">A side effect of fixing this bug
is that any old invalidly encrypted PKCS#12 files cannot no
longer be parsed by the fixed version. Under such
circumstances the pkcs12 utility <br>
will report that the MAC is OK but fail with a decryption
error when extracting private keys.</p>

<p style="margin-top: 1em">This problem can be resolved by
extracting the private keys and certificates from the
PKCS#12 file using an older version of OpenSSL and
recreating the PKCS#12 file from the keys <br>
and certificates using a newer version of OpenSSL. For
example:</p>

<p style="margin-top: 1em">old-openssl -in bad.p12 -out
keycerts.pem <br>
openssl -in keycerts.pem -export -name &quot;My PKCS#12
file&quot; -out fixed.p12</p>

<p style="margin-top: 1em">SEE ALSO <br>
pkcs8(1)</p>

<p style="margin-top: 1em">1.0.1e 2013-02-11 PKCS12(1)</p>
<hr>
</body>
</html>
