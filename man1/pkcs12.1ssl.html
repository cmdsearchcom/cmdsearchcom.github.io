<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>PKCS12(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">PKCS12(1)</td>
    <td class="head-vol">OpenSSL</td>
    <td class="head-rtitle">PKCS12(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
pkcs12 - PKCS#12 file utility
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>openssl</b> <b>pkcs12</b> [ <b>-export</b>] [ <b>-chain</b>] [ <b>-inkey
  filename</b>] [ <b>-certfile filename</b>] [ <b>-name name</b>] [ <b>-caname
  name</b>] [ <b>-in filename</b>] [ <b>-out filename</b>] [ <b>-noout</b>] [
  <b>-nomacver</b>] [ <b>-nocerts</b>] [ <b>-clcerts</b>] [ <b>-cacerts</b>] [
  <b>-nokeys</b>] [ <b>-info</b>] [ <b>-des | -des3 | -idea | -aes128 | -aes192
  | -aes256 | -camellia128 | -camellia192 | -camellia256 | -nodes</b>] [
  <b>-noiter</b>] [ <b>-maciter | -nomaciter | -nomac</b>] [ <b>-twopass</b>] [
  <b>-descert</b>] [ <b>-certpbe cipher</b>] [ <b>-keypbe cipher</b>] [
  <b>-macalg digest</b>] [ <b>-keyex</b>] [ <b>-keysig</b>] [ <b>-password
  arg</b>] [ <b>-passin arg</b>] [ <b>-passout arg</b>] [ <b>-rand file(s)</b>]
  [ <b>-CAfile file</b>] [ <b>-CApath dir</b>] [ <b>-CSP name</b>]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <b>pkcs12</b> command allows PKCS#12 files (sometimes referred to as PFX
  files) to be created and parsed. PKCS#12 files are used by several programs
  including Netscape, MSIE and MS Outlook.
<h1 class="Sh" title="Sh" id="COMMAND_OPTIONS"><a class="selflink" href="#COMMAND_OPTIONS">COMMAND
  OPTIONS</a></h1>
There are a lot of options the meaning of some depends of whether a PKCS#12 file
  is being created or parsed. By default a PKCS#12 file is parsed. A PKCS#12
  file can be created by using the <b>-export</b> option (see below).
<h1 class="Sh" title="Sh" id="PARSING_OPTIONS"><a class="selflink" href="#PARSING_OPTIONS">PARSING
  OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-in filename</b></dt>
  <dd class="It-tag">This specifies filename of the PKCS#12 file to be parsed.
      Standard input is used by default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-out filename</b></dt>
  <dd class="It-tag">The filename to write certificates and private keys to,
      standard output by default. They are all written in PEM format.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-pass arg</b>, <b>-passin arg</b></dt>
  <dd class="It-tag">the PKCS#12 file (i.e. input file) password source. For
      more information about the format of <b>arg</b> see the <b>PASS PHRASE
      ARGUMENTS</b> section in <i>openssl</i>(1).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-passout arg</b></dt>
  <dd class="It-tag">pass phrase source to encrypt any outputed private keys
      with. For more information about the format of <b>arg</b> see the <b>PASS
      PHRASE ARGUMENTS</b> section in <i>openssl</i>(1).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-noout</b></dt>
  <dd class="It-tag">this option inhibits output of the keys and certificates to
      the output file version of the PKCS#12 file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-clcerts</b></dt>
  <dd class="It-tag">only output client certificates (not CA certificates).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-cacerts</b></dt>
  <dd class="It-tag">only output CA certificates (not client certificates).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-nocerts</b></dt>
  <dd class="It-tag">no certificates at all will be output.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-nokeys</b></dt>
  <dd class="It-tag">no private keys will be output.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-info</b></dt>
  <dd class="It-tag">output additional information about the PKCS#12 file
      structure, algorithms used and iteration counts.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-des</b></dt>
  <dd class="It-tag">use DES to encrypt private keys before outputting.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-des3</b></dt>
  <dd class="It-tag">use triple DES to encrypt private keys before outputting,
      this is the default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-idea</b></dt>
  <dd class="It-tag">use IDEA to encrypt private keys before outputting.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-aes128</b>, <b>-aes192</b>, <b>-aes256</b></dt>
  <dd class="It-tag">use AES to encrypt private keys before outputting.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-camellia128</b>, <b>-camellia192</b>,
    <b>-camellia256</b></dt>
  <dd class="It-tag">use Camellia to encrypt private keys before
    outputting.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-nodes</b></dt>
  <dd class="It-tag">don't encrypt the private keys at all.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-nomacver</b></dt>
  <dd class="It-tag">don't attempt to verify the integrity MAC before reading
      the file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-twopass</b></dt>
  <dd class="It-tag">prompt for separate integrity and encryption passwords:
      most software always assumes these are the same so this option will render
      such PKCS#12 files unreadable.</dd>
</dl>
<h1 class="Sh" title="Sh" id="FILE_CREATION_OPTIONS"><a class="selflink" href="#FILE_CREATION_OPTIONS">FILE
  CREATION OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-export</b></dt>
  <dd class="It-tag">This option specifies that a PKCS#12 file will be created
      rather than parsed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-out filename</b></dt>
  <dd class="It-tag">This specifies filename to write the PKCS#12 file to.
      Standard output is used by default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-in filename</b></dt>
  <dd class="It-tag">The filename to read certificates and private keys from,
      standard input by default. They must all be in PEM format. The order
      doesn't matter but one private key and its corresponding certificate
      should be present. If additional certificates are present they will also
      be included in the PKCS#12 file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-inkey filename</b></dt>
  <dd class="It-tag">file to read private key from. If not present then a
      private key must be present in the input file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-name friendlyname</b></dt>
  <dd class="It-tag">This specifies the &quot;friendly name&quot; for the
      certificate and private key. This name is typically displayed in list
      boxes by software importing the file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-certfile filename</b></dt>
  <dd class="It-tag">A filename to read additional certificates from.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-caname friendlyname</b></dt>
  <dd class="It-tag">This specifies the &quot;friendly name&quot; for other
      certificates. This option may be used multiple times to specify names for
      all certificates in the order they appear. Netscape ignores friendly names
      on other certificates whereas MSIE displays them.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-pass arg</b>, <b>-passout arg</b></dt>
  <dd class="It-tag">the PKCS#12 file (i.e. output file) password source. For
      more information about the format of <b>arg</b> see the <b>PASS PHRASE
      ARGUMENTS</b> section in <i>openssl</i>(1).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-passin password</b></dt>
  <dd class="It-tag">pass phrase source to decrypt any input private keys with.
      For more information about the format of <b>arg</b> see the <b>PASS PHRASE
      ARGUMENTS</b> section in <i>openssl</i>(1).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-chain</b></dt>
  <dd class="It-tag">if this option is present then an attempt is made to
      include the entire certificate chain of the user certificate. The standard
      CA store is used for this search. If the search fails it is considered a
      fatal error.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-descert</b></dt>
  <dd class="It-tag">encrypt the certificate using triple DES, this may render
      the PKCS#12 file unreadable by some &quot;export grade&quot; software. By
      default the private key is encrypted using triple DES and the certificate
      using 40 bit RC2.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-keypbe alg</b>, <b>-certpbe alg</b></dt>
  <dd class="It-tag">these options allow the algorithm used to encrypt the
      private key and certificates to be selected. Any PKCS#5 v1.5 or PKCS#12
      PBE algorithm name can be used (see <b>NOTES</b> section for more
      information). If a a cipher name (as output by the
      <b>list-cipher-algorithms</b> command is specified then it is used with
      PKCS#5 v2.0. For interoperability reasons it is advisable to only use
      PKCS#12 algorithms.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-keyex|-keysig</b></dt>
  <dd class="It-tag">specifies that the private key is to be used for key
      exchange or just signing. This option is only interpreted by MSIE and
      similar MS software. Normally &quot;export grade&quot; software will only
      allow 512 bit RSA keys to be used for encryption purposes but arbitrary
      length keys for signing. The <b>-keysig</b> option marks the key for
      signing only. Signing only keys can be used for S/MIME signing,
      authenticode (ActiveX control signing) and SSL client authentication,
      however due to a bug only MSIE 5.0 and later support the use of signing
      only keys for SSL client authentication.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-macalg digest</b></dt>
  <dd class="It-tag">specify the MAC digest algorithm. If not included them SHA1
      will be used.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-nomaciter</b>, <b>-noiter</b></dt>
  <dd class="It-tag">these options affect the iteration counts on the MAC and
      key algorithms. Unless you wish to produce files compatible with MSIE 4.0
      you should leave these options alone.
    <div style="height: 1.00em;">&#x00A0;</div>
    To discourage attacks by using large dictionaries of common passwords the
      algorithm that derives keys from passwords can have an iteration count
      applied to it: this causes a certain part of the algorithm to be repeated
      and slows it down. The MAC is used to check the file integrity but since
      it will normally have the same password as the keys and certificates it
      could also be attacked. By default both MAC and encryption iteration
      counts are set to 2048, using these options the MAC and encryption
      iteration counts can be set to 1, since this reduces the file security you
      should not use these options unless you really have to. Most software
      supports both MAC and key iteration counts. MSIE 4.0 doesn't support MAC
      iteration counts so it needs the <b>-nomaciter</b> option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-maciter</b></dt>
  <dd class="It-tag">This option is included for compatibility with previous
      versions, it used to be needed to use MAC iterations counts but they are
      now used by default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-nomac</b></dt>
  <dd class="It-tag">don't attempt to provide the MAC integrity.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-rand file(s)</b></dt>
  <dd class="It-tag">a file or files containing random data used to seed the
      random number generator, or an EGD socket (see <i>RAND_egd</i>(3)).
      Multiple files can be specified separated by a OS-dependent character. The
      separator is <b>;</b> for MS-Windows, <b>,</b> for OpenVMS, and <b>:</b>
      for all others.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-CAfile file</b></dt>
  <dd class="It-tag">CA storage as a file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-CApath dir</b></dt>
  <dd class="It-tag">CA storage as a directory. This directory must be a
      standard certificate directory: that is a hash of each subject name (using
      <b>x509 -hash</b>) should be linked to each certificate.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-CSP name</b></dt>
  <dd class="It-tag">write <b>name</b> as a Microsoft CSP name.</dd>
</dl>
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
Although there are a large number of options most of them are very rarely used.
  For PKCS#12 file parsing only <b>-in</b> and <b>-out</b> need to be used for
  PKCS#12 file creation <b>-export</b> and <b>-name</b> are also used.
<div class="Pp"></div>
If none of the <b>-clcerts</b>, <b>-cacerts</b> or <b>-nocerts</b> options are
  present then all certificates will be output in the order they appear in the
  input PKCS#12 files. There is no guarantee that the first certificate present
  is the one corresponding to the private key. Certain software which requires a
  private key and certificate and assumes the first certificate in the file is
  the one corresponding to the private key: this may not always be the case.
  Using the <b>-clcerts</b> option will solve this problem by only outputting
  the certificate corresponding to the private key. If the CA certificates are
  required then they can be output to a separate file using the <b>-nokeys
  -cacerts</b> options to just output CA certificates.
<div class="Pp"></div>
The <b>-keypbe</b> and <b>-certpbe</b> algorithms allow the precise encryption
  algorithms for private keys and certificates to be specified. Normally the
  defaults are fine but occasionally software can't handle triple DES encrypted
  private keys, then the option <b>-keypbe PBE-SHA1-RC2-40</b> can be used to
  reduce the private key encryption to 40 bit RC2. A complete description of all
  algorithms is contained in the <b>pkcs8</b> manual page.
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
Parse a PKCS#12 file and output it to a file:
<div class="Pp"></div>
<pre>
 openssl pkcs12 -in file.p12 -out file.pem
</pre>
<div class="Pp"></div>
Output only client certificates to a file:
<div class="Pp"></div>
<pre>
 openssl pkcs12 -in file.p12 -clcerts -out file.pem
</pre>
<div class="Pp"></div>
Don't encrypt the private key:
<div class="Pp"></div>
<pre>
 openssl pkcs12 -in file.p12 -out file.pem -nodes
</pre>
<div class="Pp"></div>
Print some info about a PKCS#12 file:
<div class="Pp"></div>
<pre>
 openssl pkcs12 -in file.p12 -info -noout
</pre>
<div class="Pp"></div>
Create a PKCS#12 file:
<div class="Pp"></div>
<pre>
 openssl pkcs12 -export -in file.pem -out file.p12 -name &quot;My Certificate&quot;
</pre>
<div class="Pp"></div>
Include some extra certificates:
<div class="Pp"></div>
<pre>
 openssl pkcs12 -export -in file.pem -out file.p12 -name &quot;My Certificate&quot; \
  -certfile othercerts.pem
</pre>
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Some would argue that the PKCS#12 standard is one big bug :-)
<div class="Pp"></div>
Versions of OpenSSL before 0.9.6a had a bug in the PKCS#12 key generation
  routines. Under rare circumstances this could produce a PKCS#12 file encrypted
  with an invalid key. As a result some PKCS#12 files which triggered this bug
  from other implementations (MSIE or Netscape) could not be decrypted by
  OpenSSL and similarly OpenSSL could produce PKCS#12 files which could not be
  decrypted by other implementations. The chances of producing such a file are
  relatively small: less than 1 in 256.
<div class="Pp"></div>
A side effect of fixing this bug is that any old invalidly encrypted PKCS#12
  files cannot no longer be parsed by the fixed version. Under such
  circumstances the <b>pkcs12</b> utility will report that the MAC is OK but
  fail with a decryption error when extracting private keys.
<div class="Pp"></div>
This problem can be resolved by extracting the private keys and certificates
  from the PKCS#12 file using an older version of OpenSSL and recreating the
  PKCS#12 file from the keys and certificates using a newer version of OpenSSL.
  For example:
<div class="Pp"></div>
<pre>
 old-openssl -in bad.p12 -out keycerts.pem
 openssl -in keycerts.pem -export -name &quot;My PKCS#12 file&quot; -out fixed.p12
</pre>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i>pkcs8</i>(1)</div>
<table class="foot">
  <tr>
    <td class="foot-date">2013-02-11</td>
    <td class="foot-os">1.0.1e</td>
  </tr>
</table>
</body>
</html>
