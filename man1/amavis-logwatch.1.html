<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>AMAVIS-LOGWATCH(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">AMAVIS-LOGWATCH(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">AMAVIS-LOGWATCH(1)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
amavis-logwatch - An Amavisd-new log parser and analysis utility
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<br/>
<b>amavis-logwatch</b> [<i>options</i>] [<i>logfile ...</i>]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<br/>
The <b>amavis-logwatch</b>(1) utility is an Amavisd-new log parser that produces
  summaries, details, and statistics regarding the operation of Amavisd-new
  (henceforth, simply called Amavis).
<div class="Pp"></div>
This utility can be used as a standalone program, or as a Logwatch filter module
  to produce Amavisd-new summary and detailed reports from within Logwatch.
<div class="Pp"></div>
<b>Amavis-logwatch</b> is able to produce a wide range of reports with data
  grouped and sorted as much as possible to reduce noise and highlight patterns.
  Brief summary reports provide a quick overview of general Amavis operations
  and message delivery, calling out warnings that may require attention.
  Detailed reports provide easy to scan, hierarchically-arranged and organized
  information, with as much or little detail as desired.
<div class="Pp"></div>
Much of the interesting data is available when Amavis' $log_level is set to at
  least 2. See <b>Amavis Log Level</b> below.
<div class="Pp"></div>
<b>Amavis-logwatch</b> outputs two principal sections: a <b>Summary</b> section
  and a <b>Detailed</b> section. For readability and quick scanning, all event
  or hit counts appear in the left column, followed by brief description of the
  event type, and finally additional statistics or count representations may
  appear in the rightmost column.
<div style="height: 1.00em;">&#x00A0;</div>
The following segment from a sample Summary report illustrates:
<div style="margin-left: 4.00ex;">
<pre>
<div class="Pp"></div>
****** Summary ********************************************
<div class="Pp"></div>
       9   Miscellaneous warnings 
<div class="Pp"></div>
   20313   Total messages scanned ----------------  100.00%
1008.534M  Total bytes scanned                1,057,524,252
========   ================================================
<div class="Pp"></div>
    1190   Blocked -------------------------------    5.86%
      18     Malware blocked                          0.09%
       4     Banned name blocked                      0.02%
     416     Spam blocked                             2.05%
     752     Spam discarded (no quarantine)           3.70%
<div class="Pp"></div>
   19123   Passed --------------------------------   94.14%
      47     Bad header passed                        0.23%
   19076     Clean passed                            93.91%
========   ================================================
<div class="Pp"></div>
      18   Malware -------------------------------    0.09%
      18     Malware blocked                          0.09%
<div class="Pp"></div>
       4   Banned --------------------------------    0.02%
       4     Banned file blocked                      0.02%
<div class="Pp"></div>
    1168   Spam ----------------------------------    5.75%
     416     Spam blocked                             2.05%
     752     Spam discarded (no quarantine)           3.70%
<div class="Pp"></div>
   19123   Ham -----------------------------------   94.14%
      47     Bad header passed                        0.23%
   19076     Clean passed                            93.91%
========   ================================================
<div class="Pp"></div>
    1982   SpamAssassin bypassed 
      32   Released from quarantine 
       2   DSN notification (debug supplemental) 
       2   Bounce unverifiable   
    2369   Whitelisted           
       2   Blacklisted           
      12   MIME error            
      58   Bad header (debug supplemental) 
      40   Extra code modules loaded at runtime 
<div class="Pp"></div>
</pre>
</div>
The report indicates there were 9 general warnings, and <b>Amavis</b> scanned a
  total of 20313 messages for a total of 1008.53 megabytes or 1,057,524,252
  bytes. The next summary groups shows the Blocked / Passed overview, with 1190
  Blocked messages (broken down as 18 messages blocked as malware, 4 messages
  with banned names, 416 spam messages, and 752 discarded messages), and 19123
  Passed messages (47 messages with bad headers and 19076 clean messages).
<div style="height: 1.00em;">&#x00A0;</div>
The next (optional) summary grouping shows message disposition by contents
  category. There were 18 malware messages and 4 banned file messages (all
  blocked), 1168 Spam messages, of which 416 were blocked (quarantined) and 752
  discarded. Finally, there were 19123 messages consdidered to be Ham (i.e. not
  spam), 47 of which contained bad headers.
<div style="height: 1.00em;">&#x00A0;</div>
Additional count summaries for a variety of events are also listed.
<div class="Pp"></div>
There are dozens of sub-sections available in the <b>Detailed</b> report, each
  of whose output can be controlled in various ways. Each sub-section attempts
  to group and present the most meaningful data at superior levels, while
  pushing less useful or <i>noisy</i> data towards inferior levels. The goal is
  to provide as much benefit as possible from smart grouping of data, to allow
  faster report scanning, pattern identification, and problem solving. Data is
  always sorted in descending order by count, and then numerically by IP address
  or alphabetically as appropriate.
<div class="Pp"></div>
The following Spam blocked segment from a sample <b>Detailed</b> report
  illustrates the basic hierarchical level structure of <b>amavis-logwatch</b>:
<div style="margin-left: 4.00ex;">
<pre>
<div class="Pp"></div>
****** Detailed *******************************************
<div class="Pp"></div>
   19346   Spam blocked -----------------------------------
     756      from@example.com
      12         10.0.0.2
      12            &lt;&gt;
      12         192.168.2.2
      12            &lt;&gt;
       5         192.168.2.1
     ...
<div class="Pp"></div>
</pre>
</div>
<div class="Pp"></div>
The <b>amavis-logwatch</b> utility reads from STDIN or from the named Amavis
  <i>logfile</i>. Multiple <i>logfile</i> arguments may be specified, each
  processed in order. The user running <b>amavis-logwatch</b> must have read
  permission on each named log file.
<h2 class="Ss" title="Ss" id="Options"><a class="selflink" href="#Options">Options</a></h2>
The options listed below affect the operation of <b>amavis-logwatch</b>. Options
  specified later on the command line override earlier ones. Any option may be
  abbreviated to an unambiguous length.
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--[no]autolearn</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--show_autolearn </b><i>boolean</i></dt>
  <dd class="It-tag">Enables (disables) output of the autolearn report. This
      report is only available if the default Amavis <b>$log_templ</b> has been
      modified to provide autolearn results in log entries. This can be done by
      uncommenting two lines in the Amavis program itself (where the default log
      templates reside), or by correctly adding the <b>$log_templ</b> variable
      to the <b>amavisd.conf</b> file. See Amavis' <b>README.customize</b> and
      search near the end of the Amavisd program for &quot;autolearn&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--[no]by_ccat_summary</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--show_by_ccat_summary </b><i>boolean</i></dt>
  <dd class="It-tag">Enables (disables) the by contents category summary in the
      <b>Summary</b> section. Default: enabled.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f </b><i>config_file</i></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--config_file </b><i>config_file</i></dt>
  <dd class="It-tag">Use an alternate configuration file <i>config_file</i>
      instead of the default. This option may be used more than once. Multiple
      configuration files will be processed in the order presented on the
      command line. See <b>CONFIGURATION FILE</b> below.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--debug </b><i>keywords</i></dt>
  <dd class="It-tag">Output debug information during the operation of
      <b>amavis-logwatch</b>. The parameter <i>keywords</i> is one or more comma
      or space separated keywords. To obtain the list of valid keywords, use
      --debug xxx where xxx is any invalid keyword.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--detail </b><i>level</i></dt>
  <dd class="It-tag">Sets the maximum detail level for <b>amavis-logwatch</b> to
      <i>level</i>. This option is global, overriding any other output limiters
      described below.
    <div style="height: 1.00em;">&#x00A0;</div>
    The <b>amavis-logwatch</b> utility produces a <b>Summary</b> section, a
      <b>Detailed</b> section, and additional report sections. With <i>level</i>
      less than 5, <b>amavis-logwatch</b> will produce only the <b>Summary</b>
      section. At <i>level</i> 5 and above, the <b>Detailed</b> section, and any
      additional report sections are candidates for output. Each incremental
      increase in <i>level</i> generates one additional hierarchical sub-level
      of output in the <b>Detailed</b> section of the report. At <i>level</i>
      10, all levels are output. Lines that exceed the maximum report width
      (specified with <b>max_report_width</b>) will be cut. Setting <i>level</i>
      to 11 will prevent lines in the report from being cut (see also
      <b>--line_style</b>).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--[no]first_recip_only</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--show_first_recip_only </b><i>boolean</i></dt>
  <dd class="It-tag">Specifies whether or not to sort by, and show, only the
      first recipient when a scanned messages contains multiple recipients.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">Print usage information and a brief description about
      command line options.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ipaddr_width </b><i>width</i></dt>
  <dd class="It-tag">Specifies that IP addresses in address/hostname pairs
      should be printed with a field width of <i>width</i> characters.
      Increasing the default may be useful for systems using long IPv6
      addresses.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l limiter=levelspec</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--limit limiter=levelspec</b></dt>
  <dd class="It-tag">Sets the level limiter <i>limiter</i> with the
      specification <i>levelspec</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--line_style </b><i>style</i></dt>
  <dd class="It-tag">Specifies how to handle long report lines. Three styles are
      available: <b>full</b>, <b>truncate</b>, and <b>wrap</b>. Setting
      <i>style</i> to <b>full</b> will prevent cutting lines to
      <b>max_report_width</b>; this is what occurs when <b>detail</b> is 11 or
      higher. When <i>style</i> is <b>truncate</b> (the default), long lines
      will be truncated according to <b>max_report_width</b>. Setting
      <i>style</i> to <b>wrap</b> will wrap lines longer than
      <b>max_report_width</b> such that left column hit counts are not obscured.
      This option takes precedence over the line style implied by the
      <b>detail</b> level. The options <b>--full</b>, <b>--truncate</b>, and
      <b>--wrap</b> are synonyms.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--nodetail</b></dt>
  <dd class="It-tag">Disables the <b>Detailed</b> section of the report, and all
      supplemental reports. This option provides a convenient mechanism to
      quickly disable all sections under the <b>Detailed</b> report, where
      subsequent command line options may re-enable one or more sections to
      create specific reports.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--sarules </b>`<i>S,H</i>&#x00B4;</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--sarules default</b></dt>
  <dd class="It-tag">Enables the SpamAssassin Rules Hit report. The
      comma-separated <i>S</i> and <i>H</i> arguments are top N values for the
      Spam and Ham reports, respectively, and can be any integer greater than or
      equal to 0, or the keyword <b>all</b>. The keyword <b>default</b> uses the
      built-in default values.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--nosarules</b></dt>
  <dd class="It-tag">Disables the SpamAssassin Rules Hit report.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--sa_timings </b><i>nrows</i></dt>
  <dd class="It-tag">Enables the SpamAssassin Timings percentiles report. The
      report can be limited to the top N rows with the <i>nrows</i> argument.
      This report requires Amavis 2.6+ and SpamAssassin 3.3+.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--sa_timings_percentiles </b>`<i>P1 [P2
    ...]</i>&#x00B4;</dt>
  <dd class="It-tag">Specifies the percentiles shown in the SpamAssassin Timings
      report. The arguments <i>P1 ...</i> are integers from 0 to 100 inclusive.
      Their order will be preserved in the report.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--nosa_timings</b></dt>
  <dd class="It-tag">Disables the SpamAssassin Timings report.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--version</b></dt>
  <dd class="It-tag">Print <b>amavis-logwatch</b> version information.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--score_frequencies </b>`<i>B1 [B2 ...]</i>&#x00B4;</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--score_frequencies default</b></dt>
  <dd class="It-tag">Enables the Spam Score Frequency report. The arguments
      <i>B1 ...</i> are frequency distribution buckets, and can be any real
      numbers. Their order will be preserved in the report. The keyword
      <b>default</b> uses the built-in default values.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--noscore_frequencies</b></dt>
  <dd class="It-tag">Disables the Spam Score Frequency report.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--score_percentiles </b>`<i>P1 [P2 ...]</i>&#x00B4;</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--score_percentiles default</b></dt>
  <dd class="It-tag">Enables the Spam Score Percentiles report. The arguments
      <i>P1 ...</i> specify the percentiles shown in the report, and are
      integers from 0 to 100 inclusive. The keyword <b>default</b> uses the
      built-in default values.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--noscore_percentiles</b></dt>
  <dd class="It-tag">Disables the Spam Score Percentiles report.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--[no]sect_vars</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--show_sect_vars </b><i>boolean</i></dt>
  <dd class="It-tag">Enables (disables) supplementing each <b>Detailed</b>
      section title with the name of that section's level limiter. The name
      displayed is the command line option (or configuration file variable) used
      to limit that section's output. With the large number of level limiters
      available in <b>amavis-logwatch</b>, this a convenient mechanism for
      determining exactly which level limiter affects a section.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--[no]startinfo</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--show_startinfo </b><i>boolean</i></dt>
  <dd class="It-tag">Enables (disables) the Amavis startup report showing most
      recent Amavis startup details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--[no]summary</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--show_summary</b></dt>
  <dd class="It-tag">Enables (disables) displaying of the the <b>Summary</b>
      section of the report. The variable Amavis_Show_Summary in used in a
      configuration file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--syslog_name </b><i>namepat</i></dt>
  <dd class="It-tag">Specifies the syslog service name that
      <b>amavis-logwatch</b> uses to match syslog lines. Only log lines whose
      service name matches the perl regular expression <i>namepat</i> will be
      used by <b>amavis-logwatch</b>; all non-matching lines are silently
      ignored. This is useful when a pre-installed Amavis package uses a name
      other than the default ( <b>amavis</b>).
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>Note:</b> if you use parenthesis in your regular expression, be sure
      they are cloistering and not capturing: use
      <b>(?:</b><i>pattern</i><b>)</b> instead of
      <b>(</b><i>pattern</i><b>)</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--timings </b><i>percent</i></dt>
  <dd class="It-tag">Enables the Amavis Scan Timings percentiles report. The
      report can be top N-percent limited with the <i>percent</i> argument.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--timings_percentiles </b>`<i>P1 [P2
    ...]</i>&#x00B4;</dt>
  <dd class="It-tag">Specifies the percentiles shown in the Scan Timings report.
      The arguments <i>P1 ...</i> are integers from 0 to 100 inclusive. Their
      order will be preserved in the report.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--notimings</b></dt>
  <dd class="It-tag">Disables the Amavis Scan Timings report.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--version</b></dt>
  <dd class="It-tag">Print <b>amavis-logwatch</b> version information.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h2 class="Ss" title="Ss" id="Level_Limiters"><a class="selflink" href="#Level_Limiters">Level
  Limiters</a></h2>
The output of every section in the <b>Detailed</b> report is controlled by a
  level limiter. The name of the level limiter variable will be output when the
  <b>sect_vars</b> option is set. Level limiters are set either via command line
  in standalone mode with <b>--limit </b><i>limiter</i><b>=</b><i>levelspec</i>
  option, or via configuration file variable
  <b>$amavis_</b><i>limiter</i><b>=</b> <i>levelspec</i>. Each limiter requires
  a <i>levelspec</i> argument, which is described below in <b>LEVEL CONTROL</b>.
<div style="height: 1.00em;">&#x00A0;</div>
The list of level limiters is shown below.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
Amavis major contents category (ccatmajor) sections, listed in order of
  priority: VIRUS, BANNED, UNCHECKED, SPAM, SPAMMY, BADH, OVERSIZED, MTA, CLEAN.
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MalwareBlocked</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MalwarePassed</b></dt>
  <dd class="It-tag">Blocked or passed messages that contain malware (ccatmajor:
      VIRUS).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BannedNameBlocked</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BannedNamePassed</b></dt>
  <dd class="It-tag">Blocked or passed messages that contain banned names in
      MIME parts (ccatmajor: BANNED).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>UncheckedBlocked</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>UncheckedPassed</b></dt>
  <dd class="It-tag">Blocked or passed messages that were not checked by a virus
      scanner or SpamAssassin (Amavis ccatmajor: UNCHECKED).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SpamBlocked</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SpamPassed</b></dt>
  <dd class="It-tag">Blocked or passed messages that were considered spam that
      reached kill level (Amavis ccatmajor: SPAM)
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SpammyBlocked</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SpammyPassed</b></dt>
  <dd class="It-tag">Blocked or passed messages that were considered spam, but
      did not reach kill level (Amavis ccatmajor: SPAMMY)
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BadHeaderBlocked</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BadHeaderPassed</b></dt>
  <dd class="It-tag">Blocked or passed messages that contain bad mail headers
      (ccatmajor: BAD-HEADER).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>OversizedBlocked</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>OversizedPassed</b></dt>
  <dd class="It-tag">Blocked or passed messages that were considered oversized
      (Amavis ccatmajor: OVERSIZED).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MtaBlocked</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MtaPassed</b></dt>
  <dd class="It-tag">Blocked or passed messages due to failure to re-inject to
      MTA (Amavis ccatmajor: MTA-BLOCKED). Occurrences of this event indicates a
      configuration problem. [ note: I don't believe mtapassed occurs, but
      exists for completeness.]
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>OtherBlocked</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>OtherPassed</b></dt>
  <dd class="It-tag">Blocked or passed messages that are not any of other major
      contents categories (Amavis ccatmajor: OTHER).
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>TempFailBlocked</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>TempfailPassed</b></dt>
  <dd class="It-tag">Blocked or passed messages that had a temporary failure
      (Amavis ccatmajor: TEMPFAIL)
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CleanBlocked</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CleanPassed </b></dt>
  <dd class="It-tag">Messages blocked or passed which were considered clean
      (Amavis ccatmajor: CLEAN; i.e. non-spam, non-viral).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<div class="Pp"></div>
Other sections, arranged alphabetically:
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>AvConnectFailure</b></dt>
  <dd class="It-tag">Problems connecting to Anti-Virus scanner(s).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>AvTimeout</b></dt>
  <dd class="It-tag">Timeouts awaiting responses from Anti-Virus scanner(s).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ArchiveExtract</b></dt>
  <dd class="It-tag">Archive extraction problems.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BadHeaderSupp</b></dt>
  <dd class="It-tag">Supplemental debug information regarding messages
      containing bad mail headers.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Bayes</b></dt>
  <dd class="It-tag">Messages frequencies by Bayesian probability buckets.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BadAddress</b></dt>
  <dd class="It-tag">Invalid mail address syntax.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Blacklisted</b></dt>
  <dd class="It-tag">Messages that were (soft-)blacklisted. See also Whitelisted
      below.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BounceKilled</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BounceRescued</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>BounceUnverifiable</b></dt>
  <dd class="It-tag">Disposition of incoming bounce messages (DSNs).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ContentType</b></dt>
  <dd class="It-tag">MIME attachment breakdown by type/subtype.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>DccError</b></dt>
  <dd class="It-tag">Errors encountered with or returned by DCC.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>DefangError</b></dt>
  <dd class="It-tag">Errors encountered during defang process.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Defanged</b></dt>
  <dd class="It-tag">Messages defanged (rendered harmless).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>DsnNotification</b></dt>
  <dd class="It-tag">Errors encountered during attempt to send delivery status
      notification.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>DsnSuppressed</b></dt>
  <dd class="It-tag">Delivery status notification (DSN) intentionally
      suppressed.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ExtraModules</b></dt>
  <dd class="It-tag">Additional code modules Amavis loaded during runtime.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>FakeSender</b></dt>
  <dd class="It-tag">Forged sender addresses, as determimed by Amavis.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Fatal</b></dt>
  <dd class="It-tag">Fatal events. These are presented at the top of the report,
      as they may require attention.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>LocalDeliverySkipped</b></dt>
  <dd class="It-tag">Failures delivering to a local address.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MalwareByScanner</b></dt>
  <dd class="It-tag">Breakdown of malware by scanner(s) that detected the
      malware.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MimeError</b></dt>
  <dd class="It-tag">Errors encountered during MIME extraction.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Panic</b></dt>
  <dd class="It-tag">Panic events. These are presented at the top of the report,
      as they may require attention.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>p0f</b></dt>
  <dd class="It-tag">Passive fingerprint (p0f) hits, grouped by mail contents
      type (virus, unchecked, banned, spam, ham), next by operating system
      genre, and finally by IP address. Note: Windows systems are refined by
      Windows OS version, whereas versions of other operating systems are
      grouped generically.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Released</b></dt>
  <dd class="It-tag">Messages that were released from Amavis quarantine.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SADiags</b></dt>
  <dd class="It-tag">Diagnostics as reported from SpamAssassin.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>SmtpResponse</b></dt>
  <dd class="It-tag">SMTP responses received during dialog with MTA. These log
      entries are primarly debug.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>TmpPreserved</b></dt>
  <dd class="It-tag">Temporary directories preserved by Amavis when some
      component encounters a problem or failure. Directories listed and their
      corresponding log entries should be evaluated for problems.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>VirusScanSkipped</b></dt>
  <dd class="It-tag">Messages that could not be scanned by a virus scanner.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Warning</b></dt>
  <dd class="It-tag">Warning events not categorized in specific warnings below.
      These are presented at the top of the report, as they may require
      attention.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>WarningAddressModified</b></dt>
  <dd class="It-tag">Incomplete email addresses modified by Amavis for safety.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>WarningNoQuarantineId</b></dt>
  <dd class="It-tag">Attempts to release a quarantined message that did not
      contain an X-Quarantine-ID header.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>WarningSecurity </b><i>levelspec</i></dt>
  <dd class="It-tag">Insecure configuration or utility used by Amavis.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>WarningSmtpShutdown</b></dt>
  <dd class="It-tag">Failures during SMTP conversation with MTA.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>WarningSql</b></dt>
  <dd class="It-tag">Failures to communicate with, or error replies from, SQL
      service.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Whitelisted</b></dt>
  <dd class="It-tag">Messages that were (soft-)whitelisted. See also Blacklisted
      above.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="LEVEL_CONTROL"><a class="selflink" href="#LEVEL_CONTROL">LEVEL
  CONTROL</a></h1>
<br/>
The <b>Detailed</b> section of the report consists of a number of sub-sections,
  each of which is controlled both globally and independently. Two settings
  influence the output provided in the <b>Detailed</b> report: a global detail
  level (specified with <b>--detail</b>) which has final (big hammer)
  output-limiting control over the <b>Detailed</b> section, and sub-section
  specific detail settings (small hammer), which allow further limiting of the
  output for a sub-section. Each sub-section may be limited to a specific depth
  level, and each sub-level may be limited with top N or threshold limits. The
  <i>levelspec</i> argument to each of the level limiters listed above is used
  to accomplish this.
<div style="height: 1.00em;">&#x00A0;</div>
It is probably best to continue explanation of sub-level limiting with the
  following well-known outline-style hierarchy, and some basic examples:
<pre>
<div class="Pp"></div>
    level 0
       level 1
          level 2
             level 3
                level 4
                level 4
          level 2
             level 3
                level 4
                level 4
                level 4
             level 3
                level 4
             level 3
       level 1
          level 2
             level 3
                level 4
</pre>
<div class="Pp"></div>
The simplest form of output limiting suppresses all output below a specified
  level. For example, a <i>levelspec</i> set to &quot;2&quot; shows only data in
  levels 0 through 2. Think of this as collapsing each sub-level 2 item, thus
  hiding all inferior levels (3, 4, ...), to yield:
<pre>
<div class="Pp"></div>
    level 0
       level 1
          level 2
          level 2
       level 1
          level 2
</pre>
<div class="Pp"></div>
Sometimes the volume of output in a section is too great, and it is useful to
  suppress any data that does not exceed a certain threshold value. Consider a
  dictionary spam attack, which produces very lengthy lists of hit-once
  recipient email or IP addresses. Each sub-level in the hierarchy can be
  threshold-limited by setting the <i>levelspec</i> appropriately. Setting
  <i>levelspec</i> to the value &quot;2::5&quot; will suppress any data at level
  2 that does not exceed a hit count of 5.
<div class="Pp"></div>
Perhaps producing a top N list, such as top 10 senders, is desired. A
  <i>levelspec</i> of &quot;3:10:&quot; limits level 3 data to only the top 10
  hits.
<div class="Pp"></div>
With those simple examples out of the way, a <i>levelspec</i> is defined as a
  whitespace- or comma-separated list of one or more of the following:
<dl class="Bl-tag">
  <dt class="It-tag"><i>l</i></dt>
  <dd class="It-tag">Specifies the maximum level to be output for this
      sub-section, with a range from 0 to 10. if <i>l</i> is 0, no levels will
      be output, effectively disabling the sub-section (level 0 data is already
      provided in the Summary report, so level 1 is considered the first useful
      level in the <b>Detailed</b> report). Higher values will produce output up
      to and including the specified level.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>l</i><b>.</b><i>n</i></dt>
  <dd class="It-tag">Same as above, with the addition that <i>n</i> limits this
      section's level 1 output to the top <i>n</i> items. The value for <i>n</i>
      can be any integer greater than 1. (This form of limiting has less utility
      than the syntax shown below. It is provided for backwards compatibility;
      users are encouraged to use the syntax below).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>l</i><b>:</b><i>n</i><b>:</b><i>t</i></dt>
  <dd class="It-tag">This triplet specifies level <i>l</i>, top <i>n</i>, and
      minimum threshold <i>t</i>. Each of the values are integers, with <i>l</i>
      being the level limiter as described above, <i>n</i> being a top <i>n</i>
      limiter for the level <i>l</i>, and <i>t</i> being the threshold limiter
      for level <i>l</i>. When both <i>n</i> and <i>t</i> are specified,
      <i>n</i> has priority, allowing top <i>n</i> lists (regardless of
      threshold value). If the value of <i>l</i> is omitted, the specified
      values for <i>n</i> and/or <i>t</i> are used for all levels available in
      the sub-section. This permits a simple form of wildcarding (eg. place
      minimum threshold limits on all levels). However, specific limiters always
      override wildcard limiters. The first form of level limiter may be
      included in <i>levelspec</i> to restrict output, regardless of how many
      triplets are present.</dd>
</dl>
<div class="Pp"></div>
All three forms of limiters are effective only when <b>amavis-logwatch</b>'s
  detail level is 5 or greater (the <b>Detailed</b> section is not activated
  until detail is at least 5).
<div class="Pp"></div>
See the <b>EXAMPLES</b> section for usage scenarios.
<h1 class="Sh" title="Sh" id="CONFIGURATION_FILE"><a class="selflink" href="#CONFIGURATION_FILE">CONFIGURATION
  FILE</a></h1>
<b>Amavis-logwatch</b> can read configuration settings from a configuration
  file. Essentially, any command line option can be placed into a configuration
  file, and these settings are read upon startup.
<div style="height: 1.00em;">&#x00A0;</div>
Because <b>amavis-logwatch</b> can run either standalone or within Logwatch, to
  minimize confusion, <b>amavis-logwatch</b> inherits Logwatch's configuration
  file syntax requirements and conventions. These are:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">White space lines are ignored.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Lines beginning with <b>#</b> are ignored</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Settings are of the form:
    <pre>
<div class="Pp"></div>
         <i>option</i><b> = </b><i>value</i>
<div class="Pp"></div>
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Spaces or tabs on either side of the <b>=</b> character are
      ignored.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Any <i>value</i> protected in double quotes will be
      case-preserved.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">All other content is reduced to lowercase (non-preserving,
      case insensitive).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">All <b>amavis-logwatch</b> configuration settings must be
      prefixed with &quot; <b>$amavis_</b>&quot; or <b>amavis-logwatch</b> will
      ignore them.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">When running under Logwatch, any values not prefixed with
      &quot; <b>$amavis_</b>&quot; are consumed by Logwatch; it only passes to
      <b>amavis-logwatch</b> (via environment variable) settings it considers
      valid.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The values <b>True</b> and <b>Yes</b> are converted to 1,
      and <b>False</b> and <b>No</b> are converted to 0.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Order of settings is not preserved within a configuration
      file (since settings are passed by Logwatch via environment variables,
      which have no defined order).</dd>
</dl>
<div class="Pp"></div>
To include a command line option in a configuration file, prefix the command
  line option name with the word &quot; <b>$amavis_</b>&quot;. The following
  configuration file setting and command line option are equivalent:
<pre>
<div class="Pp"></div>
         <b>$amavis_Line_Style = Truncate</b>
<div class="Pp"></div>
         <b>--line_style Truncate</b>
<div class="Pp"></div>
</pre>
Level limiters are also prefixed with <b>$amavis_</b>, but on the command line
  are specified with the <b>--limit</b> option:
<pre>
<div class="Pp"></div>
         <b>$amavis_SpamBlocked = 2</b>
<div class="Pp"></div>
         <b>--limit SpamBlocked=2</b>
<div class="Pp"></div>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
The order of command line options and configuration file processing occurs as
  follows: 1) The default configuration file is read if it exists and no
  <b>--config_file</b> was specified on a command line. 2) Configuration files
  are read and processed in the order found on the command line. 3) Command line
  options override any options already set either via command line or from any
  configuration file.
<div style="height: 1.00em;">&#x00A0;</div>
Command line options are interpreted when they are seen on the command line, and
  later options will override previously set options.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="EXIT_STATUS"><a class="selflink" href="#EXIT_STATUS">EXIT
  STATUS</a></h1>
<br/>
The <b>amavis-logwatch</b> utility exits with a status code of 0, unless an
  error occurred, in which case a non-zero exit status is returned.
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<br/>
<h2 class="Ss" title="Ss" id="Running_Standalone"><a class="selflink" href="#Running_Standalone">Running
  Standalone</a></h2>
<b>Note:</b> <b>amavis-logwatch</b> reads its log data from one or more named
  Amavis log files, or from STDIN. For brevity, where required, the examples
  below use the word <i>file</i> as the command line argument meaning
  <i>/path/to/amavis.log</i>. Obviously you will need to substitute <i>file</i>
  with the appropriate path.
<div class="Pp"></div>
<pre>
To run  <b>amavis-logwatch</b> in standalone mode, simply run:
</pre>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>amavis-logwatch </b><i>file</i>
</pre>
</div>
<div class="Pp"></div>
<pre>
A complete list of options and basic usage is available via:
</pre>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>amavis-logwatch --help</b>
</pre>
</div>
<div class="Pp"></div>
<pre>
To print a summary only report of Amavis log data:
</pre>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>amavis-logwatch --detail 1 </b><i>file</i>
</pre>
</div>
<br/>
<div class="Pp"></div>
To produce a summary report and a one-level detail report for May 25th:
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>grep 'May 25' </b><i>file</i><b> | amavis-logwatch --detail 5</b>
</pre>
</div>
<br/>
<div class="Pp"></div>
To produce only a top 10 list of Sent email domains, the summary report and
  detailed reports are first disabled. Since commands line options are read and
  enabled left-to-right, the Sent section is re-enabled to level 1 with a level
  1 top 10 limiter:
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>amavis-logwatch --nosummary --nodetail \</b>
<b>   --limit spamblocked '1 1:10:' </b><i>file</i>
</pre>
</div>
<br/>
<div class="Pp"></div>
The following command and its sample output shows a more complex level limiter
  example. The command gives the top 4 spam blocked recipients (level 1), and
  under with each recipient the top 2 sending IPs (level 2) and finally below
  that, only envelope from addresses (level 3) with hit counts greater than 6.
  Ellipses indicate top N or threshold-limited data:
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>amavis-logwatch --nosummary --nodetail \</b>
<b>        --limit spamblocked '1:4: 2:2: 3::6' </b><i>file</i>
<div class="Pp"></div>
19346   Spam blocked -----------------------------------
  756      joe@example.com
   12         10.0.0.1
   12            &lt;&gt;
   12         10.99.99.99
   12            &lt;&gt;
	     ...
  640      fred@example.com
    8         10.0.0.1
    8            &lt;&gt;
    8         192.168.3.19
    8            &lt;&gt;
	     ...
  595      peter@sample.net
    8         10.0.0.1
    8            &lt;&gt;
    7         192.168.3.3
    7            &lt;&gt;
	     ...
  547      paul@example.us
    8         192.168.3.19
    8            &lt;&gt;
    7         10.0.0.1
    7            &lt;&gt;
 	      ...
	   ...
</pre>
</div>
<br/>
<h2 class="Ss" title="Ss" id="Running_within_Logwatch"><a class="selflink" href="#Running_within_Logwatch">Running
  within Logwatch</a></h2>
<b>Note:</b> Logwatch versions prior to 7.3.6, unless configured otherwise,
  required the <b>--print</b> option to print to STDOUT instead of sending
  reports via email. Since version 7.3.6, STDOUT is the default output
  destination, and the <b>--print</b> option has been replaced by <b>--output
  stdout</b>. Check your configuration to determine where report output will be
  directed, and add the appropriate option to the commands below.
<div class="Pp"></div>
To print a summary report for today's Amavis log data:
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>logwatch --service amavis --range today --detail 1</b>
</pre>
</div>
<div class="Pp"></div>
<pre>
To print a report for today's Amavis log data, with one level
of detail in the  <b>Detailed</b> section:
</pre>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>logwatch --service amavis --range today --detail 5</b>
</pre>
</div>
<br/>
<div class="Pp"></div>
To print a report for yesterday, with two levels of detail in the
  <b>Detailed</b> section:
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>logwatch --service amavis --range yesterday --detail 6</b>
</pre>
</div>
<br/>
<div class="Pp"></div>
To print a report from Dec 12th through Dec 14th, with four levels of detail in
  the <b>Detailed</b> section:
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>logwatch --service amavis --range \</b>
<b>        'between 12/12 and 12/14' --detail 8</b>
</pre>
</div>
<div class="Pp"></div>
<pre>
To print a report for today, with all levels of detail:
</pre>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>logwatch --service amavis --range today --detail 10</b>
</pre>
</div>
<div class="Pp"></div>
<pre>
Same as above, but leaves long lines uncropped:
</pre>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<pre>
<b>logwatch --service amavis --range today --detail 11</b>
</pre>
</div>
<h2 class="Ss" title="Ss" id="Amavis_Log_Level"><a class="selflink" href="#Amavis_Log_Level">Amavis
  Log Level</a></h2>
Amavis provides additional log information when the variable <b>$log_level</b>
  is increased above the default 0 value. This information is used by the
  <b>amavis-logwatch</b> utility to provide additional reports, not available
  with the default <b>$log_level</b>=0 value. A <b>$log_level</b> of 2 is
  suggested.
<div class="Pp"></div>
If you prefer not to increase the noise level in your main mail or Amavis logs,
  you can configure syslog to log Amavis' output to multiple log files, where
  basic log entries are routed to your main mail log(s) and more detailed
  entries routed to an Amavis-specific log file used to feed the
  <b>amavis-logwatch</b> utility.
<div class="Pp"></div>
A convenient way to accomplish this is to change the Amavis configuration
  variables in <b>amavisd.conf</b> as shown below:
<pre>
<div class="Pp"></div>
    amavisd.conf:
        $log_level = 2;
        $syslog_facility = 'local5';
        $syslog_priority = 'debug';
<div class="Pp"></div>
</pre>
<div class="Pp"></div>
This increases <b>$log_level</b> to 2, and sends Amavis' log entries to an
  alternate syslog facility (eg. <b>local5</b>, user), which can then be routed
  to one or more log files, including your main mail log file:
<pre>
<div class="Pp"></div>
    syslog.conf:
        #mail.info                         -/var/log/maillog
        mail.info;local5.notice            -/var/log/maillog
<div class="Pp"></div>
        local5.info                        -/var/log/amavisd-info.log
<div class="Pp"></div>
</pre>
<div class="Pp"></div>
<b>Amavis</b>' typical <b>$log_level</b> 0 messages will be directed to both
  your maillog and to the <b>amavisd-info.log</b> file, but higher
  <b>$log_level</b> messages will only be routed to the <b>amavisd-info.log</b>
  file. For additional information on Amavis' logging, search the file
  <b>RELEASE_NOTES</b> in the Amavis distribution for:
<pre>
<div class="Pp"></div>
    &quot;syslog priorities are now dynamically derived&quot;
<div class="Pp"></div>
</pre>
<h1 class="Sh" title="Sh" id="ENVIRONMENT"><a class="selflink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
<br/>
The <b>amavis-logwatch</b> program uses the following (automatically set)
  environment variables when running under Logwatch:
<dl class="Bl-tag">
  <dt class="It-tag"><b>LOGWATCH_DETAIL_LEVEL</b></dt>
  <dd class="It-tag">This is the detail level specified with the Logwatch
      command line argument <b>--detail</b> or the <b>Detail</b> setting in the
      ...conf/services/amavis.conf configuration file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>LOGWATCH_DEBUG</b></dt>
  <dd class="It-tag">This is the debug level specified with the Logwatch command
      line argument <b>--debug</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>amavis_</b><i>xxx</i></dt>
  <dd class="It-tag">The Logwatch program passes all settings
      <b>amavis_</b><i>xxx</i> in the configuration file
      ...conf/services/amavis.conf to the <b>amavis</b> filter (which is
      actually named .../scripts/services/amavis) via environment variable.</dd>
</dl>
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
<h2 class="Ss" title="Ss" id="Standalone_mode"><a class="selflink" href="#Standalone_mode">Standalone
  mode</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag">/usr/local/bin/amavis-logwatch</dt>
  <dd class="It-tag">The <b>amavis-logwatch</b> program</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">/usr/local/etc/amavis-logwatch.conf</dt>
  <dd class="It-tag">The <b>amavis-logwatch</b> configuration file in standalone
      mode</dd>
</dl>
<h2 class="Ss" title="Ss" id="Logwatch_mode"><a class="selflink" href="#Logwatch_mode">Logwatch
  mode</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag">/etc/logwatch/scripts/services/amavis</dt>
  <dd class="It-tag">The Logwatch <b>amavis</b> filter</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">/etc/logwatch/conf/services/amavis.conf</dt>
  <dd class="It-tag">The Logwatch <b>amavis</b> filter configuration file</dd>
</dl>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<pre>
logwatch(8), system log analyzer and reporter
</pre>
<h1 class="Sh" title="Sh" id="README_FILES"><a class="selflink" href="#README_FILES">README
  FILES</a></h1>
<pre>
README, an overview of  <b>amavis-logwatch</b>
Changes, the version change list history
Bugs, a list of the current bugs or other inadequacies
Makefile, the rudimentary installer
LICENSE, the usage and redistribution licensing terms
</pre>
<h1 class="Sh" title="Sh" id="LICENSE"><a class="selflink" href="#LICENSE">LICENSE</a></h1>
<pre>
Covered under the included MIT/X-Consortium License:
http://www.opensource.org/licenses/mit-license.php
<div class="Pp"></div>
</pre>
<h1 class="Sh" title="Sh" id="AUTHOR(S)"><a class="selflink" href="#AUTHOR(S)">AUTHOR(S)</a></h1>
<pre>
Mike Cappella
<div class="Pp"></div>
</pre>
The original <b>amavis</b> Logwatch filter was written by Jim O'Halloran, and
  has had many contributors over the years. They are entirely not responsible
  for any errors, problems or failures since the current author's hands have
  touched the source code.</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
