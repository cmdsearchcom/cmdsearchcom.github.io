<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>warpx(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">warpx(1)</td>
    <td class="head-vol">The Computational Morphometry Toolkit</td>
    <td class="head-rtitle">warpx(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
warpx - B-spline nonrigid registration
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>warpx</b> ReferenceImage FloatingImage InitialXform
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This program performs nonrigid image registration using multi-resolution
  optimization of voxel-based image similarity measures and a multi-resolution
  B-spline transformation model.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<h2 class="Ss" title="Ss" id="Global_Toolkit_Options_(these_are_shared_by_all_CMTK_tools)"><a class="selflink" href="#Global_Toolkit_Options_(these_are_shared_by_all_CMTK_tools)">Global
  Toolkit Options (these are shared by all CMTK tools)</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">Write list of basic command line options to standard
      output.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help-all</b></dt>
  <dd class="It-tag">Write complete list of basic and advanced command line
      options to standard output.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--wiki</b></dt>
  <dd class="It-tag">Write list of command line options to standard output in
      MediaWiki markup.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--man</b></dt>
  <dd class="It-tag">Write man page source in 'nroff' markup to standard
    output.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--xml</b></dt>
  <dd class="It-tag">Write command line syntax specification in XML markup (for
      Slicer integration).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--version</b></dt>
  <dd class="It-tag">Write toolkit version to standard output.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--echo</b></dt>
  <dd class="It-tag">Write the current command line to standard output.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verbose-level</b> <i>&lt;integer&gt;</i></dt>
  <dd class="It-tag">Set verbosity level.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verbose</b>, <b>-v</b></dt>
  <dd class="It-tag">Increment verbosity level by 1 (deprecated; supported for
      backward compatibility).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--threads</b> <i>&lt;integer&gt;</i></dt>
  <dd class="It-tag">Set maximum number of parallel threads (for POSIX threads
      and OpenMP).</dd>
</dl>
<h2 class="Ss" title="Ss" id="Transformation_import/export"><a class="selflink" href="#Transformation_import/export">Transformation
  import/export</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--initial</b> <i>&lt;transformation-path&gt;</i></dt>
  <dd class="It-tag">Initialize transformation from given path <b>[Default:
      NONE]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--invert-initial</b></dt>
  <dd class="It-tag">Invert given (affine) initial transformation.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--write-itk-xform</b>
    <i>&lt;transformation-path&gt;</i></dt>
  <dd class="It-tag">Output path for final transformation in ITK format
      <b>[Default: NONE]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--write-reformatted</b> <i>&lt;image-path&gt;</i></dt>
  <dd class="It-tag">Write reformatted floating image. <b>[Default:
    NONE]</b></dd>
</dl>
<h2 class="Ss" title="Ss" id="Transformation_parameters"><a class="selflink" href="#Transformation_parameters">Transformation
  parameters</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--grid-spacing</b> <i>&lt;double&gt;</i></dt>
  <dd class="It-tag">Control point grid spacing <b>[Default: 10]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--grid-refine</b> <i>&lt;integer&gt;</i></dt>
  <dd class="It-tag">Number of refinements (control point grid resolution
      levels) <b>[Default: 0]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--delay-refine</b></dt>
  <dd class="It-tag">Delay control point grid refinement; first switch to next
      higher image resolution</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--exact-spacing</b></dt>
  <dd class="It-tag">Use exact control point spacing; do not modify spacing to
      fit reference image bounding box</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ignore-edge</b> <i>&lt;integer&gt;</i></dt>
  <dd class="It-tag">Ignore n control point layers along each image face
      <b>[Default: 0]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--restrict</b> <i>&lt;string&gt;</i></dt>
  <dd class="It-tag">Restrict deformation to coordinate dimension(s) [one or
      more of 'x','y','z'] <b>[Default: NONE]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--no-adaptive-fix</b></dt>
  <dd class="It-tag">Disable adaptive fixing of control points; optimize all
      deformation parameters</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--adaptive-fix-thresh</b> <i>&lt;float&gt;</i></dt>
  <dd class="It-tag">Threshold factor for entropy criterion to fix local control
      points <b>[Default: 0.5]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--accurate</b></dt>
  <dd class="It-tag">Accurate computation mode: may give slightly better results
      after substantially longer computation <b>[This is the default]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--fast</b></dt>
  <dd class="It-tag">Fast computation mode: may give slightly worse results than
      accurate mode, but saves substantial CPU time</dd>
</dl>
<h2 class="Ss" title="Ss" id="Regularization_parameters"><a class="selflink" href="#Regularization_parameters">Regularization
  parameters</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--jacobian-constraint-weight</b>
    <i>&lt;float&gt;</i></dt>
  <dd class="It-tag">Weight for Jacobian-based local volume preservation
      constraint <b>[Default: 0]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--smoothness-constraint-weight</b>
    <i>&lt;float&gt;</i></dt>
  <dd class="It-tag">Weight for smoothness constraint based on second-order grid
      bending energy. <b>[Default: 0]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--inverse-consistency-weight</b>
    <i>&lt;float&gt;</i></dt>
  <dd class="It-tag">Weight for inverse consistency constraint <b>[Default:
      0]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--constraint-relaxation-factor</b>
    <i>&lt;float&gt;</i></dt>
  <dd class="It-tag">Weight relaxation factor for alternating under-constrained
      iterations <b>[Default: -1]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--relax-to-unfold</b></dt>
  <dd class="It-tag">Before each resolution level, regularize negative-Jacobian
      areas of the deformation to unfold them.</dd>
</dl>
<h2 class="Ss" title="Ss" id="Optimization_parameters"><a class="selflink" href="#Optimization_parameters">Optimization
  parameters</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--max-stepsize</b> <i>&lt;double&gt;</i></dt>
  <dd class="It-tag">Maximum optimizer step size, which determines search space
      exploration. <b>[Default: -1]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--min-stepsize</b> <i>&lt;double&gt;</i></dt>
  <dd class="It-tag">Minimum optimizer step size, which determines precision.
      <b>[Default: -1]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--stepfactor</b> <i>&lt;double&gt;</i></dt>
  <dd class="It-tag">Factor for search step size reduction. Must be &gt; 0.0 and
      &lt; 1.0 [default: 0.5] <b>[Default: 0.5]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--delta-f-threshold</b> <i>&lt;double&gt;</i></dt>
  <dd class="It-tag">Optional threshold to terminate optimization (level) if
      relative change of target function drops below this value. <b>[Default:
      0]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--no-maxnorm</b></dt>
  <dd class="It-tag">Use Euclid norm for gradient normalication in optimization,
      rather than maximum norm</dd>
</dl>
<h2 class="Ss" title="Ss" id="Image_resolution_parameters"><a class="selflink" href="#Image_resolution_parameters">Image
  resolution parameters</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--sampling</b> <i>&lt;double&gt;</i>, <b>-s</b>
    <i>&lt;double&gt;</i></dt>
  <dd class="It-tag">Image sampling (finest resampled image resolution)
      <b>[Default: -1]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--coarsest</b> <i>&lt;double&gt;</i></dt>
  <dd class="It-tag">Upper limit for image sampling in multiresolution hierarchy
      <b>[Default: -1]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--omit-original-data</b></dt>
  <dd class="It-tag">Do not use original data in full resolution for final
      registration stage.</dd>
</dl>
<h2 class="Ss" title="Ss" id="Image_data"><a class="selflink" href="#Image_data">Image
  data</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--registration-metric</b></dt>
  <dd class="It-tag">Registration metric for motion estimation by image-to-image
      registration. Supported values: &quot;nmi&quot;, &quot;mi&quot;,
      &quot;cr&quot;, &quot;rms&quot;, &quot;msd&quot;, &quot;ncc&quot;, where
      the default is &quot;nmi&quot;, or use one of the following:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--nmi</b></dt>
  <dd class="It-tag">Normalized Mutual Information metric <b>[This is the
      default]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--mi</b></dt>
  <dd class="It-tag">Standard Mutual Information metric</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--cr</b></dt>
  <dd class="It-tag">Correlation Ratio metric</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--rms</b></dt>
  <dd class="It-tag">Root of Mean Squaresa metric (this is the square root of
      MSD)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--msd</b></dt>
  <dd class="It-tag">Mean Squared Difference metric</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ncc</b></dt>
  <dd class="It-tag">Normalized Cross Correlation metric</dd>
</dl>
</div>
<h2 class="Ss" title="Ss" id="Floating_Image_Interpolation_Options"><a class="selflink" href="#Floating_Image_Interpolation_Options">Floating
  Image Interpolation Options</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--interpolation</b></dt>
  <dd class="It-tag">Interpolation method for floating image sampling: Supported
      values: &quot;nearest-neighbor&quot;, &quot;linear&quot;,
      &quot;cubic&quot;, &quot;cosine-sinc&quot;, &quot;partial-volume&quot;,
      &quot;automatic&quot;, where the default is &quot;automatic&quot;, or use
      one of the following:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>--nearest-neighbor</b></dt>
  <dd class="It-tag">Nearest neighbor interpolation (for intensity and label
      data)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--linear</b></dt>
  <dd class="It-tag">Trilinear interpolation</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--cubic</b></dt>
  <dd class="It-tag">Tricubic interpolation</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--cosine-sinc</b></dt>
  <dd class="It-tag">Cosine-windowed sinc interpolation (most accurate but
      slowest)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--partial-volume</b></dt>
  <dd class="It-tag">Partial volume interpolation (for label data)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--automatic</b></dt>
  <dd class="It-tag">Select interpolation automatically based on data type:
      linear for grey-level data, nearest neighbor for label data. <b>[This is
      the default]</b></dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--match-histograms</b></dt>
  <dd class="It-tag">Match floating image histogram to reference image
      histogram.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--repeat-match-histograms</b></dt>
  <dd class="It-tag">Repeat histogram matching after every level of the
      registration to account for volume changes. When registering masked data,
      it is advisable to also use the --force-outside-value option to prevent
      poorly matched histograms.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--force-outside-value</b> <i>&lt;double&gt;</i></dt>
  <dd class="It-tag">Force values outside field of view to this value rather
      than drop incomplete pixel pairs <b>[Default: disabled]</b></dd>
</dl>
<h2 class="Ss" title="Ss" id="Reference_Image_Preprocessing"><a class="selflink" href="#Reference_Image_Preprocessing">Reference
  Image Preprocessing</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--class-ref</b> <i>&lt;string&gt;</i></dt>
  <dd class="It-tag">Data class: grey (default) or label <b>[Default:
    NONE]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--pad-ref</b> <i>&lt;double&gt;</i></dt>
  <dd class="It-tag">Padding value <b>[Default: disabled]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--thresh-min-ref</b> <i>&lt;double&gt;</i></dt>
  <dd class="It-tag">Minimum value truncation threshold <b>[Default:
      disabled]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--thresh-max-ref</b> <i>&lt;double&gt;</i></dt>
  <dd class="It-tag">Maximum value truncation threshold <b>[Default:
      disabled]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--prune-histogram-ref</b> <i>&lt;integer&gt;</i></dt>
  <dd class="It-tag">Number of bins for histogram-based pruning <b>[Default:
      disabled]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--histogram-equalization-ref</b></dt>
  <dd class="It-tag">Apply histogram equalization</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--median-filter-radius-ref</b>
    <i>&lt;integer&gt;</i></dt>
  <dd class="It-tag">Apply median filter with given radius <b>[Default:
    0]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--sobel-filter-ref</b></dt>
  <dd class="It-tag">Apply Sobel edge detection filter</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--crop-index-ref</b> <i>&lt;string&gt;</i></dt>
  <dd class="It-tag">Cropping region in pixel index coordinates [parsed as
      %d,%d,%d,%d,%d,%d for i0,j0,k0,i1,j1,k1] <b>[Default: NONE]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--crop-world-ref</b> <i>&lt;string&gt;</i></dt>
  <dd class="It-tag">Cropping region in world coordinates [parsed as
      %f,%f,%f,%f,%f,%f for x0,y0,z0,x1,y1,z1] <b>[Default: NONE]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--crop-thresh-ref</b> <i>&lt;double&gt;</i></dt>
  <dd class="It-tag">Automatic cropping based on threshold <b>[Default:
      disabled]</b></dd>
</dl>
<h2 class="Ss" title="Ss" id="Floating_Image_Preprocessing"><a class="selflink" href="#Floating_Image_Preprocessing">Floating
  Image Preprocessing</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--class-flt</b> <i>&lt;string&gt;</i></dt>
  <dd class="It-tag">Data class: grey (default) or label <b>[Default:
    NONE]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--pad-flt</b> <i>&lt;double&gt;</i></dt>
  <dd class="It-tag">Padding value <b>[Default: disabled]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--thresh-min-flt</b> <i>&lt;double&gt;</i></dt>
  <dd class="It-tag">Minimum value truncation threshold <b>[Default:
      disabled]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--thresh-max-flt</b> <i>&lt;double&gt;</i></dt>
  <dd class="It-tag">Maximum value truncation threshold <b>[Default:
      disabled]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--prune-histogram-flt</b> <i>&lt;integer&gt;</i></dt>
  <dd class="It-tag">Number of bins for histogram-based pruning <b>[Default:
      disabled]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--histogram-equalization-flt</b></dt>
  <dd class="It-tag">Apply histogram equalization</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--median-filter-radius-flt</b>
    <i>&lt;integer&gt;</i></dt>
  <dd class="It-tag">Apply median filter with given radius <b>[Default:
    0]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--sobel-filter-flt</b></dt>
  <dd class="It-tag">Apply Sobel edge detection filter</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--crop-index-flt</b> <i>&lt;string&gt;</i></dt>
  <dd class="It-tag">Cropping region in pixel index coordinates [parsed as
      %d,%d,%d,%d,%d,%d for i0,j0,k0,i1,j1,k1] <b>[Default: NONE]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--crop-world-flt</b> <i>&lt;string&gt;</i></dt>
  <dd class="It-tag">Cropping region in world coordinates [parsed as
      %f,%f,%f,%f,%f,%f for x0,y0,z0,x1,y1,z1] <b>[Default: NONE]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--crop-thresh-flt</b> <i>&lt;double&gt;</i></dt>
  <dd class="It-tag">Automatic cropping based on threshold <b>[Default:
      disabled]</b></dd>
</dl>
<h2 class="Ss" title="Ss" id="Output_parameters"><a class="selflink" href="#Output_parameters">Output
  parameters</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--outlist</b> <i>&lt;string&gt;</i>, <b>-o</b>
    <i>&lt;string&gt;</i></dt>
  <dd class="It-tag">Output path for final transformation <b>[Default:
    NONE]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--time</b> <i>&lt;string&gt;</i>, <b>-t</b>
    <i>&lt;string&gt;</i></dt>
  <dd class="It-tag">Computation time statistics output file name <b>[Default:
      NONE]</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--output-intermediate</b></dt>
  <dd class="It-tag">Write transformation for each level [default: only write
      final transformation]</dd>
</dl>
<h2 class="Ss" title="Ss" id="Image/Transformation_Database"><a class="selflink" href="#Image/Transformation_Database">Image/Transformation
  Database</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--db</b> <i>&lt;string&gt;</i></dt>
  <dd class="It-tag">Path to image/transformation database that should be
      updated with the new registration and/or reformatted image. <b>[Default:
      NONE]</b></dd>
</dl>
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
Torsten Rohlfing, with contributions from Michael P. Hasak, Greg Jefferis,
  Calvin R. Maurer, Daniel B. Russakoff, and Yaroslav Halchenko
<h1 class="Sh" title="Sh" id="LICENSE"><a class="selflink" href="#LICENSE">LICENSE</a></h1>
http://www.fsf.org/licensing/licenses/gpl.html
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Report bugs at http://nitrc.org/projects/cmtk/
<h1 class="Sh" title="Sh" id="ACKNOWLEDGMENTS"><a class="selflink" href="#ACKNOWLEDGMENTS">ACKNOWLEDGMENTS</a></h1>
CMTK is developed with support from the NIAAA under Grant AA021697, National
  Consortium on Alcohol and Neurodevelopment in Adolescence (N-CANDA): Data
  Integration Component. From April 2009 through September 2011, CMTK
  development and maintenance was supported by the NIBIB under Grant
  EB008381.</div>
<table class="foot">
  <tr>
    <td class="foot-date">Jan 13 2017</td>
    <td class="foot-os">CMTK 3.3.1</td>
  </tr>
</table>
</body>
</html>
