<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>cmcalibrate(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">cmcalibrate(1)</td>
    <td class="head-vol">Infernal Manual</td>
    <td class="head-rtitle">cmcalibrate(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
cmcalibrate - fit exponential tails for covariance model E-value determination
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>cmcalibrate</b> <i>[options]</i> <i>cmfile</i>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>cmcalibrate</b> determines exponential tail parameters for E-value
  determination by generating random sequences, searching them with the CM and
  collecting the scores of the resulting hits. A histogram of the bit scores of
  the hits is fit to an exponential tail, and the parameters of the fitted tail
  are saved to the CM file. The exponential tail parameters are then used to
  estimate the statistical significance of hits found in <b>cmsearch</b> and
  <b>cmscan.</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
A CM file must be calibrated with <b>cmcalibrate</b> before it can be used in
  <b>cmsearch</b> or <b>cmscan,</b> with a single exception: it is not necessary
  to calibrate CM files that include only models with zero basepairs before
  running <b>cmsearch.</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<b>cmcalibrate</b> is very slow. It takes a couple of hours to calibrate a
  single average sized CM on a single CPU. <b>cmcalibrate</b> will run in
  parallel on all available cores if Infernal was built on a system that
  supports POSIX threading (see the Installation section of the user guide for
  more information). Using <b>&lt;n&gt;</b> cores will result in roughly
  <b>&lt;n&gt;</b> -fold acceleration versus a single CPU. MPI (Message Passing
  Interface) can be also be used for parallelization with the <b>--mpi</b>
  option if Infernal was built with MPI enabled, but using more than 161
  processors is not recommended because increasing past 161 won't accelerate the
  calibration. See the Installation seciton of the user guide for more
  information.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
The <b>--forecast</b> option can be used to estimate how long the program will
  take to run for a given <i>cmfile</i> on the current machine. To predict the
  running time on <i>&lt;n&gt;</i> processors with MPI, additionally use the
  <b>--nforecast</b><i> &lt;n&gt;</i> option.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
The random sequences searched in <b>cmcalibrate</b> are generated by an HMM that
  was trained on real genomic sequences with various GC contents. The goal is to
  have the GC distributions in the random sequences be similar to those in
  actual genomic sequences.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
Four rounds of searches and subsequent exponential tail fits are performed, one
  each for the four different CM algorithms that can be used in <b>cmsearch</b>
  and <b>cmscan:</b> glocal CYK, glocal Inside, local CYK and local Inside.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
The E-values parameters determined by <b>cmcalibrate</b> are only used by the
  <b>cmsearch</b> and <b>cmscan</b> programs. If you are not going to use these
  programs then do not waste time calibrating your models.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h</b></dt>
  <dd class="It-tag">Help; print a brief reminder of command line usage and
      available options.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-L</b><i> &lt;x&gt;</i></dt>
  <dd class="It-tag">Set the total length of random sequences to search to
      <i>&lt;x&gt;</i> megabases (Mb). By default, <i>&lt;x&gt; is</i> 1.6 Mb.
      Increasing <i>&lt;x&gt;</i> will make the exponential tail fits more
      precise and E-values more accurate, but will take longer (doubling
      <i>&lt;x&gt;</i> will roughly double the running time). Decreasing
      <i>&lt;x&gt;</i> is not recommended as it will make the fits less precise
      and the E-values less accurate.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="OPTIONS_FOR_PREDICTING_REQUIRED_TIME_AND_MEMORY"><a class="selflink" href="#OPTIONS_FOR_PREDICTING_REQUIRED_TIME_AND_MEMORY">OPTIONS
  FOR PREDICTING REQUIRED TIME AND MEMORY</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--forecast</b></dt>
  <dd class="It-tag">Predict the running time of the calibration of
      <i>cmfile</i> (with provided options) on the current machine and exit. The
      calibration is not performed. The predictions should be considered rough
      estimates. If multithreading is enabled (see Installation section of user
      guide), the timing will take into account the number of available cores.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--nforecast</b><i> &lt;n&gt;</i></dt>
  <dd class="It-tag">With <b>--forecast,</b> specify that <i>&lt;n&gt;</i>
      processors will be used for the calibration. This might be useful for
      predicting the running time of an MPI run with <i>&lt;n&gt;</i>
      processors.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--memreq</b></dt>
  <dd class="It-tag">Predict the amount of required memory for calibrating
      <i>cmfile</i> (with provided options) on the current machine and exit. The
      calibration is not performed.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="OPTIONS_CONTROLLING_EXPONENTIAL_TAIL_FITS"><a class="selflink" href="#OPTIONS_CONTROLLING_EXPONENTIAL_TAIL_FITS">OPTIONS
  CONTROLLING EXPONENTIAL TAIL FITS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--gtailn</b><i> &lt;x&gt;</i></dt>
  <dd class="It-tag">fit the exponential tail for glocal Inside and glocal CYK
      to the <i>&lt;n&gt;</i> highest scores in the histogram tail, where
      <i>&lt;n&gt;</i> is <i>&lt;x&gt;</i> times the number of Mb searched. The
      default value of <i>&lt;x&gt;</i> is 250. The value 250 was chosen because
      it works well empirically relative to other values.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ltailn</b><i> &lt;x&gt;</i></dt>
  <dd class="It-tag">fit the exponential tail for local Inside and local CYK to
      the <i>&lt;n&gt;</i> highest scores in the histogram tail, where
      <i>&lt;n&gt;</i> is <i>&lt;x&gt;</i> times the number of Mb searched. The
      default value of <i>&lt;x&gt;</i> is 750. The value 750 was chosen because
      it works well empirically relative to other values.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tailp</b><i> &lt;x&gt;</i></dt>
  <dd class="It-tag">Ignore the <b>--gtailn</b> and <b>--ltailn</b> prefixed
      options and fit the <i>&lt;x&gt;</i> fraction tail of the histogram to an
      exponential tail, for all search modes.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="OPTIONAL_OUTPUT_FILES"><a class="selflink" href="#OPTIONAL_OUTPUT_FILES">OPTIONAL
  OUTPUT FILES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--hfile</b><i> &lt;f&gt;</i></dt>
  <dd class="It-tag">Save the histograms fit to file <i>&lt;f&gt;.</i> The
      format of this file is two space delimited columns per line. The first
      column is the x-axis values of bit scores of each bin. The second column
      is the y-axis values of number of hits per bin. Each series is delimited
      by a line with a single character &quot;&amp;&quot;. The file will contain
      one series for each of the four exponential tail fits in the following
      order: glocal CYK, glocal Inside, local CYK, and local Inside.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--sfile</b><i> &lt;f&gt;</i></dt>
  <dd class="It-tag">Save survival plot information to file <i>&lt;f&gt;.</i>
      The format of this file is two space delimited columns per line. The first
      column is the x-axis values of bit scores of each bin. The second column
      is the y-axis values of fraction of hits that meet or exceed the score for
      each bin. Each series is delimited by a line with a single character
      &quot;&amp;&quot;. The file will contain three series of data for each of
      the four CM search modes in the following order: glocal CYK, glocal
      Inside, local CYK, and local Inside. The first series is the empirical
      survival plot from the histogram of hits to the random sequence. The
      second series is the exponential tail fit to the empirical distribution.
      The third series is the exponential tail fit if lambda were fixed and set
      as the natural log of 2 (0.691314718).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--qqfile</b><i> &lt;f&gt;</i></dt>
  <dd class="It-tag">Save quantile-quantile plot information to file
      <i>&lt;f&gt;.</i> The format of this file is two space delimited columns
      per line. The first column is the x-axis values, and the second column is
      the y-axis values. The distance of the points from the identity line (y=x)
      is a measure of how good the exponential tail fit is, the closer the
      points are to the identity line, the better the fit is. Each series is
      delimited by a line with a single character &quot;&amp;&quot;. The file
      will contain one series of empirical data for each of the four exponential
      tail fits in the following order: glocal CYK, glocal Inside, local CYK and
      local Inside.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ffile</b><i> &lt;f&gt;</i></dt>
  <dd class="It-tag">Save space delimited statistics of different exponential
      tail fits to file <i>&lt;f&gt;.</i> The file will contain the lambda and
      mu values for exponential tails fit to histogram tails of different sizes.
      The fields in the file are labelled informatively.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--xfile</b><i> &lt;f&gt;</i></dt>
  <dd class="It-tag">Save a list of the scores in each fit histogram tail to
      file <i>&lt;f&gt;.</i> Each line of this file will have a different score
      indicating one hit existed in the tail with that score. Each series is
      delimited by a line with a single character &quot;&amp;&quot;. The file
      will contain one series for each of the four exponential tail fits in the
      following order: glocal CYK, glocal Inside, local CYK, and local Inside.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="OTHER_OPTIONS"><a class="selflink" href="#OTHER_OPTIONS">OTHER
  OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--seed</b><i> &lt;n&gt;</i></dt>
  <dd class="It-tag">Seed the random number generator with <i>&lt;n&gt;,</i> an
      integer &gt;= 0. If <i>&lt;n&gt;</i> is nonzero, stochastic simulations
      will be reproducible; the same command will give the same results. If
      <i>&lt;n&gt;</i> is 0, the random number generator is seeded arbitrarily,
      and stochastic simulations will vary from run to run of the same command.
      The default seed is 181.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--beta</b><i> &lt;x&gt;</i></dt>
  <dd class="It-tag">By default query-dependent banding (QDB) is used to
      accelerate the CM search algorithms with a beta tail loss probability of
      1E-15. This beta value can be changed to <i>&lt;x&gt;</i> with
      <b>--beta</b><i> &lt;x&gt;</i><b>.</b> The beta parameter is the amount of
      probability mass excluded during band calculation, higher values of beta
      give greater speedups but sacrifice more accuracy than lower values. The
      default value used is 1E-15. (For more information on QDB see Nawrocki and
      Eddy, PLoS Computational Biology 3(3): e56.)
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--nonbanded</b></dt>
  <dd class="It-tag">Turn off QDB during E-value calibration. This will slow
      down calibration.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--nonull3</b></dt>
  <dd class="It-tag">Turn off the null3 post hoc additional null model. This is
      not recommended unless you plan on using the same option to
      <b>cmsearch</b> and/or <b>cmscan.</b>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--random</b></dt>
  <dd class="It-tag">Use the background null model of the CM to generate the
      random sequences, instead of the more realistic HMM. Unless the CM was
      built using the <b>--null</b> option to <b>cmbuild,</b> the background
      null model will be 25% each A, C, G and U.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--gc</b><i> &lt;f&gt;</i></dt>
  <dd class="It-tag">Generate the random sequences using the nucleotide
      distribution from the sequence file <i>&lt;f&gt;.</i>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--cpu</b><i> &lt;n&gt;</i></dt>
  <dd class="It-tag">Specify that <i>&lt;n&gt;</i> parallel CPU workers be used.
      If <i>&lt;n&gt;</i> is set as &quot;0&quot;, then the program will be run
      in serial mode, without using threads. You can also control this number by
      setting an environment variable, <i>INFERNAL_NCPU.</i> This option will
      only be available if the machine on which Infernal was built is capable of
      using POSIX threading (see the Installation section of the user guide for
      more information).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--mpi</b></dt>
  <dd class="It-tag">Run as an MPI parallel program. This option will only be
      available if Infernal has been configured and built with the
      &quot;--enable-mpi&quot; flag (see the Installation section of the user
      guide for more information).
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
See <b>infernal(1)</b> for a master man page with a list of all the individual
  man pages for programs in the Infernal package.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
For complete documentation, see the user guide that came with your Infernal
  distribution (Userguide.pdf); or see the Infernal web page ().
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
<pre>
Copyright (C) 2016 Howard Hughes Medical Institute.
Freely distributed under a BSD open source license.
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
For additional information on copyright and licensing, see the file called
  COPYRIGHT in your Infernal source distribution, or see the Infernal web page
  ().
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
<pre>
The Eddy/Rivas Laboratory
Janelia Farm Research Campus
19700 Helix Drive
Ashburn VA 20147 USA
http://eddylab.org
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">July 2016</td>
    <td class="foot-os">Infernal 1.1.2</td>
  </tr>
</table>
</body>
</html>
