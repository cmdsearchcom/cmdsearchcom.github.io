<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:27:14 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>NFSTEST_POSIX(1) nfstest_posix 1.1 NFSTEST_POSIX(1)</p>

<p style="margin-top: 1em">NAME <br>
nfstest_posix - POSIX file system level access tests</p>

<p style="margin-top: 1em">SYNOPSIS <br>
nfstest_posix --server &lt;server&gt; [options]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Verify POSIX file system level access over the specified
path using positive and negative testing.</p>

<p style="margin-top: 1em">Valid for any version of
NFS.</p>

<p style="margin-top: 1em">OPTIONS <br>
--version <br>
show program&rsquo;s version number and exit</p>

<p style="margin-top: 1em">-h, --help <br>
show this help message and exit</p>

<p style="margin-top: 1em">-f FILE, --file=FILE <br>
File where options are specified besides the system wide
file /etc/nfstest, user wide file $HOME/.nfstest or in the
current directory .nfstest file</p>

<p style="margin-top: 1em">NFS specific options: <br>
-s SERVER, --server=SERVER <br>
Server name or IP address</p>

<p style="margin-top: 1em">-e EXPORT, --export=EXPORT <br>
Exported file system to mount [default: &rsquo;/&rsquo;]</p>

<p style="margin-top: 1em">--nfsversion=NFSVERSION <br>
NFS version, e.g., 3, 4, 4.1, etc. [default: 4.1]</p>

<p style="margin-top: 1em">-m MTPOINT, --mtpoint=MTPOINT
<br>
Mount point [default: &rsquo;/mnt/t&rsquo;]</p>

<p style="margin-top: 1em">-p PORT, --port=PORT <br>
NFS server port [default: 2049]</p>

<p style="margin-top: 1em">--proto=PROTO <br>
NFS protocol name [default: &rsquo;tcp&rsquo;]</p>

<p style="margin-top: 1em">--sec=SEC <br>
Security flavor [default: &rsquo;sys&rsquo;]</p>

<p style="margin-top: 1em">-o MTOPTS, --mtopts=MTOPTS <br>
Mount options [default:
&rsquo;hard,rsize=4096,wsize=4096&rsquo;]</p>

<p style="margin-top: 1em">--datadir=DATADIR <br>
Data directory where files are created, directory is created
on the mount point [default: &rsquo;&rsquo;]</p>

<p style="margin-top: 1em">Logging options: <br>
-v VERBOSE, --verbose=VERBOSE <br>
Verbose level for debug messages [default:
&rsquo;none&rsquo;]</p>

<p style="margin-top: 1em">--tverbose=TVERBOSE <br>
Verbose level for test messages [default:
&rsquo;1&rsquo;]</p>

<p style="margin-top: 1em">--createlog <br>
Create log file</p>

<p style="margin-top: 1em">--warnings <br>
Display warnings</p>

<p style="margin-top: 1em">--tag=TAG <br>
Informational tag, it is displayed as an INFO message
[default: &rsquo;&rsquo;]</p>

<p style="margin-top: 1em">Packet trace options: <br>
--createtraces <br>
Create a packet trace for each test</p>

<p style="margin-top: 1em">--tbsize=TBSIZE <br>
Capture buffer size for tcpdump [default:
&rsquo;50000&rsquo;]</p>

<p style="margin-top: 1em">--trcdelay=TRCDELAY <br>
Seconds to delay before stopping packet trace [default:
0.0]</p>

<p style="margin-top: 1em">--keeptraces <br>
Do not remove any trace files [default: remove trace files
if no errors]</p>

<p style="margin-top: 1em">--rmtraces <br>
Remove trace files [default: remove trace files if no
errors]</p>

<p style="margin-top: 1em">-i INTERFACE,
--interface=INTERFACE <br>
Device interface [default: automatically selected]</p>

<p style="margin-top: 1em">File options: <br>
--nfiles=NFILES <br>
Number of files to create [default: 2]</p>

<p style="margin-top: 1em">--filesize=FILESIZE <br>
File size to use for test files [default: 65536]</p>

<p style="margin-top: 1em">--rsize=RSIZE <br>
Read size to use when reading files [default: 4096]</p>

<p style="margin-top: 1em">--wsize=WSIZE <br>
Write size to use when writing files [default: 4096]</p>

<p style="margin-top: 1em">--iodelay=IODELAY <br>
Seconds to delay I/O operations [default: 0.1]</p>

<p style="margin-top: 1em">--offset-delta=OFFSET_DELTA <br>
Read/Write offset delta [default: 4096]</p>

<p style="margin-top: 1em">Path options: <br>
--sudo=SUDO <br>
Full path of binary for sudo [default:
&rsquo;/usr/bin/sudo&rsquo;]</p>

<p style="margin-top: 1em">--tcpdump=TCPDUMP <br>
Full path of binary for tcpdump [default:
&rsquo;/usr/sbin/tcpdump&rsquo;]</p>

<p style="margin-top: 1em">--iptables=IPTABLES <br>
Full path of binary for iptables [default:
&rsquo;/sbin/iptables&rsquo;]</p>

<p style="margin-top: 1em">--messages=MESSAGES <br>
Full path of log messages file [default:
&rsquo;/var/log/messages&rsquo;]</p>

<p style="margin-top: 1em">--tmpdir=TMPDIR <br>
Temporary directory [default: &rsquo;/tmp&rsquo;]</p>

<p style="margin-top: 1em">Debug options: <br>
--nocleanup <br>
Do not cleanup created files</p>

<p style="margin-top: 1em">--bugmsgs=BUGMSGS <br>
File containing test messages to mark as bugs if they
failed</p>

<p style="margin-top: 1em">--ignore <br>
Ignore all bugs given by bugmsgs</p>

<p style="margin-top: 1em">--nomount <br>
Do not mount server and run the tests on local disk
space</p>

<p style="margin-top: 1em">--basename=BASENAME <br>
Base name for all files and logs [default: automatically
generated]</p>

<p style="margin-top: 1em">--nfsdebug=NFSDEBUG <br>
Set NFS kernel debug flags and save log messages [default:
&rsquo;&rsquo;]</p>

<p style="margin-top: 1em">--rpcdebug=RPCDEBUG <br>
Set RPC kernel debug flags and save log messages [default:
&rsquo;&rsquo;]</p>

<p style="margin-top: 1em">Test options: <br>
--runtest=RUNTEST <br>
Comma separated list of tests to run, if list starts with a
&rsquo;^&rsquo; then all tests are run except the ones
listed [default: &rsquo;all&rsquo;]</p>

<p style="margin-top: 1em">TESTS <br>
access <br>
Verify POSIX API access() on files with different modes.</p>

<p style="margin-top: 1em">chdir <br>
Verify POSIX API chdir() by changing to a newly created
directory <br>
and then by changing back to the original directory.</p>

<p style="margin-top: 1em">close <br>
Verify POSIX API close() works and that writing to a closed
file <br>
descriptor returns an error.</p>

<p style="margin-top: 1em">closedir <br>
Verify POSIX API closedir() works and that reading to a
closed file <br>
descriptor returns an error.</p>

<p style="margin-top: 1em">creat <br>
Verify POSIX API creat(path, mode) is equivalent to <br>
open(path, O_WRONLY|O_CREAT|O_TRUNC, mode). First test with
a path <br>
that does not exist to verify the file was created and then
test <br>
with a path that does exist to verify that the file is
truncated.</p>

<p style="margin-top: 1em">fcntl <br>
Verify the POSIX API fcntl() commands F_DUPFD, F_GETFD,
F_SETFD, <br>
F_GETFL, F_SETFL, and FD_CLOEXEC. The F_DUPFD command is
tested <br>
by performing operations on the original and dupped file
descriptor <br>
to ensure they behave correctly. The F_GETFD and F_SETFD
commands <br>
are tested by setting the FD_CLOEXEC flag and making sure it
gets set. <br>
The F_GETFL and F_SETFL commands are tested by setting the
O_APPEND <br>
flag and making sure it gets set. <br>
Run the test for both &rsquo;read&rsquo; and
&rsquo;write&rsquo;.</p>

<p style="margin-top: 1em">fdatasync <br>
Verify POSIX API fdatasync().</p>

<p style="margin-top: 1em">fstat <br>
Verify POSIX API fstat() by checking the mode on a file and
that <br>
it returns the expected structure members. Create a symlink
and <br>
verify that fstat returns information about the link.</p>

<p style="margin-top: 1em">fstatvfs <br>
Verify POSIX API fstatvfs() by making sure all the members
of the <br>
structure are returned.</p>

<p style="margin-top: 1em">fsync <br>
Verify POSIX API fsync().</p>

<p style="margin-top: 1em">link <br>
Verify POSIX API link(src, dst) creates a link and updates
<br>
st_ctime field for the file. Verify that link updates the
<br>
st_ctime and st_mtime for the directory. Verify st_link
count <br>
incremented by 1 for the file.</p>

<p style="margin-top: 1em">lseek <br>
Verify POSIX API lseek() with different offsets and whence
<br>
values including seeking past the end of the file.</p>

<p style="margin-top: 1em">lstat <br>
Verify POSIX API lstat() by checking the mode on a file and
that <br>
it returns the expected structure members. Create a symlink
and <br>
verify that lstat returns information about the link.</p>

<p style="margin-top: 1em">mkdir <br>
Verify POSIX API mkdir(). Verify that mkdir with a path of a
symbolic <br>
link fails. Verify that the st_ctime and st_mtime fields of
the <br>
parent directory are updated.</p>

<p style="margin-top: 1em">mmap <br>
Verify POSIX API mmap() by mapping a file and verifying I/O
<br>
operations. Verify mmap followed by memory read of existing
<br>
file works. Verify mmap followed by memory write to file
works.</p>

<p style="margin-top: 1em">munmap <br>
Verify POSIX API munmap() by mapping a file and then
unmapping <br>
the file.</p>

<p style="margin-top: 1em">opendir <br>
Verify POSIX API opendir() on a directory.</p>

<p style="margin-top: 1em">read <br>
Verify POSIX API read() by reading data from a file. Verify
that <br>
the st_atime of the file is updated after the read. Verify a
read <br>
of 0 bytes returns 0.</p>

<p style="margin-top: 1em">readdir <br>
Verify POSIX API readdir() on a directory.</p>

<p style="margin-top: 1em">readlink <br>
Verify Test POSIX API readlink() by reading a symbolic
link.</p>

<p style="margin-top: 1em">rename <br>
Verify POSIX API rename() by renaming a file, directory, and
a <br>
symbolic link. Verify that a rename from a file to a
symbolic <br>
link will cause the symbolic link to be removed.</p>

<p style="margin-top: 1em">rewinddir <br>
Verify POSIX API rewinddir() on a directory.</p>

<p style="margin-top: 1em">rmdir <br>
Verify POSIX API rmdir() by removing a directory. Verify
that the <br>
parent&rsquo;s st_ctime and st_mtime are updated.</p>

<p style="margin-top: 1em">seekdir <br>
Verify POSIX API seekdir() on a directory.</p>

<p style="margin-top: 1em">stat <br>
Verify POSIX API stat() by checking the mode on a file and
that <br>
it returns the expected structure members. Create a symlink
and <br>
verify that stat returns information about the file.</p>

<p style="margin-top: 1em">statvfs <br>
Verify POSIX API statvfs() by making sure all the members of
the <br>
structure are returned.</p>

<p style="margin-top: 1em">symlink <br>
Verify POSIX API symlink() by creating a symbolic link and
verify <br>
that the file type is slnk.</p>

<p style="margin-top: 1em">sync <br>
Verify POSIX API sync().</p>

<p style="margin-top: 1em">telldir <br>
Verify POSIX API telldir() on a directory.</p>

<p style="margin-top: 1em">unlink <br>
Verify POSIX API unlink() by unlinking a file and verify
that it <br>
was removed. Verify that the st_ctime and st_mtime fields of
the <br>
parent directory were updated. Then unlink a symbolic link
and <br>
verify that the symbolic link was removed but not the
referenced <br>
file. Then remove an opened file and verify that I/O still
occurs <br>
to the file after the unlink and that the file gets removed
when <br>
the file is closed. Create a file and then hard link to it
so the <br>
link count is greater than 1. Unlink the hard file and
verify that <br>
st_ctime field is updated.</p>

<p style="margin-top: 1em">write <br>
Verify POSIX API write() by writing 0 bytes and verifying 0
<br>
is returned. Write a pattern the file, seek +N, write
another <br>
pattern, and close the file. Open the file and read in both
<br>
written patterns and verify that it is the correct pattern.
<br>
Read in the data from the hole in the file and verify that
it is 0.</p>

<p style="margin-top: 1em">open <br>
Verify POSIX API open() on a file. Verify file creation
using <br>
the O_CREAT flag and verifying the file mode is set to the
<br>
specified value. Verify the st_ctime and st_mtime are
updated <br>
on the parent directory after the file was created. Verify
open <br>
on existing file fails with the O_EXCL flag set. Verify
write <br>
succeeds and read fails if file was open with O_WRONLY.
Verify <br>
read succeeds and write fails if file was open with
O_RDONLY. <br>
Verify that all writes with O_APPEND set are to the end of
the file. <br>
Use O_DSYNC, O_RSYNC, and O_SYNC flags in open calls. <br>
Verify file open with O_CREAT and O_TRUNC set will truncate
an <br>
existing file. Verify that it updates the file st_ctime and
st_mtime.</p>

<p style="margin-top: 1em">chmod <br>
Verify POSIX API chmod() on a file and directory by trying
all valid <br>
combinations of modes. Verify that the st_ctime files is
updated <br>
for both the file and directory.</p>

<p style="margin-top: 1em">EXAMPLES <br>
The only required option is --server <br>
$ nfstest_posix --server 192.168.0.11</p>

<p style="margin-top: 1em">NOTES <br>
The user id in the local host must have access to run
commands as root using the &rsquo;sudo&rsquo; command
without the need for a password.</p>

<p style="margin-top: 1em">SEE ALSO <br>
nfstest.test_util(3), nfstest_alloc(1), nfstest_cache(1),
nfstest_delegation(1), nfstest_dio(1), nfstest_file(1),
nfstest_interop(1), nfstest_io(1), nfstest_lock(1), <br>
nfstest_pkt(1), nfstest_pnfs(1), nfstest_sparse(1),
nfstest_xid(1)</p>

<p style="margin-top: 1em">BUGS <br>
No known bugs.</p>

<p style="margin-top: 1em">AUTHOR <br>
Jorge Mora (mora@netapp.com)</p>

<p style="margin-top: 1em">NFStest 2.1.1 23 November 2015
NFSTEST_POSIX(1)</p>
<hr>
</body>
</html>
