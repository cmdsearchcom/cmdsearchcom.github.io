<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:36:53 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>SC(1) General Commands Manual SC(1)</p>

<p style="margin-top: 1em">NAME <br>
sc - spreadsheet calculator</p>

<p style="margin-top: 1em">SYNOPSIS <br>
sc [-a] [-c] [-e] [-m] [-n] [-o] [-q] [-r] [-v] [-x] [-C]
[-R] [-P range[/address] | /address] [-W range]
[file...]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
The spreadsheet calculator sc is based on rectangular tables
much like a financial spreadsheet. When invoked, it first
looks for a file in the user&rsquo;s home directory called
.scrc <br>
and if found, reads that file into memory. If that file
contains the command &lsquo;&lsquo;set scrc&rsquo;&rsquo;,
sc looks for a file called .scrc in the current directory,
and if found, reads that <br>
file into memory, too. Next, it reads the options from the
command line, and finally, it reads in the file or files
specified on the command line and presents the data in a
ta&acirc; <br>
ble organized as rows and columns of cells. If invoked
without a file argument, the table is initially empty,
unless it is running in a pipeline, in which case it will
read its <br>
data from the standard input. If more than one file is
specified, all files except the first one will be merged.
The default filename for saving a file with the Put command
<br>
will be the same as the first file specified, and the other
files will be treated as macros. If you want to use advanced
macros from the command line, the
&lsquo;&lsquo;|&rsquo;&rsquo; must be quoted <br>
to prevent it from being expanded by the shell.</p>

<p style="margin-top: 1em">Options begin with -. However,
an argument of a single - will be interpreted to mean that
spreadsheet data will be taken from the standard input. This
is useful for including <br>
sc in a pipeline if the system supports pipes. However, if
standard input is not a terminal, the - is only necessary if
there are multiple files and standard input is not the <br>
last to be read, since standard input is automatically read
in after all other files in such cases if it is not
specified explicitly, or if there are no other filenames on
the <br>
command line. If sc is included in a pipeline, and a
filename of &lsquo;&lsquo;-&rsquo;&rsquo; is not specified,
the standard input will be merged in after all of the other
named files have been pro&acirc; <br>
cessed.</p>

<p style="margin-top: 1em">The first argument not beginning
with a -, or a single - by itself, and any subsequent
arguments will all be interpreted as filenames (a filename
of - meaning standard input as <br>
noted above). In addition, an argument of -- may be used to
signify that all subsequent arguments should be treated as
filenames even if they begin with a -, but unlike -, -- <br>
won&rsquo;t be treated as a filename itself.</p>

<p style="margin-top: 1em">Each cell may have associated
with it a numeric value, a label string, and/or an
expression (formula) which evaluates to a numeric value or
label string, often based on other <br>
cell values.</p>

<p style="margin-top: 1em">For an online tutorial, type the
command:</p>

<p style="margin-top: 1em">sc
/usr/share/doc/sc/tutorial.sc</p>

<p style="margin-top: 1em">To print a quick reference card,
type the command:</p>

<p style="margin-top: 1em">scqref |
[your_printer_commmand]</p>

<p style="margin-top: 1em">OPTIONS <br>
-a Do not run the autorun macro, if one is specified in the
file.</p>

<p style="margin-top: 1em">-c Start the program with the
recalculation being done in column order.</p>

<p style="margin-top: 1em">-e Start the program with
round-to-even (banker&rsquo;s rounding) enabled.</p>

<p style="margin-top: 1em">-m Start the program with
automatic recalculation disabled. The spreadsheet will be
recalculated only when the &lsquo;&lsquo;@&rsquo;&rsquo;
command is used.</p>

<p style="margin-top: 1em">-n Start the program in quick
numeric entry mode (see below).</p>

<p style="margin-top: 1em">-o Start the program with
automatic optimization of expressions enabled.</p>

<p style="margin-top: 1em">-q Quit after loading all files,
but before becoming interactive. This is useful in shell
scripts for getting information from a file, for example, or
using sc as a non- <br>
interactive calculator using the eval command.</p>

<p style="margin-top: 1em">-r Start the program with the
recalculation being done in row order (default option).</p>

<p style="margin-top: 1em">-v When piping data out using
the -P option (below), change all expressions to values. The
-v option must precede the -P option to have an effect. If
the -P option is used <br>
more than once, there must be a separate -v option for each
instance of the -P option.</p>

<p style="margin-top: 1em">-x Cause the Get and Put
commands (see below) to encrypt and decrypt data files.</p>

<p style="margin-top: 1em">-C Start the program with
automatic newline action set to increment the column (see
below).</p>

<p style="margin-top: 1em">-P range[/address] <br>
-P /address <br>
Pipe a range to standard output. The output is similar to
that of the Put command (below), except that only cell data
and formatting information for cells in the range <br>
are output, without all of the colors, range definitions,
column formatting, etc. The optional /address is used to
adjust all addresses in the range to a new starting <br>
point. This is useful for copying data from one file to
another, especially when used in conjunction with the -v
option (above), using something like merge &quot;|sc -v <br>
-Prange/address filename&quot; (note the pipe symbol). This
option may be used more than once to specify multiple
ranges. Note, however, that the -v option must precede the
<br>
-P option on the command line, and there must be a separate
-v option for each instance of the -P option. Any instance
of -P not preceded by its own -v option will output <br>
unevaluated expressions.</p>

<p style="margin-top: 1em">A range of
&lsquo;&lsquo;%&rsquo;&rsquo; may be used to refer to the
entire spreadsheet. If the range is left out, as shown in
the second form above, sc will be started interactively in
navigate <br>
mode, allowing you to navigate the spreadsheet and highlight
the range you want to output. Pressing ESC, ^G, or q will
terminate without outputting any data.</p>

<p style="margin-top: 1em">-R Start the program with
automatic newline action set to increment the row (see
below).</p>

<p style="margin-top: 1em">-W Pipe a range to standard
output. The output is identical to that of the Write command
(below). This option may be used more than once to specify
multiple ranges. A <br>
range of &lsquo;&lsquo;%&rsquo;&rsquo; may be used to refer
to the entire spreadsheet.</p>

<p style="margin-top: 1em">All of these options can be
changed with the ^T and S commands (see below) while sc is
running. Options specified when sc is invoked override
options saved in the data file.</p>

<p style="margin-top: 1em">Personal Initialization File
<br>
When sc first starts, it looks for a file in the
user&rsquo;s home directory called .scrc and if found, loads
it into memory. The format of this file is the same as any
other sc file, <br>
but should be reserved for setting certain defaults. Any
options set which have equivalent command line options may
be overridden by the command line. If that file contains the
<br>
command &lsquo;&lsquo;set scrc&rsquo;&rsquo;, sc will then
look for a file called .scrc in the current directory, and
if found, load that file into memory, too (this is analogous
to the &lsquo;&lsquo;set exrc&rsquo;&rsquo; <br>
command used by vi/ex). These
&lsquo;&lsquo;dotfiles&rsquo;&rsquo; may be created by any
text editor. Several commands exist specifically for setting
default file name extensions in the .scrc file, <br>
although they may also be used from macros, ordinary
spreadsheet files, or from within sc at the command line.
They will not, however, be saved along with the file. The
exten&acirc; <br>
sions should be quoted, and should not include the preceding
&lsquo;.&rsquo; (e.g., scext &quot;sc&quot; will add the
extension .sc ). These commands are:</p>

<p style="margin-top: 1em">scext This is the default
extension for normal sc files (those created with the Put
command). If this command is not used, all sc files will be
saved without an extension, and <br>
any existing extension will not be removed. Setting this
option causes all sc files to be saved with the specified
extension added, unless it is already present. If the <br>
file name already has an extension of .sc, it will first be
removed. Any other extension will not be removed.</p>

<p style="margin-top: 1em">ascext This is the default
extension for plain text files created with the Write
command. The file name will first be checked to see if it
already has an extension of either .sc <br>
or the extension specified with scext above, and if either
one exists, it will first be removed before adding the new
extension. If this option is not set, a default of <br>
.asc will be used.</p>

<p style="margin-top: 1em">tbl0ext <br>
This is the default extension for files created with the Tbl
command if tblstyle is set to 0 (default). The file name
will first be checked to see if it already has an <br>
extension of either .sc or the extension specified with
scext above, and if either one exists, it will first be
removed before adding the new extension. If this option is
<br>
not set, a default of .cln will be used.</p>

<p style="margin-top: 1em">tblext This is the default
extension for files created with the Tbl command if tblstyle
is set to tbl. The file name will first be checked to see if
it already has an extension <br>
of either .sc or the extension specified with scext above,
and if either one exists, it will first be removed before
adding the new extension. If this option is not set, <br>
a default of .tbl will be used.</p>

<p style="margin-top: 1em">latexext <br>
This is the default extension for files created with the Tbl
command if tblstyle is set to latex. The file name will
first be checked to see if it already has an exten&acirc;
<br>
sion of either .sc or the extension specified with scext
above, and if either one exists, it will first be removed
before adding the new extension. If this option is not <br>
set, a default of .lat will be used.</p>

<p style="margin-top: 1em">slatexext <br>
This is the default extension for files created with the Tbl
command if tblstyle is set to slatex. The file name will
first be checked to see if it already has an exten&acirc;
<br>
sion of either .sc or the extension specified with scext
above, and if either one exists, it will first be removed
before adding the new extension. If this option is not <br>
set, a default of .stx will be used.</p>

<p style="margin-top: 1em">texext This is the default
extension for files created with the Tbl command if tblstyle
is set to tex. The file name will first be checked to see if
it already has an extension <br>
of either .sc or the extension specified with scext above,
and if either one exists, it will first be removed before
adding the new extension. If this option is not set, <br>
a default of .tex will be used.</p>

<p style="margin-top: 1em">General Information <br>
The screen is divided into four regions. The top line is for
entering commands and displaying cell values. The second
line is for messages from sc. The third line and the <br>
first four columns show the column and row numbers, from
which are derived cell addresses, e.g. A0 for the cell in
column A, row 0. Note that column names are
case-insensitive: <br>
you can enter A0 or a0.</p>

<p style="margin-top: 1em">The rest of the screen forms a
window looking at a portion of the table. The total number
of display rows and columns available, hence the number of
table rows and columns dis&acirc; <br>
played, is set by curses(3) and may be overridden by setting
the LINES and COLUMNS environment variables,
respectively.</p>

<p style="margin-top: 1em">The screen has two cursors: a
cell cursor, indicated by either a highlighted cell or a
&lsquo;&lsquo;&lt;&rsquo;&rsquo; on the screen, and a
character cursor, indicated by the terminal&rsquo;s hardware
cursor.</p>

<p style="margin-top: 1em">If a cell&rsquo;s numeric value
is wider than the column width (see the f command), the cell
is filled with asterisks. If a cell&rsquo;s label string is
wider than the column width, it is <br>
truncated at the start of the next non-blank cell in the
row, if any.</p>

<p style="margin-top: 1em">Cursor control commands and row
and column commands can be prefixed by a numeric argument
which indicates how many times the command is to be
executed. You can type ^U before a <br>
repeat count if quick numeric entry mode is enabled.</p>

<p style="margin-top: 1em">Changing Options</p>

<p style="margin-top: 1em">^To Toggle options. This command
allows you to switch the state of one option selected by o.
A small menu lists the choices for o when you type ^T.
Unless otherwise noted, <br>
the options selected are saved when the data and formulas
are saved so that you will have the same setup next time you
enter the spreadsheet.</p>

<p style="margin-top: 1em">a Automatic Recalculation. When
set, each change in the spreadsheet causes the entire
spreadsheet be recalculated. Normally this is not
noticeable, but for very <br>
large spreadsheets, it may be faster to clear automatic
recalculation mode and update the spreadsheet via explicit
&lsquo;&lsquo;@&rsquo;&rsquo; commands. Default is automatic
recalcula&acirc; <br>
tion on.</p>

<p style="margin-top: 1em">b Braille enhancement mode. See
the braille section under the Set command below for a
complete description of how to use this mode. This option is
not saved when <br>
saving a file, to allow blind and sighted users to easily
share files. It is intended for use in a user&rsquo;s .scrc
file.</p>

<p style="margin-top: 1em">c Current cell highlighting. If
enabled, the current cell is highlighted (using the
terminal&rsquo;s standout mode, if available) and the cell
pointer &lsquo;&lsquo;&lt;&rsquo;&rsquo; is turned off. <br>
This is enabled by default.</p>

<p style="margin-top: 1em">e External function execution.
When disabled, external functions (see @ext() below) are not
called. This saves a lot of time at each screen update.
External func&acirc; <br>
tions are disabled by default. If disabled, and external
functions are used anywhere, a warning is printed each time
the screen is updated, and the result of <br>
@ext() is the value from the previous call, if any, or a
null string.</p>

<p style="margin-top: 1em">i Automatic insertion of
rows/columns. If this is enabled and craction is set to move
the cell cursor either down or to the right after entering
data into a cell, <br>
and the last cell in a row/column in the scrolling portion
of a framed range was just filled, causing the cell cursor
to move outside of this range, a new col&acirc; <br>
umn/row will be inserted, thus enlarging the range and
allowing you to continue entering data into the row/column
without overwriting the frame (which may contain <br>
expressions of some sort, such as totals). If autowrap is
also enabled, it will take precedence, and a new row/column
will only be inserted after entering data in <br>
the very last cell (bottom right corner) of the scrolling
range. The default is no automatic insertion.</p>

<p style="margin-top: 1em">w Automatic wrap to next
row/column. If this is enabled and craction is set to move
the cell cursor either down or to the right after entering
data into a cell, and <br>
the last cell in a row/column in the scrolling portion of a
framed range was just filled, causing the cell cursor to
move outside of this range, the cell cursor <br>
will move to the first cell in the next row/column in this
range. If this would also take the cursor out of the
scrolling portion of the range, the cursor will <br>
remain in last edited cell instead, unless autoinsert is
also enabled, in which case a new row/column will be added
so that the cursor can wrap. The default is no <br>
autowrap.</p>

<p style="margin-top: 1em">l Autolabeling. If enabled,
using the define command (rd) causes a label to be
automatically generated in the cell to the left of the
defined cell. This is only <br>
done if the cell to the left is empty. Default is
enabled.</p>

<p style="margin-top: 1em">n Quick numeric entry. If
enabled, a typed digit is assumed to be the start of a
numeric value for the current cell, not a repeat count,
unless preceded by ^U. <br>
Also, the &lsquo;+&rsquo; and &lsquo;-&rsquo; keys will
enter insert mode and append a &lsquo;+&rsquo; or
&lsquo;-&rsquo; to the existing contents of the cell,
allowing the user to easily add to or subtract from <br>
the current numeric contents of the cell. The cursor
controls (^P, ^N, or any of the arrow keys) in this mode
will end a numeric entry if the entry was started by <br>
pressing &lsquo;+&rsquo;, &lsquo;-&rsquo;, or a digit.
Switching from insert mode to edit mode will cause the
cursor controls to revert to their normal functions.</p>

<p style="margin-top: 1em">o Automatic optimization of
expressions. If this is enabled, expressions which evaluate
to a constant are automatically optimized upon entry. For
example, if you <br>
enter @pow(2,32) into a cell, the value 4294967296 will be
stored in that cell, whereas if optimization is turned off,
the calculated value will be displayed, but <br>
the actual expression will be stored in the cell instead.
This allows you to edit the expression instead of
re-entering it from scratch when you just want to make <br>
a minor change. Default is automatic optimization off.</p>

<p style="margin-top: 1em">t Top line display. If enabled,
the name and value of the current cell is displayed on the
top line. If there is an associated label string, the first
character of <br>
the string value is &lsquo;&lsquo;|&rsquo;&rsquo; for a
centered string, &lsquo;&lsquo;&lt;&rsquo;&rsquo; for a
leftstring or &lsquo;&lsquo;&gt;&rsquo;&rsquo; for a
rightstring (see below), followed by &quot;string&quot; for
a constant string or {expr} <br>
for a string expression. A constant string may be preceeded
with a backslash (&lsquo;&acute;). In this case the constant
string will be used as a &lsquo;&lsquo;wheel&rsquo;&rsquo;
to fill a column, <br>
e.g. &quot;&minus;&quot; for a line in a column, and &quot;h
&quot; for &quot;Yeh Yeh Ye&quot;. If the cell has a numeric
value, it follows as [value], which may be a constant or
expression.</p>

<p style="margin-top: 1em">$ Dollar prescale. If enabled,
all numeric constants (not expressions) which you enter are
multipled by 0.01 so you don&rsquo;t have to keep typing the
decimal point if <br>
you enter lots of dollar figures.</p>

<p style="margin-top: 1em">r Newline action. This is a
3-way toggle which determines which direction to move after
pressing the RETURN key to enter data into a cell. It has
the same effect as <br>
using the set (S) command to set the value of craction.
After selecting this option, you will be prompted for the
direction you want to move. Valid directions are <br>
down (craction=1) and to the right (craction=2). Pressing j,
^N, or the cursor-down key will cause the cursor to move
down a cell each time you press the RETURN <br>
key and pressing l, the cursor-right key, or the space bar
will cause the cursor to move one cell to the right.
Pressing the RETURN key at the prompt selects no <br>
action (craction=0, which means that the cursor will remain
in the current cell). No action is the default unless sc is
started with either the -R or -C option. <br>
This option is ignored if the cell into which data is being
entered is not the current cell.</p>

<p style="margin-top: 1em">s Enable/disable color slop. If
a cell&rsquo;s label string is wider than the column width,
it will slop over into the next cell to the right if that
cell is empty. How&acirc; <br>
ever, if that cell is in a different color range than the
first, this slopover will be disabled, regardless of whether
the colors assigned to the two ranges are <br>
different or not. If cslop is enabled, strings may slop over
even if the next cell is in a different color range,
carrying their color with them, which may cause a <br>
ragged boundary between the ranges, but may allow the
strings to be seen in their entirety. Cslop is disabled by
default.</p>

<p style="margin-top: 1em">x Encryption. See the -x
option.</p>

<p style="margin-top: 1em">z Set newline action limits.
This option sets limits to the newline action option above.
When this option is invoked, the row and column of the
current cell are <br>
remembered. If a later newline action would take the current
cell to the right of the remembered column, then the current
cell is instead moved to the first column <br>
of the next row. If a newline action would take the current
cell below the remembered row, then the current cell is
instead moved to the top row of the next col&acirc; <br>
umn.</p>

<p style="margin-top: 1em">C Color. This option enables
color, and must be set before any other color options, such
as colorneg (color negative numbers) or colorerr (color
cells with errors), <br>
will have an effect. On a slow connection, turning off color
can noticeably speed up screen updates.</p>

<p style="margin-top: 1em">E Color cells with errors.
Setting this option will cause all cells with expressions
which evaluate to ERROR or INVALID to be set to color 3.
Color must be enabled <br>
for this option to take effect.</p>

<p style="margin-top: 1em">N Color negative numbers. When
this option is set, all cells containing negative numbers
will have their color number incremented by one. Cells with
color 8 will <br>
cycle back to color 1. Color must be enabled for this option
to take effect.</p>

<p style="margin-top: 1em">The quick numeric entry, newline
action and set newline action limits options can be combined
to allow very quick entry of large amounts of data. If all
the data to be <br>
entered is in a single row or column then setting the quick
numeric entry and the appropriate newline action will allow
the numbers to be entered without any explicit com&acirc;
<br>
mands to position the current cell or enter a number.</p>

<p style="margin-top: 1em">If the data entry involves
several entries in each row for many rows, then setting the
quick numeric entry option, setting the newline action to
move right after each <br>
entry and setting the newline action limits on the last
column on which data should be entered will allow the data
to entered quickly. An alternative to setting newline <br>
action limits is to enclose the range for entry in a frame
(see &quot;Framed Ranges&quot; below), and setting the
autowrap option. Setting autoinsert will insert new rows as
needed <br>
if the frame includes data at the bottom. If necessary,
columns which do not need data to be entered can be hidden
with the z command. Similar arrangements can be made <br>
for entering several rows of data in each column.</p>

<p style="margin-top: 1em">S Set options. This command
allows you to set various options. A small menu lists the
options that cannot be changed through ^T above.</p>

<p style="margin-top: 1em">byrows/bycols <br>
Specify the order cell evaluation when updating. These
options also affect the order in which cells are filled (see
rf) and whether a row or column is cleared by <br>
an x command.</p>

<p style="margin-top: 1em">iterations=n <br>
Set the maximum number of recalculations before the screen
is displayed again. Iterations is set to 10 by default.</p>

<p style="margin-top: 1em">tblstyle=s <br>
Control the output of the T command. s can be: 0 (default)
to give colon delimited fields, with no tbl control lines;
tbl to give colon delimited fields, with <br>
tbl(1) control lines; latex to give a LaTeX tabular
environment; slatex to give a SLaTeX (Scandinavian LaTeX)
tabular environment; tex to give a TeX simple tabbed <br>
alignment with ampersands as delimiters; and frame to give a
tblstyle output for FrameMaker.</p>

<p style="margin-top: 1em">pagesize=n <br>
Set the page size for the PageUp, PageDown, J, and K
commands. If set to 0, the default is to move up or down
half the number of rows displayed on the screen, or <br>
if the current cell is in a framed range, half the number of
displayed rows in the scrolling region of that range.</p>

<p style="margin-top: 1em">Other Set options are normally
used only in sc data files since they are available through
^T. You can also use them interactively.</p>

<p style="margin-top: 1em">autocalc/!autocalc <br>
Set/clear auto recalculation mode.</p>

<p style="margin-top: 1em">autoinsert/!autoinsert <br>
Set/clear automatic insertion mode.</p>

<p style="margin-top: 1em">autowrap/!autowrap <br>
Set/clear autowrap mode.</p>

<p style="margin-top: 1em">optimize/!optimize <br>
Set/clear auto optimize mode.</p>

<p style="margin-top: 1em">numeric/!numeric <br>
Set/clear numeric mode.</p>

<p style="margin-top: 1em">prescale/!prescale <br>
Set/clear numeric prescale mode.</p>

<p style="margin-top: 1em">extfun/!extfun <br>
Enable/disable external functions.</p>

<p style="margin-top: 1em">toprow/!toprow <br>
Set/clear top row display mode.</p>

<p style="margin-top: 1em">rndtoeven/!rndtoeven <br>
Default: *.5 will be rounded up to the next integer; doing a
&rsquo;set rndtoeven&rsquo; will cause it to be rounded to
the closest even number instead (aka banker&rsquo;s
rounding). <br>
Round-to-even has advantages over the default rounding for
some applications. For example, if X+Y is an integer, then
X+Y = rnd(X)+rnd(Y) with round-to-even, but <br>
not always with the defaulting rounding method. This could
be an advantage, for example, when trying to split an odd
amount of money evenly between two people (it <br>
would determine who gets the extra penny). Note: rndtoeven
only effects the @rnd and @round functions. It has no effect
on how a number is rounded to fit the dis&acirc; <br>
play format of a cell.</p>

<p style="margin-top: 1em">craction=n <br>
Set the newline action. n can be: 0 (default) to give no
action; 1 to move down after each entry; or 2 to move right
after each entry.</p>

<p style="margin-top: 1em">rowlimit=n <br>
Set the remembered limit for the maximum row below which the
current cell will be moved to the top of the next column if
the newline action is set to move the cur&acirc; <br>
rent cell down. n can be -1 (default) to disable this
facility.</p>

<p style="margin-top: 1em">collimit=n <br>
Set the remembered limit for the maximum column to the right
of which the current cell will be moved to the left of the
next row if the newline action is set to <br>
move the current cell right. n can be -1 (default) to
disable this facility.</p>

<p style="margin-top: 1em">color/!color <br>
Enable color. This option must be set for any other color
options, such as colorneg or colorerr, to take effect. On a
slow connection, turning off color can <br>
noticeably speed up screen updates.</p>

<p style="margin-top: 1em">colorneg/!colorneg <br>
Color negative numbers. When this option is set, all cells
containing negative numbers will have their color number
increased by one. Cells with color 8 will <br>
cycle back to color 1. Color must be enabled for this option
to take effect.</p>

<p style="margin-top: 1em">colorerr/!colorerr <br>
Color cells with errors. Setting this option will cause all
cells with expressions which evaluate to ERROR or INVALID to
be set to color 3. Color must be enabled <br>
for this option to take effect.</p>

<p style="margin-top: 1em">cslop/!cslop <br>
Enable color slop. If a cell&rsquo;s label string is wider
than the column width, it will slop over into the next cell
to the right if that cell is empty. However, if <br>
that cell is in a different color range than the first, this
slop over will be disabled, regardless of whether the colors
assigned to the two ranges are different <br>
or not. If cslop is enabled, strings may slop over even if
the next cell is in a different color range, carrying their
color with them, which may cause a ragged <br>
boundary between the ranges, but may allow the strings to be
seen in their entirety. Cslop is disabled by default.</p>

<p style="margin-top: 1em">The following Set options are
considered personal preferences, or are terminal dependent,
and are therefore not saved when saving a file, but are
instead intended for use <br>
in a user&rsquo;s .scrc file.</p>

<p style="margin-top: 1em">braille/!braille <br>
Set/clear braille enhancement mode. When braille enhancement
mode is set, the cursor behaves in a manner that makes the
use of sc much easier when using a braille <br>
display. In spite of its name, this mode also works well
with screen readers such as SpeakUp, and can even be used by
sighted users to make cutting and pasting <br>
using the screen program much easier.</p>

<p style="margin-top: 1em">There are actually two different
braille modes. When the braille option is set, the C
command, which is normally used to set colors, will instead
change from one <br>
braille mode to the other. If it is desired to set/change
colors so you can share files with others not using a
braille display, braille mode will have to be <br>
switched off temporarily, and then switched back on after
the color operation is done.</p>

<p style="margin-top: 1em">When the braille option is set,
the default braille mode will cause the cursor to be
positioned at the left edge of the current cell, while the
alternate braille <br>
mode will cause the cursor to be placed at the beginning of
the top line, which will contain information such as the
current cell address, contents of the cell, and <br>
column formatting information. The column names will also be
moved to the left edge of their respective columns in order
to remain aligned with the cursor as it <br>
moves up and down the column.</p>

<p style="margin-top: 1em">In either mode, the cursor will
be placed in the top line when editing a line, except when
switching to navigate mode, in which case the cursor will be
placed in <br>
either the current cell (default braille mode) or the second
line, where the cell address or default range will be
displayed (alternate braille mode).</p>

<p style="margin-top: 1em">Whenever a message is displayed
on the second line, such as an error message or prompt for
further information, both modes will cause the cursor to be
placed at the <br>
beginning of that message. After this message goes away, the
cursor will revert to its former behavior. The easiest way
to make this message go away without <br>
effecting anything, except in the cases where it is asking
the user for more information, is to press CC, which
effectively changes modes twice, with a net effect <br>
of leaving sc in the original mode.</p>

<p style="margin-top: 1em">locale/!locale <br>
If locale support is compiled into sc, this option will
cause certain locale-dependent behaviors, such as the
display of numbers and the determination of word <br>
boundaries for some operations in edit mode. Note that if
this option is set and the environment variable LC_ALL is
unrecognized, unset, or set to either
&lsquo;&lsquo;POSIX&rsquo;&rsquo; <br>
or &lsquo;&lsquo;C&rsquo;&rsquo;, commas in format commands
will be ignored.</p>

<p style="margin-top: 1em">cellcur/!cellcur <br>
Set/clear current cell highlighting mode. This option is
included here because it is likely to be terminal dependent
and/or a user preference, and therefore is not <br>
saved when saving a file.</p>

<p style="margin-top: 1em">scrc It tells sc to also read
the file .scrc in the current directory when starting.
Settings in this file will override those in $HOME/.scrc but
may themselves be <br>
overridden by command line options. Setting this could be a
potential security risk, since starting sc with an unknown
.scrc could potentially execute arbitrary <br>
commands. This risk is probably very slight, since a
spreadsheet program is not likely to be run in just any
directory, and should never be run as root.</p>

<p style="margin-top: 1em">Cursor Control Commands</p>

<p style="margin-top: 1em">^A Go to cell A0 (same as
HOME).</p>

<p style="margin-top: 1em">^P Move the cell cursor up to
the previous row.</p>

<p style="margin-top: 1em">^N Move the cell cursor down to
the next row.</p>

<p style="margin-top: 1em">^H Move the cell cursor backward
one column.</p>

<p style="margin-top: 1em">SPACE Move the cell cursor
forward one column. When in navigate mode, if a range is
highlighted, insert the highlighted range into the command
line, followed by a space, while <br>
remaining in navigate mode. This is useful when entering
copy, move, or frame commands, for example, which accept
more than one range argument.</p>

<p style="margin-top: 1em">h, j, k, l <br>
These are alternate, vi-compatible cell cursor controls
(left, down, up, right). Space is just like l (right).</p>

<p style="margin-top: 1em">H, J, K, L <br>
These move the cursor by half pages (left, down, up, right).
If pagesize is nonzero, up/down paging will be by pagesize
rows, instead.</p>

<p style="margin-top: 1em">^F, ^B Same as J and K
above.</p>

<p style="margin-top: 1em">PAGE-DOWN PAGE-UP <br>
Same as J and K above.</p>

<p style="margin-top: 1em">TAB If the character cursor is
on the top line, TAB tries to complete a range name if the
character immediately preceding it is alphanumeric or
&lsquo;&lsquo;_&rsquo;&rsquo;, and starts a range if <br>
not (see below). Otherwise, move the cell cursor forward one
column.</p>

<p style="margin-top: 1em">HOME Go to cell A0.</p>

<p style="margin-top: 1em">END Same as ^E (see below).</p>

<p style="margin-top: 1em">Arrow Keys <br>
The terminal&rsquo;s arrow keys provide another alternate
set of cell cursor controls if they exist and are supported
in the appropriate termcap entry. Some terminals have <br>
arrow keys which conflict with other control key codes. For
example, a terminal might send ^H when the back arrow key is
pressed. In these cases, the conflicting arrow <br>
key performs the same function as the key combination it
mimics.</p>

<p style="margin-top: 1em">^ Move the cell cursor up to row
0 of the current column.</p>

<p style="margin-top: 1em"># Move the cell cursor down to
the last valid row of the current column.</p>

<p style="margin-top: 1em">0 Move the cell cursor backward
to column A of the current row. This command must be
prefixed with ^U if quick numeric entry mode is enabled.</p>

<p style="margin-top: 1em">$ Move the cell cursor forward
to the last valid column of the current row.</p>

<p style="margin-top: 1em">b Scan the cursor backward (left
and up) to the previous valid cell.</p>

<p style="margin-top: 1em">w Scan the cursor forward (right
and down) to the next valid cell.</p>

<p style="margin-top: 1em">g Go to a cell. sc prompts for a
cell&rsquo;s name, a regular expression surrounded by
quotes, or a number. If a cell&rsquo;s name such as ae122 or
the name of a defined range is <br>
given, the cell cursor goes directly to that cell. If a
quoted regular expression such as &quot; Tax Table &quot; or
&quot; ^Jan [0-9]*$ &quot; is given, sc searches for a cell
containing a <br>
string matching the regular expression. See regex(3) or
ed(1) for more details on the form of regular
expressions.</p>

<p style="margin-top: 1em">You can also search formatted
numbers or expressions using regular expressions by
preceding the opening quotes of the regular expression with
a &lsquo;&lsquo;#&rsquo;&rsquo; (for formatted num&acirc;
<br>
bers) or a &lsquo;&lsquo;%&rsquo;&rsquo; (for expressions).
These are handy for searching for dates within a specified
range or cells which reference a given cell, for example,
although they are <br>
somewhat slower than searching through ordinary strings,
since all numbers must be formatted or expressions
decompiled on the fly during the search.</p>

<p style="margin-top: 1em">If a number is given, sc will
search for a cell containing that number. Searches for
either strings or numbers proceed forward from the current
cell, wrapping back to a0 <br>
at the end of the table, and terminate at the current cell
if the string or number is not found. You may also go to a
cell with an ERROR (divide by zero, etc. in this <br>
cell) or INVALID (references a cell containing an ERROR). g
error will take you to the next ERROR, while g invalid take
you to the next INVALID. The last g command is <br>
saved, and can be re-issued by entering g&lt;return&gt;. You
can also repeat the last search by pressing n.</p>

<p style="margin-top: 1em">An optional second argument is
available whose meaning depends on whether you&rsquo;re
doing a search or jumping to a specific cell. When doing a
search, the second argument <br>
specifies a range to search. When jumping to a specific
cell, the second argument specifies which cell should be in
the upper lefthand corner of the screen, if possible, <br>
which allows you to position the destination cell where you
want it on the screen.</p>

<p style="margin-top: 1em">^Ed Go to end of range. Follow
^E by a direction indicator such as ^P or j. If the cell
cursor starts on a non-blank cell, it goes in the indicated
direction until the last <br>
non-blank adjacent cell. If the cell cursor starts on a
blank cell, it goes in the indicated direction until the
first non-blank cell. This command is useful when
speci&acirc; <br>
fying ranges of adjacent cells (see below), especially when
the range is bigger than the visible window.</p>

<p style="margin-top: 1em">If ^E is pressed twice in
succession, or if it is pressed after another ^E or a ^Y, it
will cause the screen to scroll up without moving the cell
cursor, unless the cell <br>
cursor is already at the top of the screen, in which case,
it will remain at the top of the visible screen.</p>

<p style="margin-top: 1em">^Y Causes the screen to scroll
down without moving the cell cursor, unless the cell cursor
is already at the bottom of the screen, in which case, it
will remain at the bottom <br>
of the visible screen.</p>

<p style="margin-top: 1em">mx Mark the current cell. sc
will prompt for a lowercase letter to be used as a mark
specifier. Marked cells may be used as the source for the c
(copy a marked cell) com&acirc; <br>
mand, or as the target of a &lsquo; or &rsquo; (go to marked
cell) command. In addition to cells marked with lowercase
letters, sc also automatically marks the last nine cells
that <br>
have been edited with the numbers 1-9, and the current cell
being edited with the number 0. When not editing a cell,
marks 0 and 1 usually refer to the same cell, unless <br>
the last edit was begun in one cell, but the cell address
was changed before pressing the RETURN key, or the last edit
was aborted prematurely.</p>

<p style="margin-top: 1em">&lsquo;x Jump to a previously
marked cell. If the target cell is currently on the screen,
sc will simply jump to the target cell, making it current.
Otherwise, sc will attempt to <br>
center the cell on the screen, if possible. As a special
case, following the &lsquo; with another &lsquo; will return
you to the cell you were in before the last g, &rsquo;,
&lsquo;, *, or ^E <br>
(or END key) was used to jump to another cell.</p>

<p style="margin-top: 1em">&rsquo;x Jump to a previously
marked cell. &rsquo; works just like &lsquo; , except that
&rsquo; will attempt to restore the marked cell to the same
position on the screen as when it was marked. <br>
It does this by remembering which cell was in the upper left
hand corner of the screen at the time the mark was set, and
restoring that cell to its original position. As <br>
a special case, following the &rsquo; with another &rsquo;
will return you to the cell you were in before the last g,
&rsquo;, &lsquo;, *, or ^E (or END key) was used to jump to
another cell, and <br>
will also try to position that cell on the screen in the
same position as when you left it.</p>

<p style="margin-top: 1em">z&lt;RETURN&gt; <br>
Move the current row to the top of the screen. If the
current row is in a framed range, move the current row to
the top of the scrolling region.</p>

<p style="margin-top: 1em">z. Move the current row to the
center of the screen.</p>

<p style="margin-top: 1em">z| Move the current column to
the center of the screen.</p>

<p style="margin-top: 1em">zc Center the current cell both
horizontally and vertically.</p>

<p style="margin-top: 1em">Cell Entry and Editing Commands
<br>
Cells can contain both a numeric value and a string value.
Either value can be the result of an expression, but not
both at once, i.e. each cell can have only one expression
<br>
associated with it. Entering a valid numeric expression
alters the cell&rsquo;s previous numeric value, if any, and
replaces the cell&rsquo;s previous string expression, if
any, leaving <br>
only the previously computed constant label string.
Likewise, entering a valid string expression alters the
cell&rsquo;s the previous label string, if any, and replaces
the cell&rsquo;s <br>
previous numeric expression, if any, leaving only the
previously computed constant numeric value.</p>

<p style="margin-top: 1em">= Enter a numeric constant or
expression into the current cell. sc prompts for the
expression on the top line. The usual way to enter a number
into a cell is to type <br>
&lsquo;&lsquo;=&rsquo;&rsquo;, then enter the number in
response to the prompt on the top line. The quick numeric
entry option, enabled through the -n option or ^T command,
shows the prompt when <br>
you enter the first digit of a number (you can skip typing
&lsquo;&lsquo;=&rsquo;&rsquo;). If you want to begin
entering an expression in the current cell, but you want to
start out in navigate <br>
mode (e.g. to enter cell addresses, or sums of ranges using
&lsquo;&lsquo;@sum&rsquo;&rsquo;), use the
&lsquo;&lsquo;+&rsquo;&rsquo; command instead (see
below).</p>

<p style="margin-top: 1em">&lt; Enter a label string into
the current cell to be flushed left against the left edge of
the cell. &nbsp;</p>

<p style="margin-top: 1em">Enter a label string into the
current cell to be centered in the column.</p>

<p style="margin-top: 1em">&gt; Enter a label string into
the current cell to be flushed right against the right edge
of the cell.</p>

<p style="margin-top: 1em">{ Left justify the string in the
current cell.</p>

<p style="margin-top: 1em">| Center the string in the
current cell.</p>

<p style="margin-top: 1em">} Right justify the string in
the current cell.</p>

<p style="margin-top: 1em">F Enter a format string into the
current cell. This format string overrides the precision
specified with the f command unless &amp; is present in the
fractional part of the <br>
format string (see below). The format only applies to
numeric values. There are two types of format strings
allowed: standard numeric and date. (Note: these format <br>
strings may also be used with the f command to create
user-defined format types.) The following characters can be
used to build a standard numeric format string:</p>

<p style="margin-top: 1em"># Digit placeholder. If the
number has fewer digits on either side of the decimal point
than there are &lsquo;#&rsquo; characters in the format, the
extra &lsquo;#&rsquo; characters are <br>
ignored. The number is rounded to the number of digit
placeholders as there are to the right of the decimal point.
If there are more digits in the number than <br>
there are digit placeholders on the left side of the decimal
point, then those digits are displayed.</p>

<p style="margin-top: 1em">0 Digit placeholder. Same as for
&lsquo;#&rsquo; except that the number is padded with zeroes
on either side of the decimal point. The number of zeroes
used in padding is <br>
determined by the number of digit placeholders after the
&lsquo;0&rsquo; for digits on the left side of the decimal
point and by the number of digit placeholders before the
&lsquo;0&rsquo; <br>
for digits on the right side of the decimal point.</p>

<p style="margin-top: 1em">. Decimal point. Determines how
many digits are placed on the right and left sides of the
decimal point in the number. If locale is set, the decimal
point for the <br>
user&rsquo;s current locale will be used when formatting a
number. Note that numbers smaller than 1 will begin with a
decimal point if the left side of the decimal point <br>
contains only a &lsquo;#&rsquo; digit placeholder. Use a
&lsquo;0&rsquo; placeholder to get a leading zero in decimal
formats.</p>

<p style="margin-top: 1em">% Percentage. For each
&lsquo;%&rsquo; character in the format, the actual number
gets multiplied by 100 (only for purposes of formatting --
the original number is left unmodi&acirc; <br>
fied) and the &lsquo;%&rsquo; character is placed in the
same position as it is in the format.</p>

<p style="margin-top: 1em">, Thousands separator. The
presence of a &lsquo;,&rsquo; in the format (multiple commas
are treated as one) will cause the number to be formatted
with a &lsquo;,&rsquo; separating each set <br>
of three digits in the integer part of the number with
numbering beginning from the right end of the integer. If
locale is set, the thousands separator for the <br>
user&rsquo;s current locale will be used in place of the
comma. If the environment variable LC_ALL is unset,
unrecognized, or is set to &lsquo;&lsquo;POSIX&rsquo;&rsquo;
or &lsquo;&lsquo;C&rsquo;&rsquo;, any commas <br>
in the format string will be ignored.</p>

<p style="margin-top: 1em">&amp; Precision. When this
character is present in the fractional part of the number,
it is equivalent to a number of 0&rsquo;s equal to the
precision specified in the column <br>
format command. For example, if the precision is 3,
&lsquo;&amp;&rsquo; is equivalent to &lsquo;000&rsquo;.
&nbsp;</p>

<p style="margin-top: 1em">Quote. This character causes the
next character to be inserted into the formatted string
directly with no special interpretation.</p>

<p style="margin-top: 1em">E- E+ e- e+ <br>
Scientific format. Causes the number to be formatted in
scientific notation. The case of the &lsquo;E&rsquo; or
&lsquo;e&rsquo; given is preserved. If the format uses a
&lsquo;+&rsquo;, then the <br>
sign is always given for the exponent value. If the format
uses a &lsquo;-&rsquo;, then the sign is only given when the
exponent value is negative. Note that if there is no <br>
digit placeholder following the &lsquo;+&rsquo; or
&lsquo;-&rsquo;, then that part of the formatted number is
left out. In general, there should be one or more digit
placeholders after <br>
the &lsquo;+&rsquo; or &lsquo;-&rsquo;.</p>

<p style="margin-top: 1em">; Format selector. Use this
character to separate the format into two distinct formats.
The format to the left of the &lsquo;;&rsquo; character will
be used if the number given <br>
is zero or positive. The format to the right of the
&lsquo;;&rsquo; character is used if the number given is
negative.</p>

<p style="margin-top: 1em">Some example formats are integer
(&lsquo;&lsquo;0&rsquo;&rsquo; or
&lsquo;&lsquo;#&rsquo;&rsquo;), fixed
(&lsquo;&lsquo;0.00&rsquo;&rsquo;), percentage
(&lsquo;&lsquo;0%&rsquo;&rsquo; or
&lsquo;&lsquo;0.00%&rsquo;&rsquo;), scientific
(&lsquo;&lsquo;0.00E+00&rsquo;&rsquo;), and currency
(&lsquo;&lsquo;$#,0.00;($#,0.00)&rsquo;&rsquo;).</p>

<p style="margin-top: 1em">Date format strings are
identified by the presence of a ^D in the first postition.
If this is present, the remainder of the string is passed to
the strftime() function, <br>
and therefore uses the same conversion specifiers as
strftime(). For more information on conversion specifiers
for date format strings, see the man page for
strftime(3).</p>

<p style="margin-top: 1em">Strings you enter must start
with &quot;. You can leave off the trailing &quot; and sc
will add it for you. You can also enter a string expression
by backspacing over the opening &quot; in <br>
the prompt.</p>

<p style="margin-top: 1em">e Edit the value associated with
the current cell. This is identical to
&lsquo;&lsquo;=&rsquo;&rsquo; except that the command line
starts out containing the old numeric value or expression
associ&acirc; <br>
ated with the cell. The editing in this mode is vi-like.</p>

<p style="margin-top: 1em">^H Move back a character</p>

<p style="margin-top: 1em">^V, v Enter navigate mode. This
mode allows you to navigate the spreadsheet while editing a
command. When in navigate mode, v will insert the numeric
value of the cur&acirc; <br>
rent cell, if any, into the command line, instead, while ^V
will return to the previous mode (like the ESCAPE key).</p>

<p style="margin-top: 1em">^W Insert the expression
attached to the current cell into the command line. If there
is none, the result is &lsquo;&lsquo;?&rsquo;&rsquo;. This
only works while in navigate mode.</p>

<p style="margin-top: 1em">^A In navigate mode, go to cell
A0. When not in navigate mode, jump to the beginning of the
line instead.</p>

<p style="margin-top: 1em">^E Jump to the end of the line.
Unlike &lsquo;&lsquo;$&rsquo;&rsquo; (below), this can also
be used from insert mode.</p>

<p style="margin-top: 1em">TAB If the character immediately
preceding the cursor is alphanumeric or
&lsquo;&lsquo;_&rsquo;&rsquo;, TAB tries to find a match in
the list of range names, and if one is found, the name will
<br>
be completed on the command line. If there are multiple
matches, pressing TAB repeatedly without any other
intervening keys will cycle through all of the valid <br>
matches. If the character immediately preceding the cursor
is not alphanumeric or &lsquo;&lsquo;_&rsquo;&rsquo;, TAB
defines a range of cells via the cursor control commands or
the arrow <br>
keys. Pressing TAB automatically switches sc to navigate
mode if you haven&rsquo;t already done so using the ^V
command, and the range is highlighted, starting at the <br>
cell where you typed TAB, and continuing through the current
cell. Pressing TAB again causes the highlighted range to be
inserted into the command line, the high&acirc; <br>
lighting to be turned off, and the previous mode to be
restored. This is most useful for defining ranges to
functions such as @sum(). Pressing
&lsquo;&lsquo;)&rsquo;&rsquo; acts just <br>
like typing the TAB key the second time and adds the closing
&lsquo;&lsquo;)&rsquo;&rsquo;. Note that when you give a
range command, if the first argument to the command is a
range, you <br>
don&rsquo;t need to press the first TAB to begin defining a
range starting with the current cell.</p>

<p style="margin-top: 1em">: Synonym for TAB, when in
navigate mode.</p>

<p style="margin-top: 1em">&lsquo; &rsquo; In navigate
mode, go to marked cell.</p>

<p style="margin-top: 1em">* In navigate mode, go to note
linked to current cell.</p>

<p style="margin-top: 1em">+ Forward through history (same
as j)</p>

<p style="margin-top: 1em">- Backward through history (same
as k)</p>

<p style="margin-top: 1em">ESC Done editing</p>

<p style="margin-top: 1em">CR Save. When in navigate mode,
insert the name of the current cell (the one at the cell
cursor) into the command line. This is useful when entering
expressions <br>
which refer to other cells in the table.</p>

<p style="margin-top: 1em">$ Goto last column</p>

<p style="margin-top: 1em">% Goto matching parenthesis</p>

<p style="margin-top: 1em">. Insert current dot buffer.
When in navigate mode, this is a synonym for : or TAB.</p>

<p style="margin-top: 1em">; Repeat the last f, F, t, or T
command.</p>

<p style="margin-top: 1em">, Repeat the last f, F, t, or T
command, but in the reverse direction.</p>

<p style="margin-top: 1em">~ Change the case of the
character under the cursor.</p>

<p style="margin-top: 1em">/ Search backwards for a string
in the history <br>
ESC edit the string you typed <br>
CR search <br>
^H backspace</p>

<p style="margin-top: 1em">? Search forward for a string in
the history (see &lsquo;&lsquo;/&rsquo;&rsquo; above)</p>

<p style="margin-top: 1em">0 Goto column 0</p>

<p style="margin-top: 1em">B Move back a word. Like b,
except words are space delimited only.</p>

<p style="margin-top: 1em">C Change to end of line (delete
first, then enter insert mode)</p>

<p style="margin-top: 1em">D Delete to end of line</p>

<p style="margin-top: 1em">F Find the next char typed,
moving backwards in the line</p>

<p style="margin-top: 1em">G Go to the end of history,
i.e., to the line being currently entered</p>

<p style="margin-top: 1em">I Insert at column 0; ESC revert
back to edit mode</p>

<p style="margin-top: 1em">N Repeat the last search in the
opposite direction</p>

<p style="margin-top: 1em">P Insert the most recently
deleted text before the cursor</p>

<p style="margin-top: 1em">R Replace mode; ESC revert back
to edit mode</p>

<p style="margin-top: 1em">T Goto a char, moving backwards
in the line</p>

<p style="margin-top: 1em">W Forward a word. Like w, except
words are space delimited only.</p>

<p style="margin-top: 1em">X Delete the char to the
left</p>

<p style="margin-top: 1em">a Append after cursor; ESC
revert back to edit mode</p>

<p style="margin-top: 1em">b Move back a word</p>

<p style="margin-top: 1em">c Change mode; ESC revert back
to edit mode. In navigate mode, insert color range which
includes the current cell.</p>

<p style="margin-top: 1em">d Delete ... <br>
0 delete to beginning of line <br>
$ delete to end of line <br>
b back word <br>
e delete to end of word <br>
f forward (right) <br>
h back char <br>
l forward <br>
t delete forward up to a given char (next char typed) <br>
w delete next word forward</p>

<p style="margin-top: 1em">e Forward to next
end-of-word</p>

<p style="margin-top: 1em">f Find the next char typed. In
navigate mode, insert the outer frame range which includes
the current cell.</p>

<p style="margin-top: 1em">g In navigate mode, allows you
to &lsquo;goto&rsquo; a cell or range, just like the regular
goto command. Ignored in edit, insert or replace modes.</p>

<p style="margin-top: 1em">h Move left a char</p>

<p style="margin-top: 1em">i Insert before cursor; ESC
revert back to edit mode</p>

<p style="margin-top: 1em">j Forward through history (same
as +)</p>

<p style="margin-top: 1em">k Backward through history (same
as -)</p>

<p style="margin-top: 1em">l Move right a char</p>

<p style="margin-top: 1em">n Repeat the last search (find
the next match)</p>

<p style="margin-top: 1em">o When highlighting a range in
navigate mode, move to the opposite corner of the
highlighted range.</p>

<p style="margin-top: 1em">p Insert the most recently
deleted text after the cursor</p>

<p style="margin-top: 1em">q Stop editing</p>

<p style="margin-top: 1em">r Replace char. In navigate
mode, insert the inner frame range which includes the
current cell.</p>

<p style="margin-top: 1em">s Delete current char and enter
insert mode (stands for substitute)</p>

<p style="margin-top: 1em">t Goto a char</p>

<p style="margin-top: 1em">u Undo</p>

<p style="margin-top: 1em">w Forward a word</p>

<p style="margin-top: 1em">x Delete the current char
(moving to the right)</p>

<p style="margin-top: 1em">y Copies to the delete buffer
without deleting. Use like d (above).</p>

<p style="margin-top: 1em">E Edit the string associated
with the current cell. This is identical to
&lsquo;&lsquo;&lt;&rsquo;&rsquo;,
&lsquo;&lsquo;&acute;&rsquo;, or
&lsquo;&lsquo;&gt;&rsquo;&rsquo; except that the command
line starts out containing the old string value or <br>
expression associated with the cell. SEE e ABOVE.</p>

<p style="margin-top: 1em">To enter and edit a cell&rsquo;s
number part, use the &lsquo;&lsquo;=&rsquo;&rsquo;,
&lsquo;&lsquo;+&rsquo;&rsquo;, and e commands. To enter and
edit a cell&rsquo;s string part, use the
&lsquo;&lsquo;&lt;&rsquo;&rsquo;,
&lsquo;&lsquo;&acute;&rsquo;,
&lsquo;&lsquo;&gt;&rsquo;&rsquo;, and E commands. See the
sec&acirc; <br>
tions below on numeric and string expressions for more
information.</p>

<p style="margin-top: 1em">Note that the descriptions of
the &lsquo;&lsquo;+&rsquo;&rsquo; and
&lsquo;&lsquo;-&rsquo;&rsquo; commands below may seem very
confusing at first, but once they&rsquo;re understood, they
can facilitate the rapid entry of expressions <br>
which add and subtract large numbers of cells and sums of
ranges of cells, so read them over carefully several times
until you understand them.</p>

<p style="margin-top: 1em">&quot; Specify a named buffer
for the next yank/delete/pull command. Buffers are named
with a single character. Buffers
&lsquo;&lsquo;a&rsquo;&rsquo; through
&lsquo;&lsquo;z&rsquo;&rsquo; are general purpose buffers,
buffers <br>
&lsquo;&lsquo;1&rsquo;&rsquo; through
&lsquo;&lsquo;9&rsquo;&rsquo; hold the last nine deletions,
with buffer &lsquo;&lsquo;1&rsquo;&rsquo; being the most
recent, and buffer &lsquo;&lsquo;0&rsquo;&rsquo; holds the
last cell or range yanked. Buffer
&lsquo;&lsquo;&quot;&rsquo;&rsquo; is the <br>
default buffer, which holds the last cell or range that was
deleted or yanked.</p>

<p style="margin-top: 1em">x Clear the current cell.
Deletes the numeric value, label string, and/or numeric or
string expression. You can prefix this command with a count
of the number of cells on <br>
the current row to clear. The current column is used if
column recalculation order is set. Cells cleared with this
command may be recalled with any of the pull commands <br>
(see below).</p>

<p style="margin-top: 1em">mx Mark the current cell. sc
will prompt for a lowercase letter to be used as a mark
specifier. Marked cells may be used as the source for the
copy command, or as the tar&acirc; <br>
get of a &lsquo; or &rsquo; (go to marked cell) command.</p>

<p style="margin-top: 1em">cx Copy a marked cell to the
current cell, adjusting row and column references in its
numeric or string expression, if any. sc will prompt for the
name of the cell to be <br>
copied, which may be a lowercase letter specified previously
with the m command, a digit 1-9 to reference one of the last
nine edited cells (0 will reference the last cell <br>
in which an edit was begun, regardless of whether the edit
was completed or not), or &lsquo;&lsquo;.&rsquo;&rsquo; to
reference the current cell, which, as a special case, is to
be used as a <br>
source rather than a destination, and is to be copied into a
range which includes the current cell. When
&lsquo;&lsquo;.&rsquo;&rsquo; is specified, the current cell
is set as the default <br>
source range for the range copy (rc) command, and then the
copy command is entered into the command line and sc
switches to navigate mode. Moving the cell cursor will <br>
then highlight the destination range. After the desired
range is highlighted, press RETURN to execute the copy.</p>

<p style="margin-top: 1em">+ If not in numeric mode, add
the current numeric argument (default 1) to the value of the
current cell. The current value of the cell must not be an
expression. In <br>
numeric mode, + switches to insert mode and appends a
&lsquo;&lsquo;+&rsquo;&rsquo; to the current expression or
value, if any, which makes it easy to add to existing
data.</p>

<p style="margin-top: 1em">In navigate mode, + inserts the
current cell address into the line, followed by another +,
and sc remains in navigate mode, unless a range is
highlighted. If a range is <br>
highlighted and the character immediately preceding the
cursor is a &lsquo;&lsquo;+&rsquo;&rsquo; or
&lsquo;&lsquo;-&rsquo;&rsquo;, or the cursor is at the
beginning of an empty &lsquo;&lsquo;let&rsquo;&rsquo;
expression, the string &lsquo;&lsquo;@sum(&rsquo;&rsquo;
<br>
will be inserted, followed by the highlighted range,
followed by &lsquo;&lsquo;)+&rsquo;&rsquo;. If a range is
highlighted and the character immediately preceding the
cursor is not a &lsquo;&lsquo;+&rsquo;&rsquo; or <br>
&lsquo;&lsquo;-&rsquo;&rsquo;, and the cursor is not at the
beginning of an empty &lsquo;&lsquo;let&rsquo;&rsquo;
expression, the highlighted range will be inserted, followed
by &lsquo;&lsquo;)+&rsquo;&rsquo;.</p>

<p style="margin-top: 1em">- If not in numeric mode,
subtract the current numeric argument (default 1) from the
value of the current cell. The current value of the cell
must not be an expression. In <br>
numeric mode, - switches to insert mode and appends a
&lsquo;&lsquo;-&rsquo;&rsquo; to the current expression or
value, if any, which makes it easy to subtract from existing
data.</p>

<p style="margin-top: 1em">In navigate mode, - inserts the
current cell address into the line, followed by another -,
and sc remains in navigate mode, unless a range is
highlighted. If a range if <br>
highlighted and the character immediately preceding the
cursor is a &lsquo;&lsquo;+&rsquo;&rsquo; or
&lsquo;&lsquo;-&rsquo;&rsquo;, or the cursor is at the
beginning of an empty &lsquo;&lsquo;let&rsquo;&rsquo;
expression, the string &lsquo;&lsquo;@sum(&rsquo;&rsquo;
<br>
will be inserted, followed by the highlighted range,
followed by &lsquo;&lsquo;)-&rsquo;&rsquo;. If a range is
highlighted and the character immediately preceding the
cursor is not a &lsquo;&lsquo;+&rsquo;&rsquo; or <br>
&lsquo;&lsquo;-&rsquo;&rsquo;, and the cursor is not at the
beginning of an empty &lsquo;&lsquo;let&rsquo;&rsquo;
expression, the highlighted range will be inserted, followed
by &lsquo;&lsquo;)-&rsquo;&rsquo;.</p>

<p style="margin-top: 1em">RETURN If you are not editing a
cell (top line is empty), pressing RETURN will make sc enter
insert mode. At this point you may type any valid command or
press ESC once to edit.</p>

<p style="margin-top: 1em">File Commands</p>

<p style="margin-top: 1em">G Get a new database from a
file. If encryption is enabled, the file is decrypted before
it is loaded into the spreadsheet.</p>

<p style="margin-top: 1em">P Put the current database into
a file. If encryption is enabled, the file is encrypted
before it is saved.</p>

<p style="margin-top: 1em">ZZ Save the current database
into a file if it has been modified, and then quit. This is
like the P command followed by the q command, except that
the default filename will <br>
be used instead of prompting you for one, and the file will
only be saved if it was modified. If there is no default
filename, an error message will be displayed, and no <br>
action taken.</p>

<p style="margin-top: 1em">W Write a listing of the current
database into a file in a form that matches its appearance
on the screen. This differs from the Put command in that its
files are intended <br>
to be reloaded with Get, while Write produces a file for
people to look at. Hidden rows or columns are not shown when
the data is printed.</p>

<p style="margin-top: 1em">T Write a listing of the current
database to a file, but include delimiters suitable for
processing by the tbl, LaTeX, or TeX table processors. The
delimiters are con&acirc; <br>
trolled by the tblstyle option. See Set above. The
delimiters are a colon (:) for style 0 or tbl and an
ampersand (&amp;) for style latex or tex.</p>

<p style="margin-top: 1em">With the Put, Write, and Table
commands, the optional range argument writes a subset of the
spreadsheet to the output file.</p>

<p style="margin-top: 1em">With the Write and Table
commands, if you try to write to the last file used with the
Get or Put commands, or the file specified on the command
line when sc was invoked, you are <br>
asked to confirm that the (potentially) dangerous operation
is really what you want.</p>

<p style="margin-top: 1em">The three output commands, Put,
Write, and Table, can pipe their (unencrypted only) output
to a program. To use this feature, enter &lsquo;&lsquo;|
program&rsquo;&rsquo; to the prompt asking for a <br>
filename. For example, to redirect the output of the Write
command to the printer, you might enter &lsquo;&lsquo;| lpr
-p&rsquo;&rsquo;.</p>

<p style="margin-top: 1em">M Merge the database from the
named file into the current database. Values and expressions
defined in the named file are read into the current
spreadsheet overwriting the <br>
existing entries at matching cell locations.</p>

<p style="margin-top: 1em">R Run macros. There are two
different kinds of macros that can be used with sc: simple
macros, which are stored in plain text files, and advanced
macros, which are exe&acirc; <br>
cutable files, and which can be written in the language of
your choice. Advanced macros are only available on systems
that support pipes.</p>

<p style="margin-top: 1em">Simple macros are interpreted by
sc&rsquo;s internal parser, and use the same commands used
to enter data and perform other operations (the single key
commands are shortcuts <br>
which switch to input mode after first entering the
beginning of the full command for you). These are also the
same commands found in sc files created with the Put
com&acirc; <br>
mand. Since sc files are saved as ASCII files, it is
possible to use them as primitive macro definition files.
The Run command makes this easier. It&rsquo;s like the Merge
<br>
command, but prints a saved path name as the start of the
filename to merge in. The string to use is set with the
Define command. To write macros, you must be familiar <br>
with the file format written by the Put command.</p>

<p style="margin-top: 1em">Advanced macros use executable
files that are started by sc as a child process with stdin
and stdout redirected back to sc for bidirectional
communication. Special com&acirc; <br>
mands are available for requesting information such as cell
contents, formatting information, or the current location of
the cell cursor. Commands are written to stdout, <br>
and responses are read from stdin. To use advanced macros,
the filename must be preceded by a | (the pipe symbol), and
the file must be executable. If the pathname set <br>
with the Define command begins with a |, all files in that
path will be executed as advanced macros. It is also
possible to include a filename as part of the path when <br>
using advanced macros, which allows you to put multiple
macros in a single file, and use the Run command to add
command line arguments or options to determine which macro
<br>
should be run. Advanced macros are relatively new, and
documentation is still incomplete. This feature will
probably be enhanced in future releases.</p>

<p style="margin-top: 1em">A Specify a macro to be
automatically run whenever the current sheet is reloaded
from a file.</p>

<p style="margin-top: 1em">D Define a path for the Run
command to use (see above).</p>

<p style="margin-top: 1em">All file operations take a
filename as the first argument to the prompt on the top
line. The prompt supplies a &quot; to aid in typing in the
filename. The filename can also be <br>
obtained from a cell&rsquo;s label string or string
expression. In this case, delete the leading &quot; with the
backspace key and enter a cell name such as a22 instead. If
the resulting <br>
string starts with &lsquo;&lsquo;|&rsquo;&rsquo;, the rest
of the string is interpreted as a UNIX command, as
above.</p>

<p style="margin-top: 1em">Row and Column Commands <br>
These are two-letter commands which can be used on either
rows or columns. The exceptions are the f command, which
only works on columns, and therefore doesn&rsquo;t require a
second <br>
letter, and the p command which, in addition to operating on
rows or columns, has several other options for merging the
data in directly, without opening up a new row or column.
<br>
There are also a few special cases where pressing the same
letter twice will affect only the current cell instead of a
row or column (except for ZZ, which is a special case all
<br>
its own).</p>

<p style="margin-top: 1em">In all of the remaining cases,
the second letter of the command will be either r or c,
depending on whether the operation should be performed on
rows or columns, respectively <br>
(additional options for the p command and the double letter
cases are listed below). A small menu lists the choices for
the second letter when you type the first letter of one <br>
of these commands.</p>

<p style="margin-top: 1em">Alternatively, you may define a
range of rows or columns by moving the cell cursor, either a
cell at a time, or by pages (roughly 1/2 screen, unless the
pagesize option has been <br>
set), but this only works for the d, y, and Z commands.
Vertical cursor movement will begin highlighting rows, and
horizontal movement will highlight columns. Pressing the
<br>
RETURN key will then perform the chosen operation on the
specified rows/columns.</p>

<p style="margin-top: 1em">Commands which copy cells also
modify the row and column references in affected cell
expressions. The references may be frozen by using the
@fixed operator or using the $ char&acirc; <br>
acter in the reference to the cell (see below). Commands
which create new rows or columns will include all newly
created cells in the same ranges (named, framed, color, or
those <br>
used in expressions) as their counterparts in the current
row or column. This can sometimes be a significant factor
when deciding whether to use ir/ic or or/oc.</p>

<p style="margin-top: 1em">ir, ic Insert a new row (column)
by moving the row (column) containing the cell cursor, and
all following rows (columns), down (right) one row (column).
The new row (column) is <br>
empty. Inserting rows while the cell cursor is in a framed
range will only effect rows in that range, leaving all rows
to the left and right untouched.</p>

<p style="margin-top: 1em">or, oc Open a new row (column).
These commands work like the ir and ic commands, except that
the new row (column) will be inserted after the current row
(column) instead of <br>
before it.</p>

<p style="margin-top: 1em">ar, ac Append a new row (column)
immediately following the current row (column). It is
initialized as a copy of the current one. Appending rows
while the cell cursor is in a <br>
framed range will only effect rows in that range, leaving
all rows to the left and right untouched.</p>

<p style="margin-top: 1em">dr, dc, dd <br>
Delete the current row (column). dd deletes the current cell
(i.e., it is a synonym for x). Deleting rows while the cell
cursor is in a framed range will only effect <br>
rows in that range, leaving all rows to the left and right
untouched.</p>

<p style="margin-top: 1em">yr, yc, yy <br>
Yank a copy of the current row (column) into the delete
buffer without actually deleting it. yy yanks the current
cell (similar to x, but without actually deleting the <br>
contents of the cell). Yanking rows while the cell cursor is
in a framed range will only copy the portion of each row
contained in that range, while ignoring everything <br>
outside the range.</p>

<p style="margin-top: 1em">pr, pc, pp, pm, px, pt, pC, p.
<br>
Pull deleted rows/columns/cells back into the spreadsheet.
The last set of cells that was deleted or yanked is put back
into the spreadsheet at the current location. pr <br>
inserts enough rows to hold the data. pc inserts enough
columns to hold the data. pp (paste) does not insert rows or
columns; it overwrites the cells beginning at the <br>
current cell cursor location. pm (merge) merges the cells in
at the current cell cursor location, but does not erase the
destination range first like pp. The difference <br>
between pp and pm is similar to the difference between the
Get and Merge commands. pf (format) works like pm except
that only cell formatting information is merged in, <br>
leaving the actual data untouched. This makes it easy to
copy cell formats from one part of the spreadsheet to
another, such as when expanding an existing spreadsheet <br>
file. px (exchange) copies the contents of the delete buffer
into the range beginning at the current cell cursor
location, while simultaneously copying the contents of <br>
this range back into the delete buffer, replacing its
current contents. pt (transpose) overwrites the cells
beginning at the current cell cursor location like pp, but
<br>
transposes rows for columns and vice versa. pC (copy) works
like pp, except that all cell references are adjusted in the
same way that they are for the copy command. p. <br>
is the same as pC, except that it switches to navigate mode
and allows you to define the destination range to be used.
This works like the copy command in that if the <br>
source range (the contents of the delete buffer) is a single
row, column, or cell, multiple copies may be made.</p>

<p style="margin-top: 1em">vr, vc, vv <br>
Remove expressions from the affected rows (columns), leaving
only the values which were in the cells before the command
was executed. When used in a framed range, vr only <br>
affects the portion of the the row inside the range, leaving
the rest of the row unchanged. vv only affects the contents
of the current cell.</p>

<p style="margin-top: 1em">Zr, Zc, ZZ <br>
Hide (&lsquo;&lsquo;zap&rsquo;&rsquo;) the current row
(column). This keeps a row (column) from being displayed but
keeps it in the data base. The status of the rows and
columns is saved with <br>
the data base so hidden rows and columns will still be
hidden when you reload the spreadsheet. Hidden rows or
columns are not printed by the W command. The ZZ command is
<br>
a special case. It does not hide anything. Instead, the file
will be saved, if modified, and sc will exit. See ZZ above,
under File Commands.</p>

<p style="margin-top: 1em">sr, sc Show hidden rows
(columns). Enter a range of rows (columns) to be revealed.
The default is the first range of rows (columns) currently
hidden. This command ignores the <br>
repeat count, if any.</p>

<p style="margin-top: 1em">f Set the output format to be
used for printing the numeric values in each cell in the
current column. This command has only a column version (no
second letter). You may <br>
change the column width by pressing the h, &lt;, or cursor
left key to reduce it, or the l, &gt;, or cursor right key
to increase it. Likewise, you may change the precision <br>
(the number of digits to follow decimal points) by pressing
the j, -, or cursor down key to reduce it, or the k, +, or
cursor up key to increase it. You may also change <br>
the format type for the column by pressing any digit. If the
f command is preceded by a numeric argument, that argument
will determine how many columns should be changed, <br>
beginning with the current column, and in the case of
incrementing or decrementing the width or precision of the
columns, each column will be incremented or decremented <br>
separately, regardless of its initial values. Several
formatting operations may be performed in sequence. To leave
the formatting command, simply press ESC, ^G, q, or <br>
RETURN .</p>

<p style="margin-top: 1em">Alternatively, you may press
SPACE to get the format command in the top line and enter
all three values directly. In order, these are: the total
width in characters of <br>
the column, the precision, and the format type. Format types
are 0 for fixed point, 1 for scientific notation, 2 for
engineering notation, 3 for dates with a two digit <br>
year, and 4 for dates with a four digit year. Values are
rounded off to the least significant digit displayed. The
total column width affects displays of strings as well <br>
as numbers. A preceding count can be used to affect more
than one column.</p>

<p style="margin-top: 1em">You can also create your own
format types by pressing = after the f command, followed by
any digit (see the F command above under Cell Entry and
Editing Commands for a <br>
description of how to build a format string). Format numbers
0 through 4 will supersede the built-in format types, while
numbers 5 through 9 will supplement them. User <br>
defined format types may be used in the same way as the
built-in types. For example, the command</p>

<p style="margin-top: 1em">format 5 = &quot;#,0.&amp;
;(#,0.&amp;)&quot;</p>

<p style="margin-top: 1em">will define a currency format
which may then be assigned to column C, for example, with
the command</p>

<p style="margin-top: 1em">format C 10 2 5</p>

<p style="margin-top: 1em">@myrow, @mycol <br>
Are functions that return the row or column of the current
cell respectively. ex: The cell directly above a cell in the
D column could then be accessed by <br>
@nval(&quot;d&quot;,@myrow-1). NOTE: @myrow and @mycol
can&rsquo;t be used in specifying ranges.</p>

<p style="margin-top: 1em">@lastrow, @lastcol <br>
These return the last row and column of the spreadsheet,
respectively. They are useful for macros designed to default
to the whole spreadsheet.</p>

<p style="margin-top: 1em">Range Commands <br>
Range operations affect a rectangular region on the screen
defined by the upper left and lower right cells in the
region. All of the commands in this class begin with
&lsquo;&lsquo;r&rsquo;&rsquo;; the <br>
second letter of the command indicates which command. A
small menu lists the choices for the second letter when you
type &lsquo;&lsquo;r&rsquo;&rsquo;. sc prompts for needed
parameters for each com&acirc; <br>
mand. Phrases surrounded by square brackets in the prompt
are informational only and may be erased with the backspace
key.</p>

<p style="margin-top: 1em">Prompts requesting variable
names may be satisfied with either an explicit variable
name, such as A10, or with a variable name previously
defined in a rd command (see below). <br>
Range name prompts require either an explicit range such as
A10:B20, or a range name previously defined with a rd
command. A default range shown in the second line is used if
<br>
you omit the range from the command or press the TAB key
(see below). The default range can be changed by moving the
cell cursor via the control commands (^P or ^N) or the arrow
<br>
keys. The cells in the default range are highlighted (using
the terminal&rsquo;s standout mode, if available).</p>

<p style="margin-top: 1em">rx Clear a range. Cells cleared
with this command will be saved in the delete buffer, and
may be recalled with any of the pull commands.</p>

<p style="margin-top: 1em">ry Yank a range. Like rx, cells
yanked with this command will be saved in the delete buffer,
and may be recalled with any of the pull commands. This
command differs from <br>
rx, however, in that the original cells will not be cleared.
Although this command may be used to copy a range of cells,
it treats all references as fixed. Use rc if you <br>
want references to be relative to the cell which contains
them unless specified otherwise, either with the @fixed
operator or using the $ character in the reference to the
<br>
cell.</p>

<p style="margin-top: 1em">rc Copy a source range to a
destination range. The source and destination may be
different sizes. The result is always one or more full
copies of the source. Copying a row <br>
to a row yields a row. Copying a column to a column yields a
column. Copying a range to anything yields a range. Copying
a row to a column or a column to a row yields a <br>
range with as many copies of the source as there are cells
in the destination. This command can be used to duplicate a
cell through an arbitrary range by making the <br>
source a single cell range such as b20:b20.</p>

<p style="margin-top: 1em">If the source range is omitted
(second argument), the source range from the last copy
command will be used, unless a range is currently
highlighted, in which case the <br>
highlighted range will be copied instead. If both the source
range and destination range are omitted, the current cell
will be used as the destination, unless a range is <br>
currently highlighted, in which case the highlighted range
will serve as the destination, and the source range from the
last copy command will be copied into that destina&acirc;
<br>
tion.</p>

<p style="margin-top: 1em">rm Move a source range to a
destination range. This differs from deleting a range with
rx and pulling it back in with pm in that any expressions
that reference a cell in the <br>
range to be moved will reference the cell at its new address
after the move. Unlike the rc command, the destination of a
move is a single cell, which will be the upper <br>
lefthand corner of the source range after the move.</p>

<p style="margin-top: 1em">rv Values only. This command
removes the expressions from a range of cells, leaving just
the values of the expressions.</p>

<p style="margin-top: 1em">rs Sort a range. The rows in the
specified range will be sorted according to criteria given
in the form of a string of characters. This string, enclosed
in double quotes, <br>
may comprise a single criterion or multiple criteria in
decreasing order of precedence. Each criterion has three
parts, all of which are mandatory. The first part is a <br>
single character, which must be either + or -, which
specifies whether the sort should be done in ascending or
descending order, respectively. The second part, which is
<br>
also a single character, must be either # or $, and is used
to specify whether the sort should be based on the numeric
portion or the string portion, respectively, of the <br>
cells being used for the comparison. The third part may be
either one or two characters, and must be alphabetic (case
insensitive), and specifies the column to be used <br>
when making the comparisons. This column must be in the
range being sorted. Any number of criteria may be
concatenated, and will be used in the order specified. If no
<br>
criteria are specified, the default behavior is to sort in
ascending order, first by string and then by number, using
the leftmost column of the range being sorted. This <br>
is equivalent to specifying the sort criteria to be &quot;
+$a+#a &quot;, where both a&rsquo;s are replaced by the name
of the leftmost column of the range being sorted.</p>

<p style="margin-top: 1em">rf Fill a range with constant
values starting with a given value and increasing by a given
increment. Each row is filled before moving on to the next
row if row order recal&acirc; <br>
culation is set. Column order fills each column in the range
before moving on to the next column. The start and increment
numbers may be positive or negative. To fill <br>
all cells with the same value, give an increment of
zero.</p>

<p style="margin-top: 1em">r{ Left justify all strings in
the specified range.</p>

<p style="margin-top: 1em">r} Right justify all strings in
the specified range.</p>

<p style="margin-top: 1em">r| Center all strings in the
specified range.</p>

<p style="margin-top: 1em">rd Use this command to assign a
symbolic name to a single cell or a rectangular range of
cells on the screen. The parameters are the name, surrounded
by &quot;&quot;, and either a <br>
single cell name such as A10 or a range such as a1:b20.
Names defined in this fashion are used by the program in
future prompts, may be entered in response to prompts <br>
requesting a cell or range name, and are saved when the
spreadsheet is saved with the Put command. Names defined may
be any combination of alphanumeric characters and
&lsquo;_&rsquo; <br>
as long as the name isn&rsquo;t a valid cell address. Thus,
x, H2SO4, and 3rdDay are all valid names, but H2 is not.</p>

<p style="margin-top: 1em">rl Use this command to lock the
current cell or a range of cells, i.e. make them immune to
any type of editing. A locked cell can&rsquo;t be changed in
any way until it is <br>
unlocked.</p>

<p style="margin-top: 1em">rU This command is the opposite
of the rl command and thus unlocks a locked cell and makes
it editable.</p>

<p style="margin-top: 1em">rS This command shows lists of
the currently defined range names, framed ranges, and color
definitions and ranges, one after the other. The output of
this command will be <br>
piped to less. If the environment variable PAGER is set, its
value is used in place of less.</p>

<p style="margin-top: 1em">ru Use this command to undefine
a previously defined range name.</p>

<p style="margin-top: 1em">rF Use this command to assign a
value format string (see the &lsquo;&lsquo;F&rsquo;&rsquo;
cell entry command) to a range of cells.</p>

<p style="margin-top: 1em">rr This command is used for
creating, modifying, and deleting framed ranges. A framed
range, is one which has a number of rows or columns
specified at the top, bottom, left, <br>
and/or right (the frame) which must remain onscreen whenever
the cell cursor is within that range. In other words, a
frame consists of an outer range and an inner range, <br>
where the inner range is allowed to scroll within the outer
range. Once a frame is defined, the inner range may be
resized, but the outer range remains fixed unless rows <br>
or columns are added or deleted within the range.</p>

<p style="margin-top: 1em">When this command is invoked,
you will be prompted for the type of frame-related action
you would like to perform. You may select an option from the
list by typing its <br>
first letter.</p>

<p style="margin-top: 1em">The options are top, bottom,
left, right, all, and unframe. If you choose top, bottom,
left, or right, you will be prompted for a range and number
of rows/columns. The <br>
range may be omitted if the cell cursor is in a previously
defined framed range, in which case that range&rsquo;s outer
range will be used instead. The number of rows/columns <br>
will set or adjust the width of the corresponding side of
the frame. If all of these widths are set to zero, the frame
will be undefined (same as the unframe command).</p>

<p style="margin-top: 1em">If you choose all, you will be
prompted for an outer range and an inner range, in which
case the inner range will scroll within the outer range, and
any rows or columns <br>
outside of the inner range, but inside the outer range will
be part of the &lsquo;&lsquo;frame&rsquo;&rsquo; that is to
remain onscreen. The outer range may be omitted if the cell
cursor is in a <br>
previously defined framed range, in which case the
previously defined outer range will be used. However, if a
single range is specified on the command line, while another
<br>
range wholly contained within this range is highlighted, the
specified range will be used as the outer range, and the
highlighted range will be used as the inner range. <br>
If no range is specified on the command line, but a range is
highlighted, and the highlighted range is wholly contained
within a previously defined framed range, the high&acirc;
<br>
lighted range will be used as the inner range, and the
previously defined outer range will be used as the outer
range.</p>

<p style="margin-top: 1em">If you choose unframe, you will
be prompted for a range, and if the range is found in the
list of frames, the frame will be deleted, and the framing
will no longer be <br>
active (the specified range must be the outer range of the
previously defined frame to be deleted). The range may be
omitted if the cell cursor is in a previously defined <br>
framed range, in which case that range will be used by
default.</p>

<p style="margin-top: 1em">Framed ranges may not be nested
or overlapping. If you try to define a range that contains
any cells in common with a previously defined framed range,
an error message <br>
will be issued, and the frame will not be created.</p>

<p style="margin-top: 1em">rC This command defines a color
range, and specifies a foreground/background pair to be used
for that range. See &quot;Color Commands&quot; below for
more information.</p>

<p style="margin-top: 1em">Note Commands <br>
A note is a cell or range of cells that can be jumped to
quickly from another cell by creating a special link in that
cell. The note may contain text explaining the contents of
<br>
the cell containing the link, similar to a footnote, or it
may simply be another part of the spreadsheet that is
related to the cell in some way. When you press the
&lsquo;n&rsquo; key, you <br>
will get a short prompt asking you whether you want to add
or delete a note, or to &lsquo;&lsquo;show&rsquo;&rsquo; (by
highlighting) which cells on the screen have attached
notes.</p>

<p style="margin-top: 1em">If a cell with an attached note
contains numeric data, it will be preceded with an
&lsquo;&lsquo;*&rsquo;&rsquo;. If color is available and
turned on, the &lsquo;&lsquo;*&rsquo;&rsquo; will be
displayed with color 4. Also, <br>
the note address will be displayed in curly braces on the
top line, preceded by an &lsquo;&lsquo;*&rsquo;&rsquo;, when
the cell is current (e.g. {*AC30:AE43} or {*note1} for a
named range). You may <br>
also use the *s (Note/Show) command to highlight all cells
on the current screen with attached notes.</p>

<p style="margin-top: 1em">*a Add a note. This will bring
up the addnote command in the top line, followed by the
target address of the cell where you want the note added.
You must then enter the <br>
cell or range where the note resides to add the note. If you
omit the note address or range, the currently highlighted
range, if any, will be used. Otherwise, the cur&acirc; <br>
rent cell will be used (you would, of course, want to move
away from the cell in which the addnote command was invoked
in the latter case).</p>

<p style="margin-top: 1em">*d Delete a note. If there is a
note attached to the current cell, the link will be removed
(deleted). The note itself will not be removed from the
spreadsheet. If it is <br>
no longer needed, it must be deleted in a separate step.</p>

<p style="margin-top: 1em">*s Show all notes on the current
screen. If there are any cells on the visible portion of the
spreadsheet which contain attached notes, they will be
highlighted until the <br>
next screen change, no matter how minor. Simply moving to a
new cell will be enough to turn off the highlighting.</p>

<p style="margin-top: 1em">** Jump to a note. If there is a
note attached to the current cell, you will be immediately
transported to that cell. You may return from the note to
where you were by <br>
pressing &lsquo; twice.</p>

<p style="margin-top: 1em">Color Commands <br>
Color may be enabled by setting the color option
(&lsquo;&lsquo;set color&rsquo;&rsquo;), or by toggling it
with ^TC (control-T followed by an uppercase C). If color is
enabled, you may define up to <br>
eight color pairs, each consisting of a foreground color and
a background color. Each of these colors may be defined by
an expression which is evaluated at the same time the <br>
rest of the spreadsheet is evaluated. Color expressions may
be simple, specifying only a foreground color and a
background color, or they may be arbitrarily complex,
causing the <br>
colors to change based upon other data in the spreadsheet,
for example. Color ranges may then be defined using the rC
command, with a color number (1-8) assigned to the range
<br>
(see below).</p>

<p style="margin-top: 1em">Some of the color numbers may
have special meaning under certain circumstances, but may
also be used explicitly at the same time. For example, color
1 is the default color pair <br>
if color is enabled but no color has been defined for a
given cell. It is also the color used for the column and row
labels and the top two lines of the display, which are used
<br>
for prompts, input, error messages, etc. Color 2, while not
explicitly used for all negative numbers, will be used for
negative numbers in cells which have no other color <br>
defined when colorneg is turned on (&lsquo;&lsquo;set
colorneg&rsquo;&rsquo; or ^TN). This is because colorneg
causes all cells with negative numbers to have their color
number incremented by one <br>
(cycling back to color 1 if the cell is defined as using
color 8). Color 3 is used for all cells with errors (ERROR
or INVALID), if colorerr is set (&lsquo;&lsquo;set
colorerr&rsquo;&rsquo; or ^TE), <br>
regardless of which color they have been defined to use, or
whether they have been defined to use any color at all.
Color 4 is used to highlight the
&lsquo;&lsquo;*&rsquo;&rsquo; which signifies that a <br>
cell has a note attached.</p>

<p style="margin-top: 1em">If two color ranges are nested
or overlapping, any cell that is common to both will be
displayed using the color of the most recently defined color
range. You can list all color <br>
definitions and color ranges with the rS (show) command (see
below).</p>

<p style="margin-top: 1em">C This command first prompts you
for the color number you would like to define (or redefine).
After selecting a number (1-8), you may enter an expression
which defines the <br>
foreground and background colors. If the chosen color has
previously been defined, the old definition will be
presented for editing. The syntax of the color command
is:</p>

<p style="margin-top: 1em">color number = expression</p>

<p style="margin-top: 1em">where number is the number of
the color pair you want to define, and expression is the
definition. If the expression is missing, the specified
color number will be unset <br>
(it will revert to its default start-up colors). Unlike
setting it explicitly to its original value, this will not
cause the expression to be written to the file when <br>
saved. See below for an explanation of the format of a color
expression.</p>

<p style="margin-top: 1em">rC This command defines a color
range, and specifies a foreground/background pair to be used
for that range. Although this command also uses the color
command, the syntax is <br>
different from that used for defining a color pair. This
syntax is:</p>

<p style="margin-top: 1em">color range number</p>

<p style="margin-top: 1em">rS This command shows lists of
the currently defined range names, framed ranges, and color
definitions and ranges, one after the other. The output of
this command will be <br>
piped to less. If the environment variable PAGER is set, its
value is used in place of less.</p>

<p style="margin-top: 1em">Color expressions are exactly
like any other numeric expression, and may contain any
function or operator that is valid in any other numeric
expression. There are, however spe&acirc; <br>
cial functions designed specifically for defining colors.
These functions are:</p>

<p style="margin-top: 1em">@black <br>
@red <br>
@green <br>
@yellow <br>
@blue <br>
@magenta <br>
@cyan <br>
@white</p>

<p style="margin-top: 1em">Although these function names
are intended to reflect the color they produce, and use the
same names as the curses colors, @yellow may appear as brown
on many displays, espe&acirc; <br>
cially those based on the VGA standard.</p>

<p style="margin-top: 1em">In addition to special functions
for specifying colors, there is also a special operator for
combining two such colors into a single number which
specifies both a foreground and <br>
a background color. This operator is the semicolon (;). For
example, the command</p>

<p style="margin-top: 1em">color 1 = @white;@green</p>

<p style="margin-top: 1em">will set the foreground color to
white and the background color to green for any cell or
range of cells defined to use color 1, or which have no
color defined. If the semicolon <br>
operator is not used, and only one color is specified, that
color will be used for the foreground, and the background
will default to black.</p>

<p style="margin-top: 1em">Although the above example is
the easiest way to specify foreground and background colors,
and will probably meet most people&rsquo;s needs, sc allows
much more power and flexibility, <br>
should the need arise, due to the fact that any color can be
specified by an expression. For example,</p>

<p style="margin-top: 1em">color 5 =
B23&lt;E75?(@black;@cyan):(@white;@magenta)</p>

<p style="margin-top: 1em">will cause all cells defined
with color 5 to be displayed as black text on a cyan
background if the numeric value in cell B23 is less than the
numeric value in cell E75; other&acirc; <br>
wise, they will be displayed as white text on a magenta
background. If you prefer to have the foreground and
background colors dependent on different criteria, you could
do <br>
something like this:</p>

<p style="margin-top: 1em">color 5 =
(B23&lt;E75?@white:@cyan);(D5%2?@red:@blue)</p>

<p style="margin-top: 1em">This will cause the text color
for color 5 to be either white or cyan, depending on the
numeric values in cells B23 and E75, as in the previous
example, and the background color <br>
to be either red or blue, depending on whether the numeric
value in cell D5 is odd or even.</p>

<p style="margin-top: 1em">Note that although a color
expression may contain any function which is valid in any
other numeric expression, the @myrow and @mycol functions
will always evaluate to 0. This is <br>
because a color expression is not tied to any particular
cell, but is instead evaluated once, and the result used for
all cells defined to use that color.</p>

<p style="margin-top: 1em">Also note that if a color
expression results in an error, the color will default to
black text on a black background. If color 1 results in an
error, color will be disabled so <br>
that you can see the input line to correct the error, after
which color will need to be reenabled manually.</p>

<p style="margin-top: 1em">Default colors are in effect for
all colors until defined otherwise. These default colors are
as follows:</p>

<p style="margin-top: 1em">color 1 = @white;@blue <br>
color 2 = @red;@blue <br>
color 3 = @white;@red <br>
color 4 = @black;@yellow <br>
color 5 = @black;@cyan <br>
color 6 = @red;@cyan <br>
color 7 = @white;@black <br>
color 8 = @red;@black</p>

<p style="margin-top: 1em">Miscellaneous Commands</p>

<p style="margin-top: 1em">Q <br>
q <br>
^C Exit from sc. If you made any changes since the last Get
or Put, sc asks about saving your data before exiting.</p>

<p style="margin-top: 1em">^G <br>
ESC Abort entry of the current command.</p>

<p style="margin-top: 1em">? Enter an interactive help
facility. Lets you look up brief summaries of the main
features of the program. The help facility is structured
like this manual page so it is <br>
easy to find more information on a particular topic,
although it may not be completely up-to-date.</p>

<p style="margin-top: 1em">! Shell escape. sc prompts for a
shell command to run. End the command line with the RETURN
key. If the environment variable SHELL is defined, that
shell is run. If not, <br>
/bin/sh is used. Giving a null command line starts the shell
in interactive mode. A second &lsquo;&lsquo;!&rsquo;&rsquo;
repeats the previous command.</p>

<p style="margin-top: 1em">~ Abbreviations. You may set
abbreviations to speed up the entry of repetitive data.
Abbreviations work much like abbreviations in vi, except
that when defining an abbre&acirc; <br>
viation, both the abbreviation and the expanded text must be
contained within quotes, separated by a single space. If
more than one space separates the abbreviation from <br>
the expanded text, it will be included as part of the
expanded text.</p>

<p style="margin-top: 1em">There are three types of
abbreviations available in sc. In the first type, all
characters must be either alphanumeric or
&lsquo;&lsquo;_&rsquo;&rsquo;. In the second type, the last
character <br>
must be alphanumeric or &lsquo;&lsquo;_&rsquo;&rsquo;, but
all other characters must not be alphanumeric or
&lsquo;&lsquo;_&rsquo;&rsquo;. Neither type may contain
spaces. The third type of abbreviation is a single <br>
character, and must be alphanumeric or
&lsquo;&lsquo;_&rsquo;&rsquo;.</p>

<p style="margin-top: 1em">When using abbreviations, the
first type must be at the beginning of the line, or must be
preceded by any character which is not alphanumeric or
&lsquo;&lsquo;_&rsquo;&rsquo;. The second type <br>
must be at the beginning of the line, or must be preceded
either by an alphanumeric character,
&lsquo;&lsquo;_&rsquo;&rsquo;, or a space. Single character
abbreviations must be at the beginning <br>
of the line or preceded by a space.</p>

<p style="margin-top: 1em">Abbreviations will be
automatically expanded as soon as the space bar or return
key is pressed, or when pressing the ESC key at the end of
the abbreviation to switch to <br>
edit mode. You can also force an abbreviation to be expanded
by following it with a ^], which won&rsquo;t be inserted
into the line. If you don&rsquo;t want an abbreviation to be
<br>
expanded, you must either press ^V twice or switch to edit
mode and back again somewhere within the abbreviation
(pressing ^V twice also has the effect of switching to <br>
navigate mode and back again).</p>

<p style="margin-top: 1em">If the string in the
abbreviation command contains no spaces, the entire string
will be looked up in the list of abbreviations, and if
found, the definition will be dis&acirc; <br>
played in the form of the original abbreviation command used
to define it. When looking up an abbreviation in this
manner, be sure to disable abbreviation expansion, as <br>
described above, or the results may not be what you
expect.</p>

<p style="margin-top: 1em">If the string is empty, a list
of all abbreviations and their corresponding expanded text
will be output to your pager. Note that abbreviations are
not saved with the <br>
file. This allows each user to create his own file of
abbreviations and either merge them in or include them in
his own .scrc file, rather than force all users who access
<br>
a file to use the same list of abbreviations.</p>

<p style="margin-top: 1em">^L Redraw the screen.</p>

<p style="margin-top: 1em">^R Redraw the screen with
special highlighting of cells to be filled in. This is
useful for finding values you need to provide or update in a
form with which you aren&rsquo;t <br>
familiar or of which you have forgotten the details.</p>

<p style="margin-top: 1em">It&rsquo;s also useful for
checking a form you are creating. All cells which contain
constant numeric values (not the result of a numeric
expression) are highlighted temporar&acirc; <br>
ily, until the next screen change, however minor. To avoid
ambiguity, the current range (if any) and current cell are
not highlighted.</p>

<p style="margin-top: 1em">^X This command is similar to
^R, but highlights cells which have expressions. It also
displays the expressions in the highlighted cells as
left-flushed strings, instead of <br>
the numeric values and/or label strings of those cells. This
command makes it easier to check expressions, at least when
they fit in their cells or the following cell(s) <br>
are blank so the expressions can slop over (like label
strings). In the latter case, the slop over is not cleared
on the next screen update, so you may want to type ^L <br>
after the ^X in order to clean up the screen.</p>

<p style="margin-top: 1em">@ Recalculates the
spreadsheet.</p>

<p style="margin-top: 1em">Variable Names <br>
Normally, a variable name is just the name of a cell, such
as K20. The value is the numeric or string value of the
cell, according to context.</p>

<p style="margin-top: 1em">When a cell&rsquo;s expression
(formula) is copied to another location via copy or
range-copy, variable references are by default offset by the
amount the formula moved. This allows <br>
the new formula to work on new data. If cell references are
not to change, you can either use the @fixed operator (see
below), or one of the following variations on the cell <br>
name.</p>

<p style="margin-top: 1em">K20 References cell K20; the
reference changes when the formula is copied.</p>

<p style="margin-top: 1em">$K$20 Always refers to cell K20;
the reference stays fixed when the formula is copied.</p>

<p style="margin-top: 1em">$K20 Keeps the column fixed at
column K; the row is free to vary.</p>

<p style="margin-top: 1em">K$20 Similarly, this fixes the
row and allows the column to vary.</p>

<p style="margin-top: 1em">These conventions also hold on
defined ranges. Range references vary when formulas
containing them are copied. If the range is defined with
fixed variable references, the ref&acirc; <br>
erences do not change.</p>

<p style="margin-top: 1em">@fixed To make a variable not
change automatically when a cell moves, put the word @fixed
in front of the reference, for example: B1 &acirc; @fixed
C3.</p>

<p style="margin-top: 1em">Numeric Expressions <br>
Numeric expressions used with the
&lsquo;&lsquo;=&rsquo;&rsquo; and e commands have a fairly
conventional syntax. Terms may be constants, variable names,
parenthesized expressions, and negated terms. <br>
Ranges may be operated upon with range functions such as sum
(@sum()) and average (@avg()). Terms may be combined using
binary operators.</p>

<p style="margin-top: 1em">-e Negation.</p>

<p style="margin-top: 1em">e+e Addition.</p>

<p style="margin-top: 1em">e-e Subtraction.</p>

<p style="margin-top: 1em">e&acirc;e Multiplication.</p>

<p style="margin-top: 1em">e/e Division.</p>

<p style="margin-top: 1em">e1%e2 e1 mod e2.</p>

<p style="margin-top: 1em">e^e Exponentiation.</p>

<p style="margin-top: 1em">e&lt;e <br>
e&lt;=e <br>
e=e <br>
e!=e <br>
e&gt;=e <br>
e&gt;e Relationals: true (1) if and only if the indicated
relation holds, else false (0). Note that
&lsquo;&lsquo;&lt;=&rsquo;&rsquo;,
&lsquo;&lsquo;!=&rsquo;&rsquo;, and
&lsquo;&lsquo;&gt;=&rsquo;&rsquo; are converted to their
&lsquo;&lsquo;!()&rsquo;&rsquo; equivalents.</p>

<p style="margin-top: 1em">~e Boolean operator NOT.</p>

<p style="margin-top: 1em">e&amp;e Boolean operator
AND.</p>

<p style="margin-top: 1em">e|e Boolean operator OR.</p>

<p style="margin-top: 1em">@if(e,e,e) <br>
e?e:e Conditional: If the first expression is true then the
value of the second is returned, otherwise the value of the
third.</p>

<p style="margin-top: 1em">Operator precedence from highest
to lowest is:</p>

<p style="margin-top: 1em">-, ~, ! <br>
^ <br>
&acirc;, / <br>
+, - <br>
&lt;, &lt;=, =, !=, &gt;=, &gt; <br>
&amp; <br>
| <br>
?:</p>

<p style="margin-top: 1em">Built-in Range Functions <br>
These functions return numeric values. The @sum, @prod,
@avg, @count, @max, @min, and @stddev functions may take an
optional second argument which is an expression that is to
be <br>
evaluated for each cell in the specified range to determine
which cells to include in the function. Only those cells for
which the expression evaluates to true (non-zero) will <br>
be used in calculating the value of the function. Before
evaluation for each cell, the expression is first converted
as if it was being copied from the cell in the upper left-
<br>
hand corner of the range into the cell under consideration,
with all cell references adjusted accordingly. Because the
parts of the expression that should remain fixed during <br>
the evaluation of the function may not necessarily be the
same as those which should remain fixed during an actual
copy operation, the rules for adjusting cell references
during <br>
a copy operation are slightly different than normal. In
particular, these rules differ in two different ways.</p>

<p style="margin-top: 1em">The first difference is that the
@fixed operator is ignored during a copy operation unless it
is enclosed in parentheses. This is so that selected cells
whose addresses should <br>
remain fixed during any given evaluation of a range function
can be adjusted relative to the cell containing the range
function when copied (the $ prefix is still honored for <br>
these cells when copying). Enclosing the @fixed operator in
parentheses will have the opposite effect. That is, it will
cause cell references to be fixed while copying, while <br>
allowing them to be adjusted when the function is being
evaluated, subject to any $ prefixes present. Note that only
the @fixed operator itself should be enclosed in parentheses
<br>
for this to work properly.</p>

<p style="margin-top: 1em">The second difference is that
any references in the expression that refer to cells in the
range in the first argument of the range function will have
any $ prefixes ignored, and <br>
the references will be treated instead as if they had the
same $ prefixes as the left side of the range argument. For
example, if the left side of the range argument (the cell
<br>
address on the left side of the colon) has a fixed row, but
does not have a fixed column, any cell references that refer
to cells in that range will also have a fixed row, but <br>
will not have a fixed column. This is so that if the range
reference moves when copying, references to any cells in
that range will also move accordingly.</p>

<p style="margin-top: 1em">Note that the test expression
will be evaluated once for every cell in the range, which
means that excessive use of these functions with the
optional test expression, or the use <br>
of overly complex test expressions or with very large ranges
can greatly slow down the recalculation of a spreadsheet,
and may require turning off autocalc for speed, and then
<br>
manually recalculating with the @ command.</p>

<p style="margin-top: 1em">@sum(r) <br>
@sum(r,e) Sum all valid (nonblank) entries in the region
whose two corners are defined by the two variable names
(e.g. c5:e14) or the range name specified. The optional <br>
second argument is an expression which can be used to
determine which cells in the range to sum (see above).</p>

<p style="margin-top: 1em">@prod(r) <br>
@prod(r,e) Multiply together all valid (nonblank) entries in
the specified region. The optional second argument is an
expression which can be used to determine which <br>
cells in the range to multiply (see above).</p>

<p style="margin-top: 1em">@avg(r) <br>
@avg(r,e) Average all valid (nonblank) entries in the
specified region. The optional second argument is an
expression which can be used to determine which cells in the
<br>
range to average (see above).</p>

<p style="margin-top: 1em">@count(r) <br>
@count(r,e) Count all valid (nonblank) entries in the
specified region. The optional second argument is an
expression which can be used to determine which cells in the
<br>
range to count (see above).</p>

<p style="margin-top: 1em">@max(r) <br>
@max(r,e) Return the maximum value in the specified region.
The optional second argument is an expression which can be
used to exclude specific cells in the range when <br>
determining this maximum value (see above). See also the
multi argument version of @max below.</p>

<p style="margin-top: 1em">@min(r) <br>
@min(r,e) Return the minimum value in the specified region.
The optional second argument is an expression which can be
used to exclude specific cells in the range when <br>
determining this minimum value (see above). See also the
multi argument version of @min below.</p>

<p style="margin-top: 1em">@stddev(r) <br>
@stddev(r,e) Return the sample standard deviation of the
cells in the specified region. The optional second argument
is an expression which can be used to exclude specific <br>
cells in the range when calculating the standard deviation
(see above).</p>

<p style="margin-top: 1em">@rows(r) Return the number of
rows in the specified range.</p>

<p style="margin-top: 1em">@cols(r) Return the number of
columns in the specified range.</p>

<p style="margin-top: 1em">@lookup(e,r) <br>
@lookup(r,e) <br>
@lookup(se,r) <br>
@lookup(r,se) Evaluates the expression then searches through
the range r for a matching value. The range should be either
a single row or a single column. The expression <br>
can be either a string expression or a numeric expression.
If it is a numeric expression, the range is searched for the
the last value less than or equal to e. <br>
If the expression is a string expression, the string
portions of the cells in the range are searched for an exact
string match. The value returned is the <br>
numeric value from the next row and the same column as the
match, if the range was a single row, or the value from the
next column and the same row as the match <br>
if the range was a single column.</p>

<p style="margin-top: 1em">@hlookup(e,r,n) <br>
@hlookup(r,e,n) <br>
@hlookup(se,r,n) <br>
@hlookup(r,se,n) Evaluates the expression then searches
through the first row in the range r for a matching value.
The expression can be either a string expression or a
numeric <br>
expression. If it is a numeric expression, the row is
searched for the the last value less than or equal to e. If
the expression is a string expression, the <br>
string portions of the cells in the row are searched for an
exact string match. The value returned is the numeric value
from the same column n rows below the <br>
match.</p>

<p style="margin-top: 1em">@vlookup(e,r,n) <br>
@vlookup(r,e,n) <br>
@vlookup(se,r,n) <br>
@vlookup(r,se,n) Evaluates the expression then searches
through the first column in the range r for a matching
value. The expression can be either a string expression or a
<br>
numeric expression. If it is a numeric expression, the
column is searched for the the last value less than or equal
to e. If the expression is a string <br>
expression, the string portions of the cells in the column
are searched for an exact string match. The value returned
is the numeric value from the same row n <br>
columns to the right of the match.</p>

<p style="margin-top: 1em">@index(e1,r) <br>
@index(r,e1) <br>
@index(r,e1,e2) Use the values of expressions e1 and
(optionally) e2 to index into the range r. The numeric value
at that position is returned. With two arguments, the range
<br>
should be either a single row or a single column. An
expression with the value 1 selects the first item in the
range, 2 selects the second item, etc. With <br>
three arguments, the range must come first, and the second
and third arguments will then be interpreted as row and
column, respectively, for indexing into a <br>
two-dimensional table.</p>

<p style="margin-top: 1em">@stindex(e1,r) <br>
@stindex(r,e1) <br>
@stindex(r,e1,e2) Use the values of expressions e1 and
(optionally) e2 to index into the range r. The string value
at that position is returned. With two arguments, the range
<br>
should be either a single row or a single column. An
expression with the value 1 selects the first item in the
range, 2 selects the second item, etc. With <br>
three arguments, the range must come first, and the second
and third arguments will then be interpreted as row and
column, respectively, for indexing into a <br>
two-dimensional table.</p>

<p style="margin-top: 1em">Built-in Numeric Functions <br>
All of these functions operate on floating point numbers
(doubles) and return numeric values. Most of them are
standard system functions more fully described in math(3).
The <br>
trig functions operate with angles in radians.</p>

<p style="margin-top: 1em">@sqrt(e) Return the square root
of e.</p>

<p style="margin-top: 1em">@exp(e) Return the exponential
function of e.</p>

<p style="margin-top: 1em">@ln(e) Return the natural
logarithm of e.</p>

<p style="margin-top: 1em">@log(e) Return the base 10
logarithm of e.</p>

<p style="margin-top: 1em">@floor(e) Return the largest
integer not greater than e.</p>

<p style="margin-top: 1em">@ceil(e) Return the smallest
integer not less than e.</p>

<p style="margin-top: 1em">@rnd(e) Round e to the nearest
integer. default: *.5 will be rounded up to the next
integer; doing a &rsquo;set rndtoeven&rsquo; will cause it
to be rounded to the closest even <br>
number instead (aka banker&rsquo;s round). Round-to-even has
advantages over the default rounding for some applications.
For example, if X+Y is an integer, then X+Y <br>
= rnd(X)+rnd(Y) with round-to-even, but not always with the
defaulting rounding method. This could be an advantage, for
example, when trying to split an odd <br>
amount of money evenly between two people (it would
determine who gets the extra penny).</p>

<p style="margin-top: 1em">@round(e,n) Round e to n decimal
places. n may be positive to round off the right side of the
decimal or negative to round off the left side. See @rnd(e)
above for round&acirc; <br>
ing types.</p>

<p style="margin-top: 1em">@abs(e) <br>
@fabs(e) Return the absolute value of e.</p>

<p style="margin-top: 1em">@pow(e1,e2) Return e1 raised to
the power of e2.</p>

<p style="margin-top: 1em">@hypot(e1,e2) Return
sqrt(e1&acirc;e1+e2&acirc;e2), taking precautions against
unwarranted overflows.</p>

<p style="margin-top: 1em">@pi A constant quite close to
pi.</p>

<p style="margin-top: 1em">@dtr(e) Convert e in degrees to
radians.</p>

<p style="margin-top: 1em">@rtd(e) Convert e in radians to
degrees.</p>

<p style="margin-top: 1em">@sin(e) <br>
@cos(e) <br>
@tan(e) Return trigonometric functions of radian arguments.
The magnitude of the arguments are not checked to assure
meaningful results.</p>

<p style="margin-top: 1em">@asin(e) Return the arc sine of
e in the range -pi/2 to pi/2.</p>

<p style="margin-top: 1em">@acos(e) Return the arc cosine
of e in the range 0 to pi.</p>

<p style="margin-top: 1em">@atan(e) Return the arc tangent
of e in the range -pi/2 to pi/2.</p>

<p style="margin-top: 1em">@atan2(e1,e2) Returns the arc
tangent of e1/e2 in the range -pi to pi.</p>

<p style="margin-top: 1em">@max(e1,e2,...) Return the
maximum of the values of the expressions. Two or more
expressions may be specified. See also the range version of
@max above.</p>

<p style="margin-top: 1em">@min(e1,e2,...) Return the
minimum of the values of the expressions. Two or more
expressions may be specified. See also the range version of
@min above.</p>

<p style="margin-top: 1em">@ston(se) Convert string
expression se to a numeric value.</p>

<p style="margin-top: 1em">@eqs(se1,se2) Return 1 if string
expression se1 has the same value as string expression se2,
0 otherwise.</p>

<p style="margin-top: 1em">@nval(se,e) Return the numeric
value of a cell selected by name. String expression se must
evaluate to a column name
(&lsquo;&lsquo;A&rsquo;&rsquo;-&lsquo;&lsquo;AE&rsquo;&rsquo;)
and e must evaluate to a row number <br>
(0-199). If se or e is out of bounds, or the cell has no
numeric value, the result is 0. You can use this for simple
table lookups. Be sure the table doesn&rsquo;t <br>
move unexpectedly! See also @sval() below.</p>

<p style="margin-top: 1em">@err Force an error. This will
force the expression which contains it to result in an
error.</p>

<p style="margin-top: 1em">String Expressions <br>
String expressions are made up of constant strings
(characters surrounded by double quotation marks), variables
(cell names, which refer to the cells&rsquo;s label strings
or expres&acirc; <br>
sions), and string functions. Note that string expressions
are only allowed when entering a cell&rsquo;s label string,
not its numeric part. Also note that string expression
results <br>
may be left or right flushed or centered, according to the
type of the cell&rsquo;s string label.</p>

<p style="margin-top: 1em"># Concatenate strings. For
example, the string expression</p>

<p style="margin-top: 1em">A0 # &quot;zy dog&quot;</p>

<p style="margin-top: 1em">displays the string
&lsquo;&lsquo;the lazy dog&rsquo;&rsquo; in the cell if the
value of A0&rsquo;s string is &lsquo;&lsquo;the
la&rsquo;&rsquo;.</p>

<p style="margin-top: 1em">Built-in String Functions</p>

<p style="margin-top: 1em">@filename(e) Return the current
default filename, as specified when the file was first
loaded or created, or during the last save, with the Put
command. If e is 0, only the <br>
actual filename will be returned, with any path removed. If
non-zero, the full path specified on the command line or in
the last Get or Put command will be <br>
returned. If the path begins with
&lsquo;&lsquo;~&rsquo;&rsquo;, it will be expanded to the
appropriate users home directory.</p>

<p style="margin-top: 1em">@substr(se,e1,e2) Extract and
return from string expression se the substring indexed by
character number e1 through character number e2 (defaults to
the size of se if beyond the <br>
end of it). If e1 is less than 1 or greater than e2, the
result is the null string. For example,</p>

<p style="margin-top: 1em">@substr (&quot;Nice
jacket&quot;, 4, 8)</p>

<p style="margin-top: 1em">returns the string
&lsquo;&lsquo;e jac&rsquo;&rsquo;.</p>

<p style="margin-top: 1em">@fmt(se,e) Convert a number to a
string. The argument se must be a valid printf(3) format
string. e is converted according to the standard rules. For
example, the <br>
expression</p>

<p style="margin-top: 1em">@fmt
(&quot;&acirc;&acirc;%6.3f&acirc;&acirc;&quot;, 10.5)</p>

<p style="margin-top: 1em">yields the string
&lsquo;&lsquo;&acirc;&acirc;10.500&acirc;&acirc;&rsquo;&rsquo;.
e is a double, so applicable formats are e, E, f, g, and G.
Try &lsquo;&lsquo;%g&rsquo;&rsquo; as a starting point.</p>

<p style="margin-top: 1em">@sval(se,e) Return the string
value of a cell selected by name. String expression se must
evaluate to a column name
(&lsquo;&lsquo;A&rsquo;&rsquo;-&lsquo;&lsquo;AE&rsquo;&rsquo;)
and e must evaluate to a row number <br>
(0-199). If se or e is out of bounds, or the cell has no
string value, the result is the null string. You can use
this for simple table lookups. Be sure the <br>
table doesn&rsquo;t move unexpectedly!</p>

<p style="margin-top: 1em">@upper(se) <br>
@lower(se) will case the string expression to upper or
lower.</p>

<p style="margin-top: 1em">@capital(se) will convert the
first letter of words in a string into upper case and other
letters to lower case (the latter if all letters of the
string are upper case).</p>

<p style="margin-top: 1em">@ext(se,e) Call an external
function (program or script). The purpose is to allow
arbitrary functions on values, e.g. table lookups and
interpolations. String expression <br>
se is a command or command line to call with popen(3). The
value of e is converted to a string and appended to the
command line as an argument. The result of <br>
@ext() is a string: the first line printed to standard
output by the command. The command should emit exactly one
output line. Additional output, or output to <br>
standard error, messes up the screen. @ext() returns a null
string and prints an appropriate warning if external
functions are disabled, se is null, or the <br>
attempt to run the command fails.</p>

<p style="margin-top: 1em">External functions can be slow
to run, and if enabled are called at each screen update, so
they are disabled by default. You can enable them with ^T
when you <br>
really want them called.</p>

<p style="margin-top: 1em">A simple example:</p>

<p style="margin-top: 1em">@ext (&quot;echo&quot;, a1)</p>

<p style="margin-top: 1em">You can use @ston() to convert
the @ext() result back to a number. For example:</p>

<p style="margin-top: 1em">@ston (@ext
(&quot;form.sc.ext&quot;, a9 + b9))</p>

<p style="margin-top: 1em">Note that you can build a
command line (including more argument values) from a string
expression with concatenation. You can also &quot;hide&quot;
the second argument by <br>
ending the command line (first argument) with &lsquo;&lsquo;
#&rsquo;&rsquo; (shell comment).</p>

<p style="margin-top: 1em">@coltoa(e) Returns a string name
for a column from the numeric argument. For example:</p>

<p style="margin-top: 1em">@coltoa(@mycol-1)
@nval(coltoa(@mycol-1), @myrow+1)</p>

<p style="margin-top: 1em">Built-in Financial Functions
<br>
Financial functions compute the mortgage (or loan) payment,
future value, and the present value functions. Each accepts
three arguments, an amount, a rate of interest (per <br>
period), and the number of periods. These functions are the
same as those commonly found in other spreadsheets and
financial calculators</p>

<p style="margin-top: 1em">@pmt(e1,e2,e3)
@pmt(60000,.01,360) computes the monthly payments for a
$60000 mortgage at 12% annual interest (.01 per month) for
30 years (360 months).</p>

<p style="margin-top: 1em">@fv(e1,e2,e3) @fv(100,.005,36)
computes the future value for 36 monthly payments of $100 at
6% interest (.005 per month). It answers the question:
&quot;How much will I have in <br>
36 months if I deposit $100 per month in a savings account
paying 6% interest compounded monthly?&quot;</p>

<p style="margin-top: 1em">@pv(e1,e2,e3) @pv(1000,.015,36)
computes the present value of an ordinary annuity of 36
monthly payments of $1000 at 18% annual interest. It answers
the question: &quot;How much <br>
can I borrow at 18% for 3 years if I pay $1000 per
month?&quot;</p>

<p style="margin-top: 1em">Built-in Date and Time Functions
<br>
Time for sc follows the system standard: the number of
seconds since the beginning of 1970. All date and time
functions except @date() return numbers, not strings.</p>

<p style="margin-top: 1em">@now Return the current time
encoded as the number of seconds since the beginning of the
epoch (December 31, 1969, midnight, GMT).</p>

<p style="margin-top: 1em">@dts(e1,e2,e3) Convert a date to
the number of seconds from the epoch to the first second of
the specified date, local time. Dates may be specified in
either (m,d,y) or <br>
(y,m,d) format, although the latter is preferred, since
it&rsquo;s more universally recognized (m,d,y is only used
in America). If e2 &gt; 12 or e3 &gt; 31, then (m,d,y) <br>
is assumed. Otherwise, (y,m,d) is assumed. For example,
@date(@dts(1976,12,14)) yields</p>

<p style="margin-top: 1em">Tue Dec 14 00:00:00 1976</p>

<p style="margin-top: 1em">The month should range from 1 to
12; the day should range from 1 to the number of days in the
specified month; and the year should include the century
(e.g. <br>
1999 instead of 99). Any date capable of being handled by
the system is valid, typically 14 Dec 1901 to 18 Jan 2038 on
a system that uses a 32 bit time_t. <br>
Invalid dates or dates outside of this range will return
ERROR. For rapid entry of dates using only the numeric
keypad, sc provides the alternate syntax y.m.d <br>
or m.d.y, which is automatically converted to the @dts(...)
format above. The year, month, and day must be entered
numerically in the alternate syntax; formu&acirc; <br>
las are not allowed.</p>

<p style="margin-top: 1em">@tts(e1,e2,e3) @tts(8,20,45)
converts the time 8:40:45 to the number of seconds since
midnight, the night before. The hour should range from 0 to
23; the minutes and seconds <br>
should range from 0 to 59.</p>

<p style="margin-top: 1em">The following functions take the
time in seconds (e.g. from @now) as an argument and return
the specified value. The functions all convert from GMT to
local time.</p>

<p style="margin-top: 1em">@date(e) <br>
@date(e,se) Convert the time in seconds to a date string.
With a single numeric argument, the date will be 24
characters long in the following form:</p>

<p style="margin-top: 1em">Sun Sep 16 01:03:52 1973</p>

<p style="margin-top: 1em">Note that you can extract parts
of this fixed-format string with @substr(). A format string
compatible with the strftime() function may optionally be
given as <br>
a second argument to override the default format. See the
strftime(3) man page for details.</p>

<p style="margin-top: 1em">@year(e) Return the year. Valid
years begin with 1970, although many systems will return
years prior to 1970 if e is negative. The last legal year is
system dependent.</p>

<p style="margin-top: 1em">@month(e) Return the month,
encoded as 1 (January) to 12 (December).</p>

<p style="margin-top: 1em">@day(e) Return the day of the
month, encoded as 1 to 31.</p>

<p style="margin-top: 1em">@hour(e) Return the number of
hours since midnight, encoded as 0 to 23.</p>

<p style="margin-top: 1em">@minute(e) Return the number of
minutes since the last full hour, encoded as 0 to 59.</p>

<p style="margin-top: 1em">@second(e) Return the number of
seconds since the last full minute, encoded as 0 to 59.</p>

<p style="margin-top: 1em">Spreadsheet Update <br>
Re-evaluation of spreadsheet expressions is done by row or
by column depending on the selected calculation order.
Evaluation is repeated up to iterations times for each
update <br>
if necessary, so forward references usually work as
expected. See set above. If stability is not reached after
ten iterations, a warning is printed. This is usually due to
a <br>
long series of forward references, or to unstable cyclic
references (for example, set A0&rsquo;s expression to
&lsquo;&lsquo;A0+1&rsquo;&rsquo;).</p>

<p style="margin-top: 1em">@numiter Returns the number of
iterations performed so far.</p>

<p style="margin-top: 1em">Programmable Function Keys <br>
Function keys can be used in sc if your terminal supports
them, and they are programmable. To program the function
keys, you use the fkey command. This command may be used in
a <br>
.scrc file or a macro file, or it may be entered directly
into sc&rsquo;s command line. Defined function keys will be
saved with the file. There is no shortcut, as there is with
most <br>
commands, so the full command must be typed in. Pressing
enter when not editing a line will start you off with a
blank line for this purpose. The format of the fkey command
is:</p>

<p style="margin-top: 1em">fkey n = &quot;command&quot;</p>

<p style="margin-top: 1em">where n is the function key
number (n = 1 for F1, n = 2 for F2, etc.), and command is
the command to be run. For example,</p>

<p style="margin-top: 1em">fkey 2 = &quot;merge</p>

<p style="margin-top: 1em">will run the macro called macro1
located in a subdirectory of your home directory called
scmacros when the F2 key is pressed. Note that embedded
quotes must be escaped by a <br>
backslash. If you want to include the cell address of the
current cell in the command line, you may do so by entering
&lsquo;&lsquo;$$&rsquo;&rsquo; in its place in the command.
For example,</p>

<p style="margin-top: 1em">fkey 5 = &quot;fmt $$</p>

<p style="margin-top: 1em">will cause the F5 key to format
the current cell to display the full weekday name of the
numeric date value stored there. The ^D is a CTRL-D
character, which denotes a date for&acirc; <br>
mat.</p>

<p style="margin-top: 1em">Although it may be overridden by
the fkey command, the F1 key is predefined by default to
execute man sc. Unlike the user-defined function keys, this
definition will also work <br>
in edit, insert, replace, and navigate modes.</p>

<p style="margin-top: 1em">To undefine a function key,
merely define it as the empty string (&quot;&quot;).
Undefining the F1 key will restore the default behavior.</p>

<p style="margin-top: 1em">Plugins <br>
There are three ways in which external programs can be used
as plugins with sc. First, they can be used as external
commands. When used as an external command, any command not
<br>
recognized by sc will be searched for first in
$HOME/.sc/plugins, and then in /usr/share/doc/sc/plugins. If
found, it will be run with its standard input and standard
output <br>
redirected back to sc. These are used to send commands to,
and receive responses back from sc in the same way that
advanced macros do.</p>

<p style="margin-top: 1em">The second and third ways that
programs can be used as plugins with sc are to automatically
convert files to and from sc format based on their
extensions. In order to use them <br>
in this way, you must first associate a given extension to a
corresponding plugin (for reading) or plugout (for writing)
using the plugin and plugout commands. These commands <br>
should be placed in your .scrc file, and have the following
syntax:</p>

<p style="margin-top: 1em">plugin &quot;ext&quot; =
&quot;programname&quot;</p>

<p style="margin-top: 1em">or</p>

<p style="margin-top: 1em">plugout &quot;ext&quot; =
&quot;programname&quot;</p>

<p style="margin-top: 1em">where ext is the extension and
programname is the name of the plugin program to be used for
filenames with that extension. For input, the plugin merely
reads the specified file, <br>
performs whatever conversion is necessary, and writes the
resulting data to standard output. For output, the plugin
writes sc commands to standard output and reads the replies
<br>
from standard input in the same way that an advanced macro
would, and then converts the data to the appropriate format
and writes it to a file with the specified filename.</p>

<p style="margin-top: 1em">FILES <br>
/usr/share/doc/sc/tutorial.sc Tutorial spreadsheet.</p>

<p style="margin-top: 1em">$HOME/.scrc Initialization
commands.</p>

<p style="margin-top: 1em">./.scrc More initialization
commands.</p>

<p style="margin-top: 1em">SEE ALSO <br>
bc(1), dc(1), crypt(1), psc(1)</p>

<p style="margin-top: 1em">BUGS <br>
Top-to-bottom, left-to-right evaluation of expressions is
silly. A proper following of the dependency graph with
(perhaps) recourse to relaxation should be implemented.</p>

<p style="margin-top: 1em">On some systems, if the cell
cursor is in column 0 with topline enabled (so the current
cell is highlighted), or if any cell in column 0 is
highlighted, the corresponding row <br>
number gets displayed and then blanked during a screen
refresh. This looks like a bug in curses.</p>

<p style="margin-top: 1em">Many commands give no indication
(a message or beep) if they have null effect. Some should
give confirmation of their action, but they don&rsquo;t.</p>

<p style="margin-top: 1em">AUTHORS <br>
This is a much modified version of a public domain spread
sheet originally authored by James Gosling, and subsequently
modified and posted to USENET by Mark Weiser under the name
<br>
vc. The program was subsequently renamed sc, and further
modified by numerous contributors, Jeff Buhrt of Proslink,
Inc. and Robert Bond of Sequent, prominent among them. The
<br>
current maintainer is Chuck Martin
(nrocinu@myrealbox.com).</p>

<p style="margin-top: 1em">Other contributors include: Tom
Anderson, Glenn T. Barry, Gregory Bond, Stephen (Steve) M.
Brooks, Peter Brower, John Campbell, Lawrence Cipriani, Jim
Clausing, Dave Close, Chris <br>
Cole, Jonathan Crompron, David I. Dalva, Glen Ditchfield,
Sam Drake, James P. Dugal, Paul Eggert, Andy Fyfe, Jack
Goral, Piercarlo &quot;Peter&quot; Grandi, Henk Hesselink,
Jeffrey C <br>
Honig, Kurt Horton, Jonathan I. Kamens, Peter King, Tom
Kloos, Michael Lapsley, Casey Leedom, Jay Lepreau, Dave
Lewis, Rick Linck, Soren Lundsgaard, Tad Mannes, Rob
McMahon, <br>
Chris Metcalf, Mark Nagel, Ulf Noren, Marius Olafsson, Gene
H. Olson, Henk P. Penning, Rick Perry, Larry Philps, Eric
Putz, Jim Richardson, Michael Richardson, R. P. C. Rodgers,
<br>
Kim Sanders, Mike Schwartz, Alan Silverstein, Lowell Skoog,
Herr Soeryantono, Tim Theisen, Tom Tkacik, Andy Valencia,
Adri Verhoef, Rick Walker, Petri Wessman, and Tim
Wilson.</p>

<p style="margin-top: 1em">SC 7.16 19 September 2002
SC(1)</p>
<hr>
</body>
</html>
