<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:27:23 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>NMAP(1) Nmap Reference Guide NMAP(1)</p>

<p style="margin-top: 1em">NAME <br>
nmap - Network exploration tool and security / port
scanner</p>

<p style="margin-top: 1em">SYNOPSIS <br>
nmap [Scan Type...] [Options] {target specification}</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Nmap (&acirc;Network Mapper&acirc;) is an open source tool
for network exploration and security auditing. It was
designed to rapidly scan large networks, although it works
fine against <br>
single hosts. Nmap uses raw IP packets in novel ways to
determine what hosts are available on the network, what
services (application name and version) those hosts are
offering, <br>
what operating systems (and OS versions) they are running,
what type of packet filters/firewalls are in use, and dozens
of other characteristics. While Nmap is commonly used for
<br>
security audits, many systems and network administrators
find it useful for routine tasks such as network inventory,
managing service upgrade schedules, and monitoring host or
<br>
service uptime.</p>

<p style="margin-top: 1em">The output from Nmap is a list
of scanned targets, with supplemental information on each
depending on the options used. Key among that information is
the &acirc;interesting ports <br>
table&acirc;.. That table lists the port number and
protocol, service name, and state. The state is either open,
filtered, closed, or unfiltered. Open. means that an
application on <br>
the target machine is listening for connections/packets on
that port. Filtered. means that a firewall, filter, or other
network obstacle is blocking the port so that Nmap <br>
cannot tell whether it is open or closed. Closed. ports have
no application listening on them, though they could open up
at any time. Ports are classified as unfiltered. when <br>
they are responsive to Nmap&rsquo;s probes, but Nmap cannot
determine whether they are open or closed. Nmap reports the
state combinations open|filtered. and closed|filtered. when
it <br>
cannot determine which of the two states describe a port.
The port table may also include software version details
when version detection has been requested. When an IP
protocol <br>
scan is requested (-sO), Nmap provides information on
supported IP protocols rather than listening ports.</p>

<p style="margin-top: 1em">In addition to the interesting
ports table, Nmap can provide further information on
targets, including reverse DNS names, operating system
guesses, device types, and MAC <br>
addresses.</p>

<p style="margin-top: 1em">A typical Nmap scan is shown in
Example 1. The only Nmap arguments used in this example are
-A, to enable OS and version detection, script scanning, and
traceroute; -T4 for <br>
faster execution; and then the two target hostnames.</p>

<p style="margin-top: 1em">Example 1. A representative Nmap
scan</p>

<p style="margin-top: 1em"># nmap -A -T4
scanme.nmap.org</p>

<p style="margin-top: 1em">Nmap scan report for
scanme.nmap.org (74.207.244.221) <br>
Host is up (0.029s latency). <br>
rDNS record for 74.207.244.221: li86-221.members.linode.com
<br>
Not shown: 995 closed ports <br>
PORT STATE SERVICE VERSION <br>
22/tcp open ssh OpenSSH 5.3p1 Debian 3ubuntu7 (protocol 2.0)
<br>
| ssh-hostkey: 1024
8d:60:f1:7c:ca:b7:3d:0a:d6:67:54:9d:69:d9:b9:dd (DSA) <br>
|_2048 79:f8:09:ac:d4:e2:32:42:10:49:d3:bd:20:82:85:ec (RSA)
<br>
80/tcp open http Apache httpd 2.2.14 ((Ubuntu)) <br>
|_http-title: Go ahead and ScanMe! <br>
646/tcp filtered ldp <br>
1720/tcp filtered H.323/Q.931 <br>
9929/tcp open nping-echo Nping echo <br>
Device type: general purpose <br>
Running: Linux 2.6.X <br>
OS CPE: cpe:/o:linux:linux_kernel:2.6.39 <br>
OS details: Linux 2.6.39 <br>
Network Distance: 11 hops <br>
Service Info: OS: Linux; CPE: cpe:/o:linux:kernel</p>

<p style="margin-top: 1em">TRACEROUTE (using port 53/tcp)
<br>
HOP RTT ADDRESS <br>
[Cut first 10 hops for brevity] <br>
11 17.65 ms li86-221.members.linode.com (74.207.244.221)</p>

<p style="margin-top: 1em">Nmap done: 1 IP address (1 host
up) scanned in 14.40 seconds</p>

<p style="margin-top: 1em">The newest version of Nmap can
be obtained from http://nmap.org. The newest version of this
man page is available at http://nmap.org/book/man.html. It
is also included as a <br>
chapter of Nmap Network Scanning: The Official Nmap Project
Guide to Network Discovery and Security Scanning (see
http://nmap.org/book/).</p>

<p style="margin-top: 1em">OPTIONS SUMMARY <br>
This options summary is printed when Nmap is run with no
arguments, and the latest version is always available at
https://svn.nmap.org/nmap/docs/nmap.usage.txt. It helps
people <br>
remember the most common options, but is no substitute for
the in-depth documentation in the rest of this manual. Some
obscure options aren&rsquo;t even included here.</p>

<p style="margin-top: 1em">Nmap 6.40 ( http://nmap.org )
<br>
Usage: nmap [Scan Type(s)] [Options] {target specification}
<br>
TARGET SPECIFICATION: <br>
Can pass hostnames, IP addresses, networks, etc. <br>
Ex: scanme.nmap.org, 192.168.0.1; 10.0.0-255.1-254 <br>
-iL &lt;inputfilename&gt;: Input from list of hosts/networks
<br>
-iR &lt;num hosts&gt;: Choose random targets <br>
--exclude &lt;host1[,host2][,host3],...&gt;: Exclude
hosts/networks <br>
--excludefile &lt;exclude_file&gt;: Exclude list from file
<br>
HOST DISCOVERY: <br>
-sL: List Scan - simply list targets to scan <br>
-sn: Ping Scan - disable port scan <br>
-Pn: Treat all hosts as online -- skip host discovery <br>
-PS/PA/PU/PY[portlist]: TCP SYN/ACK, UDP or SCTP discovery
to given ports <br>
-PE/PP/PM: ICMP echo, timestamp, and netmask request
discovery probes <br>
-PO[protocol list]: IP Protocol Ping <br>
-n/-R: Never do DNS resolution/Always resolve [default:
sometimes] <br>
--dns-servers &lt;serv1[,serv2],...&gt;: Specify custom DNS
servers <br>
--system-dns: Use OS&rsquo;s DNS resolver <br>
--traceroute: Trace hop path to each host <br>
SCAN TECHNIQUES: <br>
-sS/sT/sA/sW/sM: TCP SYN/Connect()/ACK/Window/Maimon scans
<br>
-sU: UDP Scan <br>
-sN/sF/sX: TCP Null, FIN, and Xmas scans <br>
--scanflags &lt;flags&gt;: Customize TCP scan flags <br>
-sI &lt;zombie host[:probeport]&gt;: Idle scan <br>
-sY/sZ: SCTP INIT/COOKIE-ECHO scans <br>
-sO: IP protocol scan <br>
-b &lt;FTP relay host&gt;: FTP bounce scan <br>
PORT SPECIFICATION AND SCAN ORDER: <br>
-p &lt;port ranges&gt;: Only scan specified ports <br>
Ex: -p22; -p1-65535; -p U:53,111,137,T:21-25,80,139,8080,S:9
<br>
-F: Fast mode - Scan fewer ports than the default scan <br>
-r: Scan ports consecutively - don&rsquo;t randomize <br>
--top-ports &lt;number&gt;: Scan &lt;number&gt; most common
ports <br>
--port-ratio &lt;ratio&gt;: Scan ports more common than
&lt;ratio&gt; <br>
SERVICE/VERSION DETECTION: <br>
-sV: Probe open ports to determine service/version info <br>
--version-intensity &lt;level&gt;: Set from 0 (light) to 9
(try all probes) <br>
--version-light: Limit to most likely probes (intensity 2)
<br>
--version-all: Try every single probe (intensity 9) <br>
--version-trace: Show detailed version scan activity (for
debugging) <br>
SCRIPT SCAN: <br>
-sC: equivalent to --script=default <br>
--script=&lt;Lua scripts&gt;: &lt;Lua scripts&gt; is a comma
separated list of <br>
directories, script-files or script-categories <br>
--script-args=&lt;n1=v1,[n2=v2,...]&gt;: provide arguments
to scripts <br>
--script-args-file=filename: provide NSE script args in a
file <br>
--script-trace: Show all data sent and received <br>
--script-updatedb: Update the script database. <br>
--script-help=&lt;Lua scripts&gt;: Show help about scripts.
<br>
&lt;Lua scripts&gt; is a comma separated list of
script-files or <br>
script-categories. <br>
OS DETECTION: <br>
-O: Enable OS detection <br>
--osscan-limit: Limit OS detection to promising targets <br>
--osscan-guess: Guess OS more aggressively <br>
TIMING AND PERFORMANCE: <br>
Options which take &lt;time&gt; are in seconds, or append
&rsquo;ms&rsquo; (milliseconds), <br>
&rsquo;s&rsquo; (seconds), &rsquo;m&rsquo; (minutes), or
&rsquo;h&rsquo; (hours) to the value (e.g. 30m). <br>
-T&lt;0-5&gt;: Set timing template (higher is faster) <br>
--min-hostgroup/max-hostgroup &lt;size&gt;: Parallel host
scan group sizes <br>
--min-parallelism/max-parallelism &lt;numprobes&gt;: Probe
parallelization <br>
--min-rtt-timeout/max-rtt-timeout/initial-rtt-timeout
&lt;time&gt;: Specifies <br>
probe round trip time. <br>
--max-retries &lt;tries&gt;: Caps number of port scan probe
retransmissions. <br>
--host-timeout &lt;time&gt;: Give up on target after this
long <br>
--scan-delay/--max-scan-delay &lt;time&gt;: Adjust delay
between probes <br>
--min-rate &lt;number&gt;: Send packets no slower than
&lt;number&gt; per second <br>
--max-rate &lt;number&gt;: Send packets no faster than
&lt;number&gt; per second <br>
FIREWALL/IDS EVASION AND SPOOFING: <br>
-f; --mtu &lt;val&gt;: fragment packets (optionally w/given
MTU) <br>
-D &lt;decoy1,decoy2[,ME],...&gt;: Cloak a scan with decoys
<br>
-S &lt;IP_Address&gt;: Spoof source address <br>
-e &lt;iface&gt;: Use specified interface <br>
-g/--source-port &lt;portnum&gt;: Use given port number <br>
--data-length &lt;num&gt;: Append random data to sent
packets <br>
--ip-options &lt;options&gt;: Send packets with specified ip
options <br>
--ttl &lt;val&gt;: Set IP time-to-live field <br>
--spoof-mac &lt;mac address/prefix/vendor name&gt;: Spoof
your MAC address <br>
--badsum: Send packets with a bogus TCP/UDP/SCTP checksum
<br>
OUTPUT: <br>
-oN/-oX/-oS/-oG &lt;file&gt;: Output scan in normal, XML,
s|&lt;rIpt kIddi3, <br>
and Grepable format, respectively, to the given filename.
<br>
-oA &lt;basename&gt;: Output in the three major formats at
once <br>
-v: Increase verbosity level (use -vv or more for greater
effect) <br>
-d: Increase debugging level (use -dd or more for greater
effect) <br>
--reason: Display the reason a port is in a particular state
<br>
--open: Only show open (or possibly open) ports <br>
--packet-trace: Show all packets sent and received <br>
--iflist: Print host interfaces and routes (for debugging)
<br>
--log-errors: Log errors/warnings to the normal-format
output file <br>
--append-output: Append to rather than clobber specified
output files <br>
--resume &lt;filename&gt;: Resume an aborted scan <br>
--stylesheet &lt;path/URL&gt;: XSL stylesheet to transform
XML output to HTML <br>
--webxml: Reference stylesheet from Nmap.Org for more
portable XML <br>
--no-stylesheet: Prevent associating of XSL stylesheet w/XML
output <br>
MISC: <br>
-6: Enable IPv6 scanning <br>
-A: Enable OS detection, version detection, script scanning,
and traceroute <br>
--datadir &lt;dirname&gt;: Specify custom Nmap data file
location <br>
--send-eth/--send-ip: Send using raw ethernet frames or IP
packets <br>
--privileged: Assume that the user is fully privileged <br>
--unprivileged: Assume the user lacks raw socket privileges
<br>
-V: Print version number <br>
-h: Print this help summary page. <br>
EXAMPLES: <br>
nmap -v -A scanme.nmap.org <br>
nmap -v -sn 192.168.0.0/16 10.0.0.0/8 <br>
nmap -v -iR 10000 -Pn -p 80 <br>
SEE THE MAN PAGE (http://nmap.org/book/man.html) FOR MORE
OPTIONS AND EXAMPLES</p>

<p style="margin-top: 1em">TARGET SPECIFICATION <br>
Everything on the Nmap command-line that isn&rsquo;t an
option (or option argument) is treated as a target host
specification. The simplest case is to specify a target IP
address or <br>
hostname for scanning.</p>

<p style="margin-top: 1em">Sometimes you wish to scan a
whole network of adjacent hosts. For this, Nmap supports
CIDR-style. addressing. You can append /numbits to an IPv4
address or hostname and Nmap <br>
will scan every IP address for which the first numbits are
the same as for the reference IP or hostname given. For
example, 192.168.10.0/24 would scan the 256 hosts between
<br>
192.168.10.0 (binary: 11000000 10101000 00001010 00000000)
and 192.168.10.255 (binary: 11000000 10101000 00001010
11111111), inclusive. 192.168.10.40/24 would scan exactly
the <br>
same targets. Given that the host scanme.nmap.org. is at the
IP address 64.13.134.52, the specification
scanme.nmap.org/16 would scan the 65,536 IP addresses
between 64.13.0.0 <br>
and 64.13.255.255. The smallest allowed value is /0, which
targets the whole Internet. The largest value is /32, which
scans just the named host or IP address because all address
<br>
bits are fixed.</p>

<p style="margin-top: 1em">CIDR notation is short but not
always flexible enough. For example, you might want to scan
192.168.0.0/16 but skip any IPs ending with .0 or .255
because they may be used as <br>
subnet network and broadcast addresses. Nmap supports this
through octet range addressing. Rather than specify a normal
IP address, you can specify a comma-separated list of <br>
numbers or ranges for each octet. For example,
192.168.0-255.1-254 will skip all addresses in the range
that end in .0 or .255, and 192.168.3-5,7.1 will scan the
four addresses <br>
192.168.3.1, 192.168.4.1, 192.168.5.1, and 192.168.7.1.
Either side of a range may be omitted; the default values
are 0 on the left and 255 on the right. Using - by itself is
the <br>
same as 0-255, but remember to use 0- in the first octet so
the target specification doesn&rsquo;t look like a
command-line option. Ranges need not be limited to the final
octets: the <br>
specifier 0-255.0-255.13.37 will perform an Internet-wide
scan for all IP addresses ending in 13.37. This sort of
broad sampling can be useful for Internet surveys and
research.</p>

<p style="margin-top: 1em">IPv6 addresses can only be
specified by their fully qualified IPv6 address or hostname.
CIDR and octet ranges aren&rsquo;t yet supported for
IPv6.</p>

<p style="margin-top: 1em">IPv6 addresses with non-global
scope need to have a zone ID suffix. On Unix systems, this
is a percent sign followed by an interface name; a complete
address might be <br>
fe80::a8bb:ccff:fedd:eeff%eth0. On Windows, use an interface
index number in place of an interface name:
fe80::a8bb:ccff:fedd:eeff%1. You can see a list of interface
indexes by <br>
running the command netsh.exe interface ipv6 show
interface.</p>

<p style="margin-top: 1em">Nmap accepts multiple host
specifications on the command line, and they don&rsquo;t
need to be the same type. The command nmap scanme.nmap.org
192.168.0.0/8 10.0.0,1,3-7.- does what <br>
you would expect.</p>

<p style="margin-top: 1em">While targets are usually
specified on the command lines, the following options are
also available to control target selection:</p>

<p style="margin-top: 1em">-iL inputfilename (Input from
list) . <br>
Reads target specifications from inputfilename. Passing a
huge list of hosts is often awkward on the command line, yet
it is a common desire. For example, your DHCP server <br>
might export a list of 10,000 current leases that you wish
to scan. Or maybe you want to scan all IP addresses except
for those to locate hosts using unauthorized static IP <br>
addresses. Simply generate the list of hosts to scan and
pass that filename to Nmap as an argument to the -iL option.
Entries can be in any of the formats accepted by Nmap on
<br>
the command line (IP address, hostname, CIDR, IPv6, or octet
ranges). Each entry must be separated by one or more spaces,
tabs, or newlines. You can specify a hyphen (-) as <br>
the filename if you want Nmap to read hosts from standard
input rather than an actual file.</p>

<p style="margin-top: 1em">The input file may contain
comments that start with # and extend to the end of the
line.</p>

<p style="margin-top: 1em">-iR num hosts (Choose random
targets) . <br>
For Internet-wide surveys and other research, you may want
to choose targets at random. The num hosts argument tells
Nmap how many IPs to generate. Undesirable IPs such as <br>
those in certain private, multicast, or unallocated address
ranges are automatically skipped. The argument 0 can be
specified for a never-ending scan. Keep in mind that some
<br>
network administrators bristle at unauthorized scans of
their networks and may complain. Use this option at your own
risk! If you find yourself really bored one rainy <br>
afternoon, try the command nmap -Pn -sS -p 80 -iR 0 --open.
to locate random web servers for browsing.</p>

<p style="margin-top: 1em">--exclude host1[,host2[,...]]
(Exclude hosts/networks) . <br>
Specifies a comma-separated list of targets to be excluded
from the scan even if they are part of the overall network
range you specify. The list you pass in uses normal Nmap
<br>
syntax, so it can include hostnames, CIDR netblocks, octet
ranges, etc. This can be useful when the network you wish to
scan includes untouchable mission-critical servers, <br>
systems that are known to react adversely to port scans, or
subnets administered by other people.</p>

<p style="margin-top: 1em">--excludefile exclude_file
(Exclude list from file) . <br>
This offers the same functionality as the --exclude option,
except that the excluded targets are provided in a newline-,
space-, or tab-delimited exclude_file rather than on <br>
the command line.</p>

<p style="margin-top: 1em">The exclude file may contain
comments that start with # and extend to the end of the
line.</p>

<p style="margin-top: 1em">HOST DISCOVERY <br>
One of the very first steps in any network reconnaissance
mission is to reduce a (sometimes huge) set of IP ranges
into a list of active or interesting hosts. Scanning every
port <br>
of every single IP address is slow and usually unnecessary.
Of course what makes a host interesting depends greatly on
the scan purposes. Network administrators may only be <br>
interested in hosts running a certain service, while
security auditors may care about every single device with an
IP address. An administrator may be comfortable using just
an <br>
ICMP ping to locate hosts on his internal network, while an
external penetration tester may use a diverse set of dozens
of probes in an attempt to evade firewall restrictions.</p>

<p style="margin-top: 1em">Because host discovery needs are
so diverse, Nmap offers a wide variety of options for
customizing the techniques used. Host discovery is sometimes
called ping scan, but it goes <br>
well beyond the simple ICMP echo request packets associated
with the ubiquitous ping tool. Users can skip the ping step
entirely with a list scan (-sL) or by disabling ping <br>
(-Pn), or engage the network with arbitrary combinations of
multi-port TCP SYN/ACK, UDP, SCTP INIT and ICMP probes. The
goal of these probes is to solicit responses which <br>
demonstrate that an IP address is actually active (is being
used by a host or network device). On many networks, only a
small percentage of IP addresses are active at any given
<br>
time. This is particularly common with private address space
such as 10.0.0.0/8. That network has 16 million IPs, but I
have seen it used by companies with less than a thousand
<br>
machines. Host discovery can find those machines in a
sparsely allocated sea of IP addresses.</p>

<p style="margin-top: 1em">If no host discovery options are
given, Nmap sends an ICMP echo request, a TCP SYN packet to
port 443, a TCP ACK packet to port 80, and an ICMP timestamp
request. (For IPv6, the <br>
ICMP timestamp request is omitted because it is not part of
ICMPv6.) These defaults are equivalent to the -PE -PS443
-PA80 -PP options. The exceptions to this are the ARP (for
<br>
IPv4) and Neighbor Discovery. (for IPv6) scans which are
used for any targets on a local ethernet network. For
unprivileged Unix shell users, the default probes are a SYN
packet <br>
to ports 80 and 443 using the connect system call.. This
host discovery is often sufficient when scanning local
networks, but a more comprehensive set of discovery probes
is <br>
recommended for security auditing.</p>

<p style="margin-top: 1em">The -P* options (which select
ping types) can be combined. You can increase your odds of
penetrating strict firewalls by sending many probe types
using different TCP ports/flags <br>
and ICMP codes. Also note that ARP/Neighbor Discovery (-PR).
is done by default against targets on a local ethernet
network even if you specify other -P* options, because it is
<br>
almost always faster and more effective.</p>

<p style="margin-top: 1em">By default, Nmap does host
discovery and then performs a port scan against each host it
determines is online. This is true even if you specify
non-default host discovery types <br>
such as UDP probes (-PU). Read about the -sn option to learn
how to perform only host discovery, or use -Pn to skip host
discovery and port scan all target hosts. The following <br>
options control host discovery:</p>

<p style="margin-top: 1em">-sL (List Scan) . <br>
The list scan is a degenerate form of host discovery that
simply lists each host of the network(s) specified, without
sending any packets to the target hosts. By default, <br>
Nmap still does reverse-DNS resolution on the hosts to learn
their names. It is often surprising how much useful
information simple hostnames give out. For example, fw.chi
is <br>
the name of one company&rsquo;s Chicago firewall. Nmap also
reports the total number of IP addresses at the end. The
list scan is a good sanity check to ensure that you have
<br>
proper IP addresses for your targets. If the hosts sport
domain names you do not recognize, it is worth investigating
further to prevent scanning the wrong company&rsquo;s
network.</p>

<p style="margin-top: 1em">Since the idea is to simply
print a list of target hosts, options for higher level
functionality such as port scanning, OS detection, or ping
scanning cannot be combined with <br>
this. If you wish to disable ping scanning while still
performing such higher level functionality, read up on the
-Pn (skip ping) option.</p>

<p style="margin-top: 1em">-sn (No port scan) . <br>
This option tells Nmap not to do a port scan after host
discovery, and only print out the available hosts that
responded to the scan. This is often known as a &acirc;ping
scan&acirc;, <br>
but you can also request that traceroute and NSE host
scripts be run. This is by default one step more intrusive
than the list scan, and can often be used for the same <br>
purposes. It allows light reconnaissance of a target network
without attracting much attention. Knowing how many hosts
are up is more valuable to attackers than the list <br>
provided by list scan of every single IP and host name.</p>

<p style="margin-top: 1em">Systems administrators often
find this option valuable as well. It can easily be used to
count available machines on a network or monitor server
availability. This is often <br>
called a ping sweep, and is more reliable than pinging the
broadcast address because many hosts do not reply to
broadcast queries.</p>

<p style="margin-top: 1em">The default host discovery done
with -sn consists of an ICMP echo request, TCP SYN to port
443, TCP ACK to port 80, and an ICMP timestamp request by
default. When executed by <br>
an unprivileged user, only SYN packets are sent (using a
connect call) to ports 80 and 443 on the target. When a
privileged user tries to scan targets on a local ethernet
<br>
network, ARP requests are used unless --send-ip was
specified. The -sn option can be combined with any of the
discovery probe types (the -P* options, excluding -Pn) for
<br>
greater flexibility. If any of those probe type and port
number options are used, the default probes are overridden.
When strict firewalls are in place between the source <br>
host running Nmap and the target network, using those
advanced techniques is recommended. Otherwise hosts could be
missed when the firewall drops probes or their
responses.</p>

<p style="margin-top: 1em">In previous releases of Nmap,
-sn was known as -sP..</p>

<p style="margin-top: 1em">-Pn (No ping) . <br>
This option skips the Nmap discovery stage altogether.
Normally, Nmap uses this stage to determine active machines
for heavier scanning. By default, Nmap only performs heavy
<br>
probing such as port scans, version detection, or OS
detection against hosts that are found to be up. Disabling
host discovery with -Pn causes Nmap to attempt the requested
<br>
scanning functions against every target IP address
specified. So if a class B target address space (/16) is
specified on the command line, all 65,536 IP addresses are
<br>
scanned. Proper host discovery is skipped as with the list
scan, but instead of stopping and printing the target list,
Nmap continues to perform requested functions as if <br>
each target IP is active. To skip ping scan and port scan,
while still allowing NSE to run, use the two options -Pn -sn
together.</p>

<p style="margin-top: 1em">For machines on a local ethernet
network, ARP scanning will still be performed (unless
--disable-arp-ping or --send-ip is specified) because Nmap
needs MAC addresses to <br>
further scan target hosts. In previous versions of Nmap, -Pn
was -P0. and -PN..</p>

<p style="margin-top: 1em">-PS port list (TCP SYN Ping) .
<br>
This option sends an empty TCP packet with the SYN flag set.
The default destination port is 80 (configurable at compile
time by changing DEFAULT_TCP_PROBE_PORT_SPEC. in <br>
nmap.h).. Alternate ports can be specified as a parameter.
The syntax is the same as for the -p except that port type
specifiers like T: are not allowed. Examples are -PS22 <br>
and -PS22-25,80,113,1050,35000. Note that there can be no
space between -PS and the port list. If multiple probes are
specified they will be sent in parallel.</p>

<p style="margin-top: 1em">The SYN flag suggests to the
remote system that you are attempting to establish a
connection. Normally the destination port will be closed,
and a RST (reset) packet sent <br>
back. If the port happens to be open, the target will take
the second step of a TCP three-way-handshake. by responding
with a SYN/ACK TCP packet. The machine running Nmap <br>
then tears down the nascent connection by responding with a
RST rather than sending an ACK packet which would complete
the three-way-handshake and establish a full <br>
connection. The RST packet is sent by the kernel of the
machine running Nmap in response to the unexpected SYN/ACK,
not by Nmap itself.</p>

<p style="margin-top: 1em">Nmap does not care whether the
port is open or closed. Either the RST or SYN/ACK response
discussed previously tell Nmap that the host is available
and responsive.</p>

<p style="margin-top: 1em">On Unix boxes, only the
privileged user root. is generally able to send and receive
raw TCP packets.. For unprivileged users, a workaround is
automatically employed. <br>
whereby the connect system call is initiated against each
target port. This has the effect of sending a SYN packet to
the target host, in an attempt to establish a <br>
connection. If connect returns with a quick success or an
ECONNREFUSED failure, the underlying TCP stack must have
received a SYN/ACK or RST and the host is marked available.
<br>
If the connection attempt is left hanging until a timeout is
reached, the host is marked as down.</p>

<p style="margin-top: 1em">-PA port list (TCP ACK Ping) .
<br>
The TCP ACK ping is quite similar to the just-discussed SYN
ping. The difference, as you could likely guess, is that the
TCP ACK flag is set instead of the SYN flag. Such an <br>
ACK packet purports to be acknowledging data over an
established TCP connection, but no such connection exists.
So remote hosts should always respond with a RST packet,
<br>
disclosing their existence in the process.</p>

<p style="margin-top: 1em">The -PA option uses the same
default port as the SYN probe (80) and can also take a list
of destination ports in the same format. If an unprivileged
user tries this, the <br>
connect workaround discussed previously is used. This
workaround is imperfect because connect is actually sending
a SYN packet rather than an ACK.</p>

<p style="margin-top: 1em">The reason for offering both SYN
and ACK ping probes is to maximize the chances of bypassing
firewalls. Many administrators configure routers and other
simple firewalls to <br>
block incoming SYN packets except for those destined for
public services like the company web site or mail server.
This prevents other incoming connections to the <br>
organization, while allowing users to make unobstructed
outgoing connections to the Internet. This non-stateful
approach takes up few resources on the firewall/router and
is <br>
widely supported by hardware and software filters. The Linux
Netfilter/iptables. firewall software offers the --syn
convenience option to implement this stateless approach.
<br>
When stateless firewall rules such as this are in place, SYN
ping probes (-PS) are likely to be blocked when sent to
closed target ports. In such cases, the ACK probe shines
<br>
as it cuts right through these rules.</p>

<p style="margin-top: 1em">Another common type of firewall
uses stateful rules that drop unexpected packets. This
feature was initially found mostly on high-end firewalls,
though it has become much <br>
more common over the years. The Linux Netfilter/iptables
system supports this through the --state option, which
categorizes packets based on connection state. A SYN probe
is <br>
more likely to work against such a system, as unexpected ACK
packets are generally recognized as bogus and dropped. A
solution to this quandary is to send both SYN and ACK <br>
probes by specifying -PS and -PA.</p>

<p style="margin-top: 1em">-PU port list (UDP Ping) . <br>
Another host discovery option is the UDP ping, which sends a
UDP packet to the given ports. For most ports, the packet
will be empty, though for a few a protocol-specific <br>
payload will be sent that is more likely to get a response..
The --data-length. option can be used to send a fixed-length
random payload to every port or (if you specify a <br>
value of 0) to disable payloads. You can also disable
payloads by specifying --data-length 0.</p>

<p style="margin-top: 1em">The port list takes the same
format as with the previously discussed -PS and -PA options.
If no ports are specified, the default is 40125.. This
default can be configured at <br>
compile-time by changing DEFAULT_UDP_PROBE_PORT_SPEC. in
nmap.h.. A highly uncommon port is used by default because
sending to open ports is often undesirable for this <br>
particular scan type.</p>

<p style="margin-top: 1em">Upon hitting a closed port on
the target machine, the UDP probe should elicit an ICMP port
unreachable packet in return. This signifies to Nmap that
the machine is up and <br>
available. Many other types of ICMP errors, such as
host/network unreachables or TTL exceeded are indicative of
a down or unreachable host. A lack of response is also <br>
interpreted this way. If an open port is reached, most
services simply ignore the empty packet and fail to return
any response. This is why the default probe port is 40125,
<br>
which is highly unlikely to be in use. A few services, such
as the Character Generator (chargen) protocol, will respond
to an empty UDP packet, and thus disclose to Nmap that <br>
the machine is available.</p>

<p style="margin-top: 1em">The primary advantage of this
scan type is that it bypasses firewalls and filters that
only screen TCP. For example, I once owned a Linksys
BEFW11S4 wireless broadband <br>
router. The external interface of this device filtered all
TCP ports by default, but UDP probes would still elicit port
unreachable messages and thus give away the device.</p>

<p style="margin-top: 1em">-PY port list (SCTP INIT Ping) .
<br>
This option sends an SCTP packet containing a minimal INIT
chunk. The default destination port is 80 (configurable at
compile time by changing DEFAULT_SCTP_PROBE_PORT_SPEC. <br>
in nmap.h). Alternate ports can be specified as a parameter.
The syntax is the same as for the -p except that port type
specifiers like S: are not allowed. Examples are -PY22 <br>
and -PY22,80,179,5060. Note that there can be no space
between -PY and the port list. If multiple probes are
specified they will be sent in parallel.</p>

<p style="margin-top: 1em">The INIT chunk suggests to the
remote system that you are attempting to establish an
association. Normally the destination port will be closed,
and an ABORT chunk will be <br>
sent back. If the port happens to be open, the target will
take the second step of an SCTP four-way-handshake. by
responding with an INIT-ACK chunk. If the machine running
<br>
Nmap has a functional SCTP stack, then it tears down the
nascent association by responding with an ABORT chunk rather
than sending a COOKIE-ECHO chunk which would be the next
<br>
step in the four-way-handshake. The ABORT packet is sent by
the kernel of the machine running Nmap in response to the
unexpected INIT-ACK, not by Nmap itself.</p>

<p style="margin-top: 1em">Nmap does not care whether the
port is open or closed. Either the ABORT or INIT-ACK
response discussed previously tell Nmap that the host is
available and responsive.</p>

<p style="margin-top: 1em">On Unix boxes, only the
privileged user root. is generally able to send and receive
raw SCTP packets.. Using SCTP INIT Pings is currently not
possible for unprivileged <br>
users..</p>

<p style="margin-top: 1em">-PE; -PP; -PM (ICMP Ping Types)
. <br>
In addition to the unusual TCP, UDP and SCTP host discovery
types discussed previously, Nmap can send the standard
packets sent by the ubiquitous ping program. Nmap sends an
<br>
ICMP type 8 (echo request) packet to the target IP
addresses, expecting a type 0 (echo reply) in return from
available hosts.. Unfortunately for network explorers, many
<br>
hosts and firewalls now block these packets, rather than
responding as required by RFC 1122[2].. For this reason,
ICMP-only scans are rarely reliable enough against unknown
<br>
targets over the Internet. But for system administrators
monitoring an internal network, they can be a practical and
efficient approach. Use the -PE option to enable this <br>
echo request behavior.</p>

<p style="margin-top: 1em">While echo request is the
standard ICMP ping query, Nmap does not stop there. The ICMP
standards (RFC 792[3]. and RFC 950[4]. &acirc;a host SHOULD
NOT implement these messages&acirc;. <br>
Timestamp and address mask queries can be sent with the -PP
and -PM options, respectively. A timestamp reply (ICMP code
14) or address mask reply (code 18) discloses that the <br>
host is available. These two queries can be valuable when
administrators specifically block echo request packets while
forgetting that other ICMP queries can be used for the <br>
same purpose.</p>

<p style="margin-top: 1em">-PO protocol list (IP Protocol
Ping) . <br>
One of the newer host discovery options is the IP protocol
ping, which sends IP packets with the specified protocol
number set in their IP header. The protocol list takes the
<br>
same format as do port lists in the previously discussed
TCP, UDP and SCTP host discovery options. If no protocols
are specified, the default is to send multiple IP packets
<br>
for ICMP (protocol 1), IGMP (protocol 2), and IP-in-IP
(protocol 4). The default protocols can be configured at
compile-time by changing DEFAULT_PROTO_PROBE_PORT_SPEC. in
<br>
nmap.h. Note that for the ICMP, IGMP, TCP (protocol 6), UDP
(protocol 17) and SCTP (protocol 132), the packets are sent
with the proper protocol headers. while other <br>
protocols are sent with no additional data beyond the IP
header (unless the --data-length. option is specified).</p>

<p style="margin-top: 1em">This host discovery method looks
for either responses using the same protocol as a probe, or
ICMP protocol unreachable messages which signify that the
given protocol isn&rsquo;t <br>
supported on the destination host. Either type of response
signifies that the target host is alive.</p>

<p style="margin-top: 1em">-PR (ARP Ping) . <br>
One of the most common Nmap usage scenarios is to scan an
ethernet LAN. On most LANs, especially those using private
address ranges specified by RFC 1918[5], the vast <br>
majority of IP addresses are unused at any given time. When
Nmap tries to send a raw IP packet such as an ICMP echo
request, the operating system must determine the <br>
destination hardware (ARP) address corresponding to the
target IP so that it can properly address the ethernet
frame. This is often slow and problematic, since operating
<br>
systems weren&rsquo;t written with the expectation that they
would need to do millions of ARP requests against
unavailable hosts in a short time period.</p>

<p style="margin-top: 1em">ARP scan puts Nmap and its
optimized algorithms in charge of ARP requests. And if it
gets a response back, Nmap doesn&rsquo;t even need to worry
about the IP-based ping packets <br>
since it already knows the host is up. This makes ARP scan
much faster and more reliable than IP-based scans. So it is
done by default when scanning ethernet hosts that Nmap <br>
detects are on a local ethernet network. Even if different
ping types (such as -PE or -PS) are specified, Nmap uses ARP
instead for any of the targets which are on the same <br>
LAN. If you absolutely don&rsquo;t want to do an ARP scan,
specify --disable-arp-ping.</p>

<p style="margin-top: 1em">For IPv6 (-6 option), -PR uses
ICMPv6 Neighbor Discovery instead of ARP. Neighbor
Discovery, defined in RFC 4861, can be seen as the IPv6
equivalent of ARP.</p>

<p style="margin-top: 1em">--disable-arp-ping (No ARP or ND
Ping) . <br>
Nmap normally does ARP or IPv6 Neighbor Discovery (ND)
discovery of locally connected ethernet hosts, even if other
host discovery options such as -Pn or -PE are used. To <br>
disable this implicit behavior, use the --disable-arp-ping
option.</p>

<p style="margin-top: 1em">The default behavior is normally
faster, but this option is useful on networks using proxy
ARP, in which a router speculatively replies to all ARP
requests, making every <br>
target appear to be up according to ARP scan.</p>

<p style="margin-top: 1em">--traceroute (Trace path to
host) . <br>
Traceroutes are performed post-scan using information from
the scan results to determine the port and protocol most
likely to reach the target. It works with all scan types
<br>
except connect scans (-sT) and idle scans (-sI). All traces
use Nmap&rsquo;s dynamic timing model and are performed in
parallel.</p>

<p style="margin-top: 1em">Traceroute works by sending
packets with a low TTL (time-to-live) in an attempt to
elicit ICMP Time Exceeded messages from intermediate hops
between the scanner and the <br>
target host. Standard traceroute implementations start with
a TTL of 1 and increment the TTL until the destination host
is reached. Nmap&rsquo;s traceroute starts with a high TTL
<br>
and then decrements the TTL until it reaches zero. Doing it
backwards lets Nmap employ clever caching algorithms to
speed up traces over multiple hosts. On average Nmap sends
<br>
5&acirc;10 fewer packets per host, depending on network
conditions. If a single subnet is being scanned (i.e.
192.168.0.0/24) Nmap may only have to send two packets to
most hosts.</p>

<p style="margin-top: 1em">-n (No DNS resolution) . <br>
Tells Nmap to never do reverse DNS resolution on the active
IP addresses it finds. Since DNS can be slow even with
Nmap&rsquo;s built-in parallel stub resolver, this option
can <br>
slash scanning times.</p>

<p style="margin-top: 1em">-R (DNS resolution for all
targets) . <br>
Tells Nmap to always do reverse DNS resolution on the target
IP addresses. Normally reverse DNS is only performed against
responsive (online) hosts.</p>

<p style="margin-top: 1em">--system-dns (Use system DNS
resolver) . <br>
By default, Nmap resolves IP addresses by sending queries
directly to the name servers configured on your host and
then listening for responses. Many requests (often dozens)
<br>
are performed in parallel to improve performance. Specify
this option to use your system resolver instead (one IP at a
time via the getnameinfo call). This is slower and <br>
rarely useful unless you find a bug in the Nmap parallel
resolver (please let us know if you do). The system resolver
is always used for IPv6 scans.</p>

<p style="margin-top: 1em">--dns-servers
server1[,server2[,...]] (Servers to use for reverse DNS
queries) . <br>
By default, Nmap determines your DNS servers (for rDNS
resolution) from your resolv.conf file (Unix) or the
Registry (Win32). Alternatively, you may use this option to
<br>
specify alternate servers. This option is not honored if you
are using --system-dns or an IPv6 scan. Using multiple DNS
servers is often faster, especially if you choose <br>
authoritative servers for your target IP space. This option
can also improve stealth, as your requests can be bounced
off just about any recursive DNS server on the Internet.</p>

<p style="margin-top: 1em">This option also comes in handy
when scanning private networks. Sometimes only a few name
servers provide proper rDNS information, and you may not
even know where they are. <br>
You can scan the network for port 53 (perhaps with version
detection), then try Nmap list scans (-sL) specifying each
name server one at a time with --dns-servers until you <br>
find one which works.</p>

<p style="margin-top: 1em">PORT SCANNING BASICS <br>
While Nmap has grown in functionality over the years, it
began as an efficient port scanner, and that remains its
core function. The simple command nmap target scans 1,000
TCP <br>
ports on the host target. While many port scanners have
traditionally lumped all ports into the open or closed
states, Nmap is much more granular. It divides ports into
six <br>
states: open, closed, filtered, unfiltered, open|filtered,
or closed|filtered.</p>

<p style="margin-top: 1em">These states are not intrinsic
properties of the port itself, but describe how Nmap sees
them. For example, an Nmap scan from the same network as the
target may show port 135/tcp <br>
as open, while a scan at the same time with the same options
from across the Internet might show that port as
filtered.</p>

<p style="margin-top: 1em">The six port states recognized
by Nmap</p>

<p style="margin-top: 1em">An application is actively
accepting TCP connections, UDP datagrams or SCTP
associations on this port. Finding these is often the
primary goal of port scanning. <br>
Security-minded people know that each open port is an avenue
for attack. Attackers and pen-testers want to exploit the
open ports, while administrators try to close or <br>
protect them with firewalls without thwarting legitimate
users. Open ports are also interesting for non-security
scans because they show services available for use on the
<br>
network.</p>

<p style="margin-top: 1em">A closed port is accessible (it
receives and responds to Nmap probe packets), but there is
no application listening on it. They can be helpful in
showing that a host is up on <br>
an IP address (host discovery, or ping scanning), and as
part of OS detection. Because closed ports are reachable, it
may be worth scanning later in case some open up. <br>
Administrators may want to consider blocking such ports with
a firewall. Then they would appear in the filtered state,
discussed next.</p>

<p style="margin-top: 1em">Nmap cannot determine whether
the port is open because packet filtering prevents its
probes from reaching the port. The filtering could be from a
dedicated firewall device, <br>
router rules, or host-based firewall software. These ports
frustrate attackers because they provide so little
information. Sometimes they respond with ICMP error messages
<br>
such as type 3 code 13 (destination unreachable:
communication administratively prohibited), but filters that
simply drop probes without responding are far more common.
This <br>
forces Nmap to retry several times just in case the probe
was dropped due to network congestion rather than filtering.
This slows down the scan dramatically.</p>

<p style="margin-top: 1em">The unfiltered state means that
a port is accessible, but Nmap is unable to determine
whether it is open or closed. Only the ACK scan, which is
used to map firewall rulesets, <br>
classifies ports into this state. Scanning unfiltered ports
with other scan types such as Window scan, SYN scan, or FIN
scan, may help resolve whether the port is open.</p>

<p style="margin-top: 1em">Nmap places ports in this state
when it is unable to determine whether a port is open or
filtered. This occurs for scan types in which open ports
give no response. The lack <br>
of response could also mean that a packet filter dropped the
probe or any response it elicited. So Nmap does not know for
sure whether the port is open or being filtered. The <br>
UDP, IP protocol, FIN, NULL, and Xmas scans classify ports
this way.</p>

<p style="margin-top: 1em">This state is used when Nmap is
unable to determine whether a port is closed or filtered. It
is only used for the IP ID idle scan.</p>

<p style="margin-top: 1em">PORT SCANNING TECHNIQUES <br>
As a novice performing automotive repair, I can struggle for
hours trying to fit my rudimentary tools (hammer, duct tape,
wrench, etc.) to the task at hand. When I fail miserably
<br>
and tow my jalopy to a real mechanic, he invariably fishes
around in a huge tool chest until pulling out the perfect
gizmo which makes the job seem effortless. The art of port
<br>
scanning is similar. Experts understand the dozens of scan
techniques and choose the appropriate one (or combination)
for a given task. Inexperienced users and script kiddies,.
<br>
on the other hand, try to solve every problem with the
default SYN scan. Since Nmap is free, the only barrier to
port scanning mastery is knowledge. That certainly beats the
<br>
automotive world, where it may take great skill to determine
that you need a strut spring compressor, then you still have
to pay thousands of dollars for it.</p>

<p style="margin-top: 1em">Most of the scan types are only
available to privileged users.. This is because they send
and receive raw packets,. which requires root access on Unix
systems. Using an <br>
administrator account on Windows is recommended, though Nmap
sometimes works for unprivileged users on that platform when
WinPcap has already been loaded into the OS. Requiring <br>
root privileges was a serious limitation when Nmap was
released in 1997, as many users only had access to shared
shell accounts. Now, the world is different. Computers are
<br>
cheaper, far more people have always-on direct Internet
access, and desktop Unix systems (including Linux and Mac OS
X) are prevalent. A Windows version of Nmap is now
available, <br>
allowing it to run on even more desktops. For all these
reasons, users have less need to run Nmap from limited
shared shell accounts. This is fortunate, as the privileged
options <br>
make Nmap far more powerful and flexible.</p>

<p style="margin-top: 1em">While Nmap attempts to produce
accurate results, keep in mind that all of its insights are
based on packets returned by the target machines (or
firewalls in front of them). Such <br>
hosts may be untrustworthy and send responses intended to
confuse or mislead Nmap. Much more common are
non-RFC-compliant hosts that do not respond as they should
to Nmap probes. <br>
FIN, NULL, and Xmas scans are particularly susceptible to
this problem. Such issues are specific to certain scan types
and so are discussed in the individual scan type
entries.</p>

<p style="margin-top: 1em">This section documents the dozen
or so port scan techniques supported by Nmap. Only one
method may be used at a time, except that UDP scan (-sU) and
any one of the SCTP scan <br>
types (-sY, -sZ) may be combined with any one of the TCP
scan types. As a memory aid, port scan type options are of
the form -sC, where C is a prominent character in the scan
<br>
name, usually the first. The one exception to this is the
deprecated FTP bounce scan (-b). By default, Nmap performs a
SYN Scan, though it substitutes a connect scan if the user
<br>
does not have proper privileges to send raw packets
(requires root access on Unix). Of the scans listed in this
section, unprivileged users can only execute connect and FTP
<br>
bounce scans.</p>

<p style="margin-top: 1em">-sS (TCP SYN scan) . <br>
SYN scan is the default and most popular scan option for
good reasons. It can be performed quickly, scanning
thousands of ports per second on a fast network not hampered
by <br>
restrictive firewalls. It is also relatively unobtrusive and
stealthy since it never completes TCP connections. SYN scan
works against any compliant TCP stack rather than <br>
depending on idiosyncrasies of specific platforms as
Nmap&rsquo;s FIN/NULL/Xmas, Maimon and idle scans do. It
also allows clear, reliable differentiation between the
open, closed, <br>
and filtered states.</p>

<p style="margin-top: 1em">This technique is often referred
to as half-open scanning, because you don&rsquo;t open a
full TCP connection. You send a SYN packet, as if you are
going to open a real connection <br>
and then wait for a response. A SYN/ACK indicates the port
is listening (open), while a RST (reset) is indicative of a
non-listener. If no response is received after several <br>
retransmissions, the port is marked as filtered. The port is
also marked filtered if an ICMP unreachable error (type 3,
code 1, 2, 3, 9, 10, or 13) is received. The port is <br>
also considered open if a SYN packet (without the ACK flag)
is received in response. This can be due to an extremely
rare TCP feature known as a simultaneous open or split <br>
handshake connection (see
http://nmap.org/misc/split-handshake.pdf).</p>

<p style="margin-top: 1em">-sT (TCP connect scan) . <br>
TCP connect scan is the default TCP scan type when SYN scan
is not an option. This is the case when a user does not have
raw packet privileges. Instead of writing raw packets <br>
as most other scan types do, Nmap asks the underlying
operating system to establish a connection with the target
machine and port by issuing the connect system call. This is
<br>
the same high-level system call that web browsers, P2P
clients, and most other network-enabled applications use to
establish a connection. It is part of a programming <br>
interface known as the Berkeley Sockets API. Rather than
read raw packet responses off the wire, Nmap uses this API
to obtain status information on each connection attempt.</p>

<p style="margin-top: 1em">When SYN scan is available, it
is usually a better choice. Nmap has less control over the
high level connect call than with raw packets, making it
less efficient. The system <br>
call completes connections to open target ports rather than
performing the half-open reset that SYN scan does. Not only
does this take longer and require more packets to <br>
obtain the same information, but target machines are more
likely to log the connection. A decent IDS will catch
either, but most machines have no such alarm system. Many
<br>
services on your average Unix system will add a note to
syslog, and sometimes a cryptic error message, when Nmap
connects and then closes the connection without sending
data. <br>
Truly pathetic services crash when this happens, though that
is uncommon. An administrator who sees a bunch of connection
attempts in her logs from a single system should <br>
know that she has been connect scanned.</p>

<p style="margin-top: 1em">-sU (UDP scans) . <br>
While most popular services on the Internet run over the TCP
protocol, UDP[6] services are widely deployed. DNS, SNMP,
and DHCP (registered ports 53, 161/162, and 67/68) are <br>
three of the most common. Because UDP scanning is generally
slower and more difficult than TCP, some security auditors
ignore these ports. This is a mistake, as exploitable <br>
UDP services are quite common and attackers certainly
don&rsquo;t ignore the whole protocol. Fortunately, Nmap can
help inventory UDP ports.</p>

<p style="margin-top: 1em">UDP scan is activated with the
-sU option. It can be combined with a TCP scan type such as
SYN scan (-sS) to check both protocols during the same
run.</p>

<p style="margin-top: 1em">UDP scan works by sending a UDP
packet to every targeted port. For some common ports such as
53 and 161, a protocol-specific payload is sent, but for
most ports the packet is <br>
empty.. The --data-length option can be used to send a
fixed-length random payload to every port or (if you specify
a value of 0) to disable payloads. If an ICMP port <br>
unreachable error (type 3, code 3) is returned, the port is
closed. Other ICMP unreachable errors (type 3, codes 1, 2,
9, 10, or 13) mark the port as filtered. Occasionally, <br>
a service will respond with a UDP packet, proving that it is
open. If no response is received after retransmissions, the
port is classified as open|filtered. This means that <br>
the port could be open, or perhaps packet filters are
blocking the communication. Version detection (-sV) can be
used to help differentiate the truly open ports from the
<br>
filtered ones.</p>

<p style="margin-top: 1em">A big challenge with UDP
scanning is doing it quickly. Open and filtered ports rarely
send any response, leaving Nmap to time out and then conduct
retransmissions just in <br>
case the probe or response were lost. Closed ports are often
an even bigger problem. They usually send back an ICMP port
unreachable error. But unlike the RST packets sent by <br>
closed TCP ports in response to a SYN or connect scan, many
hosts rate limit. ICMP port unreachable messages by default.
Linux and Solaris are particularly strict about <br>
this. For example, the Linux 2.4.20 kernel limits
destination unreachable messages to one per second (in
net/ipv4/icmp.c).</p>

<p style="margin-top: 1em">Nmap detects rate limiting and
slows down accordingly to avoid flooding the network with
useless packets that the target machine will drop.
Unfortunately, a Linux-style limit <br>
of one packet per second makes a 65,536-port scan take more
than 18 hours. Ideas for speeding your UDP scans up include
scanning more hosts in parallel, doing a quick scan of <br>
just the popular ports first, scanning from behind the
firewall, and using --host-timeout to skip slow hosts.</p>

<p style="margin-top: 1em">-sY (SCTP INIT scan) . <br>
SCTP[7] is a relatively new alternative to the TCP and UDP
protocols, combining most characteristics of TCP and UDP,
and also adding new features like multi-homing and <br>
multi-streaming. It is mostly being used for SS7/SIGTRAN
related services but has the potential to be used for other
applications as well. SCTP INIT scan is the SCTP <br>
equivalent of a TCP SYN scan. It can be performed quickly,
scanning thousands of ports per second on a fast network not
hampered by restrictive firewalls. Like SYN scan, INIT <br>
scan is relatively unobtrusive and stealthy, since it never
completes SCTP associations. It also allows clear, reliable
differentiation between the open, closed, and filtered <br>
states.</p>

<p style="margin-top: 1em">This technique is often referred
to as half-open scanning, because you don&rsquo;t open a
full SCTP association. You send an INIT chunk, as if you are
going to open a real <br>
association and then wait for a response. An INIT-ACK chunk
indicates the port is listening (open), while an ABORT chunk
is indicative of a non-listener. If no response is <br>
received after several retransmissions, the port is marked
as filtered. The port is also marked filtered if an ICMP
unreachable error (type 3, code 1, 2, 3, 9, 10, or 13) is
<br>
received.</p>

<p style="margin-top: 1em">-sN; -sF; -sX (TCP NULL, FIN,
and Xmas scans) . <br>
These three scan types (even more are possible with the
--scanflags option described in the next section) exploit a
subtle loophole in the TCP RFC[8] to differentiate between
<br>
open and closed ports. Page 65 of RFC 793 says that
&acirc;if the [destination] port state is CLOSED .... an
incoming segment not containing a RST causes a RST to be
sent in <br>
response.&acirc; Then the next page discusses packets sent
to open ports without the SYN, RST, or ACK bits set, stating
that: &acirc;you are unlikely to get here, but if you do,
drop <br>
the segment, and return.&acirc;</p>

<p style="margin-top: 1em">When scanning systems compliant
with this RFC text, any packet not containing SYN, RST, or
ACK bits will result in a returned RST if the port is closed
and no response at all <br>
if the port is open. As long as none of those three bits are
included, any combination of the other three (FIN, PSH, and
URG) are OK. Nmap exploits this with three scan <br>
types:</p>

<p style="margin-top: 1em">Null scan (-sN) <br>
Does not set any bits (TCP flag header is 0)</p>

<p style="margin-top: 1em">FIN scan (-sF) <br>
Sets just the TCP FIN bit.</p>

<p style="margin-top: 1em">Xmas scan (-sX) <br>
Sets the FIN, PSH, and URG flags, lighting the packet up
like a Christmas tree.</p>

<p style="margin-top: 1em">These three scan types are
exactly the same in behavior except for the TCP flags set in
probe packets. If a RST packet is received, the port is
considered closed, while no <br>
response means it is open|filtered. The port is marked
filtered if an ICMP unreachable error (type 3, code 1, 2, 3,
9, 10, or 13) is received.</p>

<p style="margin-top: 1em">The key advantage to these scan
types is that they can sneak through certain non-stateful
firewalls and packet filtering routers. Another advantage is
that these scan types <br>
are a little more stealthy than even a SYN scan. Don&rsquo;t
count on this though&acirc;most modern IDS products can be
configured to detect them. The big downside is that not all
<br>
systems follow RFC 793 to the letter. A number of systems
send RST responses to the probes regardless of whether the
port is open or not. This causes all of the ports to be <br>
labeled closed. Major operating systems that do this are
Microsoft Windows, many Cisco devices, BSDI, and IBM OS/400.
This scan does work against most Unix-based systems <br>
though. Another downside of these scans is that they
can&rsquo;t distinguish open ports from certain filtered
ones, leaving you with the response open|filtered.</p>

<p style="margin-top: 1em">-sA (TCP ACK scan) . <br>
This scan is different than the others discussed so far in
that it never determines open (or even open|filtered) ports.
It is used to map out firewall rulesets, determining <br>
whether they are stateful or not and which ports are
filtered.</p>

<p style="margin-top: 1em">The ACK scan probe packet has
only the ACK flag set (unless you use --scanflags). When
scanning unfiltered systems, open and closed ports will both
return a RST packet. Nmap <br>
then labels them as unfiltered, meaning that they are
reachable by the ACK packet, but whether they are open or
closed is undetermined. Ports that don&rsquo;t respond, or
send <br>
certain ICMP error messages back (type 3, code 1, 2, 3, 9,
10, or 13), are labeled filtered.</p>

<p style="margin-top: 1em">-sW (TCP Window scan) . <br>
Window scan is exactly the same as ACK scan except that it
exploits an implementation detail of certain systems to
differentiate open ports from closed ones, rather than <br>
always printing unfiltered when a RST is returned. It does
this by examining the TCP Window field of the RST packets
returned. On some systems, open ports use a positive <br>
window size (even for RST packets) while closed ones have a
zero window. So instead of always listing a port as
unfiltered when it receives a RST back, Window scan lists
the <br>
port as open or closed if the TCP Window value in that reset
is positive or zero, respectively.</p>

<p style="margin-top: 1em">This scan relies on an
implementation detail of a minority of systems out on the
Internet, so you can&rsquo;t always trust it. Systems that
don&rsquo;t support it will usually return all <br>
ports closed. Of course, it is possible that the machine
really has no open ports. If most scanned ports are closed
but a few common port numbers (such as 22, 25, 53) are <br>
filtered, the system is most likely susceptible.
Occasionally, systems will even show the exact opposite
behavior. If your scan shows 1,000 open ports and three
closed or <br>
filtered ports, then those three may very well be the truly
open ones.</p>

<p style="margin-top: 1em">-sM (TCP Maimon scan) . <br>
The Maimon scan is named after its discoverer, Uriel
Maimon.. He described the technique in Phrack Magazine issue
#49 (November 1996).. Nmap, which included this technique,
<br>
was released two issues later. This technique is exactly the
same as NULL, FIN, and Xmas scans, except that the probe is
FIN/ACK. According to RFC 793[8] (TCP), a RST packet <br>
should be generated in response to such a probe whether the
port is open or closed. However, Uriel noticed that many
BSD-derived systems simply drop the packet if the port is
<br>
open.</p>

<p style="margin-top: 1em">--scanflags (Custom TCP scan) .
<br>
Truly advanced Nmap users need not limit themselves to the
canned scan types offered. The --scanflags option allows you
to design your own scan by specifying arbitrary TCP <br>
flags.. Let your creative juices flow, while evading
intrusion detection systems. whose vendors simply paged
through the Nmap man page adding specific rules!</p>

<p style="margin-top: 1em">The --scanflags argument can be
a numerical flag value such as 9 (PSH and FIN), but using
symbolic names is easier. Just mash together any combination
of URG, ACK, PSH, RST, <br>
SYN, and FIN. For example, --scanflags URGACKPSHRSTSYNFIN
sets everything, though it&rsquo;s not very useful for
scanning. The order these are specified in is
irrelevant.</p>

<p style="margin-top: 1em">In addition to specifying the
desired flags, you can specify a TCP scan type (such as -sA
or -sF). That base type tells Nmap how to interpret
responses. For example, a SYN <br>
scan considers no-response to indicate a filtered port,
while a FIN scan treats the same as open|filtered. Nmap will
behave the same way it does for the base scan type, <br>
except that it will use the TCP flags you specify instead.
If you don&rsquo;t specify a base type, SYN scan is
used.</p>

<p style="margin-top: 1em">-sZ (SCTP COOKIE ECHO scan) .
<br>
SCTP COOKIE ECHO scan is a more advanced SCTP scan. It takes
advantage of the fact that SCTP implementations should
silently drop packets containing COOKIE ECHO chunks on <br>
open ports, but send an ABORT if the port is closed. The
advantage of this scan type is that it is not as obvious a
port scan than an INIT scan. Also, there may be <br>
non-stateful firewall rulesets blocking INIT chunks, but not
COOKIE ECHO chunks. Don&rsquo;t be fooled into thinking that
this will make a port scan invisible; a good IDS will be
<br>
able to detect SCTP COOKIE ECHO scans too. The downside is
that SCTP COOKIE ECHO scans cannot differentiate between
open and filtered ports, leaving you with the state <br>
open|filtered in both cases.</p>

<p style="margin-top: 1em">-sI zombie host[:probeport]
(idle scan) . <br>
This advanced scan method allows for a truly blind TCP port
scan of the target (meaning no packets are sent to the
target from your real IP address). Instead, a unique <br>
side-channel attack exploits predictable IP fragmentation ID
sequence generation on the zombie host to glean information
about the open ports on the target. IDS systems will <br>
display the scan as coming from the zombie machine you
specify (which must be up and meet certain criteria). This
fascinating scan type is too complex to fully describe in
<br>
this reference guide, so I wrote and posted an informal
paper with full details at
http://nmap.org/book/idlescan.html.</p>

<p style="margin-top: 1em">Besides being extraordinarily
stealthy (due to its blind nature), this scan type permits
mapping out IP-based trust relationships between machines.
The port listing shows <br>
open ports from the perspective of the zombie host. So you
can try scanning a target using various zombies that you
think might be trusted. (via router/packet filter <br>
rules).</p>

<p style="margin-top: 1em">You can add a colon followed by
a port number to the zombie host if you wish to probe a
particular port on the zombie for IP ID changes. Otherwise
Nmap will use the port it <br>
uses by default for TCP pings (80).</p>

<p style="margin-top: 1em">-sO (IP protocol scan) . <br>
IP protocol scan allows you to determine which IP protocols
(TCP, ICMP, IGMP, etc.) are supported by target machines.
This isn&rsquo;t technically a port scan, since it cycles
<br>
through IP protocol numbers rather than TCP or UDP port
numbers. Yet it still uses the -p option to select scanned
protocol numbers, reports its results within the normal <br>
port table format, and even uses the same underlying scan
engine as the true port scanning methods. So it is close
enough to a port scan that it belongs here.</p>

<p style="margin-top: 1em">Besides being useful in its own
right, protocol scan demonstrates the power of open-source
software. While the fundamental idea is pretty simple, I had
not thought to add it <br>
nor received any requests for such functionality. Then in
the summer of 2000, Gerhard Rieger. conceived the idea,
wrote an excellent patch implementing it, and sent it to
<br>
the announce mailing list. (then called nmap-hackers).. I
incorporated that patch into the Nmap tree and released a
new version the next day. Few pieces of commercial <br>
software have users enthusiastic enough to design and
contribute their own improvements!</p>

<p style="margin-top: 1em">Protocol scan works in a similar
fashion to UDP scan. Instead of iterating through the port
number field of a UDP packet, it sends IP packet headers and
iterates through the <br>
eight-bit IP protocol field. The headers are usually empty,
containing no data and not even the proper header for the
claimed protocol. The exceptions are TCP, UDP, ICMP, <br>
SCTP, and IGMP. A proper protocol header for those is
included since some systems won&rsquo;t send them otherwise
and because Nmap already has functions to create them.
Instead of <br>
watching for ICMP port unreachable messages, protocol scan
is on the lookout for ICMP protocol unreachable messages. If
Nmap receives any response in any protocol from the <br>
target host, Nmap marks that protocol as open. An ICMP
protocol unreachable error (type 3, code 2) causes the
protocol to be marked as closed Other ICMP unreachable
errors <br>
(type 3, code 1, 3, 9, 10, or 13) cause the protocol to be
marked filtered (though they prove that ICMP is open at the
same time). If no response is received after <br>
retransmissions, the protocol is marked open|filtered</p>

<p style="margin-top: 1em">-b FTP relay host (FTP bounce
scan) . <br>
An interesting feature of the FTP protocol (RFC 959[9]) is
support for so-called proxy FTP connections. This allows a
user to connect to one FTP server, then ask that files <br>
be sent to a third-party server. Such a feature is ripe for
abuse on many levels, so most servers have ceased supporting
it. One of the abuses this feature allows is causing <br>
the FTP server to port scan other hosts. Simply ask the FTP
server to send a file to each interesting port of a target
host in turn. The error message will describe whether <br>
the port is open or not. This is a good way to bypass
firewalls because organizational FTP servers are often
placed where they have more access to other internal hosts
than <br>
any old Internet host would. Nmap supports FTP bounce scan
with the -b option. It takes an argument of the form
username:password@server:port. Server is the name or IP <br>
address of a vulnerable FTP server. As with a normal URL,
you may omit username:password, in which case anonymous
login credentials (user: anonymous password:-wwwuser@) are
<br>
used. The port number (and preceding colon) may be omitted
as well, in which case the default FTP port (21) on server
is used.</p>

<p style="margin-top: 1em">This vulnerability was
widespread in 1997 when Nmap was released, but has largely
been fixed. Vulnerable servers are still around, so it is
worth trying when all else fails. <br>
If bypassing a firewall is your goal, scan the target
network for port 21 (or even for any FTP services if you
scan all ports with version detection) and use the
ftp-bounce. <br>
NSE script. Nmap will tell you whether the host is
vulnerable or not. If you are just trying to cover your
tracks, you don&rsquo;t need to (and, in fact,
shouldn&rsquo;t) limit yourself <br>
to hosts on the target network. Before you go scanning
random Internet addresses for vulnerable FTP servers,
consider that sysadmins may not appreciate you abusing their
<br>
servers in this way.</p>

<p style="margin-top: 1em">PORT SPECIFICATION AND SCAN
ORDER <br>
In addition to all of the scan methods discussed previously,
Nmap offers options for specifying which ports are scanned
and whether the scan order is randomized or sequential. By
<br>
default, Nmap scans the most common 1,000 ports for each
protocol.</p>

<p style="margin-top: 1em">-p port ranges (Only scan
specified ports) . <br>
This option specifies which ports you want to scan and
overrides the default. Individual port numbers are OK, as
are ranges separated by a hyphen (e.g. 1-1023). The <br>
beginning and/or end values of a range may be omitted,
causing Nmap to use 1 and 65535, respectively. So you can
specify -p- to scan ports from 1 through 65535. Scanning
port <br>
zero. is allowed if you specify it explicitly. For IP
protocol scanning (-sO), this option specifies the protocol
numbers you wish to scan for (0&acirc;255).</p>

<p style="margin-top: 1em">When scanning a combination of
protocols (e.g. TCP and UDP), you can specify a particular
protocol by preceding the port numbers by T: for TCP, U: for
UDP, S: for SCTP, or P: <br>
for IP Protocol. The qualifier lasts until you specify
another qualifier. For example, the argument -p
U:53,111,137,T:21-25,80,139,8080 would scan UDP ports 53,
111,and 137, <br>
as well as the listed TCP ports. Note that to scan both UDP
and TCP, you have to specify -sU and at least one TCP scan
type (such as -sS, -sF, or -sT). If no protocol <br>
qualifier is given, the port numbers are added to all
protocol lists. Ports can also be specified by name
according to what the port is referred to in the
nmap-services. You <br>
can even use the wildcards * and ? with the names. For
example, to scan FTP and all ports whose names begin with
&acirc;http&acirc;, use -p ftp,http*. Be careful about shell
expansions <br>
and quote the argument to -p if unsure.</p>

<p style="margin-top: 1em">Ranges of ports can be
surrounded by square brackets to indicate ports inside that
range that appear in nmap-services. For example, the
following will scan all ports in <br>
nmap-services equal to or below 1024: -p [-1024]. Be careful
with shell expansions and quote the argument to -p if
unsure.</p>

<p style="margin-top: 1em">-F (Fast (limited port) scan) .
<br>
Specifies that you wish to scan fewer ports than the
default. Normally Nmap scans the most common 1,000 ports for
each scanned protocol. With -F, this is reduced to 100.</p>

<p style="margin-top: 1em">Nmap needs an nmap-services file
with frequency information in order to know which ports are
the most common. If port frequency information isn&rsquo;t
available, perhaps because <br>
of the use of a custom nmap-services file, Nmap scans all
named ports plus ports 1-1024. In that case, -F means to
scan only ports that are named in the services file.</p>

<p style="margin-top: 1em">-r (Don&rsquo;t randomize ports)
. <br>
By default, Nmap randomizes the scanned port order (except
that certain commonly accessible ports are moved near the
beginning for efficiency reasons). This randomization is
<br>
normally desirable, but you can specify -r for sequential
(sorted from lowest to highest) port scanning instead.</p>

<p style="margin-top: 1em">--port-ratio ratio&lt;decimal
number between 0 and 1&gt; <br>
Scans all ports in nmap-services file with a ratio greater
than the one given. ratio must be between 0.0 and 1.1.</p>

<p style="margin-top: 1em">--top-ports n <br>
Scans the n highest-ratio ports found in nmap-services file.
n must be 1 or greater.</p>

<p style="margin-top: 1em">SERVICE AND VERSION DETECTION
<br>
Point Nmap at a remote machine and it might tell you that
ports 25/tcp, 80/tcp, and 53/udp are open. Using its
nmap-services. database of about 2,200 well-known services,.
Nmap <br>
would report that those ports probably correspond to a mail
server (SMTP), web server (HTTP), and name server (DNS)
respectively. This lookup is usually accurate&acirc;the vast
<br>
majority of daemons listening on TCP port 25 are, in fact,
mail servers. However, you should not bet your security on
this! People can and do run services on strange ports..</p>

<p style="margin-top: 1em">Even if Nmap is right, and the
hypothetical server above is running SMTP, HTTP, and DNS
servers, that is not a lot of information. When doing
vulnerability assessments (or even <br>
simple network inventories) of your companies or clients,
you really want to know which mail and DNS servers and
versions are running. Having an accurate version number
helps <br>
dramatically in determining which exploits a server is
vulnerable to. Version detection helps you obtain this
information.</p>

<p style="margin-top: 1em">After TCP and/or UDP ports are
discovered using one of the other scan methods, version
detection interrogates those ports to determine more about
what is actually running. The <br>
nmap-service-probes. database contains probes for querying
various services and match expressions to recognize and
parse responses. Nmap tries to determine the service
protocol <br>
(e.g. FTP, SSH, Telnet, HTTP), the application name (e.g.
ISC BIND, Apache httpd, Solaris telnetd), the version
number, hostname, device type (e.g. printer, router), the OS
<br>
family (e.g. Windows, Linux). When possible, Nmap also gets
the Common Platform Enumeration (CPE). representation of
this information. Sometimes miscellaneous details like <br>
whether an X server is open to connections, the SSH protocol
version, or the KaZaA user name, are available. Of course,
most services don&rsquo;t provide all of this information.
If <br>
Nmap was compiled with OpenSSL support, it will connect to
SSL servers to deduce the service listening behind that
encryption layer.. Some UDP ports are left in the <br>
open|filtered state after a UDP port scan is unable to
determine whether the port is open or filtered. Version
detection will try to elicit a response from these ports
(just as <br>
it does with open ports), and change the state to open if it
succeeds. open|filtered TCP ports are treated the same way.
Note that the Nmap -A option enables version detection <br>
among other things. A paper documenting the workings, usage,
and customization of version detection is available at
http://nmap.org/book/vscan.html.</p>

<p style="margin-top: 1em">When RPC services are
discovered, the Nmap RPC grinder. is automatically used to
determine the RPC program and version numbers. It takes all
the TCP/UDP ports detected as RPC <br>
and floods them with SunRPC program NULL commands in an
attempt to determine whether they are RPC ports, and if so,
what program and version number they serve up. Thus you can
<br>
effectively obtain the same info as rpcinfo -p even if the
target&rsquo;s portmapper is behind a firewall (or protected
by TCP wrappers). Decoys do not currently work with RPC
scan..</p>

<p style="margin-top: 1em">When Nmap receives responses
from a service but cannot match them to its database, it
prints out a special fingerprint and a URL for you to submit
if to if you know for sure what <br>
is running on the port. Please take a couple minutes to make
the submission so that your find can benefit everyone.
Thanks to these submissions, Nmap has about 6,500 pattern
<br>
matches for more than 650 protocols such as SMTP, FTP, HTTP,
etc..</p>

<p style="margin-top: 1em">Version detection is enabled and
controlled with the following options:</p>

<p style="margin-top: 1em">-sV (Version detection) . <br>
Enables version detection, as discussed above.
Alternatively, you can use -A, which enables version
detection among other things.</p>

<p style="margin-top: 1em">-sR. is an alias for -sV. Prior
to March 2011, it was used to active the RPC grinder
separately from version detection, but now these options are
always combined.</p>

<p style="margin-top: 1em">--allports (Don&rsquo;t exclude
any ports from version detection) . <br>
By default, Nmap version detection skips TCP port 9100
because some printers simply print anything sent to that
port, leading to dozens of pages of HTTP GET requests,
binary <br>
SSL session requests, etc. This behavior can be changed by
modifying or removing the Exclude directive in
nmap-service-probes, or you can specify --allports to scan
all ports <br>
regardless of any Exclude directive.</p>

<p style="margin-top: 1em">--version-intensity intensity
(Set version scan intensity) . <br>
When performing a version scan (-sV), Nmap sends a series of
probes, each of which is assigned a rarity value between one
and nine. The lower-numbered probes are effective <br>
against a wide variety of common services, while the
higher-numbered ones are rarely useful. The intensity level
specifies which probes should be applied. The higher the
<br>
number, the more likely it is the service will be correctly
identified. However, high intensity scans take longer. The
intensity must be between 0 and 9.. The default is 7.. <br>
When a probe is registered to the target port via the
nmap-service-probesports directive, that probe is tried
regardless of intensity level. This ensures that the DNS
probes <br>
will always be attempted against any open port 53, the SSL
probe will be done against 443, etc.</p>

<p style="margin-top: 1em">--version-light (Enable light
mode) . <br>
This is a convenience alias for --version-intensity 2. This
light mode makes version scanning much faster, but it is
slightly less likely to identify services.</p>

<p style="margin-top: 1em">--version-all (Try every single
probe) . <br>
An alias for --version-intensity 9, ensuring that every
single probe is attempted against each port.</p>

<p style="margin-top: 1em">--version-trace (Trace version
scan activity) . <br>
This causes Nmap to print out extensive debugging info about
what version scanning is doing. It is a subset of what you
get with --packet-trace.</p>

<p style="margin-top: 1em">OS DETECTION <br>
One of Nmap&rsquo;s best-known features is remote OS
detection using TCP/IP stack fingerprinting. Nmap sends a
series of TCP and UDP packets to the remote host and
examines practically <br>
every bit in the responses. After performing dozens of tests
such as TCP ISN sampling, TCP options support and ordering,
IP ID sampling, and the initial window size check, Nmap <br>
compares the results to its nmap-os-db. database of more
than 2,600 known OS fingerprints and prints out the OS
details if there is a match. Each fingerprint includes a
freeform <br>
textual description of the OS, and a classification which
provides the vendor name (e.g. Sun), underlying OS (e.g.
Solaris), OS generation (e.g. 10), and device type (general
<br>
purpose, router, switch, game console, etc). Most
fingerprints also have a Common Platform Enumeration (CPE).
representation, like cpe:/o:linux:linux_kernel:2.6.</p>

<p style="margin-top: 1em">If Nmap is unable to guess the
OS of a machine, and conditions are good (e.g. at least one
open port and one closed port were found), Nmap will provide
a URL you can use to <br>
submit the fingerprint if you know (for sure) the OS running
on the machine. By doing this you contribute to the pool of
operating systems known to Nmap and thus it will be more
<br>
accurate for everyone.</p>

<p style="margin-top: 1em">OS detection enables some other
tests which make use of information that is gathered during
the process anyway. One of these is TCP Sequence
Predictability Classification. This <br>
measures approximately how hard it is to establish a forged
TCP connection against the remote host. It is useful for
exploiting source-IP based trust relationships (rlogin, <br>
firewall filters, etc) or for hiding the source of an
attack. This sort of spoofing is rarely performed any more,
but many machines are still vulnerable to it. The actual
<br>
difficulty number is based on statistical sampling and may
fluctuate. It is generally better to use the English
classification such as &acirc;worthy challenge&acirc; or
&acirc;trivial joke&acirc;. This <br>
is only reported in normal output in verbose (-v) mode. When
verbose mode is enabled along with -O, IP ID sequence
generation is also reported. Most machines are in the <br>
&acirc;incremental&acirc; class, which means that they
increment the ID field in the IP header for each packet they
send. This makes them vulnerable to several advanced
information gathering <br>
and spoofing attacks.</p>

<p style="margin-top: 1em">Another bit of extra information
enabled by OS detection is a guess at a target&rsquo;s
uptime. This uses the TCP timestamp option (RFC 1323[10]) to
guess when a machine was last <br>
rebooted. The guess can be inaccurate due to the timestamp
counter not being initialized to zero or the counter
overflowing and wrapping around, so it is printed only in
verbose <br>
mode.</p>

<p style="margin-top: 1em">A paper documenting the
workings, usage, and customization of OS detection is
available at http://nmap.org/book/osdetect.html.</p>

<p style="margin-top: 1em">OS detection is enabled and
controlled with the following options:</p>

<p style="margin-top: 1em">-O (Enable OS detection) . <br>
Enables OS detection, as discussed above. Alternatively, you
can use -A to enable OS detection along with other
things.</p>

<p style="margin-top: 1em">--osscan-limit (Limit OS
detection to promising targets) . <br>
OS detection is far more effective if at least one open and
one closed TCP port are found. Set this option and Nmap will
not even try OS detection against hosts that do not <br>
meet this criteria. This can save substantial time,
particularly on -Pn scans against many hosts. It only
matters when OS detection is requested with -O or -A.</p>

<p style="margin-top: 1em">--osscan-guess; --fuzzy (Guess
OS detection results) . <br>
When Nmap is unable to detect a perfect OS match, it
sometimes offers up near-matches as possibilities. The match
has to be very close for Nmap to do this by default. Either
<br>
of these (equivalent) options make Nmap guess more
aggressively. Nmap will still tell you when an imperfect
match is printed and display its confidence level
(percentage) for <br>
each guess.</p>

<p style="margin-top: 1em">--max-os-tries (Set the maximum
number of OS detection tries against a target) . <br>
When Nmap performs OS detection against a target and fails
to find a perfect match, it usually repeats the attempt. By
default, Nmap tries five times if conditions are <br>
favorable for OS fingerprint submission, and twice when
conditions aren&rsquo;t so good. Specifying a lower
--max-os-tries value (such as 1) speeds Nmap up, though you
miss out on <br>
retries which could potentially identify the OS.
Alternatively, a high value may be set to allow even more
retries when conditions are favorable. This is rarely done,
except <br>
to generate better fingerprints for submission and
integration into the Nmap OS database.</p>

<p style="margin-top: 1em">NMAP SCRIPTING ENGINE (NSE) <br>
The Nmap Scripting Engine (NSE) is one of Nmap&rsquo;s most
powerful and flexible features. It allows users to write
(and share) simple scripts (using the Lua programming
language[11],</p>

<p style="margin-top: 1em">Tasks we had in mind when
creating the system include network discovery, more
sophisticated version detection, vulnerability detection.
NSE can even be used for vulnerability <br>
exploitation.</p>

<p style="margin-top: 1em">To reflect those different uses
and to simplify the choice of which scripts to run, each
script contains a field associating it with one or more
categories. Currently defined <br>
categories are auth, broadcast, default. discovery, dos,
exploit, external, fuzzer, intrusive, malware, safe,
version, and vuln. These are all described at <br>
http://nmap.org/book/nse-usage.html#nse-categories.</p>

<p style="margin-top: 1em">Scripts are not run in a sandbox
and thus could accidentally or maliciously damage your
system or invade your privacy. Never run scripts from third
parties unless you trust the <br>
authors or have carefully audited the scripts yourself.</p>

<p style="margin-top: 1em">The Nmap Scripting Engine is
described in detail at http://nmap.org/book/nse.html and is
controlled by the following options:</p>

<p style="margin-top: 1em">-sC . <br>
Performs a script scan using the default set of scripts. It
is equivalent to --script=default. Some of the scripts in
this category are considered intrusive and should not be
<br>
run against a target network without permission.</p>

<p style="margin-top: 1em">--script
filename|category|directory|expression[,...] . <br>
Runs a script scan using the comma-separated list of
filenames, script categories, and directories. Each element
in the list may also be a Boolean expression describing a
<br>
more complex set of scripts. Each element is interpreted
first as an expression, then as a category, and finally as a
file or directory name.</p>

<p style="margin-top: 1em">There are two special features
for advanced users only. One is to prefix script names and
expressions with + to force them to run even if they
normally wouldn&rsquo;t (e.g. the <br>
relevant service wasn&rsquo;t detected on the target port).
The other is that the argument all may be used to specify
every script in Nmap&rsquo;s database. Be cautious with this
because <br>
NSE contains dangerous scripts such as exploits, brute force
authentication crackers, and denial of service attacks.</p>

<p style="margin-top: 1em">File and directory names may be
relative or absolute. Absolute names are used directly.
Relative paths are looked for in the scripts of each of the
following places until <br>
found: --datadir <br>
$NMAPDIR. <br>
~/.nmap (not searched on Windows). <br>
HOME0Datanly on Windows). <br>
the directory containing the nmap executable <br>
the directory containing the nmap executable, followed by
../share/nmap <br>
NMAPDATADIR. <br>
the current directory.</p>

<p style="margin-top: 1em">When a directory name is given,
Nmap loads every file in the directory whose name ends with
.nse. All other files are ignored and directories are not
searched recursively. When a <br>
filename is given, it does not have to have the .nse
extension; it will be added automatically if necessary. Nmap
scripts are stored in a scripts subdirectory of the Nmap
data <br>
directory by default (see
http://nmap.org/book/data-files.html). For efficiency,
scripts are indexed in a database stored in
scripts/script.db,. which lists the category or <br>
categories in which each script belongs. When referring to
scripts from script.db by name, you can use a shell-style
&acirc;*&acirc; wildcard.</p>

<p style="margin-top: 1em">nmap --script &quot;http-*&quot;
<br>
Loads all scripts whose name starts with http-, such as
http-auth and http-open-proxy. The argument to --script had
to be in quotes to protect the wildcard from the shell.</p>

<p style="margin-top: 1em">More complicated script
selection can be done using the and, or, and not operators
to build Boolean expressions. The operators have the same
precedence[12] as in Lua: not is the <br>
highest, followed by and and then or. You can alter
precedence by using parentheses. Because expressions contain
space characters it is necessary to quote them.</p>

<p style="margin-top: 1em">nmap --script &quot;not
intrusive&quot; <br>
Loads every script except for those in the intrusive
category.</p>

<p style="margin-top: 1em">nmap --script &quot;default or
safe&quot; <br>
This is functionally equivalent to nmap --script
&quot;default,safe&quot;. It loads all scripts that are in
the default category or the safe category or both.</p>

<p style="margin-top: 1em">nmap --script &quot;default and
safe&quot; <br>
Loads those scripts that are in both the default and safe
categories.</p>

<p style="margin-top: 1em">nmap --script &quot;(default or
safe or intrusive) and not http-*&quot; <br>
Loads scripts in the default, safe, or intrusive categories,
except for those whose names start with http-.</p>

<p style="margin-top: 1em">--script-args
n1=v1,n2={n3=v3},n4={v4,v5} . <br>
Lets you provide arguments to NSE scripts. Arguments are a
comma-separated list of name=value pairs. Names and values
may be strings not containing whitespace or the <br>
characters &acirc;{&acirc;, &acirc;}&acirc;,
&acirc;=&acirc;, or &acirc;,&acirc;. To include one of these
characters in a string, enclose the string in single or
double quotes. Within a quoted string, &acirc;&acirc;
escapes a quote. <br>
A backslash is only used to escape quotation marks in this
special case; in all other cases a backslash is interpreted
literally. Values may also be tables enclosed in {}, <br>
just as in Lua. A table may contain simple string values or
more name-value pairs, including nested tables. Many scripts
qualify their arguments with the script name, as in <br>
xmpp-info.server_name. You may use that full qualified
version to affect just the specified script, or you may pass
the unqualified version (server_name in this case) to <br>
affect all scripts using that argument name. A script will
first check for its fully qualified argument name (the name
specified in its documentation) before it accepts an <br>
unqualified argument name. A complex example of script
arguments is --script-args
&rsquo;user=foo,pass=&quot;,{}=bar&quot;,whois={whodb=nofollow+ripe},xmpp-info.server_name=localhost&rsquo;.
The <br>
online NSE Documentation Portal at http://nmap.org/nsedoc/
lists the arguments that each script accepts.</p>

<p style="margin-top: 1em">--script-args-file filename .
<br>
Lets you load arguments to NSE scripts from a file. Any
arguments on the command line supersede ones in the file.
The file can be an absolute path, or a path relative to <br>
Nmap&rsquo;s usual search path (NMAPDIR, etc.) Arguments can
be comma-separated or newline-separated, but otherwise
follow the same rules as for --script-args, without
requiring <br>
special quoting and escaping, since they are not parsed by
the shell.</p>

<p style="margin-top: 1em">--script-help
filename|category|directory|expression|all[,...] . <br>
Shows help about scripts. For each script matching the given
specification, Nmap prints the script name, its categories,
and its description. The specifications are the same <br>
as those accepted by --script; so for example if you want
help about the ftp-anon script, you would run nmap
--script-help ftp-anon. In addition to getting help for <br>
individual scripts, you can use this as a preview of what
scripts will be run for a specification, for example with
nmap --script-help default.</p>

<p style="margin-top: 1em">--script-trace . <br>
This option does what --packet-trace does, just one ISO
layer higher. If this option is specified all incoming and
outgoing communication performed by a script is printed.
<br>
The displayed information includes the communication
protocol, the source, the target and the transmitted data.
If more than 5% of all transmitted data is not printable,
then <br>
the trace output is in a hex dump format. Specifying
--packet-trace enables script tracing too.</p>

<p style="margin-top: 1em">--script-updatedb . <br>
This option updates the script database found in
scripts/script.db which is used by Nmap to determine the
available default scripts and categories. It is only
necessary to <br>
update the database if you have added or removed NSE scripts
from the default scripts directory or if you have changed
the categories of any script. This option is generally <br>
used by itself: nmap --script-updatedb.</p>

<p style="margin-top: 1em">TIMING AND PERFORMANCE <br>
One of my highest Nmap development priorities has always
been performance. A default scan (nmap hostname) of a host
on my local network takes a fifth of a second. That is
barely <br>
enough time to blink, but adds up when you are scanning
hundreds or thousands of hosts. Moreover, certain scan
options such as UDP scanning and version detection can
increase <br>
scan times substantially. So can certain firewall
configurations, particularly response rate limiting. While
Nmap utilizes parallelism and many advanced algorithms to
accelerate <br>
these scans, the user has ultimate control over how Nmap
runs. Expert users carefully craft Nmap commands to obtain
only the information they care about while meeting their
time <br>
constraints.</p>

<p style="margin-top: 1em">Techniques for improving scan
times include omitting non-critical tests, and upgrading to
the latest version of Nmap (performance enhancements are
made frequently). Optimizing <br>
timing parameters can also make a substantial difference.
Those options are listed below.</p>

<p style="margin-top: 1em">Some options accept a time
parameter. This is specified in seconds by default, though
you can append &acirc;ms&acirc;, &acirc;s&acirc;,
&acirc;m&acirc;, or &acirc;h&acirc; to the value to specify
milliseconds, seconds, <br>
minutes, or hours. So the --host-timeout arguments 900000ms,
900, 900s, and 15m all do the same thing.</p>

<p style="margin-top: 1em">--min-hostgroup numhosts;
--max-hostgroup numhosts (Adjust parallel scan group sizes)
. <br>
Nmap has the ability to port scan or version scan multiple
hosts in parallel. Nmap does this by dividing the target IP
space into groups and then scanning one group at a <br>
time. In general, larger groups are more efficient. The
downside is that host results can&rsquo;t be provided until
the whole group is finished. So if Nmap started out with a
group <br>
size of 50, the user would not receive any reports (except
for the updates offered in verbose mode) until the first 50
hosts are completed.</p>

<p style="margin-top: 1em">By default, Nmap takes a
compromise approach to this conflict. It starts out with a
group size as low as five so the first results come quickly
and then increases the <br>
groupsize to as high as 1024. The exact default numbers
depend on the options given. For efficiency reasons, Nmap
uses larger group sizes for UDP or few-port TCP scans.</p>

<p style="margin-top: 1em">When a maximum group size is
specified with --max-hostgroup, Nmap will never exceed that
size. Specify a minimum size with --min-hostgroup and Nmap
will try to keep group <br>
sizes above that level. Nmap may have to use smaller groups
than you specify if there are not enough target hosts left
on a given interface to fulfill the specified minimum. <br>
Both may be set to keep the group size within a specific
range, though this is rarely desired.</p>

<p style="margin-top: 1em">These options do not have an
effect during the host discovery phase of a scan. This
includes plain ping scans (-sn). Host discovery always works
in large groups of hosts to <br>
improve speed and accuracy.</p>

<p style="margin-top: 1em">The primary use of these options
is to specify a large minimum group size so that the full
scan runs more quickly. A common choice is 256 to scan a
network in Class C sized <br>
chunks. For a scan with many ports, exceeding that number is
unlikely to help much. For scans of just a few port numbers,
host group sizes of 2048 or more may be helpful.</p>

<p style="margin-top: 1em">--min-parallelism numprobes;
--max-parallelism numprobes (Adjust probe parallelization) .
<br>
These options control the total number of probes that may be
outstanding for a host group. They are used for port
scanning and host discovery. By default, Nmap calculates an
<br>
ever-changing ideal parallelism based on network
performance. If packets are being dropped, Nmap slows down
and allows fewer outstanding probes. The ideal probe number
slowly <br>
rises as the network proves itself worthy. These options
place minimum or maximum bounds on that variable. By
default, the ideal parallelism can drop to one if the
network <br>
proves unreliable and rise to several hundred in perfect
conditions.</p>

<p style="margin-top: 1em">The most common usage is to set
--min-parallelism to a number higher than one to speed up
scans of poorly performing hosts or networks. This is a
risky option to play with, <br>
as setting it too high may affect accuracy. Setting this
also reduces Nmap&rsquo;s ability to control parallelism
dynamically based on network conditions. A value of 10 might
be <br>
reasonable, though I only adjust this value as a last
resort.</p>

<p style="margin-top: 1em">The --max-parallelism option is
sometimes set to one to prevent Nmap from sending more than
one probe at a time to hosts. The --scan-delay option,
discussed later, is another <br>
way to do this.</p>

<p style="margin-top: 1em">--min-rtt-timeout time,
--max-rtt-timeout time, --initial-rtt-timeout time (Adjust
probe timeouts) . <br>
Nmap maintains a running timeout value for determining how
long it will wait for a probe response before giving up or
retransmitting the probe. This is calculated based on <br>
the response times of previous probes.</p>

<p style="margin-top: 1em">If the network latency shows
itself to be significant and variable, this timeout can grow
to several seconds. It also starts at a conservative (high)
level and may stay that <br>
way for a while when Nmap scans unresponsive hosts.</p>

<p style="margin-top: 1em">Specifying a lower
--max-rtt-timeout and --initial-rtt-timeout than the
defaults can cut scan times significantly. This is
particularly true for pingless (-Pn) scans, and <br>
those against heavily filtered networks. Don&rsquo;t get too
aggressive though. The scan can end up taking longer if you
specify such a low value that many probes are timing out
<br>
and retransmitting while the response is in transit.</p>

<p style="margin-top: 1em">If all the hosts are on a local
network, 100 milliseconds (--max-rtt-timeout 100ms) is a
reasonable aggressive value. If routing is involved, ping a
host on the network first <br>
with the ICMP ping utility, or with a custom packet crafter
such as Nping. that is more likely to get through a
firewall. Look at the maximum round trip time out of ten
<br>
packets or so. You might want to double that for the
--initial-rtt-timeout and triple or quadruple it for the
--max-rtt-timeout. I generally do not set the maximum RTT
below <br>
100 ms, no matter what the ping times are. Nor do I exceed
1000 ms.</p>

<p style="margin-top: 1em">--min-rtt-timeout is a rarely
used option that could be useful when a network is so
unreliable that even Nmap&rsquo;s default is too aggressive.
Since Nmap only reduces the timeout <br>
down to the minimum when the network seems to be reliable,
this need is unusual and should be reported as a bug to the
nmap-dev mailing list..</p>

<p style="margin-top: 1em">--max-retries numtries (Specify
the maximum number of port scan probe retransmissions) .
<br>
When Nmap receives no response to a port scan probe, it
could mean the port is filtered. Or maybe the probe or
response was simply lost on the network. It is also possible
<br>
that the target host has rate limiting enabled that
temporarily blocked the response. So Nmap tries again by
retransmitting the initial probe. If Nmap detects poor
network <br>
reliability, it may try many more times before giving up on
a port. While this benefits accuracy, it also lengthen scan
times. When performance is critical, scans may be sped <br>
up by limiting the number of retransmissions allowed. You
can even specify --max-retries 0 to prevent any
retransmissions, though that is only recommended for
situations such <br>
as informal surveys where occasional missed ports and hosts
are acceptable.</p>

<p style="margin-top: 1em">The default (with no -T
template) is to allow ten retransmissions. If a network
seems reliable and the target hosts aren&rsquo;t rate
limiting, Nmap usually only does one <br>
retransmission. So most target scans aren&rsquo;t even
affected by dropping --max-retries to a low value such as
three. Such values can substantially speed scans of slow
(rate <br>
limited) hosts. You usually lose some information when Nmap
gives up on ports early, though that may be preferable to
letting the --host-timeout expire and losing all <br>
information about the target.</p>

<p style="margin-top: 1em">--host-timeout time (Give up on
slow target hosts) . <br>
Some hosts simply take a long time to scan. This may be due
to poorly performing or unreliable networking hardware or
software, packet rate limiting, or a restrictive <br>
firewall. The slowest few percent of the scanned hosts can
eat up a majority of the scan time. Sometimes it is best to
cut your losses and skip those hosts initially. Specify <br>
--host-timeout with the maximum amount of time you are
willing to wait. For example, specify 30m to ensure that
Nmap doesn&rsquo;t waste more than half an hour on a single
host. <br>
Note that Nmap may be scanning other hosts at the same time
during that half an hour, so it isn&rsquo;t a complete loss.
A host that times out is skipped. No port table, OS <br>
detection, or version detection results are printed for that
host.</p>

<p style="margin-top: 1em">--scan-delay time;
--max-scan-delay time (Adjust delay between probes) . <br>
This option causes Nmap to wait at least the given amount of
time between each probe it sends to a given host. This is
particularly useful in the case of rate limiting.. <br>
Solaris machines (among many others) will usually respond to
UDP scan probe packets with only one ICMP message per
second. Any more than that sent by Nmap will be wasteful. A
<br>
--scan-delay of 1s will keep Nmap at that slow rate. Nmap
tries to detect rate limiting and adjust the scan delay
accordingly, but it doesn&rsquo;t hurt to specify it
explicitly if <br>
you already know what rate works best.</p>

<p style="margin-top: 1em">When Nmap adjusts the scan delay
upward to cope with rate limiting, the scan slows down
dramatically. The --max-scan-delay option specifies the
largest delay that Nmap will <br>
allow. A low --max-scan-delay can speed up Nmap, but it is
risky. Setting this value too low can lead to wasteful
packet retransmissions and possible missed ports when the
<br>
target implements strict rate limiting.</p>

<p style="margin-top: 1em">Another use of --scan-delay is
to evade threshold based intrusion detection and prevention
systems (IDS/IPS)..</p>

<p style="margin-top: 1em">--min-rate number; --max-rate
number (Directly control the scanning rate) . <br>
Nmap&rsquo;s dynamic timing does a good job of finding an
appropriate speed at which to scan. Sometimes, however, you
may happen to know an appropriate scanning rate for a
network, <br>
or you may have to guarantee that a scan will be finished by
a certain time. Or perhaps you must keep Nmap from scanning
too quickly. The --min-rate and --max-rate options <br>
are designed for these situations.</p>

<p style="margin-top: 1em">When the --min-rate option is
given Nmap will do its best to send packets as fast as or
faster than the given rate. The argument is a positive real
number representing a <br>
packet rate in packets per second. For example, specifying
--min-rate 300 means that Nmap will try to keep the sending
rate at or above 300 packets per second. Specifying a <br>
minimum rate does not keep Nmap from going faster if
conditions warrant.</p>

<p style="margin-top: 1em">Likewise, --max-rate limits a
scan&rsquo;s sending rate to a given maximum. Use --max-rate
100, for example, to limit sending to 100 packets per second
on a fast network. Use <br>
--max-rate 0.1 for a slow scan of one packet every ten
seconds. Use --min-rate and --max-rate together to keep the
rate inside a certain range.</p>

<p style="margin-top: 1em">These two options are global,
affecting an entire scan, not individual hosts. They only
affect port scans and host discovery scans. Other features
like OS detection implement <br>
their own timing.</p>

<p style="margin-top: 1em">There are two conditions when
the actual scanning rate may fall below the requested
minimum. The first is if the minimum is faster than the
fastest rate at which Nmap can <br>
send, which is dependent on hardware. In this case Nmap will
simply send packets as fast as possible, but be aware that
such high rates are likely to cause a loss of <br>
accuracy. The second case is when Nmap has nothing to send,
for example at the end of a scan when the last probes have
been sent and Nmap is waiting for them to time out or <br>
be responded to. It&rsquo;s normal to see the scanning rate
drop at the end of a scan or in between hostgroups. The
sending rate may temporarily exceed the maximum to make up
for <br>
unpredictable delays, but on average the rate will stay at
or below the maximum.</p>

<p style="margin-top: 1em">Specifying a minimum rate should
be done with care. Scanning faster than a network can
support may lead to a loss of accuracy. In some cases, using
a faster rate can make a <br>
scan take longer than it would with a slower rate. This is
because Nmap&rsquo;s adaptive retransmission algorithms will
detect the network congestion caused by an excessive <br>
scanning rate and increase the number of retransmissions in
order to improve accuracy. So even though packets are sent
at a higher rate, more packets are sent overall. Cap <br>
the number of retransmissions with the --max-retries option
if you need to set an upper limit on total scan time.</p>

<p style="margin-top: 1em">--defeat-rst-ratelimit . <br>
Many hosts have long used rate limiting. to reduce the
number of ICMP error messages (such as port-unreachable
errors) they send. Some systems now apply similar rate
limits <br>
to the RST (reset) packets they generate. This can slow Nmap
down dramatically as it adjusts its timing to reflect those
rate limits. You can tell Nmap to ignore those rate <br>
limits (for port scans such as SYN scan which don&rsquo;t
treat non-responsive ports as open) by specifying
--defeat-rst-ratelimit.</p>

<p style="margin-top: 1em">Using this option can reduce
accuracy, as some ports will appear non-responsive because
Nmap didn&rsquo;t wait long enough for a rate-limited RST
response. With a SYN scan, the <br>
non-response results in the port being labeled filtered
rather than the closed state we see when RST packets are
received. This option is useful when you only care about
open <br>
ports, and distinguishing between closed and filtered ports
isn&rsquo;t worth the extra time.</p>

<p style="margin-top: 1em">--nsock-engine
epoll|kqueue|poll|select . <br>
Enforce use of a given nsock IO multiplexing engine. Only
the select(2)-based fallback engine is guaranteed to be
available on your system. Engines are named after the name
<br>
of the IO management facility they leverage. Engines
currenty implemented are epoll, kqueue, poll, and select,
but not all will be present on any platform. Use nmap -V to
see <br>
which engines are supported.</p>

<p style="margin-top: 1em">-T
paranoid|sneaky|polite|normal|aggressive|insane (Set a
timing template) . <br>
While the fine-grained timing controls discussed in the
previous section are powerful and effective, some people
find them confusing. Moreover, choosing the appropriate <br>
values can sometimes take more time than the scan you are
trying to optimize. So Nmap offers a simpler approach, with
six timing templates. You can specify them with the -T <br>
option and their number (0&acirc;5) or their name. The
template names are paranoid (0), sneaky (1), polite (2),
normal (3), aggressive (4), and insane (5). The first two
are for <br>
IDS evasion. Polite mode slows down the scan to use less
bandwidth and target machine resources. Normal mode is the
default and so -T3 does nothing. Aggressive mode speeds <br>
scans up by making the assumption that you are on a
reasonably fast and reliable network. Finally insane mode.
assumes that you are on an extraordinarily fast network or
are <br>
willing to sacrifice some accuracy for speed.</p>

<p style="margin-top: 1em">These templates allow the user
to specify how aggressive they wish to be, while leaving
Nmap to pick the exact timing values. The templates also
make some minor speed <br>
adjustments for which fine-grained control options do not
currently exist. For example, -T4. prohibits the dynamic
scan delay from exceeding 10 ms for TCP ports and -T5 caps
<br>
that value at 5 ms. Templates can be used in combination
with fine-grained controls, and the fine-grained controls
will you specify will take precedence over the timing <br>
template default for that parameter. I recommend using -T4
when scanning reasonably modern and reliable networks. Keep
that option even when you add fine-grained controls so <br>
that you benefit from those extra minor optimizations that
it enables.</p>

<p style="margin-top: 1em">If you are on a decent broadband
or ethernet connection, I would recommend always using -T4.
Some people love -T5 though it is too aggressive for my
taste. People sometimes <br>
specify -T2 because they think it is less likely to crash
hosts or because they consider themselves to be polite in
general. They often don&rsquo;t realize just how slow -T
polite. <br>
really is. Their scan may take ten times longer than a
default scan. Machine crashes and bandwidth problems are
rare with the default timing options (-T3) and so I normally
<br>
recommend that for cautious scanners. Omitting version
detection is far more effective than playing with timing
values at reducing these problems.</p>

<p style="margin-top: 1em">While -T0. and -T1. may be
useful for avoiding IDS alerts, they will take an
extraordinarily long time to scan thousands of machines or
ports. For such a long scan, you may <br>
prefer to set the exact timing values you need rather than
rely on the canned -T0 and -T1 values.</p>

<p style="margin-top: 1em">The main effects of T0 are
serializing the scan so only one port is scanned at a time,
and waiting five minutes between sending each probe. T1 and
T2 are similar but they <br>
only wait 15 seconds and 0.4 seconds, respectively, between
probes. T3 is Nmap&rsquo;s default behavior, which includes
parallelization.. does the equivalent of --max-rtt-timeout
<br>
1250ms --initial-rtt-timeout 500ms --max-retries 6 and sets
the maximum TCP scan delay to 10 milliseconds. T5 does the
equivalent of --max-rtt-timeout 300ms <br>
--min-rtt-timeout 50ms --initial-rtt-timeout 250ms
--max-retries 2 --host-timeout 15m as well as setting the
maximum TCP scan delay to 5 ms.</p>

<p style="margin-top: 1em">FIREWALL/IDS EVASION AND
SPOOFING <br>
Many Internet pioneers envisioned a global open network with
a universal IP address space allowing virtual connections
between any two nodes. This allows hosts to act as true <br>
peers, serving and retrieving information from each other.
People could access all of their home systems from work,
changing the climate control settings or unlocking the doors
<br>
for early guests. This vision of universal connectivity has
been stifled by address space shortages and security
concerns. In the early 1990s, organizations began deploying
<br>
firewalls for the express purpose of reducing connectivity.
Huge networks were cordoned off from the unfiltered Internet
by application proxies, network address translation, and
<br>
packet filters. The unrestricted flow of information gave
way to tight regulation of approved communication channels
and the content that passes over them.</p>

<p style="margin-top: 1em">Network obstructions such as
firewalls can make mapping a network exceedingly difficult.
It will not get any easier, as stifling casual
reconnaissance is often a key goal of <br>
implementing the devices. Nevertheless, Nmap offers many
features to help understand these complex networks, and to
verify that filters are working as intended. It even
supports <br>
mechanisms for bypassing poorly implemented defenses. One of
the best methods of understanding your network security
posture is to try to defeat it. Place yourself in the <br>
mind-set of an attacker, and deploy techniques from this
section against your networks. Launch an FTP bounce scan,
idle scan, fragmentation attack, or try to tunnel through
one <br>
of your own proxies.</p>

<p style="margin-top: 1em">In addition to restricting
network activity, companies are increasingly monitoring
traffic with intrusion detection systems (IDS). All of the
major IDSs ship with rules designed <br>
to detect Nmap scans because scans are sometimes a precursor
to attacks. Many of these products have recently morphed
into intrusion prevention systems (IPS). that actively <br>
block traffic deemed malicious. Unfortunately for network
administrators and IDS vendors, reliably detecting bad
intentions by analyzing packet data is a tough problem.
Attackers <br>
with patience, skill, and the help of certain Nmap options
can usually pass by IDSs undetected. Meanwhile,
administrators must cope with large numbers of false
positive results <br>
where innocent activity is misdiagnosed and alerted on or
blocked.</p>

<p style="margin-top: 1em">Occasionally people suggest that
Nmap should not offer features for evading firewall rules or
sneaking past IDSs. They argue that these features are just
as likely to be misused <br>
by attackers as used by administrators to enhance security.
The problem with this logic is that these methods would
still be used by attackers, who would just find other tools
or <br>
patch the functionality into Nmap. Meanwhile, administrators
would find it that much harder to do their jobs. Deploying
only modern, patched FTP servers is a far more powerful <br>
defense than trying to prevent the distribution of tools
implementing the FTP bounce attack.</p>

<p style="margin-top: 1em">There is no magic bullet (or
Nmap option) for detecting and subverting firewalls and IDS
systems. It takes skill and experience. A tutorial is beyond
the scope of this reference <br>
guide, which only lists the relevant options and describes
what they do.</p>

<p style="margin-top: 1em">-f (fragment packets); --mtu
(using the specified MTU) . <br>
The -f option causes the requested scan (including ping
scans) to use tiny fragmented IP packets. The idea is to
split up the TCP header over several packets to make it <br>
harder for packet filters, intrusion detection systems, and
other annoyances to detect what you are doing. Be careful
with this! Some programs have trouble handling these <br>
tiny packets. The old-school sniffer named Sniffit
segmentation faulted immediately upon receiving the first
fragment. Specify this option once, and Nmap splits the
packets <br>
into eight bytes or less after the IP header. So a 20-byte
TCP header would be split into three packets. Two with eight
bytes of the TCP header, and one with the final four. <br>
Of course each fragment also has an IP header. Specify -f
again to use 16 bytes per fragment (reducing the number of
fragments).. Or you can specify your own offset size <br>
with the --mtu option. Don&rsquo;t also specify -f if you
use --mtu. The offset must be a multiple of eight. While
fragmented packets won&rsquo;t get by packet filters and
firewalls that <br>
queue all IP fragments, such as the CONFIG_IP_ALWAYS_DEFRAG
option in the Linux kernel, some networks can&rsquo;t afford
the performance hit this causes and thus leave it disabled.
<br>
Others can&rsquo;t enable this because fragments may take
different routes into their networks. Some source systems
defragment outgoing packets in the kernel. Linux with the
<br>
iptables. connection tracking module is one such example. Do
a scan while a sniffer such as Wireshark. is running to
ensure that sent packets are fragmented. If your host <br>
OS is causing problems, try the --send-eth. option to bypass
the IP layer and send raw ethernet frames.</p>

<p style="margin-top: 1em">Fragmentation is only supported
for Nmap&rsquo;s raw packet features, which includes TCP and
UDP port scans (except connect scan and FTP bounce scan) and
OS detection. Features <br>
such as version detection and the Nmap Scripting Engine
generally don&rsquo;t support fragmentation because they
rely on your host&rsquo;s TCP stack to communicate with
target services.</p>

<p style="margin-top: 1em">-D decoy1[,decoy2][,ME][,...]
(Cloak a scan with decoys) . <br>
Causes a decoy scan to be performed, which makes it appear
to the remote host that the host(s) you specify as decoys
are scanning the target network too. Thus their IDS might
<br>
report 5&acirc;10 port scans from unique IP addresses, but
they won&rsquo;t know which IP was scanning them and which
were innocent decoys. While this can be defeated through
router path <br>
tracing, response-dropping, and other active mechanisms, it
is generally an effective technique for hiding your IP
address.</p>

<p style="margin-top: 1em">Separate each decoy host with
commas, and you can optionally use ME. as one of the decoys
to represent the position for your real IP address. If you
put ME in the sixth <br>
position or later, some common port scan detectors (such as
Solar Designer&rsquo;s. excellent Scanlogd). are unlikely to
show your IP address at all. If you don&rsquo;t use ME, Nmap
<br>
will put you in a random position. You can also use RND. to
generate a random, non-reserved IP address, or RND:number to
generate number addresses.</p>

<p style="margin-top: 1em">Note that the hosts you use as
decoys should be up or you might accidentally SYN flood your
targets. Also it will be pretty easy to determine which host
is scanning if only <br>
one is actually up on the network. You might want to use IP
addresses instead of names (so the decoy networks
don&rsquo;t see you in their nameserver logs).</p>

<p style="margin-top: 1em">Decoys are used both in the
initial ping scan (using ICMP, SYN, ACK, or whatever) and
during the actual port scanning phase. Decoys are also used
during remote OS detection <br>
(-O). Decoys do not work with version detection or TCP
connect scan. When a scan delay is in effect, the delay is
enforced between each batch of spoofed probes, not between
<br>
each individual probe. Because decoys are sent as a batch
all at once, they may temporarily violate congestion control
limits.</p>

<p style="margin-top: 1em">It is worth noting that using
too many decoys may slow your scan and potentially even make
it less accurate. Also, some ISPs will filter out your
spoofed packets, but many do <br>
not restrict spoofed IP packets at all.</p>

<p style="margin-top: 1em">-S IP_Address (Spoof source
address) . <br>
In some circumstances, Nmap may not be able to determine
your source address (Nmap will tell you if this is the
case). In this situation, use -S with the IP address of the
<br>
interface you wish to send packets through.</p>

<p style="margin-top: 1em">Another possible use of this
flag is to spoof the scan to make the targets think that
someone else is scanning them. Imagine a company being
repeatedly port scanned by a <br>
competitor! The -e option and -Pn are generally required for
this sort of usage. Note that you usually won&rsquo;t
receive reply packets back (they will be addressed to the IP
you <br>
are spoofing), so Nmap won&rsquo;t produce useful
reports.</p>

<p style="margin-top: 1em">-e interface (Use specified
interface) . <br>
Tells Nmap what interface to send and receive packets on.
Nmap should be able to detect this automatically, but it
will tell you if it cannot.</p>

<p style="margin-top: 1em">--source-port portnumber; -g
portnumber (Spoof source port number) . <br>
One surprisingly common misconfiguration is to trust traffic
based only on the source port number. It is easy to
understand how this comes about. An administrator will set
up <br>
a shiny new firewall, only to be flooded with complaints
from ungrateful users whose applications stopped working. In
particular, DNS may be broken because the UDP DNS <br>
replies from external servers can no longer enter the
network. FTP is another common example. In active FTP
transfers, the remote server tries to establish a connection
back <br>
to the client to transfer the requested file.</p>

<p style="margin-top: 1em">Secure solutions to these
problems exist, often in the form of application-level
proxies or protocol-parsing firewall modules. Unfortunately
there are also easier, insecure <br>
solutions. Noting that DNS replies come from port 53 and
active FTP from port 20, many administrators have fallen
into the trap of simply allowing incoming traffic from those
<br>
ports. They often assume that no attacker would notice and
exploit such firewall holes. In other cases, administrators
consider this a short-term stop-gap measure until they <br>
can implement a more secure solution. Then they forget the
security upgrade.</p>

<p style="margin-top: 1em">Overworked network
administrators are not the only ones to fall into this trap.
Numerous products have shipped with these insecure rules.
Even Microsoft has been guilty. The <br>
IPsec filters that shipped with Windows 2000 and Windows XP
contain an implicit rule that allows all TCP or UDP traffic
from port 88 (Kerberos). In another well-known case, <br>
versions of the Zone Alarm personal firewall up to 2.1.25
allowed any incoming UDP packets with the source port 53
(DNS) or 67 (DHCP).</p>

<p style="margin-top: 1em">Nmap offers the -g and
--source-port options (they are equivalent) to exploit these
weaknesses. Simply provide a port number and Nmap will send
packets from that port where <br>
possible. Most scanning operations that use raw sockets,
including SYN and UDP scans, support the option completely.
The option notably doesn&rsquo;t have an effect for any <br>
operations that use normal operating system sockets,
including DNS requests, TCP connect scan,. version
detection, and script scanning. Setting the source port also
doesn&rsquo;t <br>
work for OS detection, because Nmap must use different port
numbers for certain OS detection tests to work properly.</p>

<p style="margin-top: 1em">--data-length number (Append
random data to sent packets) . <br>
Normally Nmap sends minimalist packets containing only a
header. So its TCP packets are generally 40 bytes and ICMP
echo requests are just 28. Some UDP ports. and IP <br>
protocols. get a custom payload by default. This option
tells Nmap to append the given number of random bytes to
most of the packets it sends, and not to use any <br>
protocol-specific payloads. (Use --data-length 0 for no
random or protocol-specific payloads.. OS detection (-O)
packets are not affected. because accuracy there requires
<br>
probe consistency, but most pinging and portscan packets
support this. It slows things down a little, but can make a
scan slightly less conspicuous.</p>

<p style="margin-top: 1em">--ip-options S|R [route]|L
[route]|T|U ... ; --ip-options hex string (Send packets with
specified ip options) . <br>
The IP protocol[13] offers several options which may be
placed in packet headers. Unlike the ubiquitous TCP options,
IP options are rarely seen due to practicality and <br>
security concerns. In fact, many Internet routers block the
most dangerous options such as source routing. Yet options
can still be useful in some cases for determining and <br>
manipulating the network route to target machines. For
example, you may be able to use the record route option to
determine a path to a target even when more traditional <br>
traceroute-style approaches fail. Or if your packets are
being dropped by a certain firewall, you may be able to
specify a different route with the strict or loose source
<br>
routing options.</p>

<p style="margin-top: 1em">The most powerful way to specify
IP options is to simply pass in values as the argument to
--ip-options. Precede each hex number with then the two
digits. You may repeat <br>
certain characters by following them with an asterisk and
then the number of times you wish them to repeat. For
example, 1740*361 is a hex string containing 36 <br>
NUL bytes.</p>

<p style="margin-top: 1em">Nmap also offers a shortcut
mechanism for specifying options. Simply pass the letter R,
T, or U to request record-route,. record-timestamp,. or both
options together, <br>
respectively. Loose or strict source routing. may be
specified with an L or S followed by a space and then a
space-separated list of IP addresses.</p>

<p style="margin-top: 1em">If you wish to see the options
in packets sent and received, specify --packet-trace. For
more information and examples of using IP options with Nmap,
see <br>
http://seclists.org/nmap-dev/2006/q3/52.</p>

<p style="margin-top: 1em">--ttl value (Set IP time-to-live
field) . <br>
Sets the IPv4 time-to-live field in sent packets to the
given value.</p>

<p style="margin-top: 1em">--randomize-hosts (Randomize
target host order) . <br>
Tells Nmap to shuffle each group of up to 16384 hosts before
it scans them. This can make the scans less obvious to
various network monitoring systems, especially when you <br>
combine it with slow timing options. If you want to
randomize over larger group sizes, increase PING_GROUP_SZ.
in nmap.h. and recompile. An alternative solution is to <br>
generate the target IP list with a list scan (-sL -n -oN
filename), randomize it with a Perl script, then provide the
whole list to Nmap with -iL..</p>

<p style="margin-top: 1em">--spoof-mac MAC address, prefix,
or vendor name (Spoof MAC address) . <br>
Asks Nmap to use the given MAC address for all of the raw
ethernet frames it sends. This option implies --send-eth. to
ensure that Nmap actually sends ethernet-level <br>
packets. The MAC given can take several formats. If it is
simply the number 0, Nmap chooses a completely random MAC
address for the session. If the given string is an even <br>
number of hex digits (with the pairs optionally separated by
a colon), Nmap will use those as the MAC. If fewer than 12
hex digits are provided, Nmap fills in the remainder <br>
of the six bytes with random values. If the argument
isn&rsquo;t a zero or hex string, Nmap looks through
nmap-mac-prefixes to find a vendor name containing the given
string (it is <br>
case insensitive). If a match is found, Nmap uses the
vendor&rsquo;s OUI (three-byte prefix). and fills out the
remaining three bytes randomly. Valid --spoof-mac argument
examples <br>
are Apple, 0, 01:02:03:04:05:06, deadbeefcafe, 0020F2, and
Cisco. This option only affects raw packet scans such as SYN
scan or OS detection, not connection-oriented features <br>
such as version detection or the Nmap Scripting Engine.</p>

<p style="margin-top: 1em">--badsum (Send packets with
bogus TCP/UDP checksums) . <br>
Asks Nmap to use an invalid TCP, UDP or SCTP checksum for
packets sent to target hosts. Since virtually all host IP
stacks properly drop these packets, any responses received
<br>
are likely coming from a firewall or IDS that didn&rsquo;t
bother to verify the checksum. For more details on this
technique, see http://nmap.org/p60-12.html</p>

<p style="margin-top: 1em">--adler32 (Use deprecated
Adler32 instead of CRC32C for SCTP checksums) . <br>
Asks Nmap to use the deprecated Adler32 algorithm for
calculating the SCTP checksum. If --adler32 is not given,
CRC-32C (Castagnoli) is used. RFC 2960[14] originally
defined <br>
Adler32 as checksum algorithm for SCTP; RFC 4960[7] later
redefined the SCTP checksums to use CRC-32C. Current SCTP
implementations should be using CRC-32C, but in order to
<br>
elicit responses from old, legacy SCTP implementations, it
may be preferable to use Adler32.</p>

<p style="margin-top: 1em">OUTPUT <br>
Any security tool is only as useful as the output it
generates. Complex tests and algorithms are of little value
if they aren&rsquo;t presented in an organized and
comprehensible <br>
fashion. Given the number of ways Nmap is used by people and
other software, no single format can please everyone. So
Nmap offers several formats, including the interactive mode
<br>
for humans to read directly and XML for easy parsing by
software.</p>

<p style="margin-top: 1em">In addition to offering
different output formats, Nmap provides options for
controlling the verbosity of output as well as debugging
messages. Output types may be sent to <br>
standard output or to named files, which Nmap can append to
or clobber. Output files may also be used to resume aborted
scans.</p>

<p style="margin-top: 1em">Nmap makes output available in
five different formats. The default is called interactive
output,. and it is sent to standard output (stdout).. There
is also normal output,. <br>
which is similar to interactive except that it displays less
runtime information and warnings since it is expected to be
analyzed after the scan completes rather than <br>
interactively.</p>

<p style="margin-top: 1em">XML output. is one of the most
important output types, as it can be converted to HTML,
easily parsed by programs such as Nmap graphical user
interfaces, or imported into <br>
databases.</p>

<p style="margin-top: 1em">The two remaining output types
are the simple grepable output. which includes most
information for a target host on a single line, and sCRiPt
KiDDi3 0utPUt. for users who <br>
consider themselves |&lt;-r4d.</p>

<p style="margin-top: 1em">While interactive output is the
default and has no associated command-line options, the
other four format options use the same syntax. They take one
argument, which is the <br>
filename that results should be stored in. Multiple formats
may be specified, but each format may only be specified
once. For example, you may wish to save normal output for
your <br>
own review while saving XML of the same scan for
programmatic analysis. You might do this with the options
-oX myscan.xml -oN myscan.nmap. While this chapter uses the
simple <br>
names like myscan.xml for brevity, more descriptive names
are generally recommended. The names chosen are a matter of
personal preference, though I use long ones that incorporate
<br>
the scan date and a word or two describing the scan, placed
in a directory named after the company I&rsquo;m
scanning.</p>

<p style="margin-top: 1em">While these options save results
to files, Nmap still prints interactive output to stdout as
usual. For example, the command nmap -oX myscan.xml target
prints XML to myscan.xml <br>
and fills standard output with the same interactive results
it would have printed if -oX wasn&rsquo;t specified at all.
You can change this by passing a hyphen character as the
<br>
argument to one of the format types. This causes Nmap to
deactivate interactive output, and instead print results in
the format you specified to the standard output stream. So
<br>
the command nmap -oX - target will send only XML output to
stdout.. Serious errors may still be printed to the normal
error stream, stderr..</p>

<p style="margin-top: 1em">Unlike some Nmap arguments, the
space between the logfile option flag (such as -oX) and the
filename or hyphen is mandatory. If you omit the flags and
give arguments such as -oG- <br>
or -oXscan.xml, a backwards compatibility feature of Nmap
will cause the creation of normal format output files named
G- and Xscan.xml respectively.</p>

<p style="margin-top: 1em">All of these arguments support
strftime-like. conversions in the filename. %H, %M, %S, %m,
%d, %y, and %Y are all exactly the same as in strftime. %T
is the same as %H%M%S, %R <br>
is the same as %H%M, and %D is the same as %m%d%y. A %
followed by any other character just yields that character
(%% gives you a percent symbol). So -oX
&rsquo;scan-%T-%D.xml&rsquo; will <br>
use an XML file with a name in the form of
scan-144840-121307.xml.</p>

<p style="margin-top: 1em">Nmap also offers options to
control scan verbosity and to append to output files rather
than clobbering them. All of these options are described
below.</p>

<p style="margin-top: 1em">Nmap Output Formats</p>

<p style="margin-top: 1em">-oN filespec (normal output) .
<br>
Requests that normal output be directed to the given
filename. As discussed above, this differs slightly from
interactive output.</p>

<p style="margin-top: 1em">-oX filespec (XML output) . <br>
Requests that XML output be directed to the given filename.
Nmap includes a document type definition (DTD) which allows
XML parsers to validate Nmap XML output. While it is <br>
primarily intended for programmatic use, it can also help
humans interpret Nmap XML output. The DTD defines the legal
elements of the format, and often enumerates the <br>
attributes and values they can take on. The latest version
is always available from
https://svn.nmap.org/nmap/docs/nmap.dtd.</p>

<p style="margin-top: 1em">XML offers a stable format that
is easily parsed by software. Free XML parsers are available
for all major computer languages, including C/C++, Perl,
Python, and Java. People <br>
have even written bindings for most of these languages to
handle Nmap output and execution specifically. Examples are
Nmap::Scanner[15]. and Nmap::Parser[16]. in Perl CPAN. <br>
In almost all cases that a non-trivial application
interfaces with Nmap, XML is the preferred format.</p>

<p style="margin-top: 1em">The XML output references an XSL
stylesheet which can be used to format the results as HTML.
The easiest way to use this is simply to load the XML output
in a web browser <br>
such as Firefox or IE. By default, this will only work on
the machine you ran Nmap on (or a similarly configured one)
due to the hard-coded nmap.xsl filesystem path. Use the <br>
--webxml or --stylesheet options to create portable XML
files that render as HTML on any web-connected machine.</p>

<p style="margin-top: 1em">-oS filespec (ScRipT KIdd|3
oUTpuT) . <br>
Script kiddie output is like interactive output, except that
it is post-processed to better suit the l33t HaXXorZ who
previously looked down on Nmap due to its consistent <br>
capitalization and spelling. Humor impaired people should
note that this option is making fun of the script kiddies
before flaming me for supposedly &acirc;helping
them&acirc;.</p>

<p style="margin-top: 1em">-oG filespec (grepable output) .
<br>
This output format is covered last because it is deprecated.
The XML output format is far more powerful, and is nearly as
convenient for experienced users. XML is a standard <br>
for which dozens of excellent parsers are available, while
grepable output is my own simple hack. XML is extensible to
support new Nmap features as they are released, while I <br>
often must omit those features from grepable output for lack
of a place to put them.</p>

<p style="margin-top: 1em">Nevertheless, grepable output is
still quite popular. It is a simple format that lists each
host on one line and can be trivially searched and parsed
with standard Unix tools <br>
such as grep, awk, cut, sed, diff, and Perl. Even I usually
use it for one-off tests done at the command line. Finding
all the hosts with the SSH port open or that are <br>
running Solaris takes only a simple grep to identify the
hosts, piped to an awk or cut command to print the desired
fields.</p>

<p style="margin-top: 1em">Grepable output consists of
comments (lines starting with a pound (#)). and target
lines. A target line includes a combination of six labeled
fields, separated by tabs and <br>
followed with a colon. The fields are Host, Ports,
Protocols, Ignored State, OS, Seq Index, IP ID, and
Status.</p>

<p style="margin-top: 1em">The most important of these
fields is generally Ports, which gives details on each
interesting port. It is a comma separated list of port
entries. Each port entry represents <br>
one interesting port, and takes the form of seven slash (/)
separated subfields. Those subfields are: Port number,
State, Protocol, Owner, Service, SunRPC info, and Version
<br>
info.</p>

<p style="margin-top: 1em">As with XML output, this man
page does not allow for documenting the entire format. A
more detailed look at the Nmap grepable output format is
available from <br>

http://nmap.org/book/output-formats-grepable-output.html.</p>

<p style="margin-top: 1em">-oA basename (Output to all
formats) . <br>
As a convenience, you may specify -oA basename to store scan
results in normal, XML, and grepable formats at once. They
are stored in basename.nmap, basename.xml, and <br>
basename.gnmap, respectively. As with most programs, you can
prefix the filenames with a directory path, such as
~/nmaplogs/foocorp/ on Unix or c:king on Windows.</p>

<p style="margin-top: 1em">Verbosity and debugging
options</p>

<p style="margin-top: 1em">-v (Increase verbosity level) .
<br>
Increases the verbosity level, causing Nmap to print more
information about the scan in progress. Open ports are shown
as they are found and completion time estimates are <br>
provided when Nmap thinks a scan will take more than a few
minutes. Use it twice or more for even greater verbosity:
-vv, or give a verbosity level directly, for example <br>
-v3..</p>

<p style="margin-top: 1em">Most changes only affect
interactive output, and some also affect normal and script
kiddie output. The other output types are meant to be
processed by machines, so Nmap can <br>
give substantial detail by default in those formats without
fatiguing a human user. However, there are a few changes in
other modes where output size can be reduced <br>
substantially by omitting some detail. For example, a
comment line in the grepable output that provides a list of
all ports scanned is only printed in verbose mode because it
<br>
can be quite long.</p>

<p style="margin-top: 1em">-d (Increase debugging level) .
<br>
When even verbose mode doesn&rsquo;t provide sufficient data
for you, debugging is available to flood you with much more!
As with the verbosity option (-v), debugging is enabled <br>
with a command-line flag (-d) and the debug level can be
increased by specifying it multiple times,. as in -dd, or by
setting a level directly. For example, -d9 sets level <br>
nine. That is the highest effective level and will produce
thousands of lines unless you run a very simple scan with
very few ports and targets.</p>

<p style="margin-top: 1em">Debugging output is useful when
a bug is suspected in Nmap, or if you are simply confused as
to what Nmap is doing and why. As this feature is mostly
intended for developers, <br>
debug lines aren&rsquo;t always self-explanatory. You may
get something like: Timeout vals: srtt: -1 rttvar: -1 to:
1000000 delta 14987 ==&gt; srtt: 14987 rttvar: 14987 to:
100000. If <br>
you don&rsquo;t understand a line, your only recourses are
to ignore it, look it up in the source code, or request help
from the development list (nmap-dev).. Some lines are self
<br>
explanatory, but the messages become more obscure as the
debug level is increased.</p>

<p style="margin-top: 1em">--reason (Host and port state
reasons) . <br>
Shows the reason each port is set to a specific state and
the reason each host is up or down. This option displays the
type of the packet that determined a port or hosts <br>
state. For example, A RST packet from a closed port or an
echo reply from an alive host. The information Nmap can
provide is determined by the type of scan or ping. The SYN
<br>
scan and SYN ping (-sS and -PS) are very detailed, but the
TCP connect scan (-sT) is limited by the implementation of
the connect system call. This feature is automatically <br>
enabled by the debug option (-d). and the results are stored
in XML log files even if this option is not specified.</p>

<p style="margin-top: 1em">--stats-every time (Print
periodic timing stats) . <br>
Periodically prints a timing status message after each
interval of time. The time is a specification of the kind
described in the section called &acirc;TIMING AND
PERFORMANCE&acirc;; so <br>
for example, use --stats-every 10s to get a status update
every 10 seconds. Updates are printed to interactive output
(the screen) and XML output.</p>

<p style="margin-top: 1em">--packet-trace (Trace packets
and data sent and received) . <br>
Causes Nmap to print a summary of every packet sent or
received. This is often used for debugging, but is also a
valuable way for new users to understand exactly what Nmap
is <br>
doing under the covers. To avoid printing thousands of
lines, you may want to specify a limited number of ports to
scan, such as -p20-30. If you only care about the goings on
<br>
of the version detection subsystem, use --version-trace
instead. If you only care about script tracing, specify
--script-trace. With --packet-trace, you get all of the
above.</p>

<p style="margin-top: 1em">--open (Show only open (or
possibly open) ports) . <br>
Sometimes you only care about ports you can actually connect
to (open ones), and don&rsquo;t want results cluttered with
closed, filtered, and closed|filtered ports. Output <br>
customization is normally done after the scan using tools
such as grep, awk, and Perl, but this feature was added due
to overwhelming requests. Specify --open to only see <br>
hosts with at least one open, open|filtered, or unfiltered
port, and only see ports in those states. These three states
are treated just as they normally are, which means <br>
that open|filtered and unfiltered may be condensed into
counts if there are an overwhelming number of them.</p>

<p style="margin-top: 1em">--iflist (List interfaces and
routes) . <br>
Prints the interface list and system routes as detected by
Nmap. This is useful for debugging routing problems or
device mischaracterization (such as Nmap treating a PPP <br>
connection as ethernet).</p>

<p style="margin-top: 1em">Miscellaneous output options</p>

<p style="margin-top: 1em">--append-output (Append to
rather than clobber output files) . <br>
When you specify a filename to an output format flag such as
-oX or -oN, that file is overwritten by default. If you
prefer to keep the existing content of the file and <br>
append the new results, specify the --append-output option.
All output filenames specified in that Nmap execution will
then be appended to rather than clobbered. This
doesn&rsquo;t <br>
work well for XML (-oX) scan data as the resultant file
generally won&rsquo;t parse properly until you fix it up by
hand.</p>

<p style="margin-top: 1em">--resume filename (Resume
aborted scan) . <br>
Some extensive Nmap runs take a very long time&acirc;on the
order of days. Such scans don&rsquo;t always run to
completion. Restrictions may prevent Nmap from being run
during working <br>
hours, the network could go down, the machine Nmap is
running on might suffer a planned or unplanned reboot, or
Nmap itself could crash. The administrator running Nmap
could <br>
cancel it for any other reason as well, by pressing ctrl-C.
Restarting the whole scan from the beginning may be
undesirable. Fortunately, if normal (-oN) or grepable (-oG)
<br>
logs were kept, the user can ask Nmap to resume scanning
with the target it was working on when execution ceased.
Simply specify the --resume option and pass the <br>
normal/grepable output file as its argument. No other
arguments are permitted, as Nmap parses the output file to
use the same ones specified previously. Simply call Nmap as
<br>
nmap --resume logfilename. Nmap will append new results to
the data files specified in the previous execution.
Resumption does not support the XML output format because
<br>
combining the two runs into one valid XML file would be
difficult.</p>

<p style="margin-top: 1em">--stylesheet path or URL (Set
XSL stylesheet to transform XML output) . <br>
Nmap ships with an XSL. stylesheet. named nmap.xsl. for
viewing or translating XML output to HTML.. The XML output
includes an xml-stylesheet directive which points to <br>
nmap.xml where it was initially installed by Nmap. Run the
XML file through an XSLT processor such as xsltproc[17]. to
produce an HTML file. Directly opening the XML file in <br>
a browser no longer works well because modern browsers limit
the locations a stylesheet may be loaded from. If you wish
to use a different stylesheet, specify it as the <br>
argument to --stylesheet. You must pass the full pathname or
URL. One common invocation is --stylesheet
http://nmap.org/svn/docs/nmap.xsl. This tells an XSLT
processor to <br>
load the latest version of the stylesheet from Nmap.Org. The
--webxml option does the same thing with less typing and
memorization. Loading the XSL from Nmap.Org makes it <br>
easier to view results on a machine that doesn&rsquo;t have
Nmap (and thus nmap.xsl) installed. So the URL is often more
useful, but the local filesystem location of nmap.xsl is
<br>
used by default for privacy reasons.</p>

<p style="margin-top: 1em">--webxml (Load stylesheet from
Nmap.Org) . <br>
This is a convenience option, nothing more than an alias for
--stylesheet http://nmap.org/svn/docs/nmap.xsl.</p>

<p style="margin-top: 1em">--no-stylesheet (Omit XSL
stylesheet declaration from XML) . <br>
Specify this option to prevent Nmap from associating any XSL
stylesheet with its XML output. The xml-stylesheet directive
is omitted.</p>

<p style="margin-top: 1em">MISCELLANEOUS OPTIONS <br>
This section describes some important (and not-so-important)
options that don&rsquo;t really fit anywhere else.</p>

<p style="margin-top: 1em">-6 (Enable IPv6 scanning) . <br>
Nmap has IPv6 support for its most popular features. Ping
scanning, port scanning, version detection, and the Nmap
Scripting Engine all support IPv6. The command syntax is
<br>
the same as usual except that you also add the -6 option. Of
course, you must use IPv6 syntax if you specify an address
rather than a hostname. An address might look like <br>
3ffe:7501:4819:2000:210:f3ff:fe03:14d0, so hostnames are
recommended. The output looks the same as usual, with the
IPv6 address on the &acirc;interesting ports&acirc; line
being the only <br>
IPv6 giveaway.</p>

<p style="margin-top: 1em">While IPv6 hasn&rsquo;t exactly
taken the world by storm, it gets significant use in some
(usually Asian) countries and most modern operating systems
support it. To use Nmap with <br>
IPv6, both the source and target of your scan must be
configured for IPv6. If your ISP (like most of them) does
not allocate IPv6 addresses to you, free tunnel brokers are
<br>
widely available and work fine with Nmap. I use the free
IPv6 tunnel broker. service at http://www.tunnelbroker.net.
Other tunnel brokers are listed at Wikipedia[18]. 6to4 <br>
tunnels are another popular, free approach.</p>

<p style="margin-top: 1em">On Windows, raw-socket IPv6
scans are supported only on ethernet devices (not tunnels),
and only on Windows Vista. and later. Use the
--unprivileged. option in other <br>
situations.</p>

<p style="margin-top: 1em">-A (Aggressive scan options) .
<br>
This option enables additional advanced and aggressive
options. I haven&rsquo;t decided exactly which it stands for
yet. Presently this enables OS detection (-O), version
scanning <br>
(-sV), script scanning (-sC) and traceroute (--traceroute)..
More features may be added in the future. The point is to
enable a comprehensive set of scan options without <br>
people having to remember a large set of flags. However,
because script scanning with the default set is considered
intrusive, you should not use -A against target networks
<br>
without permission. This option only enables features, and
not timing options (such as -T4) or verbosity options (-v)
that you might want as well.</p>

<p style="margin-top: 1em">--datadir directoryname (Specify
custom Nmap data file location) . <br>
Nmap obtains some special data at runtime in files named
nmap-service-probes, nmap-services, nmap-protocols,
nmap-rpc, nmap-mac-prefixes, and nmap-os-db. If the location
of <br>
any of these files has been specified (using the --servicedb
or --versiondb options), that location is used for that
file. After that, Nmap searches these files in the <br>
directory specified with the --datadir option (if any). Any
files not found there, are searched for in the directory
specified by the NMAPDIR. environment variable. Next <br>
comes ~/.nmap. for real and effective UIDs; or on Windows,
HOME0Datahere HOME is the user&rsquo;s home directory, like
C:Usersser). This is followed by the <br>
location of the nmap executable and the same location with
../share/nmap appended. Then a compiled-in location such as
/usr/local/share/nmap or /usr/share/nmap.</p>

<p style="margin-top: 1em">--servicedb services file
(Specify custom services file) . <br>
Asks Nmap to use the specified services file rather than the
nmap-services data file that comes with Nmap. Using this
option also causes a fast scan (-F) to be used. See the <br>
description for --datadir for more information on
Nmap&rsquo;s data files.</p>

<p style="margin-top: 1em">--versiondb service probes file
(Specify custom service probes file) . <br>
Asks Nmap to use the specified service probes file rather
than the nmap-service-probes data file that comes with Nmap.
See the description for --datadir for more information <br>
on Nmap&rsquo;s data files.</p>

<p style="margin-top: 1em">--send-eth (Use raw ethernet
sending) . <br>
Asks Nmap to send packets at the raw ethernet (data link)
layer rather than the higher IP (network) layer. By default,
Nmap chooses the one which is generally best for the <br>
platform it is running on. Raw sockets (IP layer). are
generally most efficient for Unix machines, while ethernet
frames are required for Windows operation since Microsoft
<br>
disabled raw socket support. Nmap still uses raw IP packets
on Unix despite this option when there is no other choice
(such as non-ethernet connections).</p>

<p style="margin-top: 1em">--send-ip (Send at raw IP level)
. <br>
Asks Nmap to send packets via raw IP sockets rather than
sending lower level ethernet frames. It is the complement to
the --send-eth option discussed previously.</p>

<p style="margin-top: 1em">--privileged (Assume that the
user is fully privileged) . <br>
Tells Nmap to simply assume that it is privileged enough to
perform raw socket sends, packet sniffing, and similar
operations that usually require root privileges. on Unix
<br>
systems. By default Nmap quits if such operations are
requested but geteuid is not zero. --privileged is useful
with Linux kernel capabilities and similar systems that may
<br>
be configured to allow unprivileged users to perform
raw-packet scans. Be sure to provide this option flag before
any flags for options that require privileges (SYN scan, OS
<br>
detection, etc.). The NMAP_PRIVILEGED. environment variable
may be set as an equivalent alternative to --privileged.</p>

<p style="margin-top: 1em">--unprivileged (Assume that the
user lacks raw socket privileges) . <br>
This option is the opposite of --privileged. It tells Nmap
to treat the user as lacking network raw socket and sniffing
privileges. This is useful for testing, debugging, or <br>
when the raw network functionality of your operating system
is somehow broken. The NMAP_UNPRIVILEGED. environment
variable may be set as an equivalent alternative to <br>
--unprivileged.</p>

<p style="margin-top: 1em">--release-memory (Release memory
before quitting) . <br>
This option is only useful for memory-leak debugging. It
causes Nmap to release allocated memory just before it quits
so that actual memory leaks are easier to spot. Normally
<br>
Nmap skips this as the OS does this anyway upon process
termination.</p>

<p style="margin-top: 1em">-V; --version (Print version
number) . <br>
Prints the Nmap version number and exits.</p>

<p style="margin-top: 1em">-h; --help (Print help summary
page) . <br>
Prints a short help screen with the most common command
flags. Running Nmap without any arguments does the same
thing.</p>

<p style="margin-top: 1em">RUNTIME INTERACTION <br>
During the execution of Nmap, all key presses are captured.
This allows you to interact with the program without
aborting and restarting it. Certain special keys will change
<br>
options, while any other keys will print out a status
message telling you about the scan. The convention is that
lowercase letters increase the amount of printing, and
uppercase <br>
letters decrease the printing. You may also press
&acirc;?&acirc; for help.</p>

<p style="margin-top: 1em">v / V <br>
Increase / decrease the verbosity level</p>

<p style="margin-top: 1em">d / D <br>
Increase / decrease the debugging Level</p>

<p style="margin-top: 1em">p / P <br>
Turn on / off packet tracing</p>

<p style="margin-top: 1em">? <br>
Print a runtime interaction help screen</p>

<p style="margin-top: 1em">Anything else <br>
Print out a status message like this:</p>

<p style="margin-top: 1em">Stats: 0:00:07 elapsed; 20 hosts
completed (1 up), 1 undergoing Service Scan <br>
Service scan Timing: About 33.33% done; ETC: 20:57 (0:00:12
remaining)</p>

<p style="margin-top: 1em">EXAMPLES <br>
Here are some Nmap usage examples, from the simple and
routine to a little more complex and esoteric. Some actual
IP addresses and domain names are used to make things more
<br>
concrete. In their place you should substitute
addresses/names from your own network. While I don&rsquo;t
think port scanning other networks is or should be illegal,
some network <br>
administrators don&rsquo;t appreciate unsolicited scanning
of their networks and may complain. Getting permission first
is the best approach.</p>

<p style="margin-top: 1em">For testing purposes, you have
permission to scan the host scanme.nmap.org.. This
permission only includes scanning via Nmap and not testing
exploits or denial of service <br>
attacks. To conserve bandwidth, please do not initiate more
than a dozen scans against that host per day. If this free
scanning target service is abused, it will be taken down
<br>
and Nmap will report Failed to resolve given hostname/IP:
scanme.nmap.org. These permissions also apply to the hosts
scanme2.nmap.org, scanme3.nmap.org, and so on, though those
<br>
hosts do not currently exist.</p>

<p style="margin-top: 1em">This option scans all reserved
TCP ports on the machine scanme.nmap.org . The -v option
enables verbose mode.</p>

<p style="margin-top: 1em">Launches a stealth SYN scan
against each machine that is up out of the 256 IPs on the
class C sized network where Scanme resides. It also tries to
determine what operating system <br>
is running on each host that is up and running. This
requires root privileges because of the SYN scan and OS
detection.</p>

<p style="margin-top: 1em">Launches host enumeration and a
TCP scan at the first half of each of the 255 possible
eight-bit subnets in the 198.116 class B address space. This
tests whether the systems run <br>
SSH, DNS, POP3, or IMAP on their standard ports, or anything
on port 4564. For any of these ports found open, version
detection is used to determine what application is
running.</p>

<p style="margin-top: 1em">Asks Nmap to choose 100,000
hosts at random and scan them for web servers (port 80).
Host enumeration is disabled with -Pn since first sending a
couple probes to determine <br>
whether a host is up is wasteful when you are only probing
one port on each target host anyway.</p>

<p style="margin-top: 1em">This scans 4096 IPs for any web
servers (without pinging them) and saves the output in
grepable and XML formats.</p>

<p style="margin-top: 1em">NMAP BOOK <br>
While this reference guide details all material Nmap
options, it can&rsquo;t fully demonstrate how to apply those
features to quickly solve real-world tasks. For that, we
released Nmap <br>
Network Scanning: The Official Nmap Project Guide to Network
Discovery and Security Scanning. Topics include subverting
firewalls and intrusion detection systems, optimizing <br>
Nmap performance, and automating common networking tasks
with the Nmap Scripting Engine. Hints and instructions are
provided for common Nmap tasks such as taking network <br>
inventory, penetration testing, detecting rogue wireless
access points, and quashing network worm outbreaks. Examples
and diagrams show actual communication on the wire. More
<br>
than half of the book is available free online. See
http://nmap.org/book for more information.</p>

<p style="margin-top: 1em">BUGS <br>
Like its author, Nmap isn&rsquo;t perfect. But you can help
make it better by sending bug reports or even writing
patches. If Nmap doesn&rsquo;t behave the way you expect,
first upgrade to <br>
the latest version available from http://nmap.org. If the
problem persists, do some research to determine whether it
has already been discovered and addressed. Try searching for
<br>
the error message on our search page at
http://insecure.org/search.html or at Google. Also try
browsing the nmap-dev archives at http://seclists.org/..
Read this full manual <br>
page as well. If nothing comes of this, mail a bug report to
&lt;dev@nmap.org&gt;. Please include everything you have
learned about the problem, as well as what version of Nmap
you are <br>
running and what operating system version it is running on.
Problem reports and Nmap usage questions sent to
&lt;dev@nmap.org&gt; are far more likely to be answered than
those sent to <br>
Fyodor directly. If you subscribe to the nmap-dev list
before posting, your message will bypass moderation and get
through more quickly. Subscribe at <br>
http://nmap.org/mailman/listinfo/dev.</p>

<p style="margin-top: 1em">Code patches to fix bugs are
even better than bug reports. Basic instructions for
creating patch files with your changes are available at
https://svn.nmap.org/nmap/HACKING. <br>
Patches may be sent to nmap-dev (recommended) or to Fyodor
directly.</p>

<p style="margin-top: 1em">AUTHOR <br>
Gordon &acirc;Fyodor&acirc; Lyon &lt;fyodor@nmap.org&gt;
(http://insecure.org)</p>

<p style="margin-top: 1em">Hundreds of people have made
valuable contributions to Nmap over the years. These are
detailed in the CHANGELOG. file which is distributed with
Nmap and also available from <br>
http://nmap.org/changelog.html.</p>

<p style="margin-top: 1em">LEGAL NOTICES <br>
Nmap Copyright and Licensing <br>
The Nmap Security Scanner is (C) 1996&acirc;2012
Insecure.Com LLC. Nmap is also a registered trademark of
Insecure.Com LLC. This program is free software; you may
redistribute and/or <br>
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; Version 2 with
the clarifications and exceptions described below. This <br>
guarantees your right to use, modify, and redistribute this
software under certain conditions. If you wish to embed Nmap
technology into proprietary software, we sell alternative
<br>
licenses (contact &lt;sales@insecure.com&gt;). Dozens of
software vendors already license Nmap technology such as
host discovery, port scanning, OS detection, and version
detection.</p>

<p style="margin-top: 1em">Note that the GPL places
important restrictions on &acirc;derived works&acirc;, yet
it does not provide a detailed definition of that term. To
avoid misunderstandings, we consider an <br>
application to constitute a &acirc;derivative work&acirc;
for the purpose of this license if it does any of the
following:</p>

<p style="margin-top: 1em">&Acirc;&middot; Integrates
source code from Nmap</p>

<p style="margin-top: 1em">&Acirc;&middot; Reads or
includes Nmap copyrighted data files, such as nmap-os-db or
nmap-service-probes.</p>

<p style="margin-top: 1em">&Acirc;&middot; Executes Nmap
and parses the results (as opposed to typical shell or
execution-menu apps, which simply display raw Nmap output
and so are not derivative works.)</p>

<p style="margin-top: 1em">&Acirc;&middot;
Integrates/includes/aggregates Nmap into a proprietary
executable installer, such as those produced by
InstallShield.</p>

<p style="margin-top: 1em">&Acirc;&middot; Links to a
library or executes a program that does any of the
above.</p>

<p style="margin-top: 1em">The term &acirc;Nmap&acirc;
should be taken to also include any portions or derived
works of Nmap. This list is not exclusive, but is meant to
clarify our interpretation of derived works <br>
with some common examples. Our interpretation applies only
to Nmap&acirc;we don&rsquo;t speak for other people&rsquo;s
GPL works.</p>

<p style="margin-top: 1em">If you have any questions about
the GPL licensing restrictions on using Nmap in non-GPL
works, we would be happy to help. As mentioned above, we
also offer alternative license to <br>
integrate Nmap into proprietary applications and appliances.
These contracts have been sold to many security vendors, and
generally include a perpetual license as well as <br>
providing for priority support and updates as well as
helping to fund the continued development of Nmap
technology. Please email &lt;sales@insecure.com&gt; for
further information.</p>

<p style="margin-top: 1em">As a special exception to the
GPL terms, Insecure.Com LLC grants permission to link the
code of this program with any version of the OpenSSL library
which is distributed under a <br>
license identical to that listed in the included
COPYING.OpenSSL file, and distribute linked combinations
including the two.. You must obey the GNU GPL in all
respects for all <br>
of the code used other than OpenSSL. If you modify this
file, you may extend this exception to your version of the
file, but you are not obligated to do so.</p>

<p style="margin-top: 1em">If you received these files with
a written license agreement or contract stating terms other
than the terms above, then that alternative license
agreement takes precedence over <br>
these comments.</p>

<p style="margin-top: 1em">Creative Commons License for
this Nmap Guide <br>
This Nmap Reference Guide is (C) 2005&acirc;2012
Insecure.Com LLC. It is hereby placed under version 3.0 of
the Creative Commons Attribution License[19]. This allows
you redistribute <br>
and modify the work as you desire, as long as you credit the
original source. Alternatively, you may choose to treat this
document as falling under the same license as Nmap <br>
itself (discussed previously).</p>

<p style="margin-top: 1em">Source Code Availability and
Community Contributions <br>
Source is provided to this software because we believe users
have a right to know exactly what a program is going to do
before they run it. This also allows you to audit the <br>
software for security holes (none have been found so
far).</p>

<p style="margin-top: 1em">Source code also allows you to
port Nmap to new platforms, fix bugs, and add new features.
You are highly encouraged to send your changes to
&lt;dev@nmap.org&gt; for possible <br>
incorporation into the main distribution. By sending these
changes to Fyodor or one of the Insecure.Org development
mailing lists, it is assumed that you are offering the Nmap
<br>
Project (Insecure.Com LLC) the unlimited, non-exclusive
right to reuse, modify, and relicense the code. Nmap will
always be available open source,. but this is important
because <br>
the inability to relicense code has caused devastating
problems for other Free Software projects (such as KDE and
NASM). We also occasionally relicense the code to third
parties <br>
as discussed above. If you wish to specify special license
conditions of your contributions, just say so when you send
them.</p>

<p style="margin-top: 1em">No Warranty. <br>
This program is distributed in the hope that it will be
useful, but WITHOUT ANY WARRANTY; without even the implied
warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR <br>
PURPOSE. See the GNU General Public License v2.0 for more
details at http://www.gnu.org/licenses/gpl-2.0.html, or in
the COPYING file included with Nmap.</p>

<p style="margin-top: 1em">It should also be noted that
Nmap has occasionally been known to crash poorly written
applications, TCP/IP stacks, and even operating systems..
While this is extremely rare, it <br>
is important to keep in mind. Nmap should never be run
against mission critical systems unless you are prepared to
suffer downtime. We acknowledge here that Nmap may crash
your <br>
systems or networks and we disclaim all liability for any
damage or problems Nmap could cause.</p>

<p style="margin-top: 1em">Inappropriate Usage <br>
Because of the slight risk of crashes and because a few
black hats like to use Nmap for reconnaissance prior to
attacking systems, there are administrators who become upset
and <br>
may complain when their system is scanned. Thus, it is often
advisable to request permission before doing even a light
scan of a network.</p>

<p style="margin-top: 1em">Nmap should never be installed
with special privileges (e.g. suid root).. That would open
up a major security vulnerability as other users on the
system (or attackers) could use <br>
it for privilege escalation.</p>

<p style="margin-top: 1em">Third-Party Software and Funding
Notices <br>
This product includes software developed by the Apache
Software Foundation[20]. A modified version of the Libpcap
portable packet capture library[21]. is distributed along
with <br>
Nmap. The Windows version of Nmap utilized the
Libpcap-derived WinPcap library[22]. instead. Regular
expression support is provided by the PCRE library[23],.
which is <br>
open-source software, written by Philip Hazel.. Certain raw
networking functions use the Libdnet[24]. networking
library, which was written by Dug Song.. A modified version
is <br>
distributed with Nma.p Nmap can optionally link with the
OpenSSL cryptography toolkit[25]. for SSL version detection
support. The Nmap Scripting Engine uses an embedded version
<br>
of the Lua programming language[26].. The Liblinear linear
classification library[27] is used for our IPv6 OS detection
machine learning techniques[28]. All of the third-party <br>
software described in this paragraph is freely
redistributable under BSD-style software licenses.</p>

<p style="margin-top: 1em">Binary packages for Windows and
Mac OS X include support libraries necessary to run Zenmap
and Ndiff with Python and PyGTK. (Unix platforms commonly
make these libraries easy to <br>
install, so they are not part of the packages.) A listing of
these support libraries and their licenses is included in
the LICENSES files.</p>

<p style="margin-top: 1em">This software was supported in
part through the Google Summer of Code[29] and the DARPA
CINDER program[30] (DARPA-BAA-10-84).</p>

<p style="margin-top: 1em">United States Export Control.
<br>
Nmap only uses encryption when compiled with the optional
OpenSSL support and linked with OpenSSL. When compiled
without OpenSSL support, Insecure.Com LLC believes that Nmap
is <br>
not subject to U.S. Export Administration Regulations
(EAR)[31] export control. As such, there is no applicable
ECCN (export control classification number) and exportation
does <br>
not require any special license, permit, or other
governmental authorization.</p>

<p style="margin-top: 1em">When compiled with OpenSSL
support or distributed as source code, Insecure.Com LLC
believes that Nmap falls under U.S. ECCN 5D002[32]
(&acirc;Information Security Software&acirc;). We <br>
distribute Nmap under the TSU exception for publicly
available encryption software defined in EAR
740.13(e)[33].</p>

<p style="margin-top: 1em">NOTES <br>
1. Nmap Network Scanning: The Official Nmap Project Guide to
Network Discovery and Security Scanning <br>
http://nmap.org/book/</p>

<p style="margin-top: 1em">2. RFC 1122 <br>
http://www.rfc-editor.org/rfc/rfc1122.txt</p>

<p style="margin-top: 1em">3. RFC 792 <br>
http://www.rfc-editor.org/rfc/rfc792.txt</p>

<p style="margin-top: 1em">4. RFC 950 <br>
http://www.rfc-editor.org/rfc/rfc950.txt</p>

<p style="margin-top: 1em">5. RFC 1918 <br>
http://www.rfc-editor.org/rfc/rfc1918.txt</p>

<p style="margin-top: 1em">6. UDP <br>
http://www.rfc-editor.org/rfc/rfc768.txt</p>

<p style="margin-top: 1em">7. SCTP <br>
http://www.rfc-editor.org/rfc/rfc4960.txt</p>

<p style="margin-top: 1em">8. TCP RFC <br>
http://www.rfc-editor.org/rfc/rfc793.txt</p>

<p style="margin-top: 1em">9. RFC 959 <br>
http://www.rfc-editor.org/rfc/rfc959.txt</p>

<p style="margin-top: 1em">10. RFC 1323 <br>
http://www.rfc-editor.org/rfc/rfc1323.txt</p>

<p style="margin-top: 1em">11. Lua programming language
<br>
http://lua.org</p>

<p style="margin-top: 1em">12. precedence <br>
http://www.lua.org/manual/5.1/manual.html#2.5.3</p>

<p style="margin-top: 1em">13. IP protocol <br>
http://www.rfc-editor.org/rfc/rfc791.txt</p>

<p style="margin-top: 1em">14. RFC 2960 <br>
http://www.rfc-editor.org/rfc/rfc2960.txt</p>

<p style="margin-top: 1em">15. Nmap::Scanner <br>
http://sourceforge.net/projects/nmap-scanner/</p>

<p style="margin-top: 1em">16. Nmap::Parser <br>
http://nmapparser.wordpress.com/</p>

<p style="margin-top: 1em">17. xsltproc <br>
http://xmlsoft.org/XSLT/</p>

<p style="margin-top: 1em">18. listed at Wikipedia <br>

http://en.wikipedia.org/wiki/List_of_IPv6_tunnel_brokers</p>

<p style="margin-top: 1em">19. Creative Commons Attribution
License <br>
http://creativecommons.org/licenses/by/3.0/</p>

<p style="margin-top: 1em">20. Apache Software Foundation
<br>
http://www.apache.org</p>

<p style="margin-top: 1em">21. Libpcap portable packet
capture library <br>
http://www.tcpdump.org</p>

<p style="margin-top: 1em">22. WinPcap library <br>
http://www.winpcap.org</p>

<p style="margin-top: 1em">23. PCRE library <br>
http://www.pcre.org</p>

<p style="margin-top: 1em">24. Libdnet <br>
http://libdnet.sourceforge.net</p>

<p style="margin-top: 1em">25. OpenSSL cryptography toolkit
<br>
http://www.openssl.org</p>

<p style="margin-top: 1em">26. Lua programming language
<br>
http://www.lua.org</p>

<p style="margin-top: 1em">27. Liblinear linear
classification library <br>
http://www.csie.ntu.edu.tw/~cjlin/liblinear/</p>

<p style="margin-top: 1em">28. IPv6 OS detection machine
learning techniques <br>

http://nmap.org/book/osdetect-guess.html#osdetect-guess-ipv6</p>

<p style="margin-top: 1em">29. Google Summer of Code <br>
http://nmap.org/soc/</p>

<p style="margin-top: 1em">30. DARPA CINDER program <br>

https://www.fbo.gov/index?s=opportunity&amp;mode=form&amp;id=585e02a51f77af5cb3c9e06b9cc82c48&amp;tab=core&amp;_cview=1</p>

<p style="margin-top: 1em">31. Export Administration
Regulations (EAR) <br>
http://www.access.gpo.gov/bis/ear/ear_data.html</p>

<p style="margin-top: 1em">32. 5D002 <br>
http://www.access.gpo.gov/bis/ear/pdf/ccl5-pt2.pdf</p>

<p style="margin-top: 1em">33. EAR 740.13(e) <br>
http://www.access.gpo.gov/bis/ear/pdf/740.pdf</p>

<p style="margin-top: 1em">Nmap 07/28/2013 NMAP(1)</p>
<hr>
</body>
</html>
