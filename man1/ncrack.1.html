<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:27:01 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>NCRACK(1) Ncrack Reference Guide NCRACK(1)</p>

<p style="margin-top: 1em">NAME <br>
ncrack - Network authentication cracking tool</p>

<p style="margin-top: 1em">SYNOPSIS <br>
ncrack [Options] {target specification}</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Ncrack is an open source tool for network authentication
cracking. It was designed for high-speed parallel cracking
using a dynamic engine that can adapt to different network
<br>
situations. Ncrack can also be extensively fine-tuned for
special cases, though the default parameters are generic
enough to cover almost every situation. It is built on a
<br>
modular architecture that allows for easy extension to
support additional protocols. Ncrack is designed for
companies and security professionals to audit large networks
for <br>
default or weak passwords in a rapid and reliable way. It
can also be used to conduct fairly sophisticated and
intensive brute force attacks against individual
services.</p>

<p style="margin-top: 1em">Warning <br>
Ncrack is a project started in the Summer of 2009. While it
is already useful for some purposes, it is still unfinished,
beta quality software. You can help out by testing it <br>
and reporting any problems as described in the section
called &acirc;BUGS&acirc;.</p>

<p style="margin-top: 1em">The output from Ncrack is a list
of found credentials, if any, for each of the targets
specified. Ncrack can also print an interactive status
report of progress so far and <br>
possibly additional debugging information that can help
track problems, if the user selected that option.</p>

<p style="margin-top: 1em">A typical Ncrack scan is shown
in Example 1. The only Ncrack arguments used in this example
are the two target IP addresses along with the the
corresponding ports for each of <br>
them. The two example ports 21 and 22 are automatically
resolved to the default services listening on them: ftp and
ssh.</p>

<p style="margin-top: 1em">Example 1. A representative
Ncrack scan</p>

<p style="margin-top: 1em">$ ncrack 10.0.0.130:21
192.168.1.2:22</p>

<p style="margin-top: 1em">Starting Ncrack 0.5 (
http://ncrack.org ) at 2016-01-03 22:10 EEST</p>

<p style="margin-top: 1em">Discovered credentials for ftp
on 10.0.0.130 21/tcp: <br>
10.0.0.130 21/tcp ftp: admin hello1 <br>
Discovered credentials for ssh on 192.168.1.2 22/tcp: <br>
192.168.1.2 22/tcp ssh: guest 12345 <br>
192.168.1.2 22/tcp ssh: admin money$</p>

<p style="margin-top: 1em">Ncrack done: 2 services scanned
in 156.03 seconds.</p>

<p style="margin-top: 1em">Ncrack finished.</p>

<p style="margin-top: 1em">The latest version of Ncrack can
be obtained from http://nmap.org/ncrack. The latest version
of this man page is available at
http://nmap.org/ncrack/man.html .</p>

<p style="margin-top: 1em">OPTIONS SUMMARY <br>
This options summary is printed when Ncrack is run with no
arguments. It helps people remember the most common options,
but is no substitute for the in-depth documentation in the
<br>
rest of this manual.</p>

<p style="margin-top: 1em">Ncrack 0.5 ( http://ncrack.org )
<br>
Usage: ncrack [Options] {target and service specification}
<br>
TARGET SPECIFICATION: <br>
Can pass hostnames, IP addresses, networks, etc. <br>
Ex: scanme.nmap.org, microsoft.com/24, 192.168.0.1;
10.0.0-255.1-254 <br>
-iX &lt;inputfilename&gt;: Input from Nmap&Acirc;&acute;s
-oX XML output format <br>
-iN &lt;inputfilename&gt;: Input from Nmap&Acirc;&acute;s
-oN Normal output format <br>
-iL &lt;inputfilename&gt;: Input from list of hosts/networks
<br>
--exclude &lt;host1[,host2][,host3],...&gt;: Exclude
hosts/networks <br>
--excludefile &lt;exclude_file&gt;: Exclude list from file
<br>
SERVICE SPECIFICATION: <br>
Can pass target specific services in
&lt;service&gt;://target (standard) notation or <br>
using -p which will be applied to all hosts in non-standard
notation. <br>
Service arguments can be specified to be host-specific, type
of service-specific <br>
(-m) or global (-g). Ex: ssh://10.0.0.10,at=10,cl=30 -m
ssh:at=50 -g cd=3000 <br>
Ex2: ncrack -p ssh,ftp:3500,25 10.0.0.10 scanme.nmap.org
google.com:80,ssl <br>
-p &lt;service-list&gt;: services will be applied to all
non-standard notation hosts <br>
-m &lt;service&gt;:&lt;options&gt;: options will be applied
to all services of this type <br>
-g &lt;options&gt;: options will be applied to every service
globally <br>
Misc options: <br>
ssl: enable SSL over this service <br>
path &lt;name&gt;: used in modules like HTTP
(&Acirc;&acute;=&Acirc;&acute; needs escaping if used) <br>
TIMING AND PERFORMANCE: <br>
Options which take &lt;time&gt; are in seconds, unless you
append &Acirc;&acute;ms&Acirc;&acute; <br>
(miliseconds), &Acirc;&acute;m&Acirc;&acute; (minutes), or
&Acirc;&acute;h&Acirc;&acute; (hours) to the value (e.g.
30m). <br>
Service-specific options: <br>
cl (min connection limit): minimum number of concurrent
parallel connections <br>
CL (max connection limit): maximum number of concurrent
parallel connections <br>
at (authentication tries): authentication attempts per
connection <br>
cd (connection delay): delay &lt;time&gt; between each
connection initiation <br>
cr (connection retries): caps number of service connection
attempts <br>
to (time-out): maximum cracking &lt;time&gt; for service,
regardless of success so far <br>
-T&lt;0-5&gt;: Set timing template (higher is faster) <br>
--connection-limit &lt;number&gt;: threshold for total
concurrent connections <br>
AUTHENTICATION: <br>
-U &lt;filename&gt;: username file <br>
-P &lt;filename&gt;: password file <br>
--user &lt;username_list&gt;: comma-separated username list
<br>
--pass &lt;password_list&gt;: comma-separated password list
<br>
--passwords-first: Iterate password list for each username.
Default is opposite. <br>
--pairwise: Choose usernames and passwords in pairs. <br>
OUTPUT: <br>
-oN/-oX &lt;file&gt;: Output scan in normal and XML format,
respectively, to the given filename. <br>
-oA &lt;basename&gt;: Output in the two major formats at
once <br>
-v: Increase verbosity level (use twice or more for greater
effect) <br>
-d[level]: Set or increase debugging level (Up to 10 is
meaningful) <br>
--nsock-trace &lt;level&gt;: Set nsock trace level (Valid
range: 0 - 10) <br>
--log-errors: Log errors/warnings to the normal-format
output file <br>
--append-output: Append to rather than clobber specified
output files <br>
MISC: <br>
--resume &lt;file&gt;: Continue previously saved session
<br>
--save &lt;file&gt;: Save restoration file with specific
filename <br>
-f: quit cracking service after one found credential <br>
-6: Enable IPv6 cracking <br>
-sL or --list: only list hosts and services <br>
--datadir &lt;dirname&gt;: Specify custom Ncrack data file
location <br>
--proxy &lt;type://proxy:port&gt;: Make connections via
socks4, 4a, http. <br>
-V: Print version number <br>
-h: Print this help summary page. <br>
MODULES: <br>
FTP, SSH, Telnet, HTTP(S), POP3(S), SMB, RDP, VNC, SIP,
Redis, PostgreSQL, MySQL <br>
EXAMPLES: <br>
ncrack -v --user root localhost:22 <br>
ncrack -v -T5 https://192.168.0.1 <br>
ncrack -v -iX ~/nmap.xml -g CL=5,to=1h <br>
SEE THE MAN PAGE (http://nmap.org/ncrack/man.html) FOR MORE
OPTIONS AND EXAMPLES</p>

<p style="margin-top: 1em">TARGET SPECIFICATION <br>
Everything on the Ncrack command-line that
isn&Acirc;&acute;t an option (or an option argument) is
treated as a target host specification. The simplest case is
to specify a target IP address <br>
or a hostname. Note, that you also need to specify a service
to crack for the selected targets. Ncrack is very flexible
in host/service specification. While hostnames and IP <br>
addresses can be defined with the flexibility that you are
probably used to from Nmap, services along with
service-specific options have a unique specification style
that enables <br>
a combination of features to be taken advantage of.</p>

<p style="margin-top: 1em">Sometimes you wish to crack a
whole network of adjacent hosts. For this, Ncrack supports
CIDR-style addressing. You can append /numbits to an IPv4
address or hostname and Ncrack <br>
will try to crack every IP address for which the first
numbits are the same as for the reference IP or hostname
given. For example, 192.168.10.0/24 would send probes to the
256 <br>
hosts between 192.168.10.0 11000000 10101000 00001010
00000000) and 192.168.10.255 (binary: 11000000 10101000
00001010 11111111), inclusive. 192.168.10.40/24 would crack
exactly <br>
the same targets. Given that the host scanme.nmap.org is at
the IP address 64.13.134.52, the specification
scanme.nmap.org/16 would send probes to the 65,536 IP
addresses between <br>
64.13.0.0 and 64.13.255.255. The smallest allowed value is
/0, which targets the whole Internet. The largest value is
/32, which targets just the named host or IP address because
<br>
all address bits are fixed.</p>

<p style="margin-top: 1em">CIDR notation is short but not
always flexible enough. For example, you might want to send
probes to 192.168.0.0/16 but skip any IPs ending with .0 or
.255 because they may be <br>
used as subnet network and broadcast addresses. Ncrack
supports this through octet range addressing. Rather than
specify a normal IP address, you can specify a
comma-separated <br>
list of numbers or ranges for each octet. For example,
192.168.0-255.1-254 will skip all addresses in the range
that end in .0 or .255, and 192.168.3-5,7.1 will target the
four <br>
addresses 192.168.3.1, 192.168.4.1, 192.168.5.1, and
192.168.7.1. Either side of a range may be omitted; the
default values are 0 on the left and 255 on the right. Using
- by <br>
itself is the same as 0-255, but remember to use 0- in the
first octet so the target specification doesn&Acirc;&acute;t
look like a command-line option. Ranges need not be limited
to the <br>
final octets: the specifier will send probes to all IP
addresses on the Internet ending in 13.37 This sort of broad
sampling can be useful for Internet surveys and
research.</p>

<p style="margin-top: 1em">Ncrack accepts multiple host
specifications on the command line, and they
don&Acirc;&acute;t need to be the same type. The command
ncrack scanme.nmap.org 192.168.0.0/8 10.0.0,1,3-7.- -p22
<br>
does what you would expect.</p>

<p style="margin-top: 1em">While targets are usually
specified on the command lines, the following options are
also available to control target selection:</p>

<p style="margin-top: 1em">-iX inputfilename (Input from
Nmap&Acirc;&acute;s -oX XML output format) . <br>
Reads target/service specifications from an Nmap XML output
file. The Nmap XML file is created by scanning any hosts and
specifying the Nmap -oX option. Ncrack will <br>
automatically parse the IP addresses and the corresponding
ports and services that are open and will use these targets
for authentication auditing. This is a really useful <br>
option, since it lets you essentially combine these two
tools -Nmap and Ncrack- for cracking only those services
that are surely open. In addition, if version detection has
<br>
been enabled in Nmap (-sV option), Ncrack will use those
findings to recognize and crack those services that are
supported but are listening on non-default ports. For <br>
example, if a host is having a server listening on port
41414 and Nmap has identified that it is a SSH service,
Ncrack will use that information to crack it using the SSH
<br>
module. Of course, Ncrack is going to ignore open
ports/services that are not supported for authentication
cracking by its modules.</p>

<p style="margin-top: 1em">-iN inputfilename (Input from
Nmap&Acirc;&acute;s -oN Normal output format) . <br>
Reads target/service specifications from an Nmap Normal
output file. The Nmap Normal file is created by scanning any
hosts and specifying the Nmap -oN option. This works <br>
exactly like Ncrack&Acirc;&acute;s -iX option, the only
difference being the format of the input file.</p>

<p style="margin-top: 1em">-iL inputfilename (Input from
list) . <br>
Reads target specifications from inputfilename. Passing a
huge list of hosts is often awkward on the command line, yet
it is a common desire. For example, you might want to <br>
crack a list of very specific servers that have been
specified for penetration testing. Simply generate the list
of hosts to crack and pass that filename to Ncrack as an
<br>
argument to the -iL option. Entries can be in any of the
formats accepted by Ncrack on the command line (IP address,
hostname, CIDR, octet ranges or Ncrack&Acirc;&acute;s
special <br>
host-service syntax. Each entry must be separated by one or
more spaces, tabs, or newlines. You can specify a hyphen (-)
as the filename if you want Ncrack to read hosts from <br>
standard input rather than an actual file. Note, however,
that if hosts are specified without any service, you will
have to also provide services/ports for the targets using
<br>
the -p option.</p>

<p style="margin-top: 1em">--exclude host1[, host2[, ...]]
(Exclude hosts/networks) . <br>
Specifies a comma-separated list of targets to be excluded
from the scan even if they are part of the overall network
range you specify. The list you pass in uses normal <br>
Ncrack syntax, so it can include hostnames, CIDR netblocks,
octet ranges, etc. This can be useful when the network you
wish to scan includes untouchable mission-critical <br>
servers, systems that are known to react adversely to heavy
load, or subnets administered by other people.</p>

<p style="margin-top: 1em">--excludefile exclude_file
(Exclude list from file) . <br>
This offers the same functionality as the --exclude option,
except that the excluded targets are provided in a newline,
space, or tab delimited exclude_file rather than on <br>
the command line.</p>

<p style="margin-top: 1em">SERVICE SPECIFICATION <br>
No cracking session can be carried out without targetting a
certain service to attack. Service specification is one of
the most flexible subsystems of Ncrack and collaborates <br>
with target-specification in a way that allows different
option combinations to be applied. For Ncrack to start
running, you will have to specify at least one target host
and one <br>
associated service to attack. Ncrack provides ways to
specify a service by its default port number, by its name
(as extracted from the ncrack-services file) or both.
Normally, <br>
you need to define both name and port number only in the
special case where you know that a particular service is
listening on a non-default port.</p>

<p style="margin-top: 1em">Ncrack offers two distinct ways
with which services will be applied to your targets:
per-host service specification and global specification.</p>

<p style="margin-top: 1em">Per-host service
specification</p>

<p style="margin-top: 1em">Services specified in this mode
are written next to the host and apply to it only. Keep in
mind, however, that target-specification allows
wildcards/netmasks, which <br>
essentially means that applying a per-host service
specification format to that particular target will affect
all of the expanded ones as a result. The general format
is:</p>


<p style="margin-top: 1em">[service-name]://target:[port-number]</p>

<p style="margin-top: 1em">where target is a hostname or IP
address in any of the formats described in the
target-specification section, [service-name] is one of the
common service names as defined in <br>
the ncrack-services file (e.g ssh, http) and [port-number]
is what it obviously means. Ncrack can determine the default
port numbers for each of the services it supports, as <br>
well as being able to deduce the service name when a default
port number has been specified. Specifying both has meaning
only when the user has a priori knowledge of a <br>
service listening on a non-default port number. This can
easily be determined by using version detection like the one
offered by Nmap&Acirc;&acute;s -sV option.</p>

<p style="margin-top: 1em">Example 2. Per-host service
specification example</p>

<p style="margin-top: 1em">$ ncrack scanme.nmap.org:22
ftp://10.0.0.10 ssh://192.168.1.*:5910</p>

<p style="margin-top: 1em">The above command will try to
crack hosts: scanme.nmap.org on SSH service (default port
22), 10.0.0.10 on FTP service (default port 21) and
192.168.1.0 - 192.168.1.255 (all <br>
of this C subnet) on SSH service on non-default port 5910
which has been explicitly specified. In the last case,
Ncrack wouldn&Acirc;&acute;t be able to determine that the
subnet hosts <br>
are to be scanned against the SSH service on that particular
port without the user explicitly asking for it, because
there isn&Acirc;&acute;t any mapping of port-number 5910 to
service <br>
SSH.</p>

<p style="margin-top: 1em">Global service specification</p>

<p style="margin-top: 1em">Services specified in this mode
are applied to all hosts that haven&Acirc;&acute;t been
associated with the per-host service specification format.
This is done using the -p option. While <br>
this facility may be similar to that of Nmap&Acirc;&acute;s,
you should try not to confuse it, since the functionality is
of a slightly different nature. Services can be specified
using <br>
comma separated directives of the general format:</p>

<p style="margin-top: 1em">-p
[service1]:[port-number1],[service2]:[port-number2],...</p>

<p style="margin-top: 1em">As usual, you need not specify
both service name and port number since Ncrack knows the
mappings of default-services to default-port numbers. Be
careful though not to include <br>
any space between each service-name and/or port number,
because Ncrack will think that the argument after the space
is a host as per the rule &quot;everything that
isn&Acirc;&acute;t an option <br>
is a target specification&quot;.</p>

<p style="margin-top: 1em">Example 3. Global service
specification example</p>

<p style="margin-top: 1em">$ ncrack scanme.nmap.org
10.0.0.120-122 192.168.2.0/24 -p 22,ftp:3210,telnet</p>

<p style="margin-top: 1em">The above command will try to
crack all of the specified hosts scanme.nmap.org,
10.0.0.120, 10.0.0.121, 10.0.0.122 and the C class subnet of
192.168.2.0 against the following <br>
services: SSH service (mapped from default port 22), FTP
service on non-default port 3210, and TELNET service on
default port 23.</p>

<p style="margin-top: 1em">Of course, Ncrack allows you to
combine both modes of service specification if you deem that
as necessary. Normally, you will only need to specify a
couple of services but <br>
cracking a lot of hosts against many different services
might be a longterm project for large networks that need to
be consistently audited for weak passwords. If you are in
<br>
doubt, about which hosts and services are going to be
cracked with the current command, you can use the -sL option
(see below for explanation).</p>

<p style="margin-top: 1em">SERVICE OPTIONS <br>
Apart from general service specification, Ncrack allows you
to provide a multitude of options that apply to each or a
subset of your targets. Options include timing and <br>
performance optimizations (which are thoroughly analyzed in
a seperate section), SSL enabling/disabling and other
module-specific parameters like the relative URL path for
the <br>
HTTP module. Options can be defined in a variety of ways
which include: per-host options, per-module options and
global options. Since a combination of these options may be
used, <br>
there is a strict hierarchy of precedence which will be
discussed later.</p>

<p style="margin-top: 1em">Per-host Options</p>

<p style="margin-top: 1em">Options in this mode apply only
to the host(s) they are referring to and are written next to
it according to the following format:</p>


<p style="margin-top: 1em">[service-name]://target:[port-number],opt1=optval1,opt2=optval,...</p>

<p style="margin-top: 1em">The format concerning the
service specification which comes before the options, has
been explained in the previous section. optN is referring to
any of the option names that <br>
are available (a list will follow below), while optvalN
determines the value of that option and depends on the
nature of it. For example, most timing-related options
expect <br>
to receive numbers as values, while the path option
obviously needs a string argument.</p>

<p style="margin-top: 1em">Per-module Options</p>

<p style="margin-top: 1em">Options in this mode apply to
all hosts that are associated with the particular
service/module. This is accomplished using the -m which is
defined with the format:</p>

<p style="margin-top: 1em">-m
service-name:opt1=optval1,opt2=optval2,...</p>

<p style="margin-top: 1em">This option can be invoked
multiple times, for as many different services as you might
need to define service-wide applicable options. Each
iteration of this option must <br>
refer to only one service. However, to avoid confusion, this
option had better not be called more than one time for the
same service, although this is allowed and the last <br>
iteration will take precedence over the previous ones for
all redefined option values.</p>

<p style="margin-top: 1em">Global Options</p>

<p style="margin-top: 1em">Options in this mode apply to
all hosts regardless of which service they are associated
with. This is accomplished using the -g as follows:</p>

<p style="margin-top: 1em">-g
opt1=optval1,opt2=optval2,...</p>

<p style="margin-top: 1em">This acts as a convenience
option, where you can apply options to all services
globally. Everything else regarding the available options
and option values is the same as the <br>
previous modes.</p>

<p style="margin-top: 1em">List of available Service
Options</p>

<p style="margin-top: 1em">Below follows a list of all the
currently available service options. You can apply them with
any of the three modes described above. The last six of the
options are timing <br>
related and will be analyzed in Section &quot;Timing and
Performance&quot; of this manual.</p>

<p style="margin-top: 1em">ssl: enable SSL over this
service <br>
path: path-name used in modules like HTTP
(&Acirc;&acute;=&Acirc;&acute; needs escaping if used) <br>
cl (min connection limit): minimum number of concurrent
parallel connections <br>
CL (max connection limit): maximum number of concurrent
parallel connections <br>
at (authentication tries): authentication attempts per
connection <br>
cd (connection delay): delay time between each connection
initiation <br>
cr (connection retries): caps number of service connection
attempts <br>
to (time-out): maximum cracking time for service, regardless
of success so far</p>

<p style="margin-top: 1em">ssl (Enable/Disable SSL over
service) <br>
By enabling SSL, Ncrack will try to open a TCP connection
and then negotiate a SSL session with the target. Everything
will then be transparently encrypted and decrypted. <br>
However, since Ncrack&Acirc;&acute;s job is to provide speed
rather than strong crypto, the algorithms and ciphers for
SSL are chosen on an efficiency basis. Possible values for
this <br>
option are &Acirc;&acute;yes&Acirc;&acute; but just
specifying ssl would be enough. Thus, this is the only
option that doesn&Acirc;&acute;t need to be written in the
opt=optval format. By default, SSL is disabled <br>
for all services except those that are stricly dependent on
it like HTTPS.</p>

<p style="margin-top: 1em">path &lt;name&gt; (Path name for
relative URLs) <br>
Some services like HTTP or SVN usually require a specific
path in the URL. This option takes that pathname string as
its value. The path is always relative to the hostname or
<br>
IP address, so if you want to target something like
http://foobar.com/login.php the path must take the value
path=login.php . The initial &Acirc;&acute;/&Acirc;&acute;
is added if you omit it. <br>
However, it is usually better if you explicitly specify it
at the end of pathnames that are directories. For example,
to crack the directory for <br>
http://foobar.com/protected-dir/ , it would be better if you
wrote it as path=protected-dir/ . This is to avoid the
(very) slight probability of a false positive, because <br>
there are cases where Web servers might reply with a
&quot;301 Moved Permanently&quot; for a non-successful
attempt. They normally send that reply, when a successful
attempt is made <br>
for a requested password-protected path which has omitted
the ending &Acirc;&acute;/&Acirc;&acute; but the requested
source is actually a directory. Consequently, Ncrack regards
that reply as having <br>
succeeded in the authentication attempt.</p>

<p style="margin-top: 1em">Also be careful with the symbol
&Acirc;&acute;=&Acirc;&acute;, since it is used by Ncrack
for argument parsing and you will have to espace it if it is
included in the URL.</p>

<p style="margin-top: 1em">By default, the path-name is
initialized to &Acirc;&acute;/&Acirc;&acute;, but will be
ignored by services that do not require it.</p>

<p style="margin-top: 1em">Service Option Hierarchy</p>

<p style="margin-top: 1em">As already noted, Ncrack allows
a combination of the three different modes of service option
specification. In that case, there is a strict hierarchy
that resolves the order in <br>
which conflicting values for these options take precedence
over each other. The order is as follows, leftmost being the
highest priority and rightmost the lowest one:</p>

<p style="margin-top: 1em">Per-host options &gt; Per-module
options &gt; Global options &gt; Timing-Template (for timing
options only)</p>

<p style="margin-top: 1em">The concept of the
&quot;Timing-Template&quot; will be explained in the Section
&quot;Timing and Performance&quot;, but for now, just have
in mind that its values have the least prevalence over <br>
everything else and essentially act as defaults for
everything timing-related. Global options specified with -g
have the directly higher precedence, while -m per-module
options <br>
are immediately higher. In the top of the hierarcy reside
the per-host options which are essentially the most specific
ones. Consequently, you can see that the pattern is: the
<br>
more specific the higher the precedence.</p>

<p style="margin-top: 1em">Example 4. Service Option
Hierarchy example</p>

<p style="margin-top: 1em">$ ncrack
scanme.nmap.org:22,cl=10,at=1 10.0.0.120 10.0.0.20 -p 21 -m
ftp:CL=1 -g CL=3</p>

<p style="margin-top: 1em">The example demonstrates the
hierarchy precedence. The services that are going to be
cracked are SSH for scanme.nmap.org and FTP for hosts
10.0.0.120, 10.0.0.20. No particular <br>
timing-template has been specified and thus the default will
be used (Normal - 3). The per-host options for
scanme.nmap.org define that the minimum connection limit
(cl) is 10 <br>
and that Ncrack should attempt only 1 authentication try
(at) per connection. These values would override any other
for service SSH of host scanme.nmap.org if there were <br>
conflicts with other modes. Since a global option of -g CL=3
was defined and there is no other higher-precedence for
service SSH and scanme.nmap.org in particular, this value
<br>
will also be applied. As for the FTP targets, the per-module
-m ftp:CL=1 defined for all FTP services will override the
equivalent global one. All these can get quite complex if
<br>
overused, but they are not expected to be leveraged by the
average Ncrack user anyway. Complicated network scanning
scenarios might require them, though. To make certain the
<br>
results are the ones you expect them to be,
don&Acirc;&acute;t forget to use the -sL option that prints
out details about what Ncrack would crack if invoked
normally. You can add the <br>
debugging -d option if you want even more verbose output.
For the above example, Ncrack would print the following:</p>

<p style="margin-top: 1em">Example 5. Service Option
Hierarchy Output example</p>

<p style="margin-top: 1em">$ ncrack
scanme.nmap.org:22,cl=10,at=1 10.0.0.120 10.0.0.20 -p 21 -m
ftp:CL=1 -g CL=3 -sL -d</p>

<p style="margin-top: 1em">Starting Ncrack 0.01ALPHA (
http://ncrack.org ) at 2009-08-05 18:32 EEST</p>

<p style="margin-top: 1em">----- [ Timing Template ] -----
<br>
cl=7, CL=80, at=0, cd=0, cr=10, to=0</p>

<p style="margin-top: 1em">----- [ ServicesTable ] -----
<br>
SERVICE cl CL at cd cr to ssl path <br>
ftp:21 N/A 1 N/A N/A N/A N/A no null <br>
ssh:22 N/A N/A N/A N/A N/A N/A no null <br>
telnet:23 N/A N/A N/A N/A N/A N/A no null <br>
smtp:25 N/A N/A N/A N/A N/A N/A no null <br>
http:80 N/A N/A N/A N/A N/A N/A no null <br>
https:443 N/A N/A N/A N/A N/A N/A yes null</p>

<p style="margin-top: 1em">----- [ Targets ] ----- <br>
Host: 64.13.134.52 ( scanme.nmap.org ) <br>
ssh:22 cl=10, CL=10, at=1, cd=0, cr=10, to=0, ssl=no, path=/
<br>
Host: 10.0.0.120 <br>
ftp:21 cl=3, CL=1, at=0, cd=0, cr=10, to=0, ssl=no, path=/
<br>
Host: 10.0.0.20 <br>
ftp:21 cl=3, CL=1, at=0, cd=0, cr=10, to=0, ssl=no,
path=/</p>

<p style="margin-top: 1em">Ncrack done: 3 services would be
scanned. <br>
Probes sent: 0 | timed-out: 0 | prematurely-closed: 0</p>

<p style="margin-top: 1em">Ncrack finished.</p>

<p style="margin-top: 1em">The ServicesTable just lists the
per-module options for all available services. As you can
see, the only defined option is in the FTP service for the
CL . The Targets table is <br>
the most important part of this output and lists all targets
and associated options according to the command-line
invocation. No network operation takes place in this mode,
apart <br>
from forward DNS resolution for hostnames (like
scanme.nmap.org in this example).</p>

<p style="margin-top: 1em">TIMING AND PERFORMANCE <br>
The timing engine is perhaps the most important part of any
serious network authentication cracking tool.
Ncrack&Acirc;&acute;s timing engine offers a great many
options for optimization and <br>
can be bended to serve virtually any user need. As Ncrack is
progressing, this subsystem is going to evolve into a
dynamic autonomous engine that will be able to automatically
<br>
adjust its behaviour according to the network feedback it
gets, in order to achieve maximum performance and precision
without any user intervention.</p>

<p style="margin-top: 1em">Some options accept a time
parameter. This is specified in seconds by default, though
you can append &acirc;ms&acirc;, &acirc;m&acirc;, or
&acirc;h&acirc; to the value to specify milliseconds,
minutes, or hours <br>
(&acirc;s&acirc; for seconds is redundant). So the cd
(connection delay) arguments 900000ms, 900s, and 15m all do
the same thing.</p>

<p style="margin-top: 1em">cl num-minconnections; CL
num-maxconnections (Adjust number of concurrent parallel
connections)</p>

<p style="margin-top: 1em">Connection Limit</p>

<p style="margin-top: 1em">These options control the total
number of connections that may be outstanding for any
service at the same time. Normally, Ncrack tries to
dynamically adjust the number of <br>
connections for each individual target by counting how many
drops or connection failures happen. If a strange network
condition occurs, that signifies that something may be <br>
going wrong, like the host dropping any new connection
attempts, then Ncrack will immediately lower the total
number of connections hitting the service. However, the caps
<br>
number of the minimum or maximum connections that will take
place can be overriden using these two options. By properly
adjusting them, you can essentially optimize <br>
performance, if you can handle the tricky part of knowing or
discovering your target&Acirc;&acute;s own limits. The
convention here is that cl with lowercase letters is
referring to the <br>
minimum connection limit, while CL with uppercase letters is
referring to the maximum number of connections.</p>

<p style="margin-top: 1em">The most common usage is to set
cl (minimum connection limit) for targets that you are
almost certain are going to withstand these many connections
at any given time. This is <br>
a risky option to play with, as setting it too high might
actually do more harm than good by effectively DoS-attacking
the target and triggering firewall rules that will ban <br>
your IP address.</p>

<p style="margin-top: 1em">On the other hand, for more
stealthy missions, setting the CL (maximum connection limit)
to a low value might be what you want. However, setting it
too low will surely have a <br>
great impact in overall cracking speed. For maximum stealth,
this can be combined with the cd (connection delay)
described below.</p>

<p style="margin-top: 1em">at num-attempts (Adjust
authentication attempts per connection)</p>

<p style="margin-top: 1em">Authentication Tries</p>

<p style="margin-top: 1em">Using this option, you can order
Ncrack to limit the authentication attempts it carries out
per connection. Ncrack initially sends a reconnaisance probe
that lets it <br>
calculate the maximum number of such authentication tries
and from thereon it always tries to use that number. Most
servicse pose an upper limit on the number of <br>
authentication per connection and in most cases finding that
maximum leads to better performance.</p>

<p style="margin-top: 1em">Setting this option to lower
values can give you some stealth bonus, since services such
as SSH tend to log failed attempts after more than a certain
number of authentication <br>
tries per connection. They use that as a metric rather than
counting the total number of authentication attempts or
connections per IP address (which is usually done by a <br>
firewall). Consequently, a number of 1 or 2 authentication
tries might circumvent logging in some cases.</p>

<p style="margin-top: 1em">Note that setting that option to
a high value will not have any effect if Ncrack realizes
that the server doesn&Acirc;&acute;t allow that many
attempts per connection. In this case, it <br>
will just use that maximum number and ignore your
setting.</p>

<p style="margin-top: 1em">cd time (Adjust delay time
between each new connection)</p>

<p style="margin-top: 1em">Connection Delay</p>

<p style="margin-top: 1em">This option essentially defines
the imposed time delay between each new connection. Ncrack
will wait the amount of time you specify in this option
value, before starting a <br>
new connection against the given service. The higher you set
it, the slower Ncrack will perform, but the stealthier your
attack will become.</p>

<p style="margin-top: 1em">Ncrack by default tries to
initiate new connections as fast as possible given that new
probes are actually allowed to be sent and are not
restricted by parameters such as <br>
Connection Limit which can dynamically increase or decrease.
Although this approach achieves blazing speed as long as the
host remains responsive, it can lead to a number of <br>
disasters such as a firewall being triggered, the
targets&Acirc;&acute; or your bandwidth to be diminished and
even the tested service to suffer a Denial of Service
attack. By carefully <br>
adjusting this option, you can potentially avoid these
annoying situations.</p>

<p style="margin-top: 1em">cr max-conattempts (Adjust the
max number of connection attempts)</p>

<p style="margin-top: 1em">Connection Retries</p>

<p style="margin-top: 1em">NOT IMPLEMENTED YET.</p>

<p style="margin-top: 1em">to time (Adjust the maximum
overall cracking time)</p>

<p style="margin-top: 1em">Timeout</p>

<p style="margin-top: 1em">Define how much time Ncrack is
going to spend cracking the service, before giving up
regardless of whether it has found any credentials so far.
However, any authentication <br>
token discovered until that time, will be stored and printed
normally. Ncrack marks a service as finished when the
username/password lists iteration ends or when it can no
<br>
longer crack it for some serious reason. If Ncrack finishes
cracking a service before the time specified in this option,
then it will not be taken into account at all.</p>

<p style="margin-top: 1em">Sometimes, you have a limited
time window to scan/crack your hosts. This might occur for
various reasons. A common one would be that normal user
activity mustn&Acirc;&acute;t be <br>
interrupted and since Ncrack can become very aggressive, it
might be allowed to scan the hosts only at during certain
time period like the night hours. Scanning during <br>
certain such hours is also likely to make an attack less
detectable.</p>

<p style="margin-top: 1em">Don&Acirc;&acute;t forget that
Ncrack allows you to specify the time unit of measure by
appending &acirc;ms&acirc;, &acirc;m&acirc;, or
&acirc;h&acirc; for milliseconds, minutes or hours (seconds
is the default time unit). <br>
Using them in this particular option, is really convenient
as you can specify something like to=8h to give Ncrack a
total of 8 hours to crack that service. Setting up <br>
cronjobs for scheduled scans in combination with this
option, might also be a good idea.</p>

<p style="margin-top: 1em">-T
paranoid|sneaky|polite|normal|aggressive|insane (Set a
timing template) . <br>
While the fine-grained timing controls discussed in the
previous section are powerful and effective, some people
find them confusing. Moreover, choosing the appropriate <br>
values can sometimes take more time than the scan you are
trying to optimize. So Ncrack offers a simpler approach,
with six timing templates. You can specify them with the -T
<br>
option and their number (0&acirc;5) or their name. The
template names are paranoid (0), sneaky (1), polite (2),
normal (3), aggressive (4), and insane (5). The first two
are for <br>
IDS evasion. Polite mode slows down the scan to use less
bandwidth and target machine resources. Normal mode is the
default and so -T3 does nothing. Aggressive mode speeds <br>
scans up by making the assumption that you are on a
reasonably fast and reliable network. Finally insane mode
assumes that you are on an extraordinarily fast network or
are <br>
willing to sacrifice some accuracy for speed.</p>

<p style="margin-top: 1em">These templates allow the user
to specify how aggressive they wish to be, while leaving
Ncrack to pick the exact timing values. If you know that the
network service is going <br>
to withstand a huge number of connections you might try
using the aggressive template of -T4 . Even then, this is
mostly advised for services residing in the local network.
<br>
Going over to insane mode -T5 is not recommended, unless you
absolutely know what you are doing.</p>

<p style="margin-top: 1em">While -T0. and -T1. may be
useful for avoiding IDS alerts, they will take an
extraordinarily long time to crack even a few services. For
such a long scan, you may prefer to <br>
set the exact timing values you need rather than rely on the
canned -T0 and -T1 values.</p>

<p style="margin-top: 1em">--connection-limit numprobes
(Adjust the threshold of total concurrent connections) <br>
NOT IMPLEMENTED YET.</p>

<p style="margin-top: 1em">AUTHENTICATION <br>
This section describes ways of specifying your own username
and password lists as well as the available modes of
iterating over them. Ncrack ships in with a variety of
username <br>
and password lists which reside under the directory
&Acirc;&acute;lists&Acirc;&acute; of the source tarball and
later installed under Ncrack&Acirc;&acute;s data directory
which usually is /usr/local/share/ncrack or <br>
/usr/share/ncrack . You can omit specifying any lists and
Ncrack is going to use the default ones which contain some
of the most common usernames and passwords. The password
list <br>
is frequency-sorted with the top most common passwords at
the beginning of the list so they will be tried out first.
The lists have been derived from a combination of sorting
<br>
publicly leaked password files and other techniques.</p>

<p style="margin-top: 1em">-U filename (Specify username
list) <br>
Specify your own username list by giving the path to the
filename as argument to this option.</p>

<p style="margin-top: 1em">Usernames for specific
environments can be gathered in numerous ways including
harvesting for email-addresses in the company&Acirc;&acute;s
website, looking up information in whois <br>
databases, using the SMTP VRFY technique at vulnerable mail
servers or through social engineering.</p>

<p style="margin-top: 1em">-P filename (Specify password
list) <br>
Specify your own password list by giving the path to the
filename as argument to this option.</p>

<p style="margin-top: 1em">Common passwords are usually
derived from leaked lists as a result of successful
intrusions in public sites such as forums or other social
networking places. A great deal of <br>
them have already been publicly disclosed and some of these
have been used to assemble Ncrack&Acirc;&acute;s own
lists.</p>

<p style="margin-top: 1em">--user username_list (Specify
command-line comma-separated username list) <br>
Specify your own usernames directly in the command-line as a
comma-separated list.</p>

<p style="margin-top: 1em">--pass password_list (Specify
command-line comma-separated password list) <br>
Specify your own passwords directly in the command-line as a
comma-separated list.</p>

<p style="margin-top: 1em">--passwords-first (Reverse the
way passwords are iterated) <br>
Ncrack by default iterates the username list for each
password. With this option, you can reverse that. For
example, given the username list of -&gt; &quot;root, guest,
admin&quot; and <br>
the password list of &quot;test, 12345, q1w2e3r4&quot;
Ncrack will normally go over them like this -&gt; root:test,
guest:test, admin:test, root:12345 etc. By enabling this
option it will <br>
go over them like this -&gt; root:test, root:12345,
root:q1w2e3r4, guest:test etc.</p>

<p style="margin-top: 1em">Most network authentication
cracking tools prefer by default to iterate the password
list for each username. This is, however, ineffective
compared to the opposite iteration <br>
in most cases. This holds true for the simple reason that
password lists are usually sorted on a frequency basis,
meaning that the more common a password is, the closer to
<br>
the beginning of the password list it is. Thus, iterating
over all usernames for the most common passwords first has
usually more chances to get a positive result. With the <br>
--passwords-first iteration, very common passwords might not
even be tried out for certain usernames if the user chooses
to abort the session early. However, this option <br>
might prove valuable for cases where the attacker knows and
has already verified that the username list contains real
usernames, instead of blindly bruteforcing through them.</p>

<p style="margin-top: 1em">--pairwise (Choose usernames and
passwords in pairs) <br>
Enabling this option will make Ncrack iterate the username
and password list by choosing them in pairs. For example,
given the username list of &quot;root, guest, admin&quot;
and the <br>
password list of &quot;test, 12345, q1w2e3r4&quot; Ncrack
will go over them like this: &quot;root:test&quot;,
&quot;guest:12345&quot;, &quot;admin:q1w2e3r4&quot;. This is
particulary useful when inside knowledge of <br>
the infrastructure tested is available and special username
and password lists have been made.</p>

<p style="margin-top: 1em">OUTPUT <br>
Any security tool is only as useful as the output it
generates. Complex tests and algorithms are of little value
if they aren&Acirc;&acute;t presented in an organized and
comprehensible <br>
fashion. Of course, no single format can please everyone. So
Ncrack offers several formats, including the interactive
mode for humans to read directly and XML for easy parsing by
<br>
software.</p>

<p style="margin-top: 1em">In addition to offering
different output formats, Ncrack provides options for
controlling the verbosity of output as well as debugging
messages. Output types may be sent to <br>
standard output or to named files, which Ncrack can append
to or clobber.</p>

<p style="margin-top: 1em">Ncrack makes output available in
three different formats. The default is called interactive
output, and it is sent to standard output (stdout). There is
also normal output, which <br>
is similar to interactive except that it displays less
runtime information and warnings since it is expected to be
analyzed after the scan completes rather than
interactively.</p>

<p style="margin-top: 1em">XML output is one of the most
important output types, as it can be converted to HTML,
easily parsed by programs such as Ncrack graphical user
interfaces, or imported into <br>
databases. Currently, XML output hasn&Acirc;&acute;t been
implemented.</p>

<p style="margin-top: 1em">While interactive output is the
default and has no associated command-line options, the
other two format options use the same syntax. They take one
argument, which is the <br>
filename that results should be stored in. Multiple formats
may be specified, but each format may only be specified
once. For example, you may wish to save normal output for
your <br>
own review while saving XML of the same scan for
programmatic analysis. You might do this with the options
-oX myscan.xml -oN myscan.ncrack. While this chapter uses
the simple <br>
names like myscan.xml for brevity, more descriptive names
are generally recommended. The names chosen are a matter of
personal preference. A scheme could be using long filenames
<br>
that incorporate the scan date and a word or two describing
the scan, placed in a directory named after the company that
is being scanned.</p>

<p style="margin-top: 1em">While these options save results
to files, Ncrack still prints interactive output to stdout
as usual. For example, the command nmap -oX myscan.xml
[target] prints XML to <br>
myscan.xml and fills standard output with the same
interactive results it would have printed if -oX
wasn&Acirc;&acute;t specified at all. You can change this by
passing a hyphen character as <br>
the argument to one of the format types. This causes Ncrack
to deactivate interactive output, and instead print results
in the format you specified to the standard output stream.
<br>
So the command nmap -oX - target will send only XML output
to stdout. Serious errors may still be printed to the normal
error stream, stderr.</p>

<p style="margin-top: 1em">Unlike some Ncrack arguments,
the space between the logfile option flag (such as -oX) and
the filename or hyphen is mandatory.</p>

<p style="margin-top: 1em">All of these arguments support
strftime-like conversions in the filename. %H, %M, %S, %m,
%d, %y, and %Y are all exactly the same as in strftime. %T
is the same as %H%M%S, %R <br>
is the same as %H%M, and %D is the same as %m%d%y. A %
followed by any other character just yields that character
(%% gives you a percent symbol). So -oX
&Acirc;&acute;scan-%T-%D.xml&Acirc;&acute; will <br>
use an XML file in the form of scan-144840-121307.xml.</p>

<p style="margin-top: 1em">Ncrack also offers options to
control scan verbosity and to append to output files rather
than clobbering them. All of these options are described
below.</p>

<p style="margin-top: 1em">Ncrack Output Formats</p>

<p style="margin-top: 1em">-oN filespec (normal output) .
<br>
Requests that normal output be directed to the given
filename. As discussed above, this differs slightly from
interactive output.</p>

<p style="margin-top: 1em">-oX filespec (XML output) . <br>
Requests that XML output be directed to the given filename.
Currently this is not implemented.</p>

<p style="margin-top: 1em">-oA basename (Output to all
formats) . <br>
As a convenience, you may specify -oA basename to store scan
results in normal and XML formats at once. They are stored
in basename.ncrack, and basename.xml respectively. As <br>
with most programs, you can prefix the filenames with a
directory path, such as ~/ncracklogs/foocorp/ on Unix or
c:king on Windows.</p>

<p style="margin-top: 1em">Verbosity and debugging
options</p>

<p style="margin-top: 1em">-v (Increase verbosity level) .
<br>
Increases the verbosity level, causing Ncrack to print more
information about the scan in progress. Credentials are
shown as they are found and more statistical information
<br>
is printed in the end. Use it twice or more for even greater
verbosity.</p>

<p style="margin-top: 1em">-d [level] (Increase or set
debugging level) . <br>
When even verbose mode doesn&Acirc;&acute;t provide
sufficient data for you, debugging is available to flood you
with much more! As with the verbosity option (-v), debugging
is enabled <br>
with a command-line flag (-d) and the debug level can be
increased by specifying it multiple times. Alternatively,
you can set a debug level by giving an argument to -d. For
<br>
example, -d10 sets level ten. That is the highest effective
level and will produce thousands of lines, unless your
cracking session is going really slow.</p>

<p style="margin-top: 1em">Debugging output is useful when
a bug is suspected in Ncrack, or if you are simply confused
as to what Ncrack is doing and why. As this feature is
mostly intended for <br>
developers, debug lines aren&Acirc;&acute;t always
self-explanatory. If you don&Acirc;&acute;t understand a
line, your only recourses are to ignore it, look it up in
the source code, or request help <br>
from the development list (nmap-dev). Some lines are self
explanatory, but the messages become more obscure as the
debug level is increased.</p>

<p style="margin-top: 1em">--nsock-trace level (Set nsock
trace level) . <br>
This option is meant mostly for developers as enabling it
will activate the Nsock&Acirc;&acute;s library debugging
output. Nsock is the underlying library for parallel socket
handling. <br>
You will have to specify a certain level for this option.
Valid range is 0 up to 10. Usually, a level of 1 or 2 is
enough to get a good overview of network operations <br>
happening behind the scenes. Nsock prints that information
to stdout by default.</p>

<p style="margin-top: 1em">--log-errors (Log
errors/warnings to normal mode output file) . <br>
Warnings and errors printed by Ncrack usually go only to the
screen (interactive output), leaving any normal-format
output files (usually specified with -oN) uncluttered. <br>
When you do want to see those messages in the normal output
file you specified, add this option. It is useful when you
aren&Acirc;&acute;t watching the interactive output or when
you want <br>
to record errors while debugging a problem. The error and
warning messages will still appear in interactive mode too.
This won&Acirc;&acute;t work for most errors related to bad
<br>
command-line arguments because Ncrack may not have
initialized its output files yet.</p>

<p style="margin-top: 1em">An alternative to --log-errors
is redirecting interactive output (including the standard
error stream) to a file. Most Unix shells make this approach
easy, though it can be <br>
difficult on Windows.</p>

<p style="margin-top: 1em">Miscellaneous output options</p>

<p style="margin-top: 1em">--append-output (Append to
rather than clobber output files) . <br>
When you specify a filename to an output format flag such as
-oX or -oN, that file is overwritten by default. If you
prefer to keep the existing content of the file and <br>
append the new results, specify the --append-output option.
All output filenames specified in that Ncrack execution will
then be appended to rather than clobbered. This <br>
doesn&Acirc;&acute;t work well for XML (-oX) scan data as
the resultant file generally won&Acirc;&acute;t parse
properly until you fix it up by hand.</p>

<p style="margin-top: 1em">MISCELLANEOUS OPTIONS <br>
This section describes some important (and not-so-important)
options that don&Acirc;&acute;t really fit anywhere
else.</p>

<p style="margin-top: 1em">--resume file (Continue
previously saved session) . <br>
Whenever the user cancels a running session (usually by
pressing Ctrl+C), Ncrack saves the current state into a file
which it can later use to continue from where it had <br>
stopped. This file is saved in subdirectory .ncrack/ of the
user&Acirc;&acute;s home path with a filename format of
&quot;restore.YY-MM-DD_hh-mm&quot;. An example would be:
<br>

&quot;/home/ithilgore/.ncrack/restore.2010-05-18_04-42&quot;.
You can then continue your session, by specifying this file
as argument to the --resume option.</p>

<p style="margin-top: 1em">-f (Quit cracking service after
one found credential) . <br>
This option will force Ncrack to quit cracking a service as
soon as it finds a valid username/password combination for
it. Assuming many parallel services are being cracked <br>
at the same time, this option is applied on each of them
separately. This means that Ncrack will stop cracking each
individual service after finding a pair of credentials for
<br>
it, but will not quit entirely. Supplying the option two
times, like -f -f will, however, make Ncrack exit
immediately as soon as it finds a valid credential for any
service.</p>

<p style="margin-top: 1em">Frequently, attackers will try
cracking several services in parallel to maximize the
chances of finding a pair of valid credentials. Given that a
network is no stronger than <br>
its weakest link, this option and especially the -f -f
counterpart will often be used to lessen chances of
detection and prevent network resources from being wasted
<br>
aimlessly.</p>

<p style="margin-top: 1em">-6 (Enable IPv6 scanning) . <br>
Warning: This option was just added and it is currently
experimental, so please notify us for any problems and bugs
related to it.</p>

<p style="margin-top: 1em">The command syntax is the same
as usual except that you also add the -6 option. Of course,
you must use IPv6 syntax if you specify an address rather
than a hostname. An <br>
address might look like
3ffe:7501:4819:2000:210:f3ff:fe03:14d0, so hostnames are
recommended. The output looks the same as usual, with the
IPv6 address on the &acirc;Discovered <br>
credentials&acirc; line being the only IPv6 give away.</p>

<p style="margin-top: 1em">While IPv6 hasn&Acirc;&acute;t
exactly taken the world by storm, it gets significant use in
some (usually Asian) countries and most modern operating
systems support it. To use Ncrack with <br>
IPv6, both the source and target of your scan must be
configured for IPv6. If your ISP (like most of them) does
not allocate IPv6 addresses to you, free tunnel brokers are
<br>
widely available and will probably work fine with Ncrack. A
popular IPv6 tunnel broker service is at
http://www.tunnelbroker.net. 6to4 tunnels are another
popular, free <br>
approach.</p>

<p style="margin-top: 1em">-sL (List Scan) . <br>
The list scan simply lists each host and service that would
be cracked if this option wasn&Acirc;&acute;t specified. No
packets are sent to the target hosts and the only network
operation <br>
that might happen is DNS-resolution of any hostnames of
targets. This option is really helpful in making sure that
you have specified everything as you wanted. <br>
Service-specific options will also be printed so this acts
as a good sanity check of potentially complex command-line
arguments such as the advanced modes of Service Option <br>
Specification and the equivalent Hierarchy for sessions that
require delicate timing handling. If list scan is called
along with the -d debug option, then additional output, <br>
like the ServicesTable and the current
Timing-Template&Acirc;&acute;s parameters, is also going to
be printed.</p>

<p style="margin-top: 1em">--datadir directoryname (Specify
custom Ncrack data file location) . <br>
Ncrack needs a file called ncrack-services to load a
lookup-table of supported services/ports. This file
shouldn&Acirc;&acute;t be changed, unless you know what you
are doing (e.g <br>
extending Ncrack for additional modules). In addition,
Ncrack is shipped with various username and password lists,
some of which are used by default in case the user
doesn&Acirc;&acute;t <br>
specify ones of his own. All these files are normally copied
during the installation procedure to a directory such as
/usr/share/ncrack or /usr/local/share/ncrack . Using the
<br>
--datadir option, will force Ncrack to start searching for
these files in specified directory. If the files
aren&Acirc;&acute;t found, then it will continue searching
in the directory <br>
specified by the NCRACKDIR environmental variable NCRACKDIR
(if it is defined). Next comes ~/.ncrack directory for real
and effective UIDs (POSIX systems only) or location of <br>
the Ncrack executable (Win32 only), and then a compiled-in
location such as /usr/local/share/ncrack or
/usr/share/ncrack. As a last resort, Ncrack will look in the
current <br>
directory.</p>

<p style="margin-top: 1em">--proxy type://proxy:port (Make
connections via socks4, 4a, http) . <br>
This will make Ncrack perform the authentication cracking
session through the proxy host specified.</p>

<p style="margin-top: 1em">-V; --version (Print version
number) . <br>
Prints the Ncrack version number and exits.</p>

<p style="margin-top: 1em">-h; --help (Print help summary
page) . <br>
Prints a short help screen with the most common command
flags. Running Ncrack without any arguments does the same
thing.</p>

<p style="margin-top: 1em">RUNTIME INTERACTION <br>
During the execution of Ncrack, all key presses are
captured. This allows you to interact with the program
without aborting and restarting it. Certain special keys
will change <br>
options, while any other keys will print out a status
message telling you about the scan. The convention is that
lowercase letters increase the amount of printing, and
uppercase <br>
letters decrease the printing. You may also press
&acirc;?&acirc; for help.</p>

<p style="margin-top: 1em">v / V <br>
Increase / decrease the verbosity level</p>

<p style="margin-top: 1em">d / D <br>
Increase / decrease the debugging Level</p>

<p style="margin-top: 1em">p / P <br>
Display found credentials</p>

<p style="margin-top: 1em">? <br>
Print a runtime interaction help screen</p>

<p style="margin-top: 1em">Anything else <br>
Print out a status message like this:</p>

<p style="margin-top: 1em">Stats: 0:00:20 elapsed; 0
services completed (1 total)</p>

<p style="margin-top: 1em">Rate: 6.26; Found: 1; About
13.27% done; ETC: 21:06 (0:02:17 remaining)</p>

<p style="margin-top: 1em">MODULES <br>
Ncrack&Acirc;&acute;s architecture is modular with each
module corresponding to one particular service or protocol.
Currently, Ncrack supports the protocols FTP, Telnet, SSH,
RDP, VNC, <br>
HTTP(S), POP3(S), SIP, Redis and PostgreSQL. If you want to
write and contribute your own Ncrack modules, be sure to
read the Ncrack Developer&Acirc;&acute;s Guide at <br>
http://nmap.org/ncrack/devguide.html Below we describe some
key points for each of them.</p>

<p style="margin-top: 1em">FTP Module</p>

<p style="margin-top: 1em">FTP authentication is quite
fast, since there is very little protocol negotiation
overhead. Most FTP daemons allow 3 to 6 authentication
attempts but usually impose a certain <br>
delay before replying with the results of a failed attempt.
Filezilla is one of the most characteristic examples of this
case, where the time delay is so great, that it is <br>
usually faster to open more connections against it, with
each of them doing only 1 authentication per connection.</p>

<p style="margin-top: 1em">Telnet Module</p>

<p style="margin-top: 1em">Telnet daemons have been largely
substituded by their safer
&Acirc;&acute;counterpart&Acirc;&acute; of SSH. However,
there are many boxes, mainly routers or printers, that still
rely on Telnet for <br>
remote access. Usually these are also easier to crack, since
default passwords for them are publicly known. The drawback
is that telnet is a rather slow protocol, so you <br>
shouldn&Acirc;&acute;t be expecting really high rates
against it.</p>

<p style="margin-top: 1em">SSH Module</p>

<p style="margin-top: 1em">SSH is one of the most prevalent
protocols in today&Acirc;&acute;s networks. For this reason,
a special library, named opensshlib and based on code from
OpenSSH, was specifically built <br>
and tailored for Ncrack&Acirc;&acute;s needs. Opensshlib
ships in with Ncrack, so SSH support comes out of the box.
OpenSSL will have to be installed in Unix systems though.
Windows <br>
OpenSSL dlls are included in Ncrack, so Windows users
shouldn&Acirc;&acute;t be worrying about it at all.</p>

<p style="margin-top: 1em">SSH bruteforcing holds many
pitfalls and challenges, and you are well advised to read a
paper that was written to explain them. The latest version
of the &quot;Hacking the OpenSSH <br>
library for Ncrack&quot; document can be found under
docs/openssh_library.txt or at
http://sock-raw.org/papers/openssh_library</p>

<p style="margin-top: 1em">HTTP(S) Module</p>

<p style="margin-top: 1em">The HTTP Module currently
supports basic and digest authentication. Ncrack tries to
use the &quot;Keepalive&quot; HTTP option, whenever
possible, which leads to really high speeds, <br>
since that allows dozens of attempts to be carried out per
connection. The HTTP module can also be called over SSL.</p>

<p style="margin-top: 1em">SMB Module</p>

<p style="margin-top: 1em">The SMB module currently works
over raw TCP. NetBIOS isn&Acirc;&acute;t supported yet. This
protocol allows for high parallelization, so users could
potentially increase the number of <br>
concurrent probes against it. SMB is frequently used for
file-sharing among other things and is one of the most
ubiquitous protocols, being present in both Unix and Windows
<br>
environments.</p>

<p style="margin-top: 1em">RDP Module</p>

<p style="margin-top: 1em">RDP (Remote Desktop Protocol) is
a proprietary protocol developed by Microsoft for the
purpose of providing remote terminal services by transfering
graphics display <br>
information from the remote computer to the user and
transporting input commands from the user to the remote
computer. Fortunately, Microsoft recently decided to open
the <br>
protocol&Acirc;&acute;s internal workings to the public and
has provided official documentation, which can be found at
http://msdn.microsoft.com/en-us/library/cc240445%28v=PROT.10%29.aspx</p>

<p style="margin-top: 1em">RDP is one of the most complex
protocols, requiring the exchange of many packets, even for
just the authentication phase. For this reason, cracking it
takes a lot of time and <br>
this is probably the slowest module. The connection phase is
briefly described at
http://msdn.microsoft.com/en-us/library/cc240452%28v=PROT.10%29.aspx
where you can also see <br>
a diagram of the various packets involved. Care must be
taken against RDP servers in Windows XP versions, since they
can&Acirc;&acute;t handle multiple connections at the same
time. It is <br>
advised to use a very slow timing template or even better
limit the maximum parallel connections using timing options
such as CL (Connection Limit) or cd (connection delay) <br>
against Windows XP (and relevant) RDP servers. Windows Vista
and above don&Acirc;&acute;t suffer from the same
limitation.</p>

<p style="margin-top: 1em">VNC Module</p>

<p style="margin-top: 1em">The VNC protocol has known
widespread usage among Unix administrators and users for
remote graphical access. VNC is perhaps one of the most
vulnerable protocols in terms of <br>
brute-forcing, since it often requires a password without a
corresponding username for authentication. In addition, some
versions of VNC impose an 8-character limit in <br>
password length. You should consider adding the
--passwords-first option when cracking VNC systems to
exploit the fact that the username often has no actual
importance in <br>
authentication.</p>

<p style="margin-top: 1em">POP3(S) Module</p>

<p style="margin-top: 1em">POP3 support is still
experimental and hasn&Acirc;&acute;t been thoroughly tested.
You can expect it to work against common mail servers,
nevertheless.</p>

<p style="margin-top: 1em">SIP Module</p>

<p style="margin-top: 1em">The Session Initiation Protocol
is a text-based protocol, very similar to HTTP in its
structure. The most common application of SIP is in Internet
telephony for voice and <br>
video calls. Nearly all enterprises have infrastructure that
supports conference calls and part of them are based on SIP,
making the authentication part a significant threat <br>
vector.</p>

<p style="margin-top: 1em">Redis Module</p>

<p style="margin-top: 1em">Redis is one of the most widely
used caching servers and the most popular NoSQL database.
Despite its reputation, the authentication mechanism is very
simple, only allowing <br>
for a password to protect remote access to the service. Due
to the high performance of Redis and the fact that only 2
packets are needed for the authentication phase, Ncrack <br>
can try a lot of passwords in parallel
(http://redis.io/commands/AUTH). Specifying a username list
or single username will have no effect in this module, since
Redis only <br>
deals with passwords.</p>

<p style="margin-top: 1em">PostgreSQL Module</p>

<p style="margin-top: 1em">PostgreSQL is often used as a
backend database. The PostgreSQL module supports md5
authentication, which is the most frequent password
authentication method.</p>

<p style="margin-top: 1em">MySQL Module</p>

<p style="margin-top: 1em">The MySQL module supports native
authentication.</p>

<p style="margin-top: 1em">BUGS <br>
Like its authors, Ncrack isn&Acirc;&acute;t perfect. But you
can help make it better by sending bug reports or even
writing patches. If Ncrack doesn&Acirc;&acute;t behave the
way you expect, first upgrade <br>
to the latest version available from http://nmap.org/ncrack.
If the problem persists, do some research to determine
whether it has already been discovered and addressed. Try
<br>
searching for the error message on our search page at
http://insecure.org/search.html or at Google. Also try
browsing the nmap-dev archives at http://seclists.org/ .
Read this <br>
full manual page as well. If you are developing your own
Ncrack module, make sure you have first read the Ncrack
Developer&Acirc;&acute;s Guide at
http://nmap.org/ncrack/devguide.html . If <br>
nothing comes of this, mail a bug report to
nmap-dev@insecure.org . Please include everything you have
learned about the problem, as well as what version of Ncrack
you are <br>
running and what operating system version it is running on.
Problem reports and Ncrack usage questions sent to
nmap-dev@insecure.org are far more likely to be answered
than those <br>
sent to Fyodor directly. If you subscribe to the nmap-dev
list before posting, your message will bypass moderation and
get through more quickly. Subscribe at <br>
http://cgi.insecure.org/mailman/listinfo/nmap-dev .</p>

<p style="margin-top: 1em">Code patches to fix bugs are
even better than bug reports. Basic instructions for
creating patch files with your changes are available at
http://nmap.org/data/HACKING . Patches <br>
may be sent to nmap-dev (recommended) or to Fyodor
directly.</p>

<p style="margin-top: 1em">AUTHORS <br>
ithilgore (Fotis Hantzis) ithilgore.ryu.l@gmail.com
(http://sock-raw.org)</p>

<p style="margin-top: 1em">Fyodor fyodor@insecure.org
(http://insecure.org)</p>

<p style="margin-top: 1em">NCRACK COPYRIGHT AND LICENSING
<br>
While it isn&Acirc;&acute;t distributed with Nmap, Ncrack is
part of the Nmap project and falls under the same license
and (non) warranty provisions, as described at <br>
http://nmap.org/book/man-legal.html.</p>

<p style="margin-top: 1em">Ncrack 04/06/2016 NCRACK(1)</p>
<hr>
</body>
</html>
