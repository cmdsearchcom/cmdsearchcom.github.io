<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>XA(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">XA(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">XA(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
xa - 6502/R65C02/65816 cross-assembler
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>xa</b> [ <i>OPTION</i>]... <i>FILE</i>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>xa</b> is a multi-pass cross-assembler for the 8-bit processors in the 6502
  series (such as the 6502, 65C02, 6504, 6507, 6510, 7501, 8500, 8501 and 8502),
  the Rockwell R65C02, and the 16-bit 65816 processor. For a description of
  syntax, see <b>ASSEMBLER SYNTAX</b> further in this manual page.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v</b></dt>
  <dd class="It-tag">Verbose output.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-x</b></dt>
  <dd class="It-tag">Use old filename behaviour (overrides <b>-o</b>, <b>-e</b>
      and <b>-l</b>). This option is now deprecated.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-C</b></dt>
  <dd class="It-tag">No CMOS opcodes (default is to allow R65C02 opcodes)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-W</b></dt>
  <dd class="It-tag">No 65816 opcodes (default).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-w</b></dt>
  <dd class="It-tag">Allow 65816 opcodes.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-B</b></dt>
  <dd class="It-tag">Show lines with block open/close (see
    <b>PSEUDO-OPS</b>).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c</b></dt>
  <dd class="It-tag">Produce o65 object files instead of executable files (no
      linking performed); files may contain undefined references.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-o filename</b></dt>
  <dd class="It-tag">Set output filename. The default is <b>a.o65</b>; use the
      special filename <b>-</b> to output to standard output.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-e filename</b></dt>
  <dd class="It-tag">Set errorlog filename, default is none.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l filename</b></dt>
  <dd class="It-tag">Set labellist filename, default is none. This is the symbol
      table and can be used by disassemblers such as <b>dxa</b>(1) to
      reconstruct source.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-r</b></dt>
  <dd class="It-tag">Add cross-reference list to labellist (requires
    <b>-l</b>).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-M</b></dt>
  <dd class="It-tag">Allow colons to appear in comments; for MASM compatibility.
      This does not affect colon interpretation elsewhere.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-R</b></dt>
  <dd class="It-tag">Start assembler in relocating mode.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-Llabel</b></dt>
  <dd class="It-tag">Defines <b>label</b> as an absolute (but undefined) label
      even when linking.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-b? addr</b></dt>
  <dd class="It-tag">Set segment base for segment <b>?</b> to address
      <b>addr</b>. <b>?</b> should be t, d, b or z for text, data, bss or zero
      segments, respectively.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-A addr</b></dt>
  <dd class="It-tag">Make text segment start at an address such that when the
      file starts at address <b>addr</b>, relocation is not necessary. Overrides
      <b>-bt</b>; other segments still have to be taken care of with <b>-b</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-G</b></dt>
  <dd class="It-tag">Suppress list of exported globals.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-DDEF=TEXT</b></dt>
  <dd class="It-tag">Define a preprocessor macro on the command line (see
      <b>PREPROCESSOR</b>).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-I dir</b></dt>
  <dd class="It-tag">Add directory <b>dir</b> to the include path (before
      <b>XAINPUT</b>; see <b>ENVIRONMENT</b>).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-O charset</b></dt>
  <dd class="It-tag">Define the output charset for character strings. Currently
      supported are ASCII (default), PETSCII (Commodore ASCII), PETSCREEN
      (Commodore screen codes) and HIGH (set high bit on all characters).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p?</b></dt>
  <dd class="It-tag">Set the alternative preprocessor character to <b>?</b>.
      This is useful when you wish to use <b>cpp</b>(1) and the built-in
      preprocessor at the same time (see <b>PREPROCESSOR</b>). Characters may
      need to be quoted for your shell (example: <b>-p'~'</b> ).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">Show summary of options.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--version</b></dt>
  <dd class="It-tag">Show version of program.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="ASSEMBLER_SYNTAX"><a class="selflink" href="#ASSEMBLER_SYNTAX">ASSEMBLER
  SYNTAX</a></h1>
An introduction to 6502 assembly language programming and mnemonics is beyond
  the scope of this manual page. We invite you to investigate any number of the
  excellent books on the subject; one useful title is &quot;Machine Language For
  Beginners&quot; by Richard Mansfield (COMPUTE!), covering the Atari, Commodore
  and Apple 8-bit systems, and is widely available on the used market.
<div class="Pp"></div>
<b>xa</b> supports both the standard NMOS 6502 opcodes as well as the Rockwell
  CMOS opcodes used in the 65C02 (R65C02). With the <b>-w</b> option, <b>xa</b>
  will also accept opcodes for the 65816. NMOS 6502 undocumented opcodes are
  intentionally not supported, and should be entered manually using the
  <b>.byte</b> pseudo-op (see <b>PSEUDO-OPS</b>). Due to conflicts between the
  R65C02 and 65816 instruction sets and undocumented instructions on the NMOS
  6502, their use is discouraged.
<div class="Pp"></div>
In general, <b>xa</b> accepts the more-or-less standard 6502 assembler format as
  popularised by MASM and TurboAssembler. Values and addresses can be expressed
  either as literals, or as expressions; to wit,
<dl class="Bl-tag">
  <dt class="It-tag"><b>123</b></dt>
  <dd class="It-tag">decimal value</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>$234</b></dt>
  <dd class="It-tag">hexadecimal value</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>&amp;123</b></dt>
  <dd class="It-tag">octal</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>%010110</b></dt>
  <dd class="It-tag">binary</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>*</b></dt>
  <dd class="It-tag">current value of the program counter</dd>
</dl>
<div class="Pp"></div>
The ASCII value of any quoted character is inserted directly into the program
  text (example: <b>&quot;A&quot;</b> inserts the byte &quot;A&quot; into the
  output stream); see also the <b>PSEUDO-OPS</b> section. This is affected by
  the currently selected character set, if any.
<div class="Pp"></div>
<b>Labels</b> define locations within the program text, just as in other
  multi-pass assemblers. A label is defined by anything that is not an opcode;
  for example, a line such as
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><b>label1 lda #0</b></dd>
</dl>
<div class="Pp"></div>
defines <b>label1</b> to be the current location of the program counter (thus
  the address of the <b>LDA</b> opcode). A label can be explicitly defined by
  assigning it the value of an expression, such as
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><b>label2 = $d000</b></dd>
</dl>
<div class="Pp"></div>
which defines <b>label2</b> to be the address $d000, namely, the start of the
  VIC-II register block on Commodore 64 computers. The program counter <b>*</b>
  is considered to be a special kind of label, and can be assigned to with
  statements such as
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><b>* = $c000</b></dd>
</dl>
<div class="Pp"></div>
which sets the program counter to decimal location 49152. With the exception of
  the program counter, labels cannot be assigned multiple times. To explicitly
  declare redefinition of a label, place a - (dash) before it, e.g.,
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><b>-label2 = $d020</b></dd>
</dl>
<div class="Pp"></div>
which sets <b>label2</b> to the Commodore 64 border colour register. The scope
  of a label is affected by the block it resides within (see <b>PSEUDO-OPS</b>
  for block instructions). A label may also be hard-specified with the <b>-L</b>
  command line option.
<div class="Pp"></div>
For those instructions where the accumulator is the implied argument (such as
  <b>asl</b> and <b>lsr</b>; <b>inc</b> and <b>dec</b> on R65C02; etc.), the
  idiom of explicitly specifying the accumulator with <b>a</b> is unnecessary as
  the proper form will be selected if there is no explicit argument. In fact,
  for consistency with label handing, if there is a label named <b>a</b>, this
  will actually generate code referencing that label as a memory location and
  not the accumulator. Otherwise, the assembler will complain.
<div class="Pp"></div>
Labels and opcodes may take <b>expressions</b> as their arguments to allow
  computed values, and may themselves reference other labels and/or the program
  counter. An expression such as <b>lab1+1</b> (which operates on the current
  value of label <b>lab1</b> and increments it by one) may use the following
  operands, given from highest to lowest priority:
<dl class="Bl-tag">
  <dt class="It-tag"><b>*</b></dt>
  <dd class="It-tag">multiplication (priority 10)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>/</b></dt>
  <dd class="It-tag">integer division (priority 10)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>+</b></dt>
  <dd class="It-tag">addition (priority 9)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-</b></dt>
  <dd class="It-tag">subtraction (9)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>&lt;&lt;</b></dt>
  <dd class="It-tag">shift left (8)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>&gt;&gt;</b></dt>
  <dd class="It-tag">shift right (8)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>&gt;= =&gt;</b></dt>
  <dd class="It-tag">greater than or equal to (7)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>&lt;</b></dt>
  <dd class="It-tag">greater than (7)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>&lt;= =&lt;</b></dt>
  <dd class="It-tag">less than or equal to (7)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>&lt;</b></dt>
  <dd class="It-tag">less than (7)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>=</b></dt>
  <dd class="It-tag">equal to (6)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>&lt;&gt; &gt;&lt;</b></dt>
  <dd class="It-tag">does not equal (6)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>&amp;</b></dt>
  <dd class="It-tag">bitwise AND (5)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>^</b></dt>
  <dd class="It-tag">bitwise XOR (4)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>|</b></dt>
  <dd class="It-tag">bitwise OR (3)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>&amp;&amp;</b></dt>
  <dd class="It-tag">logical AND (2)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>||</b></dt>
  <dd class="It-tag">logical OR (1)</dd>
</dl>
<div class="Pp"></div>
Parentheses are valid. When redefining a label, combining arithmetic or bitwise
  operators with the = (equals) operator such as <b>+=</b> and so on are valid,
  e.g.,
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><b>-redeflabel += (label12/4)</b></dd>
</dl>
<div class="Pp"></div>
Normally, <b>xa</b> attempts to ascertain the value of the operand and (when
  referring to a memory location) use zero page, 16-bit or (for 65816) 24-bit
  addressing where appropriate and where supported by the particular opcode.
  This generates smaller and faster code, and is almost always preferable.
<div class="Pp"></div>
Nevertheless, you can use these prefix operators to force a particular rendering
  of the operand. Those that generate an eight bit result can also be used in
  8-bit addressing modes, such as immediate and zero page.
<dl class="Bl-tag">
  <dt class="It-tag"><b>&lt;</b></dt>
  <dd class="It-tag">low byte of expression, e.g., <b>lda #&lt;vector</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>&gt;</b></dt>
  <dd class="It-tag">high byte of expression</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>!</b></dt>
  <dd class="It-tag">in situations where the expression could be understood as
      either an absolute or zero page value, do not attempt to optimize to a
      zero page argument for those opcodes that support it (i.e., keep as 16 bit
      word)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>@</b></dt>
  <dd class="It-tag">render as 24-bit quantity for 65816 (must specify <b>-w</b>
      command-line option). <b>This is required to specify any</b> <b>24-bit
      quantity!</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>`</b></dt>
  <dd class="It-tag">force further optimization, even if the length of the
      instruction cannot be reliably determined (see <b>NOTES'N'BUGS</b>)</dd>
</dl>
<div class="Pp"></div>
Expressions can occur as arguments to opcodes or within the preprocessor (see
  <b>PREPROCESSOR</b> for syntax). For example,
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><b>lda label2+1</b></dd>
</dl>
<div class="Pp"></div>
takes the value at <b>label2+1</b> (using our previous label's value, this would
  be $d021), and will be assembled as <b>$ad $21 $d0</b> to disk. Similarly,
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><b>lda #&lt;label2</b></dd>
</dl>
<div class="Pp"></div>
will take the lowest 8 bits of <b>label2</b> (i.e., $20), and assign them to the
  accumulator (assembling the instruction as <b>$a9 $20</b> to disk).
<div class="Pp"></div>
Comments are specified with a semicolon (;), such as
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><b>;this is a comment</b></dd>
</dl>
<div class="Pp"></div>
They can also be specified in the C language style, using <b>/* */</b> and
  <b>//</b> which are understood at the <b>PREPROCESSOR</b> level (q.v.).
<div class="Pp"></div>
Normally, the colon (:) separates statements, such as
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><b>label4 lda #0:sta $d020</b></dd>
</dl>
<div class="Pp"></div>
or
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><b>label2: lda #2</b></dd>
</dl>
<div class="Pp"></div>
(note the use of a colon for specifying a label, similar to some other
  assemblers, which <b>xa</b> also understands with or without the colon). This
  also applies to semicolon comments, such that
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><b>; a comment:lda #0</b></dd>
</dl>
<div class="Pp"></div>
is understood as a comment followed by an opcode. To defeat this, use the
  <b>-M</b> command line option to allow colons within comments. This does not
  apply to <b>/* */</b> and <b>//</b> comments, which are dealt with at the
  preprocessor level (q.v.).
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="PSEUDO-OPS"><a class="selflink" href="#PSEUDO-OPS">PSEUDO-OPS</a></h1>
<b>Pseudo-ops</b> are false opcodes used by the assembler to denote meta- or
  inlined commands. Like most assemblers, <b>xa</b> has a rich set.
<dl class="Bl-tag">
  <dt class="It-tag"><b>.byt value1,value2,value3,...</b></dt>
  <dd class="It-tag">Specifies a string of bytes to be directly placed into the
      assembled object. The arguments may be expressions. Any number of bytes
      can be specified.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>.asc &quot;text1&quot; ,&quot;text2&quot;,...</b></dt>
  <dd class="It-tag">Specifies a character string which will be inserted into
      the assembled object. Strings are understood according to the currently
      specified character set; for example, if ASCII is specified, they will be
      rendered as ASCII, and if PETSCII is specified, they will be translated
      into the equivalent Commodore ASCII equivalent. Other non-standard ASCIIs
      such as ATASCII for Atari computers should use the ASCII equivalent
      characters; graphic and control characters should be specified explicitly
      using <b>.byt</b> for the precise character you want. Note that when
      specifying the argument of an opcode, <b>.asc</b> is not necessary; the
      quoted character can simply be inserted (e.g., <b>lda #&quot;A&quot;</b>
      ), and is also affected by the current character set. Any number of
      character strings can be specified.</dd>
</dl>
<div class="Pp"></div>
<b>.byt</b> and <b>.asc</b> are synonymous, so you can mix things such as
  <b>.byt $43, 22, &quot;a character string&quot;</b> and get the expected
  result. The string is subject to the current character set, but the remaining
  bytes are inserted wtihout modification.
<dl class="Bl-tag">
  <dt class="It-tag"><b>.aasc &quot;text1&quot; ,&quot;text2&quot;,...</b></dt>
  <dd class="It-tag">Specifies a character string that is <b>always</b> rendered
      in true ASCII regardless of the current character set. Like <b>.asc</b>,
      it is synonymous with <b>.byt</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>.word value1,value2,value3...</b></dt>
  <dd class="It-tag">Specifies a string of 16-bit words to be placed into the
      assembled object in 6502 little-endian format (that is,
      low-byte/high-byte). The arguments may be expressions. Any number of words
      can be specified.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>.dsb length,fillbyte</b></dt>
  <dd class="It-tag">Specifies a data block; a total of <b>length</b>
      repetitions of <b>fillbyte</b> will be inserted into the assembled object.
      For example, <b>.dsb 5,$10</b> will insert five bytes, each being 16
      decimal, into the object. The arguments may be expressions.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>.bin offset,length,&quot;filename&quot;</b></dt>
  <dd class="It-tag">Inlines a binary file without further interpretation
      specified by <b>filename</b> from offset <b>offset</b> to length
      <b>length</b>. This allows you to insert data such as a previously
      assembled object file or an image or other binary data structure, inlined
      directly into this file's object. If <b>length</b> is zero, then the
      length of <b>filename</b>, minus the offset, is used instead. The
      arguments may be expressions.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>.(</b></dt>
  <dd class="It-tag">Opens a new block for scoping. Within a block, all labels
      defined are local to that block and any sub-blocks, and go out of scope as
      soon as the enclosing block is closed (i.e., lexically scoped). All labels
      defined outside of the block are still visible within it. To explicitly
      declare a global label within a block, precede the label with <b>+</b> or
      precede it with <b>&amp;</b> to declare it within the previous level only
      (or globally if you are only one level deep). Sixteen levels of scoping
      are permitted.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>.)</b></dt>
  <dd class="It-tag">Closes a block.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>.as .al .xs .xl</b></dt>
  <dd class="It-tag">Only relevant in 65816 mode (with the <b>-w</b> option
      specified). These pseudo-ops set what size accumulator and X/Y-register
      should be used for future instructions; <b>.as</b> and <b>.xs</b> set
      8-bit operands for the accumulator and index registers, respectively, and
      <b>.al</b> and <b>.xl</b> set 16-bit operands. These pseudo-ops on purpose
      do not automatically issue <b>sep</b> and <b>rep</b> instructions to set
      the specified width in the CPU; set the processor bits as you need, or
      consider constructing a macro. <b>.al</b> and <b>.xl</b> generate errors
      if <b>-w</b> is not specified.</dd>
</dl>
<div class="Pp"></div>
The following pseudo-ops apply primarily to relocatable .o65 objects. A full
  discussion of the relocatable format is beyond the scope of this manpage, as
  it is currently a format in flux. Documentation on the proposed v1.2 format is
  in <b>doc/fileformat.txt</b> within the <b>xa</b> installation directory.
<dl class="Bl-tag">
  <dt class="It-tag"><b>.text .data .bss .zero</b></dt>
  <dd class="It-tag">These pseudo-ops switch between the different segments,
      .text being the actual code section, .data being the data segment, .bss
      being uninitialized label space for allocation and .zero being
      uninitialized zero page space for allocation. In .bss and .zero, only
      labels are evaluated. These pseudo-ops are valid in relative and absolute
      modes.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>.align value</b></dt>
  <dd class="It-tag">Aligns the current segment to a byte boundary (2, 4 or 256)
      as specified by <b>value</b> (and places it in the header when relative
      mode is enabled). Other values generate an error.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>.fopt type,value1,value2,value3,...</b></dt>
  <dd class="It-tag">Acts like <b>.byt/.asc</b> except that the values are
      embedded into the object file as file options. The argument <b>type</b> is
      used to specify the file option being referenced. A table of these options
      is in the relocatable o65 file format description. The remainder of the
      options are interpreted as values to insert. Any number of values may be
      specified, and may also be strings.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="PREPROCESSOR"><a class="selflink" href="#PREPROCESSOR">PREPROCESSOR</a></h1>
<b>xa</b> implements a preprocessor very similar to that of the C-language
  preprocessor <b>cpp</b>(1) and many oddiments apply to both. For example, as
  in C, the use of <b>/* */</b> for comment delimiters is also supported in
  <b>xa</b>, and so are comments using the double slash <b>//</b>. The
  preprocessor also supports continuation lines, i.e., lines ending with a
  backslash (\); the following line is then appended to it as if there were no
  dividing newline. This too is handled at the preprocessor level.
<div class="Pp"></div>
For reasons of memory and complexity, the full breadth of the <b>cpp</b>(1)
  syntax is not fully supported. In particular, macro definitions may not be
  forward-defined (i.e., a macro definition can only reference a previously
  defined macro definition), except for macro functions, where recursive
  evaluation is supported; e.g., to <b>#define WW AA</b> , <b>AA</b> must have
  already been defined. Certain other directives are not supported, nor are most
  standard pre-defined macros, and there are other limits on evaluation and line
  length. Because the maintainers of <b>xa</b> recognize that some files will
  require more complicated preparsing than the built-in preprocessor can supply,
  the preprocessor will accept <b>cpp</b>(1)-style line/filename/flags output.
  When these lines are seen in the input file, <b>xa</b> will treat them as
  <b>cc</b> would, except that flags are ignored. <b>xa</b> does not accept
  files on standard input for parsing reasons, so you should dump your
  <b>cpp</b>(1) output to an intermediate temporary file, such as
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><b>cc -E test.s &gt; test.xa</b>
    <div>&#x00A0;</div>
    <b>xa test.xa</b></dd>
</dl>
<div class="Pp"></div>
No special arguments need to be passed to <b>xa</b>; the presence of
  <b>cpp</b>(1) output is detected automatically.
<div class="Pp"></div>
Note that passing your file through <b>cpp</b>(1) may interfere with <b>xa</b>'s
  own preprocessor directives. In this case, to mask directives from
  <b>cpp</b>(1), use the <b>-p</b> option to specify an alternative character
  instead of <b>#</b>, such as the tilde (e.g., <b>-p'~'</b> ). With this option
  and argument specified, then instead of <b>#include</b>, for example, you can
  also use <b>~include</b>, in addition to <b>#include</b> (which will also
  still be accepted by the <b>xa</b> preprocessor, assuming any survive
  <b>cpp</b>(1)). Any character can be used, although frankly pathologic choices
  may lead to amusing and frustrating glitches during parsing. You can also use
  this option to defer preprocessor directives that <b>cpp</b>(1) may interpret
  too early until the file actually gets to <b>xa</b> itself for processing.
<div class="Pp"></div>
The following preprocessor directives are supported.
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>#include &quot;filename&quot;</b></dt>
  <dd class="It-tag">Inserts the contents of file <b>filename</b> at this
      position. If the file is not found, it is searched using paths specified
      by the <b>-I</b> command line option or the environment variable
      <b>XAINPUT</b> (q.v.). When inserted, the file will also be parsed for
      preprocessor directives.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>#echo comment</b></dt>
  <dd class="It-tag">Inserts comment <b>comment</b> into the errorlog file,
      specified with the <b>-e</b> command line option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>#print expression</b></dt>
  <dd class="It-tag">Computes the value of expression <b>expression</b> and
      prints it into the errorlog file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>#define DEFINE text</b></dt>
  <dd class="It-tag">Equates macro <b>DEFINE</b> with text <b>text</b> such that
      wherever <b>DEFINE</b> appears in the assembly source, <b>text</b> is
      substituted in its place (just like <b>cpp</b>(1) would do). In addition,
      <b>#define</b> can specify macro functions like <b>cpp</b>(1) such that a
      directive like <b>#define mult(a,b) ((a)*(b))</b> would generate the
      expected result wherever an expression of the form <b>mult(a,b)</b>
      appears in the source. This can also be specified on the command line with
      the <b>-D</b> option. The arguments of a macro function may be recursively
      evaluated, unlike other <b>#define</b>s; the preprocessor will attempt to
      re-evaluate any argument refencing another preprocessor definition up to
      ten times before complaining.</dd>
</dl>
<div class="Pp"></div>
The following directives are conditionals. If the conditional is not satisfied,
  then the source code between the directive and its terminating <b>#endif</b>
  are expunged and not assembled. Up to fifteen levels of nesting are supported.
<dl class="Bl-tag">
  <dt class="It-tag"><b>#endif</b></dt>
  <dd class="It-tag">Closes a conditional block.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>#else</b></dt>
  <dd class="It-tag">Implements alternate path for a conditional block.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>#ifdef DEFINE</b></dt>
  <dd class="It-tag">True only if macro <b>DEFINE</b> is defined.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>#ifndef DEFINE</b></dt>
  <dd class="It-tag">The opposite; true only if macro <b>DEFINE</b> has not been
      previously defined.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>#if expression</b></dt>
  <dd class="It-tag">True if expression <b>expression</b> evaluates to non-zero.
      <b>expression</b> may reference other macros.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>#iflused label</b></dt>
  <dd class="It-tag">True if label <b>label</b> has been used (but not
      necessarily instantiated with a value). <i>This works on labels, not
      macros!</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>#ifldef label</b></dt>
  <dd class="It-tag">True if label <b>label</b> is defined <i>and</i> assigned
      with a value. <i>This works on labels, not macros!</i></dd>
</dl>
<div class="Pp"></div>
Unclosed conditional blocks at the end of included files generate warnings;
  unclosed conditional blocks at the end of assembly generate an error.
<div class="Pp"></div>
<b>#iflused</b> and <b>#ifldef</b> are useful for building up a library based on
  labels. For example, you might use something like this in your library's code:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><b>#iflused label</b>
    <div>&#x00A0;</div>
    <b>#ifldef label</b>
    <div>&#x00A0;</div>
    <b>#echo label already defined, library function label cannot be
      inserted</b>
    <div>&#x00A0;</div>
    <b>#else</b>
    <div>&#x00A0;</div>
    <b>label /* your code */</b>
    <div>&#x00A0;</div>
    <b>#endif</b>
    <div>&#x00A0;</div>
    <b>#endif</b>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="ENVIRONMENT"><a class="selflink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
<b>xa</b> utilises the following environment variables, if they exist:
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>XAINPUT</b></dt>
  <dd class="It-tag">Include file path; components should be separated by
    `,'.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>XAOUTPUT</b></dt>
  <dd class="It-tag">Output file path.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="NOTES'N'BUGS"><a class="selflink" href="#NOTES'N'BUGS">NOTES'N'BUGS</a></h1>
The R65C02 instructions <b>ina</b> (often rendered <b>inc</b> <b>a</b>) and
  <b>dea</b> (<b>dec</b> <b>a</b>) must be rendered as bare <b>inc</b> and
  <b>dec</b> instructions respectively.
<div class="Pp"></div>
The 65816 instructions <b>mvn</b> and <b>mvp</b> use two eight bit parameters,
  the only instructions in the entire instruction set to do so. Older versions
  of <b>xa</b> took a single 16-bit absolute value. Since 2.3.7, the standard
  syntax is now accepted and the old syntax is deprecated (a warning will be
  generated).
<div class="Pp"></div>
Forward-defined labels -- that is, labels that are defined after the current
  instruction is processed -- cannot be optimized into zero page instructions
  even if the label does end up being defined as a zero page location, because
  the assembler does not know the value of the label in advance during the first
  pass when the length of an instruction is computed. On the second pass, a
  warning will be issued when an instruction that could have been optimized
  can't be because of this limitation. (Obviously, this does not apply to
  branching or jumping instructions because they're not optimizable anyhow, and
  those instructions that can <i>only</i> take an 8-bit parameter will always be
  casted to an 8-bit quantity.) If the label cannot otherwise be defined ahead
  of the instruction, the backtick prefix <b>`</b> may be used to force further
  optimization no matter where the label is defined as long as the instruction
  supports it. Indiscriminately forcing the issue can be fraught with peril,
  however, and is not recommended; to discourage this, the assembler will
  complain about its use in addressing mode situations where no ambiguity
  exists, such as indirect indexed, branching and so on.
<div class="Pp"></div>
Also, as a further consequence of the way optimization is managed, we repeat
  that <b>all</b> 24-bit quantities and labels that reference a 24-bit quantity
  in 65816 mode, anteriorly declared or otherwise, <b>MUST</b> be prepended with
  the <b>@</b> prefix. Otherwise, the assembler will attempt to optimize to 16
  bits, which may be undesirable.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>file65</b>(1), <b>ldo65</b>(1), <b>printcbm</b>(1), <b>reloc65</b>(1),
  <b>uncpk</b>(1), <b>dxa</b>(1)
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
This manual page was written by David Weinehall &lt;tao@acc.umu.se&gt;, Andre
  Fachat &lt;fachat@web.de&gt; and Cameron Kaiser &lt;ckaiser@floodgap.com&gt;.
  Original xa package (C)1989-1997 Andre Fachat. Additional changes (C)1989-2015
  Andre Fachat, Jolse Maginnis, David Weinehall, Cameron Kaiser. The official
  maintainer is Cameron Kaiser.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="WEBSITE"><a class="selflink" href="#WEBSITE">WEBSITE</a></h1>
http://www.floodgap.com/retrotech/xa/</div>
<table class="foot">
  <tr>
    <td class="foot-date">7 February 2009</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
