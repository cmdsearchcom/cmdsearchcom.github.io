<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>STAPREF(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">STAPREF(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">STAPREF(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
stapref - systemtap language reference
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>stapref</b>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The reference for the systemtap scripting language.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="LANGUAGE"><a class="selflink" href="#LANGUAGE">LANGUAGE</a></h1>
Keywords
<div>&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
&#x2022;  <b>break</b>
&#x2022;  <b>continue</b>
&#x2022;  <b>delete</b>
&#x2022;  <b>else</b>
&#x2022;  <b>exit</b>
&#x2022;  <b>foreach</b>
&#x2022;  <b>for</b>
&#x2022;  <b>function</b>
&#x2022;  <b>global</b>
&#x2022;  <b>private</b>
&#x2022;  <b>if</b>
&#x2022;  <b>in</b>
&#x2022;  <b>next</b>
&#x2022;  <b>probe</b>
&#x2022;  <b>return</b>
&#x2022;  <b>try/catch</b>
&#x2022;  <b>while</b>
</pre>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
Data Types and Operators
<div>&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
Integers
&#x2022; var1 = 5
&#x2022;  <b>global</b> var2 = 10
<div class="Pp"></div>
Strings
&#x2022; var1 = &quot;string1&quot;
&#x2022;  <b>global</b> var2 = &quot;string2&quot;
<div class="Pp"></div>
Associative Arrays
&#x2022;  <b>global</b> array1[]
&#x2022;  <b>global</b> array2[SIZE]
&#x2022; array[index] = 5
<div class="Pp"></div>
Context Variables
&#x2022;  <b>$</b>var
&#x2022;  <b>$</b>var<b>$</b> (pretty printed string form)
<div class="Pp"></div>
Binary numeric operators
&#x2022;  <b>* / % + - &lt;&lt; &gt;&gt; &amp; ^ | &amp;&amp; ||</b>
<div class="Pp"></div>
Binary string operators
&#x2022;  <b>.</b> (string concatenation)
<div class="Pp"></div>
Numeric assignment operators
&#x2022;  <b>= += -= *= /= %= &gt;&gt;= &lt;&lt;= &amp;= ^= |= </b>
<div class="Pp"></div>
String assignment operators
&#x2022;  <b>= .= </b>
<div class="Pp"></div>
Unary numeric operators
&#x2022;  <b>+ - ! ~ ++ -- </b>
<div class="Pp"></div>
Numeric &amp; string comparison operators
&#x2022;  <b>&lt; &gt; &lt;= &gt;= == != </b>
<div class="Pp"></div>
Regular expression matching operators
&#x2022;  <b>=~ !~ </b>
<div class="Pp"></div>
Ternary operator
&#x2022; cond  <b>?</b> exp1 <b>:</b> exp2
<div class="Pp"></div>
Grouping operator
&#x2022;  <b>(</b> expression <b>)</b>
<div class="Pp"></div>
Array operators
&#x2022; array <b>[</b>index<b>]</b> (array read/write)
&#x2022; [index]  <b>in</b> array
<div class="Pp"></div>
Aggregation operator
&#x2022; var  <b>&lt;&lt;&lt;</b> value
</pre>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
Statements
<div>&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
Jump Statements
&#x2022;  <b>continue</b>
&#x2022;  <b>break</b>
&#x2022;  <b>next</b>
&#x2022;  <b>return</b> expression
&#x2022;  <b>try</b> statement <b>catch</b> (message)
</pre>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
Selection Statements
&#x2022;  <b>if</b> (expression) statement 
&#x2022;  <b>else</b> statement
</pre>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
Iteration Statements
&#x2022;  <b>foreach</b> (variable <b>in</b> array) statement
&#x2022;  <b>foreach</b> ([var1,var2,...] <b>in</b> array) statement
&#x2022;  <b>for</b> (expression; expression; expression) statement
&#x2022;  <b>while</b> (expression) statement
</pre>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
Declaration Statements
&#x2022;  <b>function</b> name (variable : type, ...) { statement }
&#x2022;  <b>function</b> name : type (variable : type, ...) { statement }
&#x2022;  <b>function</b> name : type (variable : type, ...) %{ c_statement %}
&#x2022;  <b>probe</b> probepoint { statement }
&#x2022;  <b>probe</b> label = probepoint { statement }
</pre>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
Lexical Structure
<div>&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
Comments
&#x2022;  <b>#</b> ... comment
&#x2022;  <b>//</b> ... comment
&#x2022;  <b>/*</b> ... comment ... <b>*/</b>
</pre>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
Preprocessor
&#x2022;  <b>%(</b> expression <b>%?</b> true_tokens <b>%:</b> false_tokens <b>%)</b>
&#x2022;  <b>@define</b> label (variable, ...) %{ statement %}
</pre>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
Builtin Functions
<div>&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
Aggregation Builtin Functions
&#x2022;  <b>@avg</b> (variable)
&#x2022;  <b>@count</b> (variable)
&#x2022;  <b>@hist_linear</b> (variable, N, N, N)
&#x2022;  <b>@hist_log</b> (variable)
&#x2022;  <b>@max</b> (variable)
&#x2022;  <b>@min</b> (variable)
&#x2022;  <b>@sum</b> (variable)
</pre>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
Output Builtin Functions
&#x2022;  <b>print</b> (variable)
&#x2022;  <b>printf</b> (format:string, variable, ...) 
 &#x00A0;where format is of the form: %[flags][width][.precision][length]specifier
&#x2022;  <b>printd</b> (delimiter:string, variable, ...)
&#x2022;  <b>printdln</b> (delimiter:string, variable, ...)
&#x2022;  <b>println</b> ()
&#x2022;  <b>sprint</b>:string (variable)
&#x2022;  <b>sprintf</b>:string (format:string, variable, ...)
</pre>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
Variable Access Builtin Functions
&#x2022;  <b>@cast</b> (variable, &quot;type_name&quot;[, &quot;module&quot;])
&#x2022;  <b>@defined</b> (variable)
</pre>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
Probepoints
<div>&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
Some of the more commonly used probepoints
&#x2022; kernel.function(PATTERN) kernel.function(PATTERN).call
&#x2022; kernel.function(PATTERN).return
&#x2022; kernel.FUNCTION (PATTERN).return.maxactive(VALUE)
&#x2022; kernel.FUNCTION (PATTERN).inline
&#x2022; kernel.FUNCTION (PATTERN).label(LPATTERN)
&#x2022; module(MPATTERN).FUNCTION (PATTERN)
&#x2022; module(MPATTERN).FUNCTION (PATTERN).call
&#x2022; module(MPATTERN).FUNCTION (PATTERN).return.maxactive(VALUE)
&#x2022; module(MPATTERN).FUNCTION (PATTERN).inline
&#x2022; kernel.statement(PATTERN)
&#x2022; kernel.statement(ADDRESS).absolute
&#x2022; module(MPATTERN).statement(PATTERN)
&#x2022; kprobe.FUNCTION (FUNCTION)
&#x2022; kprobe.FUNCTION (FUNCTION).return
&#x2022; kprobe.module(NAME).FUNCTION (FUNCTION)
&#x2022; kprobe.module(NAME).FUNCTION (FUNCTION).return
&#x2022; kprobe.statement(ADDRESS).absolute
&#x2022; process.begin process(&quot;PATH&quot;).begin
&#x2022; process(PID).begin process.thread.begin
&#x2022; process(&quot;PATH&quot;).thread.begin
&#x2022; process(PID).thread.begin
&#x2022; process.end
&#x2022; process(&quot;PATH&quot;).end
&#x2022; process(PID).end
&#x2022; process.thread.end
&#x2022; process(&quot;PATH&quot;).thread.end
&#x2022; process(PID).thread.end
&#x2022; process(&quot;PATH&quot;).syscall
&#x2022; process(PID).syscall
&#x2022; process.syscall.return
&#x2022; process(&quot;PATH&quot;).syscall.return
&#x2022; process(PID).syscall.return
&#x2022; process(&quot;PATH&quot;).FUNCTION (&quot;NAME&quot;)
&#x2022; process(&quot;PATH&quot;).statement(&quot;*@FILE.c:123&quot;)
&#x2022; process(&quot;PATH&quot;).FUNCTION (&quot;*&quot;).return
&#x2022; process(&quot;PATH&quot;).FUNCTION (&quot;myfun&quot;).label(&quot;foo&quot;)
&#x2022; process(&quot;PATH&quot;).mark(&quot;LABEL&quot;)
&#x2022; java(&quot;PNAME&quot;).class(&quot;CLASSNAME&quot;).method(&quot;PATTERN&quot;)
&#x2022; java(&quot;PNAME&quot;).class(&quot;CLASSNAME&quot;).method(&quot;PATTERN&quot;).return
&#x2022; java(PID).class(&quot;CLASSNAME&quot;).method(&quot;PATTERN&quot;)
&#x2022; java(PID).class(&quot;CLASSNAME&quot;).method(&quot;PATTERN&quot;).return
</pre>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
Tapset Functions
<div>&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
Some of the more commonly used tapset functions
&#x2022; addr:long ()
&#x2022; backtrace:string ()
&#x2022; caller:string ()
&#x2022; caller_addr:long ()
&#x2022; cmdline_arg:string (N:long)
&#x2022; cmdline_args:string (N:long,m:long,delim:string)
&#x2022; cmdline_str:string ()
&#x2022; env_var:string (name:string)
&#x2022; execname:string ()
&#x2022; int_arg:long (N:long)
&#x2022; isinstr:long(s1:string,s2:string)
&#x2022; long_arg:long (N:long)
&#x2022; modname:string ()
&#x2022; module_name:string ()
&#x2022; pid:long ()
&#x2022; pn:string ()
&#x2022; pointer_arg:string (N:long)
&#x2022; pp:string ()
&#x2022; print_backtrace ()
&#x2022; probefunc:string ()
&#x2022; register:long(name:string)
&#x2022; str_replace:string(prnt_str:string,srch_str:string,rplc_str:string)
&#x2022; stringat:long(str:string,pos:long)
&#x2022; strlen:long(str:string)
&#x2022; strtol:long(str:string,base:long)
&#x2022; substr:string(str:string,start:long,length:long)
&#x2022; user_long:long(addr:long)
&#x2022; user_string:string(addr:long)
</pre>
</div>
<br/>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<pre>
<i>stap</i>(1)
<div class="Pp"></div>
</pre>
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Use the Bugzilla link of the project web page or our mailing list.
  <b>http://sourceware.org/systemtap/</b>,<b>&lt;systemtap@sourceware.org&gt;</b>.</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
