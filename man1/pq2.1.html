<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:33:44 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>PQ2(1) General Commands Manual PQ2(1)</p>

<p style="margin-top: 1em">NAME <br>
pq2 - The command line interface to a dataset
meta-repository based on ROOT files</p>

<p style="margin-top: 1em">SYNOPSIS <br>
pq2 action options</p>

<p style="margin-top: 1em">DESCRIPTION <br>
This manual page documents briefly the pq2 program.</p>

<p style="margin-top: 1em">pq2 is a ROOT application
providing an interface to a dataset meta-repository based on
ROOT files; the repository can be accessed via the local
file system or a remote file <br>
server daemon or a PROOF facility.</p>

<p style="margin-top: 1em">When working with a local or
remote file system, pq2 instantiates a TDataSetManagerFile
class on the specified local or remote directory. Remote
access is done via the TFile <br>
interface, so any implementation of TFile supported by the
installation can in principle be used. When working with
PROOF server the TProof dataset manager interface is used to
<br>
access the dataset repository attached to the PROOF
cluster.</p>

<p style="margin-top: 1em">ACTIONS <br>
ls list compact information about all or a sample
dataset.</p>

<p style="margin-top: 1em">ls-files <br>
list compact information about all the files of a given
dataset.</p>

<p style="margin-top: 1em">ls-files-server <br>
list the file content of a dataset on a given server or list
of servers.</p>

<p style="margin-top: 1em">info-server <br>
display compact information about the datasets on a given
server or a set of servers.</p>

<p style="margin-top: 1em">ana-dist <br>
analyse the file distribution of a dataset (or a set of
datasets) over the file servers, either in terms of files or
of file sizes. The output is a text file with the the <br>
file movements needed to make the file distribution even in
the chosen metrics to be used in input to pq2-redistribute.
Optionally the internal objects can be saved so <br>
that they can be used as starting point for a subsequent
run. Also an histogram and a plot can be saved to visualize
the file distribution.</p>

<p style="margin-top: 1em">put register one or more
datasets.</p>

<p style="margin-top: 1em">rm remove one or more
datasets.</p>

<p style="margin-top: 1em">verify scan the content one or
more datasets.</p>

<p style="margin-top: 1em">cache display or clear the local
cache content.</p>

<p style="margin-top: 1em">COMMON OPTIONS <br>
Some of the options listed below have a slight different
meaning depending on the action. Please refer to the man
pages of the script interfaces to the actions for more
details <br>
(see below).</p>

<p style="margin-top: 1em">-d &lt;dataset&gt; <br>
For all action but put, the dataset to be processed. For
listing actions the wildcards &rsquo;*&rsquo; is supported.
For action put, dataset is the path to the file with the
list of <br>
files in the dataset or directory with the files containing
the file lists of the datasets to be registered; in the
first case wildcards &rsquo;*&rsquo; can be specified in the
file <br>
name, i.e. &rsquo;&lt;dir&gt;/fil*&rsquo; is ok but
&rsquo;&lt;dir&gt;/*/file&rsquo; is not. In all cases the
name of the dataset is the name of the file finally
used.</p>

<p style="margin-top: 1em">-u &lt;serverurl&gt; <br>
URL of the PROOF master or data server providing the
information; for data servers, it must include the
directory. Can also be specified via the environment
variables <br>
PQ2PROOFURL or PQ2DSSRVURL (see ENVIRONMENT
VARIABLES).&quot;</p>

<p style="margin-top: 1em">-o &lt;options&gt; <br>
Specify a string of options to be passed to the instance
actuatlly performing the action; the exact meaning is action
dependent.</p>

<p style="margin-top: 1em">-s &lt;servers&gt; <br>
Specify a server or a comma-separated list of servers to be
used in the analysis when required by the action.</p>

<p style="margin-top: 1em">-k Keep the temporary files
created during the analysis under $TMPDIR</p>

<p style="margin-top: 1em">-v Verbose mode</p>

<p style="margin-top: 1em">OPTIONS for action verify <br>
The options listed below apply only to action
&rsquo;verify&rsquo;</p>

<p style="margin-top: 1em">-r &lt;redirector&gt; <br>
Force re-location of the files via the specified redirector;
useful after a file redistribution on the same file
server.</p>

<p style="margin-top: 1em">OPTIONS for action ana-dist <br>
The options listed below apply only to action
&rsquo;ana-dist&rsquo;</p>

<p style="margin-top: 1em">-m &lt;metrics&gt; <br>
Defines the metrics to be used in the distribution analysis.
The possibilities supported currently are: &rsquo;F&rsquo;
to use the number of files, and &rsquo;S&rsquo; to use the
file size.</p>

<p style="margin-top: 1em">-f &lt;result file&gt; <br>
Defines the file where to save the result of the analysis;
by the default the result is send to the screen. The output
contains one line per each file that needs to be <br>
moved with the format &rsquo;file source destination&rsquo;
where &rsquo;file&rsquo; is the file name,
&rsquo;source&rsquo; is the source server URL and
&rsquo;destination&rsquo; is the destination server URL.</p>

<p style="margin-top: 1em">--outfile &lt;output file&gt;
<br>
Defines the file where to save the output of the analysis in
binary form (ROOT file); this output can be used as starting
point for a next run, allowing to run over many <br>
datasets in separate steps.</p>

<p style="margin-top: 1em">--infile &lt;input file&gt; <br>
Defines the ROOT file from where to fetch the output of a
previous run (saved with --outfile).</p>

<p style="margin-top: 1em">-i &lt;ignored servers&gt; <br>
Specify a server or a comma-separated list of servers to be
ignored in the analysis; this allows to exclude, for
example, the redirector.</p>

<p style="margin-top: 1em">-e &lt;excluded servers&gt; <br>
Specify a server or a comma-separated list of servers to be
excluded from the target servers; this can be used, for
example, to determine the files movements to drain a <br>
server.</p>

<p style="margin-top: 1em">--plot [&lt;plot file&gt;] <br>
Defines the file with the output plot with the original
distribution with the server names and the +-10% limits; the
extension (if known) defines the format; the default <br>
format is &rsquo;png&rsquo; and the default name
&rsquo;plot.png&rsquo;. The plot can also be obtained
directly from a binary output file (saved with
&rsquo;--outfile &lt;outfile&gt;.root&rsquo;) but just
speci&acirc; <br>
fying &rsquo;--infile &lt;outfile&gt;.root --plot&rsquo;</p>

<p style="margin-top: 1em">ENVIRONMENT VARIABLES <br>
See setup-pq2(1).</p>

<p style="margin-top: 1em">SEE ALSO <br>
setup-pq2(1), pq2-ls(1), pq2-ls-files(1),
pq2-ls-files-server(1), pq2-info-server(1), pq2-ana-dist(1),
pq2-put(1), pq2-verify(1), pq2-rm(1), pq2-cache(1)</p>

<p style="margin-top: 1em">For more information on the ROOT
system, please refer to http://root.cern.ch</p>

<p style="margin-top: 1em">ORIGINAL AUTHORS <br>
Gerardo Ganis for the ROOT team.</p>

<p style="margin-top: 1em">COPYRIGHT <br>
This library is free software; you can redistribute it
and/or modify it under the terms of the GNU Lesser General
Public License as published by the Free Software Foundation;
<br>
either version 2.1 of the License, or (at your option) any
later version.</p>

<p style="margin-top: 1em">This library is distributed in
the hope that it will be useful, but WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR PUR&acirc; <br>
POSE. See the GNU Lesser General Public License for more
details.</p>

<p style="margin-top: 1em">You should have received a copy
of the GNU Lesser General Public License along with this
library; if not, write to the Free Software Foundation,
Inc., 51 Franklin St, Fifth <br>
Floor, Boston, MA 02110-1301 USA</p>

<p style="margin-top: 1em">AUTHOR <br>
This manual page was originally written by Gerardo Ganis
&lt;gerardo.ganis@cern.ch&gt;, for ROOT version 5.</p>

<p style="margin-top: 1em">ROOT Version 5 PQ2(1)</p>
<hr>
</body>
</html>
