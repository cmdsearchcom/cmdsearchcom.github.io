<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>PQ2(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">PQ2(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">PQ2(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
pq2 - The command line interface to a dataset meta-repository based on ROOT
  files
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>pq2</b> action <i>options</i>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This manual page documents briefly the <b>pq2</b> program.
<div class="Pp"></div>
<b>pq2</b> is a <b>ROOT</b> application providing an interface to a dataset
  meta-repository based on ROOT files; the repository can be accessed via the
  local file system or a remote file server daemon or a PROOF facility.
<div class="Pp"></div>
When working with a local or remote file system, <i>pq2</i> instantiates a
  <i>TDataSetManagerFile</i> class on the specified local or remote directory.
  Remote access is done via the <i>TFile</i> interface, so any implementation of
  <i>TFile</i> supported by the installation can in principle be used. When
  working with PROOF server the <i>TProof</i> dataset manager interface is used
  to access the dataset repository attached to the PROOF cluster.
<h1 class="Sh" title="Sh" id="ACTIONS"><a class="selflink" href="#ACTIONS">ACTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag">ls</dt>
  <dd class="It-tag">list compact information about all or a sample
    dataset.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">ls-files</dt>
  <dd class="It-tag">list compact information about all the files of a given
      dataset.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">ls-files-server</dt>
  <dd class="It-tag">list the file content of a dataset on a given server or
      list of servers.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">info-server</dt>
  <dd class="It-tag">display compact information about the datasets on a given
      server or a set of servers.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">ana-dist</dt>
  <dd class="It-tag">analyse the file distribution of a dataset (or a set of
      datasets) over the file servers, either in terms of files or of file
      sizes. The output is a text file with the the file movements needed to
      make the file distribution even in the chosen metrics to be used in input
      to pq2-redistribute. Optionally the internal objects can be saved so that
      they can be used as starting point for a subsequent run. Also an histogram
      and a plot can be saved to visualize the file distribution.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">put</dt>
  <dd class="It-tag">register one or more datasets.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">rm</dt>
  <dd class="It-tag">remove one or more datasets.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">verify</dt>
  <dd class="It-tag">scan the content one or more datasets.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">cache</dt>
  <dd class="It-tag">display or clear the local cache content.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="COMMON_OPTIONS"><a class="selflink" href="#COMMON_OPTIONS">COMMON
  OPTIONS</a></h1>
Some of the options listed below have a slight different meaning depending on
  the action. Please refer to the man pages of the script interfaces to the
  actions for more details (see below).
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d</b> &lt;<i>dataset</i>&gt;</dt>
  <dd class="It-tag">For all action but <i>put</i>, the dataset to be processed.
      For listing actions the wildcards '*' is supported. For action <i>put</i>,
      <i>dataset</i> is the path to the file with the list of files in the
      dataset or directory with the files containing the file lists of the
      datasets to be registered; in the first case wildcards '*' can be
      specified in the file name, i.e. '&lt;dir&gt;/fil*' is ok but
      '&lt;dir&gt;/*/file' is not. In all cases the name of the dataset is the
      name of the file finally used.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-u</b> &lt;<i>serverurl</i>&gt;</dt>
  <dd class="It-tag">URL of the PROOF master or data server providing the
      information; for data servers, it must include the directory. Can also be
      specified via the environment variables PQ2PROOFURL or PQ2DSSRVURL (see
      ENVIRONMENT VARIABLES).&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-o</b> &lt;<i>options</i>&gt;</dt>
  <dd class="It-tag">Specify a string of options to be passed to the instance
      actuatlly performing the action; the exact meaning is action
    dependent.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s</b> &lt;<i>servers</i>&gt;</dt>
  <dd class="It-tag">Specify a server or a comma-separated list of servers to be
      used in the analysis when required by the action.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-k</b></dt>
  <dd class="It-tag">Keep the temporary files created during the analysis under
      $TMPDIR</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v</b></dt>
  <dd class="It-tag">Verbose mode</dd>
</dl>
<h1 class="Sh" title="Sh" id="OPTIONS_for_action_verify"><a class="selflink" href="#OPTIONS_for_action_verify">OPTIONS
  for action verify</a></h1>
The options listed below apply only to action 'verify'
<dl class="Bl-tag">
  <dt class="It-tag"><b>-r</b> &lt;<i>redirector</i>&gt;</dt>
  <dd class="It-tag">Force re-location of the files via the specified
      redirector; useful after a file redistribution on the same file
    server.</dd>
</dl>
<h1 class="Sh" title="Sh" id="OPTIONS_for_action_ana-dist"><a class="selflink" href="#OPTIONS_for_action_ana-dist">OPTIONS
  for action ana-dist</a></h1>
The options listed below apply only to action 'ana-dist'
<dl class="Bl-tag">
  <dt class="It-tag"><b>-m</b> &lt;<i>metrics</i>&gt;</dt>
  <dd class="It-tag">Defines the metrics to be used in the distribution
      analysis. The possibilities supported currently are: 'F' to use the number
      of files, and 'S' to use the file size.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b> &lt;<i>result file</i>&gt;</dt>
  <dd class="It-tag">Defines the file where to save the result of the analysis;
      by the default the result is send to the screen. The output contains one
      line per each file that needs to be moved with the format 'file source
      destination' where 'file' is the file name, 'source' is the source server
      URL and 'destination' is the destination server URL.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--outfile</b> &lt;<i>output file</i>&gt;</dt>
  <dd class="It-tag">Defines the file where to save the output of the analysis
      in binary form (ROOT file); this output can be used as starting point for
      a next run, allowing to run over many datasets in separate steps.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--infile</b> &lt;<i>input file</i>&gt;</dt>
  <dd class="It-tag">Defines the ROOT file from where to fetch the output of a
      previous run (saved with --outfile).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i</b> &lt;<i>ignored servers</i>&gt;</dt>
  <dd class="It-tag">Specify a server or a comma-separated list of servers to be
      ignored in the analysis; this allows to exclude, for example, the
      redirector.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-e</b> &lt;<i>excluded servers</i>&gt;</dt>
  <dd class="It-tag">Specify a server or a comma-separated list of servers to be
      excluded from the target servers; this can be used, for example, to
      determine the files movements to drain a server.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--plot</b> [&lt;<i>plot file</i>&gt;]</dt>
  <dd class="It-tag">Defines the file with the output plot with the original
      distribution with the server names and the +-10% limits; the extension (if
      known) defines the format; the default format is 'png' and the default
      name 'plot.png'. The plot can also be obtained directly from a binary
      output file (saved with '--outfile &lt;outfile&gt;.root') but just
      specifying '--infile &lt;outfile&gt;.root --plot'
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="ENVIRONMENT_VARIABLES"><a class="selflink" href="#ENVIRONMENT_VARIABLES">ENVIRONMENT
  VARIABLES</a></h1>
See <i>setup-pq2</i>(1).
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i>setup-pq2</i>(1), <i>pq2-ls</i>(1), <i>pq2-ls-files</i>(1),
  <i>pq2-ls-files-server</i>(1), <i>pq2-info-server</i>(1),
  <i>pq2-ana-dist</i>(1), <i>pq2-put</i>(1), <i>pq2-verify</i>(1),
  <i>pq2-rm</i>(1), <i>pq2-cache</i>(1)
<div class="Pp"></div>
For more information on the <b>ROOT</b> system, please refer to
  <i>http://root.cern.ch</i>
<h1 class="Sh" title="Sh" id="ORIGINAL_AUTHORS"><a class="selflink" href="#ORIGINAL_AUTHORS">ORIGINAL
  AUTHORS</a></h1>
Gerardo Ganis for the ROOT team.
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
This library is free software; you can redistribute it and/or modify it under
  the terms of the GNU Lesser General Public License as published by the Free
  Software Foundation; either version 2.1 of the License, or (at your option)
  any later version.
<div class="Pp"></div>
This library is distributed in the hope that it will be useful, but WITHOUT ANY
  WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
  A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more
  details.
<div class="Pp"></div>
You should have received a copy of the GNU Lesser General Public License along
  with this library; if not, write to the Free Software Foundation, Inc., 51
  Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
This manual page was originally written by Gerardo Ganis
  &lt;gerardo.ganis@cern.ch&gt;, for ROOT version 5.</div>
<table class="foot">
  <tr>
    <td class="foot-date">Version 5</td>
    <td class="foot-os">ROOT</td>
  </tr>
</table>
</body>
</html>
