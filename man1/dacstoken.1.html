<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>DACSTOKEN(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DACSTOKEN(1)</td>
    <td class="head-vol">DACS Commands Manual</td>
    <td class="head-rtitle">DACSTOKEN(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
dacstoken - administer hash-based one-time passwords
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div class="Pp" style="margin-left: 10.00ex; text-indent: -10.00ex;"><b>dacstoken</b>
  [ <i></i><b>dacsoptions</b>[1]] [<b>-all</b>]
  [<b>-base&#x00A0;</b><b></b><i>num</i>] [ <b>-counter</b>&#x00A0;<i>num</i>]
  [<b>-digits&#x00A0;</b><b></b><i>num</i>]
<div>&#x00A0;</div>
[ <b>-disable</b> | <b>-enable</b>]
  [<b>-hotp-window&#x00A0;</b><b></b><i>num</i>] [ <b>-ignore-key-length</b>]
<div>&#x00A0;</div>
[ <b>-inkeys&#x00A0;</b><b></b><i>item_type</i>]
  [<b>-issuer&#x00A0;</b><b></b><i>name</i>] [[<b>-key</b>&#x00A0;<i>keyval</i>]
  | [ <b>-key-enc</b>&#x00A0;<i>enc</i>] |
  [<b>-key-file</b>&#x00A0;<i>filename</i>] | [ <b>-key-prompt</b>]
<div>&#x00A0;</div>
] [ <b>-mode&#x00A0;</b><b></b><i>otp-mode</i>] [<b>-nl</b>]
  [<b>-outkeys&#x00A0;</b> <b></b><i>item_type</i>]
  [[<b>-pin</b>&#x00A0;<i>pinval</i>] | [
  <b>-pin-file</b>&#x00A0;<i>filename</i>] | [ <b>-pin-prompt</b>]]
<div>&#x00A0;</div>
[ <b>-pin-constraints</b>&#x00A0;<i>str</i>] [<b>-rnd</b>]
  [<b>-seed&#x00A0;</b><b></b><i>str</i>]
  [<b>-serial&#x00A0;</b><b></b><i>str</i>] [
  <b>-totp-delta&#x00A0;</b><b></b><i>num</i>]
  [<b>-totp-drift&#x00A0;</b><b></b> <i>nwindows</i>]
<div>&#x00A0;</div>
[ <b>-totp-hash&#x00A0;</b><b></b><i>alg</i>]
  [<b>-totp-time&#x00A0;</b><b></b><i>secs</i>]
  [<b>-totp-timestep&#x00A0;</b><b></b><i>secs</i>]
  [<b>-vfs&#x00A0;</b><b></b><i>vfs_uri</i>] [<i>op-spec</i>]
  [<i>username</i>]</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This program is part of the <b>DACS</b> suite.
<div class="Pp"></div>
The <b>dacstoken</b> utility administers <b>DACS</b> accounts associated with
  one-time password (OTP) generating devices ( <i>tokens</i>) or software-based
  clients. Using command line options, it also computes OTP values; token
  account parameters can be overridden, but accounts are not even required.
<div class="Pp"></div>
Strong, two-factor authentication can be provided when
  <b>dacs_authenticate</b>[2] is configured to use the
  <b>local_token_authenticate</b>[3] authentication module or when
  <b>dacstoken</b> is used as a standalone program to validate passwords. Two
  kinds of one-time password algorithms are supported: the HMAC-based one-time
  password mode (HOTP), based on an event counter and specified by <b>RFC
  4226</b>[4], and the time-based one-time password mode (TOTP), as specified by
  <b>RFC 6238</b>[5]. Additional operational modes called OCRA ( <i>OATH
  Challenge-Response Algorithms</i>), described in <b>RFC 6287</b>[6], are not
  yet fully supported.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
This version of <b>dacstoken</b> incorporates many changes that are not backward
  compatible with release 1.4.24a and earlier. Some command line flags function
  differently, and the format of the account file has changed. If you have used
  this command in earlier releases, please make a backup copy of your token
  account file and review this manual page carefully before proceeding (note the
  <b></b><b>-convert</b> flag[7] in particular).
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Important</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
No vendor-supplied software is required by <b>dacstoken</b> to supply its
  functionality. The devices currently supported do not need any registration or
  configuration interaction with vendors and <b>dacstoken</b> <i>does not
  interact with vendors' servers or use any proprietary software</i>.
  Vendor-supplied software may be required to perform initialization or
  configuration for other token devices, however, and <b>dacstoken</b> does not
  provide such support for them.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
Each token device generally corresponds to exactly one account that is managed
  by <b>dacstoken</b>, although some vendors produce tokens that can support
  multiple accounts.
<div class="Pp"></div>
To summarize, this utility:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;creates and administers <b>DACS</b>
  accounts associated with counter-based and time-based one-time passwords</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;provides validation and testing
  functionality</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;provides a command line authentication
  capability</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
Only the <b>DACS</b> administrator should be able to successfully run this
  program from the command line. Because <b>DACS</b> keys and configuration
  files, including the file used to store accounts, must be restricted to the
  administrator, this will normally be the case, but a careful administrator
  will set file permissions to deny access to all other users.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The <b>dacs_token(8)</b>[8] web service provides users with limited self-service
  functionality to set or reset their account PIN and synchronize their token.
  It also has a demonstration mode to simplify testing and evaluation.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<h2 class="Ss" title="Ss" id="PINs_(Account_Passwords)"><a class="selflink" href="#PINs_(Account_Passwords)">PINs
  (Account Passwords)</a></h2>
A <b>dacstoken</b> account can optionally have a PIN (i.e., a password)
  associated with it. To authenticate against such an account, a user must
  provide the one-time password produced by the token <i>and</i> the PIN. The
  <b>TOKEN_REQUIRES_PIN</b>[9] configuration directive determines whether a PIN
  must be provided when creating or importing an account. By default, a PIN is
  required. The directive does not apply in conjunction with the <b>-delpin</b>
  flag, since only an administrator should be able to perform that function.
<div class="Pp"></div>
A hash of the PIN is stored in the account record. The PIN is not stored. The
  same method used by <b>dacspasswd(1)</b>[10] and <b>dacs_passwd(8)</b>[11] is
  applied, and depends on the <b>PASSWORD_DIGEST</b>[12] and
  <b>PASSWORD_SALT_PREFIX</b>[13] directives in effect. If
  <b>PASSWORD_DIGEST</b>[12] is configured, that algorithm is used, otherwise a
  compile-time default (SHA-1) is used. If a user forgets the PIN, the old one
  cannot be recovered so it must either be deleted or a new one must be set.
<div class="Pp"></div>
Some token devices and client software have a PIN feature. The user must enter a
  PIN into the device before the device will emit a one-time password. This
  &quot;device PIN&quot; is completely distinct from the account PIN (a
  server-side password) that is managed by <b>dacstoken</b>, and this manual is
  only concerned with the <b>dacstoken</b> PIN. The device PIN should always be
  used when possible; the <b>dacstoken</b> PIN is strongly recommended and is
  required for two-factor authentication (unless an additional authentication
  factor is applied in some other way).
<div class="Pp"></div>
Since only the administrator is allowed to run this command, no restrictions are
  imposed on the length or quality of the PINs that the administrator supplies;
  a warning message will be emitted, however, if the password is considered to
  be weak as determined by the <b>PASSWORD_CONSTRAINTS</b>[14] directive.
<h2 class="Ss" title="Ss" id="One-Time_Passwords_(OTPs)"><a class="selflink" href="#One-Time_Passwords_(OTPs)">One-Time
  Passwords (OTPs)</a></h2>
Both kinds of one-time password device compute a password value by employing a
  secure keyed hash algorithm ( <b>RFC 2104</b>[15], <b>FIPS 198</b>[16]). In
  the counter-based method, the device and server share a secret key and a
  counter value which are hashed to yield a numerical value displayed in a
  certain radix with a certain number of digits. Successful authentication
  requires the device and server to compute matching passwords. Each time the
  device produces a password, it increments its counter. When the server
  receives a matching password, it increments its counter. Because it is
  possible for the two counters to become unsynchronized, the server's matching
  algorithm will typically allow a client's password to fall within a
  &quot;window&quot; of counter values. The time-based method is similar, the
  main difference being that the current Unix time (as returned by
  <b>time(3)</b>[17], for instance) is used to establish a &quot;time-step
  window&quot; that serves as a counter value in the computation of the secure
  hash. Because the real-time clocks on the device and server may not be
  sufficiently synchronized, the server's matching algorithm must also allow a
  client's password to fall within some number of time-step windows for these
  devices.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
A token may be assigned a permanent secret key (sometimes called an OTP seed) by
  its manufacturer or the key may be programmable. This secret key is used by
  the token's password generation procedure and it is critical that it be kept
  private. If the token is not programmable, the key is obtained from the vendor
  (for a HOTP token, typically by providing the device's serial number and any
  three consecutive passwords). A record of each mapping from serial number to
  secret key should be kept in a secure location.
<div class="Pp"></div>
If the secret key is programmable, as it is likely to be with a software client,
  it is required to be at least <b>128</b> bits in length; a minimum of <b>160
  bits</b> is recommended (see <b>RFC 4226</b>[4]) and by default the key is
  represented as a 16 (or more) character long hexadecimal string. The minimum
  length requirement can be overridden by the <b>-ignore-key-length</b> flag,
  and the algorithm used to encode the key can be specified using the
  <b>-key-enc</b> flag. The key must be syntactically correct for the specified
  encoding algorithm and should be obtained from a cryptographic-quality source
  of random bits. Some clients may be capable of generating a suitable key, but
  you may use <b>dacsexpr(1)</b>[18]:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacsexpr -e &quot;random(string, 20)&quot;
&quot;bb2504780e8075a49bd88891b228fc7216ac18d9&quot;
</pre>
</div>
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
Tokens can be used for authentication purposes other than computer sign on. For
  example, by providing an account number, PIN, and token value, customers can
  quickly be authenticated over the phone, reducing or eliminating the need for
  expensive and time-consuming security questions.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
One-time password devices and applications have the following operational
  parameters. These parameters determine the password sequence that is
  generated. Some operational parameters may be fixed (by the relevant standard
  or due to the implementation), while others may be partially or completely
  configurable by the user. Please refer to the references and manufacturers'
  documentation for details.
<div class="Pp"></div>
base
<div style="margin-left: 4.00ex;">The radix in which passwords are
  displayed.</div>
<div class="Pp"></div>
counter
<div style="margin-left: 4.00ex;">For HOTP mode only, the current counter
  value.</div>
<div class="Pp"></div>
digits
<div style="margin-left: 4.00ex;">The number of digits in each one-time
  password.</div>
<div class="Pp"></div>
key
<div style="margin-left: 4.00ex;">The secret key (OTP seed).</div>
<div class="Pp"></div>
serial number
<div style="margin-left: 4.00ex;">A unique identifier or name for the
  device.</div>
<div class="Pp"></div>
time step size
<div style="margin-left: 4.00ex;">For TOTP mode only, the width of each time
  interval, in seconds. The same password will be generated within a given
  interval; i.e., this is the &quot;lifetime&quot; or validity period of each
  TOTP password.</div>
<div class="Pp"></div>
In addition to these parameters, <b>dacstoken</b> employs several per-account
  (i.e., per-device) parameters:
<div class="Pp"></div>
accept-window
<div style="margin-left: 4.00ex;">When validating a HOTP password, the maximum
  number of passwords to consider after the expected password.</div>
<div class="Pp"></div>
drift
<div style="margin-left: 4.00ex;">For TOTP mode only, the number of seconds by
  which to adjust the server's clock forward or backward to better synchronize
  it with the device. This is used to compensate for tokens or client software
  whose clocks are not well synchronized with the server's.</div>
<div class="Pp"></div>
drift-window
<div style="margin-left: 4.00ex;">For TOTP mode only, but analogous to the
  accept-window, the maximum number of intervals (each of the time step size) to
  search forward and backward when validating against a given password.</div>
<div class="Pp"></div>
sync-otps
<div style="margin-left: 4.00ex;">For HOTP mode only, the number of consecutive
  one-time passwords required to synchronize the account with the device.</div>
<div class="Pp"></div>
username
<div style="margin-left: 4.00ex;">The name of the <b>DACS</b> account bound to
  the device.</div>
<div class="Pp"></div>
Authentication based on one-time password devices has the following advantages:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Each time a user authenticates, a
  different password will be generated (with high probability); users cannot
  therefore jot down &quot;the password&quot; because the password is always
  changing; users cannot forget their password;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Once used, a HOTP mode password is
  immediately &quot;consumed&quot; and is unlikely to be used again for a long
  time; with suitable configuration parameters, a TOTP mode password
  automatically &quot;expires&quot; within a relatively short time interval and
  is unlikely to be used again for a long time;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;If no correction for clock drift is
  required, a TOTP mode account can have read-only operation;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Because the password is unlikely to be
  an easily-guessed number or string, it should be stronger than most
  user-selected passwords;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;A HOTP token can be the basis of a
  mutual (&quot;bidirectional&quot;) authentication method; the server shows the
  user his token's next password to confirm its identity (with both parties
  advancing their counters), then the client shows the server the next password
  to confirm his identity;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Should a key sniffer be installed on
  the user's computer, a sniffed password does not do an attacker any good
  unless a <b>man-in-the-middle attack</b>[19] is possible; given <i>N</i>
  consecutive passwords it is still very difficult to compute password <i>N +
  1</i> without knowing the secret key;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;It is more difficult for users to
  share an account (although users might sometimes view this as an
  inconvenience);</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;If a <b>dacstoken</b> PIN is assigned
  to an account and an attacker obtains the account's token, it is still
  difficult for the attacker to authenticate without knowing the PIN;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;A quick and immediately effective way
  to disable an account is by simply seizing a hardware token (e.g., if an
  employee is fired), although an account can be disabled by this program or
  using the <b>revocation list</b>[20];</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;In the case of a software client that
  runs on a mobile device, such as a phone or PDA, users are already carrying
  the device with them; free clients are available, so there may be no
  additional cost (note that mobile devices may not offer the same
  tamper-resistance, durability, key secrecy, clock accuracy, etc. of a hardware
  token).</div>
<div class="Pp"></div>
One-time password devices have the following potential disadvantages:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;There is a one-time expense for a
  hardware token (depending on the purchase volume, you can expect to pay
  $10-$100 USD each), and there is the possibility of having to replace a lost
  or broken token, or a token's battery (some units have a non-replaceable
  battery, making them disposable after a few years);</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Initial configuration is somewhat more
  difficult than with other authentication methods, and users unfamiliar with
  the devices will have to be instructed on their use;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Although they are typically quite
  small (e.g., 5cm x 2cm x 1cm) and can be attached to a keychain or lanyard, or
  kept in a wallet, users may wince at having to carry a token around with
  them;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Users can forget to have their token
  with them or lose the token;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;A mobile device (with a software
  client) is probably a likely target for theft, more so than a hardware token
  (hence the extra importance of a PIN for this device);</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Unlike a hardware token where the key
  is burned into inaccessible, tamper-proof memory, the key configured into a
  software client is likely to be readable by its owner, making sharing of the
  account possible;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Entering a 40 character or longer seed
  value into a mobile device can be frustrating and prone to error;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Once a TOTP device generates a
  password, a new password cannot be generated until the next time-step window,
  requiring the user to wait 30 (or possibly 60) seconds (e.g., if an entry
  error is made);</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Some devices are difficult to read in
  low-light conditions; presbyopic users and those with impaired vision may have
  difficulty reading the display.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h2 class="Ss" title="Ss" id="Accounts"><a class="selflink" href="#Accounts">Accounts</a></h2>
The accounts managed by <b>dacstoken</b> are completely separate from the
  accounts used by <b>local_passwd_authenticate</b>[21] or any other <b>DACS</b>
  authentication module.
<div class="Pp"></div>
Accounts for HOTP and TOTP devices may either be stored together or kept
  separate. If the virtual filestore item type auth_hotp_token is defined, it is
  only used for accounts associated with HOTP tokens. Similarly, if the virtual
  filestore item type auth_totp_token is defined, it is only used for accounts
  associated with TOTP tokens. If either item type is not defined, accounts are
  accessed through <b>DACS's</b> virtual filestore using item type auth_token.
  It is assumed that file permissions on the account databases are such that all
  access is limited to the administrator and <b>local_token_authenticate</b>.
<div class="Pp"></div>
If accounts for the two device types are <i>combined</i>, because each username
  for an authentication method must be unique, if an individual has both types
  of token they must be assigned different usernames. So, for example, if Auggie
  has one HOTP token and one TOTP token, the former might correspond to the
  username auggie-hotp and the latter to auggie-totp; the sign-on form might
  include a device-mode input which would allow Auggie to simply type
  &quot;auggie&quot; in the username field and JavaScript to automatically
  append the appropriate suffix based on the select device mode. An obvious
  disadvantage of this configuration is that it results in two different
  <b>DACS</b> identities for the same individual; this would have to be
  remembered if an access control rule needed to identify Auggie explicitly. If
  both tokens should map to the same <b>DACS</b> identity, the Auth clause could
  strip the suffix off after successful authentication, but the administrator
  would then need to beware of the case of two different Auggies, each using a
  different device type.
<div class="Pp"></div>
Configuring both the auth_hotp_token and auth_totp_token item types (or just one
  of them and auth_token) keeps the accounts separate and allows the same
  username to be used for both types of devices. Auggie could therefore have an
  account record with the same username for both device types. This approach
  requires the device mode to be specified when an operation is requested so
  that the correct item type can be used; this means that users must know which
  type of device they are using (perhaps by afixing a label to it). Refer to
  important details regarding <b></b><b>DACS</b> identities[22].
<div class="Pp"></div>
The <b>-vfs</b> can be used to configure or reconfigure the item types.
<div class="Pp"></div>
Multiple instances of each item type can exist, provided the appropriate one for
  <b>dacstoken</b> to use can be determined at run time and specified through a
  <b>VFS</b>[23] directive or <b>-vfs</b> flag.
<div class="Pp"></div>
Only keys that meet the minimum key length requirement ( <b>16</b> bytes) may be
  stored with account information (e.g., with <b>-set</b> or <b>-import</b>). In
  other contexts, the requirement is not enforced.
<div class="Pp"></div>
The secret key is always encrypted and converted to a base-64 representation
  when it is stored in the account file by <b>dacstoken</b>. The virtual
  filestore item type auth_token_keys identifies the encryption keys for
  <b>dacstoken</b> to use; the <b>-inkeys</b> and <b>-outkeys</b> flags specify
  alternatives (see <b>dacskey(1)</b>[24]). If the encryption keys are lost, the
  secret keys are practically unrecoverable.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Important</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
If an attacker discovers a secret key, generating usable passwords without
  possessing the token will not be difficult. For at least some hardware tokens,
  the key is burned in to the device and cannot be changed; in this case, if the
  key is leaked the device should be destroyed. If a token is lost, the
  corresponding account should be disabled. In the event an attacker finds a
  lost token or discovers a secret key, having a strong PIN associated with the
  account will make it difficult for the attacker to gain access.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Important</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
<div style="margin-left: 4.00ex;">&#x2022;This authentication method has been
  tested against the following OTP products:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>Authenex A-Key 3600</b>[25]
  one-time password (HOTP) hardware token;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>Feitian Technologies</b>[26] OTP
  C100 and OTP C200 one-time password hardware tokens, provided by <b>HyperSecu
  Information Systems</b>[27]; and</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>Google Authenticator</b>[28].</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;The <b>open source</b>[29] <b>FreeOTP
  Authenticator</b>[30] by <b>Red Hat</b>[31], which is available for a variety
  of platforms.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>OATH Token</b>[32] software
  application by Archie Cobbs, which implements both HOTP and TOTP on the
  <b>iPod Touch, iPhone, and iPad</b>[33].</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;The <b>OTP Auth</b>[34] software
  application for the iPod Touch, iPhone, and iPad by Roland Moers.</div>
<div style="height: 1.00em;">&#x00A0;</div>
There are many other free software implementations. Other manufacturers
  interested in having their products supported by <b>DACS</b> are welcome to
  <b>contact</b>[35] Dss.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>Photo</b>[36]: Feitian OTP C200,
  iPod Touch with the OATH Token app, Authenex A-Key 3600 (clockwise from top
  left)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Although this implementation should
  work with similar, conformant products, only these products are officially
  supported by <b>DACS</b>.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Hardware tokens can be purchased
  directly from the vendors.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Any problems with using tokens to
  authenticate through <b>DACS</b> are not the responsibility of the token
  vendor.</div>
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<h2 class="Ss" title="Ss" id="Importing_and_Exporting_OTP_Accounts"><a class="selflink" href="#Importing_and_Exporting_OTP_Accounts">Importing
  and Exporting OTP Accounts</a></h2>
Descriptions of accounts and their tokens can be loaded or dumped (refer to the
  <b>-import</b> and <b>-export</b> flags). This simplifies provisioning,
  backup, and portability. The account information can be written in a simple,
  application-specific (almost) XML format, or Google's <b>KeyUriFormat</b>[37],
  which is understood by several OTP applications.
<div class="Pp"></div>
The <b>-format</b> flag (see <b></b><i>dacsoptions</i>[38]) can be used to
  select the xml format (the default) or the uri format for export.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
At present, the uri format cannot be imported by <b>dacstoken</b>.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
Because imported records include the unencrypted secret keys for the OTP
  devices, the exported file should be kept encrypted (e.g., using
  <b>openssl</b>) or at least have appropriate file permissions.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
An official standard format for OTP device provisioning is being developed. This
  format may be understood by a future version of <b>dacstoken</b>, or a
  conversion utility may be written. The standard format is likely to be
  considerably more complex than the <b>DACS</b> format.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>XML Provisioning Format</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
The XML format understood by <b>dacstoken</b> consists of a root element
  (&quot;otp_tokens&quot;), followed by zero or more &quot;otp_token&quot;
  elements, one per line, each with required and optional attributes (described
  below). The XML declaration must be omitted. Leading whitespace and blank
  lines are ignored, as are single line XML comments. Additionally, lines having
  a &quot;#&quot; as the first non-whitespace character are ignored. Optional
  attributes that are not present are assigned default values. The default
  digest algorithm is SHA-1. Short attribute names are used to save space.
  Unrecognized attributes, and attributes irrelevant to the device mode, are
  ignored. Single or double quote characters (or both) within XML attribute
  values must be replaced by the corresponding entity reference
  (&quot;&amp;apos;&quot; and &quot;&amp;quot;&quot;, respectively), as must the
  &quot;&lt;&quot; (less than) and &quot;&amp;&quot; (ampersand) characters. A
  &quot;&gt;&quot; (greater than) character may optionally be replaced by a
  &quot;&amp;gt;&quot; sequence, but no other entity references are recognized.
<div class="Pp"></div>
Recognized attributes are:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;b:
<br/>
 <i>base</i>
<br/>
 -- radix for OTP value
<br/>
 [Optional:
<br/>
 <b>10</b> (default),
<br/>
 <b>16</b>, or <b>32</b>]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;c:
<br/>
 <i>counter</i>
<br/>
 -- current counter value for HOTP, in hex if preceded
<br/>
 by &quot;0x&quot; (or &quot;0X&quot;), decimal otherwise
<br/>
 [Optional:
<br/>
 default is <b>0</b>]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;d:
<br/>
 <i>OTP device mode</i>
<br/>
 -- &quot;c&quot; (for HOTP)
<br/>
 or &quot;t&quot; (for TOTP)
<br/>
 [Required]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;dn:
<br/>
 <i>digest-name</i>
<br/>
 -- one of the Secure Hash Algorithms
<br/>
 [Optional:
<br/>
 SHA-1 (default),
<br/>
 SHA224, SHA256,
<br/>
 SHA384, SHA512]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;dr:
<br/>
 <i>clock-drift</i>
<br/>
 -- clock adjustment, in seconds, for TOTP
<br/>
 [Optional]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;ek:
<br/>
 <i>encrypted-key</i>
<br/>
 -- encrypted secret key, base-64 encoded
<br/>
 [Required:
<br/>
 OTP account records only]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;en:
<br/>
 <i>enabled-status</i>
<br/>
 -- <b>1</b> for enabled,
<br/>
 <b>0</b> for disabled
<br/>
 [Required]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;k:
<br/>
 <i>plaintext-key</i>
<br/>
 -- unencrypted secret key
<br/>
 [Required]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;lu:
<br/>
 <i>last-update</i>
<br/>
 -- Unix time of last record update
<br/>
 [Optional: default is current time]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;nd:
<br/>
 <i>ndigits</i>
<br/>
 -- number of digits for OTP value
<br/>
 [Optional:
<br/>
 default is <b>6</b> for HOTP,
<br/>
 <b>8</b> for TOTP]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;p:
<br/>
 <i>plaintext-PIN</i>
<br/>
 -- plaintext PIN value for the account
<br/>
 [Required:
<br/>
 unless ph is present,
<br/>
 for import only]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;ph:
<br/>
 <i>hashed-PIN</i>
<br/>
 -- hashed PIN value for the account
<br/>
 [Optional:
<br/>
 generated by <b>dacstoken</b>
<br/>
 for export and OTP account files only]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;s:
<br/>
 <i>serial-number</i>
<br/>
 -- unique identifier string for the device
<br/>
 [Required]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;ts:
<br/>
 <i>time-step</i>
<br/>
 -- time-step value, in seconds, for TOTP
<br/>
 [Optional:
<br/>
 default is <b>30</b>]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;u:
<br/>
 <i>username</i>
<br/>
 -- a valid <b>DACS</b> username associated with this account
<br/>
 [Required]</div>
<div class="Pp"></div>
The following example describes two accounts that might be created using the
  <b>-import</b> flag:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;otp_tokens&gt;
&lt;!-- Staff OTP tokens for DACS authentication --&gt;
&lt;otp_token u=&quot;ietf&quot; d=&quot;t&quot; en=&quot;1&quot; s=&quot;totp-ietf &amp;quot;draft&amp;quot;&quot; k=&quot;3132333435363738393031323334353637383930&quot; dn=&quot;SHA1&quot; ts=&quot;30&quot;/&gt;
&lt;otp_token u=&quot;ipod-c&quot; d=&quot;c&quot; en=&quot;1&quot; s=&quot;ipodc-9C841SD4203&quot; k=&quot;19c0a3519a89b4a8034c5b9306db&quot; dn=&quot;SHA1&quot; c=&quot;0&quot; nd=&quot;6&quot; b=&quot;10&quot;/&gt;
&lt;/otp_tokens&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>KeyUriFormat Provisioning Format</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
The <b>KeyUriFormat</b>[37] provisioning format is supported by several OTP
  clients, such as <b>FreeOTP</b>[30] and <b>Google Authenticator</b>[28]. In
  this format, a URI describes the current state of an account. The URI can be
  encoded into a <b>QR Code</b>[39] image (a two-dimensional barcode), which
  these and other OTP clients can recognize and conveniently and correctly
  import using a device's camera. Also, software such as <b>zbarimg</b>, a
  component of the <b>ZBar</b>[40] suite, can scan and decode barcodes that it
  finds in image files.
<div class="Pp"></div>
An account can be created by <b>dacstoken</b>, exported as a KeyUriFormat URI,
  converted to a QR Code image, sent to a user (e.g., via email or an IM) or
  displayed on a secure web page, and finally imported by a user's client
  software. A QR Code generator that has been successfully used for this purpose
  with the iPhone is <b>qrencode</b>, which is distributed with the
  <b>libqrencode library</b>[41].
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Notes</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
<div style="margin-left: 4.00ex;">&#x2022;Depending on QR Code generation
  parameters, there is a limit to the length of the KeyUriFormat that can be
  encoded. The maximum URI length is likely to be around 2,953 characters.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;The <i>secret</i> query parameter (the
  OTP seed) is <b>base-32 encoded</b>[42] without padding.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;A newline should not be encoded in the
  barcode.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;The <b>-issuer</b> flag can be used to
  specify the name of the token issuer.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;A QR barcode can be easily copied by
  an attacker for reuse.</div>
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
In addition to the standard <b></b><i>dacsoptions</i>[1], a lengthy list of
  command line flags are recognized. When a <i>username</i> is given, default
  values associated with that account are used, otherwise recommended or
  implementation-specific defaults are used. These default values can usually be
  overridden on the command line. Some flags are only allowed with a particular
  token mode (e.g., <b>-counter</b>, <b>-totp-show</b>) and their appearance
  implies that mode, making the <b>-mode</b> flag unnecessary; other flags are
  mode independent (e.g., <b>-delete</b>, <b>-enable</b>). It is an error to use
  a mutually incompatible flag combination. Flags that are meaningless with the
  selected operation are ignored, although they still imply a mode. Hexadecimal
  values are case insensitive. If a counter value is required but unspecified
  (e.g., when creating an account), an initial counter value of zero is used.
<div class="Pp"></div>
The <i>op-spec</i> specifies the operation to be performed, together with zero
  or more <i>modifier</i> flags. If <i>op-spec</i> is missing, the <b>-list</b>
  operation is performed. An <i>op-spec</i> is one of the following:
<div class="Pp"></div>
<b>-auth</b> <i>otp-value</i>
<div style="margin-left: 4.00ex;">This flag is like <b></b><b>-validate</b>[43],
  except:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;a <i>username</i> is required, from
  which all parameters are obtained (such as the key);</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;if the account has a PIN, it must be
  provided;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;if the account is for a HOTP token,
  the counter will be updated if authentication is successful.</div>
<div style="height: 1.00em;">&#x00A0;</div>
An exit status of zero indicates successful authentication, while any other
  value means authentication failed.</div>
<div class="Pp"></div>
<b>-convert </b><b></b><i>filename</i>
<div style="margin-left: 4.00ex;">Load an older format (prior to release 1.4.25)
  token account file from <i>filename</i> (&quot;-&quot; means to read from
  stdin), convert it to the newer format, and write it to stdout (as by
  <b>-export</b>). This flag is deprecated and this capability will be removed
  in a future release of <b>DACS</b>.</div>
<div class="Pp"></div>
<b>-create</b>
<div style="margin-left: 4.00ex;">Create an account for <i>username</i>, which
  must not already exist. In other respects it works like
  <b></b><b>-set</b>[44]. When creating a new account, <b>-serial</b> is
  required and <b>-key</b> is implied. If no <b>-enable</b> flag is provided
  when creating an account, <b>-disable</b> is implied. If no <b>-counter</b>
  flag is provided, a default of zero is used. If one of the PIN flags is
  present, the given PIN will be assigned to the account, otherwise the account
  will not have a PIN (or the existing PIN will not be changed).</div>
<div class="Pp"></div>
<b>-current</b>
<div style="margin-left: 4.00ex;">Display the current moving factor (i.e., the
  counter value for HOTP or the interval value for TOTP) and expected OTP for
  <i>username</i>. For HOTP, the counter is advanced. All parameters are taken
  from the account.</div>
<div class="Pp"></div>
<b>-delete</b>
<div style="margin-left: 4.00ex;">Delete the account for <i>username</i>. The
  device's secret key and other operational parameters will be lost.</div>
<div class="Pp"></div>
<b>-delpin</b>
<div style="margin-left: 4.00ex;">Delete the PIN, if present, on the account for
  <i>username</i>, leaving the account without a PIN.</div>
<div class="Pp"></div>
<b>-export</b>
<div style="margin-left: 4.00ex;">Write information about all accounts, or only
  one account if <i>username</i> is given, to stdout. If a mode is selected,
  however, only accounts having that mode will be written. This information may
  be reloaded using <b>-import</b> or <b>-import-replace</b>. The output should
  be stored in an encrypted form, or at the very least have its file permissions
  set appropriately. For example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacstoken -uj EXAMPLE -export | openssl enc -aes-256-cbc &gt; dacstoken-exported.enc
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Later, you might do something like:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% openssl enc -d -aes-256-cbc &lt; dacstoken-exported.enc | dacstoken -uj EXAMPLE -import -
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
<b>-h</b>
<div>&#x00A0;</div>
<b>-help</b>
<div style="margin-left: 4.00ex;">Display a help message and exit.</div>
<div class="Pp"></div>
<b>-hotp-show</b> <i>num</i>
<div style="margin-left: 4.00ex;">Display <i>num</i> consecutive HOTP passwords
  from a given counter value and key. The <b>-counter</b> flag can be used to
  specify an initial counter value. The key can be specified using <b>-key</b>,
  <b>-key-file</b>, or <b>-key-prompt</b>. If a <i>username</i> is provided, the
  initial counter value and key are obtained from the user's HOTP account,
  unless either value is overridden on the command line; the account's stored
  counter value is not modified. This is mainly intended for debugging
  purposes.</div>
<div class="Pp"></div>
<b>-import </b><b></b><i>filename</i>
<div>&#x00A0;</div>
<b>-import-replace </b><b></b><i>filename</i>
<div style="margin-left: 4.00ex;">Load account and token information from
  <i>filename</i>; if <i>filename</i> is &quot;-&quot;, stdin is read. If a mode
  is selected, only accounts having that mode will be read. With <b>-import</b>
  it is an error if an imported account already exists, and processing stops;
  <b>-import-replace</b> will replace an existing account with imported
  data.</div>
<div class="Pp"></div>
<b>-issuer </b><b></b><i>name</i>
<div style="margin-left: 4.00ex;">Use the string <i>name</i> as the token issuer
  when exporting an account in KeyUriFormat format.</div>
<div class="Pp"></div>
<b>-l</b>
<div>&#x00A0;</div>
<b>-list</b>
<div>&#x00A0;</div>
<b>-L</b>
<div>&#x00A0;</div>
<b>-long</b>
<div style="margin-left: 4.00ex;">If <i>username</i> is provided, list the
  corresponding account (it is an error if the account does not exist).
  Otherwise, if the <b>-serial</b> flag is given, list the account with the
  specified serial number. If neither argument is given, list all accounts
  having the mode specified by the <b>-mode</b> flag, or if <b>-mode</b> is
  absent, all accounts. If <b>-l</b> (equivalently, <b>-list</b>) is repeated,
  or with the <b>-long</b> flag (equivalently, <b>-L</b>), more detail is
  displayed for each account:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;account name,.RE
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;device type (mode of operation),.RE
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;account status,.RE
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;device serial number,.RE
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;counter value (for HOTP),.RE
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;clock drift value (for TOTP),.RE
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;whether or not the account has a PIN
  (indicated by a &quot;+&quot; or &quot;-&quot; symbol), and</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;the time and date of the account's
  last modification..RE
<div style="height: 1.00em;">&#x00A0;</div>
Examples:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacstoken -uj EXAMPLE -long
bobo,hotp,disabled,&quot;foo17&quot;,000000000000000a,-PIN,10-Sep-2014@10:57:20
auggie,totp,enabled,&quot;c200-2009234172055&quot;,0,-PIN,20-May-2010@14:20:01
% dacstoken -uj EXAMPLE -mode hotp -L
bobo,hotp,disabled,&quot;foo17&quot;,000000000000000a,-PIN,10-Sep-2014@10:57:20
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
<b>-rename</b> <i>new-username</i>
<div style="margin-left: 4.00ex;">Rename the existing account for
  <i>username</i> to be <i>new-username</i>, and modify the new account using
  command line arguments (as with <b></b><b>-set</b>[44]). As this requires two
  steps that are not done atomically, if an error occurs it is possible for the
  new account to be created and the old account to still exist.</div>
<div class="Pp"></div>
<b>-set</b>
<div style="margin-left: 4.00ex;">The <b>-set</b> flag is used to modify the
  existing account for <i>username</i> based on one or more modifier arguments (
  <b>-base</b>, <b>-counter</b>, <b>-digits</b>, <b>-disable</b> or
  <b>-enable</b>, <b>-key</b> (or <b>-key-file</b> or <b>-key-prompt</b>),
  <b>-pin</b> (or <b>-pin-file</b> or <b>-pin-prompt</b>), or <b>-serial</b>).
  The mode can also be changed by specifying <b>-mode</b>, but mode-specific
  parameters associated with the account will be lost (e.g., the current counter
  value will be deleted if a HOTP account is changed to a TOTP account) and
  general parameters (such as the serial number) will be retained unless
  overridden on the command line.</div>
<div class="Pp"></div>
<b>-sync </b><b></b><i>password-list</i>
<div style="margin-left: 4.00ex;">In HOTP mode, this attempts to synchronize the
  server with the token for <i>username</i>. The <i>password-list</i> is a
  comma-separated list of three successive passwords produced by the user's
  token (this &quot;auto-synchronize&quot; function is also available through
  <b>local_token_authenticate</b>[3]). The given sequence must match the
  computed sequence <i>exactly</i>, given the operational parameters in effect;
  e.g., leading zeroes are significant, as is the display radix and number of
  OTP digits in effect. If synchronization is successful, the user should be
  able to authenticate using the next password produced by the device. An
  exhaustive search algorithm using increasing counter values is employed, with
  a compile-time limit on the maximum number of computations. The search begins
  at the server's currently stored counter value, unless one is provided using
  <b>-counter</b>. If unsuccessful, this operation could take a long time before
  it terminates; the user must contact an administrator for assistance.
<div style="height: 1.00em;">&#x00A0;</div>
In TOTP mode, attempt to determine how closely synchronized the system clock is
  with the token's clock and display the result. This information can be used to
  update the user's token record to compensate for poorly synchronized clocks,
  or to adjust validation parameters. The token's key and the name of the digest
  algorithm are obtained for the token record belonging to <i>username</i>, if
  it is given; otherwise the key is prompted for and the digest algorithm to use
  is either obtained from the command line or the default. Only the first
  password in <i>password-list</i> is used. The <b>-totp-timestep</b>,
  <b>-digits</b>, and <b>-totp-base</b> options are effective during this
  operation.</div>
<div class="Pp"></div>
<b>-test</b>
<div style="margin-left: 4.00ex;">Perform some self-tests, then exit. A non-zero
  exit status means an error occurred.</div>
<div class="Pp"></div>
<b>-totp-show</b> <i>num</i>
<div style="margin-left: 4.00ex;">Display a sequence of TOTP passwords using the
  parameters currently in effect: interval size ( <b>-totp-timestep</b>), number
  of digits ( <b>-digits</b>), and base (<b>-base</b>). The account's stored
  parameters are not modified. This is mainly intended for debugging purposes.
<div style="height: 1.00em;">&#x00A0;</div>
If a <i>username</i> is provided (it must be associated with a TOTP device), the
  key and other stored parameters from the account are used unless overridden by
  command line flags. The sequence of passwords for <i>num</i> intervals before
  and after the current time, together with the password for the current time
  are printed.
<div style="height: 1.00em;">&#x00A0;</div>
If no <i>username</i> is given, the program prompts for the key (which is
  echoed) if none has been provided, and uses command line flags or default
  values for parameters. It then emits the TOTP password for the current time
  each time Return/Enter is pressed; typing EOF causes immediate termination. If
  <i>num</i> is zero, however, the program does not wait for user input and
  prints only one password.</div>
<div class="Pp"></div>
<b>-validate</b> <i>otp-value</i>
<div style="margin-left: 4.00ex;">If <i>otp-value</i> is the next expected
  one-time password, return an exit status of zero to indicate success; any
  other value indicates failure. If <i>username</i> is given, parameters for
  validation, including the key, are obtained from that account unless
  overridden on the command line. The server's state is not changed; e.g., a
  HOTP counter is not advanced. If no <i>username</i> is given, the <b>-mode</b>
  flag must be used and the parameters required for that mode must be given,
  including a key. For HOTP mode, a counter value must be provided. For TOTP
  mode, command line parameters are effective during this validation.
  <b>dacstoken</b> will test whether <i>otp-value</i> validates against the
  parameters in effect.</div>
<div class="Pp"></div>
The following <i>modifier</i> flags are understood:
<div class="Pp"></div>
<b>-all</b>
<div style="margin-left: 4.00ex;">With <b>-set</b> and no <i>username</i>, apply
  the changes to <i>all</i> accounts. This can be used to enable or disable all
  accounts, for example. The <b>-inkeys</b> and <b>-outkeys</b> flags are
  honoured. If an error occurs processing stops immediately, in which case only
  some accounts may have been modified.</div>
<div class="Pp"></div>
<b>-base</b> <i>num</i>
<div style="margin-left: 4.00ex;">Use <i>num</i> as the base (radix) when
  displaying an OTP. The value of <i>num</i> is restricted to <b>10</b> (the
  default), <b>16</b>, or <b>32</b>.</div>
<div class="Pp"></div>
<b>-counter</b> <i>num</i>
<div style="margin-left: 4.00ex;">This is the 8-byte HOTP counter value to set,
  expressed as a hex value if preceded by by &quot;0x&quot; (or &quot;0X&quot;),
  decimal otherwise. Leading zeroes may be elided. This implies HOTP mode. For
  token devices, it should not be possible to reset a counter (modulo counter
  overflow) because that will result in the password sequence being repeated,
  assuming that the key is not changed; software implementations might not have
  this restriction, however, so beware of the security implications.</div>
<div class="Pp"></div>
<b>-digits</b> <i>num</i>
<div style="margin-left: 4.00ex;">Use <i>num</i> digits when displaying an OTP.
  The value of <i>num</i> is restricted to <b>6</b>, <b>7</b>, <b>8</b> (the
  default), or <b>9</b> with base <b>10</b>. It is restricted to <b>6</b> with
  base <b>32</b> and is ignored with base <b>16</b> (hex output).</div>
<div class="Pp"></div>
<b>-disable</b>
<div style="margin-left: 4.00ex;">Disable the account for <i>username</i>. The
  <b>local_token_authenticate</b> module, and <b>-auth</b> and <b>-validate</b>
  flags, will not allow the user to authenticate until the account has been
  enabled, although other operations may still be performed on the account. If
  <b>-enable</b> is subsequently used, the account will become usable for
  authentication and is restored to its state at the time it was disabled. It is
  not an error to disable an already disabled account.</div>
<div class="Pp"></div>
<b>-enable</b>
<div style="margin-left: 4.00ex;">Enable the account for <i>username</i>. The
  <b>local_token_authenticate</b> module will allow the user to authenticate. It
  is not an error to enable an already enabled account.</div>
<div class="Pp"></div>
<b>-hotp-window</b> <i>num</i>
<div style="margin-left: 4.00ex;">If the expected HOTP password does not match
  the given password, try to match up to <i>num</i> passwords after the expected
  password in the sequence. A value of zero for <i>num</i> disables this
  search.</div>
<div class="Pp"></div>
<b>-ignore-key-length</b>
<div style="margin-left: 4.00ex;">Do not enforce the minimum key length
  requirement (in bytes, applied to the decoded <i>keyval</i> string argument
  specified by <b>-key</b>).</div>
<div class="Pp"></div>
<b>-inkeys </b><b></b><i>item_type</i>
<div style="margin-left: 4.00ex;">For decrypting secret keys, use the store
  identified by <i>item_type</i>, presumably configured in dacs.conf.</div>
<div class="Pp"></div>
<b>-key</b> <i>keyval</i>
<div style="margin-left: 4.00ex;">Use <i>keyval</i> as the secret key, expressed
  as a hex digit string by default (see <b>-key-enc</b>).
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
Supplying a key on the command line is not secure because it may be visible to
  other processes.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div class="Pp"></div>
<b>-key-enc</b> <i>enc</i>
<div style="margin-left: 4.00ex;">The secret key, however it is read by
  <b>dacstoken</b>, has been encoded using algorithm <i>enc</i>. Recognized
  values (case insensitive) for <i>enc</i> are &quot;hex&quot;,
  &quot;base32&quot; ( <b>RFC 4648</b>[45]), and &quot;none&quot; (plaintext).
  The default is &quot;hex&quot;.</div>
<div class="Pp"></div>
<b>-key-file</b> <i>filename</i>
<div style="margin-left: 4.00ex;">Read the secret key from <i>filename</i>,
  expressed as a hex digit string by default (see <b>-key-enc</b>). If
  <i>filename</i> is &quot;-&quot;, the key is read from stdin.</div>
<div class="Pp"></div>
<b>-key-prompt</b>
<div style="margin-left: 4.00ex;">Prompt for the secret key, expressed as a hex
  digit string by default (see <b>-key-enc</b>). The input is not echoed.</div>
<div class="Pp"></div>
<b>-mode</b> <i>otp-mode</i>
<div style="margin-left: 4.00ex;">This specifies (case insensitively) the type
  of token (the OTP device mode) for use with <b>-set</b>, <b>-create</b>,
  listing accounts, and validation and synchronization operations. The
  <i>otp-mode</i> may be either counter or hotp for counter mode, or time or
  totp for time-based mode, case insensitively. This flag is required when
  creating a new account.</div>
<div class="Pp"></div>
<b>-nl</b>
<div style="margin-left: 4.00ex;">When exporting the uri format, suppress the
  newline. When generating a QR barcode from the URI, a newline should not be
  encoded.</div>
<div class="Pp"></div>
<b>-outkeys </b><b></b><i>item_type</i>
<div style="margin-left: 4.00ex;">For encrypting secret keys, use the store
  identified by <i>item_type</i>, presumably defined in dacs.conf.</div>
<div class="Pp"></div>
<b>-pin</b> <i>pinval</i>
<div style="margin-left: 4.00ex;">Use <i>pinval</i> as the secret PIN for the
  account.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
Supplying a PIN on the command line is not secure because it may be visible to
  other processes.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div class="Pp"></div>
<b>-pin-constraints</b> <i>str</i>
<div style="margin-left: 4.00ex;">Instead of using
  <b>PASSWORD_CONSTRAINTS</b>[14], use <i>str</i> (having the same syntax and
  semantics) to describe the requirements for a PIN.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
Requirements for a PIN apply to PINs obtained via a command line flag and to
  those obtained through importing (using the &quot;p&quot; attribute).
  Requirements are not &quot;retroactive&quot;, however, so changing the
  requirements does not affect the PINs of existing accounts or importing
  accounts that were previously exported (having a &quot;ph&quot; attribute).
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div class="Pp"></div>
<b>-pin-file</b> <i>filename</i>
<div style="margin-left: 4.00ex;">Read the secret PIN from <i>filename</i>. If
  <i>filename</i> is &quot;-&quot;, the PIN is read from stdin.</div>
<div class="Pp"></div>
<b>-pin-prompt</b>
<div style="margin-left: 4.00ex;">Prompt for the secret PIN. The input is not
  echoed.</div>
<div class="Pp"></div>
<b>-rnd</b>
<div style="margin-left: 4.00ex;">Reserved for future use.</div>
<div class="Pp"></div>
<b>-seed</b> <i>str</i>
<div style="margin-left: 4.00ex;">Reserved for future use.</div>
<div class="Pp"></div>
<b>-serial </b><b></b><i>str</i>
<div style="margin-left: 4.00ex;">The serial number, <i>str</i>, is a
  (purportedly) unique identifier assigned to the token. This option is used
  with the <b>-set</b>, <b>-create</b>, and <b>-list</b> flags. A serial number
  identifies a specific OTP device and need not be kept secret. The uniqueness
  property is enforced within an item type storage unit; that is, serial numbers
  of all HOTP devices must be unique, serial numbers of all TOTP devices must be
  unique, and if accounts for the two device types are combined, all device
  serial numbers must be unique. Any printable string is accepted. If a software
  client is generating passwords, you may use the device's serial number, or
  choose any suitably descriptive string not already assigned to a device.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
A jurisdiction that allows (or may eventually allow) both hardware tokens and
  software-generating client applications should consider adopting a formalized
  naming scheme for its tokens. For example, the administrator might append
  &quot;-hw&quot; to the vendor's serial number to form the <b>dacstoken</b>
  serial number. For software tokens, the administrator might create a
  <b>dacstoken</b> serial number by appending &quot;-sw&quot; to the vendor's
  serial number for the device.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div class="Pp"></div>
<b>-totp-delta</b> <i>num</i>
<div style="margin-left: 4.00ex;">Adjust the base time by <i>num</i> intervals
  (each of the step size number of seconds) when computing a TOTP. The
  <i>num</i> may be negative, zero, or positive. This is used to correct for
  inadequately synchronized clocks.</div>
<div class="Pp"></div>
<b>-totp-drift</b> <i>nwindows</i>
<div style="margin-left: 4.00ex;">For TOTP, use a window size of <i>nwindows</i>
  (in terms of the interval size) for validation. If <i>nwindows</i> is
  <b>0</b>, the computed TOTP value must match the given one exactly. If
  <i>nwindows</i> is <b>1</b>, for example, <b>dacstoken</b> will try to match
  the given TOTP value in the previous, current, and next intervals. This allows
  the clocks in the system running <b>dacstoken</b> (or
  <b>local_token_authenticate</b>) and token producing device to be less well
  synchronized.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
Although it compensates for poorly synchronized clocks, increasing the value of
  <i>nwindows</i> weakens the system by extending the lifetime of a one-time
  password.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div class="Pp"></div>
<b>-totp-hash</b> <i>alg</i>
<div style="margin-left: 4.00ex;">Use <i>alg</i> as the digest algorithm with
  TOTP. The value of <i>alg</i> is restricted to SHA1 (the default), SHA256, or
  SHA512. Digest name matching is described in <b>dacs.exprs(5)</b>[46].</div>
<div class="Pp"></div>
<b>-totp-time</b> <i>secs</i>
<div style="margin-left: 4.00ex;">Use <i>secs</i>, expressed as the number of
  seconds since the Unix Epoch, instead of the current date and time.</div>
<div class="Pp"></div>
<b>-totp-timestep</b> <i>secs</i>
<div style="margin-left: 4.00ex;">Use <i>secs</i> as the interval size when
  computing a TOTP. It must be greater than zero. The default is <b>30</b>
  seconds.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
Although it compensates for poorly synchronized clocks, increasing the value of
  <i>secs</i> weakens the system by extending the lifetime of a one-time
  password.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div class="Pp"></div>
<b>-vfs</b> <i>vfs_uri</i>
<div style="margin-left: 4.00ex;">Use <i>vfs_uri</i> to override the
  <b>VFS</b>[23] configuration directive in effect. This can be used to
  configure or reconfigure auth_token, auth_hotp_token, or auth_totp_token to
  specify the storage method for the accounts being acted upon.</div>
<div class="Pp"></div>
Apart from error messages, which are printed to the standard error, all output
  goes to the standard output.
<div class="Pp"></div>
Ordinarily, a <i>dacsoption</i> will be specified to select the jurisdiction on
  behalf of which accounts are being managed.</div>
</div>
</div>
</div>
</div>
</div>
</div>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
These examples assume that the jurisdiction name to use is EXAMPLE and its
  federation domain is example.com.
<div class="Pp"></div>
To use this authentication method, a <b>DACS</b> administrator might perform the
  following steps for each OTP device assigned to a user:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 1.Obtain a supported token or software
  client, review how it is used for authentication, and select values for the
  various parameters. For a hardware device, obtain the secret key from the
  vendor, or if it is programmable, select a suitable random key and program it
  into the device. For the HOTP algorithm, note the initial counter value; it
  might also be obtained from the vendor, although it is likely to initialized
  to zero. For a programmable device or client, set the initial counter value to
  zero. Decide whether a PIN will be required (see
  <b>TOKEN_REQUIRES_PIN</b>[9]).
<div style="height: 1.00em;">&#x00A0;</div>
If a software client is being used, install the software on the user's device
  (or have the user do so), and configure the software.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 2.Decide where the account information will
  be stored for <b>DACS</b> and, if necessary, add a suitable <b>VFS</b>[23]
  directive to dacs.conf. The default (found in site.conf) maintains the account
  information in a file named auth_tokens within each jurisdiction's default
  private area:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
VFS &quot;[auth_token]dacs-kwv-fs:${Conf::FEDERATIONS_ROOT}/\
${Conf::FEDERATION_DOMAIN}/${Conf::JURISDICTION_NAME}/auth_tokens&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 3.Generate keys to encrypt the account
  information (see <b>Tokens and secret keys</b>[47]) and decide where they will
  be stored; for example (your user ID, group ID, path, jurisdiction name, and
  federation domain may vary):
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% cd /usr/local/dacs/federations_root/example.com/EXAMPLE
% dacskey -uj EXAMPLE -q auth_token_keys
% chgrp www auth_token_keys
% chmod 0640 auth_token_keys
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
If necessary, add a suitable <b>VFS</b>[23] directive to dacs.conf; the default,
  which is used above, maintains the account information in a file named
  auth_token_keys within each jurisdiction's default private area:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
VFS &quot;[auth_token_keys]dacs-fs:${Conf::FEDERATIONS_ROOT}/\
${Conf::FEDERATION_DOMAIN}/${Conf::JURISDICTION_NAME}/auth_token_keys&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 4.If you need users to sign on through
  <b>dacs_authenticate(8)</b>[2], you must configure a suitable Auth clause in
  dacs.conf, for example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;Auth id=&quot;token&quot;&gt;
  URL &quot;token&quot;
  STYLE &quot;pass&quot;
  CONTROL &quot;sufficient&quot;
&lt;/Auth&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 5.There are several ways that an
  administrator might proceed, depending on how much of the effort can be done
  by users (e.g., whether they can be trusted, their technical ability), how
  many users there are (a few, or thousands), and the level of security
  required. Here is one way:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 1.prepare a file containing an <b>XML
  record</b>[48] for each account to be created; if PINs are to be used, assign
  a random PIN to each account;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 2.use the <b>-import</b>[49] flag to create
  the accounts;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 3.give the token device, username, and (if
  necessary) initial PIN to the user (perhaps verifying identity), providing any
  necessary demonstration and instructions;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 4.have the user set or reset the PIN for the
  account, and ask the user to sign on using the token to confirm correct
  operation.</div>
<div style="height: 1.00em;">&#x00A0;</div>
Another method of provisioning a token-based account using a QR barcode might
  follow steps similar to these for user alice:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 1.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacstoken -format uri -export -issuer DSS -nl alice &gt; alice.uri
% qrencode -o alice.png &lt; alice.uri
% chmod 0600 alice.uri alice.png
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
The exported URI put in alice.uri might look something like this:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
otpauth://totp/DSS:alice?secret=NBSWY3DPFR3W64TMMQXGCYTDMRSQ&amp;issuer=DSS&amp;algorithm=SHA1&amp;digits=8&amp;period=30
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 2.The image file alice.png is then sent to
  Alice over a sufficiently secure channel, after which alice.png and alice.uri
  may be deleted.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 3.Upon obtaining alice.png, Alice scans or
  imports the URI using her OTP client. If the user has a web browser that has
  been configured to associate the otpauth URI scheme with a suitable OTP
  client, it may be possible for the user to initialize the new account using
  the URI directly rather than the equivalent QR barcode. Her client should now
  be capable of generating a password stream that is synchronized with her
  <b>DACS</b> token account. If HOTP is being used, several OTP values might be
  provided with alice.png so that Alice can verify that her client has correctly
  initialized her account.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacstoken -hotp-show 3 alice
0000000000000000: 070440
0000000000000001: 089277
0000000000000002: 253240
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Alternatively, a web page might be provided to help users verify correct
  operation and enable their account.</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
To create a disabled account for user bobo for a HOTP device:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacstoken -uj EXAMPLE -mode hotp -serial 37000752 -key-file bobo.key -create bobo
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
In this example, the secret key for the account (which must not already exist)
  is read from the file bobo.key. New accounts are disabled by default. Use
  <b>-enable</b> to create an enabled account.
<div class="Pp"></div>
Once an account has been created, it can be synchronized with the token. To
  synchronize the HOTP token for user bobo:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacstoken -uj EXAMPLE -sync 433268,894121,615120 bobo
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
In this example, the particular token produced the three consecutive passwords
  433268, 894121, and 615120. Note that the password sequence string that
  follows the <b>-sync</b> flag is a single argument that cannot have any
  embedded spaces. If the key for this token is the value
  19c0a3519a89b4a8034c5b9306db, supplied as a hex string, the next password
  generated by this token should be 544323 (with counter value <b>13</b>). This
  can be verified using <b>-hotp-show</b>:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacstoken -hotp-show 5 -counter 10 -key 19c0a3519a89b4a8034c5b9306db -ignore-key-length
000000000000000a: 433268
000000000000000b: 894121
000000000000000c: 615120
000000000000000d: 544323
000000000000000e: 002442
</pre>
</div>
<div class="Pp"></div>
To enable the account for user bobo:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacstoken -uj EXAMPLE -enable -set bobo
</pre>
</div>
<div class="Pp"></div>
To both set the PIN and enable the account for user bobo:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacstoken -uj EXAMPLE -enable -pin &quot;CzAy&quot; -set bobo
</pre>
</div>
<div class="Pp"></div>
To list all accounts in detail:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacstoken -uj EXAMPLE -long
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
The <b>-list</b> flag is redundant because it is the default operation. The
  <b>-counter</b>, etc. modifiers have no effect when listing.
<div class="Pp"></div>
To list only the account for bobo:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacstoken -uj EXAMPLE -list bobo
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
The exit status will be non-zero if this user does not have an account.
<div class="Pp"></div>
To display the account for the device with serial number 37000752:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacstoken -uj EXAMPLE -serial 37000752
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
The serial number, which should uniquely identify a token, is often printed on
  the token or can be displayed by the token.
<div class="Pp"></div>
To set the counter value for the existing account of bobo:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacstoken -uj EXAMPLE -counter 9 -set bobo
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
This operation might be used for testing or with a software token. The
  <b>-sync</b> operation is more appropriate for a hardware token.
<div class="Pp"></div>
To change the PIN for username bobo:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacstoken -uj EXAMPLE -pin-prompt -set bobo
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
The program will prompt for the new PIN.
<div class="Pp"></div>
To use an alternate account file, /secure/auth_tokens:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacstoken -uj EXAMPLE -vfs &quot;dacs-kwv-fs:/secure/auth_tokens&quot; -list
</pre>
</div>
<div class="Pp"></div>
To use new keys (making the same assumptions as earlier), add a suitable VFS
  directive to dacs.conf; the default defines the item type auth_token_keys_prev
  as follows:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
VFS &quot;[auth_token_keys_prev]dacs-fs:${Conf::FEDERATIONS_ROOT}/\
${Conf::FEDERATION_DOMAIN}/${Conf::JURISDICTION_NAME}/auth_token_keys.prev&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% cd /usr/local/dacs/federations_root/example.com/EXAMPLE
% mv auth_token_keys auth_token_keys.prev
% dacskey -uj EXAMPLE -q auth_token_keys
% chgrp www auth_token_keys
% chmod 0640 auth_token_keys
% dacstoken -uj EXAMPLE -inkeys auth_token_keys.prev -set
</pre>
</div>
<div class="Pp"></div>
The following examples outline how <b>dacstoken</b> might be used to generate
  the same output sequence as <b>Google Authenticator</b>[50] (tested with
  Version 2.1.0.2212). Here, the key is &quot;mfrggzdf&quot;, which is the
  <b>base-32 encoding</b>[42] of the string &quot;abcde&quot;. Since this an
  unsafe, five-byte long key, it must be expressly allowed by using the
  <b>-ignore-key_length</b> flag. Google Authenticator produces codes composed
  of six decimal digits. In HOTP (counter-based) mode, Google Authenticator
  starts a new token with a counter value of one. Using this command,
  <b>dacstoken</b> displays ten consecutive codes, starting with the code for a
  counter value of one:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacsexpr -e 'encode(base32,&quot;abcde&quot;)'
&quot;MFRGGZDF&quot;
% dacstoken -un -hotp-show 10 -digits 6 -counter 1 -key mfrggzdf -key-enc base32 -ignore-key-length
0000000000000001: 106998
0000000000000002: 421654
0000000000000003: 118157
0000000000000004: 283104
0000000000000005: 848242
0000000000000006: 615855
0000000000000007: 507768
0000000000000008: 063257
0000000000000009: 974271
000000000000000a: 178655
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Similarly, for TOTP (time-based) mode, this displays the current time-based code
  that should match the code produced by Google Authenticator during the same
  time interval (if you try this your output code will most likely be
  different):
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacstoken -un -totp-show 0 -digits 6 -key mfrggzdf -key-enc base32 -ignore-key-length
TOTP=525711 [at t=1371760542]
</pre>
</div>
<div class="Pp"></div>
To generate some of the <b>RFC 6238</b>[5], Appendix B test vector values:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacstoken -un -totp-show 0 -key 12345678901234567890 -key-enc none -totp-time 59
TOTP=94287082 [at t=59]
% dacstoken -un -totp-show 0 -key 12345678901234567890123456789012 -totp-hash sha256 -key-enc none -totp-time 59
TOTP=46119246 [at t=59]
% dacstoken -un -totp-show 0 -key 1234567890123456789012345678901234567890123456789012345678901234 \
  -totp-hash sha512 -key-enc none -totp-time 59
TOTP=90693936 [at t=59]
% dacstoken -un -totp-show 0 -key 12345678901234567890 -key-enc none -totp-time 2000000000
TOTP=69279037 [at t=2000000000]
</pre>
</div>
<div class="Pp"></div>
The <b>dacsexpr(1)</b>[18] <b>base-32 encoding and decoding functions</b>[51]
  may be helpful.
<h1 class="Sh" title="Sh" id="DIAGNOSTICS"><a class="selflink" href="#DIAGNOSTICS">DIAGNOSTICS</a></h1>
The program exits 0, or 1 if an error occurred.
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
HOTP should probably be called COTP, but HOTP came before TOTP. WOTP?
<div class="Pp"></div>
Listings may only be sorted by username.
<div class="Pp"></div>
The drift adjustment for TOTP accounts is tied to the real time clocks of a
  particular client/server pair. If either clock is effectively changed
  &quot;too much&quot; (e.g., by resetting a very fast server clock or replacing
  an old token that had a relatively slower clock), then a user will observe the
  token to suddenly stop working. Resynchronization is required in these cases.
  Sharing an account file amongst two or more servers should be avoided in
  general (because locks are unlikely to be visible across hosts), but also if
  their clocks are not always well synchronized. It is recommended that the
  Network Time Protocol ( <b>RFC 1305</b>[52]) or equivalent be used on any host
  that runs <b>DACS</b> commands or web services.
<div class="Pp"></div>
The implementation of time-based tokens was originally based on the
  Internet-Draft available at the time (draft-mraihi-totp-timebased-05.txt) but
  is expected to conform to <b>RFC 6238</b>[5], <i>TOTP: Time-Based One-Time
  Password Algorithm</i>, and interoperate with other conformant hardware and
  software tokens. <b>DACS</b> passes both documents' test vectors.
<div class="Pp"></div>
TOTP password matching windows are symmetrical.
<div class="Pp"></div>
This functionality should probably be available through <b>dacs_admin(8)</b>[53]
  and <b>dacsauth(1)</b>[54], but it's not.
<div class="Pp"></div>
Mutual authentication using tokens should be implemented.
<div class="Pp"></div>
Although release 1.4.25 introduced many improvements, some cause
  incompatibilities with earlier versions of <b>dacstoken</b>.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>RFC 4226</b>[4], <b>draft-mraihi-totp-timebased-05.txt</b>[55], <b>RFC
  6238</b>[5], <b>dacs_authenticate(8)</b>[2], <b>dacs_token(8)</b>[8],
  <b>dacsgrid(1)</b>[56], <b>dacspasswd(1)</b>[10], <b>opie(4)</b>[57],
  <b>Mobile One Time Passwords</b>[58], <b>mod_authn_otp</b>[59]
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Distributed Systems Software ( <b>www.dss.ca</b>[60])
<h1 class="Sh" title="Sh" id="ACKNOWLEDGEMENTS"><a class="selflink" href="#ACKNOWLEDGEMENTS">ACKNOWLEDGEMENTS</a></h1>
Our sincere thanks to <b>Authenex, Inc.</b>[25] and <b>HyperSecu Information
  Systems, Inc.</b>[27] for generously providing samples of their products and
  technical support.
<h1 class="Sh" title="Sh" id="COPYING"><a class="selflink" href="#COPYING">COPYING</a></h1>
Copyright2003-2016 Distributed Systems Software. See the <b>LICENSE</b>[61] file
  that accompanies the distribution for licensing information.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"> 1.</dt>
  <dd class="It-tag">dacsoptions</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.1.html#dacsoptions</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 2.</dt>
  <dd class="It-tag">dacs_authenticate</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_authenticate.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 3.</dt>
  <dd class="It-tag">local_token_authenticate</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_authenticate.8.html#token</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 4.</dt>
  <dd class="It-tag">RFC 4226</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc4226.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 5.</dt>
  <dd class="It-tag">RFC 6238</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc6238.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 6.</dt>
  <dd class="It-tag">RFC 6287</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc6287.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 7.</dt>
  <dd class="It-tag"><b>-convert</b> flag</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#convert_flag</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 8.</dt>
  <dd class="It-tag">dacs_token(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_token.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 9.</dt>
  <dd class="It-tag">TOKEN_REQUIRES_PIN</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#TOKEN_REQUIRES_PIN</div>
<dl class="Bl-tag">
  <dt class="It-tag">10.</dt>
  <dd class="It-tag">dacspasswd(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacspasswd.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">11.</dt>
  <dd class="It-tag">dacs_passwd(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_passwd.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">12.</dt>
  <dd class="It-tag">PASSWORD_DIGEST</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#PASSWORD_DIGEST</div>
<dl class="Bl-tag">
  <dt class="It-tag">13.</dt>
  <dd class="It-tag">PASSWORD_SALT_PREFIX</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#PASSWORD_SALT_PREFIX</div>
<dl class="Bl-tag">
  <dt class="It-tag">14.</dt>
  <dd class="It-tag">PASSWORD_CONSTRAINTS</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#PASSWORD_CONSTRAINTS</div>
<dl class="Bl-tag">
  <dt class="It-tag">15.</dt>
  <dd class="It-tag">RFC 2104</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc2104.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">16.</dt>
  <dd class="It-tag">FIPS 198</dd>
</dl>
<div style="margin-left: 4.00ex;">http://csrc.nist.gov/publications/fips/fips198/fips-198a.pdf</div>
<dl class="Bl-tag">
  <dt class="It-tag">17.</dt>
  <dd class="It-tag">time(3)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.freebsd.org/cgi/man.cgi?query=time&amp;apropos=0&amp;sektion=3&amp;manpath=FreeBSD+10.1-RELEASE&amp;format=html</div>
<dl class="Bl-tag">
  <dt class="It-tag">18.</dt>
  <dd class="It-tag">dacsexpr(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacsexpr.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">19.</dt>
  <dd class="It-tag">man-in-the-middle attack</dd>
</dl>
<div style="margin-left: 4.00ex;">http://en.wikipedia.org/wiki/Man-in-the-middle_attack</div>
<dl class="Bl-tag">
  <dt class="It-tag">20.</dt>
  <dd class="It-tag">revocation list</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.acls.5.html#revocation_list</div>
<dl class="Bl-tag">
  <dt class="It-tag">21.</dt>
  <dd class="It-tag">local_passwd_authenticate</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_authenticate.8.html#passwd</div>
<dl class="Bl-tag">
  <dt class="It-tag">22.</dt>
  <dd class="It-tag"><b>DACS</b> identities</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.1.html#gloss_identity</div>
<dl class="Bl-tag">
  <dt class="It-tag">23.</dt>
  <dd class="It-tag">VFS</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#VFS</div>
<dl class="Bl-tag">
  <dt class="It-tag">24.</dt>
  <dd class="It-tag">dacskey(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacskey.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">25.</dt>
  <dd class="It-tag">Authenex A-Key 3600</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.authenex.com</div>
<dl class="Bl-tag">
  <dt class="It-tag">26.</dt>
  <dd class="It-tag">Feitian Technologies</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.ftSafe.com</div>
<dl class="Bl-tag">
  <dt class="It-tag">27.</dt>
  <dd class="It-tag">HyperSecu Information Systems</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.hypersecu.com</div>
<dl class="Bl-tag">
  <dt class="It-tag">28.</dt>
  <dd class="It-tag">Google Authenticator</dd>
</dl>
<div style="margin-left: 4.00ex;">https://itunes.apple.com/ca/app/google-authenticator/id388497605</div>
<dl class="Bl-tag">
  <dt class="It-tag">29.</dt>
  <dd class="It-tag">open source</dd>
</dl>
<div style="margin-left: 4.00ex;">https://fedorahosted.org/freeotp</div>
<dl class="Bl-tag">
  <dt class="It-tag">30.</dt>
  <dd class="It-tag">FreeOTP Authenticator</dd>
</dl>
<div style="margin-left: 4.00ex;">https://itunes.apple.com/ca/app/freeotp-authenticator/id872559395</div>
<dl class="Bl-tag">
  <dt class="It-tag">31.</dt>
  <dd class="It-tag">Red Hat</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.redhat.com</div>
<dl class="Bl-tag">
  <dt class="It-tag">32.</dt>
  <dd class="It-tag">OATH Token</dd>
</dl>
<div style="margin-left: 4.00ex;">http://oathtoken.googlecode.com</div>
<dl class="Bl-tag">
  <dt class="It-tag">33.</dt>
  <dd class="It-tag">iPod Touch, iPhone, and iPad</dd>
</dl>
<div style="margin-left: 4.00ex;">http://itunes.apple.com/us/app/oath-token/id364017137</div>
<dl class="Bl-tag">
  <dt class="It-tag">34.</dt>
  <dd class="It-tag">OTP Auth</dd>
</dl>
<div style="margin-left: 4.00ex;">https://itunes.apple.com/ca/app/otp-auth/id659877384</div>
<dl class="Bl-tag">
  <dt class="It-tag">35.</dt>
  <dd class="It-tag">contact</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.dss.ca/contactus.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">36.</dt>
  <dd class="It-tag">Photo</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/otp-tokens2.jpg</div>
<dl class="Bl-tag">
  <dt class="It-tag">37.</dt>
  <dd class="It-tag">KeyUriFormat</dd>
</dl>
<div style="margin-left: 4.00ex;">https://code.google.com/p/google-authenticator/wiki/KeyUriFormat</div>
<dl class="Bl-tag">
  <dt class="It-tag">38.</dt>
  <dd class="It-tag"><i>dacsoptions</i></dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.1.html#format-arg</div>
<dl class="Bl-tag">
  <dt class="It-tag">39.</dt>
  <dd class="It-tag">QR Code</dd>
</dl>
<div style="margin-left: 4.00ex;">http://en.wikipedia.org/wiki/QR_code</div>
<dl class="Bl-tag">
  <dt class="It-tag">40.</dt>
  <dd class="It-tag">ZBar</dd>
</dl>
<div style="margin-left: 4.00ex;">http://zbar.sourceforge.net</div>
<dl class="Bl-tag">
  <dt class="It-tag">41.</dt>
  <dd class="It-tag">libqrencode library</dd>
</dl>
<div style="margin-left: 4.00ex;">http://fukuchi.org/works/qrencode/</div>
<dl class="Bl-tag">
  <dt class="It-tag">42.</dt>
  <dd class="It-tag">base-32 encoded</dd>
</dl>
<div style="margin-left: 4.00ex;">https://en.wikipedia.org/wiki/Base32</div>
<dl class="Bl-tag">
  <dt class="It-tag">43.</dt>
  <dd class="It-tag"><b>-validate</b></dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#validate_flag</div>
<dl class="Bl-tag">
  <dt class="It-tag">44.</dt>
  <dd class="It-tag"><b>-set</b></dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#set_flag</div>
<dl class="Bl-tag">
  <dt class="It-tag">45.</dt>
  <dd class="It-tag">RFC 4648</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc4648.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">46.</dt>
  <dd class="It-tag">dacs.exprs(5)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.exprs.5.html#digest</div>
<dl class="Bl-tag">
  <dt class="It-tag">47.</dt>
  <dd class="It-tag">Tokens and secret keys</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#security1</div>
<dl class="Bl-tag">
  <dt class="It-tag">48.</dt>
  <dd class="It-tag">XML record</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#user_provisioning</div>
<dl class="Bl-tag">
  <dt class="It-tag">49.</dt>
  <dd class="It-tag">-import</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#import_flag</div>
<dl class="Bl-tag">
  <dt class="It-tag">50.</dt>
  <dd class="It-tag">Google Authenticator</dd>
</dl>
<div style="margin-left: 4.00ex;">http://en.wikipedia.org/wiki/Google_Authenticator</div>
<dl class="Bl-tag">
  <dt class="It-tag">51.</dt>
  <dd class="It-tag">base-32 encoding and decoding functions</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.exprs.5.html#encode</div>
<dl class="Bl-tag">
  <dt class="It-tag">52.</dt>
  <dd class="It-tag">RFC 1305</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc1305.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">53.</dt>
  <dd class="It-tag">dacs_admin(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_admin.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">54.</dt>
  <dd class="It-tag">dacsauth(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacsauth.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">55.</dt>
  <dd class="It-tag">draft-mraihi-totp-timebased-05.txt</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.ietf.org/id/draft-mraihi-totp-timebased-05.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">56.</dt>
  <dd class="It-tag">dacsgrid(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacsgrid.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">57.</dt>
  <dd class="It-tag">opie(4)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.freebsd.org/cgi/man.cgi?query=opie&amp;apropos=0&amp;sektion=4&amp;manpath=FreeBSD+10.1-RELEASE&amp;format=html</div>
<dl class="Bl-tag">
  <dt class="It-tag">58.</dt>
  <dd class="It-tag">Mobile One Time Passwords</dd>
</dl>
<div style="margin-left: 4.00ex;">http://motp.sourceforge.net</div>
<dl class="Bl-tag">
  <dt class="It-tag">59.</dt>
  <dd class="It-tag">mod_authn_otp</dd>
</dl>
<div style="margin-left: 4.00ex;">http://code.google.com/p/mod-authn-otp</div>
<dl class="Bl-tag">
  <dt class="It-tag">60.</dt>
  <dd class="It-tag">www.dss.ca</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.dss.ca</div>
<dl class="Bl-tag">
  <dt class="It-tag">61.</dt>
  <dd class="It-tag">LICENSE</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/../misc/LICENSE</div>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">01/12/2017</td>
    <td class="foot-os">DACS 1.4.38a</td>
  </tr>
</table>
</body>
</html>
