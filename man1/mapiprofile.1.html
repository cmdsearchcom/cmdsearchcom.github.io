<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>MAPIPROFILE(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">MAPIPROFILE(1)</td>
    <td class="head-vol">OpenChange Users' Manual</td>
    <td class="head-rtitle">MAPIPROFILE(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
mapiprofile - administer OpenChange MAPI Profiles databases
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>
mapiprofile [-?GSnEcrlV] [-?|--help] [--usage] [-L|--ldif=PATH] [-G|--getdefault] [-S|--default]
	[-n|--newdb] [-f|--database=PATH] [-P|--profile=PROFILE] [-I|--address=xxx.xxx.xxx.xxx]
	[-M|--workstation=WORKSTATION_NAME] [-D|--domain=DOMAIN] [-R|--realm=REALM] [-E|--encrypt]
	[-v|--exchange-version=2000] [-u|--username=USERNAME] [-C|--language=LANGUAGE]
	[-s|--pattern=USERNAME] [-p|--password=PASSWORD] [--nopass] [-c|--create] [-r|--delete]
	[-R|--rename=STRING] [-l|--list] [--listlangs] [--dump] [-a|--attr=VALUE] [--dump-data]
	[-d|--debuglevel=LEVEL] [--getfqdn] [-k|--kerberos={yes|no}] [-V|--version]
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
mapiprofile is a command line tool designed to provide administrative support
  for OpenChange MAPI profiles. A profile in this context represents a single
  user's connection to a server. It can be thought of as a user's account
  information stored on the client side. Most OpenChange utilities make use of
  the profile information stored in the local profile database, often by
  referring to the name of the profile. In addition, because most users only
  have a single account, it is possible to designate one profile as the default
  profile. If a profile is not specified, other utilities will use the default
  profile (if any) to establish a connection.
<div style="height: 1.00em;">&#x00A0;</div>
mapiprofile is designed so it also provides sample code for developers
  interested in adding OpenChange MAPI profile support to their applications.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="COMMANDS"><a class="selflink" href="#COMMANDS">COMMANDS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--newdb</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n</b></dt>
  <dd class="It-tag">Create a new database.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--create</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c</b></dt>
  <dd class="It-tag">Create a new profile in the database.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--delete</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-r</b></dt>
  <dd class="It-tag">Delete a profile from the database.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--rename PROFILE</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-R</b></dt>
  <dd class="It-tag">Rename a profile in the database
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--default</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-S</b></dt>
  <dd class="It-tag">Set the default profile in the database.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--getdefault</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-G</b></dt>
  <dd class="It-tag">Get the default profile name from the database.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dump</b></dt>
  <dd class="It-tag">Display information about a specific profile from
      information stored in the database.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--list</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l</b></dt>
  <dd class="It-tag">List existing profiles in the database.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--listlangs</b></dt>
  <dd class="It-tag">List the available languages. These can be used to specify
      the language name (--language) when creating a profile.
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--database DATABASE</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b></dt>
  <dd class="It-tag">Path to the profile database. If no path database is
      specified then the default one will be used
      <b>$HOME/.openchange/profiles.ldb</b>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ldif LDIF</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-L</b></dt>
  <dd class="It-tag">Path to the LDIF files. If no LDIF directory is specified
      then the default one set at compilation time will be used. This option is
      only used when creating a new profile database.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--profile PROFILE</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p</b></dt>
  <dd class="It-tag">Set the profile name to use (e.g. the profile to create or
      delete, or to dump information about).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--address IP_ADDR|FQDN</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-I</b></dt>
  <dd class="It-tag">Set the Exchange server IP address or fully qualified
      domain name.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--workstation WORKSTATION</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-M</b></dt>
  <dd class="It-tag">Sets the local computer name.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--domain DOMAIN</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-D</b></dt>
  <dd class="It-tag">Set the Windows domain name.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--encrypt</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-E</b></dt>
  <dd class="It-tag">Require the connection to be encrypted. This is normally
      required only on Exchange 2010 (and will presumably also be required on
      future versions), but may be used on Exchange 2003 and Exchange 2007.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--exchange-version</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v</b></dt>
  <dd class="It-tag">Specify which version of the protocol to use. The
      reasonable options are 2000, 2003/2007 and 2010. 2000 means use
      EcDoConnect (0x0) / EcDoRpc (0x2) RPC calls, 2003 or 2007 means use
      EcDoConnectEx (0xA) / EcDoRpcExt2 (0xB) RPC calls, and 2010 means use
      EcDoConnectEx (0xA) / EcDoRpcExt2 (0xB) RPC calls over a sealed pipe.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--kerberos</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-k</b></dt>
  <dd class="It-tag">Specify whether to force Kerberos (set to yes), not use
      Kerberos (set to no). If you omit this option, Kerberos will be used where
      practical.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--realm REALM</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-R</b></dt>
  <dd class="It-tag">Set the Windows realm
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--username</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-u</b></dt>
  <dd class="It-tag">Set the username to use to log on the Exchange server.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--password</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p</b></dt>
  <dd class="It-tag">Set the password corresponding to the username described
      above.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--language</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-C</b></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    Specify the language to use with the account. When specifying the name, you
      use the name of the language returned within the list --listlangs option
      displays. See the --listlangs option for how to obtain the full list of
      languages. The default language code is the system one stored within the
      LC_CTYPE environment variable.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--pattern</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s</b></dt>
  <dd class="It-tag">Set a username string pattern mapiprofile should use rather
      than the default username. This option is used during mapi profile
      creation.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--nopass</b></dt>
  <dd class="It-tag">Do not save password in the profile.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--attr VALUE</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-a</b></dt>
  <dd class="It-tag">Print an attribute value.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dump-data</b></dt>
  <dd class="It-tag">Dump the hex data.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--debuglevel LEVEL</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d</b></dt>
  <dd class="It-tag">Set the debug level.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--getfqdn</b></dt>
  <dd class="It-tag">Returns the DNS fully qualified domain name of the NSPI
      server matching the legacyDN.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<b>Create a blank MAPI profile database:</b>
<pre>
mapiprofile --database=/tmp/profiles2.ldb --ldif=/usr/local/samba/share/setup --newdb
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<b>Create a new profile using NTLMSSP authentication:</b>
<pre>
mapiprofile --database=/tmp/profiles.ldb --profile=jkerihuel
     --username=jkerihuel --password=secret --language=French\ \(France\)
     --address=192.168.194.22 --workstation=LOCALHOST --domain=OPENCHANGE 
     --create
Profile jkerihuel completed and added to database /tmp/profiles.ldb.
Note that this account will use French.
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<b>Create a new profile using Kerberos authentication:</b>
<pre>
mapiprofile --database=/tmp/profiles.ldb --profile=jkerihuel
     --username=jkerihuel --password=secret --language=French\ \(France\)
     --address=exchange.openchange.local --domain=OPENCHANGE
     --realm=OPENCHANGE.LOCAL --create
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<b>Delete a profile:</b>
<pre>
mapiprofile --database=/tmp/profiles.ldb --profile=jkerihuel --delete
Profile jkerihuel deleted from database /tmp/profiles.ldb
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<b>List profiles:</b>
<pre>
mapiprofile --database=/tmp/profiles.ldb --list
We have 2 profiles in the database:
        Profile = exchange-2000
        Profile = jkerihuel
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<b>Dump a profile:</b>
<pre>
mapiprofile --database=/tmp/profiles.ldb --profile=jkerihuel --dump
Profile: jkerihuel
	username       == jkerihuel
	password       == secret
	mailbox        == /o=First Organization/ou=First Administrative Group/cn=Recipients/cn=jkerihuel
	workstation    == LOCALHOST
	domain         == OPENCHANGE
	server         == exchange.openchange.local
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<b>Dump profile attribute:</b>
<pre>
mapiprofile --database=/tmp/profiles.ldb --profile=jkerihuel --attr=HomeMDB
Profile jkerihuel: HomeMDB = /o=First Organization/ou=First Administrative Group/cn=Configuration/cn=Servers/cn=EXCHANGE2000
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Julien Kerihuel &lt;j.kerihuel at openchange dot org&gt;
<div style="height: 1.00em;">&#x00A0;</div>
Brad Hards &lt;bradh at openchange dot org&gt;
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
The codes for various languages can be found in many places, including the
  Windows Language Code Identifier (LCID) Reference.
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2013-01-24</td>
    <td class="foot-os">OpenChange 2.0 QUADRANT</td>
  </tr>
</table>
</body>
</html>
