<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:23:53 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>MAPIPROFILE(1) OpenChange Users&rsquo; Manual
MAPIPROFILE(1)</p>

<p style="margin-top: 1em">NAME <br>
mapiprofile - administer OpenChange MAPI Profiles
databases</p>

<p style="margin-top: 1em">SYNOPSIS <br>
mapiprofile [-?GSnEcrlV] [-?|--help] [--usage]
[-L|--ldif=PATH] [-G|--getdefault] [-S|--default] <br>
[-n|--newdb] [-f|--database=PATH] [-P|--profile=PROFILE]
[-I|--address=xxx.xxx.xxx.xxx] <br>
[-M|--workstation=WORKSTATION_NAME] [-D|--domain=DOMAIN]
[-R|--realm=REALM] [-E|--encrypt] <br>
[-v|--exchange-version=2000] [-u|--username=USERNAME]
[-C|--language=LANGUAGE] <br>
[-s|--pattern=USERNAME] [-p|--password=PASSWORD] [--nopass]
[-c|--create] [-r|--delete] <br>
[-R|--rename=STRING] [-l|--list] [--listlangs] [--dump]
[-a|--attr=VALUE] [--dump-data] <br>
[-d|--debuglevel=LEVEL] [--getfqdn] [-k|--kerberos={yes|no}]
[-V|--version]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
mapiprofile is a command line tool designed to provide
administrative support for OpenChange MAPI profiles. A
profile in this context represents a single user&rsquo;s
connection to a <br>
server. It can be thought of as a user&rsquo;s account
information stored on the client side. Most OpenChange
utilities make use of the profile information stored in the
local profile <br>
database, often by referring to the name of the profile. In
addition, because most users only have a single account, it
is possible to designate one profile as the default
pro&acirc; <br>
file. If a profile is not specified, other utilities will
use the default profile (if any) to establish a
connection.</p>

<p style="margin-top: 1em">mapiprofile is designed so it
also provides sample code for developers interested in
adding OpenChange MAPI profile support to their
applications.</p>

<p style="margin-top: 1em">COMMANDS <br>
--newdb</p>

<p style="margin-top: 1em">-n Create a new database.</p>

<p style="margin-top: 1em">--create</p>

<p style="margin-top: 1em">-c Create a new profile in the
database.</p>

<p style="margin-top: 1em">--delete</p>

<p style="margin-top: 1em">-r Delete a profile from the
database.</p>

<p style="margin-top: 1em">--rename PROFILE</p>

<p style="margin-top: 1em">-R Rename a profile in the
database</p>

<p style="margin-top: 1em">--default</p>

<p style="margin-top: 1em">-S Set the default profile in
the database.</p>

<p style="margin-top: 1em">--getdefault</p>

<p style="margin-top: 1em">-G Get the default profile name
from the database.</p>

<p style="margin-top: 1em">--dump Display information about
a specific profile from information stored in the
database.</p>

<p style="margin-top: 1em">--list</p>

<p style="margin-top: 1em">-l List existing profiles in the
database.</p>

<p style="margin-top: 1em">--listlangs <br>
List the available languages. These can be used to specify
the language name (--language) when creating a profile.</p>

<p style="margin-top: 1em">OPTIONS <br>
--database DATABASE</p>

<p style="margin-top: 1em">-f Path to the profile database.
If no path database is specified then the default one will
be used $HOME/.openchange/profiles.ldb</p>

<p style="margin-top: 1em">--ldif LDIF</p>

<p style="margin-top: 1em">-L Path to the LDIF files. If no
LDIF directory is specified then the default one set at
compilation time will be used. This option is only used when
creating a new profile <br>
database.</p>

<p style="margin-top: 1em">--profile PROFILE</p>

<p style="margin-top: 1em">-p Set the profile name to use
(e.g. the profile to create or delete, or to dump
information about).</p>

<p style="margin-top: 1em">--address IP_ADDR|FQDN</p>

<p style="margin-top: 1em">-I Set the Exchange server IP
address or fully qualified domain name.</p>

<p style="margin-top: 1em">--workstation WORKSTATION</p>

<p style="margin-top: 1em">-M Sets the local computer
name.</p>

<p style="margin-top: 1em">--domain DOMAIN</p>

<p style="margin-top: 1em">-D Set the Windows domain
name.</p>

<p style="margin-top: 1em">--encrypt</p>

<p style="margin-top: 1em">-E Require the connection to be
encrypted. This is normally required only on Exchange 2010
(and will presumably also be required on future versions),
but may be used on <br>
Exchange 2003 and Exchange 2007.</p>

<p style="margin-top: 1em">--exchange-version</p>

<p style="margin-top: 1em">-v Specify which version of the
protocol to use. The reasonable options are 2000, 2003/2007
and 2010. 2000 means use EcDoConnect (0x0) / EcDoRpc (0x2)
RPC calls, 2003 or <br>
2007 means use EcDoConnectEx (0xA) / EcDoRpcExt2 (0xB) RPC
calls, and 2010 means use EcDoConnectEx (0xA) / EcDoRpcExt2
(0xB) RPC calls over a sealed pipe.</p>

<p style="margin-top: 1em">--kerberos</p>

<p style="margin-top: 1em">-k Specify whether to force
Kerberos (set to yes), not use Kerberos (set to no). If you
omit this option, Kerberos will be used where practical.</p>

<p style="margin-top: 1em">--realm REALM</p>

<p style="margin-top: 1em">-R Set the Windows realm</p>

<p style="margin-top: 1em">--username</p>

<p style="margin-top: 1em">-u Set the username to use to
log on the Exchange server.</p>

<p style="margin-top: 1em">--password</p>

<p style="margin-top: 1em">-p Set the password
corresponding to the username described above.</p>

<p style="margin-top: 1em">--language</p>

<p style="margin-top: 1em">-C</p>

<p style="margin-top: 1em">Specify the language to use with
the account. When specifying the name, you use the name of
the language returned within the list --listlangs option
displays. See the <br>
--listlangs option for how to obtain the full list of
languages. The default language code is the system one
stored within the LC_CTYPE environment variable.</p>

<p style="margin-top: 1em">--pattern</p>

<p style="margin-top: 1em">-s Set a username string pattern
mapiprofile should use rather than the default username.
This option is used during mapi profile creation.</p>

<p style="margin-top: 1em">--nopass <br>
Do not save password in the profile.</p>

<p style="margin-top: 1em">--attr VALUE</p>

<p style="margin-top: 1em">-a Print an attribute value.</p>

<p style="margin-top: 1em">--dump-data <br>
Dump the hex data.</p>

<p style="margin-top: 1em">--debuglevel LEVEL</p>

<p style="margin-top: 1em">-d Set the debug level.</p>

<p style="margin-top: 1em">--getfqdn <br>
Returns the DNS fully qualified domain name of the NSPI
server matching the legacyDN.</p>

<p style="margin-top: 1em">EXAMPLES <br>
Create a blank MAPI profile database: <br>
mapiprofile --database=/tmp/profiles2.ldb
--ldif=/usr/local/samba/share/setup --newdb</p>

<p style="margin-top: 1em">Create a new profile using
NTLMSSP authentication: <br>
mapiprofile --database=/tmp/profiles.ldb --profile=jkerihuel
<br>
--username=jkerihuel --password=secret
--language=French&nbsp;ance <br>
--address=192.168.194.22 --workstation=LOCALHOST
--domain=OPENCHANGE <br>
--create <br>
Profile jkerihuel completed and added to database
/tmp/profiles.ldb. <br>
Note that this account will use French.</p>

<p style="margin-top: 1em">Create a new profile using
Kerberos authentication: <br>
mapiprofile --database=/tmp/profiles.ldb --profile=jkerihuel
<br>
--username=jkerihuel --password=secret
--language=French&nbsp;ance <br>
--address=exchange.openchange.local --domain=OPENCHANGE <br>
--realm=OPENCHANGE.LOCAL --create</p>

<p style="margin-top: 1em">Delete a profile: <br>
mapiprofile --database=/tmp/profiles.ldb --profile=jkerihuel
--delete <br>
Profile jkerihuel deleted from database
/tmp/profiles.ldb</p>

<p style="margin-top: 1em">List profiles: <br>
mapiprofile --database=/tmp/profiles.ldb --list <br>
We have 2 profiles in the database: <br>
Profile = exchange-2000 <br>
Profile = jkerihuel</p>

<p style="margin-top: 1em">Dump a profile: <br>
mapiprofile --database=/tmp/profiles.ldb --profile=jkerihuel
--dump <br>
Profile: jkerihuel <br>
username == jkerihuel <br>
password == secret <br>
mailbox == /o=First Organization/ou=First Administrative
Group/cn=Recipients/cn=jkerihuel <br>
workstation == LOCALHOST <br>
domain == OPENCHANGE <br>
server == exchange.openchange.local</p>

<p style="margin-top: 1em">Dump profile attribute: <br>
mapiprofile --database=/tmp/profiles.ldb --profile=jkerihuel
--attr=HomeMDB <br>
Profile jkerihuel: HomeMDB = /o=First Organization/ou=First
Administrative
Group/cn=Configuration/cn=Servers/cn=EXCHANGE2000</p>

<p style="margin-top: 1em">AUTHOR <br>
Julien Kerihuel &lt;j.kerihuel at openchange dot org&gt;</p>

<p style="margin-top: 1em">Brad Hards &lt;bradh at
openchange dot org&gt;</p>

<p style="margin-top: 1em">SEE ALSO <br>
The codes for various languages can be found in many places,
including the Windows Language Code Identifier (LCID)
Reference.</p>

<p style="margin-top: 1em">OpenChange 2.0 QUADRANT
2013-01-24 MAPIPROFILE(1)</p>
<hr>
</body>
</html>
