<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:27:34 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>NS6(1) General Commands Manual NS6(1)</p>

<p style="margin-top: 1em">NAME <br>
ns6 - A security assessment tool for attack vectors based on
ICMPv6 Neighbor Solicitation messages</p>

<p style="margin-top: 1em">SYNOPSIS <br>
ns6 [-i INTERFACE] [-s SRC_ADDR[/LEN]] [-d DST_ADDR] [-y
FRAG_SIZE] [-u DST_OPT_HDR_SIZE] [-U DST_OPT_U_HDR_SIZE] [-H
HBH_OPT_HDR_SIZE] [-S LINK_SRC_ADDR] [-D LINK-DST-ADDR] [-E
<br>
LINK_ADDR] [-e] [-t TARGET_ADDR[/LEN]] [-F N_SOURCES] [-T
N_TARGETS] [-z SECONDS] [-l] [-v] [-h]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
ns6 allows the assessment of IPv6 implementations with
respect to a variety of attacks based on ICMPv6 Neighbor
Solicitation messages. This tool is part of the SI6
Networks&rsquo; IPv6 <br>
Toolkit: a security assessment suite for the IPv6
protocols.</p>

<p style="margin-top: 1em">OPTIONS <br>
ns6 The ns6 tool takes its parameters by means of
command-line options. Each of the options can be specified
with a short name (one character preceded with the hyphen
character, <br>
as e.g. &quot;-i&quot;) or with a long name (a string
preceded with two hyphen characters, as e.g.
&quot;--interface&quot;).</p>

<p style="margin-top: 1em">Depending on the amount of
information (i.e., options) to be conveyed into the Neighbor
Solicitations, it may be necessary for the ns6 tool to split
that information into more <br>
than one Neighbor Solicitation message. Also, when the ns6
tool is instructed to flood the victim with Neighbor
Solicitations from different sources
(&quot;--flood-sources&quot; option), <br>
multiple packets may need to be sent. ns6 supports IPv6
fragmentation, which may be of use if a large amount of
information needs to be conveyed within a single Neighbor
Solici&acirc; <br>
tation message. IPv6 fragmentation is not enabled by
default, and must be explicitly enabled with the
&quot;-y&quot; option.</p>

<p style="margin-top: 1em">-i INTERFACE, --interface
INTERFACE <br>
This option specifies the network interface that the tool
will use. If the destination address (&quot;-d&quot; option)
is a link-local address, the interface must be explicitly
<br>
specified. The interface may also be specified along with a
destination address, with the &quot;-d&quot; option.</p>

<p style="margin-top: 1em">-s SRC_ADDR, --src-address
SRC_ADDR</p>

<p style="margin-top: 1em">This option is meant to specify
the IPv6 Source Address to be used for the Neighbor
Solicitation messages. If left unspecified, a randomized
link-local (fe80::/64) address <br>
is selected.</p>

<p style="margin-top: 1em">-d DST_ADDR, --dst-address
DST_ADDR</p>

<p style="margin-top: 1em">This option specifies the IPv6
Destination Address of the Neighbor Solicitation messages.
If this option is left unspecified, but the Ethernet
Destination Address is spec&acirc; <br>
ified, the &quot;all-nodes link-local multicast&quot;
address (ff02::1) is selected as the IPv6 Destination
Address.</p>

<p style="margin-top: 1em">--hop-limit, -A</p>

<p style="margin-top: 1em">This option specifies the IPv6
Hop Limit to be used for the Neighbor Solicitation messages.
It defaults to 255. Note that IPv6 nodes are required to
check that the Hop <br>
Limit of incoming Neighbor Solicitation messages is 255.
Therefore, this option is only useful to assess whether an
IPv6 implementation fails to enforce the aforementioned <br>
check.</p>

<p style="margin-top: 1em">-y SIZE, --frag-hdr SIZE</p>

<p style="margin-top: 1em">This option specifies that the
resulting packet must be fragmented. The fragment size must
be specified as an argument to this option.</p>

<p style="margin-top: 1em">-u HDR_SIZE, --dst-opt-hdr
HDR_SIZE</p>

<p style="margin-top: 1em">This option specifies that a
Destination Options header is to be included in the
resulting packet. The extension header size must be
specified as an argument to this <br>
option (the header is filled with padding options). Multiple
Destination Options headers may be specified by means of
multiple &quot;-u&quot; options.</p>

<p style="margin-top: 1em">-U HDR_SIZE, --dst-opt-u-hdr
HDR_SIZE</p>

<p style="margin-top: 1em">This option specifies a
Destination Options header to be included in the
&quot;unfragmentable part&quot; of the resulting packet. The
header size must be specified as an argument to <br>
this option (the header is filled with padding options).
Multiple Destination Options headers may be specified by
means of multiple &quot;-U&quot; options. This option is
only valid <br>
if the &quot;-y&quot; option is specified (as the concept of
&quot;unfragmentable part&quot; only makes sense when
fragmentation is employed).</p>

<p style="margin-top: 1em">-H HDR_SIZE, --hbh-opt-hdr
HDR_SIZE</p>

<p style="margin-top: 1em">This option specifies that a
Hop-by-Hop Options header is to be included in the resulting
packet. The header size must be specified as an argument to
this option (the <br>
header is filled with padding options). Multiple Hop-by-Hop
Options headers may be specified by means of multiple
&quot;-H&quot; options.</p>

<p style="margin-top: 1em">-S SRC_LINK_ADDR,
--src-link-address SRC_LINK_ADDR</p>

<p style="margin-top: 1em">This option specifies the
link-layer Source Address of the Neighbor Solicitation
messages (currently, only Ethernet is supported). If left
unspecified, the link-layer <br>
Source Address is randomized.</p>

<p style="margin-top: 1em">-D DST_LINK_ADDR,
--dst-link-address DST_LINK_ADDR</p>

<p style="margin-top: 1em">This option specifies the
link-layer Destination Address of the Neighbor Solicitation
messages (currently, only Ethernet is supported). If left
unspecified, it is set to <br>
the address &quot;33:33:00:00:00:01&quot; (the Ethernet
address corresponding to the &quot;all-nodes link-local
multicast&quot; IPv6 address (ff02::1).</p>

<p style="margin-top: 1em">--target, -t</p>

<p style="margin-top: 1em">This option specifies the IPv6
Target Address of the Neighbor Solicitation messages.</p>

<p style="margin-top: 1em">If the &quot;-T&quot;
(&quot;--flood-targets&quot;) option is specified, this
option specifies an IPv6 prefix in the form &quot;-t
prefix/prefixlen&quot;. See the description of the
&quot;-T&quot; option for <br>
further information on how the &quot;-t&quot; option is
processed in that specific case.</p>

<p style="margin-top: 1em">--source-lla-opt, -E</p>

<p style="margin-top: 1em">This option specifies the
contents of a source link-layer address option to be
included in the Neighbor Solicitation messages. If more than
one source link-layer address <br>
is specified (by means of multiple &quot;-E&quot; options),
and all the resulting options cannot be conveyed into a
single Neighbor Solicitation, multiple Neighbor
Solicitations <br>
will be sent as needed.</p>

<p style="margin-top: 1em">--add-slla-opt, -e</p>

<p style="margin-top: 1em">This option instructs the ns6
tool to include a source link-layer address option in the
Neighbor Solicitation messages that it sends. The link-layer
address included in <br>
the option is the same as the Ethernet Source Address used
for the outgoing Neighbor Solicitation messages.</p>

<p style="margin-top: 1em">--flood-sources, -F</p>

<p style="margin-top: 1em">This option instructs the ns6
tool to send Neighbor Solicitations from multiple (and
random) IPv6 Source Addresses. The number of different
sources is specified as &quot;-F <br>
number&quot;. The IPv6 Source Address of the packets are
randomly selected from the prefix specified by the
&quot;-s&quot; option (which defaults to fe80::/64).</p>

<p style="margin-top: 1em">--flood-targets, -T</p>

<p style="margin-top: 1em">This option instructs the ns6
tool to send Neighbor Solicitation messages for multiple
Target Addresses. The number of different Target Addresses
is specified as &quot;-T num&acirc; <br>
ber&quot;. The Target Address of each packet is randomly
selected from the prefix ::/64, unless a different prefix
has been specified by means of the &quot;-t&quot;
option.</p>

<p style="margin-top: 1em">--loop, -l</p>

<p style="margin-top: 1em">This option instructs the ns6
tool to send periodic Neighbor Solicitations to the victim.
The amount of time to pause between sending Neighbor
Solicitations can be speci&acirc; <br>
fied by means of the &quot;-z&quot; option, and defaults to
1 second.</p>

<p style="margin-top: 1em">--sleep, -z</p>

<p style="margin-top: 1em">This option instructs the ns6
tool to the amount of time to pause between sending Neighbor
Solicitations. If left unspecified, it defaults to 1
second.</p>

<p style="margin-top: 1em">--verbose, -v</p>

<p style="margin-top: 1em">This option instructs the ns6
tool to be verbose.</p>

<p style="margin-top: 1em">--help, -h</p>

<p style="margin-top: 1em">Print help information for the
ns6 tool.</p>

<p style="margin-top: 1em">EXAMPLES <br>
The following sections illustrate typical use cases of the
ns6 tool.</p>

<p style="margin-top: 1em">Example #1</p>

<p style="margin-top: 1em"># ns6 -i eth0 -d fe80::01 -t
2001:db8::1 -e</p>

<p style="margin-top: 1em">Use the network interface
&quot;eth0&quot; to send a Neighbor Solicitation message
using a random link-local unicast IPv6 Source Address and a
random Ethernet Source Address, to the IPv6 <br>
Destination address fe80::1 and the Ethernet Destination
Address 33:33:00:00:00:01 (selected by default). The target
of the Neighbor Advertisement is 2001:db8::1. The Neighbor
<br>
Solicitation also includes a source link-layer address
option, that contains the same Ethernet address as that used
for the Ethernet Source Address of the packet.</p>

<p style="margin-top: 1em">Example #2</p>

<p style="margin-top: 1em"># ns6 -i eth0 -s 2001:db8::/32
-t 2001:db8::1 -F 10 -l -z 10 -e -v</p>

<p style="margin-top: 1em">Send 10 Neighbor Solicitation
messages using random Ethernet Source Addresses and random
IPv6 Source Addresses from the prefix 2001:db8::/32, to the
Ethernet Destination Address <br>
33:33:00:00:00:01 (default) and the IPv6 Destination Address
ff02::1 (default). The IPv6 Target Address of the Neighbor
Solicitation is 2001:db8::1, and each message includes a
<br>
source link-layer address option that contains the same
address as that used for the Ethernet Source Address of the
packet. Repeat this operation every ten seconds. Be
verbose.</p>

<p style="margin-top: 1em">Example #3</p>

<p style="margin-top: 1em"># ns6 -i eth0 -s 2001:db8::/32
-t 2001:db8::1 -F 10 -l -z 10 -E ff:ff:ff:ff:ff:ff -v</p>

<p style="margin-top: 1em">Send 10 Neighbor Solicitation
messages using random Ethernet Source Addresses and random
IPv6 Source Addresses from the prefix fe80::/64 (default,
link-local unicast), to the <br>
Ethernet Destination Address 33:33:00:00:00:01 (default) and
the IPv6 Destination Address ff02:1 (default). The IPv6
Target Address of the Neighbor Solicitation is 2001:db8::1,
<br>
and each message includes a source link-layer address option
that contains the Ethernet address ff:ff:ff:ff:ff:ff. Repeat
this operation every ten seconds. Be verbose.</p>

<p style="margin-top: 1em">SEE ALSO <br>
&quot;Security/Robustness Assessment of IPv6 Neighbor
Discovery Implementations&quot; (available at:
&lt;http://www.si6networks.com/tools/ipv6toolkit/si6networks-ipv6-nd-assessment.pdf&gt;)
for <br>
a discussion of Neighbor Discovery vulnerabilities, and
additional examples of how to use the na6 tool to exploit
them.</p>

<p style="margin-top: 1em">AUTHOR <br>
The ns6 tool and the corresponding manual pages were
produced by Fernando Gont &lt;fgont@si6networks.com&gt; for
SI6 Networks &lt;http://www.si6networks.com&gt;.</p>

<p style="margin-top: 1em">COPYRIGHT <br>
Copyright (c) 2011-2013 Fernando Gont.</p>

<p style="margin-top: 1em">Permission is granted to copy,
distribute and/or modify this document under the terms of
the GNU Free Documentation License, Version 1.3 or any later
version published by the <br>
Free Software Foundation; with no Invariant Sections, no
Front-Cover Texts, and no Back-Cover Texts. A copy of the
license is available at <br>
&lt;http://www.gnu.org/licenses/fdl.html&gt;.</p>
 
<p style="margin-top: 1em">NS6(1)</p>
<hr>
</body>
</html>
