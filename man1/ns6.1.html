<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>NS6(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">NS6(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">NS6(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
ns6 - A security assessment tool for attack vectors based on ICMPv6 Neighbor
  Solicitation messages
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>ns6</b> [<b>-i</b> <i>INTERFACE</i>] [-s SRC_ADDR[/LEN]] [-d DST_ADDR] [-y
  FRAG_SIZE] [-u DST_OPT_HDR_SIZE] [-U DST_OPT_U_HDR_SIZE] [-H HBH_OPT_HDR_SIZE]
  [-S LINK_SRC_ADDR] [-D LINK-DST-ADDR] [-E LINK_ADDR] [-e] [-t
  TARGET_ADDR[/LEN]] [-F N_SOURCES] [-T N_TARGETS] [-z SECONDS] [-l] [-v] [-h]
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>ns6</b> allows the assessment of IPv6 implementations with respect to a
  variety of attacks based on ICMPv6 Neighbor Solicitation messages. This tool
  is part of the SI6 Networks' IPv6 Toolkit: a security assessment suite for the
  IPv6 protocols.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<b>ns6</b> The ns6 tool takes its parameters by means of command-line options.
  Each of the options can be specified with a short name (one character preceded
  with the hyphen character, as e.g. &quot;-i&quot;) or with a long name (a
  string preceded with two hyphen characters, as e.g. &quot;--interface&quot;).
<div style="height: 1.00em;">&#x00A0;</div>
Depending on the amount of information (i.e., options) to be conveyed into the
  Neighbor Solicitations, it may be necessary for the ns6 tool to split that
  information into more than one Neighbor Solicitation message. Also, when the
  ns6 tool is instructed to flood the victim with Neighbor Solicitations from
  different sources (&quot;--flood-sources&quot; option), multiple packets may
  need to be sent. ns6 supports IPv6 fragmentation, which may be of use if a
  large amount of information needs to be conveyed within a single Neighbor
  Solicitation message. IPv6 fragmentation is not enabled by default, and must
  be explicitly enabled with the &quot;-y&quot; option.
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i&#x00A0;</b><i>INTERFACE</i><b>,&#x00A0;--interface&#x00A0;</b><i>INTERFACE</i></dt>
  <dd class="It-tag">This option specifies the network interface that the tool
      will use. If the destination address (&quot;-d&quot; option) is a
      link-local address, the interface must be explicitly specified. The
      interface may also be specified along with a destination address, with the
      &quot;-d&quot; option.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s&#x00A0;</b><i>SRC_ADDR</i><b>,&#x00A0;--src-address&#x00A0;</b><i>SRC_ADDR</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option is meant to specify the IPv6 Source Address to be used for the
      Neighbor Solicitation messages. If left unspecified, a randomized
      link-local (fe80::/64) address is selected.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d&#x00A0;</b><i>DST_ADDR</i><b>,&#x00A0;--dst-address&#x00A0;</b><i>DST_ADDR</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies the IPv6 Destination Address of the Neighbor
      Solicitation messages. If this option is left unspecified, but the
      Ethernet Destination Address is specified, the &quot;all-nodes link-local
      multicast&quot; address (ff02::1) is selected as the IPv6 Destination
      Address.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--hop-limit, -A</dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies the IPv6 Hop Limit to be used for the Neighbor
      Solicitation messages. It defaults to 255. Note that IPv6 nodes are
      required to check that the Hop Limit of incoming Neighbor Solicitation
      messages is 255. Therefore, this option is only useful to assess whether
      an IPv6 implementation fails to enforce the aforementioned check.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-y&#x00A0;</b><i>SIZE</i><b>,&#x00A0;--frag-hdr&#x00A0;</b><i>SIZE</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies that the resulting packet must be fragmented. The
      fragment size must be specified as an argument to this option.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-u&#x00A0;</b><i>HDR_SIZE</i><b>,&#x00A0;--dst-opt-hdr&#x00A0;</b><i>HDR_SIZE</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies that a Destination Options header is to be included in
      the resulting packet. The extension header size must be specified as an
      argument to this option (the header is filled with padding options).
      Multiple Destination Options headers may be specified by means of multiple
      &quot;-u&quot; options.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-U&#x00A0;</b><i>HDR_SIZE</i><b>,&#x00A0;--dst-opt-u-hdr&#x00A0;</b><i>HDR_SIZE</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies a Destination Options header to be included in the
      &quot;unfragmentable part&quot; of the resulting packet. The header size
      must be specified as an argument to this option (the header is filled with
      padding options). Multiple Destination Options headers may be specified by
      means of multiple &quot;-U&quot; options. This option is only valid if the
      &quot;-y&quot; option is specified (as the concept of &quot;unfragmentable
      part&quot; only makes sense when fragmentation is employed).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-H&#x00A0;</b><i>HDR_SIZE</i><b>,&#x00A0;--hbh-opt-hdr&#x00A0;</b><i>HDR_SIZE</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies that a Hop-by-Hop Options header is to be included in
      the resulting packet. The header size must be specified as an argument to
      this option (the header is filled with padding options). Multiple
      Hop-by-Hop Options headers may be specified by means of multiple
      &quot;-H&quot; options.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-S&#x00A0;</b><i>SRC_LINK_ADDR</i><b>,&#x00A0;--src-link-address&#x00A0;</b><i>SRC_LINK_ADDR</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies the link-layer Source Address of the Neighbor
      Solicitation messages (currently, only Ethernet is supported). If left
      unspecified, the link-layer Source Address is randomized.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-D&#x00A0;</b><i>DST_LINK_ADDR</i><b>,&#x00A0;--dst-link-address&#x00A0;</b><i>DST_LINK_ADDR</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies the link-layer Destination Address of the Neighbor
      Solicitation messages (currently, only Ethernet is supported). If left
      unspecified, it is set to the address &quot;33:33:00:00:00:01&quot; (the
      Ethernet address corresponding to the &quot;all-nodes link-local
      multicast&quot; IPv6 address (ff02::1).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--target, -t</dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies the IPv6 Target Address of the Neighbor Solicitation
      messages.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the &quot;-T&quot; (&quot;--flood-targets&quot;) option is specified,
      this option specifies an IPv6 prefix in the form &quot;-t
      prefix/prefixlen&quot;. See the description of the &quot;-T&quot; option
      for further information on how the &quot;-t&quot; option is processed in
      that specific case.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--source-lla-opt, -E</dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option specifies the contents of a source link-layer address option to
      be included in the Neighbor Solicitation messages. If more than one source
      link-layer address is specified (by means of multiple &quot;-E&quot;
      options), and all the resulting options cannot be conveyed into a single
      Neighbor Solicitation, multiple Neighbor Solicitations will be sent as
      needed.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--add-slla-opt, -e</dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option instructs the ns6 tool to include a source link-layer address
      option in the Neighbor Solicitation messages that it sends. The link-layer
      address included in the option is the same as the Ethernet Source Address
      used for the outgoing Neighbor Solicitation messages.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--flood-sources, -F</dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option instructs the ns6 tool to send Neighbor Solicitations from
      multiple (and random) IPv6 Source Addresses. The number of different
      sources is specified as &quot;-F number&quot;. The IPv6 Source Address of
      the packets are randomly selected from the prefix specified by the
      &quot;-s&quot; option (which defaults to fe80::/64).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--flood-targets, -T</dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option instructs the ns6 tool to send Neighbor Solicitation messages
      for multiple Target Addresses. The number of different Target Addresses is
      specified as &quot;-T number&quot;. The Target Address of each packet is
      randomly selected from the prefix ::/64, unless a different prefix has
      been specified by means of the &quot;-t&quot; option.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--loop, -l</dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option instructs the ns6 tool to send periodic Neighbor Solicitations
      to the victim. The amount of time to pause between sending Neighbor
      Solicitations can be specified by means of the &quot;-z&quot; option, and
      defaults to 1 second.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--sleep, -z</dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option instructs the ns6 tool to the amount of time to pause between
      sending Neighbor Solicitations. If left unspecified, it defaults to 1
      second.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--verbose, -v</dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This option instructs the ns6 tool to be verbose.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">--help, -h</dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    Print help information for the ns6 tool.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
The following sections illustrate typical use cases of the <b>ns6</b> tool.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Example #1</b>
<div style="height: 1.00em;">&#x00A0;</div>
# ns6 -i eth0 -d fe80::01 -t 2001:db8::1 -e
<div style="height: 1.00em;">&#x00A0;</div>
Use the network interface &quot;eth0&quot; to send a Neighbor Solicitation
  message using a random link-local unicast IPv6 Source Address and a random
  Ethernet Source Address, to the IPv6 Destination address fe80::1 and the
  Ethernet Destination Address 33:33:00:00:00:01 (selected by default). The
  target of the Neighbor Advertisement is 2001:db8::1. The Neighbor Solicitation
  also includes a source link-layer address option, that contains the same
  Ethernet address as that used for the Ethernet Source Address of the packet.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Example #2</b>
<div style="height: 1.00em;">&#x00A0;</div>
# ns6 -i eth0 -s 2001:db8::/32 -t 2001:db8::1 -F 10 -l -z 10 -e -v
<div style="height: 1.00em;">&#x00A0;</div>
Send 10 Neighbor Solicitation messages using random Ethernet Source Addresses
  and random IPv6 Source Addresses from the prefix 2001:db8::/32, to the
  Ethernet Destination Address 33:33:00:00:00:01 (default) and the IPv6
  Destination Address ff02::1 (default). The IPv6 Target Address of the Neighbor
  Solicitation is 2001:db8::1, and each message includes a source link-layer
  address option that contains the same address as that used for the Ethernet
  Source Address of the packet. Repeat this operation every ten seconds. Be
  verbose.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Example #3</b>
<div style="height: 1.00em;">&#x00A0;</div>
# ns6 -i eth0 -s 2001:db8::/32 -t 2001:db8::1 -F 10 -l -z 10 -E
  ff:ff:ff:ff:ff:ff -v
<div style="height: 1.00em;">&#x00A0;</div>
Send 10 Neighbor Solicitation messages using random Ethernet Source Addresses
  and random IPv6 Source Addresses from the prefix fe80::/64 (default,
  link-local unicast), to the Ethernet Destination Address 33:33:00:00:00:01
  (default) and the IPv6 Destination Address ff02:1 (default). The IPv6 Target
  Address of the Neighbor Solicitation is 2001:db8::1, and each message includes
  a source link-layer address option that contains the Ethernet address
  ff:ff:ff:ff:ff:ff. Repeat this operation every ten seconds. Be verbose.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
&quot;Security/Robustness Assessment of IPv6 Neighbor Discovery
  Implementations&quot; (available at:
  &lt;http://www.si6networks.com/tools/ipv6toolkit/si6networks-ipv6-nd-assessment.pdf&gt;)
  for a discussion of Neighbor Discovery vulnerabilities, and additional
  examples of how to use the na6 tool to exploit them.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
The <b>ns6</b> tool and the corresponding manual pages were produced by Fernando
  Gont <i>&lt;fgont@si6networks.com&gt;</i> for SI6 Networks
  <i>&lt;http://www.si6networks.com&gt;</i>.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
Copyright (c) 2011-2013 Fernando Gont.
<div style="height: 1.00em;">&#x00A0;</div>
Permission is granted to copy, distribute and/or modify this document under the
  terms of the GNU Free Documentation License, Version 1.3 or any later version
  published by the Free Software Foundation; with no Invariant Sections, no
  Front-Cover Texts, and no Back-Cover Texts. A copy of the license is available
  at <i>&lt;http://www.gnu.org/licenses/fdl.html&gt;</i>.</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
