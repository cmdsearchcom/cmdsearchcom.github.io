<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:17:32 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>HWLOC-CALC(1) hwloc HWLOC-CALC(1)</p>

<p style="margin-top: 1em">NAME <br>
hwloc-calc - Operate on cpu mask strings and objects</p>

<p style="margin-top: 1em">SYNOPSIS <br>
hwloc-calc [options] &lt;location1&gt; [&lt;location2&gt;
[...] ]</p>

<p style="margin-top: 1em">Note that hwloc(7) provides a
detailed explanation of the hwloc system and of valid
&lt;location&gt; formats; it should be read before reading
this man page.</p>

<p style="margin-top: 1em">OPTIONS <br>
-p --physical <br>
Use OS/physical indexes instead of logical indexes for both
input and output.</p>

<p style="margin-top: 1em">-l --logical <br>
Use logical indexes instead of physical/OS indexes for both
input and output (default).</p>

<p style="margin-top: 1em">--pi --physical-input <br>
Use OS/physical indexes instead of logical indexes for
input.</p>

<p style="margin-top: 1em">--li --logical-input <br>
Use logical indexes instead of physical/OS indexes for input
(default).</p>

<p style="margin-top: 1em">--po --physical-output <br>
Use OS/physical indexes instead of logical indexes for
output.</p>

<p style="margin-top: 1em">--lo --logical-output <br>
Use logical indexes instead of physical/OS indexes for
output (default, except for cpusets which are always
physical).</p>

<p style="margin-top: 1em">-N --number-of
&lt;type|depth&gt; <br>
Report the number of objects of the given type or depth that
intersect the CPU set. This is convenient for finding how
many cores, NUMA nodes or PUs are available in a <br>
machine.</p>

<p style="margin-top: 1em">-I --intersect
&lt;type|depth&gt; <br>
Find the list of objects of the given type or depth that
intersect the CPU set and report the comma-separated list of
their indexes instead of the cpu mask string. <br>
This may be used for determining the list of objects above
or below the input objects. When combined with --physical,
the list is convenient to pass to external tools <br>
such as taskset or numactl --physcpubind or --membind. This
is different from --largest since the latter requires that
all reported objects are strictly included <br>
inside the input objects.</p>

<p style="margin-top: 1em">-H --hierarchical
&lt;type1&gt;.&lt;type2&gt;... <br>
Find the list of objects of type &lt;type2&gt; that
intersect the CPU set and report the space-separated list of
their hierarchical indexes with respect to &lt;type1&gt;,
&lt;type2&gt;, <br>
etc. For instance, if package.core is given, the output
would be Package:1.Core:2 Package:2.Core:3 if the input
contains the third core of the second package and the <br>
fourth core of the third package.</p>

<p style="margin-top: 1em">--largest Report (in a human
readable format) the list of largest objects which exactly
include all input objects. None of these output objects
intersect each other, and the sum <br>
of them is exactly equivalent to the input. No largest
object is included in the input This is different from
--intersect where reported objects may not be strictly <br>
included in the input.</p>

<p style="margin-top: 1em">--sep &lt;sep&gt; <br>
Change the field separator in the output. By default, a
space is used to separate output objects (for instance when
--hierarchical or --largest is given) while a comma <br>
is used to separate indexes (for instance when --intersect
is given).</p>

<p style="margin-top: 1em">--single Singlify the output to
a single CPU.</p>

<p style="margin-top: 1em">--taskset Display CPU set
strings in the format recognized by the taskset command-line
program instead of hwloc-specific CPU set string format.
This option has no impact on the <br>
format of input CPU set strings, both formats are always
accepted.</p>

<p style="margin-top: 1em">--restrict &lt;cpuset&gt; <br>
Restrict the topology to the given cpuset.</p>

<p style="margin-top: 1em">--whole-system <br>
Do not consider administration limitations.</p>

<p style="margin-top: 1em">-i &lt;file&gt;, --input
&lt;file&gt; <br>
Read topology from XML file &lt;file&gt; (instead of
discovering the topology on the local machine). If
&lt;file&gt; is &quot;-&quot;, the standard input is used.
XML support must have <br>
been compiled in to hwloc for this option to be usable.</p>

<p style="margin-top: 1em">-i &lt;directory&gt;, --input
&lt;directory&gt; <br>
Read topology from the chroot specified by &lt;directory&gt;
(instead of discovering the topology on the local machine).
This option is generally only available on Linux. <br>
The chroot was usually created by gathering another machine
topology with hwloc-gather-topology.</p>

<p style="margin-top: 1em">-i &lt;specification&gt;,
--input &lt;specification&gt; <br>
Simulate a fake hierarchy (instead of discovering the
topology on the local machine). If &lt;specification&gt; is
&quot;node:2 pu:3&quot;, the topology will contain two NUMA
nodes with <br>
3 processing units in each of them. The
&lt;specification&gt; string must end with a number of
PUs.</p>

<p style="margin-top: 1em">--if &lt;format&gt;,
--input-format &lt;format&gt; <br>
Enforce the input in the given format, among xml, fsroot and
synthetic.</p>

<p style="margin-top: 1em">-q --quiet <br>
Hide non-fatal error messages. It mostly includes locations
pointing to non-existing objects.</p>

<p style="margin-top: 1em">-v --verbose <br>
Verbose output.</p>

<p style="margin-top: 1em">--version Report version and
exit.</p>

<p style="margin-top: 1em">DESCRIPTION <br>
hwloc-calc generates and manipulates CPU mask strings or
objects. Both input and output may be either objects (with
physical or logical indexes), CPU lists (with physical or
<br>
logical indexes), or CPU mask strings (always physically
indexed).</p>

<p style="margin-top: 1em">If objects or CPU mask strings
are given on the command-line, they are combined and a
single output is printed. If no object or CPU mask strings
are given on the command-line, <br>
the program will read the standard input. It will combine
multiple objects or CPU mask strings that are given on the
same line of the standard input line with spaces as
separa&acirc; <br>
tors. Different input lines will be processed
separately.</p>

<p style="margin-top: 1em">Command-line arguments and
options are processed in order. For instance, it means that
changing the type of input indexes with --li or changing the
input topology with -i only <br>
affects the processing the following arguments.</p>

<p style="margin-top: 1em">NOTE: It is highly recommended
that you read the hwloc(7) overview page before reading this
man page. Most of the concepts described in hwloc(7)
directly apply to the hwloc-calc <br>
utility.</p>

<p style="margin-top: 1em">EXAMPLES <br>
hwloc-calc&rsquo;s operation is best described through
several examples.</p>

<p style="margin-top: 1em">To display the (physical) CPU
mask corresponding to the second package:</p>

<p style="margin-top: 1em">$ hwloc-calc package:1 <br>
0x000000f0</p>

<p style="margin-top: 1em">To display the (physical) CPU
mask corresponding to the third pacakge, excluding its even
numbered logical processors:</p>

<p style="margin-top: 1em">$ hwloc-calc package:2 ~PU:even
<br>
0x00000c00</p>

<p style="margin-top: 1em">To combine two (physical) CPU
masks:</p>

<p style="margin-top: 1em">$ hwloc-calc 0x0000ffff
0xff000000 <br>
0xff00ffff</p>

<p style="margin-top: 1em">To display the list of logical
numbers of processors included in the second package:</p>

<p style="margin-top: 1em">$ hwloc-calc --intersect PU
package:1 <br>
4,5,6,7</p>

<p style="margin-top: 1em">To bind GNU OpenMP threads
logically over the whole machine, we need to use physical
number output instead:</p>

<p style="margin-top: 1em">$ export
GOMP_CPU_AFFINITY=&lsquo;hwloc-calc --physical-output
--intersect PU machine:0&lsquo; <br>
$ echo $GOMP_CPU_AFFINITY <br>
0,4,1,5,2,6,3,7</p>

<p style="margin-top: 1em">To display the list of NUMA
nodes, by physical indexes, that intersect a given
(physical) CPU mask:</p>

<p style="margin-top: 1em">$ hwloc-calc --physical
--intersect NUMAnode 0xf0f0f0f0 <br>
0,2</p>

<p style="margin-top: 1em">To display the physical index of
a processor given by its logical index:</p>

<p style="margin-top: 1em">$ hwloc-calc PU:2
--physical-output --intersect PU <br>
3</p>

<p style="margin-top: 1em">To display the set of CPUs near
network interface eth0:</p>

<p style="margin-top: 1em">$ hwloc-calc os=eth0 <br>
0x00005555</p>

<p style="margin-top: 1em">To display the indexes of
packages near PCI device whose bus ID is 0000:01:02.0:</p>

<p style="margin-top: 1em">$ hwloc-calc pci=0000:01:02.0
--intersect Package <br>
1</p>

<p style="margin-top: 1em">To display the list of
per-package cores that intersect the input:</p>

<p style="margin-top: 1em">$ hwloc-calc 0x00003c00
--hierarchical package.core <br>
Package:2.Core:1 Package:3.Core:0</p>

<p style="margin-top: 1em">To display the (physical) CPU
mask of the entire topology except the third package:</p>

<p style="margin-top: 1em">$ hwloc-calc all ~package:3 <br>
0x0000f0ff</p>

<p style="margin-top: 1em">To combine both physical and
logical indexes as input:</p>

<p style="margin-top: 1em">$ hwloc-calc PU:2
--physical-input PU:3 <br>
0x0000000c</p>

<p style="margin-top: 1em">To synthetize a set of cores
into largest objects on a 2-node 2-package 2-core
machine:</p>

<p style="margin-top: 1em">$ hwloc-calc core:0 --largest
<br>
Core:0 <br>
$ hwloc-calc core:0-1 --largest <br>
Package:0 <br>
$ hwloc-calc core:4-7 --largest <br>
NUMANode:1 <br>
$ hwloc-calc core:2-6 --largest <br>
Package:1 Package:2 Core:6 <br>
$ hwloc-calc pack:2 --largest <br>
Package:2 <br>
$ hwloc-calc package:2-3 --largest <br>
NUMANode:1</p>

<p style="margin-top: 1em">To get the set of first threads
of all cores:</p>

<p style="margin-top: 1em">$ hwloc-calc core:all.pu:0</p>

<p style="margin-top: 1em">This can also be very useful in
order to make GNU OpenMP use exactly one thread per core,
and in logical core order:</p>

<p style="margin-top: 1em">$ export
OMP_NUM_THREADS=&lsquo;hwloc-calc --number-of core
machine:0&lsquo; <br>
$ echo $OMP_NUM_THREADS <br>
4 <br>
$ export GOMP_CPU_AFFINITY=&lsquo;hwloc-calc
--physical-output --intersect PU core:all.pu:0&lsquo; <br>
$ echo $GOMP_CPU_AFFINITY <br>
0,2,1,3</p>

<p style="margin-top: 1em">RETURN VALUE <br>
Upon successful execution, hwloc-calc displays the
(physical) CPU mask string, (physical or logical) object
list, or (physical or logical) object number list. The
return value <br>
is 0.</p>

<p style="margin-top: 1em">hwloc-calc will return nonzero
if any kind of error occurs, such as (but not limited to):
failure to parse the command line.</p>

<p style="margin-top: 1em">SEE ALSO <br>
hwloc(7), lstopo(1), hwloc-info(1),
hwloc-gather-topology(1)</p>

<p style="margin-top: 1em">1.11.2 Dec 17, 2015
HWLOC-CALC(1)</p>
<hr>
</body>
</html>
