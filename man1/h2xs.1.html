<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>H2XS(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">H2XS(1)</td>
    <td class="head-vol">Perl Programmers Reference Guide</td>
    <td class="head-rtitle">H2XS(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
h2xs - convert .h C header files to Perl extensions
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>h2xs</b> [<b>OPTIONS</b> ...] [headerfile ... [extra_libraries]]
<div class="Pp"></div>
<b>h2xs</b> <b>-h</b>|<b>-?</b>|<b>--help</b>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<i>h2xs</i> builds a Perl extension from C header files. The extension will
  include functions which can be used to retrieve the value of any #define
  statement which was in the C header files.
<div class="Pp"></div>
The <i>module_name</i> will be used for the name of the extension. If
  module_name is not supplied then the name of the first header file will be
  used, with the first character capitalized.
<div class="Pp"></div>
If the extension might need extra libraries, they should be included here. The
  extension Makefile.PL will take care of checking whether the libraries
  actually exist and how they should be loaded. The extra libraries should be
  specified in the form -lm -lposix, etc, just as on the cc command line. By
  default, the Makefile.PL will search through the library path determined by
  Configure. That path can be augmented by including arguments of the form
  <b>-L/another/library/path</b> in the extra-libraries argument.
<div class="Pp"></div>
In spite of its name, <i>h2xs</i> may also be used to create a skeleton pure
  Perl module. See the <b>-X</b> option.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-A</b>, <b>--omit-autoload</b></dt>
  <dd class="It-tag">Omit all autoload facilities. This is the same as <b>-c</b>
      but also removes the &quot;use&#x00A0;AutoLoader&quot; statement from the
      .pm file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-B</b>, <b>--beta-version</b></dt>
  <dd class="It-tag">Use an alpha/beta style version number. Causes version
      number to be &quot;0.00_01&quot; unless <b>-v</b> is specified.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-C</b>, <b>--omit-changes</b></dt>
  <dd class="It-tag">Omits creation of the <i>Changes</i> file, and adds a
      HISTORY section to the POD template.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-F</b>, <b>--cpp-flags</b>=<i>addflags</i></dt>
  <dd class="It-tag">Additional flags to specify to C preprocessor when scanning
      header for function declarations. Writes these options in the generated
      <i>Makefile.PL</i> too.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-M</b>, <b>--func-mask</b>=<i>regular
    expression</i></dt>
  <dd class="It-tag">selects functions/macros to process.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-O</b>, <b>--overwrite-ok</b></dt>
  <dd class="It-tag">Allows a pre-existing extension directory to be
      overwritten.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-P</b>, <b>--omit-pod</b></dt>
  <dd class="It-tag">Omit the autogenerated stub POD section.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-X</b>, <b>--omit-XS</b></dt>
  <dd class="It-tag">Omit the XS portion. Used to generate a skeleton pure Perl
      module. &quot;-c&quot; and &quot;-f&quot; are implicitly enabled.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-a</b>, <b>--gen-accessors</b></dt>
  <dd class="It-tag">Generate an accessor method for each element of structs and
      unions. The generated methods are named after the element name; will
      return the current value of the element if called without additional
      arguments; and will set the element to the supplied value (and return the
      new value) if called with an additional argument. Embedded structures and
      unions are returned as a pointer rather than the complete structure, to
      facilitate chained calls.
    <div style="height: 1.00em;">&#x00A0;</div>
    These methods all apply to the Ptr type for the structure; additionally two
      methods are constructed for the structure type itself, &quot;_to_ptr&quot;
      which returns a Ptr type pointing to the same structure, and a
      &quot;new&quot; method to construct and return a new structure,
      initialised to zeroes.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-b</b>, <b>--compat-version</b>=<i>version</i></dt>
  <dd class="It-tag">Generates a .pm file which is backwards compatible with the
      specified perl version.
    <div style="height: 1.00em;">&#x00A0;</div>
    For versions &lt; 5.6.0, the changes are.
    <br/>
     - no use of 'our' (uses 'use vars' instead)
    <br/>
     - no 'use warnings'
    <div style="height: 1.00em;">&#x00A0;</div>
    Specifying a compatibility version higher than the version of perl you are
      using to run h2xs will have no effect. If unspecified h2xs will default to
      compatibility with the version of perl you are using to run h2xs.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c</b>, <b>--omit-constant</b></dt>
  <dd class="It-tag">Omit &quot;constant()&quot; from the .xs file and
      corresponding specialised &quot;AUTOLOAD&quot; from the .pm file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d</b>, <b>--debugging</b></dt>
  <dd class="It-tag">Turn on debugging messages.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-e</b>, <b>--omit-enums</b>=[<i>regular
    expression</i>]</dt>
  <dd class="It-tag">If <i>regular expression</i> is not given, skip all
      constants that are defined in a C enumeration. Otherwise skip only those
      constants that are defined in an enum whose name matches <i>regular
      expression</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
    Since <i>regular expression</i> is optional, make sure that this switch is
      followed by at least one other switch if you omit <i>regular
      expression</i> and have some pending arguments such as header-file names.
      This is ok:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    h2xs -e -n Module::Foo foo.h
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    This is not ok:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    h2xs -n Module::Foo -e foo.h
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    In the latter, foo.h is taken as <i>regular expression</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b>, <b>--force</b></dt>
  <dd class="It-tag">Allows an extension to be created for a header even if that
      header is not found in standard include directories.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-g</b>, <b>--global</b></dt>
  <dd class="It-tag">Include code for safely storing static data in the .xs
      file. Extensions that do no make use of static data can ignore this
      option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h</b>, <b>-?</b>, <b>--help</b></dt>
  <dd class="It-tag">Print the usage, help and version for this h2xs and
    exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-k</b>, <b>--omit-const-func</b></dt>
  <dd class="It-tag">For function arguments declared as &quot;const&quot;, omit
      the const attribute in the generated XS code.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-m</b>, <b>--gen-tied-var</b></dt>
  <dd class="It-tag"><b>Experimental</b>: for each variable declared in the
      header file(s), declare a perl variable of the same name magically tied to
      the C variable.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n</b>, <b>--name</b>=<i>module_name</i></dt>
  <dd class="It-tag">Specifies a name to be used for the extension, e.g.,
      -n&#x00A0;RPC::DCE</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-o</b>, <b>--opaque-re</b>=<i>regular
    expression</i></dt>
  <dd class="It-tag">Use &quot;opaque&quot; data type for the C types matched by
      the regular expression, even if these types are
      &quot;typedef&quot;-equivalent to types from typemaps. Should not be used
      without <b>-x</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
    This may be useful since, say, types which are
      &quot;typedef&quot;-equivalent to integers may represent OS-related
      handles, and one may want to work with these handles in OO-way, as in
      &quot;$handle-&gt;do_something()&quot;. Use &quot;-o .&quot; if you want
      to handle all the &quot;typedef&quot;ed types as opaque types.
    <div style="height: 1.00em;">&#x00A0;</div>
    The type-to-match is whitewashed (except for commas, which have no
      whitespace before them, and multiple &quot;*&quot; which have no
      whitespace between them).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p</b>, <b>--remove-prefix</b>=<i>prefix</i></dt>
  <dd class="It-tag">Specify a prefix which should be removed from the Perl
      function names, e.g., -p&#x00A0;sec_rgy_ This sets up the XS <b>PREFIX</b>
      keyword and removes the prefix from functions that are autoloaded via the
      &quot;constant()&quot; mechanism.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s</b>, <b>--const-subs</b>=<i>sub1,sub2</i></dt>
  <dd class="It-tag">Create a perl subroutine for the specified macros rather
      than autoload with the <i>constant()</i> subroutine. These macros are
      assumed to have a return type of <b>char *</b>, e.g.,
      -s&#x00A0;sec_rgy_wildcard_name,sec_rgy_wildcard_sid.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-t</b>, <b>--default-type</b>=<i>type</i></dt>
  <dd class="It-tag">Specify the internal type that the <i>constant()</i>
      mechanism uses for macros. The default is IV (signed integer). Currently
      all macros found during the header scanning process will be assumed to
      have this type. Future versions of &quot;h2xs&quot; may gain the ability
      to make educated guesses.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--use-new-tests</b></dt>
  <dd class="It-tag">When <b>--compat-version</b> (<b>-b</b>) is present the
      generated tests will use &quot;Test::More&quot; rather than
      &quot;Test&quot; which is the default for versions before 5.6.2.
      &quot;Test::More&quot; will be added to PREREQ_PM in the generated
      &quot;Makefile.PL&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--use-old-tests</b></dt>
  <dd class="It-tag">Will force the generation of test code that uses the older
      &quot;Test&quot; module.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--skip-exporter</b></dt>
  <dd class="It-tag">Do not use &quot;Exporter&quot; and/or export any
    symbol.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--skip-ppport</b></dt>
  <dd class="It-tag">Do not use &quot;Devel::PPPort&quot;: no portability to
      older version.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--skip-autoloader</b></dt>
  <dd class="It-tag">Do not use the module &quot;AutoLoader&quot;; but keep the
      <i>constant()</i> function and &quot;sub AUTOLOAD&quot; for
    constants.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--skip-strict</b></dt>
  <dd class="It-tag">Do not use the pragma &quot;strict&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--skip-warnings</b></dt>
  <dd class="It-tag">Do not use the pragma &quot;warnings&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v</b>, <b>--version</b>=<i>version</i></dt>
  <dd class="It-tag">Specify a version number for this extension. This version
      number is added to the templates. The default is 0.01, or 0.00_01 if
      &quot;-B&quot; is specified. The version specified should be numeric.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-x</b>, <b>--autogen-xsubs</b></dt>
  <dd class="It-tag">Automatically generate XSUBs basing on function
      declarations in the header file. The package &quot;C::Scan&quot; should be
      installed. If this option is specified, the name of the header file may
      look like &quot;NAME1,NAME2&quot;. In this case NAME1 is used instead of
      the specified string, but XSUBs are emitted only for the declarations
      included from file NAME2.
    <div style="height: 1.00em;">&#x00A0;</div>
    Note that some types of arguments/return-values for functions may result in
      XSUB-declarations/typemap-entries which need hand-editing. Such may be
      objects which cannot be converted from/to a pointer (like &quot;long
      long&quot;), pointers to functions, or arrays. See also the section on
      &quot;LIMITATIONS of <b>-x</b>&quot;.</dd>
</dl>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<pre>
    # Default behavior, extension is Rusers
    h2xs rpcsvc/rusers
    # Same, but extension is RUSERS
    h2xs -n RUSERS rpcsvc/rusers
    # Extension is rpcsvc::rusers. Still finds &lt;rpcsvc/rusers.h&gt;
    h2xs rpcsvc::rusers
    # Extension is ONC::RPC.  Still finds &lt;rpcsvc/rusers.h&gt;
    h2xs -n ONC::RPC rpcsvc/rusers
    # Without constant() or AUTOLOAD
    h2xs -c rpcsvc/rusers
    # Creates templates for an extension named RPC
    h2xs -cfn RPC
    # Extension is ONC::RPC.
    h2xs -cfn ONC::RPC
    # Extension is a pure Perl module with no XS code.
    h2xs -X My::Module
    # Extension is Lib::Foo which works at least with Perl5.005_03.
    # Constants are created for all #defines and enums h2xs can find
    # in foo.h.
    h2xs -b 5.5.3 -n Lib::Foo foo.h
    # Extension is Lib::Foo which works at least with Perl5.005_03.
    # Constants are created for all #defines but only for enums
    # whose names do not start with 'bar_'.
    h2xs -b 5.5.3 -e '^bar_' -n Lib::Foo foo.h
    # Makefile.PL will look for library -lrpc in
    # additional directory /opt/net/lib
    h2xs rpcsvc/rusers -L/opt/net/lib -lrpc
    # Extension is DCE::rgynbase
    # prefix &quot;sec_rgy_&quot; is dropped from perl function names
    h2xs -n DCE::rgynbase -p sec_rgy_ dce/rgynbase
    # Extension is DCE::rgynbase
    # prefix &quot;sec_rgy_&quot; is dropped from perl function names
    # subroutines are created for sec_rgy_wildcard_name and
    # sec_rgy_wildcard_sid
    h2xs -n DCE::rgynbase -p sec_rgy_ \
    -s sec_rgy_wildcard_name,sec_rgy_wildcard_sid dce/rgynbase
    # Make XS without defines in perl.h, but with function declarations
    # visible from perl.h. Name of the extension is perl1.
    # When scanning perl.h, define -DEXT=extern -DdEXT= -DINIT(x)=
    # Extra backslashes below because the string is passed to shell.
    # Note that a directory with perl header files would
    #  be added automatically to include path.
    h2xs -xAn perl1 -F &quot;-DEXT=extern -DdEXT= -DINIT\(x\)=&quot; perl.h
    # Same with function declaration in proto.h as visible from perl.h.
    h2xs -xAn perl2 perl.h,proto.h
    # Same but select only functions which match /^av_/
    h2xs -M '^av_' -xAn perl2 perl.h,proto.h
    # Same but treat SV* etc as &quot;opaque&quot; types
    h2xs -o '^[S]V \*$' -M '^av_' -xAn perl2 perl.h,proto.h
</pre>
<h2 class="Ss" title="Ss" id="Extension_based_on_.h_and_.c_files"><a class="selflink" href="#Extension_based_on_.h_and_.c_files">Extension
  based on <i>.h</i> and <i>.c</i> files</a></h2>
Suppose that you have some C files implementing some functionality, and the
  corresponding header files. How to create an extension which makes this
  functionality accessible in Perl? The example below assumes that the header
  files are <i>interface_simple.h</i> and <i>interface_hairy.h</i>, and you want
  the perl module be named as &quot;Ext::Ension&quot;. If you need some
  preprocessor directives and/or linking with external libraries, see the flags
  &quot;-F&quot;, &quot;-L&quot; and &quot;-l&quot; in &quot;OPTIONS&quot;.
<dl class="Bl-tag">
  <dt class="It-tag">Find the directory name</dt>
  <dd class="It-tag">Start with a dummy run of h2xs:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  h2xs -Afn Ext::Ension
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    The only purpose of this step is to create the needed directories, and let
      you know the names of these directories. From the output you can see that
      the directory for the extension is <i>Ext/Ension</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Copy C files</dt>
  <dd class="It-tag">Copy your header files and C files to this directory
      <i>Ext/Ension</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Create the extension</dt>
  <dd class="It-tag">Run h2xs, overwriting older autogenerated files:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  h2xs -Oxan Ext::Ension interface_simple.h interface_hairy.h
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    h2xs looks for header files <i>after</i> changing to the extension
      directory, so it will find your header files OK.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Archive and test</dt>
  <dd class="It-tag">As usual, run
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  cd Ext/Ension
  perl Makefile.PL
  make dist
  make
  make test
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Hints</dt>
  <dd class="It-tag">It is important to do &quot;make dist&quot; as early as
      possible. This way you can easily <i>merge</i>(1) your changes to
      autogenerated files if you decide to edit your &quot;.h&quot; files and
      rerun h2xs.
    <div style="height: 1.00em;">&#x00A0;</div>
    Do not forget to edit the documentation in the generated <i>.pm</i> file.
    <div style="height: 1.00em;">&#x00A0;</div>
    Consider the autogenerated files as skeletons only, you may invent better
      interfaces than what h2xs could guess.
    <div style="height: 1.00em;">&#x00A0;</div>
    Consider this section as a guideline only, some other options of h2xs may
      better suit your needs.</dd>
</dl>
<h1 class="Sh" title="Sh" id="ENVIRONMENT"><a class="selflink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
No environment variables are used.
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Larry Wall and others
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
perl, perlxstut, ExtUtils::MakeMaker, and AutoLoader.
<h1 class="Sh" title="Sh" id="DIAGNOSTICS"><a class="selflink" href="#DIAGNOSTICS">DIAGNOSTICS</a></h1>
The usual warnings if it cannot read or write the files involved.
<h1 class="Sh" title="Sh" id="LIMITATIONS_of_-x"><a class="selflink" href="#LIMITATIONS_of_-x">LIMITATIONS
  of <b>-x</b></a></h1>
<i>h2xs</i> would not distinguish whether an argument to a C function which is
  of the form, say, &quot;int *&quot;, is an input, output, or input/output
  parameter. In particular, argument declarations of the form
<div class="Pp"></div>
<pre>
    int
    foo(n)
        int *n
</pre>
<div class="Pp"></div>
should be better rewritten as
<div class="Pp"></div>
<pre>
    int
    foo(n)
        int &amp;n
</pre>
<div class="Pp"></div>
if &quot;n&quot; is an input parameter.
<div class="Pp"></div>
Additionally, <i>h2xs</i> has no facilities to intuit that a function
<div class="Pp"></div>
<pre>
   int
   foo(addr,l)
        char *addr
        int   l
</pre>
<div class="Pp"></div>
takes a pair of address and length of data at this address, so it is better to
  rewrite this function as
<div class="Pp"></div>
<pre>
    int
    foo(sv)
            SV *addr
        PREINIT:
            STRLEN len;
            char *s;
        CODE:
            s = SvPV(sv,len);
            RETVAL = foo(s, len);
        OUTPUT:
            RETVAL
</pre>
<div class="Pp"></div>
or alternately
<div class="Pp"></div>
<pre>
    static int
    my_foo(SV *sv)
    {
        STRLEN len;
        char *s = SvPV(sv,len);
        return foo(s, len);
    }
    MODULE = foo        PACKAGE = foo   PREFIX = my_
    int
    foo(sv)
        SV *sv
</pre>
<div class="Pp"></div>
See perlxs and perlxstut for additional details.</div>
<table class="foot">
  <tr>
    <td class="foot-date">2016-11-06</td>
    <td class="foot-os">perl v5.16.3</td>
  </tr>
</table>
</body>
</html>
