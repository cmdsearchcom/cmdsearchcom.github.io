<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>r.walk(1grass)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">r.walk(1grass)</td>
    <td class="head-vol">Grass User's Manual</td>
    <td class="head-rtitle">r.walk(1grass)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<i></i><b>r.walk</b> - Creates a raster map showing the anisotropic cumulative
  cost of moving between different geographic locations on an input raster map
  whose cell category values represent cost.
<h1 class="Sh" title="Sh" id="KEYWORDS"><a class="selflink" href="#KEYWORDS">KEYWORDS</a></h1>
raster, cost surface, cumulative costs, cost allocation
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>r.walk</b>
<div>&#x00A0;</div>
<b>r.walk --help</b>
<div>&#x00A0;</div>
<b>r.walk</b> [-<b>knri</b>] <b>elevation</b>=<i>name</i>
  <b>friction</b>=<i>name</i> <b>output</b>=<i>name</i>
  [<b>outdir</b>=<i>name</i>] [ <b>start_points</b>=<i>name</i>]
  [<b>stop_points</b>= <i>name</i>] [<b>start_raster</b>=<i>name</i>]
  [<b>start_coordinates</b>= <i>east,north</i>[,<i>east,north</i>,...]]
  [<b>stop_coordinates</b>= <i>east,north</i>[,<i>east,north</i>,...]]
  [<b>max_cost</b>= <i>value</i>] [<b>null_cost</b>=<i>value</i>]
  [<b>memory</b>= <i>value</i>] [<b>walk_coeff</b>=<i>a,b,c,d</i>]
  [<b>lambda</b>= <i>float</i>] [<b>slope_factor</b>=<i>float</i>]
  [--<b>overwrite</b>] [-- <b>help</b>] [--<b>verbose</b>] [--<b>quiet</b>]
  [--<b>ui</b>]
<h2 class="Ss" title="Ss" id="Flags:"><a class="selflink" href="#Flags:">Flags:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-k</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Use the &#x2019;Knight&#x2019;s move&#x2019;; slower, but more accurate</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Keep null values in output raster map</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-r</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Start with values in raster map</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Print info about disk space and memory requirements and exit</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--overwrite</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Allow output files to overwrite existing files</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Print usage summary</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verbose</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Verbose module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--quiet</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Quiet module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ui</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Force launching GUI dialog</dd>
</dl>
<h2 class="Ss" title="Ss" id="Parameters:"><a class="selflink" href="#Parameters:">Parameters:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>elevation</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input elevation raster map</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>friction</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input raster map containing friction costs</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>output</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name for output raster map to contain walking costs</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>outdir</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name for output raster map to contain movement directions</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>start_points</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of starting vector points map
    <div>&#x00A0;</div>
    Or data source for direct OGR access</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>stop_points</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of stopping vector points map
    <div>&#x00A0;</div>
    Or data source for direct OGR access</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>start_raster</b>=<i>name</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of starting raster points map</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>start_coordinates</b>=<i>east,north[,</i><i>east,north</i>,...]</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Coordinates of starting point(s) (E,N)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>stop_coordinates</b>=<i>east,north[,</i><i>east,north</i>,...]</dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Coordinates of stopping point(s) (E,N)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>max_cost</b>=<i>value</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Maximum cumulative cost
    <div>&#x00A0;</div>
    Default: <i>0</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>null_cost</b>=<i>value</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Cost assigned to null cells. By default, null cells are excluded</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>memory</b>=<i>value</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Maximum memory to be used in MB
    <div>&#x00A0;</div>
    Default: <i>300</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>walk_coeff</b>=<i>a,b,c,d</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Coefficients for walking energy formula parameters a,b,c,d
    <div>&#x00A0;</div>
    Default: <i>0.72,6.0,1.9998,-1.9998</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>lambda</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Lambda coefficients for combining walking energy and friction cost
    <div>&#x00A0;</div>
    Default: <i>1.0</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>slope_factor</b>=<i>float</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Slope factor determines travel energy cost per height step
    <div>&#x00A0;</div>
    Default: <i>-0.2125</i></dd>
</dl>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<i>r.walk</i> computes anisotropic cumulative cost of moving between different
  geographic locations on an input elevation raster map whose cell category
  values represent elevation combined with an input raster map layer whose cell
  values represent friction cost.
<div class="Pp"></div>
<i>r.walk</i> outputs 1) a raster map showing the lowest cumulative cost (time)
  of moving between each cell and the user-specified starting points and 2) a
  second raster map showing the movement direction to the next cell on the path
  back to the start point (see Movement Direction). It uses an input elevation
  raster map whose cell category values represent elevation, combined with a
  second input raster map whose cell values represent friction costs.
<div class="Pp"></div>
This function is similar to <i>r.cost</i>, but in addiction to a friction map,
  it considers an anisotropic travel time due to the different walking speed
  associated with downhill and uphill movements.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
The formula from Aitken 1977/Langmuir 1984 (based on Naismith&#x2019;s rule for
  walking times) has been used to estimate the cost parameters of specific slope
  intervals:
<div>&#x00A0;</div>
<pre>
T = a*delta_S + b*delta_H_uphill + c*delta_H_moderate_downhill + d*delta_H_steep_downhill
</pre>
where:
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">T is time of movement in seconds,</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">delta S is the horizontal distance covered in meters,</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">delta H is the altitude difference in meters.</dd>
</dl>
</div>
<div class="Pp"></div>
The a, b, c, d <b>walk_coeff</b> parameters take in account movement speed in
  the different conditions and are linked to:
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">a: time in seconds it takes to walk for 1 meter a flat
      surface (1/walking speed)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">b: additional walking time in seconds, per meter of
      elevation gain on uphill slopes</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">c: additional walking time in seconds, per meter of
      elevation loss on moderate downhill slopes (use positive value for
      decreasing cost)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">d: additional walking time in seconds, per meter of
      elevation loss on steep downhill slopes (use negative value for increasing
      cost)</dd>
</dl>
</div>
It has been proved that moving downhill is favourable up to a specific slope
  value threshold, after that it becomes unfavourable. The default slope value
  threshold ( <b>slope_factor</b>) is -0.2125, corresponding to tan(-12),
  calibrated on human behaviour (&gt;5 and &lt;12 degrees: moderate downhill;
  &gt;12 degrees: steep downhill). The default values for a, b, c, d
  <b>walk_coeff</b> parameters are those proposed by Langmuir (0.72, 6.0,
  1.9998, -1.9998), based on man walking effort in standard conditions.
<div class="Pp"></div>
The <b>friction</b> cost parameter represents a time penalty in seconds of
  additional walking time to cross 1 meter distance.
<div class="Pp"></div>
The <b>lambda</b> parameter is a dimensionless scaling factor of the friction
  cost:
<div>&#x00A0;</div>
<pre>
total cost = movement time cost + lambda * friction costs * delta_S
</pre>
<div class="Pp"></div>
For a more accurate result, the &quot;knight&#x2019;s move&quot; option can be
  used (although it is more time consuming). In the diagram below, the center
  location (O) represents a grid cell from which cumulative distances are
  calculated. Those neighbours marked with an x are always considered for
  cumulative cost updates. With the &quot;knight&#x2019;s move&quot; option, the
  neighbours marked with a K are also considered.
<div>&#x00A0;</div>
<pre>
  K   K
K x x x K
  x O x
K x x x K
  K   K
</pre>
<div class="Pp"></div>
The minimum cumulative costs are computed using Dijkstra&#x2019;s algorithm,
  that find an optimum solution (for more details see <i>r.cost</i>, that uses
  the same algorithm).
<h1 class="Sh" title="Sh" id="Movement_Direction"><a class="selflink" href="#Movement_Direction">Movement
  Direction</a></h1>
The movement direction surface is created to record the sequence of movements
  that created the cost accumulation surface. Without it <i>r.drain</i> would
  not correctly create a path from an end point back to the start point. The
  direction of each cell points towards the next cell. The directions are
  recorded as degrees CCW from East:
<div>&#x00A0;</div>
<pre>
       112.5      67.5         i.e. a cell with the value 135
157.5  135   90   45   22.5    means the next cell is to the north-west
       180   x   360
202.5  225  270  315  337.5
       247.5     292.5
</pre>
<div class="Pp"></div>
Once <i>r.walk</i> computes the cumulative cost map as a linear combination of
  friction cost (from friction map) and the altitude and distance covered (from
  the digital elevation model), <i>r.drain</i> can be used to find the minimum
  cost path. Make sure to use the <b>-d</b> flag and the movement direction
  raster map when running <i>r.drain</i> to ensure the path is computed
  according to the proper movement directions.
<div class="Pp"></div>
<i>r.walk</i>, like most all GRASS raster programs, is also made to be run on
  maps larger that can fit in available computer memory. As the algorithm works
  through the dynamic list of cells it can move almost randomly around the
  entire area. <i>r.walk</i> divides the entire area into a number of pieces and
  swaps these pieces in and out of memory (to and from disk) as needed. This
  provides a virtual memory approach optimally designed for 2-D raster maps. The
  amount of memory to be used by <i>r.walk</i> can be controlled with the
  <b>memory</b> option, default is 300 MB. For systems with less memory this
  value will have to be set to a lower value.
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
We compute a map showing how far a lost person could get from the point where he
  or she was last seen while taking into account the topography and landcover.
<div>&#x00A0;</div>
<pre>
g.region swwake_30m -p
# create friction map based on land cover
r.recode landclass96 out=friction &lt;&lt; EOF
1:3:0.1:0.1
4:5:10.:10.
6:6:1000.0:1000.0
7:7:0.3:0.3
EOF
r.walk -k elevation=elev_ned_30m friction=friction output=walkcost \
    start_coordinates=635576,216485 lambda=0.5 max=10000
# compute contours on the cost surface to better understand
# how far the person can get in certain time (1000 is in seconds)
r.contour walkcost output=walkcost step=1000
</pre>
<h1 class="Sh" title="Sh" id="REFERENCES"><a class="selflink" href="#REFERENCES">REFERENCES</a></h1>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Aitken, R. 1977. Wilderness areas in Scotland. Unpublished
      Ph.D. thesis. University of Aberdeen.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Steno Fontanari, University of Trento, Italy, Ingegneria
      per l&#x2019;Ambiente e il Territorio, 2000-2001. Svilluppo di metodologie
      GIS per la determinazione dell&#x2019;accessibilit&#x00E0; territoriale
      come supporto alle decisioni nella gestione ambientale.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Langmuir, E. 1984. Mountaincraft and leadership. The
      Scottish Sports Council/MLTB. Cordee, Leicester.</dd>
</dl>
</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i></i> <i>r.cost,</i> <i>r.drain,</i> <i>r.in.ascii,</i> <i>r.mapcalc,</i>
  <i>r.out.ascii</i> <i></i>
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
<b>Based on r.cost written by :</b>
<div>&#x00A0;</div>
Antony Awaida, Intelligent Engineering, Systems Laboratory, M.I.T.
<div>&#x00A0;</div>
James Westervelt, U.S.Army Construction Engineering Research Laboratory
<div>&#x00A0;</div>
Updated for Grass 5 by Pierre de Mouveaux (pmx@audiovu.com)
<div class="Pp"></div>
<b>Initial version of r.walk:</b>
<div>&#x00A0;</div>
Steno Fontanari, 2002
<div class="Pp"></div>
<b>Current version of r.walk:</b>
<div>&#x00A0;</div>
Franceschetti Simone, Sorrentino Diego, Mussi Fabiano and Pasolli Mattia
<div>&#x00A0;</div>
Correction by: Fontanari Steno, Napolitano Maurizio and Flor Roberto
<div>&#x00A0;</div>
In collaboration with: Franchi Matteo, Vaglia Beatrice, Bartucca Luisa, Fava
  Valentina and Tolotti Mathias, 2004
<div class="Pp"></div>
<b>Updated for GRASS 6.1:</b>
<div>&#x00A0;</div>
Roberto Flor and Markus Neteler
<div class="Pp"></div>
<b>Updated for GRASS GIS 7:</b>
<div>&#x00A0;</div>
Markus Metz
<div class="Pp"></div>
<i>Last changed: $Date: 2016-05-02 21:39:52 +0200 (Mon, 02 May 2016) $</i>
<h1 class="Sh" title="Sh" id="SOURCE_CODE"><a class="selflink" href="#SOURCE_CODE">SOURCE
  CODE</a></h1>
Available at: r.walk source code (history)
<div class="Pp"></div>
Main index | Raster index | Topics index | Keywords index | Graphical index |
  Full index
<div class="Pp"></div>
&#x00A9; 2003-2016 GRASS Development Team, GRASS GIS 7.2.0 Reference
  Manual</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os">GRASS 7.2.0</td>
  </tr>
</table>
</body>
</html>
