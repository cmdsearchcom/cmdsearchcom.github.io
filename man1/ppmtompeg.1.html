<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>PPMTOMPEG(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">PPMTOMPEG(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">PPMTOMPEG(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
ppmtompeg - encodes MPEG-1 bitstreams
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>ppmtompeg</b> [ <b><i>options</i></b> ] <b><i>parameter-file</i></b>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>ppmtompeg</b> produces an MPEG-1 video stream. param_file is a parameter file
  which includes a list of input files and other parameters. The file is
  described in detail below. The -gop, -combine_gops, -frames, and
  -combine_frames options are all exclusive. This man page is probably
  incomplete. For complete usage, see the User's Guide.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"><b>-stat
  stat_file</b> : causes the encoder to append the statistics to the file
  <i>stat_file</i>. In any case, the statistics are output to stdout. The
  statistics use the following abbreviations: bits per block (bpb), bits per
  frame (bpf), seconds per frame (spf), and bits per second (bps).</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"><b>-quiet
  num_seconds</b> : causes the program to not report remaining time for at least
  num_seconds seconds. A negative values tells the program not to report at all.
  0 is the default (reports once after each frame). Note that the time remaining
  is an estimate and does not take into account time to read in frames.</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"><b>-realquiet</b>
  : causes the encoder to run silently, with the only screen output being
  errors. Particularly useful when reading input from stdin.</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"><b>-no_frame_summary</b>
  : prevents the program from printing a summary line for each frame</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"><b>-float_dct</b>
  : forces the encoder to use a more accurate, yet more computationally
  expensive version of the DCT.</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"><b>-gop
  gop_num</b> : causes the encoder to only encode the numbered GOP (first GOP is
  0). The parameter file is the same as for normal usage. The output file will
  be the normal output file with the suffix &quot;.gop.&lt;gop_num&gt;&quot; No
  sequence info is output.</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"><b>-combine_gops</b>
  : causes the encoder to simply combine some GOP files into a single MPEG
  stream. A sequence header/ender are inserted. In this case, the parameter file
  need only contain the YUV_SIZE value, an output file, and perhaps a list of
  input GOP files (see below).</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"><b>-frames
  first_frame last_frame</b> : causes the encoder to only encode the frames from
  first_frame to last_frame, inclusive. The parameter file is the same as for
  normal usage. The output will be placed in separate files, one per frame, with
  the file names being the normal output file with the suffix
  &quot;.frame.&lt;frame num&gt;&quot; No GOP header information is output.
  (Thus, the parameter file need not include the GOP_SIZE value)</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"><b>-combine_frames</b>
  : causes the encoder to simply combine some frames into a single MPEG stream.
  Sequence and GOP headers are inserted appropriately. In this case, the
  parameter file need only contain the YUV_SIZE value, the GOP_SIZE value, an
  output file, and perhaps a list of frame files (see below).</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"><b>-nice</b>
  : causes the program to run any remote processes 'nicely.' This is only
  relevant if the program is using parallel encoding. (see 'man nice.')</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"><b>-max_machines
  num_machines</b> : causes the program to use no more than num_machines
  machines as slaves for use in parallel encoding.</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"><b>-snr</b> :
  print the signal-to-noise ratio. Prints SNR (Y U V) and peak SNR (Y U V) for
  each frame. In summary, prints averages of luminance only (Y). SNR is defined
  as 10*log(variance of original/variance of error). Peak SNR is defined as
  20*log(255/RMSE). Note that the encoder will run a little slower if you want
  it to print the SNR.</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"><b>-mse</b> :
  computes the mean squared error per block. Also automatically computes the
  quality of the images when set, so there is no need to specify -snr
  then.</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"><b>-bit_rate_info
  rate_file</b> : prints bit rate information into the file rate_file. Bit rate
  info is bits per frame, and also bits per I-frame-to-I-frame.</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"><b>-mv-histogram</b>
  : prints histogram of motion vectors as part of statistics. There are three
  histograms -- one for P, forward B, and backward B vectors. Each histogram is
  a 2-dimensional array, and there is one entry for each vector in the search
  window.</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"></div>
<h1 class="Sh" title="Sh" id="PARAMETER_FILE"><a class="selflink" href="#PARAMETER_FILE">PARAMETER
  FILE</a></h1>
The parameter file MUST contain the following lines (except when using the
  -combine_gops or -combine_frames options):
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"></div>
<div style="margin-left: 5.00ex;">PATTERN &lt;pattern&gt;
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">OUTPUT
  &lt;output file&gt;</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">INPUT_DIR
  &lt;directory&gt;</div>
<div style="margin-left: 5.00ex;">all input files must reside in this directory.
  If you want to refer to the current directory, use '.' (an empty INPUT_DIR
  value would refer to the root directory). If input files will be coming in
  from standard input, use 'stdin'.</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">INPUT</div>
<div style="margin-left: 5.00ex;">This line must be followed by a list of the
  input files (in display order) and then the line
<div style="margin-left: 5.00ex;">END_INPUT</div>
There are three types of lines between INPUT and END_INPUT. First, a line may
  simply be the name of an input file. Secondly, the line may be of the form
<div style="margin-left: 5.00ex;">&lt;single_star_expr&gt; [x-y]</div>
single_star_expr can have a single '*' in it. It is replaced by all the numbers
  between x and y inclusive. So, for example, the line
<div style="margin-left: 5.00ex;">tennis*.ppm [12-15]</div>
is replaced by tennis12.ppm, tennis13.ppm, tennis14.ppm, tennis15.ppm. Uniform
  zero-padding occurs, as well. For example, the line
<div style="margin-left: 5.00ex;">football.*.ppm [001-130]</div>
is replaced by football.001.ppm, football.002.ppm, ..., football.009.ppm,
  football.010.ppm, ..., football.130.ppm. The third type of line is:
<div style="margin-left: 5.00ex;">&lt;single_star_expr&gt; [x-y+s]</div>
Where the line is treated exactly as above, except that we skip by s. Thus, the
  line
<div style="margin-left: 5.00ex;">football.*.ppm [001-130+4]</div>
is replaced by football.001.ppm, football.005.ppm, football.009.ppm,
  football.013.ppm, etc.</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">BASE_FILE_FORMAT
  &lt;YUV or PPM or PNM or JPEG or JMOVIE&gt;</div>
<div style="margin-left: 5.00ex;">All the input files must be converted to YUV,
  JPEG(v4), JMOVIE, PNM, or PPM format. This line specifies which of the three
  formats (actually PPM is a subset of PNM). The reason for having a separate
  PPM option is for simplicity. If your files are RAWBITS ppm files, then use
  the PPM option rather than the PNM. Also, depending on the system, file reads
  will go much faster with the PPM option (as opposed to PNM).</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">INPUT_CONVERT
  &lt;conversion command&gt;</div>
<div style="margin-left: 5.00ex;">You must specify how to convert a file to the
  base file format. In the conversion command, each '*' is replaced by the
  filename (the items listed between INPUT and END_INPUT). If no conversion is
  necessary, then you would just say:
<div style="margin-left: 5.00ex;">INPUT_CONVERT *</div>
If you had a bunch of gif files, you might say:
<div style="margin-left: 5.00ex;">INPUT_CONVERT giftoppm *</div>
If you have a bunch of separate a.Y, a.U, and a.V files, then you might say:
<div style="margin-left: 5.00ex;">INPUT_CONVERT cat *.Y *.U *.V</div>
<div style="margin-left: 5.00ex;">Input conversion is not allowed with input
  from stdin.</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">GOP_SIZE
  &lt;n&gt;</div>
<div style="margin-left: 5.00ex;">n is roughly the number of frames in a Group
  of Pictures (roughly because a GOP must begin with an I-frame)</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">SLICES_PER_FRAME
  &lt;n&gt;</div>
<div style="margin-left: 5.00ex;">n is roughly the number of slices per frame.
  Note, at least one MPEG player may complain if slices do not start at the left
  side of an image. To ensure this does not happen, make sure the number of rows
  is divisible by SLICES_PER_FRAME.</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">PIXEL
  &lt;FULL or HALF&gt;</div>
<div style="margin-left: 5.00ex;">use half-pixel motion vectors, or only
  full-pixel ones</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">RANGE
  &lt;n&gt;</div>
<div style="margin-left: 5.00ex;">use a search range of +/- n pixels</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">PSEARCH_ALG
  &lt;algorithm&gt;</div>
<div style="margin-left: 5.00ex;">algorithm must be one of {EXHAUSTIVE,
  TWOLEVEL, SUBSAMPLE, LOGARITHMIC}. Tells what kind of search procedure should
  be used for P-frames. Exhaustive gives the best compression, but logarithmic
  is the fastest. You select the desired combination of speed and compression.
  TWOLEVEL is an exhaustive full-pixel search, followed by a local half- pixel
  search around the best full-pixel vector (the PIXEL option is ignored for this
  search algorithm).</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">BSEARCH_ALG
  &lt;algorithm&gt;</div>
<div style="margin-left: 5.00ex;">algorithm must be one of {SIMPLE, CROSS2,
  EXHAUSTIVE}. Tells what kind of search procedure should be used for B-frames.
  Simple means find best forward and backward vectors, then interpolate. Cross2
  means find those two vectors, then see what backward vector best matches the
  best forward vector, and vice versa. Exhaustive does an n-squared search and
  is EXTREMELY slow in relation to the others (Cross2 is about twice as slow as
  Simple).</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">IQSCALE
  &lt;n&gt;</div>
<div style="margin-left: 5.00ex;">use n as the qscale for I-frames</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">PQSCALE
  &lt;n&gt;</div>
<div style="margin-left: 5.00ex;">use n as the qscale for P-frames</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">BQSCALE
  &lt;n&gt;</div>
<div style="margin-left: 5.00ex;">use n as the qscale for B-frames</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">REFERENCE_FRAME
  &lt;ORIGINAL or DECODED&gt;</div>
<div style="margin-left: 5.00ex;">If ORIGINAL is specified, then the original
  images are used when computing motion vectors. To be more accurate, use
  DECODED, in which the decoded images are used. This should increase the
  quality of the image, but will take a bit longer to encode.</div>
The following lines are optional:
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"></div>
<div style="margin-left: 5.00ex;">FORCE_I_ALIGN
<div style="margin-left: 5.00ex;">This option is only relevant for parallel
  execution (see below). It forces each processor to encode a block of N frames,
  where N must be a multiple of the pattern length. Since the first frame in any
  pattern is an I-frame, this forces each block encoded by a processor to begin
  with an I-frame.</div>
foo</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"></div>
</div>
</div>
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
If the BASE_FILE_FORMAT is YUV, then the parameter file must contain:
<div style="margin-left: 5.00ex;">YUV_SIZE &lt;w&gt;x&lt;h&gt;</div>
where w = width, h = height (in pixels) of image, and
<div style="margin-left: 5.00ex;">YUV_FORMAT &lt;ABEKAS or PHILLIPS or UCB or
  EYUV or pattern&gt;.</div>
See the file doc/INPUT.FORMAT for more information.
<div class="Pp"></div>
If the -combine-gops option is used, then only the YUV_SIZE and OUTPUT values
  need be specified in the parameter file. In addition, the parameter file may
  specify input GOP files in the same manner as normal input files -- except
  instead of using INPUT_DIR, INPUT, and END_INPUT, use GOP_INPUT_DIR,
  GOP_INPUT, and GOP_END_INPUT. If no input GOP files are specified, then the
  default is to use the output file name with suffix
  &quot;.gop.&lt;gop_num&gt;&quot; starting from 0 as the input files.
<div class="Pp"></div>
If the -combine-frames option is used, then only the YUV_SIZE, GOP_SIZE, and
  OUTPUT values need be specified in the parameter file. In addition, the
  parameter file may specify input frame files in the same manner as normal
  input files -- except instead of using INPUT_DIR, INPUT, and END_INPUT, use
  FRAME_INPUT_DIR, FRAME_INPUT, and FRAME_END_INPUT. If no input frame files are
  specified, then the default is to use the output file name with suffix
  &quot;.frame.&lt;frame_num&gt;&quot; starting from 0 as the input files.
<div class="Pp"></div>
Any number of spaces and tabs may come between each option and value. Lines
  beginning with '#' are ignored. Any other lines are ignored except for those
  between INPUT and END_INPUT. This allows you to use the same parameter file
  for normal usage and for -combine_gops and -combine_frames.
<div class="Pp"></div>
The encoder is case-sensitive so, except for file names and directories,
  everything should be in upper case.
<div class="Pp"></div>
The lines may appear in any order, except the following exceptions. INPUT must
  appear before END_INPUT (also, GOP_INPUT before GOP_END_INPUT and FRAME_INPUT
  before FRAME_END_INPUT). All lines between INPUT and END_INPUT must be the
  frames in play order.
<div class="Pp"></div>
The encoder is prepared to handle up to 16 B frames between reference frames
  when encoding with input from stdin. To increase this amount, change the
  constant B_FRAME_RUN in frame.c and recompile.
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"></div>
<h1 class="Sh" title="Sh" id="PARALLEL_OPERATION"><a class="selflink" href="#PARALLEL_OPERATION">PARALLEL
  OPERATION</a></h1>
The encoder may be run on multiple machines at once. To do so, add a line
  &quot;PARALLEL&quot; in the parameter file, followed by a listing, one machine
  per line, then &quot;END_PARALLEL&quot;. Each of the lines should be in one of
  two forms. If the machine has access to the file server, then the line should
  be:
<div class="Pp"></div>
	&lt;machine&gt; &lt;user&gt; &lt;executable&gt;
<div class="Pp"></div>
The executable is normally ppmtompeg (you may need to give the complete path if
  you've built for different architectures). If the machine is a remote machine,
  then the line should be:
<div class="Pp"></div>
	REMOTE &lt;machine&gt; &lt;user&gt; &lt;executable&gt; &lt;parameter file&gt;
<div class="Pp"></div>
Full paths should generally be used when describing executables and parameter
  files. This INCLUDES the parameter file given as an argument to the original
  call to ppmtompeg. Also, .rhosts files on the appropriate machines should have
  the appropriate information.
<div class="Pp"></div>
The encoder will use the original machine for the master and I/O server
  processes, and uses the listed machines as slaves to do the computation.
<div class="Pp"></div>
Optional lines are
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">RSH
  &lt;remote shell command&gt;</div>
<div style="margin-left: 5.00ex;">The encoder uses the remote shell command to
  start processes on other machines. The default command is 'rsh.' If your
  machine supports a different command, specify it here.</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">PARALLEL_TEST_FRAMES
  &lt;n&gt;</div>
<div style="margin-left: 5.00ex;">n is the number of frames to encode initially
  on each processor</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">PARALLEL_TIME_CHUNKS
  &lt;t&gt;</div>
<div style="margin-left: 5.00ex;">subsequently, each slave processor will be
  asked to encode for approximately t seconds. Smaller values of &lt;t&gt;
  increase communication, but improve load balancing.
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">The default
  values for these two options are n = 3 frames and t = 30 seconds.</div>
</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">PARALLEL_PERFECT</div>
<div style="margin-left: 5.00ex;">If this line is present, then scheduling is
  done on the assumption that work distribution will be perfectly even --
  meaning that each machine is about the same speed. The frames will simply be
  divided up evenly between the processors. This has the advantage of very
  minimal scheduling overhead, but is obviously wrong if machines have varying
  speeds, or if the network load makes performance uneven.</div>
<h1 class="Sh" title="Sh" id="VERSION"><a class="selflink" href="#VERSION">VERSION</a></h1>
This is version 1.5 it contins new features and bug fixes from version 1.3.
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Not really a bug, but at least a limitation: If writing to an output file,
  ppmtompeg sometimes uses &lt;filename&gt;.* as temporary files.
<div class="Pp"></div>
No known bugs, but if you find any, report them to
  mpeg-bugs@plateau.cs.berkeley.edu.
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;"></div>
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">Kevin Gong -
  University of California, Berkeley, keving@cs.berkeley.edu</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">Ketan Patel -
  University of California, Berkeley, kpatel@cs.berkeley.edu</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">Dan Wallach -
  University of California, Berkeley, dwallach@cs.berkeley.edu</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">Darryl Brown
  - University of California, Berkeley, darryl@cs.berkeley.edu</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">Eugene Hung -
  University of California, Berkeley, eyhung@cs.berkeley.edu</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">Steve Smoot -
  University of California, Berkeley, smoot@cs.berkeley.edu</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 5.00ex; text-indent: -5.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
</div>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">1 February 1995</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
