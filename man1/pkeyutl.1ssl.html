<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>PKEYUTL(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">PKEYUTL(1)</td>
    <td class="head-vol">OpenSSL</td>
    <td class="head-rtitle">PKEYUTL(1)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
pkeyutl - public key algorithm utility
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>openssl</b> <b>pkeyutl</b> [ <b>-in file</b>] [ <b>-out file</b>] [
  <b>-sigfile file</b>] [ <b>-inkey file</b>] [ <b>-keyform PEM|DER</b>] [
  <b>-passin arg</b>] [ <b>-peerkey file</b>] [ <b>-peerform PEM|DER</b>] [
  <b>-pubin</b>] [ <b>-certin</b>] [ <b>-rev</b>] [ <b>-sign</b>] [
  <b>-verify</b>] [ <b>-verifyrecover</b>] [ <b>-encrypt</b>] [ <b>-decrypt</b>]
  [ <b>-derive</b>] [ <b>-pkeyopt opt:value</b>] [ <b>-hexdump</b>] [
  <b>-asn1parse</b>] [ <b>-engine id</b>]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <b>pkeyutl</b> command can be used to perform public key operations using
  any supported algorithm.
<h1 class="Sh" title="Sh" id="COMMAND_OPTIONS"><a class="selflink" href="#COMMAND_OPTIONS">COMMAND
  OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-in filename</b></dt>
  <dd class="It-tag">This specifies the input filename to read data from or
      standard input if this option is not specified.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-out filename</b></dt>
  <dd class="It-tag">specifies the output filename to write to or standard
      output by default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-inkey file</b></dt>
  <dd class="It-tag">the input key file, by default it should be a private
    key.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-keyform PEM|DER</b></dt>
  <dd class="It-tag">the key format PEM, DER or ENGINE.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-passin arg</b></dt>
  <dd class="It-tag">the input key password source. For more information about
      the format of <b>arg</b> see the <b>PASS PHRASE ARGUMENTS</b> section in
      <i>openssl</i>(1).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-peerkey file</b></dt>
  <dd class="It-tag">the peer key file, used by key derivation (agreement)
      operations.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-peerform PEM|DER</b></dt>
  <dd class="It-tag">the peer key format PEM, DER or ENGINE.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-engine id</b></dt>
  <dd class="It-tag">specifying an engine (by its unique <b>id</b> string) will
      cause <b>pkeyutl</b> to attempt to obtain a functional reference to the
      specified engine, thus initialising it if needed. The engine will then be
      set as the default for all available algorithms.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-pubin</b></dt>
  <dd class="It-tag">the input file is a public key.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-certin</b></dt>
  <dd class="It-tag">the input is a certificate containing a public key.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-rev</b></dt>
  <dd class="It-tag">reverse the order of the input buffer. This is useful for
      some libraries (such as CryptoAPI) which represent the buffer in little
      endian format.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-sign</b></dt>
  <dd class="It-tag">sign the input data and output the signed result. This
      requires a private key.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-verify</b></dt>
  <dd class="It-tag">verify the input data against the signature file and
      indicate if the verification succeeded or failed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-verifyrecover</b></dt>
  <dd class="It-tag">verify the input data and output the recovered data.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-encrypt</b></dt>
  <dd class="It-tag">encrypt the input data using a public key.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-decrypt</b></dt>
  <dd class="It-tag">decrypt the input data using a private key.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-derive</b></dt>
  <dd class="It-tag">derive a shared secret using the peer key.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-hexdump</b></dt>
  <dd class="It-tag">hex dump the output data.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-asn1parse</b></dt>
  <dd class="It-tag">asn1parse the output data, this is useful when combined
      with the <b>-verifyrecover</b> option when an ASN1 structure is
    signed.</dd>
</dl>
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
The operations and options supported vary according to the key algorithm and its
  implementation. The OpenSSL operations and options are indicated below.
<div class="Pp"></div>
Unless otherwise mentioned all algorithms support the <b>digest:alg</b> option
  which specifies the digest in use for sign, verify and verifyrecover
  operations. The value <b>alg</b> should represent a digest name as used in the
  <i>EVP_get_digestbyname()</i> function for example <b>sha1</b>.
<h1 class="Sh" title="Sh" id="RSA_ALGORITHM"><a class="selflink" href="#RSA_ALGORITHM">RSA
  ALGORITHM</a></h1>
The RSA algorithm supports encrypt, decrypt, sign, verify and verifyrecover
  operations in general. Some padding modes only support some of these
  operations however.
<dl class="Bl-tag">
  <dt class="It-tag">-<b>rsa_padding_mode:mode</b></dt>
  <dd class="It-tag">This sets the RSA padding mode. Acceptable values for
      <b>mode</b> are <b>pkcs1</b> for PKCS#1 padding, <b>sslv23</b> for SSLv23
      padding, <b>none</b> for no padding, <b>oaep</b> for <b>OAEP</b> mode,
      <b>x931</b> for X9.31 mode and <b>pss</b> for PSS.
    <div style="height: 1.00em;">&#x00A0;</div>
    In PKCS#1 padding if the message digest is not set then the supplied data is
      signed or verified directly instead of using a <b>DigestInfo</b>
      structure. If a digest is set then the a <b>DigestInfo</b> structure is
      used and its the length must correspond to the digest type.
    <div style="height: 1.00em;">&#x00A0;</div>
    For <b>oeap</b> mode only encryption and decryption is supported.
    <div style="height: 1.00em;">&#x00A0;</div>
    For <b>x931</b> if the digest type is set it is used to format the block
      data otherwise the first byte is used to specify the X9.31 digest ID.
      Sign, verify and verifyrecover are can be performed in this mode.
    <div style="height: 1.00em;">&#x00A0;</div>
    For <b>pss</b> mode only sign and verify are supported and the digest type
      must be specified.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>rsa_pss_saltlen:len</b></dt>
  <dd class="It-tag">For <b>pss</b> mode only this option specifies the salt
      length. Two special values are supported: -1 sets the salt length to the
      digest length. When signing -2 sets the salt length to the maximum
      permissible value. When verifying -2 causes the salt length to be
      automatically determined based on the <b>PSS</b> block structure.</dd>
</dl>
<h1 class="Sh" title="Sh" id="DSA_ALGORITHM"><a class="selflink" href="#DSA_ALGORITHM">DSA
  ALGORITHM</a></h1>
The DSA algorithm supports signing and verification operations only. Currently
  there are no additional options other than <b>digest</b>. Only the SHA1 digest
  can be used and this digest is assumed by default.
<h1 class="Sh" title="Sh" id="DH_ALGORITHM"><a class="selflink" href="#DH_ALGORITHM">DH
  ALGORITHM</a></h1>
The DH algorithm only supports the derivation operation and no additional
  options.
<h1 class="Sh" title="Sh" id="EC_ALGORITHM"><a class="selflink" href="#EC_ALGORITHM">EC
  ALGORITHM</a></h1>
The EC algorithm supports sign, verify and derive operations. The sign and
  verify operations use ECDSA and derive uses ECDH. Currently there are no
  additional options other than <b>digest</b>. Only the SHA1 digest can be used
  and this digest is assumed by default.
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
Sign some data using a private key:
<div class="Pp"></div>
<pre>
 openssl pkeyutl -sign -in file -inkey key.pem -out sig
</pre>
<div class="Pp"></div>
Recover the signed data (e.g. if an RSA key is used):
<div class="Pp"></div>
<pre>
 openssl pkeyutl -verifyrecover -in sig -inkey key.pem
</pre>
<div class="Pp"></div>
Verify the signature (e.g. a DSA key):
<div class="Pp"></div>
<pre>
 openssl pkeyutl -verify -in file -sigfile sig -inkey key.pem
</pre>
<div class="Pp"></div>
Sign data using a message digest value (this is currently only valid for RSA):
<div class="Pp"></div>
<pre>
 openssl pkeyutl -sign -in file -inkey key.pem -out sig -pkeyopt digest:sha256
</pre>
<div class="Pp"></div>
Derive a shared secret value:
<div class="Pp"></div>
<pre>
 openssl pkeyutl -derive -inkey key.pem -peerkey pubkey.pem -out secret
</pre>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i>genpkey</i>(1), <i>pkey</i>(1), <i>rsautl</i>(1) <i>dgst</i>(1),
  <i>rsa</i>(1), <i>genrsa</i>(1)</div>
<table class="foot">
  <tr>
    <td class="foot-date">2013-02-11</td>
    <td class="foot-os">1.0.1e</td>
  </tr>
</table>
</body>
</html>
