<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>v.net.alloc(1grass)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">v.net.alloc(1grass)</td>
    <td class="head-vol">Grass User's Manual</td>
    <td class="head-rtitle">v.net.alloc(1grass)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<i></i><b>v.net.alloc</b> - Allocates subnets for nearest centers (direction
  from center).
<div>&#x00A0;</div>
center node must be opened (costs &gt;= 0). Costs of center node are used in
  calculation
<h1 class="Sh" title="Sh" id="KEYWORDS"><a class="selflink" href="#KEYWORDS">KEYWORDS</a></h1>
vector, network, cost allocation
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>v.net.alloc</b>
<div>&#x00A0;</div>
<b>v.net.alloc --help</b>
<div>&#x00A0;</div>
<b>v.net.alloc</b> [-<b>tg</b>] <b>input</b>=<i>name</i>
  <b>output</b>=<i>name</i> [ <b>method</b>=<i>string</i>]
  <b>center_cats</b>=<i>range</i> <b>arc_layer</b>=<i>string</i>
  <b>arc_type</b>= <i>string</i>[,<i>string</i>,...]
  <b>node_layer</b>=<i>string</i> [ <b>arc_column</b>=<i>string</i>]
  [<b>arc_backward_column</b>= <i>string</i>] [<b>node_column</b>=<i>string</i>]
  [ <b>turn_layer</b>=<i>string</i>] [<b>turn_cat_layer</b>=<i>string</i>]
  [--<b>overwrite</b>] [--<b>help</b>] [--<b>verbose</b>] [--<b>quiet</b>]
  [--<b>ui</b>]
<h2 class="Ss" title="Ss" id="Flags:"><a class="selflink" href="#Flags:">Flags:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-t</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Use turntable</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-g</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Use geodesic calculation for longitude-latitude locations</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--overwrite</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Allow output files to overwrite existing files</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Print usage summary</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verbose</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Verbose module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--quiet</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Quiet module output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ui</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Force launching GUI dialog</dd>
</dl>
<h2 class="Ss" title="Ss" id="Parameters:"><a class="selflink" href="#Parameters:">Parameters:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>input</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name of input vector map
    <div>&#x00A0;</div>
    Or data source for direct OGR access</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>output</b>=<i>name</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Name for output vector map</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>method</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Use costs from centers or costs to centers
    <div>&#x00A0;</div>
    Options: <i>from, to</i>
    <div>&#x00A0;</div>
    Default: <i>from</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>center_cats</b>=<i>range</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Category values
    <div>&#x00A0;</div>
    Categories of centers (points on nodes) to which net will be allocated,
      layer for this categories is given by nlayer option</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>arc_layer</b>=<i>string</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Arc layer
    <div>&#x00A0;</div>
    Vector features can have category values in different layers. This number
      determines which layer to use. When used with direct OGR access this is
      the layer name.
    <div>&#x00A0;</div>
    Default: <i>1</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>arc_type</b>=<i>string[,</i><i>string</i>,...]
    <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Arc type
    <div>&#x00A0;</div>
    Input feature type
    <div>&#x00A0;</div>
    Options: <i>line, boundary</i>
    <div>&#x00A0;</div>
    Default: <i>line,boundary</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>node_layer</b>=<i>string</i> <b>[required]</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Node layer
    <div>&#x00A0;</div>
    Vector features can have category values in different layers. This number
      determines which layer to use. When used with direct OGR access this is
      the layer name.
    <div>&#x00A0;</div>
    Default: <i>2</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>arc_column</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Arc forward/both direction(s) cost column (number)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>arc_backward_column</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Arc backward direction cost column (number)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>node_column</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Node cost column (number)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>turn_layer</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Layer with turntable
    <div>&#x00A0;</div>
    Relevant only with -t flag
    <div>&#x00A0;</div>
    Default: <i>3</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>turn_cat_layer</b>=<i>string</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
    Layer with unique categories used in turntable
    <div>&#x00A0;</div>
    Relevant only with -t flag
    <div>&#x00A0;</div>
    Default: <i>4</i></dd>
</dl>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<i>v.net.alloc</i> allocates subnets for nearest centers. Center nodes must be
  opened (costs &gt;= 0). Costs of center nodes are used in the calculation.
<div class="Pp"></div>
Costs may be either line lengths, or attributes saved in a database table. These
  attribute values are taken as costs of whole segments, not as costs to
  traverse a length unit (e.g. meter) of the segment. For example, if the speed
  limit is 100 km / h, the cost to traverse a 10 km long road segment must be
  calculated as
<div>&#x00A0;</div>
length / speed = 10 km / (100 km/h) = 0.1 h.
<div>&#x00A0;</div>
Supported are cost assignments for both arcs and nodes, and also different costs
  for both directions of a vector line. For areas, costs will be calculated
  along boundary lines.
<div class="Pp"></div>
The input vector needs to be prepared with <i>v.net operation=connect</i> in
  order to connect points representing center nodes to the network.
<div class="Pp"></div>
The nearest center can be determined using either costs from the nearest center
  or costs to the nearest center with option <b>method</b>. See example below.
<div class="Pp"></div>
Application of flag <b>-t</b> enables a turntable support. This flag requires
  additional parameters <b>turn_layer</b> and <b>turn_cat_layer</b> that are
  otherwise ignored. The turntable allows to model e.g. traffic code, where some
  turns may be prohibited. This means that the input layer is expanded by
  turntable with costs of every possible turn on any possible node
  (intersection) in both directions. Turntable can be created by the
  <i>v.net</i> module. For more information about turns in the vector network
  analyses see wiki page.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
Nodes and arcs can be closed using cost = -1.
<div class="Pp"></div>
Center nodes can also be assigned to vector nodes using <i>wxGUI vector
  digitizer</i>.
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
1. Subnetwork allocation using distance:
<div class="Pp"></div>
2. Subnetwork allocation using traveling time:
<div class="Pp"></div>
Example 1: <i>Calculating subnets for 3 center nodes using distances</i>
<div>&#x00A0;</div>
<pre>
# Spearfish
# center nodes:
echo &quot;591235.5|4926306.62|1
596591.8|4917042.5|2
602722.9|4923544.2|3&quot; | v.in.ascii in=- out=centernodes
g.copy vect=roads,myroads
# connect points to network
v.net myroads points=centernodes out=myroads_net op=connect thresh=200
# allocate, specifying range of center cats (easier to catch all):
v.net.alloc myroads_net out=myroads_net_alloc center_cats=1-100000 node_layer=2
# report categories
v.category myroads_net_alloc option=report
</pre>
To display the result, run for example:
<div>&#x00A0;</div>
<pre>
# show result
g.region vector=myroads_net
d.mon x0
d.vect myroads_net layer=1
# the result has to be selected by category number of the relevant node:
d.vect myroads_net_alloc cat=1 col=red layer=1
d.vect myroads_net_alloc cat=2 col=green layer=1
d.vect myroads_net_alloc cat=3 col=yellow layer=1
# center nodes
d.vect myroads_net col=red icon=basic/triangle fcol=green size=12 layer=2
</pre>
<div class="Pp"></div>
Example 2: <i>Calculating subnets for 3 center nodes using traveling time</i>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<pre>
# Spearfish
# center nodes:
echo &quot;591235.5|4926306.62|1
596591.8|4917042.5|2
602722.9|4923544.2|3&quot; | v.in.ascii in=- out=centernodes
g.copy vect=roads,myroads
# create lines map connecting points to network
v.net myroads points=centernodes out=myroads_net op=connect thresh=500 arc_layer=1 node_layer=2
# set up costs
# create unique categories for each road in layer 3
v.category in=myroads_net out=myroads_net_time opt=add cat=1 layer=3 type=line
# add new table for layer 3
v.db.addtable myroads_net_time layer=3 col=&quot;cat integer,label varchar(43),length double precision,speed double precision,cost double precision,bcost double precision&quot;
# copy road type to layer 3
v.to.db myroads_net_time layer=3 qlayer=1 opt=query qcolumn=label columns=label
# upload road length in miles
v.to.db myroads_net_time layer=3 type=line option=length col=length unit=miles
# set speed limits in miles / hour
v.db.update myroads_net_time layer=3 col=speed val=&quot;5.0&quot;
v.db.update myroads_net_time layer=3 col=speed val=&quot;75.0&quot; where=&quot;label=&#x2019;interstate&#x2019;&quot;
v.db.update myroads_net_time layer=3 col=speed val=&quot;75.0&quot; where=&quot;label=&#x2019;primary highway, hard surface&#x2019;&quot;
v.db.update myroads_net_time layer=3 col=speed val=&quot;50.0&quot; where=&quot;label=&#x2019;secondary highway, hard surface&#x2019;&quot;
v.db.update myroads_net_time layer=3 col=speed val=&quot;25.0&quot; where=&quot;label=&#x2019;light-duty road, improved surface&#x2019;&quot;
v.db.update myroads_net_time layer=3 col=speed val=&quot;5.0&quot; where=&quot;label=&#x2019;unimproved road&#x2019;&quot;
# define traveling costs as traveling time in minutes:
# set forward costs
v.db.update myroads_net_time layer=3 col=cost val=&quot;length / speed * 60&quot;
# set backward costs
v.db.update myroads_net_time layer=3 col=bcost val=&quot;length / speed * 60&quot;
# subnetwork allocation with fastest paths
v.net.alloc in=myroads_net_time arc_layer=3 node_layer=2 arc_column=cost arc_backward_column=bcost out=myroads_net_alloc_time center_cats=1-3
</pre>
To display the result, run for example:
<div>&#x00A0;</div>
<pre>
# show result
g.region vector=myroads_net
d.mon x0
d.vect myroads_net type=line layer=1
# the result has to be selected by category number of the relevant node:
d.vect myroads_net_alloc_time cat=1 col=red layer=1
d.vect myroads_net_alloc_time cat=2 col=green layer=1
d.vect myroads_net_alloc_time cat=3 col=yellow layer=1
# center nodes
d.vect myroads_net_time col=red icon=basic/triangle fcol=green size=12 type=point layer=2
</pre>
<div class="Pp"></div>
Example 3: <i>Differences between costs from centers and costs to centers</i>
<div>&#x00A0;</div>
Each lane of the two-lane road is a one-way road.
<div class="Pp"></div>
1. Subnetwork allocation from centers:
<div class="Pp"></div>
A center reaches any point following the one-way lanes.
<div class="Pp"></div>
2. Subnetwork allocation to centers:
<div class="Pp"></div>
Any node reaches reaches the nearest center following the one-way lanes.
<div class="Pp"></div>
In case of an accident, the ambulance should come from the nearest
  &#x2019;from&#x2019; hospital and go to the nearest &#x2019;to&#x2019;
  hospital.
<div>&#x00A0;</div>
<pre>
# North Carolina
# center nodes are hospitals:
# connect hospitals to streets as layer 2
v.net input=streets_wake points=hospitals output=streets_hospitals operation=connect thresh=400 arc_layer=1 node_layer=2
v.to.db map=streets_hospitals layer=1 type=line option=cat columns=cat
# close oneway roads
v.db.update map=streets_hospitals column=TF_COST value=-1 where=&quot;ONE_WAY = &#x2019;FT&#x2019;&quot;
v.db.update map=streets_hospitals column=FT_COST value=-1 where=&quot;ONE_WAY = &#x2019;TF&#x2019;&quot;
# add costs to newly created lines
v.db.update map=streets_hospitals column=TF_COST value=0 where=&quot;cat &gt; 49746&quot;
v.db.update map=streets_hospitals column=FT_COST value=0 where=&quot;cat &gt; 49746&quot;
# from centers
v.net.alloc in=streets_hospitals out=streets_hospitals_alloc_from center_cats=1-10000 arc_column=FT_COST arc_backward_column=TF_COST
# to centers
v.net.alloc in=streets_hospitals out=streets_hospitals_alloc_to method=to center_cats=1-10000 arc_column=FT_COST arc_backward_column=TF_COST
</pre>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i>d.path</i>, <i>v.net</i>, <i>v.net.iso</i>, <i>v.net.path</i>,
  <i>v.net.steiner</i>, <i>v.net.salesman</i>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Radim Blazek, ITC-Irst, Trento, Italy
<div>&#x00A0;</div>
Documentation: Markus Neteler, Markus Metz
<h2 class="Ss" title="Ss" id="TURNS_SUPPORT"><a class="selflink" href="#TURNS_SUPPORT">TURNS
  SUPPORT</a></h2>
The turns support was implemnented as part of GRASS GIS turns cost project at
  Czech Technical University in Prague, Czech Republic. Eliska Kyzlikova, Stepan
  Turek, Lukas Bocan and Viera Bejdova participated at the project.
  Implementation: Stepan Turek Documentation: Lukas Bocan Mentor: Martin Landa
<div class="Pp"></div>
<i>Last changed: $Date: 2016-11-14 00:09:36 +0100 (Mon, 14 Nov 2016) $</i>
<h1 class="Sh" title="Sh" id="SOURCE_CODE"><a class="selflink" href="#SOURCE_CODE">SOURCE
  CODE</a></h1>
Available at: v.net.alloc source code (history)
<div class="Pp"></div>
Main index | Vector index | Topics index | Keywords index | Graphical index |
  Full index
<div class="Pp"></div>
&#x00A9; 2003-2016 GRASS Development Team, GRASS GIS 7.2.0 Reference
  Manual</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os">GRASS 7.2.0</td>
  </tr>
</table>
</body>
</html>
