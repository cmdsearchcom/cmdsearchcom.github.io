<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:17:27 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>httperf(1) General Commands Manual httperf(1)</p>

<p style="margin-top: 1em">NAME <br>
httperf - HTTP performance measurement tool</p>

<p style="margin-top: 1em">SYNOPSIS <br>
httperf [--add-header S] [--burst-length N] [--client I/N]
[--close-with-reset] [-d|--debug N] [--failure-status N]
[-h|--help] [--hog] [--http-version S] [--max-connections N]
<br>
[--max-piped-calls N] [--method S] [--no-host-hdr]
[--num-calls N] [--num-conns N] [--period [d|u|e]T1[,T2]]
[--port N] [--print-reply [header|body]] [--print-request
<br>
[header|body]] [--rate X] [--recv-buffer N]
[--retry-on-failure] [--send-buffer N] [--server S]
[--server-name S] [--session-cookie] [--ssl] [--ssl-ciphers
L] [--ssl-no-reuse] <br>
[--think-timeout X] [--timeout X] [--uri S] [-v|--verbose]
[-V|--version] [--wlog y|n,F] [--wsess N,N,X] [--wsesslog
N,X,F] [--wset N,X]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
httperf is a tool to measure web server performance. It
speaks the HTTP protocol both in its HTTP/1.0 and HTTP/1.1
flavors and offers a variety of workload generators. While
<br>
running, it keeps track of a number of performance metrics
that are summarized in the form of statistics that are
printed at the end of a test run. The most basic operation
of <br>
httperf is to generate a fixed number of HTTP GET requests
and to measure how many replies (responses) came back from
the server and at what rate the responses arrived.</p>

<p style="margin-top: 1em">IMPORTANT: To obtain correct
results, it is necessary to run at most one httperf process
per client machine. Also, there should be as few background
processes as possible both <br>
on the client and server machines.</p>

<p style="margin-top: 1em">EXAMPLES <br>
httperf --hog --server www <br>
This command causes httperf to create a connection to host
www, send a request for the root document (http://www/),
receive the reply, close the connection, and then print <br>
some performance statistics.</p>

<p style="margin-top: 1em">httperf --hog --server www
--num-conns 100 --ra 10 --timeout 5 <br>
Like above, except that a total of 100 connections are
created and that connections are created at a fixed rate of
10 per second. Note that option
&lsquo;&lsquo;--rate&rsquo;&rsquo; has been <br>
abbreviated to &lsquo;&lsquo;--ra&rsquo;&rsquo;.</p>

<p style="margin-top: 1em">httperf --hog --server=www
--wsess=10,5,2 --rate 1 --timeout 5 <br>
Causes httperf to generate a total of 10 sessions at a rate
of 1 session per second. Each session consists of 5 calls
that are spaced out by 2 seconds.</p>

<p style="margin-top: 1em">httperf --hog --server=www
--wsess=10,5,2 --rate=1 --timeout=5 --ssl <br>
Like above, except that httperf contacts server www via SSL
at port 443 (the default port for SSL connections).</p>

<p style="margin-top: 1em">httperf --hog --server www
--wsess=10,5,2 --rate=1 --timeout=5 --ssl
--ssl-ciphers=EXP-RC4-MD5:EXP-RC2-CBC-MD5 --ssl-no-reuse
--http-version=1.0 <br>
Like above, except that httperf will inform the server that
it can only select from two cipher suites (EXP-RC4-MD5 or
EXP-RC2-CBC-MD5); furthermore, httperf will use HTTP <br>
version 1.0 which requires a new TCP connection for each
request. Also, SSL session ids are not reused, so the entire
SSL connection establishment process (known as the <br>
SSL handshake) occurs for each connection.</p>

<p style="margin-top: 1em">OPTIONS <br>
The operation of httperf can be controlled through a number
of options. The tool supports both short (one-character) and
long (arbitrary-length) option names. Short options are <br>
prefixed with a single leading dash (-), long options with a
double-dash (--). Multiple short options can be grouped
together (e.g., &lsquo;&lsquo;-vV&rsquo;&rsquo; is
equivalent to &lsquo;&lsquo;-v -V&rsquo;&rsquo;) and long
<br>
options can be abbreviated so long as they remain unique.
Parameters to options can be specified either by following
the long option name with an equal sign and the parameter
<br>
value (e.g., --burst=10) or by separating the option name
and value with whitespace (e.g., --burst 10).</p>

<p style="margin-top: 1em">--add-header=S <br>
Specifies to include string S as an additional request
header. It is necessary to specify the terminating
carriage-return/line-feed sequence explicitly. This can be
done <br>
by using the escape sequence &lsquo;&lsquo;0&rsquo;. This
makes it possible to include multiple request headers. For
example, &lsquo;&lsquo;--add-header &quot;Referer: foo0uth:
secret0&rsquo;&rsquo; would add <br>
two request headers (&lsquo;&lsquo;Referer&rsquo;&rsquo; and
&lsquo;&lsquo;Auth&rsquo;&rsquo;) to&rsquo;&rsquo; each
request. Other supported escape sequences are &lsquo;&lsquo;
(carriage-return), &lsquo;&lsquo;&rsquo;&rsquo; (line-feed),
&lsquo;&lsquo;\&rsquo;&rsquo; (backslash), and <br>
&lsquo;&lsquo; where N is the code the character to be
inserted (in octal).</p>

<p style="margin-top: 1em">--burst-length=N <br>
Specifies the length of bursts. Each burst consists of N
calls to the server. The exact meaning of this parameter
depends on the workload generator. For regular <br>
request-oriented workloads, see the description of option
--wsess.</p>

<p style="margin-top: 1em">--no-host-hdr <br>
Specifies that the &quot;Host:&quot; header should not be
included when issuing an HTTP request.</p>

<p style="margin-top: 1em">--num-calls. <br>
For session-oriented workloads, see the description of
option --wsess.</p>

<p style="margin-top: 1em">--client=I/N <br>
Specifies that the machine httperf is running on is client I
out of a total of N clients. I should be in the range from 0
to N-1. Some of the workload generators (e.g., <br>
--wset) use the client identity as a bias value to ensure
that not all clients generate perfectly identical workloads.
When performing a test that involves several client <br>
machines, it is generally a good idea to specify this
option.</p>

<p style="margin-top: 1em">--close-with-reset <br>
Requests that httperf closes TCP connections by sending a
RESET instead of going through the normal TCP connection
shutdown handshake. Turning on this option can have ill <br>
effects such as data corruption, stuck TCP control blocks,
or wrong results. For this reason, the option should not be
used unless absolutely necessary and even then it <br>
should not be used unless its implications are fully
understood.</p>

<p style="margin-top: 1em">-d=N</p>

<p style="margin-top: 1em">--debug=N <br>
Set debug level to N. Larger values of N will result in more
output.</p>

<p style="margin-top: 1em">--failure-status=N <br>
Specifies that an HTTP response status code of N should be
treated as a failure (i.e., treated as if the request had
timed out, for example). For example, with
&lsquo;&lsquo;--fail&acirc; <br>
ure-status=504&rsquo;&rsquo; responses with an HTTP status
of &lsquo;&lsquo;504 Gateway Time-out&rsquo;&rsquo; would be
considered failures. Caveat: this option is currently
supported for session workloads <br>
only (see the --wsess and --wsesslog options).</p>

<p style="margin-top: 1em">-h</p>

<p style="margin-top: 1em">--help Prints a summary of
available options and their parameters.</p>

<p style="margin-top: 1em">--hog This option requests to
use up as many TCP ports as necessary. Without this option,
httperf is typically limited to using ephemeral ports (in
the range from 1024 to <br>
5000). This limited port range can quickly become a
bottleneck so it is generally a good idea to specify this
option for serious testing. Also, this option must be
spec&acirc; <br>
ified when measuring NT servers since it avoids a TCP
incompatibility between NT and UNIX machines.</p>

<p style="margin-top: 1em">--http-version=S <br>
Specifies the version string that should be included in the
requests sent to the server. By default, version string
&lsquo;&lsquo;1.1&rsquo;&rsquo; is used. This option can be
set to &lsquo;&lsquo;1.0&rsquo;&rsquo; to <br>
force the generation of HTTP/1.0 requests. Setting this
option to any value other than
&lsquo;&lsquo;1.0&rsquo;&rsquo; or
&lsquo;&lsquo;1.1&rsquo;&rsquo; may result in undefined
behavior.</p>

<p style="margin-top: 1em">--max-connections=N <br>
Specifies that at most N connections are opened for each
session. This option is meaningful in conjunction with
options --wsess and --wsesslog only.</p>

<p style="margin-top: 1em">--max-piped-calls=N <br>
Specifies that at most N pipelined calls are issued on each
connection. This option is meaningful in conjunction with
options --wsess and --wsesslog only.</p>

<p style="margin-top: 1em">--method=S <br>
Specifies the method that should be used when issuing an
HTTP request. If this option is not specified, the GET
method is used. The method S can be an arbitrary string <br>
but is usually one of GET, HEAD, PUT, POST, etc.</p>

<p style="margin-top: 1em">--num-calls=N <br>
This option is meaningful for request-oriented workloads
only. It specifies the total number of calls to issue on
each connection before closing it. If N is greater than <br>
1, the server must support persistent connections. The
default value for this option is 1. If --burst-length is set
to B, then the N calls are issued in bursts of B <br>
pipelined calls each. Thus, the total number of such bursts
will be N/B (per connection).</p>

<p style="margin-top: 1em">--num-conns=N <br>
This option is meaningful for request-oriented workloads
only. It specifies the total number of connections to
create. On each connection, calls are issued as specified
<br>
by options --num-calls and --burst-length. A test stops as
soon as the N connections have either completed or failed. A
connection is considered to have failed if any <br>
activity on the connection fails to make forward progress
for more than the time specified by the timeout options
--timeout and --think-timeout. The default value for <br>
this option is 1.</p>

<p style="margin-top: 1em">--period=[D]T1[,T2] <br>
Specifies the time interval between the creation of
connections or sessions. Connections are created by default,
sessions if option --wsess or --wsesslog has been
speci&acirc; <br>
fied. This connection/session &lsquo;&lsquo;interarrival
time&rsquo;&rsquo; can alternatively be specified by the
--rate option, although more flexibility is available with
--period. The D <br>
parameter specifies the interarrival time distribution. If
omitted or set to &lsquo;&lsquo;d&rsquo;&rsquo;, a
deterministic (i.e., fixed) period is used as specified by
parameter T1 in units of <br>
seconds. If D is set to &lsquo;&lsquo;e&rsquo;&rsquo;, an
exponential (i.e., Poisson) distribution is used with a mean
interarrival time of T1. Finally, if D is set to
&lsquo;&lsquo;u&rsquo;&rsquo;, a uniform distri&acirc; <br>
bution over the interval [T1,T2) is used for the
interarrival time. In all cases, a period of 0 results in
connections or sessions being generated sequentially (a new
<br>
connection/session is initiated as soon as the previous one
completes). The default value for this option is 0. Note
that specifying, for example, --rate=5 is equivalent <br>
to specifying --period=d0.2 or --period=0.2. By specifying
--period=u1,3, the interarrival times will be randomly
chosen from the interval between 1 and 3 seconds. The <br>
specific sequence of (pseudo-)random interarrival times are
identical from one httperf run to another as long as the
values for the --period and --client options are iden&acirc;
<br>
tical.</p>

<p style="margin-top: 1em">--port=N <br>
This option specifies the port number N on which the web
server is listening for HTTP requests. By default, httperf
uses port number 80.</p>

<p style="margin-top: 1em">--print-reply[=[header|body]]
<br>
Requests the printing of the reply headers, body, and
summary. The output is directed to standard output. Reply
header lines are prefixed by &quot;RH&quot;, reply body
lines are <br>
prefixed by &quot;RB&quot;, and the reply-size summary is
prefixed by &quot;RS&quot;. The prefix is followed by a
serial number that uniquely identifies the call that the
reply line is for <br>
and a colon (&quot;:&quot;) character that marks the
beginning of the actual reply line. To print only reply
headers, pass argument header to this option. To print only
the reply <br>
body, pass argument body to this option.</p>

<p style="margin-top: 1em">--print-request[=[header|body]]
<br>
Requests the printing of the request headers, body (if one
is present), and summary. The output is directed to standard
output. Request header lines are prefixed by <br>
&quot;SH&quot;, request body lines are prefixed by
&quot;SB&quot;, and the request summary is prefixed by
&quot;SS&quot;. The prefix is followed by the call&rsquo;s
serial number and a colon (&quot;:&quot;) character <br>
that marks the beginning of the actual reply line. To print
only request headers, pass argument header to this option.
To print only the request body, pass argument body <br>
to this option.</p>

<p style="margin-top: 1em">--rate=X <br>
Specifies the fixed rate at which connections or sessions
are created. Connections are created by default, sessions if
option --wsess or --wsesslog has been specified. <br>
In both cases a rate of 0 results in connections or sessions
being generated sequentially (a new session/connection is
initiated as soon as the previous one completes). <br>
The default value for this option is 0.</p>

<p style="margin-top: 1em">--recv-buffer=N <br>
Specifies the maximum size of the socket receive buffers
used to receive HTTP replies. By default, the limit is 16KB.
A smaller value may help memory-constrained clients <br>
whereas a larger value may be necessary when communicating
with a server over a high-bandwidth, high-latency
connection.</p>

<p style="margin-top: 1em">--retry-on-failure <br>
This option is meaningful for session workloads only (see
the --wsess and --wsesslog options). If specified, a call
that results in a failure response (as defined by the <br>
--failure-status option) is retried immediately instead of
causing the session to fail.</p>

<p style="margin-top: 1em">--send-buffer=N <br>
Specifies the maximum size of the socket send buffers used
to send HTTP requests. By default, the limit is 4KB. A
smaller value may help memory-constrained clients <br>
whereas a larger value may be necessary when generating
large requests to a server connected via a high-bandwidth,
high-latency connection.</p>

<p style="margin-top: 1em">--server=S <br>
Specifies the IP hostname of the server. By default, the
hostname &lsquo;&lsquo;localhost&rsquo;&rsquo; is used. This
option should always be specified as it is generally not a
good idea to run <br>
the client and the server on the same machine.</p>

<p style="margin-top: 1em">--server-name=S <br>
Specifies the (default) server name that appears in the
&quot;Host:&quot; header of every request sent by httperf.
Without this option, the host name (or IP address) specified
by <br>
option --server is used instead.</p>

<p style="margin-top: 1em">--session-cookie <br>
When this option is turned on, cookie management is enabled
on a per-session basis. What this means is that if a reply
to a request that was generated by session X con&acirc; <br>
tains a cookie, then all future requests sent by session X
will include this cookie as well. At present, the cookie
manager in httperf supports only one cookie per ses&acirc;
<br>
sion. If a second cookie is received, the new cookie
overwrites the existing one and a warning message is printed
if &lsquo;&lsquo;--debug 1&rsquo;&rsquo; is on.</p>

<p style="margin-top: 1em">--ssl Specifies that all
communication between httperf and the server should utilize
the Secure Sockets Layer (SSL) protocol. This option is
available only if httperf was com&acirc; <br>
piled with SSL support enabled.</p>

<p style="margin-top: 1em">--ssl-ciphers=L <br>
This option is only meaningful if SSL is in use (see --ssl
option). This option specifies the list L of cipher suites
that httperf may use in negotiating a secure connec&acirc;
<br>
tion with the server. If the list contains more than one
cipher suite, the ciphers must be separated by a colon. If
the server does not accept any of the listed cipher <br>
suites, the connection establishment will fail and httperf
will exit immediately. If this option is not specified when
the --ssl option is present then httperf will use <br>
all of the SSLv3 cipher suites provided by the underlying
SSL library.</p>

<p style="margin-top: 1em">--ssl-no-reuse <br>
This option is only meaningful if SSL and sessions are in
use (see --ssl, --wsess, --wsesslog). When an SSL connection
is established the client receives a session iden&acirc;
<br>
tifier (session id) from the server. On subsequent SSL
connections, the client normally reuses this session id in
order to avoid the expense of repeating the (slow) SSL <br>
handshake to establish a new SSL session and obtain another
session id (even if the client attempts to re-use a session
id, the server may force the client to renegotiate <br>
a session). By default httperf reuses the session id across
all connections in a session. If the --ssl-no-reuse option
is in effect, then httperf will not reuse the ses&acirc;
<br>
sion id, and the entire SSL handshake will be performed for
each new connection in a session.</p>

<p style="margin-top: 1em">--think-timeout=X <br>
Specifies the maximum time that the server may need to
initiate sending the reply for a given request. Note that
this timeout value is added to the normal timeout value <br>
(see option --timeout). When accessing static web content,
it is usually not necessary to specify this option. However,
when performing tests with long-running CGI <br>
scripts, it may be necessary to use this option to allow for
larger response-times. The default value for this option is
zero seconds, meaning that the server has to be <br>
able to respond within the normal timeout value.</p>

<p style="margin-top: 1em">--timeout=X <br>
Specifies the amount of time X that httperf is willing to
wait for a server reaction. The timeout is specified in
seconds and can be a fractional number (e.g., --timeout <br>
3.5). This timeout value is used when establishing a TCP
connection, when sending a request, when waiting for a
reply, and when receiving a reply. If during any of those
<br>
activities a request fails to make forward progress within
the alloted time, httperf considers the request to have
died, closes the associated connection or session and <br>
increases the client-timo error count. The actual timeout
value used when waiting for a reply is the sum of this
timeout and the think-timeout (see option
--think-time&acirc; <br>
out). By default, the timeout value is infinity.</p>

<p style="margin-top: 1em">--uri=S <br>
Specifies that URI S should be accessed on the server. For
some of the workload generators (e.g., --wset), this option
specifies the prefix for the URIs being accessed.</p>

<p style="margin-top: 1em">-v</p>

<p style="margin-top: 1em">--verbose <br>
Puts httperf into verbose mode. In this mode, additional
output such as the individual reply rate samples and
connection lifetime histogram are printed.</p>

<p style="margin-top: 1em">-V</p>

<p style="margin-top: 1em">--version <br>
Prints the version of httperf.</p>

<p style="margin-top: 1em">--wlog=B,F <br>
This option can be used to generate a specific sequence of
URI accesses. This is useful to replay the accesses recorded
in a server log file, for example. Parameter F is <br>
the name of a file containing the ASCII NUL separated list
of URIs that should be accessed. If parameter B is set to
&lsquo;&lsquo;y&rsquo;&rsquo;, httperf will wrap around to
the beginning of <br>
the file when reaching the end of the list (so the list of
URIs is accessed repeatedly). With B set to
&lsquo;&lsquo;n&rsquo;&rsquo;, the test will stop no later
than when reaching the end of <br>
the URI list.</p>

<p style="margin-top: 1em">--wsess=N1,N2,X <br>
Requests the generation and measurement of sessions instead
of individual requests. A session consists of a sequence of
bursts which are spaced out by the user think- <br>
time. Each burst consists of a fixed number L of calls to
the server (L is specified by option --burst-length). The
calls in a burst are issued as follows: at first, a <br>
single call is issued. Once the reply to this first call has
been fully received, all remaining calls in the burst are
issued concurrently. The concurrent calls are <br>
issued either as pipelined calls on an existing persistent
connection or as individual calls on separate connections.
Whether a persistent connection is used depends on <br>
whether the server responds to the first call with a reply
that includes a &lsquo;&lsquo;Connection:
close&rsquo;&rsquo; header line. If such a line is present,
separate connections are used.</p>

<p style="margin-top: 1em">The option specifies the
following parameters: N1 is the total number of sessions to
generate, N2 is the number of calls per session, and X is
the user think-time (in sec&acirc; <br>
onds) that separates consecutive call bursts. For example,
the options &lsquo;&lsquo;--wsess=100,50,10 --burst-len
5&rsquo;&rsquo; would result in 100 sessions with a total of
50 calls each. <br>
Since each burst has a length of 5 calls, a total of 10 call
bursts would be generated per session. The user think-time
between call bursts would be 10 seconds. Note <br>
that user think-time X denotes the time between receiving
the last reply of the previous call burst and the sending of
the first request of the next burst.</p>

<p style="margin-top: 1em">A test involving sessions
finishes as soon as the requested number N1 of sessions have
either failed or completed. A session is considered to have
failed if any operation <br>
in a session takes longer than the timeouts specified by
options --timeout and --think-timeout. In addition, a
session also fails if the server returns a reply with a <br>
status code matching the one specified by option
--failure-status.</p>

<p style="margin-top: 1em">--wsesslog=N,X,F <br>
This specifies a session workload generator similar to
--wsess (please read that description first). With
--wsesslog though, many aspects of user sessions, including
the <br>
number and sequence of URI&rsquo;s, request method,
think-time and burst-length parameters, can be specified in
an input file F. Two other parameters are retained from
--wsess, <br>
namely N, the number of sessions to initiate, and X, the
burst-to-burst user think time (note that this becomes a
default time since the input file F can also specify user
<br>
think time on a per-burst basis. A small example input file
can most-easily show the settable parameters:</p>

<p style="margin-top: 1em"># Comment lines start with a
&lsquo;&lsquo;#&rsquo;&rsquo; as the first <br>
# character. Lines with only whitespace delimit <br>
# sessions (multiple blank lines do not generate <br>
# &lsquo;&lsquo;null&rsquo;&rsquo; sessions). All other
lines specify a <br>
# uri-sequence (1 uri per line). If the first <br>
# character of the line is whitespace (e.g. space <br>
# or tab), the uri is considered to be part of a <br>
# burst that is sent out after the previous <br>
# non-burst uri.</p>

<p style="margin-top: 1em"># session 1 definition (this is
a comment) <br>
/foo.html think=2.0 <br>
/pict1.gif <br>
/pict2.gif <br>
/foo2.html method=POST contents=&rsquo;Post data&rsquo; <br>
/pict3.gif <br>
/pict4.gif</p>

<p style="margin-top: 1em"># session 2 definition <br>
/foo3.html method=POST contents=&quot;Multiline0ata&quot;
<br>
/foo4.html method=HEAD</p>

<p style="margin-top: 1em">The above description specifies
2 sessions. The first session will start with a request for
/foo.html. When the /foo.html response comes back, a burst
of 2 requests will <br>
follow (/pict1.gif and /pict2.gif). When the last of those
responses is received, a two second user think time is
inserted before the next request of /foo2.html is <br>
issued. This request is sent as a POST. The posted data can
be contained between single- or double-quotes. Newlines can
appear within posted data as &lsquo;&lsquo;0&rsquo; or as a
<br>
&lsquo;&lsquo;&lt;CR&gt;&rsquo;&rsquo;. The /foo2.html
response is followed by a burst request of /pict3.gif and
/pict4.gif, which concludes this session. The second session
is started some time <br>
after the first, as specified by the --rate or --period
options.</p>

<p style="margin-top: 1em">The second session consists of 2
requests separated by the default user think time as
specified by the X parameter of the --wsesslog option. If
the N parameter of <br>
--wsesslog is greater than the number of sessions defined in
input file F, then the defined sessions are used repeatedly
until N sessions have been created (i.e., the <br>
defined sessions are used in a round-robin fashion).</p>

<p style="margin-top: 1em">One should avoid using
--wsesslog in conjunction with other httperf options that
also control session behavior and workload URI&rsquo;s,
namely --burst-length, --wsess, --wlog, <br>
and --wset.</p>

<p style="margin-top: 1em">--wset=N,X <br>
This option can be used to walk through a list of URIs at a
given rate. Parameter N specifies the number of distinct
URIs that should be generated and X specifies the <br>
rate at which new URIs are accessed. A rate of 0.25 would
mean that the same URI would be accessed four times in a row
before moving on to the next URI. This type of <br>
access pattern is useful in generating a workload that
induces a relatively predictable amount of traffic in the
disk I/O subsystem of the server (assuming N and the <br>
accessed files are big enough to exceed the server&rsquo;s
buffer cache). The URIs generated are of the form
prefix/path.html, where prefix is the URI prefix specified
by <br>
option --wset and path is generated as follows: for the i-th
file in the working set, write down i in decimal, prefixing
the number with as many zeroes as necessary to get <br>
a string that has as many digits as N-1. Then insert a slash
character between each digit. For example, the 103rd file in
a working set consisting of 1024 files would <br>
result in a path of &lsquo;&lsquo;0/1/0/3&rsquo;&rsquo;.
Thus, if the URI-prefix is /wset1024, then the URI being
accessed would be /wset1024/0/1/0/3.html. In other words,
the files on the <br>
server need to be organized as a 10ary tree.</p>

<p style="margin-top: 1em">OUTPUT <br>
This section describes the statistics output at the end of
each test run. The basic information shown below is printed
independent of the selected workload generator.</p>

<p style="margin-top: 1em">Total: connections 30000
requests 29997 replies 29997 test-duration 299.992 s</p>

<p style="margin-top: 1em">Connection rate: 100.0 conn/s
(10.0 ms/conn, &lt;=14 concurrent connections) <br>
Connection time [ms]: min 1.4 avg 3.0 max 163.4 median 1.5
stddev 7.3 <br>
Connection time [ms]: connect 0.6 <br>
Connection length [replies/conn]: 1.000</p>

<p style="margin-top: 1em">Request rate: 100.0 req/s (10.0
ms/req) <br>
Request size [B]: 75.0</p>

<p style="margin-top: 1em">Reply rate [replies/s]: min 98.8
avg 100.0 max 101.2 stddev 0.3 (60 samples) <br>
Reply time [ms]: response 2.4 transfer 0.0 <br>
Reply size [B]: header 242.0 content 1010.0 footer 0.0
(total 1252.0) <br>
Reply status: 1xx=0 2xx=29997 3xx=0 4xx=0 5xx=0</p>

<p style="margin-top: 1em">CPU time [s]: user 94.31 system
205.26 (user 31.4% system 68.4% total 99.9%) <br>
Net I/O: 129.6 KB/s (1.1*10^6 bps)</p>

<p style="margin-top: 1em">Errors: total 3 client-timo 0
socket-timo 0 connrefused 3 connreset 0 <br>
Errors: fd-unavail 0 addrunavail 0 ftab-full 0 other 0</p>

<p style="margin-top: 1em">There are six groups of
statistics: overall results
(&lsquo;&lsquo;Total&rsquo;&rsquo;), connection related
results (&lsquo;&lsquo;Connection&rsquo;&rsquo;), results
relating to the issuing of HTTP requests
(&lsquo;&lsquo;Request&rsquo;&rsquo;), <br>
results relating to the replies received from the server
(&lsquo;&lsquo;Reply&rsquo;&rsquo;), miscellaneous results
relating to the CPU (&lsquo;&lsquo;CPU&rsquo;&rsquo;) and
network (&lsquo;&lsquo;Net I/O&rsquo;&rsquo;) utilization
and, last but not <br>
least, a summary of errors encountered
(&lsquo;&lsquo;Errors&rsquo;&rsquo;).</p>

<p style="margin-top: 1em">Total Section <br>
This section summarizes how many TCP connections were
initiated by httperf, how many requests it sent out, how
many replies it received, and what the total test duration
<br>
was. In the example output shown above, 30,000 connections
were created, 29,997 requests were sent out and 29,997
replies were received. The duration of the test was <br>
almost exactly 5 minutes (300 seconds).</p>

<p style="margin-top: 1em">Connection Section <br>
This section conveys information related to TCP connections
generated by the tool. Specifically, the
&lsquo;&lsquo;Connection rate&rsquo;&rsquo; line shows that
new connections were initiated at <br>
a rate of 100.0 connections per second. This rate
corresponds to a period of 10.0 milliseconds per connection.
The last number in this line shows that at most 14
connec&acirc; <br>
tions were open at any given time.</p>

<p style="margin-top: 1em">The first line labeled
&lsquo;&lsquo;Connection time&rsquo;&rsquo; gives lifetime
statistics for successful connections. The lifetime of a
connection is the time between a TCP connection is
ini&acirc; <br>
tiated and the time the connection is closed. A connection
is considered successful if it had at least one call that
completed successfully. In the example output, the <br>
line indicates that the minimum
(&lsquo;&lsquo;min&rsquo;&rsquo;) connection lifetime was
1.4 milliseconds, the average
(&lsquo;&lsquo;avg&rsquo;&rsquo;) lifetime was 3.0
milliseconds, the maximum (&lsquo;&lsquo;max&rsquo;&rsquo;)
was 163.4 <br>
milliseconds, the median
(&lsquo;&lsquo;median&rsquo;&rsquo;) lifetime was 1.5
milliseconds, and that the standard deviation of the
lifetimes was 7.3 milliseconds. The median lifetime is
com&acirc; <br>
puted based on a histogram with one millisecond resolution
and a maximum lifetime of 100 seconds. Thus, the median is
accurate to within half a millisecond if at least <br>
half of the successful connections have a lifetime of no
more than 100 seconds.</p>

<p style="margin-top: 1em">The next statistic in this
section is the average time it took to establish a TCP
connection. Only successful TCP connection establishments
are counted. In the example, <br>
the second line labeled &lsquo;&lsquo;Connection
time&rsquo;&rsquo; shows that, on average, it took 0.6
milliseconds to establish a connection.</p>

<p style="margin-top: 1em">The final line in this section
is labeled &lsquo;&lsquo;Connection length.&rsquo;&rsquo; It
gives the average number of replies received on each
connection that received at least one reply <br>
(i.e., connections that failed before yielding the first
reply are not counted). This number can be bigger than 1.0
due to persistent connections.</p>

<p style="margin-top: 1em">Request Section <br>
The line labeled &lsquo;&lsquo;Request rate&rsquo;&rsquo;
gives the rate at which HTTP requests were issued and the
period that this rate corresponds to. In the example above,
the request rate <br>
was 100.0 requests per second, which corresponds to 10.0
milliseconds per request. As long as no persistent
connections are employed, the results in this section are
very <br>
similar or identical to results in the connection section.
However, when persistent connections are used, several calls
can be performed on a single connection in which <br>
case the results would be different.</p>

<p style="margin-top: 1em">The line labeled
&lsquo;&lsquo;Request size&rsquo;&rsquo; gives the average
size of the HTTP requests in bytes. In the example above,
the average request size was 75 bytes.</p>

<p style="margin-top: 1em">Reply Section <br>
For simple measurements, this section is often the most
interesting one as the line labeled &lsquo;&lsquo;Reply
rate&rsquo;&rsquo; gives various statistics for the reply
rate. In the example <br>
above, the minimum (&lsquo;&lsquo;min&rsquo;&rsquo;) reply
rate was 98.8 replies per second, the average
(&lsquo;&lsquo;avg&rsquo;&rsquo;) was 100 replies per
second, and the maximum (&lsquo;&lsquo;max&rsquo;&rsquo;)
rate was 101.2 replies per <br>
second. The standard deviation was 0.3 replies per second.
The number enclosed in parentheses shows that 60 reply rate
samples were acquired. At present, httperf col&acirc; <br>
lects a rate sample once every five seconds. To obtain a
meaningful standard deviation, it is recommended to run
tests long enough so at least thirty samples are <br>
obtained. This corresponds to a test duration of at least
150 seconds.</p>

<p style="margin-top: 1em">The line labeled
&lsquo;&lsquo;Reply Time&rsquo;&rsquo; gives information on
how long it took for the server to respond and how long it
took to receive the reply. In the example, it took on <br>
average 2.4 milliseconds between sending the first byte of
the request and receiving the first byte of the reply. The
time to &lsquo;&lsquo;transfer&rsquo;&rsquo;, or read, the
reply was too <br>
short to be measured, so it shows up as zero. The is typical
when the entire reply fits into a single TCP segment.</p>

<p style="margin-top: 1em">The next line, labeled
&lsquo;&lsquo;Reply size&rsquo;&rsquo; contains statistics
on the average size of the replies---all numbers are in
reported bytes. Specifically, the line lists the average
<br>
length of reply headers, the content, and footers (HTTP/1.1
uses footers to realize the
&lsquo;&lsquo;chunked&rsquo;&rsquo; transfer encoding). For
convenience, the average total number of bytes <br>
in the replies is also given in parentheses. In the example,
the average header length
(&lsquo;&lsquo;header&rsquo;&rsquo;) was 242 bytes, the
average content length (&lsquo;&lsquo;content&rsquo;&rsquo;)
was 1010 <br>
bytes, and there were no footers
(&lsquo;&lsquo;footer&rsquo;&rsquo; length is zero). The
total reply length of 1252 bytes on average.</p>

<p style="margin-top: 1em">The final line in this section
is a histogram of the major status codes received in the
replies from the server. The major status code is the
&lsquo;&lsquo;hundreds&rsquo;&rsquo;-digit of the <br>
full HTTP status code. In the example, all 29,997 replies
had a major status code of 2. It&rsquo;s a good guess that
all status codes were &lsquo;&lsquo;200 OK&rsquo;&rsquo; but
the information in <br>
the histogram is not detailed enough to allow distinguishing
status codes with the same major code.</p>

<p style="margin-top: 1em">Miscellaneous Section <br>
This section starts with a summary of the CPU utilization on
the client machine. In the example, the line labeled
&lsquo;&lsquo;CPU time&rsquo;&rsquo; shows that 94.31
seconds were spent execut&acirc; <br>
ing in user mode (&lsquo;&lsquo;user&rsquo;&rsquo;), 205.26
seconds were spent executing in system mode
(&lsquo;&lsquo;system&rsquo;&rsquo;) and that this
corresponds to 31.4% user mode execution and 68.4% system
execu&acirc; <br>
tion. The total utilization was 99.9%, which is expected
given that httperf is a CPU hog. A total CPU utilization of
significantly less than 100% is a sign that there <br>
were competing processes that interfered with the test.</p>

<p style="margin-top: 1em">The line labeled
&lsquo;&lsquo;Net I/O&rsquo;&rsquo; gives the average
network throughput in kilobytes per second (where a kilobyte
is 1024 bytes) and in megabits per second (where a megabit
is <br>
10^6 bits). In the example, an average network usage of
about 129.6 kilobytes per second was sustained. The number
in parentheses shows that this corresponds to about <br>
1.1 megabits per second. This network bandwidth is computed
based on the number of bytes sent and received on the TCP
connections. In other words, it does not account <br>
for the network headers or TCP retransmissions that may have
occurred.</p>

<p style="margin-top: 1em">Errors Section <br>
The last section contains statistics on the errors that were
encountered during a test. In the example, the two lines
labeled &lsquo;&lsquo;Errors&rsquo;&rsquo; show that there
were a total of <br>
three errors and that all three errors were due to the
server refusing to accept a connection
(&lsquo;&lsquo;connrefused&rsquo;&rsquo;). A description of
each error counter follows:</p>

<p style="margin-top: 1em">client-timo: The number of times
a session, connection, or call failed due to a client
timeout (as specified by the --timeout and --think-timeout)
options.</p>

<p style="margin-top: 1em">socket-timo: The number of times
a TCP connection failed with a socket-level timeout
(ETIMEDOUT).</p>

<p style="margin-top: 1em">connrefused: The number of times
a TCP connection attempt failed with a
&lsquo;&lsquo;connection refused by server&rsquo;&rsquo;
error (ECONNREFUSED).</p>

<p style="margin-top: 1em">connreset: The number of times a
TCP connection failed due to a RESET from the server.
Typically, a RESET is received when the client attempts to
send data to the server <br>
at a time the server has already closed its end of the
connection. NT servers also send RESETs when attempting to
establish a new connection when the listen queue is <br>
full.</p>

<p style="margin-top: 1em">fd-unavail: The number of times
the httperf process was out of file descriptors. Whenever
this count is non-zero, the test results are meaningless
because the client was <br>
overloaded (see section &quot;CHOOSING TIMEOUT
VALUES&quot;).</p>

<p style="margin-top: 1em">addrunavail: The number of times
the client was out of TCP port numbers (EADDRNOTAVAIL). This
error should never occur. If it does, the results should be
discarded.</p>

<p style="margin-top: 1em">ftab-full: The number of times
the system&rsquo;s file descriptor table is full. Again,
this error should never occur. If it does, the results
should be discarded.</p>

<p style="margin-top: 1em">other: The number of times some
other type of error occurred. Whenever this counter is
non-zero, it is necessary to track down the real cause of
the error. To assist in <br>
doing this, httperf prints the error code (errno) of the
first unknown errors that occurs during a test run.</p>

<p style="margin-top: 1em">When --wsess or --wsesslog is
specified, httperf generates and measures sessions instead
of individual calls and additional statistics are printed at
the end of a test. An exam&acirc; <br>
ple output is shown below.</p>

<p style="margin-top: 1em">Session rate [sess/s]: min 0.00
avg 0.59 max 2.40 stddev 0.37 (240/450) <br>
Session: avg 6.45 connections/session <br>
Session lifetime [s]: 123.9 <br>
Session failtime [s]: 58.5 <br>
Session length histogram: 4 7 4 ... 3 3 240</p>

<p style="margin-top: 1em">The line labeled
&lsquo;&lsquo;Session rate&rsquo;&rsquo; shows the minium,
average, and maximum rate at which sessions completed (based
on a 5 second sampling interval). It also shows the standard
<br>
deviation of the session completion rate. The numbers in
parentheses show how many sessions succeeded and how many
sessions were initiated. In the example above, the minimum,
<br>
average, and maximum session completion rates were 0.00,
0.59, and 2.40 sessions per second, respectively. The
standard deviation was 0.37 sessions per second and 240 out
of 450 <br>
sessions completed successfully (210 failed due to errors
such as timeouts).</p>

<p style="margin-top: 1em">The next line, labeled
&lsquo;&lsquo;Session:&rsquo;&rsquo; shows the average
length of a session measured in connections. In the example
above, an average of 6.45 connections were required to
complete <br>
a session.</p>

<p style="margin-top: 1em">The line labeled
&lsquo;&lsquo;Session lifetime&rsquo;&rsquo; gives the
average time it took to complete a successful session. In
the example above, it took an average of 123.9 seconds.</p>

<p style="margin-top: 1em">The line labeled
&lsquo;&lsquo;Session failtime&rsquo;&rsquo; gives the
average time it took before an unsuccessful session failed.
In the example above, it took on average 58.5 seconds for a
session <br>
to fail.</p>

<p style="margin-top: 1em">Finally, the line labeled
&lsquo;&lsquo;Session length histogram&rsquo;&rsquo; gives a
histogram of the number of replies received by each session.
In the example above, 4 sessions ended after receiv&acirc;
<br>
ing no reply at all, 7 ended after receiving one reply, and
so on (the ellipsis indicates additional histogram counts
that were omitted from this manual for space reasons). Note
<br>
that this histogram does not distinguish between successful
and failed sessions.</p>

<p style="margin-top: 1em">CHOOSING TIMEOUT VALUES <br>
Since the machine that httperf runs on has only a finite set
of resource available, it can not sustain arbitrarily high
HTTP loads. For example, one limiting factor is that <br>
there are only roughly 60,000 TCP port numbers that can be
in use at any given time. Since on most UNIX systems it
takes one minute for a TCP connection to be fully closed
<br>
(leave the TIME_WAIT state), the maximum rate a client can
sustain is at most 1,000 requests per second.</p>

<p style="margin-top: 1em">The actual sustainable rate is
often much lower than that because before running out of TCP
ports, the machine is likely to run out of file descriptors
(one file descriptor is <br>
used up for each open TCP connection). By default, HP-UX
10.20 allows 1,024 open file descriptors per process. This
means that without extra precautions, httperf could
poten&acirc; <br>
tially very quickly use up all available file descriptors,
at which point it could not induce any additional load on
the server. To avoid this problem, httperf provides option
<br>
--timeout to set a timeout for all communication with the
server. If the server does not respond before the timeout
expires, the client considers the corresponding session,
con&acirc; <br>
nection, or call to be &lsquo;&lsquo;dead,&rsquo;&rsquo;
closes the associated TCP connection, and increases the
&lsquo;&lsquo;client-timo&rsquo;&rsquo; error count. The
only exception to this rule is that after sending an <br>
entire request to the server, httperf allows the server to
take some additional time before it starts sending the
reply. This is to accommodate HTTP requests that take a long
<br>
time to complete on the server. This additional time is
called the &lsquo;&lsquo;server think time&rsquo;&rsquo; and
can be specified by option --think-timeout. By default, this
additional think time <br>
is zero seconds, so the server would always have to respond
within the time alloted by option --timeout.</p>

<p style="margin-top: 1em">Timeouts allow httperf to
sustain high offered loads even when the server is
overloaded. For example, with a timeout of 2 seconds and
assuming that 1,000 file-descriptors are <br>
available, the offered load could be up to 500 requests per
second (in practice, the sustainable load is often somewhat
smaller than the theoretical value). On the downside, <br>
timeouts artificially truncate the connection lifetime
distribution. Thus, it is recommended to pick a timeout
value that is as large as possible yet small enough to allow
sus&acirc; <br>
taining the desired offered rate. A timeout as short as one
second may be acceptable, but larger timeouts (5-10 seconds)
are preferable.</p>

<p style="margin-top: 1em">It is important to keep in mind
that timeouts do not guarantee that a client can sustain a
particular offered load---there are many other potential
resource bottlenecks. For <br>
example, in some cases the client machine may simply run out
of CPU time. To ensure that a given test really measured the
server&rsquo;s capabilities and not the client&rsquo;s, it
is a <br>
good idea to vary the number of machines participating in a
test. If observed performance remains the same as the number
of client machines is varied, the test results are <br>
likely to be valid.</p>

<p style="margin-top: 1em">AUTHOR <br>
httperf was developed by David Mosberger and was heavily
influenced by an earlier tool written by Tai Jin. Stephane
Eranian contributed the log-file based URI generator. Dick
<br>
Carter contributed the --wsesslog workload generator, the
support behind the --period option, and bug fixes. All four
authors are with Hewlett-Packard Research Laboratories.</p>

<p style="margin-top: 1em">BUGS <br>
Probably many. Always be sure to double-check results and
don&rsquo;t fall prey to measuring client-performance
instead of server performance!</p>

<p style="margin-top: 1em">The user-interface definitely
could be improved. A simple workload description language
might be more suitable than the dozens of little
command-line options the tool has right <br>
now.</p>

<p style="margin-top: 1em">30 Oct 2000 httperf(1)</p>
<hr>
</body>
</html>
