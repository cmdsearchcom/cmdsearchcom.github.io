<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 16:04:02 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>dicelab(1) Dicelab - examine and roll dice
dicelab(1)</p>

<p style="margin-top: 1em">NAME <br>
dicelab - roll and examine dice rolling schemes</p>

<p style="margin-top: 1em">SYNOPSIS <br>
dicelab [options] [-f &lt;file&gt;]</p>

<p style="margin-top: 1em">OPTIONS <br>
-h, --help, -? <br>
print a help message</p>

<p style="margin-top: 1em">--version, -v <br>
display version number</p>

<p style="margin-top: 1em">--calc, -c <br>
calculate the distribution</p>

<p style="margin-top: 1em">--roll, -r <br>
roll the dice as specified. This will also be used if no
other action is requested</p>

<p style="margin-top: 1em">--eval, -e <br>
reroll many times and sum up the results to get a
statistical distribution of values</p>

<p style="margin-top: 1em">--count, -n <br>
specify the number of rerolls for --eval, default it
10000</p>

<p style="margin-top: 1em">--print-tree, -p <br>
print the parse tree (for debugging purposes)</p>

<p style="margin-top: 1em">-f&lt;file&gt; <br>
read the scheme description from file instead from stdin</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Dicelab reads a description of a dice rolling scheme from a
file or from stdin if no file is specified and then rolls or
examines this scheme.</p>

<p style="margin-top: 1em">QUICK START <br>
Single die rolls may be made using the &rsquo;d&rsquo;
operator, followed by the number of faces on the die to be
rolled. E.g., d6 will roll a single six-sided die, and d2
will flip a coin. <br>
Expressions may be modified by the standard arithmetic
operators. d10-1 will yield a value between 0 and 9,
inclusive. In order to roll multiple dice of the same type,
use the <br>
repetition operator &rsquo;#&rsquo;. 2#d6 will roll two
six-sided dice; this is not the same as 2*d6, which rolls
only a single die but multipies the result by two, or 2d6
which will cause a <br>
syntax error. In order to get the sum of two six-sided dice,
do sum(2#d6).</p>

<p style="margin-top: 1em">FULL SYNTAX <br>
&lt;integer&gt; ::= <br>
-?[0-9]+ <br>
&lt;variable&gt; ::= <br>
[A-Za-z]+ <br>
&lt;scalar&gt; ::= <br>
&lt;integer&gt; <br>
| &lt;variable&gt; <br>
| ( &lt;scalar&gt; ) <br>
| - &lt;scalar&gt; <br>
| &lt;scalar&gt; + &lt;scalar&gt; <br>
| &lt;scalar&gt; - &lt;scalar&gt; <br>
| &lt;scalar&gt; * &lt;scalar&gt; <br>
| &lt;scalar&gt; / &lt;scalar&gt; <br>
| &lt;scalar&gt; % &lt;scalar&gt; <br>
| &lt;scalar&gt; ^ &lt;scalar&gt; <br>
| &lt;scalar&gt; . &lt;scalar&gt; <br>
| d&lt;scalar&gt; <br>
| sum &lt;expr&gt; <br>
| prod &lt;expr&gt; <br>
| count &lt;expr&gt; <br>
&lt;list&gt; ::= <br>
&lt;scalar&gt; # &lt;expr&gt; <br>
| ( &lt;list&gt; ) <br>
| &lt;scalar&gt; .. &lt;scalar&gt; <br>
| &lt;expr&gt; , &lt;expr&gt; <br>
| perm &lt;expr&gt; <br>
| sort &lt;expr&gt; <br>
| rev &lt;expr&gt; <br>
| (drop|keep)? low &lt;scalar&gt; &lt;expr&gt; <br>
| (drop|keep)? high &lt;scalar&gt; &lt;expr&gt; <br>
| (drop|keep)? first &lt;scalar&gt; &lt;expr&gt; <br>
| (drop|keep)? last &lt;scalar&gt; &lt;expr&gt; <br>
| (drop|keep)? == &lt;scalar&gt; &lt;expr&gt; <br>
| (drop|keep)? != &lt;scalar&gt; &lt;expr&gt; <br>
| (drop|keep)? &lt; &lt;scalar&gt; &lt;expr&gt; <br>
| (drop|keep)? &gt; &lt;scalar&gt; &lt;expr&gt; <br>
| (drop|keep)? &lt;= &lt;scalar&gt; &lt;expr&gt; <br>
| (drop|keep)? &gt;= &lt;scalar&gt; &lt;expr&gt; <br>
| if &lt;expr&gt; then &lt;expr&gt; else &lt;expr&gt; <br>
| let &lt;variable&gt; = &lt;expr&gt; in &lt;expr&gt; <br>
| while &lt;variable&gt; = &lt;expr&gt; do &lt;expr&gt; <br>
| foreach &lt;variable&gt; in &lt;expr&gt; do &lt;expr&gt;
<br>
&lt;expr&gt; ::= <br>
&lt;scalar&gt; <br>
&lt;list&gt; <br>
&lt;input&gt; ::= <br>
&lt;expr&gt; <br>
| &lt;expr&gt; ; &lt;expr&gt;</p>

<p style="margin-top: 1em">Comments may be inserted by
using double slashed (//) as in C.</p>

<p style="margin-top: 1em">SEMANTICS <br>
+ - * / ^</p>

<p style="margin-top: 1em">These are the familiar binary
arithmetic operators for addition, subtraction,
multiplication, division, and exponentiation. Division
rounds toward zero. Examples: 5+7, <br>
d6-1, 2^10</p>

<p style="margin-top: 1em">-</p>

<p style="margin-top: 1em">This is the unary minus
operator. Examples: -1</p>

<p style="margin-top: 1em">%</p>

<p style="margin-top: 1em">This is the modulus operator. x
% y gives the remainder of x divided by y. Examples: 11%2,
d6%3</p>

<p style="margin-top: 1em">.</p>

<p style="margin-top: 1em">This is the scalar concatenation
operator. x . y gives xy, the concatenation of x and y.
Examples: -10.9, d6.d6</p>

<p style="margin-top: 1em">d</p>

<p style="margin-top: 1em">This is the die roll operator.
dn gives the value of a single roll of an n-sided die.
Examples: d6, 2#d6</p>

<p style="margin-top: 1em">sum prod</p>

<p style="margin-top: 1em">These are the extended sum and
product operators. If e is an expression, sum e and prod e
give the sum of the members of e and the product of the
members of e, respec&acirc; <br>
tively. Examples: sum(1..100), prod(3#d6)</p>

<p style="margin-top: 1em">count</p>

<p style="margin-top: 1em">This is the list size operator.
If e is an expression, then count e gives the number of
members of e. Examples: count(1,2,3), count(== 6 10#d6)</p>

<p style="margin-top: 1em">#</p>

<p style="margin-top: 1em">This is the list repetition
operator. If n is a nonnegative scalar and e is an
expression, then n#e is a list containing the results of n
evaluations of e. Examples: 10#8, <br>
3#d10</p>

<p style="margin-top: 1em">..</p>

<p style="margin-top: 1em">This is the range operator. If x
and y are scalars, then x..y is a list consisting of the
interval [x,y]. If x&gt;y, then the resulting list is empty.
Examples: 1..10, <br>
4..d10</p>

<p style="margin-top: 1em">,</p>

<p style="margin-top: 1em">This is the list concatenation
operator. v,u gives the list consisting of all of the
members of v, followed by all of the members of u. Examples:
1,2 4,(3#d6)</p>

<p style="margin-top: 1em">sort</p>

<p style="margin-top: 1em">This is the list sorting
operator. sort e sorts the list e in ascending order.
Examples: sort(10#d6)</p>

<p style="margin-top: 1em">perm</p>

<p style="margin-top: 1em">This is the list permutation
operator. sort e results in a random permutation of the list
e. Use perm to shuffle a list. Examples: perm(1..52)</p>

<p style="margin-top: 1em">rev</p>

<p style="margin-top: 1em">This is the list reversal
operator. rev e results in a list with the same members as
the list e, but in reverse order. Examples: rev(1..10), rev
sort(10#d8)</p>

<p style="margin-top: 1em">low high</p>

<p style="margin-top: 1em">These operators act as filters
by finding the least and greatest values in lists. If n is a
nonnegative scalar and e is an expression, then low n e
gives the n least mem&acirc; <br>
bers of e, and high n e gives the n greatest members of e.
Examples: high 3 5#d6</p>

<p style="margin-top: 1em">first last</p>

<p style="margin-top: 1em">These operators act as filters
by finding initial and final segments of lists. If n is a
nonnegtive scalar and e is an expression, then first n e
gives the first n members <br>
of e, and last n e gives the last n members of e. Examples:
first 3 (1..10)</p>

<p style="margin-top: 1em">== != &lt; &gt; &lt;= &gt;=</p>

<p style="margin-top: 1em">These operators act as filters
by finding values in lists which meet given conditions. If x
is a scalar and e is an expression, then == x e gives the
list of members of e <br>
equal to x; != x e gives the list of members of e not equal
to x; &lt; x e gives the list of members of e less than x;
&gt; x e gives the list of members of e greater than x;
&lt;= <br>
x e gives the list of members of e less than or equal to x;
&gt;= x e gives the list of members of e greater than or
equal to x. Examples: &gt;= 3 5#d6</p>

<p style="margin-top: 1em">drop keep</p>

<p style="margin-top: 1em">These operators modify filters
on lists. If fop is a filter operation on an expression e,
then keep fop e has the same result as fop e and drop fop e
evaluates to e less <br>
keep fop e. In other words, drop negates filter conditions,
and keep affirms them. keep is never necessary and exists
only for symmetry. Examples: sum(drop low 1 4#d6)</p>

<p style="margin-top: 1em">let</p>

<p style="margin-top: 1em">This is the variable assignment
and substitution operator. If x is a variable and e and f
are an expressions, then let x = e in f gives the list which
results from evalu&acirc; <br>
ating f with the value of e substituted for every occurance
of x in f. Evaluation of e is done prior to substitution.
Examples: let x = d6 in x*x</p>

<p style="margin-top: 1em">foreach</p>

<p style="margin-top: 1em">This is the bounded iteration
operator. If x is a variable and e and f are expressions,
then foreach x in e do f gives the list which results from
assigning to x each of <br>
the members of e and evaluating f. Examples: foreach x in c
do x+1</p>

<p style="margin-top: 1em">while</p>

<p style="margin-top: 1em">This is the unbounded iteration
operator. If x is a variable and e and f are expressions,
then while x = e do f is the list v0,v1,...,vn, where v0 is
the result of evalu&acirc; <br>
ating e and vi+1 is the result of assigning vi to x and
evaluating f, stopping at the first vi which is empty.
Examples: while x=d6 do ((count &lt;6 x)#d6)</p>

<p style="margin-top: 1em">if</p>

<p style="margin-top: 1em">This is the branching operator.
If e, f, and g are expressions, then if e then f else g
gives f if e is nonempty, and g otherwise. Examples: if
count(&gt;4 2#d6) then 1 else <br>
0</p>

<p style="margin-top: 1em">EXAMPLES <br>
Count the number of dice greater than 7:</p>

<p style="margin-top: 1em">count &gt;7 5#d10</p>

<p style="margin-top: 1em">Count the number of dice greater
than 7 minus the number of dice equal to 1:</p>

<p style="margin-top: 1em">let c=5#d10 in (count &gt;7
c)-(count ==1 c)</p>

<p style="margin-top: 1em">Count the number of rolls until
a 6 is rolled:</p>

<p style="margin-top: 1em">count (while x=d6 do ((count
&lt;6 x)#d6))</p>

<p style="margin-top: 1em">Count the number of rolls until
a 6 is rolled, more efficiently:</p>

<p style="margin-top: 1em">count (while x=(d6/6) do ((count
&lt;1 x)#(d6/6)))</p>

<p style="margin-top: 1em">Roll attributes for a new
D&amp;D character:</p>

<p style="margin-top: 1em">6#sum(drop low 1 4#d6)</p>

<p style="margin-top: 1em">Roll on the 11..66 morale check
table in The Gamers&rsquo; Civil War Brigade Series:</p>

<p style="margin-top: 1em">d6.d6</p>

<p style="margin-top: 1em">Find the median of 3 d20s:</p>

<p style="margin-top: 1em">high 1 low 2 3#d20</p>

<p style="margin-top: 1em">3d6 with rerolls on 6s:</p>

<p style="margin-top: 1em">sum(while x=3#d6 do ((count ==6
x)#d6))</p>

<p style="margin-top: 1em">Roll 7 d10 and find the largest
sum of identical dice:</p>

<p style="margin-top: 1em">let x = 7#d10 in high 1 (foreach
y in 1..10 do sum (==y x))</p>

<p style="margin-top: 1em">The Fibonacci sequence is
defined by Fn = Fn-1 + Fn-2, with F1 = F2 = 1. Calculate the
first twenty Fibonacci numbers:</p>

<p style="margin-top: 1em">let n = 20 in <br>
let f = (1,1) in <br>
foreach i in 1..n do <br>
let f = (f,sum(high 2 f)) in <br>
if ==n i then f else ()</p>

<p style="margin-top: 1em">Risk has battles where the
attacker rolls 3d6 and the defender rolls 2d6. The highest
attacker die is matched with the highest defender die and
the second highest attacker die <br>
to the second highest defender die. For both matches, the
highest wins, with ties going to the defender. The number of
attacker wins:</p>

<p style="margin-top: 1em">let a = 3#d6 in <br>
let b = 2#d6 in <br>
count( (&lt;(high 1 a) high 1 b), <br>
(&lt;(high 1 low 2 a) low 1 b))</p>

<p style="margin-top: 1em">Storyteller die roll with target
number 8 and botches indicated at -1:</p>

<p style="margin-top: 1em">let c=5#d10 in <br>
let succs = count &gt;7 c in <br>
let ones = count ==1 c in <br>
if &gt;0 succs then high 1 (0,succs-ones) <br>
else if &gt;0 ones then -1 else 0</p>

<p style="margin-top: 1em">Combat in Silent Death is rather
complex. Three dice are rolled. If their sum is above a
target, the roll is a hit. To calculate damage, the same
dice are sorted. If all three <br>
are equal, all are summed to yield the damage. If the least
two are equal, but the third is higher, the high die is the
damage. If the two highest are equal, but the third is <br>
lower, the two high dice are summed to yield the damage. If
all three dice are different, the middle die is the damage.
This example assumes that the dice are two d8s and a d10,
<br>
with a target number of 15:</p>

<p style="margin-top: 1em">let x = 2#d8,d10 in <br>
(count &gt;15 sum x)# <br>
let a = low 1 x in // low die <br>
let b = high 1 low 2 x in // middle die <br>
let c = high 1 x in // high die <br>
if ==a ==b c then a+b+c // all equal <br>
else if ==a &lt;c b then c // two low equal <br>
else if &gt;a ==c b then b+c // two high equal <br>
else b // all different</p>

<p style="margin-top: 1em">CREDITS <br>
Dicelab is based on the excellent work &quot;roll&quot; by
Torben Mogensen (http://www.diku.dk/~torbenm/Dice.zip).
Without his work and comments, this would hardly ever have
happened.</p>

<p style="margin-top: 1em">The current language
specification and the extensions to the original language
are derived from the work of Joel Uckelman
(http://dice.nomic.net/bones.html), most of the
documen&acirc; <br>
tation is stolen from him as well.</p>

<p style="margin-top: 1em">This code was written by Robert
Lemmen &lt;robertle@semistable.com&gt; who would be glad to
hear your questions and remarks.</p>

<p style="margin-top: 1em">dicelab v0.2 February 2007
dicelab(1)</p>
<hr>
</body>
</html>
