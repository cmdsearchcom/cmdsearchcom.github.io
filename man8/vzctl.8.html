<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:17:35 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>vzctl(8) Containers vzctl(8)</p>

<p style="margin-top: 1em">NAME <br>
vzctl - perform various operations on an OpenVZ
container</p>

<p style="margin-top: 1em">SYNOPSIS <br>
vzctl [flags] create CTID --parameter value [...] <br>
vzctl [flags] start CTID [--wait] [--force] [--skip-fsck]
[--skip-remount] <br>
vzctl [flags] stop CTID [--fast] [--skip-umount] <br>
vzctl [flags] restart CTID [--wait] [--force] [--fast]
[--skip-fsck] [--skip-remount] <br>
vzctl [flags] suspend | resume CTID [--dumpfile name] <br>
vzctl [flags] snapshot CTID [--id uuid] [--name name]
[--description desc] [--skip-suspend] [--skip-config] <br>
vzctl [flags] snapshot-switch CTID [--skip-resume |
--must-resume] [--skip-config] --id uuid <br>
vzctl [flags] snapshot-delete CTID --id uuid <br>
vzctl [flags] snapshot-mount CTID --id uuid --target dir
<br>
vzctl [flags] snapshot-umount CTID --id uuid <br>
vzctl [flags] snapshot-list CTID [-H] [-o field[,field...]
[--id uuid] <br>
vzctl [flags] set CTID --parameter value [...] [--save]
[--force] [--setmode restart|ignore] <br>
vzctl [flags] set CTID --reset_ub <br>
vzctl [flags] destroy | delete | mount | umount | status |
quotaon | quotaoff | quotainit CTID <br>
vzctl [flags] console CTID [ttynum] <br>
vzctl [flags] convert CTID [--layout
ploop[:{expanded|plain|raw}]] <br>
vzctl [flags] compact CTID <br>
vzctl [flags] exec | exec2 CTID command [arg ...] <br>
vzctl [flags] enter CTID [--exec command [arg ...]] <br>
vzctl [flags] runscript CTID script <br>
vzctl --help | --version</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Utility vzctl runs on the host system (otherwise known as
Hardware Node, or HN) and performs direct manipulations with
containers (CTs).</p>

<p style="margin-top: 1em">Containers can be referred to by
either numeric CTID or by name (see --name option). Note
that CT ID &lt;= 100 are reserved for OpenVZ internal
purposes. A numeric ID should not be <br>
more than 2147483644.</p>

<p style="margin-top: 1em">OPTIONS <br>
Flags <br>
These flags come before a command, and can be used with any
command. They affect logging to console (terminal) only, and
do not affect logging to a log file.</p>

<p style="margin-top: 1em">--quiet <br>
Disables output. Note that scripts run by vzctl are still
able to produce some output.</p>

<p style="margin-top: 1em">--verbose <br>
Increments logging level up from the default. Can be used
multiple times. Default value is set to the value of VERBOSE
parameter in the global configuration file vz.conf(5), <br>
or to 0 if not set by VERBOSE parameter.</p>

<p style="margin-top: 1em">Setting container parameters
<br>
set CTID [--onboot yes|no] [--bootorder number] [--root
path] [--private path] [--mount_opts options] [--userpasswd
user:pass] [--disabled yes|no] [--name name] <br>
[--description string] [--ostemplate string] [--stop-timeout
seconds] [--ipadd addr] [--ipdel addr|all] [--hostname name]
[--nameserver addr] [--searchdomain name] <br>
[--netif_add dev[,params...]] [--netif_del dev|all]
[--ifname dev [--mac hwaddr] [--host_ifname dev] [--host_mac
hwaddr] [--bridge name] [--mac_filter on|off]] <br>
[--numproc items] [--numtcpsock items] [--numothersock
items] [--vmguarpages pages] [--kmemsize bytes] [--tcpsndbuf
bytes] [--tcprcvbuf bytes] [--othersockbuf bytes] <br>
[--dgramrcvbuf bytes] [--oomguarpages pages] [--lockedpages
pages] [--privvmpages pages] [--shmpages pages] [--numfile
items] [--numflock items] [--numpty items] <br>
[--numsiginfo items] [--dcachesize bytes] [--numiptent num]
[--physpages pages] [--swappages pages] [--ram bytes]
[--swap bytes] [--vm_overcommit float] [--cpuunits num] <br>
[--cpulimit num] [--cpus num] [--cpumask cpus|auto|all]
[--nodemask nodes|all] [--meminfo none|mode:value]
[--iptables name[,...]] <br>
[--netfilter disabled|stateless|stateful|full] [--netdev_add
ifname] [--netdev_del ifname] [--diskquota yes|no]
[--diskspace num] [--diskinodes num] [--quotatime seconds]
<br>
[--quotaugidlimit num] [--capability capname:on|off[,...]]
[--devnodes param] [--devices param] [--pci_add dev]
[--pci_del dev] [--features name:on|off[,...]] <br>
[--applyconfig name] [--applyconfig_map group] [--ioprio
num] [--iolimit mbps] [--iopslimit iops] [--save] [--force]
[--reset_ub] [--setmode restart|ignore]</p>

<p style="margin-top: 1em">This command sets various
container parameters. If the container is currently running,
vzctl applies these parameters to the container. The
following options can be used <br>
with set command.</p>

<p style="margin-top: 1em">Flags</p>

<p style="margin-top: 1em">--save <br>
If this flag is given, parameters are saved in container
configuration file ctid.conf(5).</p>

<p style="margin-top: 1em">--force <br>
If this flag is given together with --save, parameters are
saved even if the current kernel doesn&rsquo;t support
OpenVZ. Note this flag does not make sense without --save,
so <br>
--save is required.</p>

<p style="margin-top: 1em">--reset_ub <br>
If this flag is given, vzctl applies all User Beancounter
parameters from the configuration file to a running
container. This is helpful in case configuration file is
modi&acirc; <br>
fied manually. Please note this flag is exclusive, i.e. it
can not be combined with any other options or flags.</p>

<p style="margin-top: 1em">--setmode restart | ignore <br>
A few parameters can only be applied by restarting the
container. By default, vzctl prints a warning if such
parameters are supplied and a container is running. Use
--set&acirc; <br>
mode restart together with --save flag to restart a
container in such a case, or --setmode ignore to suppress
the warning.</p>

<p style="margin-top: 1em">Miscellaneous</p>

<p style="margin-top: 1em">--onboot yes | no <br>
Sets whether the container will be started during system
boot. The container will be started on boot by vz initscript
if either this parameter is set to yes, or the con&acirc;
<br>
tainer was running just before last reboot, and this
parameter is not set to no. Default value is unset, meaning
the container will be started if it was running before the
<br>
last reboot.</p>

<p style="margin-top: 1em">--bootorder number <br>
Sets the boot order priority for this CT. The higher the
number is, the earlier in the boot process this container
starts. By default this parameter is unset, which is
con&acirc; <br>
sidered to be the lowest priority, so containers with unset
bootorder will start last.</p>

<p style="margin-top: 1em">--root path <br>
Sets the path to root directory (VE_ROOT) for this
container. This is essentially a mount point for
container&rsquo;s root directory. Argument can contain
literal string $VEID, <br>
which will be substituted with the numeric CT ID.</p>

<p style="margin-top: 1em">--private path <br>
Sets the path to private directory (VE_PRIVATE) for this
container. This is a directory in which all the
container&rsquo;s files are stored. Argument can contain
literal string <br>
$VEID, which will be substituted with the numeric CT ID.</p>

<p style="margin-top: 1em">--mount_opts option[,option...]
<br>
Sets additional mount options for container file system.
Only applicable for ploop layout, ignored otherwise.</p>

<p style="margin-top: 1em">--userpasswd user:password <br>
Sets password for the given user in a container, creating
the user if it does not exists. Note that this option is not
saved in configuration file at all (so --save flag is <br>
useless), it is applied directly to the container, by
running distribution-specific programs inside the container.
It is not recommended to combine this option with any <br>
other options.</p>

<p style="margin-top: 1em">In case container was not
running, it is automatically started then all the
appropriate changes are applied, then it is stopped.</p>

<p style="margin-top: 1em">Note that container should be
created before using this option.</p>

<p style="margin-top: 1em">--disabled yes | no <br>
Disable container start. To force the start of a disabled
container, use vzctl start --force.</p>

<p style="margin-top: 1em">--name name <br>
Add a name for a container. The name can later be used in
subsequent calls to vzctl in place of CTID. Note this option
can not be used without --save.</p>

<p style="margin-top: 1em">--description string <br>
Add a textual description for a container.</p>

<p style="margin-top: 1em">--ostemplate string <br>
Sets a new value of OSTEMPLATE parameter in container
configuration file ctid.conf(5). Requires --save flag.
Useful after a change/upgrade of a distribution running
inside <br>
container, as vzctl uses the value of OSTEMPLATE to run
distribution-specific scripts.</p>

<p style="margin-top: 1em">--stop-timeout seconds <br>
Sets a time to wait for container to stop on vzctl stop
before forcibly killing it, in seconds. Note this option can
not be used without --save flag.</p>

<p style="margin-top: 1em">Special value of 0 means to use
compiled-in default.</p>

<p style="margin-top: 1em">Networking</p>

<p style="margin-top: 1em">--ipadd addr <br>
Adds an IP address addr to a given container. Address can
optionally have a netmask specified in the CIDR notation
(e.g. 10.1.2.3/25). Note that this option is incremental,
<br>
so addr are added to already existing ones.</p>

<p style="margin-top: 1em">--ipdel addr | all <br>
Removes IP address addr from a container. If you want to
remove all the addresses, use --ipdel all.</p>

<p style="margin-top: 1em">--hostname name <br>
Sets container hostname. vzctl writes it to the appropriate
file inside a container (distribution-dependent).</p>

<p style="margin-top: 1em">--nameserver addr <br>
Sets DNS server IP address for a container. If you want to
set several nameservers, you should do it at once, so use
--nameserver option multiple times in one call to vzctl,
<br>
as all the name server values set in previous calls to vzctl
are overwritten.</p>

<p style="margin-top: 1em">A special value of inherit can
be used to auto-propagate nameserver value(s) from the host
system&rsquo;s /etc/resolv.conf file.</p>

<p style="margin-top: 1em">--searchdomain name <br>
Sets DNS search domains for a container. If you want to set
several search domains, you should do it at once, so use
--searchdomain option multiple times in one call to <br>
vzctl, as all the search domain values set in previous calls
to vzctl are overwritten.</p>

<p style="margin-top: 1em">A special value of inherit can
be used to auto-propagate search domain value(s) from the
host system&rsquo;s /etc/resolv.conf file.</p>

<p style="margin-top: 1em">--netif_add
ifname[,mac,host_ifname,host_mac,bridge] <br>
Adds a virtual Ethernet device (veth) to a given container.
Here ifname is the Ethernet device name in the container,
mac is its MAC address, host_ifname is the Ethernet <br>
device name on the host, and host_mac is its MAC address.
MAC addresses should be in the format like
XX:XX:XX:XX:XX:XX. bridge is an optional parameter which can
be used in <br>
custom network start scripts to automatically add the
interface to a bridge. All parameters except ifname are
optional and are automatically generated if not
specified.</p>

<p style="margin-top: 1em">--netif_del dev_name | all <br>
Removes virtual Ethernet device from a container. If you
want to remove all devices, use all.</p>

<p style="margin-top: 1em">veth interface configuration</p>

<p style="margin-top: 1em">The following options can be
used to reconfigure the already-created virtual Ethernet
interface. To select the interface to configure, use
--ifname name option.</p>

<p style="margin-top: 1em">--mac XX:XX:XX:XX:XX:XX <br>
MAC address of interface inside a container.</p>

<p style="margin-top: 1em">--host_ifname name <br>
interface name for virtual interface in the host system.</p>

<p style="margin-top: 1em">--host_mac XX:XX:XX:XX:XX:XX
<br>
MAC address of interface in the host system.</p>

<p style="margin-top: 1em">If you want an independent
communication with the Container through the bridge, you
should specify a multicast MAC address here
(FE:FF:FF:FF:FF:FF).</p>

<p style="margin-top: 1em">--bridge name <br>
Bridge name. Custom network start scripts can use this value
to automatically add the interface to a bridge.</p>

<p style="margin-top: 1em">--mac_filter on | off <br>
Enables/disables MAC address filtering for the Container
veth device and the possibility of configuring the MAC
address of this device from inside the Container. If the
<br>
filtering is turned on: <br>
&Acirc;&middot; the veth device accepts only those packets
that have a MAC address in their headers corresponding to
that of this device (excluding all broadcast and multicast
pack&acirc; <br>
ets); <br>
&Acirc;&middot; it is impossible to modify the veth MAC
address from inside the Container.</p>

<p style="margin-top: 1em">By default, this functionality
is enabled for all veth devices existing inside the
Container.</p>

<p style="margin-top: 1em">VSwap limits</p>

<p style="margin-top: 1em">The following options sets
memory and swap limits for VSwap-enabled kernels (kernel
version 042stab042 or greater).</p>

<p style="margin-top: 1em">Argument is in bytes, unless
otherwise specified by an optional suffix. Available
suffixes are:</p>

<p style="margin-top: 1em">&Acirc;&middot; T, t -
terabytes; <br>
&Acirc;&middot; G, g - gigabytes; <br>
&Acirc;&middot; M, m - megabytes; <br>
&Acirc;&middot; K, k - kilobytes; <br>
&Acirc;&middot; P, p - memory pages (arch-specific, usually
4KB); <br>
&Acirc;&middot; B, b - bytes (this is the default).</p>

<p style="margin-top: 1em">--ram bytes <br>
Sets physical memory (RAM) available to a container.
Actually, the option is a shortcut for setting --physpages
limit (the barrier is set to 0).</p>

<p style="margin-top: 1em">--swap bytes <br>
Set swap space available to a container. Actually, the
option is a shortcut for setting --swappages limit (the
barrier is set to 0).</p>

<p style="margin-top: 1em">--vm_overcommit float <br>
Set VM overcommitment value to float. If set, it is used to
calculate privmmpages parameter in case it is not set
explicitly (see below). Default value is 0, meaning <br>
unlimited privvmpages.</p>

<p style="margin-top: 1em">vzctl checks if running kernel
is VSwap capable, and refuses to use these parameters
otherwise. This behavior can be overriden by using --force
flag before parameters.</p>

<p style="margin-top: 1em">In VSwap mode, all beancounters
other than RAM and swap become optional. Note though that if
some optional beancounters are not set, they are calculated
and set by vzctl implic&acirc; <br>
itly, using the following formulae:</p>

<p style="margin-top: 1em">&Acirc;&middot;
lockedpages.barrier = oomguarpages.barrier = ram</p>

<p style="margin-top: 1em">&Acirc;&middot;
lockedpages.limit = oomguarpages.limit = unlimited</p>

<p style="margin-top: 1em">&Acirc;&middot;
vmguarpages.barrier = vmguarpages.limit = ram + swap</p>

<p style="margin-top: 1em">&Acirc;&middot;
privvmpages.barrier = privvmpages.limit = (ram + swap) *
vm_overcommit</p>

<p style="margin-top: 1em">(if vm_overcommit is 0 or not
set, privvmpages is set to &quot;unlimited&quot;)</p>

<p style="margin-top: 1em">Here is an example of setting
container 777 to have 512 megabytes of RAM and 1 gigabyte of
swap: <br>
vzctl set 777 --ram 512M --swap 1G --save</p>

<p style="margin-top: 1em">User Beancounter limits</p>

<p style="margin-top: 1em">The following options sets
barrier and limit for various user beancounters.</p>

<p style="margin-top: 1em">Note that for VSwap-enabled
kernels (version 042stab042 or greater) these limits are
optional, you must only set --ram and --swap (see above).
For older kernels, these limits are <br>
obligatory.</p>

<p style="margin-top: 1em">Each option requires one or two
arguments. In case of one argument, vzctl sets barrier and
limit to the same value. In case of two colon-separated
arguments, the first is a bar&acirc; <br>
rier, and the second is a limit. Each argument is either a
number, a number with a suffix, or a special value
unlimited.</p>

<p style="margin-top: 1em">Arguments are in items, pages or
bytes. Note that page size is architecture-specific, it is
4096 bytes on x86 and x86_64 platforms.</p>

<p style="margin-top: 1em">You can also specify different
suffixes for User Beancounter parameters (except for those
which names start with num). For example, vzctl set CTID
--privvmpages 5M:6M should set <br>
privvmpages&rsquo; barrier to 5 megabytes and its limit to 6
megabytes.</p>

<p style="margin-top: 1em">Available suffixes are:</p>

<p style="margin-top: 1em">&Acirc;&middot; T, t -
terabytes; <br>
&Acirc;&middot; G, g - gigabytes; <br>
&Acirc;&middot; M, m - megabytes; <br>
&Acirc;&middot; K, k - kilobytes; <br>
&Acirc;&middot; P, p - memory pages (arch-specific, usually
4KB); <br>
&Acirc;&middot; B, b - bytes.</p>

<p style="margin-top: 1em">You can also specify the literal
word unlimited in place of a number. In that case the
corresponding value will be set to LONG_MAX, i. e. the
maximum possible value.</p>

<p style="margin-top: 1em">--numproc items[:items] <br>
Maximum number of processes and kernel-level threads.
Setting the barrier and the limit to different values does
not make practical sense.</p>

<p style="margin-top: 1em">--numtcpsock items[:items] <br>
Maximum number of TCP sockets. This parameter limits the
number of TCP connections and, thus, the number of clients
the server application can handle in parallel. Setting <br>
the barrier and the limit to different values does not make
practical sense.</p>

<p style="margin-top: 1em">--numothersock items[:items]
<br>
Maximum number of non-TCP sockets (local sockets, UDP and
other types of sockets). Setting the barrier and the limit
to different values does not make practical sense.</p>

<p style="margin-top: 1em">--vmguarpages pages[:pages] <br>
Memory allocation guarantee. This parameter controls how
much memory is available to a container. The barrier is the
amount of memory that container&rsquo;s applications are
<br>
guaranteed to be able to allocate. The meaning of the limit
is currently unspecified; it should be set to unlimited.</p>

<p style="margin-top: 1em">--kmemsize bytes[:bytes] <br>
Maximum amount of kernel memory used. This parameter is
related to --numproc. Each process consumes certain amount
of kernel memory - 16 KB at least, 30-50 KB typically. <br>
Very large processes may consume a bit more. It is important
to have a certain safety gap between the barrier and the
limit of this parameter: equal barrier and limit may <br>
lead to the situation where the kernel will need to kill
container&rsquo;s applications to keep the kmemsize usage
under the limit.</p>

<p style="margin-top: 1em">--tcpsndbuf bytes[:bytes] <br>
Maximum size of TCP send buffers. Barrier should be not less
than 64 KB, and difference between barrier and limit should
be equal to or more than value of numtcpsock mul&acirc; <br>
tiplied by 2.5 KB.</p>

<p style="margin-top: 1em">--tcprcvbuf bytes[:bytes] <br>
Maximum size of TCP receive buffers. Barrier should be not
less than 64 KB, and difference between barrier and limit
should be equal to or more than value of numtcpsock <br>
multiplied by 2.5 KB.</p>

<p style="margin-top: 1em">--othersockbuf bytes[:bytes]
<br>
Maximum size of other (non-TCP) socket send buffers. If
container&rsquo;s processes needs to send very large
datagrams, the barrier should be set accordingly. Increased
limit <br>
is necessary for high performance of communications through
local (UNIX-domain) sockets.</p>

<p style="margin-top: 1em">--dgramrcvbuf bytes[:bytes] <br>
Maximum size of other (non-TCP) socket receive buffers. If
container&rsquo;s processes needs to receive very large
datagrams, the barrier should be set accordingly. The
differ&acirc; <br>
ence between the barrier and the limit is not needed.</p>

<p style="margin-top: 1em">--oomguarpages pages[:pages]
<br>
Guarantees against OOM kill. Under this beancounter the
kernel accounts the total amount of memory and swap space
used by the container&rsquo;s processes. The barrier of this
<br>
parameter is the out-of-memory guarantee. If the
oomguarpages usage is below the barrier, processes of this
container are guaranteed not to be killed in out-of-memory
sit&acirc; <br>
uations. The meaning of limit is currently unspecified; it
should be set to unlimited.</p>

<p style="margin-top: 1em">--lockedpages pages[:pages] <br>
Maximum number of pages acquired by mlock(2).</p>

<p style="margin-top: 1em">--privvmpages pages[:pages] <br>
Allows controlling the amount of memory allocated by the
applications. For shared (mapped as MAP_SHARED) pages, each
container really using a memory page is charged for <br>
the fraction of the page (depending on the number of others
using it). For &quot;potentially private&quot; pages (mapped
as MAP_PRIVATE), container is charged either for a fraction
<br>
of the size or for the full size if the allocated address
space. In the latter case, the physical pages associated
with the allocated address space may be in memory, in <br>
swap or not physically allocated yet.</p>

<p style="margin-top: 1em">The barrier and the limit of
this parameter control the upper boundary of the total size
of allocated memory. Note that this upper boundary does not
guarantee that con&acirc; <br>
tainer will be able to allocate that much memory. The
primary mechanism to control memory allocation is the
--vmguarpages guarantee.</p>

<p style="margin-top: 1em">--shmpages pages[:pages] <br>
Maximum IPC SHM segment size. Setting the barrier and the
limit to different values does not make practical sense.</p>

<p style="margin-top: 1em">--numfile items[:items] <br>
Maximum number of open files. In most cases the barrier and
the limit should be set to the same value. Setting the
barrier to 0 effectively disables pre-charging
optimiza&acirc; <br>
tion for this beancounter in the kernel, which leads to the
held value being precise but could slightly degrade file
open performance.</p>

<p style="margin-top: 1em">--numflock items[:items] <br>
Maximum number of file locks. Safety gap should be between
barrier and limit.</p>

<p style="margin-top: 1em">--numpty items[:items] <br>
Number of pseudo-terminals (PTY). Note that in OpenVZ each
container can have not more than 255 PTYs. Setting the
barrier and the limit to different values does not make <br>
practical sense.</p>

<p style="margin-top: 1em">--numsiginfo items[:items] <br>
Number of siginfo structures. Setting the barrier and the
limit to different values does not make practical sense.</p>

<p style="margin-top: 1em">--dcachesize bytes[:bytes] <br>
Maximum size of filesystem-related caches, such as directory
entry and inode caches. Exists as a separate parameter to
impose a limit causing file operations to sense mem&acirc;
<br>
ory shortage and return an errno to applications, protecting
from memory shortages during critical operations that should
not fail. Safety gap should be between barrier <br>
and limit.</p>

<p style="margin-top: 1em">--numiptent num[:num] <br>
Number of iptables (netfilter) entries. Setting the barrier
and the limit to different values does not make practical
sense.</p>

<p style="margin-top: 1em">--physpages pages[:pages] <br>
On VSwap-enabled kernels, this limits the amount of physical
memory (RAM) available to a container. The barrier should be
set to 0, and the limit to a total size of RAM <br>
that can be used used by a container.</p>

<p style="margin-top: 1em">For older kernels, this is an
accounting-only parameter, showing the usage of RAM by this
container. Barrier should be set to 0, and limit should be
set to unlimited.</p>

<p style="margin-top: 1em">--swappages pages[:pages] <br>
For VSwap-enabled kernels (042stab042 or greater), this
parameter limits the amount of swap space available to a
container. The barrier should be set to 0, and the limit
<br>
to a total size of swap that can be used by a container.</p>

<p style="margin-top: 1em">For older (pre-VSwap) kernels,
the limit is used to show a total amount of swap space
available inside the container. The barrier of this
parameter is ignored. The default <br>
value is unlimited, meaning total swap will be reported as
0.</p>

<p style="margin-top: 1em">CPU fair scheduler
parameters</p>

<p style="margin-top: 1em">These parameters control CPU
usage by container.</p>

<p style="margin-top: 1em">--cpuunits num <br>
CPU weight for a container. Argument is positive non-zero
number, passed to and used in the kernel fair scheduler. The
larger the number is, the more CPU time this con&acirc; <br>
tainer gets. Maximum value is 500000, minimal is 8. Number
is relative to weights of all the other running containers.
If cpuunits are not specified, default value of <br>
1000 is used.</p>

<p style="margin-top: 1em">You can set CPU weight for CT0
(host system itself) as well (use vzctl set 0 --cpuunits
num). Usually, OpenVZ initscript (/etc/init.d/vz) takes care
of setting this.</p>

<p style="margin-top: 1em">--cpulimit num[%] <br>
Limit of CPU usage for the container, in per cent. Note if
the computer has 2 CPUs, it has total of 200% CPU time.
Default CPU limit is 0 (no CPU limit).</p>

<p style="margin-top: 1em">--cpus num <br>
sets number of CPUs available in the container.</p>

<p style="margin-top: 1em">--cpumask cpus | auto | all <br>
Sets list of allowed CPUs for the container. Input format is
a comma-separated list of decimal numbers and/or ranges.
Consecutively set bits are shown as two hyphen-sep&acirc;
<br>
arated decimal numbers, the smallest and largest bit numbers
set in the range. For example, if you want the container to
execute on CPUs 0, 1, 2, 7, you should pass <br>
0-2,7. Default value is all (the container can execute on
any CPU). If used with the --nodemask option, value of auto
assigns all CPUs from the specified NUMA node to a <br>
container.</p>

<p style="margin-top: 1em">--nodemask nodes | all <br>
Sets list of allowed NUMA nodes for the container. Input
format is the same as for --cpumask. Note that --nodemask
must be used with the --cpumask option.</p>

<p style="margin-top: 1em">Memory output parameters</p>

<p style="margin-top: 1em">For VSwap-enabled kernels
(042stab042 or greater), this parameter is ignored. For
older kernels, it controls the output of /proc/meminfo
inside a container.</p>

<p style="margin-top: 1em">--meminfo none <br>
No /proc/meminfo virtualization (the same as on host
system).</p>

<p style="margin-top: 1em">--meminfo mode:value <br>
Configure total memory output in a container. Reported free
memory is evaluated accordingly to the mode being set.
Reported swap is evaluated according to the settings of <br>
--swappages parameter.</p>

<p style="margin-top: 1em">You can use the following modes
for mode: <br>
&Acirc;&middot; pages:value - sets total memory in pages;
<br>
&Acirc;&middot; privvmpages:value - sets total memory as
privvmpages * value.</p>

<p style="margin-top: 1em">Default is privvmpages:1.</p>

<p style="margin-top: 1em">Netfilter (iptables) control
parameters</p>

<p style="margin-top: 1em">--netfilter
disabled|stateless|stateful|full <br>
Restrict access to netfilter/iptables modules for a
container. This option replaces obsoleted --iptables.</p>

<p style="margin-top: 1em">Note that changing this
parameter requires container restart, so consider using
--setmode option.</p>

<p style="margin-top: 1em">The following arguments can be
used:</p>

<p style="margin-top: 1em">&Acirc;&middot; disabled <br>
no modules are allowed</p>

<p style="margin-top: 1em">&Acirc;&middot; stateless <br>
all modules except NAT and conntracks are allowed (i.e.
filter and mangle); this is the default</p>

<p style="margin-top: 1em">&Acirc;&middot; stateful <br>
all modules except NAT are allowed</p>

<p style="margin-top: 1em">&Acirc;&middot; full all modules
are allowed</p>

<p style="margin-top: 1em">--iptables name[,...] <br>
Note this option is obsoleted, --netfilter should be used
instead.</p>

<p style="margin-top: 1em">Allow to use the functionality
of name iptables module inside the container. Multiple
comma-separated names can be specified.</p>

<p style="margin-top: 1em">The default list of enabled
iptables modules is defined by the IPTABLES variable in
vz.conf(5).</p>

<p style="margin-top: 1em">You can use the following values
for name: iptable_filter, iptable_mangle, ipt_limit,
ipt_multiport, ipt_tos, ipt_TOS, ipt_REJECT, ipt_TCPMSS,
ipt_tcpmss, ipt_ttl, <br>
ipt_LOG, ipt_length, ip_conntrack, ip_conntrack_ftp,
ip_conntrack_irc, ipt_conntrack, ipt_state, ipt_helper,
iptable_nat, ip_nat_ftp, ip_nat_irc, ipt_REDIRECT, xt_mac,
<br>
ipt_recent, ipt_owner.</p>

<p style="margin-top: 1em">Network devices control
parameters</p>

<p style="margin-top: 1em">--netdev_add name <br>
move network device from the host system to a specified
container</p>

<p style="margin-top: 1em">--netdev_del name <br>
delete network device from a specified container</p>

<p style="margin-top: 1em">Disk quota parameters</p>

<p style="margin-top: 1em">--diskquota yes | no <br>
allows to enable or disable disk quota for a container. By
default, a global value (DISK_QUOTA) from vz.conf(5) is
used.</p>

<p style="margin-top: 1em">Note that this parameter is
ignored for ploop layout.</p>

<p style="margin-top: 1em">--diskspace num[:num] <br>
For simfs layout, sets soft and hard disk quota limits.
First parameter is soft limit, second is hard limit.</p>

<p style="margin-top: 1em">For ploop layout, initiates the
procedure of resizing the ploop image file to the new size.
Since there is no soft/hard limit concept in ploop, second
num, if specified, <br>
is ignored.</p>

<p style="margin-top: 1em">By default, ploop resize is done
online, i.e. on a mounted ploop. This is a preferred way of
doing resize. Although, in a rare case a container was using
lots of disk <br>
space and should now be resized to a much smaller size, an
offline resize might be more appropriate. In this case, make
sure the container is stopped and unmounted and <br>
use additional --offline-resize option</p>

<p style="margin-top: 1em">Note that ploop resize is NOT
performed on container start, so for consistency --diskspace
must be used together with --save flag.</p>

<p style="margin-top: 1em">Suffixes G, M, K can also be
specified (see Resource limits section for more info on
suffixes). If suffix is not specified, value is in
kilobytes.</p>

<p style="margin-top: 1em">--diskinodes num[:num] <br>
sets soft and hard disk quota limits, in i-nodes. First
parameter is soft limit, second is hard limit.</p>

<p style="margin-top: 1em">Note that this parameter is
ignored for ploop layout.</p>

<p style="margin-top: 1em">--quotatime seconds <br>
sets quota grace period. Container is permitted to exceed
its soft limits for the grace period, but once it has
expired, the soft limit is enforced as a hard limit.</p>

<p style="margin-top: 1em">Note that this parameter is
ignored for ploop layout.</p>

<p style="margin-top: 1em">--quotaugidlimit num <br>
Enables or disables in-container per-user and per-group disk
quotas. If the value is set to 0 or not set, disk quotas
inside the container is disabled and not accounted.</p>

<p style="margin-top: 1em">For simfs layout containers,
non-zero value sets maximum number of user/group IDs for
which disk quota is accounted.</p>

<p style="margin-top: 1em">For ploop layout containers, any
non-zero value enables disk quota inside the container; the
number of user/group IDs used by disk quota is not limited
by OpenVZ.</p>

<p style="margin-top: 1em">Note that enabling or disabling
in-container disk quotas requires container restart, so
consider using --setmode option.</p>

<p style="margin-top: 1em">Capability option</p>

<p style="margin-top: 1em">--capability
capname:on|off[,...] <br>
Sets a capability for a container. Multiple comma-separated
capabilities can be specified.</p>

<p style="margin-top: 1em">Note that setting a capability
when the container is running does not take immediate
effect; restart the container in order for the changes to
take effect (consider using <br>
--setmode option).</p>

<p style="margin-top: 1em">A container has the default set
of capabilities, thus any operation on capabilities is
&quot;logical AND&quot; with the default capability
mask.</p>

<p style="margin-top: 1em">You can use the following values
for capname: chown, dac_override, dac_read_search, fowner,
fsetid, kill, setgid, setuid, setpcap, linux_immutable,
net_bind_service, <br>
net_broadcast, net_admin, net_raw, ipc_lock, ipc_owner,
sys_module, sys_rawio, sys_chroot, sys_ptrace, sys_pacct,
sys_admin, sys_boot, sys_nice, sys_resource, sys_time, <br>
sys_tty_config, mknod, lease, setveid, ve_admin. For
detailed description, see capabilities(7).</p>

<p style="margin-top: 1em">WARNING: setting some of those
capabilities may have far reaching security implications, so
do not do it unless you know what you are doing. Also note
that setting setp&acirc; <br>
cap:on for a container will most probably lead to inability
to start it.</p>

<p style="margin-top: 1em">Device access management</p>

<p style="margin-top: 1em">--devnodes device:[r][w][q]|none
<br>
Give the container an access (r - read, w - write, q - disk
quota management, none - no access) to a device designated
by the special file /dev/device. Device file is cre&acirc;
<br>
ated in a container by vzctl. Example: <br>
vzctl set 777 --devnodes sdb:rwq</p>

<p style="margin-top: 1em">--devices
b|c:major:minor|all:[r][w][q]|none <br>
Give the container an access to a block or character device
designated by its major and minor numbers. Device file have
to be created manually.</p>

<p style="margin-top: 1em">PCI device management</p>

<p style="margin-top: 1em">--pci_add [domain:]bus:slot.func
<br>
Give the container an access to a specified PCI device. All
numbers are hexadecimal (as printed by lspci(8) in the first
column).</p>

<p style="margin-top: 1em">--pci_del [domain:]bus:slot.func
<br>
Delete a PCI device from the container.</p>

<p style="margin-top: 1em">Note that vps-pci configuration
script is executed by vzctl then configuring PCI devices.
The script is usually located at
/usr/libexec/vzctl/scripts/.</p>

<p style="margin-top: 1em">Features management</p>

<p style="margin-top: 1em">--features name:on|off[,...]
<br>
Enable or disable a specific container feature. Known
features are: sysfs, nfs, sit, ipip, ppp, ipgre, bridge,
nfsd. A few features can be specified at once,
comma-sepa&acirc; <br>
rated.</p>

<p style="margin-top: 1em">Apply config</p>

<p style="margin-top: 1em">--applyconfig name <br>
Read container parameters from the container sample
configuration file /etc/vz/conf/ve-name.conf-sample, and
apply them, if --save option specified save to the container
<br>
config file. The following parameters are not changed:
HOSTNAME, IP_ADDRESS, OSTEMPLATE, VE_ROOT, and
VE_PRIVATE.</p>

<p style="margin-top: 1em">--applyconfig_map group <br>
Apply container config parameters selected by group. Now the
only possible value for group is name: to restore container
name based on NAME variable in container configu&acirc; <br>
ration file.</p>

<p style="margin-top: 1em">I/O scheduling</p>

<p style="margin-top: 1em">--ioprio priority <br>
Assigns disk I/O priority to container. Priority range is
0-7. The greater priority is, the more time for I/O activity
container has. By default each container has pri&acirc; <br>
ority of 4.</p>

<p style="margin-top: 1em">--iolimit limit[B|K|M|G] <br>
Assigns disk I/O bandwidth limit for a container. Value is
either a number with an optional suffix, or a literal string
unlimited. Value of 0 means &quot;unlimited&quot;. By <br>
default a container has no I/O limit. Maximum allowed limit
is 2 gigabytes per second; values exceeding the limit are
truncated.</p>

<p style="margin-top: 1em">If no suffix is provided, the
limit is assumed to be in megabytes per second. Available
suffixes are: <br>
&Acirc;&middot; b, B -- bytes per second; <br>
&Acirc;&middot; k, K -- kilobytes per second; <br>
&Acirc;&middot; m, M -- megabytes per second (default); <br>
&Acirc;&middot; g, G -- gigabytes per second;</p>

<p style="margin-top: 1em">--iopslimit iops <br>
Assigns IOPS limit for a container, in number of
input/output operations per second. Value is a number or a
literal string unlimited. Value of 0 means
&quot;unlimited&quot;. By <br>
default a container has no IOPS limit.</p>

<p style="margin-top: 1em">Suspending and resuming <br>
Checkpointing is a feature of OpenVZ kernel which allows to
save a complete in-kernel state of a running container, and
to restore it later.</p>

<p style="margin-top: 1em">suspend|chkpnt CTID [--dumpfile
name] <br>
This command suspends a container to a dump file If an
option --dumpfile is not set, default dump file name
/var/lib/vz/dump/Dump.CTID is used.</p>

<p style="margin-top: 1em">resume|restore CTID [--dumpfile
name] <br>
This command restores a container from the dump file created
by the suspend command.</p>

<p style="margin-top: 1em">Snapshotting <br>
Snapshotting is a feature based on checkpointing and ploop
shapshots. It allows to save a complete state of container
file system. Plus, if the container is running, it&rsquo;s
in- <br>
memory state (as in checkpointing). Note that snapshot
functionality is only working for containers on ploop
device.</p>

<p style="margin-top: 1em">snapshot CTID [--id uuid]
[--name name] [--description desc] [--skip-suspend]
[--skip-config] <br>
Creates a container snapshot, i.e. saves the current
container state, including its file system state, running
processes state, and configuration file.</p>

<p style="margin-top: 1em">If a container is running, and
--skip-suspend option is not specified, a container is
checkpointed and then restored, and CT memory dump becomes
the part of snapshot.</p>

<p style="margin-top: 1em">Unless --skip-config option is
given, container configuration file is saved to the
snapshot.</p>

<p style="margin-top: 1em">If uuid is not specified, it is
auto-generated. Options --name and --description can be used
to specify the snapshot name and description, respectively.
Name is displayed by <br>
snapshot-list.</p>

<p style="margin-top: 1em">snapshot-switch CTID
[--skip-resume | --must-resume] [--skip-config] --id uuid
<br>
Switches the container to a snapshot identified by uuid,
restoring its file system state, configuration (if
available) and its running state (if available).</p>

<p style="margin-top: 1em">Note that the current state of a
container (including its file system state and its
configuration file) is lost!</p>

<p style="margin-top: 1em">Option --skip-resume is used to
ignore a CT memory dump file in a snapshot, as a result the
container will end up being in a stopped state (same as if a
snapshot has been <br>
taken with --skip-suspend).</p>

<p style="margin-top: 1em">If option --must-resume is set,
absense of a memory dump is treated as an error, and the
inability to restore from the memory dump is treated as an
error rather than warning.</p>

<p style="margin-top: 1em">Option option --skip-config is
used to ignore the CT configuration file in a snapshot, i.e.
the current configuration file will be left as is.</p>

<p style="margin-top: 1em">snapshot-delete CTID --id uuid
<br>
Removes a specified snapshot.</p>

<p style="margin-top: 1em">snapshot-mount CTID --id uuid
--target directory <br>
Mounts a snapshot specified by uuid to a directory. Note
this mount is read-only.</p>

<p style="margin-top: 1em">snapshot-umount CTID --id uuid
<br>
Unmounts a specified snapshot.</p>

<p style="margin-top: 1em">snapshot-list CTID [-H] [-o
field[,field...] [--id uuid] <br>
List container&rsquo;s snapshots.</p>

<p style="margin-top: 1em">You can suppress displaying
header using -H option.</p>

<p style="margin-top: 1em">You can use the -o option to
display only the specified field(s). List of available
fields can be obtained using -L option.</p>

<p style="margin-top: 1em">Performing container actions
<br>
create CTID [--ostemplate name] [--config name] [--layout
simfs|ploop[:{expanded|plain|raw}]] [--diskspace kbytes]
[--diskinodes num] [--private path] [--root path] <br>
[--ipadd addr] [--hostname name] [--name name] [--local_uid
uid] [--local_gid gid]</p>

<p style="margin-top: 1em">Creates a new container area.
This operation should be done once, before the first start
of the container.</p>

<p style="margin-top: 1em">By default, an OS template
denoted by DEF_OSTEMPLATE parameter of vz.conf(5) is used to
create a container. This can be overwritten by --ostemplate
option.</p>

<p style="margin-top: 1em">By default, a new container
configuration file is created from a sample configuration
denoted by value of CONFIGFILE parameter of vz.conf(5). If
the container configuration <br>
file already exists, it will not be modified.</p>

<p style="margin-top: 1em">The value of CONFIGFILE can be
overwritten by using the --config name option. This option
can not be used if the container configuration file already
exists.</p>

<p style="margin-top: 1em">A new container can either be
created using simfs filesystem or on a ploop device. The
default is set by value of VE_LAYOUT parameter of vz.conf(5)
and can be overwritten by <br>
--layout option. In case ploop is used, one can additionally
specify ploop disk image format after a colon. Possible
ploop formats are expanded, plain and raw. Default is <br>
expanded. Using value other than expanded is not recommended
and is currently not supported.</p>

<p style="margin-top: 1em">You can use --diskspace and
--diskinodes options to specify container file system size.
Note that for ploop layout, you will not be able to change
inodes value later.</p>

<p style="margin-top: 1em">If DISKSPACE is not specified
either in the sample configuration file used for creation or
in global configuration file vz.conf(5), --diskspace
parameter is required for <br>
ploop layout.</p>

<p style="margin-top: 1em">Suffixes G, M, K can also be
specified (see Resource limits section for more info on
suffixes).</p>

<p style="margin-top: 1em">You can use --root path option
to sets the path to the mount point for the container root
directory (default is VE_ROOT specified in vz.conf(5) file).
Argument can contain <br>
literal string $VEID, which will be substituted with the
numeric CT ID.</p>

<p style="margin-top: 1em">You can use --private path
option to set the path to directory in which all the files
and directories specific to this very container are stored
(default is VE_PRIVATE speci&acirc; <br>
fied in vz.conf(5) file). Argument can contain literal
string $VEID, which will be substituted with the numeric CT
ID.</p>

<p style="margin-top: 1em">You can use --ipadd addr option
to assign an IP address to a container. Note that this
option can be used multiple times.</p>

<p style="margin-top: 1em">You can use --hostname name
option to set a host name for a container.</p>

<p style="margin-top: 1em">When running with an upstream
Linux Kernel that supports user namespaces (&gt;= 3.8), the
parameters --local_uid and --local_gid can be used to select
which uid and gid respec&acirc; <br>
tively will be used as a base user in the host system. Note
that user namespaces provide a 1:1 mapping between container
users and host users. If these options are not speci&acirc;
<br>
fied, the values LOCAL_UID and LOCAL_GID from global
configuration file vz.conf(5) are used. An explicit
--local_uid value of 0 will disable user namespace support,
and run <br>
the container as a privileged user. In this case,
--local_gid is ignored.</p>

<p style="margin-top: 1em">Warning: use --local_uid and
--local_gid with care, specially when migrating containers.
In all situations, the container&rsquo;s files in the
filesystem needs to be correctly <br>
owned by the host-side users.</p>

<p style="margin-top: 1em">destroy | delete CTID <br>
Removes a container private area by deleting all files,
directories and the configuration file of this
container.</p>

<p style="margin-top: 1em">start CTID [--wait] [--force]
[--skip-fsck] [--skip-remount] <br>
Mounts (if necessary) and starts a container. Unless --wait
option is specified, vzctl will return immediately;
otherwise an attempt to wait till the default runlevel is
<br>
reached will be made by vzctl.</p>

<p style="margin-top: 1em">Specify --force if you want to
start a container which is disabled (see --disabled).</p>

<p style="margin-top: 1em">Specify --skip-fsck to skip fsck
for ploop-based container filesystem (this option is used by
vz initscript).</p>

<p style="margin-top: 1em">By default, if a container to be
started happens to be already mounted, it is unmounted and
mounted again. This behavior can be turned off by using
--skip-remount flag.</p>

<p style="margin-top: 1em">Note that this command can lead
to execution of premount, mount and start action scripts
(see ACTION SCRIPTS below).</p>

<p style="margin-top: 1em">stop CTID [--fast]
[--skip-umount] <br>
Stops a container and unmounts it (unless --skip-umount is
given). Normally, halt(8) is executed inside a container;
option --fast makes vzctl use reboot(2) syscall instead <br>
which is faster but can lead to unclean container
shutdown.</p>

<p style="margin-top: 1em">Note that vzctl stop is not
asyncronous, in other words vzctl waits for
container&rsquo;s init to exit (unless --fast is given),
which can take up to a few minutes. Default wait <br>
timeout is 120 seconds; it can be changed globally, by
setting STOP_TIMEOUT in vz.conf(5), or per container
(STOP_TIMEOUT in ctid.conf(5), see --stop-timeout).</p>

<p style="margin-top: 1em">Note that this command can lead
to execution of stop, umount and postumount action scripts
(see ACTION SCRIPTS below).</p>

<p style="margin-top: 1em">restart CTID [--wait] [--force]
[--fast] [--skip-fsck] <br>
Restarts a container, i.e. stops it if it is running, and
starts again. Accepts all the start and stop options.</p>

<p style="margin-top: 1em">Note that this command can lead
to execution of some action scripts (see ACTION SCRIPTS
below).</p>

<p style="margin-top: 1em">status CTID <br>
Shows a container status. This is a line with five or six
words, separated by spaces.</p>

<p style="margin-top: 1em">First word is literally
CTID.</p>

<p style="margin-top: 1em">Second word is the numeric CT
ID.</p>

<p style="margin-top: 1em">Third word is showing whether
this container exists or not, it can be either exist or
deleted.</p>

<p style="margin-top: 1em">Fourth word is showing the
status of the container filesystem, it can be either mounted
or unmounted.</p>

<p style="margin-top: 1em">Fifth word shows if the
container is running, it can be either running or down.</p>

<p style="margin-top: 1em">Sixth word, if exists, is
suspended. It appears if a dump file exists for a stopped
container (see suspend).</p>

<p style="margin-top: 1em">This command can also be usable
from scripts.</p>

<p style="margin-top: 1em">mount CTID <br>
Mounts container private area. Note that this command can
lead to execution of premount and mount action scripts (see
ACTION SCRIPTS below).</p>

<p style="margin-top: 1em">umount CTID <br>
Unmounts container private area. Note that this command can
lead to execution of umount and postumount action scripts
(see ACTION SCRIPTS below).</p>

<p style="margin-top: 1em">Note that stop does umount
automatically.</p>

<p style="margin-top: 1em">convert CTID [--layout
ploop[:{expanded|plain|raw}]] <br>
Convert CT private area to reside on a ploop device
(available in kernel version 042stab052.8 and greater).
Conversion should be performed when a container is stopped,
plus <br>
disk space quota should be set.</p>

<p style="margin-top: 1em">compact CTID <br>
Compact container image. This only makes sense for ploop
layout.</p>

<p style="margin-top: 1em">quotaon CTID <br>
Turn disk quota on. Not that mount and start does that
automatically.</p>

<p style="margin-top: 1em">quotaoff CTID <br>
Turn disk quota off. Not that umount and stop does that
automatically.</p>

<p style="margin-top: 1em">quotainit CTID <br>
Initialize disk quota (i.e. run vzquota init) with the
parameters taken from the CT configuration file
ctid.conf(5).</p>

<p style="margin-top: 1em">exec CTID command <br>
Executes command in a container. Environment variables are
not set inside the container. Signal handlers may differ
from default settings. If command is -, commands are read
<br>
from stdin.</p>

<p style="margin-top: 1em">exec2 CTID command <br>
The same as exec, but return code is that of command.</p>

<p style="margin-top: 1em">runscript CTID script <br>
Run specified shell script in the container. Argument script
is a file on the host system which contents is read by vzctl
and executed in the context of the container. For a <br>
running container, the command jumps into the container and
executes the script. For a stopped container, it enters the
container, mounts container&rsquo;s root filesystem,
exe&acirc; <br>
cutes the script, and unmounts CT root. In the latter case,
the container is not really started, no file systems other
than root (such as /proc) are mounted, no startup <br>
scripts are executed etc. Thus the environment in which the
script is running is far from normal and is only usable for
very basic operations.</p>

<p style="margin-top: 1em">enter CTID [--exec command [arg
...]] <br>
Enters into a container (giving a container&rsquo;s root
shell). This option is a back-door for host root only. The
proper way to have CT root shell is to use ssh(1).</p>

<p style="margin-top: 1em">Option --exec is used to run
command with arguments after entering into container. This
is useful if command to be run requires a terminal (so vzctl
exec can not be used) and <br>
for some reason you can not use ssh(1).</p>

<p style="margin-top: 1em">You need to log out manually
from the shell to finish session (even if you specified
--exec).</p>

<p style="margin-top: 1em">console CTID [ttynum] <br>
Attach to a container console. Optional ttynum argument is
tty number (such as 4 for tty4), default is 1 which is used
for container&rsquo;s /dev/console.</p>

<p style="margin-top: 1em">Note the consoles are
persistent, meaning that: <br>
&Acirc;&middot; it can be attached to even if the container
is not running; <br>
&Acirc;&middot; there is no automatic detachment upon the
container stop; <br>
&Acirc;&middot; detaching from the console leaves anything
running in this console as is.</p>

<p style="margin-top: 1em">The following escape sequences
are recognized by vzctl console. Note that these sequences
are only recognized at the beginning of a line.</p>

<p style="margin-top: 1em">&Acirc;&middot; Esc then . to
detach from the console.</p>

<p style="margin-top: 1em">&Acirc;&middot; Esc then ! to
kill anything running on the console (SAK). This is helpful
when one expects a login prompt but there isn&rsquo;t
one.</p>

<p style="margin-top: 1em">Other options <br>
--help <br>
Prints help message with a brief list of possible
options.</p>

<p style="margin-top: 1em">--version <br>
Prints vzctl version.</p>

<p style="margin-top: 1em">ACTION SCRIPTS <br>
vzctl has an ability to execute user-defined scripts when a
specific vzctl command is run for a container. The following
vzctl commands can trigger execution of action scripts: <br>
start, stop, restart, mount and umount.</p>

<p style="margin-top: 1em">Action scripts are located in
the /etc/vz/conf/ directory. There are global and per-CT
scripts. Global scripts have a literal prefix of vps. and
are executed for all containers. <br>
Per-CT scripts have a CTID. numeric prefix and are executed
for the given container only.</p>

<p style="margin-top: 1em">Please note scripts are executed
in a host system (CT0) context, with the exception of .start
and .stop scripts, which are executed in a container
context.</p>

<p style="margin-top: 1em">The following action scripts are
currently defined:</p>

<p style="margin-top: 1em">vps.premount, CTID.premount <br>
Global and per-CT mount scripts which are executed for a
container before it is mounted. Scripts are executed in the
host system context, while a CT is not yet mounted or <br>
running. Global script, if exists, is executed first.</p>

<p style="margin-top: 1em">vps.mount, CTID.mount <br>
Global and per-CT mount scripts which are executed for a
container right after it is mounted. Otherwise they are the
same as .premount scripts.</p>

<p style="margin-top: 1em">CTID.start <br>
Right after vzctl has started a container, it executes this
script in a container context.</p>

<p style="margin-top: 1em">CTID.stop <br>
Right before vzctl has stopped a container, it executes this
script in a container context.</p>

<p style="margin-top: 1em">vps.umount, CTID.umount <br>
Global and per-CT umount scripts which are executed for a
container before it is unmounted. Scripts are executed in
the host system context, while a CT is mounted. Global <br>
script, if exists, is executed first.</p>

<p style="margin-top: 1em">vps.postumount, CTID.postumount
<br>
Global and per-CT umount scripts which are executed for a
container right after it is unmounted. Otherwise they are
the same as .umount scripts.</p>

<p style="margin-top: 1em">The environment passed to all
the *mount scripts is the standard environment of the parent
(i.e. vzctl) with two additional variables: $VEID and
$VE_CONFFILE. The first one holds <br>
the ID of the container, and the second one holds the full
path to the container configuration file. If the script
needs to get other CT configuration parameters, such as <br>
$VE_ROOT, it needs to get those from global and per-CT
configuration files.</p>

<p style="margin-top: 1em">Here is an example of a mount
script, which makes host system&rsquo;s /mnt/disk available
to container(s). Script name can either be
/etc/vz/conf/vps.mount or /etc/vz/conf/CTID.mount.</p>

<p style="margin-top: 1em"># If one of these files does not
exist then something <br>
# is really broken <br>
[ -f /etc/vz/vz.conf ] || exit 1 <br>
[ -f $VE_CONFFILE ] || exit 1 <br>
# Source both files. Note the order is important. <br>
. /etc/vz/vz.conf <br>
. $VE_CONFFILE <br>
SRC=/mnt/disk <br>
DST=/mnt/disk <br>
mount -n -t simfs $SRC ${VE_ROOT}${DST} -o $SRC</p>

<p style="margin-top: 1em">EXIT STATUS <br>
Returns 0 upon success, or an appropriate error code in case
of an error:</p>

<p style="margin-top: 1em">1 Failed to set a UBC
parameter</p>

<p style="margin-top: 1em">2 Failed to set a fair scheduler
parameter</p>

<p style="margin-top: 1em">3 Generic system error</p>

<p style="margin-top: 1em">5 The running kernel is not an
OpenVZ kernel (or some OpenVZ modules are not loaded)</p>

<p style="margin-top: 1em">6 Not enough system
resources</p>

<p style="margin-top: 1em">7 ENV_CREATE ioctl failed</p>

<p style="margin-top: 1em">8 Command executed by vzctl exec
returned non-zero exit code</p>

<p style="margin-top: 1em">9 Container is locked by another
vzctl invocation</p>

<p style="margin-top: 1em">10 Global OpenVZ configuration
file vz.conf(5) not found</p>

<p style="margin-top: 1em">11 A vzctl helper script file
not found</p>

<p style="margin-top: 1em">12 Permission denied</p>

<p style="margin-top: 1em">13 Capability setting failed</p>

<p style="margin-top: 1em">14 Container configuration file
ctid.conf(5) not found</p>

<p style="margin-top: 1em">15 Timeout on vzctl exec</p>

<p style="margin-top: 1em">16 Error during vzctl
suspend</p>

<p style="margin-top: 1em">17 Error during vzctl resume</p>

<p style="margin-top: 1em">18 Error from setluid()
syscall</p>

<p style="margin-top: 1em">20 Invalid command line
parameter</p>

<p style="margin-top: 1em">21 Invalid value for command
line parameter</p>

<p style="margin-top: 1em">22 Container root directory
(VE_ROOT) not set</p>

<p style="margin-top: 1em">23 Container private directory
(VE_PRIVATE) not set</p>

<p style="margin-top: 1em">24 Container template directory
(TEMPLATE) not set</p>

<p style="margin-top: 1em">28 Not all required UBC
parameters are set, unable to start container</p>

<p style="margin-top: 1em">29 OS template is not specified,
unable to create container</p>

<p style="margin-top: 1em">31 Container not running</p>

<p style="margin-top: 1em">32 Container already running</p>

<p style="margin-top: 1em">33 Unable to stop container</p>

<p style="margin-top: 1em">34 Unable to add IP address to
container</p>

<p style="margin-top: 1em">40 Container not mounted</p>

<p style="margin-top: 1em">41 Container already mounted</p>

<p style="margin-top: 1em">43 Container private area not
found</p>

<p style="margin-top: 1em">44 Container private area
already exists</p>

<p style="margin-top: 1em">46 Not enough disk space</p>

<p style="margin-top: 1em">47 Bad/broken container
(/sbin/init or /bin/sh not found)</p>

<p style="margin-top: 1em">48 Unable to create a new
container private area</p>

<p style="margin-top: 1em">49 Unable to create a new
container root area</p>

<p style="margin-top: 1em">50 Unable to mount container</p>

<p style="margin-top: 1em">51 Unable to unmount
container</p>

<p style="margin-top: 1em">52 Unable to delete a
container</p>

<p style="margin-top: 1em">53 Container private area not
exist</p>

<p style="margin-top: 1em">60 vzquota on failed</p>

<p style="margin-top: 1em">61 vzquota init failed</p>

<p style="margin-top: 1em">62 vzquota setlimit failed</p>

<p style="margin-top: 1em">63 Parameter DISKSPACE not
set</p>

<p style="margin-top: 1em">64 Parameter DISKINODES not
set</p>

<p style="margin-top: 1em">65 Error setting in-container
disk quotas</p>

<p style="margin-top: 1em">66 vzquota off failed</p>

<p style="margin-top: 1em">67 ugid quota not
initialized</p>

<p style="margin-top: 1em">71 Incorrect IP address
format</p>

<p style="margin-top: 1em">74 Error changing password</p>

<p style="margin-top: 1em">78 IP address already in use</p>

<p style="margin-top: 1em">79 Container action script
returned an error</p>

<p style="margin-top: 1em">82 Config file copying error</p>

<p style="margin-top: 1em">86 Error setting devices
(--devices or --devnodes)</p>

<p style="margin-top: 1em">89 IP address not available</p>

<p style="margin-top: 1em">91 OS template not found</p>

<p style="margin-top: 1em">99 Ploop is not supported by
either the running kernel or vzctl.</p>

<p style="margin-top: 1em">100 Unable to find container IP
address</p>

<p style="margin-top: 1em">104 VE_NETDEV ioctl error</p>

<p style="margin-top: 1em">105 Container start disabled</p>

<p style="margin-top: 1em">106 Unable to set iptables on a
running container</p>

<p style="margin-top: 1em">107 Distribution-specific
configuration file not found</p>

<p style="margin-top: 1em">109 Unable to apply a config</p>

<p style="margin-top: 1em">129 Unable to set meminfo
parameter</p>

<p style="margin-top: 1em">130 Error setting veth
interface</p>

<p style="margin-top: 1em">131 Error setting container
name</p>

<p style="margin-top: 1em">133 Waiting for container start
failed</p>

<p style="margin-top: 1em">139 Error saving container
configuration file</p>

<p style="margin-top: 1em">148 Error setting container IO
parameters (ioprio)</p>

<p style="margin-top: 1em">150 Ploop image file not
found</p>

<p style="margin-top: 1em">151 Error creating ploop
image</p>

<p style="margin-top: 1em">152 Error mounting ploop
image</p>

<p style="margin-top: 1em">153 Error unmounting ploop
image</p>

<p style="margin-top: 1em">154 Error resizing ploop
image</p>

<p style="margin-top: 1em">155 Error converting container
to ploop layout</p>

<p style="margin-top: 1em">156 Error creating ploop
snapshot</p>

<p style="margin-top: 1em">157 Error merging ploop
snapshot</p>

<p style="margin-top: 1em">158 Error deleting ploop
snapshot</p>

<p style="margin-top: 1em">159 Error switching ploop
snapshot</p>

<p style="margin-top: 1em">166 Error compacting ploop
image</p>

<p style="margin-top: 1em">167 Error listing ploop
snapsots</p>

<p style="margin-top: 1em">EXAMPLES <br>
To create and start &quot;basic&quot; container with ID of
1000 using centos-5 OS template and IP address of
192.168.10.200:</p>

<p style="margin-top: 1em">vzctl create 1000 --ostemplate
centos-5 --config basic <br>
vzctl set 1000 --ipadd 192.168.10.200 --save <br>
vzctl start 1000</p>

<p style="margin-top: 1em">To set number of processes
barrier/limit to 80/100, and PTY barrier/limit to 16/20
PTYs:</p>

<p style="margin-top: 1em">vzctl set 1000 --numproc 80:100
-t 16:20 --save</p>

<p style="margin-top: 1em">To execute command ls -la in
this container:</p>

<p style="margin-top: 1em">vzctl exec 1000 /bin/ls -la</p>

<p style="margin-top: 1em">To execute command pipe ls -l /
| sort in this container:</p>

<p style="margin-top: 1em">vzctl exec 1000 &rsquo;ls -l / |
sort&rsquo;</p>

<p style="margin-top: 1em">To enter this container and
execute command apt-get install vim:</p>

<p style="margin-top: 1em">vzctl enter 1000 --exec apt-get
install vim</p>

<p style="margin-top: 1em">Note that in the above example
you will need to log out from the container&rsquo;s shell
after apt-get finishes.</p>

<p style="margin-top: 1em">To enter this container, execute
command apt-get install vim and logout after successful
installation (or stay inside the container if installation
process failed) use &amp;&amp;:</p>

<p style="margin-top: 1em">vzctl enter 1000 --exec
&quot;apt-get install vim &amp;&amp; logout&quot;</p>

<p style="margin-top: 1em">To enter this container, execute
command apt-get install vim and logout independently of exit
code of installation process use ;:</p>

<p style="margin-top: 1em">vzctl enter 1000 --exec
&quot;apt-get install vim ; logout&quot;</p>

<p style="margin-top: 1em">Note that you need to quote the
command if you use &amp;&amp; or ;.</p>

<p style="margin-top: 1em">To stop this container:</p>

<p style="margin-top: 1em">vzctl stop 1000</p>

<p style="margin-top: 1em">To permanently remove this
container:</p>

<p style="margin-top: 1em">vzctl destroy 1000</p>

<p style="margin-top: 1em">FILES <br>
/etc/vz/vz.conf <br>
/etc/vz/conf/CTID.conf <br>
/etc/vz/conf/vps.{premount,mount,umount,postumount} <br>

/etc/vz/conf/CTID.{premount,mount,start,stop,umount,postumount}
<br>
/proc/vz/veinfo <br>
/proc/vz/vzquota <br>
/proc/user_beancounters <br>
/proc/bc/* <br>
/proc/fairsched</p>

<p style="margin-top: 1em">SEE ALSO <br>
vz.conf(5), ctid.conf(5), arpsend(8), vzcalc(8),
vzcfgvalidate(8), vzcpucheck(8), vzifup-post(8), vzlist(8),
vzmemcheck(8), vzmigrate(8), vzpid(8), vzquota(8),
vzsplit(8), <br>
vzubc(8), http://wiki.openvz.org/UBC.</p>

<p style="margin-top: 1em">LICENSE <br>
Copyright (C) 2000-2013, Parallels, Inc. Licensed under GNU
GPL.</p>

<p style="margin-top: 1em">OpenVZ 3 Jul 2014 vzctl(8)</p>
<hr>
</body>
</html>
