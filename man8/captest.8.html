<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>CAPTEST:(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">CAPTEST:(8)</td>
    <td class="head-vol">System Administration Utilities</td>
    <td class="head-rtitle">CAPTEST:(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
captest - a program to demonstrate capabilities
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>captest [ --drop-all | --drop-caps | --id ] [ --lock ] [ --text ]</b>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>captest</b> is a program that demonstrates and prints out the current process
  capabilities. Each option prints the same report. It will output current
  capabilities. then it will try to access /etc/shadow directly to show if that
  can be done. Then it creates a child process that attempts to read /etc/shadow
  and outputs the results of that. Then it outputs the capabilities that a child
  process would have.
<div style="height: 1.00em;">&#x00A0;</div>
You can also apply file system capabilities to this program to study how they
  work. For example, filecap /usr/bin/captest chown. Then run captest as a
  normal user. Another interesting test is to make captest suid root so that you
  can see what the interaction is between root's credentials and capabilities.
  For example, chmod 4755 /usr/bin/captest. When run as a normal user, the
  program will see if privilege escalation is possible. But do not leave this
  app setuid root after you are don testing so that an attacker cannot take
  advantage of it.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--drop-all</b></dt>
  <dd class="It-tag">This drops all capabilities and clears the bounding
    set.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--drop-caps</b></dt>
  <dd class="It-tag">This drops just traditional capabilities.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--id</b></dt>
  <dd class="It-tag">This changes to uid and gid 99, drops supplemental groups,
      and clears the bounding set.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--text</b></dt>
  <dd class="It-tag">This option outputs the effective capabilities in text
      rather than numerically.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--lock</b></dt>
  <dd class="It-tag">This prevents the ability for child processes to regain
      privileges if the uid is 0.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>filecap</b>(8), <b>capabilities</b>(7)
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Steve Grubb</div>
<table class="foot">
  <tr>
    <td class="foot-date">June 2009</td>
    <td class="foot-os">Red Hat</td>
  </tr>
</table>
</body>
</html>
