<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:11:12 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>MTREE(8) BSD System Manager&rsquo;s Manual MTREE(8)</p>

<p style="margin-top: 1em">NAME <br>
mtree &acirc; map a directory hierarchy</p>

<p style="margin-top: 1em">SYNOPSIS <br>
mtree [-LPUcdeinqruxw] [-f spec] [-K keywords] [-k keywords]
[-p path] [-s seed] [-X exclude-list]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
The mtree utility compares the file hierarchy rooted in the
current directory against a specification read from the
standard input. Messages are written to the standard output
for <br>
any files whose characteristics do not match the
specifications, or which are missing from either the file
hierarchy or the specification.</p>

<p style="margin-top: 1em">The options are as follows:</p>

<p style="margin-top: 1em">-L Follow all symbolic links in
the file hierarchy.</p>

<p style="margin-top: 1em">-P Do not follow symbolic links
in the file hierarchy, instead consider the symbolic link
itself in any comparisons. This is the default.</p>

<p style="margin-top: 1em">-U Modify the owner, group,
permissions, and modification time of existing files to
match the specification and create any missing directories
or symbolic links. User, group <br>
and permissions must all be specified for missing
directories to be created. Corrected mismatches are not
considered errors.</p>

<p style="margin-top: 1em">-c Print a specification for the
file hierarchy to the standard output.</p>

<p style="margin-top: 1em">-d Ignore everything except
directory type files.</p>

<p style="margin-top: 1em">-e Do not complain about files
that are in the file hierarchy, but not in the
specification.</p>

<p style="margin-top: 1em">-i Indent the output 4 spaces
each time a directory level is descended when creating a
specification with the -c option. This does not affect
either the /set statements or the <br>
comment before each directory. It does however affect the
comment before the close of each directory.</p>

<p style="margin-top: 1em">-n Do not emit pathname comments
when creating a specification. Normally a comment is emitted
before each directory and before the close of that directory
when using the -c <br>
option.</p>

<p style="margin-top: 1em">-q Quiet mode. Do not complain
when a &acirc;missing&acirc; directory cannot be created
because it already exists. This occurs when the directory is
a symbolic link.</p>

<p style="margin-top: 1em">-r Remove any files in the file
hierarchy that are not described in the specification.</p>

<p style="margin-top: 1em">-u Same as -U except a status of
2 is returned if the file hierarchy did not match the
specification.</p>

<p style="margin-top: 1em">-w Make some errors non-fatal
warnings.</p>

<p style="margin-top: 1em">-x Do not descend below mount
points in the file hierarchy.</p>

<p style="margin-top: 1em">-f file <br>
Read the specification from file, instead of from the
standard input.</p>

<p style="margin-top: 1em">If this option is specified
twice, the two specifications are compared to each other
rather than to the file hierarchy. The specifications will
be sorted like output gener&acirc; <br>
ated using -c. The output format in this case is somewhat
remniscent of comm(1), having &quot;in first spec
only&quot;, &quot;in second spec only&quot;, and
&quot;different&quot; columns, prefixed by <br>
zero, one and two TAB characters respectively. Each entry in
the &quot;different&quot; column occupies two lines, one
from each specification.</p>

<p style="margin-top: 1em">-K keywords <br>
Add the specified (whitespace or comma separated) keywords
to the current set of keywords.</p>

<p style="margin-top: 1em">-k keywords <br>
Use the &lsquo;&lsquo;type&rsquo;&rsquo; keyword plus the
specified (whitespace or comma separated) keywords instead
of the current set of keywords.</p>

<p style="margin-top: 1em">-p path <br>
Use the file hierarchy rooted in path, instead of the
current directory.</p>

<p style="margin-top: 1em">-s seed <br>
Display a single checksum to the standard error output that
represents all of the files for which the keyword cksum was
specified. The checksum is seeded with the specified <br>
value.</p>

<p style="margin-top: 1em">-X exclude-list <br>
The specified file contains fnmatch(3) patterns matching
files to be excluded from the specification, one to a line.
If the pattern contains a &acirc;/&acirc; character, it will
be <br>
matched against entire pathnames (relative to the starting
directory); otherwise, it will be matched against basenames
only. No comments are allowed in the exclude-list <br>
file.</p>

<p style="margin-top: 1em">Specifications are mostly
composed of &lsquo;&lsquo;keywords&rsquo;&rsquo;, i.e.,
strings that specify values relating to files. No keywords
have default values, and if a keyword has no value set, no
<br>
checks based on it are performed.</p>

<p style="margin-top: 1em">Currently supported keywords are
as follows:</p>

<p style="margin-top: 1em">cksum The checksum of the file
using the default algorithm specified by the cksum(1)
utility.</p>

<p style="margin-top: 1em">flags The file flags as a
symbolic name. See chflags(1) for information on these
names. If no flags are to be set the string
&acirc;none&acirc; may be used to override the current <br>
default.</p>

<p style="margin-top: 1em">ignore Ignore any file hierarchy
below this file.</p>

<p style="margin-top: 1em">gid The file group as a numeric
value.</p>

<p style="margin-top: 1em">gname The file group as a
symbolic name.</p>

<p style="margin-top: 1em">md5digest The MD5 message digest
of the file.</p>

<p style="margin-top: 1em">sha1digest The FIPS 160-1
(&acirc;SHA-1&acirc;) message digest of the file.</p>

<p style="margin-top: 1em">sha256digest <br>
The FIPS 180-2 (&acirc;SHA-256&acirc;) message digest of the
file.</p>

<p style="margin-top: 1em">ripemd160digest <br>
The RIPEMD160 message digest of the file.</p>

<p style="margin-top: 1em">mode The current file&rsquo;s
permissions as a numeric (octal) or symbolic value.</p>

<p style="margin-top: 1em">nlink The number of hard links
the file is expected to have.</p>

<p style="margin-top: 1em">nochange Make sure this file or
directory exists but otherwise ignore all attributes.</p>

<p style="margin-top: 1em">optional The file is optional;
do not complain about the file if it is not in the file
hierarchy.</p>

<p style="margin-top: 1em">uid The file owner as a numeric
value.</p>

<p style="margin-top: 1em">uname The file owner as a
symbolic name.</p>

<p style="margin-top: 1em">size The size, in bytes, of the
file.</p>

<p style="margin-top: 1em">link The file the symbolic link
is expected to reference.</p>

<p style="margin-top: 1em">time The last modification time
of the file, in seconds and nanoseconds. The value should
include a period character and exactly nine digits after the
period.</p>

<p style="margin-top: 1em">type The type of the file; may
be set to any one of the following:</p>

<p style="margin-top: 1em">block block special device <br>
char character special device <br>
dir directory <br>
fifo fifo <br>
file regular file <br>
link symbolic link <br>
socket socket</p>

<p style="margin-top: 1em">The default set of keywords are
flags, gid, link, mode, nlink, size, time, and uid.</p>

<p style="margin-top: 1em">There are four types of lines in
a specification.</p>

<p style="margin-top: 1em">The first type of line sets a
global value for a keyword, and consists of the string
&lsquo;&lsquo;/set&rsquo;&rsquo; followed by whitespace,
followed by sets of keyword/value pairs, separated by
white&acirc; <br>
space. Keyword/value pairs consist of a keyword, followed by
an equals sign (&lsquo;&lsquo;=&rsquo;&rsquo;), followed by
a value, without whitespace characters. Once a keyword has
been set, its value <br>
remains unchanged until either reset or unset.</p>

<p style="margin-top: 1em">The second type of line unsets
keywords and consists of the string
&lsquo;&lsquo;/unset&rsquo;&rsquo;, followed by whitespace,
followed by one or more keywords, separated by
whitespace.</p>

<p style="margin-top: 1em">The third type of line is a file
specification and consists of a file name, followed by
whitespace, followed by zero or more whitespace separated
keyword/value pairs. The file <br>
name may be preceded by whitespace characters. The file name
may contain any of the standard file name matching
characters (&lsquo;&lsquo;[&rsquo;&rsquo;,
&lsquo;&lsquo;]&rsquo;&rsquo;, &lsquo;&lsquo;?&rsquo;&rsquo;
or &lsquo;&lsquo;*&rsquo;&rsquo;), in which case files in
<br>
the hierarchy will be associated with the first pattern that
they match.</p>

<p style="margin-top: 1em">Each of the keyword/value pairs
consist of a keyword, followed by an equals sign
(&lsquo;&lsquo;=&rsquo;&rsquo;), followed by the
keyword&rsquo;s value, without whitespace characters. These
values override, <br>
without changing, the global value of the corresponding
keyword.</p>

<p style="margin-top: 1em">All paths are relative.
Specifying a directory will cause subsequent files to be
searched for in that directory hierarchy. Which brings us to
the last type of line in a specifi&acirc; <br>
cation: a line containing only the string &acirc;..&acirc;
causes the current directory path to ascend one level.</p>

<p style="margin-top: 1em">Empty lines and lines whose
first non-whitespace character is a hash mark
(&lsquo;&lsquo;#&rsquo;&rsquo;) are ignored.</p>

<p style="margin-top: 1em">The mtree utility exits with a
status of 0 on success, 1 if any error occurred, and 2 if
the file hierarchy did not match the specification. A status
of 2 is converted to a status <br>
of 0 if the -U option is used.</p>

<p style="margin-top: 1em">FILES <br>
/etc/mtree system specification directory</p>

<p style="margin-top: 1em">EXIT STATUS <br>
The mtree utility exits 0 on success, and &gt;0 if an error
occurs.</p>

<p style="margin-top: 1em">EXAMPLES <br>
To detect system binaries that have been
&lsquo;&lsquo;trojan horsed&rsquo;&rsquo;, it is recommended
that mtree -K sha256digest be run on the file systems, and a
copy of the results stored on a different <br>
machine, or, at least, in encrypted form. The output file
itself should be digested using the sha256(1) utility. Then,
periodically, mtree and sha256(1) should be run against the
<br>
on-line specifications. While it is possible for the bad
guys to change the on-line specifications to conform to
their modified binaries, it is believed to be impractical
for them <br>
to create a modified specification which has the same
SHA-256 digest as the original.</p>

<p style="margin-top: 1em">The -d and -u options can be
used in combination to create directory hierarchies for
distributions and other such things; the files in /etc/mtree
were used to create almost all <br>
directories in this FreeBSD distribution.</p>

<p style="margin-top: 1em">To create an /etc/mtree style
BSD.*.dist file, use mtree -c -d -i -n -k
uname,gname,mode,nochange.</p>

<p style="margin-top: 1em">SEE ALSO <br>
chflags(1), chgrp(1), chmod(1), cksum(1), md5(1), stat(2),
fts(3), md5(3), chown(8)</p>

<p style="margin-top: 1em">HISTORY <br>
The mtree utility appeared in 4.3BSD-Reno. The MD5 digest
capability was added in FreeBSD 2.1, in response to the
widespread use of programs which can spoof cksum(1). The
SHA-1 <br>
and RIPEMD160 digests were added in FreeBSD 4.0, as new
attacks have demonstrated weaknesses in MD5. The SHA-256
digest was added in FreeBSD 6.0. Support for file flags was
added <br>
in FreeBSD 4.0, and mostly comes from NetBSD.</p>

<p style="margin-top: 1em">BSD June 16, 2007 BSD</p>
<hr>
</body>
</html>
