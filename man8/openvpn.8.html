<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:14:11 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>openvpn(8) System Manager&rsquo;s Manual openvpn(8)</p>

<p style="margin-top: 1em">NAME <br>
openvpn - secure IP tunnel daemon.</p>

<p style="margin-top: 1em">SYNOPSIS <br>
openvpn [ options ... ]</p>

<p style="margin-top: 1em">INTRODUCTION <br>
OpenVPN is an open source VPN daemon by James Yonan. Because
OpenVPN tries to be a universal VPN tool offering a great
deal of flexibility, there are a lot of options on this <br>
manual page. If you&rsquo;re new to OpenVPN, you might want
to skip ahead to the examples section where you will see how
to construct simple VPNs on the command line without even
<br>
needing a configuration file.</p>

<p style="margin-top: 1em">Also note that there&rsquo;s
more documentation and examples on the OpenVPN web site:
http://openvpn.net/</p>

<p style="margin-top: 1em">And if you would like to see a
shorter version of this manual, see the openvpn usage
message which can be obtained by running openvpn without any
parameters.</p>

<p style="margin-top: 1em">DESCRIPTION <br>
OpenVPN is a robust and highly flexible VPN daemon. OpenVPN
supports SSL/TLS security, ethernet bridging, TCP or UDP
tunnel transport through proxies or NAT, support for dynamic
<br>
IP addresses and DHCP, scalability to hundreds or thousands
of users, and portability to most major OS platforms.</p>

<p style="margin-top: 1em">OpenVPN is tightly bound to the
OpenSSL library, and derives much of its crypto capabilities
from it.</p>

<p style="margin-top: 1em">OpenVPN supports conventional
encryption using a pre-shared secret key (Static Key mode)
or public key security (SSL/TLS mode) using client &amp;
server certificates. OpenVPN also <br>
supports non-encrypted TCP/UDP tunnels.</p>

<p style="margin-top: 1em">OpenVPN is designed to work with
the TUN/TAP virtual networking interface that exists on most
platforms.</p>

<p style="margin-top: 1em">Overall, OpenVPN aims to offer
many of the key features of IPSec but with a relatively
lightweight footprint.</p>

<p style="margin-top: 1em">OPTIONS <br>
OpenVPN allows any option to be placed either on the command
line or in a configuration file. Though all command line
options are preceded by a double-leading-dash
(&quot;--&quot;), this <br>
prefix can be removed when an option is placed in a
configuration file.</p>

<p style="margin-top: 1em">--help Show options.</p>

<p style="margin-top: 1em">--config file <br>
Load additional config options from file where each line
corresponds to one command line option, but with the leading
&rsquo;--&rsquo; removed.</p>

<p style="margin-top: 1em">If --config file is the only
option to the openvpn command, the --config can be removed,
and the command can be given as openvpn file</p>

<p style="margin-top: 1em">Note that configuration files
can be nested to a reasonable depth.</p>

<p style="margin-top: 1em">Double quotation or single
quotation characters (&quot;&quot;, &rsquo;&rsquo;) can be
used to enclose single parameters containing whitespace, and
&quot;#&quot; or &quot;;&quot; characters in the first
column can <br>
be used to denote comments.</p>

<p style="margin-top: 1em">Note that OpenVPN 2.0 and higher
performs backslash-based shell escaping for characters not
in single quotations, so the following mappings should be
observed:</p>

<p style="margin-top: 1em">\ Maps to a single backslash
character (.</p>

<p style="margin-top: 1em">interpret it as enclosing a
parameter. <br>
Pass a literal space or tab character, don&rsquo;t <br>
interpret it as a parameter delimiter.</p>

<p style="margin-top: 1em">For example on Windows, use
double backslashes to represent pathnames:</p>

<p style="margin-top: 1em">secret
&quot;c:\OpenVPN\secret.key&quot;</p>

<p style="margin-top: 1em">For examples of configuration
files, see http://openvpn.net/examples.html</p>

<p style="margin-top: 1em">Here is an example configuration
file:</p>

<p style="margin-top: 1em"># <br>
# Sample OpenVPN configuration file for <br>
# using a pre-shared static key. <br>
# <br>
# &rsquo;#&rsquo; or &rsquo;;&rsquo; may be used to delimit
comments.</p>

<p style="margin-top: 1em"># Use a dynamic tun device. <br>
dev tun</p>

<p style="margin-top: 1em"># Our remote peer <br>
remote mypeer.mydomain</p>

<p style="margin-top: 1em"># 10.1.0.1 is our local VPN
endpoint <br>
# 10.1.0.2 is our remote VPN endpoint <br>
ifconfig 10.1.0.1 10.1.0.2</p>

<p style="margin-top: 1em"># Our pre-shared static key <br>
secret static.key</p>

<p style="margin-top: 1em">Tunnel Options: <br>
--mode m <br>
Set OpenVPN major mode. By default, OpenVPN runs in
point-to-point mode (&quot;p2p&quot;). OpenVPN 2.0
introduces a new mode (&quot;server&quot;) which implements
a multi-client server <br>
capability.</p>

<p style="margin-top: 1em">--local host <br>
Local host name or IP address for bind. If specified,
OpenVPN will bind to this address only. If unspecified,
OpenVPN will bind to all interfaces.</p>

<p style="margin-top: 1em">--remote host [port] [proto]
<br>
Remote host name or IP address. On the client, multiple
--remote options may be specified for redundancy, each
referring to a different OpenVPN server. Specifying
multi&acirc; <br>
ple --remote options for this purpose is a special case of
the more general connection-profile feature. See the
&lt;connection&gt; documentation below.</p>

<p style="margin-top: 1em">The OpenVPN client will try to
connect to a server at host:port in the order specified by
the list of --remote options.</p>

<p style="margin-top: 1em">proto indicates the protocol to
use when connecting with the remote, and may be
&quot;tcp&quot; or &quot;udp&quot;.</p>

<p style="margin-top: 1em">For forcing IPv4 or IPv6
connection suffix tcp or udp with 4/6 like
udp4/udp6/tcp4/tcp6.</p>

<p style="margin-top: 1em">The client will move on to the
next host in the list, in the event of connection failure.
Note that at any given time, the OpenVPN client will at most
be connected to one <br>
server.</p>

<p style="margin-top: 1em">Note that since UDP is
connectionless, connection failure is defined by the --ping
and --ping-restart options.</p>

<p style="margin-top: 1em">Note the following corner case:
If you use multiple --remote options, AND you are dropping
root privileges on the client with --user and/or --group,
AND the client is <br>
running a non-Windows OS, if the client needs to switch to a
different server, and that server pushes back different
TUN/TAP or route settings, the client may lack the <br>
necessary privileges to close and reopen the TUN/TAP
interface. This could cause the client to exit with a fatal
error.</p>

<p style="margin-top: 1em">If --remote is unspecified,
OpenVPN will listen for packets from any IP address, but
will not act on those packets unless they pass all
authentication tests. This <br>
requirement for authentication is binding on all potential
peers, even those from known and supposedly trusted IP
addresses (it is very easy to forge a source IP address <br>
on a UDP packet).</p>

<p style="margin-top: 1em">When used in TCP mode, --remote
will act as a filter, rejecting connections from any host
which does not match host.</p>

<p style="margin-top: 1em">If host is a DNS name which
resolves to multiple IP addresses, OpenVPN will try them in
the order that the system getaddrinfo() presents them, so
priorization and DNS ran&acirc; <br>
domization is done by the system library. Unless an IP
version is forced by the protocol specification (4/6
suffix), OpenVPN will try both IPv4 and IPv6 addresses, in
the <br>
order getaddrinfo() returns them.</p>

<p style="margin-top: 1em">--remote-random-hostname <br>
Prepend a random string (6 bytes, 12 hex characters) to
hostname to prevent DNS caching. For example,
&quot;foo.bar.gov&quot; would be modified to
&quot;&lt;random-chars&gt;.foo.bar.gov&quot;.</p>

<p style="margin-top: 1em">&lt;connection&gt; <br>
Define a client connection profile. Client connection
profiles are groups of OpenVPN options that describe how to
connect to a given OpenVPN server. Client connection <br>
profiles are specified within an OpenVPN configuration file,
and each profile is bracketed by &lt;connection&gt; and
&lt;/connection&gt;.</p>

<p style="margin-top: 1em">An OpenVPN client will try each
connection profile sequentially until it achieves a
successful connection.</p>

<p style="margin-top: 1em">--remote-random can be used to
initially &quot;scramble&quot; the connection list.</p>

<p style="margin-top: 1em">Here is an example of connection
profile usage:</p>

<p style="margin-top: 1em">client <br>
dev tun</p>

<p style="margin-top: 1em">&lt;connection&gt; <br>
remote 198.19.34.56 1194 udp <br>
&lt;/connection&gt;</p>

<p style="margin-top: 1em">&lt;connection&gt; <br>
remote 198.19.34.56 443 tcp <br>
&lt;/connection&gt;</p>

<p style="margin-top: 1em">&lt;connection&gt; <br>
remote 198.19.34.56 443 tcp <br>
http-proxy 192.168.0.8 8080 <br>
&lt;/connection&gt;</p>

<p style="margin-top: 1em">&lt;connection&gt; <br>
remote 198.19.36.99 443 tcp <br>
http-proxy 192.168.0.8 8080 <br>
&lt;/connection&gt;</p>

<p style="margin-top: 1em">persist-key <br>
persist-tun <br>
pkcs12 client.p12 <br>
ns-cert-type server <br>
verb 3</p>

<p style="margin-top: 1em">First we try to connect to a
server at 198.19.34.56:1194 using UDP. If that fails, we
then try to connect to 198.19.34.56:443 using TCP. If that
also fails, then try <br>
connecting through an HTTP proxy at 192.168.0.8:8080 to
198.19.34.56:443 using TCP. Finally, try to connect through
the same proxy to a server at 198.19.36.99:443 using <br>
TCP.</p>

<p style="margin-top: 1em">The following OpenVPN options
may be used inside of a &lt;connection&gt; block:</p>

<p style="margin-top: 1em">bind, connect-retry,
connect-retry-max, connect-timeout, explicit-exit-notify,
float, fragment, http-proxy, http-proxy-option, link-mtu,
local, lport, mssfix, mtu-disc, <br>
nobind, port, proto, remote, rport, socks-proxy, tun-mtu and
tun-mtu-extra.</p>

<p style="margin-top: 1em">A defaulting mechanism exists
for specifying options to apply to all &lt;connection&gt;
profiles. If any of the above options (with the exception of
remote ) appear outside of <br>
a &lt;connection&gt; block, but in a configuration file
which has one or more &lt;connection&gt; blocks, the option
setting will be used as a default for &lt;connection&gt;
blocks which <br>
follow it in the configuration file.</p>

<p style="margin-top: 1em">For example, suppose the nobind
option were placed in the sample configuration file above,
near the top of the file, before the first
&lt;connection&gt; block. The effect would <br>
be as if nobind were declared in all &lt;connection&gt;
blocks below it.</p>

<p style="margin-top: 1em">--proto-force p <br>
When iterating through connection profiles, only consider
profiles using protocol p
(&rsquo;tcp&rsquo;|&rsquo;udp&rsquo;).</p>

<p style="margin-top: 1em">--remote-random <br>
When multiple --remote address/ports are specified, or if
connection profiles are being used, initially randomize the
order of the list as a kind of basic load-balancing <br>
measure.</p>

<p style="margin-top: 1em">--proto p <br>
Use protocol p for communicating with remote host. p can be
udp, tcp-client, or tcp-server.</p>

<p style="margin-top: 1em">The default protocol is udp when
--proto is not specified.</p>

<p style="margin-top: 1em">For UDP operation, --proto udp
should be specified on both peers.</p>

<p style="margin-top: 1em">For TCP operation, one peer must
use --proto tcp-server and the other must use --proto
tcp-client. A peer started with tcp-server will wait
indefinitely for an incoming <br>
connection. A peer started with tcp-client will attempt to
connect, and if that fails, will sleep for 5 seconds
(adjustable via the --connect-retry option) and try again
<br>
infinite or up to N retries (adjustable via the
--connect-retry-max option). Both TCP client and server will
simulate a SIGUSR1 restart signal if either side resets the
<br>
connection.</p>

<p style="margin-top: 1em">OpenVPN is designed to operate
optimally over UDP, but TCP capability is provided for
situations where UDP cannot be used. In comparison with UDP,
TCP will usually be <br>
somewhat less efficient and less robust when used over
unreliable or congested networks.</p>

<p style="margin-top: 1em">This article outlines some of
problems with tunneling IP over TCP:</p>


<p style="margin-top: 1em">http://sites.inka.de/sites/bigred/devel/tcp-tcp.html</p>

<p style="margin-top: 1em">There are certain cases,
however, where using TCP may be advantageous from a security
and robustness perspective, such as tunneling non-IP or
application-level UDP proto&acirc; <br>
cols, or tunneling protocols which don&rsquo;t possess a
built-in reliability layer.</p>

<p style="margin-top: 1em">--connect-retry n [max] <br>
Wait n seconds between connection attempts (default=5).
Repeated reconnection attempts are slowed down after 5
retries per remote by doubling the wait time after each <br>
unsuccessful attempt. The optional argument max specifies
the maximum value of wait time in seconds at which it gets
capped (default=300).</p>

<p style="margin-top: 1em">--connect-retry-max n <br>
n specifies the number of times each --remote or
&lt;connection&gt; entry is tried. Specifying n as one would
try each entry exactly once. A successful connection resets
the <br>
counter. (default=unlimited).</p>

<p style="margin-top: 1em">--show-proxy-settings <br>
Show sensed HTTP or SOCKS proxy settings. Currently, only
Windows clients support this option.</p>

<p style="margin-top: 1em">--http-proxy server port
[authfile|&rsquo;auto&rsquo;|&rsquo;auto-nct&rsquo;]
[auth-method] <br>
Connect to remote host through an HTTP proxy at address
server and port port. If HTTP Proxy-Authenticate is
required, authfile is a file containing a username and
pass&acirc; <br>
word on 2 lines, or &quot;stdin&quot; to prompt from
console. Its content can also be specified in the config
file with the --http-proxy-user-pass option. (See section on
inline <br>
files)</p>

<p style="margin-top: 1em">auth-method should be one of
&quot;none&quot;, &quot;basic&quot;, or
&quot;ntlm&quot;.</p>

<p style="margin-top: 1em">HTTP Digest authentication is
supported as well, but only via the auto or auto-nct flags
(below).</p>

<p style="margin-top: 1em">The auto flag causes OpenVPN to
automatically determine the auth-method and query stdin or
the management interface for username/password credentials,
if required. This <br>
flag exists on OpenVPN 2.1 or higher.</p>

<p style="margin-top: 1em">The auto-nct flag (no clear-text
auth) instructs OpenVPN to automatically determine the
authentication method, but to reject weak authentication
protocols such as HTTP <br>
Basic Authentication.</p>

<p style="margin-top: 1em">--http-proxy-option type [parm]
<br>
Set extended HTTP proxy options. Repeat to set multiple
options.</p>

<p style="margin-top: 1em">VERSION version -- Set HTTP
version number to version (default=1.0).</p>

<p style="margin-top: 1em">AGENT user-agent -- Set HTTP
&quot;User-Agent&quot; string to user-agent.</p>

<p style="margin-top: 1em">CUSTOM-HEADER name content --
Adds the custom Header with name as name and content as the
content of the custom HTTP header.</p>

<p style="margin-top: 1em">--socks-proxy server [port]
[authfile] <br>
Connect to remote host through a Socks5 proxy at address
server and port port (default=1080). authfile (optional) is
a file containing a username and password on 2 lines, <br>
or &quot;stdin&quot; to prompt from console.</p>

<p style="margin-top: 1em">--resolv-retry n <br>
If hostname resolve fails for --remote, retry resolve for n
seconds before failing.</p>

<p style="margin-top: 1em">Set n to &quot;infinite&quot; to
retry indefinitely.</p>

<p style="margin-top: 1em">By default, --resolv-retry
infinite is enabled. You can disable by setting n=0.</p>

<p style="margin-top: 1em">--float <br>
Allow remote peer to change its IP address and/or port
number, such as due to DHCP (this is the default if --remote
is not used). --float when specified with --remote <br>
allows an OpenVPN session to initially connect to a peer at
a known address, however if packets arrive from a new
address and pass all authentication tests, the new <br>
address will take control of the session. This is useful
when you are connecting to a peer which holds a dynamic
address such as a dial-in user or DHCP client.</p>

<p style="margin-top: 1em">Essentially, --float tells
OpenVPN to accept authenticated packets from any address,
not only the address which was specified in the --remote
option.</p>

<p style="margin-top: 1em">--ipchange cmd <br>
Run command cmd when our remote ip-address is initially
authenticated or changes.</p>

<p style="margin-top: 1em">cmd consists of a path to script
(or executable program), optionally followed by arguments.
The path and arguments may be single- or double-quoted
and/or escaped using a <br>
backslash, and should be separated by one or more
spaces.</p>

<p style="margin-top: 1em">When cmd is executed two
arguments are appended after any arguments specified in cmd
, as follows:</p>

<p style="margin-top: 1em">cmd ip_address port_number</p>

<p style="margin-top: 1em">Don&rsquo;t use --ipchange in
--mode server mode. Use a --client-connect script
instead.</p>

<p style="margin-top: 1em">See the &quot;Environmental
Variables&quot; section below for additional parameters
passed as environmental variables.</p>

<p style="margin-top: 1em">If you are running in a dynamic
IP address environment where the IP addresses of either peer
could change without notice, you can use this script, for
example, to edit the <br>
/etc/hosts file with the current address of the peer. The
script will be run every time the remote peer changes its IP
address.</p>

<p style="margin-top: 1em">Similarly if our IP address
changes due to DHCP, we should configure our IP address
change script (see man page for dhcpcd(8) ) to deliver a
SIGHUP or SIGUSR1 signal to <br>
OpenVPN. OpenVPN will then reestablish a connection with its
most recently authenticated peer on its new IP address.</p>

<p style="margin-top: 1em">--port port <br>
TCP/UDP port number or port name for both local and remote
(sets both --lport and --rport options to given port). The
current default of 1194 represents the official IANA <br>
port number assignment for OpenVPN and has been used since
version 2.0-beta17. Previous versions used port 5000 as the
default.</p>

<p style="margin-top: 1em">--lport port <br>
Set local TCP/UDP port number or name. Cannot be used
together with --nobind option.</p>

<p style="margin-top: 1em">--rport port <br>
Set TCP/UDP port number or name used by the --remote option.
The port can also be set directly using the --remote
option.</p>

<p style="margin-top: 1em">--bind [ipv6only] <br>
Bind to local address and port. This is the default unless
any of --proto tcp-client , --http-proxy or --socks-proxy
are used.</p>

<p style="margin-top: 1em">If the ipv6only keyword is
present OpenVPN will bind only to IPv6 (as oposed to IPv6
and IPv4) when a IPv6 socket is opened.</p>

<p style="margin-top: 1em">--nobind <br>
Do not bind to local address and port. The IP stack will
allocate a dynamic port for returning packets. Since the
value of the dynamic port could not be known in advance <br>
by a peer, this option is only suitable for peers which will
be initiating connections by using the --remote option.</p>

<p style="margin-top: 1em">--dev tunX | tapX | null <br>
TUN/TAP virtual network device ( X can be omitted for a
dynamic device.)</p>

<p style="margin-top: 1em">See examples section below for
an example on setting up a TUN device.</p>

<p style="margin-top: 1em">You must use either tun devices
on both ends of the connection or tap devices on both ends.
You cannot mix them, as they represent different underlying
network layers.</p>

<p style="margin-top: 1em">tun devices encapsulate IPv4 or
IPv6 (OSI Layer 3) while tap devices encapsulate Ethernet
802.3 (OSI Layer 2).</p>

<p style="margin-top: 1em">--dev-type device-type <br>
Which device type are we using? device-type should be tun
(OSI Layer 3) or tap (OSI Layer 2). Use this option only if
the TUN/TAP device used with --dev does not begin <br>
with tun or tap.</p>

<p style="margin-top: 1em">--topology mode <br>
Configure virtual addressing topology when running in --dev
tun mode. This directive has no meaning in --dev tap mode,
which always uses a subnet topology.</p>

<p style="margin-top: 1em">If you set this directive on the
server, the --server and --server-bridge directives will
automatically push your chosen topology setting to clients
as well. This direc&acirc; <br>
tive can also be manually pushed to clients. Like the --dev
directive, this directive must always be compatible between
client and server.</p>

<p style="margin-top: 1em">mode can be one of:</p>

<p style="margin-top: 1em">net30 -- Use a point-to-point
topology, by allocating one /30 subnet per client. This is
designed to allow point-to-point semantics when some or all
of the connecting <br>
clients might be Windows systems. This is the default on
OpenVPN 2.0.</p>

<p style="margin-top: 1em">p2p -- Use a point-to-point
topology where the remote endpoint of the client&rsquo;s tun
interface always points to the local endpoint of the
server&rsquo;s tun interface. This mode <br>
allocates a single IP address per connecting client. Only
use when none of the connecting clients are Windows systems.
This mode is functionally equivalent to the <br>
--ifconfig-pool-linear directive which is available in
OpenVPN 2.0 and is now deprecated.</p>

<p style="margin-top: 1em">subnet -- Use a subnet rather
than a point-to-point topology by configuring the tun
interface with a local IP address and subnet mask, similar
to the topology used in <br>
--dev tap and ethernet bridging mode. This mode allocates a
single IP address per connecting client and works on Windows
as well. Only available when server and clients <br>
are OpenVPN 2.1 or higher, or OpenVPN 2.0.x which has been
manually patched with the --topology directive code. When
used on Windows, requires version 8.2 or higher of <br>
the TAP-Win32 driver. When used on *nix, requires that the
tun driver supports an ifconfig(8) command which sets a
subnet instead of a remote endpoint IP address.</p>

<p style="margin-top: 1em">This option exists in OpenVPN
2.1 or higher.</p>

<p style="margin-top: 1em">Note: Using --topology subnet
changes the interpretation of the arguments of --ifconfig to
mean &quot;address netmask&quot;, no longer &quot;local
remote&quot;.</p>

<p style="margin-top: 1em">--dev-node node <br>
Explicitly set the device node rather than using
/dev/net/tun, /dev/tun, /dev/tap, etc. If OpenVPN cannot
figure out whether node is a TUN or TAP device based on the
<br>
name, you should also specify --dev-type tun or --dev-type
tap.</p>

<p style="margin-top: 1em">Under Mac OS X this option can
be used to specify the default tun implementation. Using
--dev-node utun forces usage of the native Darwin tun kernel
support. Use <br>
--dev-node utunN to select a specific utun instance. To
force using the tun.kext (/dev/tunX) use --dev-node tun.
When not specifying a --dev-node option openvpn will <br>
first try to open utun, and fall back to tun.kext.</p>

<p style="margin-top: 1em">On Windows systems, select the
TAP-Win32 adapter which is named node in the Network
Connections Control Panel or the raw GUID of the adapter
enclosed by braces. The <br>
--show-adapters option under Windows can also be used to
enumerate all available TAP-Win32 adapters and will show
both the network connections control panel name and the <br>
GUID for each TAP-Win32 adapter.</p>

<p style="margin-top: 1em">--lladdr address <br>
Specify the link layer address, more commonly known as the
MAC address. Only applied to TAP devices.</p>

<p style="margin-top: 1em">--iproute cmd <br>
Set alternate command to execute instead of default iproute2
command. May be used in order to execute OpenVPN in
unprivileged environment.</p>

<p style="margin-top: 1em">--ifconfig l rn <br>
Set TUN/TAP adapter parameters. l is the IP address of the
local VPN endpoint. For TUN devices in point-to-point mode,
rn is the IP address of the remote VPN endpoint. <br>
For TAP devices, or TUN devices used with --topology subnet,
rn is the subnet mask of the virtual network segment which
is being created or connected to.</p>

<p style="margin-top: 1em">For TUN devices, which
facilitate virtual point-to-point IP connections (when used
in --topology net30 or p2p mode), the proper usage of
--ifconfig is to use two private <br>
IP addresses which are not a member of any existing subnet
which is in use. The IP addresses may be consecutive and
should have their order reversed on the remote peer. <br>
After the VPN is established, by pinging rn, you will be
pinging across the VPN.</p>

<p style="margin-top: 1em">For TAP devices, which provide
the ability to create virtual ethernet segments, or TUN
devices in --topology subnet mode (which create virtual
&quot;multipoint networks&quot;), <br>
--ifconfig is used to set an IP address and subnet mask just
as a physical ethernet adapter would be similarly
configured. If you are attempting to connect to a remote
<br>
ethernet bridge, the IP address and subnet should be set to
values which would be valid on the the bridged ethernet
segment (note also that DHCP can be used for the same <br>
purpose).</p>

<p style="margin-top: 1em">This option, while primarily a
proxy for the ifconfig(8) command, is designed to simplify
TUN/TAP tunnel configuration by providing a standard
interface to the different <br>
ifconfig implementations on different platforms.</p>

<p style="margin-top: 1em">--ifconfig parameters which are
IP addresses can also be specified as a DNS or /etc/hosts
file resolvable name.</p>

<p style="margin-top: 1em">For TAP devices, --ifconfig
should not be used if the TAP interface will be getting an
IP address lease from a DHCP server.</p>

<p style="margin-top: 1em">--ifconfig-noexec <br>
Don&rsquo;t actually execute ifconfig/netsh commands,
instead pass --ifconfig parameters to scripts using
environmental variables.</p>

<p style="margin-top: 1em">--ifconfig-nowarn <br>
Don&rsquo;t output an options consistency check warning if
the --ifconfig option on this side of the connection
doesn&rsquo;t match the remote side. This is useful when you
want to <br>
retain the overall benefits of the options consistency check
(also see --disable-occ option) while only disabling the
ifconfig component of the check.</p>

<p style="margin-top: 1em">For example, if you have a
configuration where the local host uses --ifconfig but the
remote host does not, use --ifconfig-nowarn on the local
host.</p>

<p style="margin-top: 1em">This option will also silence
warnings about potential address conflicts which
occasionally annoy more experienced users by triggering
&quot;false positive&quot; warnings.</p>

<p style="margin-top: 1em">--route network/IP [netmask]
[gateway] [metric] <br>
Add route to routing table after connection is established.
Multiple routes can be specified. Routes will be
automatically torn down in reverse order prior to TUN/TAP
<br>
device close.</p>

<p style="margin-top: 1em">This option is intended as a
convenience proxy for the route(8) shell command, while at
the same time providing portable semantics across
OpenVPN&rsquo;s platform space.</p>

<p style="margin-top: 1em">netmask default --
255.255.255.255</p>

<p style="margin-top: 1em">gateway default -- taken from
--route-gateway or the second parameter to --ifconfig when
--dev tun is specified.</p>

<p style="margin-top: 1em">metric default -- taken from
--route-metric otherwise 0.</p>

<p style="margin-top: 1em">The default can be specified by
leaving an option blank or setting it to
&quot;nil&quot;.</p>

<p style="margin-top: 1em">The network and gateway
parameters can also be specified as a DNS or /etc/hosts file
resolvable name, or as one of three special keywords:</p>

<p style="margin-top: 1em">vpn_gateway -- The remote VPN
endpoint address (derived either from --route-gateway or the
second parameter to --ifconfig when --dev tun is
specified).</p>

<p style="margin-top: 1em">net_gateway -- The pre-existing
IP default gateway, read from the routing table (not
supported on all OSes).</p>

<p style="margin-top: 1em">remote_host -- The --remote
address if OpenVPN is being run in client mode, and is
undefined in server mode.</p>

<p style="margin-top: 1em">--route-gateway
gw|&rsquo;dhcp&rsquo; <br>
Specify a default gateway gw for use with --route.</p>

<p style="margin-top: 1em">If dhcp is specified as the
parameter, the gateway address will be extracted from a DHCP
negotiation with the OpenVPN server-side LAN.</p>

<p style="margin-top: 1em">--route-metric m <br>
Specify a default metric m for use with --route.</p>

<p style="margin-top: 1em">--route-delay [n] [w] <br>
Delay n seconds (default=0) after connection establishment,
before adding routes. If n is 0, routes will be added
immediately upon connection establishment. If <br>
--route-delay is omitted, routes will be added immediately
after TUN/TAP device open and --up script execution, before
any --user or --group privilege downgrade (or <br>
--chroot execution.)</p>

<p style="margin-top: 1em">This option is designed to be
useful in scenarios where DHCP is used to set tap adapter
addresses. The delay will give the DHCP handshake time to
complete before routes <br>
are added.</p>

<p style="margin-top: 1em">On Windows, --route-delay tries
to be more intelligent by waiting w seconds (w=30 by
default) for the TAP-Win32 adapter to come up before adding
routes.</p>

<p style="margin-top: 1em">--route-up cmd <br>
Run command cmd after routes are added, subject to
--route-delay.</p>

<p style="margin-top: 1em">cmd consists of a path to script
(or executable program), optionally followed by arguments.
The path and arguments may be single- or double-quoted
and/or escaped using a <br>
backslash, and should be separated by one or more
spaces.</p>

<p style="margin-top: 1em">See the &quot;Environmental
Variables&quot; section below for additional parameters
passed as environmental variables.</p>

<p style="margin-top: 1em">--route-pre-down cmd <br>
Run command cmd before routes are removed upon
disconnection.</p>

<p style="margin-top: 1em">cmd consists of a path to script
(or executable program), optionally followed by arguments.
The path and arguments may be single- or double-quoted
and/or escaped using a <br>
backslash, and should be separated by one or more
spaces.</p>

<p style="margin-top: 1em">See the &quot;Environmental
Variables&quot; section below for additional parameters
passed as environmental variables.</p>

<p style="margin-top: 1em">--route-noexec <br>
Don&rsquo;t add or remove routes automatically. Instead pass
routes to --route-up script using environmental
variables.</p>

<p style="margin-top: 1em">--route-nopull <br>
When used with --client or --pull, accept options pushed by
server EXCEPT for routes, block-outside-dns and dhcp options
like DNS servers.</p>

<p style="margin-top: 1em">When used on the client, this
option effectively bars the server from adding routes to the
client&rsquo;s routing table, however note that this option
still allows the server to <br>
set the TCP/IP properties of the client&rsquo;s TUN/TAP
interface.</p>

<p style="margin-top: 1em">--allow-pull-fqdn <br>
Allow client to pull DNS names from server (rather than
being limited to IP address) for --ifconfig, --route, and
--route-gateway.</p>

<p style="margin-top: 1em">--client-nat snat|dnat network
netmask alias <br>
This pushable client option sets up a stateless one-to-one
NAT rule on packet addresses (not ports), and is useful in
cases where routes or ifconfig settings pushed to the <br>
client would create an IP numbering conflict.</p>

<p style="margin-top: 1em">network/netmask (for example
192.168.0.0/255.255.0.0) defines the local view of a
resource from the client perspective, while alias/netmask
(for example <br>
10.64.0.0/255.255.0.0) defines the remote view from the
server perspective.</p>

<p style="margin-top: 1em">Use snat (source NAT) for
resources owned by the client and dnat (destination NAT) for
remote resources.</p>

<p style="margin-top: 1em">Set --verb 6 for debugging info
showing the transformation of src/dest addresses in
packets.</p>

<p style="margin-top: 1em">--redirect-gateway flags... <br>
Automatically execute routing commands to cause all outgoing
IP traffic to be redirected over the VPN. This is a
client-side option.</p>

<p style="margin-top: 1em">This option performs three
steps:</p>

<p style="margin-top: 1em">(1) Create a static route for
the --remote address which forwards to the pre-existing
default gateway. This is done so that (3) will not create a
routing loop.</p>

<p style="margin-top: 1em">(2) Delete the default gateway
route.</p>

<p style="margin-top: 1em">(3) Set the new default gateway
to be the VPN endpoint address (derived either from
--route-gateway or the second parameter to --ifconfig when
--dev tun is specified).</p>

<p style="margin-top: 1em">When the tunnel is torn down,
all of the above steps are reversed so that the original
default route is restored.</p>

<p style="margin-top: 1em">Option flags:</p>

<p style="margin-top: 1em">local -- Add the local flag if
both OpenVPN servers are directly connected via a common
subnet, such as with wireless. The local flag will cause
step 1 above to be omit&acirc; <br>
ted.</p>

<p style="margin-top: 1em">autolocal -- Try to
automatically determine whether to enable local flag
above.</p>

<p style="margin-top: 1em">def1 -- Use this flag to
override the default gateway by using 0.0.0.0/1 and
128.0.0.0/1 rather than 0.0.0.0/0. This has the benefit of
overriding but not wiping out the <br>
original default gateway.</p>

<p style="margin-top: 1em">bypass-dhcp -- Add a direct
route to the DHCP server (if it is non-local) which bypasses
the tunnel (Available on Windows clients, may not be
available on non-Windows <br>
clients).</p>

<p style="margin-top: 1em">bypass-dns -- Add a direct route
to the DNS server(s) (if they are non-local) which bypasses
the tunnel (Available on Windows clients, may not be
available on non-Windows <br>
clients).</p>

<p style="margin-top: 1em">block-local -- Block access to
local LAN when the tunnel is active, except for the LAN
gateway itself. This is accomplished by routing the local
LAN (except for the LAN <br>
gateway address) into the tunnel.</p>

<p style="margin-top: 1em">ipv6 -- Redirect IPv6 routing
into the tunnel. This works similar to the def1 flag, that
is, more specific IPv6 routes are added (2000::/4,
3000::/4), covering the whole <br>
IPv6 unicast space.</p>

<p style="margin-top: 1em">!ipv4 -- Do not redirect IPv4
traffic - typically used in the flag pair ipv6 !ipv4 to
redirect IPv6-only.</p>

<p style="margin-top: 1em">--link-mtu n <br>
Sets an upper bound on the size of UDP packets which are
sent between OpenVPN peers. It&rsquo;s best not to set this
parameter unless you know what you&rsquo;re doing.</p>

<p style="margin-top: 1em">--redirect-private [flags] <br>
Like --redirect-gateway, but omit actually changing the
default gateway. Useful when pushing private subnets.</p>

<p style="margin-top: 1em">--tun-mtu n <br>
Take the TUN device MTU to be n and derive the link MTU from
it (default=1500). In most cases, you will probably want to
leave this parameter set to its default value.</p>

<p style="margin-top: 1em">The MTU (Maximum Transmission
Units) is the maximum datagram size in bytes that can be
sent unfragmented over a particular network path. OpenVPN
requires that packets on <br>
the control or data channels be sent unfragmented.</p>

<p style="margin-top: 1em">MTU problems often manifest
themselves as connections which hang during periods of
active usage.</p>

<p style="margin-top: 1em">It&rsquo;s best to use the
--fragment and/or --mssfix options to deal with MTU sizing
issues.</p>

<p style="margin-top: 1em">--tun-mtu-extra n <br>
Assume that the TUN/TAP device might return as many as n
bytes more than the --tun-mtu size on read. This parameter
defaults to 0, which is sufficient for most TUN <br>
devices. TAP devices may introduce additional overhead in
excess of the MTU size, and a setting of 32 is the default
when TAP devices are used. This parameter only con&acirc;
<br>
trols internal OpenVPN buffer sizing, so there is no
transmission overhead associated with using a larger
value.</p>

<p style="margin-top: 1em">--mtu-disc type <br>
Should we do Path MTU discovery on TCP/UDP channel? Only
supported on OSes such as Linux that supports the necessary
system call to set.</p>

<p style="margin-top: 1em">&rsquo;no&rsquo; -- Never send
DF (Don&rsquo;t Fragment) frames <br>
&rsquo;maybe&rsquo; -- Use per-route hints <br>
&rsquo;yes&rsquo; -- Always DF (Don&rsquo;t Fragment)</p>

<p style="margin-top: 1em">--mtu-test <br>
To empirically measure MTU on connection startup, add the
--mtu-test option to your configuration. OpenVPN will send
ping packets of various sizes to the remote peer and <br>
measure the largest packets which were successfully
received. The --mtu-test process normally takes about 3
minutes to complete.</p>

<p style="margin-top: 1em">--fragment max <br>
Enable internal datagram fragmentation so that no UDP
datagrams are sent which are larger than max bytes.</p>

<p style="margin-top: 1em">The max parameter is interpreted
in the same way as the --link-mtu parameter, i.e. the UDP
packet size after encapsulation overhead has been added in,
but not including <br>
the UDP header itself.</p>

<p style="margin-top: 1em">The --fragment option only makes
sense when you are using the UDP protocol ( --proto udp
).</p>

<p style="margin-top: 1em">--fragment adds 4 bytes of
overhead per datagram.</p>

<p style="margin-top: 1em">See the --mssfix option below
for an important related option to --fragment.</p>

<p style="margin-top: 1em">It should also be noted that
this option is not meant to replace UDP fragmentation at the
IP stack level. It is only meant as a last resort when path
MTU discovery is <br>
broken. Using this option is less efficient than fixing path
MTU discovery for your IP link and using native IP
fragmentation instead.</p>

<p style="margin-top: 1em">Having said that, there are
circumstances where using OpenVPN&rsquo;s internal
fragmentation capability may be your only option, such as
tunneling a UDP multicast stream which <br>
requires fragmentation.</p>

<p style="margin-top: 1em">--mssfix max <br>
Announce to TCP sessions running over the tunnel that they
should limit their send packet sizes such that after OpenVPN
has encapsulated them, the resulting UDP packet <br>
size that OpenVPN sends to its peer will not exceed max
bytes. The default value is 1450.</p>

<p style="margin-top: 1em">The max parameter is interpreted
in the same way as the --link-mtu parameter, i.e. the UDP
packet size after encapsulation overhead has been added in,
but not including <br>
the UDP header itself. Resulting packet would be at most 28
bytes larger for IPv4 and 48 bytes for IPv6 (20/40 bytes for
IP header and 8 bytes for UDP header). Default <br>
value of 1450 allows IPv4 packets to be transmitted over a
link with MTU 1473 or higher without IP level
fragmentation.</p>

<p style="margin-top: 1em">The --mssfix option only makes
sense when you are using the UDP protocol for OpenVPN
peer-to-peer communication, i.e. --proto udp.</p>

<p style="margin-top: 1em">--mssfix and --fragment can be
ideally used together, where --mssfix will try to keep TCP
from needing packet fragmentation in the first place, and if
big packets come <br>
through anyhow (from protocols other than TCP), --fragment
will internally fragment them.</p>

<p style="margin-top: 1em">Both --fragment and --mssfix are
designed to work around cases where Path MTU discovery is
broken on the network path between OpenVPN peers.</p>

<p style="margin-top: 1em">The usual symptom of such a
breakdown is an OpenVPN connection which successfully
starts, but then stalls during active usage.</p>

<p style="margin-top: 1em">If --fragment and --mssfix are
used together, --mssfix will take its default max parameter
from the --fragment max option.</p>

<p style="margin-top: 1em">Therefore, one could lower the
maximum UDP packet size to 1300 (a good first try for
solving MTU-related connection problems) with the following
options:</p>

<p style="margin-top: 1em">--tun-mtu 1500 --fragment 1300
--mssfix</p>

<p style="margin-top: 1em">--sndbuf size <br>
Set the TCP/UDP socket send buffer size. Defaults to
operation system default.</p>

<p style="margin-top: 1em">--rcvbuf size <br>
Set the TCP/UDP socket receive buffer size. Defaults to
operation system default.</p>

<p style="margin-top: 1em">--mark value <br>
Mark encrypted packets being sent with value. The mark value
can be matched in policy routing and packetfilter rules.
This option is only supported in Linux and does noth&acirc;
<br>
ing on other operating systems.</p>

<p style="margin-top: 1em">--socket-flags flags... <br>
Apply the given flags to the OpenVPN transport socket.
Currently, only TCP_NODELAY is supported.</p>

<p style="margin-top: 1em">The TCP_NODELAY socket flag is
useful in TCP mode, and causes the kernel to send tunnel
packets immediately over the TCP connection without trying
to group several smaller <br>
packets into a larger packet. This can result in a
considerably improvement in latency.</p>

<p style="margin-top: 1em">This option is pushable from
server to client, and should be used on both client and
server for maximum effect.</p>

<p style="margin-top: 1em">--txqueuelen n <br>
(Linux only) Set the TX queue length on the TUN/TAP
interface. Currently defaults to 100.</p>

<p style="margin-top: 1em">--shaper n <br>
Limit bandwidth of outgoing tunnel data to n bytes per
second on the TCP/UDP port. Note that this will only work if
mode is set to p2p. If you want to limit the band&acirc;
<br>
width in both directions, use this option on both peers.</p>

<p style="margin-top: 1em">OpenVPN uses the following
algorithm to implement traffic shaping: Given a shaper rate
of n bytes per second, after a datagram write of b bytes is
queued on the TCP/UDP <br>
port, wait a minimum of (b / n) seconds before queuing the
next write.</p>

<p style="margin-top: 1em">It should be noted that OpenVPN
supports multiple tunnels between the same two peers,
allowing you to construct full-speed and reduced bandwidth
tunnels at the same time, <br>
routing low-priority data such as off-site backups over the
reduced bandwidth tunnel, and other data over the full-speed
tunnel.</p>

<p style="margin-top: 1em">Also note that for low bandwidth
tunnels (under 1000 bytes per second), you should probably
use lower MTU values as well (see above), otherwise the
packet latency will <br>
grow so large as to trigger timeouts in the TLS layer and
TCP connections running over the tunnel.</p>

<p style="margin-top: 1em">OpenVPN allows n to be between
100 bytes/sec and 100 Mbytes/sec.</p>

<p style="margin-top: 1em">--inactive n [bytes] <br>
Causes OpenVPN to exit after n seconds of inactivity on the
TUN/TAP device. The time length of inactivity is measured
since the last incoming or outgoing tunnel packet. <br>
The default value is 0 seconds, which disables this
feature.</p>

<p style="margin-top: 1em">If the optional bytes parameter
is included, exit if less than bytes of combined in/out
traffic are produced on the tun/tap device in n seconds.</p>

<p style="margin-top: 1em">In any case, OpenVPN&rsquo;s
internal ping packets (which are just keepalives) and TLS
control packets are not considered &quot;activity&quot;, nor
are they counted as traffic, as they <br>
are used internally by OpenVPN and are not an indication of
actual user activity.</p>

<p style="margin-top: 1em">--ping n <br>
Ping remote over the TCP/UDP control channel if no packets
have been sent for at least n seconds (specify --ping on
both peers to cause ping packets to be sent in both <br>
directions since OpenVPN ping packets are not echoed like IP
ping packets). When used in one of OpenVPN&rsquo;s secure
modes (where --secret, --tls-server, or --tls-client is <br>
specified), the ping packet will be cryptographically
secure.</p>

<p style="margin-top: 1em">This option has two intended
uses:</p>

<p style="margin-top: 1em">(1) Compatibility with stateful
firewalls. The periodic ping will ensure that a stateful
firewall rule which allows OpenVPN UDP packets to pass will
not time out.</p>

<p style="margin-top: 1em">(2) To provide a basis for the
remote to test the existence of its peer using the
--ping-exit option.</p>

<p style="margin-top: 1em">--ping-exit n <br>
Causes OpenVPN to exit after n seconds pass without
reception of a ping or other packet from remote. This option
can be combined with --inactive, --ping, and --ping-exit
<br>
to create a two-tiered inactivity disconnect.</p>

<p style="margin-top: 1em">For example,</p>

<p style="margin-top: 1em">openvpn [options...] --inactive
3600 --ping 10 --ping-exit 60</p>

<p style="margin-top: 1em">when used on both peers will
cause OpenVPN to exit within 60 seconds if its peer
disconnects, but will exit after one hour if no actual
tunnel data is exchanged.</p>

<p style="margin-top: 1em">--ping-restart n <br>
Similar to --ping-exit, but trigger a SIGUSR1 restart after
n seconds pass without reception of a ping or other packet
from remote.</p>

<p style="margin-top: 1em">This option is useful in cases
where the remote peer has a dynamic IP address and a low-TTL
DNS name is used to track the IP address using a service
such as http://dyn&acirc; <br>
dns.org/ + a dynamic DNS client such as ddclient.</p>

<p style="margin-top: 1em">If the peer cannot be reached, a
restart will be triggered, causing the hostname used with
--remote to be re-resolved (if --resolv-retry is also
specified).</p>

<p style="margin-top: 1em">In server mode, --ping-restart,
--inactive, or any other type of internally generated signal
will always be applied to individual client instance
objects, never to whole <br>
server itself. Note also in server mode that any internally
generated signal which would normally cause a restart, will
cause the deletion of the client instance object <br>
instead.</p>

<p style="margin-top: 1em">In client mode, the
--ping-restart parameter is set to 120 seconds by default.
This default will hold until the client pulls a replacement
value from the server, based on <br>
the --keepalive setting in the server configuration. To
disable the 120 second default, set --ping-restart 0 on the
client.</p>

<p style="margin-top: 1em">See the signals section below
for more information on SIGUSR1.</p>

<p style="margin-top: 1em">Note that the behavior of
SIGUSR1 can be modified by the --persist-tun, --persist-key,
--persist-local-ip, and --persist-remote-ip options.</p>

<p style="margin-top: 1em">Also note that --ping-exit and
--ping-restart are mutually exclusive and cannot be used
together.</p>

<p style="margin-top: 1em">--keepalive interval timeout
<br>
A helper directive designed to simplify the expression of
--ping and --ping-restart.</p>

<p style="margin-top: 1em">This option can be used on both
client and server side, but it is in enough to add this on
the server side as it will push appropriate --ping and
--ping-restart options to <br>
the client. If used on both server and client, the values
pushed from server will override the client local
values.</p>

<p style="margin-top: 1em">The timeout argument will be
twice as long on the server side. This ensures that a
timeout is detected on client side before the server side
drops the connection.</p>

<p style="margin-top: 1em">For example, --keepalive 10 60
expands as follows:</p>

<p style="margin-top: 1em">if mode server: <br>
ping 10 # Argument: interval <br>
ping-restart 120 # Argument: timeout*2 <br>
push &quot;ping 10&quot; # Argument: interval <br>
push &quot;ping-restart 60&quot; # Argument: timeout <br>
else <br>
ping 10 # Argument: interval <br>
ping-restart 60 # Argument: timeout</p>

<p style="margin-top: 1em">--ping-timer-rem <br>
Run the --ping-exit / --ping-restart timer only if we have a
remote address. Use this option if you are starting the
daemon in listen mode (i.e. without an explicit <br>
--remote peer), and you don&rsquo;t want to start clocking
timeouts until a remote peer connects.</p>

<p style="margin-top: 1em">--persist-tun <br>
Don&rsquo;t close and reopen TUN/TAP device or run up/down
scripts across SIGUSR1 or --ping-restart restarts.</p>

<p style="margin-top: 1em">SIGUSR1 is a restart signal
similar to SIGHUP, but which offers finer-grained control
over reset options.</p>

<p style="margin-top: 1em">--persist-key <br>
Don&rsquo;t re-read key files across SIGUSR1 or
--ping-restart.</p>

<p style="margin-top: 1em">This option can be combined with
--user nobody to allow restarts triggered by the SIGUSR1
signal. Normally if you drop root privileges in OpenVPN, the
daemon cannot be <br>
restarted since it will now be unable to re-read protected
key files.</p>

<p style="margin-top: 1em">This option solves the problem
by persisting keys across SIGUSR1 resets, so they
don&rsquo;t need to be re-read.</p>

<p style="margin-top: 1em">--persist-local-ip <br>
Preserve initially resolved local IP address and port number
across SIGUSR1 or --ping-restart restarts.</p>

<p style="margin-top: 1em">--persist-remote-ip <br>
Preserve most recently authenticated remote IP address and
port number across SIGUSR1 or --ping-restart restarts.</p>

<p style="margin-top: 1em">--mlock <br>
Disable paging by calling the POSIX mlockall function.
Requires that OpenVPN be initially run as root (though
OpenVPN can subsequently downgrade its UID using the --user
<br>
option).</p>

<p style="margin-top: 1em">Using this option ensures that
key material and tunnel data are never written to disk due
to virtual memory paging operations which occur under most
modern operating sys&acirc; <br>
tems. It ensures that even if an attacker was able to crack
the box running OpenVPN, he would not be able to scan the
system swap file to recover previously used <br>
ephemeral keys, which are used for a period of time governed
by the --reneg options (see below), then are discarded.</p>

<p style="margin-top: 1em">The downside of using --mlock is
that it will reduce the amount of physical memory available
to other applications.</p>

<p style="margin-top: 1em">--up cmd <br>
Run command cmd after successful TUN/TAP device open (pre
--user UID change).</p>

<p style="margin-top: 1em">cmd consists of a path to script
(or executable program), optionally followed by arguments.
The path and arguments may be single- or double-quoted
and/or escaped using a <br>
backslash, and should be separated by one or more
spaces.</p>

<p style="margin-top: 1em">The up command is useful for
specifying route commands which route IP traffic destined
for private subnets which exist at the other end of the VPN
connection into the tun&acirc; <br>
nel.</p>

<p style="margin-top: 1em">For --dev tun execute as:</p>

<p style="margin-top: 1em">cmd tun_dev tun_mtu link_mtu
ifconfig_local_ip ifconfig_remote_ip [ init | restart ]</p>

<p style="margin-top: 1em">For --dev tap execute as:</p>

<p style="margin-top: 1em">cmd tap_dev tap_mtu link_mtu
ifconfig_local_ip ifconfig_netmask [ init | restart ]</p>

<p style="margin-top: 1em">See the &quot;Environmental
Variables&quot; section below for additional parameters
passed as environmental variables.</p>

<p style="margin-top: 1em">Note that if cmd includes
arguments, all OpenVPN-generated arguments will be appended
to them to build an argument list with which the executable
will be called.</p>

<p style="margin-top: 1em">Typically, cmd will run a script
to add routes to the tunnel.</p>

<p style="margin-top: 1em">Normally the up script is called
after the TUN/TAP device is opened. In this context, the
last command line parameter passed to the script will be
init. If the <br>
--up-restart option is also used, the up script will be
called for restarts as well. A restart is considered to be a
partial reinitialization of OpenVPN where the TUN/TAP <br>
instance is preserved (the --persist-tun option will enable
such preservation). A restart can be generated by a SIGUSR1
signal, a --ping-restart timeout, or a connection <br>
reset when the TCP protocol is enabled with the --proto
option. If a restart occurs, and --up-restart has been
specified, the up script will be called with restart as the
<br>
last parameter.</p>

<p style="margin-top: 1em">NOTE: on restart, OpenVPN will
not pass the full set of environment variables to the
script. Namely, everything related to routing and gateways
will not be passed, as <br>
nothing needs to be done anyway - all the routing setup is
already in place. Additionally, the up-restart script will
run with the downgraded UID/GID settings (if config&acirc;
<br>
ured).</p>

<p style="margin-top: 1em">The following standalone example
shows how the --up script can be called in both an
initialization and restart context. (NOTE: for security
reasons, don&rsquo;t run the follow&acirc; <br>
ing example unless UDP port 9999 is blocked by your
firewall. Also, the example will run indefinitely, so you
should abort with control-c).</p>

<p style="margin-top: 1em">openvpn --dev tun --port 9999
--verb 4 --ping-restart 10 --up &rsquo;echo up&rsquo; --down
&rsquo;echo down&rsquo; --persist-tun --up-restart</p>

<p style="margin-top: 1em">Note that OpenVPN also provides
the --ifconfig option to automatically ifconfig the TUN
device, eliminating the need to define an --up script,
unless you also want to con&acirc; <br>
figure routes in the --up script.</p>

<p style="margin-top: 1em">If --ifconfig is also specified,
OpenVPN will pass the ifconfig local and remote endpoints on
the command line to the --up script so that they can be used
to configure <br>
routes such as:</p>

<p style="margin-top: 1em">route add -net 10.0.0.0 netmask
255.255.255.0 gw $5</p>

<p style="margin-top: 1em">--up-delay <br>
Delay TUN/TAP open and possible --up script execution until
after TCP/UDP connection establishment with peer.</p>

<p style="margin-top: 1em">In --proto udp mode, this option
normally requires the use of --ping to allow connection
initiation to be sensed in the absence of tunnel data, since
UDP is a &quot;connection&acirc; <br>
less&quot; protocol.</p>

<p style="margin-top: 1em">On Windows, this option will
delay the TAP-Win32 media state transitioning to
&quot;connected&quot; until connection establishment, i.e.
the receipt of the first authenticated <br>
packet from the peer.</p>

<p style="margin-top: 1em">--down cmd <br>
Run command cmd after TUN/TAP device close (post --user UID
change and/or --chroot ). cmd consists of a path to script
(or executable program), optionally followed by <br>
arguments. The path and arguments may be single- or
double-quoted and/or escaped using a backslash, and should
be separated by one or more spaces.</p>

<p style="margin-top: 1em">Called with the same parameters
and environmental variables as the --up option above.</p>

<p style="margin-top: 1em">Note that if you reduce
privileges by using --user and/or --group, your --down
script will also run at reduced privilege.</p>

<p style="margin-top: 1em">--down-pre <br>
Call --down cmd/script before, rather than after, TUN/TAP
close.</p>

<p style="margin-top: 1em">--up-restart <br>
Enable the --up and --down scripts to be called for restarts
as well as initial program start. This option is described
more fully above in the --up option documentation.</p>

<p style="margin-top: 1em">--setenv name value <br>
Set a custom environmental variable name=value to pass to
script.</p>

<p style="margin-top: 1em">--setenv FORWARD_COMPATIBLE 1
<br>
Relax config file syntax checking so that unknown directives
will trigger a warning but not a fatal error, on the
assumption that a given unknown directive might be valid
<br>
in future OpenVPN versions.</p>

<p style="margin-top: 1em">This option should be used with
caution, as there are good security reasons for having
OpenVPN fail if it detects problems in a config file. Having
said that, there are <br>
valid reasons for wanting new software features to
gracefully degrade when encountered by older software
versions.</p>

<p style="margin-top: 1em">It is also possible to tag a
single directive so as not to trigger a fatal error if the
directive isn&rsquo;t recognized. To do this, prepend the
following before the direc&acirc; <br>
tive: setenv opt</p>

<p style="margin-top: 1em">Versions prior to OpenVPN 2.3.3
will always ignore options set with the setenv opt
directive.</p>

<p style="margin-top: 1em">See also
--ignore-unknown-option</p>

<p style="margin-top: 1em">--setenv-safe name value <br>
Set a custom environmental variable OPENVPN_name=value to
pass to script.</p>

<p style="margin-top: 1em">This directive is designed to be
pushed by the server to clients, and the prepending of
&quot;OPENVPN_&quot; to the environmental variable is a
safety precaution to prevent a <br>
LD_PRELOAD style attack from a malicious or compromised
server.</p>

<p style="margin-top: 1em">--ignore-unknown-option opt1
opt2 opt3 ... optN <br>
When one of options opt1 ... optN is encountered in the
configuration file the configuration file parsing does not
fail if this OpenVPN version does not support the <br>
option. Multiple --ignore-unknown-option options can be
given to support a larger number of options to ignore.</p>

<p style="margin-top: 1em">This option should be used with
caution, as there are good security reasons for having
OpenVPN fail if it detects problems in a config file. Having
said that, there are <br>
valid reasons for wanting new software features to
gracefully degrade when encountered by older software
versions.</p>

<p style="margin-top: 1em">--ignore-unknown-option is
available since OpenVPN 2.3.3.</p>

<p style="margin-top: 1em">--script-security level <br>
This directive offers policy-level control over
OpenVPN&rsquo;s usage of external programs and scripts.
Lower level values are more restrictive, higher values are
more permis&acirc; <br>
sive. Settings for level:</p>

<p style="margin-top: 1em">0 -- Strictly no calling of
external programs. <br>
1 -- (Default) Only call built-in executables such as
ifconfig, ip, route, or netsh. <br>
2 -- Allow calling of built-in executables and user-defined
scripts. <br>
3 -- Allow passwords to be passed to scripts via
environmental variables (potentially unsafe).</p>

<p style="margin-top: 1em">OpenVPN releases before v2.3
also supported a method flag which indicated how OpenVPN
should call external commands and scripts. This could be
either execve or system. <br>
As of OpenVPN v2.3, this flag is no longer accepted. In most
*nix environments the execve() approach has been used
without any issues.</p>

<p style="margin-top: 1em">Some directives such as --up
allow options to be passed to the external script. In these
cases make sure the script name does not contain any spaces
or the configuration <br>
parser will choke because it can&rsquo;t determine where the
script name ends and script options start.</p>

<p style="margin-top: 1em">To run scripts in Windows in
earlier OpenVPN versions you needed to either add a full
path to the script interpreter which can parse the script or
use the system flag to <br>
run these scripts. As of OpenVPN v2.3 it is now a strict
requirement to have full path to the script interpreter when
running non-executables files. This is not needed <br>
for executable files, such as .exe, .com, .bat or .cmd
files. For example, if you have a Visual Basic script, you
must use this syntax now:</p>

<p style="margin-top: 1em">--up
&rsquo;C:\Windows\System32\wscript.exe
C:\Program&nbsp;Files\OpenVPN\config\my-up-script.vbs&rsquo;</p>

<p style="margin-top: 1em">Please note the single quote
marks and the escaping of the backslashes ( and the space
character.</p>

<p style="margin-top: 1em">The reason the support for the
system flag was removed is due to the security implications
with shell expansions when executing scripts via the
system() call.</p>

<p style="margin-top: 1em">--disable-occ <br>
Don&rsquo;t output a warning message if option
inconsistencies are detected between peers. An example of an
option inconsistency would be where one peer uses --dev tun
while <br>
the other peer uses --dev tap.</p>

<p style="margin-top: 1em">Use of this option is
discouraged, but is provided as a temporary fix in
situations where a recent version of OpenVPN must connect to
an old version.</p>

<p style="margin-top: 1em">--user user <br>
Change the user ID of the OpenVPN process to user after
initialization, dropping privileges in the process. This
option is useful to protect the system in the event that
<br>
some hostile party was able to gain control of an OpenVPN
session. Though OpenVPN&rsquo;s security features make this
unlikely, it is provided as a second line of defense.</p>

<p style="margin-top: 1em">By setting user to nobody or
somebody similarly unprivileged, the hostile party would be
limited in what damage they could cause. Of course once you
take away privileges, <br>
you cannot return them to an OpenVPN session. This means,
for example, that if you want to reset an OpenVPN daemon
with a SIGUSR1 signal (for example in response to a <br>
DHCP reset), you should make use of one or more of the
--persist options to ensure that OpenVPN doesn&rsquo;t need
to execute any privileged operations in order to restart
(such <br>
as re-reading key files or running ifconfig on the TUN
device).</p>

<p style="margin-top: 1em">--group group <br>
Similar to the --user option, this option changes the group
ID of the OpenVPN process to group after initialization.</p>

<p style="margin-top: 1em">--cd dir <br>
Change directory to dir prior to reading any files such as
configuration files, key files, scripts, etc. dir should be
an absolute path, with a leading &quot;/&quot;, and without
<br>
any references to the current directory such as
&quot;.&quot; or &quot;..&quot;.</p>

<p style="margin-top: 1em">This option is useful when you
are running OpenVPN in --daemon mode, and you want to
consolidate all of your OpenVPN control files in one
location.</p>

<p style="margin-top: 1em">--chroot dir <br>
Chroot to dir after initialization. --chroot essentially
redefines dir as being the top level directory tree (/).
OpenVPN will therefore be unable to access any files <br>
outside this tree. This can be desirable from a security
standpoint.</p>

<p style="margin-top: 1em">Since the chroot operation is
delayed until after initialization, most OpenVPN options
that reference files will operate in a pre-chroot
context.</p>

<p style="margin-top: 1em">In many cases, the dir parameter
can point to an empty directory, however complications can
result when scripts or restarts are executed after the
chroot operation.</p>

<p style="margin-top: 1em">Note: The SSL library will
probably need /dev/urandom to be available inside the chroot
directory dir. This is because SSL libraries occasionally
need to collect fresh <br>
random. Newer linux kernels and some BSDs implement a
getrandom() or getentropy() syscall that removes the need
for /dev/urandom to be available.</p>

<p style="margin-top: 1em">--setcon context <br>
Apply SELinux context after initialization. This essentially
provides the ability to restrict OpenVPN&rsquo;s rights to
only network I/O operations, thanks to SELinux. This goes
<br>
further than --user and --chroot in that those two, while
being great security features, unfortunately do not protect
against privilege escalation by exploitation of a <br>
vulnerable system call. You can of course combine all three,
but please note that since setcon requires access to /proc
you will have to provide it inside the chroot <br>
directory (e.g. with mount --bind).</p>

<p style="margin-top: 1em">Since the setcon operation is
delayed until after initialization, OpenVPN can be
restricted to just network-related system calls, whereas by
applying the context before <br>
startup (such as the OpenVPN one provided in the SELinux
Reference Policies) you will have to allow many things
required only during initialization.</p>

<p style="margin-top: 1em">Like with chroot, complications
can result when scripts or restarts are executed after the
setcon operation, which is why you should really consider
using the --per&acirc; <br>
sist-key and --persist-tun options.</p>

<p style="margin-top: 1em">--daemon [progname] <br>
Become a daemon after all initialization functions are
completed. This option will cause all message and error
output to be sent to the syslog file (such as
/var/log/mes&acirc; <br>
sages), except for the output of scripts and ifconfig
commands, which will go to /dev/null unless otherwise
redirected. The syslog redirection occurs immediately at the
<br>
point that --daemon is parsed on the command line even
though the daemonization point occurs later. If one of the
--log options is present, it will supercede syslog
redi&acirc; <br>
rection.</p>

<p style="margin-top: 1em">The optional progname parameter
will cause OpenVPN to report its program name to the system
logger as progname. This can be useful in linking OpenVPN
messages in the sys&acirc; <br>
log file with specific tunnels. When unspecified, progname
defaults to &quot;openvpn&quot;.</p>

<p style="margin-top: 1em">When OpenVPN is run with the
--daemon option, it will try to delay daemonization until
the majority of initialization functions which are capable
of generating fatal <br>
errors are complete. This means that initialization scripts
can test the return status of the openvpn command for a
fairly reliable indication of whether the command has <br>
correctly initialized and entered the packet forwarding
event loop.</p>

<p style="margin-top: 1em">In OpenVPN, the vast majority of
errors which occur after initialization are non-fatal.</p>

<p style="margin-top: 1em">Note: as soon as OpenVPN has
daemonized, it can not ask for usernames, passwords, or key
pass phrases anymore. This has certain consequences, namely
that using a pass&acirc; <br>
word-protected private key will fail unless the --askpass
option is used to tell OpenVPN to ask for the pass phrase
(this requirement is new in 2.3.7, and is a consequence <br>
of calling daemon() before initializing the crypto
layer).</p>

<p style="margin-top: 1em">Further, using --daemon together
with --auth-user-pass (entered on console) and
--auth-nocache will fail as soon as key renegotiation (and
reauthentication) occurs.</p>

<p style="margin-top: 1em">--syslog [progname] <br>
Direct log output to system logger, but do not become a
daemon. See --daemon directive above for description of
progname parameter.</p>

<p style="margin-top: 1em">--errors-to-stderr <br>
Output errors to stderr instead of stdout unless log output
is redirected by one of the --log options.</p>

<p style="margin-top: 1em">--passtos <br>
Set the TOS field of the tunnel packet to what the
payload&rsquo;s TOS is.</p>

<p style="margin-top: 1em">--inetd [wait|nowait] [progname]
<br>
Use this option when OpenVPN is being run from the inetd or
xinetd(8) server.</p>

<p style="margin-top: 1em">The wait/nowait option must
match what is specified in the inetd/xinetd config file. The
nowait mode can only be used with --proto tcp-server. The
default is wait. The <br>
nowait mode can be used to instantiate the OpenVPN daemon as
a classic TCP server, where client connection requests are
serviced on a single port number. For additional <br>
information on this kind of configuration, see the OpenVPN
FAQ: http://openvpn.net/faq.html#oneport</p>

<p style="margin-top: 1em">This option precludes the use of
--daemon, --local, or --remote. Note that this option causes
message and error output to be handled in the same way as
the --daemon <br>
option. The optional progname parameter is also handled
exactly as in --daemon.</p>

<p style="margin-top: 1em">Also note that in wait mode,
each OpenVPN tunnel requires a separate TCP/UDP port and a
separate inetd or xinetd entry. See the OpenVPN 1.x HOWTO
for an example on using <br>
OpenVPN with xinetd: http://openvpn.net/1xhowto.html</p>

<p style="margin-top: 1em">--log file <br>
Output logging messages to file, including output to
stdout/stderr which is generated by called scripts. If file
already exists it will be truncated. This option takes <br>
effect immediately when it is parsed in the command line and
will supercede syslog output if --daemon or --inetd is also
specified. This option is persistent over the <br>
entire course of an OpenVPN instantiation and will not be
reset by SIGHUP, SIGUSR1, or --ping-restart.</p>

<p style="margin-top: 1em">Note that on Windows, when
OpenVPN is started as a service, logging occurs by default
without the need to specify this option.</p>

<p style="margin-top: 1em">--log-append file <br>
Append logging messages to file. If file does not exist, it
will be created. This option behaves exactly like --log
except that it appends to rather than truncating the <br>
log file.</p>

<p style="margin-top: 1em">--suppress-timestamps <br>
Avoid writing timestamps to log messages, even when they
otherwise would be prepended. In particular, this applies to
log messages sent to stdout.</p>

<p style="margin-top: 1em">--machine-readable-output <br>
Always write timestamps and message flags to log messages,
even when they otherwise would not be prefixed. In
particular, this applies to log messages sent to stdout.</p>

<p style="margin-top: 1em">--writepid file <br>
Write OpenVPN&rsquo;s main process ID to file.</p>

<p style="margin-top: 1em">--nice n <br>
Change process priority after initialization ( n greater
than 0 is lower priority, n less than zero is higher
priority).</p>

<p style="margin-top: 1em">--fast-io <br>
(Experimental) Optimize TUN/TAP/UDP I/O writes by avoiding a
call to poll/epoll/select prior to the write operation. The
purpose of such a call would normally be to block <br>
until the device or socket is ready to accept the write.
Such blocking is unnecessary on some platforms which
don&rsquo;t support write blocking on UDP sockets or TUN/TAP
<br>
devices. In such cases, one can optimize the event loop by
avoiding the poll/epoll/select call, improving CPU
efficiency by 5% to 10%.</p>

<p style="margin-top: 1em">This option can only be used on
non-Windows systems, when --proto udp is specified, and when
--shaper is NOT specified.</p>

<p style="margin-top: 1em">--multihome <br>
Configure a multi-homed UDP server. This option needs to be
used when a server has more than one IP address (e.g.
multiple interfaces, or secondary IP addresses), and is <br>
not using --local to force binding to one specific address
only. This option will add some extra lookups to the packet
path to ensure that the UDP reply packets are <br>
always sent from the address that the client is talking to.
This is not supported on all platforms, and it adds more
processing, so it&rsquo;s not enabled by default.</p>

<p style="margin-top: 1em">Note: this option is only
relevant for UDP servers.</p>

<p style="margin-top: 1em">Note 2: if you do an IPv6+IPv4
dual-stack bind on a Linux machine with multiple IPv4
address, connections to IPv4 addresses will not work right
on kernels before 3.15, due <br>
to missing kernel support for the IPv4-mapped case (some
distributions have ported this to earlier kernel versions,
though).</p>

<p style="margin-top: 1em">--echo [parms...] <br>
Echo parms to log output.</p>

<p style="margin-top: 1em">Designed to be used to send
messages to a controlling application which is receiving the
OpenVPN log output.</p>

<p style="margin-top: 1em">--remap-usr1 signal <br>
Control whether internally or externally generated SIGUSR1
signals are remapped to SIGHUP (restart without persisting
state) or SIGTERM (exit).</p>

<p style="margin-top: 1em">signal can be set to
&quot;SIGHUP&quot; or &quot;SIGTERM&quot;. By default, no
remapping occurs.</p>

<p style="margin-top: 1em">--verb n <br>
Set output verbosity to n (default=1). Each level shows all
info from the previous levels. Level 3 is recommended if you
want a good summary of what&rsquo;s happening without <br>
being swamped by output.</p>

<p style="margin-top: 1em">0 -- No output except fatal
errors. <br>
1 to 4 -- Normal usage range. <br>
5 -- Output R and W characters to the console for each
packet read and write, uppercase is used for TCP/UDP packets
and lowercase is used for TUN/TAP packets. <br>
6 to 11 -- Debug info range (see errlevel.h for additional
information on debug levels).</p>

<p style="margin-top: 1em">--status file [n] <br>
Write operational status to file every n seconds.</p>

<p style="margin-top: 1em">Status can also be written to
the syslog by sending a SIGUSR2 signal.</p>

<p style="margin-top: 1em">--status-version [n] <br>
Choose the status file format version number. Currently n
can be 1, 2, or 3 and defaults to 1.</p>

<p style="margin-top: 1em">--mute n <br>
Log at most n consecutive messages in the same category.
This is useful to limit repetitive logging of similar
message types.</p>

<p style="margin-top: 1em">--compress [algorithm] <br>
Enable a compression algorithm.</p>

<p style="margin-top: 1em">The algorithm parameter may be
&quot;lzo&quot;, &quot;lz4&quot;, or empty. LZO and LZ4 are
different compression algorithms, with LZ4 generally
offering the best performance with least CPU <br>
usage. For backwards compatibility with OpenVPN versions
before 2.4, use &quot;lzo&quot; (which is identical to the
older option &quot;--comp-lzo yes&quot;).</p>

<p style="margin-top: 1em">If the algorithm parameter is
empty, compression will be turned off, but the packet
framing for compression will still be enabled, allowing a
different setting to be <br>
pushed later.</p>

<p style="margin-top: 1em">--comp-lzo [mode] <br>
Use LZO compression -- may add up to 1 byte per packet for
incompressible data. mode may be &quot;yes&quot;,
&quot;no&quot;, or &quot;adaptive&quot; (default).</p>

<p style="margin-top: 1em">This option is deprecated in
favor of the newer --compress option.</p>

<p style="margin-top: 1em">In a server mode setup, it is
possible to selectively turn compression on or off for
individual clients.</p>

<p style="margin-top: 1em">First, make sure the client-side
config file enables selective compression by having at least
one --comp-lzo directive, such as --comp-lzo no. This will
turn off compres&acirc; <br>
sion by default, but allow a future directive push from the
server to dynamically change the on/off/adaptive
setting.</p>

<p style="margin-top: 1em">Next in a --client-config-dir
file, specify the compression setting for the client, for
example:</p>

<p style="margin-top: 1em">comp-lzo yes <br>
push &quot;comp-lzo yes&quot;</p>

<p style="margin-top: 1em">The first line sets the comp-lzo
setting for the server side of the link, the second sets the
client side.</p>

<p style="margin-top: 1em">--comp-noadapt <br>
When used in conjunction with --comp-lzo, this option will
disable OpenVPN&rsquo;s adaptive compression algorithm.
Normally, adaptive compression is enabled with
--comp-lzo.</p>

<p style="margin-top: 1em">Adaptive compression tries to
optimize the case where you have compression enabled, but
you are sending predominantly incompressible (or
pre-compressed) packets over the <br>
tunnel, such as an FTP or rsync transfer of a large,
compressed file. With adaptive compression, OpenVPN will
periodically sample the compression process to measure its
<br>
efficiency. If the data being sent over the tunnel is
already compressed, the compression efficiency will be very
low, triggering openvpn to disable compression for a <br>
period of time until the next re-sample test.</p>

<p style="margin-top: 1em">--management IP port [pw-file]
<br>
Enable a TCP server on IP:port to handle daemon management
functions. pw-file, if specified, is a password file
(password on first line) or &quot;stdin&quot; to prompt from
stan&acirc; <br>
dard input. The password provided will set the password
which TCP clients will need to provide in order to access
management functions.</p>

<p style="margin-top: 1em">The management interface can
also listen on a unix domain socket, for those platforms
that support it. To use a unix domain socket, specify the
unix socket pathname in <br>
place of IP and set port to &rsquo;unix&rsquo;. While the
default behavior is to create a unix domain socket that may
be connected to by any process, the --management-client-user
and <br>
--management-client-group directives can be used to restrict
access.</p>

<p style="margin-top: 1em">The management interface
provides a special mode where the TCP management link can
operate over the tunnel itself. To enable this mode, set IP
= &quot;tunnel&quot;. Tunnel mode <br>
will cause the management interface to listen for a TCP
connection on the local VPN address of the TUN/TAP
interface.</p>

<p style="margin-top: 1em">While the management port is
designed for programmatic control of OpenVPN by other
applications, it is possible to telnet to the port, using a
telnet client in &quot;raw&quot; mode. <br>
Once connected, type &quot;help&quot; for a list of
commands.</p>

<p style="margin-top: 1em">For detailed documentation on
the management interface, see the management-notes.txt file
in the management folder of the OpenVPN source
distribution.</p>

<p style="margin-top: 1em">It is strongly recommended that
IP be set to 127.0.0.1 (localhost) to restrict accessibility
of the management server to local clients.</p>

<p style="margin-top: 1em">--management-client <br>
Management interface will connect as a TCP/unix domain
client to IP:port specified by --management rather than
listen as a TCP server or on a unix domain socket.</p>

<p style="margin-top: 1em">If the client connection fails
to connect or is disconnected, a SIGTERM signal will be
generated causing OpenVPN to quit.</p>

<p style="margin-top: 1em">--management-query-passwords
<br>
Query management channel for private key password and
--auth-user-pass username/password. Only query the
management channel for inputs which ordinarily would have
been <br>
queried from the console.</p>

<p style="margin-top: 1em">--management-query-proxy <br>
Query management channel for proxy server information for a
specific --remote (client-only).</p>

<p style="margin-top: 1em">--management-query-remote <br>
Allow management interface to override --remote directives
(client-only).</p>

<p style="margin-top: 1em">--management-external-key <br>
Allows usage for external private key file instead of --key
option (client-only).</p>

<p style="margin-top: 1em">--management-external-cert
certificate-hint <br>
Allows usage for external certificate instead of --cert
option (client-only). certificate-hint is an arbitrary
string which is passed to a management interface client as
<br>
an argument of NEED-CERTIFICATE notification. Requires
--management-external-key.</p>

<p style="margin-top: 1em">--management-forget-disconnect
<br>
Make OpenVPN forget passwords when management session
disconnects.</p>

<p style="margin-top: 1em">This directive does not affect
the --http-proxy username/password. It is always cached.</p>

<p style="margin-top: 1em">--management-hold <br>
Start OpenVPN in a hibernating state, until a client of the
management interface explicitly starts it with the hold
release command.</p>

<p style="margin-top: 1em">--management-signal <br>
Send SIGUSR1 signal to OpenVPN if management session
disconnects. This is useful when you wish to disconnect an
OpenVPN session on user logoff. For --management-client <br>
this option is not needed since a disconnect will always
generate a SIGTERM.</p>

<p style="margin-top: 1em">--management-log-cache n <br>
Cache the most recent n lines of log file history for usage
by the management channel.</p>

<p style="margin-top: 1em">--management-up-down <br>
Report tunnel up/down events to management interface.</p>

<p style="margin-top: 1em">--management-client-auth <br>
Gives management interface client the responsibility to
authenticate clients after their client certificate has been
verified. See management-notes.txt in OpenVPN distri&acirc;
<br>
bution for detailed notes.</p>

<p style="margin-top: 1em">--management-client-pf <br>
Management interface clients must specify a packet filter
file for each connecting client. See management-notes.txt in
OpenVPN distribution for detailed notes.</p>

<p style="margin-top: 1em">--management-client-user u <br>
When the management interface is listening on a unix domain
socket, only allow connections from user u.</p>

<p style="margin-top: 1em">--management-client-group g <br>
When the management interface is listening on a unix domain
socket, only allow connections from group g.</p>

<p style="margin-top: 1em">--plugin module-pathname
[init-string] <br>
Load plug-in module from the file module-pathname, passing
init-string as an argument to the module initialization
function. Multiple plugin modules may be loaded into <br>
one OpenVPN process.</p>

<p style="margin-top: 1em">For more information and
examples on how to build OpenVPN plug-in modules, see the
README file in the plugin folder of the OpenVPN source
distribution.</p>

<p style="margin-top: 1em">If you are using an RPM install
of OpenVPN, see /usr/share/openvpn/plugin. The documentation
is in doc and the actual plugin modules are in lib.</p>

<p style="margin-top: 1em">Multiple plugin modules can be
cascaded, and modules can be used in tandem with scripts.
The modules will be called by OpenVPN in the order that they
are declared in the <br>
config file. If both a plugin and script are configured for
the same callback, the script will be called last. If the
return code of the module/script controls an <br>
authentication function (such as tls-verify,
auth-user-pass-verify, or client-connect), then every module
and script must return success (0) in order for the
connection to <br>
be authenticated.</p>

<p style="margin-top: 1em">--keying-material-exporter label
len <br>
Save Exported Keying Material [RFC5705] of len bytes (must
be between 16 and 4095 bytes) using label in environment
(exported_keying_material) for use by plugins in OPEN&acirc;
<br>
VPN_PLUGIN_TLS_FINAL callback.</p>

<p style="margin-top: 1em">Note that exporter labels have
the potential to collide with existing PRF labels. In order
to prevent this, labels MUST begin with
&quot;EXPORTER&quot;.</p>

<p style="margin-top: 1em">This option requires OpenSSL
1.0.1 or newer.</p>

<p style="margin-top: 1em">Server Mode <br>
Starting with OpenVPN 2.0, a multi-client TCP/UDP server
mode is supported, and can be enabled with the --mode server
option. In server mode, OpenVPN will listen on a single <br>
port for incoming client connections. All client connections
will be routed through a single tun or tap interface. This
mode is designed for scalability and should be able to <br>
support hundreds or even thousands of clients on
sufficiently fast hardware. SSL/TLS authentication must be
used in this mode.</p>

<p style="margin-top: 1em">--server network netmask
[&rsquo;nopool&rsquo;] <br>
A helper directive designed to simplify the configuration of
OpenVPN&rsquo;s server mode. This directive will set up an
OpenVPN server which will allocate addresses to clients <br>
out of the given network/netmask. The server itself will
take the &quot;.1&quot; address of the given network for use
as the server-side endpoint of the local TUN/TAP
interface.</p>

<p style="margin-top: 1em">For example, --server 10.8.0.0
255.255.255.0 expands as follows:</p>

<p style="margin-top: 1em">mode server <br>
tls-server <br>
push &quot;topology [topology]&quot;</p>

<p style="margin-top: 1em">if dev tun AND (topology ==
net30 OR topology == p2p): <br>
ifconfig 10.8.0.1 10.8.0.2 <br>
if !nopool: <br>
ifconfig-pool 10.8.0.4 10.8.0.251 <br>
route 10.8.0.0 255.255.255.0 <br>
if client-to-client: <br>
push &quot;route 10.8.0.0 255.255.255.0&quot; <br>
else if topology == net30: <br>
push &quot;route 10.8.0.1&quot;</p>

<p style="margin-top: 1em">if dev tap OR (dev tun AND
topology == subnet): <br>
ifconfig 10.8.0.1 255.255.255.0 <br>
if !nopool: <br>
ifconfig-pool 10.8.0.2 10.8.0.253 255.255.255.0 <br>
push &quot;route-gateway 10.8.0.1&quot; <br>
if route-gateway unset: <br>
route-gateway 10.8.0.2</p>

<p style="margin-top: 1em">Don&rsquo;t use --server if you
are ethernet bridging. Use --server-bridge instead.</p>

<p style="margin-top: 1em">--server-bridge gateway netmask
pool-start-IP pool-end-IP</p>

<p style="margin-top: 1em">--server-bridge
[&rsquo;nogw&rsquo;]</p>

<p style="margin-top: 1em">A helper directive similar to
--server which is designed to simplify the configuration of
OpenVPN&rsquo;s server mode in ethernet bridging
configurations.</p>

<p style="margin-top: 1em">If --server-bridge is used
without any parameters, it will enable a DHCP-proxy mode,
where connecting OpenVPN clients will receive an IP address
for their TAP adapter from <br>
the DHCP server running on the OpenVPN server-side LAN. Note
that only clients that support the binding of a DHCP client
with the TAP adapter (such as Windows) can sup&acirc; <br>
port this mode. The optional nogw flag (advanced) indicates
that gateway information should not be pushed to the
client.</p>

<p style="margin-top: 1em">To configure ethernet bridging,
you must first use your OS&rsquo;s bridging capability to
bridge the TAP interface with the ethernet NIC interface.
For example, on Linux this <br>
is done with the brctl tool, and with Windows XP it is done
in the Network Connections Panel by selecting the ethernet
and TAP adapters and right-clicking on &quot;Bridge
Con&acirc; <br>
nections&quot;.</p>

<p style="margin-top: 1em">Next you you must manually set
the IP/netmask on the bridge interface. The gateway and
netmask parameters to --server-bridge can be set to either
the IP/netmask of the <br>
bridge interface, or the IP/netmask of the default
gateway/router on the bridged subnet.</p>

<p style="margin-top: 1em">Finally, set aside a IP range in
the bridged subnet, denoted by pool-start-IP and
pool-end-IP, for OpenVPN to allocate to connecting
clients.</p>

<p style="margin-top: 1em">For example, server-bridge
10.8.0.4 255.255.255.0 10.8.0.128 10.8.0.254 expands as
follows:</p>

<p style="margin-top: 1em">mode server <br>
tls-server</p>

<p style="margin-top: 1em">ifconfig-pool 10.8.0.128
10.8.0.254 255.255.255.0 <br>
push &quot;route-gateway 10.8.0.4&quot;</p>

<p style="margin-top: 1em">In another example,
--server-bridge (without parameters) expands as follows:</p>

<p style="margin-top: 1em">mode server <br>
tls-server</p>

<p style="margin-top: 1em">push &quot;route-gateway
dhcp&quot;</p>

<p style="margin-top: 1em">Or --server-bridge nogw expands
as follows:</p>

<p style="margin-top: 1em">mode server <br>
tls-server</p>

<p style="margin-top: 1em">--push option <br>
Push a config file option back to the client for remote
execution. Note that option must be enclosed in double
quotes (&quot;&quot;). The client must specify --pull in its
config <br>
file. The set of options which can be pushed is limited by
both feasibility and security. Some options such as those
which would execute scripts are banned, since they <br>
would effectively allow a compromised server to execute
arbitrary code on the client. Other options such as TLS or
MTU parameters cannot be pushed because the client <br>
needs to know them before the connection to the server can
be initiated.</p>

<p style="margin-top: 1em">This is a partial list of
options which can currently be pushed: --route,
--route-gateway, --route-delay, --redirect-gateway,
--ip-win32, --dhcp-option, --inactive, <br>
--ping, --ping-exit, --ping-restart, --setenv, --auth-token,
--persist-key, --persist-tun, --echo, --comp-lzo,
--socket-flags, --sndbuf, --rcvbuf</p>

<p style="margin-top: 1em">--push-reset <br>
Don&rsquo;t inherit the global push list for a specific
client instance. Specify this option in a client-specific
context such as with a --client-config-dir configuration
file. <br>
This option will ignore --push options at the global config
file level.</p>

<p style="margin-top: 1em">--push-remove opt <br>
selectively remove all --push options matching
&quot;opt&quot; from the option list for a client.
&quot;opt&quot; is matched as a substring against the whole
option string to-be-pushed to <br>
the client, so --push-remove route would remove all --push
route ... and --push route-ipv6 ... statements, while
--push-remove &rsquo;route-ipv6 2001:&rsquo; would only
remove IPv6 <br>
routes for 2001:... networks.</p>

<p style="margin-top: 1em">--push-remove can only be used
in a client-specific context, like in a --client-config-dir
file, or --client-connect script or plugin -- similar to
--push-reset, just more <br>
selective.</p>

<p style="margin-top: 1em">NOTE: to change an option,
--push-remove can be used to first remove the old value, and
then add a new --push option with the new value.</p>

<p style="margin-top: 1em">--push-peer-info <br>
Push additional information about the client to server. The
following data is always pushed to the server:</p>

<p style="margin-top: 1em">IV_VER=&lt;version&gt; -- the
client OpenVPN version</p>


<p style="margin-top: 1em">IV_PLAT=[linux|solaris|openbsd|mac|netbsd|freebsd|win]
-- the client OS platform</p>

<p style="margin-top: 1em">IV_LZO_STUB=1 -- if client was
built with LZO stub capability</p>

<p style="margin-top: 1em">IV_LZ4=1 -- if the client
supports LZ4 compressions.</p>

<p style="margin-top: 1em">IV_PROTO=2 -- if the client
supports peer-id floating mechansim</p>

<p style="margin-top: 1em">IV_NCP=2 -- negotiable ciphers,
client supports --cipher pushed by the server, a value of 2
or greater indicates client supports AES-GCM-128 and
AES-GCM-256.</p>

<p style="margin-top: 1em">IV_UI_VER=&lt;gui_id&gt;
&lt;version&gt; -- the UI version of a UI if one is running,
for example &quot;de.blinkt.openvpn 0.5.47&quot; for the
Android app.</p>

<p style="margin-top: 1em">When --push-peer-info is enabled
the additional information consists of the following
data:</p>

<p style="margin-top: 1em">IV_HWADDR=&lt;mac address&gt; --
the MAC address of clients default gateway</p>

<p style="margin-top: 1em">IV_SSL=&lt;version string&gt; --
the ssl version used by the client, e.g. &quot;OpenSSL
1.0.2f 28 Jan 2016&quot;.</p>

<p style="margin-top: 1em">IV_PLAT_VER=x.y - the version of
the operating system, e.g. 6.1 for Windows 7.</p>

<p style="margin-top: 1em">UV_&lt;name&gt;=&lt;value&gt; --
client environment variables whose names start with
&quot;UV_&quot;</p>

<p style="margin-top: 1em">--disable <br>
Disable a particular client (based on the common name) from
connecting. Don&rsquo;t use this option to disable a client
due to key or password compromise. Use a CRL (certifi&acirc;
<br>
cate revocation list) instead (see the --crl-verify
option).</p>

<p style="margin-top: 1em">This option must be associated
with a specific client instance, which means that it must be
specified either in a client instance config file using
--client-config-dir or <br>
dynamically generated using a --client-connect script.</p>

<p style="margin-top: 1em">--ifconfig-pool start-IP end-IP
[netmask] <br>
Set aside a pool of subnets to be dynamically allocated to
connecting clients, similar to a DHCP server. For tun-style
tunnels, each client will be given a /30 subnet <br>
(for interoperability with Windows clients). For tap-style
tunnels, individual addresses will be allocated, and the
optional netmask parameter will also be pushed to <br>
clients.</p>

<p style="margin-top: 1em">--ifconfig-pool-persist file
[seconds] <br>
Persist/unpersist ifconfig-pool data to file, at seconds
intervals (default=600), as well as on program startup and
shutdown.</p>

<p style="margin-top: 1em">The goal of this option is to
provide a long-term association between clients (denoted by
their common name) and the virtual IP address assigned to
them from the ifconfig- <br>
pool. Maintaining a long-term association is good for
clients because it allows them to effectively use the
--persist-tun option.</p>

<p style="margin-top: 1em">file is a comma-delimited ASCII
file, formatted as
&lt;Common-Name&gt;,&lt;IP-address&gt;.</p>

<p style="margin-top: 1em">If seconds = 0, file will be
treated as read-only. This is useful if you would like to
treat file as a configuration file.</p>

<p style="margin-top: 1em">Note that the entries in this
file are treated by OpenVPN as suggestions only, based on
past associations between a common name and IP address. They
do not guarantee that <br>
the given common name will always receive the given IP
address. If you want guaranteed assignment, use
--ifconfig-push</p>

<p style="margin-top: 1em">--ifconfig-pool-linear <br>
Modifies the --ifconfig-pool directive to allocate
individual TUN interface addresses for clients rather than
/30 subnets. NOTE: This option is incompatible with Windows
<br>
clients.</p>

<p style="margin-top: 1em">This option is deprecated, and
should be replaced with --topology p2p which is functionally
equivalent.</p>

<p style="margin-top: 1em">--ifconfig-push local
remote-netmask [alias] <br>
Push virtual IP endpoints for client tunnel, overriding the
--ifconfig-pool dynamic allocation.</p>

<p style="margin-top: 1em">The parameters local and
remote-netmask are set according to the --ifconfig directive
which you want to execute on the client machine to configure
the remote end of the <br>
tunnel. Note that the parameters local and remote-netmask
are from the perspective of the client, not the server. They
may be DNS names rather than IP addresses, in <br>
which case they will be resolved on the server at the time
of client connection.</p>

<p style="margin-top: 1em">The optional alias parameter may
be used in cases where NAT causes the client view of its
local endpoint to differ from the server view. In this case
local/remote-netmask <br>
will refer to the server view while alias/remote-netmask
will refer to the client view.</p>

<p style="margin-top: 1em">This option must be associated
with a specific client instance, which means that it must be
specified either in a client instance config file using
--client-config-dir or <br>
dynamically generated using a --client-connect script.</p>

<p style="margin-top: 1em">Remember also to include a
--route directive in the main OpenVPN config file which
encloses local, so that the kernel will know to route it to
the server&rsquo;s TUN/TAP inter&acirc; <br>
face.</p>

<p style="margin-top: 1em">OpenVPN&rsquo;s internal client
IP address selection algorithm works as follows:</p>

<p style="margin-top: 1em">1 -- Use --client-connect script
generated file for static IP (first choice). <br>
2 -- Use --client-config-dir file for static IP (next
choice). <br>
3 -- Use --ifconfig-pool allocation for dynamic IP (last
choice).</p>

<p style="margin-top: 1em">--iroute network [netmask] <br>
Generate an internal route to a specific client. The netmask
parameter, if omitted, defaults to 255.255.255.255.</p>

<p style="margin-top: 1em">This directive can be used to
route a fixed subnet from the server to a particular client,
regardless of where the client is connecting from. Remember
that you must also <br>
add the route to the system routing table as well (such as
by using the --route directive). The reason why two routes
are needed is that the --route directive routes the <br>
packet from the kernel to OpenVPN. Once in OpenVPN, the
--iroute directive routes to the specific client.</p>

<p style="margin-top: 1em">This option must be specified
either in a client instance config file using
--client-config-dir or dynamically generated using a
--client-connect script.</p>

<p style="margin-top: 1em">The --iroute directive also has
an important interaction with --push &quot;route ...&quot;.
--iroute essentially defines a subnet which is owned by a
particular client (we will <br>
call this client A). If you would like other clients to be
able to reach A&rsquo;s subnet, you can use --push
&quot;route ...&quot; together with --client-to-client to
effect this. In <br>
order for all clients to see A&rsquo;s subnet, OpenVPN must
push this route to all clients EXCEPT for A, since the
subnet is already owned by A. OpenVPN accomplishes this by
<br>
not not pushing a route to a client if it matches one of the
client&rsquo;s iroutes.</p>

<p style="margin-top: 1em">--client-to-client <br>
Because the OpenVPN server mode handles multiple clients
through a single tun or tap interface, it is effectively a
router. The --client-to-client flag tells OpenVPN to <br>
internally route client-to-client traffic rather than
pushing all client-originating traffic to the TUN/TAP
interface.</p>

<p style="margin-top: 1em">When this option is used, each
client will &quot;see&quot; the other clients which are
currently connected. Otherwise, each client will only see
the server. Don&rsquo;t use this option <br>
if you want to firewall tunnel traffic using custom,
per-client rules.</p>

<p style="margin-top: 1em">--duplicate-cn <br>
Allow multiple clients with the same common name to
concurrently connect. In the absence of this option, OpenVPN
will disconnect a client instance upon connection of a <br>
new client having the same common name.</p>

<p style="margin-top: 1em">--client-connect cmd <br>
Run command cmd on client connection.</p>

<p style="margin-top: 1em">cmd consists of a path to script
(or executable program), optionally followed by arguments.
The path and arguments may be single- or double-quoted
and/or escaped using a <br>
backslash, and should be separated by one or more
spaces.</p>

<p style="margin-top: 1em">The command is passed the common
name and IP address of the just-authenticated client as
environmental variables (see environmental variable section
below). The command <br>
is also passed the pathname of a freshly created temporary
file as the last argument (after any arguments specified in
cmd ), to be used by the command to pass dynamically <br>
generated config file directives back to OpenVPN.</p>

<p style="margin-top: 1em">If the script wants to generate
a dynamic config file to be applied on the server when the
client connects, it should write it to the file named by the
last argument.</p>

<p style="margin-top: 1em">See the --client-config-dir
option below for options which can be legally used in a
dynamically generated config file.</p>

<p style="margin-top: 1em">Note that the return value of
script is significant. If script returns a non-zero error
status, it will cause the client to be disconnected.</p>

<p style="margin-top: 1em">--client-disconnect cmd <br>
Like --client-connect but called on client instance
shutdown. Will not be called unless the --client-connect
script and plugins (if defined) were previously called on
<br>
this instance with successful (0) status returns.</p>

<p style="margin-top: 1em">The exception to this rule is if
the --client-disconnect command or plugins are cascaded, and
at least one client-connect function succeeded, then ALL of
the client-dis&acirc; <br>
connect functions for scripts and plugins will be called on
client instance object deletion, even in cases where some of
the related client-connect functions returned an <br>
error status.</p>

<p style="margin-top: 1em">The --client-disconnect command
is passed the same pathname as the corresponding
--client-connect command as its last argument. (after any
arguments specified in cmd ).</p>

<p style="margin-top: 1em">--client-config-dir dir <br>
Specify a directory dir for custom client config files.
After a connecting client has been authenticated, OpenVPN
will look in this directory for a file having the same <br>
name as the client&rsquo;s X509 common name. If a matching
file exists, it will be opened and parsed for
client-specific configuration options. If no matching file
is found, <br>
OpenVPN will instead try to open and parse a default file
called &quot;DEFAULT&quot;, which may be provided but is not
required. Note that the configuration files must be readable
<br>
by the OpenVPN process after it has dropped it&rsquo;s root
privileges.</p>

<p style="margin-top: 1em">This file can specify a fixed IP
address for a given client using --ifconfig-push, as well as
fixed subnets owned by the client using --iroute.</p>

<p style="margin-top: 1em">One of the useful properties of
this option is that it allows client configuration files to
be conveniently created, edited, or removed while the server
is live, without <br>
needing to restart the server.</p>

<p style="margin-top: 1em">The following options are legal
in a client-specific context: --push, --push-reset,
--push-remove, --iroute, --ifconfig-push, and --config.</p>

<p style="margin-top: 1em">--ccd-exclusive <br>
Require, as a condition of authentication, that a connecting
client has a --client-config-dir file.</p>

<p style="margin-top: 1em">--tmp-dir dir <br>
Specify a directory dir for temporary files. This directory
will be used by openvpn processes and script to communicate
temporary data with openvpn main process. Note <br>
that the directory must be writable by the OpenVPN process
after it has dropped it&rsquo;s root privileges.</p>

<p style="margin-top: 1em">This directory will be used by
in the following cases:</p>

<p style="margin-top: 1em">* --client-connect scripts to
dynamically generate client-specific configuration
files.</p>

<p style="margin-top: 1em">*
OPENVPN_PLUGIN_AUTH_USER_PASS_VERIFY plugin hook to return
success/failure via auth_control_file when using deferred
auth method</p>

<p style="margin-top: 1em">* OPENVPN_PLUGIN_ENABLE_PF
plugin hook to pass filtering rules via pf_file</p>

<p style="margin-top: 1em">--hash-size r v <br>
Set the size of the real address hash table to r and the
virtual address table to v. By default, both tables are
sized at 256 buckets.</p>

<p style="margin-top: 1em">--bcast-buffers n <br>
Allocate n buffers for broadcast datagrams
(default=256).</p>

<p style="margin-top: 1em">--tcp-queue-limit n <br>
Maximum number of output packets queued before TCP
(default=64).</p>

<p style="margin-top: 1em">When OpenVPN is tunneling data
from a TUN/TAP device to a remote client over a TCP
connection, it is possible that the TUN/TAP device might
produce data at a faster rate <br>
than the TCP connection can support. When the number of
output packets queued before sending to the TCP socket
reaches this limit for a given client connection, OpenVPN
<br>
will start to drop outgoing packets directed at this
client.</p>

<p style="margin-top: 1em">--tcp-nodelay <br>
This macro sets the TCP_NODELAY socket flag on the server as
well as pushes it to connecting clients. The TCP_NODELAY
flag disables the Nagle algorithm on TCP sockets <br>
causing packets to be transmitted immediately with low
latency, rather than waiting a short period of time in order
to aggregate several packets into a larger containing <br>
packet. In VPN applications over TCP, TCP_NODELAY is
generally a good latency optimization.</p>

<p style="margin-top: 1em">The macro expands as
follows:</p>

<p style="margin-top: 1em">if mode server: <br>
socket-flags TCP_NODELAY <br>
push &quot;socket-flags TCP_NODELAY&quot;</p>

<p style="margin-top: 1em">--max-clients n <br>
Limit server to a maximum of n concurrent clients.</p>

<p style="margin-top: 1em">--max-routes-per-client n <br>
Allow a maximum of n internal routes per client
(default=256). This is designed to help contain DoS attacks
where an authenticated client floods the server with packets
<br>
appearing to come from many unique MAC addresses, forcing
the server to deplete virtual memory as its internal routing
table expands. This directive can be used in a <br>
--client-config-dir file or auto-generated by a
--client-connect script to override the global value for a
particular client.</p>

<p style="margin-top: 1em">Note that this directive affects
OpenVPN&rsquo;s internal routing table, not the kernel
routing table.</p>

<p style="margin-top: 1em">--stale-routes-check n [t] <br>
Remove routes haven&rsquo;t had activity for n seconds (i.e.
the ageing time).</p>

<p style="margin-top: 1em">This check is ran every t
seconds (i.e. check interval).</p>

<p style="margin-top: 1em">If t is not present it defaults
to n</p>

<p style="margin-top: 1em">This option helps to keep the
dynamic routing table small. See also
--max-routes-per-client</p>

<p style="margin-top: 1em">--connect-freq n sec <br>
Allow a maximum of n new connections per sec seconds from
clients. This is designed to contain DoS attacks which flood
the server with connection requests using certifi&acirc;
<br>
cates which will ultimately fail to authenticate.</p>

<p style="margin-top: 1em">This is an imperfect solution
however, because in a real DoS scenario, legitimate
connections might also be refused.</p>

<p style="margin-top: 1em">For the best protection against
DoS attacks in server mode, use --proto udp and either
--tls-auth or --tls-crypt.</p>

<p style="margin-top: 1em">--learn-address cmd <br>
Run command cmd to validate client virtual addresses or
routes.</p>

<p style="margin-top: 1em">cmd consists of a path to script
(or executable program), optionally followed by arguments.
The path and arguments may be single- or double-quoted
and/or escaped using a <br>
backslash, and should be separated by one or more
spaces.</p>

<p style="margin-top: 1em">Three arguments will be appended
to any arguments in cmd as follows:</p>

<p style="margin-top: 1em">[1] operation --
&quot;add&quot;, &quot;update&quot;, or &quot;delete&quot;
based on whether or not the address is being added to,
modified, or deleted from OpenVPN&rsquo;s internal routing
table. <br>
[2] address -- The address being learned or unlearned. This
can be an IPv4 address such as &quot;198.162.10.14&quot;, an
IPv4 subnet such as &quot;198.162.10.0/24&quot;, or an
ethernet MAC <br>
address (when --dev tap is being used) such as
&quot;00:FF:01:02:03:04&quot;. <br>
[3] common name -- The common name on the certificate
associated with the client linked to this address. Only
present for &quot;add&quot; or &quot;update&quot;
operations, not &quot;delete&quot;.</p>

<p style="margin-top: 1em">On &quot;add&quot; or
&quot;update&quot; methods, if the script returns a failure
code (non-zero), OpenVPN will reject the address and will
not modify its internal routing table.</p>

<p style="margin-top: 1em">Normally, the cmd script will
use the information provided above to set appropriate
firewall entries on the VPN TUN/TAP interface. Since OpenVPN
provides the association <br>
between virtual IP or MAC address and the client&rsquo;s
authenticated common name, it allows a user-defined script
to configure firewall access policies with regard to the
<br>
client&rsquo;s high-level common name, rather than the low
level client virtual addresses.</p>

<p style="margin-top: 1em">--auth-user-pass-verify cmd
method <br>
Require the client to provide a username/password (possibly
in addition to a client certificate) for authentication.</p>

<p style="margin-top: 1em">OpenVPN will run command cmd to
validate the username/password provided by the client.</p>

<p style="margin-top: 1em">cmd consists of a path to script
(or executable program), optionally followed by arguments.
The path and arguments may be single- or double-quoted
and/or escaped using a <br>
backslash, and should be separated by one or more
spaces.</p>

<p style="margin-top: 1em">If method is set to
&quot;via-env&quot;, OpenVPN will call script with the
environmental variables username and password set to the
username/password strings provided by the client. <br>
Be aware that this method is insecure on some platforms
which make the environment of a process publicly visible to
other unprivileged processes.</p>

<p style="margin-top: 1em">If method is set to
&quot;via-file&quot;, OpenVPN will write the username and
password to the first two lines of a temporary file. The
filename will be passed as an argument to <br>
script, and the file will be automatically deleted by
OpenVPN after the script returns. The location of the
temporary file is controlled by the --tmp-dir option, and
will <br>
default to the current directory if unspecified. For
security, consider setting --tmp-dir to a volatile storage
medium such as /dev/shm (if available) to prevent the <br>
username/password file from touching the hard drive.</p>

<p style="margin-top: 1em">The script should examine the
username and password, returning a success exit code (0) if
the client&rsquo;s authentication request is to be accepted,
or a failure code (1) to <br>
reject the client.</p>

<p style="margin-top: 1em">This directive is designed to
enable a plugin-style interface for extending
OpenVPN&rsquo;s authentication capabilities.</p>

<p style="margin-top: 1em">To protect against a client
passing a maliciously formed username or password string,
the username string must consist only of these characters:
alphanumeric, underbar <br>
(&rsquo;_&rsquo;), dash (&rsquo;-&rsquo;), dot
(&rsquo;.&rsquo;), or at (&rsquo;@&rsquo;). The password
string can consist of any printable characters except for CR
or LF. Any illegal characters in either the username <br>
or password string will be converted to underbar
(&rsquo;_&rsquo;).</p>

<p style="margin-top: 1em">Care must be taken by any
user-defined scripts to avoid creating a security
vulnerability in the way that these strings are handled.
Never use these strings in such a way <br>
that they might be escaped or evaluated by a shell
interpreter.</p>

<p style="margin-top: 1em">For a sample script that
performs PAM authentication, see sample-scripts/auth-pam.pl
in the OpenVPN source distribution.</p>

<p style="margin-top: 1em">--auth-gen-token [lifetime] <br>
After successful user/password authentication, the OpenVPN
server will with this option generate a temporary
authentication token and push that to client. On the
follow&acirc; <br>
ing renegotiations, the OpenVPN client will pass this token
instead of the users password. On the server side the server
will do the token authentication internally and <br>
it will NOT do any additional authentications against
configured external user/password authentication
mechanisms.</p>

<p style="margin-top: 1em">The lifetime argument defines
how long the generated token is valid. The lifetime is
defined in seconds. If lifetime is not set or it is set to
0, the token will never <br>
expire.</p>

<p style="margin-top: 1em">This feature is useful for
environments which is configured to use One Time Passwords
(OTP) as part of the user/password authentications and that
authentication mechanism <br>
does not implement any auth-token support.</p>

<p style="margin-top: 1em">--opt-verify <br>
Clients that connect with options that are incompatible with
those of the server will be disconnected.</p>

<p style="margin-top: 1em">Options that will be compared
for compatibility include dev-type, link-mtu, tun-mtu,
proto, ifconfig, comp-lzo, fragment, keydir, cipher, auth,
keysize, secret, no-replay, <br>
no-iv, tls-auth, key-method, tls-server, and tls-client.</p>

<p style="margin-top: 1em">This option requires that
--disable-occ NOT be used.</p>

<p style="margin-top: 1em">--auth-user-pass-optional <br>
Allow connections by clients that do not specify a
username/password. Normally, when --auth-user-pass-verify or
--management-client-auth is specified (or an
authentica&acirc; <br>
tion plugin module), the OpenVPN server daemon will require
connecting clients to specify a username and password. This
option makes the submission of a username/password <br>
by clients optional, passing the responsibility to the
user-defined authentication module/script to accept or deny
the client based on other factors (such as the setting <br>
of X509 certificate fields). When this option is used, and a
connecting client does not submit a username/password, the
user-defined authentication module/script will see <br>
the username and password as being set to empty strings
(&quot;&quot;). The authentication module/script MUST have
logic to detect this condition and respond accordingly.</p>

<p style="margin-top: 1em">--client-cert-not-required
(DEPRECATED) <br>
Don&rsquo;t require client certificate, client will
authenticate using username/password only. Be aware that
using this directive is less secure than requiring
certificates <br>
from all clients.</p>

<p style="margin-top: 1em">Please note: This option is now
deprecated and will be removed in OpenVPN v2.5. It is
replaced by --verify-client-cert which allows for more
flexibility. The option <br>
--verify-client-cert none is functionally equivalent to
--client-cert-not-required</p>

<p style="margin-top: 1em">--verify-client-cert
none|optional|require <br>
Specify whether the client is required to supply a valid
certificate.</p>

<p style="margin-top: 1em">Possible options are</p>

<p style="margin-top: 1em">none : a client certificate is
not required. the client need to authenticate using
username/password only. Be aware that using this directive
is less secure than requir&acirc; <br>
ing certificates from all clients.</p>

<p style="margin-top: 1em">If you use this directive, the
entire responsibility of authentication will rest on your
--auth-user-pass-verify script, so keep in mind that bugs in
your script could <br>
potentially compromise the security of your VPN.</p>

<p style="margin-top: 1em">--verify-client-cert none is
functionally equivalent to --client-cert-not-required.</p>

<p style="margin-top: 1em">optional : a client may present
a certificate but it is not required to do so. When using
this directive, you should also use a
--auth-user-pass-verify script to ensure <br>
that clients are authenticated using a certificate, a
username and password, or possibly even both.</p>

<p style="margin-top: 1em">Again, the entire responsibility
of authentication will rest on your --auth-user-pass-verify
script, so keep in mind that bugs in your script could
potentially compromise <br>
the security of your VPN.</p>

<p style="margin-top: 1em">require : this is the default
option. A client is required to present a certificate,
otherwise VPN access is refused.</p>

<p style="margin-top: 1em">If you don&rsquo;t use this
directive (or use --verify-client-cert require ) but you
also specify an --auth-user-pass-verify script, then OpenVPN
will perform double authentica&acirc; <br>
tion. The client certificate verification AND the
--auth-user-pass-verify script will need to succeed in order
for a client to be authenticated and accepted onto the
VPN.</p>

<p style="margin-top: 1em">--username-as-common-name <br>
For --auth-user-pass-verify authentication, use the
authenticated username as the common name, rather than the
common name from the client cert.</p>

<p style="margin-top: 1em">--compat-names [no-remapping]
(DEPRECATED) <br>
Until OpenVPN v2.3 the format of the X.509 Subject fields
was formatted like this:</p>

<p style="margin-top: 1em">/C=US/L=Somewhere/CN=John
Doe/emailAddress=john@example.com</p>

<p style="margin-top: 1em">In addition the old behaviour
was to remap any character other than alphanumeric,
underscore (&rsquo;_&rsquo;), dash (&rsquo;-&rsquo;), dot
(&rsquo;.&rsquo;), and slash (&rsquo;/&rsquo;) to underscore
(&rsquo;_&rsquo;). The X.509 <br>
Subject string as returned by the tls_id environmental
variable, could additionally contain colon (&rsquo;:&rsquo;)
or equal (&rsquo;=&rsquo;).</p>

<p style="margin-top: 1em">When using the --compat-names
option, this old formatting and remapping will be re-enabled
again. This is purely implemented for compatibility reasons
when using older <br>
plug-ins or scripts which does not handle the new formatting
or UTF-8 characters.</p>

<p style="margin-top: 1em">In OpenVPN v2.3 the formatting
of these fields changed into a more standardised format. It
now looks like:</p>

<p style="margin-top: 1em">C=US, L=Somewhere, CN=John Doe,
emailAddress=john@example.com</p>

<p style="margin-top: 1em">The new default format in
OpenVPN v2.3 also does not do the character remapping which
happened earlier. This new format enables proper support for
UTF-8 characters in the <br>
usernames, X.509 Subject fields and Common Name variables
and it complies to the RFC 2253, UTF-8 String Representation
of Distinguished Names.</p>

<p style="margin-top: 1em">The no-remapping mode flag can
be used with the --compat-names option to be compatible with
the now deprecated --no-name-remapping option. It is only
available at the <br>
server. When this mode flag is used, the Common Name,
Subject, and username strings are allowed to include any
printable character including space, but excluding control
<br>
characters such as tab, newline, and carriage-return.
no-remapping is only available on the server side.</p>

<p style="margin-top: 1em">Please note: This option is
immediately deprecated. It is only implemented to make the
transition to the new formatting less intrusive. It will be
removed in OpenVPN <br>
v2.5. So please update your scripts/plug-ins where
necessary.</p>

<p style="margin-top: 1em">--no-name-remapping (DEPRECATED)
<br>
The --no-name-remapping option is an alias for
--compat-names no-remapping. It ensures compatibility with
server configurations using the --no-name-remapping
option.</p>

<p style="margin-top: 1em">Please note: This option is now
deprecated. It will be removed in OpenVPN v2.5. So please
make sure you support the new X.509 name formatting
described with the --com&acirc; <br>
pat-names option as soon as possible.</p>

<p style="margin-top: 1em">--port-share host port [dir]
<br>
When run in TCP server mode, share the OpenVPN port with
another application, such as an HTTPS server. If OpenVPN
senses a connection to its port which is using a non- <br>
OpenVPN protocol, it will proxy the connection to the server
at host:port. Currently only designed to work with
HTTP/HTTPS, though it would be theoretically possible to
<br>
extend to other protocols such as ssh.</p>

<p style="margin-top: 1em">dir specifies an optional
directory where a temporary file with name N containing
content C will be dynamically generated for each proxy
connection, where N is the source <br>
IP:port of the client connection and C is the source IP:port
of the connection to the proxy receiver. This directory can
be used as a dictionary by the proxy receiver to <br>
determine the origin of the connection. Each generated file
will be automatically deleted when the proxied connection is
torn down.</p>

<p style="margin-top: 1em">Not implemented on Windows.</p>

<p style="margin-top: 1em">Client Mode <br>
Use client mode when connecting to an OpenVPN server which
has --server, --server-bridge, or --mode server in
it&rsquo;s configuration.</p>

<p style="margin-top: 1em">--client <br>
A helper directive designed to simplify the configuration of
OpenVPN&rsquo;s client mode. This directive is equivalent
to:</p>

<p style="margin-top: 1em">pull <br>
tls-client</p>

<p style="margin-top: 1em">--pull This option must be used
on a client which is connecting to a multi-client server. It
indicates to OpenVPN that it should accept options pushed by
the server, provided <br>
they are part of the legal set of pushable options (note
that the --pull option is implied by --client ).</p>

<p style="margin-top: 1em">In particular, --pull allows the
server to push routes to the client, so you should not use
--pull or --client in situations where you don&rsquo;t trust
the server to have con&acirc; <br>
trol over the client&rsquo;s routing table.</p>

<p style="margin-top: 1em">--pull-filter
accept|ignore|reject text <br>
Filter options received from the server if the option starts
with text. Runs on client. The action flag accept allows the
option, ignore removes it and reject flags an <br>
error and triggers a SIGUSR1 restart. The filters may be
specified multiple times, and each filter is applied in the
order it is specified. The filtering of each option <br>
stops as soon as a match is found. Unmatched options are
accepted by default.</p>

<p style="margin-top: 1em">Prefix comparison is used to
match text against the received option so that</p>

<p style="margin-top: 1em">--pull-filter ignore
&quot;route&quot;</p>

<p style="margin-top: 1em">would remove all pushed options
starting with route which would include, for example,
route-gateway. Enclose text in quotes to embed spaces.</p>

<p style="margin-top: 1em">--pull-filter accept &quot;route
192.168.1.&quot; <br>
--pull-filter ignore &quot;route &quot;</p>

<p style="margin-top: 1em">would remove all routes that do
not start with 192.168.1.</p>

<p style="margin-top: 1em">This option may be used only on
clients. Note that reject may result in a repeated cycle of
failure and reconnect, unless multiple remotes are specified
and connection to <br>
the next remote succeeds. To silently ignore an option
pushed by the server, use ignore.</p>

<p style="margin-top: 1em">--auth-user-pass [up] <br>
Authenticate with server using username/password. up is a
file containing username/password on 2 lines. If the
password line is missing, OpenVPN will prompt for one.</p>

<p style="margin-top: 1em">If up is omitted,
username/password will be prompted from the console.</p>

<p style="margin-top: 1em">The server configuration must
specify an --auth-user-pass-verify script to verify the
username/password provided by the client.</p>

<p style="margin-top: 1em">--auth-retry type <br>
Controls how OpenVPN responds to username/password
verification errors such as the client-side response to an
AUTH_FAILED message from the server or verification failure
<br>
of the private key password.</p>

<p style="margin-top: 1em">Normally used to prevent auth
errors from being fatal on the client side, and to permit
username/password requeries in case of error.</p>

<p style="margin-top: 1em">An AUTH_FAILED message is
generated by the server if the client fails --auth-user-pass
authentication, or if the server-side --client-connect
script returns an error sta&acirc; <br>
tus when the client tries to connect.</p>

<p style="margin-top: 1em">type can be one of:</p>

<p style="margin-top: 1em">none -- Client will exit with a
fatal error (this is the default). <br>
nointeract -- Client will retry the connection without
requerying for an --auth-user-pass username/password. Use
this option for unattended clients. <br>
interact -- Client will requery for an --auth-user-pass
username/password and/or private key password before
attempting a reconnection.</p>

<p style="margin-top: 1em">Note that while this option
cannot be pushed, it can be controlled from the management
interface.</p>

<p style="margin-top: 1em">--static-challenge t e <br>
Enable static challenge/response protocol using challenge
text t, with echo flag given by e (0|1).</p>

<p style="margin-top: 1em">The echo flag indicates whether
or not the user&rsquo;s response to the challenge should be
echoed.</p>

<p style="margin-top: 1em">See management-notes.txt in the
OpenVPN distribution for a description of the OpenVPN
challenge/response protocol.</p>

<p style="margin-top: 1em">--server-poll-timeout n <br>
--connect-timeout n when connecting to a remote server do
not wait for more than n seconds waiting for a response
before trying the next server. The default value is <br>
120s. This timeout includes proxy and TCP connect
timeouts.</p>

<p style="margin-top: 1em">--explicit-exit-notify [n] <br>
In UDP client mode or point-to-point mode, send server/peer
an exit notification if tunnel is restarted or OpenVPN
process is exited. In client mode, on exit/restart, <br>
this option will tell the server to immediately close its
client instance object rather than waiting for a timeout.
The n parameter (default=1) controls the maximum num&acirc;
<br>
ber of attempts that the client will try to resend the exit
notification message.</p>

<p style="margin-top: 1em">In UDP server mode, send RESTART
control channel command to connected clients. The n
parameter (default=1) controls client behavior. With n = 1
client will attempt to <br>
reconnect to the same server, with n = 2 client will advance
to the next server.</p>

<p style="margin-top: 1em">OpenVPN will not send any exit
notifications unless this option is enabled.</p>

<p style="margin-top: 1em">--allow-recursive-routing <br>
When this option is set, OpenVPN will not drop incoming tun
packets with same destination as host.</p>

<p style="margin-top: 1em">Data Channel Encryption Options:
<br>
These options are meaningful for both Static &amp;
TLS-negotiated key modes (must be compatible between
peers).</p>

<p style="margin-top: 1em">--secret file [direction] <br>
Enable Static Key encryption mode (non-TLS). Use pre-shared
secret file which was generated with --genkey.</p>

<p style="margin-top: 1em">The optional direction parameter
enables the use of 4 distinct keys (HMAC-send,
cipher-encrypt, HMAC-receive, cipher-decrypt), so that each
data flow direction has a dif&acirc; <br>
ferent set of HMAC and cipher keys. This has a number of
desirable security properties including eliminating certain
kinds of DoS and message replay attacks.</p>

<p style="margin-top: 1em">When the direction parameter is
omitted, 2 keys are used bidirectionally, one for HMAC and
the other for encryption/decryption.</p>

<p style="margin-top: 1em">The direction parameter should
always be complementary on either side of the connection,
i.e. one side should use &quot;0&quot; and the other should
use &quot;1&quot;, or both sides should <br>
omit it altogether.</p>

<p style="margin-top: 1em">The direction parameter requires
that file contains a 2048 bit key. While pre-1.5 versions of
OpenVPN generate 1024 bit key files, any version of OpenVPN
which supports <br>
the direction parameter, will also support 2048 bit key file
generation using the --genkey option.</p>

<p style="margin-top: 1em">Static key encryption mode has
certain advantages, the primary being ease of
configuration.</p>

<p style="margin-top: 1em">There are no certificates or
certificate authorities or complicated negotiation
handshakes and protocols. The only requirement is that you
have a pre-existing secure <br>
channel with your peer (such as ssh ) to initially copy the
key. This requirement, along with the fact that your key
never changes unless you manually generate a new one, <br>
makes it somewhat less secure than TLS mode (see below). If
an attacker manages to steal your key, everything that was
ever encrypted with it is compromised. Contrast <br>
that to the perfect forward secrecy features of TLS mode
(using Diffie Hellman key exchange), where even if an
attacker was able to steal your private key, he would gain
<br>
no information to help him decrypt past sessions.</p>

<p style="margin-top: 1em">Another advantageous aspect of
Static Key encryption mode is that it is a handshake-free
protocol without any distinguishing signature or feature
(such as a header or pro&acirc; <br>
tocol handshake sequence) that would mark the ciphertext
packets as being generated by OpenVPN. Anyone eavesdropping
on the wire would see nothing but random-looking <br>
data.</p>

<p style="margin-top: 1em">--key-direction <br>
Alternative way of specifying the optional direction
parameter for the --tls-auth and --secret options. Useful
when using inline files (See section on inline files).</p>

<p style="margin-top: 1em">--auth alg <br>
Authenticate data channel packets and (if enabled) tls-auth
control channel packets with HMAC using message digest
algorithm alg. (The default is SHA1 ). HMAC is a com&acirc;
<br>
monly used message authentication algorithm (MAC) that uses
a data string, a secure hash algorithm, and a key, to
produce a digital signature.</p>

<p style="margin-top: 1em">The OpenVPN data channel
protocol uses encrypt-then-mac (i.e. first encrypt a packet,
then HMAC the resulting ciphertext), which prevents padding
oracle attacks.</p>

<p style="margin-top: 1em">If an AEAD cipher mode (e.g.
GCM) is chosen, the specified --auth algorithm is ignored
for the data channel, and the authentication method of the
AEAD cipher is used <br>
instead. Note that alg still specifies the digest used for
tls-auth.</p>

<p style="margin-top: 1em">In static-key encryption mode,
the HMAC key is included in the key file generated by
--genkey. In TLS mode, the HMAC key is dynamically generated
and shared between peers <br>
via the TLS control channel. If OpenVPN receives a packet
with a bad HMAC it will drop the packet. HMAC usually adds
16 or 20 bytes per packet. Set alg=none to disable <br>
authentication.</p>

<p style="margin-top: 1em">For more information on HMAC see
http://www.cs.ucsd.edu/users/mihir/papers/hmac.html</p>

<p style="margin-top: 1em">--cipher alg <br>
Encrypt data channel packets with cipher algorithm alg. The
default is BF-CBC, an abbreviation for Blowfish in Cipher
Block Chaining mode.</p>

<p style="margin-top: 1em">Using BF-CBC is no longer
recommended, because of it&rsquo;s 64-bit block size. This
small block size allows attacks based on collisions, as
demonstrated by SWEET32. See <br>
https://community.openvpn.net/openvpn/wiki/SWEET32 for
details.</p>

<p style="margin-top: 1em">To see other ciphers that are
available with OpenVPN, use the --show-ciphers option.</p>

<p style="margin-top: 1em">Set alg=none to disable
encryption.</p>

<p style="margin-top: 1em">As of OpenVPN 2.4, cipher
negotiation (NCP) can override the cipher specified by
--cipher. See --ncp-ciphers and --ncp-disable for more on
NCP.</p>

<p style="margin-top: 1em">--ncp-ciphers cipher_list <br>
Restrict the allowed ciphers to be negotiated to the ciphers
in cipher_list. cipher_list is a colon-separated list of
ciphers, and defaults to
&quot;AES-256-GCM:AES-128-GCM&quot;.</p>

<p style="margin-top: 1em">For servers, the first cipher
from cipher_list will be pushed to clients that support
cipher negotiation.</p>

<p style="margin-top: 1em">Cipher negotiation is enabled in
client-server mode only. I.e. if --mode is set to
&rsquo;server&rsquo; (server-side, implied by setting
--server ), or if --pull is specified <br>
(client-side, implied by setting --client).</p>

<p style="margin-top: 1em">If both peers support and do not
disable NCP, the negotiated cipher will override the cipher
specified by --cipher.</p>

<p style="margin-top: 1em">Additionally, to allow for more
smooth transition, if NCP is enabled, OpenVPN will inherit
the cipher of the peer if that cipher is different from the
local --cipher set&acirc; <br>
ting, but the peer cipher is one of the ciphers specified in
--ncp-ciphers. E.g. a non-NCP client (&lt;=2.3, or with
--ncp-disabled set) connecting to a NCP server (2.4+) <br>
with &quot;--cipher BF-CBC&quot; and &quot;--ncp-ciphers
AES-256-GCM:AES-256-CBC&quot; set can either specify
&quot;--cipher BF-CBC&quot; or &quot;--cipher
AES-256-CBC&quot; and both will work.</p>

<p style="margin-top: 1em">--ncp-disable <br>
Disable &quot;negotiable crypto parameters&quot;. This
completely disables cipher negotiation.</p>

<p style="margin-top: 1em">--keysize n <br>
Size of cipher key in bits (optional). If unspecified,
defaults to cipher-specific default. The --show-ciphers
option (see below) shows all available OpenSSL ciphers, <br>
their default key sizes, and whether the key size can be
changed. Use care in changing a cipher&rsquo;s default key
size. Many ciphers have not been extensively cryptanalyzed
<br>
with non-standard key lengths, and a larger key may offer no
real guarantee of greater security, or may even reduce
security.</p>

<p style="margin-top: 1em">--prng alg [nsl] <br>
(Advanced) For PRNG (Pseudo-random number generator), use
digest algorithm alg (default=sha1), and set nsl
(default=16) to the size in bytes of the nonce secret length
<br>
(between 16 and 64).</p>

<p style="margin-top: 1em">Set alg=none to disable the PRNG
and use the OpenSSL RAND_bytes function instead for all of
OpenVPN&rsquo;s pseudo-random number needs.</p>

<p style="margin-top: 1em">--engine [engine-name] <br>
Enable OpenSSL hardware-based crypto engine
functionality.</p>

<p style="margin-top: 1em">If engine-name is specified, use
a specific crypto engine. Use the --show-engines standalone
option to list the crypto engines which are supported by
OpenSSL.</p>

<p style="margin-top: 1em">--no-replay <br>
(Advanced) Disable OpenVPN&rsquo;s protection against replay
attacks. Don&rsquo;t use this option unless you are prepared
to make a tradeoff of greater efficiency in exchange for
<br>
less security.</p>

<p style="margin-top: 1em">OpenVPN provides datagram replay
protection by default.</p>

<p style="margin-top: 1em">Replay protection is
accomplished by tagging each outgoing datagram with an
identifier that is guaranteed to be unique for the key being
used. The peer that receives the <br>
datagram will check for the uniqueness of the identifier. If
the identifier was already received in a previous datagram,
OpenVPN will drop the packet. Replay protection <br>
is important to defeat attacks such as a SYN flood attack,
where the attacker listens in the wire, intercepts a TCP SYN
packet (identifying it by the context in which it <br>
occurs in relation to other packets), then floods the
receiving peer with copies of this packet.</p>

<p style="margin-top: 1em">OpenVPN&rsquo;s replay
protection is implemented in slightly different ways,
depending on the key management mode you have selected.</p>

<p style="margin-top: 1em">In Static Key mode or when using
an CFB or OFB mode cipher, OpenVPN uses a 64 bit unique
identifier that combines a time stamp with an incrementing
sequence number.</p>

<p style="margin-top: 1em">When using TLS mode for key
exchange and a CBC cipher mode, OpenVPN uses only a 32 bit
sequence number without a time stamp, since OpenVPN can
guarantee the uniqueness of <br>
this value for each key. As in IPSec, if the sequence number
is close to wrapping back to zero, OpenVPN will trigger a
new key exchange.</p>

<p style="margin-top: 1em">To check for replays, OpenVPN
uses the sliding window algorithm used by IPSec.</p>

<p style="margin-top: 1em">--replay-window n [t] <br>
Use a replay protection sliding-window of size n and a time
window of t seconds.</p>

<p style="margin-top: 1em">By default n is 64 (the IPSec
default) and t is 15 seconds.</p>

<p style="margin-top: 1em">This option is only relevant in
UDP mode, i.e. when either --proto udp is specified, or no
--proto option is specified.</p>

<p style="margin-top: 1em">When OpenVPN tunnels IP packets
over UDP, there is the possibility that packets might be
dropped or delivered out of order. Because OpenVPN, like
IPSec, is emulating the <br>
physical network layer, it will accept an out-of-order
packet sequence, and will deliver such packets in the same
order they were received to the TCP/IP protocol stack, <br>
provided they satisfy several constraints.</p>

<p style="margin-top: 1em">(a) The packet cannot be a
replay (unless --no-replay is specified, which disables
replay protection altogether).</p>

<p style="margin-top: 1em">(b) If a packet arrives out of
order, it will only be accepted if the difference between
its sequence number and the highest sequence number received
so far is less than <br>
n.</p>

<p style="margin-top: 1em">(c) If a packet arrives out of
order, it will only be accepted if it arrives no later than
t seconds after any packet containing a higher sequence
number.</p>

<p style="margin-top: 1em">If you are using a network link
with a large pipeline (meaning that the product of bandwidth
and latency is high), you may want to use a larger value for
n. Satellite <br>
links in particular often require this.</p>

<p style="margin-top: 1em">If you run OpenVPN at --verb 4,
you will see the message &quot;Replay-window backtrack
occurred [x]&quot; every time the maximum sequence number
backtrack seen thus far increases. <br>
This can be used to calibrate n.</p>

<p style="margin-top: 1em">There is some controversy on the
appropriate method of handling packet reordering at the
security layer.</p>

<p style="margin-top: 1em">Namely, to what extent should
the security layer protect the encapsulated protocol from
attacks which masquerade as the kinds of normal packet loss
and reordering that <br>
occur over IP networks?</p>

<p style="margin-top: 1em">The IPSec and OpenVPN approach
is to allow packet reordering within a certain fixed
sequence number window.</p>

<p style="margin-top: 1em">OpenVPN adds to the IPSec model
by limiting the window size in time as well as sequence
space.</p>

<p style="margin-top: 1em">OpenVPN also adds TCP transport
as an option (not offered by IPSec) in which case OpenVPN
can adopt a very strict attitude towards message deletion
and reordering: Don&rsquo;t <br>
allow it. Since TCP guarantees reliability, any packet loss
or reordering event can be assumed to be an attack.</p>

<p style="margin-top: 1em">In this sense, it could be
argued that TCP tunnel transport is preferred when tunneling
non-IP or UDP application protocols which might be
vulnerable to a message deletion <br>
or reordering attack which falls within the normal
operational parameters of IP networks.</p>

<p style="margin-top: 1em">So I would make the statement
that one should never tunnel a non-IP protocol or UDP
application protocol over UDP, if the protocol might be
vulnerable to a message dele&acirc; <br>
tion or reordering attack that falls within the normal
operating parameters of what is to be expected from the
physical IP layer. The problem is easily fixed by simply
<br>
using TCP as the VPN transport layer.</p>

<p style="margin-top: 1em">--mute-replay-warnings <br>
Silence the output of replay warnings, which are a common
false alarm on WiFi networks. This option preserves the
security of the replay protection code without the
ver&acirc; <br>
bosity associated with warnings about duplicate packets.</p>

<p style="margin-top: 1em">--replay-persist file <br>
Persist replay-protection state across sessions using file
to save and reload the state.</p>

<p style="margin-top: 1em">This option will strengthen
protection against replay attacks, especially when you are
using OpenVPN in a dynamic context (such as with --inetd)
when OpenVPN sessions are <br>
frequently started and stopped.</p>

<p style="margin-top: 1em">This option will keep a disk
copy of the current replay protection state (i.e. the most
recent packet timestamp and sequence number received from
the remote peer), so that <br>
if an OpenVPN session is stopped and restarted, it will
reject any replays of packets which were already received by
the prior session.</p>

<p style="margin-top: 1em">This option only makes sense
when replay protection is enabled (the default) and you are
using either --secret (shared-secret key mode) or TLS mode
with --tls-auth.</p>

<p style="margin-top: 1em">--no-iv</p>

<p style="margin-top: 1em">DEPRECATED This option will be
removed in OpenVPN 2.5.</p>

<p style="margin-top: 1em">(Advanced) Disable
OpenVPN&rsquo;s use of IV (cipher initialization vector).
Don&rsquo;t use this option unless you are prepared to make
a tradeoff of greater efficiency in exchange <br>
for less security.</p>

<p style="margin-top: 1em">OpenVPN uses an IV by default,
and requires it for CFB and OFB cipher modes (which are
totally insecure without it). Using an IV is important for
security when multiple <br>
messages are being encrypted/decrypted with the same
key.</p>

<p style="margin-top: 1em">IV is implemented differently
depending on the cipher mode used.</p>

<p style="margin-top: 1em">In CBC mode, OpenVPN uses a
pseudo-random IV for each packet.</p>

<p style="margin-top: 1em">In CFB/OFB mode, OpenVPN uses a
unique sequence number and time stamp as the IV. In fact, in
CFB/OFB mode, OpenVPN uses a datagram space-saving
optimization that uses the <br>
unique identifier for datagram replay protection as the
IV.</p>

<p style="margin-top: 1em">--use-prediction-resistance <br>
Enable prediction resistance on PolarSSL&rsquo;s RNG.</p>

<p style="margin-top: 1em">Enabling prediction resistance
causes the RNG to reseed in each call for random. Reseeding
this often can quickly deplete the kernel entropy pool.</p>

<p style="margin-top: 1em">If you need this option, please
consider running a daemon that adds entropy to the kernel
pool.</p>

<p style="margin-top: 1em">Note that this option only works
with PolarSSL versions greater than 1.1.</p>

<p style="margin-top: 1em">--test-crypto <br>
Do a self-test of OpenVPN&rsquo;s crypto options by
encrypting and decrypting test packets using the data
channel encryption options specified above. This option does
not <br>
require a peer to function, and therefore can be specified
without --dev or --remote.</p>

<p style="margin-top: 1em">The typical usage of
--test-crypto would be something like this:</p>

<p style="margin-top: 1em">openvpn --test-crypto --secret
key</p>

<p style="margin-top: 1em">or</p>

<p style="margin-top: 1em">openvpn --test-crypto --secret
key --verb 9</p>

<p style="margin-top: 1em">This option is very useful to
test OpenVPN after it has been ported to a new platform, or
to isolate problems in the compiler, OpenSSL crypto library,
or OpenVPN&rsquo;s crypto <br>
code. Since it is a self-test mode, problems with encryption
and authentication can be debugged independently of network
and tunnel issues.</p>

<p style="margin-top: 1em">TLS Mode Options: <br>
TLS mode is the most powerful crypto mode of OpenVPN in both
security and flexibility. TLS mode works by establishing
control and data channels which are multiplexed over a
sin&acirc; <br>
gle TCP/UDP port. OpenVPN initiates a TLS session over the
control channel and uses it to exchange cipher and HMAC keys
to protect the data channel. TLS mode uses a robust <br>
reliability layer over the UDP connection for all control
channel communication, while the data channel, over which
encrypted tunnel data passes, is forwarded without any
media&acirc; <br>
tion. The result is the best of both worlds: a fast data
channel that forwards over UDP with only the overhead of
encrypt, decrypt, and HMAC functions, and a control channel
<br>
that provides all of the security features of TLS, including
certificate-based authentication and Diffie Hellman forward
secrecy.</p>

<p style="margin-top: 1em">To use TLS mode, each peer that
runs OpenVPN should have its own local certificate/key pair
( --cert and --key ), signed by the root certificate which
is specified in --ca.</p>

<p style="margin-top: 1em">When two OpenVPN peers connect,
each presents its local certificate to the other. Each peer
will then check that its partner peer presented a
certificate which was signed by the <br>
master root certificate as specified in --ca.</p>

<p style="margin-top: 1em">If that check on both peers
succeeds, then the TLS negotiation will succeed, both
OpenVPN peers will exchange temporary session keys, and the
tunnel will begin passing data.</p>

<p style="margin-top: 1em">The OpenVPN project provides a
set of scripts for managing RSA certificates &amp; keys:
https://github.com/OpenVPN/easy-rsa</p>

<p style="margin-top: 1em">--tls-server <br>
Enable TLS and assume server role during TLS handshake. Note
that OpenVPN is designed as a peer-to-peer application. The
designation of client or server is only for the <br>
purpose of negotiating the TLS control channel.</p>

<p style="margin-top: 1em">--tls-client <br>
Enable TLS and assume client role during TLS handshake.</p>

<p style="margin-top: 1em">--ca file <br>
Certificate authority (CA) file in .pem format, also
referred to as the root certificate. This file can have
multiple certificates in .pem format, concatenated together.
<br>
You can construct your own certificate authority certificate
and private key by using a command such as:</p>

<p style="margin-top: 1em">openssl req -nodes -new -x509
-keyout ca.key -out ca.crt</p>

<p style="margin-top: 1em">Then edit your openssl.cnf file
and edit the certificate variable to point to your new root
certificate ca.crt.</p>

<p style="margin-top: 1em">For testing purposes only, the
OpenVPN distribution includes a sample CA certificate
(ca.crt). Of course you should never use the test
certificates and test keys distrib&acirc; <br>
uted with OpenVPN in a production environment, since by
virtue of the fact that they are distributed with OpenVPN,
they are totally insecure.</p>

<p style="margin-top: 1em">--capath dir <br>
Directory containing trusted certificates (CAs and CRLs).
Not available with PolarSSL.</p>

<p style="margin-top: 1em">When using the --capath option,
you are required to supply valid CRLs for the CAs too. CAs
in the capath directory are expected to be named
&lt;hash&gt;.&lt;n&gt;. CRLs are expected <br>
to be named &lt;hash&gt;.r&lt;n&gt;. See the -CApath option
of openssl verify , and the -hash option of openssl x509 and
openssl crl for more information.</p>

<p style="margin-top: 1em">--dh file <br>
File containing Diffie Hellman parameters in .pem format
(required for --tls-server only).</p>

<p style="margin-top: 1em">Set file=none to disable Diffie
Hellman key exchange (and use ECDH only). Note that this
requires peers to be using an SSL library that supports ECDH
TLS cipher suites <br>
(e.g. OpenSSL 1.0.1+, or PolarSSL 1.3+).</p>

<p style="margin-top: 1em">Use openssl dhparam -out
dh2048.pem 2048 to generate 2048-bit DH parameters. Diffie
Hellman parameters may be considered public.</p>

<p style="margin-top: 1em">--ecdh-curve name <br>
Specify the curve to use for elliptic curve Diffie Hellman.
Available curves can be listed with --show-curves. The
specified curve will only be used for ECDH TLS-ciphers.</p>

<p style="margin-top: 1em">This option is not supported in
mbed TLS builds of OpenVPN.</p>

<p style="margin-top: 1em">--cert file <br>
Local peer&rsquo;s signed certificate in .pem format -- must
be signed by a certificate authority whose certificate is in
--ca file. Each peer in an OpenVPN link running in TLS <br>
mode should have its own certificate and private key file.
In addition, each certificate should have been signed by the
key of a certificate authority whose public key <br>
resides in the --ca certificate authority file. You can
easily make your own certificate authority (see above) or
pay money to use a commercial service such as thawte.com
<br>
(in which case you will be helping to finance the
world&rsquo;s second space tourist :). To generate a
certificate, you can use a command such as:</p>

<p style="margin-top: 1em">openssl req -nodes -new -keyout
mycert.key -out mycert.csr</p>

<p style="margin-top: 1em">If your certificate authority
private key lives on another machine, copy the certificate
signing request (mycert.csr) to this other machine (this can
be done over an inse&acirc; <br>
cure channel such as email). Now sign the certificate with a
command such as:</p>

<p style="margin-top: 1em">openssl ca -out mycert.crt -in
mycert.csr</p>

<p style="margin-top: 1em">Now copy the certificate
(mycert.crt) back to the peer which initially generated the
.csr file (this can be over a public medium). Note that the
openssl ca command reads <br>
the location of the certificate authority key from its
configuration file such as /usr/share/ssl/openssl.cnf --
note also that for certificate authority functions, you <br>
must set up the files index.txt (may be empty) and serial
(initialize to 01 ).</p>

<p style="margin-top: 1em">--extra-certs file <br>
Specify a file containing one or more PEM certs
(concatenated together) that complete the local certificate
chain.</p>

<p style="margin-top: 1em">This option is useful for
&quot;split&quot; CAs, where the CA for server certs is
different than the CA for client certs. Putting certs in
this file allows them to be used to com&acirc; <br>
plete the local certificate chain without trusting them to
verify the peer-submitted certificate, as would be the case
if the certs were placed in the ca file.</p>

<p style="margin-top: 1em">--key file <br>
Local peer&rsquo;s private key in .pem format. Use the
private key which was generated when you built your
peer&rsquo;s certificate (see --cert file above).</p>

<p style="margin-top: 1em">--tls-version-min version
[&rsquo;or-highest&rsquo;] <br>
Sets the minimum TLS version we will accept from the peer
(default is &quot;1.0&quot;). Examples for version include
&quot;1.0&quot;, &quot;1.1&quot;, or &quot;1.2&quot;. If
&rsquo;or-highest&rsquo; is specified and ver&acirc; <br>
sion is not recognized, we will only accept the highest TLS
version supported by the local SSL implementation.</p>

<p style="margin-top: 1em">--tls-version-max version <br>
Set the maximum TLS version we will use (default is the
highest version supported). Examples for version include
&quot;1.0&quot;, &quot;1.1&quot;, or &quot;1.2&quot;.</p>

<p style="margin-top: 1em">--pkcs12 file <br>
Specify a PKCS #12 file containing local private key, local
certificate, and root CA certificate. This option can be
used instead of --ca, --cert, and --key. Not avail&acirc;
<br>
able with PolarSSL.</p>

<p style="margin-top: 1em">--verify-hash hash <br>
Specify SHA1 fingerprint for level-1 cert. The level-1 cert
is the CA (or intermediate cert) that signs the leaf
certificate, and is one removed from the leaf certificate
<br>
in the direction of the root. When accepting a connection
from a peer, the level-1 cert fingerprint must match hash or
certificate verification will fail. Hash is speci&acirc;
<br>
fied as XX:XX:... For example:
AD:B0:95:D8:09:C8:36:45:12:A9:89:C8:90:09:CB:13:72:A6:AD:16</p>

<p style="margin-top: 1em">--pkcs11-cert-private [0|1]...
<br>
Set if access to certificate object should be performed
after login. Every provider has its own setting.</p>

<p style="margin-top: 1em">--pkcs11-id name <br>
Specify the serialized certificate id to be used. The id can
be gotten by the standalone --show-pkcs11-ids option.</p>

<p style="margin-top: 1em">--pkcs11-id-management <br>
Acquire PKCS#11 id from management interface. In this case a
NEED-STR &rsquo;pkcs11-id-request&rsquo; real-time message
will be triggered, application may use pkcs11-id-count
command <br>
to retrieve available number of certificates, and
pkcs11-id-get command to retrieve certificate id and
certificate body.</p>

<p style="margin-top: 1em">--pkcs11-pin-cache seconds <br>
Specify how many seconds the PIN can be cached, the default
is until the token is removed.</p>


<p style="margin-top: 1em">--pkcs11-protected-authentication
[0|1]... <br>
Use PKCS#11 protected authentication path, useful for
biometric and external keypad devices. Every provider has
its own setting.</p>

<p style="margin-top: 1em">--pkcs11-providers provider...
<br>
Specify a RSA Security Inc. PKCS #11 Cryptographic Token
Interface (Cryptoki) providers to load. This option can be
used instead of --cert, --key, and --pkcs12.</p>

<p style="margin-top: 1em">If p11-kit is present on the
system, its p11-kit-proxy.so module will be loaded by
default if either the --pkcs11-id or --pkcs11-id-management
options are specified with&acirc; <br>
out --pkcs11-provider being given.</p>

<p style="margin-top: 1em">--pkcs11-private-mode mode...
<br>
Specify which method to use in order to perform private key
operations. A different mode can be specified for each
provider. Mode is encoded as hex number, and can be a <br>
mask one of the following:</p>

<p style="margin-top: 1em">0 (default) -- Try to determine
automatically. <br>
1 -- Use sign. <br>
2 -- Use sign recover. <br>
4 -- Use decrypt. <br>
8 -- Use unwrap.</p>

<p style="margin-top: 1em">--cryptoapicert select-string
<br>
Load the certificate and private key from the Windows
Certificate System Store (Windows/OpenSSL Only).</p>

<p style="margin-top: 1em">Use this option instead of
--cert and --key.</p>

<p style="margin-top: 1em">This makes it possible to use
any smart card, supported by Windows, but also any kind of
certificate, residing in the Cert Store, where you have
access to the private key. <br>
This option has been tested with a couple of different smart
cards (GemSAFE, Cryptoflex, and Swedish Post Office eID) on
the client side, and also an imported PKCS12 soft&acirc;
<br>
ware certificate on the server side.</p>

<p style="margin-top: 1em">To select a certificate, based
on a substring search in the certificate&rsquo;s
subject:</p>

<p style="margin-top: 1em">cryptoapicert &quot;SUBJ:Peter
Runestig&quot;</p>

<p style="margin-top: 1em">To select a certificate, based
on certificate&rsquo;s thumbprint:</p>

<p style="margin-top: 1em">cryptoapicert &quot;THUMB:f6 49
24 41 01 b4 ...&quot;</p>

<p style="margin-top: 1em">The thumbprint hex string can
easily be copy-and-pasted from the Windows Certificate Store
GUI.</p>

<p style="margin-top: 1em">--key-method m <br>
Use data channel key negotiation method m. The key method
must match on both sides of the connection.</p>

<p style="margin-top: 1em">After OpenVPN negotiates a TLS
session, a new set of keys for protecting the tunnel data
channel is generated and exchanged over the TLS session.</p>

<p style="margin-top: 1em">In method 1 (the default for
OpenVPN 1.x), both sides generate random encrypt and
HMAC-send keys which are forwarded to the other host over
the TLS channel. Method 1 is <br>
deprecated in OpenVPN 2.4 , and will be removed in OpenVPN
2.5.</p>

<p style="margin-top: 1em">In method 2, (the default for
OpenVPN 2.0) the client generates a random key. Both client
and server also generate some random seed material. All key
source material is <br>
exchanged over the TLS channel. The actual keys are
generated using the TLS PRF function, taking source entropy
from both client and server. Method 2 is designed to <br>
closely parallel the key generation process used by TLS
1.0.</p>

<p style="margin-top: 1em">Note that in TLS mode, two
separate levels of keying occur:</p>

<p style="margin-top: 1em">(1) The TLS connection is
initially negotiated, with both sides of the connection
producing certificates and verifying the certificate (or
other authentication info pro&acirc; <br>
vided) of the other side. The --key-method parameter has no
effect on this process.</p>

<p style="margin-top: 1em">(2) After the TLS connection is
established, the tunnel session keys are separately
negotiated over the existing secure TLS channel. Here,
--key-method determines the <br>
derivation of the tunnel session keys.</p>

<p style="margin-top: 1em">--tls-cipher l <br>
A list l of allowable TLS ciphers delimited by a colon
(&quot;:&quot;).</p>

<p style="margin-top: 1em">This setting can be used to
ensure that certain cipher suites are used (or not used) for
the TLS connection. OpenVPN uses TLS to secure the control
channel, over which <br>
the keys that are used to protect the actual VPN traffic are
exchanged.</p>

<p style="margin-top: 1em">The supplied list of ciphers is
(after potential OpenSSL/IANA name translation) simply
supplied to the crypto library. Please see the OpenSSL
and/or PolarSSL documenta&acirc; <br>
tion for details on the cipher list interpretation.</p>

<p style="margin-top: 1em">Use --show-tls to see a list of
TLS ciphers supported by your crypto library.</p>

<p style="margin-top: 1em">Warning! --tls-cipher is an
expert feature, which - if used correcly - can improve the
security of your VPN connection. But it is also easy to
unwittingly use it to <br>
carefully align a gun with your foot, or just break your
connection. Use with care!</p>

<p style="margin-top: 1em">The default for --tls-cipher is
to use PolarSSL&rsquo;s default cipher list when using
PolarSSL or
&quot;DEFAULT:!EXP:!LOW:!MEDIUM:!kDH:!kECDH:!DSS:!PSK:!SRP:!kRSA&quot;
when using <br>
OpenSSL.</p>

<p style="margin-top: 1em">--tls-timeout n <br>
Packet retransmit timeout on TLS control channel if no
acknowledgment from remote within n seconds (default=2).
When OpenVPN sends a control packet to its peer, it will
<br>
expect to receive an acknowledgement within n seconds or it
will retransmit the packet, subject to a TCP-like
exponential backoff algorithm. This parameter only applies
<br>
to control channel packets. Data channel packets (which
carry encrypted tunnel data) are never acknowledged,
sequenced, or retransmitted by OpenVPN because the higher
<br>
level network protocols running on top of the tunnel such as
TCP expect this role to be left to them.</p>

<p style="margin-top: 1em">--reneg-bytes n <br>
Renegotiate data channel key after n bytes sent or received
(disabled by default with an exception, see below). OpenVPN
allows the lifetime of a key to be expressed as a <br>
number of bytes encrypted/decrypted, a number of packets, or
a number of seconds. A key renegotiation will be forced if
any of these three criteria are met by either <br>
peer.</p>

<p style="margin-top: 1em">If using ciphers with cipher
block sizes less than 128-bits, --reneg-bytes is set to 64MB
by default, unless it is explicitly disabled by setting the
value to 0, but this <br>
is HIGHLY DISCOURAGED as this is designed to add some
protection against the SWEET32 attack vector. For more
information see the --cipher option.</p>

<p style="margin-top: 1em">--reneg-pkts n <br>
Renegotiate data channel key after n packets sent and
received (disabled by default).</p>

<p style="margin-top: 1em">--reneg-sec n <br>
Renegotiate data channel key after n seconds
(default=3600).</p>

<p style="margin-top: 1em">When using dual-factor
authentication, note that this default value may cause the
end user to be challenged to reauthorize once per hour.</p>

<p style="margin-top: 1em">Also, keep in mind that this
option can be used on both the client and server, and
whichever uses the lower value will be the one to trigger
the renegotiation. A common <br>
mistake is to set --reneg-sec to a higher value on either
the client or server, while the other side of the connection
is still using the default value of 3600 seconds, <br>
meaning that the renegotiation will still occur once per
3600 seconds. The solution is to increase --reneg-sec on
both the client and server, or set it to 0 on one side <br>
of the connection (to disable), and to your chosen value on
the other side.</p>

<p style="margin-top: 1em">--hand-window n <br>
Handshake Window -- the TLS-based key exchange must finalize
within n seconds of handshake initiation by any peer
(default = 60 seconds). If the handshake fails we will <br>
attempt to reset our connection with our peer and try again.
Even in the event of handshake failure we will still use our
expiring key for up to --tran-window seconds to <br>
maintain continuity of transmission of tunnel data.</p>

<p style="margin-top: 1em">--tran-window n <br>
Transition window -- our old key can live this many seconds
after a new a key renegotiation begins (default = 3600
seconds). This feature allows for a graceful transition <br>
from old to new key, and removes the key renegotiation
sequence from the critical path of tunnel data
forwarding.</p>

<p style="margin-top: 1em">--single-session <br>
After initially connecting to a remote peer, disallow any
new connections. Using this option means that a remote peer
cannot connect, disconnect, and then reconnect.</p>

<p style="margin-top: 1em">If the daemon is reset by a
signal or --ping-restart, it will allow one new
connection.</p>

<p style="margin-top: 1em">--single-session can be used
with --ping-exit or --inactive to create a single dynamic
session that will exit when finished.</p>

<p style="margin-top: 1em">--tls-exit <br>
Exit on TLS negotiation failure.</p>

<p style="margin-top: 1em">--tls-auth file [direction] <br>
Add an additional layer of HMAC authentication on top of the
TLS control channel to mitigate DoS attacks and attacks on
the TLS stack.</p>

<p style="margin-top: 1em">In a nutshell, --tls-auth
enables a kind of &quot;HMAC firewall&quot; on
OpenVPN&rsquo;s TCP/UDP port, where TLS control channel
packets bearing an incorrect HMAC signature can be dropped
<br>
immediately without response.</p>

<p style="margin-top: 1em">file (required) is a file in
OpenVPN static key format which can be generated by
--genkey</p>

<p style="margin-top: 1em">Older versions (up to 2.3)
supported a freeform passphrase file. This is no longer
supported in newer versions (2.4+).</p>

<p style="margin-top: 1em">See the --secret option for more
information on the optional direction parameter.</p>

<p style="margin-top: 1em">--tls-auth is recommended when
you are running OpenVPN in a mode where it is listening for
packets from any IP address, such as when --remote is not
specified, or --remote <br>
is specified with --float.</p>

<p style="margin-top: 1em">The rationale for this feature
is as follows. TLS requires a multi-packet exchange before
it is able to authenticate a peer. During this time before
authentication, <br>
OpenVPN is allocating resources (memory and CPU) to this
potential peer. The potential peer is also exposing many
parts of OpenVPN and the OpenSSL library to the packets <br>
it is sending. Most successful network attacks today seek to
either exploit bugs in programs (such as buffer overflow
attacks) or force a program to consume so many <br>
resources that it becomes unusable. Of course the first line
of defense is always to produce clean, well-audited code.
OpenVPN has been written with buffer overflow <br>
attack prevention as a top priority. But as history has
shown, many of the most widely used network applications
have, from time to time, fallen to buffer overflow <br>
attacks.</p>

<p style="margin-top: 1em">So as a second line of defense,
OpenVPN offers this special layer of authentication on top
of the TLS control channel so that every packet on the
control channel is <br>
authenticated by an HMAC signature and a unique ID for
replay protection. This signature will also help protect
against DoS (Denial of Service) attacks. An important <br>
rule of thumb in reducing vulnerability to DoS attacks is to
minimize the amount of resources a potential, but as yet
unauthenticated, client is able to consume.</p>

<p style="margin-top: 1em">--tls-auth does this by signing
every TLS control channel packet with an HMAC signature,
including packets which are sent before the TLS level has
had a chance to authen&acirc; <br>
ticate the peer. The result is that packets without the
correct signature can be dropped immediately upon reception,
before they have a chance to consume additional sys&acirc;
<br>
tem resources such as by initiating a TLS handshake.
--tls-auth can be strengthened by adding the
--replay-persist option which will keep OpenVPN&rsquo;s
replay protection <br>
state in a file so that it is not lost across restarts.</p>

<p style="margin-top: 1em">It should be emphasized that
this feature is optional and that the key file used with
--tls-auth gives a peer nothing more than the power to
initiate a TLS handshake. It <br>
is not used to encrypt or authenticate any tunnel data.</p>

<p style="margin-top: 1em">Use --tls-crypt instead if you
want to use the key file to not only authenticate, but also
encrypt the TLS control channel.</p>

<p style="margin-top: 1em">--tls-crypt keyfile</p>

<p style="margin-top: 1em">Encrypt and authenticate all
control channel packets with the key from keyfile. (See
--tls-auth for more background.)</p>

<p style="margin-top: 1em">Encrypting (and authenticating)
control channel packets:</p>

<p style="margin-top: 1em">&Acirc;&middot; provides more
privacy by hiding the certificate used for the TLS
connection,</p>

<p style="margin-top: 1em">&Acirc;&middot; makes it harder
to identify OpenVPN traffic as such,</p>

<p style="margin-top: 1em">&Acirc;&middot; provides
&quot;poor-man&rsquo;s&quot; post-quantum security, against
attackers who will never know the pre-shared key (i.e. no
forward secrecy).</p>

<p style="margin-top: 1em">In contrast to --tls-auth,
--tls-crypt does *not* require the user to set
--key-direction.</p>

<p style="margin-top: 1em">--askpass [file] <br>
Get certificate password from console or file before we
daemonize.</p>

<p style="margin-top: 1em">For the extremely security
conscious, it is possible to protect your private key with a
password. Of course this means that every time the OpenVPN
daemon is started you <br>
must be there to type the password. The --askpass option
allows you to start OpenVPN from the command line. It will
query you for a password before it daemonizes. To <br>
protect a private key with a password you should omit the
-nodes option when you use the openssl command line tool to
manage certificates and private keys.</p>

<p style="margin-top: 1em">If file is specified, read the
password from the first line of file. Keep in mind that
storing your password in a file to a certain extent
invalidates the extra security <br>
provided by using an encrypted key.</p>

<p style="margin-top: 1em">--auth-nocache <br>
Don&rsquo;t cache --askpass or --auth-user-pass
username/passwords in virtual memory.</p>

<p style="margin-top: 1em">If specified, this directive
will cause OpenVPN to immediately forget username/password
inputs after they are used. As a result, when OpenVPN needs
a username/password, <br>
it will prompt for input from stdin, which may be multiple
times during the duration of an OpenVPN session.</p>

<p style="margin-top: 1em">When using --auth-nocache in
combination with a user/password file and --chroot or
--daemon, make sure to use an absolute path.</p>

<p style="margin-top: 1em">This directive does not affect
the --http-proxy username/password. It is always cached.</p>

<p style="margin-top: 1em">--auth-token token <br>
This is not an option to be used directly in any
configuration files, but rather push this option from a
--client-connect script or a --plugin which hooks into the
OPEN&acirc; <br>
VPN_PLUGIN_CLIENT_CONNECT or
OPENVPN_PLUGIN_CLIENT_CONNECT_V2 calls. This option provides
a possibility to replace the clients password with an
authentication token dur&acirc; <br>
ing the lifetime of the OpenVPN client.</p>

<p style="margin-top: 1em">Whenever the connection is
renegotiated and the --auth-user-pass-verify script or
--plugin making use of the
OPENVPN_PLUGIN_AUTH_USER_PASS_VERIFY hook is triggered, it
<br>
will pass over this token as the password instead of the
password the user provided. The authentication token can
only be reset by a full reconnect where the server can <br>
push new options to the client. The password the user
entered is never preserved once an authentication token have
been set. If the OpenVPN server side rejects the <br>
authentication token, the client will receive an AUTH_FAIL
and disconnect.</p>

<p style="margin-top: 1em">The purpose of this is to enable
two factor authentication methods, such as HOTP or TOTP, to
be used without needing to retrieve a new OTP code each time
the connection is <br>
renegotiated. Another use case is to cache authentication
data on the client without needing to have the users
password cached in memory during the life time of the
ses&acirc; <br>
sion.</p>

<p style="margin-top: 1em">To make use of this feature, the
--client-connect script or --plugin needs to put</p>

<p style="margin-top: 1em">push &quot;auth-token
UNIQUE_TOKEN_VALUE&quot;</p>

<p style="margin-top: 1em">into the file/buffer for dynamic
configuration data. This will then make the OpenVPN server
to push this value to the client, which replaces the local
password with the <br>
UNIQUE_TOKEN_VALUE.</p>

<p style="margin-top: 1em">--tls-verify cmd <br>
Run command cmd to verify the X509 name of a pending TLS
connection that has otherwise passed all other tests of
certification (except for revocation via --crl-verify <br>
directive; the revocation test occurs after the --tls-verify
test).</p>

<p style="margin-top: 1em">cmd should return 0 to allow the
TLS handshake to proceed, or 1 to fail.</p>

<p style="margin-top: 1em">cmd consists of a path to script
(or executable program), optionally followed by arguments.
The path and arguments may be single- or double-quoted
and/or escaped using a <br>
backslash, and should be separated by one or more
spaces.</p>

<p style="margin-top: 1em">When cmd is executed two
arguments are appended after any arguments specified in cmd
, as follows:</p>

<p style="margin-top: 1em">cmd certificate_depth
subject</p>

<p style="margin-top: 1em">These arguments are,
respectively, the current certificate depth and the X509
common name (cn) of the peer.</p>

<p style="margin-top: 1em">This feature is useful if the
peer you want to trust has a certificate which was signed by
a certificate authority who also signed many other
certificates, where you don&rsquo;t <br>
necessarily want to trust all of them, but rather be
selective about which peer certificate you will accept. This
feature allows you to write a script which will test the
<br>
X509 name on a certificate and decide whether or not it
should be accepted. For a simple perl script which will test
the common name field on the certificate, see the <br>
file verify-cn in the OpenVPN distribution.</p>

<p style="margin-top: 1em">See the &quot;Environmental
Variables&quot; section below for additional parameters
passed as environmental variables.</p>

<p style="margin-top: 1em">--tls-export-cert directory <br>
Store the certificates the clients uses upon connection to
this directory. This will be done before --tls-verify is
called. The certificates will use a temporary name and <br>
will be deleted when the tls-verify script returns. The file
name used for the certificate is available via the peer_cert
environment variable.</p>

<p style="margin-top: 1em">--x509-username-field
[ext:]fieldname <br>
Field in the X.509 certificate subject to be used as the
username (default=CN). Typically, this option is specified
with fieldname as either of the following:</p>

<p style="margin-top: 1em">--x509-username-field
emailAddress <br>
--x509-username-field ext:subjectAltName</p>

<p style="margin-top: 1em">The first example uses the value
of the &quot;emailAddress&quot; attribute in the
certificate&rsquo;s Subject field as the username. The
second example uses the ext: prefix to signify <br>
that the X.509 extension fieldname
&quot;subjectAltName&quot; be searched for an rfc822Name
(email) field to be used as the username. In cases where
there are multiple email <br>
addresses in ext:fieldname, the last occurrence is
chosen.</p>

<p style="margin-top: 1em">When this option is used, the
--verify-x509-name option will match against the chosen
fieldname instead of the Common Name.</p>

<p style="margin-top: 1em">Please note: This option has a
feature which will convert an all-lowercase fieldname to
uppercase characters, e.g., ou -&gt; OU. A mixed-case
fieldname or one having the <br>
ext: prefix will be left as-is. This automatic upcasing
feature is deprecated and will be removed in a future
release.</p>

<p style="margin-top: 1em">--verify-x509-name name type
<br>
Accept connections only if a host&rsquo;s X.509 name is
equal to name. The remote host must also pass all other
tests of verification.</p>

<p style="margin-top: 1em">Which X.509 name is compared to
name depends on the setting of type. type can be
&quot;subject&quot; to match the complete subject DN
(default), &quot;name&quot; to match a subject RDN or <br>
&quot;name-prefix&quot; to match a subject RDN prefix. Which
RDN is verified as name depends on the --x509-username-field
option. But it defaults to the common name (CN), e.g. a <br>
certificate with a subject DN &quot;C=KG, ST=NA, L=Bishkek,
CN=Server-1&quot; would be matched by:</p>

<p style="margin-top: 1em">--verify-x509-name &rsquo;C=KG,
ST=NA, L=Bishkek, CN=Server-1&rsquo; and --verify-x509-name
Server-1 name or you could use --verify-x509-name Server
-name-prefix if you want a client <br>
to only accept connections to &quot;Server-1&quot;,
&quot;Server-2&quot;, etc.</p>

<p style="margin-top: 1em">--verify-x509-name is a useful
replacement for the --tls-verify option to verify the remote
host, because --verify-x509-name works in a --chroot
environment without any <br>
dependencies.</p>

<p style="margin-top: 1em">Using a name prefix is a useful
alternative to managing a CRL (Certificate Revocation List)
on the client, since it allows the client to refuse all
certificates except for <br>
those associated with designated servers.</p>

<p style="margin-top: 1em">NOTE: Test against a name prefix
only when you are using OpenVPN with a custom CA certificate
that is under your control. Never use this option with type
&quot;name-prefix&quot; <br>
when your client certificates are signed by a third party,
such as a commercial web CA.</p>

<p style="margin-top: 1em">--x509-track attribute <br>
Save peer X509 attribute value in environment for use by
plugins and management interface. Prepend a &rsquo;+&rsquo;
to attribute to save values from full cert chain. Values
will be <br>
encoded as
X509_&lt;depth&gt;_&lt;attribute&gt;=&lt;value&gt;. Multiple
--x509-track options can be defined to track multiple
attributes.</p>

<p style="margin-top: 1em">--ns-cert-type client|server
<br>
Require that peer certificate was signed with an explicit
nsCertType designation of &quot;client&quot; or
&quot;server&quot;.</p>

<p style="margin-top: 1em">This is a useful security option
for clients, to ensure that the host they connect with is a
designated server.</p>

<p style="margin-top: 1em">See the
easy-rsa/build-key-server script for an example of how to
generate a certificate with the nsCertType field set to
&quot;server&quot;.</p>

<p style="margin-top: 1em">If the server
certificate&rsquo;s nsCertType field is set to
&quot;server&quot;, then the clients can verify this with
--ns-cert-type server.</p>

<p style="margin-top: 1em">This is an important security
precaution to protect against a man-in-the-middle attack
where an authorized client attempts to connect to another
client by impersonating <br>
the server. The attack is easily prevented by having clients
verify the server certificate using any one of
--ns-cert-type, --verify-x509-name, or --tls-verify.</p>

<p style="margin-top: 1em">--remote-cert-ku v... <br>
Require that peer certificate was signed with an explicit
key usage.</p>

<p style="margin-top: 1em">This is a useful security option
for clients, to ensure that the host they connect to is a
designated server.</p>

<p style="margin-top: 1em">The key usage should be encoded
in hex, more than one key usage can be specified.</p>

<p style="margin-top: 1em">--remote-cert-eku oid <br>
Require that peer certificate was signed with an explicit
extended key usage.</p>

<p style="margin-top: 1em">This is a useful security option
for clients, to ensure that the host they connect to is a
designated server.</p>

<p style="margin-top: 1em">The extended key usage should be
encoded in oid notation, or OpenSSL symbolic
representation.</p>

<p style="margin-top: 1em">--remote-cert-tls client|server
<br>
Require that peer certificate was signed with an explicit
key usage and extended key usage based on RFC3280 TLS
rules.</p>

<p style="margin-top: 1em">This is a useful security option
for clients, to ensure that the host they connect to is a
designated server.</p>

<p style="margin-top: 1em">The --remote-cert-tls client
option is equivalent to --remote-cert-ku 80 08 88
--remote-cert-eku &quot;TLS Web Client
Authentication&quot;</p>

<p style="margin-top: 1em">The key usage is
digitalSignature and/or keyAgreement.</p>

<p style="margin-top: 1em">The --remote-cert-tls server
option is equivalent to --remote-cert-ku a0 88
--remote-cert-eku &quot;TLS Web Server
Authentication&quot;</p>

<p style="margin-top: 1em">The key usage is
digitalSignature and ( keyEncipherment or keyAgreement
).</p>

<p style="margin-top: 1em">This is an important security
precaution to protect against a man-in-the-middle attack
where an authorized client attempts to connect to another
client by impersonating <br>
the server. The attack is easily prevented by having clients
verify the server certificate using any one of
--remote-cert-tls, --verify-x509-name, or --tls-verify.</p>

<p style="margin-top: 1em">--crl-verify crl
[&rsquo;dir&rsquo;] <br>
Check peer certificate against the file crl in PEM
format.</p>

<p style="margin-top: 1em">A CRL (certificate revocation
list) is used when a particular key is compromised but when
the overall PKI is still intact.</p>

<p style="margin-top: 1em">Suppose you had a PKI consisting
of a CA, root certificate, and a number of client
certificates. Suppose a laptop computer containing a client
key and certificate was <br>
stolen. By adding the stolen certificate to the CRL file,
you could reject any connection which attempts to use it,
while preserving the overall integrity of the PKI.</p>

<p style="margin-top: 1em">The only time when it would be
necessary to rebuild the entire PKI from scratch would be if
the root certificate key itself was compromised.</p>

<p style="margin-top: 1em">If the optional dir flag is
specified, enable a different mode where crl is a directory
containing files named as revoked serial numbers (the files
may be empty, the con&acirc; <br>
tents are never read). If a client requests a connection,
where the client certificate serial number (decimal string)
is the name of a file present in the directory, it <br>
will be rejected.</p>

<p style="margin-top: 1em">Note: As the crl file (or
directory) is read every time a peer connects, if you are
dropping root privileges with --user, make sure that this
user has sufficient privi&acirc; <br>
leges to read the file.</p>

<p style="margin-top: 1em">SSL Library information: <br>
--show-ciphers <br>
(Standalone) Show all cipher algorithms to use with the
--cipher option.</p>

<p style="margin-top: 1em">--show-digests <br>
(Standalone) Show all message digest algorithms to use with
the --auth option.</p>

<p style="margin-top: 1em">--show-tls <br>
(Standalone) Show all TLS ciphers supported by the crypto
library. OpenVPN uses TLS to secure the control channel,
over which the keys that are used to protect the actual <br>
VPN traffic are exchanged. The TLS ciphers will be sorted
from highest preference (most secure) to lowest.</p>

<p style="margin-top: 1em">Be aware that whether a cipher
suite in this list can actually work depends on the specific
setup of both peers (e.g. both peers must support the
cipher, and an ECDSA <br>
cipher suite will not work if you are using an RSA
certificate, etc.).</p>

<p style="margin-top: 1em">--show-engines <br>
(Standalone) Show currently available hardware-based crypto
acceleration engines supported by the OpenSSL library.</p>

<p style="margin-top: 1em">--show-curves <br>
(Standalone) Show all available elliptic curves to use with
the --ecdh-curve option.</p>

<p style="margin-top: 1em">Generate a random key: <br>
Used only for non-TLS static key encryption mode.</p>

<p style="margin-top: 1em">--genkey <br>
(Standalone) Generate a random key to be used as a shared
secret, for use with the --secret option. This file must be
shared with the peer over a pre-existing secure <br>
channel such as scp(1)</p>

<p style="margin-top: 1em">--secret file <br>
Write key to file.</p>

<p style="margin-top: 1em">TUN/TAP persistent tunnel config
mode: <br>
Available with linux 2.4.7+. These options comprise a
standalone mode of OpenVPN which can be used to create and
delete persistent tunnels.</p>

<p style="margin-top: 1em">--mktun <br>
(Standalone) Create a persistent tunnel on platforms which
support them such as Linux. Normally TUN/TAP tunnels exist
only for the period of time that an application has <br>
them open. This option takes advantage of the TUN/TAP
driver&rsquo;s ability to build persistent tunnels that live
through multiple instantiations of OpenVPN and die only when
<br>
they are deleted or the machine is rebooted.</p>

<p style="margin-top: 1em">One of the advantages of
persistent tunnels is that they eliminate the need for
separate --up and --down scripts to run the appropriate
ifconfig(8) and route(8) commands. <br>
These commands can be placed in the the same shell script
which starts or terminates an OpenVPN session.</p>

<p style="margin-top: 1em">Another advantage is that open
connections through the TUN/TAP-based tunnel will not be
reset if the OpenVPN peer restarts. This can be useful to
provide uninterrupted <br>
connectivity through the tunnel in the event of a DHCP reset
of the peer&rsquo;s public IP address (see the --ipchange
option above).</p>

<p style="margin-top: 1em">One disadvantage of persistent
tunnels is that it is harder to automatically configure
their MTU value (see --link-mtu and --tun-mtu above).</p>

<p style="margin-top: 1em">On some platforms such as
Windows, TAP-Win32 tunnels are persistent by default.</p>

<p style="margin-top: 1em">--rmtun <br>
(Standalone) Remove a persistent tunnel.</p>

<p style="margin-top: 1em">--dev tunX | tapX <br>
TUN/TAP device</p>

<p style="margin-top: 1em">--user user <br>
Optional user to be owner of this tunnel.</p>

<p style="margin-top: 1em">--group group <br>
Optional group to be owner of this tunnel.</p>

<p style="margin-top: 1em">Windows-Specific Options: <br>
--win-sys path <br>
Set the Windows system directory pathname to use when
looking for system executables such as route.exe and
netsh.exe. By default, if this directive is not specified,
<br>
OpenVPN will use the SystemRoot environment variable.</p>

<p style="margin-top: 1em">This option have changed
behaviour in OpenVPN 2.3. Earlier you had to define
--win-sys env to use the SystemRoot environment variable,
otherwise it defaulted to C:WIN&acirc; <br>
DOWS. It is not needed to use the env keyword any more, and
it will just be ignored. A warning is logged when this is
found in the configuration file.</p>

<p style="margin-top: 1em">--ip-win32 method <br>
When using --ifconfig on Windows, set the TAP-Win32 adapter
IP address and netmask using method. Don&rsquo;t use this
option unless you are also using --ifconfig.</p>

<p style="margin-top: 1em">manual -- Don&rsquo;t set the IP
address or netmask automatically. Instead output a message
to the console telling the user to configure the adapter
manually and indicating the <br>
IP/netmask which OpenVPN expects the adapter to be set
to.</p>

<p style="margin-top: 1em">dynamic [offset] [lease-time] --
Automatically set the IP address and netmask by replying to
DHCP query messages generated by the kernel. This mode is
probably the <br>
&quot;cleanest&quot; solution for setting the TCP/IP
properties since it uses the well-known DHCP protocol. There
are, however, two prerequisites for using this mode: (1) The
<br>
TCP/IP properties for the TAP-Win32 adapter must be set to
&quot;Obtain an IP address automatically,&quot; and (2)
OpenVPN needs to claim an IP address in the subnet for use
as the <br>
virtual DHCP server address. By default in --dev tap mode,
OpenVPN will take the normally unused first address in the
subnet. For example, if your subnet is 192.168.4.0 <br>
netmask 255.255.255.0, then OpenVPN will take the IP address
192.168.4.0 to use as the virtual DHCP server address. In
--dev tun mode, OpenVPN will cause the DHCP server <br>
to masquerade as if it were coming from the remote endpoint.
The optional offset parameter is an integer which is &gt;
-256 and &lt; 256 and which defaults to -1. If offset is
<br>
positive, the DHCP server will masquerade as the IP address
at network address + offset. If offset is negative, the DHCP
server will masquerade as the IP address at <br>
broadcast address + offset. The Windows ipconfig /all
command can be used to show what Windows thinks the DHCP
server address is. OpenVPN will &quot;claim&quot; this
address, so <br>
make sure to use a free address. Having said that, different
OpenVPN instantiations, including different ends of the same
connection, can share the same virtual DHCP <br>
server address. The lease-time parameter controls the lease
time of the DHCP assignment given to the TAP-Win32 adapter,
and is denoted in seconds. Normally a very long <br>
lease time is preferred because it prevents routes involving
the TAP-Win32 adapter from being lost when the system goes
to sleep. The default lease time is one year.</p>

<p style="margin-top: 1em">netsh -- Automatically set the
IP address and netmask using the Windows command-line
&quot;netsh&quot; command. This method appears to work
correctly on Windows XP but not Windows <br>
2000.</p>

<p style="margin-top: 1em">ipapi -- Automatically set the
IP address and netmask using the Windows IP Helper API. This
approach does not have ideal semantics, though testing has
indicated that it <br>
works okay in practice. If you use this option, it is best
to leave the TCP/IP properties for the TAP-Win32 adapter in
their default state, i.e. &quot;Obtain an IP address <br>
automatically.&quot;</p>

<p style="margin-top: 1em">adaptive -- (Default) Try
dynamic method initially and fail over to netsh if the DHCP
negotiation with the TAP-Win32 adapter does not succeed in
20 seconds. Such failures <br>
have been known to occur when certain third-party firewall
packages installed on the client machine block the DHCP
negotiation used by the TAP-Win32 adapter. Note that if <br>
the netsh failover occurs, the TAP-Win32 adapter TCP/IP
properties will be reset from DHCP to static, and this will
cause future OpenVPN startups using the adaptive mode <br>
to use netsh immediately, rather than trying dynamic first.
To &quot;unstick&quot; the adaptive mode from using netsh,
run OpenVPN at least once using the dynamic mode to restore
<br>
the TAP-Win32 adapter TCP/IP properties to a DHCP
configuration.</p>

<p style="margin-top: 1em">--route-method m <br>
Which method m to use for adding routes on Windows?</p>

<p style="margin-top: 1em">adaptive (default) -- Try IP
helper API first. If that fails, fall back to the route.exe
shell command. <br>
ipapi -- Use IP helper API. <br>
exe -- Call the route.exe shell command.</p>

<p style="margin-top: 1em">--dhcp-option type [parm] <br>
Set extended TAP-Win32 TCP/IP properties, must be used with
--ip-win32 dynamic or --ip-win32 adaptive. This option can
be used to set additional TCP/IP properties on the <br>
TAP-Win32 adapter, and is particularly useful for
configuring an OpenVPN client to access a Samba server
across the VPN.</p>

<p style="margin-top: 1em">DOMAIN name -- Set
Connection-specific DNS Suffix.</p>

<p style="margin-top: 1em">DNS addr -- Set primary domain
name server IPv4 address. Repeat this option to set
secondary DNS server addresses.</p>

<p style="margin-top: 1em">DNS6 addr -- Set primary domain
name server IPv6 address. Repeat this option to set
secondary DNS server IPv6 addresses.</p>

<p style="margin-top: 1em">Note: currently this is handled
using netsh (the existing DHCP code can only do IPv4 DHCP,
and that protocol only permits IPv4 addresses anywhere). The
option will be put <br>
into the environment, so an --up script could act upon it if
needed.</p>

<p style="margin-top: 1em">WINS addr -- Set primary WINS
server address (NetBIOS over TCP/IP Name Server). Repeat
this option to set secondary WINS server addresses.</p>

<p style="margin-top: 1em">NBDD addr -- Set primary NBDD
server address (NetBIOS over TCP/IP Datagram Distribution
Server) Repeat this option to set secondary NBDD server
addresses.</p>

<p style="margin-top: 1em">NTP addr -- Set primary NTP
server address (Network Time Protocol). Repeat this option
to set secondary NTP server addresses.</p>

<p style="margin-top: 1em">NBT type -- Set NetBIOS over
TCP/IP Node type. Possible options: 1 = b-node (broadcasts),
2 = p-node (point-to-point name queries to a WINS server), 4
= m-node (broadcast <br>
then query name server), and 8 = h-node (query name server,
then broadcast).</p>

<p style="margin-top: 1em">NBS scope-id -- Set NetBIOS over
TCP/IP Scope. A NetBIOS Scope ID provides an extended naming
service for the NetBIOS over TCP/IP (Known as NBT) module.
The primary pur&acirc; <br>
pose of a NetBIOS scope ID is to isolate NetBIOS traffic on
a single network to only those nodes with the same NetBIOS
scope ID. The NetBIOS scope ID is a character <br>
string that is appended to the NetBIOS name. The NetBIOS
scope ID on two hosts must match, or the two hosts will not
be able to communicate. The NetBIOS Scope ID also <br>
allows computers to use the same computer name, as they have
different scope IDs. The Scope ID becomes a part of the
NetBIOS name, making the name unique. (This descrip&acirc;
<br>
tion of NetBIOS scopes courtesy of NeonSurge@abyss.com)</p>

<p style="margin-top: 1em">DISABLE-NBT -- Disable
Netbios-over-TCP/IP.</p>

<p style="margin-top: 1em">Note that if --dhcp-option is
pushed via --push to a non-windows client, the option will
be saved in the client&rsquo;s environment before the up
script is called, under the <br>
name &quot;foreign_option_{n}&quot;.</p>

<p style="margin-top: 1em">--tap-sleep n <br>
Cause OpenVPN to sleep for n seconds immediately after the
TAP-Win32 adapter state is set to &quot;connected&quot;.</p>

<p style="margin-top: 1em">This option is intended to be
used to troubleshoot problems with the --ifconfig and
--ip-win32 options, and is used to give the TAP-Win32
adapter time to come up before <br>
Windows IP Helper API operations are applied to it.</p>

<p style="margin-top: 1em">--show-net-up <br>
Output OpenVPN&rsquo;s view of the system routing table and
network adapter list to the syslog or log file after the
TUN/TAP adapter has been brought up and any routes have been
<br>
added.</p>

<p style="margin-top: 1em">--block-outside-dns <br>
Block DNS servers on other network adapters to prevent DNS
leaks. This option prevents any application from accessing
TCP or UDP port 53 except one inside the tunnel. It <br>
uses Windows Filtering Platform (WFP) and works on Windows
Vista or later.</p>

<p style="margin-top: 1em">This option is considered
unknown on non-Windows platforms and unsupported on Windows
XP, resulting in fatal error. You may want to use --setenv
opt or <br>
--ignore-unknown-option (not suitable for Windows XP) to
ignore said error. Note that pushing unknown options from
server does not trigger fatal errors.</p>

<p style="margin-top: 1em">--dhcp-renew <br>
Ask Windows to renew the TAP adapter lease on startup. This
option is normally unnecessary, as Windows automatically
triggers a DHCP renegotiation on the TAP adapter when <br>
it comes up, however if you set the TAP-Win32 adapter Media
Status property to &quot;Always Connected&quot;, you may
need this flag.</p>

<p style="margin-top: 1em">--dhcp-release <br>
Ask Windows to release the TAP adapter lease on shutdown.
This option has the same caveats as --dhcp-renew above.</p>

<p style="margin-top: 1em">--register-dns <br>
Run ipconfig /flushdns and ipconfig /registerdns on
connection initiation. This is known to kick Windows into
recognizing pushed DNS servers.</p>

<p style="margin-top: 1em">--pause-exit <br>
Put up a &quot;press any key to continue&quot; message on
the console prior to OpenVPN program exit. This option is
automatically used by the Windows explorer when OpenVPN is
run <br>
on a configuration file using the right-click explorer
menu.</p>

<p style="margin-top: 1em">--service exit-event [0|1] <br>
Should be used when OpenVPN is being automatically executed
by another program in such a context that no interaction
with the user via display or keyboard is possible. In <br>
general, end-users should never need to explicitly use this
option, as it is automatically added by the OpenVPN service
wrapper when a given OpenVPN configuration is being <br>
run as a service.</p>

<p style="margin-top: 1em">exit-event is the name of a
Windows global event object, and OpenVPN will continuously
monitor the state of this event object and exit when it
becomes signaled.</p>

<p style="margin-top: 1em">The second parameter indicates
the initial state of exit-event and normally defaults to
0.</p>

<p style="margin-top: 1em">Multiple OpenVPN processes can
be simultaneously executed with the same exit-event
parameter. In any case, the controlling process can signal
exit-event, causing all such <br>
OpenVPN processes to exit.</p>

<p style="margin-top: 1em">When executing an OpenVPN
process using the --service directive, OpenVPN will probably
not have a console window to output status/error messages,
therefore it is useful to <br>
use --log or --log-append to write these messages to a
file.</p>

<p style="margin-top: 1em">--show-adapters <br>
(Standalone) Show available TAP-Win32 adapters which can be
selected using the --dev-node option. On non-Windows
systems, the ifconfig(8) command provides similar
func&acirc; <br>
tionality.</p>

<p style="margin-top: 1em">--allow-nonadmin [TAP-adapter]
<br>
(Standalone) Set TAP-adapter to allow access from
non-administrative accounts. If TAP-adapter is omitted, all
TAP adapters on the system will be configured to allow non-
<br>
admin access. The non-admin access setting will only persist
for the length of time that the TAP-Win32 device object and
driver remain loaded, and will need to be re- <br>
enabled after a reboot, or if the driver is unloaded and
reloaded. This directive can only be used by an
administrator.</p>

<p style="margin-top: 1em">--show-valid-subnets <br>
(Standalone) Show valid subnets for --dev tun emulation.
Since the TAP-Win32 driver exports an ethernet interface to
Windows, and since TUN devices are point-to-point in <br>
nature, it is necessary for the TAP-Win32 driver to impose
certain constraints on TUN endpoint address selection.</p>

<p style="margin-top: 1em">Namely, the point-to-point
endpoints used in TUN device emulation must be the middle
two addresses of a /30 subnet (netmask 255.255.255.252).</p>

<p style="margin-top: 1em">--show-net <br>
(Standalone) Show OpenVPN&rsquo;s view of the system routing
table and network adapter list.</p>

<p style="margin-top: 1em">PKCS#11 Standalone Options: <br>
--show-pkcs11-ids [provider] [cert_private] <br>
(Standalone) Show PKCS#11 token object list. Specify
cert_private as 1 if certificates are stored as private
objects.</p>

<p style="margin-top: 1em">If p11-kit is present on the
system, the provider argument is optional; if omitted the
default p11-kit-proxy.so module will be queried.</p>

<p style="margin-top: 1em">--verb option can be used BEFORE
this option to produce debugging information.</p>

<p style="margin-top: 1em">Standalone Debug Options: <br>
--show-gateway [v6target] <br>
(Standalone) Show current IPv4 and IPv6 default gateway and
interface towards the gateway (if the protocol in question
is enabled). If an IPv6 address is passed as argu&acirc;
<br>
ment, the IPv6 route for this host is reported.</p>

<p style="margin-top: 1em">IPv6 Related Options <br>
The following options exist to support IPv6 tunneling in
peer-to-peer and client-server mode. All options are modeled
after their IPv4 counterparts, so more detailed
explana&acirc; <br>
tions given there apply here as well (except for --topology
, which has no effect on IPv6).</p>

<p style="margin-top: 1em">--ifconfig-ipv6 ipv6addr/bits
ipv6remote <br>
configure IPv6 address ipv6addr/bits on the
&lsquo;&lsquo;tun&rsquo;&rsquo; device. The second parameter
is used as route target for --route-ipv6 if no gateway is
specified.</p>

<p style="margin-top: 1em">--route-ipv6 ipv6addr/bits
[gateway] [metric] <br>
setup IPv6 routing in the system to send the specified IPv6
network into OpenVPN&rsquo;s
&lsquo;&lsquo;tun&rsquo;&rsquo;. The gateway parameter is
only used for IPv6 routes across
&lsquo;&lsquo;tap&rsquo;&rsquo; devices, and <br>
if missing, the &lsquo;&lsquo;ipv6remote&rsquo;&rsquo; field
from --ifconfig-ipv6 is used.</p>

<p style="margin-top: 1em">--server-ipv6 ipv6addr/bits <br>
convenience-function to enable a number of IPv6 related
options at once, namely --ifconfig-ipv6,
--ifconfig-ipv6-pool and --push tun-ipv6 Is only accepted if
&lsquo;&lsquo;--mode <br>
server&rsquo;&rsquo; or &lsquo;&lsquo;--server&rsquo;&rsquo;
is set. Pushing of the --tun-ipv6 directive is done for
older clients which require an explicit
&lsquo;&lsquo;--tun-ipv6&rsquo;&rsquo; in their
configuration.</p>

<p style="margin-top: 1em">--ifconfig-ipv6-pool
ipv6addr/bits <br>
Specify an IPv6 address pool for dynamic assignment to
clients. The pool starts at ipv6addr and matches the offset
determined from the start of the IPv4 pool.</p>

<p style="margin-top: 1em">--ifconfig-ipv6-push
ipv6addr/bits ipv6remote <br>
for ccd/ per-client static IPv6 interface configuration, see
--client-config-dir and --ifconfig-push for more
details.</p>

<p style="margin-top: 1em">--iroute-ipv6 ipv6addr/bits <br>
for ccd/ per-client static IPv6 route configuration, see
--iroute for more details how to setup and use this, and how
--iroute and --route interact.</p>

<p style="margin-top: 1em">SCRIPTING AND ENVIRONMENTAL
VARIABLES <br>
OpenVPN exports a series of environmental variables for use
by user-defined scripts.</p>

<p style="margin-top: 1em">Script Order of Execution <br>
--up Executed after TCP/UDP socket bind and TUN/TAP
open.</p>

<p style="margin-top: 1em">--tls-verify <br>
Executed when we have a still untrusted remote peer.</p>

<p style="margin-top: 1em">--ipchange <br>
Executed after connection authentication, or remote IP
address change.</p>

<p style="margin-top: 1em">--client-connect <br>
Executed in --mode server mode immediately after client
authentication.</p>

<p style="margin-top: 1em">--route-up <br>
Executed after connection authentication, either immediately
after, or some number of seconds after as defined by the
--route-delay option.</p>

<p style="margin-top: 1em">--route-pre-down <br>
Executed right before the routes are removed.</p>

<p style="margin-top: 1em">--client-disconnect <br>
Executed in --mode server mode on client instance
shutdown.</p>

<p style="margin-top: 1em">--down Executed after TCP/UDP
and TUN/TAP close.</p>

<p style="margin-top: 1em">--learn-address <br>
Executed in --mode server mode whenever an IPv4
address/route or MAC address is added to OpenVPN&rsquo;s
internal routing table.</p>

<p style="margin-top: 1em">--auth-user-pass-verify <br>
Executed in --mode server mode on new client connections,
when the client is still untrusted.</p>

<p style="margin-top: 1em">String Types and Remapping <br>
In certain cases, OpenVPN will perform remapping of
characters in strings. Essentially, any characters outside
the set of permitted characters for each string type will be
con&acirc; <br>
verted to underbar (&rsquo;_&rsquo;).</p>

<p style="margin-top: 1em">Q: Why is string remapping
necessary?</p>

<p style="margin-top: 1em">A: It&rsquo;s an important
security feature to prevent the malicious coding of strings
from untrusted sources to be passed as parameters to
scripts, saved in the environment, used as a <br>
common name, translated to a filename, etc.</p>

<p style="margin-top: 1em">Q: Can string remapping be
disabled?</p>

<p style="margin-top: 1em">A: Yes, by using the
--no-name-remapping option, however this should be
considered an advanced option.</p>

<p style="margin-top: 1em">Here is a brief rundown of
OpenVPN&rsquo;s current string types and the permitted
character class for each string:</p>

<p style="margin-top: 1em">X509 Names: Alphanumeric,
underbar (&rsquo;_&rsquo;), dash (&rsquo;-&rsquo;), dot
(&rsquo;.&rsquo;), at (&rsquo;@&rsquo;), colon
(&rsquo;:&rsquo;), slash (&rsquo;/&rsquo;), and equal
(&rsquo;=&rsquo;). Alphanumeric is defined as a character
which will cause the <br>
C library isalnum() function to return true.</p>

<p style="margin-top: 1em">Common Names: Alphanumeric,
underbar (&rsquo;_&rsquo;), dash (&rsquo;-&rsquo;), dot
(&rsquo;.&rsquo;), and at (&rsquo;@&rsquo;).</p>

<p style="margin-top: 1em">--auth-user-pass username: Same
as Common Name, with one exception: starting with OpenVPN
2.0.1, the username is passed to the
OPENVPN_PLUGIN_AUTH_USER_PASS_VERIFY plugin in its <br>
raw form, without string remapping.</p>

<p style="margin-top: 1em">--auth-user-pass password: Any
&quot;printable&quot; character except CR or LF. Printable
is defined to be a character which will cause the C library
isprint() function to return true.</p>

<p style="margin-top: 1em">--client-config-dir filename as
derived from common name or username: Alphanumeric, underbar
(&rsquo;_&rsquo;), dash (&rsquo;-&rsquo;), and dot
(&rsquo;.&rsquo;) except for &quot;.&quot; or &quot;..&quot;
as standalone strings. As of <br>
2.0.1-rc6, the at (&rsquo;@&rsquo;) character has been added
as well for compatibility with the common name character
class.</p>

<p style="margin-top: 1em">Environmental variable names:
Alphanumeric or underbar (&rsquo;_&rsquo;).</p>

<p style="margin-top: 1em">Environmental variable values:
Any printable character.</p>

<p style="margin-top: 1em">For all cases, characters in a
string which are not members of the legal character class
for that string type will be remapped to underbar
(&rsquo;_&rsquo;).</p>

<p style="margin-top: 1em">Environmental Variables <br>
Once set, a variable is persisted indefinitely until it is
reset by a new value or a restart,</p>

<p style="margin-top: 1em">As of OpenVPN 2.0-beta12, in
server mode, environmental variables set by OpenVPN are
scoped according to the client objects they are associated
with, so there should not be any <br>
issues with scripts having access to stale, previously set
variables which refer to different client instances.</p>

<p style="margin-top: 1em">bytes_received <br>
Total number of bytes received from client during VPN
session. Set prior to execution of the --client-disconnect
script.</p>

<p style="margin-top: 1em">bytes_sent <br>
Total number of bytes sent to client during VPN session. Set
prior to execution of the --client-disconnect script.</p>

<p style="margin-top: 1em">common_name <br>
The X509 common name of an authenticated client. Set prior
to execution of --client-connect, --client-disconnect, and
--auth-user-pass-verify scripts.</p>

<p style="margin-top: 1em">config Name of first --config
file. Set on program initiation and reset on SIGHUP.</p>

<p style="margin-top: 1em">daemon Set to &quot;1&quot; if
the --daemon directive is specified, or &quot;0&quot;
otherwise. Set on program initiation and reset on
SIGHUP.</p>

<p style="margin-top: 1em">daemon_log_redirect <br>
Set to &quot;1&quot; if the --log or --log-append directives
are specified, or &quot;0&quot; otherwise. Set on program
initiation and reset on SIGHUP.</p>

<p style="margin-top: 1em">dev The actual name of the
TUN/TAP device, including a unit number if it exists. Set
prior to --up or --down script execution.</p>

<p style="margin-top: 1em">dev_idx <br>
On Windows, the device index of the TUN/TAP adapter (to be
used in netsh.exe calls which sometimes just do not work
right with interface names). Set prior to --up or <br>
--down script execution.</p>

<p style="margin-top: 1em">foreign_option_{n} <br>
An option pushed via --push to a client which does not
natively support it, such as --dhcp-option on a non-Windows
system, will be recorded to this environmental variable <br>
sequence prior to --up script execution.</p>

<p style="margin-top: 1em">ifconfig_broadcast <br>
The broadcast address for the virtual ethernet segment which
is derived from the --ifconfig option when --dev tap is
used. Set prior to OpenVPN calling the ifconfig or <br>
netsh (windows version of ifconfig) commands which normally
occurs prior to --up script execution.</p>

<p style="margin-top: 1em">ifconfig_ipv6_local <br>
The local VPN endpoint IPv6 address specified in the
--ifconfig-ipv6 option (first parameter). Set prior to
OpenVPN calling the ifconfig or netsh (windows version of
<br>
ifconfig) commands which normally occurs prior to --up
script execution.</p>

<p style="margin-top: 1em">ifconfig_ipv6_netbits <br>
The prefix length of the IPv6 network on the VPN interface.
Derived from the /nnn parameter of the IPv6 address in the
--ifconfig-ipv6 option (first parameter). Set <br>
prior to OpenVPN calling the ifconfig or netsh (windows
version of ifconfig) commands which normally occurs prior to
--up script execution.</p>

<p style="margin-top: 1em">ifconfig_ipv6_remote <br>
The remote VPN endpoint IPv6 address specified in the
--ifconfig-ipv6 option (second parameter). Set prior to
OpenVPN calling the ifconfig or netsh (windows version of
<br>
ifconfig) commands which normally occurs prior to --up
script execution.</p>

<p style="margin-top: 1em">ifconfig_local <br>
The local VPN endpoint IP address specified in the
--ifconfig option (first parameter). Set prior to OpenVPN
calling the ifconfig or netsh (windows version of ifconfig)
<br>
commands which normally occurs prior to --up script
execution.</p>

<p style="margin-top: 1em">ifconfig_remote <br>
The remote VPN endpoint IP address specified in the
--ifconfig option (second parameter) when --dev tun is used.
Set prior to OpenVPN calling the ifconfig or netsh
(win&acirc; <br>
dows version of ifconfig) commands which normally occurs
prior to --up script execution.</p>

<p style="margin-top: 1em">ifconfig_netmask <br>
The subnet mask of the virtual ethernet segment that is
specified as the second parameter to --ifconfig when --dev
tap is being used. Set prior to OpenVPN calling the <br>
ifconfig or netsh (windows version of ifconfig) commands
which normally occurs prior to --up script execution.</p>

<p style="margin-top: 1em">ifconfig_pool_local_ip <br>
The local virtual IP address for the TUN/TAP tunnel taken
from an --ifconfig-push directive if specified, or otherwise
from the ifconfig pool (controlled by the --ifcon&acirc;
<br>
fig-pool config file directive). Only set for --dev tun
tunnels. This option is set on the server prior to execution
of the --client-connect and --client-disconnect <br>
scripts.</p>

<p style="margin-top: 1em">ifconfig_pool_netmask <br>
The virtual IP netmask for the TUN/TAP tunnel taken from an
--ifconfig-push directive if specified, or otherwise from
the ifconfig pool (controlled by the --ifconfig-pool <br>
config file directive). Only set for --dev tap tunnels. This
option is set on the server prior to execution of the
--client-connect and --client-disconnect scripts.</p>

<p style="margin-top: 1em">ifconfig_pool_remote_ip <br>
The remote virtual IP address for the TUN/TAP tunnel taken
from an --ifconfig-push directive if specified, or otherwise
from the ifconfig pool (controlled by the --ifcon&acirc;
<br>
fig-pool config file directive). This option is set on the
server prior to execution of the --client-connect and
--client-disconnect scripts.</p>

<p style="margin-top: 1em">link_mtu <br>
The maximum packet size (not including the IP header) of
tunnel data in UDP tunnel transport mode. Set prior to --up
or --down script execution.</p>

<p style="margin-top: 1em">local The --local parameter. Set
on program initiation and reset on SIGHUP.</p>

<p style="margin-top: 1em">local_port <br>
The local port number or name, specified by --port or
--lport. Set on program initiation and reset on SIGHUP.</p>

<p style="margin-top: 1em">password <br>
The password provided by a connecting client. Set prior to
--auth-user-pass-verify script execution only when the
via-env modifier is specified, and deleted from the <br>
environment after the script returns.</p>

<p style="margin-top: 1em">proto The --proto parameter. Set
on program initiation and reset on SIGHUP.</p>

<p style="margin-top: 1em">remote_{n} <br>
The --remote parameter. Set on program initiation and reset
on SIGHUP.</p>

<p style="margin-top: 1em">remote_port_{n} <br>
The remote port number, specified by --port or --rport. Set
on program initiation and reset on SIGHUP.</p>

<p style="margin-top: 1em">route_net_gateway <br>
The pre-existing default IP gateway in the system routing
table. Set prior to --up script execution.</p>

<p style="margin-top: 1em">route_vpn_gateway <br>
The default gateway used by --route options, as specified in
either the --route-gateway option or the second parameter to
--ifconfig when --dev tun is specified. Set <br>
prior to --up script execution.</p>

<p style="margin-top: 1em">route_{parm}_{n} <br>
A set of variables which define each route to be added, and
are set prior to --up script execution.</p>

<p style="margin-top: 1em">parm will be one of
&quot;network&quot;, &quot;netmask&quot;,
&quot;gateway&quot;, or &quot;metric&quot;.</p>

<p style="margin-top: 1em">n is the OpenVPN route number,
starting from 1.</p>

<p style="margin-top: 1em">If the network or gateway are
resolvable DNS names, their IP address translations will be
recorded rather than their names as denoted on the command
line or configuration <br>
file.</p>

<p style="margin-top: 1em">route_ipv6_{parm}_{n} <br>
A set of variables which define each IPv6 route to be added,
and are set prior to --up script execution.</p>

<p style="margin-top: 1em">parm will be one of
&quot;network&quot; or &quot;gateway&quot;
(&quot;netmask&quot; is contained as &quot;/nnn&quot; in the
route_ipv6_network_{n}, unlike IPv4 where it is passed in a
separate environment vari&acirc; <br>
able).</p>

<p style="margin-top: 1em">n is the OpenVPN route number,
starting from 1.</p>

<p style="margin-top: 1em">If the network or gateway are
resolvable DNS names, their IP address translations will be
recorded rather than their names as denoted on the command
line or configuration <br>
file.</p>

<p style="margin-top: 1em">peer_cert <br>
Temporary file name containing the client certificate upon
connection. Useful in conjunction with --tls-verify</p>

<p style="margin-top: 1em">script_context <br>
Set to &quot;init&quot; or &quot;restart&quot; prior to
up/down script execution. For more information, see
documentation for --up.</p>

<p style="margin-top: 1em">script_type <br>
Prior to execution of any script, this variable is set to
the type of script being run. It can be one of the
following: up, down, ipchange, route-up, tls-verify, <br>
auth-user-pass-verify, client-connect, client-disconnect, or
learn-address. Set prior to execution of any script.</p>

<p style="margin-top: 1em">signal The reason for exit or
restart. Can be one of sigusr1, sighup, sigterm, sigint,
inactive (controlled by --inactive option), ping-exit
(controlled by --ping-exit option), <br>
ping-restart (controlled by --ping-restart option),
connection-reset (triggered on TCP connection reset), error,
or unknown (unknown signal). This variable is set just <br>
prior to down script execution.</p>

<p style="margin-top: 1em">time_ascii <br>
Client connection timestamp, formatted as a human-readable
time string. Set prior to execution of the --client-connect
script.</p>

<p style="margin-top: 1em">time_duration <br>
The duration (in seconds) of the client session which is now
disconnecting. Set prior to execution of the
--client-disconnect script.</p>

<p style="margin-top: 1em">time_unix <br>
Client connection timestamp, formatted as a unix integer
date/time value. Set prior to execution of the
--client-connect script.</p>

<p style="margin-top: 1em">tls_digest_{n} /
tls_digest_sha256_{n} <br>
Contains the certificate SHA1 / SHA256 fingerprint, where n
is the verification level. Only set for TLS connections. Set
prior to execution of --tls-verify script.</p>

<p style="margin-top: 1em">tls_id_{n} <br>
A series of certificate fields from the remote peer, where n
is the verification level. Only set for TLS connections. Set
prior to execution of --tls-verify script.</p>

<p style="margin-top: 1em">tls_serial_{n} <br>
The serial number of the certificate from the remote peer,
where n is the verification level. Only set for TLS
connections. Set prior to execution of --tls-verify <br>
script. This is in the form of a decimal string like
&quot;933971680&quot;, which is suitable for doing
serial-based OCSP queries (with OpenSSL, do not prepend
&quot;0x&quot; to the string) <br>
If something goes wrong while reading the value from the
certificate it will be an empty string, so your code should
check that. See the contrib/OCSP_check/OCSP_check.sh <br>
script for an example.</p>

<p style="margin-top: 1em">tls_serial_hex_{n} <br>
Like tls_serial_{n}, but in hex form (e.g.
&quot;12:34:56:78:9A&quot;).</p>

<p style="margin-top: 1em">tun_mtu <br>
The MTU of the TUN/TAP device. Set prior to --up or --down
script execution.</p>

<p style="margin-top: 1em">trusted_ip (or trusted_ip6) <br>
Actual IP address of connecting client or peer which has
been authenticated. Set prior to execution of --ipchange,
--client-connect, and --client-disconnect scripts. If <br>
using ipv6 endpoints (udp6, tcp6), trusted_ip6 will be set
instead.</p>

<p style="margin-top: 1em">trusted_port <br>
Actual port number of connecting client or peer which has
been authenticated. Set prior to execution of --ipchange,
--client-connect, and --client-disconnect scripts.</p>

<p style="margin-top: 1em">untrusted_ip (or untrusted_ip6)
<br>
Actual IP address of connecting client or peer which has not
been authenticated yet. Sometimes used to nmap the
connecting host in a --tls-verify script to ensure it is
<br>
firewalled properly. Set prior to execution of --tls-verify
and --auth-user-pass-verify scripts. If using ipv6 endpoints
(udp6, tcp6), untrusted_ip6 will be set instead.</p>

<p style="margin-top: 1em">untrusted_port <br>
Actual port number of connecting client or peer which has
not been authenticated yet. Set prior to execution of
--tls-verify and --auth-user-pass-verify scripts.</p>

<p style="margin-top: 1em">username <br>
The username provided by a connecting client. Set prior to
--auth-user-pass-verify script execution only when the
via-env modifier is specified.</p>

<p style="margin-top: 1em">X509_{n}_{subject_field} <br>
An X509 subject field from the remote peer certificate,
where n is the verification level. Only set for TLS
connections. Set prior to execution of --tls-verify script.
<br>
This variable is similar to tls_id_{n} except the component
X509 subject fields are broken out, and no string remapping
occurs on these field values (except for remapping <br>
of control characters to &quot;_&quot;). For example, the
following variables would be set on the OpenVPN server using
the sample client certificate in sample-keys (client.crt).
<br>
Note that the verification level is 0 for the client
certificate and 1 for the CA certificate.</p>


<p style="margin-top: 1em">X509_0_emailAddress=me@myhost.mydomain
<br>
X509_0_CN=Test-Client <br>
X509_0_O=OpenVPN-TEST <br>
X509_0_ST=NA <br>
X509_0_C=KG <br>
X509_1_emailAddress=me@myhost.mydomain <br>
X509_1_O=OpenVPN-TEST <br>
X509_1_L=BISHKEK <br>
X509_1_ST=NA <br>
X509_1_C=KG</p>

<p style="margin-top: 1em">INLINE FILE SUPPORT <br>
OpenVPN allows including files in the main configuration for
the --ca, --cert, --dh, --extra-certs, --key, --pkcs12,
--secret, --crl-verify, --http-proxy-user-pass, --tls-auth
<br>
and --tls-crypt options.</p>

<p style="margin-top: 1em">Each inline file started by the
line &lt;option&gt; and ended by the line
&lt;/option&gt;</p>

<p style="margin-top: 1em">Here is an example of an inline
file usage</p>

<p style="margin-top: 1em">&lt;cert&gt; <br>
-----BEGIN CERTIFICATE----- <br>
[...] <br>
-----END CERTIFICATE----- <br>
&lt;/cert&gt;</p>

<p style="margin-top: 1em">When using the inline file
feature with --pkcs12 the inline file has to be base64
encoded. Encoding of a .p12 file into base64 can be done for
example with OpenSSL by running <br>
openssl base64 -in input.p12</p>

<p style="margin-top: 1em">SIGNALS <br>
SIGHUP Cause OpenVPN to close all TUN/TAP and network
connections, restart, re-read the configuration file (if
any), and reopen TUN/TAP and network connections.</p>

<p style="margin-top: 1em">SIGUSR1 <br>
Like SIGHUP, except don&rsquo;t re-read configuration file,
and possibly don&rsquo;t close and reopen TUN/TAP device,
re-read key files, preserve local IP address/port, or
preserve <br>
most recently authenticated remote IP address/port based on
--persist-tun, --persist-key, --persist-local-ip, and
--persist-remote-ip options respectively (see above).</p>

<p style="margin-top: 1em">This signal may also be
internally generated by a timeout condition, governed by the
--ping-restart option.</p>

<p style="margin-top: 1em">This signal, when combined with
--persist-remote-ip, may be sent when the underlying
parameters of the host&rsquo;s network interface change such
as when the host is a DHCP <br>
client and is assigned a new IP address. See --ipchange
above for more information.</p>

<p style="margin-top: 1em">SIGUSR2 <br>
Causes OpenVPN to display its current statistics (to the
syslog file if --daemon is used, or stdout otherwise).</p>

<p style="margin-top: 1em">SIGINT, SIGTERM <br>
Causes OpenVPN to exit gracefully.</p>

<p style="margin-top: 1em">TUN/TAP DRIVER SETUP <br>
If you are running Linux 2.4.7 or higher, you probably have
the TUN/TAP driver already installed. If so, there are still
a few things you need to do:</p>

<p style="margin-top: 1em">Make device: mknod /dev/net/tun
c 10 200</p>

<p style="margin-top: 1em">Load driver: modprobe tun</p>

<p style="margin-top: 1em">EXAMPLES <br>
Prior to running these examples, you should have OpenVPN
installed on two machines with network connectivity between
them. If you have not yet installed OpenVPN, consult the
<br>
INSTALL file included in the OpenVPN distribution.</p>

<p style="margin-top: 1em">TUN/TAP Setup: <br>
If you are using Linux 2.4 or higher, make the tun device
node and load the tun module:</p>

<p style="margin-top: 1em">mknod /dev/net/tun c 10 200</p>

<p style="margin-top: 1em">modprobe tun</p>

<p style="margin-top: 1em">If you installed from RPM, the
mknod step may be omitted, because the RPM install does that
for you.</p>

<p style="margin-top: 1em">Only Linux 2.4 and newer are
supported.</p>

<p style="margin-top: 1em">For other platforms, consult the
INSTALL file at http://openvpn.net/install.html for more
information.</p>

<p style="margin-top: 1em">Firewall Setup: <br>
If firewalls exist between the two machines, they should be
set to forward UDP port 1194 in both directions. If you do
not have control over the firewalls between the two <br>
machines, you may still be able to use OpenVPN by adding
--ping 15 to each of the openvpn commands used below in the
examples (this will cause each peer to send out a UDP ping
to <br>
its remote peer once every 15 seconds which will cause many
stateful firewalls to forward packets in both directions
without an explicit firewall rule).</p>

<p style="margin-top: 1em">If you are using a Linux
iptables-based firewall, you may need to enter the following
command to allow incoming packets on the TUN device:</p>

<p style="margin-top: 1em">iptables -A INPUT -i tun+ -j
ACCEPT</p>

<p style="margin-top: 1em">See the firewalls section below
for more information on configuring firewalls for use with
OpenVPN.</p>

<p style="margin-top: 1em">VPN Address Setup: <br>
For purposes of our example, our two machines will be called
bob.example.com and alice.example.com. If you are
constructing a VPN over the internet, then replace
bob.example.com <br>
and alice.example.com with the internet hostname or IP
address that each machine will use to contact the other over
the internet.</p>

<p style="margin-top: 1em">Now we will choose the tunnel
endpoints. Tunnel endpoints are private IP addresses that
only have meaning in the context of the VPN. Each machine
will use the tunnel endpoint <br>
of the other machine to access it over the VPN. In our
example, the tunnel endpoint for bob.example.com will be
10.4.0.1 and for alice.example.com, 10.4.0.2.</p>

<p style="margin-top: 1em">Once the VPN is established, you
have essentially created a secure alternate path between the
two hosts which is addressed by using the tunnel endpoints.
You can control which <br>
network traffic passes between the hosts (a) over the VPN or
(b) independently of the VPN, by choosing whether to use (a)
the VPN endpoint address or (b) the public internet <br>
address, to access the remote host. For example if you are
on bob.example.com and you wish to connect to
alice.example.com via ssh without using the VPN (since ssh
has its own <br>
built-in security) you would use the command ssh
alice.example.com. However in the same scenario, you could
also use the command telnet 10.4.0.2 to create a telnet
session with <br>
alice.example.com over the VPN, that would use the VPN to
secure the session rather than ssh.</p>

<p style="margin-top: 1em">You can use any address you wish
for the tunnel endpoints but make sure that they are private
addresses (such as those that begin with 10 or 192.168) and
that they are not part <br>
of any existing subnet on the networks of either peer,
unless you are bridging. If you use an address that is part
of your local subnet for either of the tunnel endpoints, you
<br>
will get a weird feedback loop.</p>

<p style="margin-top: 1em">Example 1: A simple tunnel
without security <br>
On bob:</p>

<p style="margin-top: 1em">openvpn --remote
alice.example.com --dev tun1 --ifconfig 10.4.0.1 10.4.0.2
--verb 9</p>

<p style="margin-top: 1em">On alice:</p>

<p style="margin-top: 1em">openvpn --remote bob.example.com
--dev tun1 --ifconfig 10.4.0.2 10.4.0.1 --verb 9</p>

<p style="margin-top: 1em">Now verify the tunnel is working
by pinging across the tunnel.</p>

<p style="margin-top: 1em">On bob:</p>

<p style="margin-top: 1em">ping 10.4.0.2</p>

<p style="margin-top: 1em">On alice:</p>

<p style="margin-top: 1em">ping 10.4.0.1</p>

<p style="margin-top: 1em">The --verb 9 option will produce
verbose output, similar to the tcpdump(8) program. Omit the
--verb 9 option to have OpenVPN run quietly.</p>

<p style="margin-top: 1em">Example 2: A tunnel with
static-key security (i.e. using a pre-shared secret) <br>
First build a static key on bob.</p>

<p style="margin-top: 1em">openvpn --genkey --secret
key</p>

<p style="margin-top: 1em">This command will build a random
key file called key (in ascii format). Now copy key to alice
over a secure medium such as by using the scp(1)
program.</p>

<p style="margin-top: 1em">On bob:</p>

<p style="margin-top: 1em">openvpn --remote
alice.example.com --dev tun1 --ifconfig 10.4.0.1 10.4.0.2
--verb 5 --secret key</p>

<p style="margin-top: 1em">On alice:</p>

<p style="margin-top: 1em">openvpn --remote bob.example.com
--dev tun1 --ifconfig 10.4.0.2 10.4.0.1 --verb 5 --secret
key</p>

<p style="margin-top: 1em">Now verify the tunnel is working
by pinging across the tunnel.</p>

<p style="margin-top: 1em">On bob:</p>

<p style="margin-top: 1em">ping 10.4.0.2</p>

<p style="margin-top: 1em">On alice:</p>

<p style="margin-top: 1em">ping 10.4.0.1</p>

<p style="margin-top: 1em">Example 3: A tunnel with full
TLS-based security <br>
For this test, we will designate bob as the TLS client and
alice as the TLS server. Note that client or server
designation only has meaning for the TLS subsystem. It has
no <br>
bearing on OpenVPN&rsquo;s peer-to-peer, UDP-based
communication model.</p>

<p style="margin-top: 1em">First, build a separate
certificate/key pair for both bob and alice (see above where
--cert is discussed for more info). Then construct Diffie
Hellman parameters (see above <br>
where --dh is discussed for more info). You can also use the
included test files client.crt, client.key, server.crt,
server.key and ca.crt. The .crt files are
certificates/pub&acirc; <br>
lic-keys, the .key files are private keys, and ca.crt is a
certification authority who has signed both client.crt and
server.crt. For Diffie Hellman parameters you can use the
<br>
included file dh1024.pem. Note that all client, server, and
certificate authority certificates and keys included in the
OpenVPN distribution are totally insecure and should be <br>
used for testing only.</p>

<p style="margin-top: 1em">On bob:</p>

<p style="margin-top: 1em">openvpn --remote
alice.example.com --dev tun1 --ifconfig 10.4.0.1 10.4.0.2
--tls-client --ca ca.crt --cert client.crt --key client.key
--reneg-sec 60 --verb 5</p>

<p style="margin-top: 1em">On alice:</p>

<p style="margin-top: 1em">openvpn --remote bob.example.com
--dev tun1 --ifconfig 10.4.0.2 10.4.0.1 --tls-server --dh
dh1024.pem --ca ca.crt --cert server.crt --key server.key
--reneg-sec 60 --verb <br>
5</p>

<p style="margin-top: 1em">Now verify the tunnel is working
by pinging across the tunnel.</p>

<p style="margin-top: 1em">On bob:</p>

<p style="margin-top: 1em">ping 10.4.0.2</p>

<p style="margin-top: 1em">On alice:</p>

<p style="margin-top: 1em">ping 10.4.0.1</p>

<p style="margin-top: 1em">Notice the --reneg-sec 60 option
we used above. That tells OpenVPN to renegotiate the data
channel keys every minute. Since we used --verb 5 above, you
will see status informa&acirc; <br>
tion on each new key negotiation.</p>

<p style="margin-top: 1em">For production operations, a key
renegotiation interval of 60 seconds is probably too
frequent. Omit the --reneg-sec 60 option to use
OpenVPN&rsquo;s default key renegotiation inter&acirc; <br>
val of one hour.</p>

<p style="margin-top: 1em">Routing: <br>
Assuming you can ping across the tunnel, the next step is to
route a real subnet over the secure tunnel. Suppose that bob
and alice have two network interfaces each, one con&acirc;
<br>
nected to the internet, and the other to a private network.
Our goal is to securely connect both private networks. We
will assume that bob&rsquo;s private subnet is 10.0.0.0/24
and <br>
alice&rsquo;s is 10.0.1.0/24.</p>

<p style="margin-top: 1em">First, ensure that IP forwarding
is enabled on both peers. On Linux, enable routing:</p>

<p style="margin-top: 1em">echo 1 &gt;
/proc/sys/net/ipv4/ip_forward</p>

<p style="margin-top: 1em">and enable TUN packet forwarding
through the firewall:</p>

<p style="margin-top: 1em">iptables -A FORWARD -i tun+ -j
ACCEPT</p>

<p style="margin-top: 1em">On bob:</p>

<p style="margin-top: 1em">route add -net 10.0.1.0 netmask
255.255.255.0 gw 10.4.0.2</p>

<p style="margin-top: 1em">On alice:</p>

<p style="margin-top: 1em">route add -net 10.0.0.0 netmask
255.255.255.0 gw 10.4.0.1</p>

<p style="margin-top: 1em">Now any machine on the
10.0.0.0/24 subnet can access any machine on the 10.0.1.0/24
subnet over the secure tunnel (or vice versa).</p>

<p style="margin-top: 1em">In a production environment, you
could put the route command(s) in a script and execute with
the --up option.</p>

<p style="margin-top: 1em">FIREWALLS <br>
OpenVPN&rsquo;s usage of a single UDP port makes it fairly
firewall-friendly. You should add an entry to your firewall
rules to allow incoming OpenVPN packets. On Linux 2.4+:</p>

<p style="margin-top: 1em">iptables -A INPUT -p udp -s
1.2.3.4 --dport 1194 -j ACCEPT</p>

<p style="margin-top: 1em">This will allow incoming packets
on UDP port 1194 (OpenVPN&rsquo;s default UDP port) from an
OpenVPN peer at 1.2.3.4.</p>

<p style="margin-top: 1em">If you are using HMAC-based
packet authentication (the default in any of OpenVPN&rsquo;s
secure modes), having the firewall filter on source address
can be considered optional, since <br>
HMAC packet authentication is a much more secure method of
verifying the authenticity of a packet source. In that
case:</p>

<p style="margin-top: 1em">iptables -A INPUT -p udp --dport
1194 -j ACCEPT</p>

<p style="margin-top: 1em">would be adequate and would not
render the host inflexible with respect to its peer having a
dynamic IP address.</p>

<p style="margin-top: 1em">OpenVPN also works well on
stateful firewalls. In some cases, you may not need to add
any static rules to the firewall list if you are using a
stateful firewall that knows how <br>
to track UDP connections. If you specify --ping n, OpenVPN
will be guaranteed to send a packet to its peer at least
once every n seconds. If n is less than the stateful
fire&acirc; <br>
wall connection timeout, you can maintain an OpenVPN
connection indefinitely without explicit firewall rules.</p>

<p style="margin-top: 1em">You should also add firewall
rules to allow incoming IP traffic on TUN or TAP devices
such as:</p>

<p style="margin-top: 1em">iptables -A INPUT -i tun+ -j
ACCEPT</p>

<p style="margin-top: 1em">to allow input packets from tun
devices,</p>

<p style="margin-top: 1em">iptables -A FORWARD -i tun+ -j
ACCEPT</p>

<p style="margin-top: 1em">to allow input packets from tun
devices to be forwarded to other hosts on the local
network,</p>

<p style="margin-top: 1em">iptables -A INPUT -i tap+ -j
ACCEPT</p>

<p style="margin-top: 1em">to allow input packets from tap
devices, and</p>

<p style="margin-top: 1em">iptables -A FORWARD -i tap+ -j
ACCEPT</p>

<p style="margin-top: 1em">to allow input packets from tap
devices to be forwarded to other hosts on the local
network.</p>

<p style="margin-top: 1em">These rules are secure if you
use packet authentication, since no incoming packets will
arrive on a TUN or TAP virtual device unless they first pass
an HMAC authentication test.</p>

<p style="margin-top: 1em">FAQ <br>
http://openvpn.net/faq.html</p>

<p style="margin-top: 1em">HOWTO <br>
For a more comprehensive guide to setting up OpenVPN in a
production setting, see the OpenVPN HOWTO at
http://openvpn.net/howto.html</p>

<p style="margin-top: 1em">PROTOCOL <br>
For a description of OpenVPN&rsquo;s underlying protocol,
see http://openvpn.net/security.html</p>

<p style="margin-top: 1em">WEB <br>
OpenVPN&rsquo;s web site is at http://openvpn.net/</p>

<p style="margin-top: 1em">Go here to download the latest
version of OpenVPN, subscribe to the mailing lists, read the
mailing list archives, or browse the SVN repository.</p>

<p style="margin-top: 1em">BUGS <br>
Report all bugs to the OpenVPN team
&lt;info@openvpn.net&gt;.</p>

<p style="margin-top: 1em">SEE ALSO <br>
dhcpcd(8), ifconfig(8), openssl(1), route(8), scp(1)
ssh(1)</p>

<p style="margin-top: 1em">NOTES <br>
This product includes software developed by the OpenSSL
Project ( http://www.openssl.org/ )</p>

<p style="margin-top: 1em">For more information on the TLS
protocol, see http://www.ietf.org/rfc/rfc2246.txt</p>

<p style="margin-top: 1em">For more information on the LZO
real-time compression library see
http://www.oberhumer.com/opensource/lzo/</p>

<p style="margin-top: 1em">COPYRIGHT <br>
Copyright (C) 2002-2010 OpenVPN Technologies, Inc. This
program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
ver&acirc; <br>
sion 2 as published by the Free Software Foundation.</p>

<p style="margin-top: 1em">AUTHORS <br>
James Yonan &lt;jim@yonan.net&gt;</p>

<p style="margin-top: 1em">25 August 2016 openvpn(8)</p>
<hr>
</body>
</html>
