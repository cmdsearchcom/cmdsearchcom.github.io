<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:13:17 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>MAUSEZAHN(8) netsniff-ng toolkit MAUSEZAHN(8)</p>

<p style="margin-top: 1em">NAME <br>
mausezahn - a fast versatile packet generator with
Cisco-cli</p>

<p style="margin-top: 1em">SYNOPSIS <br>
mausezahn { [options] &quot;&lt;arg-string&gt; |
&lt;hex-string&gt;&quot; }</p>

<p style="margin-top: 1em">DESCRIPTION <br>
mausezahn is a fast traffic generator which allows you to
send nearly every possible and impossible packet. In
contrast to trafgen(8), mausezahn&rsquo;s packet
configuration is on a <br>
protocol-level instead of byte-level and mausezahn also
comes with a built-in Cisco-like command-line interface,
making it suitable as a network traffic generator box in
your <br>
network lab.</p>

<p style="margin-top: 1em">Next to network labs, it can
also be used as a didactical tool and for security audits
including penetration and DoS testing. As a traffic
generator, mausezahn is also able to <br>
test IP multicast or VoIP networks. Packet rates close to
the physical limit are reachable, depending on the hardware
platform.</p>

<p style="margin-top: 1em">mausezahn supports two modes,
&rsquo;&rsquo;direct mode&rsquo;&rsquo; and a multi-threaded
&rsquo;&rsquo;interactive mode&rsquo;&rsquo;.</p>

<p style="margin-top: 1em">The &rsquo;&rsquo;direct
mode&rsquo;&rsquo; allows you to create a packet directly on
the command line and every packet parameter is specified in
the argument list when calling mausezahn.</p>

<p style="margin-top: 1em">The &rsquo;&rsquo;interactive
mode&rsquo;&rsquo; is an advanced multi-threaded
configuration mode with its own command line interface
(CLI). This mode allows you to create an arbitrary number of
packet <br>
types and streams in parallel, each with different
parameters.</p>

<p style="margin-top: 1em">The interactive mode utilizes a
completely redesigned and more flexible protocol framework
called &rsquo;&rsquo;mops&rsquo;&rsquo; (mausezahn&rsquo;s
own packet system). The look and feel of the CLI is very
<br>
close to the Cisco IOS^tm command line interface.</p>

<p style="margin-top: 1em">You can start the interactive
mode by executing mausezahn with the
&rsquo;&rsquo;-x&rsquo;&rsquo; argument (an optional port
number may follow, otherwise it is 25542). Then use
telnet(1) to connect to <br>
this mausezahn instance. If not otherwise specified, the
default login and password combination is mz:mz and the
enable password is: mops. This can be changed in
/etc/netsniff- <br>
ng/mausezahn.conf.</p>

<p style="margin-top: 1em">The direct mode supports two
specification schemes: The
&rsquo;&rsquo;raw-layer-2&rsquo;&rsquo; scheme, where every
single byte to be sent can be specified, and
&rsquo;&rsquo;higher-layer&rsquo;&rsquo; scheme, where
packet <br>
builder interfaces are used (using the
&rsquo;&rsquo;-t&rsquo;&rsquo; option).</p>

<p style="margin-top: 1em">To use the
&rsquo;&rsquo;raw-layer-2&rsquo;&rsquo; scheme, simply
specify the desired frame as a hexadecimal sequence (the
&rsquo;&rsquo;hex-string&rsquo;&rsquo;), such as:</p>

<p style="margin-top: 1em">mausezahn eth0
&quot;00:ab:cd:ef:00 00:00:00:00:00:01 08:00
ca:fe:ba:be&quot;</p>

<p style="margin-top: 1em">In this example, whitespaces
within the byte string are optional and separate the
Ethernet fields (destination and source address, type field,
and a short payload). The only <br>
additional options supported are
&rsquo;&rsquo;-a&rsquo;&rsquo;,
&rsquo;&rsquo;-b&rsquo;&rsquo;,
&rsquo;&rsquo;-c&rsquo;&rsquo;, and
&rsquo;&rsquo;-p&rsquo;&rsquo;. The frame length must be
greater than or equal to 15 bytes.</p>

<p style="margin-top: 1em">The
&rsquo;&rsquo;higher-layer&rsquo;&rsquo; scheme is enabled
using the &rsquo;&rsquo;-t &lt;packet-type&gt;&rsquo;&rsquo;
option. This option activates a packet builder, and besides
the &rsquo;&rsquo;packet-type&rsquo;&rsquo;, an optional
&rsquo;&rsquo;arg-string&rsquo;&rsquo; <br>
can be specified. The &rsquo;&rsquo;arg-string&rsquo;&rsquo;
contains packet- specific parameters, such as TCP flags,
port numbers, etc. (see example section).</p>

<p style="margin-top: 1em">OPTIONS <br>
mausezahn provides a built-in context-specific help. Append
the keyword <br>
&rsquo;&rsquo;help&rsquo;&rsquo; after the configuration
options. The most important options are:</p>

<p style="margin-top: 1em">-x [&lt;port&gt;] <br>
Start mausezahn in interactive mode with a Cisco-like CLI.
Use telnet to log into the local mausezahn instance. If no
port has been specified, port 25542 is used by default.</p>

<p style="margin-top: 1em">-6 <br>
Specify IPv6 mode (IPv4 is the default).</p>

<p style="margin-top: 1em">-l &lt;IP&gt; <br>
Specify the IP address mausezahn should bind to when in
interactive mode, default: 0.0.0.0.</p>

<p style="margin-top: 1em">-v <br>
Verbose mode. Capital -V is even more verbose.</p>

<p style="margin-top: 1em">-S <br>
Simulation mode, i.e. don&rsquo;t put anything on the wire.
This is typically combined with the verbose mode.</p>

<p style="margin-top: 1em">-q <br>
Quiet mode where only warnings and errors are displayed.</p>

<p style="margin-top: 1em">-c &lt;count&gt; <br>
Send the packet count times (default: 1, infinite: 0).</p>

<p style="margin-top: 1em">-d &lt;delay&gt; <br>
Apply delay between transmissions. The delay value can be
specified in usec (default, no additional unit needed), or
in msec (e.g. 100m or 100msec), or in seconds (e.g. 100s or
<br>
100sec). Note: mops also supports nanosecond delay
resolution if you need it (see interactive mode).</p>

<p style="margin-top: 1em">-p &lt;length&gt; <br>
Pad the raw frame to specified length using zero bytes. Note
that for raw layer 2 frames the specified length defines the
whole frame length, while for higher layer packets the <br>
number of additional padding bytes are specified.</p>

<p style="margin-top: 1em">-a &lt;src-mac|keyword&gt; <br>
Use specified source MAC address with hexadecimal notation
such as 00:00:aa:bb:cc:dd. By default the interface MAC
address will be used. The keywords
&rsquo;&rsquo;rand&rsquo;&rsquo; and <br>
&rsquo;&rsquo;own&rsquo;&rsquo; refer to a random MAC
address (only unicast addresses are created) and the own
address, respectively. You can also use the keywords
mentioned below although broadcast- <br>
type source addresses are officially invalid.</p>

<p style="margin-top: 1em">-b &lt;dst-mac|keyword&gt; <br>
Use specified destination MAC address. By default, a
broadcast is sent in raw layer 2 mode or to the destination
hosts or gateway interface MAC address in normal (IP) mode.
You <br>
can use the same keywords as mentioned above, as well as
<br>
&rsquo;&rsquo;bc&rsquo;&rsquo; or
&rsquo;&rsquo;bcast&rsquo;&rsquo;,
&rsquo;&rsquo;cisco&rsquo;&rsquo;, and
&rsquo;&rsquo;stp&rsquo;&rsquo;. Please note that for the
destination MAC address the &rsquo;&rsquo;rand&rsquo;&rsquo;
keyword is supported but creates a random address only once,
even when <br>
you send multiple packets.</p>

<p style="margin-top: 1em">-A &lt;src-ip|range|rand&gt;
<br>
Use specified source IP address, default is own interface
address. Optionally, the keyword
&rsquo;&rsquo;rand&rsquo;&rsquo; can again be used for a
random source IP address or a range can be specified, <br>
such as
&rsquo;&rsquo;192.168.1.1-192.168.1.100&rsquo;&rsquo; or
&rsquo;&rsquo;10.1.0.0/16&rsquo;&rsquo;. Also, a DNS name
can be specified for which mausezahn tries to determine the
corresponding IP address automatically.</p>

<p style="margin-top: 1em">-B &lt;dst-ip|range&gt; <br>
Use specified destination IP address (default is broadcast
i.e. 255.255.255.255). As with the source address (see
above) you can also specify a range or a DNS name.</p>

<p style="margin-top: 1em">-t &lt;packet-type [help] |
help&gt; <br>
Create the specified packet type using the built-in packet
builder. Currently, supported packet types are:
&rsquo;&rsquo;arp&rsquo;&rsquo;,
&rsquo;&rsquo;bpdu&rsquo;&rsquo;,
&rsquo;&rsquo;ip&rsquo;&rsquo;,
&rsquo;&rsquo;udp&rsquo;&rsquo;,
&rsquo;&rsquo;tcp&rsquo;&rsquo;,
&rsquo;&rsquo;rtp&rsquo;&rsquo;, and
&rsquo;&rsquo;dns&rsquo;&rsquo;. Cur&acirc; <br>
rently, there is also limited support for
&rsquo;&rsquo;icmp&rsquo;&rsquo;. Type <br>
&rsquo;&rsquo;-t help&rsquo;&rsquo; to verify which packet
builders your actual mausezahn version supports. Also, for
any particular packet type, for example
&rsquo;&rsquo;tcp&rsquo;&rsquo; type <br>
&rsquo;&rsquo;mausezahn -t tcp help&rsquo;&rsquo; to receive
a more in-depth context specific help.</p>

<p style="margin-top: 1em">-T &lt;packet-type&gt; <br>
Make this mausezahn instance the receiving station.
Currently, only &rsquo;&rsquo;rtp&rsquo;&rsquo; is an option
here and provides precise jitter measurements. For this
purpose, start another mausezahn <br>
instance on the sending station and the local receiving
station will output jitter statistics. See
&rsquo;&rsquo;mausezahn -T rtp help&rsquo;&rsquo; for a
detailed help.</p>

<p style="margin-top: 1em">-Q &lt;[CoS:]vlan&gt; [,
&lt;[CoS:]vlan&gt;, ...] <br>
Specify 802.1Q VLAN tag and optional Class of Service. An
arbitrary number of VLAN tags can be specified (that is, you
can simulate QinQ or even QinQinQinQ..). Multiple tags <br>
must be separated via a comma or a period (e.g.
&quot;5:10,20,2:30&quot;). VLAN tags are not supported for
ARP and BPDU packets (in which case you could specify the
whole frame in hexa&acirc; <br>
decimal using the raw layer 2 interface of mausezahn).</p>

<p style="margin-top: 1em">-M
&lt;label[:cos[:ttl]][bos]&gt; [, &lt;label...&gt;] <br>
Specify a MPLS label or even a MPLS label stack. Optionally,
for each label the experimental bits (usually the Class of
Service, CoS) and the Time To Live (TTL) can be specified.
<br>
If you are really crazy you can set and unset the Bottom of
Stack (BoS) bit for each label using the
&rsquo;&rsquo;S&rsquo;&rsquo; (set) and
&rsquo;&rsquo;s&rsquo;&rsquo; (unset) option. By default,
the BoS is set automati&acirc; <br>
cally and correctly. Any other setting will lead to invalid
frames. Enter &rsquo;&rsquo;-M help&rsquo;&rsquo; for
detailed instructions and examples.</p>

<p style="margin-top: 1em">-P &lt;ascii-payload&gt; <br>
Specify a cleartext payload. Alternatively, each packet type
supports a hexadecimal specification of the payload (see for
example &rsquo;&rsquo;-t udp help&rsquo;&rsquo;).</p>

<p style="margin-top: 1em">-f &lt;filename&gt; <br>
Read the ASCII payload from the specified file.</p>

<p style="margin-top: 1em">-F &lt;filename&gt; <br>
Read the hexadecimal payload from the specified file.
Actually, this file must be also an ASCII text file, but
must contain hexadecimal digits, e.g.
&quot;aa:bb:cc:0f:e6...&quot;. You can <br>
use also spaces as separation characters.</p>

<p style="margin-top: 1em">USAGE EXAMPLE <br>
For more comprehensive examples, have a look at the two
following HOWTO sections.</p>

<p style="margin-top: 1em">mausezahn eth0 -c 0 -d 2s -t
bpdu vlan=5 <br>
Send BPDU frames for VLAN 5 as used with Cisco&rsquo;s PVST+
type of STP. By default mausezahn assumes that you want to
become the root bridge.</p>

<p style="margin-top: 1em">mausezahn eth0 -c 128000 -a rand
-p 64 <br>
Perform a CAM table overflow attack.</p>

<p style="margin-top: 1em">mausezahn eth0 -c 0 -Q 5,100 -t
tcp flags=syn,dp=1-1023 -p 20 -A rand -B 10.100.100.0/24
<br>
Perform a SYN flood attack to another VLAN using VLAN
hopping. This only works if you are connected to the same
VLAN which is configured as native VLAN on the trunk. We
assume <br>
that the victim VLAN is VLAN 100 and the native VLAN is VLAN
5. Lets attack every host in VLAN 100 which use an IP prefix
of 10.100.100.0/24, also try out all ports between 1 <br>
and 1023 and use a random source IP address.</p>

<p style="margin-top: 1em">mausezahn eth0 -c 0 -d 10msec -B
230.1.1.1 -t udp dp=32000,dscp=46 -P Multicast test packet
<br>
Send IP multicast packets to the multicast group 230.1.1.1
using a UDP header with destination port 32000 and set the
IP DSCP field to EF (46). Send one frame every 10 msec.</p>

<p style="margin-top: 1em">mausezahn eth0 -Q 6:420 -M
100,200,300:5 -A 172.30.0.0/16 -B target.anynetwork.foo -t
udp sp=666,dp=1-65535 -p 1000 -c 10 <br>
Send UDP packets to the destination host
target.anynetwork.foo using all possible destination ports
and send every packet with all possible source addresses of
the range <br>
172.30.0.0/16; additionally use a source port of 666 and
three MPLS labels, 100, 200, and 300, the outer (300) with
QoS field 5. Send the frame with a VLAN tag 420 and CoS 6;
<br>
eventually pad with 1000 bytes and repeat the whole thing 10
times.</p>

<p style="margin-top: 1em">mausezahn -t syslog sev=3 -P
Main reactor reached critical temperature. -A 192.168.33.42
-B 10.1.1.9 -c 6 -d 10s <br>
Send six forged syslog messages with severity 3 to a Syslog
server 10.1.1.9; use a forged source IP address
192.168.33.42 and let mausezahn decide which local interface
to use. <br>
Use an inter-packet delay of 10 seconds.</p>

<p style="margin-top: 1em">mausezahn -t tcp
flags=syn|urg|rst, sp=145, dp=145, win=0, s=0-4294967295,
ds=1500, urg=666 -a bcast -b bcast -A bcast -B 10.1.1.6 -p 5
<br>
Send an invalid TCP packet with only a 5 byte payload as
layer-2 broadcast and also use the broadcast MAC address as
source address. The target should be 10.1.1.6 but use a <br>
broadcast source address. The source and destination port
shall be 145 and the window size 0. Set the TCP flags SYN,
URG, and RST simultaneously and sweep through the whole TCP
<br>
sequence number space with an increment of 1500. Finally set
the urgent pointer to 666, i.e. pointing to nowhere.</p>

<p style="margin-top: 1em">CONFIGURATION FILE <br>
When mausezahn is run in interactive mode it automatically
looks for and reads a configuration file located at
/etc/netsniff-ng/mausezahn.conf for custom options if the
file is <br>
available, otherwise it uses defaults set at compile
time.</p>

<p style="margin-top: 1em">Config file:
/etc/netsniff-ng/mausezahn.conf <br>
The configuration file contains lines of the form:</p>

<p style="margin-top: 1em">option = value</p>

<p style="margin-top: 1em">Options supported in the
configuration file are: <br>
Option: Description:</p>

<p style="margin-top: 1em">user Username for authentication
(default: mz) <br>
password Password for authentication (default: mz) <br>
enable Password to enter privilege mode (default: mops) <br>
port The listening port for the CLI (default: 25542) <br>
listen-addr IP address to bind CLI to (default: 0.0.0.0)
<br>
management-only Set management interface (no data traffic is
allowed to pass through) <br>
cli-device Interface to bind CLI to (default: all) *not
fully implemented* <br>
automops Path to automops file (contains XML data describing
protocols) *in development*</p>

<p style="margin-top: 1em">Example: <br>
$ cat /etc/netsniff-ng/mausezahn.conf <br>
user = mzadmin <br>
password = mzpasswd <br>
enable = privilege-mode-passwd <br>
port = 65000 <br>
listen-addr = 127.0.0.1</p>

<p style="margin-top: 1em">INTERACTIVE MODE HOWTO <br>
Telnet: <br>
Using the interactive mode requires starting mausezahn as a
server:</p>

<p style="margin-top: 1em"># mausezahn -x</p>

<p style="margin-top: 1em">Now you can telnet(1) to that
server using the default port number 25542, but also an
arbitrary port number can be specified:</p>

<p style="margin-top: 1em"># mausezahn -x 99 <br>
mausezahn accepts incoming telnet connections on port 99.
<br>
mz: Problems opening config file. Will use defaults</p>

<p style="margin-top: 1em">Either from another terminal or
from another host try to telnet to the mausezahn server:</p>

<p style="margin-top: 1em">caprica$ telnet galactica 99
<br>
Trying 192.168.0.4... <br>
Connected to galactica. <br>
Escape character is &rsquo;^]&rsquo;. <br>
mausezahn &lt;version&gt;</p>

<p style="margin-top: 1em">Username: mz <br>
Password: mz</p>

<p style="margin-top: 1em">mz&gt; enable <br>
Password: mops <br>
mz#</p>

<p style="margin-top: 1em">It is recommended to configure
your own login credentials in
/etc/netsniff-ng/mausezahn.conf, (see configuration file
section)</p>

<p style="margin-top: 1em">Basics: <br>
Since you reached the mausezahn prompt, lets try some common
commands. You can use the &rsquo;?&rsquo; character at any
time for context-specific help. Note that Cisco-like short
form of <br>
commands are accepted in interactive mode. For example, one
can use &quot;sh pac&quot; instead of &quot;show
packet&quot;; another common example is to use &quot;config
t&quot; in place of &quot;configure termi&acirc; <br>
nal&quot;. For readability, this manual will continue with
the full commands.</p>

<p style="margin-top: 1em">First try out the show
command:</p>

<p style="margin-top: 1em">mz# show ?</p>

<p style="margin-top: 1em">mausezahn maintains its own ARP
table and observes anomalies. There is an entry for every
physical interface (however this host has only one):</p>

<p style="margin-top: 1em">mz# show arp <br>
Intf Index IP address MAC address last Ch UCast BCast Info
<br>

----------------------------------------------------------------------------------
<br>
eth0 [1] D 192.168.0.1 00:09:5b:9a:15:84 23:44:41 1 1 0
0000</p>

<p style="margin-top: 1em">The column Ch tells us that the
announced MAC address has only changed one time (= when it
was learned). The columns Ucast and BCast tell us how often
this entry was announced <br>
via unicast or broadcast respectively.</p>

<p style="margin-top: 1em">Let&rsquo;s check our
interfaces:</p>

<p style="margin-top: 1em">mz# show interface <br>
Available network interfaces: <br>
real real used (fake) used (fake) <br>
device IPv4 address MAC address IPv4 address MAC address
<br>

---------------------------------------------------------------------------------------
<br>
&gt; eth0 192.168.0.4 00:30:05:76:2e:8d 192.168.0.4
00:30:05:76:2e:8d <br>
lo 127.0.0.1 00:00:00:00:00:00 127.0.0.1 00:00:00:00:00:00
<br>
2 interfaces found. <br>
Default interface is eth0.</p>

<p style="margin-top: 1em">Defining packets: <br>
Let&rsquo;s check the current packet list:</p>

<p style="margin-top: 1em">mz# show packet <br>
Packet layer flags: E=Ethernet, S=SNAP, Q=802.1Q, M=MPLS,
I/i=IP/delivery_off, U=UDP, T=TCP <br>
PktID PktName Layers Proto Size State Device Delay
Count/CntX <br>
1 sysARP_servic... E----- ARP 60 config lo 100 msec 1/0
(100%) <br>
1 packets defined, 0 active.</p>

<p style="margin-top: 1em">We notice that there is already
one system-defined packet process; it has been created and
used only once (during startup) by mausezahn&rsquo;s ARP
service. Currently, its state is <br>
config which means that the process is sleeping.</p>

<p style="margin-top: 1em">General packet options: <br>
Now let&rsquo;s create our own packet process and switch
into the global configuration mode:</p>

<p style="margin-top: 1em">mz# configure terminal <br>
mz(config)# packet <br>
Allocated new packet PKT0002 at slot 2 <br>
mz(config-pkt-2)# ? <br>
... <br>
name Assign a unique name <br>
description Assign a packet description text <br>
bind Select the network interface <br>
count Configure the packet count value <br>
delay Configure the inter-packet delay <br>
interval Configure a greater interval <br>
type Specify packet type <br>
mac Configure packet&rsquo;s MAC addresses <br>
tag Configure tags <br>
payload Configure a payload <br>
port Configure packet&rsquo;s port numbers <br>
end End packet configuration mode <br>
ethernet Configure frame&rsquo;s Ethernet, 802.2, 802.3, or
SNAP settings <br>
ip Configure packet&rsquo;s IP settings <br>
udp Configure packet&rsquo;s UDP header parameters <br>
tcp Configure packet&rsquo;s TCP header parameters</p>

<p style="margin-top: 1em">Here are a lot of options but
normally you only need a few of them. When you configure
lots of different packets you might assign a reasonable name
and description for them:</p>

<p style="margin-top: 1em">mz(config-pkt-2)# name Test <br>
mz(config-pkt-2)# description This is just a test</p>

<p style="margin-top: 1em">You can, for example, change the
default settings for the source and destination MAC or IP
addresses using the mac and ip commands:</p>

<p style="margin-top: 1em">mz(config-pkt-2)# ip address
destination 10.1.1.0 /24 <br>
mz(config-pkt-2)# ip address source random</p>

<p style="margin-top: 1em">In the example above, we
configured a range of addresses (all hosts in the network
10.1.1.0 should be addressed). Additionally we spoof our
source IP address. Of course, we can <br>
also add one or more VLAN and, or, MPLS tag(s):</p>

<p style="margin-top: 1em">mz(config-pkt-2)# tag ? <br>
dot1q Configure 802.1Q (and 802.1P) parameters <br>
mpls Configure MPLS label stack <br>
mz(config-pkt-2)# tag dot ? <br>
Configure 802.1Q tags: <br>
VLAN[:CoS] [VLAN[:CoS]] ... The leftmost tag is the outer
tag in the frame <br>
remove &lt;tag-nr&gt; | all Remove one or more tags
(&lt;tag-nr&gt; starts with 1), <br>
by default the first (=leftmost,outer) tag is removed, <br>
keyword &rsquo;all&rsquo; can be used instead of tag
numbers. <br>
cfi | nocfi [&lt;tag-nr&gt;] Set or unset the CFI-bit in any
tag (by default <br>
assuming the first tag). <br>
mz(config-pkt-2)# tag dot 1:7 200:5</p>

<p style="margin-top: 1em">Configure count and delay: <br>
mz(config-pkt-2)# count 1000 <br>
mz(config-pkt-2)# delay ? <br>
delay &lt;value&gt; [hour | min | sec | msec | usec |
nsec]</p>

<p style="margin-top: 1em">Specify the inter-packet delay
in hours, minutes, seconds, milliseconds, microseconds or
nanoseconds. The default unit is milliseconds (i.e. when no
unit is given).</p>

<p style="margin-top: 1em">mz(config-pkt-2)# delay 1 msec
<br>
Inter-packet delay set to 0 sec and 1000000 nsec <br>
mz(config-pkt-2)#</p>

<p style="margin-top: 1em">Configuring protocol types: <br>
mausezahn&rsquo;s interactive mode supports a growing list
of protocols and only relies on the MOPS architecture (and
not on libnet as is the case with the legacy direct
mode):</p>

<p style="margin-top: 1em">mz(config-pkt-2)# type <br>
Specify a packet type from the following list: <br>
arp <br>
bpdu <br>
igmp <br>
ip <br>
lldp <br>
tcp <br>
udp <br>
mz(config-pkt-2)# type tcp <br>
mz(config-pkt-2-tcp)# <br>
.... <br>
seqnr Configure the TCP sequence number <br>
acknr Configure the TCP acknowledgement number <br>
hlen Configure the TCP header length <br>
reserved Configure the TCP reserved field <br>
flags Configure a combination of TCP flags at once <br>
cwr Set or unset the TCP CWR flag <br>
ece Set or unset the TCP ECE flag <br>
urg Set or unset the TCP URG flag <br>
ack set or unset the TCP ACK flag <br>
psh set or unset the TCP PSH flag <br>
rst set or unset the TCP RST flag <br>
syn set or unset the TCP SYN flag <br>
fin set or unset the TCP FIN flag <br>
window Configure the TCP window size <br>
checksum Configure the TCP checksum <br>
urgent-pointer Configure the TCP urgent pointer <br>
options Configure TCP options <br>
end End TCP configuration mode <br>
mz(config-pkt-2-tcp)# flags syn fin rst <br>
Current setting is: --------------------RST-SYN-FIN <br>
mz(config-pkt-2-tcp)# end <br>
mz(config-pkt-2)# payload ascii This is a dummy payload for
my first packet <br>
mz(config-pkt-2)# end</p>

<p style="margin-top: 1em">Now configure another packet,
for example let&rsquo;s assume we want an LLDP process:</p>

<p style="margin-top: 1em">mz(config)# packet <br>
Allocated new packet PKT0003 at slot 3 <br>
mz(config-pkt-3)# type lldp <br>
mz(config-pkt-3-lldp)# exit <br>
mz(config)# exit</p>

<p style="margin-top: 1em">In the above example we only use
the default LLDP settings and don&rsquo;t configure further
LLDP options or TLVs. Back in the top level of the CLI
let&rsquo;s verify what we had done:</p>

<p style="margin-top: 1em">mz# show packet <br>
Packet layer flags: E=Ethernet, S=SNAP, Q=802.1Q, M=MPLS,
I/i=IP/delivery_off, U=UDP, T=TCP <br>
PktID PktName Layers Proto Size State Device Delay
Count/CntX <br>
1 sysARP_servic... E----- ARP 60 config lo 100 msec 1/0
(100%) <br>
2 Test E-Q-IT 125 config eth0 1000 usec 1000/1000 (0%) <br>
3 PKT0003 E----- LLDP 36 config eth0 30 sec 0/0 (0%) <br>
3 packets defined, 0 active.</p>

<p style="margin-top: 1em">The column Layers indicates
which major protocols have been combined. For example the
packet with packet-id 2 (&quot;Test&quot;) utilizes Ethernet
(E), IP (I), and TCP (T). Additionally an <br>
802.1Q tag (Q) has been inserted. Now start one of these
packet processes:</p>

<p style="margin-top: 1em">mz# start slot 3 <br>
Activate [3] <br>
mz# show packet <br>
Packet layer flags: E=Ethernet, S=SNAP, Q=802.1Q, M=MPLS,
I/i=IP/delivery_off, U=UDP, T=TCP <br>
PktID PktName Layers Proto Size State Device Delay
Count/CntX <br>
1 sysARP_servic... E----- ARP 60 config lo 100 msec 1/0
(100%) <br>
2 Test E-Q-IT 125 config eth0 1000 usec 1000/1000 (0%) <br>
3 PKT0003 E----- LLDP 36 config eth0 30 sec 0/1 (0%) <br>
3 packets defined, 1 active.</p>

<p style="margin-top: 1em">Let&rsquo;s have a more detailed
look at a specific packet process:</p>

<p style="margin-top: 1em">mz# show packet 2 <br>
Packet [2] Test <br>
Description: This is just a test <br>
State: config, Count=1000, delay=1000 usec (0 s 1000000
nsec), interval= (undefined) <br>
Headers: <br>
Ethernet: 00-30-05-76-2e-8d =&gt; ff-ff-ff-ff-ff-ff [0800
after 802.1Q tag] <br>
Auto-delivery is ON (that is, the actual MAC is adapted upon
transmission) <br>
802.1Q: 0 tag(s); (VLAN:CoS) <br>
IP: SA=192.168.0.4 (not random) (no range) <br>
DA=255.255.255.255 (no range) <br>
ToS=0x00 proto=17 TTL=255 ID=0 offset=0 flags: -|-|- <br>
len=49664(correct) checksum=0x2e8d(correct) <br>
TCP: 83 bytes segment size (including TCP header) <br>
SP=0 (norange) (not random), DP=0 (norange) (not random)
<br>
SQNR=3405691582 (start 0, stop 4294967295, delta 0) --
ACKNR=0 (invalid) <br>
Flags: ------------------------SYN----, reserved field is
00, urgent pointer= 0 <br>
Announced window size= 100 <br>
Offset= 0 (times 32 bit; value is valid), checksum= ffff
(valid) <br>
(No TCP options attached) - 0 bytes defined <br>
Payload size: 43 bytes <br>
Frame size: 125 bytes <br>
1 ff:ff:ff:ff:ff:ff:00:30 05:76:2e:8d:81:00:e0:01
81:00:a0:c8:08:00:45:00 00:67:00:00:00:00:ff:06 <br>
33 fa:e4:c0:a8:00:04:ff:ff ff:ff:00:00:00:00:ca:fe
ba:be:00:00:00:00:a0:07 00:64:f7:ab:00:00:02:04 <br>
65 05:ac:04:02:08:0a:19:35 90:c3:00:00:00:00:01:03
03:05:54:68:69:73:20:69 73:20:61:20:64:75:6d:6d <br>
97 79:20:70:61:79:6c:6f:61 64:20:66:6f:72:20:6d:79
20:66:69:72:73:74:20:70 61:63:6b:65:74 <br>
mz#</p>

<p style="margin-top: 1em">If you want to stop one or more
packet processes, use the stop command. The &quot;emergency
stop&quot; is when you use stop all:</p>

<p style="margin-top: 1em">mz# stop all <br>
Stopping <br>
[3] PKT0003 <br>
Stopped 1 transmission processe(s)</p>

<p style="margin-top: 1em">The launch command provides a
shortcut for commonly used packet processes. For example to
behave like a STP-capable bridge we want to start an BPDU
process with typical parame&acirc; <br>
ters:</p>

<p style="margin-top: 1em">mz# launch bpdu <br>
Allocated new packet sysBPDU at slot 5 <br>
mz# show packet <br>
Packet layer flags: E=Ethernet, S=SNAP, Q=802.1Q, M=MPLS,
I/i=IP/delivery_off, U=UDP, T=TCP <br>
PktID PktName Layers Proto Size State Device Delay
Count/CntX <br>
1 sysARP_servic... E----- ARP 60 config lo 100 msec 1/0
(100%) <br>
2 Test E-Q-IT 125 config eth0 1000 usec 1000/1000 (0%) <br>
3 PKT0003 E----- LLDP 36 config eth0 30 sec 0/12 (0%) <br>
4 PKT0004 E---I- IGMP 46 config eth0 100 msec 0/0 (0%) <br>
5 sysBPDU ES---- BPDU 29 active eth0 2 sec 0/1 (0%) <br>
5 packets defined, 1 active.</p>

<p style="margin-top: 1em">Now a Configuration BPDU is sent
every 2 seconds, claiming to be the root bridge (and usually
confusing the LAN. Note that only packet 5 (i.e. the last
row) is active and there&acirc; <br>
fore sending packets while all other packets are in state
config (i.e. they have been configured but they are not
doing anything at the moment).</p>

<p style="margin-top: 1em">Configuring a greater interval:
<br>
Sometimes you may want to send a burst of packets at a
greater interval:</p>

<p style="margin-top: 1em">mz(config)# packet 2 <br>
Modify packet parameters for packet Test [2] <br>
mz(config-pkt-2)# interval <br>
Configure a greater packet interval in days, hours, minutes,
or seconds <br>
Arguments: &lt;value&gt; &lt;days | hours | minutes |
seconds&gt; <br>
Use a zero value to disable an interval. <br>
mz(config-pkt-2)# interval 1 hour <br>
mz(config-pkt-2)# count 10 <br>
mz(config-pkt-2)# delay 15 usec <br>
Inter-packet delay set to 0 sec and 15000 nsec</p>

<p style="margin-top: 1em">Now this packet is sent ten
times with an inter-packet delay of 15 microseconds and this
is repeated every hour. When you look at the packet list, an
interval is indicated with <br>
the additional flag &rsquo;i&rsquo; when inactive or
&rsquo;I&rsquo; when active:</p>

<p style="margin-top: 1em">mz# show packet <br>
Packet layer flags: E=Ethernet, S=SNAP, Q=802.1Q, M=MPLS,
I/i=IP/delivery_off, U=UDP, T=TCP <br>
PktID PktName Layers Proto Size State Device Delay
Count/CntX <br>
1 sysARP_servic... E----- ARP 60 config lo 100 msec 1/0
(100%) <br>
2 Test E-Q-IT 125 config-i eth0 15 usec 10/10 (0%) <br>
3 PKT0003 E----- LLDP 36 config eth0 30 sec 0/12 (0%) <br>
4 PKT0004 E---I- IGMP 46 config eth0 100 msec 0/0 (0%) <br>
5 sysBPDU ES---- BPDU 29 active eth0 2 sec 0/251 (0%) <br>
5 packets defined, 1 active. <br>
mz# start slot 2 <br>
Activate [2] <br>
mz# show packet <br>
Packet layer flags: E=Ethernet, S=SNAP, Q=802.1Q, M=MPLS,
I/i=IP/delivery_off, U=UDP, T=TCP <br>
PktID PktName Layers Proto Size State Device Delay
Count/CntX <br>
1 sysARP_servic... E----- ARP 60 config lo 100 msec 1/0
(100%) <br>
2 Test E-Q-IT 125 config+I eth0 15 usec 10/0 (100%) <br>
3 PKT0003 E----- LLDP 36 config eth0 30 sec 0/12 (0%) <br>
4 PKT0004 E---I- IGMP 46 config eth0 100 msec 0/0 (0%) <br>
5 sysBPDU ES---- BPDU 29 active eth0 2 sec 0/256 (0%) <br>
5 packets defined, 1 active.</p>

<p style="margin-top: 1em">Note that the flag
&rsquo;I&rsquo; indicates that an interval has been
specified for packet 2. The process is not active at the
moment (only packet 5 is active here) but it will become
<br>
active at a regular interval. You can verify the actual
interval when viewing the packet details via the &rsquo;show
packet 2&rsquo; command.</p>

<p style="margin-top: 1em">Load prepared configurations:
<br>
You can prepare packet configurations using the same
commands as you would type them in on the CLI and then load
them to the CLI. For example, assume we have prepared a file
<br>
&rsquo;test.mops&rsquo; containing:</p>

<p style="margin-top: 1em">configure terminal <br>
packet <br>
name IGMP_TEST <br>
desc This is only a demonstration how to load a file to mops
<br>
type igmp</p>

<p style="margin-top: 1em">Then we can add this packet
configuration to our packet list using the load command:</p>

<p style="margin-top: 1em">mz# load test.mops <br>
Read commands from test.mops... <br>
Allocated new packet PKT0002 at slot 2 <br>
mz# show packet <br>
Packet layer flags: E=Ethernet, S=SNAP, Q=802.1Q, M=MPLS,
I/i=IP/delivery_off, U=UDP, T=TCP <br>
PktID PktName Layers Proto Size State Device Delay
Count/CntX <br>
1 sysARP_servic... E----- ARP 60 config lo 100 msec 1/0
(100%) <br>
2 IGMP_TEST E---I- IGMP 46 config eth0 100 msec 0/0 (0%)
<br>
2 packets defined, 0 active.</p>

<p style="margin-top: 1em">The file
src/examples/mausezahn/example_lldp.conf contains another
example list of commands to create a bogus LLDP packet. You
can load this configuration from the mausezahn com&acirc;
<br>
mand line as follows:</p>

<p style="margin-top: 1em">mz# load
/home/hh/tmp/example_lldp.conf</p>

<p style="margin-top: 1em">In case you copied the file in
that path. Now when you enter &rsquo;show packet&rsquo; you
will see a new packet entry in the packet list. Use the
&rsquo;start slot &lt;nr&gt;&rsquo; command to activate this
<br>
packet.</p>

<p style="margin-top: 1em">You can store your own packet
creations in such a file and easily load them when you need
them. Every command within such configuration files is
executed on the command line <br>
interface as if you had typed it in -- so be careful about
the order and don&rsquo;t forget to use &rsquo;configure
terminal&rsquo; as first command.</p>

<p style="margin-top: 1em">You can even load other files
from within a central config file.</p>

<p style="margin-top: 1em">DIRECT MODE HOWTO <br>
How to specify hexadecimal digits: <br>
Many arguments allow direct byte input. Bytes are
represented as two hexadecimal digits. Multiple bytes must
be separated either by spaces, colons, or dashes - whichever
you pre&acirc; <br>
fer. The following byte strings are equivalent:</p>

<p style="margin-top: 1em">&quot;aa:bb cc-dd-ee ff 01 02
03-04 05&quot; <br>
&quot;aa bb cc dd ee ff:01:02:03:04 05&quot;</p>

<p style="margin-top: 1em">To begin with, you may want to
send an arbitrary fancy (possibly invalid) frame right
through your network card:</p>

<p style="margin-top: 1em">mausezahn
ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:ff:08:00:ca:fe:ba:be</p>

<p style="margin-top: 1em">or equivalent but more
readable:</p>

<p style="margin-top: 1em">mausezahn
ff:ff:ff:ff:ff:ff-ff:ff:ff:ff:ff:ff-08:00-ca:fe:ba:be</p>

<p style="margin-top: 1em">Basic operations: <br>
All major command line options are listed when you execute
mausezahn without arguments. For practical usage, keep the
following special (not so widely known) options in mind:</p>

<p style="margin-top: 1em">-r Multiplies the specified
delay with a random value. <br>
-p &lt;length&gt; Pad the raw frame to specified length
(using random bytes). <br>
-P &lt;ASCII Payload&gt; Use the specified ASCII payload.
<br>
-f &lt;filename&gt; Read the ASCII payload from a file. <br>
-F &lt;filename&gt; Read the hexadecimal payload from a
file. <br>
-S Simulation mode: DOES NOT put anything on the wire. <br>
This is typically combined with one of the verbose <br>
modes (-v or V).</p>

<p style="margin-top: 1em">Many options require a keyword
or a number but the -t option is an exception since it
requires both a packet type (such as ip, udp, dns, etc) and
an argument string which is spe&acirc; <br>
cific for that packet type. Here are some simple
examples:</p>

<p style="margin-top: 1em">mausezahn -t help <br>
mausezahn -t tcp help <br>
mausezahn eth3 -t udp sp=69,dp=69,p=ca:fe:ba:be</p>

<p style="margin-top: 1em">Note: Don&rsquo;t forget that on
the CLI the Linux shell (usually the Bash) interprets spaces
as a delimiting character. That is, if you are specifying an
argument that consists of <br>
multiple words with spaces in between, you MUST group these
within quotes. For example, instead of</p>

<p style="margin-top: 1em">mausezahn eth0 -t udp
sp=1,dp=80,p=00:11:22:33</p>

<p style="margin-top: 1em">you could either omit the
spaces</p>

<p style="margin-top: 1em">mausezahn eth0 -t udp
sp=1,dp=80,p=00:11:22:33</p>

<p style="margin-top: 1em">or, for greater safety, use
quotes:</p>

<p style="margin-top: 1em">mausezahn eth0 -t udp
&quot;sp=1,dp=80,p=00:11:22:33&quot;</p>

<p style="margin-top: 1em">In order to monitor what&rsquo;s
going on, you can enable the verbose mode using the -v
option. The opposite is the quiet mode (-q) which will keep
mausezahn absolutely quiet (except <br>
for error messages and warnings.)</p>

<p style="margin-top: 1em">Don&rsquo;t confuse the payload
argument p=... with the padding option -p. The latter is
used outside the quotes!</p>

<p style="margin-top: 1em">The automatic packet builder:
<br>
An important argument is -t which invokes a packet builder.
Currently there are packet builders for ARP, BPDU, CDP, IP,
partly ICMP, UDP, TCP, RTP, DNS, and SYSLOG. (Additionally
<br>
you can insert a VLAN tag or a MPLS label stack but this
works independently of the packet builder.)</p>

<p style="margin-top: 1em">You get context specific help
for every packet builder using the help keyword, such
as:</p>

<p style="margin-top: 1em">mausezahn -t bpdu help <br>
mausezahn -t tcp help</p>

<p style="margin-top: 1em">For every packet you may specify
an optional payload. This can be done either via hexadecimal
notation using the payload (or short p) argument or directly
as ASCII text using the <br>
-P option:</p>

<p style="margin-top: 1em">mausezahn eth0 -t ip -P
&quot;Hello World&quot; # ASCII payload <br>
mausezahn eth0 -t ip p=68:65:6c:6c:6f:20:77:6f:72:6c:64 #
hex payload <br>
mausezahn eth0 -t ip &quot;proto=89,
p=68:65:6c:6c:6f:20:77:6f:72:6c:64, &nbsp; # same with other
<br>
ttl=1&quot; # IP arguments</p>

<p style="margin-top: 1em">Note: The raw link access mode
only accepts hexadecimal payloads (because you specify
everything in hexadecimal here.)</p>

<p style="margin-top: 1em">Packet count and delay: <br>
By default only one packet is sent. If you want to send more
packets then use the count option -c &lt;count&gt;. When
count is zero then mausezahn will send forever. By default,
<br>
mausezahn sends at maximum speed (and this is really fast
;-)). If you don&rsquo;t want to overwhelm your network
devices or have other reasons to send at a slower rate then
you might <br>
want to specify a delay using the -d &lt;delay&gt;
option.</p>

<p style="margin-top: 1em">If you only specify a numeric
value it is interpreted in microsecond units. Alternatively,
for easier use, you might specify units such as seconds,
sec, milliseconds, or msec. <br>
(You can also abbreviate this with s or m.) Note:
Don&rsquo;t use spaces between the value and the unit! Here
are typical examples:</p>

<p style="margin-top: 1em">Send an infinite number of
frames as fast as possible:</p>

<p style="margin-top: 1em">mausezahn -c 0 &quot;aa bb cc dd
....&quot;</p>

<p style="margin-top: 1em">Send 100,000 frames with a 50
msec interval:</p>

<p style="margin-top: 1em">mausezahn -c 100000 -d 50msec
&quot;aa bb cc dd ....&quot;</p>

<p style="margin-top: 1em">Send an unlimited number of BPDU
frames in a 2 second interval:</p>

<p style="margin-top: 1em">mausezahn -c 0 -d 2s -t bpdu
conf</p>

<p style="margin-top: 1em">Note: mausezahn does not support
fractional numbers. If you want to specify for example 2.5
seconds then express this in milliseconds (2500 msec).</p>

<p style="margin-top: 1em">Source and destination
addresses: <br>
As a mnemonic trick keep in mind that all packets run from
&quot;A&quot; to &quot;B&quot;. You can always specify
source and destination MAC addresses using the -a and -b
options, respectively. <br>
These options also allow keywords such as rand, own, bpdu,
cisco, and others.</p>

<p style="margin-top: 1em">Similarly, you can specify
source and destination IP addresses using the -A and -B
options, respectively. These options also support FQDNs
(i.e. domain names) and ranges such as <br>
192.168.0.0/24 or 10.0.0.11-10.0.3.22. Additionally, the
source address option supports the rand keyword (ideal for
&quot;attacks&quot;).</p>

<p style="margin-top: 1em">Note: When you use the packet
builder for IP-based packets (e.g. UDP or TCP) then
mausezahn automatically cares about correct MAC and IP
addresses (i.e. it performs ARP, DHCP, <br>
and DNS for you). But when you specify at least a single
link-layer address (or any other L2 option such as a VLAN
tag or MPLS header) then ARP is disabled and you must care
for <br>
the Ethernet destination address for yourself.</p>

<p style="margin-top: 1em">Layer-2: <br>
&lsquo;-- Direct link access: <br>
mausezahn allows you to send ANY chain of bytes directly
through your Ethernet interface:</p>

<p style="margin-top: 1em">mausezahn eth0
&quot;ff:ff:ff:ff:ff:ff ff:ff:ff:ff:ff:ff 00:00
ca:fe:ba:be&quot;</p>

<p style="margin-top: 1em">This way you can craft every
packet you want but you must do it by hand. Note: On Wi-Fi
interfaces the header is much more complicated and
automatically created by the Wi-Fi <br>
driver. As an example to introduce some interesting options,
lets continuously send frames at max speed with random
source MAC address and broadcast destination address,
addi&acirc; <br>
tionally pad the frame to 1000 bytes:</p>

<p style="margin-top: 1em">mausezahn eth0 -c 0 -a rand -b
bcast -p 1000 &quot;08 00 aa bb cc dd&quot;</p>

<p style="margin-top: 1em">The direct link access supports
automatic padding using the -p &lt;total frame length&gt;
option. This allows you to pad a raw L2 frame to the desired
length. You must specify the <br>
total length, and the total frame length must have at least
15 bytes for technical reasons. Zero bytes are used for
padding.</p>

<p style="margin-top: 1em">&lsquo;-- ARP: <br>
mausezahn provides a simple interface to the ARP packet. You
can specify the ARP method (request|reply) and up to four
arguments: sendermac, targetmac, senderip, targetip, or <br>
short smac, tmac, sip, tip. By default, an ARP reply is sent
with your own interface addresses as source MAC and IP
address, and a broadcast destination MAC and IP address.
Send <br>
a gratuitous ARP request (as used for duplicate IP address
detection):</p>

<p style="margin-top: 1em">mausezahn eth0 -t arp</p>

<p style="margin-top: 1em">ARP cache poisoning:</p>

<p style="margin-top: 1em">mausezahn eth0 -t arp
&quot;reply, senderip=192.168.0.1,
targetmac=00:00:0c:01:02:03, targetip=172.16.1.50&quot;</p>

<p style="margin-top: 1em">where by default your interface
MAC address will be used as sendermac, senderip denotes the
spoofed IP address, targetmac and targetip identifies the
receiver. By default, the <br>
Ethernet source address is your interface MAC and the
destination address is the broadcast address. You can change
this using the flags -a and -b.</p>

<p style="margin-top: 1em">&lsquo;-- BPDU: <br>
mausezahn provides a simple interface to the 802.1D BPDU
frame format (used to create the Spanning Tree in bridged
networks). By default, standard IEEE 802.1D BPDUs are sent
and <br>
it is assumed that your computer wants to become the root
bridge (rid=bid). Optionally the 802.3 destination address
can be a specified MAC address, broadcast, own MAC, or <br>
Cisco&rsquo;s PVST+ MAC address. The destination MAC can be
specified using the -b command which, besides MAC addresses,
accepts keywords such as bcast, own, pvst, or stp (default).
<br>
PVST+ is supported as well. Simply specify the VLAN for
which you want to send a BPDU:</p>

<p style="margin-top: 1em">mausezahn eth0 -t bpdu
&quot;vlan=123, rid=2000&quot;</p>

<p style="margin-top: 1em">See mausezahn -t bpdu help for
more details.</p>

<p style="margin-top: 1em">&lsquo;-- CDP: <br>
mausezahn can send Cisco Discovery Protocol (CDP) messages
since this protocol has security relevance. Of course lots
of dirty tricks are possible; for example arbitrary TLVs can
<br>
be created (using the hex-payload argument for example
p=00:0e:00:07:01:01:90) and if you want to stress the CDP
database of some device, mausezahn can send each CDP message
with <br>
another system-id using the change keyword:</p>

<p style="margin-top: 1em">mausezahn -t cdp change -c 0</p>

<p style="margin-top: 1em">Some routers and switches may
run into deep problems ;-) See mausezahn -t cdp help for
more details.</p>

<p style="margin-top: 1em">&lsquo;-- 802.1Q VLAN Tags: <br>
mausezahn allows simple VLAN tagging for IP (and other
higher layer) packets. Simply use the option -Q
&lt;[CoS:]VLAN&gt;, such as -Q 10 or -Q 3:921. By default
CoS=0. For example <br>
send a TCP packet in VLAN 500 using CoS=7:</p>

<p style="margin-top: 1em">mausezahn eth0 -t tcp -Q 7:500
&quot;dp=80, flags=rst, p=aa:aa:aa&quot;</p>

<p style="margin-top: 1em">You can create as many VLAN tags
as you want! This is interesting to create QinQ
encapsulations or VLAN hopping: Send a UDP packet with VLAN
tags 100 (outer) and 651 (inner):</p>

<p style="margin-top: 1em">mausezahn eth0 -t udp
&quot;dp=8888, sp=13442&quot; -P &quot;Mausezahn is
great&quot; -Q 100,651</p>

<p style="margin-top: 1em">Don&rsquo;t know if this is
useful anywhere but at least it is possible:</p>

<p style="margin-top: 1em">mausezahn eth0 -t udp
&quot;dp=8888, sp=13442&quot; -P &quot;Mausezahn is
great&quot; -Q 6:5,7:732,5:331,5,6</p>

<p style="margin-top: 1em">Mix it with MPLS:</p>

<p style="margin-top: 1em">mausezahn eth0 -t udp
&quot;dp=8888, sp=13442&quot; -P &quot;Mausezahn is
great&quot; -Q 100,651 -M 314</p>

<p style="margin-top: 1em">When in raw Layer 2 mode you
must create the VLAN tag completely by yourself. For example
if you want to send a frame in VLAN 5 using CoS 0 simply
specify 81:00 as type field <br>
and for the next two bytes the CoS (PCP), DEI (CFI), and
VLAN ID values (all together known as TCI):</p>

<p style="margin-top: 1em">mausezahn eth0 -b bc -a rand
&quot;81:00 00:05 08:00 aa-aa-aa-aa-aa-aa-aa-aa-aa&quot;</p>

<p style="margin-top: 1em">&lsquo;-- MPLS labels: <br>
mausezahn allows you to insert one or more MPLS headers.
Simply use the option -M &lt;label:CoS:TTL:BoS&gt; where
only the label is mandatory. If you specify a second number
it is <br>
interpreted as the experimental bits (the CoS usually). If
you specify a third number it is interpreted as TTL. By
default the TTL is set to 255. The Bottom of Stack flag is
set <br>
automatically, otherwise the frame would be invalid, but if
you want you can also set or unset it using the S (set) and
s (unset) argument. Note that the BoS must be the last <br>
argument in each MPLS header definition. Here are some
examples:</p>

<p style="margin-top: 1em">Use MPLS label 214:</p>

<p style="margin-top: 1em">mausezahn eth0 -M 214 -t tcp
&quot;dp=80&quot; -P &quot;HTTP...&quot; -B myhost.com</p>

<p style="margin-top: 1em">Use three labels (the 214 is now
the outer):</p>

<p style="margin-top: 1em">mausezahn eth0 -M 9999,51,214 -t
tcp &quot;dp=80&quot; -P &quot;HTTP...&quot; -B
myhost.com</p>

<p style="margin-top: 1em">Use two labels, one with CoS=5
and TTL=1, the other with CoS=7:</p>

<p style="margin-top: 1em">mausezahn eth0 -M 100:5:1,500:7
-t tcp &quot;dp=80&quot; -P &quot;HTTP...&quot; -B
myhost.com</p>

<p style="margin-top: 1em">Unset the BoS flag (which will
result in an invalid frame):</p>

<p style="margin-top: 1em">mausezahn eth0 -M 214:s -t tcp
&quot;dp=80&quot; -P &quot;HTTP...&quot; -B myhost.com</p>

<p style="margin-top: 1em">Layer 3-7: <br>
IP, UDP, and TCP packets can be padded using the -p option.
Currently 0x42 is used as padding byte (&rsquo;the
answer&rsquo;). You cannot pad DNS packets (would be useless
anyway).</p>

<p style="margin-top: 1em">&lsquo;-- IP: <br>
mausezahn allows you to send any malformed or correct IP
packet. Every field in the IP header can be manipulated. The
IP addresses can be specified via the -A and -B options,
<br>
denoting the source and destination address, respectively.
You can also specify an address range or a host name (FQDN).
Additionally, the source address can also be random. By <br>
default the source address is your interface IP address and
the destination address is a broadcast address. Here are
some examples:</p>

<p style="margin-top: 1em">ASCII payload:</p>

<p style="margin-top: 1em">mausezahn eth0 -t ip -A rand -B
192.168.1.0/24 -P &quot;hello world&quot;</p>

<p style="margin-top: 1em">Hexadecimal payload:</p>

<p style="margin-top: 1em">mausezahn eth0 -t ip -A
10.1.0.1-10.1.255.254 -B 255.255.255.255 p=ca:fe:ba:be</p>

<p style="margin-top: 1em">Will use correct source IP
address:</p>

<p style="margin-top: 1em">mausezahn eth0 -t ip -B
www.xyz.com</p>

<p style="margin-top: 1em">The Type of Service (ToS) byte
can either be specified directly by two hexadecimal digits,
which means you can also easily set the Explicit Congestion
Notification (ECN) bits <br>
(LSB 1 and 2), or you may only want to specify a common DSCP
value (bits 3-8) using a decimal number (0..63):</p>

<p style="margin-top: 1em">Packet sent with DSCP =
Expedited Forwarding (EF):</p>

<p style="margin-top: 1em">mausezahn eth0 -t ip
dscp=46,ttl=1,proto=1,p=08:00:5a:a2:de:ad:be:af</p>

<p style="margin-top: 1em">If you leave the checksum as
zero (or unspecified) the correct checksum will be
automatically computed. Note that you can only use a wrong
checksum when you also specify at least <br>
one L2 field manually.</p>

<p style="margin-top: 1em">&lsquo;-- UDP: <br>
mausezahn supports easy UDP datagram generation. Simply
specify the destination address (-B option) and optionally
an arbitrary source address (-A option) and as arguments you
<br>
may specify the port numbers using the dp (destination port)
and sp (source port) arguments and a payload. You can also
easily specify a whole port range which will result in <br>
sending multiple packets. Here are some examples:</p>

<p style="margin-top: 1em">Send test packets to the RTP
port range:</p>

<p style="margin-top: 1em">mausezahn eth0 -B 192.168.1.1 -t
udp &quot;dp=16384-32767,
p=A1:00:CC:00:00:AB:CD:EE:EE:DD:DD:00&quot;</p>

<p style="margin-top: 1em">Send a DNS request as local
broadcast (often a local router replies):</p>

<p style="margin-top: 1em">mausezahn eth0 -t udp
dp=53,p=c5-2f-01-00-00-01-00-00-00-00-00-00-03-77-77-
77-03-78-79-7a-03-63-6f-6d-00-00-01-00-01&quot;</p>

<p style="margin-top: 1em">Additionally you may specify the
length and checksum using the len and sum arguments (will be
set correctly by default). Note: several protocols have same
arguments such as len <br>
(length) and sum (checksum). If you specified a UDP type
packet (via -t udp) and want to modify the IP length, then
use the alternate keyword iplen and ipsum. Also note that
you <br>
must specify at least one L2 field which tells mausezahn to
build everything without the help of your kernel (the kernel
would not allow modifying the IP checksum and the IP <br>
length).</p>

<p style="margin-top: 1em">&lsquo;-- ICMP: <br>
mausezahn currently only supports the following ICMP
methods: PING (echo request), Redirect (various types),
Unreachable (various types). Additional ICMP types will be
supported <br>
in future. Currently you would need to tailor them by
yourself, e.g. using the IP packet builder (setting
proto=1). Use the mausezahn -t icmp help for help on
currently imple&acirc; <br>
mented options.</p>

<p style="margin-top: 1em">&lsquo;-- TCP: <br>
mausezahn allows you to easily tailor any TCP packet.
Similarly as with UDP you can specify source and destination
port (ranges) using the sp and dp arguments. Then you can
<br>
directly specify the desired flags using an &quot;|&quot; as
delimiter if you want to specify multiple flags. For
example, a SYN-Flood attack against host 1.1.1.1 using a
random source IP <br>
address and periodically using all 1023 well-known ports
could be created via:</p>

<p style="margin-top: 1em">mausezahn eth0 -A rand -B
1.1.1.1 -c 0 -t tcp &quot;dp=1-1023, flags=syn&quot; -P
&quot;Good morning! This is a SYN Flood Attack. We apologize
for any inconvenience.&quot;</p>

<p style="margin-top: 1em">Be careful with such SYN floods
and only use them for firewall testing. Check your legal
position! Remember that a host with an open TCP session only
accepts packets with correct <br>
socket information (addresses and ports) and a valid TCP
sequence number (SQNR). If you want to try a DoS attack by
sending a RST-flood and you do NOT know the target&rsquo;s
initial <br>
SQNR (which is normally the case) then you may want to sweep
through a range of sequence numbers:</p>

<p style="margin-top: 1em">mausezahn eth0 -A legal.host.com
-B target.host.com -t tcp
&quot;sp=80,dp=80,s=1-4294967295&quot;</p>

<p style="margin-top: 1em">Fortunately, the SQNR must match
the target host&rsquo;s acknowledgement number plus the
announced window size. Since the typical window size is
something between 40000 and 65535 you <br>
are MUCH quicker when using an increment via the ds
argument:</p>

<p style="margin-top: 1em">mausezahn eth0 -A legal.host.com
-B target.host.com -t tcp &quot;sp=80, dp=80,
s=1-4294967295, ds=40000&quot;</p>

<p style="margin-top: 1em">In the latter case mausezahn
will only send 107375 packets instead of 4294967295 (which
results in a duration of approximately 1 second compared to
11 hours!). Of course you can <br>
tailor any TCP packet you like. As with other L4 protocols
mausezahn builds a correct IP header but you can
additionally access every field in the IP packet (also in
the Ethernet <br>
frame).</p>

<p style="margin-top: 1em">&lsquo;-- DNS: <br>
mausezahn supports UDP-based DNS requests or responses.
Typically you may want to send a query or an answer. As
usual, you can modify every flag in the header. Here is an
exam&acirc; <br>
ple of a simple query:</p>

<p style="margin-top: 1em">mausezahn eth0 -B
mydns-server.com -t dns &quot;q=www.ibm.com&quot;</p>

<p style="margin-top: 1em">You can also create server-type
messages:</p>

<p style="margin-top: 1em">mausezahn eth0 -A
spoofed.dns-server.com -B target.host.com
&quot;q=www.topsecret.com, a=172.16.1.1&quot;</p>

<p style="margin-top: 1em">The syntax according to the
online help (-t dns help) is:</p>

<p style="margin-top: 1em">query|q =
&lt;name&gt;[:&lt;type&gt;] ............. where type is per
default &quot;A&quot; <br>
(and class is always &quot;IN&quot;) <br>
answer|a = [&lt;type&gt;:&lt;ttl&gt;:]&lt;rdata&gt; ......
ttl is per default 0. <br>
=
[&lt;type&gt;:&lt;ttl&gt;:]&lt;rdata&gt;/[&lt;type&gt;:&lt;ttl&gt;:]&lt;rdata&gt;/...</p>

<p style="margin-top: 1em">Note: If you only use the
&rsquo;query&rsquo; option then a query is sent. If you
additionally add an &rsquo;answer&rsquo; then an answer is
sent. Examples:</p>

<p style="margin-top: 1em">q = www.xyz.com <br>
q = www.xyz.com, a=192.168.1.10 <br>
q = www.xyz.com, a=A:3600:192.168.1.10 <br>
q = www.xyz.com,
a=CNAME:3600:abc.com/A:3600:192.168.1.10</p>

<p style="margin-top: 1em">Please try out mausezahn -t dns
help to see the many other optional command line
options.</p>

<p style="margin-top: 1em">&lsquo;-- RTP and VoIP path
measurements: <br>
mausezahn can send arbitrary Real Time Protocol (RTP)
packets. By default a classical G.711 codec packet of 20 ms
segment size and 160 bytes is assumed. You can measure
jitter, <br>
packet loss, and reordering along a path between two hosts
running mausezahn. The jitter measurement is either done
following the variance low-pass filtered estimation
specified <br>
in RFC 3550 or using an alternative &quot;real-time&quot;
method which is even more precise (the RFC-method is used by
default). For example on Host1 you start a transmission
process:</p>

<p style="margin-top: 1em">mausezahn -t rtp -B
192.168.1.19</p>

<p style="margin-top: 1em">And on Host2 (192.168.1.19) a
receiving process which performs the measurement:</p>

<p style="margin-top: 1em">mausezahn -T rtp</p>

<p style="margin-top: 1em">Note that the option flag with
the capital &quot;T&quot; means that it is a server RTP
process, waiting for incoming RTP packets from any mausezahn
source. In case you want to restrict the <br>
measurement to a specific source or you want to perform a
bidirectional measurement, you must specify a stream
identifier. Here is an example for bidirectional
measurements <br>
which logs the running jitter average in a file:</p>

<p style="margin-top: 1em">Host1# mausezahn -t rtp
id=11:11:11:11 -B 192.168.2.2 &amp; <br>
Host1# mausezahn -T rtp id=22:22:22:22 &quot;log,
path=/tmp/mz/&quot;</p>

<p style="margin-top: 1em">Host2# mausezahn -t rtp
id=22:22:22:22 -B 192.168.1.1 &amp; <br>
Host2# mausezahn -T rtp id=11:11:11:11 &quot;log,
path=/tmp/mz/&quot;</p>

<p style="margin-top: 1em">In any case the measurements are
printed continuously onto the screen; by default it looks
like this:</p>

<p style="margin-top: 1em">0.00 0.19 0.38 0.57 <br>

|-------------------------|-------------------------|-------------------------|
<br>
######### 0.07 msec <br>
#################### 0.14 msec <br>
## 0.02 msec <br>
### 0.02 msec <br>
######### 0.07 msec <br>
#### 0.03 msec <br>
######### 0.07 msec <br>
############# 0.10 msec <br>
## 0.02 msec <br>
########################################### 0.31 msec <br>
######### 0.07 msec <br>
############################################## 0.33 msec
<br>
############### 0.11 msec <br>
########## 0.07 msec <br>
############### 0.11 msec <br>
##########################################################
0.42 msec <br>
##### 0.04 msec</p>

<p style="margin-top: 1em">More information is shown using
the txt keyword:</p>

<p style="margin-top: 1em">mausezahn -T rtp txt <br>
Got 100 packets from host 192.168.0.3: 0 lost (0 absolute
lost), 1 out of order <br>
Jitter_RFC (low pass filtered) = 30 usec <br>
Samples jitter (min/avg/max) = 1/186/2527 usec <br>
Delta-RX (min/avg/max) = 2010/20167/24805 usec <br>
Got 100 packets from host 192.168.0.3: 0 lost (0 absolute
lost), 1 out of order <br>
Jitter_RFC (low pass filtered) = 17 usec <br>
Samples jitter (min/avg/max) = 1/53/192 usec <br>
Delta-RX (min/avg/max) = 20001/20376/20574 usec <br>
Got 100 packets from host 192.168.0.3: 0 lost (0 absolute
lost), 1 out of order <br>
Jitter_RFC (low pass filtered) = 120 usec <br>
Samples jitter (min/avg/max) = 0/91/1683 usec <br>
Delta-RX (min/avg/max) = 18673/20378/24822 usec</p>

<p style="margin-top: 1em">See mausezahn -t rtp help and mz
-T rtp help for more details.</p>

<p style="margin-top: 1em">&lsquo;-- Syslog: <br>
The traditional Syslog protocol is widely used even in
professional networks and is sometimes vulnerable. For
example you might insert forged Syslog messages by spoofing
your <br>
source address (e.g. impersonate the address of a legit
network device):</p>

<p style="margin-top: 1em">mausezahn -t syslog sev=3 -P
&quot;You have been mausezahned.&quot; -A 10.1.1.109 -B
192.168.7.7</p>

<p style="margin-top: 1em">See mausezahn -t syslog help for
more details.</p>

<p style="margin-top: 1em">NOTE <br>
When multiple ranges are specified, e.g. destination port
ranges and destination address ranges, then all possible
combinations of ports and addresses are used for packet
genera&acirc; <br>
tion. Furthermore, this can be mixed with other ranges e.g.
a TCP sequence number range. Note that combining ranges can
lead to a very huge number of frames to be sent. As a rule
<br>
of thumb you can assume that about 100,000 frames and more
are sent in a fraction of one second, depending on your
network interface.</p>

<p style="margin-top: 1em">mausezahn has been designed as a
fast traffic generator so you might easily overwhelm a LAN
segment with myriads of packets. And because mausezahn could
also support security <br>
audits it is possible to create malicious or invalid
packets, SYN floods, port and address sweeps, DNS and ARP
poisoning, etc.</p>

<p style="margin-top: 1em">Therefore, don&rsquo;t use this
tool when you are not aware of the possible consequences or
have only a little knowledge about networks and data
communication. If you abuse mausezahn <br>
for &rsquo;unallowed&rsquo; attacks and get caught, or
damage something of your own, then this is completely your
fault. So the safest solution is to try it out in a lab
environment.</p>

<p style="margin-top: 1em">Also have a look at the
netsniff-ng(8) note section on how you can properly setup
and tune your system.</p>

<p style="margin-top: 1em">LEGAL <br>
mausezahn is licensed under the GNU GPL version 2.0.</p>

<p style="margin-top: 1em">HISTORY <br>
mausezahn was originally written by Herbert Haas. According
to his website [1], he unfortunately passed away in 2011
thus leaving this tool unmaintained. It has been adopted and
<br>
integrated into the netsniff-ng toolkit and is further being
maintained and developed from there. Maintainers are Tobias
Klauser &lt;tklauser@distanz.ch&gt; and Daniel Borkmann <br>
&lt;dborkma@tik.ee.ethz.ch&gt;.</p>

<p style="margin-top: 1em">[1] http://www.perihel.at/</p>

<p style="margin-top: 1em">SEE ALSO <br>
netsniff-ng(8), trafgen(8), ifpps(8), bpfc(8), flowtop(8),
astraceroute(8), curvetun(8)</p>

<p style="margin-top: 1em">AUTHOR <br>
Manpage was written by Herbert Haas and modified by Daniel
Borkmann.</p>

<p style="margin-top: 1em">COLOPHON <br>
This page is part of the Linux netsniff-ng toolkit project.
A description of the project, and information about
reporting bugs, can be found at http://netsniff-ng.org/.</p>

<p style="margin-top: 1em">Linux 03 March 2013
MAUSEZAHN(8)</p>
<hr>
</body>
</html>
