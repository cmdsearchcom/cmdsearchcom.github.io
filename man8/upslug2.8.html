<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>UPSLUG2(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">UPSLUG2(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">UPSLUG2(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
upslug2 - utility to upgrade the firmware of a NSLU2 via the network
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>upslug2</b> [options]
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>upslug2</b> is a command line program intended to allow the upgrade the
  firmware of a LinkSys NSLU2 (Network Storage Link for USB 2.0 Disk Drives) to
  new or different versions. When a NSLU2 in the local network is put in upgrade
  mode, <b>upslug2</b> can connect to it and upload a new firmware.
<div style="height: 1.00em;">&#x00A0;</div>
<b>upslug2</b> will accept a full firmware image but it can also upgrade the
  flash from individual files holding the kernel, ramdisk and root filesystem.
  <b>upslug2</b> provides status information during the upgrade process and
  verifies the written image after the upgrade.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-C</b>, <b>--Complete-reprogram</b></dt>
  <dd class="It-tag">Reprogram the complete flash, including the RedBoot boot
      loader and the SysConf partition holding configuration information. Using
      this option may result in the NSLU2 becoming permanently unusable! By
      default, <b>upslug2</b> will not touch these two partitions since this
      allows flashing a new firmware if an uploaded firmware does not work. This
      is not possible if RedBoot itself is damaged. Use with caution.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d</b>, <b>--device</b></dt>
  <dd class="It-tag">The network device on the host machine connected to the
      network on which the NSLU2 is located. (Default: eth0).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-e</b>, <b>--endian</b></dt>
  <dd class="It-tag">The endianness of the files to be uploaded. <b>upslug2</b>
      will usually detected the endianness automatically but this option can be
      used to force byte swapping to occur. This option accepts three values,
      separated by comma: endianness of kernel, data and RedBoot FIS directory.
      Valid values are <b>l</b> (little endian), <b>p</b> (pdp endian) and
      <b>b</b> (big endian). (Default: ,b,b)
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b>, <b>--from</b></dt>
  <dd class="It-tag">The MAC address of the host system.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h</b>, <b>--help</b></dt>
  <dd class="It-tag">Show summary of options.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i</b>, <b>--image</b></dt>
  <dd class="It-tag">The flash image to use.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-j</b>, <b>--rootfs</b></dt>
  <dd class="It-tag">A root filesystem, usually of type jffs.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-k</b>, <b>--kernel</b></dt>
  <dd class="It-tag">A compressed kernel zImage image.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n</b>, <b>--no-reboot</b></dt>
  <dd class="It-tag">Do not reboot after upgrade
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p</b>, <b>--payload</b></dt>
  <dd class="It-tag">FIS directory payload. There are about 140 Kb in the last
      block (between the FIS dir and the trailer at the end) which can be used
      for data.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-r</b>, <b>--ramdisk</b></dt>
  <dd class="It-tag">A compressed ramdisk image.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-R</b>, <b>--ram-payload</b></dt>
  <dd class="It-tag">A ram paylod (replaced ramdisk). (FIXME: if it replaced the
      ramdisk, why cannot you just use the -r option? What's the difference)
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-t</b>, <b>--target</b></dt>
  <dd class="It-tag">The MAC address of the NSLU2 to upgrade. Without this
      option, <b>upslug2</b> will only perform an upgrade if there is just one
      NSLU2 in upgrade mode.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-U</b>, <b>--no-verify</b></dt>
  <dd class="It-tag">Do not verify the image, only upgrade.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v</b>, <b>--verify</b></dt>
  <dd class="It-tag">Do not write to flash, only verify the image.
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h2 class="Ss" title="Ss" id="Options_to_specify_firmware_information"><a class="selflink" href="#Options_to_specify_firmware_information">Options
  to specify firmware information</a></h2>
The following options should be used when individual kernel, ramdisk and root
  filesystem files are specified rather than a firmware image.
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-E</b>, <b>--extra-version</b></dt>
  <dd class="It-tag">Extra version information, a 2 byte value. (Default:
      0x90f7)
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-F</b>, <b>--firmware-version</b></dt>
  <dd class="It-tag">The firmware version, a 2 byte value. (Default: 0x2329)
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-P</b>, <b>--product-id</b></dt>
  <dd class="It-tag">The product ID, a 2 byte value. (Default: 1)
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-T</b>, <b>--protocol-id</b></dt>
  <dd class="It-tag">The protocol ID, a 2 byte value. (Default: 0)
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="USING_UPSLUG2"><a class="selflink" href="#USING_UPSLUG2">USING
  UPSLUG2</a></h1>
In order to use <b>upslug2</b> the NSLU2 which is to be upgraded has to be put
  in upgrade mode:
<div style="height: 1.00em;">&#x00A0;</div>
1. Disconnect any disks and/or devices from the USB ports.
<div style="height: 1.00em;">&#x00A0;</div>
2. Power off the NSLU2
<div style="height: 1.00em;">&#x00A0;</div>
3. Press and hold the reset button (accessible through the small hole on the
  back just above the power input).
<div style="height: 1.00em;">&#x00A0;</div>
4. Press and release the power button to power on the NSLU2.
<div style="height: 1.00em;">&#x00A0;</div>
5. Wait for 10 seconds watching the ready/status LED. After 10 seconds it will
  change from amber to red. Immediately release the reset button.
<div style="height: 1.00em;">&#x00A0;</div>
6. The NSLU2 ready/status LED will flash alternately red/green (there is a 1
  second delay before the first green). The NSLU2 is now in upgrade mode.
<div style="height: 1.00em;">&#x00A0;</div>
If you decide not to flash the image the NSLU2 can be rebooted by disconnecting
  the power. If the ready/status LED does not turn green after step four it will
  remain red for several seconds then flash amber. This happens if you do not
  release the reset button in time - pull the power, reconnect it and repeat
  from the second step.
<div style="height: 1.00em;">&#x00A0;</div>
Once the NSLU2 is in upgrade mode it will remain in this state until either the
  power is connected or a new image has been flashed. If the flash fails the
  NSLU2 will (eventually) return to upgrade mode
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
The most common use of <b>upslug2</b> is the following:
<div style="margin-left: 5.00ex;">upslug2 --image NSLU2_V23R63.bin</div>
This specifies a firmware image which will be written to flash (with the
  exception of the RedBoot and SysConf partitions).
<div style="height: 1.00em;">&#x00A0;</div>
Alternatively, kernel, ramdisk and root filesystem can be specified
  individually:
<div style="margin-left: 5.00ex;">upslug2 -k nslu2-zImage -r ramdisk -j
  root.jffs</div>
In this case, the options <b>-E</b>, <b>-F</b>, <b>-P</b> and <b>-T</b> should
  typically be specified as well.
<div style="height: 1.00em;">&#x00A0;</div>
By default, <b>upslug2</b> will search for the NSLU2 on the network on your eth0
  network interface. If the network is on a different interface, you can easily
  specify it:
<div style="margin-left: 5.00ex;">upslug2 -d eth1 --image NSLU2_V23R63.bin</div>
<div style="height: 1.00em;">&#x00A0;</div>
If there are potentially more than one NSLU2 in your network which may be in
  upgrade mode, you can specify its MAC address:
<div style="margin-left: 5.00ex;">upslug2 -t 00:11:85:12:34:56 --image
  NSLU2_V23R63.bin</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>slugimage</b>(1)
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
John Bowler &lt;jbowler@acm.org&gt;
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">January 2006</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
