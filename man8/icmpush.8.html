<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:11:59 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>ICMPUSH(8) System Manager&rsquo;s Manual ICMPUSH(8)</p>

<p style="margin-top: 1em">NAME <br>
icmpush - ICMP packet builder</p>

<p style="margin-top: 1em">SYNOPSIS <br>
icmpush type [options] host</p>

<p style="margin-top: 1em">DESCRIPTION <br>
icmpush is a tool that builds ICMP packets fully customized
from command line.</p>

<p style="margin-top: 1em">It supports the following ICMP
error types: Redirect, Source Quench, Time Exceeded,
Destination Unreach and Parameter Problem.</p>

<p style="margin-top: 1em">And the following ICMP
information types: Address Mask Request, Timestamp,
Information Request, Echo Request, Router Solicitation and
Router Advertisement.</p>

<p style="margin-top: 1em">Is not of our concern to give a
fully description of how ICMP protocol works, but the more
knowledgement we have we can fully understand its
management, use and posibilities of <br>
this tool.</p>

<p style="margin-top: 1em">The quantity of arguments needed
can appear excessive but his own author reminds that some
imperative data must be given through a command line for a
fully adjustment to the pro&acirc; <br>
tocol format on a ICMP packet construction.</p>

<p style="margin-top: 1em">A long number of examples is
given at the EXAMPLES section of this page that shows a real
use of this program.</p>

<p style="margin-top: 1em">OPTIONS <br>
-h, --help <br>
Help.</p>

<p style="margin-top: 1em">-V, --version <br>
Program version.</p>

<p style="margin-top: 1em">-v, --verbose <br>
Informative mode.</p>

<p style="margin-top: 1em">-vv, --more_verbose <br>
More informative. Useful when debugging.</p>

<p style="margin-top: 1em">The ICMP type type can be any of
the following below:</p>

<p style="margin-top: 1em">-du, --dest_unreach <br>
Destination Unreach. IP packet couldn&rsquo;t be given. This
ICMP type is error.</p>

<p style="margin-top: 1em">-sq, --src_quench <br>
Source Quench. IP packet is not given do a congestion on the
net. This ICMP type is error.</p>

<p style="margin-top: 1em">-red, --redirect <br>
Redirect. Request to forward IP packets through another
router. This ICMP type is error.</p>

<p style="margin-top: 1em">-echo, --echo_request <br>
Echo Request. Request sent to a host to receive an echo
reply. This ICMP type is information.</p>

<p style="margin-top: 1em">-rta, --router_advert
address[/preference] <br>
Router Advertisement. Router trasmits one or more routers
with address address and preference preference. If this is
ommited, default preference 0 is given. This ICMP <br>
type is information.</p>

<p style="margin-top: 1em">-rts, --router_solicit <br>
Router Solicitation. Host requeriment for a message of one
or more routers. Like the previous, is a part of the
messages exchange Router Discovery and this ICMP type is
<br>
information.</p>

<p style="margin-top: 1em">-tx, --time_exc <br>
Time Exceeded. Time Exceeded for an IP packet. This ICMP
type is error.</p>

<p style="margin-top: 1em">-param, --param_problem <br>
Parameter Problem. Erroneous value on a variable of IP
header. This ICMP type is error.</p>

<p style="margin-top: 1em">-tstamp, --timestamp <br>
Timestamp. Host request to receive the time of another host.
This ICMP type is information.</p>

<p style="margin-top: 1em">-info, --info_req <br>
Information Request. Host request to receive an Info Reply
from another host. This ICMP type is information.</p>

<p style="margin-top: 1em">-mask, --mask_req <br>
Address Mask Request. Used to find out a host network mask.
This ICMP type is information.</p>

<p style="margin-top: 1em">The options can be any of the
following:</p>

<p style="margin-top: 1em">-sp, --spoof address <br>
IP address to be used as the source of the ICMP packet.</p>

<p style="margin-top: 1em">-to, --timeout secs <br>
Timeout in seconds to read the answers. Only valid on ICMPs
of information type but the Router Advertisement type
(-rta). Default is 5 seconds. If 0 is given answers can <br>
not be read.</p>

<p style="margin-top: 1em">-n, --no_resolve <br>
Don&rsquo;t use name resolution.</p>

<p style="margin-top: 1em">-lt, --lifetime secs <br>
Lifetime in seconds of the router announcement. Only valid
with Router Advertisement (-rta) type. 1800 seconds on
default (30&rsquo;).</p>

<p style="margin-top: 1em">-gw, --gateway address <br>
Route gateway address on an ICMP Redirect (-red). On default
will be the spoof address (-sp), if it has been specified,
or the outgoing IP address if it has not been <br>
specified.</p>

<p style="margin-top: 1em">-dest, --route_dest address <br>
Route destination address on an ICMP Redirect (-red). This
is a required option when sending an ICMP Redirect.</p>

<p style="margin-top: 1em">-orig, --orig_host address <br>
Original host within the IP header sent in the 64 bits data
field of an ICMP error. On default will be the same as the
IP of the host that sends the ICMP packet.</p>

<p style="margin-top: 1em">-psrc, --port_src port <br>
Source port (tcp or udp) within the IP header sent in the 64
bits data field of an ICMP error. 0 on default.</p>

<p style="margin-top: 1em">-pdst, --port_dest port <br>
Destination port (tcp or udp) within the IP header sent in
the 64 bits data field of an ICMP error. 0 on default.</p>

<p style="margin-top: 1em">-prot, --protocol icmp|tcp|udp
<br>
Protocol to be used within the IP header sent in the 64 bits
data field of an ICMP error. Must be one of the three listed
above. Tcp on default.</p>

<p style="margin-top: 1em">-id, --echo_id identificator
<br>
Echo identificator within the IP header sent in the 64 bits
data field of an ICMP error when the IP header protocol of
the 64 bits data field (-prot) is icmp. 0 on <br>
default.</p>

<p style="margin-top: 1em">-seq, --echo_seq sequence <br>
Echo sequence number within the IP header sent in the 64
bits data field of an ICMP error when the IP header protocol
of the 64 bits data field (-prot) is icmp. 0 on <br>
default.</p>

<p style="margin-top: 1em">-pat, --pattern pattern <br>
Data pattern to send on an Echo Request (-echo).</p>

<p style="margin-top: 1em">-gbg, --garbage bytes|max <br>
Number of garbage bytes that will be sent on any ICMP
packet. With max the maximum possible will be sent.</p>

<p style="margin-top: 1em">-ptr, --pointer byte <br>
Pointer to erroneus byte byte on an ICMP packet showing a
parameter problem. Valid only on Parameter Problem type
(-param).</p>

<p style="margin-top: 1em">-c, --code code|num|max <br>
ICMP code to send. Code code valid for Destination Unreach
(-du), Redirect (-red) and Time Exceeded (-tx) types.</p>

<p style="margin-top: 1em">Numerical code can be specified
for the ICMP types that doesn&rsquo;t have (Echo Request,
Information Request, Address Mask Request, Router
Solicitation, Router Advertisement, <br>
Source Quench, Parameter Problem and Timestamp).</p>

<p style="margin-top: 1em">Using max an ICMP code bigger
than the admited ones will be sent.</p>

<p style="margin-top: 1em">Next ICMP CODES section
enumerates the valid code types.</p>

<p style="margin-top: 1em">ICMP CODES <br>
Valid codes used with Destination Unreach, Redirect y Time
Exceeded types are,</p>

<p style="margin-top: 1em">- Used with Destination Unreach
type (-du):</p>

<p style="margin-top: 1em">net-unreach (Net Unreachable)
The destination net is unreacheable.</p>

<p style="margin-top: 1em">host-unreach (Host Unreachable)
The destination host is unreacheable.</p>

<p style="margin-top: 1em">prot-unreach (Protocol
Unreachable) desired protocol is unreacheable to destination
host.</p>

<p style="margin-top: 1em">port-unreach (Port Unreachable)
desired port is unreacheable to destination host.</p>

<p style="margin-top: 1em">frag-needed (Fragmentation
Needed and Don&rsquo;t Fragment was Set) Shows that IP
packet had to be fragmented because of its size but the
sender did not allowed it because of DF (DON&rsquo;T <br>
FRAGMENT) flag.</p>

<p style="margin-top: 1em">sroute-fail (Source Route
Failed) could&rsquo;nt follow the route indicated on IP
packet.</p>

<p style="margin-top: 1em">net-unknown (Destination Network
Unknown) Destination network is unknown.</p>

<p style="margin-top: 1em">host-unknown (Destination Host
Unknown) Destination host unknown but network is.</p>

<p style="margin-top: 1em">host-isolated (Source Host
Isolated) Can&rsquo;t reach destination host.</p>

<p style="margin-top: 1em">net-ano (Communication with
Destination Network is Administratively Prohibited) access
network is denied through firewall or similar on receiver
side.</p>

<p style="margin-top: 1em">host-ano (Communication with
Destination Host is Administratively Prohibited) access host
is denied through firewall or similar on receiver side.</p>

<p style="margin-top: 1em">net-unr-tos (Destination Network
Unreachable for Type of Service) indicates on destination
network that the Type Of Service (TOS) applied for is not
allowed.</p>

<p style="margin-top: 1em">host-unr-tos (Destination Host
Unreachable for Type of Service) shows that destination host
is unreachable with applied TOS.</p>

<p style="margin-top: 1em">com-admin-prohib (Communication
Administratively Prohibited) a router can&rsquo;t forward a
packet because of administrative filter.</p>

<p style="margin-top: 1em">host-precedence-viol (Host
Precedence Violation) IP packet procedence is not
allowed.</p>

<p style="margin-top: 1em">precedence-cutoff (Precedence
cutoff in effect) a smaller IP packet precedence has tried
to be sent over the minimous impossed by network&rsquo;s
manager.</p>

<p style="margin-top: 1em">- To be used with Redirect type
(-red):</p>

<p style="margin-top: 1em">net (Redirect Datagram for the
Network) shows that destination is a network.</p>

<p style="margin-top: 1em">host (Redirect Datagram for the
Host) shows that destination is a host.</p>

<p style="margin-top: 1em">serv-net (Redirect Datagram for
the Type Of Service and Network) destination is a type of
service and network.</p>

<p style="margin-top: 1em">serv-host (Redirect Datagram for
the Type Of Service and Host) destination is a type of
service and host.</p>

<p style="margin-top: 1em">and</p>

<p style="margin-top: 1em">- to be used with Time Exceeded
type (-tx):</p>

<p style="margin-top: 1em">ttl (Time to Live exceeded in
Transit) time is over on an IP&rsquo;s header packet.</p>

<p style="margin-top: 1em">frag (Fragment Reassembly Time
Exceeded) could not put IP&rsquo;s packet fragment together
again.</p>

<p style="margin-top: 1em">RETURN CODES <br>
icmpush can be easily used within shell scripts. Program
returns the following data to the shell:</p>

<p style="margin-top: 1em">Value Meaning <br>
----- ----------- <br>
0 Finished program OK. <br>
1 Incorrect argument number. <br>
2 Unkown ICMP protocol. <br>
3 Cannot create RAW socket type. <br>
4 Erroneous ICMP packet. <br>
5 Erroneous gateway. <br>
6 Erroneous destination route. <br>
7 Erroneous ICMP packet code. <br>
8 Erroneous source host. <br>
9 Error sending packet. <br>
10 Protocol still not implemented. <br>
11 Erroneous IP address or spoof host incorrect. <br>
12 Could not save memory for the data_hdr union. <br>
13 Erroneous IP address or packet destination host. <br>
14 Unkown protocol. <br>
16 Error reading RAW socket. <br>
17 Error initializing signal handler SIGALARM. <br>
18 Echo Request packet data too big. <br>
19 Source port incorrect. <br>
20 Destination port incorrect. <br>
21 Incorrect timeout value. <br>
22 Incorrect Echo ID. <br>
23 Incorrect sequence number. <br>
24 Erroneous Echo data. <br>
25 IP_HDRINCL error. <br>
26 Erroneous router address in Router Advertisement. <br>
27 Incorrect garbage bytes number. <br>
28 Incorrect ICMP pointer Parameter Problem.</p>

<p style="margin-top: 1em">EXAMPLES <br>
- In response to a packet send with TCP source port 100 and
destination on port 90, we want to send and ICMP Redirect to
asshole.es to modify its routing table with the following
<br>
data: 10.12.12.12 as a gateway to the host death.es masking
the packet source as if it was sent from infect.comx
host:</p>

<p style="margin-top: 1em">icmpush -red -sp infect.comx -gw
10.12.12.12 -dest death.es -c host -prot tcp -psrc 100 -pdst
90 asshole.es</p>

<p style="margin-top: 1em">- In response to an ICMP packet
Echo Request sent with Echo Request id 100 and Echo Request
sequence number 90, we want to send an ICMP Redirect to the
host hemorroids.es to mod&acirc; <br>
ify its routing table with the following data: the host
pizza.death as a gateway to the host death.es, masking the
packet source as if iit was sent from infect.comx host.</p>

<p style="margin-top: 1em">icmpush -red -sp infect.comx -gw
pizza.death -dest death.es -c host -prot icmp -id 100 -seq
90 hemorroids.es</p>

<p style="margin-top: 1em">- We want to send an ICMP packet
Destination Unreach to the host 10.2.3.4 saying that our TCP
port number 20 connected with his TCP port 2100, is
unreachable. We mask ourselves <br>
as host 10.1.1.1:</p>

<p style="margin-top: 1em">icmpush -du -sp 10.1.1.1 -c
port-unreach -prot tcp -psrc 2100 -pdst 20 10.2.3.4</p>

<p style="margin-top: 1em">- We want to send an ICMP packet
Destination Unreach to host 10.2.3.4 saying that the host
inferno.hell and its TCP port 69, connected with his port
TCP 666 in unreacheable. We <br>
mask ourselves as gateway router.comx:</p>

<p style="margin-top: 1em">icmpush -du -sp router.comx -c
host-unreach -prot tcp -psrc 666 -pdst 69 -orig inferno.hell
10.2.3.4</p>

<p style="margin-top: 1em">- We want to send a packet ICMP
Source Quench to host ldg02.hell in response to a packet
destinated to host ldg00 with UDP protocol, source port 100
and destination port 200. We <br>
mask ourselves as gateway 10.10.10.1:</p>

<p style="margin-top: 1em">icmpush -sq -sp 10.10.10.1 -prot
udp -psrc 100 -pdst 200 -orig ldg00 ldg02.hell</p>

<p style="margin-top: 1em">- We want to send an ICMP packet
Time Exceeded to host ldg02.hell in response to a packet
destinated to host ldg00 with UDP protocol, source port 100
and destination port 200. We <br>
mask as gateway ldg04.hell:</p>

<p style="margin-top: 1em">icmpush -tx -sp ldg04.hell -c
frag -prot udp -psrc 100 -pdst 200 -orig ldg00
ldg02.hell</p>

<p style="margin-top: 1em">- We want to send an ICMP packet
Address Mask Request and wait 10 seconds to see the replies.
We mask the packet with source address of 10.2.3.4 and we
send it to the address <br>
10.0.1.255:</p>

<p style="margin-top: 1em">icmpush -mask -sp 10.2.3.4 -to
10 10.0.1.255</p>

<p style="margin-top: 1em">- We want to send an ICMP packet
Timestamp to host sepultura.hell. We mask the packet as if
it were send from host 10.2.3.1. We use the default timeout
(5 seconds):</p>

<p style="margin-top: 1em">icmpush -tstamp --spoof 10.2.3.1
sepultura.hell</p>

<p style="margin-top: 1em">- We want to send an ICMP packet
Information Request to host voucher.hell. The source address
will be our own IP address, and the timeout will be 20
seconds:</p>

<p style="margin-top: 1em">icmpush -info -to 20
voucher.hell</p>

<p style="margin-top: 1em">- We want to send an ICMP packet
Router Solicitation to host lazy.hell. The source address
will be our own IP address and the timeout will be 20
seconds:</p>

<p style="margin-top: 1em">icmpush -rts --timeout 20
lazy.hell</p>

<p style="margin-top: 1em">- We want to send an ICMP packet
Echo Request to host lazy.hell with the data pattern
&rsquo;MyNameIsGump&rsquo;. The source address will be our
own IP address and the timeout to read the <br>
data will be 2 seconds:</p>

<p style="margin-top: 1em">icmpush -echo -data MyNameIsGump
-to 2 lazy.hell</p>

<p style="margin-top: 1em">- We want to send ICMP packet
Echo Request to 10.12.0.255 with the following data pattern:
and we do not want to read the answers:</p>

<p style="margin-top: 1em">icmpush -echo -sp 192.168.0.255
-data &rsquo;D E A T H&rsquo; -to 0 192.168.0.255</p>

<p style="margin-top: 1em">- We want to send an ICMP packet
Destination Unreach to host destination.death but sending it
with an ICMP code bigger to the legal ones adding also 60K
of garbage data:</p>

<p style="margin-top: 1em">icmpush -du -c max -gbg 60000
destination.death</p>

<p style="margin-top: 1em">- We want to send an ICMP Router
Advertisement to host death.es, saying that the routers to
use are: router1.xtc with preference 20, router2.xtc with
preference 50 and <br>
router3.xtc with default preference (0). We mask ourselves
as fatherouter.xtc</p>

<p style="margin-top: 1em">icmpush -rta router1.xtc/20 -rta
router2.xtc/50 -rta router3.xtc -sp fatherouter.xtc
death.es</p>

<p style="margin-top: 1em">- We send an ICMP Parameter
Problem to host misery.es saying that the packet sent from
the host hick.org with udp protocol, source port 13 and
destination port 53, has an error <br>
on the IP header byte 13. We will also add all garbage bytes
as possible:</p>

<p style="margin-top: 1em">icmpush -sp hick.org -param -ptr
13 -prot udp -psrc 13 -pdest 53 -gbg max misery.es</p>

<p style="margin-top: 1em">- We want to send an ICMP packet
Timestamp to host www.hicks.org with code 38 instead of code
(0) as usual:</p>

<p style="margin-top: 1em">icmpush -tstamp -c 38
www.hicks.org</p>

<p style="margin-top: 1em">SEE ALSO <br>
Postel, John, &quot;Internet Control Message Protocol -
DARPA Internet Program Protocol Specification&quot;, RFC
792, USC/Information Sciences Institute, September 1981.</p>

<p style="margin-top: 1em">Mogul, Jeffrey and John Postel,
&quot;Internet Standard Subnetting Procedure&quot;, RFC 950,
Stanford, USC/Information Sciences Institute, August
1985.</p>

<p style="margin-top: 1em">Braden, Robert,
&quot;Requeriments for Internet Hosts - Communication
Layers&quot;, RFC 1122, USC/Information Sciences Institute,
October 1989.</p>

<p style="margin-top: 1em">Deering, Stephen, &quot;ICMP
Router Discovery Messages&quot;, RFC 1256, Xerox PARC,
September 1991.</p>

<p style="margin-top: 1em">Baker, Fred, &quot;Requeriments
for IP Version 4 Routers&quot;, RFC 1812, Cisco Systems,
June 1995.</p>

<p style="margin-top: 1em">The Linux source code,
everything referent to network code and to ICMP
protocol.</p>

<p style="margin-top: 1em">AUTHOR <br>
Slayer &lt;tcpbgp@softhome.net&gt;</p>

<p style="margin-top: 1em">icmpush v2.2 February 22, 1999
ICMPUSH(8)</p>
<hr>
</body>
</html>
