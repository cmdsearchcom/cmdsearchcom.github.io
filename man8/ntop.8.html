<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>NTOP(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">NTOP(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">NTOP(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
ntop - display top network users
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>ntop</b> [<b>@filename</b>] [<b>-a</b>|<b>--access-log-file</b>
  <i>&lt;path&gt;</i>] [<b>-b</b>|<b>--disable-decoders</b>]
  [<b>-c</b>|<b>--sticky-hosts</b>] [<b>-e</b>|<b>--max-table-rows</b>]
  [<b>-f</b>|<b>--traffic-dump-file</b> <i>file&gt;</i>]
  [<b>-g</b>|<b>--track-local-hosts</b>] [<b>-h</b>|<b>--help</b>]
  [<b>-l</b>|<b>--pcap-log</b> <i>&lt;path&gt;</i>]
  [<b>-m</b>|<b>--local-subnets</b> <i>&lt;addresses&gt;</i>]
  [<b>-n</b>|<b>--numeric-ip-addresses</b>] [<b>-p</b>|<b>--protocols</b>
  <i>&lt;list&gt;</i>] [<b>-q</b>|<b>--create-suspicious-packets</b>]
  [<b>-r</b>|<b>--refresh-time</b> <i>&lt;number&gt;</i>]
  [<b>-s</b>|<b>--no-promiscuous</b>] [<b>-t</b>|<b>--trace-level</b>
  <i>&lt;number&gt;</i>] [<b>-x</b> <i>&lt;max_num_hash_entries&gt;</i>]
  [<b>-w</b>|<b>--http-server</b> <i>&lt;port&gt;</i>]
  [<b>-z</b>|<b>--disable-sessions</b>] [<b>-A</b>|<b>--set-admin-password</b>
  <i>password</i>] [<b>-B</b>|<b>--filter-expression</b> <i>expression</i>]
  [<b>-C</b> <i>&lt;config</i>mode&gt;<i>]</i> [<b>-D</b>|<b>--domain</b>
  <i>&lt;name&gt;</i>] [<b>-F</b>|<b>--flow-spec</b> <i>&lt;specs&gt;</i>]
  [<b>-M</b>|<b>--no-interface-merge</b>] [<b>-N</b>|<b>--wwn-map</b>
  <i>&lt;path&gt;</i>] [<b>-O</b>|<b>----output-packet-path</b>
  <i>&lt;path&gt;</i>] [<b>-P</b>|<b>--db-file-path</b> <i>&lt;path&gt;</i>]
  [<b>-Q</b>|<b>--spool-file-path</b> <i>&lt;path&gt;</i>]
  [<b>-U</b>|<b>--mapper</b> <i>&lt;URL&gt;</i>] [<b>-V</b>|<b>--version]</b>
  [<b>-X</b> <i>&lt;max_num_TCP_sessions&gt;</i>]
  [<b>--disable-instantsessionpurge</b>] [<b>--disable-mutexextrainfo</b>]
  [<b>--disable-ndpi</b>] [<b>--disable-python</b>] [<b>--instance</b>]
  [<b>--p3p-cp</b>] [<b>--p3p-uri</b>] [<b>--skip-version-check</b>]
  [<b>--w3c</b>] [<b>-4</b>|<b>--ipv4]</b> [<b>-6</b>|<b>--ipv6]</b>
<div style="height: 1.00em;">&#x00A0;</div>
Unix options:
<div style="height: 1.00em;">&#x00A0;</div>
[<b>-d</b>|<b>--daemon</b>] [<b>-i</b>|<b>--interface</b> <i>&lt;name&gt;</i>]
  [<b>-u</b>|<b>--user</b> <i>&lt;user&gt;</i>]
  [<b>-K</b>|<b>--enable-debug</b>] [<b>-L</b>] [<b>--pcap_setnonblock</b>]
  [<b>--use-syslog=</b> <i>&lt;facility&gt;</i>] [<b>--webserver-queue</b>
  <i>&lt;number&gt;</i>]
<div style="height: 1.00em;">&#x00A0;</div>
Windows option:
<div style="height: 1.00em;">&#x00A0;</div>
[<b>-i</b>|<b>--interface</b> <i>&lt;number|name&gt;</i>]
<div style="height: 1.00em;">&#x00A0;</div>
OpenSSL options:
<div style="height: 1.00em;">&#x00A0;</div>
[<b>-W</b>|<b>--https-server</b> <i>&lt;port&gt;</i>] [<b>--ssl-watchdog</b>]
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>ntop</b> shows the current network usage. It displays a list of hosts that
  are currently using the network and reports information concerning the (IP and
  non-IP) traffic generated and received by each host. <b>ntop</b> may operate
  as a front-end collector (sFlow and/or netFlow plugins) or as a stand-alone
  collector/display program. A web browser is needed to access the information
  captured by the <b>ntop</b> program.
<div style="height: 1.00em;">&#x00A0;</div>
<b>ntop</b> is a hybrid layer 2 / layer 3 network monitor, that is by default it
  uses the layer 2 Media Access Control (MAC) addresses AND the layer 3 tcp/ip
  addresses. <b>ntop</b> is capable of associating the two, so that ip and
  non-ip traffic (e.g. arp, rarp) are combined for a complete picture of network
  activity.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="COMMAND-LINE_OPTIONS"><a class="selflink" href="#COMMAND-LINE_OPTIONS">COMMAND-LINE
  OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>@filename </b></dt>
  <dd class="It-tag">The text of <b>filename</b> is copied - ignoring line
      breaks and comment lines (anything following a #) - into the command line.
      <b>ntop</b> behaves as if all of the text had simply been typed directly
      on the command line. For example, if the command line is &quot;-t 3 @d -u
      ntop&quot; and file d contains just the line '-d', then the effective
      command line is -t 3 -d -u ntop. Multiple @s are permitted. Nested @s (an
      @ inside the file) are not permitted.
    <div style="height: 1.00em;">&#x00A0;</div>
    Remember, most <b>ntop</b> options are &quot;sticky&quot;, that is they just
      set an internal flag. Invoking them multiple times doesn't change
      <b>ntop's</b> behavior. However, options that set a value, such as
      --trace-level, will use the LAST value given: --trace-level 2
      --trace-level 3 will run as --trace-level 3.
    <div style="height: 1.00em;">&#x00A0;</div>
    Beginning with 3.1, many command-line options may also be set via the web
      browser interface. These changes take effect on the next run of and on
      each subsequent run until changed.
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-a | --access-log-file</b></dt>
  <dd class="It-tag">By default <b>ntop</b> does not maintain a log of HTTP
      requests to the internal web server. Use this parameter to request logging
      and to specify the location of the file where these HTTP requests are
      logged.
    <div style="height: 1.00em;">&#x00A0;</div>
    Each log entry is in Apache-like style. The only difference between Apache
      and <b>ntop</b> logs is that an additional column has been added which has
      the time (in milliseconds) that <b>ntop</b> needed to serve the request.
      Log entries look like this:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
192.168.1.1 - - [04/Sep/2003:20:38:55 -0500] - &quot;GET / HTTP/1.1&quot; 200 1489 4
192.168.1.1 - - [04/Sep/2003:20:38:55 -0500] - &quot;GET /index_top.html HTTP/1.1&quot; 200 1854 4
192.168.1.1 - - [04/Sep/2003:20:38:55 -0500] - &quot;GET /index_inner.html HTTP/1.1&quot; 200 1441 7
192.168.1.1 - - [04/Sep/2003:20:38:56 -0500] - &quot;GET /index_left.html HTTP/1.1&quot; 200 1356 4
192.168.1.1 - - [04/Sep/2003:20:38:56 -0500] - &quot;GET /home_.html HTTP/1.1&quot; 200 154/617 9
192.168.1.1 - - [04/Sep/2003:20:38:56 -0500] - &quot;GET /home.html HTTP/1.1&quot; 200 1100/3195 10
192.168.1.1 - - [04/Sep/2003:20:38:56 -0500] - &quot;GET /About.html HTTP/1.1&quot; 200 2010 10
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    This parameter is the complete file name of the access log. In prior
      releases it was erroneously called --access-log-path.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-b | --disable-decoders</b></dt>
  <dd class="It-tag">This parameter disables protocol decoders.
    <div style="height: 1.00em;">&#x00A0;</div>
    Protocol decoders examine and collect information about layer 2 protocols
      such as NetBIOS or Netware SAP, as well as about specific tcp/ip (layer 3)
      protocols, such as DNS, http and ftp.
    <div style="height: 1.00em;">&#x00A0;</div>
    This support is specifically coded for each protocol and is different from
      the capability to count raw information (packets and bytes) by protocol
      specified by the -p | --protocols parameter, below.
    <div style="height: 1.00em;">&#x00A0;</div>
    Decoding protocols is a significant consumer of resources. If the
      <b>ntop</b> host is underpowered or monitoring a very busy network, you
      may wish to disable protocol decoding via this parameter. It may also be
      appropriate to use this parameter if you believe that <b>ntop</b> has
      problems handling some protocols that occur on your network.
    <div style="height: 1.00em;">&#x00A0;</div>
    Even if decoding is disabled, ftp-data traffic is still decoded to look for
      passive ftp port commands.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c | --sticky-hosts</b></dt>
  <dd class="It-tag">Use this parameter to prevent idle hosts from being purged
      from memory.
    <div style="height: 1.00em;">&#x00A0;</div>
    By default idle hosts are periodically purged from memory. An idle host is
      identified when no packets from or to that host have been monitored for
      the period of time defined by the value of PARM_HOST_PURGE_MINIMUM_IDLE in
      globals-defines.h.
    <div style="height: 1.00em;">&#x00A0;</div>
    If you use this option, all hosts - active and idle - are retained in memory
      for the duration of the <b>ntop</b> run.
    <div style="height: 1.00em;">&#x00A0;</div>
    P2P users, port scans, popular web servers and other activity will cause
      <b>ntop</b> to record data about a large number of hosts. On an active
      network, this will consume a significant - and always growing - amount of
      memory. It is strongly recommended that you use a filtering expression to
      limit the hosts which are stored if you use --sticky-hosts.
    <div style="height: 1.00em;">&#x00A0;</div>
    The idle purge is a statistical one - a random selection of the eligible
      hosts will be purged during each cycle. Thus it is possible on a busy
      system for an idle host to remain in the <b>ntop</b> tables and appear
      'active' for some considerable time after it is truly idle.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d | --daemon</b></dt>
  <dd class="It-tag">This parameter causes ntop to become a daemon, i.e. a task
      which runs in the background without connection to a specific terminal. To
      use <b>ntop</b> other than as a casual monitoring tool, you probably will
      want to use this option.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>WARNING:</b> If you are running as a daemon, the messages from
      <b>ntop</b> will be 'printed' on to stdout and thus dropped. You probably
      don't want to do this. So remember to also use the -L or --use-syslog
      options to save the messages into the system log.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-e | --max-table-rows</b></dt>
  <dd class="It-tag">This defines the maximum number of lines that <b>ntop</b>
      will display on each generated HTML page. If there are more lines to be
      displayed than this setting permits, only part of the data will be
      displayed. There will be page forward/back arrows placed at the bottom of
      the page for navigation between pages.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f | --traffic-dump-file</b></dt>
  <dd class="It-tag">By default, <b>ntop</b> captures traffic from network
      interface cards (NICs) or from netFlow/sFlow probes. However, <b>ntop</b>
      can also read data from a file - typically a tcpdump capture or the output
      from one of the <b>ntop</b> packet capture options.
    <div style="height: 1.00em;">&#x00A0;</div>
    if you specify -f, <b>ntop</b> will not capture any traffic from NICs during
      or after the file has been read. netFlow/sFlow capture - if enabled -
      would still be active.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option is mostly used for debug purposes.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-g | --track-local-hosts</b></dt>
  <dd class="It-tag">By default, <b>ntop</b> tracks all hosts that it sees from
      packets captured on the various NICs. Use this parameter to tell
      <b>ntop</b> to capture data only about local hosts. Local hosts are
      defined based on the addresses of the NICs and those networks identified
      as local via the -m | --local-subnets parameter.
    <div style="height: 1.00em;">&#x00A0;</div>
    This parameter is useful on large networks or those that see many hosts,
      (e.g. a border router or gateway), where information about remote hosts is
      not desired/required to be tracked.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h | --help</b></dt>
  <dd class="It-tag">Print help information for <b>ntop,</b> including usage and
      parameters.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i | --interface</b></dt>
  <dd class="It-tag">Specifies the network interface or interfaces to be used by
      <b>ntop</b> for network monitoring.
    <div style="height: 1.00em;">&#x00A0;</div>
    If multiple interfaces are used (this feature is available only if ntop is
      compiled with thread support) their names must be separated with a comma.
      For instance -i &quot;eth0,lo&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    If not specified, the default is the first Ethernet device, e.g. eth0. The
      specific device that is 'first' is highly system dependent. Especially on
      systems where the device name reflects the driver name instead of the type
      of interface.
    <div style="height: 1.00em;">&#x00A0;</div>
    By default, traffic information obtained by all the interfaces is merged
      together as if the traffic was seen by only one interface. Use the -M
      parameter to keep traffic separate by interface.
    <div style="height: 1.00em;">&#x00A0;</div>
    If you do not want <b>ntop</b> to monitor any interfaces, use -i none.
    <div style="height: 1.00em;">&#x00A0;</div>
    Under Windows, the parameter value is either the number of the interface or
      its name, e.g. {6252C14C-44C9-49D9-BF59-B2DC18C7B811}. Run <b>ntop</b> -h
      to see a list of interface name-number mappings (at the end of the help
      information).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l | --pcap-log</b></dt>
  <dd class="It-tag">This parameter causes a dump file to be created of the
      network traffic captured by <b>ntop</b> in tcpdump (pcap) format. This
      file is useful for debug, and may be read back into <b>ntop</b> by the -f
      | --traffic-dump-file parameter. The dump is made after processing any
      filter expression ( never even sees filtered packets).
    <div style="height: 1.00em;">&#x00A0;</div>
    The output file will be named
      <i>&lt;path&gt;/&lt;log&gt;.&lt;device&gt;.pcap</i> (Windows:
      <i>&lt;path&gt;/&lt;log&gt;.pcap</i> ), where &lt;path&gt; is defined by
      the -O | --output-packet-path parameter and &lt;log&gt; is defined by this
      -l | --pcap-log parameter.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-m | --local-subnets</b></dt>
  <dd class="It-tag"><b>ntop</b> determines the ip addresses and netmasks for
      each active interface. Any traffic on those networks is considered local.
      This parameter allows the user to define additional networks and
      subnetworks whose traffic is also considered local in <b>ntop</b> reports.
      All other hosts are considered remote.
    <div style="height: 1.00em;">&#x00A0;</div>
    Commas separate multiple network values. Both netmask and CIDR notation may
      be used, even mixed together, for instance
      &quot;131.114.21.0/24,10.0.0.0/255.0.0.0&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    The local subnet - as defined by the interface address(es) - is/are always
      local and do not need to be specified. If you do give the same value as a
      NIC's local address, a harmless warning message is issued.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n | --numeric-ip-addresses</b></dt>
  <dd class="It-tag">By default, <b>ntop</b> resolves IP addresses using a
      combination of active (explicit) DNS queries and passive sniffing.
      Sniffing of DNS responses occurs when <b>ntop</b> receives a network
      packet containing the response to some other user's DNS query. <b>ntop</b>
      captures this information and enters it into <b>ntop's</b> DNS cache, in
      expectation of shortly seeing traffic addressed to that host. This way
      <b>ntop</b> significantly reduces the number of DNS queries it makes.
    <div style="height: 1.00em;">&#x00A0;</div>
    This parameter causes <b>ntop</b> to skip DNS resolution, showing only
      numeric IP addresses instead of the symbolic names. This option can useful
      when the DNS is not present or quite slow.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p | --protocols</b></dt>
  <dd class="It-tag">This parameter is used to specify the TCP/UDP protocols
      that <b>ntop</b> will monitor. The format is &lt;label&gt;=&lt;protocol
      list&gt; [, &lt;label&gt;=&lt;protocol list&gt;], where label is used to
      symbolically identify the &lt;protocol list&gt;. The format of
      &lt;protocol list&gt; is &lt;protocol&gt;[|&lt;protocol&gt;], where
      &lt;protocol&gt; is either a valid protocol specified inside the
      /etc/services file or a numeric port range (e.g. 80, or 6000-6500).
    <div style="height: 1.00em;">&#x00A0;</div>
    A simple example is
      --protocols=&quot;HTTP=http|www|https|3128,FTP=ftp|ftp-data&quot;, which
      reduces the protocols displayed on the &quot;IP&quot; pages to three:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
Host                      Domain Data          HTTP   FTP   Other IP
ns2.attbi.com             &lt;flag&gt;  954 63.9 %      0     0        954
64.124.83.112.akamai.com  &lt;flag&gt;  240 16.1 %    240     0          0
64.124.83.99.akamai.com   &lt;flag&gt;  240 16.1 %    240     0          0
toolbarqueries.google.com &lt;flag&gt;   60 4.0 %      60     0          0
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    If the &lt;protocol list&gt; is very long you may store it in a file (for
      instance protocol.list). To do so, specify the file name instead of the
      &lt;protocol list&gt; on the command line. e.g. <b>ntop -p
      protocol.list</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    If the -p parameter is omitted the following default value is used:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  FTP=ftp|ftp-data
  HTTP=http|www|https|3128     3128 is Squid, the HTTP cache
  DNS=name|domain
  Telnet=telnet|login
  NBios-IP=netbios-ns|netbios-dgm|netbios-ssn
  Mail=pop-2|pop-3|pop3|kpop|smtp|imap|imap2
  DHCP-BOOTP=67-68
  SNMP=snmp|snmp-trap
  NNTP=nntp
  NFS=mount|pcnfs|bwnfs|nfsd|nfsd-status
  X11=6000-6010
  SSH=22
<div class="Pp"></div>
  Peer-to-Peer Protocols
  ----------------------
  Gnutella=6346|6347|6348
  Kazaa=1214
  WinMX=6699|7730
  DirectConnect=0      Dummy port as this is a pure P2P protocol
  eDonkey=4661-4665
<div class="Pp"></div>
  Instant Messenger
  -----------------
  Messenger=1863|5000|5001|5190-5193
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    NOTE: To resolve protocol names to port numbers, they must be specified in
      the system file used to list tcp/udp protocols and ports, which is
      typically /etc/services file. You will have to match the names in that
      file, exactly. Missing or unspecified (non-standard) ports must be
      specified by number, such as 3128 in our examples above.
    <div style="height: 1.00em;">&#x00A0;</div>
    If you have a file named /etc/protocols, don't get confused by it, as that's
      the Ethernet protocol numbers, which are not what you're looking for.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-q | --create-suspicious-packets</b></dt>
  <dd class="It-tag">This parameter tells <b>ntop</b> to create a dump file of
      suspicious packets.
    <div style="height: 1.00em;">&#x00A0;</div>
    There are many, many, things that cause a packet to be labeled as
      'suspicious', including:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
  Detected ICMP fragment
  Detected Land Attack against host
  Detected overlapping/tiny packet fragment
  Detected traffic on a diagnostic port
  Host performed ACK/FIN/NULL scan
  Host rejected TCP session
  HTTP/FTP/SMTP/SSH detected at wrong port
  Malformed TCP/UDP/ICMP packet (packet too short)
  Packet # %u too long
  Received a ICMP protocol Unreachable from host
  Sent ICMP Administratively Prohibited packet to host
  Smurf packet detected for host
  TCP connection with no data exchanged
  TCP session reset without completing 3-way handshake
  Two MAC addresses found for the same IP address
  UDP data to a closed port
  Unknown protocol (no HTTP/FTP/SMTP/SSH) detected (on port 80/21/25/22)
  Unusual ICMP options
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    When this parameter is used, one file is created for each network interface
      where suspicious packets are found. The file is in tcpdump (pcap) format
      and is named &lt;path&gt;/ntop-suspicious-pkts.&lt;device&gt;.pcap, where
      &lt;path&gt; is defined by the -O | --output-packet-path parameter.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-r | --refresh-time</b></dt>
  <dd class="It-tag">Specifies the delay (in seconds) between automatic screen
      updates for those generated HTML pages which support them. This parameter
      allows you to leave your browser window open and have it always displaying
      nearly real-time data from <b>ntop.</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    The default is 3 seconds. Please note that if the delay is very short (1
      second for instance), <b>ntop</b> might not be able to process all of the
      network traffic.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s | --no-promiscuous</b></dt>
  <dd class="It-tag">Use this parameter to prevent from setting the interface(s)
      into promiscuous mode.
    <div style="height: 1.00em;">&#x00A0;</div>
    An interface in promiscuous mode will accept ALL Ethernet frames, regardless
      of whether they directed (addressed) to the specific network interface
      (NIC) or not. This is an essential part of enabling <b>ntop</b> to monitor
      an entire network. (Without promiscuous mode, <b>ntop</b> will only see
      traffic directed to the specific host it is running on, plus broadcast
      traffic such as the arp and dhcp protocols.
    <div style="height: 1.00em;">&#x00A0;</div>
    Even if you use this parameter, the interface could well be in promiscuous
      mode if another application enabled it.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>ntop</b> passes this setting on to libpcap, the packet capture library.
      On many systems, a non-promiscuous open of the network interface will
      fail, since the libpcap function on most systems require it to capture raw
      packets ( <b>ntop</b> captures raw packets so that we may view and analyze
      the layer 2 - MAC - information).
    <div style="height: 1.00em;">&#x00A0;</div>
    Thus on most systems, <b>ntop</b> must probably still be started as root,
      and this option is largely ornamental. If it fails, you will see a
      ***FATALERROR*** message referring to pcap_open_live() and then an
      information message, &quot;Sorry, but on this system, even with -s, it
      appears that ntop must be started as root&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-t | --trace-level</b></dt>
  <dd class="It-tag">This parameter specifies the 'information' level of
      messages that you wish <b>ntop</b> to display (on stdout or to the log).
      The higher the trace level number the more information that is displayed.
      The trace level ranges between 0 (no trace) and 5 (full debug tracings).
    <div style="height: 1.00em;">&#x00A0;</div>
    The default trace value is 3.
    <div style="height: 1.00em;">&#x00A0;</div>
    Trace level 0 is not quite zero messages. Fatal errors and certain
      startup/shutdown messages are always displayed. Trace level 1 is used to
      display errors only, level 2 for both errors and warnings, and level 3
      displays error, warning and informational messages.
    <div style="height: 1.00em;">&#x00A0;</div>
    Trace level 4 is called 'noisy' and it is - generating many messages about
      the internal functioning of <b>ntop.</b> Trace level 5 and above are
      'noisy' plus extra logs, i.e. all possible messages, with a file:line tag
      prepended to every message.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-u | --user</b></dt>
  <dd class="It-tag">Specifies the user <b>ntop</b> should run as after it
      initializes.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>ntop</b> must normally be started as root so that it has sufficient
      privileges to open the network interfaces in promiscuous mode and to
      receive raw frames. See the discussion of -s | --no-promiscuous above, if
      you wish to try starting <b>ntop</b> as a non-root user.
    <div style="height: 1.00em;">&#x00A0;</div>
    Shortly after starting up, <b>ntop</b> becomes the user you specify here,
      which normally has substantially reduced privileges, such as no login
      shell. This is the userid which owns <b>ntop's</b> database and output
      files.
    <div style="height: 1.00em;">&#x00A0;</div>
    The value specified may be either a username or a numeric user id. The group
      id used will be the primary group of the user specified.
    <div style="height: 1.00em;">&#x00A0;</div>
    If this parameter is not specified, ntop will try to switch first to
      'nobody' and then to 'anonymous' before giving up.
    <div style="height: 1.00em;">&#x00A0;</div>
    NOTE: This should not be root unless you really understand the security
      risks. In order to prevent this by accident, the only way to run
      <b>ntop</b> as root is to explicitly specify -u root. <b>Don't do it.</b>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-x </b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-X </b></dt>
  <dd class="It-tag"><b>ntop</b> creates a new hash/list entry for each new
      host/TCP session seen. In case of DOS (Denial Of Service) an attacker can
      easily exhaust all the host available memory because ntop is creating
      entries for dummy hosts. In order to avoid this you can set an upper limit
      in order to limit the memory ntop can use.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-w | --http-server</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-W | --https-server</b></dt>
  <dd class="It-tag"><b>ntop</b> offers an embedded web server to present the
      information that has been so painstakingly gathered. An external HTTP
      server is NOT required NOR supported. The <b>ntop</b> web server is
      embedded into the application. These parameters specify the port (and
      optionally the address (i.e. interface)) of the <b>ntop</b> web server.
    <div style="height: 1.00em;">&#x00A0;</div>
    For example, if started with -w 3000 (the default port), the URL to access
      <b>ntop</b> is http://hostname:3000/. If started with a full
      specification, e.g. -w 192.168.1.1:3000, <b>ntop</b> listens on only that
      address/port combination.
    <div style="height: 1.00em;">&#x00A0;</div>
    If -w is set to 0 the web server will not listen for http:// connections.
    <div style="height: 1.00em;">&#x00A0;</div>
    -W operates similarly, but controls the port for the https:// connections.
    <div style="height: 1.00em;">&#x00A0;</div>
    Some examples:
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>ntop -w 3000 -W 0</b> (this is the default setting) HTTP requests on port
      3000 and no HTTPS.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>ntop -w 80 -W 443</b> Both HTTP and HTTPS have been enabled on their most
      common ports.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>ntop -w 0 -W 443</b> HTTP disabled, HTTPS enabled on the common port.
    <div style="height: 1.00em;">&#x00A0;</div>
    Certain sensitive, configuration pages of the <b>ntop</b> web server are
      protected by a userid/password. By default, these are the user/URL
      administration, filter, shutdown and reset stats are password protected
    <br/>
     and are accessible initially only to user <b>admin</b> with a password set
      during the first run of <b>ntop.</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    Users can modify/add/delete users/URLs using ntop itself - see the Admin
      tab.
    <div style="height: 1.00em;">&#x00A0;</div>
    The passwords, userids and URLs to protect with passwords are stored in a
      database file. Passwords are stored in an encrypted form in the database
      for further security. Best practices call for securing that database so
      that only the <b>ntop</b> user can read it.
    <div style="height: 1.00em;">&#x00A0;</div>
    There is a discussion in docs/FAQ about further securing the <b>ntop</b>
      environment.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-z | --disable-sessions</b></dt>
  <dd class="It-tag">This parameter disables TCP session tracking. Use it for
      better performance or when you don't really need/care to track sessions.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-A | --set-admin-password</b></dt>
  <dd class="It-tag">This parameter is used to start <b>ntop</b> , set the admin
      password and quit. It is quite useful for installers that need to
      automatically set the password for the admin user.
    <div style="height: 1.00em;">&#x00A0;</div>
    -A and --set-admin-password (without a value) will prompt the user for the
      password.
    <div style="height: 1.00em;">&#x00A0;</div>
    You may also use this parameter to set a specific value using
      --set-admin-password=value. <b>The = is REQUIRED and no spaces are
      permitted!</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    If you attempt to run <b>ntop</b> as a daemon without setting a password, a
      FATAL ERROR message is generated and <b>ntop</b> stops.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-B | --filter-expression</b></dt>
  <dd class="It-tag">Filters allows the user to restrict the traffic seen by
      <b>ntop</b> on just about any imaginable item.
    <div style="height: 1.00em;">&#x00A0;</div>
    The filter expression is set at run time by this parameter, but it may be
      changed during the <b>ntop</b> run on the Admin | Change Filter web page.
    <div style="height: 1.00em;">&#x00A0;</div>
    The basic format is <b>-B filter</b> , where the quotes are <b>REQUIRED</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    The syntax of the filter expression uses the same BPF (Berkeley Packet
      Filter) expressions used by other packages such as tcpdump
    <div style="height: 1.00em;">&#x00A0;</div>
    For instance, suppose you are interested only in the traffic
      generated/received by the host jake.unipi.it. <b>ntop</b> can then be
      started with the following filter:
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>ntop -B src host jake.unipi.it or dst host jake.unipi.it</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    or in shorthand:
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>ntop -B host jake.unipi.it or host jake.unipi.it</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    See the 'expression' section of the <b>tcpdump</b> man page - usually
      available at http://www.tcpdump.org/tcpdump_man.html - for further
      information and the best quick guide to BPF filters currently available.
    <div style="height: 1.00em;">&#x00A0;</div>
    WARNING: If you are using complex filter expressions, especially those with
      =s or meaningful spaces in them, be sure and use the long option format,
      --filter-expression=&quot;xxxx&quot; and not -B &quot;xxxx&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-C | </b></dt>
  <dd class="It-tag">This instruments ntop to be used in two configurations:
      host and network mode. In host mode (default) ntop works as usual: the IP
      addresses received are those of real hosts. In host mode the IP addresses
      received are those of the C-class network to which the address belongs.
      Using ntop in network mode is extremely useful when installed in a traffic
      exchange (e.g. in the middle of the Internet) whereas the host mode should
      be used when ntop is installed on the edge of a network (e.g. inside a
      company). The network mode significantly reduces the amount of work ntop
      has to perform and it has to be used whenever ntop is used to find out how
      the network traffic flows and not to pin-point specific hosts.
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-D | --domain</b></dt>
  <dd class="It-tag">This identifies the local domain suffix, e.g. ntop.org. It
      may be necessary, if <b>ntop</b> is having difficulty determining it from
      the interface.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-F | --flow-spec</b></dt>
  <dd class="It-tag">It is used to specify network flows similar to more
      powerful applications such as NeTraMet. A flow is a stream of captured
      packets that match a specified rule. The format is
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>&lt;flow-label&gt;='&lt;matching
      expression&gt;'[,&lt;flow-label&gt;='&lt;matching expression&gt;']</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    , where the label is used to symbolically identify the flow specified by the
      expression. The expression is a bpf (Berkeley Packet Filter) expression.
      If an expression is specified, then the information concerning flows can
      be accessed following the HTML link named 'List NetFlows'.
    <div style="height: 1.00em;">&#x00A0;</div>
    For instance define two flows with the following expression
      <b>LucaHosts='host jake.unipi.it or host
      pisanino.unipi.it',GatewayRoutedPkts='gateway gateway.unipi.it' .</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    All the traffic sent/received by hosts jake.unipi.it or pisanino.unipi.it is
      collected by <b>ntop</b> and added to the LucaHosts flow, whereas all the
      packet routed by the gateway gateway.unipi.it are added to the
      GatewayRoutedPkts flow. If the flows list is very long you may store in a
      file (for instance flows.list) and specify the file name instead of the
      actual flows list (in the above example, this would be 'ntop -F
      flows.list').
    <div style="height: 1.00em;">&#x00A0;</div>
    Note that the double quotations around the entire flow expression are
      required.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-K | --enable-debug</b></dt>
  <dd class="It-tag">Use this parameter to simplify application debug. It does
      three things: 1. Does not fork() on the &quot;read only&quot; html pages.
      2. Displays mutex values on the configuration (info.html) page. 3. (If
      available - glibc/gcc) Activates an automated backtrace on application
      errors.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-L | --use-syslog=facility</b></dt>
  <dd class="It-tag">Use this parameter to send log messages to the system log
      instead of stdout.
    <div style="height: 1.00em;">&#x00A0;</div>
    -L and the simple form --use-syslog use the default log facility, defined as
      LOG_DAEMON in the #define symbol DEFAULT_SYSLOG_FACILITY in
      globals-defines.h.
    <div style="height: 1.00em;">&#x00A0;</div>
    The complex form, --use-syslog=facility will set the log facility to
      whatever value (e.g. local3, security) you specify. <b>The = is REQUIRED
      and no spaces are allowed!</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    This setting applies both to <b>ntop</b> and to any child fork()ed for
      reporting. If this parameter is not specified, any fork()ed child will use
      the default value and will log it's messages to the system log (this
      occurs because the fork()ed child must give up it's access to the parents
      stdout).
    <div style="height: 1.00em;">&#x00A0;</div>
    Because various systems do not make the permissible names available, we have
      a table at the end of globals-core.c. Look for myFacilityNames.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-M | --no-interface-merge</b></dt>
  <dd class="It-tag">By default, <b>ntop</b> merges the data collected from all
      of the interfaces (NICs) it is monitoring into a single set of counters.
    <div style="height: 1.00em;">&#x00A0;</div>
    If you have a simple network, say a small LAN with a connection to the
      internet, merging data is good as it gives you a better picture of the
      whole network. For larger, more complex networks, this may not be
      desirable. You may also have other reasons for wishing to monitor each
      interface separately, for example DMZ vs. LAN traffic.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option instructs <b>ntop</b> not to merge network interfaces together.
      This means that <b>ntop</b> will collect statistics for each interface and
      report them separately.
    <div style="height: 1.00em;">&#x00A0;</div>
    Only ONE interface may be reported on at a time - use the <b>Admin | Switch
      NIC</b> option on the web server to select which interface to report upon.
    <div style="height: 1.00em;">&#x00A0;</div>
    Note that activating either the netFlow and/or sFlow plugins will force the
      setting of -M. Once enabled, you cannot go back.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-N | --wwn-map</b></dt>
  <dd class="It-tag">This options names the file providing the map of WWN to
      FCID/VSAN ids.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-O | --output-packet-path</b></dt>
  <dd class="It-tag">This parameter defines the base path for the
      ntop-suspicious-pkts.XXX.pcap and normal packet dump files.
    <div style="height: 1.00em;">&#x00A0;</div>
    If this parameter is not specified, the default value is the config.h
      parameter CFG_DBFILE_DIR, which is set during ./configure from the
      --localstatedir= parameter. If --localstatedir is not specified, it
      defaults to the --prefix value plus /var (e.g. /usr/local/var).
    <div style="height: 1.00em;">&#x00A0;</div>
    Be aware that this may not be what you expect when running <b>ntop</b> as a
      daemon or Windows service. Setting an explicit and absolute path value is
      <b>STRONGLY</b> recommended if you use this facility.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-P | --db-file-path</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-Q | --spool-file-path</b></dt>
  <dd class="It-tag">These parameters specify where <b>ntop</b> stores database
      files.
    <div style="height: 1.00em;">&#x00A0;</div>
    There are two types, 'temporary' - that is ones which need not be retained
      from <b>ntop</b> run to <b>ntop</b> run, and 'permanent', which must be
      retained (or recreated).
    <div style="height: 1.00em;">&#x00A0;</div>
    The 'permanent' databases are the preferences, &quot;prefsCache.db&quot; and
      the password file, &quot;ntop_pw.db&quot;. These are stored in the -P |
      --db-file-path specified location.
    <div style="height: 1.00em;">&#x00A0;</div>
    Certain plugins use the -P | --db-file-path specified location for their
      database (&quot;LsWatch.db&quot;) or (as a default value) for files
      (.../rrd/...).
    <div style="height: 1.00em;">&#x00A0;</div>
    The 'temporary' databases are the address queue,
      &quot;addressQueue.db&quot;, the cached DNS resolutions,
      &quot;dnsCache.db&quot; and the MAC prefix (vendor table),
      &quot;macPrefix.db&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
    If only -P | --db-file-path is specified, it is used for both types of
      databases.
    <div style="height: 1.00em;">&#x00A0;</div>
    The directories named must allow read/write and file creation by the
      <b>ntop</b> user. For security, nobody else should have even read access
      to these files.
    <div style="height: 1.00em;">&#x00A0;</div>
    Note that the default value is the config.h parameter CFG_DBFILE_DIR. This
      is set during ./configure from the --localstatedir= parameter. If
      --localstatedir is not specified, it defaults to the --prefix value plus
      /var (e.g. /usr/local/var).
    <div style="height: 1.00em;">&#x00A0;</div>
    This may not be what you expect when running <b>ntop</b> as a daemon or
      Windows service.
    <div style="height: 1.00em;">&#x00A0;</div>
    Note that on versions of <b>ntop</b> prior to 2.3, these parameters
      defaulted to &quot;.&quot; (the current working directory, e.g. the value
      returned by the pwd command) and caused havoc as it was different when
      <b>ntop</b> was run from the command line, vs. run via cron, vs. run from
      an initialization script.
    <div style="height: 1.00em;">&#x00A0;</div>
    Setting an explicit and absolute path value is <b>STRONGLY</b> recommended.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-U | --mapper</b></dt>
  <dd class="It-tag">Specifies the URL of the mapper.pl utility.
    <div style="height: 1.00em;">&#x00A0;</div>
    If provided, <b>ntop</b> creates a clickable hyperlink on the 'Info about
      host xxxxxx' page to this URL by appending ?host=xxxxx. Any type of host
      lookup could be performed, but this is intended to lookup the geographical
      location of the host.
    <div style="height: 1.00em;">&#x00A0;</div>
    A cgi-based mapper interface to http://www.multimap.com is part of the
      <b>ntop</b> distribution [see www/Perl/mapper.pl]).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-V | --version</b></dt>
  <dd class="It-tag">Prints <b>ntop</b> version information and then exits.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-W | --https-server</b></dt>
  <dd class="It-tag">(See the joint documentation with the -w parameter, above)
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--disable-instantsessionpurge </b></dt>
  <dd class="It-tag"><b>ntop</b> sets completed sessions as 'timed out' and then
      purge them almost instantly, which is not the behavior you might expect
      from the discussions about purge timeouts. This switch makes ntop respect
      the timeouts for completed sessions. It is NOT the default because a busy
      web server may have 100s or 1000s of completed sessions and this would
      significantly increase the amount of memory <b>ntop</b> uses.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--disable-mutexextrainfo </b></dt>
  <dd class="It-tag"><b>ntop</b> stores extra information about the locks and
      unlocks of the protective mutexes it uses. Since <b>ntop</b> uses
      fine-grained locking, this information is updated frequently. On some
      OSes, the system calls used to collect this informatio (getpid() and
      gettimeofday()) are expensive. This option disables the extra information.
      It should have no processing impact on <b>ntop</b>
    <br/>
     - however should <b>ntop</b> actually deadlock, we would lose the
      information that sometimes tells us why.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--disable-ndpi </b></dt>
  <dd class="It-tag"><b>ntop</b> is started without nDPI support thus
      application protocols are not recognized.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--disable-python </b></dt>
  <dd class="It-tag"><b>ntop</b> is started without the Python interpreter.
      Beware as some ntop reports are based on python, thus disabling it will
      prevent some reports to work properly.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--instance </b></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    You can run multiple instances of <b>ntop</b> simultaneously by specifying
      different -P values (typically through separate ntop.conf files). If you
      set a value for this parameter (available only on the command line), you
      (1) display the 'instance' name on every web page and (2) alter the log
      prefix from &quot;NTOP&quot; to your chosen value.
    <div style="height: 1.00em;">&#x00A0;</div>
    If you want to make the tag more obvious, create a .instance class in
      style.css, e.g.:
    <div style="height: 1.00em;">&#x00A0;</div>
    <br/>
     .instance {
    <br/>
     color: #666666;
    <br/>
     font-size: 18pt;
    <br/>
     }
    <div style="height: 1.00em;">&#x00A0;</div>
    Note (UNIX): To run completely different versions of the <b>ntop</b> binary,
      you need to compile and install into a different library (using
      ./configure --prefix) and then specify the LD_LIBRARY_PATH before
      invoking, e.g.
    <div style="height: 1.00em;">&#x00A0;</div>
    LD_LIBRARY_PATH=/devel/lib/ntop/:... /devel/bin/ntop ...args...
    <div style="height: 1.00em;">&#x00A0;</div>
    If present, a file of the form &lt;instance&gt;_ntop_logo.gif will be used
      instead of the normal ntop_logo.gif. This is tested for ONLY once, at the
      beginning of the run. The EXACT word(s) of the --instance flag are used,
      without testing if they make a proper file name. If - for any reason - the
      file is not found, an informational message is logged and the normal logo
      file is used. To construct your own logo, make it a 300x40 transparent
      gif.
    <div style="height: 1.00em;">&#x00A0;</div>
    NOTE: On the web pages, <b>ntop</b> uses the dladdr() function. The original
      Solaris routine had a bug, replicated in FreeBSD (and possibly other
      places) where it uses the ARGV[0] value - which might be erroneous -
      instead of the actual file name. If the 'running from' value looks bogus
      but the 'libaries in' value looks ok, go with the libarary.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--p3p-cp </b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--p3p-uri </b></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    P3P is a W3C recommendation - http://www.w3.org/TR/P3P/ - for specifying
      personal information a site collects and what it does with the
      information. These parameters allow to return P3P information. We do not
      supply samples.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--pcap_setnonblock </b></dt>
  <dd class="It-tag">On some platforms, the <b>ntop</b> web server will hang or
      appear to hang (it actually just responds incredibly slowly to the first
      request from a browser session), while the rest of <b>ntop</b> runs just
      fine. This is known to be an issue under FreeBSD 4.x.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option sets the non-blocking option (assuming it's available in the
      version of libpcap that is installed).
    <div style="height: 1.00em;">&#x00A0;</div>
    While this works around the problem (by turing an interupt driven process
      into a poll), it also MAY signifcantly increases the cpu usage of
      <b>ntop.</b> Although it does not actually interfere with other work,
      seeing <b>ntop</b> use 80-90% or more of the cpu is not uncommon - don't
      say we didn't warn you.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>THIS OPTION IS OFFICIALLY UNSUPPORTED</b> and used at your own risk. Read
      the docs/FAQ write-up.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--skip-version-check </b></dt>
  <dd class="It-tag">By default, <b>ntop</b> accesses a remote file to
      periodically check if the most current version is running. This option
      disables that check. Please review the privacy notice at the bottom of
      this page for more information. By default, the recheck period is slightly
      more than 15 days. This can be adjusted via a constant in
      globals-defines.h. If the result of the initial check indicates that the
      <b>ntop</b> version is a 'new development' version (that is newer than the
      latest published development version), the recheck is disabled. This is
      because which fixes and enhancements were present/absent from the code.
    <div style="height: 1.00em;">&#x00A0;</div>
    NOTE: At present, the recheck does not work under Windows.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ssl-watchdog </b></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    Enable a watchdog for webserver hangs. These usually happen when connecting
      with older browsers. The user gets nothing back and other users can't
      connect. Internally, packet processing continues but there is no way to
      access the data through the web server or shutdown ntop cleanly. With the
      watchdog, a timeout occurs after 3 seconds, and processing continues with
      a log message. Unfortunately, the user sees nothing - it just looks like a
      failed connection. (also available as a ./configure option,
      --enable-sslwatchdog)
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--w3c </b></dt>
  <dd class="It-tag">By default, <b>ntop</b> generates displayable but not great
      html. There are a number of tags we do not generate because they cause
      problems with older browsers which are still commonly used or are
      important to look good on real-world browsers. This flag tells <b>ntop</b>
      to generate 'BETTER' (but not perfect) w3c compliant html 4.01 output.
      This in no way addresses all of the compatibility and markup issues. Over
      time, we would like to make <b>ntop</b> more compatible, but it will never
      be 100%. If you find any issues, please report them to ntop-dev.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-4 | --ipv4</b></dt>
  <dd class="It-tag">Use IPv4 connections.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-6 | --ipv6</b></dt>
  <dd class="It-tag">Use IPv6 connections
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="WEB_VIEWS"><a class="selflink" href="#WEB_VIEWS">WEB
  VIEWS</a></h1>
While <b>ntop</b> is running, multiple users can access the traffic information
  using their web browsers. <b>ntop</b> does not generate 'fancy' or 'complex'
  html, although it does use frames, shallowly nested tables and makes some use
  of JavaScript and Cascading Style Sheets.
<div style="height: 1.00em;">&#x00A0;</div>
Beginning with release 3.1, the menus are cascading dropdowns via JSCookMenu.
  With release 3.2, this extends to plugins.
<div style="height: 1.00em;">&#x00A0;</div>
We do not expect problems with any current web browser, but our ability to test
  with less common ones is very limited. Testing has included Firefox and
  Internet Explorer, with very limited testing on other current common browsers
  such as Opera.
<div style="height: 1.00em;">&#x00A0;</div>
In documentation and this man page, when we refer to a page such as Admin |
  Switch NIC, we mean the Broad category &quot;Admin&quot; and the detailed item
  &quot;Switch NIC&quot; on that Admin menu.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
<b>ntop</b> requires a number of external tools and libraries to operate.
  Certain other tools are optional, but add to the program's capabilities.
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--webserver-queue </b></dt>
  <dd class="It-tag">Specifies the maximum number of web server requests for the
      tcp/ip stack to retain in it's queue awaiting delivery to the <b>ntop</b>
      web server. Requests in excess of this queue may be dropped (allowing for
      retransmission) or rejected at the tcp/ip stack level, depending upon the
      OS. Whatever happens, happens at the OS level, without any information
      being delivered to <b>ntop</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    Required libraries include:
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>libpcap</b> from http://www.tcpdump.org/, version 0.7.2 or newer. 0.8.3
      or newer is strongly recommended.
    <div style="height: 1.00em;">&#x00A0;</div>
    The Windows version makes use of <b>WinPcap</b> (libpcap for Windows) which
      may be downloaded from http://winpcap.polito.it/install/default.htm.
    <div style="height: 1.00em;">&#x00A0;</div>
    WARNING: The 2.x releases of <b>WinPcap</b> will NOT support SMP machines.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>gdbm</b> from http://www.gnu.org/software/gdbm/gdbm.html
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>ntop</b> requires a POSIX threads library. As of <b>ntop</b> 3.2, the
      single-threaded version of <b>ntop</b> is no longer available.
    <div style="height: 1.00em;">&#x00A0;</div>
    The <b>gd</b> 2.x library, for the creation of png files, available at
      http://www.boutell.com/gd/.
    <div style="height: 1.00em;">&#x00A0;</div>
    The <b>libpng</b> 1.2.x library, for the creation of png files, available at
      http://www.libpng.org/pub/png/libpng.html.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>ntop</b> should support both gd 1.X and libpng 1.0.x libraries but this
      has not been tested. Note that there are incompatibilities if you compile
      with one version of these libraries and then run with the other. Please
      read the discussion in docs/FAQ before reporting ANY problems of this
      nature.
    <div style="height: 1.00em;">&#x00A0;</div>
    (if an https:// server is desired) <b>openSSL</b> from the OpenSSL project
      available at http://www.openssl.org.
    <div style="height: 1.00em;">&#x00A0;</div>
    The <b>rrdtool</b> library is required by the rrd plugin. rrdtool creates
      'Round-Robin databases' which are used to store and graph historical data
      in a format that permits long duration retention without growing larger
      over time. The rrdtool home page is
      http://people.ee.ethz.ch/~oetiker/webtools/rrdtool/
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>ntop</b> includes a limited version of rrdtool 1.0.49 in the myrrd/
      directory. Users of <b>ntop</b> 3.2 should not need to specifically
      install rrdtool.
    <div style="height: 1.00em;">&#x00A0;</div>
    The <b>sflow</b> Plugin is courtesy of and supported by InMon Corporation,
      http://www.inmon.com/sflowTools.htm.
    <div style="height: 1.00em;">&#x00A0;</div>
    There are other optional libraries. See the output of ./configure for a
      fuller listing.
    <div style="height: 1.00em;">&#x00A0;</div>
    Tool locations are current as of August 2005 - please send email to report
      new locations or dead links.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>top</b>(1), <b>tcpdump</b>(8). <b>pcap</b>(3).
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="PRIVACY_NOTICE"><a class="selflink" href="#PRIVACY_NOTICE">PRIVACY
  NOTICE</a></h1>
By default at startup and at periodic intervals, the <b>ntop</b> program will
  retrieve a file containing current ntop program version information.
  Retrieving this file allows this <b>ntop</b> instance to confirm that it is
  running the most current version.
<div style="height: 1.00em;">&#x00A0;</div>
The retrieval is done using standard http:// requests, which will create log
  records on the hosting system. These log records do contain information which
  identifies a specific <b>ntop</b> site. Accordingly, you are being notified
  that this individually identifiable information is being transmitted and
  recorded.
<div style="height: 1.00em;">&#x00A0;</div>
You may request - via the <b>--skip-version-check</b> run-time option - that
  this check be eliminated. If you use this option, no individually identifiable
  information is transmitted or recorded, because the entire retrieval and check
  is skipped.
<div style="height: 1.00em;">&#x00A0;</div>
We ask you to allow this retrieval and check, because it benefits both you and
  the <b>ntop</b> developers. It benefits you because you will be automatically
  notified if the <b>ntop</b> program version is obsolete, becomes unsupported
  or is no longer current. It benefits the developers of <b>ntop</b> because it
  allows us to determine the number of active <b>ntop</b> instances, and the
  operating system/versions that users are running <b>ntop</b> under. This
  allows us to focus development resources on systems like those our users are
  using <b>ntop</b> on.
<div style="height: 1.00em;">&#x00A0;</div>
The individually identifiable information is contained in the web server log
  records which are automatically created each time the version file is
  retrieved. This is a function of the web server and not of <b>ntop</b> , but
  we do take advantage of it. The log record shows the IP address of the
  requestor (the <b>ntop</b> instance) and a User-Agent header field. We place
  information in the User-Agent header as follows:
<div style="height: 1.00em;">&#x00A0;</div>
<br/>
 ntop/&lt;version&gt;
<br/>
 host/&lt;name from config.guess&gt;
<br/>
 distro/&lt;if one&gt;
<br/>
 release/&lt;of the distro, also if one&gt;
<br/>
 kernrlse/&lt;kernel version or release&gt;
<br/>
 GCC/&lt;version&gt;
<br/>
 config() &lt;condensed parameters from ./configure&gt;
<br/>
 run() &lt;condensed flags - no data - from the execution line&gt;
<br/>
 libpcap/&lt;version&gt;
<br/>
 gdbm/&lt;version&gt;
<br/>
 openssl/&lt;version&gt;
<br/>
 zlib/&lt;version&gt;
<br/>
 access/&lt;http, https, both or none&gt;
<br/>
 interfaces() &lt;given interface names&gt;
<div style="height: 1.00em;">&#x00A0;</div>
For example:
<div style="height: 1.00em;">&#x00A0;</div>
<br/>
 ntop/2.2.98 host/i686-pc-linux-gnu distro/redhat release/9 kernrlse/2.4.20-8smp
<br/>
 GCC/3.2.2 config(i18n) run(i; u; P; w; t; logextra; m; instantsessionpurge;
<br/>
 schedyield; d; usesyslog=; t) gdbm/1.8.0 openssl/0.9.7a zlib/1.1.4
<br/>
 access/http interfaces(eth0,eth1)
<div style="height: 1.00em;">&#x00A0;</div>
Distro and release information is determined at compile time and consists of
  information typically found in the /etc/release (or similar) file. See the
  <b>ntop</b> tool linuxrelease for how this is determined.
<div style="height: 1.00em;">&#x00A0;</div>
gcc compiler version (if available) is the internal version #s for the gcc
  compiler, e.g. 3.2.3.
<div style="height: 1.00em;">&#x00A0;</div>
kernrlse is the Linux Kernel version or the xBSD 'release' such as 4.9-RELEASE
  and is determined from the uname data (if it's available).
<div style="height: 1.00em;">&#x00A0;</div>
The ./configure parameters are stripped of directory paths, leading -s, etc. to
  create a short form that shows us what ./configure parameters people are
  using.
<div style="height: 1.00em;">&#x00A0;</div>
Similarly, the run time parameters are stripped of data and paths, just showing
  which flags are being used.
<div style="height: 1.00em;">&#x00A0;</div>
The libpcap, gdbm, openssl and zlib versions come from the strings returned by
  the various inquiry functions (if they're availabe).
<div style="height: 1.00em;">&#x00A0;</div>
Here's a sample log record:
<div style="height: 1.00em;">&#x00A0;</div>
67.xxx.xxx.xxx - - [28/Dec/2003:12:11:46 -0500] &quot;GET /version.xml
  HTTP/1.0&quot;
<br/>
 200 1568 www.burtonstrauss.com &quot;-&quot; &quot;ntop/2.2.98
  host/i686-pc-linux-gnu
<br/>
 distro/redhat release/9 kernrlse/2.4.20-8smp GCC/3.2.2 config(i18n)
<br/>
 run(i; u; P; w; t; logextra; m; instantsessionpurge; schedyield; d;
<br/>
 usesyslog=) libpcap/0.8 gdbm/1.8.0 openssl/0.9.7a zlib/1.1.4 access/http
<br/>
 interfaces(eth0,eth1,eth2)&quot; &quot;-&quot;
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="USER_SUPPORT"><a class="selflink" href="#USER_SUPPORT">USER
  SUPPORT</a></h1>
Please send bug reports to the ntop-dev &lt;ntop-dev@ntop.org&gt; mailing list.
  The ntop &lt;ntop@ntop.org&gt; mailing list is used for discussing ntop usage
  issues. In order to post messages on the lists a (free) subscription is
  required to limit/avoid spam. Please do NOT contact the author directly unless
  this is a personal question.
<div style="height: 1.00em;">&#x00A0;</div>
Commercial support is available upon request. Please see the ntop site for
  further info.
<div style="height: 1.00em;">&#x00A0;</div>
Please send code patches to &lt;patch@ntop.org&gt;.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
ntop's author is Luca Deri (http://luca.ntop.org/) who can be reached at
  &lt;deri@ntop.org&gt;.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="LICENCE"><a class="selflink" href="#LICENCE">LICENCE</a></h1>
ntop is distributed under the GNU GPL licence (http://www.gnu.org/).
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="ACKNOWLEDGMENTS"><a class="selflink" href="#ACKNOWLEDGMENTS">ACKNOWLEDGMENTS</a></h1>
The author acknowledges the Centro Serra of the University of Pisa, Italy
  (http://www-serra.unipi.it/) for hosting the ntop sites (both web and mailing
  lists), and Burton Strauss &lt;burton@ntopsupport.com&gt; for his help and
  user assistance. Many thanks to Stefano Suin &lt;stefano@ntop.org&gt; and
  Rocco Carbone &lt;rocco@ntop.org&gt; for contributing to the project.</div>
<table class="foot">
  <tr>
    <td class="foot-date">August 2005 (ntop 3.2)</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
