<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>opasetupssh(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">opasetupssh(8)</td>
    <td class="head-vol">Master map: IFSFFCLIRG (Man Page)</td>
    <td class="head-rtitle">opasetupssh(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
opasetupssh
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<b>(Linux or Switch)</b> Creates SSH keys and configures them on all hosts or
  chassis so the system can use SSH and SCP into all other hosts or chassis
  without a password prompt. Typically, during cluster setup this tool enables
  the root user on the Management Node to log into the other hosts (as root) or
  chassis (as admin) using password-less SSH.
<h1 class="Sh" title="Sh" id="Syntax"><a class="selflink" href="#Syntax">Syntax</a></h1>
opasetupssh [-C|p|U] [-f <i>hostfile</i>] [-F <i>chassisfile</i>] [-h
  '<i>hosts</i>'] [-H ' <i>chassis</i>'] [-i <i>ipoib_suffix</i>] [-u
  <i>user</i>] [-S] [-R|P]
<h1 class="Sh" title="Sh" id="Options"><a class="selflink" href="#Options">Options</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag">--help</dt>
  <dd class="It-tag">Produces full help text.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-C</dt>
  <dd class="It-tag">Performs operation against chassis. Default is hosts.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-p</dt>
  <dd class="It-tag">Performs operation against all chassis or hosts in
      parallel.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-U</dt>
  <dd class="It-tag">Performs connect only (to enter in local hosts, known
      hosts). When run in this mode, the -S option is ignored.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-f <i>hostfile</i></dt>
  <dd class="It-tag">File with hosts in cluster. Default is
      /etc/sysconfig/opa/hosts file.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-F <i>chassisfile</i></dt>
  <dd class="It-tag">File with chassis in cluster. Default is
      /etc/sysconfig/opa/chassis file.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-h <i>hosts</i></dt>
  <dd class="It-tag">List of hosts to set up.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-H <i>chassis</i></dt>
  <dd class="It-tag">List of chassis to set up.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-i <i>ipoib_suffix</i></dt>
  <dd class="It-tag">Suffix to apply to host names to create IPoIB host names.
      Default is -ib.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-u <i>user</i></dt>
  <dd class="It-tag">User on remote system to allow this user to SSH to. Default
      is current user code for host(s) and admin for chassis.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-S</dt>
  <dd class="It-tag">Securely prompts for password for user on remote system.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-R</dt>
  <dd class="It-tag">Skips setup of SSH to local host.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">-P</dt>
  <dd class="It-tag">Skips ping of host (for SSH to devices on Internet with
      ping firewalled).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="Examples"><a class="selflink" href="#Examples">Examples</a></h1>
<h1 class="Sh" title="Sh" id="Operations_on_Hosts"><a class="selflink" href="#Operations_on_Hosts">Operations
  on Hosts</a></h1>
opasetupssh -S -i''
<div>&#x00A0;</div>
opasetupssh -U
<div>&#x00A0;</div>
opasetupssh -h 'arwen elrond' -U
<div>&#x00A0;</div>
HOSTS='arwen elrond' opasetupssh -U
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="Operations_on_Chassis"><a class="selflink" href="#Operations_on_Chassis">Operations
  on Chassis</a></h1>
opasetupssh -C
<div>&#x00A0;</div>
opasetupssh -C -H 'chassis1 chassis2'
<div>&#x00A0;</div>
CHASSIS='chassis1 chassis2' opasetupssh -C
<h1 class="Sh" title="Sh" id="Environment_Variables"><a class="selflink" href="#Environment_Variables">Environment
  Variables</a></h1>
The following environment variables are also used by this command:
<dl class="Bl-tag">
  <dt class="It-tag"><b>HOSTS_FILE</b></dt>
  <dd class="It-tag">File containing list of hosts, used in absence of -f and
      -h.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CHASSIS_FILE</b></dt>
  <dd class="It-tag">File containing list of chassis, used in absence of -F and
      -H.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>HOSTS</b></dt>
  <dd class="It-tag">List of hosts, used if -h option not supplied.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CHASSIS</b></dt>
  <dd class="It-tag">List of chassis, used if -C is used and -H and -F options
      not supplied.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>FF_MAX_PARALLEL</b></dt>
  <dd class="It-tag">When -p option is used, maximum concurrent operations.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>FF_IPOIB_SUFFIX</b></dt>
  <dd class="It-tag">Suffix to append to hostname to create IPoIB hostname. Used
      in absence of -i.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>FF_CHASSIS_LOGIN_METHOD</b></dt>
  <dd class="It-tag">How to log into chassis. Can be Telnet or SSH.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>FF_CHASSIS_ADMIN_PASSWORD</b></dt>
  <dd class="It-tag">Password for admin on all chassis. Used in absence of -S
      option.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="Description"><a class="selflink" href="#Description">Description</a></h1>
The Intel(R) Omni-Path Fabric Suite FastFabric Toolset provides additional
  flexibility in the translation between IPoIB and management network hostnames.
  Refer to &quot;Configuration of IPoIB Name Mapping&quot; section in the
  <i>Intel(R) Omni-Path Fabric Suite FastFabric User Guide</i>
<div style="height: 1.00em;">&#x00A0;</div>
for more information.
<div class="Pp"></div>
opasetupssh provides an easy way to create SSH keys and distribute them to the
  hosts or chassis in the cluster. Many of the FastFabric tools (as well as many
  versions of MPI) require that SSH is set up for password-less operation.
  Therefore, opasetupssh is an important setup step.
<div class="Pp"></div>
This tool also sets up SSH to the local host and the local host's IPoIB name.
  This capability is required by selected FastFabric Toolset commands and may be
  used by some applications (such as MPI).
<div class="Pp"></div>
opasetupssh has two modes of operation. The mode is selected by the presence or
  absence of the -U option. Typically, opasetupssh is first run without the -U
  option, then it may later be run with the -U option.
<h1 class="Sh" title="Sh" id="Host_Initial_Key_Exchange"><a class="selflink" href="#Host_Initial_Key_Exchange">Host
  Initial Key Exchange</a></h1>
When run without the -U option, opasetupssh performs the initial key exchange
  and enables password-less SSH and SCP. The preferred way to use opasetupssh
  for initial key exchange is with the -S option. This requires that all hosts
  are configured with the same password for the specified #8217#8220;user''
  (typically root). In this mode, the password is prompted for once and then SSH
  and SCP are used in conjunction with that password to complete the setup for
  the hosts. This mode also avoids the need to set up rsh/rcp/rlogin (which can
  be a security risk).
<div class="Pp"></div>
opasetupssh configures password-less SSH/SCP for both the management network and
  IPoIB. Typically, the management network is used for FastFabric Toolset
  operations while IPoIB is used for MPI and other applications.
<div class="Pp"></div>
During initial cluster installation, where the Intel(R) Omni-Path Fabric
  software is not yet installed on all the hosts, IPoIB is not yet running. In
  this situation, use the -i option with an empty string as follows:opasetupssh
  -i ''
<div class="Pp"></div>
This causes the last part of the setup of SSH for IPoIB to be skipped.
<h1 class="Sh" title="Sh" id="Refreshing_Local_Systems_Known_Hosts"><a class="selflink" href="#Refreshing_Local_Systems_Known_Hosts">Refreshing
  Local Systems Known Hosts</a></h1>
If aspects of the host have changed, such as IP addresses, MAC addresses,
  software installation, or server OS reinstallation, you can refresh the local
  host's SSH known_hosts file by running opasetupssh with the -U option. This
  option does not transfer the keys, but instead connects to each host
  (management network and IPoIB) to refresh the SSH keys. Existing entries for
  the specified hosts are replaced within the local known_hosts file. When run
  in this mode, the -S option is ignored. This mode assumes SSH has previously
  been set up for the hosts, as such no files are transferred to the specified
  hosts and no passwords should be required.
<div class="Pp"></div>
Typically after completing the installation and booting of Intel(R) Omni-Path
  Fabric software, opasetupssh must be rerun with the -U option to update the
  known_hosts file.
<h1 class="Sh" title="Sh" id="Chassis_Initial_Key_Exchange"><a class="selflink" href="#Chassis_Initial_Key_Exchange">Chassis
  Initial Key Exchange</a></h1>
When run without the -U option, opasetupssh performs the initial key exchange
  and enables password-less SSH and SCP. For chassis, the key exchange uses SCP
  and the chassis CLI. During this command you log into the chassis using the
  configured mechanism for chassis login.
<div class="Pp"></div>
The preferred way to use opasetupssh for initial key exchange is with the -S
  option. This requires that all chassis are configured with the same password
  for admin. In this mode, you are prompted for the password once and then the
  <b>FF_CHASSIS_LOGIN_METHOD</b> and SCP are used in conjunction with that
  password to complete the setup for the chassis. This method also avoids the
  need to setup the chassis password in /etc/sysconfig/opa/opafastfabric.conf
  (which can be a security risk).
<div class="Pp"></div>
For chassis, the -i option is ignored.
<h1 class="Sh" title="Sh" id="Chassis_Refreshing_Local_Systems_Known_Hosts"><a class="selflink" href="#Chassis_Refreshing_Local_Systems_Known_Hosts">Chassis
  Refreshing Local Systems Known Hosts</a></h1>
If aspects of the chassis have changed, such as IP addresses or MAC addresses,
  you can refresh the local host's SSH known_hosts file by running opasetupssh
  with the -U option. This option does not transfer the keys, but instead
  connects to each chassis to refresh the SSH keys. Existing entries for the
  specified chassis are replaced within the local known_hosts file. When run in
  this mode, the -S option is ignored. This mode assumes SSH has previously been
  set up for the chassis, because no files are transferred to the specified
  hosts and no passwords are required.</div>
<table class="foot">
  <tr>
    <td class="foot-date">Intel Corporation</td>
    <td class="foot-os">Copyright(C) 2015-2016</td>
  </tr>
</table>
</body>
</html>
