<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>SING(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">SING(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">SING(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<b>sing</b> - <b>S</b>end <b>I</b>CMP <b>N</b>asty <b>G</b>arbage packets to
  network hosts
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>sing</b> [ <b>-hVRnvqGQOBU</b>] [<b>-c</b> <i>count</i>] [<b>-T</b>
  <i>wait</i>] [ <b>-p</b> <i>pattern</i>] [ <b>-s</b> <i>datasize</i>]
  [<b>-F</b> <i>bytes</i>] [<b>-i</b> <i>interface</i>] [ <b>-S</b>
  <i>spoof</i>] [ <b>-t</b> <i>ttl</i>] [<b>-TOS</b> <i>tos</i>] [<b>-l</b>
  <i>preload</i>] [ <b>-M</b> <i>os</i>] [<b>-L</b> <i>logfile</i>] [<b>-MAC</b>
  <i>hw_addr</i>] [<b>-x</b> <i>code</i>] [<i>type</i>] <i>host</i>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>sing</b> is a tool that sends ICMP packets fully customized from command
  line. The main purpose is to replace the niceful <b>ping</b> command with
  certain enhancenments as the ability to send/read IP spoofed packets, send MAC
  spoofed packets, send in addition to the ECHO REQUEST type sent by default,
  many other ICMP types as <b>Echo Reply</b>, <b>Address Mask Request</b>,
  <b>Timestamp</b>, <b>Information Request</b>,<b>Router Solicitation</b> and
  <b>Router Advertisement</b>.
<div style="height: 1.00em;">&#x00A0;</div>
It supports also the following ICMP error types: <b>Redirect</b>, <b>Source
  Quench</b>, <b>Time Exceeded</b>, <b>Destination Unreachable</b> and
  <b>Parameter Problem</b>.
<div style="height: 1.00em;">&#x00A0;</div>
It can do a little fingerprinting, see the <b>FINGERPRINTING TECHNIQUES</b>
  section to read more details about.
<div style="height: 1.00em;">&#x00A0;</div>
It can emulate certain OOSS sending <b>Echo Request</b> or <b>Echo Reply</b>
  packets. See the <b>MIMIC TECHNIQUES</b> section for a more accurate
  information.
<div style="height: 1.00em;">&#x00A0;</div>
The host destination can also be specified as a list of gateways (including
  destination) breaked by the ' <b>%</b>' symbol meaning the use of a <b>Strict
  Source Routing IP Option</b> (v.g. router1
  <b>%</b>router2<b>%</b>router3<b>%</b>host) or the ' <b>@</b>' symbol meaning
  the use of a <b>Loose</b> <b>Source Routing IP Option</b> (v.g.
  router1<b>@</b>router2 <b>@</b>router3<b>@</b>host).
<div style="height: 1.00em;">&#x00A0;</div>
A long number of examples is given at the <b>EXAMPLES</b> section of this page
  that shows a real use of this program.
<h1 class="Sh" title="Sh" id="MOST_COMMON_OPTIONS"><a class="selflink" href="#MOST_COMMON_OPTIONS">MOST
  COMMON OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h</b>, <b>--help</b></dt>
  <dd class="It-tag">Help screen.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-V</b>, <b>--Version</b></dt>
  <dd class="It-tag">Program version.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v</b></dt>
  <dd class="It-tag">Verbose mode.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-B</b></dt>
  <dd class="It-tag">Send a <b>B</b>ad ICMP Checksum on Information types.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c</b> <i>count</i></dt>
  <dd class="It-tag">Stop after sending (and receiving) <i>count</i> packets.
      Information types only.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-F</b> <i>bytes</i></dt>
  <dd class="It-tag">Fragment the entire ICMP packet with <i>bytes</i> size by
      fragment. Not used on Solaris systems.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-G</b></dt>
  <dd class="It-tag">Set the IP header Don't Fragment flag. Not used on Solaris
      systems.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i</b> <i>interface</i></dt>
  <dd class="It-tag">Interface (name or IP address) where listen on for
    replies.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l</b> <i>preload</i></dt>
  <dd class="It-tag">If <i>preload</i> is specified, <b>sing</b> sends that many
      packets as fast as possible before falling into its normal mode of
      behavior. Only the super-user may use this option. Information types
    only.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-L</b> <i>logfile</i></dt>
  <dd class="It-tag">Save the current session to the file <i>logfile</i>. If
      <i>logfile</i> exists the data will be appended at end.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-M</b> <i>os</i></dt>
  <dd class="It-tag">Do mimic of the <i>os</i> specified when sending an <i>Echo
      Request</i> or <i>Echo Reply</i>. <i>os</i> can be <i>win</i>,
      <i>unix</i>, <i>linux</i>, <i>cisco</i>, <i>solaris</i> or
    <i>shiva</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-MAC</b> <i>hw_address</i></dt>
  <dd class="It-tag">Do MAC spoofing using the MAC <i>hw_address</i> (maybe to
      surpass filtered switches). Be aware of using on an interface with a
      datalink type different of Ethernet. The MAC address must be on
      hexadecimal form and must be delimited by ' <b>:</b>' (Example:
      00:FF:AC:33:1:B). This option made use of the libnet library to acces the
      network link layer. Only the super-user can use this option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n</b></dt>
  <dd class="It-tag">Don't use name resolution.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-O</b></dt>
  <dd class="It-tag">Do fingerprinting to discover the target OS.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p</b> <i>pattern</i></dt>
  <dd class="It-tag">You may specify a <i>pattern</i> of bytes to fill out the
      packet you send. This is useful for diagnosing data-dependent problems in
      a network. For example, `-p INPACK'' will cause the sent packet to be
      filled with the word INPACK.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-q</b></dt>
  <dd class="It-tag">Quiet output. Nothing is displayed except the summary lines
      at startup time and when finished.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-Q</b></dt>
  <dd class="It-tag">Totally quiet output. Absolutly nothing is displayed.
      Useful to use within shell scripts.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-R</b></dt>
  <dd class="It-tag">Use Record Route IP Header Option on the ICMP packet.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s</b> <i>bytes</i>|<i>max</i></dt>
  <dd class="It-tag">Number of garbage bytes that will be sent on any ICMP
      packet. With <i>max</i> the maximum possible will be sent.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-S</b> <i>address</i></dt>
  <dd class="It-tag">IP address to be used as the source of the ICMP packet.
      This force the use of the libpcap routines that puts your network
      interface into promiscuous mode to be able to read the replies. Only the
      super-user may use this option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-t</b> <i>ttl</i></dt>
  <dd class="It-tag">Set the IP Time To Live field to <i>ttl</i> value.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-T</b> <i>wait</i></dt>
  <dd class="It-tag">Wait <i>wait</i> seconds <i>between sending each
      packet</i>. The default is to wait for one second between each
    packet.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-TOS</b> <i>tos</i></dt>
  <dd class="It-tag">Set the IP Type Of Service field to <i>tos</i> value.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-U</b></dt>
  <dd class="It-tag">Set the IP header Unused bit flag. Be aware on *BSD systems
      because the kernel set to 0 the IP header flags when using the Reserved
      Bit so <i>SING</i> must revert to promiscuous mode to be able to read the
      response with libpcap. Not used on Solaris systems.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-x</b>, <b>--xcode</b>
    <i>code</i>|<i>num</i>|<i>max</i></dt>
  <dd class="It-tag">ICMP code to send. Code <i>code</i> valid for Destination
      Unreachable ( <b>-du</b>), Redirect ( <b>-red</b>) and Time Exceeded
      (<b>-tx</b>) types. Numerical code can be specified for the ICMP types
      that doesn't have (Echo Request, Information Request, Address Mask
      Request, Router Solicitation, Router Advertisement, Source Quench,
      Parameter Problem and Timestamp). Using <i>max</i> an ICMP code greater
      than the admited ones will be sent. See the <b>ICMP CODES</b> section for
      a long list of <i>code</i> types.</dd>
</dl>
<h1 class="Sh" title="Sh" id="ICMP_TYPES"><a class="selflink" href="#ICMP_TYPES">ICMP
  TYPES</a></h1>
The <b>type</b> can be any of the following below:
<dl class="Bl-tag">
  <dt class="It-tag"><b>-echo</b>, <b>--echo_request</b></dt>
  <dd class="It-tag">Echo Request. Request sent to a host to receive an echo
      reply. This is the type sent by default. This ICMP type is
      <b>information</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-tstamp</b>, <b>--timestamp</b></dt>
  <dd class="It-tag">Timestamp. Host request to receive the time of another
      host. This ICMP type is <b>information</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-mask</b>, <b>--mask_req</b></dt>
  <dd class="It-tag">Address Mask Request. Used to find out a host network mask.
      This ICMP type is <b>information</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-info</b>, <b>--info_req</b></dt>
  <dd class="It-tag">Information Request. Host request to receive an Info Reply
      from another host. This ICMP type is <b>information</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-du</b>, <b>--dest_unreach</b></dt>
  <dd class="It-tag">Destination Unreach. IP packet couldn't be given. This ICMP
      type is <b>error</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-sq</b>, <b>--src_quench</b></dt>
  <dd class="It-tag">Source Quench. IP packet is not given due a net congestion.
      This ICMP type is <b>error</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-red</b>, <b>--redirect</b></dt>
  <dd class="It-tag">Redirect. Request to forward IP packets through another
      router. This ICMP type is <b>error</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-rta</b>, <b>--router_advert</b>
    <b>address</b>[<b>/preference</b>]</dt>
  <dd class="It-tag">Router Advertisement. Router trasmits one or more routers
      with address <b>address</b> and preference <b>preference</b>. If this is
      ommited, default preference 0 is given. This ICMP type is
      <b>information</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-rts</b>, <b>--router_solicit</b></dt>
  <dd class="It-tag">Router Solicitation. Host requeriment for a message of one
      or more routers. Like the previous, is a part of the messages exchange
      Router Discovery and this ICMP type is <b>information</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-tx</b>, <b>--time_exc</b></dt>
  <dd class="It-tag">Time Exceeded. Time Exceeded for an IP packet. This ICMP
      type is <b>error</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-param</b>, <b>--param_problem</b></dt>
  <dd class="It-tag">Parameter Problem. Erroneous value on a variable of IP
      header. This ICMP type is <b>error</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-reply</b></dt>
  <dd class="It-tag">Echo Reply. Response to a Echo Request. This ICMP type is
      <b>information</b>.</dd>
</dl>
<h1 class="Sh" title="Sh" id="LESS_COMMON_OPTIONS"><a class="selflink" href="#LESS_COMMON_OPTIONS">LESS
  COMMON OPTIONS</a></h1>
The <b>options</b> can be any of the following:
<dl class="Bl-tag">
  <dt class="It-tag"><b>-lt</b>, <b>--lifetime</b> <i>secs</i></dt>
  <dd class="It-tag">Lifetime in seconds of the router announcement. Only valid
      with Router Advertisement ( <b>-rta</b>) type. 1800 seconds by default
      (30').</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-gw</b>, <b>--gateway</b> <i>address</i></dt>
  <dd class="It-tag">Route gateway address on an ICMP Redirect (<b>-red</b>). By
      default will be the spoof address ( <b>-S</b>), if it has been specified,
      or the outgoing IP address if it has not been specified.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-dest</b>, <b>--route_dest</b> <i>address</i></dt>
  <dd class="It-tag">Route destination address on an ICMP Redirect
      (<b>-red</b>). This is a required option when sending an ICMP
    Redirect.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-orig</b>, <b>--orig_host</b> <i>address</i></dt>
  <dd class="It-tag">Original host within the IP header sent in the 64 bits data
      field of an ICMP <b>error</b>. By default will be the same as the IP of
      the host that sends the ICMP packet.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-psrc</b>, <b>--port_src</b> <i>port</i></dt>
  <dd class="It-tag">Source port (tcp or udp) within the IP header sent in the
      64 bits data field of an ICMP <b>error</b>. 0 by default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-pdst</b>, <b>--port_dst</b> <i>port</i></dt>
  <dd class="It-tag">Destination port (tcp or udp) within the IP header sent in
      the 64 bits data field of an ICMP <b>error</b>. 0 by default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-prot</b>, <b>--protocol</b>
    <i>name</i>|<i>number</i></dt>
  <dd class="It-tag">Protocol to be used within the IP header sent in the 64
      bits data field of an ICMP <b>error</b>. Must be a name from the
      <b>/etc/protocols</b> or a protocol number. Only <b>tcp</b>,<b> udp</b>
      and <b>icmp</b> are fully implemented, with other protocols the remaining
      of the 64 bits field are fulfilled with 0xFF. TCP by default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-id</b> <i>identificator</i></dt>
  <dd class="It-tag">ICMP id to be used with ICMP of Information types. Do not
      be confused with the <b>-ip_id</b> option!.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-seq</b> <i>sequence</i></dt>
  <dd class="It-tag">Echo sequence number to be used with <b>Echo Request</b> or
      <b>Echo Reply</b> types. Do not be confused with the <b>-ip_seq</b>
      option!.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-ip_id</b> <i>identificator</i></dt>
  <dd class="It-tag">Echo identificator within the IP header sent in the 64 bits
      data field of an ICMP <b>error</b> when the IP header protocol of the 64
      bits data field ( <b>-prot</b>) is icmp. 0 by default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-ip_seq</b> <i>sequence</i></dt>
  <dd class="It-tag">Echo sequence number within the IP header sent in the 64
      bits data field of an ICMP <b>error</b> when the IP header protocol of the
      64 bits data field ( <b>-prot</b>) is icmp. 0 by default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-ptr</b>, <b>--pointer</b> <i>byte</i></dt>
  <dd class="It-tag">Pointer to erroneus byte <b>byte</b> on an ICMP packet
      showing a parameter problem. Valid only on Parameter Problem type (
      <b>-param</b>).</dd>
</dl>
<h1 class="Sh" title="Sh" id="ICMP_CODES"><a class="selflink" href="#ICMP_CODES">ICMP
  CODES</a></h1>
Valid <b>codes</b> used with Destination Unreach, Redirect and Time Exceeded
  types are,
<dl class="Bl-tag">
  <dt class="It-tag">- Used with <b>Destination Unreach</b> type
    (<b>-du</b>):</dt>
  <dd class="It-tag"></dd>
</dl>
<div class="Pp"></div>
<b>net-unreach</b> (Net Unreachable) The destination net is unreachable.
<div style="height: 1.00em;">&#x00A0;</div>
<b>host-unreach</b> (Host Unreachable) The destination host is unreachable.
<div style="height: 1.00em;">&#x00A0;</div>
<b>prot-unreach</b> (Protocol Unreachable) desired protocol is unreachable to
  destination host.
<div style="height: 1.00em;">&#x00A0;</div>
<b>port-unreach</b> (Port Unreachable) desired port is unreachable to
  destination host.
<div style="height: 1.00em;">&#x00A0;</div>
<b>frag-needed</b> (Fragmentation Needed and Don't Fragment was Set) Shows that
  IP packet had to be fragmented because of its size but the sender did not
  allowed it because the DF (DON'T FRAGMENT) flag was set.
<div style="height: 1.00em;">&#x00A0;</div>
<b>sroute-fail</b> (Source Route Failed) could'nt follow the route indicated on
  IP packet.
<div style="height: 1.00em;">&#x00A0;</div>
<b>net-unknown</b> (Destination Network Unknown) Destination network is unknown.
<div style="height: 1.00em;">&#x00A0;</div>
<b>host-unknown</b> (Destination Host Unknown) Destination host unknown but
  network is.
<div style="height: 1.00em;">&#x00A0;</div>
<b>host-isolated</b> (Source Host Isolated) Can't reach destination host.
<div style="height: 1.00em;">&#x00A0;</div>
<b>net-ano</b> (Communication with Destination Network is Administratively
  Prohibited) access network is denied through firewall or similar on receiver
  side.
<div style="height: 1.00em;">&#x00A0;</div>
<b>host-ano</b> (Communication with Destination Host is Administratively
  Prohibited) access host is denied through firewall or similar on receiver
  side.
<div style="height: 1.00em;">&#x00A0;</div>
<b>net-unr-tos</b> (Destination Network Unreachable for Type of Service)
  indicates on destination network that the Type Of Service (TOS) applied for is
  not allowed.
<div style="height: 1.00em;">&#x00A0;</div>
<b>host-unr-tos</b> (Destination Host Unreachable for Type of Service) shows
  that destination host is unreachable with applied TOS.
<div style="height: 1.00em;">&#x00A0;</div>
<b>com-admin-prohib</b> (Communication Administratively Prohibited) a router
  can't forward a packet because of administrative filter.
<div style="height: 1.00em;">&#x00A0;</div>
<b>host-precedence-viol</b> (Host Precedence Violation) IP packet precedence is
  not allowed.
<div style="height: 1.00em;">&#x00A0;</div>
<b>precedence-cutoff</b> (Precedence cutoff in effect) a smaller IP packet
  precedence has tried to be sent over the minimal impossed by network manager.
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag">- To be used with <b>Redirect</b> type (<b>-red</b>):</dt>
  <dd class="It-tag"></dd>
</dl>
<div class="Pp"></div>
<b>net</b> (Redirect Datagram for the Network) shows that destination is a
  network.
<div style="height: 1.00em;">&#x00A0;</div>
<b>host</b> (Redirect Datagram for the Host) shows that destination is a host.
<div style="height: 1.00em;">&#x00A0;</div>
<b>serv-net</b> (Redirect Datagram for the Type Of Service and Network)
  destination is a type of service and network.
<div style="height: 1.00em;">&#x00A0;</div>
<b>serv-host</b> (Redirect Datagram for the Type Of Service and Host)
  destination is a type of service and host.
<div class="Pp"></div>
and
<dl class="Bl-tag">
  <dt class="It-tag">- to be used with <b>Time Exceeded</b> type
    (<b>-tx</b>):</dt>
  <dd class="It-tag"></dd>
</dl>
<div class="Pp"></div>
<b>ttl</b> (Time to Live exceeded in Transit) time is over on an IP packet
  header packet.
<div style="height: 1.00em;">&#x00A0;</div>
<b>frag</b> (Fragment Reassembly Time Exceeded) could not reassembly all the IP
  packet fragments.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="FINGERPRINTING_TECHNIQUES"><a class="selflink" href="#FINGERPRINTING_TECHNIQUES">FINGERPRINTING
  TECHNIQUES</a></h1>
With the <b>-O</b> option <b>SING</b> can use little techniques of remote OS
  fingerprinting. To distinguish between Window$ boxes and the rest of the world
  <b>Ofir</b> <b>Arkin</b> has discovered a simple method: Sending an ICMP code
  that is not 0 within an ICMP Echo Request, a Window$ box respond with a 0 code
  while the rest of the boxes would leave the code field unchanged. See the
  <b>SEE ALSO</b> section.
<div style="height: 1.00em;">&#x00A0;</div>
With Solaris systems <b>SING</b> use a method discovered by me: Sending a
  fragmented Addres Mask Request any Solaris system (tested from 2.5.1 to
  Solaris8 Intel &amp; SPARC) respond with an Address Mask of 0's. Last update!:
  Some people have noticed that HP-UX v11.0 respond the same way.
<div style="height: 1.00em;">&#x00A0;</div>
See the <b>EXAMPLES</b> section for examples.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="MIMIC_TECHNIQUES"><a class="selflink" href="#MIMIC_TECHNIQUES">MIMIC
  TECHNIQUES</a></h1>
With the <b>-M</b> option <b>SING</b> can try to emulate certain OS. At the
  moment Window$98/Window$NT4 ( <b>win</b> value), UNIX (<b>unix</b> value),
  Linux ( <b>linux</b> value), Cisco (<b>cisco</b> value), Solaris (
  <b>solaris</b> value) or Shiva ( <b>shiva</b> value) are the only accepted
  values. To emulate them <b>SING</b> changes its normal behaviour about the IP
  header flags, the TTL, the initial ICMP sequence number, the ICMP id and the
  ICMP data that each OS send. These techniques are aplied only when using
  <b>Echo Request</b> or <b>Echo Reply</b> types.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="RETURN_VALUES"><a class="selflink" href="#RETURN_VALUES">RETURN
  VALUES</a></h1>
<b>sing</b> can be easily used within shell scripts. Program returns the
  following values to the shell:
<div style="height: 1.00em;">&#x00A0;</div>
Value Meaning ----- ----------- 0 Received at least 1 response from destination
  host. 1 General Error. 2 Packet sent OK but received no response. 3 Out of
  memory.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
- Testing if www.solarisbox.xx is running the Solaris OS. Supposed no filter
  methods:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -mask -O www.solarisbox.xx</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- Testing if www.winbox.xx is running the Window$ OS:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -O www.winbox.xx</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- Send Echos with garbage size of 32 bytes and fragments of 8 bytes to host
  www.provatina.xx:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -s</b> 32 <b>-F</b> 8 <b>www.provatina.xx</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- Send Echos with data pattern IsSiNg and fragments of 8 bytes to the host
  www.provatina.xx using Loose Source Routing via router1.xx and router2.xx:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -p</b> IsSiNg <b>-F</b> 8 <b>router1.xx@router2.xx@www.provatina.xx</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- Send an ICMP packet Timestamp to host sepultura.hell. We spoof as host
  10.2.3.1:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -tstamp -S</b> 10.2.3.1 <b>sepultura.hell</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- Send an ICMP packet Router Solicitation to 10.13.1.0:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -rts </b> <b>10.13.1.0</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- Send an ICMP Router Advertisement to host death.es, saying that the routers to
  use are: router1.xtc with preference 20, router2.xtc with preference 50 and
  router3.xtc with default preference (0). We spoof as fatherouter.xtc:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -rta</b> router1.xtc/20 <b>-rta</b> router2.xtc/50 <b>-rta</b>
  router3.xtc <b>-S</b> fatherouter.xtc <b>death.es</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- In response to a packet send with TCP source port 100 and destination on port
  90, we want to send and ICMP Redirect to dwdwah.xx to modify its routing table
  with the following data: 10.12.12.12 as a gateway to the host death.es masking
  the packet source as if it was sent from infect.comx host:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -red -S</b> infect.comx <b>-gw</b> 10.12.12.12 <b>-dest</b> death.es
  <b>-x</b> host <b>-prot</b> tcp <b>-psrc</b> 100 <b>-pdst</b> 90
  <b>dwdwah.xx</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- In response to an ICMP packet Echo Request sent with Echo Request id 100 and
  Echo Request sequence number 90, we want to send an ICMP Redirect to the host
  araya.xx to modify its routing table with the following data: the host
  pizza.death as a gateway to the host death.es, masking the packet source as if
  it was sent from infect.comx host.
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -red -S</b> infect.comx <b>-gw</b> pizza.death <b>-dest</b> death.es
  <b>-x</b> host <b>-prot</b> icmp <b>-ip_id</b> 100 <b>-ip_seq</b> 90
  <b>araya.xx</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- We want to send an ICMP packet Destination Unreach to the host 10.2.3.4 saying
  that our TCP port number 20 connected with its TCP port 2100, is unreachable.
  We mask ourselves as host 10.1.1.1:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -du -S</b> 10.1.1.1 <b>-x</b> port-unreach <b>-prot</b> tcp <b>-psrc</b>
  2100 <b>-pdst</b> 20 <b>10.2.3.4</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- We want to send an ICMP packet Destination Unreach to host 10.2.3.4 saying
  that the host inferno.hell and its TCP port 69, connected with his port TCP
  666 in unreachable. We mask ourselves as gateway router.comx:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -du -S</b> router.comx <b>-x</b> host-unreach <b>-prot</b> tcp
  <b>-psrc</b> 666 <b>-pdst</b> 69 <b>-orig</b> inferno.hell <b>10.2.3.4</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- We want to send a packet ICMP Source Quench to host ldg02.hell in response to
  a packet destinated to host ldg00 with UDP protocol, source port 100 and
  destination port 200. We mask ourselves as gateway 10.10.10.1:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -sq -S</b> 10.10.10.1 <b>-prot</b> udp <b>-psrc</b> 100 <b>-pdst</b> 200
  <b>-orig</b> ldg00 <b>ldg02.hell</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- We want to send an ICMP packet Time Exceeded to host ldg02.hell in response to
  a packet destinated to host ldg00 with UDP protocol, source port 100 and
  destination port 200. We mask as gateway ldg04.hell:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -tx -S</b> ldg04.hell <b>-x</b> frag <b>-prot</b> udp <b>-psrc</b> 100
  <b>-pdst</b> 200 <b>-orig</b> ldg00 <b>ldg02.hell</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- We want to send an ICMP packet Address Mask Request and wait 10 seconds
  between sending each packet. We mask the packet with source address of
  10.2.3.4 and we send it to the address 10.0.1.255:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -mask -S</b> 10.2.3.4 <b>-T</b> 10 <b>10.0.1.255</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- We want to send an ICMP packet Information Request to host deep.hell:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -info </b> <b>deep.hell</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- We want to send an ICMP packet Echo Request to host black.hell with the data
  pattern 'MyNameIsGump':
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -p</b> MyNameIsGump <b>black.hell</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- We want to send ICMP packet Echo Request to 10.12.0.255 with the following
  data pattern: D E A T H (blanks included). We will mask the source address as
  192.168.0.255:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -S</b> 192.168.0.255 <b>-p</b> 'D E A T H' <b>10.12.0.255</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- We want to send an ICMP packet Destination Unreach to host destination.death
  but sending it with an ICMP code bigger to the legal ones adding also 60K of
  garbage data:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -du -x</b> max <b>-s</b> 60000 <b>destination.death</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- We send an ICMP Parameter Problem to host misery.es saying that the packet
  sent from the host dump.xorg with udp protocol, source port 13 and destination
  port 53, has an error on the IP header byte 13. We will also add all garbage
  bytes as possible:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -S</b> dump.xorg <b>-param -ptr</b> 13 <b>-prot</b> udp <b>-psrc</b> 13
  <b>-pdest</b> 53 <b>-s</b> max <b>misery.es</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
- We want to send an ICMP packet Timestamp to host www.danz.hell with code 38
  instead of code (0) as usual:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -tstamp -x</b> 38 <b>www.danz.hell</b>
<div style="height: 1.00em;">&#x00A0;</div>
- Same as above without code 38 and using Loose Source Routing between the
  routers cisco, 10.13.1.1 and wakeup.man:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -tstamp cisco@10.13.1.1@wakeup.man@www.danz.hell</b>
<div style="height: 1.00em;">&#x00A0;</div>
- Same as above using Strict Source Routing between the gateways:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -tstamp cisco%10.13.1.1%wakeup.man%www.danz.hell</b>
<div style="height: 1.00em;">&#x00A0;</div>
- Using Record Route IP Option to see the route that takes to ftp.target.xx:
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing -R ftp.target.xx</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
Postel, John, &quot;Internet Control Message Protocol - DARPA Internet Program
  Protocol Specification&quot;, <b>RFC 792</b>, USC/Information Sciences
  Institute, September 1981.
<div style="height: 1.00em;">&#x00A0;</div>
Mogul, Jeffrey and John Postel, &quot;Internet Standard Subnetting
  Procedure&quot;, <b>RFC 950</b>, Stanford, USC/Information Sciences Institute,
  August 1985.
<div style="height: 1.00em;">&#x00A0;</div>
Braden, Robert, &quot;Requeriments for Internet Hosts - Communication
  Layers&quot;, <b>RFC 1122</b>, USC/Information Sciences Institute, October
  1989.
<div style="height: 1.00em;">&#x00A0;</div>
Deering, Stephen, &quot;ICMP Router Discovery Messages&quot;, <b>RFC 1256</b>,
  Xerox PARC, September 1991.
<div style="height: 1.00em;">&#x00A0;</div>
Baker, Fred, &quot;Requeriments for IP Version 4 Routers&quot;, <b>RFC 1812</b>,
  Cisco Systems, June 1995.
<div style="height: 1.00em;">&#x00A0;</div>
Arkin, Ofir, &quot;ICMP usage in scanning&quot;,
  <b>http://www.sys-security.com/archive/papers/ICMP_Scanning.pdf</b>,
  Sys-Security Group, July 2000.
<div style="height: 1.00em;">&#x00A0;</div>
The <b>Linux source code</b>, everything referent to network code and to ICMP
  protocol.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
The original <b>ping</b> command was written by Mike Muuss.
<div style="height: 1.00em;">&#x00A0;</div>
<b>sing</b> is original from Alfredo Andres Omella, Slay
  &lt;aandres@s21sec.com&gt;</div>
<table class="foot">
  <tr>
    <td class="foot-date">$Date: 2001/02/13 10:51:31 $</td>
    <td class="foot-os">sing v1.1</td>
  </tr>
</table>
</body>
</html>
