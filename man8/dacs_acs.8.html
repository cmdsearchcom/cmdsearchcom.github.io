<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>DACS_ACS(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DACS_ACS(8)</td>
    <td class="head-vol">DACS Web Services Manual</td>
    <td class="head-rtitle">DACS_ACS(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
dacs_acs - <b>DACS</b> access control service
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div class="Pp" style="margin-left: 17.00ex; text-indent: -17.00ex;"><b>dacs_acs</b>
  [ <i></i><b>dacsoptions</b>[1]] [<b>-dcc</b>] [<b>-proxy-static</b>]
  [<b>-proxy-exec</b>]
<div>&#x00A0;</div>
<b>dacs_acs</b><b>-test</b></div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This program is part of the <b>DACS</b> suite.
<div class="Pp"></div>
The <b>DACS</b> access control service, <b>dacs_acs</b> (or simply <b>ACS</b>)
  is responsible for making access control decisions on web service requests. It
  is run by a web server. In the current implementation, <b>dacs_acs</b> is
  executed by the web server as an external program. <b>ACS</b> provides
  attribute- and role-based access control using the <b>DACS</b> rule-processing
  engine, which consults access control rules (also referred to as ACLs)
  provided with <b>DACS</b> or written by a <b>DACS</b> administrator. Because
  access control is performed on URIs, <b>ACS</b> can control access to
  arbitrary resources, such as web pages, files, or programs.
<div class="Pp"></div>
A generic interface to <b>DACS's</b> rule processing engine is given by
  <b>dacscheck(1)</b>[2].
<div class="Pp"></div>
A web server runs <b>dacs_acs</b> to determine whether a particular service
  request is authorized. Although in theory any web server that provides
  appropriate hooks could call <b>dacs_acs</b>, at present only <b>Apache</b>
  2.x and 2.2.x web servers are supported. A <b>DACS</b>-aware <b>Apache</b>
  module called <b>mod_auth_dacs</b>[3] is configured using custom <b>Apache</b>
  directives and runs <b>dacs_acs</b>. A web server having
  <b>mod_auth_dacs</b>[3] functionality is said to be <b>DACS</b>-enhanced and
  web services that are under the control of <b>mod_auth_dacs</b>[3] are said to
  be <b>DACS</b>-wrapped.
<div class="Pp"></div>
When <b>Apache</b> receives a <b>DACS</b>-wrapped service request, the
  <b>mod_auth_dacs</b> module is run, which in turn runs <b>dacs_acs</b> to
  determine whether the request should be granted. The module provides
  <b>dacs_acs</b> with the name of the requested service (&quot;What is being
  accessed?&quot;), parameters that were passed in the request (&quot;How is it
  being accessed?&quot;), the identity of the client (&quot;Who is making the
  request?&quot;), and other context associated with the request. With this
  information at hand, <b>dacs_acs</b> consults a set of access control rules
  (the ruleset) (see <b>dacs.acls(5)</b>[4]). Additional contextual information,
  such as <b>DACS</b> configuration directives and build-time options, and the
  run-time environment, is also available. The information returned by
  <b>dacs_acs</b> to the module either causes <b>Apache</b> to grant permission,
  possibly with a constraint that specifies additional, service-specific
  information, or denies permission, possibly with a reason for denial.
  <b>dacs_acs</b> may also instruct the web server to redirect the client.
<div class="Pp"></div>
All <b>DACS</b> services must be under the control of <b>dacs_acs</b>, even
  those that do not require the client to be authenticated. Also, a web server
  must be configured such that only <b>DACS</b>-controlled services and no other
  services can be invoked through URLs associated with its <b>DACS</b>
  jurisdiction.
<div class="Pp"></div>
It is not a requirement that all of a web server's resources be under the
  control of <b>DACS</b>. That is, it is not necessary to <b>DACS</b>-wrap
  everything, but it is certainly possible.
<div class="Pp"></div>
Please refer to the documentation for <b>mod_auth_dacs</b>[3] for information on
  configuring the <b>DACS</b> <b>Apache</b> module.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
A <b>dacs_acs</b> process, which is created by <b>httpd</b>, should ordinarily
  run as the same user id as <b>httpd</b>. File and directory ownership and
  modes must be set so that it can read its configuration files, access control
  rules, and so on. The <b>DACS</b> expression language includes functions that
  can execute an arbitrary program and perform file system operations, so care
  must be taken to ensure that files used by <b>DACS</b> cannot be edited or
  replaced by non-privileged users. In some circumstances, it may be necessary
  for <b>dacs_acs</b> to run as root, in which case a <b>DACS</b> administrator
  must be extra careful in this regard.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
One way to understand what <b>dacs_acs</b> is doing, or to debug it, is to
  enable the most detailed level of <b>logging</b>[5]. This will emit a copious
  quantity of output to the <b>DACS</b> log file, so be sure to reduce the
  logging level and delete the log file when you are finished.
<div class="Pp"></div>
Setting the <b>LOG_LEVEL</b>[6] directive to &quot;debug&quot; or
  &quot;trace&quot; will produce detailed output (although it can be moderated
  using the <b>LOG_FILTER</b>[7] directive). LOG_LEVEL has the disadvantage that
  it cannot take effect until after configuration processing.
<div class="Pp"></div>
To enable logging output at the earliest possible time, you can add the desired
  <b></b><i>dacsoptions</i>[1] flags to Apache's <b>AddDACSAuth</b>[8]
  directive; for example, by using a directive like the following in httpd.conf:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
AddDACSAuth dacs-acs /usr/local/dacs/bin/dacs_acs &quot;-t -v&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Note that <b>httpd</b> must be restarted before changes to this directive take
  effect.
<div class="Pp"></div>
An alternative method of enabling detailed logging, equivalent to using the
  <b>-t</b> and <b>-v</b> flags if neither has been specified, is to create a
  file in the <b>DACS_HOME</b>[9] directory with the name debug_
  <i>progname</i>. For example, to enable detailed logging for <b>dacs_acs</b>,
  the following command might be used:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% touch /usr/local/dacs/debug_dacs_acs
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
This method takes effect immediately and applies to any <b>DACS</b> web service
  or command that accepts <b></b><i>dacsoptions</i>[1] at the time they begin
  execution. It overrides the current value of LOG_LEVEL, is more selective
  because it applies only to <i>progname</i> (unlike LOG_LEVEL), is easily
  turned on by creating the file and turned off by removing the file, and
  neither requires changes to httpd.conf nor an <b>httpd</b> restart.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<h2 class="Ss" title="Ss" id="Module-to-ACS_Protocol"><a class="selflink" href="#Module-to-ACS_Protocol">Module-to-ACS
  Protocol</a></h2>
<b>DACS</b>'s <b>mod_auth_dacs</b>[3] module for <b>Apache</b> invokes the
  <b>dacs_acs</b> program to do the hard part of deciding whether a request
  should be granted or denied. The module is responsible for configuring itself
  using new <b>Apache</b> directives, gathering information required to make the
  access control decision, passing that information to <b>dacs_acs</b>, and
  receiving the access control decision from <b>dacs_acs</b>, together with
  either environment information (if access is granted to an executable request)
  or error handling directives (if access is denied).
<div class="Pp"></div>
To prevent potentially sensitive information from becoming visible,
  <b>mod_auth_dacs</b>[3] passes information to <b>dacs_acs</b> over an
  interprocess communication channel ( <b>pipe(2)</b>[10]). <b>dacs_acs</b>
  reads its standard input, makes the access control decision, and writes either
  environment information or an optional error handling directive to its
  standard output. The exit status of <b>dacs_acs</b> communicates its decision:
  zero means the request should be granted, anything else means the request
  should be denied.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Important</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The module provides <b>dacs_acs</b> with its <b>DACS</b> version number to
  ensure that it is compatible. <b>dacs_acs</b> will deny all access to
  <b>DACS</b>-wrapped resources if its version number does not exactly match the
  module's. This requirement helps to protect against build or installation
  mistakes.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
The information passed <i>to</i> <b>dacs_acs</b> <i>from</i> <b>Apache</b> is in
  the format:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
<i>variable-name</i>=&quot;<i>variable-value</i>&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
each of which is terminated by a newline character. These variables are listed
  below. For details about how to reference these values, see <b>Variables
  Available To Rules</b>[11].
<div class="Pp"></div>
<i>SERVICE_ARGS</i>
<div style="margin-left: 4.00ex;">The query arguments (if any and whether GET or
  POST method is being used) followed by POST arguments (if any and to the
  maximum length configured), base-64 encoded.</div>
<div class="Pp"></div>
<i>SERVICE_ARGS_TRUNCATED</i>
<div style="margin-left: 4.00ex;">For POST method requests, if the POST data
  stream (i.e., the request's entity-body) was not completely captured, such as
  if the maximum length was reached, this variable will be present and assigned
  the value 1.</div>
<div class="Pp"></div>
<i>SERVICE_AUTHORIZATION</i>
<div style="margin-left: 4.00ex;">The value of the Authorization HTTP header
  field, if present.</div>
<div class="Pp"></div>
<i>SERVICE_CONTENT_ENCODING</i>
<div style="margin-left: 4.00ex;">The value of the Content-Encoding HTTP header
  field, if present.</div>
<div class="Pp"></div>
<i>SERVICE_CONTENT_LENGTH</i>
<div style="margin-left: 4.00ex;">The value of the Content-Length HTTP header
  field, if present.</div>
<div class="Pp"></div>
<i>SERVICE_CONTENT_TYPE</i>
<div style="margin-left: 4.00ex;">The value of the Content-Type HTTP header
  field, if present.</div>
<div class="Pp"></div>
<i>SERVICE_COOKIE</i>
<div style="margin-left: 4.00ex;">The value of the Cookie HTTP header field, if
  present.</div>
<div class="Pp"></div>
<i>SERVICE_FILENAME</i>
<div style="margin-left: 4.00ex;">The name of the file, as determined by
  <b>Apache</b>, corresponding to this response.</div>
<div class="Pp"></div>
<i>SERVICE_HOSTNAME</i>
<div style="margin-left: 4.00ex;">The name of the host as set by the full URI or
  Host HTTP header field, as determined by <b>Apache</b>.</div>
<div class="Pp"></div>
<i>SERVICE_HTTPS</i>
<div style="margin-left: 4.00ex;">If the request came over SSL/TLS (HTTPS), this
  variable will be present and set to &quot;on&quot;.</div>
<div class="Pp"></div>
<i>SERVICE_METHOD</i>
<div style="margin-left: 4.00ex;">The request method, as set by <b>Apache</b>
  (e.g., &quot;GET&quot;).</div>
<div class="Pp"></div>
<i>SERVICE_MOD_AUTH_DACS_VERSION</i>
<div style="margin-left: 4.00ex;">The DACS version number string associated with
  the <b>mod_auth_dacs</b>[3] module.</div>
<div class="Pp"></div>
<i>SERVICE_PATH_INFO</i>
<div style="margin-left: 4.00ex;">The <b>PATH_INFO</b> part of the URI, as set
  by <b>Apache</b>.</div>
<div class="Pp"></div>
<i>SERVICE_POSTDATA</i>
<div style="margin-left: 4.00ex;">When available, the POST data stream (the HTTP
  message body) (or part of it: see the description of the SetDACSAuthPostBuffer
  directive to <b>mod_auth_dacs</b>[12]). It is MIME base-64 encoded.</div>
<div class="Pp"></div>
<i>SERVICE_PROXY_AUTH</i>
<div style="margin-left: 4.00ex;">The value of the DACS-Proxy-Authorization HTTP
  header field, if present. (Not currently used).</div>
<div class="Pp"></div>
<i>SERVICE_PROXYREQ</i>
<div style="margin-left: 4.00ex;">If the current request involves proxy
  processing on this server, this identifies the type of processing as
  &quot;proxy&quot; (for &quot;forward proxying&quot;),
  &quot;proxy_reverse&quot; (for &quot;reverse proxying&quot;), or
  &quot;proxy_response&quot;.</div>
<div class="Pp"></div>
<i>SERVICE_QUERY</i>
<div style="margin-left: 4.00ex;">The value of the query string component of the
  URI.</div>
<div class="Pp"></div>
<i>SERVICE_REMOTE_ADDR</i>
<div style="margin-left: 4.00ex;">The client's IP address.</div>
<div class="Pp"></div>
<i>SERVICE_REMOTE_HOST</i>
<div style="margin-left: 4.00ex;">The client's DNS name, if known by
  <b>Apache</b>.</div>
<div class="Pp"></div>
<i>SERVICE_SERVER_PORT</i>
<div style="margin-left: 4.00ex;">The TCP/IP port on which the request was
  received by <b>Apache</b>.</div>
<div class="Pp"></div>
<i>SERVICE_URI</i>
<div style="margin-left: 4.00ex;">The path portion of the URI, as determined by
  <b>Apache</b>.</div>
<div class="Pp"></div>
<i>SERVICE_USER_AGENT</i>
<div style="margin-left: 4.00ex;">The value of the User-Agent HTTP header field,
  if present.</div>
<div class="Pp"></div>
If access is granted, <b>dacs_acs</b> may provide a set of control directives
  for <b>mod_auth_dacs</b>[3] to interpret, followed by a set of environment
  variables for <b>mod_auth_dacs</b>[3] to introduce into the environment of an
  executable request. Each control directive starts with a &quot;=&quot;
  character and is terminated by a newline. Environment variables are specified
  in the format:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
<i>variable-name</i>=<i>variable-value</i>
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
each of which is terminated by a newline character.
<div class="Pp"></div>
If access is denied, <b>dacs_acs</b> may instead provide an error handling
  directive, newline terminated, in the form expected as the third argument to
  <b>Apache</b>'s <b>ap_custom_response()</b> function.
<h2 class="Ss" title="Ss" id="Credentials"><a class="selflink" href="#Credentials">Credentials</a></h2>
<b>DACS</b> credentials can be passed to <b>dacs_acs</b> in several ways, but
  they have the following representation:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
DACS: <i>federation-name</i>::[<i>jurisdiction-name</i>]:[<i>username</i>]=<i>value</i>[; ...]
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
If the <i>jurisdiction-name</i> is omitted, the <i>username</i> must also be
  omitted (see <b>COOKIE_NAME_TERMINATORS</b>[13]). The string is URL encoded.
  If there are multiple credentials, they are separated by any combination of
  spaces and &quot;;&quot; characters.
<div class="Pp"></div>
Credentials are passed from <b>mod_auth_dacs</b>[3] to <b>dacs_acs</b> using the
  <i>SERVICE_COOKIE</i> variable (transmitted over a <b>pipe(2)</b>[10])
<div class="Pp"></div>
Because a process's environment is public on some systems, <b>DACS</b> takes
  care not to pass credentials using environment variables. Passing credentials
  through the <b>HTTP_COOKIE</b> environment variable is forbidden unless
  enabled by the <b>ALLOW_HTTP_COOKIE</b>[14] directive. When specifically
  enabled by a rule's attribute, they can be passed using the <b>DACS_COOKIE</b>
  environment variable (see the pass_credentials attribute described in
  <b>dacs.acls(5)</b>[4]).
<div class="Pp"></div>
If an HTTP Authorization header is used with the &quot;DACS&quot; authentication
  scheme, the &quot;basic-credentials&quot; component of the header may contain
  <b>DACS</b> credentials. Please refer to <b>RFC 2617</b>[15]. These
  credentials have the format given above but are also base-64 encoded.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
It is forbidden to submit multiple credentials for the same identity to
  <b>DACS</b> and such a request will trigger an error.
<div class="Pp"></div>
It is also forbidden to submit multiple <b>DACS</b> authentication cookies with
  the same cookie name.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
Please refer to <b>dacs_authenticate(8)</b>[16] for additional information.
<h2 class="Ss" title="Ss" id="Rlinks"><a class="selflink" href="#Rlinks">Rlinks</a></h2>
<b>DACS</b> provides an alternate authentication and authorization mechanism. An
  Rlink (rule link) is a special URL that includes an Rname component, which is
  essentially the name of an access control rule. Instead of matching the name
  of a requested resource against rules, as is normally done by <b>DACS</b>, the
  request itself (indirectly) specifies authorization constraints that
  <b>DACS</b> must apply to the request. Optionally, a <b>DACS</b> identity and
  other information can be included in the Rlink.
<div class="Pp"></div>
During authorization processing, the Rname is resolved to an access control rule
  that is processed the same as any other access control rule and the requested
  resource must be <b>DACS</b>-wrapped. In other words, a request that is
  recognized as an Rlink essentially says &quot;use the rule identified by this
  request's Rname to decide whether or not to grant access and do not consider
  any other rule&quot;. Subsequent access control processing is identical to the
  normal case.
<div class="Pp"></div>
In typical usage, an Rlink is created (probably, but not necessarily by
  <b>dacsrlink(1)</b>[17]) and the resulting URL is distributed (e.g., by email)
  to those parties intended to be able to access the resource. Similar
  mechanisms are widely used by web-based applications. For example, consider
  the case where a customer has purchased a digital resource and it is time to
  make the item (e.g., a file) available for downloading. A new Rlink is created
  for the item and given to the customer. The customer invokes the URL to obtain
  the item. Each customer receives a unique Rlink but there only needs to be one
  instance of the resource. Only those with a valid Rlink can access the
  resource. No traditional account needs to be created for the customer, and the
  Rlink does not authorize the customer to access any other secure resource.
  When the resource has been accessed, a log record will be created that
  identifies the customer and confirms the download.
<div class="Pp"></div>
The main advantage of Rlinks is that they make controlled file sharing and web
  service access simple. An Rlink is created and disseminated, and all
  recipients can access the named resource (subject to the Rlink's rule) using
  any web browser. Any number of different rules can be created for the same
  resource, with each one having a different Rname. An Rlink's rule can be
  changed or deleted by its owner at any time, even after it has been
  distributed.
<div class="Pp"></div>
Rlinks also offer an alternative way to make exceptions to the rule normally
  applicable. Rather than revising the &quot;normal&quot; rule for a resource or
  set of resources to take account for the exceptions, one or more Rlinks can be
  created to handle the special cases and the normal rules need not be touched.
<div class="Pp"></div>
Another application of Rlinks is as a short representation of an arbitrary URL.
  Someone accessing an Rlink that has been configured in this way is redirected
  to a specified URL; see the <b>redirect()</b>[18] function. The URL can be
  changed at will simply by editing the Rlink's rule. The Rlink need not be kept
  secret when it is used for this purpose.
<div class="Pp"></div>
The main disadvantage of Rlinks is that security may rely on keeping Rnames
  secret, and because an Rlink may be visible in a URL, this can be difficult to
  keep up. Anyone who can capture an Rname and use it properly with a resource
  to which it applies can potentially gain access to that resource. An Rname
  might be found in a log file, or in a browser's history or bookmark list.
  Although this method is convenient for users, the requirement for secrecy
  means that it might not be appropriate in some situations. At the expense of
  some convenience, however, a password can be bound to an Rlink when it is
  created; for the Rlink to be valid when it is invoked, the same password must
  be presented as an argument. Furthermore, because the access control rule
  associated with an Rname is the same as any other rule, it may express any
  conditions it likes, so it can still require authentication to have been
  performed, restrict the user's IP address, and so on. Also, an Rlink cannot be
  used to gain access to a resource that is not described by its rule's services
  element.
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>Rlink Details</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
When an Rlink is used as a kind of &quot;secret URL&quot; that grants access to
  anyone who uses it, an Rname is a randomly generated identifier that is
  unique, with very high probability, relative to its namespace at a
  jurisdiction. By default, an Rname consists of eight symbols from the set of
  upper- and lower-case alphabetics and digits, yielding a namespace in excess
  of 10^14 identifiers. This makes guessing a valid Rname highly unlikely. The
  characteristics of new Rnames can be changed at will; the alphabet from which
  they are generated should be considered carefully, however, to avoid problems
  that might arise when they are embedded within a URL or used as a filename.
  <b>RLINK</b>[19] directives can map Rnames to the same or different
  namespaces, depending on the filestore selected by a directive.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
An Rlink does not have to be used as a secret URL though, and its creator can
  choose any Rname that will work with the mechanism described here.
<div class="Pp"></div>
If a rule contains the optional name attribute, the attribute value must exactly
  match the Rname.
<div class="Pp"></div>
The base name of a file containing an Rlink will be its Rname. This naming
  scheme is different from <b>the one used for normal rules</b>[20].
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
This feature allows multiple versions of an Rlink to be created, each bound to a
  different identity. By attaching an identity to an Rlink, its creator can
  confer different rights to different users, or simply track who has used the
  Rlink. These identities may or may not correspond to &quot;real&quot;
  identities that are associated with <b>DACS</b> authentication (i.e., there
  may or may not be an account associated with them); <b>DACS</b> administrators
  should keep this mind to avoid any confusion.
<div class="Pp"></div>
An Rname may be followed by a suffix that directly or indirectly associates a
  <b>DACS</b> identity with the Rlink. For want of a better name, this composite
  identifier is called an RnameIdent and has the following syntax:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
   <i>RnameIdent</i>  -&gt; <i>Rname</i> ':' <i>ident</i> | <i>Rname</i> ';' <i>iptr</i>
</pre>
</div>
<div class="Pp"></div>
In the <i>direct</i> mode of identity attachment, the Rname is followed by a
  separator (a colon, which cannot appear in an Rname) and <i>ident</i>, a
  cryptographically protected and base-64 encoded <b>concise user
  identity</b>[21] that is created by <b>dacsrlink(1)</b>[17]. These encrypted
  identities are <i>not</i> the same as encrypted credentials. Different
  encrypted identifiers may represent exactly the same identity. If <b>DACS</b>
  recognizes the Rname, when it performs authorization checking it will do so
  assuming the specified identity, <i>ignoring any other credentials that might
  have accompanied the request</i>.
<div class="Pp"></div>
In the <i>indirect</i> mode, the Rname is followed by a different separator (a
  semi-colon, which cannot appear in an Rname) and an arbitrary string, called
  an <i>iptr</i> (identity pointer) that is safe to embed in a URI. The same
  character set from which an Rname can be generated is safe for an <i>iptr</i>:
  any number of alphanumerics, hyphens, and underscores. The rule that is
  specified by the Rname is expected to map the string to an identity, probably
  by using the <b>identity element</b>[22], and the identity is used in the same
  way as in the direct mode. Like an Rname, in typical usage an <i>iptr</i> must
  be difficult to guess and be kept secret, otherwise a valid Rlink might easily
  be constructed that is associated with a chosen identity. The indirect mode
  has the advantages of keeping the URL relatively short, is immune to changes
  of the encryption key, and allows identities to be modified after an Rlink is
  shared.
<div class="Pp"></div>
An identity obtained using either attachment mode is tested for revocation.
<div class="Pp"></div>
The Rname, specified identity, and identity pointer are accessible in the
  <b></b> <i>DACS</i> namespace[11], when they are available, as
  <i>${DACS::RNAME}</i>, <i>${DACS::RIDENT}</i>, and <i>${DACS::RIPTR}</i>,
  respectively.
<div class="Pp"></div>
Rlinks can easily be created manually or by a custom program, but the
  <b>dacsrlink(1)</b>[17] utility provides a simple interface to create and
  administer them. Rules created by <b>dacsrlink</b> can be manually edited and
  deleted just like any other rule. There is no <i>a priori</i> limit on the
  lifetime of an Rlink; it continues to exist as far as <b>DACS</b> is concerned
  if the Rname is recognized by an RLINK directive and the named rule exists and
  is valid. Deleting the rule corresponding to an Rname effectively invalidates
  that Rlink.
<div class="Pp"></div>
An Rname can be presented as an ordinary web service argument, as a component of
  the request URI, or via the special <b>DACS_ACS argument</b>[23]:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
https://example.com/~alice/photos/myphoto.gif?RNAME=jigrFUwF
https://example.com/cgi-bin/manage.cgi/jigrFUwF
https://example.com/private/data?DACS_ACS=-rname+jigrFUwF
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Each of these approaches has advantages and disadvantages; the best choice
  depends on web site and application details. For example, embedding an Rname
  as a component of a URI is particularly well suited to CGI programs and web
  services (e.g., https://example.com/cgi-bin/manage/jigrFUwF, where manage is
  the name of the program). Using the <i>DACS_ACS</i> argument allows the Rname
  to be used during access control testing but completely hidden from the
  requested resource.
<div class="Pp"></div>
<b>RLINK</b>[19] directives are used to examine an incoming request, decide
  whether an Rname is present, extract the Rname, and specify where the rule can
  be found. If an Rname is present, normal access control processing is disabled
  and no search of the usual <b>DACS</b> rulesets for an applicable rule occurs.
  If no RLINK directive finds an Rname, normal access control processing
  occurs.</div>
<h2 class="Ss" title="Ss" id="HTTP_Authentication"><a class="selflink" href="#HTTP_Authentication">HTTP
  Authentication</a></h2>
<b>dacs_acs</b> can be configured to trigger HTTP authentication (see <b>RFC
  2617</b>[15]) by returning a WWW-Authenticate response header in certain
  circumstances. This will usually cause a browser or other web user agent to
  use its built-in mechanism for prompting the user for a username and password
  that corresponds to a particular access realm (a label that identifies a URL
  path prefix belonging to the server).
<div class="Pp"></div>
If <b>dacs_acs</b> denies access because the user is not authenticated (code
  <b>902</b>, ACS_DENIAL_REASON_NO_AUTH), it checks to see if HTTP
  authentication has been enabled for the request. If not, processing of the
  denied request proceeds normally, otherwise <b>DACS</b> will try to use the
  <b>RFC 2617</b>[15] protocol to have <b>dacs_authenticate</b> authenticate the
  user.
<div class="Pp"></div>
Also see <b>autologin(8)</b>[24].
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
This feature is configured through the <b>HTTP_AUTH_ENABLE</b>[25] and
  <b>HTTP_AUTH</b>[26] directives, some configuration variables, and <b>Auth
  clause directives</b>[27]. Please refer to them for details.
<div class="Pp"></div>
When HTTP authentication is triggered in this way, <i>no extra
  </i><i></i><b>Apache</b> <i> configuration needs to be done or should be
  done</i>. All that is required of <b>Apache</b> is that the resource that
  should trigger authentication be <b>DACS</b>-wrapped.
<div class="Pp"></div>
<i>Any</i> password style authentication module, or the CAS authentication
  module, can be configured in conjunction with <b>DACS's</b> HTTP Basic
  authentication ( <b>RFC 2617</b>[15]). That is, <b>DACS</b> can be configured
  to cause a browser to pop-up a username/password prompt and then use the
  values supplied by the user as if they were the <i>USERNAME</i> and
  <i>PASSWORD</i> arguments to <b>dacs_authenticate</b>. The authentication
  module on the backend of the authentication procedure can use any type of
  <b>Apache</b> password file or <b>DACS</b> password file, NTLM, CAS, etc.
<div class="Pp"></div>
Besides authenticating against an <b>Apache</b> password file created by
  <b>htpasswd</b>, <b>htdigest</b>, or <b>htdbm</b>, this means that an ordinary
  browser can be used to capture a username and password for any <b>DACS</b>
  authentication module that requires it. Please refer to the description of the
  <b>local_apache_authenticate</b>[28] module for details.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
If the feature is enabled and applies to a request:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 1.any <b>ACS_ERROR_HANDLER</b>[29],
  <b>AUTH_SUCCESS_HANDLER</b>[30], and <b>AUTH_ERROR_HANDLER</b>[31] directives
  that would ordinarily apply are overridden.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 2.the <b>HTTP_AUTH</b>[26] directive that
  applies to the request specifies the authentication scheme, realm, and any
  additional authentication parameters.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 3.a WWW-Authenticate response header is
  returned to the browser. For example, for HTTP Basic authentication this
  header might look like:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
WWW-Authenticate: Basic realm=&quot;My Realm&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 4.an HTTP status value of <b>401</b> ( <b>RFC
  2616</b>[32]) is returned. If the variable <i>${Conf::http_auth_message}</i>
  is defined, its value is used as the message body; if it is &quot;&quot;, then
  no message body will be sent; if not provided, the string &quot;902
  Authentication by DACS is required&quot; is used.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 5.if the variable
  <i>${Conf::http_auth_jurisdiction}</i> is configured, it is expected to be the
  name of the jurisdiction (within the current federation) at which
  <b>dacs_authenticate</b> is to be invoked to authenticate the user; if the
  variable is undefined, the name of the current jurisdiction is used.</div>
<div class="Pp"></div>
The values of some of these variables are neither examined by <b>DACS</b> nor
  meaningful to it. For example, all that <b>DACS</b> requires of the realm
  string is that it be syntactically valid.
<div class="Pp"></div>
When enabled, the following flow of control occurs:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 1.The user hits a <b>DACS</b>-wrapped URL
  when not authenticated; if <b>dacs_acs</b> is configured to perform HTTP
  authentication for the request, it returns a <b>401</b>
  (&quot;Unauthorized&quot;) status code and a WWW-Authenticate header;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 2.The browser prompts for a username and
  password; the user enters the information and the browser re-submits the
  request, which this time includes an Authorization header;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 3.<b>dacs_acs</b> again denies the request
  because the user is not authenticated, but sees an Authorization header and
  redirects the user to <b>dacs_authenticate</b> (at
  <i>${Conf::http_auth_jurisdiction}</i> or the current jurisdiction) with
  arguments necessary for the selected authentication scheme;
  <b>dacs_authenticate</b> maps the given username (and password, if available)
  to the <i>USERNAME</i> argument (and possibly the <i>PASSWORD</i> argument)
  and invokes authentication modules as necessary;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 4.If authentication succeeds, credentials are
  issued and the user is redirected to the original request (via the GET
  method);</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 5.If authentication fails, the procedure is
  repeated from the beginning.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Important</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The main advantages of HTTP Basic and Digest authentication ( <b>RFC
  2617</b>[15]) are its simplicity and near-universal support. It does have some
  serious drawbacks compared to a cookie-based (token) implementation, however.
  Here are a few:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;While various kludges exist, there is
  no standard way to de-authenticate, to tell a client to stop sending an
  Authorization request header. Consequently, if a user that has authenticated
  using HTTP Basic authentication signs out of <b>DACS</b> and in the same
  browser session visits a link that triggers authentication, <b>DACS</b>
  credentials may be automatically re-issued without prompting.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;In HTTP Basic authentication, there
  are more opportunities for an attacker to capture a username and password, on
  the client side (which must cache both parameters indefinitely), at a web
  server, or at a proxy server, even when SSL/TLS is used.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Any method can be used by a web server
  to validate a username and password. In the common HTTP Basic authentication
  deployment, the web server must validate the Authorization request header
  <i>each time</i> it is sent by a client, perhaps with every request, meaning
  that an expensive authentication function may need to be executed many times
  with exactly the same parameters during a particular session.</div>
<div class="Pp"></div>
With Digest authentication, various aspects of the authentication protocol are
  subject to time limits as a security measure. The configuration variable
  <i>${Conf::http_auth_timeout_secs}</i> can be set to the number of seconds for
  which a nonce is valid, thereby overriding the default; only advanced
  administrators familiar with <b>RFC 2617</b>[15] should change the default.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
The following is an example of configuration that might appear in the
  appropriate section (or sections) in <b>DACS</b> configuration files:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
HTTP_AUTH_ENABLE &quot;yes&quot;
HTTP_AUTH &quot;Basic \&quot;Doggies\&quot; /basic/*&quot;
<div class="Pp"></div>
EVAL ${Conf::http_auth_message} = \
  &quot;902 https://example.com/cgi-bin/dacs/dacs_authenticate&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Given this example configuration, whenever access is denied for a resource
  having a URL path that begins with &quot;/basic/&quot; because the user is not
  authenticated, the following response-headers will be returned:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
WWW-Authenticate: Basic realm=&quot;Doggies&quot;
Status: 401
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
and the message body will contain the single line:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
902 https://example.com/cgi-bin/dacs/dacs_authenticate
</pre>
</div>
<div class="Pp"></div>
Instead of enabling the feature for <i>all</i> requests, the following example
  enables it only for those user agents that supply a User-Agent request-header
  that matches the regular expression &quot;DACS-http/.*&quot; (which happens to
  match the default User-Agent string sent by the <b>DACS</b>
  <b>dacshttp(1)</b>[33] utility).
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
HTTP_AUTH_ENABLE = regmatch(&quot;${DACS::USER_AGENT}&quot;, &quot;DACS-http/.*&quot;) ? &quot;yes&quot; : &quot;no&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
A similar expression would enable the feature only for <b>Internet Explorer</b>,
  <b>Mozilla</b>, <b>curl</b>, <b>dacshttp(1)</b>[33], etc., or some combination
  of browsers. Simply obtain the User-Agent string(s) sent by the browser(s) and
  write the appropriate regular expression to match it/them.
<div class="Pp"></div>
Although <b>RFC 2617</b>[15] allows multiple WWW-Authenticate response-headers
  to be returned, this mechanism can only send one.
<div class="Pp"></div>
When provided by a user agent, <b>dacs_acs</b> makes the value of the
  Authorization request-header available to access control rules through the
  <i>${DACS::AUTHORIZATION}</i> variable. <b>DACS</b> credentials can also be
  <b>passed using this request-header</b>[34].
<h2 class="Ss" title="Ss" id="Authorization_Caching"><a class="selflink" href="#Authorization_Caching">Authorization
  Caching</a></h2>
After a rule grants access, <b>dacs_acs</b> can be configured to save some
  context about its access control decision so that if the user makes a
  subsequent request for a resource managed by the same rule in a similar
  context, authorization can be granted quickly and without having to search for
  the applicable rule or re-evaluate it. Basically, the administrator tells
  <b>DACS</b> that if the rule grants access to a particular user, then it is
  safe for <b>DACS</b> to assume that future requests for the same resource by
  the same user should be granted without doing a complete authorization check.
<div class="Pp"></div>
This mechanism offers improved performance in cases where:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;users tend to make many requests for
  the same resource, or for a set of resources that are managed by the same rule
  (such as CSS files or images);</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;rule evaluation is relatively slow or
  expensive;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;there are a large number of rules
  and/or rule retrieval is relatively slow;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;re-evaluation of the rule is
  unnecessary (e.g., the rule does not update any state information)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;it is acceptable for changes to the
  ruleset to not immediately affect cachable decisions</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
Pending further testing, this feature should be considered experimental. Use it
  in production situations only after you have satisfied yourself that it is
  working properly with your access control rules.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
Authorization caching is implemented using a special HTTP cookie, called an
  access token (not related to the tokens used in authentication), and a simple
  database maintained by <b>dacs_acs</b>. A cookie is returned to the user when
  caching is possible and the user does not already possess a valid cookie. An
  access token points to server-side data that describes the cached
  authorization, including the context in which it is valid. Immediately after
  revocation testing, <b>dacs_acs</b> checks if authorization caching applies to
  the current request; if it does, no access control rules are examined and
  access is immediately granted. If caching does not apply, processing continues
  as usual. If any invalid access tokens were sent with the request,
  <b>dacs_acs</b> will ask for them to be deleted (i.e., it unsets the cookies).
  These cookies have the following format:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
DACS: <i>federation-name</i>::<i>jurisdiction-name</i>::TOKEN-<i>unique</i>
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Here, <i>unique</i> is the &quot;dacs64&quot; encoding (see
  <b>dacs.exprs(5)</b>[35]) of a cryptographically strong pseudo-random 16 byte
  value. Also see the <b>COOKIE_NAME_TERMINATORS</b>[13] directive. Since access
  control is purely a jurisdictional responsibility in <b>DACS</b>, a cookie is
  meaningful only to the jurisdiction that issues it.
<div class="Pp"></div>
These cookies are non-persistent (they are supposed to disappear when a browser
  session ends). The value of <b>COOKIE_PATH</b>[36], or &quot;/&quot;,
  determines the cookie's path attribute. The <b>COOKIE_NO_DOMAIN</b>[37] and
  <b>COOKIE_HTTP_ONLY</b>[38] directives are also honoured.
<div class="Pp"></div>
Here is a simple example of how <b>DACS</b> might be configured to enable
  authorization caching for a particular resource. The jurisdiction's dacs.conf
  would include directives similar to the following:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
ACS_ACCESS_TOKEN_ENABLE        &quot;yes&quot;
ACS_ACCESS_TOKEN_LIFETIME_SECS &quot;43200&quot;
VFS                            &quot;[tokens]dacs-kwv-fs:/usr/local/dacs/conf/tokens&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
A rule for the resource might look like this:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;acl_rule status=&quot;enabled&quot;&gt;
   &lt;services&gt;
     &lt;service url_pattern=&quot;/cgi-bin/database.cgi&quot;/&gt;
     &lt;service url_pattern=&quot;/cgi-bin/someprog.cgi&quot;/&gt;
   &lt;/services&gt;
      
   &lt;rule order=&quot;allow,deny&quot;&gt;
     &lt;allow permit_caching=&quot;yes&quot;&gt;
       user(&quot;auth&quot;)
     &lt;/allow&gt;
   &lt;/rule&gt;
&lt;/acl_rule&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Given this configuration, the first time an authenticated user requests, say,
  https://example.com/cgi-bin/database.cgi, he will be issued an access token.
  This token will be valid for up to 12 hours, and its associated data will be
  stored as an entry in the file /usr/local/dacs/conf/tokens.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
In the current implementation, each access token is contained within its own
  cookie, rather than a jurisdiction collecting all of the user's tokens within
  a single cookie. A user might therefore simultaneously hold many access tokens
  from each jurisdiction. This should not be significant for middleware agents,
  but web browsers typically impose various kinds of limits on cookie &quot;real
  estate&quot;. Administrators should take this into account when using this
  feature.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
Before it can be used, <b>DACS</b> must be built with the feature enabled (see
  <b>--enable-access-tokens</b> in <b>dacs.install(7)</b>[39]). The virtual
  filestore item type &quot;tokens&quot; must be configured to identify an
  indexed virtual storage method and location for storing cache entries. Also,
  the authorization caching mechanism must be configured (see
  <b>ACS_ACCESS_TOKEN_ENABLE</b>[40],
  <b>ACS_ACCESS_TOKEN_LIFETIME_LIMIT</b>[41], and
  <b>ACS_ACCESS_TOKEN_LIFETIME_SECS</b>[42]).
<div class="Pp"></div>
Enabling the feature in a particular context also requires setting a rule's
  permit_caching attribute to &quot;yes&quot; (see <b>dacs.acls(5)</b>[43]).
  Whenever access is granted because of the rule, authorization caching of the
  rule is possible.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
Only the url_pattern of the rule's matching Service element (or the path derived
  from a url_expr attribute) is associated with the access token. This implies
  that when a rule has more than one service element, as in the example rule
  above, a single access token would be associated with only one of the two
  resources. Requests for different services could result in multiple access
  tokens being returned to a user, one for each service. A wildcard pattern is
  required if an access token is intended to grant access to more than one
  resource (this restriction may be lifted in future releases).
<div class="Pp"></div>
Although a service request's arguments may be significant when initially
  granting access, they are not significant with respect to authorization
  caching applied to subsequent requests that use the access token. Once an
  access token is issued, the resource or resources named by it may therefore be
  invoked with different arguments without negating authorization caching.
<div class="Pp"></div>
If any constraint, permit_chaining pass_credentials, or pass_http_cookie
  attributes are associated with the cachable rule, their values are also
  remembered and set if the access token subsequently causes access to be
  granted.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
Authorization caching is possible irrespective of whether a user has been
  authenticated. Caching is not allowed, however, in cases where the granting
  rule uses <b>tail matching</b>[44] <i>and</i> a rule exists for a subordinate
  URL (i.e., where there is a &quot;more specific&quot; rule for some other
  resource that should not be overridden by caching the &quot;more general&quot;
  rule). These cases are simply ignored; they are not considered to be errors.
  It is therefore not possible to cache the outcome of a rule with a url_pattern
  of &quot;/*&quot;, for example, unless it is the only rule in the ruleset.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
A positive result will be cached regardless of whether the requested resource
  actually exists or is subsequently processed without error by the web server.
  It is therefore possible for an access token to be issued for a resource that
  does not exist at the time of issue but which is created at some later time.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
The store of tokens may be deleted or modified at any time. Any access token
  that points to an invalid or missing entry in the store becomes invalid.
<div class="Pp"></div>
Over time, the server-side access token database tends to accumulate entries for
  access tokens that no longer exist or have expired. These should be garbage
  collected. (This is currently not automated, so the database needs to be
  truncated. There should also be way to list the entries and manually delete
  entries.) The <b>dacsacl(1)</b>[45] command and <b>dacs_admin(8)</b>[46]
  service can perform administrative functions on the entry database.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
Access tokens are created and used in such a way that it is practically
  impossible for an attacker to manufacture a valid access token or to convert
  an access token valid for one resource into one valid for a different
  resource.
<div class="Pp"></div>
If a user is authenticated at the time an access token is generated, the token
  is &quot;tied&quot; to those credentials (all of them) and becomes invalid if
  any of the credentials become invalid or are not sent with the access token.
  If a user signs out or reauthenticates after being issued an access token,
  therefore, the access token will become invalid. Additional credentials,
  beyond what were present at the time an access token was generated, have no
  effect in this regard.
<div class="Pp"></div>
As with cookies bearing <b>DACS</b> credentials, cookies containing access
  tokens must be kept private. For an authenticated user, an attacker would need
  to acquire an access token <i>and all credentials</i> to make use of the
  token. For an unauthenticated user, only the access token is needed;
  presumably (but not necessarily) in this case a lower level of security is
  being applied to the resource in any case.
<div class="Pp"></div>
It is the administrator's responsibility to ensure that authorization caching
  does not break the intended semantics of a rule - <b>DACS</b> does not do any
  consistency or sanity checks. For instance, if a rule is written to grant
  access only between 12:00 and 12:59 but an access token produced by the rule
  could continue to be valid beyond that time interval, authorization caching
  could violate the intent of the rule. Also, a rule that ordinarily produces
  side effects would not do so for any requests granted through authorization
  caching.
<div class="Pp"></div>
As long as an authorization decision remains valid, changes to the ruleset will
  not cause a cached decision to be reversed. That is, a change to the ruleset
  that would ordinarily cause a request to be denied will have no effect on a
  cached decision. The <b>revocation list</b>[47] is, however, processed as
  usual, so it is possible for a cached decision to be denied due to revocation.
  An error encountered during processing would also cause access to be denied,
  regardless of authorization caching.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<h2 class="Ss" title="Ss" id="XML_Output"><a class="selflink" href="#XML_Output">XML
  Output</a></h2>
When XML output has been enabled, <b>dacs_acs</b> will emit a document
  (conforming to <b>dacs_acs.dtd</b>[48]) when access is denied, a processing
  error occurs, or when an access testing mode has been requested using the
  <i>DACS_ACS</i> argument.
<div class="Pp"></div>
<b>dacs_acs</b> associates an error code with each event or reason for which
  access might be denied (see the description of the ACS_ERROR_HANDLER directive
  in <b>dacs.conf(5)</b>[49]). The error code is itself sufficient for a client
  to know why access was denied. When access is denied, an appropriately named
  XML element is emitted. The element will include an explanatory text message,
  and optionally, the URI of a handler that the client might call to continue
  the workflow. This URI is obtained from the applicable ACS_ERROR_HANDLER
  directive, if any.
<div class="Pp"></div>
The event905 element corresponds to the ACK_NEEDED (equivalent to error code
  <b>905</b>) <b>DACS</b> error event. It is emitted if the client must
  acknowledge one or more notices before the request will be granted. Its
  handler attributes, which are optional, are obtained from the
  ACS_ERROR_HANDLER directive that applies to this error and the
  NOTICES_ACK_HANDLER directive. If the ack_handler attribute is absent, then
  the presentation_handler is expected to perform both presentation and
  acknowledgement handling functions. The notice_uris attribute is a
  comma-separated list of URIs of notices that must be acknowledged by the user.
  The resource_uris attribute is a comma-separated list of URIs of resources
  associated with this request; this will usually be only a single URI. The time
  and hmac attributes are used to enforce a secure workflow mode. Please refer
  to <b>dacs_notices(8)</b>[50] and <b>dacs.conf(5)</b>[49] for additional
  detail.
<div class="Pp"></div>
A common_status element indicates that <b>dacs_acs</b> could not process the
  request. This might happen, for example, if <b>dacs_acs</b> were not properly
  configured.
<h2 class="Ss" title="Ss" id="Variables_Available_To_Rules"><a class="selflink" href="#Variables_Available_To_Rules">Variables
  Available To Rules</a></h2>
<b>dacs_acs</b> predefines several variables that may be accessed by rules.
  Additionally, variables obtained from the request's credentials are exported
  into the environment of an invoked CGI program. In this way, services can know
  who is making the request, to retrieve user preferences, for example.
<div class="Pp"></div>
In addition, parameters passed to a CGI program, whether through a query string
  or a message body (e.g., POST method data), may be accessed as variables. For
  example, for the service request:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
 .../cgi-bin/foo?A=hello&amp;B=world
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
the variables <i>${Args::A}</i> with the value hello and <i>${Args::B}</i> with
  the value world will be defined at the time ACL rulesets are evaluated. Also,
  variables obtained from the authenticated credentials may be referenced (e.g.,
  <i>${DACS::JURISDICTION}</i>).
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
Because at present a variable cannot be multi-valued, if a variable is set more
  than once its value at the time of evaluation is not predictable. For example,
  given this query string you cannot depend on which value is assigned to
  <i>${Args::ARG}</i>:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
 .../cgi-bin/foo?ARG=hello&amp;ARG=world
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
This also creates problems if you need to examine arguments produced by an HTML
  SELECT element within a form when the MULTIPLE attribute is used because each
  OPTION selected by the user will be associated with the same argument name.
  Syntactical and functional improvements are planned in this regard.
<div class="Pp"></div>
Any &quot;null&quot; arguments in the query string (e.g.,
  &quot;&amp;&amp;&quot;) are ignored. A query string with a component that has
  a value but not a name (e.g., &quot;&amp;=foo&quot;) is considered to be
  invalid.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
From these sources, the execution environment, and from the <b>DACS</b>
  configuration, <b>dacs_acs</b> automatically creates four &quot;classes&quot;
  of variables: CGI parameter variables, configuration variables, environment
  variables, and request-specific variables created by <b>DACS</b>. These
  classes are called namespaces; please refer to <b>dacs.exprs(5)</b>[51] for
  details. For example, the value of a CGI parameter is accessed by
  <i>${Args::</i> <i></i><i>varname</i><i>}</i>, the value of a <b>DACS</b>
  context variable is accessed by <i>${DACS::</i><i></i><i>varname</i><i>}</i>
  (e.g., <i>${DACS::JURISDICTION}</i>), and the value of configuration variable
  is obtained using <i>${Conf::</i><i></i><i>varname</i><i>}</i> (e.g.,
  <i>${Conf::FEDERATION_DOMAIN}</i>).
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>Standard Environment Variables</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
For <b>dacs_acs</b>, the <i>Env</i> namespace is comprised of CGI variables
  exported by <b>Apache</b>, which includes HTTP request variables such as
  <i>${Env::HTTP_USER_AGENT}</i>. The values of recognized headers that might
  compromise security are edited or deleted. <b>Apache</b> will export
  unrecognized HTTP request headers by prefixing the header name with HTTP_ and
  mapping the header name to upper case; this example results in
  <i>${Env::AUGGIE}</i> having the value &quot;Doggie&quot;:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacshttp -header Auggie Doggie https://example.com/cgi-bin/dacs/someprog
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
For other programs, the <i>Env</i> namespace is populated from the program's
  normal environment.
<div class="Pp"></div>
These namespaces are reserved from other uses and their contents are, for the
  most part, read-only.
<div class="Pp"></div>
The only MIME content types currently supported with respect to capturing CGI
  parameters are application/x-www-form-urlencoded, which is the default used by
  browsers when submitting a form, and multipart/form-data. At present, only
  7bit data encoding is supported. The methods by which values from forms can be
  returned to a server are described in <b>RFC 1867</b>[52], <b>RFC
  2388</b>[53], and <b>HTML 4</b>[54].
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
In some contexts, Apache's <b>PATH_TRANSLATED</b> environment variable is not
  passed to <b>dacs_acs</b> (it is still available as unusual to CGI programs).
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>Exported DACS Variables</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
The following variables are exported to the &quot; <i>DACS</i>&quot; namespace
  (e.g., <i>${DACS::QUERY}</i>). Upper and lower case are distinct in variable
  names. These values are either obtained from <b>Apache</b> or are elements of
  the client's credentials.
<div class="Pp"></div>
<i>ACS</i>
<div style="margin-left: 4.00ex;">If <b>dacs_acs</b> is requested to test
  access, this variable will be defined and have the value of the
  <i>DACS_ACS</i> argument.</div>
<div class="Pp"></div>
<i>ARGS</i>
<div style="margin-left: 4.00ex;">A string representing all of the parameters to
  a CGI program, excluding multipart/form-data, encoded as a query string. If
  the number or total size of the parameters exceeded the
  implementation-dependent limit, the variable <i>ARGS_TRUNCATED</i> will be
  defined and have a non-zero value.</div>
<div class="Pp"></div>
<i>ARGS_TRUNCATED</i>
<div style="margin-left: 4.00ex;">If this variable is defined and its value is
  non-zero, the argument list has been truncated. This means that not all
  arguments to the CGI program are accessible to <b>dacs_acs</b> and the value
  of one argument may have been truncated. See
  <b>ACS_POST_EXCEPTION_MODE</b>[55].</div>
<div class="Pp"></div>
<i>ARG_COUNT</i>
<div style="margin-left: 4.00ex;">The number of arguments available in the
  <i>Args</i> namespace. If there are four arguments in a request's query string
  and two arguments within its application/x-www-form-urlencoded message body,
  for instance, then the value of <i>${DACS::ARG_COUNT}</i> will be six. These
  arguments will be available collectively as the value of <i>${DACS::ARGS}</i>
  and individually in the <i>Args</i> namespace.</div>
<div class="Pp"></div>
<i>AUTHORIZATION</i>
<div style="margin-left: 4.00ex;">The value of the Authorization HTTP header
  field, if available.</div>
<div class="Pp"></div>
<i>CONTENT_ENCODING</i>
<div style="margin-left: 4.00ex;">The value of the Content-Encoding HTTP header
  field, if available.</div>
<div class="Pp"></div>
<i>CONTENT_LENGTH</i>
<div style="margin-left: 4.00ex;">The value of the Content-Length HTTP header
  field, if available.</div>
<div class="Pp"></div>
<i>CONTENT_TYPE</i>
<div style="margin-left: 4.00ex;">The value of the Content-Type HTTP header
  field, if available.</div>
<div class="Pp"></div>
<i>CURRENT_URI</i>
<div style="margin-left: 4.00ex;">The full URI for the requested resource,
  including any query component.</div>
<div class="Pp"></div>
<i>CURRENT_URI_NO_QUERY</i>
<div style="margin-left: 4.00ex;">The full URI for the requested resource,
  excluding any query component.</div>
<div class="Pp"></div>
<i>FEDERATION</i>
<div style="margin-left: 4.00ex;">The official name of the federation to which
  <i>JURISDICTION</i> belongs. If the user was not authenticated, this variable
  will be undefined.</div>
<div class="Pp"></div>
<i>FILENAME</i>
<div style="margin-left: 4.00ex;">The full path of the file corresponding to the
  URL being invoked, equivalent to <b>Apache</b>'s <b>SCRIPT_FILENAME</b>
  environment variable or its <i>REQUEST_FILENAME</i> variable.</div>
<div class="Pp"></div>
<i>IDENTITY</i>
<div style="margin-left: 4.00ex;">The <b>DACS</b> identity (the username
  component plus federation and jurisdiction components) if the user was
  authenticated, otherwise undefined.</div>
<div class="Pp"></div>
<i>INTERACTIVE</i>
<div style="margin-left: 4.00ex;">If the standard input is a valid terminal type
  device, this variable is set to 1, otherwise it is undefined.</div>
<div class="Pp"></div>
<i>IP</i>
<div style="margin-left: 4.00ex;">The IP address, in standard numeric dot
  notation, associated with <i>USERNAME</i>. If the user was not authenticated,
  this variable will be undefined.</div>
<div class="Pp"></div>
<i>JURISDICTION</i>
<div style="margin-left: 4.00ex;">The official, abbreviated name of the
  jurisdiction that authenticated <i>USERNAME</i>. If the user was not
  authenticated, this variable will be undefined.</div>
<div class="Pp"></div>
<i>METHOD</i>
<div style="margin-left: 4.00ex;">The method used to invoke the URL, equivalent
  to <b>Apache</b>'s <b>REQUEST_METHOD</b> environment variable.</div>
<div class="Pp"></div>
<i>PATH_INFO</i>
<div style="margin-left: 4.00ex;">The <b>PATH_INFO</b> part of the URI, as set
  by <b>Apache</b>.</div>
<div class="Pp"></div>
<i>POSTDATA</i>
<div style="margin-left: 4.00ex;">A MIME base-64 encoded string representing the
  data stream (message body) sent to a CGI program. If the number or total size
  of the parameters exceeded the configured limit, the variable
  <i>ARGS_TRUNCATED</i> will be defined and have a non-zero value. See the
  description of the SetDACSAuthPostBuffer directive to
  <b>mod_auth_dacs</b>[12]).</div>
<div class="Pp"></div>
<i>PROXYREQ</i>
<div style="margin-left: 4.00ex;">If set, the type of proxy processing performed
  for this request by Apache (from <i>SERVICE_PROXYREQ</i>).</div>
<div class="Pp"></div>
<i>QUERY</i>
<div style="margin-left: 4.00ex;">The query string, if any, that was appended to
  the URL.</div>
<div class="Pp"></div>
<i>REMOTE_ADDR</i>
<div style="margin-left: 4.00ex;">The <b>REMOTE_ADDR</b>, as set by
  <b>Apache</b>.</div>
<div class="Pp"></div>
<i>REMOTE_HOST</i>
<div style="margin-left: 4.00ex;">The <b>REMOTE_HOST</b>, as set by
  <b>Apache</b>.</div>
<div class="Pp"></div>
<i>RIDENT</i>
<div style="margin-left: 4.00ex;">The Rlink identity, if any, associated with
  the rule currently being evaluated. See <b>Rlinks</b>[56].</div>
<div class="Pp"></div>
<i>RIPTR</i>
<div style="margin-left: 4.00ex;">The Rlink identity pointer, if any, associated
  with the rule currently being evaluated. See <b>Rlinks</b>[56].</div>
<div class="Pp"></div>
<i>RNAME</i>
<div style="margin-left: 4.00ex;">The Rname, if any, associated with the rule
  currently being evaluated. This is also available as <i>${Args::RNAME}</i>.
  See <b>Rlinks</b>[56].</div>
<div class="Pp"></div>
<i>ROLES</i>
<div style="margin-left: 4.00ex;">The role string associated with
  <i>USERNAME</i>. If the user was not authenticated, this variable will be
  undefined.</div>
<div class="Pp"></div>
<i>URI</i> and <i>URL</i>
<div style="margin-left: 4.00ex;">The URL being invoked.</div>
<div class="Pp"></div>
<i>USERNAME</i>
<div style="margin-left: 4.00ex;">The username (without any federation or
  jurisdiction component). If the user was not authenticated, this variable will
  be undefined.</div>
<div class="Pp"></div>
<i>USER_AGENT</i>
<div style="margin-left: 4.00ex;">When provided by the user agent, this is
  equivalent to the HTTP User-Agent request-header field and
  <b>HTTP_USER_AGENT</b> environment variable provided by <b>Apache</b>. When an
  actual value is unavailable, this variable is set to
  &quot;unknown&quot;.</div>
</div>
<h2 class="Ss" title="Ss" id="Exported_Environment_Variables"><a class="selflink" href="#Exported_Environment_Variables">Exported
  Environment Variables</a></h2>
The normal execution environment of a CGI program or internally processed script
  (e.g., <b>mod_php</b>) that is <b>DACS</b>-wrapped is augmented with
  environment variables instantiated from validated credentials, access control
  rules, configuration information, and so on. Through these variables, services
  have access to the identity of the user making the request to retrieve user
  preferences, for example, or make run-time decisions.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
Environment variables with the prefix &quot;DACS_&quot; are reserved for use by
  <b>DACS</b> and should not be used for other purposes by an application. Upper
  and lower case are distinct in variable names.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
If <b>PHP</b>[57] is installed, a nice way to see the <b>DACS</b> environment
  variables that are passed to a CGI program is to run a <b>DACS</b>-wrapped
  script like this:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;html&gt;&lt;head&gt;
&lt;meta http-equiv=&quot;Content-type&quot; content=&quot;text/html;charset=ISO-8859-1&quot;&gt;
&lt;title&gt;&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;p&gt;
&lt;?php
phpinfo();
?&gt;
&lt;/p&gt;
&lt;/body&gt;&lt;/html&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Alternatively, you can use <b>dacs_prenv(8)</b>[58].
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
The environment variables that are exported (when defined) are listed here. More
  detailed descriptions of these variables appear in other <b>DACS</b>
  documents.
<div class="Pp"></div>
<b>DACS_ACS_JURISDICTION</b>
<div style="margin-left: 4.00ex;">This is the official <b>DACS</b> internal,
  abbreviated name for the jurisdiction that has granted access.</div>
<div class="Pp"></div>
<b>DACS_APPROVAL</b>
<div style="margin-left: 4.00ex;">A digitally signed message that confirms that
  <b>DACS</b> authorized the request. See <b>dacs_acs(8)</b>[59].</div>
<div class="Pp"></div>
<b>DACS_CONCISE_IDENTITY</b>
<div style="margin-left: 4.00ex;">This is the full <b>DACS</b> identity to which
  access was granted expressed in the concise syntax used by
  <b>dacscheck(1)</b>[2]. When available, the user's roles and IP address are
  included.</div>
<div class="Pp"></div>
<b>DACS_CONF</b>
<div style="margin-left: 4.00ex;">This is the full pathname of the <b>DACS</b>
  configuration file.</div>
<div class="Pp"></div>
<b>DACS_CONSTRAINT</b>
<div style="margin-left: 4.00ex;">A constraint string associated with a
  sub-component of the matching access control rule permitting the service
  request.</div>
<div class="Pp"></div>
<b>DACS_DEFAULT_CONSTRAINT</b>
<div style="margin-left: 4.00ex;">A constraint string associated with the
  matching access control rule.</div>
<div class="Pp"></div>
<b>DACS_FEDERATION</b>
<div style="margin-left: 4.00ex;">This is the federation name component of
  <b>DACS_IDENTITY</b>.</div>
<div class="Pp"></div>
<b>DACS_IDENTITY</b>
<div style="margin-left: 4.00ex;">This is the full <b>DACS</b> identity to which
  access was granted. <b>Apache</b>'s <b>REMOTE_USER</b> environment variable is
  also set to this value, so it is available for logging purposes and export to
  CGI programs.</div>
<div class="Pp"></div>
<b>DACS_JURISDICTION</b>
<div style="margin-left: 4.00ex;">This is the jurisdiction component of
  <b>DACS_IDENTITY</b>.</div>
<div class="Pp"></div>
<b>DACS_MOD_AUTH_DACS</b>
<div style="margin-left: 4.00ex;">This is the date and time
  <b>mod_auth_dacs</b>[3] was built.</div>
<div class="Pp"></div>
<b>DACS_MOD_AUTH_DACS_VERSION</b>
<div style="margin-left: 4.00ex;">This is the <b>DACS</b> version identification
  string for the <b>mod_auth_dacs</b>[3] being used (i.e., the <b>DACS</b>
  distribution that this module was built with).</div>
<div class="Pp"></div>
<b>DACS_ROLES</b>
<div style="margin-left: 4.00ex;">This is the role string associated with
  <b>DACS_USERNAME</b> within <b>DACS_JURISDICTION</b>.</div>
<div class="Pp"></div>
<b>DACS_SITE_CONF</b>
<div style="margin-left: 4.00ex;">This is the full pathname of the <b>DACS</b>
  site configuration file.</div>
<div class="Pp"></div>
<b>DACS_USERNAME</b>
<div style="margin-left: 4.00ex;">This is the username component of the identity
  to which access was granted.</div>
<div class="Pp"></div>
<b>DACS_VERSION</b>
<div style="margin-left: 4.00ex;">The major version number of <b>DACS</b>.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>About Servlets</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The details of how environment variables are passed from <b>Apache</b> to
  servlets are beyond the scope of <b>DACS</b>. But for what it's worth, the
  following illustrates how to export and access them from servlets that are
  under the control of <b>DACS</b> in conjunction with <b>mod_jk</b>[60] and
  <b>Tomcat</b>[61]. This used to work at one time but may no longer be correct.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
The following directives (which appear in, or are included in, the <b>Apache</b>
  configuration file) are used (this list may be expanded):
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;IfModule mod_jk.c&gt;
  JkEnvVar DACS_FEDERATION         NONE
  JkEnvVar DACS_JURISDICTION       NONE
  JkEnvVar DACS_ACS_JURISDICTION   NONE
  JkEnvVar DACS_ROLES              NONE
  JkEnvVar DACS_USERNAME           NONE
  JkEnvVar DACS_CONSTRAINT         NONE
  JkEnvVar DACS_DEFAULT_CONSTRAINT NONE
  JkEnvVar DACS_COOKIE             NONE
  JkEnvVar DACS_MOD_AUTH_DACS      NONE
&lt;/IfModule mod_jk.c&gt;
</pre>
</div>
<div class="Pp"></div>
From a servlet, the values of these variables can be obtained through the
  <b>getAttribute()</b> method, invoked on an <i>HttpServletRequest</i> object.
  For example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
Object username = req.getAttribute(&quot;DACS_USERNAME&quot;);
out.println(&quot;roles = &quot; + req.getAttribute(&quot;DACS_ROLES&quot;));
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
In addition to the standard <b></b><i>dacsoptions</i>[1], <b>dacs_acs</b>
  recognizes the following arguments:
<div class="Pp"></div>
<b>-dcc</b>
<div style="margin-left: 4.00ex;">Disable the <b>mod_auth_dacs</b>[3]
  compatibility check. Use with care, normally only for testing and
  debugging.</div>
<div class="Pp"></div>
<b>-proxy-static</b>
<div style="margin-left: 4.00ex;">Reserved for future use.</div>
<div class="Pp"></div>
<b>-proxy-exec</b>
<div style="margin-left: 4.00ex;">Reserved for future use.</div>
<div class="Pp"></div>
<b>-test</b>
<div style="margin-left: 4.00ex;">Perform some self-tests, then exit. A non-zero
  exit status means an error occurred. If <b>-test</b> is the only argument
  (recommended), no configuration is necessary; otherwise, normal configuration
  processing will be performed before the self-tests.</div>
<h2 class="Ss" title="Ss" id="The_DACS_ACS_Argument"><a class="selflink" href="#The_DACS_ACS_Argument">The
  DACS_ACS Argument</a></h2>
Various aspects of the behaviour of <b>dacs_acs</b> can be controlled by an
  optional argument named <i>DACS_ACS</i>. This argument, which may be passed to
  <i>any</i> web service, is interpreted by <b>dacs_acs</b> rather than the web
  service that is being invoked. The value of this argument is parsed as a list
  of space-separated command line flags.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The space character(s) must be properly escaped; e.g., as %20 or +.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
One use of this feature is when an application or middleware would like to know
  whether <b>DACS</b> will grant or deny a service request without having to
  actually execute the service request. When building a menu, for instance, an
  application might want to exclude items involving service requests that would
  be denied to the user. <b>dacs_acs</b> provides this capability.
<div class="Pp"></div>
To check whether access would be granted or denied, the application invokes the
  <b>DACS</b>-wrapped service or resource exactly as it would normally except
  that it provides the <i>DACS_ACS</i> argument. In some situations, if access
  would be denied <b>dacs_acs</b> will return an indication of what must be
  done; e.g., the user must authenticate or a notice must be acknowledged. There
  can be multiple reasons for denying access, in which case an application may
  have to repeatedly request a check and address the reason for denial before
  access may be granted.
<div class="Pp"></div>
The <i>DACS_ACS</i> argument can be a query argument or can appear in a message
  body with the content type application/x-www-form-urlencoded (as in the case
  of an HTML form submitted using the POST method, for example). The
  <i>DACS_ACS</i> argument may not be specified more than once. It is not always
  possible to escape this argument (see <b></b><b>-invisible</b>[62]).
<div class="Pp"></div>
The following flags are recognized:
<div class="Pp"></div>
<b>-check_only</b>
<div style="margin-left: 4.00ex;">The presence of this flag tells
  <b>dacs_acs</b> not to actually execute the web service or return the
  resource, but to merely return the access control decision. This flag and the
  <b>-check_fail</b> flag are mutually exclusive.
<div style="height: 1.00em;">&#x00A0;</div>
If the access check was performed, HTTP status code <b>200</b> (OK) will be
  returned; any other result indicates that the check could not be executed
  (e.g., due to an <b>Apache</b> configuration problem or a <b>DACS</b> error).
  If the check is performed, a DACS-Status-Line HTTP extension header is
  included in the response by default (see below).
<div style="height: 1.00em;">&#x00A0;</div>
The default response consists of a single line of text that gives the result.
  This line consists of a three decimal digit result code, followed by a space,
  an explanatory message, and a newline character; for example,
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
797 Access denied
798 Access granted
799 Access error
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Inspecting the result code is sufficient to obtain the outcome of the check. Any
  <b>Apache</b> <b>ErrorDocument</b>[63] directive for &quot;error-code&quot;
  200 is overridden. The <b>-format</b> flag (see below) can be used to select a
  different output format.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
The service or resource in question does not have to exist for <b>dacs_acs</b>
  to grant access; for instance, this can happen if a wildcard rule pattern is
  used. Also, keep in mind that access control rules can be written to be highly
  context specific. The result of a test for a particular resource need not be
  the same an instant later (access control rules can depend on the current date
  or time, for instance).
<div style="height: 1.00em;">&#x00A0;</div>
Rules can be written such that their evaluation results in persistent changes;
  for example, a database might be updated. These kinds of changes will occur
  both in normal operation and when only checking access. <b>dacs_acs</b>
  defines the variable <i>${DACS::ACS}</i> only during the testing mode of
  operation so that, if necessary, rules can be written to differentiate between
  testing mode and normal operation.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div class="Pp"></div>
<b>-check_fail</b>
<div style="margin-left: 4.00ex;">This flag is like the <b>-check_only</b> flag,
  except if access is granted the request is allowed to proceed. If access is
  not granted and HTTP status code <b>200</b> is returned, a DACS-Status-Line
  HTTP extension header is included in the response by default (see below). The
  <b>-check_fail</b> flag is useful in situations where a <b>-check_only</b>
  test that indicates that access would be granted is always immediately
  followed by the actual request. This flag and the <b>-check_only</b> flag are
  mutually exclusive.</div>
<div class="Pp"></div>
<b>-format</b> <i>fmt</i>
<div style="margin-left: 4.00ex;">By default, the <b>-check_only</b> flag (and
  in the case where access is denied, also the <b>-check_fail</b> flag) results
  in a single line of text being output (equivalent to &quot; <b>-format
  text</b>&quot;). If more detail is required, an XML description can be
  produced by specifying any of the XML output formats. Refer to <b>XML
  Output</b>[64], the <b></b><i>FORMAT</i> CGI argument[65], and the
  <b></b><b>-format</b>[66] command line argument.</div>
<div class="Pp"></div>
<b>-rname</b> <i>rname</i>
<div style="margin-left: 4.00ex;">The string <i>rname</i>, which is assumed to
  be the name of an Rlink, is made available available as <i>${Args::RNAME}</i>
  during evaluation of <b>ACS_PRE_AUTH</b>[67] directive expressions.</div>
<div class="Pp"></div>
<b>-status_line</b>
<div>&#x00A0;</div>
<b>-no-status_line</b>
<div style="margin-left: 4.00ex;">The <b>-status_line</b> flag enables the
  <b>DACS-Status-Line</b>[68] header, overriding the setting of the
  <b>STATUS_LINE</b>[69] configuration directive. The <b>-no_status_line</b>
  flag <i>always</i> suppresses this header, regardless of the
  <b>STATUS_LINE</b>[69] directive and the <b>-check_only</b> and
  <b>-check_fail</b> flags.</div>
<div class="Pp"></div>
<b>-visible</b>
<div>&#x00A0;</div>
<b>-invisible</b>
<div style="margin-left: 4.00ex;">If the <i>DACS_ACS</i> argument is passed as a
  query argument, the default behaviour is to delete it so that it cannot be
  seen after access control processing grants access. This deletion is
  explicitly enabled by the <b>-invisible</b> flag and disabled by the
  <b>-visible</b> flag. If <i>DACS_ACS</i> is not deleted, it will be passed to
  an invoked program and might affect subsequent processing.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Important</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
Deletion of the <i>DACS_ACS</i> argument is currently possible only if it is
  passed as a query argument.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
For example, consider the hypothetical URL:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
https://example.com/cgi-bin/myprog?DACS_ACS=-check_fail+-visible&amp;foo=baz
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
If the CGI program <b>myprog</b> is executed, it will not only see the
  <i>foo=baz</i> argument, but also the <i>DACS_ACS=-check_fail+-visible</i>
  argument, and this could trigger an error or incorrect behaviour when
  <b>myprog</b> processes it.
<div style="height: 1.00em;">&#x00A0;</div>
All <b>DACS</b> web services ignore a <i>DACS_ACS</i> argument, however, so its
  presence will not affect them.</div>
<div class="Pp"></div>
The flag list is processed from left to right. Any flag may be repeated, with
  the value of a later occurrence overriding an earlier one. If some part of the
  <i>DACS_ACS</i> argument is invalid, the initial, valid part will still be
  effective; e.g., if the initial part is <b>-format</b> XML, the output format
  will be XML.
<div class="Pp"></div>
<b>dacs_acs</b> removes the <i>DACS_ACS</i> argument from the rule-processing
  environment so as not to disturb access control processing. <b>DACS</b>
  credentials may accompany the service request just as they would a real
  request and are incorporated into the check.
<div class="Pp"></div>
Assuming the target resource is <b>DACS</b>-wrapped, instead of returning the
  resource, accessing the following URL would return an indication of whether an
  actual request to access the resource would be granted or denied:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacshttp -v -v \
 'https://dacs.dss.ca/cgi-bin/dacs/dacs_version?DACS_ACS=-check_only%20-format+xml'
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>The DACS-Status-Line header</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
When the <b>DACS_ACS=-check_only</b> argument is present, the response from
  <b>DACS</b> includes an extension header named DACS-Status-Line. The format of
  this extension header follows that of the HTTP Status-Line ( <b>RFC
  2616</b>[32], section 6.1):
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
DACS-Status-Line = &quot;DACS-Status-Line&quot; &quot;:&quot;  <i>DACS-Version</i> SP <i>ACS-Status-Code</i>
  SP  <i>Reason-Phrase</i> CRLF
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Where:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
<i>DACS-Version</i> = &quot;DACS-&quot; <i>Version</i>
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
and <i>Version</i> is the <b>DACS_VERSION_RELEASE</b> string (e.g., 1.4.8b), and
  where:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
<i>ACS-Status-Code</i> = &quot;797&quot; | &quot;798&quot; | &quot;799&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
The status code <b>797</b> means that <b>DACS</b> denies access, <b>798</b>
  means that it grants access, and <b>799</b> means that an error occurred
  during processing.
<div class="Pp"></div>
Here are some examples:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
DACS-Status-Line: DACS-1.4.8b 797 Access denied
DACS-Status-Line: DACS-1.4.8b 798 Access granted
DACS-Status-Line: DACS-1.4.8b 799 Access error
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
The reason phrases in the examples are only recommendations; they may be
  replaced by local equivalents without affecting the protocol.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The reason phrase may include additional information, such as an audit
  identifier that can be used to track the request in the <b>DACS</b> logs:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
DACS-Status-Line: DACS-1.4.10 798 Access granted, unauth user (j10OXL2Z)
</pre>
</div>
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
This header is also returned when <b>-check_fail</b> is requested, but only if
  access is not granted.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>The DACS_APPROVAL environment variable</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
If enabled by the <b>ACS_EMIT_APPROVAL</b>[70] directive, the
  <b>DACS_APPROVAL</b> environment variable will be passed to a
  <b>DACS</b>-wrapped program. If the program cares to verify that its execution
  has been authorized, it may validate the approval's signature (to ensure that
  the approval has not been forged) and validate the stamp (to ensure that the
  approval is not being replayed). If a man-in-the-middle attack is of concern,
  end-to-end encryption should always be used.
<div class="Pp"></div>
With proper configuration, this feature can be used by a web-based program that
  is not <b>DACS</b>-wrapped but for which authorization has been obtained
  indirectly. For example, when <b>dacs_uproxy(8)</b>[71], invokes a program,
  <b>dacs_uproxy</b> will forward the value of <b>DACS_APPROVAL</b> (when
  available) to the invoked program, which can obtain the value in its
  <b>HTTP_DACS_UPROXY_APPROVAL</b> environment variable. If it is able to
  validate the value (or can trust it), the invoked program knows that its
  execution was authorized by <b>DACS</b>, even though <b>DACS</b> may not be
  configured or even installed on the host where the invoked program runs.
<div class="Pp"></div>
A jurisdiction's cryptographic keys, identified by the virtual filestore item
  type jurisdiction_keys, must be configured so that the approval can be
  digitally signed.
<div class="Pp"></div>
The value of <b>DACS_APPROVAL</b> has the following format:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
a=&quot; <i>dacs64-approval-message</i>&quot;, s=&quot;<i>dacs64-signature</i>&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
The <i>dacs64-approval-message</i> is a <b>dacs64</b>[35] encoded string,
  described below. The <i>dacs64-signature</i> is the dacs64 encoded RSA
  signature of the approval message, which is the unencoded
  <i>dacs64-approval-message</i>.
<div class="Pp"></div>
An approval message has the following format:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
j=&quot; <i>jurisdiction-name</i>&quot;&lt;newline&gt;
h=&quot; <i>digest-name</i>&quot;&lt;newline&gt;
s=&quot; <i>stamp</i>&quot;&lt;newline&gt;
u=&quot; <i>uri</i>&quot;&lt;newline&gt;
m=&quot; <i>method</i>&quot;&lt;newline&gt;
i=&quot; <i>ident</i>&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Here, <i>jurisdiction-name</i> is the name of the jurisdiction (including its
  federation name) that generated the approval. The name of the message digest
  (secure hash) algorithm used to sign the approval is <i>digest-name</i>. The
  unique stamp is <i>stamp</i> (as generated by <b>ustamp()</b>[72]) and the
  URI, including any query component, is <i>uri</i>. The HTTP method is
  <i>method</i>. The <b>DACS</b> identity of the user for which access was
  granted is <i>ident</i> (or &quot;unauth&quot;, if none). The <i>stamp</i> and
  <i>method</i> are mapped to lowercase. Here is an example of an approval
  message:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
j=&quot;DSS::DSS-dacs&quot;
h=&quot;SHA1&quot;
s=&quot;1185565675:130&quot;,
u=&quot;http://example.com/cgi-bin/dacs/dacs_current_credentials?FORMAT=HTML&quot;
m=&quot;get&quot;
i=&quot;unauth&quot;
</pre>
</div>
<div class="Pp"></div>
The RSA signature is computed using the jurisdiction's private key and SHA-1 (by
  default) over the approval message. A different message digest algorithm can
  be used by setting the configuration variable
  <i>${Conf::dacs_approval_digest_name}</i> (see <b>digest()</b>[73] for
  information about message digest algorithms):
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
EVAL ${Conf::dacs_approval_digest_name} = &quot;SHA256&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<h1 class="Sh" title="Sh" id="DIAGNOSTICS"><a class="selflink" href="#DIAGNOSTICS">DIAGNOSTICS</a></h1>
The program exits 0 if everything was fine, 1 if an error occurred.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
It ought to be possible to add functionality to clear or modify the
  Authorization header associated with a particular resource by recognizing an
  argument much like <b>-check_only</b>.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>dacsacl(1)</b>[45], <b>dacscheck(1)</b>[2], <b>dacs.acls(5)</b>[4],
  <b>dacs.conf(5)</b>[49], <b>dacs_admin(8)</b>[46]
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
While the <i>DACS_ACS</i> mechanism can be useful, it is still a kludge,
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Distributed Systems Software ( <b>www.dss.ca</b>[74])
<h1 class="Sh" title="Sh" id="COPYING"><a class="selflink" href="#COPYING">COPYING</a></h1>
Copyright2003-2016 Distributed Systems Software. See the <b>LICENSE</b>[75] file
  that accompanies the distribution for licensing information.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"> 1.</dt>
  <dd class="It-tag">dacsoptions</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.1.html#dacsoptions</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 2.</dt>
  <dd class="It-tag">dacscheck(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacscheck.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 3.</dt>
  <dd class="It-tag">mod_auth_dacs</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/mod_auth_dacs.html</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 4.</dt>
  <dd class="It-tag">dacs.acls(5)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.acls.5.html</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 5.</dt>
  <dd class="It-tag">logging</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.1.html#logging</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 6.</dt>
  <dd class="It-tag">LOG_LEVEL</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#LOG_LEVEL</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 7.</dt>
  <dd class="It-tag">LOG_FILTER</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#LOG_FILTER</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 8.</dt>
  <dd class="It-tag">AddDACSAuth</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/mod_auth_dacs.html#AddDACSAuth</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 9.</dt>
  <dd class="It-tag">DACS_HOME</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#var_dacs_home</div>
<dl class="Bl-tag">
  <dt class="It-tag">10.</dt>
  <dd class="It-tag">pipe(2)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.freebsd.org/cgi/man.cgi?query=pipe&amp;apropos=0&amp;sektion=2&amp;manpath=FreeBSD+10.1-RELEASE&amp;format=html</div>
<dl class="Bl-tag">
  <dt class="It-tag">11.</dt>
  <dd class="It-tag">Variables Available To Rules</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#vars_in_rules</div>
<dl class="Bl-tag">
  <dt class="It-tag">12.</dt>
  <dd class="It-tag">mod_auth_dacs</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/mod_auth_dacs.html#SetDACSAuthPostBuffer</div>
<dl class="Bl-tag">
  <dt class="It-tag">13.</dt>
  <dd class="It-tag">COOKIE_NAME_TERMINATORS</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#COOKIE_NAME_TERMINATORS</div>
<dl class="Bl-tag">
  <dt class="It-tag">14.</dt>
  <dd class="It-tag">ALLOW_HTTP_COOKIE</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#ALLOW_HTTP_COOKIE</div>
<dl class="Bl-tag">
  <dt class="It-tag">15.</dt>
  <dd class="It-tag">RFC 2617</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc2617.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">16.</dt>
  <dd class="It-tag">dacs_authenticate(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_authenticate.8.html#credentials</div>
<dl class="Bl-tag">
  <dt class="It-tag">17.</dt>
  <dd class="It-tag">dacsrlink(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacsrlink.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">18.</dt>
  <dd class="It-tag">redirect()</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.exprs.5.html#redirect</div>
<dl class="Bl-tag">
  <dt class="It-tag">19.</dt>
  <dd class="It-tag">RLINK</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#RLINK</div>
<dl class="Bl-tag">
  <dt class="It-tag">20.</dt>
  <dd class="It-tag">the one used for normal rules</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.acls.5.html#acl_files</div>
<dl class="Bl-tag">
  <dt class="It-tag">21.</dt>
  <dd class="It-tag">concise user identity</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.1.html#concise_user_syntax</div>
<dl class="Bl-tag">
  <dt class="It-tag">22.</dt>
  <dd class="It-tag">identity element</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.acls.5.html#elements</div>
<dl class="Bl-tag">
  <dt class="It-tag">23.</dt>
  <dd class="It-tag">DACS_ACS argument</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#dacs_acs_argument</div>
<dl class="Bl-tag">
  <dt class="It-tag">24.</dt>
  <dd class="It-tag">autologin(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/autologin.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">25.</dt>
  <dd class="It-tag">HTTP_AUTH_ENABLE</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#HTTP_AUTH_ENABLE</div>
<dl class="Bl-tag">
  <dt class="It-tag">26.</dt>
  <dd class="It-tag">HTTP_AUTH</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#HTTP_AUTH</div>
<dl class="Bl-tag">
  <dt class="It-tag">27.</dt>
  <dd class="It-tag">Auth clause directives</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_authenticate.8.html#auth_clause</div>
<dl class="Bl-tag">
  <dt class="It-tag">28.</dt>
  <dd class="It-tag">local_apache_authenticate</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_authenticate.8.html#local_apache_authenticate</div>
<dl class="Bl-tag">
  <dt class="It-tag">29.</dt>
  <dd class="It-tag">ACS_ERROR_HANDLER</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#ACS_ERROR_HANDLER</div>
<dl class="Bl-tag">
  <dt class="It-tag">30.</dt>
  <dd class="It-tag">AUTH_SUCCESS_HANDLER</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#AUTH_SUCCESS_HANDLER</div>
<dl class="Bl-tag">
  <dt class="It-tag">31.</dt>
  <dd class="It-tag">AUTH_ERROR_HANDLER</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#AUTH_ERROR_HANDLER</div>
<dl class="Bl-tag">
  <dt class="It-tag">32.</dt>
  <dd class="It-tag">RFC 2616</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc2616.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">33.</dt>
  <dd class="It-tag">dacshttp(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacshttp.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">34.</dt>
  <dd class="It-tag">passed using this request-header</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#http_authentication</div>
<dl class="Bl-tag">
  <dt class="It-tag">35.</dt>
  <dd class="It-tag">dacs.exprs(5)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.exprs.5.html#encode</div>
<dl class="Bl-tag">
  <dt class="It-tag">36.</dt>
  <dd class="It-tag">COOKIE_PATH</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#COOKIE_PATH</div>
<dl class="Bl-tag">
  <dt class="It-tag">37.</dt>
  <dd class="It-tag">COOKIE_NO_DOMAIN</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#COOKIE_NO_DOMAIN</div>
<dl class="Bl-tag">
  <dt class="It-tag">38.</dt>
  <dd class="It-tag">COOKIE_HTTP_ONLY</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#COOKIE_HTTP_ONLY</div>
<dl class="Bl-tag">
  <dt class="It-tag">39.</dt>
  <dd class="It-tag">dacs.install(7)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.install.7.html#configure_options</div>
<dl class="Bl-tag">
  <dt class="It-tag">40.</dt>
  <dd class="It-tag">ACS_ACCESS_TOKEN_ENABLE</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#ACS_ACCESS_TOKEN_ENABLE</div>
<dl class="Bl-tag">
  <dt class="It-tag">41.</dt>
  <dd class="It-tag">ACS_ACCESS_TOKEN_LIFETIME_LIMIT</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#ACS_ACCESS_TOKEN_LIFETIME_LIMIT</div>
<dl class="Bl-tag">
  <dt class="It-tag">42.</dt>
  <dd class="It-tag">ACS_ACCESS_TOKEN_LIFETIME_SECS</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#ACS_ACCESS_TOKEN_LIFETIME_SECS</div>
<dl class="Bl-tag">
  <dt class="It-tag">43.</dt>
  <dd class="It-tag">dacs.acls(5)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.acls.5.html#acl_syntax</div>
<dl class="Bl-tag">
  <dt class="It-tag">44.</dt>
  <dd class="It-tag">tail matching</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.acls.5.html#tail_matching</div>
<dl class="Bl-tag">
  <dt class="It-tag">45.</dt>
  <dd class="It-tag">dacsacl(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacsacl.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">46.</dt>
  <dd class="It-tag">dacs_admin(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_admin.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">47.</dt>
  <dd class="It-tag">revocation list</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.acls.5.html#revocation_list</div>
<dl class="Bl-tag">
  <dt class="It-tag">48.</dt>
  <dd class="It-tag">dacs_acs.dtd</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/../dtd-xsd/dacs_acs.dtd</div>
<dl class="Bl-tag">
  <dt class="It-tag">49.</dt>
  <dd class="It-tag">dacs.conf(5)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">50.</dt>
  <dd class="It-tag">dacs_notices(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_notices.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">51.</dt>
  <dd class="It-tag">dacs.exprs(5)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.exprs.5.html#variables</div>
<dl class="Bl-tag">
  <dt class="It-tag">52.</dt>
  <dd class="It-tag">RFC 1867</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc1867.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">53.</dt>
  <dd class="It-tag">RFC 2388</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc2388.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">54.</dt>
  <dd class="It-tag">HTML 4</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.w3.org/TR/html4</div>
<dl class="Bl-tag">
  <dt class="It-tag">55.</dt>
  <dd class="It-tag">ACS_POST_EXCEPTION_MODE</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#ACS_POST_EXCEPTION_MODE</div>
<dl class="Bl-tag">
  <dt class="It-tag">56.</dt>
  <dd class="It-tag">Rlinks</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#rlinks</div>
<dl class="Bl-tag">
  <dt class="It-tag">57.</dt>
  <dd class="It-tag">PHP</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.php.net</div>
<dl class="Bl-tag">
  <dt class="It-tag">58.</dt>
  <dd class="It-tag">dacs_prenv(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_prenv.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">59.</dt>
  <dd class="It-tag">dacs_acs(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_acs.8.html#dacs_approval</div>
<dl class="Bl-tag">
  <dt class="It-tag">60.</dt>
  <dd class="It-tag">mod_jk</dd>
</dl>
<div style="margin-left: 4.00ex;">http://tomcat.apache.org/connectors-doc/generic_howto/quick.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">61.</dt>
  <dd class="It-tag">Tomcat</dd>
</dl>
<div style="margin-left: 4.00ex;">http://jakarta.apache.org</div>
<dl class="Bl-tag">
  <dt class="It-tag">62.</dt>
  <dd class="It-tag"><b>-invisible</b></dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#invisible_flag</div>
<dl class="Bl-tag">
  <dt class="It-tag">63.</dt>
  <dd class="It-tag">ErrorDocument</dd>
</dl>
<div style="margin-left: 4.00ex;">http://httpd.apache.org/docs/2.2/mod/core.html#errordocument</div>
<dl class="Bl-tag">
  <dt class="It-tag">64.</dt>
  <dd class="It-tag">XML Output</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#XML-output</div>
<dl class="Bl-tag">
  <dt class="It-tag">65.</dt>
  <dd class="It-tag"><i>FORMAT</i> CGI argument</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.1.html#FORMAT</div>
<dl class="Bl-tag">
  <dt class="It-tag">66.</dt>
  <dd class="It-tag"><b>-format</b></dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.1.html#format-arg</div>
<dl class="Bl-tag">
  <dt class="It-tag">67.</dt>
  <dd class="It-tag">ACS_PRE_AUTH</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#ACS_PRE_AUTH</div>
<dl class="Bl-tag">
  <dt class="It-tag">68.</dt>
  <dd class="It-tag">DACS-Status-Line</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_acs.8.html#dacs_status_line</div>
<dl class="Bl-tag">
  <dt class="It-tag">69.</dt>
  <dd class="It-tag">STATUS_LINE</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#STATUS_LINE</div>
<dl class="Bl-tag">
  <dt class="It-tag">70.</dt>
  <dd class="It-tag">ACS_EMIT_APPROVAL</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#ACS_EMIT_APPROVAL</div>
<dl class="Bl-tag">
  <dt class="It-tag">71.</dt>
  <dd class="It-tag">dacs_uproxy(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_uproxy.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">72.</dt>
  <dd class="It-tag">ustamp()</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.exprs.5.html#ustamp</div>
<dl class="Bl-tag">
  <dt class="It-tag">73.</dt>
  <dd class="It-tag">digest()</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.exprs.5.html#digest</div>
<dl class="Bl-tag">
  <dt class="It-tag">74.</dt>
  <dd class="It-tag">www.dss.ca</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.dss.ca</div>
<dl class="Bl-tag">
  <dt class="It-tag">75.</dt>
  <dd class="It-tag">LICENSE</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/../misc/LICENSE</div>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">01/12/2017</td>
    <td class="foot-os">DACS 1.4.38a</td>
  </tr>
</table>
</body>
</html>
