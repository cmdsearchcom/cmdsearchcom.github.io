<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>IPTSTATE(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">IPTSTATE(8)</td>
    <td class="head-vol"></td>
    <td class="head-rtitle">IPTSTATE(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<b>iptstate</b> - A top-like display of IP Tables state table entries
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>iptstate</b> [&lt;<b>options</b>&gt;]
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>iptstate</b> displays information held in the IP Tables state table in
  real-time in a top-like format. Output can be sorted by any field, or any
  field reversed. Users can choose to have the output only print once and exit,
  rather than the top-like system. Refresh rate is configurable, IPs can be
  resolved to names, output can be formatted, the display can be filtered, and
  color coding are among some of the many features.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="COMMAND-LINE_OPTIONS"><a class="selflink" href="#COMMAND-LINE_OPTIONS">COMMAND-LINE
  OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c, --no-color</b></dt>
  <dd class="It-tag">Toggle color-code by protocol</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-C, --counters</b></dt>
  <dd class="It-tag">Toggle display of bytes/packets counters</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d, --dst-filter <i>IP</i></b></dt>
  <dd class="It-tag">Only show states with a destination of <i>IP</i> Note, that
      this must be an IP, hostname matching is not yet supported.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-D --dstpt-filter <i>port</i></b></dt>
  <dd class="It-tag">Only show states with a destination port of
    <i>port</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h, --help</b></dt>
  <dd class="It-tag">Show help message</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l, --lookup</b></dt>
  <dd class="It-tag">Show hostnames instead of IP addresses</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-m, --mark-truncated</b></dt>
  <dd class="It-tag">Mark truncated hostnames with a '+'</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-o, --no-dynamic</b></dt>
  <dd class="It-tag">Toggle dynamic formatting</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-L, --no-dns</b></dt>
  <dd class="It-tag">Skip outgoing DNS lookup states</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f, --no-loopback</b></dt>
  <dd class="It-tag">Filter states on loopback</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p, --no-scroll</b></dt>
  <dd class="It-tag">No scrolling (don't use a &quot;pad&quot;). See
      <b>SCROLLING AND PADS</b> for more information.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-r, --reverse</b></dt>
  <dd class="It-tag">Reverse sort order</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-R, --rate <i>seconds</i></b></dt>
  <dd class="It-tag">Refresh rate, followed by rate in <i>seconds</i>. Note that
      this is for statetop mode, and not applicable for single-run mode
      (--single).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-1, --single</b></dt>
  <dd class="It-tag">Single run (no curses)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-b, --sort <i>column</i></b></dt>
  <dd class="It-tag">This determines what column to sort by. Options:
    <div>&#x00A0;</div>
    <b>	S</b> Source Port
    <div>&#x00A0;</div>
    <b>	d</b> Destination IP (or Name)
    <div>&#x00A0;</div>
    <b>	D</b> Destination Port
    <div>&#x00A0;</div>
    <b>	p</b> Protocol
    <div>&#x00A0;</div>
    <b>	s</b> State
    <div>&#x00A0;</div>
    <b>	t</b> TTL
    <div>&#x00A0;</div>
    <b>	b</b> Bytes
    <div>&#x00A0;</div>
    <b>	P</b> Packets
    <div>&#x00A0;</div>
    To sort by Source IP (or Name), don't use -b. Sorting by bytes/packets is
      only available for kernels that support it, and only when compiled against
      libnetfilter_conntrack (the default).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s, --src-filter <i>IP</i></b></dt>
  <dd class="It-tag">Only show states with a source of <i>IP</i>. Note, that
      this must be an IP, hostname matching is not yet supported.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-S, --srcpt-filter <i>port</i></b></dt>
  <dd class="It-tag">Only show states with a source port of <i>port</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-t, --totals</b></dt>
  <dd class="It-tag">Toggle display of totals
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="INTERACTIVE_OPTIONS"><a class="selflink" href="#INTERACTIVE_OPTIONS">INTERACTIVE
  OPTIONS</a></h1>
As of version 2.0, all command-line options are now available interactively
  using the same key as the short-option. For example, <b>--sort</b> is also
  <b>-b</b>, so while <b>iptstate</b> is running, hitting <b>b</b> will change
  the sorting to the next column. Similarly, <b>t</b> toggles the display of
  totals, and so on.
<div class="Pp"></div>
There are also extra interactive options: <b>B</b> - change sorting to previous
  column (opposite of <b>b</b>); <b>q</b> - quit; and <b>x</b> - delete the
  currently highlighted state from the netfilter conntrack table.
<div class="Pp"></div>
Additionally, the following keys are used to navigate within <b>iptstate</b>:
<dl class="Bl-tag">
  <dt class="It-tag"><b>Up</b> or <b>j</b> - Move up one line</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Down</b> or <b>k</b> - Move down one line</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Left</b> or <b>h</b> - Move left one column</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Right</b> or <b>l</b> - Move right one column</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>PageUp</b> or <b>^u</b> - Move up one page</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>PageDown</b> or <b>^d</b> - Move down one page</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Home</b> - Go to the top</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>End</b> - Go to the end</dt>
  <dd class="It-tag"></dd>
</dl>
<div class="Pp"></div>
In many cases, <b>iptstate</b> needs to prompt you in order to change something.
  For example, if you want to set or change the source-ip filter, when you hit
  <b>s</b>, <b>iptstate</b> will pop up a prompt at the top of the window to ask
  you what you want to set it to.
<div class="Pp"></div>
Note that like many UNIX applications, ctrl-G will tell <b>iptstate</b>
  &quot;nevermind&quot; - it'll remove the prompt and forget you ever hit
  <b>s</b>.
<div class="Pp"></div>
In most cases, a blank response means &quot;clear&quot; - clear the source IP
  filter, for example.
<div class="Pp"></div>
At anytime while <b>iptstate</b> is running, you can hit <b>h</b> to get to the
  <b>interactive help</b> which will display all the current settings to you as
  well give you a list of all interactive commands available.
<div class="Pp"></div>
While running, <b>space</b> will immediately update the display. <b>Iptstate</b>
  should gracefully handle all window resizes, but if it doesn't, you can force
  it to re-calculate and re-draw the screen with a <b>ctrl-L</b>.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SCROLLING_AND_PADS"><a class="selflink" href="#SCROLLING_AND_PADS">SCROLLING
  AND PADS</a></h1>
For almost any user, there is no reason to turn off scrolling. The ability to
  turn this off - and especially the ability to toggle this interactively - is
  done more for theoretical completeness than anything else.
<dl class="Bl-tag">
  <dt class="It-tag">But, nonetheless, here are the details. Typically in a
    curses application you create a &quot;window.&quot; Windows don't scroll,
    however. They are, at most, the size of your terminal. Windows provide
    double-buffering to make refreshing as fast and seemless as possible.
    However, to enable scrolling, one has to use &quot;pads&quot; instead of
    windows. Pads can be bigger than the current terminal. Then all necessary
    data is written to the pad, and &quot;scrolling&quot; becomes a function of
    just showing the right part of that pad on the screen.</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">However, pads do not have the double-buffering feature that
    windows have. Thus, there _might_ be some case where for some user using
    some very strange machine, having scrolling enabled could cause poor
    refreshing. Given the nature of the way <b>iptstate</b> uses the screen
    though, I find this highly unlikely. In addition, the scrolling method uses
    a little more memory. However, <b>iptstate</b> is not a memory intensive
    application, so this shouldn't be a problem even on low-memory systems.</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Nonetheless, if this does negatively affect you, the option
    to turn it off is there.</dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="EXIT_STATUS"><a class="selflink" href="#EXIT_STATUS">EXIT
  STATUS</a></h1>
Anything other than 0 indicates and error. A list of current exit statuses are
  below:
<dl class="Bl-tag">
  <dt class="It-tag"><b>0</b></dt>
  <dd class="It-tag">Success</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>1</b></dt>
  <dd class="It-tag">Bad command-line arguments</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>2</b></dt>
  <dd class="It-tag">Error communicating with the netfilter subsystem.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>3</b></dt>
  <dd class="It-tag">Terminal too narrow
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
We don't support filtering on resolved names, and we don't support filtering on
  networks. IPv6 support is new and the dynamic formatting doesn't yet always
  handle IPv6 addresses as well as it should.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="BUG_REPORTS"><a class="selflink" href="#BUG_REPORTS">BUG
  REPORTS</a></h1>
All bugs should be reported to Phil Dibowitz &lt;phil AT ipom DOT com&gt;.
  Please see the <b>README</b> and <b>BUGS</b> for more information on bug
  reports. Please read the <b>WISHLIST</b> before sending in features you hope
  to see.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
<b>iptstate</b> does a lot of work to try to fit everything on the screen in an
  easy-to-read way. However, in some cases, hostnames may need to be truncated
  (in lookup mode). Similarly, IPv6 addresses may need to be truncated. The
  truncation of names happens from the right for source because you most likely
  know your own domain name, and from the left for destination because knowing
  your users are connection to &quot;mail.a.&quot; doesn't help much. However,
  for addresses, this is reversed.
<div class="Pp"></div>
<b>iptstate</b> does not automatically handle window-resizes while in the
  <b>interactive help</b> screen. If you do resize while in this window, you
  should return to the main window, hit <b>ctrl-L</b> to re-calculate and
  re-draw the screen, and then, if you choose, return to the <b>interactive
  help</b>.
<div class="Pp"></div>
<b>iptstate</b> currently uses libnetfilter_conntrack to access the netfilter
  connection state table. However, older versions read out of
  /proc/net/ip_conntrack, and the current version can still be compiled to do
  this. This deprecated method can be racy on SMP systems, and can hurt
  performance on very heavily loaded firewalls. This deprecated method should be
  avoided - support will be removed in future versions.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>iptables</b>(8)
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
<b>iptstate</b> was written by Phil Dibowitz &lt;phil AT ipom DOT com&gt;
<div>&#x00A0;</div>
http://www.phildev.net/iptstate/</div>
<table class="foot">
  <tr>
    <td class="foot-date">JUNE 2012</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
