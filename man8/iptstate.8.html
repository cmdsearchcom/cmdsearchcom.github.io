<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:12:28 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>IPTSTATE(8) IPTSTATE(8)</p>

<p style="margin-top: 1em">NAME <br>
iptstate - A top-like display of IP Tables state table
entries</p>

<p style="margin-top: 1em">SYNOPSIS <br>
iptstate [&lt;options&gt;]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
iptstate displays information held in the IP Tables state
table in real-time in a top-like format. Output can be
sorted by any field, or any field reversed. Users can choose
to <br>
have the output only print once and exit, rather than the
top-like system. Refresh rate is configurable, IPs can be
resolved to names, output can be formatted, the display can
be <br>
filtered, and color coding are among some of the many
features.</p>

<p style="margin-top: 1em">COMMAND-LINE OPTIONS <br>
-c, --no-color <br>
Toggle color-code by protocol</p>

<p style="margin-top: 1em">-C, --counters <br>
Toggle display of bytes/packets counters</p>

<p style="margin-top: 1em">-d, --dst-filter IP <br>
Only show states with a destination of IP Note, that this
must be an IP, hostname matching is not yet supported.</p>

<p style="margin-top: 1em">-D --dstpt-filter port <br>
Only show states with a destination port of port</p>

<p style="margin-top: 1em">-h, --help <br>
Show help message</p>

<p style="margin-top: 1em">-l, --lookup <br>
Show hostnames instead of IP addresses</p>

<p style="margin-top: 1em">-m, --mark-truncated <br>
Mark truncated hostnames with a &rsquo;+&rsquo;</p>

<p style="margin-top: 1em">-o, --no-dynamic <br>
Toggle dynamic formatting</p>

<p style="margin-top: 1em">-L, --no-dns <br>
Skip outgoing DNS lookup states</p>

<p style="margin-top: 1em">-f, --no-loopback <br>
Filter states on loopback</p>

<p style="margin-top: 1em">-p, --no-scroll <br>
No scrolling (don&rsquo;t use a &quot;pad&quot;). See
SCROLLING AND PADS for more information.</p>

<p style="margin-top: 1em">-r, --reverse <br>
Reverse sort order</p>

<p style="margin-top: 1em">-R, --rate seconds <br>
Refresh rate, followed by rate in seconds. Note that this is
for statetop mode, and not applicable for single-run mode
(--single).</p>

<p style="margin-top: 1em">-1, --single <br>
Single run (no curses)</p>

<p style="margin-top: 1em">-b, --sort column <br>
This determines what column to sort by. Options: <br>
S Source Port <br>
d Destination IP (or Name) <br>
D Destination Port <br>
p Protocol <br>
s State <br>
t TTL <br>
b Bytes <br>
P Packets <br>
To sort by Source IP (or Name), don&rsquo;t use -b. Sorting
by bytes/packets is only available for kernels that support
it, and only when compiled against libnetfilter_conntrack
<br>
(the default).</p>

<p style="margin-top: 1em">-s, --src-filter IP <br>
Only show states with a source of IP. Note, that this must
be an IP, hostname matching is not yet supported.</p>

<p style="margin-top: 1em">-S, --srcpt-filter port <br>
Only show states with a source port of port</p>

<p style="margin-top: 1em">-t, --totals <br>
Toggle display of totals</p>

<p style="margin-top: 1em">INTERACTIVE OPTIONS <br>
As of version 2.0, all command-line options are now
available interactively using the same key as the
short-option. For example, --sort is also -b, so while
iptstate is running, <br>
hitting b will change the sorting to the next column.
Similarly, t toggles the display of totals, and so on.</p>

<p style="margin-top: 1em">There are also extra interactive
options: B - change sorting to previous column (opposite of
b); q - quit; and x - delete the currently highlighted state
from the netfilter con&acirc; <br>
ntrack table.</p>

<p style="margin-top: 1em">Additionally, the following keys
are used to navigate within iptstate:</p>

<p style="margin-top: 1em">Up or j - Move up one line</p>

<p style="margin-top: 1em">Down or k - Move down one
line</p>

<p style="margin-top: 1em">Left or h - Move left one
column</p>

<p style="margin-top: 1em">Right or l - Move right one
column</p>

<p style="margin-top: 1em">PageUp or ^u - Move up one
page</p>

<p style="margin-top: 1em">PageDown or ^d - Move down one
page</p>

<p style="margin-top: 1em">Home - Go to the top</p>

<p style="margin-top: 1em">End - Go to the end</p>

<p style="margin-top: 1em">In many cases, iptstate needs to
prompt you in order to change something. For example, if you
want to set or change the source-ip filter, when you hit s,
iptstate will pop up a <br>
prompt at the top of the window to ask you what you want to
set it to.</p>

<p style="margin-top: 1em">Note that like many UNIX
applications, ctrl-G will tell iptstate
&quot;nevermind&quot; - it&rsquo;ll remove the prompt and
forget you ever hit s.</p>

<p style="margin-top: 1em">In most cases, a blank response
means &quot;clear&quot; - clear the source IP filter, for
example.</p>

<p style="margin-top: 1em">At anytime while iptstate is
running, you can hit h to get to the interactive help which
will display all the current settings to you as well give
you a list of all interactive <br>
commands available.</p>

<p style="margin-top: 1em">While running, space will
immediately update the display. Iptstate should gracefully
handle all window resizes, but if it doesn&rsquo;t, you can
force it to re-calculate and re-draw <br>
the screen with a ctrl-L.</p>

<p style="margin-top: 1em">SCROLLING AND PADS <br>
For almost any user, there is no reason to turn off
scrolling. The ability to turn this off - and especially the
ability to toggle this interactively - is done more for
theoreti&acirc; <br>
cal completeness than anything else.</p>

<p style="margin-top: 1em">But, nonetheless, here are the
details. Typically in a curses application you create a
&quot;window.&quot; Windows don&rsquo;t scroll, however.
They are, at most, the size of your terminal. Win&acirc;
<br>
dows provide double-buffering to make refreshing as fast and
seemless as possible. However, to enable scrolling, one has
to use &quot;pads&quot; instead of windows. Pads can be
bigger than <br>
the current terminal. Then all necessary data is written to
the pad, and &quot;scrolling&quot; becomes a function of
just showing the right part of that pad on the screen.</p>

<p style="margin-top: 1em">However, pads do not have the
double-buffering feature that windows have. Thus, there
_might_ be some case where for some user using some very
strange machine, having scrolling <br>
enabled could cause poor refreshing. Given the nature of the
way iptstate uses the screen though, I find this highly
unlikely. In addition, the scrolling method uses a little
<br>
more memory. However, iptstate is not a memory intensive
application, so this shouldn&rsquo;t be a problem even on
low-memory systems.</p>

<p style="margin-top: 1em">Nonetheless, if this does
negatively affect you, the option to turn it off is
there.</p>

<p style="margin-top: 1em">EXIT STATUS <br>
Anything other than 0 indicates and error. A list of current
exit statuses are below:</p>

<p style="margin-top: 1em">0 Success</p>

<p style="margin-top: 1em">1 Bad command-line arguments</p>

<p style="margin-top: 1em">2 Error communicating with the
netfilter subsystem.</p>

<p style="margin-top: 1em">3 Terminal too narrow</p>

<p style="margin-top: 1em">BUGS <br>
We don&rsquo;t support filtering on resolved names, and we
don&rsquo;t support filtering on networks. IPv6 support is
new and the dynamic formatting doesn&rsquo;t yet always
handle IPv6 addresses <br>
as well as it should.</p>

<p style="margin-top: 1em">BUG REPORTS <br>
All bugs should be reported to Phil Dibowitz &lt;phil AT
ipom DOT com&gt;. Please see the README and BUGS for more
information on bug reports. Please read the WISHLIST before
sending <br>
in features you hope to see.</p>

<p style="margin-top: 1em">NOTES <br>
iptstate does a lot of work to try to fit everything on the
screen in an easy-to-read way. However, in some cases,
hostnames may need to be truncated (in lookup mode).
Similarly, <br>
IPv6 addresses may need to be truncated. The truncation of
names happens from the right for source because you most
likely know your own domain name, and from the left for
desti&acirc; <br>
nation because knowing your users are connection to
&quot;mail.a.&quot; doesn&rsquo;t help much. However, for
addresses, this is reversed.</p>

<p style="margin-top: 1em">iptstate does not automatically
handle window-resizes while in the interactive help screen.
If you do resize while in this window, you should return to
the main window, hit ctrl- <br>
L to re-calculate and re-draw the screen, and then, if you
choose, return to the interactive help.</p>

<p style="margin-top: 1em">iptstate currently uses
libnetfilter_conntrack to access the netfilter connection
state table. However, older versions read out of
/proc/net/ip_conntrack, and the current version <br>
can still be compiled to do this. This deprecated method can
be racy on SMP systems, and can hurt performance on very
heavily loaded firewalls. This deprecated method should be
<br>
avoided - support will be removed in future versions.</p>

<p style="margin-top: 1em">SEE ALSO <br>
iptables(8)</p>

<p style="margin-top: 1em">AUTHOR <br>
iptstate was written by Phil Dibowitz &lt;phil AT ipom DOT
com&gt; <br>
http://www.phildev.net/iptstate/</p>

<p style="margin-top: 1em">JUNE 2012 IPTSTATE(8)</p>
<hr>
</body>
</html>
