<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:15:10 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>REAR(8) REAR(8)</p>

<p style="margin-top: 1em">NAME <br>
rear - bare metal disaster recovery and system migration
tool</p>

<p style="margin-top: 1em">SYNOPSIS <br>
rear [-dDsSvV] [-r KERNEL] COMMAND [-- ARGS...]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Relax-and-Recover is the leading Open Source disaster
recovery solution. It is a modular framework with many
ready-to-go workflows for common situations.</p>

<p style="margin-top: 1em">Relax-and-Recover produces a
bootable image. This image can repartition the system. Once
that is done it initiates a restore from backup. Restores to
different hardware are <br>
possible. Relax-and-Recover can therefore be used as a
migration tool as well.</p>

<p style="margin-top: 1em">Currently Relax-and-Recover
supports various boot media (incl. ISO, PXE, OBDR tape, USB
or eSATA storage), a variety of network protocols (incl.
sftp, ftp, http, nfs, cifs) for <br>
storage and backup as well as a multitude of backup
strategies (incl. IBM Tivoli Storage Manager, HP
DataProtector, Symantec NetBackup, EMC NetWorker, Bareos,
Bacula, rsync, <br>
rbme). This results in a bootable image that os capable of
booting via PXE, DVD/CD, bootable tape or virtual
provisioning.</p>

<p style="margin-top: 1em">Relax-and-Recover was designed
to be easy to set up, requires no maintenance and is there
to assist when disaster strikes. Its setup-and-forget nature
removes any excuses for not <br>
having a disaster recovery solution implemented.</p>

<p style="margin-top: 1em">Recovering from disaster is made
very straight-forward by a 2-step recovery process so that
it can be executed by operational teams when required. When
used interactively (e.g. <br>
when used for migrating systems), menus help make decisions
to restore to a new (hardware) environment.</p>

<p style="margin-top: 1em">Extending Relax-and-Recover is
made possible by its modular framework. Consistent logging
and optionally extended output help understand the concepts
behind Relax-and-Recover and <br>
help debug during development.</p>

<p style="margin-top: 1em">Relax-and-Recover comes with
ABSOLUTELY NO WARRANTY; for details see the GNU General
Public License at: http://www.gnu.org/licenses/gpl.html</p>

<p style="margin-top: 1em">OPTIONS <br>
GLOBAL OPTIONS <br>
-d <br>
debug mode (log debug messages to log file)</p>

<p style="margin-top: 1em">-D <br>
debugscript mode (log every function call)</p>

<p style="margin-top: 1em">-r KERNEL <br>
kernel version to use (by default use running kernel)</p>

<p style="margin-top: 1em">-s <br>
simulation mode (show what scripts rear would include)</p>

<p style="margin-top: 1em">-S <br>
step-by-step mode (acknowledge each script individually)</p>

<p style="margin-top: 1em">-v <br>
verbose mode (show progress output)</p>

<p style="margin-top: 1em">-V <br>
version information</p>

<p style="margin-top: 1em">COMMANDS <br>
checklayout <br>
check if the disk layout has changed since the last run of
mkbackup/mkrescue</p>

<p style="margin-top: 1em">dump <br>
dump configuration and system information; please run this
to verify your setup</p>

<p style="margin-top: 1em">format <br>
format and label USB or tape media to be used with rear;</p>

<p style="margin-top: 1em">first argument is the USB or
tape device to use, eg. /dev/sdX or /dev/stX</p>

<p style="margin-top: 1em">help <br>
print full list of commands and options</p>

<p style="margin-top: 1em">mkbackup <br>
create rescue media and backup the system (only for internal
backup methods)</p>

<p style="margin-top: 1em">mkbackuponly <br>
backup the system (only for internal backup methods) without
creating rescue media</p>

<p style="margin-top: 1em">mkrescue <br>
create rescue media only</p>

<p style="margin-top: 1em">recover <br>
recover the system; can be used only when running from the
rescue media</p>

<p style="margin-top: 1em">validate <br>
submit validation information</p>

<p style="margin-top: 1em">Use rear -v help for more
advanced commands.</p>

<p style="margin-top: 1em">BACKGROUND INFORMATION <br>
The process of bare metal disaster recovery consists of two
parts:</p>

<p style="margin-top: 1em">&Acirc;&middot; Recreate the
system layout</p>

<p style="margin-top: 1em">&Acirc;&middot; Restore the data
to the system</p>

<p style="margin-top: 1em">Most backup software solutions
are very good at restoring data but do not support
recreating the system layout. Relax-and-Recover is very good
at recreating the system layout but <br>
works best when used together with supported backup
software.</p>

<p style="margin-top: 1em">In this combination
Relax-and-Recover recreates the system layout and calls the
backup software to restore the actual data. Thus there is no
unnessecary duplicate data storage <br>
and the Relax-and-Recover rescue media can be very
small.</p>

<p style="margin-top: 1em">For demonstration and special
use purposes Relax-and-Recover also includes an internal
backup method, NETFS, which can be used to create a simple
tar.gz archive of the system. <br>
For all permanent setups we recommend using something more
professional for backup, either a traditional backup
software (open source or commercial) or rsync with hardlink
based <br>
solutions, e.g. RSYNC BACKUP MADE EASY.</p>

<p style="margin-top: 1em">RESCUE IMAGE CONFIGURATION <br>
The OUTPUT variable defines how from where our rescue image
will be booted and the OUTPUT_URL variable defines where the
rescue image should be send to. Possible OUTPUT setting <br>
are:</p>

<p style="margin-top: 1em">OUTPUT=RAMDISK <br>
Create only the Relax-and-Recover initramfs.</p>

<p style="margin-top: 1em">OUTPUT=ISO <br>
(Default) Create a bootable ISO9660 image on disk as
rear-$(hostname).iso</p>

<p style="margin-top: 1em">OUTPUT=PXE <br>
Create on a remote PXE/NFS server the required files (such
as configuration file, kernel and initrd image</p>

<p style="margin-top: 1em">OUTPUT=OBDR <br>
Create a bootable OBDR tape (optionally including the backup
archive). Specify the OBDR tape device by using
TAPE_DEVICE.</p>

<p style="margin-top: 1em">OUTPUT=USB <br>
Create a bootable USB disk (using extlinux). Specify the USB
storage device by using USB_DEVICE.</p>

<p style="margin-top: 1em">When using OUTPUT=ISO, RAMDISK,
OBDR or USB you should provide the backup target location
through the OUTPUT_URL variable. Possible OUTPUT_URL
settings are:</p>

<p style="margin-top: 1em">OUTPUT_URL=file:// <br>
Write the image to disk. The default is in
/var/lib/rear/output/.</p>

<p style="margin-top: 1em">OUTPUT_URL=fish:// <br>
Write the image using lftp and the FISH protocol.</p>

<p style="margin-top: 1em">OUTPUT_URL=ftp:// <br>
Write the image using lftp and the FTP protocol.</p>

<p style="margin-top: 1em">OUTPUT_URL=ftps:// <br>
Write the image using lftp and the FTPS protocol.</p>

<p style="margin-top: 1em">OUTPUT_URL=hftp:// <br>
Write the image using lftp and the HFTP protocol.</p>

<p style="margin-top: 1em">OUTPUT_URL=http:// <br>
Write the image using lftp and the HTTP (PUT) procotol.</p>

<p style="margin-top: 1em">OUTPUT_URL=https:// <br>
Write the image using lftp and the HTTPS (PUT) protocol.</p>

<p style="margin-top: 1em">OUTPUT_URL=sftp:// <br>
Write the image using lftp and the secure FTP (SFTP)
protocol.</p>

<p style="margin-top: 1em">OUTPUT_URL=rsync:// <br>
Write the image using rsync and the RSYNC protocol (SSH
only).</p>

<p style="margin-top: 1em">OUTPUT_URL=sshfs:// <br>
Write the image using sshfs and the SSH protocol.</p>

<p style="margin-top: 1em">OUTPUT_URL=null <br>
Do not copy the ISO image from /var/lib/rear/output/ to an
external destination. Useful in combination with an external
backup program, or when BACKUP_URL=iso://backup</p>

<p style="margin-top: 1em">BACKUP SOFTWARE INTEGRATION <br>
Currently Relax-and-Recover supports the following backup
methods. Please distinguish carefully between
Relax-and-Recover support for 3rd party backup software and
<br>
Relax-and-Recover internal backup methods. The latter also
creates a backup of your data while the former will only
integrate Relax-and-Recover with the backup software to <br>
restore the data with the help of the backup software
without actually creating backups. This means that for all
non-internal backup software you must take care of creating
<br>
backups yourself.</p>

<p style="margin-top: 1em">Especially the rear mkbackup
command can be confusing as it is only useful for the
internal backup methods and has no function at all with the
other (external) backup methods.</p>

<p style="margin-top: 1em">The following backup methods
need to be set in Relax-and-Recover with the BACKUP option.
As mentioned we have two types of BACKUP methods - internal
and external.</p>

<p style="margin-top: 1em">The following BACKUP methods are
external of Relax-and-Recover meaning that you are
responsible of backups being made:</p>

<p style="margin-top: 1em">BACKUP=REQUESTRESTORE <br>
(default) Not really a backup method at all,
Relax-and-Recover simply halts the recovery and requests
that somebody will restore the data to the appropriate
location (e.g. <br>
via SSH). This method works especially well with an rsync
bases backup that is pushed back to the backup client.</p>

<p style="margin-top: 1em">BACKUP=EXTERNAL <br>
Internal backup method that uses an arbitrary external
command to create a backup and restore the data.</p>

<p style="margin-top: 1em">BACKUP=DP <br>
Use HP Data Protector to restore the data.</p>

<p style="margin-top: 1em">BACKUP=GALAXY <br>
Use CommVault Galaxy 5 to restore the data.</p>

<p style="margin-top: 1em">BACKUP=GALAXY7 <br>
Use CommVault Galaxy 7 to restore the data.</p>

<p style="margin-top: 1em">BACKUP=GALAXY10 <br>
Use CommVault Galaxy 10 (or Simpana 10) to restore the
data.</p>

<p style="margin-top: 1em">BACKUP=NBU <br>
Use Symantec NetBackup to restore the data.</p>

<p style="margin-top: 1em">BACKUP=TSM <br>
Use IBM Tivoli Storage Manager to restore the data. The
Relax-and-Recover result files (e.g. ISO image) are also
saved into TSM.</p>

<p style="margin-top: 1em">BACKUP=NSR <br>
Using EMC NetWorker (Legato) to restore the data.</p>

<p style="margin-top: 1em">BACKUP=SESAM <br>
Using SEP Sesam to restore the data.</p>

<p style="margin-top: 1em">BACKUP=RBME <br>
Use Rsync Backup Made Easy (rbme) to restore the data.</p>

<p style="margin-top: 1em">BACKUP=BAREOS <br>
Use Open Source backup solution BAREOS (a fork a BUCULA) to
restore the data.</p>

<p style="margin-top: 1em">BACKUP=BACULA <br>
Use Open Source backup solution BACULA to restore the
data.</p>

<p style="margin-top: 1em">BACKUP=DUPLICITY <br>
Use encrypted bandwidth-efficient backup solution using the
rsync algorithm to restore the data.</p>

<p style="margin-top: 1em">The following BACKUP methods are
internal of Relax-and-Recover:</p>

<p style="margin-top: 1em">BACKUP=NETFS <br>
Internal backup method which can be used to create a simple
backup (tar archive).</p>

<p style="margin-top: 1em">BACKUP=RSYNC <br>
Use rsync to restore data.</p>

<p style="margin-top: 1em">If your favourite backup
software is missing from this list, please submit a patch or
ask us to implement it for you.</p>

<p style="margin-top: 1em">When using BACKUP=NETFS you
should provide the backup target location through the
BACKUP_URL variable. Possible BACKUP_URL settings are:</p>

<p style="margin-top: 1em">BACKUP_URL=file:// <br>
To backup to local disk, use
BACKUP_URL=file:///directory/path/</p>

<p style="margin-top: 1em">BACKUP_URL=nfs:// <br>
To backup to NFS disk, use
BACKUP_URL=nfs://nfs-server-name/share/path</p>

<p style="margin-top: 1em">BACKUP_URL=tape:// <br>
To backup to tape device, use BACKUP_URL=tape:///dev/nst0 or
alternatively, simply define TAPE_DEVICE=/dev/nst0</p>

<p style="margin-top: 1em">BACKUP_URL=cifs:// <br>
To backup to a Samba share (CIFS), use
BACKUP_URL=cifs://cifs-server-name/share/path. To provide
credentials for CIFS mounting use a /etc/rear/.cifs
credentials file and <br>
define BACKUP_OPTIONS=&quot;cred=/etc/rear/.cifs&quot; and
pass along:</p>

<p style="margin-top: 1em">username=_username_ <br>
password=_secret password_ <br>
domain=_domain_</p>

<p style="margin-top: 1em">BACKUP_URL=usb:// <br>
To backup to USB storage device, use
BACKUP_URL=usb:///dev/disk/by-path/REAR-000 or use a real
device node or a specific filesystem label. Alternatively,
you can specify the <br>
device using USB_DEVICE=/dev/disk/by-path/REAR-000.</p>

<p style="margin-top: 1em">If you combine this with
OUTPUT=USB you will end up with a bootable USB device.</p>

<p style="margin-top: 1em">BACKUP_URL=sshfs:// <br>
To backup to a remote server via sshfs (SSH protocol), use
BACKUP_URL=sshfs://user@remote-system.domain.org/home/user/backup-dir/</p>

<p style="margin-top: 1em">It is advisable to add
ServerAliveInterval 15 in the /root/.ssh/config file for the
remote system (remote-system.domain.org).</p>

<p style="margin-top: 1em">BACKUP_URL=iso:// <br>
To include the backup within the ISO image. It is important
that the BACKUP_URL and OUTPUT_URL variables are different.
E.g.</p>

<p style="margin-top: 1em">BACKUP_URL=iso:///backup/ <br>
OUTPUT_URL=nfs://server/path/</p>

<p style="margin-top: 1em">When using BACKUP=NETFS there is
an option to select a BACKUP_TYPE=incremental to have rear
make incrementals until the next
FULLBACKUPDAY=&quot;Mon&quot; has reached.</p>

<p style="margin-top: 1em">CONFIGURATION <br>
To configure Relax-and-Recover you have to edit the
configuration files in /etc/rear/. All *.conf files there
are part of the configuration, but only site.conf and
local.conf are <br>
intended for the user configuration. All other configuration
files hold defaults for various distributions and should not
be changed.</p>

<p style="margin-top: 1em">In /etc/rear/templates/ there
are also some template files which are used by
Relax-and-Recover to create configuration files (mostly for
the boot environment). Modify the <br>
templates to adjust the information contained in the emails
produced by Relax-and-Recover. You can use these templates
to prepend your own configurations to the configuration <br>
files created by Relax-and-recover, for example you can edit
PXE_pxelinux.cfg to add some general pxelinux configuration
you use.</p>

<p style="margin-top: 1em">In almost all circumstances you
have to configure two main settings and their parameters:
The backup method and the output method.</p>

<p style="margin-top: 1em">The backup method defines, how
your data was saved and wether Relax-and-Recover should
backup your data as part of the mkrescue process or wether
you use an external application, <br>
e.g. backup software to archive your data.</p>

<p style="margin-top: 1em">The output method defines how
the rescue system is written to disk and how you plan to
boot the failed computer from the rescue system.</p>

<p style="margin-top: 1em">See the default configuration
file /usr/share/rear/conf/default.conf for an overview of
the possible methods and their options.</p>

<p style="margin-top: 1em">An example to use TSM for backup
and ISO for output would be to add these lines to
/etc/rear/local.conf (no need to define a BACKUP_URL when
using an external backup solution):</p>

<p style="margin-top: 1em">BACKUP=TSM <br>
OUTPUT=ISO</p>

<p style="margin-top: 1em">And if all your systems use NTP
for time synchronisation, you can also add these lines to
/etc/rear/site.conf</p>

<p style="margin-top: 1em">TIMESYNC=NTP</p>

<p style="margin-top: 1em">Do not forget to distribute the
site.conf to all your systems.</p>

<p style="margin-top: 1em">The resulting ISO image will be
created in /var/lib/rear/output/. You can now modify the
behaviour by copying the appropriate configuration variables
from default.conf to <br>
local.conf and changing them to suit your environment.</p>

<p style="margin-top: 1em">EXIT STATUS <br>
0 <br>
Successful program execution.</p>

<p style="margin-top: 1em">&gt;0 <br>
Usage, syntax or execution errors. Check the log file in
/var/log/rear/ for more information.</p>

<p style="margin-top: 1em">EXAMPLES <br>
To print out the current settings for BACKUP and OUTPUT
methods and some system information. This command can be
used to see the supported features for the given release and
<br>
platform.</p>

<p style="margin-top: 1em"># rear dump</p>

<p style="margin-top: 1em">To create a new rescue
environment. Do not forget to copy the resulting rescue
system away so that you can use it in the case of a system
failure.</p>

<p style="margin-top: 1em"># rear -v mkrescue</p>

<p style="margin-top: 1em">To create a new rescue image
together with a complete archive of your local system run
the command:</p>

<p style="margin-top: 1em"># rear -v mkbackup</p>

<p style="margin-top: 1em">FILES <br>
/usr/sbin/rear <br>
The program itself.</p>

<p style="margin-top: 1em">/etc/rear/local.conf <br>
System specific configuration can be set here.</p>

<p style="margin-top: 1em">/etc/rear/site.conf <br>
Site specific configuration can be set here (not created by
default).</p>

<p style="margin-top: 1em">/var/log/rear/ <br>
Directory holding the log files.</p>

<p style="margin-top: 1em">/tmp/rear.#### <br>
Relax-and-Recover working directory. If Relax-and-Recover
exits with an error, you must remove this directory
manually.</p>

<p style="margin-top: 1em">/usr/share/rear <br>
Relax-and-Recover script components.</p>


<p style="margin-top: 1em">/usr/share/rear/conf/default.conf
<br>
Relax-and-Recover default values. Contains a complete set of
parameters and its explanation. Please do not edit or
modify. Copy values to local.conf or site.conf instead.</p>

<p style="margin-top: 1em">BUGS <br>
Feedback is welcome, please report any issues or
improvements to our issue-tracker at:
http://github.com/rear/issues/</p>

<p style="margin-top: 1em">Furthermore, we welcome pull
requests via GitHub.</p>

<p style="margin-top: 1em">SEE ALSO <br>
Relax-and-Recover comes with extensive documentation located
in /usr/share/doc.</p>

<p style="margin-top: 1em">AUTHORS <br>
Gratien Dhaese, Schlomo Schapiro, Jeroen Hoekx and Dag
Wieers.</p>

<p style="margin-top: 1em">Lars Pinne (original man
page).</p>

<p style="margin-top: 1em">Relax-and-Recover is a
collaborative process using Github at:
http://github.com/rear/</p>

<p style="margin-top: 1em">The Relax-and-Recover website is
located at: http://relax-and-recover.org/</p>

<p style="margin-top: 1em">COPYRIGHT <br>
(c) 2006-2015</p>

<p style="margin-top: 1em">Schlomo Schapiro</p>

<p style="margin-top: 1em">Gratien Dhaese, IT3
Consultants</p>

<p style="margin-top: 1em">Jeroen Hoekx</p>

<p style="margin-top: 1em">Dag Wieers, Dagit Linux
Solutions</p>

<p style="margin-top: 1em">Relax-and-Recover comes with
ABSOLUTELY NO WARRANTY; for details see the GNU General
Public License at http://www.gnu.org/licenses/gpl.html</p>

<p style="margin-top: 1em">31 August 2015 REAR(8)</p>
<hr>
</body>
</html>
