<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>VIRT-WHO(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">VIRT-WHO(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">VIRT-WHO(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
virt-who - Agent for reporting virtual guest IDs to Subscription Asset Manager,
  Satellite 6, or Satellite 5.
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
virt-who [-d] [-i INTERVAL] [-b] [-o] [--sam|--satellite5|--satellite6]
  [--libvirt|--vdsm|--esx|--rhevm|--hyperv]
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h</b>, <b>--help</b></dt>
  <dd class="It-tag">show this help message and exit</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d</b>, <b>--debug</b></dt>
  <dd class="It-tag">Enable debugging output</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-o</b>, <b>--one-shot</b></dt>
  <dd class="It-tag">Send the list of guest IDs and exit immediately</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i</b> INTERVAL, <b>--interval</b>=<i>INTERVAL</i></dt>
  <dd class="It-tag">Acquire and send guest information each N seconds; note
      that this option is recommendation only, requested interval might not been
      honoured and the actual interval might be longer or shorter depending on
      backend that is used.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p</b>, <b>--print</b></dt>
  <dd class="It-tag">Print the host/guests association in JSON format to
    stdout</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c</b>, <b>--config</b></dt>
  <dd class="It-tag">Use configuration file directly, can be used multiple
      times. See virt-who-config(5) for details about configuration file
    format.</dd>
</dl>
<h2 class="Ss" title="Ss" id="Virtualization_backend"><a class="selflink" href="#Virtualization_backend">Virtualization
  backend</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Choose virtualization backend that should be used to gather
      host/guest associations</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--libvirt</b></dt>
  <dd class="It-tag">Use libvirt to list virtual guests [default]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--vdsm</b></dt>
  <dd class="It-tag">Use vdsm to list virtual guests</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--esx</b></dt>
  <dd class="It-tag">Register ESX machines using vCenter</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--rhevm</b></dt>
  <dd class="It-tag">Register guests using RHEV-M</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--hyperv</b></dt>
  <dd class="It-tag">Register guests using Hyper-V</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--xen</b></dt>
  <dd class="It-tag">Register XEN machines using XenServer</dd>
</dl>
<h2 class="Ss" title="Ss" id="Subscription_manager"><a class="selflink" href="#Subscription_manager">Subscription
  manager</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Choose where the host/guest associations should be
    reported</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--sam</b></dt>
  <dd class="It-tag">Report host/guest associations to the Subscription Asset
      Manager or Satellite 6 [default]</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--satellite5</b></dt>
  <dd class="It-tag">Report host/guest associations to the Satellite 5
    server</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><b>--satellite6</b> Report host/guest associations to the
      Satellite 6 server</dd>
</dl>
<h2 class="Ss" title="Ss" id="Libvirt_options"><a class="selflink" href="#Libvirt_options">Libvirt
  options</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Use this options with <b>--libvirt</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--libvirt-owner</b>=<i>OWNER</i></dt>
  <dd class="It-tag">Organization who has purchased subscriptions of the
      products, same as current system registration by default</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--libvirt-env</b>=<i>ENV</i></dt>
  <dd class="It-tag">Environment where the libvirt server belongs to, same as
      current system registration by default</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--libvirt-server</b>=<i>SERVER</i></dt>
  <dd class="It-tag">URL of the remote libvirt server to connect to, local
      server by default</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--libvirt-username</b>=<i>USERNAME</i></dt>
  <dd class="It-tag">Username for connecting to libvirt, username of current
      user by default</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--libvirt-password</b>=<i>PASSWORD</i></dt>
  <dd class="It-tag">Password for connecting to libvirt. This option doesn't
      work with ssh transport (default), copy your public ssh key to the remote
      machine.</dd>
</dl>
<h2 class="Ss" title="Ss" id="vCenter/ESX_options"><a class="selflink" href="#vCenter/ESX_options">vCenter/ESX
  options</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Use this options with <b>--esx</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--esx-owner</b>=<i>OWNER</i></dt>
  <dd class="It-tag">Organization who has purchased subscriptions of the
      products</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--esx-env</b>=<i>ENV</i></dt>
  <dd class="It-tag">Environment where the vCenter server belongs to</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--esx-server</b>=<i>SERVER</i></dt>
  <dd class="It-tag">URL of the vCenter server to connect to</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--esx-username</b>=<i>USERNAME</i></dt>
  <dd class="It-tag">Username for connecting to vCenter</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--esx-password</b>=<i>PASSWORD</i></dt>
  <dd class="It-tag">Password for connecting to vCenter</dd>
</dl>
<h2 class="Ss" title="Ss" id="RHEV-M_options"><a class="selflink" href="#RHEV-M_options">RHEV-M
  options</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Use this options with <b>--rhevm</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--rhevm-owner</b>=<i>OWNER</i></dt>
  <dd class="It-tag">Organization who has purchased subscriptions of the
      products</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--rhevm-env</b>=<i>ENV</i></dt>
  <dd class="It-tag">Environment where the RHEV-M belongs to</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--rhevm-server</b>=<i>SERVER</i></dt>
  <dd class="It-tag">URL of the RHEV-M server to connect to</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--rhevm-username</b>=<i>USERNAME</i></dt>
  <dd class="It-tag">Username for connecting to RHEV-M</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--rhevm-password</b>=<i>PASSWORD</i></dt>
  <dd class="It-tag">Password for connecting to RHEV-M</dd>
</dl>
<h2 class="Ss" title="Ss" id="Hyper-V_options"><a class="selflink" href="#Hyper-V_options">Hyper-V
  options</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Use this options with <b>--hyperv</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--hyperv-owner</b>=<i>OWNER</i></dt>
  <dd class="It-tag">Organization who has purchased subscriptions of the
      products</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--hyperv-env</b>=<i>ENV</i></dt>
  <dd class="It-tag">Environment where the Hyper-V belongs to</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--hyperv-server</b>=<i>SERVER</i></dt>
  <dd class="It-tag">URL of the Hyper-V server to connect to</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--hyperv-username</b>=<i>USERNAME</i></dt>
  <dd class="It-tag">Username for connecting to Hyper-V</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--hyperv-password</b>=<i>PASSWORD</i></dt>
  <dd class="It-tag">Password for connecting to Hyper-V</dd>
</dl>
<h2 class="Ss" title="Ss" id="XenServer_options"><a class="selflink" href="#XenServer_options">XenServer
  options</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Use this options with <b>--xen</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--xen-owner</b>=<i>OWNER</i></dt>
  <dd class="It-tag">Organization who has purchased subscriptions of the
      products</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--xen-env</b>=<i>ENV</i></dt>
  <dd class="It-tag">Environment where the XenServer belongs to</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--xen-server</b>=<i>SERVER</i></dt>
  <dd class="It-tag">URL of the XenServer server to connect to</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--xen-username</b>=<i>USERNAME</i></dt>
  <dd class="It-tag">Username for connecting to XenServer</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--xen-password</b>=<i>PASSWORD</i></dt>
  <dd class="It-tag">Password for connecting to XenServer</dd>
</dl>
<h2 class="Ss" title="Ss" id="Satellite_5_options:"><a class="selflink" href="#Satellite_5_options:">Satellite
  5 options:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Use this options with <b>--satellite5</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--satellite-server</b>=<i>SAT_SERVER</i></dt>
  <dd class="It-tag">Satellite server URL</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--satellite-username</b>=<i>SAT_USERNAME</i></dt>
  <dd class="It-tag">Username for connecting to Satellite server</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--satellite-password</b>=<i>SAT_PASSWORD</i></dt>
  <dd class="It-tag">Password for connecting to Satellite server</dd>
</dl>
<h1 class="Sh" title="Sh" id="ENVIRONMENT"><a class="selflink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
virt-who also reads environmental variables. They have the same name as command
  line arguments but upper-cased, with underscore instead of dash and prefixed
  with VIRTWHO_ (e.g. VIRTWHO_ONE_SHOT). Empty variables are considered as
  disabled, non-empty as enabled
<h1 class="Sh" title="Sh" id="USAGE"><a class="selflink" href="#USAGE">USAGE</a></h1>
<h2 class="Ss" title="Ss" id="MODE"><a class="selflink" href="#MODE">MODE</a></h2>
virt-who has three modes how it can run:
<dl class="Bl-tag">
  <dt class="It-tag">1. one-shot mode</dt>
  <dd class="It-tag"># virt-who -o
    <div style="height: 1.00em;">&#x00A0;</div>
    In this mode virt-who just sends the host to guest association to the server
      once and then exits.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">2. interval mode</dt>
  <dd class="It-tag"># virt-who
    <div style="height: 1.00em;">&#x00A0;</div>
    This is default mode. virt-who will listen to change events (if available)
      or do a polling with given interval, and will send the host to guest
      association when it changes. The default polling interval is 60 seconds
      and can be changed using &quot;-i INTERVAL&quot; (in seconds).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">3. print mode</dt>
  <dd class="It-tag"># virt-who -p
    <div style="height: 1.00em;">&#x00A0;</div>
    This mode is similar to oneshot mode but the host to guest association is
      not send to server, but printed to standard output instead.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h2 class="Ss" title="Ss" id="VIRTUALIZATION_BACKEND"><a class="selflink" href="#VIRTUALIZATION_BACKEND">VIRTUALIZATION
  BACKEND</a></h2>
virt-who can use couple of virtualization backends.
<dl class="Bl-tag">
  <dt class="It-tag">1. libvirt</dt>
  <dd class="It-tag"># virt-who
    <div style="height: 1.00em;">&#x00A0;</div>
    # virt-who --libvirt
    <div style="height: 1.00em;">&#x00A0;</div>
    Use libvirt as virtualization backend. This is default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    NOTE: virt-who can monitor for events only in this mode.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">2. vdsm</dt>
  <dd class="It-tag"># virt-who --vdsm
    <div style="height: 1.00em;">&#x00A0;</div>
    Use vdsm as virtualization backend.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">3. ESX</dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    # virt-who --esx --esx-owner=ESX_OWNER --esx-env=ESX_ENV
      --esx-server=ESX_SERVER --esx-username=ESX_USERNAME
      --esx-password=ESX_PASSWORD
    <div style="height: 1.00em;">&#x00A0;</div>
    Use ESX (vCenter) as virtualization backend and specify option required to
      connect to ESX server.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">4. RHEV-M</dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    # virt-who --rhevm --rhevm-owner=RHEVM_OWNER --rhevm-env=RHEVM_ENV
      --rhevm-server=RHEVM_SERVER --rhevm-username=RHEVM_USERNAME
      --rhevm-password=RHEVM_PASSWORD
    <div style="height: 1.00em;">&#x00A0;</div>
    Use RHEV-M as virtualization backend and specify option required to connect
      to RHEV-M server.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">5. Hyper-V</dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    # virt-who --hyperv --hyperv-owner=HYPERV_OWNER --hyperv-env=HYPERV_ENV
      --hyperv-server=HYPERV_SERVER --hyperv-username=HYPERV_USERNAME
      --hyperv-password=HYPERV_PASSWORD
    <div style="height: 1.00em;">&#x00A0;</div>
    Use Hyper-V as virtualization backend and specify option required to connect
      to Hyper-V server.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">6. XenServer</dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    # virt-who --xen --xen-owner=XEN_OWNER --xen-env=XEN_ENV
      --xen-server=XEN_SERVER --xen-username=XEN_USERNAME
      --xen-password=XEN_PASSWORD
    <div style="height: 1.00em;">&#x00A0;</div>
    Use Citrix XenServer as virtualization backend and specify option required
      to connect to XenServer server.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">7. Fake</dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    Fake virtualization backend fetches the host/guests association from file.
      This can be useful in environments where the hypervisor is not accessible
      by virt-who. It's only available through configuration file, see
      virt-who-config(5) for details about configuration of this backend.
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h2 class="Ss" title="Ss" id="SUBSCRIPTION_MANAGER"><a class="selflink" href="#SUBSCRIPTION_MANAGER">SUBSCRIPTION
  MANAGER</a></h2>
virt-who can report host/guest associations to Subscription Asset Manager (SAM),
  to Satellite 5, or to Satellite 6.
<dl class="Bl-tag">
  <dt class="It-tag">1. Subscription Asset Manager or Satellite 6</dt>
  <dd class="It-tag"># virt-who
    <div style="height: 1.00em;">&#x00A0;</div>
    # virt-who --sam
    <div style="height: 1.00em;">&#x00A0;</div>
    System must be registered using subscription-manager prior to using
      virt-who. Configuration for connecting to SAM is shared between
      subscription-manager and virt-who. This is default.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">2. Satellite 6</dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    # virt-who --satellite6
    <div style="height: 1.00em;">&#x00A0;</div>
    System must be registered using subscription-manager prior to using
      virt-who. Configuration for connecting to Satellite 6 is shared between
      subscription-manager and virt-who.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">2. Satellite 5</dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    # virt-who --satellite5 --satellite-server=SAT_SERVER
      --satellite-username=SAT_USERNAME --satellite-password=SAT_PASSWORD
    <div style="height: 1.00em;">&#x00A0;</div>
    This option can't be used for monitoring local guests, use
      rhn-virtualization-host instead.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="LOGGING"><a class="selflink" href="#LOGGING">LOGGING</a></h1>
virt-who always writes error output to file /var/log/rhsm/rhsm.log. In all
  modes, excluding background (&quot;-b&quot;), it writes same output also to
  the standard error output.
<div style="height: 1.00em;">&#x00A0;</div>
virt-who can be started with option &quot;-d&quot; in all modes and with all
  backends. This option will enable verbose output with more information.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SECURITY"><a class="selflink" href="#SECURITY">SECURITY</a></h1>
Virt-who may present security concerns in some scenarios because it needs access
  to every hypervisor in the environment. To minimize security risk, virt-who is
  a network client, not a server. It only does outbound connections to find and
  register new hypervisors and does not need access to any virtual machines. To
  further reduce risk, deploy virt-who in a small virtual machine with a minimal
  installation and lock it down from any unsolicited inbound network
  connections.
<div style="height: 1.00em;">&#x00A0;</div>
Here is a list of ports that need to be open for different hypervisors:
<div style="height: 1.00em;">&#x00A0;</div>
<br/>
 VMWare ESX/vCenter: 443/tcp
<br/>
 Hyper-V: 5985/tcp
<br/>
 RHEV-M: 443/tcp or 8443/tcp (depending on version)
<br/>
 XenServer: 443/tcp
<br/>
 libvirt: depending on transport type, default (for remote connections) is qemu
  over ssh on port 22
<br/>
 local libvirt and vdsm use local connections and don't need open ports
<div style="height: 1.00em;">&#x00A0;</div>
virt-who also needs to have access to Subscription Asset Manager, Satellite 5,
  or Satellite 6. Default port is 443/tcp. All the ports might be changed by
  system administrators.
<div style="height: 1.00em;">&#x00A0;</div>
Using the same network for machine running virt-who as for hypervisor management
  software instead of production VM networks is suggested.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Radek Novacek &lt;rnovacek at redhat dot com&gt;</div>
<table class="foot">
  <tr>
    <td class="foot-date">April 2016</td>
    <td class="foot-os">virt-who</td>
  </tr>
</table>
</body>
</html>
