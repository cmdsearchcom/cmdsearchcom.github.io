<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:17:33 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>VIRT-WHO(8) System Manager&rsquo;s Manual
VIRT-WHO(8)</p>

<p style="margin-top: 1em">NAME <br>
virt-who - Agent for reporting virtual guest IDs to
Subscription Asset Manager, Satellite 6, or Satellite 5.</p>

<p style="margin-top: 1em">SYNOPSIS <br>
virt-who [-d] [-i INTERVAL] [-b] [-o]
[--sam|--satellite5|--satellite6]
[--libvirt|--vdsm|--esx|--rhevm|--hyperv]</p>

<p style="margin-top: 1em">OPTIONS <br>
-h, --help <br>
show this help message and exit</p>

<p style="margin-top: 1em">-d, --debug <br>
Enable debugging output</p>

<p style="margin-top: 1em">-o, --one-shot <br>
Send the list of guest IDs and exit immediately</p>

<p style="margin-top: 1em">-i INTERVAL, --interval=INTERVAL
<br>
Acquire and send guest information each N seconds; note that
this option is recommendation only, requested interval might
not been honoured and the actual interval might <br>
be longer or shorter depending on backend that is used.</p>

<p style="margin-top: 1em">-p, --print <br>
Print the host/guests association in JSON format to
stdout</p>

<p style="margin-top: 1em">-c, --config <br>
Use configuration file directly, can be used multiple times.
See virt-who-config(5) for details about configuration file
format.</p>

<p style="margin-top: 1em">Virtualization backend <br>
Choose virtualization backend that should be used to gather
host/guest associations</p>

<p style="margin-top: 1em">--libvirt <br>
Use libvirt to list virtual guests [default]</p>

<p style="margin-top: 1em">--vdsm Use vdsm to list virtual
guests</p>

<p style="margin-top: 1em">--esx Register ESX machines
using vCenter</p>

<p style="margin-top: 1em">--rhevm <br>
Register guests using RHEV-M</p>

<p style="margin-top: 1em">--hyperv <br>
Register guests using Hyper-V</p>

<p style="margin-top: 1em">--xen Register XEN machines
using XenServer</p>

<p style="margin-top: 1em">Subscription manager <br>
Choose where the host/guest associations should be
reported</p>

<p style="margin-top: 1em">--sam Report host/guest
associations to the Subscription Asset Manager or Satellite
6 [default]</p>

<p style="margin-top: 1em">--satellite5 <br>
Report host/guest associations to the Satellite 5 server</p>

<p style="margin-top: 1em">--satellite6 Report host/guest
associations to the Satellite 6 server</p>

<p style="margin-top: 1em">Libvirt options <br>
Use this options with --libvirt</p>

<p style="margin-top: 1em">--libvirt-owner=OWNER <br>
Organization who has purchased subscriptions of the
products, same as current system registration by default</p>

<p style="margin-top: 1em">--libvirt-env=ENV <br>
Environment where the libvirt server belongs to, same as
current system registration by default</p>

<p style="margin-top: 1em">--libvirt-server=SERVER <br>
URL of the remote libvirt server to connect to, local server
by default</p>

<p style="margin-top: 1em">--libvirt-username=USERNAME <br>
Username for connecting to libvirt, username of current user
by default</p>

<p style="margin-top: 1em">--libvirt-password=PASSWORD <br>
Password for connecting to libvirt. This option
doesn&rsquo;t work with ssh transport (default), copy your
public ssh key to the remote machine.</p>

<p style="margin-top: 1em">vCenter/ESX options <br>
Use this options with --esx</p>

<p style="margin-top: 1em">--esx-owner=OWNER <br>
Organization who has purchased subscriptions of the
products</p>

<p style="margin-top: 1em">--esx-env=ENV <br>
Environment where the vCenter server belongs to</p>

<p style="margin-top: 1em">--esx-server=SERVER <br>
URL of the vCenter server to connect to</p>

<p style="margin-top: 1em">--esx-username=USERNAME <br>
Username for connecting to vCenter</p>

<p style="margin-top: 1em">--esx-password=PASSWORD <br>
Password for connecting to vCenter</p>

<p style="margin-top: 1em">RHEV-M options <br>
Use this options with --rhevm</p>

<p style="margin-top: 1em">--rhevm-owner=OWNER <br>
Organization who has purchased subscriptions of the
products</p>

<p style="margin-top: 1em">--rhevm-env=ENV <br>
Environment where the RHEV-M belongs to</p>

<p style="margin-top: 1em">--rhevm-server=SERVER <br>
URL of the RHEV-M server to connect to</p>

<p style="margin-top: 1em">--rhevm-username=USERNAME <br>
Username for connecting to RHEV-M</p>

<p style="margin-top: 1em">--rhevm-password=PASSWORD <br>
Password for connecting to RHEV-M</p>

<p style="margin-top: 1em">Hyper-V options <br>
Use this options with --hyperv</p>

<p style="margin-top: 1em">--hyperv-owner=OWNER <br>
Organization who has purchased subscriptions of the
products</p>

<p style="margin-top: 1em">--hyperv-env=ENV <br>
Environment where the Hyper-V belongs to</p>

<p style="margin-top: 1em">--hyperv-server=SERVER <br>
URL of the Hyper-V server to connect to</p>

<p style="margin-top: 1em">--hyperv-username=USERNAME <br>
Username for connecting to Hyper-V</p>

<p style="margin-top: 1em">--hyperv-password=PASSWORD <br>
Password for connecting to Hyper-V</p>

<p style="margin-top: 1em">XenServer options <br>
Use this options with --xen</p>

<p style="margin-top: 1em">--xen-owner=OWNER <br>
Organization who has purchased subscriptions of the
products</p>

<p style="margin-top: 1em">--xen-env=ENV <br>
Environment where the XenServer belongs to</p>

<p style="margin-top: 1em">--xen-server=SERVER <br>
URL of the XenServer server to connect to</p>

<p style="margin-top: 1em">--xen-username=USERNAME <br>
Username for connecting to XenServer</p>

<p style="margin-top: 1em">--xen-password=PASSWORD <br>
Password for connecting to XenServer</p>

<p style="margin-top: 1em">Satellite 5 options: <br>
Use this options with --satellite5</p>

<p style="margin-top: 1em">--satellite-server=SAT_SERVER
<br>
Satellite server URL</p>


<p style="margin-top: 1em">--satellite-username=SAT_USERNAME
<br>
Username for connecting to Satellite server</p>


<p style="margin-top: 1em">--satellite-password=SAT_PASSWORD
<br>
Password for connecting to Satellite server</p>

<p style="margin-top: 1em">ENVIRONMENT <br>
virt-who also reads environmental variables. They have the
same name as command line arguments but upper-cased, with
underscore instead of dash and prefixed with VIRTWHO_ (e.g.
<br>
VIRTWHO_ONE_SHOT). Empty variables are considered as
disabled, non-empty as enabled</p>

<p style="margin-top: 1em">USAGE <br>
MODE <br>
virt-who has three modes how it can run:</p>

<p style="margin-top: 1em">1. one-shot mode <br>
# virt-who -o</p>

<p style="margin-top: 1em">In this mode virt-who just sends
the host to guest association to the server once and then
exits.</p>

<p style="margin-top: 1em">2. interval mode <br>
# virt-who</p>

<p style="margin-top: 1em">This is default mode. virt-who
will listen to change events (if available) or do a polling
with given interval, and will send the host to guest
association when it <br>
changes. The default polling interval is 60 seconds and can
be changed using &quot;-i INTERVAL&quot; (in seconds).</p>

<p style="margin-top: 1em">3. print mode <br>
# virt-who -p</p>

<p style="margin-top: 1em">This mode is similar to oneshot
mode but the host to guest association is not send to
server, but printed to standard output instead.</p>

<p style="margin-top: 1em">VIRTUALIZATION BACKEND <br>
virt-who can use couple of virtualization backends.</p>

<p style="margin-top: 1em">1. libvirt <br>
# virt-who</p>

<p style="margin-top: 1em"># virt-who --libvirt</p>

<p style="margin-top: 1em">Use libvirt as virtualization
backend. This is default.</p>

<p style="margin-top: 1em">NOTE: virt-who can monitor for
events only in this mode.</p>

<p style="margin-top: 1em">2. vdsm <br>
# virt-who --vdsm</p>

<p style="margin-top: 1em">Use vdsm as virtualization
backend.</p>

<p style="margin-top: 1em">3. ESX</p>

<p style="margin-top: 1em"># virt-who --esx
--esx-owner=ESX_OWNER --esx-env=ESX_ENV
--esx-server=ESX_SERVER --esx-username=ESX_USERNAME
--esx-password=ESX_PASSWORD</p>

<p style="margin-top: 1em">Use ESX (vCenter) as
virtualization backend and specify option required to
connect to ESX server.</p>

<p style="margin-top: 1em">4. RHEV-M</p>

<p style="margin-top: 1em"># virt-who --rhevm
--rhevm-owner=RHEVM_OWNER --rhevm-env=RHEVM_ENV
--rhevm-server=RHEVM_SERVER --rhevm-username=RHEVM_USERNAME
--rhevm-password=RHEVM_PASSWORD</p>

<p style="margin-top: 1em">Use RHEV-M as virtualization
backend and specify option required to connect to RHEV-M
server.</p>

<p style="margin-top: 1em">5. Hyper-V</p>

<p style="margin-top: 1em"># virt-who --hyperv
--hyperv-owner=HYPERV_OWNER --hyperv-env=HYPERV_ENV
--hyperv-server=HYPERV_SERVER
--hyperv-username=HYPERV_USERNAME
--hyperv-password=HYPERV_PASSWORD</p>

<p style="margin-top: 1em">Use Hyper-V as virtualization
backend and specify option required to connect to Hyper-V
server.</p>

<p style="margin-top: 1em">6. XenServer</p>

<p style="margin-top: 1em"># virt-who --xen
--xen-owner=XEN_OWNER --xen-env=XEN_ENV
--xen-server=XEN_SERVER --xen-username=XEN_USERNAME
--xen-password=XEN_PASSWORD</p>

<p style="margin-top: 1em">Use Citrix XenServer as
virtualization backend and specify option required to
connect to XenServer server.</p>

<p style="margin-top: 1em">7. Fake</p>

<p style="margin-top: 1em">Fake virtualization backend
fetches the host/guests association from file. This can be
useful in environments where the hypervisor is not
accessible by virt-who. It&rsquo;s <br>
only available through configuration file, see
virt-who-config(5) for details about configuration of this
backend.</p>

<p style="margin-top: 1em">SUBSCRIPTION MANAGER <br>
virt-who can report host/guest associations to Subscription
Asset Manager (SAM), to Satellite 5, or to Satellite 6.</p>

<p style="margin-top: 1em">1. Subscription Asset Manager or
Satellite 6 <br>
# virt-who</p>

<p style="margin-top: 1em"># virt-who --sam</p>

<p style="margin-top: 1em">System must be registered using
subscription-manager prior to using virt-who. Configuration
for connecting to SAM is shared between subscription-manager
and virt-who. This <br>
is default.</p>

<p style="margin-top: 1em">2. Satellite 6</p>

<p style="margin-top: 1em"># virt-who --satellite6</p>

<p style="margin-top: 1em">System must be registered using
subscription-manager prior to using virt-who. Configuration
for connecting to Satellite 6 is shared between
subscription-manager and virt- <br>
who.</p>

<p style="margin-top: 1em">2. Satellite 5</p>

<p style="margin-top: 1em"># virt-who --satellite5
--satellite-server=SAT_SERVER
--satellite-username=SAT_USERNAME
--satellite-password=SAT_PASSWORD</p>

<p style="margin-top: 1em">This option can&rsquo;t be used
for monitoring local guests, use rhn-virtualization-host
instead.</p>

<p style="margin-top: 1em">LOGGING <br>
virt-who always writes error output to file
/var/log/rhsm/rhsm.log. In all modes, excluding background
(&quot;-b&quot;), it writes same output also to the standard
error output.</p>

<p style="margin-top: 1em">virt-who can be started with
option &quot;-d&quot; in all modes and with all backends.
This option will enable verbose output with more
information.</p>

<p style="margin-top: 1em">SECURITY <br>
Virt-who may present security concerns in some scenarios
because it needs access to every hypervisor in the
environment. To minimize security risk, virt-who is a
network client, <br>
not a server. It only does outbound connections to find and
register new hypervisors and does not need access to any
virtual machines. To further reduce risk, deploy virt-who in
<br>
a small virtual machine with a minimal installation and lock
it down from any unsolicited inbound network
connections.</p>

<p style="margin-top: 1em">Here is a list of ports that
need to be open for different hypervisors:</p>

<p style="margin-top: 1em">VMWare ESX/vCenter: 443/tcp <br>
Hyper-V: 5985/tcp <br>
RHEV-M: 443/tcp or 8443/tcp (depending on version) <br>
XenServer: 443/tcp <br>
libvirt: depending on transport type, default (for remote
connections) is qemu over ssh on port 22 <br>
local libvirt and vdsm use local connections and don&rsquo;t
need open ports</p>

<p style="margin-top: 1em">virt-who also needs to have
access to Subscription Asset Manager, Satellite 5, or
Satellite 6. Default port is 443/tcp. All the ports might be
changed by system administrators.</p>

<p style="margin-top: 1em">Using the same network for
machine running virt-who as for hypervisor management
software instead of production VM networks is suggested.</p>

<p style="margin-top: 1em">AUTHOR <br>
Radek Novacek &lt;rnovacek at redhat dot com&gt;</p>

<p style="margin-top: 1em">virt-who April 2016
VIRT-WHO(8)</p>
<hr>
</body>
</html>
