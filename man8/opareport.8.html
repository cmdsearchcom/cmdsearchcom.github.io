<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:14:05 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p style="margin-top: 1em">opareport(8) Master map:
IFSFFCLIRG (Man Page) opareport(8)</p>

<p style="margin-top: 1em">NAME <br>
opareport</p>

<p style="margin-top: 1em">(All) Provides powerful fabric
analysis and reporting capabilities. Must be run on a host
connected to the Intel(R) Omni-Path Fabric with the Intel(R)
Omni-Path Fabric Suite <br>
FastFabric Toolset installed.</p>

<p style="margin-top: 1em">Syntax <br>
opareport [-v][-q] [-h hfi] [-p port] <br>
[-o report] [-d detail] [-P|-H] [-N] [-x] <br>
[-X snapshot_input] [-T topology_input] [-s] [-r] [-V] <br>
[-i#8217#160; seconds] [-C] [-a] [-m] [-K mkey] [-M] [-A]
[-c file] [-L] <br>
[-F point] [-S point] [-D point] [-Q]</p>

<p style="margin-top: 1em">Options <br>
--help Produces full help text.</p>

<p style="margin-top: 1em">-v/--verbose <br>
Returns verbose output.</p>

<p style="margin-top: 1em">-q/--quiet <br>
Disables progress reports.</p>

<p style="margin-top: 1em">-h/--hfi hfi <br>
HFI, numbered 1..n. Using 0 specifies that the -p port port
is a system-wide port number. Default is 0.</p>

<p style="margin-top: 1em">-p/--port port <br>
Port, numbered 1..n. If -h hfi is 0 then port is a
system-wide port number. Default is 1.</p>

<p style="margin-top: 1em">-o/--output report <br>
Report type for output. Refer to Report Types for
details.</p>

<p style="margin-top: 1em">-d/--detail detail <br>
Level of detail 0-n for output. Default is 2.</p>

<p style="margin-top: 1em">-P/--persist <br>
Includes data persistent across reboots.</p>

<p style="margin-top: 1em">-H/--hard Includes permanent
hardware data.</p>

<p style="margin-top: 1em">-N/--noname <br>
Omits node and IOC names.</p>

<p style="margin-top: 1em">-x/--xml Produces output in
XML.</p>

<p style="margin-top: 1em">-X/--infile snapshot_input <br>
Generates a report using the data in the snapshot_input
file. snapshot_input must have been generated during a
previous -o snapshot run. When used, the -s, -i, -C, and
<br>
-a options are ignored. Not permitted with -o route and -F
route. &rsquo;-&rsquo; may be used as the snapshot_input to
specify stdin.</p>

<p style="margin-top: 1em">-T/--topology topology_input
<br>
Uses topology_input file to augment and verify fabric
information. When used, various reports can be augmented
with information not available electronically (such as <br>
cable labels and lengths). &rsquo;-&rsquo; may be used to
specify stdin.</p>

<p style="margin-top: 1em">-s/--stats <br>
Gets performance statistics for all ports.</p>

<p style="margin-top: 1em">-i/--interval seconds <br>
Obtains performance statistics over interval seconds, clears
all statistics, waits interval seconds, then generates
report. Implies -s option.</p>

<p style="margin-top: 1em">-C/--clear <br>
Clears performance statistics for all ports. Only statistics
with error thresholds are cleared. A clear occurs after
generating the report.</p>

<p style="margin-top: 1em">-a/--clearall <br>
Clears all performance statistics for all ports.</p>

<p style="margin-top: 1em">-m/--smadirect <br>
Accesses fabric information directly from SMA.</p>

<p style="margin-top: 1em">-K/--mkey mkey <br>
SMA M_Key for direct SMA query. Default is 0.</p>

<p style="margin-top: 1em">-M/--pmadirect <br>
Accesses performance statistics using direct PMA.</p>

<p style="margin-top: 1em">-A/--allports <br>
Gets PortInfo for down switch ports. Uses direct SMA to get
this data. If used with -M, also gets PMA stats for
down-switch ports.</p>

<p style="margin-top: 1em">-c/--config file <br>
Error thresholds configuration file. Default is
/etc/sysconfig/opa/opamon.conf file.</p>

<p style="margin-top: 1em">-L/--limit <br>
Limits operation to exact specified focus with -F for port
error counters check (-o errors) and port counters clear (-C
or -i). Normally, the neighbor of each selected <br>
port is also checked/cleared. Does not affect other
reports.</p>

<p style="margin-top: 1em">-F/--focus point <br>
Focus area for report. Used for all reports except route to
limit scope of report. Refer to Point Syntax for
details.</p>

<p style="margin-top: 1em">-S/--src point <br>
Source for trace route, default is local port. Refer to
Point Syntax for details.</p>

<p style="margin-top: 1em">-D/--dest point <br>
Destination for trace route. Refer to Point Syntax for
details.</p>

<p style="margin-top: 1em">-Q/--quietfocus <br>
Excludes focus description from report.</p>

<p style="margin-top: 1em">-h and -p options permit a
variety of selections: <br>
-h 0 First active port in system (default).</p>

<p style="margin-top: 1em">-h 0 -p 0 First active port in
system.</p>

<p style="margin-top: 1em">-h x First active port on HFI
x.</p>

<p style="margin-top: 1em">-h x#8217#160;-p 0 <br>
First active port on HFI x.</p>

<p style="margin-top: 1em">-h 0 -p y Port y#8217#160;within
system (no matter which ports are active).</p>

<p style="margin-top: 1em">-h x#8217#160;-p y <br>
HFI x, port y.</p>

<p style="margin-top: 1em">Snapshot-Specific Options <br>
-r/--routes <br>
Gets routing tables for all switches.</p>

<p style="margin-top: 1em">-V/--vltables <br>
Gets QOS VL-related tables for all ports.</p>

<p style="margin-top: 1em">Report Types <br>
comps Summary of all systems and SMs in fabric.</p>

<p style="margin-top: 1em">brcomps Brief summary of all
systems and SMs in fabric.</p>

<p style="margin-top: 1em">nodes Summary of all node types
and SMs in fabric.</p>

<p style="margin-top: 1em">brnodes Brief summary of all
node types and SMs in fabric.</p>

<p style="margin-top: 1em">ious Summary of all IO units in
the fabric.</p>

<p style="margin-top: 1em">lids Summary of all LIDs in the
fabric.</p>

<p style="margin-top: 1em">links Summary of all links.</p>

<p style="margin-top: 1em">extlinks Summary of links
external to systems.</p>

<p style="margin-top: 1em">slowlinks Summary of links
running slower than expected.</p>

<p style="margin-top: 1em">slowconfiglinks <br>
Summary of links configured to run slower than supported,
includes slowlinks.</p>

<p style="margin-top: 1em">slowconnlinks <br>
Summary of links connected with mismatched speed potential,
includes slowconfiglinks.</p>

<p style="margin-top: 1em">misconfiglinks <br>
Summary of links configured to run slower than
supported.</p>

<p style="margin-top: 1em">misconnlinks <br>
Summary of links connected with mismatched speed
potential.</p>

<p style="margin-top: 1em">errors Summary of links whose
errors exceed counts in the configuration file.</p>

<p style="margin-top: 1em">otherports <br>
Summary of ports not connected to the fabric.</p>

<p style="margin-top: 1em">linear Summary of linear
forwarding data base (FDB) for each switch.</p>

<p style="margin-top: 1em">mcast Summary of multicast FDB
for each switch in the fabric.</p>

<p style="margin-top: 1em">portusage Summary of ports
referenced in linear FDB for each switch, broken down by
NodeType of DLID.</p>

<p style="margin-top: 1em">pathusage Summary of number of
FI to FI paths routed through each switch port.</p>

<p style="margin-top: 1em">treepathusage <br>
Analysis of number of FI to FI paths routed through each
switch port for a FAT tree.</p>

<p style="margin-top: 1em">portgroups <br>
Summary of adaptive routing port groups for each switch.</p>

<p style="margin-top: 1em">quarantinednodes <br>
Summary of quarantined nodes.</p>

<p style="margin-top: 1em">validateroutes <br>
Validates all routes in the fabric.</p>

<p style="margin-top: 1em">validatepgs <br>
Validates all port groups in the fabric.</p>

<p style="margin-top: 1em">validatecreditloops <br>
Validates topology configuration of the fabric to identify
any existing credit loops.</p>

<p style="margin-top: 1em">vfinfo Summary of virtual fabric
(vFabric) information.</p>

<p style="margin-top: 1em">vfmember Summary of vFabric
membership information.</p>

<p style="margin-top: 1em">verifyfis Compares fabric (or
snapshot) FIs to supplied topology and identifies
differences and omissions.</p>

<p style="margin-top: 1em">verifysws Compares fabric (or
snapshot) switches to supplied topology and identifies
differences and omissions.</p>

<p style="margin-top: 1em">verifynodes <br>
Returns verifyfis and verifysws reports.</p>

<p style="margin-top: 1em">verifysms Compares fabric (or
snapshot) SMs to supplied topology and identifies
differences and omissions.</p>

<p style="margin-top: 1em">verifylinks <br>
Compares fabric (or snapshot) links to supplied topology and
identifies differences and omissions.</p>

<p style="margin-top: 1em">verifyextlinks <br>
Compares fabric (or snapshot) links to supplied topology and
identifies differences and omissions. Limits analysis to
links external to systems.</p>

<p style="margin-top: 1em">verifyall Returns verifyfis,
verifysws, verifysms, and verifylinks reports.</p>

<p style="margin-top: 1em">all Returns comps, nodes, ious,
links, extlinks, slowconnlinks, and errors reports.</p>

<p style="margin-top: 1em">route Traces route between -S
and -D points.</p>

<p style="margin-top: 1em">bfrctrl Reports Buffer Control
Tables for all ports.</p>

<p style="margin-top: 1em">snapshot Outputs snapshot of the
fabric state for later use as snapshot_input. This implies
-x. May not be combined with other reports. When selected,
-F, -P, -H, and -N <br>
options are ignored.</p>

<p style="margin-top: 1em">topology Outputs the topology of
the fabric for later use as topology_input. This implies -x.
May not be combined with other reports.</p>

<p style="margin-top: 1em">none No report, useful to clear
statistics.</p>

<p style="margin-top: 1em">Point Syntax <br>
gid: value <br>
value is numeric port GID of form: subnet:guid.</p>

<p style="margin-top: 1em">lid: value <br>
value is numeric LID.</p>

<p style="margin-top: 1em">lid: value:node <br>
value is numeric LID, selects entire node with given
LID.</p>

<p style="margin-top: 1em">lid: value:port: value2 <br>
value is numeric LID of node, value2 is port number.</p>

<p style="margin-top: 1em">portguid: value <br>
value is numeric port GUID.</p>

<p style="margin-top: 1em">nodeguid: value <br>
value is numeric node GUID.</p>

<p style="margin-top: 1em">nodeguid: value1: port: value2
<br>
value1 is numeric node GUID, value2 is port number.</p>

<p style="margin-top: 1em">iocguid: value <br>
value is numeric IOC GUID.</p>

<p style="margin-top: 1em">iocguid: value1:port: value2
<br>
value1 is numeric IOC GUID, value2 is port number.</p>

<p style="margin-top: 1em">systemguid: value <br>
value is numeric system image GUID.</p>

<p style="margin-top: 1em">systemguid: value1:port: value2
<br>
value1 is the numeric system image GUID, value2 is port
number.</p>

<p style="margin-top: 1em">ioc: value <br>
value is IOC Profile ID String (IOC Name).</p>

<p style="margin-top: 1em">ioc: value1:port: value2 <br>
value1 is IOC Profile ID String (IOC Name), value2 is port
number.</p>

<p style="margin-top: 1em">iocpat: value <br>
value is glob pattern for IOC Profile ID String (IOC
Name).</p>

<p style="margin-top: 1em">iocpat: value1:port: value2 <br>
value1 is glob pattern for IOC Profile ID String (IOC Name),
value2 is port number.</p>

<p style="margin-top: 1em">ioctype: value <br>
value is IOC type (VNIC or SRP).</p>

<p style="margin-top: 1em">ioctype: value1:port: value2
<br>
value1 is IOC type (VNIC or SRP), value2 is port number.</p>

<p style="margin-top: 1em">node: value <br>
value is node description (node name).</p>

<p style="margin-top: 1em">node: value1:port: value2 <br>
value1 is node description (node name), value2 is port
number.</p>

<p style="margin-top: 1em">nodepat: value <br>
#8217gt;value is glob pattern for node description (node
name).</p>

<p style="margin-top: 1em">nodepat: value1:port: value2
<br>
value1 is the glob pattern for the node description (node
name), value2 is port number.</p>

<p style="margin-top: 1em">nodedetpat: value <br>
value is glob pattern for node details.</p>

<p style="margin-top: 1em">nodedetpat: value1:port: value2
<br>
value1 is the glob pattern for the node details, value2 is
port number.</p>

<p style="margin-top: 1em">nodetype: value <br>
value is node type (SW, FI, or RT).</p>

<p style="margin-top: 1em">nodetype: value1:port: value2
<br>
value1 is node type (SW, FI, or RT), value2 is port
number.</p>

<p style="margin-top: 1em">rate: value <br>
value is string for rate (25g, 50g, 75g, 100g), omits switch
mgmt port 0.</p>

<p style="margin-top: 1em">portstate: value <br>
value is a string for state (init, armed, active).</p>

<p style="margin-top: 1em">portphysstate: value <br>
value is a string for PHYs state (polling, disabled,
training, linkup, recovery, offline, test)</p>

<p style="margin-top: 1em">mtucap: value <br>
value is MTU size (2048, 4096, 8192, 10240), omits switch
mgmt port 0.</p>

<p style="margin-top: 1em">labelpat: value <br>
value is glob pattern for cable label.</p>

<p style="margin-top: 1em">lengthpat: value <br>
value is glob pattern for cable length.</p>

<p style="margin-top: 1em">cabledetpat: value <br>
value is glob pattern for cable details.</p>

<p style="margin-top: 1em">cabinflenpat: value <br>
value is glob pattern for cable info length.</p>

<p style="margin-top: 1em">cabinfvendnamepat: value <br>
value is glob pattern for cable info vendor name.</p>

<p style="margin-top: 1em">cabinfvendpnpat: value <br>
value is glob pattern for cable info vendor part number.</p>

<p style="margin-top: 1em">cabinfvendrevpat: value <br>
value is glob pattern for cable info vendor revision.</p>

<p style="margin-top: 1em">cabinftype: value <br>
value is either optical, passive_copper, active_copper, or
unknown.</p>

<p style="margin-top: 1em">cabinfvendsnpat: value <br>
value is glob pattern for cable info vendor serial
number.</p>

<p style="margin-top: 1em">linkdetpat: value <br>
value is glob pattern for link details.</p>

<p style="margin-top: 1em">portdetpat: value <br>
value is glob pattern for port details.</p>

<p style="margin-top: 1em">sm Master subnet manager
(SM).</p>

<p style="margin-top: 1em">smdetpat: value <br>
value is glob pattern for SM details.</p>

<p style="margin-top: 1em">route: point1: point2 <br>
All ports along the routes between the two given points.</p>

<p style="margin-top: 1em">linkqual: value <br>
Ports with a link quality equal to value.</p>

<p style="margin-top: 1em">linkqualLE: value <br>
Ports with a link quality less than or equal to value.</p>

<p style="margin-top: 1em">linkqualGE: value <br>
Ports with a link quality greater than or equal to
value.</p>

<p style="margin-top: 1em">Examples <br>
opareport can generate hundreds of different reports.
Commonly generated reports include the following:opareport
-o comps -d 3 <br>
opareport -o errors -o slowlinks <br>
opareport -o nodes -F portguid:0x00117500a000447b <br>
opareport -o nodes -F nodeguid:0x001175009800447b:port:1
<br>
opareport -o nodes -F nodeguid:0x001175009800447b <br>
opareport -o nodes -F &rsquo;node:duster hfi1_0&rsquo; <br>
opareport -o nodes -F &rsquo;node:duster
hfi1_0:port:1&rsquo; <br>
opareport -o nodes -F &rsquo;nodepat:d*&rsquo; <br>
opareport -o nodes -F &rsquo;nodepat:d*:port:1&rsquo; <br>
opareport -o nodes -F &rsquo;nodedetpat:compute*&rsquo; <br>
opareport -o nodes -F
&rsquo;nodedetpat:compute*:port:1&rsquo; <br>
opareport -o nodes -F nodetype:FI <br>
opareport -o nodes -F nodetype:FI:port:1 <br>
opareport -o nodes -F lid:1 <br>
opareport -o nodes -F lid:1:node <br>
opareport -o nodes -F lid:1:port:2 <br>
opareport -o nodes -F
gid:0xfe80000000000000:0x00117500a000447b <br>
opareport -o nodes -F systemguid:0x001175009800447b <br>
opareport -o nodes -F systemguid:0x001175009800447b:port:1
<br>
opareport -o nodes -F iocguid:0x00117501300001e0 <br>
opareport -o nodes -F iocguid:0x00117501300001e0:port:2 <br>
opareport -o nodes -F &rsquo;ioc:Chassis 0x001175005000010C,
Slot 2, IOC 1&rsquo; <br>
opareport -o nodes -F &rsquo;ioc:Chassis 0x001175005000010C,
Slot 2, IOC 1:port:2&rsquo; <br>
opareport -o nodes -F &rsquo;iocpat:*Slot 2*&rsquo; <br>
opareport -o nodes -F &rsquo;iocpat:*Slot 2*:port:2&rsquo;
<br>
opareport -o nodes -F ioctype:VNIC <br>
opareport -o nodes -F ioctype:VNIC:port:2 <br>
opareport -o extlinks -F rate:5g <br>
opareport -o extlinks -F portstate:armed <br>
opareport -o extlinks -F portphysstate:linkup <br>
opareport -o extlinks -F &rsquo;labelpat:S1345*&rsquo; <br>
opareport -o extlinks -F &rsquo;lengthpat:11m&rsquo; <br>
opareport -o extlinks -F &rsquo;cabledetpat:*gore*&rsquo;
<br>
opareport -o extlinks -F &rsquo;linkdetpat:*core ISL*&rsquo;
<br>
opareport -o extlinks -F &rsquo;portdetpat:*mgmt*&rsquo;
<br>
opareport -o links -F mtucap:2048 <br>
opareport -o nodes -F sm <br>
opareport -o nodes -F &rsquo;smdetpat:primary*&rsquo; <br>
opareport -o nodes -F &rsquo;route:node:duster
hfi1_0:node:cuda hfi1_0&rsquo; <br>
opareport -o nodes -F &rsquo;route:node:duster
hfi1_0:port:1:node:cuda hfi1_0:port:2&rsquo; <br>
opareport -s -o snapshot #8217gt; file <br>
opareport -o topology #8217gt; topology.xml <br>
opareport -o errors -X file</p>

<p style="margin-top: 1em">Other Information <br>
opareport also supports operation with the Fabric Manager
Performance Manager (PM)/Performance Manager Agent (PMA).
When opareport detects the presence of a PMA, it
automatically <br>
issues any required PortCounter queries and clears to the
PMA to access the PMs running totals. If a PMA is not
detected, then opareport directly accesses the PMAs on all
the <br>
nodes. The -M option can force access to the PMA even if a
PMA is present.</p>

<p style="margin-top: 1em">opareport takes advantage of
these interfaces to obtain extensive information about the
fabric from the subnet manager and the end nodes. Using this
information, opareport is <br>
able to cross-reference it and produce analysis greatly
beyond what any single subnet manager request could provide.
As such, it exceeds the capabilities previously available in
<br>
tools such as opasaquery and opafabricinfo.</p>

<p style="margin-top: 1em">opareport obtains and displays
64-bit data movement counters from the Fabric Manager PM/PA
or directly from the fabric using the -M option. Snapshots
generated by this version of <br>
opareport, in conjunction with the -s option, may report
value out of range errors when used as input to older
versions of opareport. However, the thresholds specified in
opa&acirc; <br>
mon.conf and other input configuration files continue to
only support 32-bit values for data movement counter
thresholds.</p>

<p style="margin-top: 1em">opareport internally
cross-references all this information so its output can be
in user-friendly form. Reports include GUIDs, LIDs, and
names for components. Obviously, these <br>
reports are easiest to read if the end user has taken the
time to provide unique names for all the components in the
fabric (node names and IOC names). All Intel components
sup&acirc; <br>
port this capability. For hosts, the node names are
automatically assigned based on the network host name of the
server. For switches and line cards, the names can be
assigned <br>
using the element managers for each component.</p>

<p style="margin-top: 1em">Each run of opareport obtains
up-to-date information from the fabric. At the start of the
run opareport takes a few seconds to obtain all the fabric
data, then it is output to <br>
stdout. The reports are sorted by GUIDs and other permanent
information so they can be rerun in the future and produce
output in the same order even if components have been <br>
rebooted. This is useful for comparison using simple tools
like diff. opareport permits multiple reports to be
requested for a single run (for example, one of each report
type).</p>

<p style="margin-top: 1em">By default, opareport uses the
first active port on the local system. However, if the
Management Node is connected to more than one fabric (for
example, a subnet), the Intel(R) <br>
Omni-Path Host Fabric Interface (HFI) and port may be
specified to select the fabric to analyze.</p>

<p style="margin-top: 1em">Copyright(C) 2015-2016 Intel
Corporation opareport(8)</p>
<hr>
</body>
</html>
