<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:14:02 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p style="margin-top: 1em">opachassisadmin(8) Master map:
IFSFFCLIRG (Man Page) opachassisadmin(8)</p>

<p style="margin-top: 1em">NAME <br>
opachassisadmin</p>

<p style="margin-top: 1em">(Switch) Performs a number of
multi-step chassis initialization and verification
operations, including initial chassis setup, firmware
upgrades, chassis reboot, and others.</p>

<p style="margin-top: 1em">Syntax <br>
opachassisadmin [-c] [-F chassisfile] [-H
&rsquo;chassis&rsquo;] [-P packages] [-a action] [-I
fm_bootstate] [-S] [-d upload_dir] [-s securityfiles]
operation...</p>

<p style="margin-top: 1em">Options <br>
--help Produces full help text.</p>

<p style="margin-top: 1em">-c Clobbers result files from
any previous run before starting this run.</p>

<p style="margin-top: 1em">-F chassisfile <br>
File with chassis in cluster. The default is
/etc/sysconfig/opa/chassis.</p>

<p style="margin-top: 1em">-H chassis <br>
List of chassis to execute the operation against.</p>

<p style="margin-top: 1em">-P packages <br>
Filenames and directories of firmware images to install. For
directories specified, all .pkg files in directory tree are
used. shell wild cards may also be used within <br>
quotes, or for fmconfig, filename of FM config file to use,
or for fmgetconfig, filename to upload to (default
opafm.xml).</p>

<p style="margin-top: 1em">-a action Action for supplied
file. The default is push.</p>

<p style="margin-top: 1em">For chassis upgrade:</p>

<p style="margin-top: 1em">push Ensures firmware is in
primary or alternate.</p>

<p style="margin-top: 1em">select Ensures firmware is in
primary.</p>

<p style="margin-top: 1em">run Ensures firmware is in
primary and running.</p>

<p style="margin-top: 1em">For chassis fmconfig :</p>

<p style="margin-top: 1em">push Ensures the configuration
file is in chassis.</p>

<p style="margin-top: 1em">run After push, restarts FM on
master, stops on secondary.</p>

<p style="margin-top: 1em">runall After push, restarts FM
on all management modules.</p>

<p style="margin-top: 1em">For chassis fmcontrol :</p>

<p style="margin-top: 1em">stop Stops FM on all management
modules.</p>

<p style="margin-top: 1em">run Ensures FM running on
master, stopped on secondary.</p>

<p style="margin-top: 1em">runall Ensures FM running on all
management modules.</p>

<p style="margin-top: 1em">restart Restarts FM on master,
stops on secondary.</p>

<p style="margin-top: 1em">restartall <br>
Restarts FM on all MM.</p>

<p style="margin-top: 1em">For chassis fmsecurityfiles
:</p>

<p style="margin-top: 1em">push Ensures FM security files
are in chassis.</p>

<p style="margin-top: 1em">-I fm_bootstate <br>
fmconfig and fmcontrol install options.</p>

<p style="margin-top: 1em">disable Disables FM start at
chassis boot.</p>

<p style="margin-top: 1em">enable Enables FM start on
master at chassis boot.</p>

<p style="margin-top: 1em">enableall Enables FM start on
all MM at chassis boot.</p>

<p style="margin-top: 1em">-d upload_dir <br>
Directory to upload FM configuration files to; default is
uploads.</p>

<p style="margin-top: 1em">-S Securely prompts for password
for user on chassis.</p>

<p style="margin-top: 1em">-s securityFiles <br>
Security files to install. Default is *.pem. For Chassis
fmsecurityfiles, filenames/directories of security files to
install. For directories specified, all security <br>
files in directory tree are used. Shell wildcards may also
be used within quotes.</p>

<p style="margin-top: 1em">For Chassis fmgetsecurityfiles,
filename to upload to. Default is *.pem</p>

<p style="margin-top: 1em">operation <br>
Operation to perform. Can be one or more of:</p>

<p style="margin-top: 1em">reboot Reboots chassis, ensures
they go down and come back.</p>

<p style="margin-top: 1em">configure Runs wizard to perform
chassis configuration.</p>

<p style="margin-top: 1em">upgrade Upgrades install of all
chassis.</p>

<p style="margin-top: 1em">getconfig Gets basic
configuration of chassis.</p>

<p style="margin-top: 1em">fmconfig FM configuration
operation on all chassis.</p>

<p style="margin-top: 1em">fmgetconfig <br>
Fetches FM configuration from all chassis.</p>

<p style="margin-top: 1em">fmcontrol Controls FM on all
chassis.</p>

<p style="margin-top: 1em">fmsecurityfiles <br>
FM security files operation on all chassis.</p>

<p style="margin-top: 1em">fmgetsecurityfiles <br>
Fetches FM security files from all chassis.</p>

<p style="margin-top: 1em">For more information on the
operations that can be performed, see Operation Details</p>

<p style="margin-top: 1em">Example <br>
opachassisadmin -c reboot <br>
opachassisadmin -P /root/ChassisFw4.2.0.0.1 upgrade <br>
opachassisadmin -H &rsquo;chassis1 chassis2&rsquo; reboot
<br>
CHASSIS=&rsquo;chassis1 chassis2&rsquo; opachassis_admin
reboot <br>
opachassisadmin -a run -P &rsquo;*.pkg&rsquo; upgrade</p>

<p style="margin-top: 1em">Environment Variables <br>
The following environment variables are also used by this
command:</p>

<p style="margin-top: 1em">CHASSIS List of chassis, used if
-H and -F option not supplied.</p>

<p style="margin-top: 1em">CHASSIS_FILE <br>
File containing list of chassis, used in absence of -F and
-H.</p>

<p style="margin-top: 1em">FF_MAX_PARALLEL <br>
Maximum concurrent operations.</p>

<p style="margin-top: 1em">FF_SERIALIZE_OUTPUT <br>
Serializes output of parallel operations (yes or no).</p>

<p style="margin-top: 1em">UPLOADS_DIR <br>
Directory to upload to, used in absence of -d.</p>

<p style="margin-top: 1em">Operation Details <br>
(Switch) All chassis operations log into the chassis as
chassis user admin. Intel recommends using the -S option to
securely prompt for a password, in which case the same
pass&acirc; <br>
word is used for all chassis. Alternately, the password may
be put in the environment or the opafastfabric.conf file
using FF_CHASSIS_ADMIN_PASSWORD.</p>

<p style="margin-top: 1em">All versions of Intel(R)
Omni-Path Switch 100 Series firmware permit SSH keys to be
configured within the chassis for secure password-less
login. In this case, there is no need <br>
to configure a FF_CHASSIS_ADMIN_PASSWORD and
FF_CHASSIS_LOGIN_METHOD can be SSH. Refer to the Intel(R)
Omni-Path Fabric Switches Command Line Interface Reference
Guide</p>

<p style="margin-top: 1em">for more information.</p>

<p style="margin-top: 1em">upgrade Upgrades the firmware on
each chassis or slot specified. The -P option selects a
directory containing .pkg files or provides an explicit list
of .pkg files for the <br>
chassis and/or slots. The -a option selects the desired
minimal state for the new firmware. For each chassis and/or
slot selected for upgrade, the .pkg file applicable <br>
to that slot is selected and used. If more than one .pkg
file is specified of a given card type, the operation is
undefined.</p>

<p style="margin-top: 1em">The upgrade is intelligent and
does not upgrade chassis that already have the desired
firmware in the desired state (as specified by -a).</p>

<p style="margin-top: 1em">When the -a option specifies
run, chassis that are not already running the desired
firmware are rebooted. By selecting the proper
FF_MAX_PARALLEL value, a rolling <br>
upgrade or a parallel upgrade may be accomplished. In most
cases, a parallel upgrade is recommended for expediency.</p>

<p style="margin-top: 1em">For more information about
chassis firmware, refer to the Intel(R) Omni-Path Fabric
Switches GUI User Guide</p>

<p style="margin-top: 1em">and Intel(R) Omni-Path Fabric
Externally-Managed Switches Release Notes</p>

<p style="margin-top: 1em">configure Runs the chassis setup
wizard, which asks a series of questions. Once the wizard
has finished prompting for configuration information, all
the selected chassis are con&acirc; <br>
figured through the CLI interface according to the
responses. The following options may be configured for all
chassis:</p>

<p style="margin-top: 1em">&Acirc;&middot; syslog server IP
address, TCP/UDP port number, syslog facility code, and the
chassis LogMode.</p>

<p style="margin-top: 1em">&Acirc;&middot; NTP server</p>

<p style="margin-top: 1em">&Acirc;&middot; local time
zone</p>

<p style="margin-top: 1em">&Acirc;&middot; maximum packet
MTU</p>

<p style="margin-top: 1em">&Acirc;&middot; VL
capability</p>

<p style="margin-top: 1em">&Acirc;&middot; VL credit
distribution</p>

<p style="margin-top: 1em">&Acirc;&middot; link width
supported</p>

<p style="margin-top: 1em">&Acirc;&middot; IB node
description</p>

<p style="margin-top: 1em">&Acirc;&middot; IB node
description format</p>

<p style="margin-top: 1em">&Acirc;&middot; disable chassis
auto clear of port counters</p>

<p style="margin-top: 1em">reboot Reboots the given chassis
and ensures they go down and come back up by pinging them
during the reboot process.</p>

<p style="margin-top: 1em">By selecting the proper
FF_MAX_PARALLEL value, a rolling reboot or a parallel reboot
may be accomplished. In most cases, a parallel upgrade is
recommended for expedi&acirc; <br>
ency.</p>

<p style="margin-top: 1em">getconfig Retrieves basic
information from a chassis such as syslog, NTP
configuration, timezone info, MTU Capability, VL Capability,
VL Credit Distribution, Link Width, and node <br>
description.</p>

<p style="margin-top: 1em">fmconfig Updates the Fabric
Manager configuration file on each chassis specified. The -P
option selects a file to transfer to the chassis. The -a
option selects the desired min&acirc; <br>
imal state for the new configuration and controls whether
the FM is started/restarted after the file is updated. The
-I option can be used to configure the FM start at <br>
boot for the selected chassis.</p>

<p style="margin-top: 1em">fmgetconfig <br>
Uploads the FM configuration file from all selected chassis.
The file is uploaded to the selected uploads directory. The
-P option specifies the desired destination <br>
filename within the uploads directory.</p>

<p style="margin-top: 1em">fmcontrol Allows the FM to be
controlled on each chassis specified. The -a option selects
the desired state for the FM.</p>

<p style="margin-top: 1em">The -I option configures the FM
start at boot for the selected chassis.</p>

<p style="margin-top: 1em">fmsecurityfiles <br>
Updates the FM security files on each chassis specified. The
-s option selects file(s) to transfer to the chassis. The -a
option selects the desired minimal state for <br>
the new security files. In this release, push is the only
supported action.</p>

<p style="margin-top: 1em">fmgetsecurityfiles <br>
Uploads the FM security files from all selected chassis. The
files are uploaded to the selected uploads directory. The -s
option specifies the desired destination file&acirc; <br>
name within the uploads directory.</p>

<p style="margin-top: 1em">Logging <br>
opachassisadmin provides detailed logging of its results.
During each run, the following files are produced:</p>

<p style="margin-top: 1em">test.res Appended with summary
results of run.</p>

<p style="margin-top: 1em">test.log Appended with detailed
results of run.</p>

<p style="margin-top: 1em">save_tmp/ Contains a directory
per failed test with detailed logs.</p>

<p style="margin-top: 1em">test_tmp*/ <br>
Intermediate result files while test is running.</p>

<p style="margin-top: 1em">The -c option removes all log
files.</p>

<p style="margin-top: 1em">ssh Keys <br>
When performing operations against chassis, Intel recommends
setting up SSH keys. If SSH keys are not set up, all chassis
must be configured with the same admin password. In this
<br>
case, Intel recommends using the -S option. The -S option
avoids the need to keep the password in configuration
files.</p>

<p style="margin-top: 1em">Results <br>
Results from opachassisadmin are grouped into test suites,
test cases, and test items. A given run of opachassisadmin
represents a single test suite. Within a test suite,
multi&acirc; <br>
ple test cases occur; typically one test case per chassis
being operated on. Some of the more complex operations may
have multiple test items per test case. Each test item
repre&acirc; <br>
sents a major step in the overall test case.</p>

<p style="margin-top: 1em">Each opachassisadmin run appends
to test.res and test.log, and creates temporary files in
test_tmp$PID in the current directory. The test.res file
provides an overall summary of <br>
operations performed and their results. The same information
is also displayed while opachassisadmin is executing.
test.log contains detailed information about what was
per&acirc; <br>
formed, including the specific commands executed and the
resulting output. The test_tmp directories contain temporary
files that reflect tests in progress (or killed). The logs
<br>
for any failures are logged in the save_temp directory with
a directory per failed test case. If the same test case
fails more than once, save_temp retains the information from
<br>
the first failure. Subsequent runs of opachassisadmin are
appended to test.log. Intel recommends reviewing failures
and using the -c option to remove old logs before subsequent
<br>
runs of opachassisadmin.</p>

<p style="margin-top: 1em">opachassisadmin implicitly
performs its operations in parallel. However, as for the
other tools, FF_MAX_PARALLEL can be exported to change the
degree of parallelism. Twenty (20) <br>
parallel operations is the default.</p>

<p style="margin-top: 1em">Copyright(C) 2015-2016 Intel
Corporation opachassisadmin(8)</p>
<hr>
</body>
</html>
