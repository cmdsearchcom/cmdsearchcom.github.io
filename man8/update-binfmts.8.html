<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>UPDATE-BINFMTS(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">UPDATE-BINFMTS(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">UPDATE-BINFMTS(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<b class="Nm" title="Nm">update-binfmts</b> &#x2014;
  <span class="Nd" title="Nd">maintain registry of executable binary
  formats</span>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<table class="Nm">
  <tr>
    <td><b class="Nm" title="Nm">update-binfmts</b></td>
    <td>[<span class="Op"><var class="Ar" title="Ar">options</var></span>]
      <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-install</b>
      <var class="Ar" title="Ar">name path spec</var>
    <div>&#x00A0;</div>
    </td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><b class="Nm" title="Nm">update-binfmts</b></td>
    <td>[<span class="Op"><var class="Ar" title="Ar">options</var></span>]
      <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-remove</b>
      <var class="Ar" title="Ar">name path</var>
    <div>&#x00A0;</div>
    </td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><b class="Nm" title="Nm">update-binfmts</b></td>
    <td>[<span class="Op"><var class="Ar" title="Ar">options</var></span>]
      <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-import</b>
      [<span class="Op"><var class="Ar" title="Ar">name</var></span>]
    <div>&#x00A0;</div>
    </td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><b class="Nm" title="Nm">update-binfmts</b></td>
    <td>[<span class="Op"><var class="Ar" title="Ar">options</var></span>]
      <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-display</b>
      [<span class="Op"><var class="Ar" title="Ar">name</var></span>]
    <div>&#x00A0;</div>
    </td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><b class="Nm" title="Nm">update-binfmts</b></td>
    <td>[<span class="Op"><var class="Ar" title="Ar">options</var></span>]
      <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-enable</b>
      [<span class="Op"><var class="Ar" title="Ar">name</var></span>]
    <div>&#x00A0;</div>
    </td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><b class="Nm" title="Nm">update-binfmts</b></td>
    <td>[<span class="Op"><var class="Ar" title="Ar">options</var></span>]
      <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-disable</b>
      [<span class="Op"><var class="Ar" title="Ar">name</var></span>]
    <div>&#x00A0;</div>
    </td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><b class="Nm" title="Nm">update-binfmts</b></td>
    <td>[<span class="Op"><var class="Ar" title="Ar">options</var></span>]
      <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-find</b>
      [<span class="Op"><var class="Ar" title="Ar">path</var></span>]</td>
  </tr>
</table>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
Versions 2.1.43 and later of the Linux kernel have contained the binfmt_misc
  module. This enables a system administrator to register interpreters for
  various binary formats based on a magic number or their file extension, and
  cause the appropriate interpreter to be invoked whenever a matching file is
  executed. Think of it as a more flexible version of the #! executable
  interpreter mechanism, or as something which can behave a little like
  &quot;associations&quot; in certain other operating systems (though in
  GNU/Linux the tendency is to keep this sort of thing somewhere else, like your
  file manager). <b class="Nm" title="Nm">update-binfmts</b> manages a
  persistent database of these interpreters.
<div class="Pp"></div>
When each package providing a registered interpreter is installed, changed, or
  removed, <b class="Nm" title="Nm">update-binfmts</b> is called to update
  information about that interpreter.
  <b class="Nm" title="Nm">update-binfmts</b> is usually called from the
  <i class="Pa" title="Pa">postinst</i> or <i class="Pa" title="Pa">prerm</i>
  scripts in Debian packages.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
Exactly one action must be specified; this may be accompanied by any one of the
  common options.
<h2 class="Ss" title="Ss" id="COMMON_OPTIONS"><a class="selflink" href="#COMMON_OPTIONS">COMMON
  OPTIONS</a></h2>
<dl class="Bl-tag" style="margin-left: 7.80ex;">
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-package</b>
    <var class="Ar" title="Ar">package-name</var></dt>
  <dd class="It-tag">Specifies the name of the current package, to be used by
      package post-installation and pre-removal scripts. System administrators
      installing binary formats for local use should probably ignore this
      option.
    <div class="Pp"></div>
    When installing new formats, the
      <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-import</b> action
      should be used instead.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-admindir</b>
    <var class="Ar" title="Ar">directory</var></dt>
  <dd class="It-tag">Specifies the administrative directory, when this is to be
      different from the default of
      <i class="Pa" title="Pa">/var/lib/binfmts</i>.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-importdir</b>
    <var class="Ar" title="Ar">directory</var></dt>
  <dd class="It-tag">Specifies the directory from which packaged binary formats
      are imported, when this is to be different from the default of
      <i class="Pa" title="Pa">/usr/share/binfmts</i>.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-test</b></dt>
  <dd class="It-tag">Don't do anything, just demonstrate what would be
    done.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-help</b></dt>
  <dd class="It-tag">Display some usage information.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-version</b></dt>
  <dd class="It-tag">Display version information.</dd>
</dl>
<h2 class="Ss" title="Ss" id="ACTIONS"><a class="selflink" href="#ACTIONS">ACTIONS</a></h2>
<dl class="Bl-tag" style="margin-left: 7.80ex;">
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-install</b>
    <var class="Ar" title="Ar">name path spec</var></dt>
  <dd class="It-tag">Install a binary format identified by
      <var class="Ar" title="Ar">name</var> with interpreter
      <var class="Ar" title="Ar">path</var> into the database. After
      registration, this format will be used when the kernel tries to execute a
      file matching <var class="Ar" title="Ar">spec</var> (see
      <a class="Sx" title="Sx" href="#BINARY_FORMAT_SPECIFICATIONS">BINARY
      FORMAT SPECIFICATIONS</a> below).
    <div class="Pp"></div>
    <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-install</b> will
      attempt to enable this binary format in the kernel as well as adding it to
      its own database; see
      <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-enable</b> below.
    <div class="Pp"></div>
    You cannot install a format with any of the names &quot;.&quot;,
      &quot;..&quot;, &quot;register&quot;, or &quot;status&quot;, as these are
      used by the filesystem or the binfmt_misc module.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-remove</b>
    <var class="Ar" title="Ar">name path</var></dt>
  <dd class="It-tag">Remove the binary format identified by
      <var class="Ar" title="Ar">name</var> with interpreter
      <var class="Ar" title="Ar">path</var> from the database. This will also
      attempt to disable the binary format in the kernel; see
      <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-disable</b>
    below.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-import</b>
    [<span class="Op"><var class="Ar" title="Ar">name</var></span>]</dt>
  <dd class="It-tag">Import a packaged format file called
      <var class="Ar" title="Ar">name</var>, or import all format files
      currently on the system if no <var class="Ar" title="Ar">name</var> is
      given. If <var class="Ar" title="Ar">name</var> is not a full path, it is
      assumed to be a file in the import directory
      (<i class="Pa" title="Pa">/usr/share/binfmts</i> by default). See
      <a class="Sx" title="Sx" href="#FORMAT_FILES">FORMAT FILES</a> below for
      the required contents of these files.
    <div class="Pp"></div>
    For packages, this is preferable to using the
      <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-install</b>
      option, as a format file can be installed without
      <b class="Nm" title="Nm">update-binfmts</b> needing to be available.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-display</b>
    [<span class="Op"><var class="Ar" title="Ar">name</var></span>]</dt>
  <dd class="It-tag">Display any information held in the database about the
      binary format identifier <var class="Ar" title="Ar">name</var>, or about
      all known binary formats if no <var class="Ar" title="Ar">name</var> is
      given. Also show whether displayed binary formats are enabled or
    disabled.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-enable</b>
    [<span class="Op"><var class="Ar" title="Ar">name</var></span>]</dt>
  <dd class="It-tag">Enable binary format <var class="Ar" title="Ar">name</var>,
      or all known binary formats if no <var class="Ar" title="Ar">name</var> is
      given, in the kernel, thus enabling direct execution of matching files.
      You must have binfmt_misc compiled into the kernel or loaded as a module
      for this to work.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-disable</b>
    [<span class="Op"><var class="Ar" title="Ar">name</var></span>]</dt>
  <dd class="It-tag">Disable binary format
      <var class="Ar" title="Ar">name</var>, or all known binary formats if no
      <var class="Ar" title="Ar">name</var> is given, in the kernel, thus
      disabling direct execution of matching files. You must have binfmt_misc
      compiled into the kernel or loaded as a module for this to work.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-find</b>
    [<span class="Op"><var class="Ar" title="Ar">path</var></span>]</dt>
  <dd class="It-tag">Print the list of interpreters that will be tried in
      sequence when attempting to execute <var class="Ar" title="Ar">path</var>,
      one per line. The first one for which
      <a class="Xr" title="Xr">execvp(3)</a> succeeds will be used.
    <div class="Pp"></div>
    Note that if multiple formats match an executable, then the order is in
      general not defined, and may not be preserved between
      <b class="Nm" title="Nm">update-binfmts</b> operations, so you should
      generally try to ensure that this option prints at most one line for any
      given <var class="Ar" title="Ar">path</var>. The exception to this is that
      any format with a userspace detector will be run before any format without
      a userspace detector.</dd>
</dl>
<h2 class="Ss" title="Ss" id="BINARY_FORMAT_SPECIFICATIONS"><a class="selflink" href="#BINARY_FORMAT_SPECIFICATIONS">BINARY
  FORMAT SPECIFICATIONS</a></h2>
<dl class="Bl-tag" style="margin-left: 7.80ex;">
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-magic</b>
    <var class="Ar" title="Ar">byte-sequence</var></dt>
  <dd class="It-tag">This matches all files with the magic number
      <var class="Ar" title="Ar">byte-sequence</var>. Hexadecimal escapes may be
      included in the <var class="Ar" title="Ar">byte-sequence</var> by
      preceding them with \x, for example &#x2018;\x0a&#x2019; for a linefeed.
      Remember to protect such escapes with quotes or an additional backslash to
      prevent their interpretation by the shell.
    <div class="Pp"></div>
    Also see <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-offset</b>
      and <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-mask</b>.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-offset</b>
    <var class="Ar" title="Ar">offset</var></dt>
  <dd class="It-tag">This is the offset of the magic/mask in the file, counted
      in bytes. The default is 0. Only valid with
      <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-magic</b>.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-mask</b>
    <var class="Ar" title="Ar">byte-sequence</var></dt>
  <dd class="It-tag">This mask will be logically-ANDed with the string to be
      checked against the magic number given with
      <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-magic</b>. The
      default is all 0xff, i.e. no effect. Only valid with
      <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-magic</b>.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-extension</b>
    <var class="Ar" title="Ar">extension</var></dt>
  <dd class="It-tag">This matches all files whose names end in
      &#x201C;.<var class="Ar" title="Ar">extension</var>&#x201D;. Hexadecimal
      escapes are not recognized here. Extension matching is
    case-sensitive.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-detector</b>
    <var class="Ar" title="Ar">path</var></dt>
  <dd class="It-tag">If this option is used, a userspace detector program will
      be used to check whether the file is suitable for this interpreter. This
      may be used when the binary format is more complex than can be handled by
      the kernel's format specifications alone. The program should return an
      exit code of zero if the file is appropriate and non-zero otherwise.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-credentials</b>
    <b class="Cm" title="Cm">yes</b>,
    <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-credentials</b>
    <b class="Cm" title="Cm">no</b></dt>
  <dd class="It-tag">Whether to keep the credentials of the original binary to
      run the interpreter; this is typically useful to run setuid binaries, but
      has security implications.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;"><b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-preserve</b>
    <b class="Cm" title="Cm">yes</b>,
    <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-preserve</b>
    <b class="Cm" title="Cm">no</b></dt>
  <dd class="It-tag">Whether to preserve the original
      <code class="Li">argv[0]</code> when running the interpreter, rather than
      overwriting it with the full path to the binary.</dd>
</dl>
<h2 class="Ss" title="Ss" id="FORMAT_FILES"><a class="selflink" href="#FORMAT_FILES">FORMAT
  FILES</a></h2>
A format file is a sequence of options, one per line, corresponding roughly to
  the options given to an
  <b class="Fl" title="Fl">-</b><b class="Fl" title="Fl">-install</b> command.
  Each option consists of a key, followed by whitespace, followed by a value.
<div class="Pp"></div>
The <var class="Ar" title="Ar">package</var> option should be set to the current
  package. The <var class="Ar" title="Ar">interpreter</var> option should be set
  to the path to the interpreter that will handle this binary format. The
  <var class="Ar" title="Ar">magic</var>,
  <var class="Ar" title="Ar">offset</var>,
  <var class="Ar" title="Ar">mask</var>,
  <var class="Ar" title="Ar">extension</var>,
  <var class="Ar" title="Ar">detector</var>,
  <var class="Ar" title="Ar">credentials</var>, and
  <var class="Ar" title="Ar">preserve</var> options correspond to the
  command-line options of the same names.
<h1 class="Sh" title="Sh" id="EXIT_STATUS"><a class="selflink" href="#EXIT_STATUS">EXIT
  STATUS</a></h1>
<dl class="Bl-tag" style="margin-left: 7.80ex;">
  <dt class="It-tag" style="margin-left: -7.80ex;">0</dt>
  <dd class="It-tag">The requested action was successfully performed.</dd>
  <dt class="It-tag" style="margin-left: -7.80ex;">2</dt>
  <dd class="It-tag">Problems were encountered whilst parsing the command line
      or performing the action.</dd>
</dl>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
This format file can be used with an interpreter capable of handling Java .class
  files:
<div class="Pp"></div>
<div class="Bd" style="margin-left: 0.00ex;">
<pre class="Li">
    package javawrapper 
    interpreter /usr/bin/javawrapper 
    magic \xca\xfe\xba\xbe
</pre>
</div>
<div class="Pp"></div>
This corresponds roughly to the following command:
<div class="Pp"></div>
<div class="Bd" style="margin-left: 0.00ex;">
<pre class="Li">
    update-binfmts --package javawrapper \ 
        --install javawrapper /usr/bin/javawrapper \ 
        --magic '\xca\xfe\xba\xbe'
</pre>
</div>
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
If you're not careful, you can break your system with
  <b class="Nm" title="Nm">update-binfmts</b>. An easy way to do this is to
  register an ELF binary as a handler for ELF, which will almost certainly cause
  your system to hang immediately; even if it doesn't, you won't be able to run
  <b class="Nm" title="Nm">update-binfmts</b> to fix it. In the future
  <b class="Nm" title="Nm">update-binfmts</b> may have some checks to prevent
  this sort of thing happening accidentally, though of course you can still
  manipulate the binfmt_misc kernel module directly.
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
<b class="Nm" title="Nm">update-binfmts</b> is copyright (C) 2000, 2001, 2002,
  2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011
  <span class="An" title="An">Colin Watson</span>
  &#x27E8;cjwatson@debian.org&#x27E9;. See the GNU General Public License
  version 3 or later for copying conditions.
<div class="Pp"></div>
You can find the GNU GPL v3 in
  <i class="Pa" title="Pa">/usr/share/common-licenses/GPL-3</i> on any modern
  Debian system.
<div class="Pp"></div>
Richard Guenther wrote the binfmt_misc kernel module.
<h1 class="Sh" title="Sh" id="THANKS"><a class="selflink" href="#THANKS">THANKS</a></h1>
Ian Jackson wrote <b class="Ic" title="Ic">update-alternatives</b> and
  <b class="Ic" title="Ic">dpkg-divert</b>, from which this program borrows
  heavily.</div>
<table class="foot">
  <tr>
    <td class="foot-date">January 24, 2011</td>
    <td class="foot-os">Debian</td>
  </tr>
</table>
</body>
</html>
