<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>tcpick(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">tcpick(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">tcpick(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
tcpick - tcp stream sniffer and connection tracker
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>tcpick</b> [ <b> -a </b>] [<b> -n </b>] [<b> -C </b>]
<div>&#x00A0;</div>
[ <b> -e </b><i>count</i> ]
<div>&#x00A0;</div>
[ <b> -i </b><i>interface </i>|<b> -r </b><i> file </i>]
<div>&#x00A0;</div>
[ <b> -X </b><i>timeout</i> ]
<div>&#x00A0;</div>
[ <b> -D </b> ] [<b> -F1 </b>|<b> -F2 </b>]
<div>&#x00A0;</div>
[ <b> -yH </b>|<b> -yP </b>|<b> -yR </b>|<b> -yU </b>|<b> -yx </b>|<b> -yX </b>]
<div>&#x00A0;</div>
[ <b> -bH </b>|<b> -bP </b>|<b> -bR </b>|<b> -bU </b>|<b> -bx </b>|<b> -bX </b>]
<div>&#x00A0;</div>
[ <b> -wH[ub] </b>|<b> -wP[ub] </b>|<b> -wR[ub] </b>|<b> -wU[ub] </b>]
<div>&#x00A0;</div>
[ <b> -v </b> [<i> verbosity </i>]] [<b> -S </b>] [<b> -h </b>]
<div>&#x00A0;</div>
[ <b> --separator </b>]
<div>&#x00A0;</div>
[ <b> -T </b>|<b> -Tf </b> [<i> number </i>]]
<div>&#x00A0;</div>
[ <b> -E </b>|<b> -Ef </b> [<i> number </i>]]
<div>&#x00A0;</div>
[ <b> -Pc </b> | <b> -Ps </b>]
<div>&#x00A0;</div>
[ <i> &quot;filter&quot; </i>]
<div>&#x00A0;</div>
[ <b> --help </b>] [<b> --version </b>]
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>tcpick</b> is a textmode sniffer libpcap-based that can track tcp streams and
  saves the data captured in different files, each for every connection, or
  displays them in the terminal in different formats (hexdump, printable
  charachters, raw...) Useful for picking files in a passive way. It is useful
  to keep track of what users of a network are doing, and is usable with
  textmode tools like grep, sed, awk. Happy data hunting :-)
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="BASE_OPTIONS"><a class="selflink" href="#BASE_OPTIONS">BASE
  OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i --interface <i>interface</i></b></dt>
  <dd class="It-tag">listen on selected interface, (i.e. <i>ppp0</i> or
      <i>eth0</i>). If option <b>-i</b> is omitted, tcpick is able to select the
      first open interface (usually a ethernet card).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-r --readfile</b></dt>
  <dd class="It-tag">reads raw packets from a file written with <b>tcpdump
      -w</b> instead of using a network device.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b> &quot;filter&quot; </b></dt>
  <dd class="It-tag">This is the filter for the capturer engine. You can set it
      in the same way of setting the <b>tcpdump(1)</b> filter. Read tcpdump(1)
      manpage for other explanations.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-a</b></dt>
  <dd class="It-tag">Displays host names instead of ip addresses. Warning: for
      every new ip grabbed a dns query will be generated! Use it carefully on
      high-traffic network devices!</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-C --colors</b></dt>
  <dd class="It-tag">Uses terminal colors: very nice! It should help you to read
      the output of tcpick</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-D <i>number</i> <b>--dirs</b> <i>number</i></b></dt>
  <dd class="It-tag">Create directories to store sniffed sessions. When a
      directory contains <i>number</i> sessions, a new one will be created.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-e <i>count</i></b></dt>
  <dd class="It-tag">Exits when <i>count</i> packets have been sniffed</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-E <i>number</i></b></dt>
  <dd class="It-tag">Exit when <i>number</i> sniffed connections are detected as
      &quot;CLOSED&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-Ef <i>number</i></b></dt>
  <dd class="It-tag">Exit when <b>the first</b> <i>number</i> connections are
      detected as &quot;CLOSED&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-F1 -F2 --filenaming 1|2</b></dt>
  <dd class="It-tag">Choose the filenaming system.
    <div>&#x00A0;</div>
     <b> -F1 </b>: tcpick_<b>clientip</b>_<b>serverip</b>.<b>side</b>.dat
    <div>&#x00A0;</div>
    (side means <b>clnt</b>, <b>serv</b> or <b>both</b>)
    <div>&#x00A0;</div>
     <b> -F2 </b>:
      tcpick_<b>connectionnumber</b>_<b>clientip</b>_<b>serverip</b>.
      <b>side</b>.dat</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h</b></dt>
  <dd class="It-tag">Shows source and destination ip and port; shows tcp flags
      as letters.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">Displays a short help summary</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p</b></dt>
  <dd class="It-tag"><i>Don't</i> put the network interface in promiscuous mode.
      Note that the interface might be in promiscuous mode for some other
      reason.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-S</b></dt>
  <dd class="It-tag">Suppresses the &quot;status of the connection&quot;
    banner.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--separator</b></dt>
  <dd class="It-tag">Add a separator for the payloads displayed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-t</b></dt>
  <dd class="It-tag">Adds timestamp in <b>hour:minutes:seconds:microseconds</b>
      format</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-td</b></dt>
  <dd class="It-tag">Like <b>-t with date timestamp in
      </b><b>day-month-year</b><b> format</b>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-T <i>number</i><i></i></b></dt>
  <dd class="It-tag">Track <i>number</i> connections. It could be very useful on
      a high-traffic network device. If <i>number</i> is not specified, it will
      be set to <b>1</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-Tf <i>number</i></b></dt>
  <dd class="It-tag">Track <b>only the first</b> <i>number</i> connections; the
      following will be discarded. If <i>number</i> is not specified, it will be
      set to <b>1</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v <i>verbosity</i></b></dt>
  <dd class="It-tag">Quite unuseful, yet. Set verbosity level. Actually there
      are not really many extra messages to display, this means it is enabled by
      default ( <b>-v1</b>). Set verbosity level to <b>0</b> to suppress extra
      messages ( <b>-v0</b>) except error messages. Set verbosity level to
      <b>5</b> to display debug messages ( <b>-v5</b>). There are not other
      verbosity levels.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-X <i>timeout</i><i></i></b></dt>
  <dd class="It-tag">Connections are considered <b>EXPIRED</b> when there is no
      traffic for at least <i>timeout</i> seconds. Default is 600.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--version</b></dt>
  <dd class="It-tag">Displays the tcpick version
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="DISPLAY_THE_DATA_IN_THE_TCP_PACKETS"><a class="selflink" href="#DISPLAY_THE_DATA_IN_THE_TCP_PACKETS">DISPLAY
  THE DATA IN THE TCP PACKETS</a></h1>
These options are prefixed by <b>-y</b> and are useful to display in various
  ways the content of the packet sniffed (the data, called payload), once it
  arrives at the listening interface. In that way the tcp duplicates will be not
  discarded and the packets will not be reordered, but displayed &quot;as
  is&quot;. If you want a fully acknowledged stream, see the <b>-w</b> and
  <b>-b</b> set of options.
<dl class="Bl-tag">
  <dt class="It-tag"><b>-yH</b></dt>
  <dd class="It-tag">View data in hexadecimal-spaced mode (for the hexdump see
      <b>-yx</b> and <b>-yX</b> options.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-yP</b></dt>
  <dd class="It-tag">Shows data contained in the tcp packets. Non-printable
      charachters are transformed in dots: &quot; <b>.</b>&quot;. Newline
      character is preserved. This is the best way, in my opinion to show data
      like HTTP requests, IRC communication, SMTP stuff and so on.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-yR</b></dt>
  <dd class="It-tag">Displays all kind of charachters, printable and non
      printable. If something binary is transmitted, the effect will probably be
      like watching with &quot; <b>cat</b>&quot; at a gzipped file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-yx</b></dt>
  <dd class="It-tag">Shows all data after the header in hexadecimal dump of 16
      bytes per line.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-yX</b></dt>
  <dd class="It-tag">Shows all data after the header in hexadecimal and ascii
      dump with 16 bytes per line.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-yU</b></dt>
  <dd class="It-tag">Shows all data after the header, but <b>U</b>nprintable
      charachters are displayed as hexadecimal values between a &quot;&lt;&quot;
      and a &quot;&gt;&quot; symbol.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="REBUILD_AND_WRITE_THE_TCP_STREAM_TO_FILE"><a class="selflink" href="#REBUILD_AND_WRITE_THE_TCP_STREAM_TO_FILE">REBUILD
  AND WRITE THE TCP STREAM TO FILE</a></h1>
The prefix for these options is <b>-w</b>. The TCP stream that has been sniffed
  with these options will be written to file named:
<div>&#x00A0;</div>
<i>client_&lt;ip_client&gt;_&lt;ip_server&gt;_&lt;port_server&gt;.tcpick</i> and
<div>&#x00A0;</div>
<i>server_&lt;ip_client&gt;_&lt;ip_server&gt;_&lt;port_server&gt;.tcpick</i>
<div>&#x00A0;</div>
With the <b>u</b> flag of the <b>-w</b> option (i.e. <b>-wRu</b>) both client
  and server data will be written to a unique file named in that way:
<div>&#x00A0;</div>
<i>&lt;ip_client&gt;_&lt;ip_server&gt;_&lt;port_server&gt;.tcpick</i>
<div>&#x00A0;</div>
If you use the additional flag <b>b</b> of the <b>-w</b> option (i.e.
  <b>-wPub</b>), in the file will be written this banner:
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>[client|server] offset before:offset after (lenght of rebuilded</b>
  <b>segment)</b>
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
to distinguish between client and server data.
<div>&#x00A0;</div>
The flow is rebuilded, reordered and the duplicates are dropped. In that way it
  is possible to sniff entire files transmitted via ftp without data corruption
  (you can see this with md5sum). If no argument is given to <b>-w</b> the data
  will be written like <b>-wR</b> You can decide to write only client or server
  data by setting the flag
<br/>
 <b>C</b> (output only client data) and <b>S</b> (output only server data) to
  the <b>-w</b> set.
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-wR</b></dt>
  <dd class="It-tag">This is the preferred option: data will be written without
      any changes. Useful for sniffing binary or compressed files.
    <div>&#x00A0;</div>
    ( <b>-wRC</b> only the client, <b>-wRS</b> only the server)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-wP</b></dt>
  <dd class="It-tag">Unprintable charachters are written like dots.
    <div>&#x00A0;</div>
    ( <b>-wPC</b> only the client, <b>-wPS</b> only the server)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-wU</b></dt>
  <dd class="It-tag"><b>U</b>nprintable charachters are displayed as hexadecimal
      values between a &quot;&lt;&quot; and a &quot;&gt;&quot; symbol.
    <div>&#x00A0;</div>
    ( <b>-wPC</b> only the client, <b>-wPS</b> only the server)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-wH</b></dt>
  <dd class="It-tag">The flow is written in hexadecimal-spaced mode.
    <div>&#x00A0;</div>
    ( <b>-wHC</b> only the client, <b>-wHS</b> only the server)
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="DISPLAY_THE_REBUILDED_TCP_STREAM"><a class="selflink" href="#DISPLAY_THE_REBUILDED_TCP_STREAM">DISPLAY
  THE REBUILDED TCP STREAM</a></h1>
The prefix for these options is <b>-b</b>. This set of options is very useful if
  you want to redirect the sniffed flow to anoter program with a pipe, and there
  should be no data corruption. Of course the most useful is <b>-bR</b> to show
  the data as they are (raw). A very useful feature is the flag <b>C</b> (output
  only client data) and <b>S</b> (output only server data). I.e.: <b>-bRC</b>
  will display only the data from the client in raw mode; in that way you can
  put them in a file with a pipe redirection.
<div style="height: 1.00em;">&#x00A0;</div>
The sub-options are quite the same of the <b>-y</b> set, so you have:
<dl class="Bl-tag">
  <dt class="It-tag"><b> -bH </b> hex-spaced</dt>
  <dd class="It-tag">(<b>-bHC</b> only the client, <b>-bHS</b> only the
    server)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b> -bP </b> unprintable displayed as dots</dt>
  <dd class="It-tag">(<b>-bPC</b> only the client, <b>-bPS</b> only the
    server)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b> -bR </b> raw mode</dt>
  <dd class="It-tag">(<b>-bRC</b> only the client, <b>-bRS</b> only the
    server)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b> -bU </b> unprintable as &lt;hex&gt;.</dt>
  <dd class="It-tag">(<b>-bUC</b> only the client, <b>-bUS</b> only the
    server)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b> -bx </b> hexdump</dt>
  <dd class="It-tag">(<b>-bxC</b> only the client, <b>-bxS</b> only the
    server)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b> -bU </b> hexdump + ascii</dt>
  <dd class="It-tag">(<b>-bXC</b> only the client, <b>-bXS</b> only the
    server)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b> -PC --pipe client </b></dt>
  <dd class="It-tag">This is an alias for <b>-bRC -S -v0 -Tf1 -Ef1</b>. With
      this option you are able to track only the first connection ( <b>-T1</b>)
      matched by tcpick and data are displayed as raw. Only data from the client
      are put on stdout. All messages and banners are suppressed, except error
      messages ( <b>-S -v0</b>), so this option is particulary useful to
      download an entire fully rebuilded and acknowledged connection.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b> -PS --pipe server </b></dt>
  <dd class="It-tag">This is an alias for <b>-bRS -S -v0 -Tf1 -Ef1</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag">how to display the connection status:</dt>
  <dd class="It-tag"><b> # tcpick -i eth0 -C</b>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">display the payload and packet headers:</dt>
  <dd class="It-tag"><b> # tcpick -i eth0 -C -yP -h -a</b>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">display client data only of the first smtp connection:</dt>
  <dd class="It-tag"><b> # tcpick -i eth0 -C -bCU -T1 &quot;port 25&quot;</b>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">download a file passively:</dt>
  <dd class="It-tag"><b> # tcpick -i eth0 -wR &quot;port ftp-data&quot;</b>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">log http data in unique files (client and server mixed
    together):</dt>
  <dd class="It-tag"><b> # tcpick -i eth0 &quot;port 80&quot; -wRub</b>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">redirect the first connection to a software:</dt>
  <dd class="It-tag"><b> # tcpick -i eth0 --pipe client &quot;port 80&quot; |
      gzip &gt; http_response.gz</b>
    <div>&#x00A0;</div>
     <b> # tcpick -i eth0 --pipe server &quot;port 25&quot; | nc foobar.net
      25</b>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="MAILING-LIST"><a class="selflink" href="#MAILING-LIST">MAILING-LIST</a></h1>
Address: <i>&lt;tcpick-project[a]lists.sourceforge.net&gt;</i>
<div>&#x00A0;</div>
Archive:
  <i>http://sourceforge.net/mailarchive/forum.php?forum=tcpick-project</i>
<div>&#x00A0;</div>
Subscribe: <i>http://lists.sourceforge.net/lists/listinfo/tcpick-project</i>
<div>&#x00A0;</div>
If you have new ideas, patches, feature requests or simply need help, don't
  wait! I will be grateful if you send a message to the mailing list (even if
  you want to say what you liked most on tcpick).
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="TCPICK_WEBSITE"><a class="selflink" href="#TCPICK_WEBSITE">TCPICK
  WEBSITE</a></h1>
The tcpick website is at <i>http://tcpick.sf.net</i>.
<div>&#x00A0;</div>
You can find the project page here:
  <i>http://sourceforge.net/projects/tcpick</i> kindly hosted by the sourceforge
  team.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
Please check <b>AUTHORS</b> file.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Tcpick is an experimental software, and maybe some bugs are described in the
  <b>KNOWN-BUGS</b> file.
<div>&#x00A0;</div>
On some versions of MacOSX Segmentation Fault happens and connections aren't
  tracked properly.
<div>&#x00A0;</div>
If you find any other bug, please write to the tcpick mailing list.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
Other nice packet/data sniffers:
<div>&#x00A0;</div>
tcpdump, ngrep, tcptrack, ettercap, ethereal, snort
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="LICENSE"><a class="selflink" href="#LICENSE">LICENSE</a></h1>
This program is <b>free software</b>; you can redistribute it and/or modify it
  under the terms of the <b>GNU General Public License</b> as published by the
  Free Software Foundation; either version 2 of the License, or (at you option)
  any later version.
<div style="height: 1.00em;">&#x00A0;</div>
This program is distributed in the hope that it will be useful, but <b> WITHOUT
  ANY WARRANTY</b>; without even the implied warranty of MERCHANTABILITY or
  FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more
  details.
<div style="height: 1.00em;">&#x00A0;</div>
You should have received a copy of the GNU General Public License along with
  this program; if not, write to the Free Software Foundation, Inc., 59 Temple
  Place - Suite 330, Boston, MA 02111, USA.</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
