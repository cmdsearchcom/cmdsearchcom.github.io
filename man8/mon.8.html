<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>mon(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">mon(8)</td>
    <td class="head-vol">Parallel Service Monitoring Daemon</td>
    <td class="head-rtitle">mon(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
mon - monitor services for availability, sending alarms upon failures.
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>mon</b> [<b>-dfhlMSv</b>] [<b>-a</b> <i>dir</i>] [<b>-A</b> <i>authfile</i>]
  [<b>-b</b> <i>dir</i>] [<b>-B</b> <i>dir</i>] [<b>-c</b> <i>config</i>]
  [<b>-D</b> <i>dir</i>] [<b>-i</b> <i>secs</i>] [<b>-k</b> <i>num</i>]
  [<b>-l</b> <i>[</i>statetype<i>]</i>] [<b>-L</b> <i>dir</i>] [<b>-m</b>
  <i>num</i>] [<b>-p</b> <i>num</i>] [<b>-P</b> <i>pidfile</i>] [<b>-r</b>
  <i>delay</i>] [<b>-s</b> <i>dir</i>]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>mon</b> is a general-purpose scheduler for monitoring service availability
  and triggering alerts upon detecting failures. <b>mon</b> was designed to be
  open in the sense that it supports arbitrary monitoring facilities and alert
  methods via a common interface, which are easily implemented through programs
  (in C, Perl, shell, etc.), SNMP traps, and special Mon (UDP packet) traps.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-a&#x00A0;</b><i>dir</i></dt>
  <dd class="It-tag">Path to alert scripts. Default is
      <i>/usr/local/lib/mon/alert.d:alert.d</i>. Multiple alert paths may be
      specified by separating them with a colon. Non-absolute paths are taken to
      be relative to the base directory (<i>/usr/lib/mon</i> by default).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-b&#x00A0;</b><i>dir</i></dt>
  <dd class="It-tag">Base directory for mon. scriptdir, alertdir, and statedir
      are all relative to this directory unless specified from /. Default is
      <i>/usr/lib/mon</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-B&#x00A0;</b><i>dir</i></dt>
  <dd class="It-tag">Configuration file base directory. All config files are
      located here, including mon.cf, monusers.cf, and auth.cf.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-A&#x00A0;</b><i>authfile</i></dt>
  <dd class="It-tag">Authentication configuration file. By default this is
      <i>/etc/mon/auth.cf</i> if the <i>/etc/mon</i> directory exists, or
      <i>/usr/lib/mon/auth.cf</i> otherwise.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c&#x00A0;</b><i>file</i></dt>
  <dd class="It-tag">Read configuration from <i>file</i>. This defaults to IR
      /etc/mon/mon.cf &quot; if the &quot; /etc/mon directory exists, otherwise
      to <i>/etc/mon.cf</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d</b></dt>
  <dd class="It-tag">Enable debugging mode.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-D&#x00A0;dir</b></dt>
  <dd class="It-tag">Path to state directory. Default is the first of
      <i>/var/state/mon</i>, <i>/var/lib/mon</i>, and
      <i>/usr/lib/mon/state.d</i> which exists.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b></dt>
  <dd class="It-tag">Fork and run as a daemon process. This is the preferred way
      to run <b>mon</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h</b></dt>
  <dd class="It-tag">Print help information.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i&#x00A0;</b><i>secs</i></dt>
  <dd class="It-tag">Sleep interval, in seconds. Defaults to 1. This shouldn't
      need to be adjusted for any reason.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-k&#x00A0;</b><i>num</i></dt>
  <dd class="It-tag">Set log history to a maximum of <i>num</i> entries.
      Defaults to 100.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l&#x00A0;statetype</b></dt>
  <dd class="It-tag">Load state from the last saved state file. The supported
      saved state types are <b>disabled</b> for disabled watches, services, and
      hosts, <b>opstatus</b> for failure/alert/ack status of all services, and
      <b>all</b> for both. If no statetype is provided, <b>disabled</b> is
      assumed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-L&#x00A0;dir</b></dt>
  <dd class="It-tag">Sets the log dir. See also <b>logdir</b> in the
      configuration file. The default is <b>/var/log/mon</b> if that directory
      exists, otherwise <b>log.d</b> in the base directory.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-M</b></dt>
  <dd class="It-tag">Pre-process the configuration file with the macro expansion
      package <i>m4</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-m&#x00A0;</b><i>num</i></dt>
  <dd class="It-tag">Set the throttle for the maximum number of processes to
      <i>num</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p&#x00A0;</b><i>num</i></dt>
  <dd class="It-tag">Make server listen on port <i>num</i>. This defaults to
      2583.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-S</b></dt>
  <dd class="It-tag">Start with the scheduler stopped.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-P&#x00A0;</b><i>pidfile</i></dt>
  <dd class="It-tag">Store the server's pid in <i>pidfile</i>, the default is
      the first of <i>/var/run/mon/mon.pid</i>, <i>/var/run/mon.pid</i>, and
      <i>/etc/mon.pid</i> whose directory exists. An empty value tells
      <b>mon</b> not to use a pid file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-r&#x00A0;</b><i>delay</i></dt>
  <dd class="It-tag">Sets the number of seconds used to randomize the startup
      delay before each service is scheduled. Refer to the global
      <i>randstart</i> variable in the configuration file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s&#x00A0;</b><i>dir</i></dt>
  <dd class="It-tag">Path to monitor scripts. Default is
      <i>/usr/local/lib/mon/mon.d:mon.d</i>. Multiple alert paths may be
      specified by separating them with a colon. Non-absolute paths are taken to
      be relative to the base directory (<i>/usr/lib/mon</i> by default).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v</b></dt>
  <dd class="It-tag">Print version information.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="DEFINITIONS"><a class="selflink" href="#DEFINITIONS">DEFINITIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>monitor</b></dt>
  <dd class="It-tag">A program which tests for a certain condition, returns
      either true or false, and optionally produces output to be passed back to
      the scheduler. Common monitors detect host reachability via ICMP echo
      messages, or connection to TCP services.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>period</b></dt>
  <dd class="It-tag">A period in time as interpreted by the Time::Period
    module.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>alert</b></dt>
  <dd class="It-tag">A program which sends a message when invoked by the
      scheduler. The scheduler calls upon an alert when it detects a failure
      from a monitor. An alert program accepts a set of command-line arguments
      from the scheduler, in addition to data via standard input.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>hostgroup</b></dt>
  <dd class="It-tag">A single host or list of hosts, specified as names or IP
      addresses.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>service</b></dt>
  <dd class="It-tag">A collection of parameters used to deal with monitoring a
      particular resource which is provided by a group. Services are usually
      modeled after things such as an SMTP server, ICMP echo capability, server
      disk space availability, or SNMP events.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>view</b></dt>
  <dd class="It-tag">A collection of hostgroups, used to filter mon output for
      client display. i.e. a 'network-services' view might be defined so your
      network staff can see just the hostgroups which matter to them, without
      having to see all hostgroups defined in Mon.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>watch</b></dt>
  <dd class="It-tag">A collection of services which apply to a particular
    group.</dd>
</dl>
<h1 class="Sh" title="Sh" id="OPERATION"><a class="selflink" href="#OPERATION">OPERATION</a></h1>
When the <b>mon</b> scheduler starts, it reads a configuration file to determine
  the services it needs to monitor. The configuration file defaults to
  <i>/etc/mon.cf</i>, and can be specified using the <b>-c</b> parameter. If the
  <b>-M</b> option is specified, then the configuration file is pre-processed
  with <i>m4</i>. If the configuration file ends with .m4, the file is also
  processed by m4 automatically.
<div style="height: 1.00em;">&#x00A0;</div>
The scheduler enters a loop which handles client connections, monitor
  invocations, and failure alerts. Each service has a timer, specified in the
  configuration file as the <b>interval</b> variable, which tells the scheduler
  how frequently to invoke a monitor process. The scheduler may be temporarily
  stopped. While it is stopped, client access still functions, but it just
  doesn't schedule things. This is useful in conjunction while resetting the
  server, because you can do this: save the hosts and services which are
  disabled, reset the server with the scheduler stopped, re-disabled those hosts
  and services, then start the scheduler. It also allows making atomic changes
  across several client connections. See the <b>moncmd</b> man page for more
  information.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="MONITOR_PROGRAMS"><a class="selflink" href="#MONITOR_PROGRAMS">MONITOR&#x00A0;PROGRAMS</a></h1>
Monitor processes are invoked with the arguments specified in the configuration
  file, appended by the hosts from the applicable host group. For example, if
  the watch group is &quot;servers&quot;, which contain the hostnames
  &quot;smtp&quot;, &quot;nntp&quot;, and &quot;ns&quot;, and the monitor line
  reads as follows,
<div>&#x00A0;</div>
monitor fping.monitor -t 4000 -r 2
<div>&#x00A0;</div>
then the exectuable &quot;fping.monitor&quot; will be executed with these
  parameters:
<div>&#x00A0;</div>
MONITOR_DIR/fping.monitor -t 4000 -r 2 smtp nntp ns
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
MONITOR_DIR is actually a search path, by default
  <i>/usr/local/lib/mon/mon.d</i> then <i>/usr/lib/mon/mon.d</i>, but it can be
  overridden by the <b>-s</b> option or in the configuration file. If all hosts
  in the hostgroup have been disabled, then a warning is sent to syslog and the
  monitor is not run. This behavior may be overridden with the
  &quot;allow_empty_group&quot; option in the service definition. If the final
  argument to the &quot;monitor&quot; line is &quot;;;&quot; (it must be
  preceded by whitespace), then the host list will not be appended to the
  parameter list.
<div style="height: 1.00em;">&#x00A0;</div>
In addition to environment variables defined by the user in the service
  definition, <b>mon</b> passes certain variables to monitor process.
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_LAST_SUMMARY</b></dt>
  <dd class="It-tag">The first line of the output from the last time the monitor
      exited. This is not the summary of the current monitor run, but the
      previous one. This may be used by an alert script to provide historical
      context in an alert.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_LAST_OUTPUT</b></dt>
  <dd class="It-tag">The entire output of the monitor from the last time it
      exited. This is not the output of the current monitor run, but the
      previous one. This may be used by an alert script to provide historical
      context in an alert.
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_LAST_FAILURE</b></dt>
  <dd class="It-tag">The time(2) of the last failure for this service.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_FIRST_FAILURE</b></dt>
  <dd class="It-tag">The time(2) of the first time this service failed.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_LAST_SUCCESS</b></dt>
  <dd class="It-tag">The time(2) of the last time this service passed.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_DESCRIPTION</b></dt>
  <dd class="It-tag">The description of this service, as defined in the
      configuration file using the <i>description</i> tag.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_DEPEND_STATUS</b></dt>
  <dd class="It-tag">The depend status, &quot;o&quot; if dependency failure,
      &quot;1&quot; otherwise.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_LOGDIR</b></dt>
  <dd class="It-tag">The directory log files should be placed, as indicated by
      the <i>logdir</i> global configuration variable.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_STATEDIR</b></dt>
  <dd class="It-tag">The directory where state files should be kept, as
      indicated by the <i>statedir</i> global configuration variable.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_CFBASEDIR</b></dt>
  <dd class="It-tag">The directory where configuration files should be kept, as
      indicated by the <i>cfbasedir</i> global configuration variable.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<div class="Pp"></div>
&quot;fping.monitor&quot; should return an exit status of 0 if it completed
  successfully (found no problems), or nonzero if a problem was detected. The
  first line of output from the monitor script has a special meaning: it is used
  as a brief summary of the exact failure which was detected, and is passed to
  the alert program. All remaining output is also passed to the alert program,
  but it has no required interpretation.
<div style="height: 1.00em;">&#x00A0;</div>
If a monitor for a particular service is still running, and the time comes for
  <b>mon</b> to run another monitor for that service, it will not start another
  monitor. For example, if the <i>interval</i> is 10s, and the monitor does not
  finish running within 10 seconds, then <b>mon</b> will wait until the first
  monitor exits before running another one.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="ALERT_DECISION_LOGIC"><a class="selflink" href="#ALERT_DECISION_LOGIC">ALERT
  DECISION LOGIC</a></h1>
Upon a non-zero or zero exit status, the associated alert or upalert program
  (respectively) is started, pending the following conditions: If an alert for a
  specific service is disabled, do not send an alert. If <b>dep_behavior</b> is
  set to <i>'a'</i>, or <b>alertdepend</b> is set, and a parent dependency is
  failing, then suppress the alert. If the alert has previously been
  acknowledged, do not send the alert, unless it is an upalert. If an alert is
  not within the specified period, record the failure via syslog(3) and do not
  send an alert. If the failure does not fall within a defined period, do not
  send an alert. No upalerts are sent without corresponding down alerts, unless
  <b>no_comp_alerts</b> is defined in the period section. An upalert will only
  be sent if the previous state is a failure. If an alert was already sent
  within the last <b>alertevery</b> interval, do not send another alert,
  <i>unless</i> the summary output from the current monitor program differs from
  the last monitor process. Otherwise, send an alert using each alert program
  listed for that period. The <b>observe_detail</b> argument to
  <b>alertevery</b> affects this behavior by observing the changes in the detail
  part of the output in addition to the summary line. If a monitor has
  successive failures and the summary output changes in each of them,
  <b>alertevery</b> will not suppress multiple consecutive alerts. The reasoning
  is that if the summary output changes, then a significant event occurred and
  the user should be alerted. The &quot;strict&quot; argument to alertevery will
  suppress both comparing the output from the previous monitor run to the
  current and prevent a successful return value of the monitor from resetting
  the alertevery timer. For example, &quot;alertevery 24h strict&quot; will only
  send out an alert once every 24 hours, regardless of whether the monitor
  output changes, or if the service stops and then starts failing.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="ALERT_PROGRAMS"><a class="selflink" href="#ALERT_PROGRAMS">ALERT&#x00A0;PROGRAMS</a></h1>
Alert programs are found in the path supplied with the <b>-a</b> parameter, or
  in the <i>/usr/local/lib/mon/alert.d</i> and directories if not specified.
  They are invoked with the following command-line parameters:
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s&#x00A0;</b><i>service</i></dt>
  <dd class="It-tag">Service tag from the configuration file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-g&#x00A0;</b><i>group</i></dt>
  <dd class="It-tag">Host group name from the configuration file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h&#x00A0;</b><i>hosts</i></dt>
  <dd class="It-tag">The expanded version of the host group, space delimited,
      but contained in one shell &quot;word&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l&#x00A0;</b><i>alertevery</i></dt>
  <dd class="It-tag">The number of seconds until the next alarm will be
    sent.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-O</b></dt>
  <dd class="It-tag">This option is supplied to an alert only if the alert is
      being generated as a result of an expected traap timing out</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-t&#x00A0;</b><i>time</i></dt>
  <dd class="It-tag">The time (in <b>time</b>(2) format) of when this failure
      condition was detected.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-T</b></dt>
  <dd class="It-tag">This option is supplied to an alert only if the alert was
      triggered by a trap</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-u</b></dt>
  <dd class="It-tag">This option is supplied to an alert only if it is being
      called as an upalert.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<div class="Pp"></div>
The remaining arguments are supplied from the trailing parameters in the
  configuration file, after the &quot;alert&quot; service parameter.
<div style="height: 1.00em;">&#x00A0;</div>
As with monitor programs, alert programs are invoked with environment variables
  defined by the user in the service definition, in addition to the following
  which are explicitly set by the server:
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_LAST_SUMMARY</b></dt>
  <dd class="It-tag">The first line of the output from the last time the monitor
      exited.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_LAST_OUTPUT</b></dt>
  <dd class="It-tag">The entire output of the monitor from the last time it
      exited.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_LAST_FAILURE</b></dt>
  <dd class="It-tag">The time(2) of the last failure for this service.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_FIRST_FAILURE</b></dt>
  <dd class="It-tag">The time(2) of the first time this service failed.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_LAST_SUCCESS</b></dt>
  <dd class="It-tag">The time(2) of the last time this service passed.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_DESCRIPTION</b></dt>
  <dd class="It-tag">The description of this service, as defined in the
      configuration file using the <i>description</i> tag.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_GROUP</b></dt>
  <dd class="It-tag">The watch group which triggered this alarm
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_SERVICE</b></dt>
  <dd class="It-tag">The service heading which generated this alert
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_RETVAL</b></dt>
  <dd class="It-tag">The exit value of the failed monitor program, or return
      value as accepted from a trap.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_OPSTATUS</b></dt>
  <dd class="It-tag">The operational status of the service.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_ALERTTYPE</b></dt>
  <dd class="It-tag">Has one of the following values: &quot;failure&quot;,
      &quot;up&quot;, &quot;startup&quot;, &quot;trap&quot;, or
      &quot;traptimeout&quot;, and signifies the type of alert which was
      triggered.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_TRAP_INTENDED</b></dt>
  <dd class="It-tag">This is only set when an unknown mon trap is received and
      caught by the default/defaut watch/service. This contains colon separated
      entries of the trap's intended watch group and service name.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_LOGDIR</b></dt>
  <dd class="It-tag">The directory log files should be placed, as indicated by
      the <i>logdir</i> global configuration variable.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_STATEDIR</b></dt>
  <dd class="It-tag">The directory where state files should be kept, as
      indicated by the <i>statedir</i> global configuration variable.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>MON_CFBASEDIR</b></dt>
  <dd class="It-tag">The directory where configuration files should be kept, as
      indicated by the <i>cfbasedir</i> global configuration variable.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<div class="Pp"></div>
The first line from standard input must be used as a brief summary of the
  problem, normally supplied as the subject line of an email, or text sent to an
  alphanumeric pager. Interpretation of all subsequent lines read from stdin is
  left up to the alerting program. The usual parameters are a list of recipients
  to deliver the notification to. The interpretation of the recipients is not
  specified, and is up to the alert program.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="CONFIGURATION_FILE"><a class="selflink" href="#CONFIGURATION_FILE">CONFIGURATION
  FILE</a></h1>
The configuration file consists of zero or more global variable definitions,
  zero or more hostgroup definitions, and one or more watch definitions. Each
  watch definition may have one or more service definitions. A watch definition
  is terminated by a blank line, another definition, or the end of the file. A
  line beginning with optional leading whitespace and a pound (&quot;#&quot;) is
  regarded as a comment, and is ignored.
<div style="height: 1.00em;">&#x00A0;</div>
Lines are parsed as they are read. Long lines may be continued by ending them
  with a backslash (&quot;\&quot;). If a line is continued, then the backslash,
  the trailing whitespace after the backslash, and the leading whitespace of the
  following line are removed. The end result is assembled into a single line.
<div style="height: 1.00em;">&#x00A0;</div>
Typically the configuration file has the following layout:
<div style="height: 1.00em;">&#x00A0;</div>
1. Global variable definitions
<div style="height: 1.00em;">&#x00A0;</div>
2. Hostgroup definitions
<div style="height: 1.00em;">&#x00A0;</div>
3. Watch definitions
<div style="height: 1.00em;">&#x00A0;</div>
See the &quot;etc/example.cf&quot; file which comes for the distribution for an
  example.
<div style="height: 1.00em;">&#x00A0;</div>
<h2 class="Ss" title="Ss" id="Global_Variables"><a class="selflink" href="#Global_Variables">Global
  Variables</a></h2>
The following variables may be set to override compiled-in defaults.
  Command-line options will have a higher precedence than these definitions.
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>alertdir = </b><i>dir</i></dt>
  <dd class="It-tag"><i>dir</i> is the full path to the alert scripts. This is
      the value set by the <b>-a</b> command-line parameter.
    <div style="height: 1.00em;">&#x00A0;</div>
    Multiple alert paths may be specified by separating them with a colon.
      Non-absolute paths are taken to be relative to the base directory
      (<i>/usr/lib/mon</i> by default).
    <div style="height: 1.00em;">&#x00A0;</div>
    When the configuration file is read, all alerts referenced from the
      configuration will be looked up in each of these paths, and the full path
      to the first instance of the alert found is stored in a hash. This hash is
      only generated upon startup or after a &quot;reset&quot; command, so newly
      added alert scripts will not be recognized until a &quot;reset&quot; is
      performed.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>mondir = </b><i>dir</i></dt>
  <dd class="It-tag"><i>dir</i> is the full path to the monitor scripts. This
      value may also be set by the <b>-s</b> command-line parameter. If this
      path does not begin with a &quot;/&quot;, it will be relative to
      <i>basedir</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
    Multiple alert paths may be specified by separating them with a colon. All
      paths must be absolute.
    <div style="height: 1.00em;">&#x00A0;</div>
    When the configuration file is read, all monitors referenced from the
      configuration will be looked up in each of these paths, and the full path
      to the first instance of the monitor found is stored in a hash. This hash
      is only generated upon startup or after a &quot;reset&quot; command, so
      newly added monitor scripts will not be recognized until a
      &quot;reset&quot; is performed.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>statedir = </b><i>dir</i></dt>
  <dd class="It-tag"><i>dir</i> is the full path to the state directory.
      <b>mon</b> uses this directory to save various state information. If this
      path does not begin with a &quot;/&quot;, it will be relative to
      <i>basedir</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>logdir = </b><i>dir</i></dt>
  <dd class="It-tag"><i>dir</i> is the full path to the log directory.
      <b>mon</b> uses this directory to save various logs, including the
      downtime log. If this path does not begin with a &quot;/&quot;, it will be
      relative to <i>basedir</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>basedir = </b><i>dir</i></dt>
  <dd class="It-tag"><i>dir</i> is the full path for the state, log, monitor,
      and alert directories.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>cfbasedir = </b><i>dir</i></dt>
  <dd class="It-tag"><i>dir</i> is the full path where all the config files can
      be found (monusers.cf, auth.cf, etc.).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>authfile = </b><i>file</i></dt>
  <dd class="It-tag"><i>file</i> is the path to the authentication file. If the
      path does not begin with a &quot;/&quot;, it will be relative to
      <i>cfbasedir</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>authtype = </b><i>type [type...]</i></dt>
  <dd class="It-tag"><i>type</i> is the type of authentication to use. A
      space-separated list of types may be specified, and they will be checked
      the order they are listed. As soon as a successful authentication is
      performed, the user is considered authenticated by mon for the duration of
      the session and no more authentication checks are performed.
    <div style="height: 1.00em;">&#x00A0;</div>
    If <i>type</i> is <b>getpwnam</b>, then the standard Unix passwd file
      authentication method will be used (calls getpwnam(3) on the user and
      compares the crypt(3)ed version of the password with what it gets from
      getpwnam). This will not work if shadow passwords are enabled on the
      system.
    <div style="height: 1.00em;">&#x00A0;</div>
    If <i>type</i> is <b>userfile</b>, then usernames and hashed passwords are
      read from <i>userfile</i>, which is defined via the <b>userfile</b>
      configuration variable.
    <div style="height: 1.00em;">&#x00A0;</div>
    If <i>type</i> is <b>pam</b>, then PAM (pluggable authentication modules)
      will be used for authentication. The service specified by the
      <b>pamservice</b> global will be used. If no global is given, the PAM
      <b>passwd</b> service will be used.
    <div style="height: 1.00em;">&#x00A0;</div>
    If <i>type</i> is <b>trustlocal</b>, then if the client connection comes
      from locahost, the username passed from the client will be trusted, and
      the password will be ignored. This can be used when you want the client to
      handle the authentication for you. I.e. a CGI script using one of the many
      apache authentication methods.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>userfile = </b><i>file</i></dt>
  <dd class="It-tag">This file is used when <b>authtype</b> is set to
      <i>userfile</i>. It consists of a sequence of lines of the format
      <b>'username : password'</b>. <b>password</b> is stored as the hash
      returned by the standard Unix crypt(3) function. <b>NOTE:</b> the format
      of this file is compatible with the Apache file based username/password
      file format. It is possible to use the <i>htpasswd</i> program supplied
      with Apache to manage the mon userfile.
    <div style="height: 1.00em;">&#x00A0;</div>
    Blank lines and lines beginning with # are ignored.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>pamservice = </b><i>service</i></dt>
  <dd class="It-tag">The PAM service used for authentication. This is applicable
      only if &quot;pam&quot; is specified as a parameter to the <b>authtype</b>
      setting. If this global is not defined, it defaults to <b>passwd</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>serverbind = </b><i>addr</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>trapbind = </b><i>addr</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>serverbind</b> and <b>trapbind</b> specify which address to bind the
      server and trap ports to, respectively. If these are not defined, the
      default address is INADDR_ANY, which allows connections on all interfaces.
      For security reasons, it could be a good idea to bind only to the loopback
      interface.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>dtlogfile = </b><i>file</i></dt>
  <dd class="It-tag"><i>file</i> is a file which will be used to record the
      downtime log. Whenever a service fails for some amount of time and then
      stop failing, this event is written to the log. If this parameter is not
      set, no logging is done. The format of the file is as follows (# is a
      comment and may be ignored):
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>timenoticed group service firstfail downtime interval summary</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>timenoticed</b> is the time(2) the service came back up.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>group service</b> is the group and service which failed.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>firstfail</b> is the time(2) when the service began to fail.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>downtime</b> is the number of seconds the service failed.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>interval</b> is the frequency (in seconds) that the service is polled.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>summary</b> is the summary line from when the service was failing.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>monerrfile = </b><i>filename</i></dt>
  <dd class="It-tag">By default, when mon daemonizes itself, it connects stdout
      and stderr to /dev/null. If <b>monerrfile</b> is set to a file, then
      stdout and stderr will be appended to that file. In all cases stdin is
      connected to /dev/null. If mon is told to run in the foreground and to not
      daemonize, then none of this applies, since stdin/stdout/stderr stay
      connected to whatever they were at the time of invocation.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>dtlogging = </b><i>yes/no</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    Turns downtime logging on or off. The default is off.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>histlength = </b><i>num</i></dt>
  <dd class="It-tag"><i>num</i> is the the maximum number of events to be
      retained in history list. The default is 100. This value may also be set
      by the <b>-k</b> command-line parameter.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>historicfile = </b><i>file</i></dt>
  <dd class="It-tag">If this variable is set, then alerts are logged to
      <i>file</i>, and upon startup, some (or all) of the past history is read
      into memory.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>historictime = </b><i>timeval</i></dt>
  <dd class="It-tag"><i>num</i> is the amount of the history file to read upon
      startup. &quot;Now&quot; - <i>timeval</i> is read. See the explanation of
      <i>interval</i> in the &quot;Service Definitions&quot; section for a
      description of <i>timeval</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>serverport = </b><i>port</i></dt>
  <dd class="It-tag"><i>port</i> is the TCP port number that the server should
      bind to. This value may also be set by the <b>-p</b> command-line
      parameter. Normally this port is looked up via getservbyname(3), and it
      defaults to 2583.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>trapport = </b><i>port</i></dt>
  <dd class="It-tag"><i>port</i> is the UDP port number that the trap server
      should bind to. Normally this port is looked up via getservbyname(3), and
      it defaults to 2583.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>pidfile = </b><i>path</i></dt>
  <dd class="It-tag"><i>path</i> is the file the sever will store its pid in.
      This value may also be set by the <b>-P</b> command-line parameter.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>maxprocs = </b><i>num</i></dt>
  <dd class="It-tag">Throttles the number of concurrently forked processes to
      <i>num.</i> The intent is to provide a safety net for the unlikely
      situation when the server tries to take on too many tasks at once. Note
      that this situation has only been reported to happen when trying to use a
      garbled configuration file! You don't want to use a garbled configuration
      file now, do you?
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>cltimeout = </b><i>secs</i></dt>
  <dd class="It-tag">Sets the client inactivity timeout to <i>secs.</i> This is
      meant to help thwart denial of service attacks or recover from crashed
      clients. <i>secs</i> is interpreted as a &quot;1h/1m/1s&quot; string,
      where &quot;1m&quot; = 60 seconds.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>randstart = </b><i>interval</i></dt>
  <dd class="It-tag">When the server starts, normally all services will not be
      scheduled until the interval defined in the respective service section.
      This can cause long delays before the first check of a service, and
      possibly a high load on the server if multiple things are scheduled at the
      same intervals. This option is used to randomize the scheduling of the
      first test for all services during the startup period, and immediately
      after the <i>reset</i> command. If <i>randstart</i> is defined, the
      scheduled run time of all services of all watch groups will be a random
      number between zero and <i>randstart</i> seconds.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>dep_recur_limit = </b><i>depth</i></dt>
  <dd class="It-tag">Limit dependency recursion level to <i>depth</i>. If
      dependency recursion (dependencies which depend on other dependencies)
      tries to go beyond <i>depth</i>, then the recursion is aborted and a
      messages is logged to syslog. The default limit is 10.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>dep_behavior = </b><i>{a|m|hm}</i></dt>
  <dd class="It-tag"><b>dep_behavior</b> controls whether the dependency
      expression suppresses one of: the running of alerts, the running of
      monitors, or the passing of individual hosts to the monitors. Read more
      about the behavior in the &quot;Service Definitions&quot; section below.
    <div style="height: 1.00em;">&#x00A0;</div>
    This is a global setting which controls the default settings for the
      service-specified variable.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>dep_memory = </b><i>timeval</i></dt>
  <dd class="It-tag">If set, dep_memory will cause dependencies to continue to
      prevent alerts/monitoring for a period of time after the service returns
      to a normal state. This can be used to prevent over-eager alerting when a
      machine is rebooting, for example. See the explanation of <i>interval</i>
      in the &quot;Service Definitions&quot; section for a description of
      <i>timeval</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
    This is a global setting which controls the default settings for the
      service-specified variable.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>syslog_facility = </b><i>facility</i></dt>
  <dd class="It-tag">Specifies the syslog facility used for logging.
      <b>daemon</b> is the default.
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>startupalerts_on_reset = </b><i>{yes|no}</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    If set to &quot;yes&quot;, startupalerts will be invoked when the
      <b>reset</b> client command is executed. The default is &quot;no&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>monremote = </b><i>program</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    If set, this external program will be called by Mon when various client
      requests are processed. This can be used to propagate those changes from
      one Mon server to another, if you have multiple monitoring machines. An
      example script, <b>monremote.pl</b> is available in the clients directory.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h2 class="Ss" title="Ss" id="Hostgroup_Entries"><a class="selflink" href="#Hostgroup_Entries">Hostgroup
  Entries</a></h2>
Hostgroup entries begin with the keyword <b>hostgroup</b>, and are followed by a
  hostgroup tag and one or more hostnames or IP addresses, separated by
  whitespace. The hostgroup tag must be composed of alphanumeric characters, a
  dash (&quot;-&quot;), a period (&quot;.&quot;), or an underscore
  (&quot;_&quot;). Non-blank lines following the first hostgroup line are
  interpreted as more hostnames. The hostgroup definition ends with a blank
  line. For example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
hostgroup servers nameserver smtpserver nntpserver
	nfsserver httpserver smbserver
<div class="Pp"></div>
hostgroup router_group cisco7000 agsplus
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h2 class="Ss" title="Ss" id="View_Entries"><a class="selflink" href="#View_Entries">View
  Entries</a></h2>
View entries begin with the keyword <b>view</b>, and are followed by a view tag
  and the names of one or more hostgroups. The view tag must be composed of
  alphanumeric characters, a dash (&quot;-&quot;), a period (&quot;.&quot;), or
  an underscore (&quot;_&quot;). Non-blank lines following the first view line
  are interpreted as more hostgroup names. The view definition ends with a blank
  line. For example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
view servers dns-servers web-servers file-servers
     mail-servers
<div class="Pp"></div>
view network-services routers switches vpn-servers
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h2 class="Ss" title="Ss" id="Watch_Group_Entries"><a class="selflink" href="#Watch_Group_Entries">Watch
  Group Entries</a></h2>
Watch entries begin with a line that starts with the keyword <b>watch</b>,
  followed by whitespace and a single word which normally refers to a
  pre-defined hostgroup. If the second word is not recognized as a hostgroup
  tag, a new hostgroup is created whose tag is that word, and that word is its
  only member.
<div style="height: 1.00em;">&#x00A0;</div>
Watch entries consist of one or more service definitions.
<div style="height: 1.00em;">&#x00A0;</div>
A watch group is terminated by a blank line, the end of the file, or by a
  subsequent definition, &quot;watch&quot;, &quot;hostgroup&quot;, or otherwise.
<div style="height: 1.00em;">&#x00A0;</div>
There may be a special watch group entry called &quot;default&quot;. If a
  default watch group is defined with a service entry named &quot;default&quot;,
  then this definition will be used in handling traps received for an
  unrecognized watch and service.
<div style="height: 1.00em;">&#x00A0;</div>
<h2 class="Ss" title="Ss" id="Service_Definitions"><a class="selflink" href="#Service_Definitions">Service
  Definitions</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>service</b><i> servicename</i></dt>
  <dd class="It-tag">A service definition begins with they keyword
      <b>service</b> followed by a word which is the tag for this service. This
      word must be unique among all services defined for the same watch group.
    <div style="height: 1.00em;">&#x00A0;</div>
    The components of a service are an interval, monitor, and one or more time
      period definitions, as defined below.
    <div style="height: 1.00em;">&#x00A0;</div>
    If a service name of &quot;default&quot; is defined within a watch group
      called &quot;dafault&quot; (see above), then the default/default
      definition will be used for handling unknown mon traps.
    <div style="height: 1.00em;">&#x00A0;</div>
    The following configuration parameters are valid only following a service
      definition:
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>VARIABLE=</b><i>value</i></dt>
  <dd class="It-tag">Environment variables may be defined for each service,
      which will be included in the environment of monitors and alerts.
      Variables must be specified in all capital letters, must begin with an
      alphabetical character or an underscore, and there must be no spaces to
      the left of the equal sign.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>interval</b><i> timeval</i></dt>
  <dd class="It-tag">The keyword <b>interval</b> followed by a time value
      specifies the frequency that a monitor script will be triggered. Time
      values are defined as &quot;30s&quot;, &quot;5m&quot;, &quot;1h&quot;, or
      &quot;1d&quot;, meaning 30 seconds, 5 minutes, 1 hour, or 1 day. The
      numeric portion may be a fraction, such as &quot;1.5h&quot; or an hour and
      a half. This format of a time specification will be referred to as
      <i>timeval</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>failure_interval</b><i> timeval</i></dt>
  <dd class="It-tag">Adjusts the polling interval to <i>timeval</i> when the
      service check is failing. Resets the interval to the original when the
      service succeeds.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>traptimeout</b><i> timeval</i></dt>
  <dd class="It-tag">This keyword takes the same time specification argument as
      <b>interval</b><i>,</i> and makes the service expect a trap from an
      external source at least that often, else a failure will be registered.
      This is used for a heartbeat-style service.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>trapduration</b><i> timeval</i></dt>
  <dd class="It-tag">If a trap is received, the status of the service the trap
      was delivered to will normally remain constant. If <b>trapduration</b> is
      specified, the status of the service will remain in a failure state for
      the duration specified by <i>timeval</i>, and then it will be reset to
      &quot;success&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>randskew</b><i> timeval</i></dt>
  <dd class="It-tag">Rather than schedule the monitor script to run at the start
      of each interval, randomly adjust the interval specified by the
      <b>interval</b> parameter by plus-or-minus <b>randskew .</b> The skew
      value is specified as the <b>interval</b> parameter: &quot;30s&quot;,
      &quot;5m&quot;, etc... For example if <b>interval</b> is 1m, and
      <b>randskew</b> is &quot;5s&quot;, then <i>mon</i> will schedule the
      monitor script some time between every 55 seconds and 65 seconds. The
      intent is to help distribute the load on the server when many services are
      scheduled at the same intervals.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>monitor</b><i> monitor-name [arg...]</i></dt>
  <dd class="It-tag">The keyword <b>monitor</b> followed by a script name and
      arguments specifies the monitor to run when the timer expires. Shell-like
      quoting conventions are followed when specifying the arguments to send to
      the monitor script. The script is invoked from the directory given with
      the <b>-s</b> argument, and all following words are supplied as arguments
      to the monitor program, followed by the list of hosts in the group
      referred to by the current watch group. If the monitor line ends with
      &quot;;;&quot; as a separate word, the host groups are not appended to the
      argument list when the program is invoked.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>allow_empty_group</b></dt>
  <dd class="It-tag">The <b>allow_empty_group</b> option will allow a monitor to
      be invoked even when the hostgroup for that watch is empty because of
      disabled hosts. The default behavior is not to invoke the monitor when all
      hosts in a hostgroup have been disabled.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>description</b><i> descriptiontext</i></dt>
  <dd class="It-tag">The text following <b>description</b> is queried by client
      programs, passed to alerts and monitors via an environment variable. It
      should contain a brief description of the service, suitable for inclusion
      in an email or on a web page.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>exclude_hosts</b><i> host [host...]</i></dt>
  <dd class="It-tag">Any hosts listed after <b>exclude_hosts</b> will be
      excluded from the service check.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>exclude_period</b><i> periodspec</i></dt>
  <dd class="It-tag">Do not run a scheduled monitor during the time identified
      by <i>periodspec</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>depend</b><i> dependexpression</i></dt>
  <dd class="It-tag">The <b>depend</b> keyword is used to specify a dependency
      expression, which evaluates to either true of false, in the boolean sense.
      Dependencies are actual Perl expressions, and must obey all syntactical
      rules. The expressions are evaluated in their own package space so as to
      not accidentally have some unwanted side-effect. If a syntax error is
      found when evaluating the expression, it is logged via syslog.
    <div style="height: 1.00em;">&#x00A0;</div>
    Before evaluation, the following substitutions on the expression occur:
      phrases which look like &quot;group:service&quot; are substituted with the
      value of the current operational status of that specified service. These
      opstatus substitutions are computed recursively, so if service A depends
      upon service B, and service B depends upon service C, then service A
      depends upon service C. Successful operational statuses (which evaluate to
      &quot;1&quot;) are &quot;STAT_OK&quot;, &quot;STAT_COLDSTART&quot;,
      &quot;STAT_WARMSTART&quot;, and &quot;STAT_UNKNOWN&quot;. The word
      &quot;SELF&quot; (in all caps) can be used for the group (e.g.
      &quot;SELF:service&quot;), and is an abbreviation for the current watch
      group.
    <div style="height: 1.00em;">&#x00A0;</div>
    This feature can be used to control alerts for services which are dependent
      on other services, e.g. an SMTP test which is dependent upon the machine
      being ping-reachable.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>dep_behavior</b><i> {a|m|hm}</i></dt>
  <dd class="It-tag">The evaluation of the dependency graphs specified via the
      <b>depend</b> keyword can control the suppression of alert or monitor
      invocations, or the suppression of individual hosts passed to the monitor.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>Alert suppression</b>. If this option is set to &quot;a&quot;, then the
      dependency expression will be evaluated after the monitor for the service
      exits or after a trap is received. An alert will only be sent if the
      evaluation succeeds, meaning that none of the nodes in the dependency
      graph indicate failure.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>Monitor suppression</b>. If it is set to &quot;m&quot;, then the
      dependency expression will be evaulated before the monitor for the service
      is about to run. If the evaulation succeeds, then the monitor will be run.
      Otherwise, the monitor will not be run and the status of the service will
      remain the same.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>Host suppression</b>. If it is set to &quot;hm&quot; then Mon will
      extract the list of &quot;parent&quot; services from the dependency
      expression. (In fact the expression can be just a list of services.) Then
      when the monitor for the service is about to be run, for each host in the
      current hostgroup Mon will search all the parent services which are
      currently failing and look for the hostname in the current summary output.
      If the hostname is found, this host will be excluded from this run of the
      monitor. This can be used to e.g. allow an SMTP test on a group of hosts
      to still be run even when a single host is not ping-reachable. If all the
      rest of the hosts are working fine, the service will be in an OK state,
      but if another host fails the SMTP test Mon can still alert about that
      host even though the parent dependency was failing. The dependency
      expression will <b>not</b> be used recursively in this case.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>alertdepend</b><i> dependexpression</i></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>monitordepend</b><i> dependexpression</i></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>hostdepend</b><i> dependexpression</i></dt>
  <dd class="It-tag">These keywords allow you to specify multiple dependency
      expressions of different types. Each one corresponds to the different
      <b>dep_behavior</b> settings listed above. They will be evaluated
      independently in the different contexts as listed above. If <b>depend</b>
      is present, it takes precedence over the matching keyword, depending on
      the <b>dep_behavior</b> setting.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>dep_memory </b><i>timeval</i></dt>
  <dd class="It-tag">If set, dep_memory will cause dependencies to continue to
      prevent alerts/monitoring for a period of time after the service returns
      to a normal state. This can be used to prevent over-eager alerting when a
      machine is rebooting, for example. See the explanation of <i>interval</i>
      in the &quot;Service Definitions&quot; section for a description of
      <i>timeval</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>redistribute</b><i> alert [arg...]</i></dt>
  <dd class="It-tag">A service may have one redistribute option, which is a
      special form of an an alert definition. This alert will be called on every
      service status update, even sequential success status updates. This can be
      used to integrate Mon with another monitoring system, or to link together
      multiple Mon servers via an alert script that generates Mon traps. See the
      &quot;ALERT PROGRAMS&quot; section above for a list of the parameters mon
      will pass automatically to alert programs.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>unack_summary</b></dt>
  <dd class="It-tag">Remove the &quot;acknowledged&quot; state from a service if
      the summary component of the failure message changes. In most common usage
      the summary is the list of hosts that are failing, so additional hosts
      failing would remove an ack.
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h2 class="Ss" title="Ss" id="Period_Definitions"><a class="selflink" href="#Period_Definitions">Period
  Definitions</a></h2>
Periods are used to define the conditions which should allow alerts to be
  delivered.
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>period</b><i> [label:] periodspec</i></dt>
  <dd class="It-tag">A period groups one or more alarms and variables which
      control how often an alert happens when there is a failure. The
      <b>period</b> definition has two forms. The first takes an argument which
      is a period specification from Patrick Ryan's Time::Period Perl 5 module.
      Refer to &quot;perldoc Time::Period&quot; for more information.
    <div style="height: 1.00em;">&#x00A0;</div>
    The second form requires a label followed by a period specification, as
      defined above. The label is a tag consisting of an alphabetic character or
      underscore followed by zero or more alphanumerics or underscores and
      ending with a colon. This form allows multiple periods with the same
      period definition. One use is to have a period definition which has no
      <b>alertafter</b> or <b>alertevery</b> parameters for a particular time
      period, and another for the same time period with a different set of
      alerts that does contain those parameters.
    <div style="height: 1.00em;">&#x00A0;</div>
    Period definitions, in either the first or second form, must be unique
      within each service definition. For example, if you need to define two
      periods both for &quot;wd {Sun-Sat}&quot;, then one or both of the period
      definitions must specify a label such as &quot;period t1: wd
      {Sun-Sat}&quot; and &quot;period t2: wd {Sun-Sat}&quot;.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>alertevery</b><i> timeval [observe_detail |
    strict]</i></dt>
  <dd class="It-tag">The <b>alertevery</b> keyword (within a <b>period</b>
      definition) takes the same type of argument as the <b>interval</b>
      variable, and limits the number of times an alert is sent when the service
      continues to fail. For example, if the interval is &quot;1h&quot;, then
      only the alerts in the period section will only be triggered once every
      hour. If the <b>alertevery</b> keyword is omitted in a period entry, an
      alert will be sent out every time a failure is detected. By default, if
      the summary output of two successive failures changes, then the alertevery
      interval is overridden, and an alert will be sent. If the string
      &quot;observe_detail&quot; is the last argument, then both the summary and
      detail output lines will be considered when comparing the output of
      successive failures. If the string &quot;strict&quot; is the last
      argument, then the output of the monitor or the state change of the
      service will have no effect on when alerts are sent. That is,
      &quot;alertevery 24h strict&quot; will send only one alert every 24 hours,
      no matter what. Please refer to the <b>ALERT DECISION LOGIC</b> section
      for a detailed explanation of how alerts are suppressed.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>alertafter</b><i> num</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>alertafter</b><i> num timeval</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>alertafter</b><i> timeval</i></dt>
  <dd class="It-tag">The <b>alertafter</b> keyword (within a <b>period</b>
      section) has three forms: only with the &quot;num&quot; argument, or with
      the &quot;num timeval&quot; arguments, or only with the
      &quot;timeval&quot; argument. In the first form, an alert will only be
      invoked after &quot;num&quot; consecutive failures.
    <div style="height: 1.00em;">&#x00A0;</div>
    In the second form, the arguments are a positive integer followed by an
      interval, as described by the <b>interval</b> variable above. If these
      parameters are specified, then the alerts for that period will only be
      called after that many failures happen within that interval. For example,
      if <b>alertafter</b> is given the arguments &quot;3&#x00A0;30m&quot;, then
      the alert will be called if 3 failures happen within 30 minutes.
    <div style="height: 1.00em;">&#x00A0;</div>
    In the third form, the argument is an interval, as described by the
      <b>interval</b> variable above. Alerts for that period will only be called
      if the service has been in a failure state for more than the length of
      time desribed by the interval, regardless of the number of failures
      noticed within that interval.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>numalerts</b><i> num</i></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    This variable tells the server to call no more than <i>num</i> alerts during
      a failure. The alert counter is kept on a per-period basis, and is reset
      upon each success.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>no_comp_alerts</b></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    If this option is specified, then upalerts will be called whenever the
      service state changes from failure to success, rather than only after a
      corresponding &quot;down&quot; alert.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>alert</b><i> alert [arg...]</i></dt>
  <dd class="It-tag">A period may contain multiple alerts, which are triggered
      upon failure of the service. An alert is specified with the <b>alert</b>
      keyword, followed by an optional <b>exit</b> parameter, and arguments
      which are interpreted the same as the <b>monitor</b> definition, but
      without the &quot;;;&quot; exception. The <b>exit</b> parameter takes the
      form of <b>exit=x</b> or <b>exit=x-y</b> and has the effect that the alert
      is only called if the exit status of the monitor script falls within the
      range of the <b>exit</b> parameter. If, for example, the alert line is
      <i>alert exit=10-20 mail.alert mis</i> then <i>mail-alert</i> will only be
      invoked with <i>mis</i> as its arguments if the monitor program's exit
      value is between 10 and 20. This feature allows you to trigger different
      alerts at different severity levels (like when free disk space goes from
      8% to 3%).
    <div style="height: 1.00em;">&#x00A0;</div>
    See the <b>ALERT PROGRAMS</b> section above for a list of the pramaeters mon
      will pass automatically to alert programs.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>upalert</b><i> alert [arg...]</i></dt>
  <dd class="It-tag">An <b>upalert</b> is the compliment of an <b>alert</b>. An
      upalert is called when a services makes the state transition from failure
      to success, if a corresponding &quot;down&quot; alert was previously sent.
      The <b>upalert</b> script is called supplying the same parameters as the
      <b>alert</b> script, with the addition of the <b>-u</b> parameter which is
      simply used to let an alert script know that it is being called as an
      upalert. Multiple upalerts may be specified for each period definition.
      Set the per-period <b>no_comp_alerts</b> option to send an upalert
      regardless if whether or not a &quot;down&quot; alert was sent.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>startupalert</b><i> alert [arg...]</i></dt>
  <dd class="It-tag">A <b>startupalert</b> is only called when the <b>mon</b>
      server starts execution, or when a &quot;reset&quot; command was issued to
      the server, depending on the setting of the <b>startupalerts_on_reset</b>
      global. Unlike other alerts, <b>startupalerts</b> are not called following
      the exit of a monitor, i.e. they are called in their own right, therefore
      the &quot;exit=&quot; argument is not applicable to <b>startupalert.</b>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>upalertafter</b><i> timeval</i></dt>
  <dd class="It-tag">The <b>upalertafter</b> parameter is specified as a string
      that follows the syntax of the <b>interval</b> parameter (&quot;30s&quot;,
      &quot;1m&quot;, etc.), and controls the triggering of an <b>upalert</b>.
      If a service comes back up after being down for a time greater than or
      equal to the value of this option, an <b>upalert</b> will be called. Use
      this option to prevent upalerts to be called because of &quot;blips&quot;
      (brief outages).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="AUTHENTICATION_CONFIGURATION_FILE"><a class="selflink" href="#AUTHENTICATION_CONFIGURATION_FILE">AUTHENTICATION
  CONFIGURATION FILE</a></h1>
The file specified by the <b>authfile</b> variable in the configuration file (or
  passed via the <b>-A</b> parameter) will be loaded upon startup. This file
  defines restrictions upon which client commands may be executed by which
  users. It is a text file which consists of comments, command definitions, and
  trap authentication parameters. A comment line begins with optional whitespace
  followed by pound sign. Blank lines are ignored.
<div style="height: 1.00em;">&#x00A0;</div>
The file is separated into a command section and a trap section. Sections are
  specified by a single line containing one of the following statements:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
	command section
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
or
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
	trap section
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Lines following one of the above statements apply to that section until either
  the end of the file or another section begins.
<div style="height: 1.00em;">&#x00A0;</div>
A command definition consists of a command, followed by a colon, followed by a
  comma-separated list of users who may execute the command. The default is that
  no users may execute any commands unless they are explicitly allowed in this
  configuration file. For clarity, a user can be denied by prefixing the user
  name with &quot;!&quot;. If the word &quot;AUTH_ANY&quot; is used for a
  username, then any authenticated user will be allowed to execute the command.
  If the word &quot;all&quot; is used for a username, then that command may be
  executed by any user, authenticated or not.
<div style="height: 1.00em;">&#x00A0;</div>
The trap section allows configuration of which users may send traps from which
  hosts. The syntax is a source host (name or ip address), whitespace, a
  username, whitespace, and a plaintext password for that user. If the source
  host is &quot;*&quot;, then allow traps from any host. If the username is
  &quot;*&quot;, then accept traps without regard for the username or password.
  If no hosts or users are specified, then no traps will be accepted.
<div style="height: 1.00em;">&#x00A0;</div>
An example configuration file:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
command section
list:		all
reset:		root,admin
loadstate:      	root
savestate:      	root
<div class="Pp"></div>
trap section
127.0.0.1	root	r@@tp4sswrd
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
This means that all clients are able to perform the <b>list</b> command,
  &quot;root&quot; is able to perform &quot;reset&quot;, &quot;loadstate&quot;,
  &quot;savestate&quot;, and &quot;admin&quot; is able to execute the
  &quot;reset&quot; command.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="CLIENT-SERVER_INTERFACE"><a class="selflink" href="#CLIENT-SERVER_INTERFACE">CLIENT-SERVER&#x00A0;INTERFACE</a></h1>
The server listens on TCP port 2583, which may be overridden using the
  <b>-p&#x00A0;</b><i>port</i> option. Commands are a single line each,
  terminated by a newline. The server can handle any number of simultaneous
  client connections.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="CLIENT_INTERFACE_COMMANDS"><a class="selflink" href="#CLIENT_INTERFACE_COMMANDS">CLIENT&#x00A0;INTERFACE&#x00A0;COMMANDS</a></h1>
See manual page for <b>moncmd</b>.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="MON_TRAPPING"><a class="selflink" href="#MON_TRAPPING">MON&#x00A0;TRAPPING</a></h1>
Mon has the facility to receive special &quot;mon traps&quot; from any local or
  remote machine. Currently, the only available method for sending mon traps are
  through the Mon::Client perl interface, though the UDP packet format is
  defined well enough to permit the writing of traps in other languages.
<div style="height: 1.00em;">&#x00A0;</div>
Traps are handled similarly to monitors: a trap sends an operational status,
  summary line, and description text, and mon generates an alert or upalert as
  necessary.
<div style="height: 1.00em;">&#x00A0;</div>
Traps can be caught by any watch/service group set up in the mon configuration
  file, however it is suggested that you configure watch/service groups
  specifically for the traps you expect to receive. When defining a special
  watch/service group for traps, do not include a &quot;monitor&quot; directive
  (as no monitor need be invoked). Since a monitor is not being invoked, it is
  not necessary for the watch definition to have a hostgroup which contains real
  host names. Just make up a useful name, and mon will automatically create the
  watch group for you.
<div style="height: 1.00em;">&#x00A0;</div>
Here is a simple config file example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
watch trap-service
	service host1-disks
		description TRAP: for host1 disk status
		period wd {Sun-Sat}
			alert mail.alert someone@your.org
			upalert mail.alert -u someone@your.org
<div class="Pp"></div>
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Since mon listens on a UDP port for any trap, a default facility is available
  for handling traps to unknown groups or services. To enable this facility, you
  must include a &quot;default&quot; watch group with a &quot;default&quot;
  service entry containing the specifics of alarms. If a default/default watch
  group and service are not configured, then unknown traps get logged via
  syslog, and no alarm is sent. <b>NOTE:</b> The default/default facility is a
  single entity as far as accounting and alarming go. Alarm programs which are
  not aware of this fact may send confusing information when a failure trap
  comes from one machine, followed by a success (ok) trap from a different
  machine. See the alarm environment variable <b>MON_TRAP_INTENDED</b> above for
  a possible way around this. It is intended that default/default be used as a
  facility to catch unknown traps, and should not be relied upon to catch all
  traps in a production environment. If you are lazy and only want to use
  default/default for catching all traps, it would be best to disable upalerts,
  and use the MON_TRAP_INTENDED environment variable in alert scripts to make
  the alerts more meaningful to you.
<div style="height: 1.00em;">&#x00A0;</div>
Here is an example default facility:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 5.00ex;">
<pre>
watch default
	service default
		description Default trap service
		period wd {Sun-Sat}
			alert mail.alert someone@your.org
			upalert mail.alert -u someone@your.org
<div class="Pp"></div>
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
The <b>mon</b> distribution comes with an example configuration called
  <i>example.cf</i>. Refer to that file for more information.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>moncmd</b>(1), <b>Time::Period</b>(3pm), <b>Mon::Client</b>(3pm)
<h1 class="Sh" title="Sh" id="HISTORY"><a class="selflink" href="#HISTORY">HISTORY</a></h1>
<b>mon</b> was written because I couldn't find anything out there that did just
  what I needed, and nothing was worth modifying to add the features I wanted.
  It doesn't have a cool name, and that bothers me because I couldn't think of
  one.
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Report bugs to the email address below.
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Jim Trocki &lt;trockij@arctic.org&gt;</div>
<table class="foot">
  <tr>
    <td class="foot-date">$Date: 2007/06/25 13:10:07 $</td>
    <td class="foot-os">Linux</td>
  </tr>
</table>
</body>
</html>
