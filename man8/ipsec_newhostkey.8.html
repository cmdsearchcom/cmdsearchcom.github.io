<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>IPSEC_RANBITS(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">IPSEC_RANBITS(8)</td>
    <td class="head-vol">Executable programs</td>
    <td class="head-rtitle">IPSEC_RANBITS(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
ipsec_newhostkey - generate a new raw RSA authentication key for a host
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div class="Pp" style="margin-left: 6.00ex; text-indent: -6.00ex;"><b>ipsec</b>
  <i>newhostkey</i> [[--configdir<i>nssdbdir</i>] |
  [--password&#x00A0;<i>password</i>]] [[--quiet] | [--verbose]] [--bits&#x00A0;
  <i>bits</i>] [--seeddev&#x00A0;<i>device</i>]
  [--hostname&#x00A0;<i>hostname</i>] [--output&#x00A0; <i>filename</i>]</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<i>newhostkey</i> outputs (into <i>filename</i>, which can be '-' for standard
  output) an RSA private key suitable for this host, in
  <i>/etc/ipsec.secrets</i> format (see <b>ipsec.secrets</b>(5)) using the
  <b>--quiet</b> option per default.
<div class="Pp"></div>
The <b>--output</b> option is mandatory. The specified <i>filename</i> is
  created under umask <b>077</b> if nonexistent; if it already exists and is
  non-empty, a warning message about that is sent to standard error, and the
  output is appended to the file.
<div class="Pp"></div>
The <b>--quiet</b> option suppresses both the <i>rsasigkey</i> narrative and the
  existing-file warning message.
<div class="Pp"></div>
When compiled with NSS support (the default), <b>--configdir</b> specifies the
  nss configuration directory where the certificate key, and modsec databases
  reside. There is no default value, though /etc/ipsec.d might be sensible
  choice.
<div class="Pp"></div>
When compiled with NSS support (the default), <b>--password</b> specifies a
  module authentication password that may be required if FIPS mode is enabled
<div class="Pp"></div>
The <b>--bits</b> option specifies the number of bits in the RSA key; the
  current default is a random (multiple of 16) value between 3072 and 4096. The
  minimum allowed is 2192.
<div class="Pp"></div>
The <b>--seeddev</b> is used to specify the random device (default /dev/random
  used to seed the crypto library RNG.
<div class="Pp"></div>
The <b>--hostname</b> option is passed through to <i>rsasigkey</i> to tell it
  what host name to label the output with (via its <b>--hostname</b> option).
<div class="Pp"></div>
The output format is that of <i>rsasigkey</i>, with bracketing added to complete
  the <i>ipsec.secrets</i> format. In the usual case, where <i>ipsec.secrets</i>
  contains only the host&#x00E2;&#xFFFD;&#xFFFD;s own private key, the output of
  <i>newhostkey</i> is sufficient as a complete <i>ipsec.secrets</i> file.
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
/dev/random, /dev/urandom
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>ipsec_rsasigkey</b>(8), <b>ipsec.secrets</b>(5)
<h1 class="Sh" title="Sh" id="HISTORY"><a class="selflink" href="#HISTORY">HISTORY</a></h1>
Originally written for the Linux FreeS/WAN project &lt;
  <b>http://www.freeswan.org</b>&gt; by Henry Spencer. Updated by Paul Wouters
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
As with <i>rsasigkey</i>, the run time is difficult to predict, since depletion
  of the system&#x00E2;&#xFFFD;&#xFFFD;s randomness pool can cause arbitrarily
  long waits for random bits for seeding the NSS library, and the prime-number
  searches can also take unpredictable (and potentially large) amounts of CPU
  time. See <b>ipsec_rsasigkey</b>(8) .
<div class="Pp"></div>
A higher-level tool which could handle the clerical details of changing to a new
  key would be helpful.
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
<b>Paul Wouters</b>
<div style="margin-left: 4.00ex;">placeholder to suppress warning</div>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">11/12/2016</td>
    <td class="foot-os">libreswan</td>
  </tr>
</table>
</body>
</html>
