<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>AMSSL(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">AMSSL(8)</td>
    <td class="head-vol">System Administration Commands</td>
    <td class="head-rtitle">AMSSL(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
amssl - Program to manage amanda ssl certificates
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div class="Pp" style="margin-left: 6.00ex; text-indent: -6.00ex;"><b>amssl</b>
  [--client] [--init | --create-ca | --create-server-cert&#x00A0;
  <i>server-host</i> | --create-client-cert&#x00A0;
  <i>client-host</i>&#x00A0;[--server&#x00A0; <i>server-host</i>] ]
  [--country&#x00A0; <i>country-code</i>] [--state&#x00A0;<i>state</i>]
  [--locality&#x00A0; <i>locality</i>]
  [--organisation&#x00A0;<i>organisation</i>] [--organisation-unit&#x00A0;
  <i>organisation-unit</i>] [--common&#x00A0; <i>common-name</i>]
  [--email&#x00A0; <i>email</i>] [<b>-o</b>&#x00A0;<i>configoption</i>...]
  [--config&#x00A0; <i>config</i>]</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>amssl</b> is a program to manage amanda ssl certificates for the <b>ssl</b>
  auth. It can create self-signed CA, server certificate and client
  certificates.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<b>--create-ca</b>
<div style="margin-left: 4.00ex;">Create a self-signed CA.</div>
<div class="Pp"></div>
<b>--create-server-cert</b>
<div style="margin-left: 4.00ex;">Create a server certificate.</div>
<div class="Pp"></div>
<b>--create-client-cert</b> <i>CLIENT-HOSTNAME</i>
<div style="margin-left: 4.00ex;">Create a client certificate.</div>
<div class="Pp"></div>
<b>--server</b> <i>SERVER-HOSTNAME</i>
<div style="margin-left: 4.00ex;">The amanda server to connect to.</div>
<div class="Pp"></div>
<b>--batch</b>
<div style="margin-left: 4.00ex;">use the certificate fields set in the
  initialization, there is confirmation.
<div style="height: 1.00em;">&#x00A0;</div>
This option is useless if one the fields was not set in the
  initiatization.</div>
<div class="Pp"></div>
<b>--client</b>
<div style="margin-left: 4.00ex;">When running <b>amssl</b> on a client.</div>
<div class="Pp"></div>
<b>--init</b>
<div style="margin-left: 4.00ex;">Initialize the host.</div>
<div class="Pp"></div>
The following options are the one needed by a certificate
<div class="Pp"></div>
<b>--country</b>
<div style="margin-left: 4.00ex;">The two letter country code.</div>
<div class="Pp"></div>
<b>--state</b>
<div style="margin-left: 4.00ex;">The State.</div>
<div class="Pp"></div>
<b>--locality</b>
<div style="margin-left: 4.00ex;">The locality.</div>
<div class="Pp"></div>
<b>--organisation</b>
<div style="margin-left: 4.00ex;">The organisation</div>
<div class="Pp"></div>
<b>--organisation-unit</b>
<div style="margin-left: 4.00ex;">The organisation unit.</div>
<div class="Pp"></div>
<b>--common</b>
<div style="margin-left: 4.00ex;">The common name.</div>
<div class="Pp"></div>
<b>--email</b>
<div style="margin-left: 4.00ex;">The email.</div>
<h1 class="Sh" title="Sh" id="INITIALISATION"><a class="selflink" href="#INITIALISATION">INITIALISATION</a></h1>
Must be run once before any other command
<div class="Pp"></div>
Create a template openssl.cnf file and a configuration file with the value
  provided, they are used in future command so you do not need to enter them at
  every invocation.
<div class="Pp"></div>
The value provided must be the one you want in the certificate.
<div class="Pp"></div>
<div class="Pp" style="margin-left: 6.00ex; text-indent: -6.00ex;"><b>amssl</b>
  [--client] --init [--country&#x00A0; <i>country-code</i>]
  [--state&#x00A0;<i>state</i>] [--locality&#x00A0; <i>locality</i>]
  [--organisation&#x00A0; <i>organisation</i>]
  [--organisation-unit&#x00A0;<i>organisation-unit</i>] [--common&#x00A0;
  <i>common-name</i>] [--email&#x00A0; <i>email</i>]
  [<b>-o</b>&#x00A0;<i>configoption</i>...] [--config&#x00A0;
  <i>config</i>]</div>
<div class="Pp"></div>
A client is initialized with the --client options.
<div class="Pp"></div>
Create
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
      <b>$SSL_DIR/openssl.cnf.template</b>
      <b>$SSL_DIR/openssl.data</b>
</pre>
<h1 class="Sh" title="Sh" id="CREATE_A_SELF-SIGNED_CA"><a class="selflink" href="#CREATE_A_SELF-SIGNED_CA">CREATE
  A SELF-SIGNED CA</a></h1>
Create a self-signed CA.
<div class="Pp"></div>
<div class="Pp" style="margin-left: 6.00ex; text-indent: -6.00ex;"><b>amssl</b>
  --create-ca [--batch] [--config&#x00A0; <i>CONFIG</i>]</div>
<div class="Pp"></div>
You can also provide all options of the initialization step
<div class="Pp"></div>
You must enter a new CA passphrase, you must keep it secret and remember it. It
  will be required every time you need to create a new cetificate.
<div class="Pp"></div>
After you enter the passphrase, it will be asked 3 other times.
<div class="Pp"></div>
Create
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
     $SSL_DIR/CA/crt.pem
     $SSL_DIR/CA/private/key.pem
</pre>
<h1 class="Sh" title="Sh" id="CREATE_THE_SERVER_CERTIFICATE"><a class="selflink" href="#CREATE_THE_SERVER_CERTIFICATE">CREATE
  THE SERVER CERTIFICATE</a></h1>
Create the amanda server certificate.
<div class="Pp"></div>
<div class="Pp" style="margin-left: 6.00ex; text-indent: -6.00ex;"><b>amssl</b>
  --create-server-cert&#x00A0; <i>HOSTNAME</i> [--batch]
  [--config&#x00A0;<i>CONFIG</i>]</div>
<div class="Pp"></div>
You can also provide all options of the initialization step
<div class="Pp"></div>
The CA passphrase is asked.
<div class="Pp"></div>
Create
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
     $SSL_DIR/me/crt.pem
     $SSL_DIR/me/fingerprint
     $SSL_DIR/me/private/key.pem
     $SSL_DIR/remote/ <i>HOSTNAME</i> -&gt; ../me
</pre>
<h1 class="Sh" title="Sh" id="CREATE_A_CLIENT_CERTIFICATE"><a class="selflink" href="#CREATE_A_CLIENT_CERTIFICATE">CREATE
  A CLIENT CERTIFICATE</a></h1>
Create a client certificate, sign it by the CA certicate on the server and both
  server and client learn the remore fingerprint.
<div class="Pp"></div>
DO NOT RUN IT ON SERVER. This will detroy the server certificate
<div class="Pp"></div>
It require to run amssl on the server and client at the same time
<div class="Pp"></div>
<b>ssl-dir</b> must be set in amanda-client.conf on the client.
<div class="Pp"></div>
Both server and client must already be initialized.
<div class="Pp"></div>
Run on the server:
<div class="Pp"></div>
<div class="Pp" style="margin-left: 6.00ex; text-indent: -6.00ex;"><b>amssl</b>
  --create-client-cert&#x00A0; <i>client-host</i>
  [--config&#x00A0;<i>CONFIG</i>]</div>
<div class="Pp"></div>
It wait for the client to connect and then sign the client certificate, The CA
  passphrase is asked.
<div class="Pp"></div>
Run on the client:
<div class="Pp"></div>
<div class="Pp" style="margin-left: 6.00ex; text-indent: -6.00ex;"><b>amssl</b>
  --client --create-client-cert&#x00A0; <i>CLIENT-HOST</i>
  --server&#x00A0;<i>SERVER-HOST</i> [--batch] [--config&#x00A0;
  <i>CONFIG</i>]</div>
<div class="Pp"></div>
Create on server
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
     $SSL_DIR/remote/ <i>CLIENT-HOST</i>/fingerprint
</pre>
<div class="Pp"></div>
Create on client
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
     $SSL_DIR/me/crt.pem
     $SSL_DIR/me/fingerprint
     $SSL_DIR/me/private/key.pem
     $SSL_DIR/remote/ <i>SERVER-HOST</i>/fingerprint
</pre>
<h1 class="Sh" title="Sh" id="EXAMPLE"><a class="selflink" href="#EXAMPLE">EXAMPLE</a></h1>
<b>Initialize the server</b>
<div style="margin-left: 4.00ex;">amssl --init --country US --state California
  --locality Sunnyvale --organisation zmanda --organistion-unit engineering
  --common boss --email 'email@email.com'</div>
<div class="Pp"></div>
<b>Create the CA on the server</b>
<div style="margin-left: 4.00ex;">amssl --create-ca</div>
<div class="Pp"></div>
<b>Create the server certificate</b>
<div style="margin-left: 4.00ex;">amssl --create-server-cert
  server.zmanda.com</div>
<div class="Pp"></div>
<b>Create a client certificate</b>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<b>On server:</b>
<div style="margin-left: 4.00ex;">amssl --create-client-cert
  client.zmanda.com</div>
<div class="Pp"></div>
<b>On client:</b>
<div style="margin-left: 4.00ex;">amssl --client --init --country US --state
  California --locality Sunnyvale --organisation zmanda --organistion-unit
  engineering --common boss --email 'email@email.com'
<div style="height: 1.00em;">&#x00A0;</div>
amssl --client --create-client-cert client.zmanda.com --server
  server.zmanda.com</div>
</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>amanda</b>(8), <b>amanda.conf</b>(5), <b>amanda-client.conf</b>(5),
  <b>amanda</b>(8), <b>amanda-auth</b>(7), <b>amanda-auth-ssl</b>(7)
<div class="Pp"></div>
The Amanda Wiki: : http://wiki.zmanda.com/
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
<b>James da Silva</b> &lt;jds@amanda.org&gt;
<div class="Pp"></div>
<b>Stefan G. Weichinger</b> &lt;sgw@amanda.org&gt;</div>
<table class="foot">
  <tr>
    <td class="foot-date">06/08/2017</td>
    <td class="foot-os">Amanda 3.4.5</td>
  </tr>
</table>
</body>
</html>
