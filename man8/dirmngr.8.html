<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:10:18 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>DIRMNGR(8) GNU Privacy Guard 2.1 DIRMNGR(8)</p>

<p style="margin-top: 1em">NAME <br>
dirmngr - CRL and OCSP daemon</p>

<p style="margin-top: 1em">SYNOPSIS <br>
dirmngr [options] command [args]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Since version 2.1 of GnuPG, dirmngr takes care of accessing
the OpenPGP keyservers. As with previous versions it is also
used as a server for managing and downloading certifi&acirc;
<br>
cate revocation lists (CRLs) for X.509 certificates,
downloading X.509 certificates, and providing access to OCSP
providers. Dirmngr is invoked internally by gpg, gpgsm, or
via <br>
the gpg-connect-agent tool.</p>

<p style="margin-top: 1em">COMMANDS <br>
Commands are not distinguished from options except for the
fact that only one command is allowed.</p>

<p style="margin-top: 1em">--version <br>
Print the program version and licensing information. Note
that you cannot abbreviate this command.</p>

<p style="margin-top: 1em">--help, -h <br>
Print a usage message summarizing the most useful
command-line options. Not that you cannot abbreviate this
command.</p>

<p style="margin-top: 1em">--dump-options <br>
Print a list of all available options and commands. Note
that you cannot abbreviate this command.</p>

<p style="margin-top: 1em">--server <br>
Run in server mode and wait for commands on the stdin. The
default mode is to create a socket and listen for commands
there. This is only used for testing.</p>

<p style="margin-top: 1em">--daemon <br>
Run in background daemon mode and listen for commands on a
socket. Note that this also changes the default home
directory and enables the internal certificate validation
<br>
code. This mode is deprecated.</p>

<p style="margin-top: 1em">--list-crls <br>
List the contents of the CRL cache on stdout. This is
probably only useful for debugging purposes.</p>

<p style="margin-top: 1em">--load-crl file <br>
This command requires a filename as additional argument, and
it will make Dirmngr try to import the CRL in file into
it&rsquo;s cache. Note, that this is only possible if
Dirm&acirc; <br>
ngr is able to retrieve the CA&rsquo;s certificate directly
by its own means. In general it is better to use
gpgsm&rsquo;s --call-dirmngr loadcrl filename command so
that gpgsm can <br>
help dirmngr.</p>

<p style="margin-top: 1em">--fetch-crl url <br>
This command requires an URL as additional argument, and it
will make dirmngr try to retrieve an import the CRL from
that url into it&rsquo;s cache. This is mainly useful for
<br>
debugging purposes. The dirmngr-client provides the same
feature for a running dirmngr.</p>

<p style="margin-top: 1em">--shutdown <br>
This commands shuts down an running instance of Dirmngr.
This command has currently no effect.</p>

<p style="margin-top: 1em">--flush <br>
This command removes all CRLs from Dirmngr&rsquo;s cache.
Client requests will thus trigger reading of fresh CRLs.</p>

<p style="margin-top: 1em">OPTIONS <br>
--options file <br>
Reads configuration from file instead of from the default
per-user configuration file. The default configuration file
is named &acirc;dirmngr.conf&acirc; and expected in the home
<br>
directory.</p>

<p style="margin-top: 1em">--homedir dir <br>
Set the name of the home directory to dir. This option is
only effective when used on the command line. The default
depends on the running mode:</p>

<p style="margin-top: 1em">With --daemon given on the
commandline <br>
the directory named &acirc;/etc/gnupg&acirc; is used for
configuration files and &acirc;/var/cache/gnupg&acirc; for
cached CRLs.</p>

<p style="margin-top: 1em">Without --daemon given on the
commandline <br>
the directory named &acirc;.gnupg&acirc; directly below the
home directory of the user unless the environment variable
GNUPGHOME has been set in which case its value will be <br>
used. All kind of data is stored below this directory.</p>

<p style="margin-top: 1em">-v</p>

<p style="margin-top: 1em">--verbose <br>
Outputs additional information while running. You can
increase the verbosity by giving several verbose commands to
dirmngr, such as -vv.</p>

<p style="margin-top: 1em">--log-file file <br>
Append all logging output to file. This is very helpful in
seeing what the agent actually does.</p>

<p style="margin-top: 1em">--debug-level level <br>
Select the debug level for investigating problems. level may
be a numeric value or by a keyword:</p>

<p style="margin-top: 1em">none No debugging at all. A
value of less than 1 may be used instead of the keyword.</p>

<p style="margin-top: 1em">basic Some basic debug messages.
A value between 1 and 2 may be used instead of the
keyword.</p>

<p style="margin-top: 1em">advanced <br>
More verbose debug messages. A value between 3 and 5 may be
used instead of the keyword.</p>

<p style="margin-top: 1em">expert Even more detailed
messages. A value between 6 and 8 may be used instead of the
keyword.</p>

<p style="margin-top: 1em">guru All of the debug messages
you can get. A value greater than 8 may be used instead of
the keyword. The creation of hash tracing files is only
enabled if the keyword <br>
is used.</p>

<p style="margin-top: 1em">How these messages are mapped to
the actual debugging flags is not specified and may change
with newer releases of this program. They are however
carefully selected to best aid <br>
in debugging.</p>

<p style="margin-top: 1em">--debug flags <br>
This option is only useful for debugging and the behaviour
may change at any time without notice. FLAGS are bit encoded
and may be given in usual C-Syntax.</p>

<p style="margin-top: 1em">--debug-all <br>
Same as --debug=0xffffffff</p>

<p style="margin-top: 1em">--gnutls-debug level <br>
Enable debugging of GNUTLS at level.</p>

<p style="margin-top: 1em">--debug-wait n <br>
When running in server mode, wait n seconds before entering
the actual processing loop and print the pid. This gives
time to attach a debugger.</p>

<p style="margin-top: 1em">-s <br>
--sh <br>
-c <br>
--csh Format the info output in daemon mode for use with the
standard Bourne shell respective the C-shell . The default
ist to guess it based on the environment variable SHELL <br>
which is in almost all cases sufficient.</p>

<p style="margin-top: 1em">--force <br>
Enabling this option forces loading of expired CRLs; this is
only useful for debugging.</p>

<p style="margin-top: 1em">--use-tor <br>
This option switches Dirmngr and thus GnuPG into
&lsquo;&lsquo;Tor mode&rsquo;&rsquo; to route all network
access via Tor (an anonymity network). WARNING: As of now
this still leaks the DNS <br>
queries; e.g. to lookup the hosts in a keyserver pool.
Certain other features are disabled if this mode is
active.</p>

<p style="margin-top: 1em">--keyserver name <br>
Use name as your keyserver. This is the server that gpg
communicates with to receive keys, send keys, and search for
keys. The format of the name is a URI: <br>
&lsquo;scheme:[//]keyservername[:port]&rsquo; The scheme is
the type of keyserver: &quot;hkp&quot; for the HTTP (or
compatible) keyservers, &quot;ldap&quot; for the LDAP
keyservers, or &quot;mailto&quot; for the <br>
Graff email keyserver. Note that your particular
installation of GnuPG may have other keyserver types
available as well. Keyserver schemes are case-insensitive.
After the <br>
keyserver name, optional keyserver configuration options may
be provided. These are the same as the --keyserver-options
of gpg, but apply only to this particular key&acirc; <br>
server.</p>

<p style="margin-top: 1em">Most keyservers synchronize with
each other, so there is generally no need to send keys to
more than one server. The keyserver hkp://keys.gnupg.net
uses round robin DNS to <br>
give a different keyserver each time you use it.</p>

<p style="margin-top: 1em">If exactly two keyservers are
configured and only one is a Tor hidden service (.onion),
Dirmngr selects the keyserver to use depending on whether
Tor is locally running or <br>
not. The check for a running Tor is done for each new
connection.</p>

<p style="margin-top: 1em">--nameserver ipaddr <br>
In &lsquo;&lsquo;Tor mode&rsquo;&rsquo; Dirmngr uses a
public resolver via Tor to resolve DNS names. If the default
public resolver, which is 8.8.8.8, shall not be used a
different one can be <br>
given using this option. Note that a numerical IP address
must be given (IPv6 or IPv4) and that no error checking is
done for ipaddr. DNS queries in Tor mode do only <br>
work if GnuPG as been build with ADNS support.</p>

<p style="margin-top: 1em">--disable-ldap <br>
Entirely disables the use of LDAP.</p>

<p style="margin-top: 1em">--disable-http <br>
Entirely disables the use of HTTP.</p>

<p style="margin-top: 1em">--ignore-http-dp <br>
When looking for the location of a CRL, the to be tested
certificate usually contains so called CRL Distribution
Point (DP) entries which are URLs describing the way to <br>
access the CRL. The first found DP entry is used. With this
option all entries using the HTTP scheme are ignored when
looking for a suitable DP.</p>

<p style="margin-top: 1em">--ignore-ldap-dp <br>
This is similar to --ignore-http-dp but ignores entries
using the LDAP scheme. Both options may be combined
resulting in ignoring DPs entirely.</p>

<p style="margin-top: 1em">--ignore-ocsp-service-url <br>
Ignore all OCSP URLs contained in the certificate. The
effect is to force the use of the default responder.</p>

<p style="margin-top: 1em">--honor-http-proxy <br>
If the environment variable &acirc;http_proxy&acirc; has
been set, use its value to access HTTP servers.</p>

<p style="margin-top: 1em">--http-proxy host[:port] <br>
Use host and port to access HTTP servers. The use of this
option overrides the environment variable
&acirc;http_proxy&acirc; regardless whether
--honor-http-proxy has been set.</p>

<p style="margin-top: 1em">--ldap-proxy host[:port] <br>
Use host and port to connect to LDAP servers. If port is
omitted, port 389 (standard LDAP port) is used. This
overrides any specified host and port part in a LDAP URL
<br>
and will also be used if host and port have been omitted
from the URL.</p>

<p style="margin-top: 1em">--only-ldap-proxy <br>
Never use anything else but the LDAP &quot;proxy&quot; as
configured with --ldap-proxy. Usually dirmngr tries to use
other configured LDAP server if the connection using the
<br>
&quot;proxy&quot; failed.</p>

<p style="margin-top: 1em">--ldapserverlist-file file <br>
Read the list of LDAP servers to consult for CRLs and
certificates from file instead of the default per-user ldap
server list file. The default value for file is
&acirc;dirm&acirc; <br>
ngr_ldapservers.conf&acirc; or
&acirc;ldapservers.conf&acirc; when running in --daemon
mode.</p>

<p style="margin-top: 1em">This server list file contains
one LDAP server per line in the format</p>


<p style="margin-top: 1em">hostname:port:username:password:base_dn</p>

<p style="margin-top: 1em">Lines starting with a
&rsquo;#&rsquo; are comments.</p>

<p style="margin-top: 1em">Note that as usual all strings
entered are expected to be UTF-8 encoded. Obviously this
will lead to problems if the password has originally been
encoded as Latin-1. <br>
There is no other solution here than to put such a password
in the binary encoding into the file (i.e. non-ascii
characters won&rsquo;t show up readable). ([The gpgconf tool
<br>
might be helpful for frontends as it enables editing this
configuration file using percent-escaped strings.])</p>

<p style="margin-top: 1em">--ldaptimeout secs <br>
Specify the number of seconds to wait for an LDAP query
before timing out. The default is currently 100 seconds. 0
will never timeout.</p>

<p style="margin-top: 1em">--add-servers <br>
This options makes dirmngr add any servers it discovers when
validating certificates against CRLs to the internal list of
servers to consult for certificates and CRLs.</p>

<p style="margin-top: 1em">This options is useful when
trying to validate a certificate that has a CRL distribution
point that points to a server that is not already listed in
the ldapserverlist. <br>
Dirmngr will always go to this server and try to download
the CRL, but chances are high that the certificate used to
sign the CRL is located on the same server. So if <br>
dirmngr doesn&rsquo;t add that new server to list, it will
often not be able to verify the signature of the CRL unless
the --add-servers option is used.</p>

<p style="margin-top: 1em">Note: The current version of
dirmngr has this option disabled by default.</p>

<p style="margin-top: 1em">--allow-ocsp <br>
This option enables OCSP support if requested by the
client.</p>

<p style="margin-top: 1em">OCSP requests are rejected by
default because they may violate the privacy of the user;
for example it is possible to track the time when a user is
reading a mail.</p>

<p style="margin-top: 1em">--ocsp-responder url <br>
Use url as the default OCSP Responder if the certificate
does not contain information about an assigned responder.
Note, that --ocsp-signer must also be set to a valid <br>
certificate.</p>

<p style="margin-top: 1em">--ocsp-signer fpr|file <br>
Use the certificate with the fingerprint fpr to check the
responses of the default OCSP Responder. Alternatively a
filename can be given in which case the respinse is <br>
expected to be signed by one of the certificates described
in that file. Any argument which contains a slash, dot or
tilde is considered a filename. Usual filename <br>
expansion takes place: A tilde at the start followed by a
slash is replaced by the content of &acirc;HOME&acirc;, no
slash at start describes a relative filename which will be
<br>
searched at the home directory. To make sure that the file
is searched in the home directory, either prepend the name
with &quot;./&quot; or use a name which contains a dot.</p>

<p style="margin-top: 1em">If a response has been signed by
a certificate described by these fingerprints no further
check upon the validity of this certificate is done.</p>

<p style="margin-top: 1em">The format of the FILE is a list
of SHA-1 fingerprint, one per line with optional colons
between the bytes. Empty lines and lines prefix with a hash
mark are ignored.</p>

<p style="margin-top: 1em">--ocsp-max-clock-skew n <br>
The number of seconds a skew between the OCSP responder and
them local clock is accepted. Default is 600 (20
minutes).</p>

<p style="margin-top: 1em">--ocsp-max-period n <br>
Seconds a response is at maximum considered valid after the
time given in the thisUpdate field. Default is 7776000 (90
days).</p>

<p style="margin-top: 1em">--ocsp-current-period n <br>
The number of seconds an OCSP response is considered valid
after the time given in the NEXT_UPDATE datum. Default is
10800 (3 hours).</p>

<p style="margin-top: 1em">--max-replies n <br>
Do not return more that n items in one query. The default is
10.</p>

<p style="margin-top: 1em">--ignore-cert-extension oid <br>
Add oid to the list of ignored certificate extensions. The
oid is expected to be in dotted decimal form, like 2.5.29.3.
This option may be used more than once. Critical <br>
flagged certificate extensions matching one of the OIDs in
the list are treated as if they are actually handled and
thus the certificate won&rsquo;t be rejected due to an <br>
unknown critical extension. Use this option with care
because extensions are usually flagged as critical for a
reason.</p>

<p style="margin-top: 1em">--hkp-cacert file <br>
Use the root certificates in file for verification of the
TLS certificates used with hkps (keyserver access over TLS).
If the file is in PEM format a suffix of .pem is <br>
expected for file. This option may be given multiple times
to add more root certificates. Tilde expansion is
supported.</p>

<p style="margin-top: 1em">EXAMPLES <br>
Here is an example on how to show dirmngr&rsquo;s internal
table of OpenPGP keyserver addresses. The output is intended
for debugging purposes and not part of a defined API.</p>

<p style="margin-top: 1em">gpg-connect-agent --dirmngr
&rsquo;keyserver --hosttable&rsquo; /bye</p>

<p style="margin-top: 1em">To inhibit the use of a
particular host you have noticed in one of the keyserver
pools, you may use</p>

<p style="margin-top: 1em">gpg-connect-agent --dirmngr
&rsquo;keyserver --dead pgpkeys.bnd.de&rsquo; /bye</p>

<p style="margin-top: 1em">The description of the keyserver
command can be printed using</p>

<p style="margin-top: 1em">gpg-connect-agent --dirmngr
&rsquo;help keyserver&rsquo; /bye</p>

<p style="margin-top: 1em">FILES <br>
Dirmngr makes use of several directories when running in
daemon mode:</p>

<p style="margin-top: 1em">~/.gnupg <br>
This is the standard home directory for all configuration
files.</p>

<p style="margin-top: 1em">/etc/gnupg/trusted-certs <br>
This directory should be filled with certificates of Root
CAs you are trusting in checking the CRLs and signing OCSP
Responses.</p>

<p style="margin-top: 1em">Usually these are the same
certificates you use with the applications making use of
dirmngr. It is expected that each of these certificate files
contain exactly one DER <br>
encoded certificate in a file with the suffix
&acirc;.crt&acirc; or &acirc;.der&acirc;. dirmngr reads
those certificates on startup and when given a SIGHUP.
Certificates which are not readable <br>
or do not make up a proper X.509 certificate are ignored;
see the log file for details.</p>

<p style="margin-top: 1em">Applications using dirmngr (e.g.
gpgsm) can request these certificates to complete a trust
chain in the same way as with the extra-certs directory (see
below).</p>

<p style="margin-top: 1em">Note that for OCSP responses the
certificate specified using the option --ocsp-signer is
always considered valid to sign OCSP requests.</p>

<p style="margin-top: 1em">/etc/gnupg/extra-certs <br>
This directory may contain extra certificates which are
preloaded into the interal cache on startup. Applications
using dirmngr (e.g. gpgsm) can request cached certifi&acirc;
<br>
cates to complete a trust chain. This is convenient in cases
you have a couple intermediate CA certificates or
certificates ususally used to sign OCSP responses. These
<br>
certificates are first tried before going out to the net to
look for them. These certificates must also be DER encoded
and suffixed with &acirc;.crt&acirc; or
&acirc;.der&acirc;.</p>

<p style="margin-top: 1em">~/.gnupg/crls.d <br>
This directory is used to store cached CRLs. The
&acirc;crls.d&acirc; part will be created by dirmngr if it
does not exists but you need to make sure that the upper
directory exists.</p>

<p style="margin-top: 1em">SIGNALS <br>
A running dirmngr may be controlled by signals, i.e. using
the kill command to send a signal to the process.</p>

<p style="margin-top: 1em">Here is a list of supported
signals:</p>

<p style="margin-top: 1em">SIGHUP This signals flushes all
internally cached CRLs as well as any cached certificates.
Then the certificate cache is reinitialized as on startup.
Options are re-read from <br>
the configuration file. Instead of sending this signal it is
better to use <br>
gpgconf --reload dirmngr</p>

<p style="margin-top: 1em">SIGTERM <br>
Shuts down the process but waits until all current requests
are fulfilled. If the process has received 3 of these
signals and requests are still pending, a shutdown is <br>
forced. You may also use <br>
gpgconf --kill dirmngr <br>
instead of this signal</p>

<p style="margin-top: 1em">SIGINT Shuts down the process
immediately.</p>

<p style="margin-top: 1em">SIGUSR1 <br>
This prints some caching statistics to the log file.</p>

<p style="margin-top: 1em">SEE ALSO <br>
gpgsm(1), dirmngr-client(1)</p>

<p style="margin-top: 1em">The full documentation for this
tool is maintained as a Texinfo manual. If GnuPG and the
info program are properly installed at your site, the
command</p>

<p style="margin-top: 1em">info gnupg</p>

<p style="margin-top: 1em">should give you access to the
complete manual including a menu structure and an index.</p>

<p style="margin-top: 1em">GnuPG 2.1.15 2016-08-18
DIRMNGR(8)</p>
<hr>
</body>
</html>
