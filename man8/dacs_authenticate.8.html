<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>DACS_AUTHENTICATE(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DACS_AUTHENTICATE(8)</td>
    <td class="head-vol">DACS Web Services Manual</td>
    <td class="head-rtitle">DACS_AUTHENTICATE(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
dacs_authenticate - <b>DACS</b> authentication service
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div class="Pp" style="margin-left: 18.00ex; text-indent: -18.00ex;"><b>dacs_authenticate</b>
  [ <i></i><b>dacsoptions</b>[1]]</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This web service is part of the <b>DACS</b> suite.
<div class="Pp"></div>
The <b>dacs_authenticate</b> web service is an authentication &quot;driver&quot;
  for <b>DACS</b>. When it receives a request to authenticate a user, it usually
  invokes one or more authentication modules, depending on its configuration.
  Successful authentication assigns a <b>DACS</b> user identity to the user and
  roles modules may be invoked to determine the roles with which the identity is
  associated; <b>DACS</b> credentials are generated and returned to the user.
  The caller of <b>dacs_authenticate</b> can be redirected to a configured URL,
  called the post-authentication handler (or just the handler), depending on
  whether authentication fails or succeeds.
<div class="Pp"></div>
General <b>DACS</b> configuration directives are discussed in
  <b>dacs.conf(5)</b>[2]. Configuration directives specific to authentication
  are described here.
<div class="Pp"></div>
<b>DACS</b> expressions are described in <b>dacs.exprs(5)</b>[3].
<div class="Pp"></div>
<b>dacs_authenticate</b> might be called from an HTML form (see the
  distribution's <b>html/examples</b>[4] directory for examples of simple login
  pages), directly through a link on a web page, indirectly by <b>DACS</b>
  <b>HTTP Authentication</b>[5], or from middleware.
<div class="Pp"></div>
Command line authentication functionality is provided by <b>dacsauth(1)</b>[6].
  Other authentication mechanisms are provided by <b>dacs_auth_agent(8)</b>[7],
  <b>dacs_auth_transfer(8)</b>[8], and <b>dacscookie(1)</b>[9].
<h2 class="Ss" title="Ss" id="Authentication"><a class="selflink" href="#Authentication">Authentication</a></h2>
Authentication is the procedure by which a claimed identity is confirmed.
  Following successful authentication, <b>DACS</b> credentials may be created
  that represent the identity. For maximum convenience and interoperability in a
  web environment, <b>DACS</b> credentials are usually encapsulated within an
  HTTP cookie and transmitted over a TCP/IP connection secured by SSL/TLS. Any
  secure method of transporting credentials can be used instead, however, such
  as the value of an HTTP extension-header entity-header field in a request
  message sent over a VPN.
<div class="Pp"></div>
While <b>dacs_authenticate</b> provides powerful and flexible ways to combine
  and compose a variety of authentication methods, most <b>DACS</b>
  jurisdictions will configure only one method, or perhaps just a few methods,
  in simple ways.
<div class="Pp"></div>
To help integrate <b>DACS</b> seamlessly within a web site,
  <b>dacs_authenticate</b> allows handlers to be configured. Handlers allow
  various exceptions to be caught and processed so that an appropriate flow of
  control can occur. For example, if authentication succeeds the user can be
  redirected to a specific page, including the one originally requested before
  the exception occurred.
<div class="Pp"></div>
Authentication succeeds (and the user is authenticated) if and only if:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;at least one <b>Auth clause</b>[10]
  has been configured,</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;the semantics of all
  <b>CONTROL</b>[11] directives satisfy the requirements for success,</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;the <b>DACS</b> <b>username</b>[12]
  arrived at is syntactically valid, and</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;the identity's access has not been
  revoked or denied (see <b>dacs.acls(5)</b>[13]).</div>
<div class="Pp"></div>
An incorrect password, for instance, is not considered to be an error; it will
  cause its Auth clause to fail but depending on the control directives that
  have been configured, the user may still be successfully authenticated by some
  other Auth clause. True errors are fatal and cause <b>dacs_authenticate</b> to
  terminate without issuing credentials and possibly without invoking a handler.
<div class="Pp"></div>
If a <b>DACS</b> identity reauthenticates, the user agent is expected to replace
  the old credentials with new ones; if re-authentication fails (e.g., the
  password is incorrect), the old credentials should continue to exist. If a
  user establishes multiple concurrent identities, the user agent is expected to
  send all credentials with each service request in accordance with the relevant
  standards. This is standard behaviour for most common web browsers.
<div class="Pp"></div>
As an efficiency measure, the authentication architecture allows an
  authentication module to return roles.
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>Names</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
Please refer to <b>dacs(1)</b>[14] for details about naming.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>Credentials and Cookies</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<b>DACS</b> credentials are cryptographically protected XML documents (
  <b>credentials.dtd</b>[15]). They have been carefully designed to make it
  extremely difficult for an attacker to generate valid credentials, modify
  captured credentials to impersonate another user, or obtain greater access
  rights without being detected. <b>DACS</b> is careful to not produce log
  information or error messages that might benefit an attacker.
<div class="Pp"></div>
User agents and other software outside of <b>DACS</b> do not need to decrypt the
  credentials and do not possess the required encryption key.
<div class="Pp"></div>
New credentials are created and returned to the user after successful
  authentication. The lifetime of each set of credentials is independently
  configurable, but they are intended to be fairly transitory. If a user
  reauthenticates, new credentials different than previous credentials might
  well be returned (e.g., with different roles).
<div class="Pp"></div>
<b>DACS</b> does not verify that a user's browser is configured to accept
  cookies - this is the responsibility of the <b>DACS</b> administrator (by
  supplying client-side code to test that cookies have been enabled, for
  instance). Failure to accept cookies may cause some features to be unavailable
  or work incorrectly. Also note that despite what <b>DACS</b> (or any other
  program) tells a browser about the lifetime of an HTTP cookie, browsers may be
  configured to impose a shorter lifetime and can delete a cookie at any time.
  (Aside: Firefox 2.0.0.3 appears to show cookies that have been deleted.)
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;For <b>DACS</b> to operate securely,
  communication between a user (or middleware) and <b>dacs_authenticate</b>,
  which may include information such as passwords, <i>must only be transmitted
  over a secure connection (SSL/TLS)</i>.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Communication between
  <b>dacs_authenticate</b> (and <b>dacsauth</b>) and an external (not built-in)
  authentication module may include information such as passwords and therefore
  <i>should only be transmitted over a secure connection (SSL/TLS)</i> or in a
  way that is not subject to eavesdropping or attack.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;For <b>DACS</b> to operate securely,
  regardless of how they are obtained, <b>DACS</b> credentials <i>must only be
  transmitted over a secure connection (SSL/TLS) so that they cannot easily be
  captured and reused by an attacker</i>.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;It is unwise to configure both SSL/TLS
  and non-SSL/TLS communication. Besides providing an avenue for attack, it may
  cause <b>DACS</b> to behave strangely (e.g., infinite loops may occur because
  cookies obtained over an SSL/TLS connection are not subsequently forwarded
  over a non-SSL/TLS connection).</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;The apparent IP address of an
  authenticated user, as provided by the web server, is stored in credentials.
  <b>DACS</b> can be configured to consider credentials to be valid only for
  requests that come from that address (refer to the <b>VERIFY_IP</b>[16]
  configuration directive), making it more difficult for an attacker to replay
  captured credentials.
<div style="height: 1.00em;">&#x00A0;</div>
In some environments this constraint is a good idea, but in general it is of
  dubious value so enable it with care. Where a user is behind a firewall or
  router that has multiple IP addresses, successive service requests might
  legitimately not appear to be coming from the same address and some requests
  would be denied if this constraint were enabled. In situations where
  credentials are being forwarded between web services they might be rejected.
  In the case of dial-up Internet access, a user might be issued credentials,
  lose the connection, and be assigned a different IP address upon reconnecting;
  the user would be forced to reauthenticate. Also, more than one user may be
  associated with a particular IP address, as when a Network Address Translation
  (NAT) facility such as <b>natd(8)</b>[17] is used, so the check does not
  guarantee uniqueness.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Information associated with a user's
  browser can be included in credentials created for that user to make it
  difficult to reuse captured credentials with a different browser. Please refer
  to <b>VERIFY_UA</b>[18] for details.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Credentials have a limit on their
  lifetime that is independent of the lifetime of the HTTP cookie that contains
  them; that is, credentials can expire without their cookie having expired, and
  vice versa. Expired credentials are recognized and will not be used by
  <b>DACS</b>. Refer to the <b>AUTH_CREDENTIALS_DEFAULT_LIFETIME_SECS</b>[19]
  configuration directive for details.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Passwords do not appear in any
  credentials and are not stored once the user has been authenticated.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;It is forbidden to submit multiple
  credentials for the same identity to <b>DACS</b> and such a request will
  trigger an error.</div>
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
All <b>DACS</b> jurisdictions within the same federation share an algorithm and
  key to encrypt and decrypt credentials. A cryptographically secure, symmetric
  encryption function, Rijndael (the <b>Advanced Encryption Standard</b>[20]
  (AES) algorithm and <b>Federal Information Processing Standard</b>[21]), is
  used. The same 128 bit key is used by all <b>DACS</b> jurisdictions. AES also
  supports 192 and 256 bit key lengths and either can be configured at
  build-time.
<div class="Pp"></div>
A cryptographically secure message authentication code (MAC) is used to detect
  modification of credentials. A key different from the encryption key is used.
  The Keyed-Hash Message Authentication Code (HMAC, <b>FIPS 198</b>[22], <b>RFC
  2104</b>[23], <b>RFC 4635</b>[24], <b>RFC 4868</b>[25]), is employed using the
  160-bit <b>NIST</b>[26] secure hash standard, SHA-1 ( <b>FIPS 180-1</b>[27],
  <b>RFC 4634</b>[28], <b>RFC 6234</b>[29]). In addition to SHA-1, SHA-224,
  SHA-256, SHA-384, and SHA-512 ( <b>FIPS 180-4</b>[30]) can be used, although
  they must be configured at build-time.
<div class="Pp"></div>
The AES key length and HMAC digest algorithm used by a federation can be changed
  at any time, perhaps forcing some users to reauthenticate, but the same key
  length and digest algorithm must be used throughout a federation.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
<b>DACS</b> can be configured to use the less secure but widely-used and
  somewhat more efficient <b>MD5 algorithm</b>[31] instead, although it is
  deprecated and it will eventually be removed.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
The <b>Netscape HTTP Cookies Specification</b>[32] defines the syntax and
  semantics of the HTTP response header that a web server sends to a client;
  this syntax is used by default, but the <b></b><i>COOKIE_SYNTAX</i>[33]
  argument can be used to request a different syntax. The Netscape format is as
  follows:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
Set-Cookie: NAME=VALUE; expires=DATE; path=PATH; domain=DOMAIN_NAME; secure
</pre>
</div>
<div class="Pp"></div>
<b>DACS</b> formulates these response headers as follows.
<div class="Pp"></div>
The NAME attribute of an authentication cookie returned to the user (e.g., by
  <b>dacs_authenticate</b>) has the following default format:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
DACS: <i>federation-name</i>::[<i>jurisdiction-name</i>]:[<i>username</i>]
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
where <i>federation-name</i> is the official name assigned to the federation for
  which the cookie is valid, <i>jurisdiction-name</i> is the name of the
  authenticating jurisdiction, and <i>username</i> is the authenticated name of
  the user. If the <i>jurisdiction-name</i> is omitted, the <i>username</i> must
  also be omitted. Semicolons, commas, and whitespace within the name must be
  URL-style encoded. Colons are not allowed in any of the name components. Here
  is an example of a cookie name:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
DACS:EXAMPLE::METALOGIC:rick@example.com
</pre>
</div>
<div class="Pp"></div>
<b>DACS</b> can also return HTTP cookies for other purposes. The NAME attribute
  of these cookies has the same format as an authentication cookie but is
  followed by a colon and a keyword; e.g., DACS:EXAMPLE:::SELECTED.
<div class="Pp"></div>
The default format of the NAME attribute can be overridden through the
  <b>COOKIE_NAME_TERMINATORS</b>[34] directive.
<div class="Pp"></div>
The VALUE attribute of a cookie is a printable text encoding of credentials.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Although <b>DACS</b> performs validity
  tests on cookie names, middleware should not rely on cookie names for any
  purpose. An apparently valid <b>DACS</b> cookie can easily be crafted with any
  value. Also, an apparently legitimate cookie might convey expired or otherwise
  invalid credentials. Middleware should use
  <b>dacs_current_credentials(8)</b>[35] to validate an authentication cookie
  and not trust cookie names.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;No expires attribute is set; this will
  cause the cookie to be automatically deleted by a conforming browser when the
  user's browser session ends and not made persistent (i.e., not stored on disk
  for use in a subsequent browser session), closing a potential security
  hole.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;By default, the value of the path
  attribute is &quot;/&quot;, meaning the cookie will be sent with every request
  to the domain that created the cookie, whether it is for a <b>DACS</b>-wrapped
  service request or not. The <b>COOKIE_PATH</b>[36] configuration directive can
  specify an alternative value. Using a more restricted path can potentially
  improve security. All of the jurisdiction's <b>DACS</b>-wrapped services must
  appear under that path, of course, or the cookie will not be sent; ideally, no
  non- <b>DACS</b> wrapped service would appear under that path.</div>
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
The value of the domain attribute associated with the cookie is dependent on the
  uniform domain name scheme chosen for the jurisdictions. The value will be
  configured to be the most specific tail string that tail matches all
  participating domain names. For example, if the uniform domain name scheme has
  hostnames of the form xxx.example.com, yyy.example.com, and zzz.example.com,
  then the value of the attribute will be example.com. This will ensure that the
  user agent sends the cookie with any service request directed to a hostname
  ending in example.com.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The HTTP cookie specifications appear to say that a cookie having a domain
  attribute of example.com should <i>not</i> be sent to a host of the same name,
  yet both Mozilla and IE (and perhaps other browsers) do just that. Without
  this behaviour, it would not be possible to use a single domain name with
  multiple <b>DACS</b> jurisdictions below it; that is, given
  domain=example.com, it is expected that jurisdictions can be identified by URI
  path prefixes such as example.com/metalogic, example.com/test, and so on.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
When operating securely (see the <b>SECURE_MODE</b>[37] directive in
  <b>dacs.conf(5)</b>[2]) or when an authentication request is sent over
  SSL/TLS, the secure attribute will be present so that the cookie will only be
  transmitted if the communications channel with the host is a secure one. At
  present, browsers define this to mean that secure cookies will only be sent to
  HTTPS (HTTP over SSL/TLS) servers.</div>
<h2 class="Ss" title="Ss" id="Web_Service_Arguments"><a class="selflink" href="#Web_Service_Arguments">Web
  Service Arguments</a></h2>
In addition to the <b>standard CGI arguments</b>[38], <b>dacs_authenticate</b>
  understands the following CGI arguments. Some arguments are optional, while
  others are required depending on the authentication configuration. An invalid
  argument value will usually cause authentication to fail immediately.
  Unrecognized arguments are ignored.
<div class="Pp"></div>
<i>AUTH_ID</i>
<div style="margin-left: 4.00ex;">This optional argument is used with the
  user_sufficient keyword (refer to the <b>CONTROL</b>[11] directive).</div>
<div class="Pp"></div>
<i>AUTH_PROMPT_VAR_PREFIX</i>
<div style="margin-left: 4.00ex;">Reserved for use by
  <b>local_pam_authenticate</b>[39].</div>
<div class="Pp"></div>
<i>AUTH_TRANSID</i>
<div style="margin-left: 4.00ex;">Reserved for use by
  <b>local_pam_authenticate</b>[39].</div>
<div class="Pp"></div>
<i>AUTHORIZATION</i>
<div style="margin-left: 4.00ex;">Used internally with <b>HTTP
  Authentication</b>[5].</div>
<div class="Pp"></div>
<i>AUXILIARY</i>
<div style="margin-left: 4.00ex;">This argument can be used to pass additional
  authentication material to authentication modules. A compile-time maximum
  length of <b>128</b> characters is imposed.</div>
<div class="Pp"></div>
<i>COOKIE_SYNTAX</i>
<div style="margin-left: 4.00ex;">By default, the <i>de facto</i> standard
  <b>Netscape HTTP Cookies Specification</b>[32] syntax is followed when cookies
  are created (COOKIE_SYNTAX=COOKIE_NETSCAPE). The value COOKIE_EXT_NETSCAPE
  selects an &quot;extended&quot; Netscape spec syntax (it is not the Netscape
  syntax but it is not fully RFC 2109 compliant either); instead of using the
  expires attribute it will use the Max-Age attribute as defined in <b>RFC
  2109</b>[40], <b>RFC 2965</b>[41], and <b>RFC 6265</b>[42]. Attribute values
  are not quoted and there is no support for the Comment field. Parameter values
  COOKIE_RFC2109, COOKIE_RFC2965, and COOKIE_RFC6265 are recognized but not
  implemented.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<b>RFC 2109</b>[40], <b>RFC 2965</b>[41], and <b>RFC 6265</b>[42] forbid the
  following characters from appearing within an HTTP cookie's NAME attribute:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
( ) &lt;  &gt; @ , ; : \ &quot;  /  [  ]  ? = {  }
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Additionally, the space, tab, and all US-ASCII control characters (octets 0 -
  31) and DEL (127) are disallowed (refer to the definition of a token in <b>RFC
  2616</b>[43], S2.2). By default, <b>DACS</b> currently follows the original
  Netscape spec syntax in this respect and produces cookies that are invalid
  according to RFC 2109, RFC 2965, and RFC 6265 because <b>colons are used
  within cookie names</b>[44]. While this limitation does not appear to cause
  problems for web browsers in practice, it may be noteworthy for users of some
  cookie handling APIs. When necessary, the cookie name format can be customized
  using the <b>COOKIE_NAME_TERMINATORS</b>[34] directive.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div class="Pp"></div>
<i>DACS_AUTH_SUCCESS_HANDLER</i>
<div style="margin-left: 4.00ex;">This argument provides a way for the caller to
  specify where the user agent should be redirected after successful
  authentication, regardless of whether authentication handlers are configured
  or enabled. If its value is DACS_ERROR_URL and an argument by that name is
  present, the user agent will be redirected to the value of that argument;
  otherwise, the user agent will be redirected to the value of
  <i>DACS_AUTH_SUCCESS_HANDLER</i>. The <i>DACS_ERROR_URL</i> is passed to this
  web service by <b>dacs_acs(8)</b>[45] as part of an authentication workflow
  initiated by a request that is denied because no credentials were supplied;
  <i>DACS_ERROR_URL</i> should not be generated by any non- <b>DACS</b>
  software.</div>
<div class="Pp"></div>
<i>DACS_BROWSER</i>
<div style="margin-left: 4.00ex;">If an argument named <i>DACS_BROWSER</i> is
  present and has the value <b>1</b>, it signifies that the request is coming
  from a browser rather than middleware. If the request comes from a browser,
  <b>DACS</b> will return a cookie using the Set-Cookie HTTP response header,
  otherwise it will not.</div>
<div class="Pp"></div>
<i>DACS_DEBUG</i>
<div style="margin-left: 4.00ex;">If this argument is present, the web service
  will produce more detailed log information.</div>
<div class="Pp"></div>
<i>ENABLE_AUTH_HANDLERS</i>
<div style="margin-left: 4.00ex;">The jurisdiction's authentication handler
  directives are honoured if and only if this argument is present and has the
  value <b>1</b>.</div>
<div class="Pp"></div>
<i>OPERATION</i>
<div style="margin-left: 4.00ex;">This is used with the identity selection
  mechanism described by <b>dacs_select_credentials(8)</b>[46]. If the value of
  this parameter is SELECT and authentication is successful, any currently
  selected credentials are deselected and the new credentials are
  selected.</div>
<div class="Pp"></div>
<i>PASSWORD</i>
<div style="margin-left: 4.00ex;">This argument is the password that corresponds
  to <i>USERNAME</i>. A compile-time maximum length of <b>128</b> characters is
  imposed.</div>
<div class="Pp"></div>
<i>USERNAME</i>
<div style="margin-left: 4.00ex;">This argument, which is almost always
  required, is the name provided by the user and is usually the name being
  authenticated. It will not necessarily be the same as the final <b>DACS</b>
  username. For example, if the value of <i>USERNAME</i> is not a syntactically
  valid <b>DACS</b> username (see <b>dacs(1)</b>[12]), the authentication
  procedure must transform it into something acceptable (using the
  <b></b><b>strtr()</b>[47] function, for instance; see
  <b>dacs.exprs(5)</b>[3]). A compile-time maximum length of <b>64</b>
  characters is imposed.</div>
<div class="Pp"></div>
<i>WWW_AUTHENTICATE</i>
<div style="margin-left: 4.00ex;">Reserved for internal use by <b>HTTP
  Authentication</b>[5].</div>
<h2 class="Ss" title="Ss" id="Auth_Clause_Directives"><a class="selflink" href="#Auth_Clause_Directives">Auth
  Clause Directives</a></h2>
Each Auth clause in a <b>DACS</b> configuration file contains directives that
  describe a procedure for authenticating users. Some of these directives are
  common to all authentication modules, while others are understood only by a
  certain module; for example, <b>LDAP_USERNAME_URL</b>[48] is only meaningful
  to the <b>local_ldap_authenticate</b>[49] module. The general-purpose
  <b>OPTION</b>[50] directive may sometimes be used to specify an argument to an
  authentication module.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Important</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The order in which the Auth clauses appear is significant. See the
  <b>CONTROL</b>[11] directive.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
Every Auth element must have an id attribute. Its value is merely a label (an
  alphabetic followed by zero or more alphanumerics, hyphens, and underscores)
  that allows the clause to be referenced. Each id attribute value must be
  unique (case-sensitively) within the Jurisdiction section that contains it.
<div class="Pp"></div>
The following configuration directives are recognized by
  <b>dacs_authenticate</b> within any Auth clause (see <b>dacs.conf(5)</b>[51]
  for general information about directives).
<div class="Pp"></div>
<b>Auth Clause Common Directives Index:</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 1.CONTROL (Required1)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 2.CREDENTIALS_LIFETIME_SECS (Optional1)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 3.EXIT* (Optional1)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 4.EXPR (Optional1)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 5.FLAGS (Optional1)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 6.INIT* (Optional1)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 7.OPTION (Optional)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 8.OPTION* (Optional)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 9.PASSWORD_AUDIT (Optional)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">10.PREDICATE (Optional1)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">11.STYLE (Required1)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">12.URL (Optional1)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">13.URL* (Optional1)</div>
<div class="Pp"></div>
CONTROL (Required1)
<div style="margin-left: 4.00ex;">This directive specifies a PAM-like control
  keyword that determines what will happen if the authentication module succeeds
  or fails; see <b>pam(3)</b>[52] and the <b>X/Open Single Sign-On Service
  (XSSO) preliminary specification</b>[53] (page 30), from which the description
  of these directives was adapted. Although this control mechanism allows for
  rather complicated authentication sequences to be described, in practice
  jurisdictions tend to construct fairly simple configurations. Most processing
  errors (other than errors encountered by a module) are considered fatal.
<div style="height: 1.00em;">&#x00A0;</div>
The first Auth clause that appears after configuration merging (see
  <b>dacs.conf(5)</b>[54]) is the &quot;top&quot; or first module in the stack,
  the next one is the second module in the stack, and so on.
<div style="height: 1.00em;">&#x00A0;</div>
The value of this directive is a case-insensitive keyword that can be
  abbreviated up to the indicated minimum:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;require[d]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;requisite</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;opt[ional]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;suff[icient]</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;user_suff[icient]</div>
<div style="height: 1.00em;">&#x00A0;</div>
For example, the keywords require and required are equivalent.
<div style="height: 1.00em;">&#x00A0;</div>
The control flow of authentication module processing is as follows:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 1.If a requisite module fails, authentication
  fails and <b>dacs_authenticate</b> stops processing the module stack,
  returning the error reported by the requisite module;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 2.If all requisite and required modules in
  the stack succeed, then authentication succeeds (any errors reported by
  optional, sufficient, and user_sufficient modules are ignored);</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 3.If one or more required modules fail, then
  the error value from the first required module that failed is returned; unlike
  failure of a requisite module, processing continues;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 4.If none of the modules in the stack are
  designated as required or requisite, then <b>dacs_authenticate</b> requires
  that at least one optional, sufficient, or user_sufficient module succeed. If
  all fail, then the error value from the first module in the stack is
  returned;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 5.The first exception to the above is caused
  by the sufficient keyword. If a module that is designated as sufficient
  succeeds, then <b>dacs_authenticate</b> immediately returns success (all
  subsequent modules are ignored, even required and requisite ones), given that
  all prior required and requisite modules have also succeeded. If a prior
  required module failed, then the error value from that module is
  returned;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 6.The second exception to the above involves
  the user_sufficient keyword, which enables at most one user_sufficient Auth
  clause and disables all other user_sufficient <i>and</i> sufficient Auth
  clauses. This control simplifies configuring user-selectable authentication
  methods. Note that this mechanism will necessarily reveal additional
  information about a jurisdiction's authentication configuration.
<div style="height: 1.00em;">&#x00A0;</div>
If the <i>AUTH_ID</i> argument is <i>not</i> given, then all Auth clauses with
  the user_sufficient control are disabled - none of their directives are
  evaluated - and any sufficient controlled clauses are processed normally. If
  the <i>AUTH_ID</i> is present, then only an Auth clause with a user_sufficient
  control <i>and</i> an exactly matching id attribute is used. There can be at
  most one such Auth clause; all other Auth clauses having a user_sufficient
  <i>or</i> sufficient control is disabled. In all other respects, an enabled
  user_sufficient Auth clause is processed as for the sufficient control;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 7.If an error occurs while processing a
  directive, then <b>dacs_authenticate</b> fails immediately.</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
CREDENTIALS_LIFETIME_SECS (Optional1)
<div style="margin-left: 4.00ex;">The lifetime, in seconds, of credentials
  returned after successful authentication. This overrides the general directive
  of the same name, and may in turn be overridden by setting the variable
  <i>${Auth::CREDENTIALS_LIFETIME_SECS}</i>. Authentication will fail if this
  value is invalid.</div>
<div class="Pp"></div>
EXIT* (Optional1)
<div style="margin-left: 4.00ex;">If authentication is successful, this
  expression is evaluated immediately after the module's authentication
  processing is executed (but refer to the FLAGS directive).</div>
<div class="Pp"></div>
EXPR (Optional1)
<div style="margin-left: 4.00ex;">This directive, which is required when STYLE
  is expr, gives an expression that is evaluated to decide whether to grant
  credentials and the <b>DACS</b> identity to use. See <b>Authenticating Using
  an Expression</b>[55].</div>
<div class="Pp"></div>
FLAGS (Optional1)
<div style="margin-left: 4.00ex;">This directive gives control flags that are
  interpreted by <b>dacs_authenticate</b>. Each directive consists of a
  whitespace-separated list of values.
<div style="height: 1.00em;">&#x00A0;</div>
The only value currently recognized is the keyword ident.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Important</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
If there is more than one Auth clause, the ident flag should ordinarily be
  specified in at least one of them to indicate that the username returned by
  the module, if authentication is successful, is to become the
  &quot;current&quot; username. Those Auth clauses without the ident flag will
  not change the current username. After the last Auth clause is processed, the
  current username is used in the resulting credentials.
<div style="height: 1.00em;">&#x00A0;</div>
The <i>${Auth::CURRENT_USERNAME}</i> variable (see below) is updated only if
  there is exactly one Auth clause or if the ident flag is given. This update
  occurs immediately prior to execution of any EXIT* directive.
<div style="height: 1.00em;">&#x00A0;</div>
If ident is not specified in any successfully processed Auth clause (i.e., one
  where authentication succeeds), the username returned by the last successfully
  processed clause is used. If the ident flag is specified in one or more
  successfully processed clauses, the username returned by the last such module
  will be used.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div class="Pp"></div>
INIT* (Optional1)
<div style="margin-left: 4.00ex;">The given expression is evaluated immediately
  prior to the URL* and EXPR expressions, all of which are evaluated before a
  module's authentication processing is invoked.</div>
<div class="Pp"></div>
OPTION (Optional)
<div style="margin-left: 4.00ex;">The directive value is a
  <i>name</i>=<i>value</i> pair that may be interpreted by
  <b>dacs_authenticate</b> or the authentication module specified by the Auth
  clause. It causes a variable called <i>name</i> to be put into the Options
  namespace, which only exists within the context of the Auth clause containing
  this OPTION. The variables in this namespace are passed as arguments to the
  authentication module. Whitespace may not precede or follow the '=' and any
  quotes around the value are considered to be part of the value. A given
  <i>name</i> may not be specified more than once within a particular Auth
  clause. The Options namespace is initialized with <i>USERNAME</i>,
  <i>PASSWORD</i>, <i>AUXILIARY</i>, <i>DACS_JURISDICTION</i>, and
  <i>DACS_VERSION</i> variables. If these variables are specified by an OPTION,
  the argument ordinarily used will be overridden.
<div style="height: 1.00em;">&#x00A0;</div>
For example, this directive causes SAMBA_PORT=139 to be passed as a POST method
  parameter:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
OPTION &quot;SAMBA_PORT=139&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
OPTION* (Optional)
<div style="margin-left: 4.00ex;">The given expression is evaluated before the
  module is called, and after all OPTION directives and all OPTION* directives
  that appear earlier. The value of the expression must be a
  <i>name</i>=<i>value</i> pair, as with the OPTION directive, and overrides any
  <i>name</i> in the Options namespace.</div>
<div class="Pp"></div>
PASSWORD_AUDIT (Optional)
<div style="margin-left: 4.00ex;">This directive is used to audit password-type
  arguments passed to authentication modules by <b>dacs_authenticate</b>,
  regardless of the authentication method, against the criteria selected by the
  specified constraint string, which is in the format used by
  <b>PASSWORD_CONSTRAINTS</b>[56]. If any password does not meet the
  requirements, a log message will be emitted (which does not include the
  password itself). The message will be tagged as audit and sensitive; please
  refer to the <b>LOG_FILTER</b>[57] directive. This feature can be used to
  notify the administrator about weak passwords.
<div style="height: 1.00em;">&#x00A0;</div>
The directive value can be a variable name, which is matched exactly against the
  <i>PASSWORD</i> or <i>AUXILIARY</i> arguments, or a keyword in one of the
  OPTION directives within the same clause. In this form, the
  PASSWORD_CONSTRAINTS directive must be configured and its value is used as the
  constraint. In the second form, the directive value is a variable name as in
  the first form, followed by spaces or tabs, followed by the constraint string
  to use in the syntax of PASSWORD_CONSTRAINTS. Consider the following
  directives:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
PASSWORD_CONSTRAINTS &quot;8L,1C,1P&quot;
<div class="Pp"></div>
&lt;Auth id=&quot;auth1&quot;&gt;
  URL &quot;https://foo.example.com/cgi-bin/dacs/local_woof_authenticate&quot;
  STYLE &quot;pass&quot;
  CONTROL &quot;sufficient&quot;
  PASSWORD_AUDIT &quot;PASSWORD 10L&quot;
  PASSWORD_AUDIT &quot;AUXILIARY&quot;
&lt;/Auth&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Here, the <i>PASSWORD</i> argument must be at least ten characters long but
  <i>AUXILIARY</i> must only be eight characters long and include an upper case
  character and punctuation.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
Not all authentication modules require a <i>PASSWORD</i> argument, such as
  <b>local_cas_authenticate</b>[58] in its interactive mode. This directive is
  ignored if the argument is not passed to the module.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div class="Pp"></div>
PREDICATE (Optional1)
<div style="margin-left: 4.00ex;">If provided, this expression is evaluated
  before any other authentication module processing is done. If there is an
  evaluation error or it returns <b>False</b> (zero or the empty string),
  processing continues just as if the module were run and indicated that
  authentication failed. Otherwise, processing of the clause continues normally.
<div style="height: 1.00em;">&#x00A0;</div>
This directive provides a way to effectively enable or disable a module based on
  run time context. This can be used to configure layered authentication or
  risk-based authentication because a predicate can examine various aspects of
  an authentication request, such as the <i>USERNAME</i>, current date and time,
  IP address from where the request originates, and so on.</div>
<div class="Pp"></div>
STYLE (Required1)
<div style="margin-left: 4.00ex;">Each authentication module implements one or
  more authentication styles. The value of the STYLE directive is a
  comma-separated list of case-insensitive style names and style options; the
  order is insignificant. No whitespace is allowed. Keywords can be abbreviated
  up to the indicated minimum.
<div class="Pp"></div>
cas
<div style="margin-left: 4.00ex;">This style selects username/password
  authentication using the <b>Central Authentication Service (CAS)</b>[59]
  protocol through the <b>local_cas_authenticate</b>[58] authentication
  module.</div>
<div class="Pp"></div>
cert[ificate]
<div style="margin-left: 4.00ex;">An X.509 client certificate, obtained from the
  SSL/TLS layer, will be provided for authentication. The request must be sent
  using SSL/TLS and the client certificate must be provided by <b>Apache</b>
  through the <b>SSL_CLIENT_CERT</b> environment variable.</div>
<div class="Pp"></div>
digest
<div style="margin-left: 4.00ex;">This selects the <b>RFC 2617</b>[60] Digest
  Access Authentication scheme as implemented by <b>DACS</b> in conjunction with
  the <b>local_apache_authenticate</b>[61] authentication module. See <b>HTTP
  Authentication</b>[5].</div>
<div class="Pp"></div>
expr
<div style="margin-left: 4.00ex;">No authentication module will be used;
  <b>expression evaluation</b>[55] will be used instead.</div>
<div class="Pp"></div>
infocard
<div style="margin-left: 4.00ex;">A self-issued or managed <b>Information
  Card</b>[62] (InfoCard) must be provided for authentication. To be recognized,
  the InfoCard must have been previously registered at this jurisdiction using
  <b>dacsinfocard(1)</b>[63], <b>dacs_infocard(8)</b>[64], or
  <b>dacs_managed_infocard(8)</b>[65]. This style is implemented by the
  <b>local_infocard_authenticate</b>[66] authentication module.</div>
<div class="Pp"></div>
managed_infocard
<div style="margin-left: 4.00ex;">A managed <b>Information Card</b>[62]
  (InfoCard) must be provided for authentication. To be recognized, the InfoCard
  must have been previously registered at this jurisdiction using
  <b>dacs_managed_infocard(8)</b>[65]. This style is implemented by the
  <b>local_infocard_authenticate</b>[66] authentication module.</div>
<div class="Pp"></div>
nat[ive]
<div style="margin-left: 4.00ex;">The user is expected to have already
  authenticated through the web server's native authentication mechanism (e.g.,
  HTTP Basic or Digest authentication, <b>RFC 2617</b>[60]); <b>DACS</b> will
  import this identity without any additional requirements. The <b>AUTH_TYPE</b>
  environment variable but be available and have the value Basic or Digest (case
  insensitive), and the <b>REMOTE_USER</b> environment variable must be
  set.</div>
<div class="Pp"></div>
pass[word]
<div>&#x00A0;</div>
passwd
<div style="margin-left: 4.00ex;">The username must be provided through a
  <i>USERNAME</i> argument and the password must accompany the authentication
  request through a <i>PASSWORD</i> argument.</div>
<div class="Pp"></div>
prompt[ed]
<div style="margin-left: 4.00ex;">A dialog-based interaction will be conducted,
  such as one based on Pluggable Authentication Modules (PAM). See
  <b>local_pam_authenticate</b>[39].</div>
<div class="Pp"></div>
selfissued_infocard
<div style="margin-left: 4.00ex;">A self-issued <b>Information Card</b>[62]
  (InfoCard) must be provided for authentication. To be recognized, the InfoCard
  must have been previously registered at this jurisdiction using
  <b>dacsinfocard(1)</b>[63] or <b>dacs_infocard(8)</b>[64]. This style is
  implemented by the <b>local_infocard_authenticate</b>[66] authentication
  module.</div>
<div class="Pp"></div>
simple
<div style="margin-left: 4.00ex;">This style of authentication merely requires a
  recognized username, provided through a <i>USERNAME</i> argument and therefore
  offers little security. Still, it can be used in appropriate situations to
  authenticate a user that can provide a valid account name, which might be a
  membership number or randomly generated (and perhaps hard to guess) username.
  If a <i>PASSWORD</i> argument is provided, it is logged as sensitive data,
  much as an anonymous FTP password might be logged. This style is implemented
  by the <b>local_simple_authenticate</b>[67] authentication module.</div>
<div class="Pp"></div>
tgma
<div style="margin-left: 4.00ex;"><i>Experimental</i>. This interactive style of
  authentication requires only <i>USERNAME</i> and <i>JURISDICTION</i> arguments
  to be selected by the user. Refer to the TGMA authentication module for
  details.
<div style="height: 1.00em;">&#x00A0;</div>
This style is implemented by the <b>local_tgma_authenticate</b>[68]
  authentication module.</div>
<div class="Pp"></div>
set_roles
<div style="margin-left: 4.00ex;">If the authentication module returns roles,
  this style modifier says that they should override any other roles currently
  in effect and no roles module should be executed. This option may appear at
  most once among all Auth clauses and only if <b>add_roles</b>[69] is not
  used.</div>
<div class="Pp"></div>
add_roles
<div style="margin-left: 4.00ex;">If the authentication module returns roles,
  this style modifier says that they should be appended to any other roles
  currently in effect. Any configured roles modules will still be executed. This
  option may be repeated in other Auth clauses but may not appear if the
  <b>set_roles</b>[70] option also appears.</div>
</div>
<div class="Pp"></div>
URL (Optional1)
<div>&#x00A0;</div>
URL* (Optional1)
<div style="margin-left: 4.00ex;">Exactly one of these two directives must be
  specified, except when STYLE is expr, where neither directive is used. These
  directives specify the URL to be used to invoke the authentication module. Use
  of an absolute URL is recommended.
<div style="height: 1.00em;">&#x00A0;</div>
The difference between the two directives is that the value of URL* is an
  expression that is evaluated immediately before the module is invoked to
  determine the URL to be used.
<div style="height: 1.00em;">&#x00A0;</div>
In the current implementation, the standard set of modules must run within the
  context of a <b>DACS</b> jurisdiction. This is not an architectural
  limitation, however.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
Some authentication modules are available as built-in components of
  <b>dacs_authenticate</b> and <b>dacsauth</b>. These modules are identified by
  specific relative URLs. A module's description will provide its built-in name
  when this capability is available. The built-in capability will automatically
  be provided if the module has been enabled at build-time.
<div style="height: 1.00em;">&#x00A0;</div>
Although it will be more efficient (and possibly more secure) to use a built-in
  module, they are executed on the same host as <b>dacs_authenticate</b> thereby
  giving up some flexibility because access control rules are not applied to
  them (other than the one for <b>dacs_authenticate</b>), and
  <b>dacs_authenticate</b> may need to be executed setuid root or setgid www so
  that it can access password files. When an external module is used, it is
  subject to normal <b>DACS</b> access control rules. In contrast to a built-in
  module, the additional level of indirection makes it simple to substitute a
  custom version of an external module. The same comments apply to
  <b>dacsauth</b>.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div class="Pp"></div>
Here is an example of a configuration that will authenticate using Unix user
  names and passwords:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;Auth id=&quot;passwd&quot;&gt;
  URL &quot;https://foo.example.com:8443/cgi-bin/dacs/local_unix_authenticate&quot;
  STYLE &quot;pass&quot;
  CONTROL &quot;sufficient&quot;
&lt;/Auth&gt;
</pre>
</div>
<div class="Pp"></div>
In the following example, <b>dacs_authenticate</b> will first try to
  authenticate using a Unix login name and password; if that fails, it will then
  try a <b>DACS</b> account name and password.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;Auth id=&quot;passwd&quot;&gt;
  URL &quot;https://foo.example.com:8443/cgi-bin/dacs/local_unix_authenticate&quot;
  STYLE &quot;pass&quot;
  CONTROL &quot;sufficient&quot;
&lt;/Auth&gt;
<div class="Pp"></div>
&lt;Auth id=&quot;passwd2&quot;&gt;
  URL &quot;https://foo2.example.com/cgi-bin/dacs/local_passwd_authenticate&quot;
  STYLE &quot;pass&quot;
  CONTROL &quot;sufficient&quot;
&lt;/Auth&gt;
</pre>
</div>
<div class="Pp"></div>
The preceding example can be changed to try authenticating using a <b>DACS</b>
  account name and password if and only if the <i>AUXILIARY</i> argument has the
  value &quot;guest&quot; (which might have been provided when the user selected
  a button on a login form):
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;Auth id=&quot;passwd&quot;&gt;
  URL &quot;https://foo.example.com:8443/cgi-bin/dacs/local_unix_authenticate&quot;
  STYLE &quot;pass&quot;
  CONTROL &quot;sufficient&quot;
  PREDICATE '${Args::AUXILIARY} ne &quot;guest&quot;'
&lt;/Auth&gt;
<div class="Pp"></div>
&lt;Auth id=&quot;passwd2&quot;&gt;
  URL &quot;https://foo2.example.com/cgi-bin/dacs/local_passwd_authenticate&quot;
  STYLE &quot;pass&quot;
  CONTROL &quot;sufficient&quot;
  PREDICATE '${Args::AUXILIARY} eq &quot;guest&quot;'
&lt;/Auth&gt;
</pre>
</div>
<div class="Pp"></div>
In this example, a jurisdiction offers users a choice from among three
  authentication methods: a Googleaccount, a Windows NTLM account, or a
  <b>DACS</b> password-based account. The jurisdiction's login form would be
  written to provide the appropriate <i>AUTH_ID</i> argument for the
  corresponding method;
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
# For AUTH_ID=google
&lt;Auth id=&quot;google&quot;&gt;
  URL &quot;local_http_authenticate&quot;
  STYLE &quot;password&quot;
  CONTROL &quot;user_sufficient&quot;
  OPTION 'AUTH_URL=&quot;https://www.google.com/accounts/ClientLogin&quot;'
  OPTION 'AUTH_METHOD=POST'
  OPTION 'USERNAME_PARAMETER=&quot;Email&quot;'
  OPTION 'PASSWORD_PARAMETER=&quot;Passwd&quot;'
  OPTION 'service=xapi'
  OPTION &quot;source=DSS-DACS-1.4&quot;
&lt;/Auth&gt;
<div class="Pp"></div>
# For AUTH_ID=ntlm
&lt;Auth id=&quot;ntlm&quot;&gt;
  URL &quot;local__ntlm_authenticate&quot;
  STYLE &quot;password&quot;
  CONTROL &quot;user_sufficient&quot;
  OPTION 'SAMBA_SERVER=&quot;samba.example.com&quot;'
  OPTION 'SAMBA_PORT=&quot;139&quot;'
  EXIT* '${Auth::CURRENT_USERNAME}=strtr(${Auth::CURRENT_USERNAME}, &quot;a-z&quot;, &quot;A-Z&quot;)'
&lt;/Auth&gt;
<div class="Pp"></div>
# For AUTH_ID=passwd
&lt;Auth id=&quot;passwd&quot;&gt;
  URL &quot;local_passwd_authenticate&quot;
  STYLE &quot;password&quot;
  CONTROL &quot;user_sufficient&quot;
&lt;/Auth&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h2 class="Ss" title="Ss" id="Initialization_and_the_Auth_Namespace"><a class="selflink" href="#Initialization_and_the_Auth_Namespace">Initialization
  and the Auth Namespace</a></h2>
<b>dacs_authenticate</b> uses a variable namespace called Auth to make
  authentication-related context available to its configuration directives (see
  <b>dacs.exprs(5)</b>[71]). Aspects of <b>dacs_authenticate</b>'s behaviour can
  be controlled by modifying these variables. This namespace disappears when
  <b>dacs_authenticate</b> terminates. The next section describes how these
  variables are used.
<div class="Pp"></div>
Additionally, all environment variables are accessible through the Env namespace
  (e.g., <i>${Env::REMOTE_ADDR}</i>) during authentication processing.
<h2 class="Ss" title="Ss" id="Authentication_Clause_Control_Flow"><a class="selflink" href="#Authentication_Clause_Control_Flow">Authentication
  Clause Control Flow</a></h2>
Auth clauses are processed in the order in which they appear in the
  configuration file, subject to the semantics of the CONTROL directives.
<div class="Pp"></div>
<b>dacs_authenticate</b> is typically configured so that the last thing it does
  is to redirect its caller to an appropriate web page. If authentication is
  successful, any <b>AUTH_SUCCESS</b>[72] expression is evaluated and the
  <b>AUTH_SUCCESS_HANDLER</b>[73] directive is consulted; if authentication
  fails, the <b>AUTH_ERROR_HANDLER</b>[74] and <b>AUTH_FAIL_DELAY_SECS</b>[75]
  directives are used. This behaviour is partially under the control of the
  caller through the <b></b><i>DACS_AUTH_SUCCESS_HANDLER</i>[76] and
  <b></b><i>ENABLE_AUTH_HANDLERS</i>[77] arguments, however.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
To redirect the newly authenticated user to a web page based on the user's
  identity, jurisdiction, roles, or other contextual state, configure
  AUTH_SUCCESS_HANDLER to specify the URL of a <b>DACS</b>-wrapped CGI program.
  After examining environment variables automatically passed to it by
  <b>DACS</b> or its query arguments, this program can emit an appropriate
  redirect. To test this, configure:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
AUTH_SUCCESS_HANDLER &quot;url /cgi-bin/dacs/dacs_prenv&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
(making sure that <b>dacs_prenv(8)</b>[78] has been installed) and examine the
  information that is available.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
An Auth clause is processed in a sequence of steps, and with various hooks to
  provide fine-grained control. Only advanced <b>DACS</b> administrators usually
  need to be concerned with this level of detail.
<div class="Pp"></div>
Before the first clause is examined, the variable
  <i>${Auth::CURRENT_USERNAME}</i> is set to the empty string; this variable is
  automatically updated by <b>dacs_authenticate</b>. The contents of the Args,
  DACS, Conf, and Env <b>namespaces</b>[71] are made available to all
  expressions evaluated during authentication module processing. Processing of
  each Auth clause is performed in the following sequence:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 1.If the clause has a PREDICATE directive, it
  is evaluated in the current context. If the value is not <b>True</b>
  (including cases where the expression was invalid), processing of the clause
  terminates immediately with the same result as if its authentication had been
  unsuccessful.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 2.If a variable named <i>${Auth::ABORT}</i>
  has the value yes (case insensitive), authentication terminates. If the
  variable <i>${Auth::MODULE_SKIP}</i> has the value yes (case insensitive),
  processing of the clause terminates immediately with the same result as if its
  authentication had been unsuccessful.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 3.If the clause has an INIT* directive, it is
  evaluated; if an error occurs, authentication terminates.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 4.If the clause has a URL directive, it names
  the authentication module to be invoked (or is the name of a built-in module).
<div style="height: 1.00em;">&#x00A0;</div>
If the URL* directive is used instead, it is evaluated to obtain the URL to be
  invoked; if an error occurs, authentication terminates.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 5.If a variable named <i>${Auth::ABORT}</i>
  has the value yes (case insensitive), authentication terminates. If the
  variable <i>${Auth::MODULE_SKIP}</i> has the value yes (case insensitive),
  processing of the clause terminates immediately with the same result as if its
  authentication had been unsuccessful.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 6.If the clause's STYLE is expr, the EXPR
  directive is evaluated and is expected to either return <b>False</b> or a
  valid <b>DACS</b> username. If the expression's value is <b>False</b>,
  processing of the clause terminates immediately with the same result as if its
  authentication had been unsuccessful; if its value is an invalid username,
  authentication terminates, otherwise the module is deemed to have been
  successful. If an error occurs, authentication terminates.
<div style="height: 1.00em;">&#x00A0;</div>
If the clause's STYLE is not expr, the authentication module is invoked.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 7.If an error occurs while executing the
  authentication module, authentication terminates. If the authentication module
  does not authenticate the user, the CONTROL directive determines whether
  authentication fails or continues.
<div style="height: 1.00em;">&#x00A0;</div>
The username passed to the module, or returned by the module, becomes the
  tentative <b>DACS</b> username and the variable
  <i>${Auth::CURRENT_USERNAME}</i> is set to it. If the variable
  <i>${Auth::ROLES}</i> is set to a valid role descriptor, it becomes the
  current tentative roles for the user.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 8.The expression given by the EXIT*
  directive, if any, is evaluated. If an error occurs, authentication
  terminates. The expression may update <i>${Auth::CURRENT_USERNAME}</i>. For
  instance, the directive:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
EXIT* '${Auth::CURRENT_USERNAME}=&quot;bobo&quot;'
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
completely ignores the username returned by the module and simply assigns one,
  while this directive:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
EXIT* '${Auth::CURRENT_USERNAME} = \
       strtr(${Auth::CURRENT_USERNAME}, &quot;A-Z&quot;, &quot;a-z&quot;)'
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
converts all upper case characters in the username returned by the module to
  their lower case equivalents.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 9.If a variable named <i>${Auth::ABORT}</i>
  has the value yes (case insensitive), authentication terminates despite
  success of the module. If the variable <i>${Auth::MODULE_SKIP}</i> has the
  value yes (case insensitive), processing of the clause terminates immediately
  with the same result as if its authentication had been unsuccessful.</div>
<div class="Pp"></div>
The value of <i>${Auth::CURRENT_USERNAME}</i> when the last module has been
  processed is the username that will be assigned to a successfully
  authenticated user. If set, the value of
  <i>${Auth::CREDENTIALS_LIFETIME_SECS}</i> will be used as the lifetime of the
  generated credentials; if not set, the value returned by the last successful
  authentication module is used (typically that of the module's
  CREDENTIALS_LIFETIME_SECS directive), if available, or the jurisdiction's
  CREDENTIALS_LIFETIME_SECS directive's value.
<h2 class="Ss" title="Ss" id="Authenticating_Using_an_Expression"><a class="selflink" href="#Authenticating_Using_an_Expression">Authenticating
  Using an Expression</a></h2>
Rather than using an authentication module, the expr style of authentication
  involves evaluating an expression. The value of the expression is the
  <b>DACS</b> username to associate with the user. If no value is returned, an
  invalid value is returned, or an error occurs, the Auth clause fails.
<div class="Pp"></div>
Here is a simple example that is unlikely to be used in practice. If the
  <i>PASSWORD</i> argument is &quot;xyzzy&quot;, then authentication will
  succeed and the user will be assigned the <b>DACS</b> username bobo.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;Auth id=&quot;expr1&quot;&gt;
  STYLE &quot;expr&quot;
  CONTROL &quot;sufficient&quot;
  EXPR '${Args::PASSWORD} eq &quot;xyzzy&quot; ? &quot;bobo&quot; : &quot;&quot;'
&lt;/Auth&gt;
</pre>
</div>
<div class="Pp"></div>
This example illustrates how an expression can be used to read a password (its
  hex-encoded SHA-256 hash, actually) from a file and compare it with the one
  provided in the service request. Each user has his own password file that
  consists of a single line of text containing the hash. If a username is given
  that does not have a corresponding password file, or if the hash of the
  provided password does not match the stored one, the Auth clause will fail,
  otherwise the given username is returned as the authenticated name.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;Auth id=&quot;expr5&quot;&gt;
STYLE &quot;expr&quot;
EXPR '${pwd} = get(&quot;/usr/local/dacs/pwd/pwd.&quot; . ${Args::USERNAME}); \
  digest(${Args::PASSWORD}, 0, sha256) eq decode(hex, ${pwd}) \
      ? ${Args::USERNAME} : &quot;&quot;'
CONTROL &quot;sufficient&quot;
&lt;/Auth&gt;
</pre>
</div>
<div class="Pp"></div>
The expression can also assign a valid role string to <i>${Auth::ROLES}</i> to
  establish roles for the user (in conjunction with the <b>add_roles</b>[69] or
  <b>set_roles</b>[70] style modifier):
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;Auth id=&quot;expr2&quot;&gt;
  STYLE &quot;expr,add_roles&quot;
  CONTROL &quot;sufficient&quot;
  EXPR '${Auth::ROLES}=&quot;foo,bar&quot;; ${Args::PASSWORD} eq \
    &quot;xyzzy&quot; ? &quot;bobo&quot; : &quot;&quot;'
&lt;/Auth&gt;
</pre>
</div>
<div class="Pp"></div>
This style of authentication can be a useful alternative to the cert style with
  the <b>local_cert_authenticate</b> module. If the client has provided an X.509
  certificate that has been adequately verified by the web server, then in many
  cases all that remains to be done is to assign a syntactically valid DACS
  username to the client. <b>Environment variables</b>[79] created by
  <b>mod_ssl</b>[80] can be referenced as
  <i>${Auth::</i><i></i><i>ssl_variable_name</i> <i>}</i>. Something such as the
  following might be suitable:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;Auth id=&quot;expr3&quot;&gt;
  STYLE &quot;expr&quot;
  CONTROL &quot;sufficient&quot;
  EXPR '${Auth::SSL_CLIENT_VERIFY} eq &quot;SUCCESS&quot; and
    ${Auth::SSL_CLIENT_S_DN_Email:ei} \
        ? ${Auth::SSL_CLIENT_S_DN_Email:i} : &quot;&quot;'
&lt;/Auth&gt;
</pre>
</div>
<div class="Pp"></div>
Another application of this style of authentication is where it is the location
  of the user that is important rather than the user's identity <i>per se</i>.
  For example, if a system administrator needs to restrict access to a web
  server to the hosts in a lab or desktops in a group of offices (that
  presumably share a subnet) but does not require individual users to
  authenticate, a configuration like the following might be adequate:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;Auth id=&quot;expr4&quot;&gt;
  STYLE &quot;expr&quot;
  CONTROL &quot;sufficient&quot;
  EXPR '${Auth::CURRENT_USERNAME} = &quot;user-${Env::REMOTE_ADDR}&quot;'
&lt;/Auth&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
A user would not provide a username or a password; by simply clicking on a link
  that invokes <b>dacs_authenticate</b>, a user from the computer with IP
  address 10.0.0.213 (for example) would be assigned the identity
  user-10.0.0.213. Access control rules could be expressed in terms of those
  identities or the corresponding IP addresses.
<h2 class="Ss" title="Ss" id="Middleware_Support"><a class="selflink" href="#Middleware_Support">Middleware
  Support</a></h2>
As with most <b>DACS</b> web services, the <i>FORMAT</i> argument can be used to
  request a particular type of output (see <b>dacs.services(8)</b>[81]) from
  <b>dacs_authenticate</b>. If any XML type is specified, the reply from
  <b>dacs_authenticate</b> will conform to the DTD
  <b>dacs_auth_reply.dtd</b>[82]. The reply indicates whether the user has been
  successfully authenticated or not. If authentication was successful, a
  description of the new credentials is returned as a dacs_current_credentials
  element, (as described by <b>dacs_current_credentials.dtd</b>[83]). If
  authentication was unsuccessful because of a transient error condition, a
  reason may optionally be provided.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
This reason is solely used to inform the user; it should not reveal any details
  that might compromise security.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
Authentication modules return an <b>auth_reply.dtd</b>[84] document to
  <b>dacs_authenticate</b>.
<h2 class="Ss" title="Ss" id="Authentication_Modules"><a class="selflink" href="#Authentication_Modules">Authentication
  Modules</a></h2>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Important</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
<b>DACS</b> provides a set of authentication modules. At the time <b>DACS</b> is
  compiled, some standard modules are enabled by default while others needed
  must be specifically enabled (see <b>dacs.install(7)</b>[85]). You should not
  enable authentication modules that you do not plan to use.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;As a security measure, these modules
  should be executable only by <b>dacs_authenticate</b>, which is the
  default.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;By default, access control rules are
  configured to restrict access to all authentication and roles modules. This
  prevents an attacker from calling an authentication module directly in an
  attempt to guess account names, passwords, and so on.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Modules may need to be installed
  setuid or setgid as appropriate so that it is possible for them to read the
  password files that they require or obtain encryption keys.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Modules may need to be installed
  setuid or setgid, and never run as the UID of a less-privileged user, so that
  it is impossible to circumvent the module's functionality (e.g., by attaching
  to the running module with a debugger).</div>
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
Each authentication module is called with the following arguments.
  Authentication modules are always invoked using the POST method.
<div class="Pp"></div>
<i>AUXILIARY</i>
<div style="margin-left: 4.00ex;">The value of the <i>AUXILIARY</i> argument to
  <b>dacs_authenticate</b> if one was given, otherwise the empty string.</div>
<div class="Pp"></div>
<i>DACS_JURISDICTION</i>
<div style="margin-left: 4.00ex;">The value of the <i>DACS_JURISDICTION</i>
  argument to <b>dacs_authenticate</b>.</div>
<div class="Pp"></div>
<i>DACS_VERSION</i>
<div style="margin-left: 4.00ex;">The DACS_VERSION_NUMBER for this version of
  <b>dacs_authenticate</b>.</div>
<div class="Pp"></div>
<i>PASSWORD</i>
<div style="margin-left: 4.00ex;">The value of the <i>PASSWORD</i> argument to
  <b>dacs_authenticate</b> if one was given, otherwise the empty string.</div>
<div class="Pp"></div>
<i>USERNAME</i>
<div style="margin-left: 4.00ex;">The value of the <i>USERNAME</i> argument to
  <b>dacs_authenticate</b>.</div>
<div class="Pp"></div>
Directives
<div style="margin-left: 4.00ex;">Each directive in the Auth section being
  processed and its value is passed.</div>
<div class="Pp"></div>
SSL/TLS environment variables
<div style="margin-left: 4.00ex;">Each SSL/TLS environment variable passed to
  <b>dacs_authenticate</b> is passed.</div>
<div class="Pp"></div>
Transaction state data
<div style="margin-left: 4.00ex;">With respect to the prompted style of
  authentication, transaction state variables are passed.</div>
Ordinarily, a particular argument may not appear more than once.
<div class="Pp"></div>
<b>Authentication Module Index:</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 1.local_apache_authenticate:
  Password-protected accounts maintained by <b>Apache</b> utilities</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 2.local_cas_authenticate: Central
  Authentication Service (CAS)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 3.local_cert_authenticate: SSL-based X.509
  client certificates</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 4.local_grid_authenticate: Grid-based
  one-time passwords</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 5.local_http_authenticate: Generic
  authentication via HTTP</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 6.local_infocard_authenticate: Information
  Card-based accounts and identities</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 7.local_ldap_authenticate: Lightweight
  Directory Access Protocol (LDAP) / Microsoft Active Directory</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 8.local_native_authenticate: Importing an
  identity established by <b>Apache</b></div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 9.local_ntlm_authenticate: Microsoft Windows
  NT LAN Manager usernames and passwords</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">10.local_pam_authenticate: Pluggable
  Authentication Modules (PAM)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">11.local_passwd_authenticate:
  Password-protected <b>DACS</b> accounts</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">12.local_simple_authenticate: Account name
  without a password</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">13.local_tgma_authenticate: Time-Gated Mutual
  Authentication ( <i>experimental</i>)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">14.local_token_authenticate: One-time
  passwords, two-factor authentication</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">15.local_unix_authenticate: Unix usernames and
  passwords</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>local_apache_authenticate</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
The <b>local_apache_authenticate</b> module is used to authenticate against
  password files used by the <b>Apache</b> <b></b><b>mod_auth</b>[86],
  <b></b><b>mod_auth_digest</b>[87], or <b></b><b>mod_auth_dbm</b>[88] modules.
  These password files are managed by <b>Apache's</b> <b>htpasswd(1)</b>[89],
  <b>htdigest(1)</b>[90], and <b>htdbm(1)</b>[91] utilities, respectively. An
  administrator can configure <b>DACS</b> to use an existing htpasswd file, for
  instance, and so avoid dealing with creating and managing a duplicate set of
  usernames and passwords.
<div class="Pp"></div>
If HTTP Basic authentication ( <b>RFC 2617</b>[60]) is used, the STYLE should be
  password. If Digest authentication is used, because no password is passed to
  <b>DACS</b>, the STYLE for this module should be configured as digest.
<div class="Pp"></div>
The following configuration options are recognized by this module. They should
  be provided using the OPTION directive.
<div class="Pp"></div>
AUTH_MODULE
<div style="margin-left: 4.00ex;">This must be &quot;mod_auth&quot; (or
  &quot;htpasswd&quot;), &quot;mod_auth_digest&quot; (or &quot;htdigest&quot;),
  or &quot;mod_auth_dbm&quot; (or &quot;htdbm&quot;), depending on which
  module's authentication method is to be used. This value is
  case-insensitive.</div>
<div class="Pp"></div>
AUTH_FILE
<div style="margin-left: 4.00ex;">This is the absolute pathname of the flat-file
  or database file to use.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
This pathname is resolved on the host that runs this module. This should
  eventually be extended to accept a <b>DACS</b> virtual filestore URI.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div class="Pp"></div>
DBM_TYPE
<div style="margin-left: 4.00ex;">Required only in conjunction with mod_auth_dbm
  compatibility, this argument identifies the database format of AUTH_FILE. The
  names &quot;sdbm&quot; (not yet implemented), &quot;gdbm&quot;,
  &quot;ndbm&quot;, and &quot;db&quot; are recognized, although not all types
  may be available on a particular platform.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Notes</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;This module does not rely on any
  <b>Apache</b> module (other than <b>mod_auth_dacs</b>).</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;This module does not require any
  <b>Apache</b> configuration with respect to authentication; only <b>DACS</b>
  needs to be configured.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;It is not necessary to use
  <b>DACS's</b> <b>HTTP Authentication</b>[5] feature in order to use this
  module. For example, using HTTP Basic authentication ( <b>RFC 2617</b>[60]),
  the <i>USERNAME</i> and <i>PASSWORD</i> arguments can be submitted from a
  site's login page and verified by this module against an <b>htpasswd</b>
  file.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>htpasswd</b> allows plaintext
  passwords to be stored in a password file, although <b>httpd</b> apparently
  restricts the use of these passwords. This module imposes no such
  restrictions. Under normal circumstances passwords should not be stored in
  plaintext form.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;The major difference between this
  module and <b>local_native_authenticate</b>[92] is that the latter
  &quot;imports&quot; an identity already established by an <b>Apache</b>
  authentication module, whereas this module authenticates using information
  that can also be used by <b>Apache</b> and which is administered using
  <b>Apache</b> utiltities.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>DACS</b> will access <b>Apache</b>
  password files in read-only mode only; <b>DACS</b> never modifies those
  files.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Some platforms may not support all
  possible DBM-type databases and some types of database may not have been
  configured at build-time.</div>
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
Here is an example configuration that uses an <b>htpasswd</b>-managed file for
  authentication:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
HTTP_AUTH_ENABLE &quot;yes&quot;
HTTP_AUTH &quot;Basic \&quot;DACS Basic Auth Area\&quot; /restricted/*&quot;
<div class="Pp"></div>
&lt;Auth id=&quot;apache-htpasswd&quot;&gt;
URL &quot;https://example.com/cgi-bin/dacs/local_apache_authenticate&quot;
STYLE &quot;pass&quot;
CONTROL &quot;sufficient&quot;
OPTION &quot;AUTH_FILE=/usr/local/apache2/conf/passwords&quot;
OPTION &quot;AUTH_MODULE=mod_auth&quot;
&lt;/Auth&gt;
</pre>
</div>
<div class="Pp"></div>
If the passwords were kept in a Berkeley DB database instead, the configuration
  might look like:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
HTTP_AUTH_ENABLE &quot;yes&quot;
HTTP_AUTH &quot;Basic \&quot;DACS Basic Auth Area\&quot; /restricted/*&quot;
<div class="Pp"></div>
&lt;Auth id=&quot;apache-htpasswd&quot;&gt;
URL &quot;https://example.com/cgi-bin/dacs/local_apache_authenticate&quot;
STYLE &quot;pass&quot;
CONTROL &quot;sufficient&quot;
OPTION &quot;AUTH_FILE=/usr/local/apache2/conf/passwords.db&quot;
OPTION &quot;AUTH_MODULE=mod_auth_dbm&quot;
OPTION &quot;DBM_TYPE=db&quot;
&lt;/Auth&gt;
</pre>
</div>
<div class="Pp"></div>
This example configuration is similar; the difference is that the username and
  password obtained through HTTP Basic authentication are verified against a
  Unix account:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
HTTP_AUTH_ENABLE &quot;yes&quot;
HTTP_AUTH &quot;Basic \&quot;DACS Basic Auth Area\&quot; /private/*&quot;
<div class="Pp"></div>
&lt;Auth id=&quot;basic&quot;&gt;
URL &quot;https://example.com/cgi-bin/dacs/local_unix_authenticate&quot;
STYLE &quot;pass&quot;
CONTROL &quot;sufficient&quot;
&lt;/Auth&gt;
</pre>
</div>
<div class="Pp"></div>
This example configures HTTP Digest authentication and references an
  <b>htdigest</b>-managed file:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
HTTP_AUTH_ENABLE &quot;yes&quot;
HTTP_AUTH &quot;Digest \&quot;DACS Digest Auth Area\&quot; /digest/*&quot;
<div class="Pp"></div>
&lt;Auth id=&quot;apache-htdigest&quot;&gt;
URL &quot;apache&quot;
STYLE &quot;digest&quot;
CONTROL &quot;sufficient&quot;
OPTION &quot;AUTH_FILE=/usr/local/apache2/conf/passwords.digest&quot;
OPTION &quot;AUTH_MODULE=mod_auth_digest&quot;
&lt;/Auth&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
A built-in version of this module can be selected by using the URL
  local_apache_authenticate or just apache.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>local_cas_authenticate</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
This module coordinates with a specified <b>Central Authentication Service
  (CAS)</b>[93] server to authenticate a user that is purportedly known to that
  server. The module implements the client side of the <b>CAS 2.0
  Protocol</b>[94] and can be used in two different modes: interactive and
  non-interactive.
<div class="Pp"></div>
Interactive mode is employed if neither a <i>USERNAME</i> nor a <i>PASSWORD</i>
  argument is given to <b>dacs_authenticate</b>. When <b>dacs_authenticate</b>
  is called, whether directly or as the result of redirection after access was
  denied to an unauthenticated user, it redirects the user to a CAS login page.
  After successful CAS authentication (which may return a ticket granting cookie
  to the user's browser), CAS redirects the user to <b>dacs_authenticate</b>,
  passing it the CAS session ticket as an argument called <i>ticket</i>. After
  successfully validating the session ticket at the CAS server, <b>DACS</b>
  authentication succeeds.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
When interactive mode is used, <b>DACS</b> does not see the username and
  password, only CAS does. The username is obtained by the module as part of the
  session ticket validation protocol. This mode of operation is similar to, but
  simpler than, the <b>OpenID</b>[95] Authentication protocol.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
A variant of this flow of control can occur if the user has authenticated
  against the CAS server outside of <b>DACS</b> and therefore holds a ticket
  granting cookie. This cookie will automatically be sent by the user's browser
  when it is redirected to the CAS server; as a result, the CAS server may not
  prompt the user to authenticate.
<div class="Pp"></div>
In non-interactive mode, both a <i>USERNAME</i> <i>and</i> a <i>PASSWORD</i>
  argument are passed to <b>dacs_authenticate</b>. This module will use these
  arguments to authenticate the user against the CAS server. In this mode, no
  ticket granting cookie will be returned to the user. This mode can be used
  with the <b>DACS</b> <b>HTTP authentication</b>[5] feature.
<div class="Pp"></div>
The STYLE should be configured as cas for this module.
<div class="Pp"></div>
The following module-specific OPTION directive value is understood:
<div class="Pp"></div>
CAS_SERVER_URI (Required1)
<div style="margin-left: 4.00ex;">This is the URI of the CAS server to
  authenticate against. For example, dacs.conf might contain authentication
  configuration similar to the following:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;Auth id=&quot;CAS&quot;&gt;
URL &quot;cas&quot;
STYLE &quot;cas&quot;
CONTROL &quot;sufficient&quot;
OPTION &quot;CAS_SERVER_URI=https://cas.example.com/castest&quot;
&lt;/Auth&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
The module recognizes the following arguments (which are automatically passed to
  it as necessary by <b>dacs_authenticate</b>):
<div class="Pp"></div>
CAS_TICKET (Required1-C)
<div style="margin-left: 4.00ex;">This is the session ticket returned by CAS via
  a callback to <b>dacs_authenticate</b> (i.e., the <i>ticket</i>
  argument).</div>
<div class="Pp"></div>
CAS_REDIRECT_ARGS (Optional1)
<div style="margin-left: 4.00ex;">These are additional arguments to
  <b>dacs_authenticate</b> that must be provided when CAS performs its callback
  to <b>dacs_authenticate</b> to preserve user preferences. The
  <i>DACS_BROWSER</i>, <i>FORMAT</i>, <i>DACS_ERROR_URL</i>, and
  <i>ENABLE_AUTH_HANDLERS</i> arguments may be forwarded in this way.</div>
<div class="Pp"></div>
CAS_SERVER_URI (Required1-C)
<div style="margin-left: 4.00ex;">This argument has the value specified in the
  Auth clause's OPTION directive. Note that HTTP redirects are not handled in
  this context, so invoking GET on CAS_SERVER_URI must return a valid
  document.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The <b>local_cas_authenticate</b> module extends the response of the
  <b>validate</b> service of the CAS protocol to allow a role descriptor string
  ( <i>role_string</i>) to be returned. If authentication succeeds, the standard
  service returns the following text: yes\n <i>username</i>\n
<div class="Pp"></div>
An invalid role string is discarded. If these roles should be used, it will be
  necessary to use either the <b>set_roles</b>[70] or <b>add_roles</b>[69] style
  modifier with the <b>STYLE</b>[96] directive.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The authentication procedure described by the CAS protocol is notable because
  the authentication material provided by the user in interactive mode <i>does
  not flow through </i> <i></i><b>DACS</b>; in particular, <b>DACS</b> does not
  see a user's password when this module is used. This may be an important
  consideration in some environments.
<div class="Pp"></div>
Because the protocol implemented by this module is general purpose and
  relatively simple, writing middleware that implements a subset of the
  server-side CAS protocol to interface with this module may be a sensible
  solution for <b>DACS</b> administrators who require a CAS-like control flow
  but do not want to use actual CAS server-side software. The user would be
  redirected to the middleware component by <b>local_cas_authenticate</b> to
  perform the /login service; then it would prompt and authenticate the user,
  and redirect the user to a URL provided to it by
  <b>local_cas_authenticate</b>; then <b>local_cas_authenticate</b> would call
  the middleware component directly, this time to perform the /validate service.
  The usual flow of control within <b>DACS</b> would follow.
<div class="Pp"></div>
A simple script for testing and working with <b>local_cas_authenticate</b> is
  available in src/cas_middleware_test.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
A built-in version of this module can be selected by using the URL
  local_cas_authenticate or just cas.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>local_cert_authenticate</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
The <b>local_cert_authenticate</b> module authenticates a user that supplies an
  acceptable X.509 client certificate via SSL/TLS. <b>Apache</b> must be
  appropriately configured to request and verify client certificates, check for
  revocation, and so on (see <b>SSLVerifyClient</b>[97] and related directives).
  As part of the SSL/TLS protocol, <b>Apache</b>'s <b>mod_ssl</b>[80] module
  verifies that the client possesses the private key that corresponds to the
  client certificate. <b>Apache</b> will usually be configured to verify the
  correctness and suitability of the client certificate. <b>Apache</b>
  directives such as <b>SSLRequire</b>[98] might be used, for example.
<div class="Pp"></div>
The STYLE should be configured as certificate for this module.
<div class="Pp"></div>
The verification of the client certificate done by <b>Apache</b> may be
  sufficient, in which case the only remaining configuration task for the Auth
  clause is to assign a username and possibly extract role information from the
  certificate; it may impose additional tests on the certificate, however, by
  inspecting its fields. If verification beyond the ability of
  <b>mod_ssl</b>[80] is required, or if it needs to be performed on a system
  other than where the web server is running, <b>local_cert_authenticate</b> can
  execute an external program to decide whether the client certificate is
  suitable for authentication. This program is currently limited to
  <b>OpenSSL</b>[99] but this may be generalized in future versions.
<div class="Pp"></div>
To ensure that <b>local_cert_authenticate</b> is able to obtain information
  contained within the client certificate, <b>Apache</b> must be configured so
  that <b>StdEnvVars</b> and <b>ExportCertData</b> are enabled in an appropriate
  <b>SSLOptions</b>[100] directive, such as the following:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
SSLOptions +StdEnvVars +ExportCertData
</pre>
</div>
<div class="Pp"></div>
The following configuration directives are specific to this module:
<div class="Pp"></div>
CERT_CA_PATH (Required1)
<div style="margin-left: 4.00ex;">This is the absolute pathname of a directory
  that contains trusted certificates. Refer to the <b>-CApath</b> argument to
  <b>OpenSSL</b>'s verify command.</div>
<div class="Pp"></div>
CERT_DUMP_CLIENT (Optional1)
<div style="margin-left: 4.00ex;">If configured, this gives the absolute
  pathname of a file to which the client certificate is to be written in PEM
  format. The file is created or truncated, as necessary. This is useful for
  debugging purposes.</div>
<div class="Pp"></div>
CERT_NAME_ATTR (Optional1)
<div style="margin-left: 4.00ex;">If this directive is configured, it gives the
  name of an <b>SSL/TLS environment variable</b>[79]. The value of that variable
  is used as a key for the certnamemap item type (which must also be
  configured); the key's value becomes the username returned by the module (if
  the environment variable is not found or the lookup is unsuccessful, the
  module will fail to authenticate the user). If the module is not fully
  configured for this lookup, the value of the <i>USERNAME</i> is returned by
  the module.
<div style="height: 1.00em;">&#x00A0;</div>
To illustrate this, consider the following configuration:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
VFS &quot;[certmap]dacs-kwv-fs:/usr/local/dacs/federations/certnamemap&quot;
<div class="Pp"></div>
&lt;Auth id=&quot;cert&quot;&gt;
  URL &quot;https://example.com/cgi-bin/dacs/local_cert_authenticate&quot;
  STYLE &quot;cert&quot;
  CONTROL &quot;sufficient&quot;
  CERT_CA_PATH &quot;/usr/local/apache2/conf/ssl.crt&quot;
  CERT_NAME_ATTR &quot;SSL_CLIENT_S_DN_CN&quot;
&lt;/Auth&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
with the file /usr/local/dacs/federations/certnamemap containing the two lines:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
Clark Kent:superman
Bruce Wayne:batman
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Given the configuration above, if the value of the <b>SSL_CLIENT_S_DN_CN</b>
  environment variable is &quot;Clark Kent&quot;, the username returned by the
  module will be &quot;superman&quot;.
<div style="height: 1.00em;">&#x00A0;</div>
As with any module, an expression can be used within an Auth clause to modify or
  override the value returned by a module.</div>
<div class="Pp"></div>
CERT_OPENSSL_PATH (Optional1)
<div style="margin-left: 4.00ex;">This is the absolute pathname of the
  <b>openssl</b> program. If not provided, a build-time value is used (
  <i>OPENSSL_PATH</i>).</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The lifetime of credentials obtained through the local authentication service
  may be independent of the validity period of the certificate presented for
  authentication. It is therefore possible for the certificate to expire before
  the <b>DACS</b> credentials. The local authentication service might take this
  into consideration before granting access and when computing a lifetime for
  the resulting <b>DACS</b> credentials.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>local_grid_authenticate</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
This module works in concert with the <b>dacsgrid(1)</b>[101] utility to provide
  users with one-time passwords. It is also an approximation of the
  &quot;something you have&quot; factor of two-factor authentication.
<div class="Pp"></div>
The STYLE should be configured as password for this module.
<div class="Pp"></div>
Please refer to <b>dacsgrid(1)</b>[101] for a complete description.
<div class="Pp"></div>
In addition to the usual <i>USERNAME</i> argument, the module requires the
  <i>PASSWORD</i> argument to be the user's response to the challenge and the
  <i>AUXILIARY</i> argument to be the encoded challenge. The latter two
  arguments must be produced by <b>dacsgrid(1)</b>[101].
<div class="Pp"></div>
The following OPTION directive values are understood:
<div class="Pp"></div>
AUTH_GRID_CHALLENGE_SECS (Optional1)
<div style="margin-left: 4.00ex;">The number of seconds between when a challenge
  is created and when it expires, overriding the default value. This value
  should be relatively small, at most on the order of a few tens of seconds. If
  this module runs on a host other than the one running
  <b>dacs_authenticate</b>, the two system clocks must be suitably
  synchronized.</div>
<div class="Pp"></div>
AUTH_GRID_LIFETIME_SECS (Optional1)
<div style="margin-left: 4.00ex;">The length of time, in seconds, for which a
  grid is valid. After this period, all authentication against a grid will
  fail.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
A built-in version of this module can be selected by using the URL
  local_grid_authenticate or just grid.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>local_http_authenticate</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
This module authenticates by invoking a given (non-interactive) web service with
  specified arguments. If the web service reports success by returning HTTP
  status code <b>200</b> (see <b>RFC 2616</b>[43], Section 10), then the module
  succeeds, otherwise it fails. No session is established with the web service
  and no additional requests are made to it.
<div class="Pp"></div>
In its simple (default) mode of operation, any output returned by the web
  service is discarded, including cookies. The web service is used solely to
  determine whether a username/password is correct. In its alternate mode, the
  web service can return a document that specifies a replacement username,
  lifetime of generated credentials, and a role string.
<div class="Pp"></div>
This module can be used to authenticate against any existing web service that
  follows the expected protocol, or provide a way to add a new, custom
  authentication method to <b>DACS</b>.
<div class="Pp"></div>
The STYLE should be configured as password for this module.
<div class="Pp"></div>
The following OPTION directive values are understood:
<div class="Pp"></div>
AUTH_URL (Required1)
<div style="margin-left: 4.00ex;">The URL of the web service to invoke, which
  need not be <b>DACS</b>-wrapped. It may use either the http or https scheme.
  No <b>DACS</b> credentials will be sent with the request.</div>
<div class="Pp"></div>
AUTH_METHOD (Optional1)
<div style="margin-left: 4.00ex;">The HTTP method to use to invoke AUTH_URL. The
  default is POST. Keep in mind that if query arguments are present (or if the
  GET method is used) they may appear in log files.</div>
<div class="Pp"></div>
PASSWORD_PARAMETER (Optional1)
<div style="margin-left: 4.00ex;">The name of the argument by which
  <i>PASSWORD</i> is passed to the web service. The default is
  <i>PASSWORD</i>.</div>
<div class="Pp"></div>
USERNAME_PARAMETER (Optional1)
<div style="margin-left: 4.00ex;">The name of the argument by which
  <i>USERNAME</i> is passed to the web service. The default is
  <i>USERNAME</i>.</div>
<div class="Pp"></div>
USE_AUTH_REPLY (Optional1)
<div style="margin-left: 4.00ex;">The default behaviour is to ignore any
  document that is returned by the web service. If this option is
  &quot;yes&quot; or &quot;on&quot;, however, the web service must return a
  syntactically valid <b>auth_reply.dtd</b>[84] document. For authentication to
  succeed, the document must indicate successful authentication. The contents of
  a valid document will provide the username (overriding USERNAME), and,
  optionally, the lifetime of the credentials and a role string. If the STYLE
  directive does not include an <b>add_roles</b>[69] or <b>set_roles</b>[70]
  modifier, the role string will be ignored. This capability allows a generic
  web service to be called with arbitrary arguments to dynamically authenticate
  a user, and set an identity and roles. The returned values must be
  valid.</div>
<div class="Pp"></div>
Any other OPTION directive values are simply passed to the invoked web service,
  including any duplicate argument names.
<div class="Pp"></div>
For <b>Google</b>[102] <b>account authentication</b>[103], for instance, the
  following configuration might be used:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;Auth id=&quot;google&quot;&gt;
URL &quot;local_http_authenticate&quot;
STYLE &quot;password&quot;
CONTROL &quot;required&quot;
OPTION 'AUTH_URL=&quot;https://www.google.com/accounts/ClientLogin&quot;'
OPTION 'USERNAME_PARAMETER=Email'
OPTION 'PASSWORD_PARAMETER=Passwd'
OPTION 'service=xapi'
OPTION &quot;source=DSS-DACS-1.4&quot;
&lt;/Auth&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
This web service returns an HTTP status code of <b>200</b> if the correct
  username and password are given (i.e., login succeeded), and <b>403</b> if
  login fails. If <b>ClientLogin</b> fails and requests a CAPTCHA challenge the
  request will not be passed back to the user.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
One of the reasons for inclusion of this module is to support reuse of accounts
  widely used by the public. Googleprovides exactly the right interface needed
  by systems such as <b>DACS</b>. As of 20-April-2012, Google has officially
  deprecated <b>ClientLogin</b>. Accounts provided by <b>eBay</b>[104]and
  <b>Yahoo!</b>[105], for instance, do not appear to be directly usable in this
  way. In some cases, <b>dacs_auth_transfer(8)</b>[8] may be a better approach
  than this module.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
The following outlines a trivial example of authentication using the
  USE_AUTH_REPLY directive. Assume that the following shell script can be
  invoked as http://example.com/cgi-bin/myauth:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
#! /bin/sh
<div class="Pp"></div>
/bin/cat &lt;&lt;HERE
<div class="Pp"></div>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;US-ASCII&quot;?&gt;
&lt;!DOCTYPE auth_reply SYSTEM &quot;http://example.com/dacs/dtd-xsd/auth_reply.dtd&quot;&gt;
&lt;auth_reply&gt;
&lt;ok username=&quot;guest&quot;&gt;
&lt;roles_reply&gt;
&lt;ok roles=&quot;bigwheel,mediumwheel,littlewheel&quot;/&gt;
&lt;/roles_reply&gt;
&lt;/ok&gt;
&lt;/auth_reply&gt;
HERE
<div class="Pp"></div>
exit 0
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Also assume the following Auth clause has been configured:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;Auth id=&quot;http&quot;&gt;
URL &quot;local_http_authenticate&quot;
STYLE &quot;password,set_roles&quot;
CONTROL &quot;required&quot;
OPTION 'AUTH_URL=&quot;http://example.com/cgi-bin/myauth&quot;'
OPTION 'AUTH_METHOD=GET'
OPTION 'USE_AUTH_REPLY=&quot;YES&quot;'
&lt;/Auth&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Invoking this URL will always successfully authenticate any user and issue
  credentials for the identity JUR1:guest with roles
  bigwheel,mediumwheel,littlewheel:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
https://example.com/cgi-bin/dacs/dacs_authenticate?USERNAME=alice&amp;PASSWORD=test&amp;DACS_JURISDICTION=JUR1
</pre>
</div>
<div class="Pp"></div>
This <b>expression</b>[3] is equivalent:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacsexpr -e 'dacsauth(&quot;-m http passwd,set_roles suff -OAUTH_URL=http://bsd9.dss.ca/cgi-bin/dacs/http_auth \
    -OAUTH_METHOD=GET -OUSE_AUTH_REPLY=yes -u test -p test&quot;)'
{&quot;result&quot;,1,&quot;identity&quot;,&quot;DSS::BSD9:guest&quot;,&quot;roles&quot;,&quot;bigwheel,mediumwheel,littlewheel&quot;}
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
A built-in version of this module can be selected by using the URL
  local_http_authenticate or just http.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>local_infocard_authenticate</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Deprecated</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
In early 2011, Microsoft <b>announced</b>[106] that it would not support
  <b>CardSpace</b>[107] (aka, Infocards and Information Cards) starting with
  <b>Windows 8</b>[108]. CardSpace has been the most widely available identity
  selector for using Information Cards.
<div class="Pp"></div>
The implementation of Infocards support within <b>DACS</b> remains in the code
  base and is documented, but is no longer being actively tested and maintained
  (neither are the demos). Support for Information Cards within <b>DACS</b> will
  likely be removed eventually. You may notice that other Infocard and CardSpace
  related projects have been terminated and their web pages are out of date or
  no longer available.
<div class="Pp"></div>
References: <b>On the Demise of CardSpace</b>[109]; <b>Open Cardspace
  opportunity</b>[110]; <b>Personal Reflections on the CardSpace
  Journey</b>[111]; <b>From CardSpace to Verified Claims</b>[112]; <b>Change
  will come: the present is untenable</b>[113]; <b>The Clay Feet of
  Giants?</b>[114]; <b>RIP, Windows CardSpace. Hello, U-Prove</b>[115]; and
  <b>U-Prove</b>[116].
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
The <b>local_infocard_authenticate</b> module performs <b>DACS</b>
  authentication using an <b>Information Card</b>[62] (InfoCard) previously
  registered at the jurisdiction. Self-issued InfoCards are registered using
  <b>dacs_infocard(8)</b>[64] or <b>dacsinfocard(1)</b>[63]. Managed InfoCards
  are also supported, provided they have been registered using
  <b>dacs_managed_infocard(8)</b>[65] and include a dacs_identity claim in the
  <b>DACS</b> namespace. <b>DACS</b> aims to conform to <b>Identity Selector
  Interoperability Profile (ISIP) 1.5</b>[117].
<div class="Pp"></div>
A <b>DACS</b> <b>role descriptor string</b>[118] can be associated with a
  managed InfoCard through the dacs_roles claim name in the <b>DACS</b>
  namespace (see <b>dacs_infocard(8)</b>[119]. These roles can be associated
  with new credentials via the <b>add_roles</b>[69] and <b>set_roles</b>[70]
  modifiers.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
At present, to be valid for authentication, the dacs_identity claim value must
  specify a user at the current jurisdiction; that is, it cannot specify an
  identity at a jurisdiction other than the one where authentication is being
  performed.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
The authentication style infocard causes the module to accept either type of
  InfoCard - the type of InfoCard actually used will be available in the
  resulting credentials. The styles managed_infocard and selfissued_infocard
  tell the module to limit authentication to managed InfoCards or self-issued
  InfoCards, respectively. When invoked as a web service,
  <b>local_infocard_authenticate</b> understands an optional argument,
  <i>TYPE</i>, that may have the value &quot;selfissued&quot; or
  &quot;managed&quot; to restrict authentication to the corresponding InfoCard
  type; the default behaviour accepts either type of InfoCard.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The <b>expression-based authentication style</b>[120], which does not call this
  module, provides an alternative way to support InfoCard-based authentication.
  It is somewhat more complicated to use, however, and may require a small
  amount of programming.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
For additional information about InfoCards, please refer to:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>dacs_managed_infocard(8)</b>[121],
  <b>dacs.conf(5)</b>[122] (the INFOCARD_ prefixed directives),
  <b>dacs_mex(8)</b>[123], and <b>dacs_sts(8)</b>[124].</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>Using InfoCards With DACS</b>[125],
  Distributed Systems Software (July, 2009).</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b></b><i>Identity Selector
  Interoperability Profile specification and companion guides</i>[126] (August,
  2008).</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b></b><i>Introducing Windows
  CardSpace</i>[127] (April, 2006).</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
A built-in version of this module can be selected by using the URL
  local_infocard_authenticate or just infocard.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>local_ldap_authenticate</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
The <b>local_ldap_authenticate</b> module performs <b>DACS</b> authentication
  using the Lightweight Directory Access Protocol, also known as LDAP, (see
  <b>RFC 2251</b>[128], <b>RFC 2252</b>[129], <b>RFC 2253</b>[130], <b>RFC
  3377</b>[131], and many others). This form of authentication can be used with
  Microsoft's <b>Active Directory (ADS)</b>[132]. <b>OpenLDAP</b>[133] is used
  to supply LDAP client support.
<div class="Pp"></div>
The STYLE should be configured as password for this module.
<div class="Pp"></div>
In general, authentication using LDAP is challenging because an LDAP name (a
  distinguished name, or DN) is typically long and often has a site-specific
  structure. For this reason, this module often requires more local expertise
  for configuring and testing than other <b>DACS</b> authentication modules. At
  least a basic familiarity with LDAP will be required to configure this module.
<div class="Pp"></div>
The module implements two different approaches to authentication:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 1.In the direct method, which is the simpler
  and more efficient approach, the <i>USERNAME</i> argument is directly mapped
  to the corresponding DN. The module binds to that DN using the given
  <i>PASSWORD</i>. If the bind operation succeeds, the user has been
  authenticated.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 2.When the simpler method is not possible,
  the indirect method can be used to bind to the directory as an LDAP
  administrator (or an identity with the ability to search the appropriate
  portion of the directory tree) and perform an LDAP search operation for a
  directory entry having an attribute that matches the <i>USERNAME</i> argument.
  If the search returns exactly one entry, it binds to that entry's DN using the
  <i>PASSWORD</i> argument; if the bind operation succeeds, the user has been
  authenticated.</div>
<div style="height: 1.00em;">&#x00A0;</div>
Regardless of the approach, after successful authentication it may be necessary
  to map the <i>USERNAME</i> or the DN into a valid <b>DACS</b> username.
<div class="Pp"></div>
The following configuration directives are specific to this module:
<div class="Pp"></div>
LDAP_ADMIN_PASSWORD (Optional1)
<div style="margin-left: 4.00ex;">This is the password for the LDAP
  administrator account that corresponds to LDAP_ADMIN_URL.</div>
<div class="Pp"></div>
LDAP_ADMIN_URL (Required1-C)
<div style="margin-left: 4.00ex;">If the indirect method is used, this directive
  is required. This value is a URI like LDAP_USERNAME_URL except that it
  identifies the LDAP directory's administrator. Example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
LDAP_ADMIN_URL
  &quot;ldap://example.com/cn=Administrator, cn=Users, dc=example, dc=com&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
LDAP_BIND_METHOD (Required1-C)
<div style="margin-left: 4.00ex;">This directive tells the module to use the
  direct method, indirect method, or both methods (case insensitive). When both
  are used, the indirect method is attempted only if the direct method
  fails.</div>
<div class="Pp"></div>
LDAP_ROLES_SELECTOR* (Optional)
<div style="margin-left: 4.00ex;">Since LDAP directory operations are usually
  relatively expensive, this module can return role information for the
  authenticated user, avoiding a second LDAP operation during Roles clause
  processing. Roles are typically extracted from information in the user's
  directory entry. Each occurrence of this directive specifies an expression
  that is evaluated by iterating through each attribute of the entry and making
  the attribute name ( <i>${LDAP::attrname}</i>) and its value
  (<i>${LDAP::attrvalue}</i>) available. All of the entry's attribute names and
  values are made available within the LDAP namespace. If the result of the
  expression is a valid role string (which excludes the empty string,
  &quot;&quot;), it is added to the list of roles.
<div style="height: 1.00em;">&#x00A0;</div>
An example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
LDAP_ROLES_SELECTOR* '&quot;${LDAP::attrname}&quot; eq &quot;memberOf&quot; \
    ? strtr(ldap(rdn_attrvalue, \
        ldap(dn_index, &quot;${LDAP::attrvalue}&quot;, 1)), &quot; &quot;, &quot;_&quot;) \
    : &quot;&quot;'
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
For each instance of the entry's memberOf attribute, this expression selects the
  least significant (left-most) component of the attribute value (a DN) using
  <b>ldap()</b>[134] and converts spaces to underscores. If the user's entry
  contains:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
memberOf: CN=Domain Guests,CN=Users,DC=example,DC=com
memberOf: CN=Guests,CN=Builtin,DC=example,DC=com
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
the resulting roles would be Domain_Guests and Guests.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
These roles are discarded unless the <b>STYLE</b>[96] directive for this module
  allows the roles to be incorporated into the user's credentials.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div class="Pp"></div>
LDAP_SEARCH_FILTER (Required1-C)
<div style="margin-left: 4.00ex;">If the indirect method is used, either this
  directive or LDAP_SEARCH_FILTER* (but not both) must be configured. This
  search filter is used to select the unique directory entry that corresponds to
  this user.</div>
<div class="Pp"></div>
LDAP_SEARCH_FILTER* (Required1-C)
<div style="margin-left: 4.00ex;">If the indirect method is used, either this
  directive or LDAP_SEARCH_FILTER (but not both) must be configured. This search
  filter is used to select the unique directory entry that corresponds to this
  user. This directive is exactly like LDAP_SEARCH_FILTER except that it is
  evaluated just before it is used, allowing various elements of the execution
  context to appear in the string. Example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
LDAP_SEARCH_FILTER* '&quot;(sAMAccountName=${Args::USERNAME})&quot;'
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
LDAP_SEARCH_ROOT_DN (Required1-C)
<div style="margin-left: 4.00ex;">This is the root DN at which the indirect
  method should begin searching for user entries.</div>
<div class="Pp"></div>
LDAP_TIMEOUT_SECS (Optional1)
<div style="margin-left: 4.00ex;">This is a maximum time limit, in seconds, for
  any individual LDAP read or search operation performed by the module. If not
  specified, there will not be an application-specified time limit.</div>
<div class="Pp"></div>
LDAP_USERNAME_EXPR* (Optional1)
<div style="margin-left: 4.00ex;">If authentication succeeds, this directive is
  evaluated to yield the <b>DACS</b> username returned to
  <b>dacs_authenticate</b>. All of the entry's attribute names and values are
  made available within the LDAP namespace. If unspecified, the value of the
  <i>USERNAME</i> parameter is returned. Example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
LDAP_USERNAME_EXPR* '&quot;${LDAP::sAMAccountName}&quot;'
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
LDAP_USERNAME_URL (Optional1)
<div style="margin-left: 4.00ex;">If the direct method is used, either this
  directive or <b>LDAP_USERNAME_URL*</b>[135] (but not both) must be configured.
  This directive identifies both the LDAP server to use and the user being
  authenticated. The value of this directive is a URI (see <b>RFC 2396</b>[136]
  and <b>RFC 3986</b>[137]) that gives the name of the LDAP server to contact to
  authenticate the user (as the scheme and authority part of the URI) and the DN
  for the user (as the path part of the URI). The scheme must be either ldap or
  ldaps (case insensitive). If no port number is specified, 389 is used with the
  former scheme and 636 with the latter.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
LDAP_USERNAME_URL
  '&quot;ldap://example.com/cn=Auggie%20Doggie, cn=Users, dc=example, dc=com&quot;'
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
The ldaps scheme is not implemented. Communication between this module and the
  LDAP server should use a secure channel or at least not be snoopable.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div class="Pp"></div>
LDAP_USERNAME_URL* (Optional1)
<div style="margin-left: 4.00ex;">If the direct method is used, either this
  directive or LDAP_USERNAME_URL (but not both) must be configured. This
  directive is exactly like LDAP_USERNAME_URL except that it is evaluated just
  before it is used, allowing various elements of the execution context to
  appear in the string. Example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
LDAP_USERNAME_URL*
  '&quot;ldap://example.com/cn=${Args::USERNAME}, cn=Users, dc=example, dc=com&quot;'
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
Before using LDAP authentication with <b>DACS</b>, you should first make sure
  that your LDAP server is functioning as you expect and that the host that will
  run the <b>local_ldap_authenticate</b> module can communicate with the LDAP
  server.
<div class="Pp"></div>
One way to do this is to use the <b>ldapsearch(1)</b>[138] command (found in the
  clients/tools directory of the OpenLDAP distribution) to bind to the directory
  and perform some searches. You should run this command on the same machine
  that will be running <b>DACS</b>'s LDAP authentication module (
  <b>local_ldap_authenticate</b>). Some of the information that you obtain from
  this exercise may be helpful when you configure <b>DACS</b> to use this form
  of authentication.
<div class="Pp"></div>
Here are some examples to try - you must adapt the names for your environment:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% ./ldapsearch -h win2k.example.com -x -b &quot;dc=example,dc=com&quot; \
     -D &quot;CN=Administrator,CN=Users,DC=example,DC=com&quot; -W -LLL
% ./ldapsearch -h win2k.example.com -x -b &quot;dc=example,dc=com&quot; \
     -D &quot;CN=Auggie Doggie,CN=Users,DC=example,DC=com&quot; -W -LLL
% ./ldapsearch -h win2k.example.com -x -b &quot;dc=example,dc=com&quot; \
     -D &quot;CN=Administrator,CN=Users,DC=example,DC=com&quot; -W -LLL \
     &quot;(cn=Administrator)&quot; memberOf
% ./ldapsearch -h win2k.example.com -x -b &quot;dc=example,dc=com&quot; \
     -D &quot;CN=Administrator,CN=Users,DC=example,DC=com&quot; -W -LLL \
     &quot;(sAMAccountName=auggie)&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
In these examples, the LDAP server runs on a host named win2k.example.com (so
  change win2k.example.com, example, and com), and it expects a user named
  &quot;Auggie Doggie&quot; to exist and have the account name
  &quot;auggie&quot; (again, change to names that exist in your LDAP directory).
  You should be prompted for the LDAP password (in Windows, that will be the
  login password) for either Administrator or a user named &quot;Auggie
  Doggie&quot;, depending on the argument that follows the <b>-D</b> flag.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
The following configuration illustrates authentication using this module:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;Auth id=&quot;ldap&quot;&gt;
  URL &quot;https://example.com/cgi-bin/dacs/local_ldap_authenticate&quot;
  STYLE &quot;password,add_roles&quot;
  CONTROL &quot;required&quot;
  LDAP_BIND_METHOD &quot;direct&quot;
  LDAP_USERNAME_URL* '&quot;ldap://windows.example.com/cn=&quot; \
     . encode(url, ${Args::USERNAME}) . &quot;,cn=Users,dc=example,dc=com&quot;'
  LDAP_USERNAME_EXPR* '&quot;${LDAP::sAMAccountName}&quot;'
  LDAP_ROLES_SELECTOR* '&quot;${LDAP::attrname}&quot; eq &quot;memberOf&quot; \
    ? strtr(ldap(rdn_attrvalue, \
        ldap(dn_index, &quot;${LDAP::attrvalue}&quot;, 1)), &quot; &quot;, &quot;_&quot;) \
    : 0'
&lt;/Auth&gt;
</pre>
</div>
<div class="Pp"></div>
Here, the LDAP authentication module will construct a DN by plugging the
  user-provided <i>USERNAME</i> argument into the template and binding to that
  DN with the <i>PASSWORD</i> argument. If successful, the <b>DACS</b> username
  will be the value of the user's entry's sAMAccountName attribute, and roles
  will extracted from the entry's memberOf attribute values, as described above.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
In Windows, the SAM-Account-Name Active Directory attribute value
  (sAMAccountName) need not be the same as the entry's Common Name; for
  instance, the former might be &quot;doggie&quot; and the latter
  &quot;CN=Auggie Doggie&quot;. The sAMAccountName must not exceed 20 characters
  in length and must be unique within the domain. It is composed of printable
  characters other than the following:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
\   /   [   ]   :   ;   |   =   ,   +   *   ?   &lt;   &gt;   @   &quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
The userPrincipalName attribute value is a user account name (or &quot;user
  login name&quot;) that is unique within its domain and a domain name
  identifying the domain in which the user account is located. The format is the
  same as a domain-name based email address; e.g., doggie@example.com.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>local_native_authenticate</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
The <b>local_native_authenticate</b> module transfers a user's current,
  context-dependent web server identity to a <b>DACS</b> identity. The web
  server will most likely have used HTTP Basic or Digest authentication ( <b>RFC
  2617</b>[60]). The user, having already been authenticated by the web server
  at a particular jurisdiction, will automatically be given <b>DACS</b>
  credentials associated with that jurisdiction and typically having the same
  username.
<div class="Pp"></div>
The STYLE should be configured as native for this module.
<div class="Pp"></div>
This method of authentication also depends on a CGI helper program (
  <b>autologin(8)</b>[139]) and appropriate configuration of <b>Apache</b>
  authentication. The general idea is that the helper program must be executable
  only by users that have been properly authenticated by the web server (by any
  <b>Apache</b> method and using any <b>Apache</b> authentication module). The
  helper program then invokes <b>dacs_authenticate</b> with appropriate
  arguments; if this module has been enabled and accepts its arguments, the user
  will be given <b>DACS</b> credentials.
<div class="Pp"></div>
There are no directives or options specific to this module.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>local_ntlm_authenticate</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
The <b>local_ntlm_authenticate</b> module authenticates users through Windows NT
  LAN Manager using the NTLM protocol [ <b>1</b>[140], <b>2</b>[141]]. This
  module, which makes use of <b>Samba</b>[142] libraries, provides Windows
  <b>NTLM authentication</b>[143] based on a username and password. The module
  does not need to be (and will not usually be) executed on the host running
  Windows.
<div class="Pp"></div>
The STYLE should be configured as password for this module.
<div class="Pp"></div>
The following OPTION directive values are understood:
<div class="Pp"></div>
SAMBA_SERVER (Required1)
<div style="margin-left: 4.00ex;">The domain name or IP address in standard dot
  notation of the Windows system providing NTLM authentication.</div>
<div class="Pp"></div>
SAMBA_PORT (Optional1)
<div style="margin-left: 4.00ex;">The port number to use on SAMBA_SERVER. The
  default is 0, which tells Samba to use a sequence of default ports until one
  works.</div>
<div class="Pp"></div>
SAMBA_DOMAIN (Optional1)
<div style="margin-left: 4.00ex;">The domain name to use on SAMBA_SERVER. The
  default is &quot;&quot;.</div>
<div class="Pp"></div>
The module-specific option SAMBA_SERVER must be given to provide the domain name
  of the host providing the NTLM authentication. The module-specific options
  SAMBA_DOMAIN and SAMBA_PORT, which are optional, can be used to override the
  default port(s) used by Samba to contact SAMBA_SERVER.
<div class="Pp"></div>
The following illustrates how this module might be configured:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;Auth id=&quot;ntlm&quot;&gt;
  URL &quot;https://example.com/cgi-bin/dacs/local_ntlm_authenticate&quot;
  STYLE &quot;pass&quot;
  CONTROL &quot;sufficient&quot;
  OPTION 'SAMBA_SERVER=&quot;10.0.0.123&quot;'
  OPTION 'SAMBA_PORT=&quot;139&quot;'
&lt;/Auth&gt;
</pre>
</div>
<div class="Pp"></div>
Here, <b>dacs_authenticate</b> will invoke the NTLM authentication module at the
  given URL. That module will try to authenticate the username and password
  given to it by asking the NTLM service at port 139 on the Windows system at
  10.0.0.213.
<div class="Pp"></div>
There are no directives specific to this module.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
Attacks against some versions of NTLM <b>have been identified</b>[144].
  Communication between this module and the NTLM service should use a secure
  channel or at least not be snoopable.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;A built-in version of this module can
  be selected by using the URL local_ntlm_authenticate or just ntlm.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Before attempting to use this module,
  it may save a lot of time and aggravation if you first check that it is
  possible to authenticate against NTLM, <i>from the machine on which you intend
  to run this module</i>, using a username/password combination that you know is
  correct. If you are not able to successfully authenticate in this way,
  obviously you will not have any luck with the <b>DACS</b> module.
<div style="height: 1.00em;">&#x00A0;</div>
To test whether it is possible to authenticate using a particular username and
  password, you may be able to use <b>smbclient(1)</b>[145]. For example, if
  C:\Shared is a network shared folder or HPLaserJ-PS is a shared printer on the
  Windows machine on which you want to perform authentication, to authenticate
  as the Administrator try something like:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% smbclient //mywinhost/shared -U Administrator
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
or to authenticate as the user bob, try:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% smbclient //mywinhost/HPLaserJ-PS -U bob
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Replace <i>mywinhost</i> with the name of your Windows machine. You should be
  prompted for the account's password. If <b>smbclient</b> successfully connects
  and establishes a session using the username and password you provide, then
  this module should also be able to authenticate that user, otherwise you
  should see an error message.
<div style="height: 1.00em;">&#x00A0;</div>
Before you have configured <b>DACS</b>, you can test NTLM authentication from
  the command line using <b>dacsauth(1)</b>[6]. For example, try something like:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% dacsauth -m ntlm passwd suff -OSAMBA_SERVER=&quot;windows.example.com&quot; -prompt -u bob
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Change &quot;bob&quot; to the username you want to authenticate and
  &quot;windows.example.com&quot; to the domain name of the Windows machine
  where the user's account is. You may also need to specify <i>SAMBA_PORT</i> if
  a non-standard port is being used. You will be prompted for the password for
  the user's account The program's exit status indicates success (&quot;ok&quot;
  is exit status 0) or failure (exit status 1). Repeat this with an invalid
  password to make sure that it fails.
<div style="height: 1.00em;">&#x00A0;</div>
After you have configured <b>DACS</b>, there is another method of testing
  <b>local_ntlm_authenticate</b> from the command line. Set the environment
  variable <b>QUERY_STRING</b> (using your preferred shell's syntax) to
  something like this:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% export QUERY_STRING=&quot;USERNAME=bob&amp;PASSWORD=test&amp;DACS_JURISDICTION=Test\
&amp;SAMBA_SERVER=windows.example.com&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Change &quot;bob&quot; to the username you want to authenticate,
  &quot;test&quot; to the password for that username, &quot;Test&quot; to the
  name of the <b>DACS</b> jurisdiction that will perform the authentication, and
  &quot;windows.example.com&quot; to the domain name of the Windows machine
  where the user's account is. You may also need to specify <i>SAMBA_PORT</i>.
  Then from the distribution's src directory:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% ./local_ntlm_auth -uj Test
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Use the <b>-u</b>, <b>-uj</b>, or <b>-us</b> flag to specify a jurisdiction that
  you have configured (see <b>dacs(1)</b>[146]). The output, an XML document,
  indicates success (&quot;ok&quot;, exit status 0) or failure
  (&quot;failed&quot;, exit status 1). Repeat this with an invalid password to
  make sure that it fails. When you are done, remember to delete the
  <b>QUERY_STRING</b> environment variable.</div>
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>local_pam_authenticate</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
This module makes a local or remote Pluggable Authentication Modules (PAM)
  infrastructure available for authentication. PAM authenticates a user that is
  known to the PAM-capable operating system (i.e., a user with an existing
  account) through one or more PAM authentication service modules that have been
  configured by the system administrator. Other PAM operations, such as password
  management, are currently unsupported by <b>DACS</b>. Please refer to
  <b>X/Open Single Sign-On Service (XSSO) -- Pluggable Authentication</b>[53]
  for additional information about PAM.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Notes</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;The PAM-based infrastructure described
  here was mainly developed to allow a system's PAM authentication services to
  be used for <b>DACS</b> web-based authentication. See src/pamd.c for
  architectural details.
<div style="height: 1.00em;">&#x00A0;</div>
Although a prototype has been developed, no &quot;native&quot; PAM
  authentication module for <b>DACS</b> is distributed. Such a module might be
  used to provide Unix services with <b>DACS</b> authentication and access
  control functionality, conceptually allowing <b>dacsauth(1)</b>[6] or
  <b>dacscheck(1)</b>[147] to be used by them. For instance, configuration for
  <b>ftp</b> authentication that normally uses <b>pam_unix.so</b> might be
  replaced by a reference to the module, leveraging any password style of
  <b>DACS</b> authentication, such as <b>local_ldap_authenticate</b>[49].</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;By default, the <b>pamd</b> server
  uses &quot;dacs&quot; as the name of the PAM service policy (see
  <b>pam_start(3)</b>[148]). Some systems may revert to a default policy (such
  as &quot;other&quot;) if no &quot;dacs&quot; policy is defined. A policy name
  can be specified as a <b>pamd</b> argument.</div>
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
There is a huge selection of open source and vendor-supplied PAM authentication
  modules for a wide variety of platforms, including some that provide
  functionality similar to that of <b>DACS</b> authentication modules [
  <b>GNU/Linux</b>[149], <b>FreeBSD</b>[150], <b>macOS</b>[151]]. For example,
  <b>pam_unix(8)</b>[152] performs essentially the same authentication function
  as <b>local_unix_authenticate</b>[153], except that the latter is not
  interactive (it does not prompt).
<div class="Pp"></div>
The STYLE should be configured as prompted for this module.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
While this authentication module has been tested with only a few PAM
  authentication service modules, in theory it should work with any conformant
  PAM authentication module. If this module is used, the current implementation
  does not allow any other authentication modules to be configured for the
  jurisdiction; this can be partially ameliorated by configuring PAM to try
  multiple PAM modules (yes, writing &quot;PAM modules&quot; might be incorrect
  in the same way that &quot; <b>ATM</b>[154] machine&quot; is).
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Important</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The <b>local_pam_authenticate</b> module depends on functionality provided by
  <b>pamd(8)</b>[155] running on a PAM-capable system, which does not need to be
  the same host where <b>local_pam_authenticate</b> is run. The
  <b>local_pam_authenticate</b> module establishes connections with <b>pamd</b>,
  which interacts with the <b>pam(3)</b>[52] library. Unlike the other
  <b>DACS</b> authentication styles, authentication using the prompted style may
  involve more than one request to <b>dacs_authenticate</b>, each of which
  supplies additional authentication material.
<div class="Pp"></div>
The prompted authentication style implements a <i>session</i> between the user
  and the PAM library that consists of a sequence of operations that comprise a
  PAM <i>transaction</i>. For each operation, <b>dacs_authenticate</b> (via
  <b>local_pam_authenticate</b> and <b>pamd</b>) supplies the PAM library with
  authentication material (either initial data or data requested by the PAM
  library from the previous operation), determines if authentication has
  succeeded or failed, or whether the user must be prompted for additional data.
  If the PAM library requires additional data, the user is prompted for it, and
  the response is submitted to <b>dacs_authenticate</b> in the transaction's
  next operation.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
If PAM requires information from the user, <b>local_pam_authenticate</b> can be
  configured to prompt for it using one of three methods. The first method is
  used if the Auth clause has an OPTION directive that configures
  PAM_HANDLER_URL; the user will be redirected to this URL. The other
  possibilities are selected by the <i>FORMAT</i> argument (see
  <b>dacs.services(8)</b>[81]). If any XML type is specified, the reply from
  <b>dacs_authenticate</b> will conform to the DTD
  <b>dacs_auth_reply.dtd</b>[82]. If HTML is specified and PAM authentication
  requires additional information from the user, <b>dacs_authenticate</b> will
  return a rudimentary HTML form that must be completed and submitted by the
  user. For example, if <b>pam_unix</b> is configured, <b>dacs_authenticate</b>
  may emit a web page that prompts for a username (if none was provided with the
  initial invocation of <b>dacs_authenticate</b>), and after that form has been
  submitted by the user emit a web page that prompts for a password.
<div class="Pp"></div>
If PAM_HANDLER_URL is configured, the handler to which the administrator
  redirects users has complete control over user prompting. In most
  implementations, the handler will emit a web page that includes a form
  element, with appropriate inputs and hidden variables, which is submitted to
  the web service named in the <i>service</i> argument (see below). The handler
  is required to obtain values for a set of requested variables and submit them
  to a given URL ( <b>dacs_authenticate</b>). Each variable has a type, an
  optional descriptive text label, and a name. The value of PAM_HANDLER_URL may
  either be an absolute URL or a web service name, beginning with a '/', that is
  interpreted relative to the current jurisdiction (i.e., the
  <b>dacs_url</b>[156] is prepended). Query arguments may be included, provided
  none of the argument names used by <b>dacs_authenticate</b>, described below,
  are duplicated.
<div class="Pp"></div>
The <b>pamd</b> server requires the handler to respond within <b>60</b> seconds
  (configured at compile time). The <b>local_pam_authenticate</b> module
  requires <b>pamd</b> to respond to the initial request with the first prompt
  within <b>20</b> seconds (configured at compile time). Should the handler
  encounter a serious error, it can simply terminate; this will cause
  <b>pamd</b> to eventually time out, which will abort the PAM transaction.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The handler does not have to be <b>DACS</b>-wrapped, but ideally it should be.
  If it is, don't forget to add an access control rule to grant access to any
  user that might authenticate through <b>local_pam_authenticate</b>.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
This &quot;prompter&quot; service might be configured as follows:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
OPTION &quot;PAM_HANDLER_URL=/dacs_pam_handler&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
This will be expanded into a URL that looks something like
  https://example.com/cgi-bin/dacs/dacs_pam_handler. When a user is redirected
  to this handler, <b>dacs_authenticate</b> adds the following query arguments:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<i>service</i>: This is the URL of the
  <b>dacs_authenticate</b> service to which the handler must submit the
  requested values. This URL will not include any query arguments. Because
  private information, such as a password, may be present, it will typically use
  the https scheme. The handler should use the POST method to invoke
  <i>service</i>.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<i>CSS_PATH</i>: This is the path
  configured for HTML stylesheets.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<i>AUTH_TRANSID</i>: This is the
  unique transaction identifier for this PAM interaction. As part of a single
  authentication transaction, the handler may be called several times with the
  same <i>AUTH_TRANSID</i>. The handler is not required to retain state between
  these calls, but it may do so. The handler must pass this argument when
  calling <i>service</i>. Although the lifetime of this identifier is relatively
  brief, it should be kept private by the handler.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<i>auth_prompt_var_prefix</i>: Each
  requested value will be identified by an argument to <i>service</i> having
  this prefix, with a positive integer ( <i>int</i>, which is assigned
  consecutive integers starting with <b>1</b>) appended. For instance, if
  <i>auth_prompt_var_prefix</i> is &quot;AUTH_PROMPT_VAR&quot;, then the handler
  must submit the requested values as <i>AUTH_PROMPT_VAR1</i>,
  <i>AUTH_PROMPT_VAR2</i>, and so on. The first absent <i>int</i> value signals
  the end of the variable argument list.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<i>TYPE</i><i></i><i>int</i>: This is
  the type (&quot;text&quot;, &quot;password&quot;, or &quot;error&quot;) of the
  variable numbered <i>int</i>. The password type indicates the value should not
  be displayed during user input.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<i>LABEL</i><i></i><i>int</i>: This
  argument, which is optional, indicates a label that might be displayed beside
  the user prompt (e.g., &quot;Username?&quot;) for variable <i>int</i>.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<i>NAME</i><i></i><i>int</i>: If this
  argument is not present for a given <i>int</i>, then no value is required for
  this variable - presumably <i>LABEL</i><i></i><i>int</i> is informational. If
  <i>NAME</i><i></i><i>int</i> is present, it gives the name of the variable to
  use when the handler submits the value. For example, suppose the handler is
  called with arguments <i>TYPE2</i> as &quot;text&quot;, <i>LABEL2</i> as
  &quot;Login:&quot;, and <i>NAME2</i> as &quot;AUTH_PROMPT_VAR2&quot;. This
  asks the handler to prompt for text input labeled &quot;Login:&quot;. If the
  user submits the value &quot;Auggie&quot;, then included with the arguments to
  <i>service</i> there should be a variable named <i>AUTH_PROMPT_VAR2</i> with
  the value &quot;Auggie&quot;.</div>
<div style="height: 1.00em;">&#x00A0;</div>
Any other arguments to the handler should be forwarded to <i>service</i>
  verbatim. Such arguments include <i>DACS_VERSION</i>,
  <i>DACS_JURISDICTION</i>, <i>DACS_BROWSER</i>, and
  <i>ENABLE_AUTH_HANDLERS</i>.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
For testing purposes, it may be helpful to set PAM_HANDLER_URL to
  <b>dacs_prenv</b>, which will display the arguments passed to the handler and
  other context. The <b>DACS</b> distribution includes an example handler,
  html/handlers/dacs_pam_handler.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
If an HTML form is emitted, its appearance can be customized somewhat through
  the default stylesheet <b>local_pam_authenticate.css</b>[157]. The content of
  the generated web page can be customized through the local_pam_authenticate
  VFS item type. The following items relative to that item type are emitted if
  they exist:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;header: Initial HTML to emit instead
  of the default.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;prologue: HTML to emit immediately
  after the header.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;instructions: HTML to emit immediately
  after the prologue and before the form.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;form: Additional HTML to emit within
  the form.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;epilogue: HTML to emit immediately
  after the form.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;trailer: Final HTML to emit instead of
  the default.</div>
<div style="height: 1.00em;">&#x00A0;</div>
For example, consider the configuration directive:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
VFS &quot;[local_pam_authenticate]dacs-fs:${Conf::DACS_HOME}/pam_auth&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Here, pam_auth is the directory ${Conf::DACS_HOME}/pam_auth. If files named
  header and trailer exist in that directory, they are expected to contain the
  initial and final HTML content, respectively. These files consist of text and
  HTML markup but are not complete HTML documents.
<div class="Pp"></div>
Customization of the HTML form is possible using configuration variables:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<i>prompt_submit_label</i>: the text
  label to put in the form's submit button.</div>
<div style="height: 1.00em;">&#x00A0;</div>
For example, the submit button's text can be specified using the directive:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
EVAL ${Conf::prompt_submit_label} = &quot; Continue &quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
A built-in version of this module can be selected by using the URL
  local_pam_authenticate or just pam.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>local_passwd_authenticate</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
The <b>local_passwd_authenticate</b> module provides support for <b>DACS</b>
  identities, strictly private to <b>DACS</b>, through password-protected
  accounts (similar to what <b>Apache</b>'s <b></b><b>mod_auth</b>[86] and
  <b></b> <b>mod_auth_dbm</b>[88] modules do, along with the
  <b>htpasswd(1)</b>[89] utility). A secure hash of a password is stored rather
  than the plaintext password itself. Several hashing methods are available (see
  <b>PASSWORD_DIGEST</b>[158]).
<div class="Pp"></div>
The <b>local_passwd_authenticate</b> module performs authentication by
  consulting the <i>USERNAME</i> and <i>PASSWORD</i> parameters and comparing
  them to the information previously stored by the administrator.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
This module always requires the <i>PASSWORD</i> argument and will not accept the
  empty string as a password value (even if that actually is the password). Use
  <b>local_simple_authenticate</b>[67] for password-less accounts.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
The STYLE should be configured as password for this module.
<div class="Pp"></div>
The <b>dacspasswd(1)</b>[159] utility is used to manage these accounts. The item
  type is &quot;passwds&quot;.
<div class="Pp"></div>
The following example configuration, which reflects typical usage, maintains
  user and password information in a plain text file named
  /usr/local/dacs/federations/passwd.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
VFS &quot;[passwds]dacs-kwv-fs:/usr/local/dacs/federations/passwd&quot;
</pre>
</div>
<div class="Pp"></div>
There are no directives or options specific to this module.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The name &quot;local_passwd_authenticate&quot; may be a little confusing because
  there are other modules that implement some form of password-based
  authentication. This module might more appropriately be called
  &quot;local_dacspasswd_authenticate&quot;.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
A built-in version of this module can be selected by using the URL
  local_passwd_authenticate or just passwd.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>local_simple_authenticate</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
The <b>local_simple_authenticate</b> module supports <b>DACS</b> identities,
  strictly private to <b>DACS</b>, through accounts that are <i>not</i>
  password-protected. The <b>local_simple_authenticate</b> module performs
  authentication by looking up an account named by the <i>USERNAME</i> argument.
  In typical use, the username will be an email address, account or membership
  number, or random character string.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
This form of authentication is <i>inherently insecure</i> because no password is
  provided. It is only appropriate when the consequences of a valid account name
  being guessed or misappropriated are of little concern, such as for restricted
  guest accounts. Administrators should not assume that using difficult-to-guess
  account names with this module offers much security. Keep in mind that
  depending on the larger context of how these identities are used, these
  usernames may be publicly visible.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
The STYLE should be configured as simple for this module.
<div class="Pp"></div>
The <b>dacspasswd(1)</b>[159] utility is used to manage these accounts. The item
  type is &quot;simple&quot;.
<div class="Pp"></div>
The following example configuration, which reflects typical usage, maintains
  user account information in a plain text file named
  /usr/local/dacs/federations/simple_accounts.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
VFS &quot;[simple]dacs-kwv-fs:/usr/local/dacs/federations/simple_accounts&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
Although it is possible to combine password-protected accounts and password-less
  accounts in the same VFS object (i.e., with the item types passwds and simple
  pointing to the same file or database), putting them in separate objects is
  recommended.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
There are no directives or options specific to this module.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
A built-in version of this module can be selected by using the URL
  local_simple_authenticate or just simple.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>local_tgma_authenticate</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<i>Experimental</i>. The <b>local_tgma_authenticate</b> module, together with a
  TGMA server and client <i>validator</i> software, implements strong,
  interactive mutual authentication without the user having to input a password.
  The <b>local_tgma_authenticate</b> module supports <b>DACS</b> identities that
  are strictly private to <b>DACS</b>.
<div class="Pp"></div>
The user begins the authentication procedure by using a simple sign-on page to
  submit an identity ( <i>USERNAME</i> and <i>JURISDICTION</i>). A password is
  not normally required. A special web-based utility returns a new web page to
  the user that displays instructions and another form that the user must submit
  when she is ready to complete the procedure. Next, and within a configurable
  window of time, the user must prove his ownership of the identity by executing
  a secure validation protocol. The validation protocol is conducted from a
  device, such as a smart phone or tablet, which runs the custom validator app
  and has been configured with account information for the user's identity at
  the jurisdiction.
<div class="Pp"></div>
This authentication module sends an authentication request message to a TGMA
  server. The TGMA server executes an authentication protocol with a user's
  <i>validator</i> and returns the result to the module. The TGMA server is a
  light-weight daemon that may serve one or more jurisdictions. The mutual
  authentication protocol, based on Secure Remote Password authentication (
  <b>RFC 2945</b>[160], <b>RFC 5054</b>[161]), verifies the user's identity
  using account information available to the module, TGMA server, and the
  validator. The user's validator confirms the identity of the TGMA server, and
  indirectly, the jurisdiction. Communication between the TGMA server and the
  module may use TCP, SSL, or UDP, depending on configuration. Likewise,
  communication between the TGMA server and a validator may also use TCP, SSL,
  or UDP. Choice of the networking protocol will depend on security,
  performance, and connectivity dependencies. An instance of the TGMA server
  must have network connectivity with both users' validator devices and
  instances of this authentication module. In a larger organization it will
  likely run on a firewall or DMZ-located server.
<div class="Pp"></div>
The STYLE should be configured as tgma for this module.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>local_token_authenticate</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
This module works in concert with the <b>dacstoken(1)</b>[162] utility to
  support one-time passwords. Two-factor authentication, a strong authentication
  method, is supported by combining hardware token-based one-time passwords
  (&quot;something you have&quot;) with a PIN (a password, &quot;something you
  know&quot;). Software-based clients may also be used. The implementation
  follows <b>RFC 4226</b>[163], which has been adopted by <b>OATH</b>[164], and
  other standards. Please refer to <b>dacstoken(1)</b>[162] for complete
  details.
<div class="Pp"></div>
The STYLE should be configured as password for this module.
<div class="Pp"></div>
In addition to the usual <i>USERNAME</i> argument, the module requires the
  <i>PASSWORD</i> argument to be the next one-time password (e.g., the value
  produced by the user's hardware token). If the user's <b>DACS</b> account has
  a PIN associated with it, the PIN must be passed as the <i>AUXILIARY</i>
  argument. The PIN referred to here is the one managed by <b>dacstoken</b>, not
  a PIN that may be entered into the token device to unlock it.
<div class="Pp"></div>
One-time password generation depends on a secret that is shared between the
  client and <b>DACS</b>, and a non-repeating value that may be based on
  synchronized counters or clocks. The client's token can become unsynchronized
  with the server's state. This can happen for many reasons, such as if a
  password is generated by the device but not used, if a password or PIN is
  typed incorrectly, or because of a configuration error. The method can
  tolerate a configurable deviation of the client's token from the server's
  state; that is, provided the client's password falls within a window of
  <i>N</i> from the one expected by <b>DACS</b>, <b>DACS</b> will accept the
  client's token. For counter-based tokens, only the &quot;forward&quot; side of
  the window is examined, so <b>DACS</b> can &quot;catch up&quot; to the client.
<div class="Pp"></div>
If the user's password does not fall within the window, it is deemed to have
  become unsynchronized with <b>local_token_authenticate</b> and authentication
  will fail. The user can attempt to resynchronize by entering a sequence of
  passwords as <i>PASSWORD</i>, using a comma to separate them. Three
  consecutive, valid passwords are required (this number can be configured at
  build time). If the account has a PIN, it must be provided to enable
  synchronization. If synchronization succeeds, the user's account information
  is corrected and the module also reports successful authentication. If
  synchronization fails, the module also fails and a <b>DACS</b> administrator
  must be contacted to resynchronize the token.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The token value must be entered exactly as it is displayed on the token. Leading
  zeroes must be typed, for example, and no spaces or punctuation are allowed.
  Whenever authentication fails, the user must obtain a new password from the
  token.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
The following OPTION directive value is understood:
<div class="Pp"></div>
ACCEPT_WINDOW (Optional1)
<div style="margin-left: 4.00ex;">The (non-negative) size of the acceptance
  window for one-time passwords, overriding the default. If the size is zero,
  <b>DACS</b> will only consider a match with the expected password and will not
  try to match the user's password against &quot;nearby&quot; passwords. With
  some modes of operation, only forward matches are allowed.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
A built-in version of this module can be selected by using the URL
  local_token_authenticate or just token.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>local_unix_authenticate</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
The <b>local_unix_authenticate</b> module implements native Unix
  username/password authentication, allowing a user having a pre-existing Unix
  account to be authenticated by <b>DACS</b> using the username and password for
  that account. Normally, the user's hashed password is compared to the string
  obtained by hashing the <i>PASSWORD</i> argument. But because some platforms
  do not make stored passwords available to applications (most notably macOS), a
  second algorithm can be used; if it is enabled and the <b>pam(3)</b>[165]
  library is available, a simple PAM policy is used to validate the plaintext
  password provided.
<div class="Pp"></div>
In the password comparison algorithm, the <b>getpwnam(3)</b>[166] library
  function is passed the <i>USERNAME</i> parameter given to
  <b>dacs_authenticate</b>. It can be configured for systems with or without
  shadow passwords. On some Unix systems, when the <b>yp(8)</b>[167] password
  database is enabled, the <b>getpwnam(3)</b>[166] function will use the YP map
  &quot;passwd.byname&quot; if the requested password entry is not found in the
  local database. If the account information is obtained, the <i>PASSWORD</i>
  parameter is validated.
<div class="Pp"></div>
In the PAM-based algorithm, the <i>USERNAME</i> and <i>PASSWORD</i> parameters
  given to <b>dacs_authenticate</b> are passed to the PAM module (e.g.,
  <b>pam_unix(8)</b>[152]) that has been configured by an administrator. This
  method is separate and much simpler than what is provided by
  <b>local_pam_authenticate</b>[39]. To help protect against misconfiguration,
  any unexpected behaviour by PAM will cause authentication to fail. For
  example, the password prompt string produced by PAM must match
  &quot;Password:&quot;, ignoring trailing spaces; currently, this default can
  only be changed at compile time.
<div class="Pp"></div>
The STYLE should be configured as password for this module.
<div class="Pp"></div>
The following OPTION directive values are understood:
<div class="Pp"></div>
PAM_SERVICE (Optional1)
<div style="margin-left: 4.00ex;">This is the name of the PAM <i>service
  policy</i> to use. If unspecified, a compile-time default
  (DEFAULT_PAM_SERVICE, set to &quot;dacs-unix-auth&quot;) is used. The name of
  the service policy will usually identify a file (for instance,
  /etc/pam.d/dacs-unix-auth) that might simply contain something like:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
auth        required    pam_unix.so     no_warn
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
An existing policy file may be available or it may be necessary to create one.
  On macOS, for example, /etc/pam.d/chkpasswd contains the following entry,
  which is sufficient for password validation:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
auth       required       pam_opendirectory.so
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
To use that file with this module, the following <b>DACS</b> configuration
  directive would be placed in the appropriate Auth clause:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
OPTION &quot;PAM_SERVICE=chkpasswd&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
See <b>pam_start(3)</b>[148] and <b>pam.conf(5)</b>[168].
<div style="height: 1.00em;">&#x00A0;</div>
Depending on the operating system, PAM modules might be found in /usr/lib,
  /usr/lib/pam, or /lib/security.
<div style="height: 1.00em;">&#x00A0;</div>
It is possible to configure the PAM service policy to use a password-based
  &quot;auth&quot; facility other than the Unix password module, but do so with
  care.</div>
<div class="Pp"></div>
USE_PAM (Optional1)
<div style="margin-left: 4.00ex;">If &quot;yes&quot; or &quot;on&quot;, only use
  the PAM-based algorithm, if &quot;no&quot; or &quot;off&quot;, do not use the
  PAM-based algorithm, and if &quot;both&quot;, &quot;try&quot;, or unspecified,
  use the PAM-based method only if the password comparison algorithm is
  unavailable. These string values are case insensitive.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
A built-in version of this module can be selected by using the URL
  local_unix_authenticate or just unix. If the built-in version is used,
  <b>dacs_authenticate</b> must be setuid root, and if the web-based version is
  used, <b>local_unix_authenticate</b> must be setuid root, so that the shadow
  password file can be read and/or the PAM module used. Authentication using
  this module will fail if it does not execute with sufficient priviledges.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
On platforms where encrypted passwords are unavailable, such as macOS,
  authentication will always fail unless the PAM-based algorithm is available
  and enabled.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<h2 class="Ss" title="Ss" id="Roles"><a class="selflink" href="#Roles">Roles</a></h2>
Each user authenticated by <b>DACS</b> may be associated with one or more roles.
  The <b>syntax of roles and role descriptors</b>[14] is described elsewhere.
  Role-based group membership is discussed in <b>dacs.groups(5)</b>[169].
  Configuration of a Roles clause is optional and if none are specified, an
  empty role descriptor string will be used. If more than one Roles clause is
  configured, their role strings are concatenated (duplicates are not removed).
  If a roles service fails, it is treated as if it returned no roles and
  processing continues normally.
<div class="Pp"></div>
Like authentication, a modular mechanism is used to find the roles with which a
  user is associated. A roles module, analogous to an authentication module, can
  be called by <b>dacs_authenticate</b> to return roles. A roles service returns
  a roles_reply element (see <b>roles_reply.dtd</b>[170]).
<div class="Pp"></div>
Each Roles element must have an id attribute. Its value is merely a label (an
  alphabetic followed by zero or more alphanumerics, hyphens, and underscores)
  that allows the clause to be referenced. The id attribute values must be
  unique (case-sensitively) within the clause's Jurisdiction section.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
A maximum limit is imposed on the length of a role descriptor string. Please
  refer to the <b>ROLE_STRING_MAX_LENGTH</b>[171] directive.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<h2 class="Ss" title="Ss" id="Roles_Clause_Directives"><a class="selflink" href="#Roles_Clause_Directives">Roles
  Clause Directives</a></h2>
The roles directives are largely analogous to the authentication directives.
<div class="Pp"></div>
When evaluation of the Roles clauses begins, several variables are available in
  the Auth namespace to reflect the outcome of authentication. These variables
  may be useful when determining the user's roles: <i>DACS_USERNAME</i>,
  <i>DACS_IDENTITY</i>, <i>DACS_JURISDICTION</i>, and <i>DACS_VERSION</i>.
<div class="Pp"></div>
<b>Roles Clause Directives Index:</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 1.EXIT* (Optional1)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 2.EXPR (Optional1)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 3.INIT* (Optional1)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 4.OPTION (Optional)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 5.OPTION* (Optional)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 6.PREDICATE (Optional1)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 7.URL (Optional1)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 8.URL* (Optional1)</div>
<div class="Pp"></div>
URL (Optional1)
<div>&#x00A0;</div>
URL* (Optional1)
<div style="margin-left: 4.00ex;">Exactly one of these two directives must be
  specified, unless EXPR is specified, in which case neither URL nor URL* may be
  specified. These directives specify the URL to be used to invoke the roles
  module (or is the name of a built-in module). The difference between the two
  directives is that the value of URL* is an expression that is evaluated to
  determine the URL to be used; this evaluation occurs immediately before the
  module is invoked.</div>
<div class="Pp"></div>
INIT* (Optional1)
<div style="margin-left: 4.00ex;">An expression can be specified that is to be
  evaluated immediately prior to the URL* and EXPR expressions, all of which are
  evaluated before a module is invoked.</div>
<div class="Pp"></div>
EXIT* (Optional1)
<div style="margin-left: 4.00ex;">If authentication is successful, this
  expression is evaluated immediately after the module is executed or EXPR
  evaluated.</div>
<div class="Pp"></div>
EXPR (Optional1)
<div style="margin-left: 4.00ex;">This directive gives an expression that is
  evaluated to obtain roles instead of invoking a roles module. Please refer to
  Advanced Techniques.</div>
<div class="Pp"></div>
OPTION (Optional)
<div style="margin-left: 4.00ex;">Similar to the Auth clause's <b>OPTION</b>[50]
  directive, this is used to pass an argument to the roles module. A given
  <i>name</i> may not be specified more than once within a particular Roles
  clause. The Options namespace is initialized with <i>DACS_USERNAME</i>,
  <i>DACS_JURISDICTION</i>, and <i>DACS_VERSION</i> variables. If these are
  specified by an OPTION, the argument ordinarily used will be overridden.
<div style="height: 1.00em;">&#x00A0;</div>
For example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
OPTION &quot;PASSWORD=bobo&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
causes PASSWORD=bobo to be passed as a POST method parameter.</div>
<div class="Pp"></div>
OPTION* (Optional)
<div style="margin-left: 4.00ex;">The given expression is evaluated before the
  module is called, and after all OPTION directives and all OPTION* directives
  that appear earlier. The value of the expression must be a
  <i>name</i>=<i>value</i> pair, as with the OPTION directive, and overrides any
  <i>name</i> in the Options namespace.</div>
<div class="Pp"></div>
PREDICATE (Optional1)
<div style="margin-left: 4.00ex;">If provided, this expression is evaluated
  before any other roles module processing is done. If there is an evaluation
  error or it returns <b>False</b> (zero or the empty string), processing of the
  clause terminates and the next Roles clause, if any, is processed. Otherwise,
  processing of the clause continues normally.</div>
<h2 class="Ss" title="Ss" id="Roles_Clause_Control_Flow"><a class="selflink" href="#Roles_Clause_Control_Flow">Roles
  Clause Control Flow</a></h2>
If authentication succeeds, Roles clauses are processed in which they appear,
  but only if <b>set_roles</b>[70] has not been specified for some
  authentication module's STYLE.
<div class="Pp"></div>
A Roles clause is processed in a sequence of steps, and with various hooks to
  provide fine-grained control. Before the first clause is examined, the
  variables <i>${Auth::CURRENT_ROLES}</i> and <i>${Auth::LAST_ROLES}</i> are
  initialized to the role string, if any, obtained during authentication module
  processing. Processing of each Roles clause proceeds as follows:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 1.If the clause has a PREDICATE directive, it
  is evaluated in the current context. If the value is not <b>True</b> the
  clause is not evaluated further. No variables are updated. If the expression
  was invalid, processing of roles is terminated.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 2.If the clause has an INIT* directive, it is
  evaluated; if an error occurs, processing of roles is terminated.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 3.If the clause has a URL* directive, it is
  evaluated to obtain the URL of the <b>DACS</b> roles service to be invoked; if
  an error occurs, processing of roles is terminated. If the clause has an EXPR*
  directive, it is evaluated to obtain the role string; if an error occurs
  during evaluation it is treated as if the expression returned the empty
  string.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 4.If a roles service has been specified, it
  is invoked. If an error occurs, roles processing <i>continues as if the module
  returned the empty string for the role string</i>.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 5.The variable <i>${Auth::LAST_ROLES}</i> is
  set to the roles string returned by the module or expression.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 6.If the clause has an EXIT* directive, it is
  evaluated; if an error occurs, processing of roles is terminated. The value of
  <i>${Auth::LAST_ROLES}</i> becomes the role string returned by the
  clause.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 7.The role string returned by the clause is
  appended to the variable <i>${Auth::CURRENT_ROLES}</i>.</div>
<div class="Pp"></div>
The value of <i>${Auth::CURRENT_ROLES}</i> when the last module has been
  processed is the roles string that will be used in the generated credentials.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
Some roles modules are available as built-in components of
  <b>dacs_authenticate</b>. These modules are identified by specific relative
  URLs; a module's description will provide its built-in name when this
  capability is available. The built-in capability will automatically be
  provided if the module has been enabled at build-time. The same applies for
  <b>dacsauth</b>.
<div class="Pp"></div>
Although it will be more efficient (and possibly more secure) to use a built-in
  module, they are executed on the same host as <b>dacs_authenticate</b>
  (thereby giving up some flexibility), access control rules are not applied to
  them (other than the one for <b>dacs_authenticate</b>), and
  <b>dacs_authenticate</b> may need to be executed setuid (probably as root) or
  setgid (as www, for example) so that it can access password files.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<h2 class="Ss" title="Ss" id="Roles_Modules"><a class="selflink" href="#Roles_Modules">Roles
  Modules</a></h2>
If and only if authentication succeeds, <b>DACS</b> can request the user's role
  descriptor from the jurisdiction. Roles modules are always invoked using the
  POST method and are passed the following arguments:
<div class="Pp"></div>
<i>DACS_USERNAME</i>
<div style="margin-left: 4.00ex;">The <i>username</i> component of the user's
  <b>DACS</b> identity.</div>
<div class="Pp"></div>
<i>DACS_JURISDICTION</i>
<div style="margin-left: 4.00ex;">The name of the jurisdiction that
  authenticated <i>DACS_USERNAME</i>.</div>
<div class="Pp"></div>
<i>DACS_VERSION</i>
<div style="margin-left: 4.00ex;">The DACS_VERSION_NUMBER for this version of
  <b>dacs_authenticate</b>.</div>
<div class="Pp"></div>
OPTION directives
<div style="margin-left: 4.00ex;">For each <b>OPTION directive</b>[172] or
  <b>OPTION* directive</b>[173] in the Roles section being processed, the
  variable name and its value are passed.</div>
Any of the standard web service arguments will also be accepted; anything else
  will be ignored.
<div class="Pp"></div>
Roles modules return an <b>roles_reply.dtd</b>[170] document to
  <b>dacs_authenticate</b>.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
Although there is a roles module for obtaining LDAP or ADS roles, you may also
  get them by authenticating through <b>local_ldap_authenticate</b>[49] or by
  using a Roles clause with an appropriate EXPR directive.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
<b>Roles Module Index:</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 1.local_roles: Private <b>DACS</b>
  roles</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 2.local_ldap_roles: Roles imported from an
  LDAP/ADS directory</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 3.local_unix_roles: Roles imported from Unix
  group membership</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>local_roles</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
This roles service consults a private list to obtain a username-to-roles mapping
  using <b>DACS</b> virtual storage (the item type is &quot;roles&quot;). The
  following example configuration, which reflects typical usage, maintains
  mappings in a plain text file named /usr/local/dacs/federations/roles.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
VFS &quot;[roles]dacs-kwv-fs:/usr/local/dacs/federations/roles&quot;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
The file /usr/local/dacs/federations/roles might look something like this:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
admin:dacs,admin
rick:metalogic,guests
bobo:staff,users
auggie:staff,users
</pre>
</div>
<div class="Pp"></div>
Here, user auggie is associated with the roles staff and users.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
A built-in version of this module can be selected by using the URL local_roles
  or just roles.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>local_ldap_roles</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
This roles service returns roles derived from the attributes of a user's
  LDAP/ADS directory entry. This module is based on
  <b>local_ldap_authenticate</b>[49]; please consult the description and
  examples presented with that authentication module for additional information.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The user need not have been authenticated by LDAP/ADS for this module to be
  used. For example, the user can be authenticated on a Unix system but his
  roles can come from LDAP/ADS.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
The following configuration directives are recognized by this module. They
  function identically to the directives of the same name used by
  <b>local_ldap_authenticate</b>[49], so for the most part their descriptions
  will not be repeated here.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
These module directives must be passed using either <b>OPTION</b>[172] or
  <b>OPTION*</b>[173] directives. Ensure that the option value is properly
  quoted.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
LDAP_BIND_METHOD (Required1-C)
<div style="margin-left: 4.00ex;">This tells the module how to find the user's
  entry in the directory.</div>
<div class="Pp"></div>
LDAP_USERNAME_URL (Optional1)
<div>&#x00A0;</div>
LDAP_USERNAME_URL* (Optional1)
<div style="margin-left: 4.00ex;">With the direct method, one of these options
  is used to name the user's entry as a URI.</div>
<div class="Pp"></div>
LDAP_ADMIN_URL (Required1-C)
<div style="margin-left: 4.00ex;">If the indirect method is used, this option is
  required. This value is a URI like LDAP_USERNAME_URL except that it identifies
  the LDAP administrator within the directory.</div>
<div class="Pp"></div>
LDAP_ADMIN_PASSWORD (Optional1)
<div style="margin-left: 4.00ex;">This is the password for the LDAP
  administrator account that corresponds to LDAP_ADMIN_URL.</div>
<div class="Pp"></div>
LDAP_SEARCH_ROOT_DN (Required1-C)
<div style="margin-left: 4.00ex;">This is the root DN at which the indirect
  method should begin searching for user entries.</div>
<div class="Pp"></div>
LDAP_SEARCH_FILTER (Required1-C)
<div>&#x00A0;</div>
LDAP_SEARCH_FILTER* (Required1-C)
<div style="margin-left: 4.00ex;">If the indirect method is used, either this
  option or LDAP_SEARCH_FILTER* (but not both) must be configured. This search
  filter is used to select the unique directory entry that corresponds to this
  user. The LDAP_SEARCH_FILTER* option is exactly like LDAP_SEARCH_FILTER except
  that it is evaluated just before it is used, allowing various elements of the
  execution context to appear in the string. The <b>DACS</b> username obtained
  from the preceding authentication phase can be referenced as
  <i>${Args::DACS_USERNAME}</i>.</div>
<div class="Pp"></div>
LDAP_USERNAME_EXPR* (Optional1)
<div style="margin-left: 4.00ex;">This option is evaluated to yield a username
  that can be referenced by the LDAP_ROLES_SELECTOR* option as
  <i>${LDAP::USERNAME}</i>.</div>
<div class="Pp"></div>
LDAP_ROLES_SELECTOR* (Optional)
<div style="margin-left: 4.00ex;">Each occurrence of this directive specifies an
  expression that is evaluated by iterating through each attribute of the entry
  and making the attribute name ( <i>${LDAP::attrname}</i>) and its value
  (<i>${LDAP::attrvalue}</i>) available. All of the entry's attribute names and
  values are made available within the LDAP namespace. If the result of the
  expression is a valid role string (which excludes the empty string,
  &quot;&quot;), it is added to the list of roles.</div>
<div class="Pp"></div>
LDAP_TIMEOUT_SECS (Optional1)
<div style="margin-left: 4.00ex;">This is a maximum time limit, in seconds, for
  any individual LDAP read or search operation performed by the module. If not
  specified, there will not be an application-specified time limit.</div>
<div class="Pp"></div>
Here is an example that binds to the directory on x.example.com as the
  administrator, searches for the entry for the account of the authenticated
  user, and assigns the user a role from the attribute value of each memberOf
  attribute in the entry:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;Roles id=&quot;ldap_roles&quot;&gt;
URL &quot;http://example.com/cgi-bin/dacs/local_ldap_roles&quot;
OPTION &quot;LDAP_BIND_METHOD=indirect&quot;
OPTION \
'LDAP_ADMIN_URL=&quot;ldap://x.example.com/CN=Administrator,CN=Users,DC=example,DC=com&quot;'
OPTION 'LDAP_ADMIN_PASSWORD=&quot;secretpassword&quot;'
<div class="Pp"></div>
OPTION 'LDAP_SEARCH_ROOT_DN=&quot;cn=Users,dc=example,dc=com&quot;'
OPTION 'LDAP_SEARCH_FILTER*=\'&quot;(sAMAccountName=${Args::DACS_USERNAME})&quot;\''
<div class="Pp"></div>
OPTION 'LDAP_ROLES_SELECTOR*=\'&quot;${LDAP::attrname}&quot; eq &quot;memberOf&quot; \
    ? strtr(ldap(rdn_attrvalue, \
        ldap(dn_index, &quot;${LDAP::attrvalue}&quot;, 1)), &quot; &quot;, &quot;_&quot;) \
    : &quot;&quot;\''
&lt;/Roles&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
For example, the resulting role string might look like:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
DnsAdmins,Print_Operators,Domain_Admins,Administrators
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>local_unix_roles</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
This roles service returns the Unix group membership associated with an
  authenticated username; that it, the resulting list of roles is the same as
  would be obtained if the user ran the Unix <b>groups(1)</b>[174].
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
The user need not have been authenticated as this username on the Unix system
  where this service is run.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div class="Pp"></div>
A built-in version of this module can be selected by using the URL
  local_unix_roles or just unix.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<h2 class="Ss" title="Ss" id="Related_Services"><a class="selflink" href="#Related_Services">Related
  Services</a></h2>
The <b>dacs_current_credentials(8)</b>[35] web service displays elements of each
  set of credentials sent with the request. The <b>dacs_signout(8)</b>[175]
  service is typically called from a browser to cause one or more cookies (each
  representing a <b>DACS</b> identity) to be deleted. Cookies are automatically
  deleted when a browser terminates, but it is sometimes useful to explicitly
  logoff.
<h1 class="Sh" title="Sh" id="DIAGNOSTICS"><a class="selflink" href="#DIAGNOSTICS">DIAGNOSTICS</a></h1>
The program exits 0 if everything was fine, 1 if an error occurred.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
A separate but similar mechanism called &quot;affiliated <b>DACS</b>
  federations&quot; supports cross-federation single sign-on; see
  <b>dacs_auth_transfer(8)</b>[8].
<div class="Pp"></div>
<b>dacs_authenticate</b> could be modified to temporarily disable an account
  after some number of unsuccessful login attempts over a certain time period.
  The flip side of such a feature is that it could be used in a denial of
  service attack. Rather than disabling an account, a designated administrator
  might receive an email notification or a console message might be logged.
<div class="Pp"></div>
It might be worthwhile to include a rule-based mechanism, called after the user
  has been identified but before credentials are returned, to decide whether
  authentication should be permitted. This might be used, for example, to
  restrict a particular user to login from a specified IP address or range of
  addresses, or limit the time of day at which login is allowed.
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
It would be nice to provide assistance to programs that generate login pages.
  Composing modules should be easier, to make multi-factor authentication more
  accessible.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>dacsauth(1)</b>[6], <b>dacscred(1)</b>[176], <b>dacscookie(1)</b>[9],
  <b>dacs.exprs(5)</b>[3], <b>dacs_autologin_ssl(8)</b>[177],
  <b>autologin(8)</b>[139], <b>dacs_auth_agent(8)</b>[7],
  <b>dacs_auth_transfer(8)</b>[8], <b>dacs_current_credentials(8)</b>[35],
  <b>dacs_select_credentials(8)</b>[46], <b>dacs_signout(8)</b>[175],
  <b>pamd(8)</b>[155]
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Distributed Systems Software ( <b>www.dss.ca</b>[178])
<h1 class="Sh" title="Sh" id="COPYING"><a class="selflink" href="#COPYING">COPYING</a></h1>
Copyright2003-2016 Distributed Systems Software. See the <b>LICENSE</b>[179]
  file that accompanies the distribution for licensing information.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"> 1.</dt>
  <dd class="It-tag">dacsoptions</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.1.html#dacsoptions</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 2.</dt>
  <dd class="It-tag">dacs.conf(5)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 3.</dt>
  <dd class="It-tag">dacs.exprs(5)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.exprs.5.html</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 4.</dt>
  <dd class="It-tag">html/examples</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man//examples</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 5.</dt>
  <dd class="It-tag">HTTP Authentication</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_acs.8.html#http_authentication</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 6.</dt>
  <dd class="It-tag">dacsauth(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacsauth.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 7.</dt>
  <dd class="It-tag">dacs_auth_agent(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_auth_agent.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 8.</dt>
  <dd class="It-tag">dacs_auth_transfer(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_auth_transfer.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 9.</dt>
  <dd class="It-tag">dacscookie(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacscookie.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">10.</dt>
  <dd class="It-tag">Auth clause</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#auth_clause</div>
<dl class="Bl-tag">
  <dt class="It-tag">11.</dt>
  <dd class="It-tag">CONTROL</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#CONTROL</div>
<dl class="Bl-tag">
  <dt class="It-tag">12.</dt>
  <dd class="It-tag">username</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.1.html#dacs_identity</div>
<dl class="Bl-tag">
  <dt class="It-tag">13.</dt>
  <dd class="It-tag">dacs.acls(5)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.acls.5.html#revocation_list</div>
<dl class="Bl-tag">
  <dt class="It-tag">14.</dt>
  <dd class="It-tag">dacs(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.1.html#naming</div>
<dl class="Bl-tag">
  <dt class="It-tag">15.</dt>
  <dd class="It-tag">credentials.dtd</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/../dtd-xsd/credentials.dtd</div>
<dl class="Bl-tag">
  <dt class="It-tag">16.</dt>
  <dd class="It-tag">VERIFY_IP</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#VERIFY_IP</div>
<dl class="Bl-tag">
  <dt class="It-tag">17.</dt>
  <dd class="It-tag">natd(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.freebsd.org/cgi/man.cgi?query=natd&amp;apropos=0&amp;sektion=8&amp;manpath=FreeBSD+10.1-RELEASE&amp;format=html</div>
<dl class="Bl-tag">
  <dt class="It-tag">18.</dt>
  <dd class="It-tag">VERIFY_UA</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#VERIFY_UA</div>
<dl class="Bl-tag">
  <dt class="It-tag">19.</dt>
  <dd class="It-tag">AUTH_CREDENTIALS_DEFAULT_LIFETIME_SECS</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#AUTH_CREDENTIALS_DEFAULT_LIFETIME_SECS</div>
<dl class="Bl-tag">
  <dt class="It-tag">20.</dt>
  <dd class="It-tag">Advanced Encryption Standard</dd>
</dl>
<div style="margin-left: 4.00ex;">https://en.wikipedia.org/wiki/Advanced_Encryption_Standard</div>
<dl class="Bl-tag">
  <dt class="It-tag">21.</dt>
  <dd class="It-tag">Federal Information Processing Standard</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.nist.gov/itl/fips.cfhttp://www.nist.gov/itl/fips.cfm</div>
<dl class="Bl-tag">
  <dt class="It-tag">22.</dt>
  <dd class="It-tag">FIPS 198</dd>
</dl>
<div style="margin-left: 4.00ex;">http://csrc.nist.gov/publications/fips/fips198-1/FIPS-198-1_final.pdf</div>
<dl class="Bl-tag">
  <dt class="It-tag">23.</dt>
  <dd class="It-tag">RFC 2104</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc2104.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">24.</dt>
  <dd class="It-tag">RFC 4635</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc4635.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">25.</dt>
  <dd class="It-tag">RFC 4868</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc4868.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">26.</dt>
  <dd class="It-tag">NIST</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.nist.gov/</div>
<dl class="Bl-tag">
  <dt class="It-tag">27.</dt>
  <dd class="It-tag">FIPS 180-1</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.itl.nist.gov/fipspubs/fip180-1.htm</div>
<dl class="Bl-tag">
  <dt class="It-tag">28.</dt>
  <dd class="It-tag">RFC 4634</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc4634.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">29.</dt>
  <dd class="It-tag">RFC 6234</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc6234.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">30.</dt>
  <dd class="It-tag">FIPS 180-4</dd>
</dl>
<div style="margin-left: 4.00ex;">http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf</div>
<dl class="Bl-tag">
  <dt class="It-tag">31.</dt>
  <dd class="It-tag">MD5 algorithm</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc1321.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">32.</dt>
  <dd class="It-tag">Netscape HTTP Cookies Specification</dd>
</dl>
<div style="margin-left: 4.00ex;">http://web.archive.org/web/20070805052634/http://wp.netscape.com/newsref/std/cookie_spec.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">33.</dt>
  <dd class="It-tag"><i>COOKIE_SYNTAX</i></dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#COOKIE_SYNTAX</div>
<dl class="Bl-tag">
  <dt class="It-tag">34.</dt>
  <dd class="It-tag">COOKIE_NAME_TERMINATORS</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#COOKIE_NAME_TERMINATORS</div>
<dl class="Bl-tag">
  <dt class="It-tag">35.</dt>
  <dd class="It-tag">dacs_current_credentials(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_current_credentials.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">36.</dt>
  <dd class="It-tag">COOKIE_PATH</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#COOKIE_PATH</div>
<dl class="Bl-tag">
  <dt class="It-tag">37.</dt>
  <dd class="It-tag">SECURE_MODE</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#SECURE_MODE</div>
<dl class="Bl-tag">
  <dt class="It-tag">38.</dt>
  <dd class="It-tag">standard CGI arguments</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.services.8.html#standard_cgi_args</div>
<dl class="Bl-tag">
  <dt class="It-tag">39.</dt>
  <dd class="It-tag">local_pam_authenticate</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#local_pam_authenticate</div>
<dl class="Bl-tag">
  <dt class="It-tag">40.</dt>
  <dd class="It-tag">RFC 2109</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc2109.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">41.</dt>
  <dd class="It-tag">RFC 2965</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc2965.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">42.</dt>
  <dd class="It-tag">RFC 6265</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc6265.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">43.</dt>
  <dd class="It-tag">RFC 2616</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc2616.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">44.</dt>
  <dd class="It-tag">colons are used within cookie names</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#cookie-name-syntax</div>
<dl class="Bl-tag">
  <dt class="It-tag">45.</dt>
  <dd class="It-tag">dacs_acs(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_acs.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">46.</dt>
  <dd class="It-tag">dacs_select_credentials(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_select_credentials.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">47.</dt>
  <dd class="It-tag"><b>strtr()</b></dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.exprs.5.html#strtr</div>
<dl class="Bl-tag">
  <dt class="It-tag">48.</dt>
  <dd class="It-tag">LDAP_USERNAME_URL</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#LDAP_USERNAME_URL</div>
<dl class="Bl-tag">
  <dt class="It-tag">49.</dt>
  <dd class="It-tag">local_ldap_authenticate</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#local_ldap_authenticate</div>
<dl class="Bl-tag">
  <dt class="It-tag">50.</dt>
  <dd class="It-tag">OPTION</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#OPTION</div>
<dl class="Bl-tag">
  <dt class="It-tag">51.</dt>
  <dd class="It-tag">dacs.conf(5)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#auth_clause</div>
<dl class="Bl-tag">
  <dt class="It-tag">52.</dt>
  <dd class="It-tag">pam(3)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.freebsd.org/cgi/man.cgi?query=pam&amp;apropos=0&amp;sektion=0&amp;manpath=FreeBSD+10.1-RELEASE&amp;format=html</div>
<dl class="Bl-tag">
  <dt class="It-tag">53.</dt>
  <dd class="It-tag">X/Open Single Sign-On Service (XSSO) preliminary
      specification</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.opengroup.org/pubs/catalog/p702.htm</div>
<dl class="Bl-tag">
  <dt class="It-tag">54.</dt>
  <dd class="It-tag">dacs.conf(5)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#merging</div>
<dl class="Bl-tag">
  <dt class="It-tag">55.</dt>
  <dd class="It-tag">Authenticating Using an Expression</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#expr</div>
<dl class="Bl-tag">
  <dt class="It-tag">56.</dt>
  <dd class="It-tag">PASSWORD_CONSTRAINTS</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#PASSWORD_CONSTRAINTS</div>
<dl class="Bl-tag">
  <dt class="It-tag">57.</dt>
  <dd class="It-tag">LOG_FILTER</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#LOG_FILTER</div>
<dl class="Bl-tag">
  <dt class="It-tag">58.</dt>
  <dd class="It-tag">local_cas_authenticate</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#local_cas_authenticate</div>
<dl class="Bl-tag">
  <dt class="It-tag">59.</dt>
  <dd class="It-tag">Central Authentication Service (CAS)</dd>
</dl>
<div style="margin-left: 4.00ex;">https://en.wikipedia.org/wiki/Central_Authentication_Service</div>
<dl class="Bl-tag">
  <dt class="It-tag">60.</dt>
  <dd class="It-tag">RFC 2617</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc2617.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">61.</dt>
  <dd class="It-tag">local_apache_authenticate</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#local_apache_authenticate</div>
<dl class="Bl-tag">
  <dt class="It-tag">62.</dt>
  <dd class="It-tag">Information Card</dd>
</dl>
<div style="margin-left: 4.00ex;">http://en.wikipedia.org/wiki/Information_Card</div>
<dl class="Bl-tag">
  <dt class="It-tag">63.</dt>
  <dd class="It-tag">dacsinfocard(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacsinfocard.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">64.</dt>
  <dd class="It-tag">dacs_infocard(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_infocard.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">65.</dt>
  <dd class="It-tag">dacs_managed_infocard(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_managed_infocard.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">66.</dt>
  <dd class="It-tag">local_infocard_authenticate</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#local_infocard_authenticate</div>
<dl class="Bl-tag">
  <dt class="It-tag">67.</dt>
  <dd class="It-tag">local_simple_authenticate</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#local_simple_authenticate</div>
<dl class="Bl-tag">
  <dt class="It-tag">68.</dt>
  <dd class="It-tag">local_tgma_authenticate</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#local_tgma_authenticate</div>
<dl class="Bl-tag">
  <dt class="It-tag">69.</dt>
  <dd class="It-tag">add_roles</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#add_roles</div>
<dl class="Bl-tag">
  <dt class="It-tag">70.</dt>
  <dd class="It-tag">set_roles</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#set_roles</div>
<dl class="Bl-tag">
  <dt class="It-tag">71.</dt>
  <dd class="It-tag">dacs.exprs(5)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.exprs.5.html#variables</div>
<dl class="Bl-tag">
  <dt class="It-tag">72.</dt>
  <dd class="It-tag">AUTH_SUCCESS</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#AUTH_SUCCESS</div>
<dl class="Bl-tag">
  <dt class="It-tag">73.</dt>
  <dd class="It-tag">AUTH_SUCCESS_HANDLER</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#AUTH_SUCCESS_HANDLER</div>
<dl class="Bl-tag">
  <dt class="It-tag">74.</dt>
  <dd class="It-tag">AUTH_ERROR_HANDLER</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#AUTH_ERROR_HANDLER</div>
<dl class="Bl-tag">
  <dt class="It-tag">75.</dt>
  <dd class="It-tag">AUTH_FAIL_DELAY_SECS</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#AUTH_FAIL_DELAY_SECS</div>
<dl class="Bl-tag">
  <dt class="It-tag">76.</dt>
  <dd class="It-tag"><i>DACS_AUTH_SUCCESS_HANDLER</i></dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#DACS_AUTH_SUCCESS_HANDLER</div>
<dl class="Bl-tag">
  <dt class="It-tag">77.</dt>
  <dd class="It-tag"><i>ENABLE_AUTH_HANDLERS</i></dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#ENABLE_AUTH_HANDLERS</div>
<dl class="Bl-tag">
  <dt class="It-tag">78.</dt>
  <dd class="It-tag">dacs_prenv(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_prenv.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">79.</dt>
  <dd class="It-tag">Environment variables</dd>
</dl>
<div style="margin-left: 4.00ex;">http://httpd.apache.org/docs-2.2/mod/mod_ssl.html#envvars</div>
<dl class="Bl-tag">
  <dt class="It-tag">80.</dt>
  <dd class="It-tag">mod_ssl</dd>
</dl>
<div style="margin-left: 4.00ex;">http://httpd.apache.org/docs-2.2/mod/mod_ssl.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">81.</dt>
  <dd class="It-tag">dacs.services(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.services.8.html#FORMAT</div>
<dl class="Bl-tag">
  <dt class="It-tag">82.</dt>
  <dd class="It-tag">dacs_auth_reply.dtd</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/../dtd-xsd/dacs_auth_reply.dtd</div>
<dl class="Bl-tag">
  <dt class="It-tag">83.</dt>
  <dd class="It-tag">dacs_current_credentials.dtd</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/../dtd-xsd/dacs_current_credentials.dtd</div>
<dl class="Bl-tag">
  <dt class="It-tag">84.</dt>
  <dd class="It-tag">auth_reply.dtd</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/../dtd-xsd/auth_reply.dtd</div>
<dl class="Bl-tag">
  <dt class="It-tag">85.</dt>
  <dd class="It-tag">dacs.install(7)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man//man/dacs.install.7.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">86.</dt>
  <dd class="It-tag"><b>mod_auth</b></dd>
</dl>
<div style="margin-left: 4.00ex;">http://httpd.apache.org/docs-2.2/mod/mod_auth.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">87.</dt>
  <dd class="It-tag"><b>mod_auth_digest</b></dd>
</dl>
<div style="margin-left: 4.00ex;">http://httpd.apache.org/docs-2.2/mod/mod_auth_digest.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">88.</dt>
  <dd class="It-tag"><b>mod_auth_dbm</b></dd>
</dl>
<div style="margin-left: 4.00ex;">http://httpd.apache.org/docs-2.2/mod/mod_auth_dbm.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">89.</dt>
  <dd class="It-tag">htpasswd(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://httpd.apache.org/docs/2.2/programs/htpasswd.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">90.</dt>
  <dd class="It-tag">htdigest(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://httpd.apache.org/docs/2.2/programs/htdigest.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">91.</dt>
  <dd class="It-tag">htdbm(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://httpd.apache.org/docs/2.2/programs/htdbm.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">92.</dt>
  <dd class="It-tag">local_native_authenticate</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#local_native_authenticate</div>
<dl class="Bl-tag">
  <dt class="It-tag">93.</dt>
  <dd class="It-tag">Central Authentication Service (CAS)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.jasig.org/cas</div>
<dl class="Bl-tag">
  <dt class="It-tag">94.</dt>
  <dd class="It-tag">CAS 2.0 Protocol</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.jasig.org/cas/protocol</div>
<dl class="Bl-tag">
  <dt class="It-tag">95.</dt>
  <dd class="It-tag">OpenID</dd>
</dl>
<div style="margin-left: 4.00ex;">http://openid.net/</div>
<dl class="Bl-tag">
  <dt class="It-tag">96.</dt>
  <dd class="It-tag">STYLE</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#STYLE</div>
<dl class="Bl-tag">
  <dt class="It-tag">97.</dt>
  <dd class="It-tag">SSLVerifyClient</dd>
</dl>
<div style="margin-left: 4.00ex;">http://httpd.apache.org/docs-2.2/mod/mod_ssl.html#sslverifyclient</div>
<dl class="Bl-tag">
  <dt class="It-tag">98.</dt>
  <dd class="It-tag">SSLRequire</dd>
</dl>
<div style="margin-left: 4.00ex;">http://httpd.apache.org/docs-2.2/mod/mod_ssl.html#sslrequire</div>
<dl class="Bl-tag">
  <dt class="It-tag">99.</dt>
  <dd class="It-tag">OpenSSL</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.openssl.org</div>
<dl class="Bl-tag">
  <dt class="It-tag">00.</dt>
  <dd class="It-tag">SSLOptions</dd>
</dl>
<div style="margin-left: 4.00ex;">http://httpd.apache.org/docs-2.2/mod/mod_ssl.html#ssloptions</div>
<dl class="Bl-tag">
  <dt class="It-tag">01.</dt>
  <dd class="It-tag">dacsgrid(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacsgrid.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">02.</dt>
  <dd class="It-tag">Google</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.google.com</div>
<dl class="Bl-tag">
  <dt class="It-tag">03.</dt>
  <dd class="It-tag">account authentication</dd>
</dl>
<div style="margin-left: 4.00ex;">http://code.google.com/apis/accounts/AuthForInstalledApps.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">04.</dt>
  <dd class="It-tag">eBay</dd>
</dl>
<div style="margin-left: 4.00ex;">http://developer.ebay.com/developercenter/rest/</div>
<dl class="Bl-tag">
  <dt class="It-tag">05.</dt>
  <dd class="It-tag">Yahoo!</dd>
</dl>
<div style="margin-left: 4.00ex;">http://developer.yahoo.com/auth/</div>
<dl class="Bl-tag">
  <dt class="It-tag">06.</dt>
  <dd class="It-tag">announced</dd>
</dl>
<div style="margin-left: 4.00ex;">http://blogs.msdn.com/b/card/archive/2011/02/15/beyond-windows-cardspace.aspx</div>
<dl class="Bl-tag">
  <dt class="It-tag">07.</dt>
  <dd class="It-tag">CardSpace</dd>
</dl>
<div style="margin-left: 4.00ex;">http://en.wikipedia.org/wiki/Windows_CardSpace</div>
<dl class="Bl-tag">
  <dt class="It-tag">08.</dt>
  <dd class="It-tag">Windows 8</dd>
</dl>
<div style="margin-left: 4.00ex;">http://en.wikipedia.org/wiki/List_of_features_removed_in_Windows_8</div>
<dl class="Bl-tag">
  <dt class="It-tag">09.</dt>
  <dd class="It-tag">On the Demise of CardSpace</dd>
</dl>
<div style="margin-left: 4.00ex;">http://upon2020.com/blog/2011/03/on-the-demise-of-cardspace/</div>
<dl class="Bl-tag">
  <dt class="It-tag">10.</dt>
  <dd class="It-tag">Open Cardspace opportunity</dd>
</dl>
<div style="margin-left: 4.00ex;">http://blogs.law.harvard.edu/doc/2011/02/16/open-cardspace-opportunity/</div>
<dl class="Bl-tag">
  <dt class="It-tag">11.</dt>
  <dd class="It-tag">Personal Reflections on the CardSpace Journey</dd>
</dl>
<div style="margin-left: 4.00ex;">http://self-issued.info/?p=458</div>
<dl class="Bl-tag">
  <dt class="It-tag">12.</dt>
  <dd class="It-tag">From CardSpace to Verified Claims</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.identityblog.com/?p=1164</div>
<dl class="Bl-tag">
  <dt class="It-tag">13.</dt>
  <dd class="It-tag">Change will come: the present is untenable</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.identityblog.com/?p=1165</div>
<dl class="Bl-tag">
  <dt class="It-tag">14.</dt>
  <dd class="It-tag">The Clay Feet of Giants?</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.identityblog.com/?p=1167</div>
<dl class="Bl-tag">
  <dt class="It-tag">15.</dt>
  <dd class="It-tag">RIP, Windows CardSpace. Hello, U-Prove</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.zdnet.com/blog/microsoft/rip-windows-cardspace-hello-u-prove/8717</div>
<dl class="Bl-tag">
  <dt class="It-tag">16.</dt>
  <dd class="It-tag">U-Prove</dd>
</dl>
<div style="margin-left: 4.00ex;">http://research.microsoft.com/en-us/projects/u-prove/</div>
<dl class="Bl-tag">
  <dt class="It-tag">17.</dt>
  <dd class="It-tag">Identity Selector Interoperability Profile (ISIP) 1.5</dd>
</dl>
<div style="margin-left: 4.00ex;">http://download.microsoft.com/download/1/1/a/11ac6505-e4c0-4e05-987c-6f1d31855cd2/Identity_Selector_Interoperability_Profile_V1.5.pdf</div>
<dl class="Bl-tag">
  <dt class="It-tag">18.</dt>
  <dd class="It-tag">role descriptor string</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.1.html#roles</div>
<dl class="Bl-tag">
  <dt class="It-tag">19.</dt>
  <dd class="It-tag">dacs_infocard(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_infocard.8.html#about_claims</div>
<dl class="Bl-tag">
  <dt class="It-tag">20.</dt>
  <dd class="It-tag">expression-based authentication style</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man//man/dacs_authenticate.8.html#expr</div>
<dl class="Bl-tag">
  <dt class="It-tag">21.</dt>
  <dd class="It-tag">dacs_managed_infocard(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man//man/dacs_managed_infocard.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">22.</dt>
  <dd class="It-tag">dacs.conf(5)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man//man/dacs.conf.5.html#INFOCARD_prefixed</div>
<dl class="Bl-tag">
  <dt class="It-tag">23.</dt>
  <dd class="It-tag">dacs_mex(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man//man/dacs_mex.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">24.</dt>
  <dd class="It-tag">dacs_sts(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man//man/dacs_sts.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">25.</dt>
  <dd class="It-tag">Using InfoCards With DACS</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/using-infocards-with-dacs.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">26.</dt>
  <dd class="It-tag"><i>Identity Selector Interoperability Profile specification
      and companion guides</i></dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.microsoft.com/downloads/details.aspx?FamilyID=b94817fc-3991-4dd0-8e85-b73e626f6764&amp;DisplayLang=en</div>
<dl class="Bl-tag">
  <dt class="It-tag">27.</dt>
  <dd class="It-tag"><i>Introducing Windows CardSpace</i></dd>
</dl>
<div style="margin-left: 4.00ex;">http://msdn.microsoft.com/en-us/library/aa480189.aspx</div>
<dl class="Bl-tag">
  <dt class="It-tag">28.</dt>
  <dd class="It-tag">RFC 2251</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.faqs.org/rfcs/rfc2251.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">29.</dt>
  <dd class="It-tag">RFC 2252</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.faqs.org/rfcs/rfc2252.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">30.</dt>
  <dd class="It-tag">RFC 2253</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.faqs.org/rfcs/rfc2253.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">31.</dt>
  <dd class="It-tag">RFC 3377</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.faqs.org/rfcs/rfc3377.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">32.</dt>
  <dd class="It-tag">Active Directory (ADS)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.microsoft.com/windows2000/technologies/directory/ad/default.asp</div>
<dl class="Bl-tag">
  <dt class="It-tag">33.</dt>
  <dd class="It-tag">OpenLDAP</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.openldap.org</div>
<dl class="Bl-tag">
  <dt class="It-tag">34.</dt>
  <dd class="It-tag">ldap()</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.exprs.5.html#ldap</div>
<dl class="Bl-tag">
  <dt class="It-tag">35.</dt>
  <dd class="It-tag">LDAP_USERNAME_URL*</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#LDAP_USERNAME_URL*</div>
<dl class="Bl-tag">
  <dt class="It-tag">36.</dt>
  <dd class="It-tag">RFC 2396</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.faqs.org/rfcs/rfc2396.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">37.</dt>
  <dd class="It-tag">RFC 3986</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc3986.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">38.</dt>
  <dd class="It-tag">ldapsearch(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.openldap.org/software/man.cgi?query=ldapsearch&amp;apropos=0&amp;sektion=0&amp;manpath=OpenLDAP+2.4-Release&amp;format=html</div>
<dl class="Bl-tag">
  <dt class="It-tag">39.</dt>
  <dd class="It-tag">autologin(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/autologin.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">40.</dt>
  <dd class="It-tag">1</dd>
</dl>
<div style="margin-left: 4.00ex;">http://curl.haxx.se/rfc/ntlm.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">41.</dt>
  <dd class="It-tag">2</dd>
</dl>
<div style="margin-left: 4.00ex;">http://msdn.microsoft.com/en-us/library/cc236621%28PROT.10%29.aspx</div>
<dl class="Bl-tag">
  <dt class="It-tag">42.</dt>
  <dd class="It-tag">Samba</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.samba.org</div>
<dl class="Bl-tag">
  <dt class="It-tag">43.</dt>
  <dd class="It-tag">NTLM authentication</dd>
</dl>
<div style="margin-left: 4.00ex;">https://en.wikipedia.org/wiki/NTLM</div>
<dl class="Bl-tag">
  <dt class="It-tag">44.</dt>
  <dd class="It-tag">have been identified</dd>
</dl>
<div style="margin-left: 4.00ex;">http://support.microsoft.com/kb/2793313</div>
<dl class="Bl-tag">
  <dt class="It-tag">45.</dt>
  <dd class="It-tag">smbclient(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.samba.org/samba/docs/man/manpages-3/smbclient.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">46.</dt>
  <dd class="It-tag">dacs(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">47.</dt>
  <dd class="It-tag">dacscheck(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacscheck.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">48.</dt>
  <dd class="It-tag">pam_start(3)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.freebsd.org/cgi/man.cgi?query=pam_start&amp;apropos=0&amp;sektion=3&amp;manpath=FreeBSD+10.1-RELEASE&amp;format=html</div>
<dl class="Bl-tag">
  <dt class="It-tag">49.</dt>
  <dd class="It-tag">GNU/Linux</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.kernel.org/pub/linux/libs/pam/modules.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">50.</dt>
  <dd class="It-tag">FreeBSD</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.freebsd.org/doc/en_US.ISO8859-1/articles/pam/pam-freebsd-modules.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">51.</dt>
  <dd class="It-tag">macOS</dd>
</dl>
<div style="margin-left: 4.00ex;">https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man3/pam.3.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">52.</dt>
  <dd class="It-tag">pam_unix(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.freebsd.org/cgi/man.cgi?query=pam_unix&amp;apropos=0&amp;sektion=8&amp;manpath=FreeBSD+10.1-RELEASE&amp;format=html</div>
<dl class="Bl-tag">
  <dt class="It-tag">53.</dt>
  <dd class="It-tag">local_unix_authenticate</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#local_unix_authenticate</div>
<dl class="Bl-tag">
  <dt class="It-tag">54.</dt>
  <dd class="It-tag">ATM</dd>
</dl>
<div style="margin-left: 4.00ex;">https://en.wikipedia.org/wiki/Cash_machine</div>
<dl class="Bl-tag">
  <dt class="It-tag">55.</dt>
  <dd class="It-tag">pamd(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/pamd.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">56.</dt>
  <dd class="It-tag">dacs_url</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.groups.5.html#group_syntax</div>
<dl class="Bl-tag">
  <dt class="It-tag">57.</dt>
  <dd class="It-tag">local_pam_authenticate.css</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man//css/local_pam_authenticate.css</div>
<dl class="Bl-tag">
  <dt class="It-tag">58.</dt>
  <dd class="It-tag">PASSWORD_DIGEST</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#PASSWORD_DIGEST</div>
<dl class="Bl-tag">
  <dt class="It-tag">59.</dt>
  <dd class="It-tag">dacspasswd(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacspasswd.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">60.</dt>
  <dd class="It-tag">RFC 2945</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc2945.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">61.</dt>
  <dd class="It-tag">RFC 5054</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc5054.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">62.</dt>
  <dd class="It-tag">dacstoken(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacstoken.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">63.</dt>
  <dd class="It-tag">RFC 4226</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.rfc-editor.org/rfc/rfc4226.txt</div>
<dl class="Bl-tag">
  <dt class="It-tag">64.</dt>
  <dd class="It-tag">OATH</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.openauthentication.org</div>
<dl class="Bl-tag">
  <dt class="It-tag">65.</dt>
  <dd class="It-tag">pam(3)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.freebsd.org/cgi/man.cgi?query=pam&amp;apropos=0&amp;sekti
  on=0&amp;manpath=FreeBSD+10.1-RELEASE&amp;format=html</div>
<dl class="Bl-tag">
  <dt class="It-tag">66.</dt>
  <dd class="It-tag">getpwnam(3)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.freebsd.org/cgi/man.cgi?query=getpwnam&amp;apropos=0&amp;sektion=3&amp;manpath=FreeBSD+10.1-RELEASE&amp;format=html</div>
<dl class="Bl-tag">
  <dt class="It-tag">67.</dt>
  <dd class="It-tag">yp(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.freebsd.org/cgi/man.cgi?query=yp&amp;apropos=0&amp;sektion=8&amp;manpath=FreeBSD+10.1-RELEASE&amp;format=html</div>
<dl class="Bl-tag">
  <dt class="It-tag">68.</dt>
  <dd class="It-tag">pam.conf(5)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.freebsd.org/cgi/man.cgi?query=pam.conf&amp;apropos=0&amp;sektion=5&amp;manpath=FreeBSD+10.1-RELEASE&amp;format=html</div>
<dl class="Bl-tag">
  <dt class="It-tag">69.</dt>
  <dd class="It-tag">dacs.groups(5)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.groups.5.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">70.</dt>
  <dd class="It-tag">roles_reply.dtd</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/../dtd-xsd/roles_reply.dtd</div>
<dl class="Bl-tag">
  <dt class="It-tag">71.</dt>
  <dd class="It-tag">ROLE_STRING_MAX_LENGTH</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.conf.5.html#ROLE_STRING_MAX_LENGTH</div>
<dl class="Bl-tag">
  <dt class="It-tag">72.</dt>
  <dd class="It-tag">OPTION directive</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#r_OPTION</div>
<dl class="Bl-tag">
  <dt class="It-tag">73.</dt>
  <dd class="It-tag">OPTION* directive</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#r_OPTION*</div>
<dl class="Bl-tag">
  <dt class="It-tag">74.</dt>
  <dd class="It-tag">groups(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.freebsd.org/cgi/man.cgi?query=groups&amp;apropos=0&amp;sektion=1&amp;manpath=FreeBSD+10.1-RELEASE&amp;format=html</div>
<dl class="Bl-tag">
  <dt class="It-tag">75.</dt>
  <dd class="It-tag">dacs_signout(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_signout.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">76.</dt>
  <dd class="It-tag">dacscred(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacscred.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">77.</dt>
  <dd class="It-tag">dacs_autologin_ssl(8)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs_autologin_ssl.8.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">78.</dt>
  <dd class="It-tag">www.dss.ca</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.dss.ca</div>
<dl class="Bl-tag">
  <dt class="It-tag">79.</dt>
  <dd class="It-tag">LICENSE</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/../misc/LICENSE</div>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">01/12/2017</td>
    <td class="foot-os">DACS 1.4.38a</td>
  </tr>
</table>
</body>
</html>
