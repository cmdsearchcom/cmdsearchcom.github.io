<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:08:40 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>ARPALERT(8) arp traffic monitoring ARPALERT(8)</p>

<p style="margin-top: 1em">NAME <br>
arpalert - ARP traffic monitoring</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Arpalert uses ARP protocol monitoring to prevent
unauthorized connections on the local network. If an illegal
connection is detected, a program or script could be
launched, <br>
which could be used to send an alert message, for
example.</p>

<p style="margin-top: 1em">COMMAND LINE <br>
-f config_file <br>
Specify the config file.</p>

<p style="margin-top: 1em">-i interface <br>
Comma separated network interfaces listen to.</p>

<p style="margin-top: 1em">-p pid_file <br>
Use this pid file. this file containis a pid number of the
arpalert session. If the file exist and his locked, the
daemon do not run.</p>

<p style="margin-top: 1em">-e exec_script <br>
Script launched when an alert is send.</p>

<p style="margin-top: 1em">-D log_level <br>
The level logged. The levels are between 0 (emergency) and 7
(debug). If 3 is selected all levels bitween 0 and 3 are
logged.</p>

<p style="margin-top: 1em">-l leases_file <br>
This file contain a dump of the mac address in memory (see
config file).</p>

<p style="margin-top: 1em">-m module file <br>
Specify a module file to load</p>

<p style="margin-top: 1em">-d Run as daemon.</p>

<p style="margin-top: 1em">-F Run in foreground.</p>

<p style="margin-top: 1em">-v Watch on screen all the
option selected (the options specified in config file and
the default options)</p>

<p style="margin-top: 1em">-h The help command line.</p>

<p style="margin-top: 1em">-w Debug option: print a dump of
packets captured.</p>

<p style="margin-top: 1em">-P Set the interface in
promiscuous mode (don&rsquo;t set this if only the arp
analyse is used).</p>

<p style="margin-top: 1em">-V Print version and quit.</p>

<p style="margin-top: 1em">CONFIGURATION FILE <br>
The config file contains 3 types of data: integer, string
and boolean. The boolean type can take values
&rsquo;oui&rsquo;, &rsquo;true&rsquo;, &rsquo;yes&rsquo;,
&rsquo;1&rsquo; for the true values or &rsquo;non&rsquo;,
&rsquo;no&rsquo;, &rsquo;false&rsquo;, &rsquo;0&rsquo; <br>
for the falses values.</p>

<p style="margin-top: 1em">user = arpalert <br>
Use privileges separation with this user</p>

<p style="margin-top: 1em">umask = 177 <br>
Uses this umask for file creation.</p>

<p style="margin-top: 1em">chroot dir =
/home/thierry/arp_test/ <br>
Use this directory for program jail <br>
If this option is commented out, the program does not use
chroot. <br>
The program read the config file and open the syslog socket
before the chroot: <br>
The kill -HUP does not work with chroot. <br>
If the syslog program is restarted, the socket change and
the arpalert syslog system can&rsquo;t be connect to the new
socket: the logs with syslog are disabled. Prefere to use
<br>
the log file. <br>
The file pathes are relative to the chroot dir (except the
config file)</p>

<p style="margin-top: 1em">log file = /var/log/arpalert.log
<br>
The program log into this file <br>
If this option is commented out, the internal system log is
not used. <br>
The internal system logs can be used in same time that
syslog.</p>

<p style="margin-top: 1em">log level = 6 <br>
The level logged. The levels are between 0 (emergency) and 7
(debug). If 3 is selected all levels between 0 and 3 are
logged.</p>

<p style="margin-top: 1em">use syslog = true <br>
If this option is false, the syslog system is disabled</p>

<p style="margin-top: 1em">maclist file =
/etc/arpalert/maclist.allow <br>
White list</p>

<p style="margin-top: 1em">maclist alert file =
/etc/arpalert/maclist.deny <br>
Black list</p>

<p style="margin-top: 1em">maclist leases file =
/var/lib/arpalert/arpalert.leases <br>
Dump file</p>

<p style="margin-top: 1em">dump inter = 5 <br>
Minimun time to wait between two leases dump</p>

<p style="margin-top: 1em">auth request file =
/etc/arpalert/authrq.conf <br>
List of authorized request</p>

<p style="margin-top: 1em">lock file =
/var/run/arpalert.pid <br>
pid file</p>

<p style="margin-top: 1em">dump packet = false <br>
Only for debugging: this dump packet received on standard
output. The syntax &quot;dump paquet&quot; is also
avalaible, but is deprecated</p>

<p style="margin-top: 1em">daemon = false <br>
If is set to true, run the program as daemon</p>

<p style="margin-top: 1em">interface = &quot;&quot; <br>
Comma separated network interfaces leisten to. If this value
is not specified, the soft select the first interface.</p>

<p style="margin-top: 1em">catch only arp = TRUE <br>
Configure the network for catch only arp request. The
detection type &quot;new_mac&quot; is deactived. This mode
is used for CPU saving if Arpalert is running on a
router</p>

<p style="margin-top: 1em">mod on detect = &quot;&quot;
<br>
Module file loaded by arpalert. This module is launched on
each valid alert. This system avoids a costly fork/exec</p>

<p style="margin-top: 1em">mod config = &quot;&quot; <br>
This chain is transferred to the init function of module
loaded</p>

<p style="margin-top: 1em">action on detect = &quot;&quot;
<br>
Script launched on each detection. Parameters are: <br>
- mac address of requestor, <br>
- ip of requestor, <br>
- supp. parm., <br>
- ethernet device listening on <br>
- type of alert, <br>
- optional: ethernet vendor</p>

<p style="margin-top: 1em">type of alert: <br>
0: IP change <br>
1: Mac address already detected but not in white list <br>
2: Mac address in black list <br>
3: New mac address <br>
4: Unauthorized arp request <br>
5: Abusive number of arp request detected <br>
6: Ethernet mac address different from arp mac address <br>
7: Flood detected <br>
8: New mac address whithout ip address</p>

<p style="margin-top: 1em">execution timeout = 10 <br>
Script execution timeout (seconds)</p>

<p style="margin-top: 1em">max alert = 20 <br>
Maximun simultaneous lanched script</p>

<p style="margin-top: 1em">dump black list = false <br>
Dump the black listed mac address in leases file</p>

<p style="margin-top: 1em">dump white list = false <br>
Dump the white listed mac address in leases file</p>

<p style="margin-top: 1em">dump new address = true <br>
Dump the new mac address in leases file</p>

<p style="margin-top: 1em">mac timeout = 259200 <br>
After this time a mac address is removed from memory
(seconds) (default 1 month)</p>

<p style="margin-top: 1em">max entry = 1000000 <br>
After this limit the memory hash is cleaned (protect to arp
flood)</p>

<p style="margin-top: 1em">anti flood interval = 10 <br>
This sends only one mismatch alert in this time (in
seconds)</p>

<p style="margin-top: 1em">anti flood global = 50 <br>
If the number of arp request in seconds exceeds this value,
all alerts are ignored for &quot;anti flood interval&quot;
time</p>

<p style="margin-top: 1em">mac vendor file = &quot;&quot;
<br>
This file contain the association from mac address to vendor
name. This file can be downloaded here:
http://standards.ieee.org/regauth/oui/oui.txt</p>

<p style="margin-top: 1em">log mac vendor = false <br>
Log vendor name</p>

<p style="margin-top: 1em">alert mac vendor = false <br>
Give vendor name to script</p>

<p style="margin-top: 1em">mod mac vendor = false <br>
Give vendor name to module</p>

<p style="margin-top: 1em">log referenced address, alert on
referenced address, mod on referenced address = false <br>
Log/launch script/call module if the address is referenced
in hash but is not in white list</p>

<p style="margin-top: 1em">log deny address, alert on deny
address, mod on deny address = true <br>
Log/launch script/call module if the mac address is in black
list</p>

<p style="margin-top: 1em">log new address, alert on new
address, mod on new address = true <br>
Log/launch script/call module if the address isn&rsquo;t
referenced</p>

<p style="margin-top: 1em">log mac change, alert on mac
change, mod on mac change = true <br>
Log/launch script/call module if the mac address is
different from the last arp request with the same ip
address</p>

<p style="margin-top: 1em">log ip change, alert on ip
change, mod on ip change = true <br>
Log/launch script/call module if the ip address is different
from the last arp request with the same mac address</p>

<p style="margin-top: 1em">log unauth request, alert on
unauth request, mod on unauth request = true <br>
Unauthorized arp request: launch if the request is not
authorized in auth file</p>

<p style="margin-top: 1em">ignore unknown sender = true
<br>
Don&rsquo;t analyse arp request for unknow hosts (not in
white list)</p>

<p style="margin-top: 1em">ignore self test = true <br>
Ignore ARP self test generated by windows dhcp for
unauthorized request detection</p>

<p style="margin-top: 1em">ignore me = true <br>
Ignore arp request with mac addresse of the listing
interfaces for the authorizations checks</p>

<p style="margin-top: 1em">unauth ignore time method = 2
<br>
Select suspend time method: <br>
1: ignore all unauth alerts during &quot;anti flood
interval&quot; time <br>
2: ignore only tuple (mac address, ip address) during
&quot;anti flood interval&quot; time</p>

<p style="margin-top: 1em">log request abus, alert on
request abus, mod on request abus = true <br>
Log/launch script/call module if the number of request per
seconds are &gt; &quot;max request&quot;</p>

<p style="margin-top: 1em">max request = 1000000 <br>
Maximun request authorized by second</p>

<p style="margin-top: 1em">log mac error, alert on mac
error, mod on mac error = true <br>
Log/launch script/call module if the ethernet mac address is
different than the arp mac address (only for requestor)</p>

<p style="margin-top: 1em">log flood = true, alert on flood
= true, mod on flood = true <br>
Log/launch script/call module if have too many arp request
per seconds</p>

<p style="margin-top: 1em">log expire mac address = true,
alert on expire mac address = true, mod on expire mac
address = true <br>
Log/launch script/call module if the ethernet mac address
expire</p>

<p style="margin-top: 1em">expire authorized mac addresses
= true <br>
Allow authorized mac addresses to expire</p>

<p style="margin-top: 1em">DATA FILES FORMATS <br>
/etc/arpalert/maclist.allow and /etc/arpalert/maclist.deny:
<br>
All the line with # as a first caracter are ignored <br>
The data on this file take this form <br>
&lt;MAC_ADRESS&gt; &lt;IP_ADDRESS&gt; &lt;DEVICE&gt;
[&lt;FLAG&gt; &lt;FLAG&gt; &lt;FLAG&gt; ...] <br>
The available flags are: <br>
ip_change: Ignore ip change alert for this mac address <br>
black_listed: Ignore black list alerts for this mac address
<br>
unauth_rq: Ignore unauthorized requests for this mac address
<br>
rq_abus: Ignore request abuse for this mac address <br>
mac_error: Ignore mac error for this mac address <br>
mac_change: Ignore mac change for this mac address <br>
mac_expire: Never expire this mac address. Useful if the
option &quot;expire authorized mac addresses&quot; is
used</p>

<p style="margin-top: 1em">/etc/arpalert/authrq.conf: <br>
All the words after # character are ignored <br>
All the blank characters are ignored <br>
The authorisations list for one mac address begins by the
mac address into brackets <br>
All the next values are ip hosts addresses or ip networks
addresses (with /xx notion) <br>
[&lt;MAC_ADRESS&gt; &lt;DEVICE&gt;] &lt;IP_ADRESS&gt; <br>
&lt;IP_ADRESS&gt;/&lt;BITS&gt;</p>

<p style="margin-top: 1em">FILES <br>
sbin/arpalert: binary file <br>
etc/arpalert/arpalert.conf: default config file <br>
var/run/arpalert.pid: pid file <br>
var/state/arpalert.leases: leases file</p>

<p style="margin-top: 1em">2006-05-09 ARPALERT(8)</p>
<hr>
</body>
</html>
