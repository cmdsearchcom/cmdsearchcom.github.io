<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:14:02 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p style="margin-top: 1em">opadisableports(8) Master map:
IFSFFCLIRG (Man Page) opadisableports(8)</p>

<p style="margin-top: 1em">NAME <br>
opadisableports</p>

<p style="margin-top: 1em">(Linux) Accepts a CSV file
listing links to disable. For each HFI-SW link, the switch
side of the link is disabled. For each SW-SW link, the side
of the link with the lower LID <br>
(typically, the side closest to the SM) is disabled. This
approach generally permits a future opaenableports operation
to re-enable the port once the issue is corrected or ready
<br>
to be retested. When using the -R option, this tool does not
look at the routes, it disables the switch ports with the
lower value LID. The list of disabled ports is tracked in
<br>
/etc/sysconfig/opa/disabled*.csv.</p>

<p style="margin-top: 1em">Syntax <br>
opadisableports [-R] [-t portsfile] [-p ports] [ reason]
#8217lt; disable.csv</p>

<p style="margin-top: 1em">Options <br>
--help Produces full help text.</p>

<p style="margin-top: 1em">-R Does not attempt to get
routes for computation of distance. Instead, disables switch
port with lower LID assuming that it is closer to this
node.</p>

<p style="margin-top: 1em">-t portsfile <br>
File with list of local HFI ports used to access fabric(s)
for operation. Default is /etc/sysconfig/opa/ports.</p>

<p style="margin-top: 1em">-p ports List of local HFI ports
used to access fabric(s) for operation. Default is first
active port. The first HFI in the system is 1. The first
port on an HFI is 1.</p>

<p style="margin-top: 1em">NOTE: In this release, in
multi-rail fabrics, this script does not work as expected
when supplied with multiple egress ports. The script
processes the entire input file against <br>
the first egress port specified, leaving no data to be
applied against other egress ports. As a workaround, call
the script once for each egress port.</p>

<p style="margin-top: 1em">Uses the format hfi:port :</p>

<p style="margin-top: 1em">0:0 First active port in
system.</p>

<p style="margin-top: 1em">0:y Port y within system.</p>

<p style="margin-top: 1em">x:0 First active port on HFI
x.</p>

<p style="margin-top: 1em">x:y HFI x, port y.</p>

<p style="margin-top: 1em">reason Optional text describing
why ports are being disabled. If used, text is saved in the
reason field of the output file.</p>

<p style="margin-top: 1em">disable.csv <br>
Input file listing the links to disable. The list is of the
form: NodeGUID;PortNum;NodeType;NodeDesc;NodeGUID;PortNum;
NodeType;NodeDesc;Reason</p>

<p style="margin-top: 1em">For each listed link, the switch
port closer to this node is disabled. The reason field is
optional. An input file such as this can be generated by
using opaextract&acirc; <br>
badlinks or opaextractsellinks.</p>

<p style="margin-top: 1em">Information about the links
disabled and the reason is saved (in the same format) to an
output file named /etc/sysconfig/opa/disabled:hfi:port.csv
where the hfi:port <br>
part of the file name is replaced by the HFI number and the
port number being operated on (such as 0:0 or 1:2). This CSV
file can be used as input to opaenableports.</p>

<p style="margin-top: 1em">Environment Variables <br>
The following environment variables are also used by this
command:</p>

<p style="margin-top: 1em">PORTS List of ports, used in
absence of -t and -p.</p>

<p style="margin-top: 1em">PORTS_FILE <br>
File containing list of ports, used in absence of -t and
-p.</p>

<p style="margin-top: 1em">Examples <br>
opadisableports &rsquo;bad cable&rsquo; #8217lt;
disable.csv</p>

<p style="margin-top: 1em">opadisableports -p &rsquo;1:1
1:2 2:1 2:2&rsquo; &rsquo;dead servers&rsquo; #8217lt;
disable.csv</p>

<p style="margin-top: 1em">Copyright(C) 2015-2016 Intel
Corporation opadisableports(8)</p>
<hr>
</body>
</html>
