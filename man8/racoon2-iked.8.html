<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>IKED(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">IKED(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">IKED(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<b class="Nm" title="Nm">iked</b> &#x2014; <span class="Nd" title="Nd">Internet
  Key Exchange protocol daemon</span>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<table class="Nm">
  <tr>
    <td><b class="Nm" title="Nm">iked</b></td>
    <td>[<span class="Op"><b class="Fl" title="Fl">-46hvFV</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-f</b>
      <var class="Ar" title="Ar">configfile</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-l</b>
      <var class="Ar" title="Ar">logfile</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-p</b>
      <var class="Ar" title="Ar">port</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-I</b>
      <var class="Ar" title="Ar">peer-address</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-S</b>
      <var class="Ar" title="Ar">selector-index</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-d</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-D</b>
      <var class="Ar" title="Ar">level</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-P</b>
      <var class="Ar" title="Ar">outfile</var></span>]</td>
  </tr>
</table>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b class="Nm" title="Nm">iked</b> is a key management daemon, which supports the
  Internet Key Exchange (IKE) protocol version 1 (RFC2409) and version 2
  (RFC4306). It is driven by upcalls from the kernel via the PF_KEYv2 interface
  or by negotiation requests from remote peers, and manages IPsec SAs according
  to <i class="Pa" title="Pa">racoon2.conf</i>.
<div class="Pp"></div>
The following options are available:
<dl class="Bl-tag">
  <dt class="It-tag"><a class="selflink" href="#4"><b class="Fl" title="Fl" id="4">-4</b></a></dt>
  <dd class="It-tag">Use IPv4 addresses only for local sockets.</dd>
  <dt class="It-tag"><a class="selflink" href="#6"><b class="Fl" title="Fl" id="6">-6</b></a></dt>
  <dd class="It-tag">Use IPv6 addresses only for local sockets.</dd>
  <dt class="It-tag"><a class="selflink" href="#d"><b class="Fl" title="Fl" id="d">-d</b></a></dt>
  <dd class="It-tag">Increase the debugging level. This flag may occur multiple
      times.</dd>
  <dt class="It-tag"><a class="selflink" href="#f"><b class="Fl" title="Fl" id="f">-f</b></a>
    <var class="Ar" title="Ar">configfile</var></dt>
  <dd class="It-tag">Read configurations from the specified file.</dd>
  <dt class="It-tag"><a class="selflink" href="#I"><b class="Fl" title="Fl" id="I">-I</b></a>
    <var class="Ar" title="Ar">peer-address</var></dt>
  <dd class="It-tag">Immediately initiate to the peer specified.</dd>
  <dt class="It-tag"><a class="selflink" href="#S"><b class="Fl" title="Fl" id="S">-S</b></a>
    <var class="Ar" title="Ar">selector_index</var></dt>
  <dd class="It-tag">Immediately initiate using the selector specified.</dd>
  <dt class="It-tag"><a class="selflink" href="#h"><b class="Fl" title="Fl" id="h">-h</b></a></dt>
  <dd class="It-tag">Show simple help messages.</dd>
  <dt class="It-tag"><a class="selflink" href="#l"><b class="Fl" title="Fl" id="l">-l</b></a>
    <var class="Ar" title="Ar">logfile</var></dt>
  <dd class="It-tag">Output log to logfile instead of syslog.</dd>
  <dt class="It-tag"><a class="selflink" href="#p"><b class="Fl" title="Fl" id="p">-p</b></a>
    <var class="Ar" title="Ar">portnum</var></dt>
  <dd class="It-tag">Specify default port number for IKE sockets.</dd>
  <dt class="It-tag"><a class="selflink" href="#v"><b class="Fl" title="Fl" id="v">-v</b></a></dt>
  <dd class="It-tag">Output log to stdout in addition to syslog.</dd>
  <dt class="It-tag"><a class="selflink" href="#D"><b class="Fl" title="Fl" id="D">-D</b></a>
    <var class="Ar" title="Ar">num</var></dt>
  <dd class="It-tag">Set debug flag.</dd>
  <dt class="It-tag"><a class="selflink" href="#F"><b class="Fl" title="Fl" id="F">-F</b></a></dt>
  <dd class="It-tag">Run in the foreground. <b class="Nm" title="Nm">iked</b>
      does not detach itself from the terminal and does not become a daemon.
      Logs are output to the stderr.</dd>
  <dt class="It-tag"><a class="selflink" href="#P"><b class="Fl" title="Fl" id="P">-P</b></a>
    <var class="Ar" title="Ar">outfile</var></dt>
  <dd class="It-tag">Record unencrypted IKE communication packets to the file.
      This option is available only if <b class="Nm" title="Nm">iked</b> was
      compiled with --enable-pcap configuration option.</dd>
  <dt class="It-tag"><a class="selflink" href="#V"><b class="Fl" title="Fl" id="V">-V</b></a></dt>
  <dd class="It-tag">Show the version.</dd>
</dl>
<div class="Pp"></div>
Upon receiving SIGINT or SIGTERM, <b class="Nm" title="Nm">iked</b> shuts down
  IKEv2 IKE_SAs with peer nodes by sending Informational exchange with Delete
  payload, deletes relevant IPsec SAs, and then exits. Upon receiving SIGHUP,
  <b class="Nm" title="Nm">iked</b> similarly shuts down IKEv2 IKE_SAs and
  deletes relevant IPsec SAs, then reloads the configuration file.
<div class="Pp"></div>
IPsec policies are managed by <a class="Xr" title="Xr">spmd(8)</a>, thus it must
  be started before <b class="Nm" title="Nm">iked</b>. When
  <a class="Xr" title="Xr">spmd(8)</a> restarts,
  <b class="Nm" title="Nm">iked</b> needs to be reloaded to reconnect with it.
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
<dl class="Bl-tag Bl-compact" style="margin-left: 23.40ex;">
  <dt class="It-tag" style="margin-left: -23.40ex;"><i class="Pa" title="Pa">@sysconfdir@/racoon2.conf</i></dt>
  <dd class="It-tag">The default configuration file for racoon2.</dd>
  <dt class="It-tag" style="margin-left: -23.40ex;"><i class="Pa" title="Pa">/var/run/iked.pid</i></dt>
  <dd class="It-tag">The PID file of the current instance of the daemon.</dd>
</dl>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<a class="Xr" title="Xr">racoon2(7)</a>,
  <a class="Xr" title="Xr">racoon2.conf(5)</a>,
  <a class="Xr" title="Xr">spmd(8)</a>, <a class="Xr" title="Xr">kinkd(8)</a>,
  <a class="Xr" title="Xr">ipsec(4)</a>
<div class="Pp"></div>
<cite class="Rs" title="Rs"><span class="RsT">The Internet Key Exchange
  (IKE)</span>, <span class="RsR">RFC2409</span>, <span class="RsD">November
  1998</span>.</cite>
<div class="Pp"></div>
<cite class="Rs" title="Rs"><span class="RsT">Internet Key Exchange (IKEv2)
  Protocol</span>, <span class="RsR">RFC4306</span>, <span class="RsD">December
  2005</span>.</cite>
<h1 class="Sh" title="Sh" id="HISTORY"><a class="selflink" href="#HISTORY">HISTORY</a></h1>
The <b class="Nm" title="Nm">iked</b> command was developed for racoon2 in
  2004-2005.
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
<b class="Nm" title="Nm">iked</b> was written and is maintained by
  <span class="An" title="An">WIDE/racoon2 project</span>
  &#x27E8;http://www.racoon2.wide.ad.jp/&#x27E9;
<h1 class="Sh" title="Sh" id="ACKNOWLEDGEMENTS"><a class="selflink" href="#ACKNOWLEDGEMENTS">ACKNOWLEDGEMENTS</a></h1>
Part of the codes are derived from ipsec-tools racoon daemon, which was derived
  from KAME racoon daemon.
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
&quot;default&quot; clause of configuration file is used for two purposes: to
  provide default values for individual field for other sections of
  configuration, and to specify default kmp configuration when the responder
  received a message from unknown peer. In latter case, when &quot;default&quot;
  clause lacks some necessary fields, error message may be cryptic, since it is
  not checked by configuration check routine of iked. (Probably it will result
  in &quot;no proposal chosen&quot;.)
<div class="Pp"></div>
On FreeBSD/NetBSD, when IPsec SA expires by IPsec SA lifetime, kernel does not
  notify iked about the sa expiration. To remedy this, iked maintains its own
  expiration timer for each IPsec SA. Since the iked can't know how much bytes
  used for the SA, lifetime_bytes in the configuration are ignored for now.
<div class="Pp"></div>
SA bundles (e.g. AH+ESP) does not conform to protocol spec.
<div class="Pp"></div>
After rekeying IKE_SA, iked may spit some warning messages, if the rekey
  negotiation or delete request was started from both ends at once.</div>
<table class="foot">
  <tr>
    <td class="foot-date">August 18, 2006</td>
    <td class="foot-os">RACOON2</td>
  </tr>
</table>
</body>
</html>
