<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>nft(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">nft(8)</td>
    <td class="head-vol"></td>
    <td class="head-rtitle">nft(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
nft - Administration tool for packet filtering and classification
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<br/>
<b>nft</b>
<br/>
[ <b>-n | --numeric</b> ] [ <b>[-I | --includepath]</b> <i>directory</i> ] [
  <b>[-f | --file]</b> <i>filename</i> | <b>[-i | --interactive]</b> |
  <i>cmd</i> ...]
<br/>
<br/>
<b>nft</b>
<br/>
[ <b>-h | --help</b> ] [ <b>-v | --version</b> ]
<br/>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
nft is used to set up, maintain and inspect packet filtering and classification
  rules in the Linux kernel.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
For a full summary of options, run <b>nft --help</b>.
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h, --help</b></dt>
  <dd class="It-tag">Show help message and all options.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v, --version</b></dt>
  <dd class="It-tag">Show version.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n, --numeric</b></dt>
  <dd class="It-tag">Numeric output: Addresses and other information that might
      need network traffic to resolve to symbolic names are shown numerically
      (default behaviour). When used twice, internet services are translated.
      When used twice, internet services and UIDs/GIDs are also shown
      numerically. When used three times, protocol numbers are also shown
      numerically.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-N</b></dt>
  <dd class="It-tag">Translate IP addresses to DNS names.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-a, --handle</b></dt>
  <dd class="It-tag">Show rule handles in output.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-I, --includepath </b><i>directory</i></dt>
  <dd class="It-tag">Add the directory <i>directory</i> to the list of
      directories to be searched for included files.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f, --file </b><i>filename</i></dt>
  <dd class="It-tag">Read input from <i>filename</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i, --interactive</b></dt>
  <dd class="It-tag">Read input from an interactive readline CLI.</dd>
</dl>
<h1 class="Sh" title="Sh" id="INPUT_FILE_FORMAT"><a class="selflink" href="#INPUT_FILE_FORMAT">INPUT
  FILE FORMAT</a></h1>
<h2 class="Ss" title="Ss" id="LEXICAL_CONVENTIONS"><a class="selflink" href="#LEXICAL_CONVENTIONS">LEXICAL
  CONVENTIONS</a></h2>
Input is parsed line-wise. When the last character of a line, just before the
  newline character, is a non-quoted backslash (\), the next line is treated as
  a continuation. Multiple commands on the same line can be separated using a
  semicolon (;).
<div class="Pp"></div>
A hash sign (#) begins a comment. All following characters on the same line are
  ignored.
<div class="Pp"></div>
Identifiers begin with an alphabetic character (a-z,A-Z), followed zero or more
  alphanumeric characters (a-z,A-Z,0-9) and the characters slash (/), backslash
  (\), underscore (_) and dot (.). Identifiers using different characters or
  clashing with a keyword need to be enclosed in double quotes (&quot;).
<h2 class="Ss" title="Ss" id="INCLUDE_FILES"><a class="selflink" href="#INCLUDE_FILES">INCLUDE
  FILES</a></h2>
<br/>
<b>include</b>
<br/>
<i>filename</i>
<br/>
<div class="Pp"></div>
Other files can be included by using the <b>include</b> statement. The
  directories to be searched for include files can be specified using the
  <b>-I/--includepath</b> option.
<h2 class="Ss" title="Ss" id="SYMBOLIC_VARIABLES"><a class="selflink" href="#SYMBOLIC_VARIABLES">SYMBOLIC
  VARIABLES</a></h2>
<br/>
<b>define</b>
<br/>
variable <i>expr</i>
<br/>
<br/>
<b>$variable</b>
<br/>
<br/>
<div class="Pp"></div>
Symbolic variables can be defined using the <b>define</b> statement. Variable
  references are expressions and can be used initialize other variables. The
  scope of a definition is the current block and all blocks contained within.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Using symbolic variables</b>
<div class="Pp"></div>
<pre>
define int_if1 = eth0
define int_if2 = eth1
define int_ifs = { $int_if1, $int_if2 }
<div class="Pp"></div>
filter input iif $int_ifs accept
					
</pre>
<h1 class="Sh" title="Sh" id="ADDRESS_FAMILIES"><a class="selflink" href="#ADDRESS_FAMILIES">ADDRESS
  FAMILIES</a></h1>
Address families determine the type of packets which are processed. For each
  address family the kernel contains so called hooks at specific stages of the
  packet processing paths, which invoke nftables if rules for these hooks exist.
<dl class="Bl-tag">
  <dt class="It-tag"><b>ip</b></dt>
  <dd class="It-tag">IPv4 address family.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ip6</b></dt>
  <dd class="It-tag">IPv6 address family.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>inet</b></dt>
  <dd class="It-tag">Internet (IPv4/IPv6) address family.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>arp</b></dt>
  <dd class="It-tag">ARP address family, handling packets vi</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>bridge</b></dt>
  <dd class="It-tag">Bridge address family, handling packets which traverse a
      bridge device.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>netdev</b></dt>
  <dd class="It-tag">Netdev address family, handling packets from ingress.</dd>
</dl>
<div class="Pp"></div>
All nftables objects exist in address family specific namespaces, therefore all
  identifiers include an address family. If an identifier is specified without
  an address family, the ip family is used by default.
<h2 class="Ss" title="Ss" id="IPV4/IPV6/INET_ADDRESS_FAMILIES"><a class="selflink" href="#IPV4/IPV6/INET_ADDRESS_FAMILIES">IPV4/IPV6/INET
  ADDRESS FAMILIES</a></h2>
The IPv4/IPv6/Inet address families handle IPv4, IPv6 or both types of packets.
  They contain five hooks at different packet processing stages in the network
  stack.
<div class="Pp"></div>
<b>IPv4/IPv6/Inet address family hooks</b>
<table class="tbl">
  <colgroup>
    <col style="width: 11.00ex;"/>
    <col style="width: 193.00ex;"/>
  </colgroup>
  <tr>
    <td>Hook</td>
    <td>Description</td>
  </tr>
  <tr>
    <td>prerouting</td>
    <td>All packets entering the system are processed by the prerouting hook. It
      is invoked before the routing process and is used for early filtering or
      changing packet attributes that affect routing.</td>
  </tr>
  <tr>
    <td>input</td>
    <td>Packets delivered to the local system are processed by the input
      hook.</td>
  </tr>
  <tr>
    <td>forward</td>
    <td>Packets forwarded to a different host are processed by the forward
      hook.</td>
  </tr>
  <tr>
    <td>output</td>
    <td>Packets sent by local processes are processed by the output hook.</td>
  </tr>
  <tr>
    <td>postrouting</td>
    <td>All packets leaving the system are processed by the postrouting
      hook.</td>
  </tr>
</table>
<h2 class="Ss" title="Ss" id="ARP_ADDRESS_FAMILY"><a class="selflink" href="#ARP_ADDRESS_FAMILY">ARP
  ADDRESS FAMILY</a></h2>
The ARP address family handles ARP packets received and sent by the system. It
  is commonly used to mangle ARP packets for clustering.
<div class="Pp"></div>
<b>ARP address family hooks</b>
<table class="tbl">
  <colgroup>
    <col style="width: 6.00ex;"/>
    <col style="width: 70.00ex;"/>
  </colgroup>
  <tr>
    <td>Hook</td>
    <td>Description</td>
  </tr>
  <tr>
    <td>input</td>
    <td>Packets delivered to the local system are processed by the input
      hook.</td>
  </tr>
  <tr>
    <td>output</td>
    <td>Packets send by the local system are processed by the output hook.</td>
  </tr>
</table>
<h2 class="Ss" title="Ss" id="BRIDGE_ADDRESS_FAMILY"><a class="selflink" href="#BRIDGE_ADDRESS_FAMILY">BRIDGE
  ADDRESS FAMILY</a></h2>
The bridge address family handles ethernet packets traversing bridge devices.
<h2 class="Ss" title="Ss" id="NETDEV_ADDRESS_FAMILY"><a class="selflink" href="#NETDEV_ADDRESS_FAMILY">NETDEV
  ADDRESS FAMILY</a></h2>
The Netdev address family handles packets from ingress.
<div class="Pp"></div>
<b>Netdev address family hooks</b>
<table class="tbl">
  <colgroup>
    <col style="width: 7.00ex;"/>
    <col style="width: 159.00ex;"/>
  </colgroup>
  <tr>
    <td>Hook</td>
    <td>Description</td>
  </tr>
  <tr>
    <td>ingress</td>
    <td>All packets entering the system are processed by this hook. It is
      invoked before layer 3 protocol handlers and it can be used for early
      filtering and policing.</td>
  </tr>
</table>
<h1 class="Sh" title="Sh" id="TABLES"><a class="selflink" href="#TABLES">TABLES</a></h1>
<br/>
{add | delete | list | flush} <b>table</b> [<i>family</i>] {<i>table</i>}
<div class="Pp"></div>
Tables are containers for chains and sets. They are identified by their address
  family and their name. The address family must be one of ip, ip6, inet, arp,
  bridge, netdev. The inet address family is a dummy family which is used to
  create hybrid IPv4/IPv6 tables. When no address family is specified, ip is
  used by default.
<dl class="Bl-tag">
  <dt class="It-tag"><b>add</b></dt>
  <dd class="It-tag">Add a new table for the given family with the given
    name.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>delete</b></dt>
  <dd class="It-tag">Delete the specified table.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>list</b></dt>
  <dd class="It-tag">List all chains and rules of the specified table.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>flush</b></dt>
  <dd class="It-tag">Flush all chains and rules of the specified table.</dd>
</dl>
<h1 class="Sh" title="Sh" id="CHAINS"><a class="selflink" href="#CHAINS">CHAINS</a></h1>
<br/>
{add} <b>chain</b> [<i>family</i>] {<i>table</i>} {<i>chain</i>} {<i>hook</i>}
  {<i>priority</i>} {<i>policy</i>} {<i>device</i>}
<br/>
{add | create | delete | list | flush} <b>chain</b> [<i>family</i>]
  {<i>table</i>} { <i>chain</i>}
<br/>
{rename} <b>chain</b> [<i>family</i>] {<i>table</i>} {<i>chain</i>}
  {<i>newname</i>}
<div class="Pp"></div>
Chains are containers for rules. They exist in two kinds, base chains and
  regular chains. A base chain is an entry point for packets from the networking
  stack, a regular chain may be used as jump target and is used for better rule
  organization.
<dl class="Bl-tag">
  <dt class="It-tag"><b>add</b></dt>
  <dd class="It-tag">Add a new chain in the specified table. When a hook and
      priority value are specified, the chain is created as a base chain and
      hooked up to the networking stack.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>create</b></dt>
  <dd class="It-tag">Simlar to the <b>add</b> command, but returns an error if
      the chain already exists.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>delete</b></dt>
  <dd class="It-tag">Delete the specified chain. The chain must not contain any
      rules or be used as jump target.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>rename</b></dt>
  <dd class="It-tag">Rename the specified chain.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>list</b></dt>
  <dd class="It-tag">List all rules of the specified chain.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>flush</b></dt>
  <dd class="It-tag">Flush all rules of the specified chain.</dd>
</dl>
<h1 class="Sh" title="Sh" id="RULES"><a class="selflink" href="#RULES">RULES</a></h1>
<br/>
[add | insert] <b>rule</b> [<i>family</i>] {<i>table</i>} {<i>chain</i>}
  [position <i>position</i>] {<i>statement</i>}...
<br/>
{delete} <b>rule</b> [<i>family</i>] {<i>table</i>} {<i>chain</i>} {handle
  <i>handle</i>}
<div class="Pp"></div>
Rules are constructed from two kinds of components according to a set of
  grammatical rules: expressions and statements.
<dl class="Bl-tag">
  <dt class="It-tag"><b>add</b></dt>
  <dd class="It-tag">Add a new rule described by the list of statements. The
      rule is appended to the given chain unless a position is specified, in
      which case the rule is appended to the rule given by the position.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>insert</b></dt>
  <dd class="It-tag">Similar to the <b>add</b> command, but the rule is
      prepended to the beginning of the chain or before the rule at the given
      position.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>delete</b></dt>
  <dd class="It-tag">Delete the specified rule.</dd>
</dl>
<h1 class="Sh" title="Sh" id="EXPRESSIONS"><a class="selflink" href="#EXPRESSIONS">EXPRESSIONS</a></h1>
Expressions represent values, either constants like network addresses, port
  numbers etc. or data gathered from the packet during ruleset evaluation.
  Expressions can be combined using binary, logical, relational and other types
  of expressions to form complex or relational (match) expressions. They are
  also used as arguments to certain types of operations, like NAT, packet
  marking etc.
<div class="Pp"></div>
Each expression has a data type, which determines the size, parsing and
  representation of symbolic values and type compatibility with other
  expressions.
<h2 class="Ss" title="Ss" id="DESCRIBE_COMMAND"><a class="selflink" href="#DESCRIBE_COMMAND">DESCRIBE
  COMMAND</a></h2>
<br/>
<b>describe</b>
<br/>
{ <i>expression</i>}
<br/>
<div class="Pp"></div>
The <b>describe</b> command shows information about the type of an expression
  and its data type.
<div class="Pp"></div>
<b>The describe command</b>
<div class="Pp"></div>
<pre>
$ nft describe tcp flags
payload expression, datatype tcp_flag (TCP flag) (basetype bitmask, integer), 8 bits
<div class="Pp"></div>
pre-defined symbolic constants:
fin                           	0x01
syn                           	0x02
rst                           	0x04
psh                           	0x08
ack                           	0x10
urg                           	0x20
ecn                           	0x40
cwr                           	0x80
				
</pre>
<h1 class="Sh" title="Sh" id="DATA_TYPES"><a class="selflink" href="#DATA_TYPES">DATA
  TYPES</a></h1>
Data types determine the size, parsing and representation of symbolic values and
  type compatibility of expressions. A number of global data types exist, in
  addition some expression types define further data types specific to the
  expression type. Most data types have a fixed size, some however may have a
  dynamic size, f.i. the string type.
<div class="Pp"></div>
Types may be derived from lower order types, f.i. the IPv4 address type is
  derived from the integer type, meaning an IPv4 address can also be specified
  as an integer value.
<div class="Pp"></div>
In certain contexts (set and map definitions) it is necessary to explicitly
  specify a data type. Each type has a name which is used for this.
<h2 class="Ss" title="Ss" id="INTEGER_TYPE"><a class="selflink" href="#INTEGER_TYPE">INTEGER
  TYPE</a></h2>
<table class="tbl">
  <colgroup>
    <col style="width: 7.00ex;"/>
    <col style="width: 7.00ex;"/>
    <col style="width: 8.00ex;"/>
    <col style="width: 9.00ex;"/>
  </colgroup>
  <tr>
    <td>Name</td>
    <td>Keyword</td>
    <td>Size</td>
    <td>Base type</td>
  </tr>
  <tr>
    <td>Integer</td>
    <td>integer</td>
    <td>variable</td>
    <td>-</td>
  </tr>
</table>
<div class="Pp"></div>
The integer type is used for numeric values. It may be specified as decimal,
  hexadecimal or octal number. The integer type doesn't have a fixed size, its
  size is determined by the expression for which it is used.
<h2 class="Ss" title="Ss" id="BITMASK_TYPE"><a class="selflink" href="#BITMASK_TYPE">BITMASK
  TYPE</a></h2>
<table class="tbl">
  <colgroup>
    <col style="width: 7.00ex;"/>
    <col style="width: 7.00ex;"/>
    <col style="width: 8.00ex;"/>
    <col style="width: 9.00ex;"/>
  </colgroup>
  <tr>
    <td>Name</td>
    <td>Keyword</td>
    <td>Size</td>
    <td>Base type</td>
  </tr>
  <tr>
    <td>Bitmask</td>
    <td>bitmask</td>
    <td>variable</td>
    <td>integer</td>
  </tr>
</table>
<div class="Pp"></div>
The bitmask type ( <b>bitmask</b>) is used for bitmasks.
<h2 class="Ss" title="Ss" id="STRING_TYPE"><a class="selflink" href="#STRING_TYPE">STRING
  TYPE</a></h2>
<table class="tbl">
  <colgroup>
    <col style="width: 6.00ex;"/>
    <col style="width: 7.00ex;"/>
    <col style="width: 8.00ex;"/>
    <col style="width: 9.00ex;"/>
  </colgroup>
  <tr>
    <td>Name</td>
    <td>Keyword</td>
    <td>Size</td>
    <td>Base type</td>
  </tr>
  <tr>
    <td>String</td>
    <td>string</td>
    <td>variable</td>
    <td>-</td>
  </tr>
</table>
<div class="Pp"></div>
The string type is used to for character strings. A string begins with an
  alphabetic character (a-zA-Z) followed by zero or more alphanumeric characters
  or the characters /, -, _ and .. In addition anything enclosed in double
  quotes (&quot;) is recognized as a string.
<div class="Pp"></div>
<b>String specification</b>
<div class="Pp"></div>
<pre>
# Interface name
filter input iifname eth0
<div class="Pp"></div>
# Weird interface name
filter input iifname &quot;(eth0)&quot;
				
</pre>
<h2 class="Ss" title="Ss" id="LINK_LAYER_ADDRESS_TYPE"><a class="selflink" href="#LINK_LAYER_ADDRESS_TYPE">LINK
  LAYER ADDRESS TYPE</a></h2>
<table class="tbl">
  <colgroup>
    <col style="width: 18.00ex;"/>
    <col style="width: 7.00ex;"/>
    <col style="width: 8.00ex;"/>
    <col style="width: 9.00ex;"/>
  </colgroup>
  <tr>
    <td>Name</td>
    <td>Keyword</td>
    <td>Size</td>
    <td>Base type</td>
  </tr>
  <tr>
    <td>Link layer address</td>
    <td>lladdr</td>
    <td>variable</td>
    <td>integer</td>
  </tr>
</table>
<div class="Pp"></div>
The link layer address type is used for link layer addresses. Link layer
  addresses are specified as a variable amount of groups of two hexadecimal
  digits separated using colons (:).
<div class="Pp"></div>
<b>Link layer address specification</b>
<div class="Pp"></div>
<pre>
# Ethernet destination MAC address
filter input ether daddr 20:c9:d0:43:12:d9
				
</pre>
<h2 class="Ss" title="Ss" id="IPV4_ADDRESS_TYPE"><a class="selflink" href="#IPV4_ADDRESS_TYPE">IPV4
  ADDRESS TYPE</a></h2>
<table class="tbl">
  <colgroup>
    <col style="width: 12.00ex;"/>
    <col style="width: 9.00ex;"/>
    <col style="width: 6.00ex;"/>
    <col style="width: 9.00ex;"/>
  </colgroup>
  <tr>
    <td>Name</td>
    <td>Keyword</td>
    <td>Size</td>
    <td>Base type</td>
  </tr>
  <tr>
    <td>IPv4 address</td>
    <td>ipv4_addr</td>
    <td>32 bit</td>
    <td>integer</td>
  </tr>
</table>
<div class="Pp"></div>
The IPv4 address type is used for IPv4 addresses. Addresses are specified in
  either dotted decimal, dotted hexadecimal, dotted octal, decimal, hexadecimal,
  octal notation or as a host name. A host name will be resolved using the
  standard system resolver.
<div class="Pp"></div>
<b>IPv4 address specification</b>
<div class="Pp"></div>
<pre>
# dotted decimal notation
filter output ip daddr 127.0.0.1
<div class="Pp"></div>
# host name
filter output ip daddr localhost
				
</pre>
<h2 class="Ss" title="Ss" id="IPV6_ADDRESS_TYPE"><a class="selflink" href="#IPV6_ADDRESS_TYPE">IPV6
  ADDRESS TYPE</a></h2>
<table class="tbl">
  <colgroup>
    <col style="width: 12.00ex;"/>
    <col style="width: 9.00ex;"/>
    <col style="width: 7.00ex;"/>
    <col style="width: 9.00ex;"/>
  </colgroup>
  <tr>
    <td>Name</td>
    <td>Keyword</td>
    <td>Size</td>
    <td>Base type</td>
  </tr>
  <tr>
    <td>IPv6 address</td>
    <td>ipv6_addr</td>
    <td>128 bit</td>
    <td>integer</td>
  </tr>
</table>
<div class="Pp"></div>
The IPv6 address type is used for IPv6 addresses. FIXME
<div class="Pp"></div>
<b>IPv6 address specification</b>
<div class="Pp"></div>
<pre>
# abbreviated loopback address
filter output ip6 daddr ::1
				
</pre>
<h1 class="Sh" title="Sh" id="PRIMARY_EXPRESSIONS"><a class="selflink" href="#PRIMARY_EXPRESSIONS">PRIMARY
  EXPRESSIONS</a></h1>
The lowest order expression is a primary expression, representing either a
  constant or a single datum from a packet's payload, meta data or a stateful
  module.
<h2 class="Ss" title="Ss" id="META_EXPRESSIONS"><a class="selflink" href="#META_EXPRESSIONS">META
  EXPRESSIONS</a></h2>
<br/>
<b>meta</b>
<br/>
{length | nfproto | l4proto | protocol | priority}
<br/>
<br/>
[meta] {mark | iif | iifname | iiftype | oif | oifname | oiftype | skuid | skgid
  | nftrace | rtclassid | ibriport | obriport | pkttype | cpu | iifgroup |
  oifgroup | cgroup}
<div class="Pp"></div>
A meta expression refers to meta data associated with a packet.
<div class="Pp"></div>
There are two types of meta expressions: unqualified and qualified meta
  expressions. Qualified meta expressions require the <b>meta</b> keyword before
  the meta key, unqualified meta expressions can be specified by using the meta
  key directly or as qualified meta expressions.
<div class="Pp"></div>
<b>Meta expression types</b>
<table class="tbl">
  <colgroup>
    <col style="width: 9.00ex;"/>
    <col style="width: 38.00ex;"/>
    <col style="width: 17.00ex;"/>
  </colgroup>
  <tr>
    <td>Keyword</td>
    <td>Description</td>
    <td>Type</td>
  </tr>
  <tr>
    <td>length</td>
    <td>Length of the packet in bytes</td>
    <td>integer (32 bit)</td>
  </tr>
  <tr>
    <td>protocol</td>
    <td>Ethertype protocol value</td>
    <td>ether_type</td>
  </tr>
  <tr>
    <td>priority</td>
    <td>TC packet priority</td>
    <td>integer (32 bit)</td>
  </tr>
  <tr>
    <td>mark</td>
    <td>Packet mark</td>
    <td>packetmark</td>
  </tr>
  <tr>
    <td>iif</td>
    <td>Input interface index</td>
    <td>iface_index</td>
  </tr>
  <tr>
    <td>iifname</td>
    <td>Input interface name</td>
    <td>string</td>
  </tr>
  <tr>
    <td>iiftype</td>
    <td>Input interface type</td>
    <td>iface_type</td>
  </tr>
  <tr>
    <td>oif</td>
    <td>Output interface index</td>
    <td>iface_index</td>
  </tr>
  <tr>
    <td>oifname</td>
    <td>Output interface name</td>
    <td>string</td>
  </tr>
  <tr>
    <td>oiftype</td>
    <td>Output interface hardware type</td>
    <td>iface_type</td>
  </tr>
  <tr>
    <td>skuid</td>
    <td>UID associated with originating socket</td>
    <td>uid</td>
  </tr>
  <tr>
    <td>skgid</td>
    <td>GID associated with originating socket</td>
    <td>gid</td>
  </tr>
  <tr>
    <td>rtclassid</td>
    <td>Routing realm</td>
    <td>realm</td>
  </tr>
  <tr>
    <td>ibriport</td>
    <td>Input bridge interface name</td>
    <td>string</td>
  </tr>
  <tr>
    <td>obriport</td>
    <td>Output bridge interface name</td>
    <td>string</td>
  </tr>
  <tr>
    <td>pkttype</td>
    <td>packet type</td>
    <td>pkt_type</td>
  </tr>
  <tr>
    <td>cpu</td>
    <td>cpu number processing the packet</td>
    <td>integer (32 bits)</td>
  </tr>
  <tr>
    <td>iifgroup</td>
    <td>incoming device group</td>
    <td>devgroup_type</td>
  </tr>
  <tr>
    <td>oifgroup</td>
    <td>outgoing device group</td>
    <td>devgroup_type</td>
  </tr>
  <tr>
    <td>cgroup</td>
    <td>control group id</td>
    <td>integer (32 bits)</td>
  </tr>
</table>
<div class="Pp"></div>
<b>Meta expression specific types</b>
<table class="tbl">
  <colgroup>
    <col style="width: 13.00ex;"/>
    <col style="width: 115.00ex;"/>
  </colgroup>
  <tr>
    <td>Type</td>
    <td>Description</td>
  </tr>
  <tr>
    <td>iface_index</td>
    <td>Interface index (32 bit number). Can be specified numerically or as name
      of an existing interface.</td>
  </tr>
  <tr>
    <td>ifname</td>
    <td>Interface name (16 byte string). Does not have to exist.</td>
  </tr>
  <tr>
    <td>iface_type</td>
    <td>Interface type (16 bit number).</td>
  </tr>
  <tr>
    <td>uid</td>
    <td>User ID (32 bit number). Can be specified numerically or as user
      name.</td>
  </tr>
  <tr>
    <td>gid</td>
    <td>Group ID (32 bit number). Can be specified numerically or as group
      name.</td>
  </tr>
  <tr>
    <td>realm</td>
    <td>Routing Realm (32 bit number). Can be specified numerically or as
      symbolic name defined in /etc/iproute2/rt_realms.</td>
  </tr>
  <tr>
    <td>devgroup_type</td>
    <td>Device group (32 bit number). Can be specified numerically or as
      symbolic name defined in /etc/iproute2/group.</td>
  </tr>
  <tr>
    <td>pkt_type</td>
    <td>Packet type: Unicast (addressed to local host), Broadcast (to all),
      Multicast (to group).</td>
  </tr>
</table>
<div class="Pp"></div>
<b>Using meta expressions</b>
<div class="Pp"></div>
<pre>
# qualified meta expression
filter output meta oif eth0
<div class="Pp"></div>
# unqualified meta expression
filter output oif eth0
					
</pre>
<h1 class="Sh" title="Sh" id="PAYLOAD_EXPRESSIONS"><a class="selflink" href="#PAYLOAD_EXPRESSIONS">PAYLOAD
  EXPRESSIONS</a></h1>
Payload expressions refer to data from the packet's payload.
<h2 class="Ss" title="Ss" id="ETHERNET_HEADER_EXPRESSION"><a class="selflink" href="#ETHERNET_HEADER_EXPRESSION">ETHERNET
  HEADER EXPRESSION</a></h2>
<br/>
<b>ether</b>
<br/>
[ <i>ethernet header field</i>]
<br/>
<div class="Pp"></div>
<b>Ethernet header expression types</b>
<table class="tbl">
  <colgroup>
    <col style="width: 7.00ex;"/>
    <col style="width: 23.00ex;"/>
    <col style="width: 10.00ex;"/>
  </colgroup>
  <tr>
    <td>Keyword</td>
    <td>Description</td>
    <td>Type</td>
  </tr>
  <tr>
    <td>daddr</td>
    <td>Destination MAC address</td>
    <td>ether_addr</td>
  </tr>
  <tr>
    <td>saddr</td>
    <td>Source MAC address</td>
    <td>ether_addr</td>
  </tr>
  <tr>
    <td>type</td>
    <td>EtherType</td>
    <td>ether_type</td>
  </tr>
</table>
<h2 class="Ss" title="Ss" id="VLAN_HEADER_EXPRESSION"><a class="selflink" href="#VLAN_HEADER_EXPRESSION">VLAN
  HEADER EXPRESSION</a></h2>
<br/>
<b>vlan</b>
<br/>
[ <i>VLAN header field</i>]
<br/>
<div class="Pp"></div>
<b>VLAN header expression</b>
<table class="tbl">
  <colgroup>
    <col style="width: 7.00ex;"/>
    <col style="width: 26.00ex;"/>
    <col style="width: 16.00ex;"/>
  </colgroup>
  <tr>
    <td>Keyword</td>
    <td>Description</td>
    <td>Type</td>
  </tr>
  <tr>
    <td>id</td>
    <td>VLAN ID (VID)</td>
    <td>integer (12 bit)</td>
  </tr>
  <tr>
    <td>cfi</td>
    <td>Canonical Format Indicator</td>
    <td>flag</td>
  </tr>
  <tr>
    <td>pcp</td>
    <td>Priority code point</td>
    <td>integer (3 bit)</td>
  </tr>
  <tr>
    <td>type</td>
    <td>EtherType</td>
    <td>ethertype</td>
  </tr>
</table>
<h2 class="Ss" title="Ss" id="ARP_HEADER_EXPRESSION"><a class="selflink" href="#ARP_HEADER_EXPRESSION">ARP
  HEADER EXPRESSION</a></h2>
<br/>
<b>arp</b>
<br/>
[ <i>ARP header field</i>]
<br/>
<div class="Pp"></div>
<b>ARP header expression</b>
<table class="tbl">
  <colgroup>
    <col style="width: 9.00ex;"/>
    <col style="width: 20.00ex;"/>
    <col style="width: 16.00ex;"/>
  </colgroup>
  <tr>
    <td>Keyword</td>
    <td>Description</td>
    <td>Type</td>
  </tr>
  <tr>
    <td>htype</td>
    <td>ARP hardware type</td>
    <td>integer (16 bit)</td>
  </tr>
  <tr>
    <td>ptype</td>
    <td>EtherType</td>
    <td>ethertype</td>
  </tr>
  <tr>
    <td>hlen</td>
    <td>Hardware address len</td>
    <td>integer (8 bit)</td>
  </tr>
  <tr>
    <td>plen</td>
    <td>Protocol address len</td>
    <td>integer (8 bit)</td>
  </tr>
  <tr>
    <td>operation</td>
    <td>Operation</td>
    <td>arp_op</td>
  </tr>
</table>
<h2 class="Ss" title="Ss" id="IPV4_HEADER_EXPRESSION"><a class="selflink" href="#IPV4_HEADER_EXPRESSION">IPV4
  HEADER EXPRESSION</a></h2>
<br/>
<b>ip</b>
<br/>
[ <i>IPv4 header field</i>]
<br/>
<div class="Pp"></div>
<b>IPv4 header expression</b>
<table class="tbl">
  <colgroup>
    <col style="width: 9.00ex;"/>
    <col style="width: 34.00ex;"/>
    <col style="width: 29.00ex;"/>
  </colgroup>
  <tr>
    <td>Keyword</td>
    <td>Description</td>
    <td>Type</td>
  </tr>
  <tr>
    <td>version</td>
    <td>IP header version (4)</td>
    <td>integer (4 bit)</td>
  </tr>
  <tr>
    <td>hdrlength</td>
    <td>IP header length including options</td>
    <td>integer (4 bit) FIXME scaling</td>
  </tr>
  <tr>
    <td>dscp</td>
    <td>Differentiated Services Code Point</td>
    <td>integer (6 bit)</td>
  </tr>
  <tr>
    <td>ecn</td>
    <td>Explicit Congestion Notification</td>
    <td>integer (2 bit)</td>
  </tr>
  <tr>
    <td>length</td>
    <td>Total packet length</td>
    <td>integer (16 bit)</td>
  </tr>
  <tr>
    <td>id</td>
    <td>IP ID</td>
    <td>integer (16 bit)</td>
  </tr>
  <tr>
    <td>frag-off</td>
    <td>Fragment offset</td>
    <td>integer (16 bit)</td>
  </tr>
  <tr>
    <td>ttl</td>
    <td>Time to live</td>
    <td>integer (8 bit)</td>
  </tr>
  <tr>
    <td>protocol</td>
    <td>Upper layer protocol</td>
    <td>inet_proto</td>
  </tr>
  <tr>
    <td>checksum</td>
    <td>IP header checksum</td>
    <td>integer (16 bit)</td>
  </tr>
  <tr>
    <td>saddr</td>
    <td>Source address</td>
    <td>ipv4_addr</td>
  </tr>
  <tr>
    <td>daddr</td>
    <td>Destination address</td>
    <td>ipv4_addr</td>
  </tr>
</table>
<h2 class="Ss" title="Ss" id="IPV6_HEADER_EXPRESSION"><a class="selflink" href="#IPV6_HEADER_EXPRESSION">IPV6
  HEADER EXPRESSION</a></h2>
<br/>
<b>ip6</b>
<br/>
[ <i>IPv6 header field</i>]
<br/>
<div class="Pp"></div>
<b>IPv6 header expression</b>
<table class="tbl">
  <colgroup>
    <col style="width: 9.00ex;"/>
    <col style="width: 34.00ex;"/>
    <col style="width: 16.00ex;"/>
  </colgroup>
  <tr>
    <td>Keyword</td>
    <td>Description</td>
    <td>Type</td>
  </tr>
  <tr>
    <td>version</td>
    <td>IP header version (6)</td>
    <td>integer (4 bit)</td>
  </tr>
  <tr>
    <td>priority</td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>dscp</td>
    <td>Differentiated Services Code Point</td>
    <td>integer (6 bit)</td>
  </tr>
  <tr>
    <td>ecn</td>
    <td>Explicit Congestion Notification</td>
    <td>integer (2 bit)</td>
  </tr>
  <tr>
    <td>flowlabel</td>
    <td>Flow label</td>
    <td>integer (20 bit)</td>
  </tr>
  <tr>
    <td>length</td>
    <td>Payload length</td>
    <td>integer (16 bit)</td>
  </tr>
  <tr>
    <td>nexthdr</td>
    <td>Nexthdr protocol</td>
    <td>inet_proto</td>
  </tr>
  <tr>
    <td>hoplimit</td>
    <td>Hop limit</td>
    <td>integer (8 bit)</td>
  </tr>
  <tr>
    <td>saddr</td>
    <td>Source address</td>
    <td>ipv6_addr</td>
  </tr>
  <tr>
    <td>daddr</td>
    <td>Destination address</td>
    <td>ipv6_addr</td>
  </tr>
</table>
<h2 class="Ss" title="Ss" id="TCP_HEADER_EXPRESSION"><a class="selflink" href="#TCP_HEADER_EXPRESSION">TCP
  HEADER EXPRESSION</a></h2>
<br/>
<b>tcp</b>
<br/>
[ <i>TCP header field</i>]
<br/>
<div class="Pp"></div>
<b>TCP header expression</b>
<table class="tbl">
  <colgroup>
    <col style="width: 8.00ex;"/>
    <col style="width: 22.00ex;"/>
    <col style="width: 29.00ex;"/>
  </colgroup>
  <tr>
    <td>Keyword</td>
    <td>Description</td>
    <td>Type</td>
  </tr>
  <tr>
    <td>sport</td>
    <td>Source port</td>
    <td>inet_service</td>
  </tr>
  <tr>
    <td>dport</td>
    <td>Destination port</td>
    <td>inet_service</td>
  </tr>
  <tr>
    <td>sequence</td>
    <td>Sequence number</td>
    <td>integer (32 bit)</td>
  </tr>
  <tr>
    <td>ackseq</td>
    <td>Acknowledgement number</td>
    <td>integer (32 bit)</td>
  </tr>
  <tr>
    <td>doff</td>
    <td>Data offset</td>
    <td>integer (4 bit) FIXME scaling</td>
  </tr>
  <tr>
    <td>reserved</td>
    <td>Reserved area</td>
    <td>integer (4 bit)</td>
  </tr>
  <tr>
    <td>flags</td>
    <td>TCP flags</td>
    <td>tcp_flags</td>
  </tr>
  <tr>
    <td>window</td>
    <td>Window</td>
    <td>integer (16 bit)</td>
  </tr>
  <tr>
    <td>checksum</td>
    <td>Checksum</td>
    <td>integer (16 bit)</td>
  </tr>
  <tr>
    <td>urgptr</td>
    <td>Urgent pointer</td>
    <td>integer (16 bit)</td>
  </tr>
</table>
<h2 class="Ss" title="Ss" id="UDP_HEADER_EXPRESSION"><a class="selflink" href="#UDP_HEADER_EXPRESSION">UDP
  HEADER EXPRESSION</a></h2>
<br/>
<b>udp</b>
<br/>
[ <i>UDP header field</i>]
<br/>
<div class="Pp"></div>
<b>UDP header expression</b>
<table class="tbl">
  <colgroup>
    <col style="width: 8.00ex;"/>
    <col style="width: 19.00ex;"/>
    <col style="width: 16.00ex;"/>
  </colgroup>
  <tr>
    <td>Keyword</td>
    <td>Description</td>
    <td>Type</td>
  </tr>
  <tr>
    <td>sport</td>
    <td>Source port</td>
    <td>inet_service</td>
  </tr>
  <tr>
    <td>dport</td>
    <td>Destination port</td>
    <td>inet_service</td>
  </tr>
  <tr>
    <td>length</td>
    <td>Total packet length</td>
    <td>integer (16 bit)</td>
  </tr>
  <tr>
    <td>checksum</td>
    <td>Checksum</td>
    <td>integer (16 bit)</td>
  </tr>
</table>
<h2 class="Ss" title="Ss" id="UDP-LITE_HEADER_EXPRESSION"><a class="selflink" href="#UDP-LITE_HEADER_EXPRESSION">UDP-LITE
  HEADER EXPRESSION</a></h2>
<br/>
<b>udplite</b>
<br/>
[ <i>UDP-Lite header field</i>]
<br/>
<div class="Pp"></div>
<b>UDP-Lite header expression</b>
<table class="tbl">
  <colgroup>
    <col style="width: 8.00ex;"/>
    <col style="width: 17.00ex;"/>
    <col style="width: 16.00ex;"/>
  </colgroup>
  <tr>
    <td>Keyword</td>
    <td>Description</td>
    <td>Type</td>
  </tr>
  <tr>
    <td>sport</td>
    <td>Source port</td>
    <td>inet_service</td>
  </tr>
  <tr>
    <td>dport</td>
    <td>Destination port</td>
    <td>inet_service</td>
  </tr>
  <tr>
    <td>cscov</td>
    <td>Checksum coverage</td>
    <td>integer (16 bit)</td>
  </tr>
  <tr>
    <td>checksum</td>
    <td>Checksum</td>
    <td>integer (16 bit)</td>
  </tr>
</table>
<h2 class="Ss" title="Ss" id="SCTP_HEADER_EXPRESSION"><a class="selflink" href="#SCTP_HEADER_EXPRESSION">SCTP
  HEADER EXPRESSION</a></h2>
<br/>
<b>sctp</b>
<br/>
[ <i>SCTP header field</i>]
<br/>
<div class="Pp"></div>
<b>SCTP header expression</b>
<table class="tbl">
  <colgroup>
    <col style="width: 8.00ex;"/>
    <col style="width: 16.00ex;"/>
    <col style="width: 16.00ex;"/>
  </colgroup>
  <tr>
    <td>Keyword</td>
    <td>Description</td>
    <td>Type</td>
  </tr>
  <tr>
    <td>sport</td>
    <td>Source port</td>
    <td>inet_service</td>
  </tr>
  <tr>
    <td>dport</td>
    <td>Destination port</td>
    <td>inet_service</td>
  </tr>
  <tr>
    <td>vtag</td>
    <td>Verfication Tag</td>
    <td>integer (32 bit)</td>
  </tr>
  <tr>
    <td>checksum</td>
    <td>Checksum</td>
    <td>integer (32 bit)</td>
  </tr>
</table>
<h2 class="Ss" title="Ss" id="DCCP_HEADER_EXPRESSION"><a class="selflink" href="#DCCP_HEADER_EXPRESSION">DCCP
  HEADER EXPRESSION</a></h2>
<br/>
<b>dccp</b>
<br/>
[ <i>DCCP header field</i>]
<br/>
<div class="Pp"></div>
<b>DCCP header expression</b>
<table class="tbl">
  <colgroup>
    <col style="width: 7.00ex;"/>
    <col style="width: 16.00ex;"/>
    <col style="width: 12.00ex;"/>
  </colgroup>
  <tr>
    <td>Keyword</td>
    <td>Description</td>
    <td>Type</td>
  </tr>
  <tr>
    <td>sport</td>
    <td>Source port</td>
    <td>inet_service</td>
  </tr>
  <tr>
    <td>dport</td>
    <td>Destination port</td>
    <td>inet_service</td>
  </tr>
</table>
<h2 class="Ss" title="Ss" id="AUTHENTICATION_HEADER_EXPRESSION"><a class="selflink" href="#AUTHENTICATION_HEADER_EXPRESSION">AUTHENTICATION
  HEADER EXPRESSION</a></h2>
<br/>
<b>ah</b>
<br/>
[ <i>AH header field</i>]
<br/>
<div class="Pp"></div>
<b>AH header expression</b>
<table class="tbl">
  <colgroup>
    <col style="width: 9.00ex;"/>
    <col style="width: 24.00ex;"/>
    <col style="width: 16.00ex;"/>
  </colgroup>
  <tr>
    <td>Keyword</td>
    <td>Description</td>
    <td>Type</td>
  </tr>
  <tr>
    <td>nexthdr</td>
    <td>Next header protocol</td>
    <td>inet_service</td>
  </tr>
  <tr>
    <td>hdrlength</td>
    <td>AH Header length</td>
    <td>integer (8 bit)</td>
  </tr>
  <tr>
    <td>reserved</td>
    <td>Reserved area</td>
    <td>integer (4 bit)</td>
  </tr>
  <tr>
    <td>spi</td>
    <td>Security Parameter Index</td>
    <td>integer (32 bit)</td>
  </tr>
  <tr>
    <td>sequence</td>
    <td>Sequence number</td>
    <td>integer (32 bit)</td>
  </tr>
</table>
<h2 class="Ss" title="Ss" id="ENCRYPTED_SECURITY_PAYLOAD_HEADER_EXPRESSION"><a class="selflink" href="#ENCRYPTED_SECURITY_PAYLOAD_HEADER_EXPRESSION">ENCRYPTED
  SECURITY PAYLOAD HEADER EXPRESSION</a></h2>
<br/>
<b>esp</b>
<br/>
[ <i>ESP header field</i>]
<br/>
<div class="Pp"></div>
<b>ESP header expression</b>
<table class="tbl">
  <colgroup>
    <col style="width: 8.00ex;"/>
    <col style="width: 24.00ex;"/>
    <col style="width: 16.00ex;"/>
  </colgroup>
  <tr>
    <td>Keyword</td>
    <td>Description</td>
    <td>Type</td>
  </tr>
  <tr>
    <td>spi</td>
    <td>Security Parameter Index</td>
    <td>integer (32 bit)</td>
  </tr>
  <tr>
    <td>sequence</td>
    <td>Sequence number</td>
    <td>integer (32 bit)</td>
  </tr>
</table>
<h2 class="Ss" title="Ss" id="IPCOMP_HEADER_EXPRESSION"><a class="selflink" href="#IPCOMP_HEADER_EXPRESSION">IPCOMP
  HEADER EXPRESSION</a></h2>
<br/>
<b>comp</b>
<br/>
[ <i>IPComp header field</i>]
<br/>
<div class="Pp"></div>
<b>IPComp header expression</b>
<table class="tbl">
  <colgroup>
    <col style="width: 7.00ex;"/>
    <col style="width: 27.00ex;"/>
    <col style="width: 16.00ex;"/>
  </colgroup>
  <tr>
    <td>Keyword</td>
    <td>Description</td>
    <td>Type</td>
  </tr>
  <tr>
    <td>nexthdr</td>
    <td>Next header protocol</td>
    <td>inet_service</td>
  </tr>
  <tr>
    <td>flags</td>
    <td>Flags</td>
    <td>bitmask</td>
  </tr>
  <tr>
    <td>cpi</td>
    <td>Compression Parameter Index</td>
    <td>integer (16 bit)</td>
  </tr>
</table>
<h1 class="Sh" title="Sh" id="BLA"><a class="selflink" href="#BLA">BLA</a></h1>
<h2 class="Ss" title="Ss" id="IPV6_EXTENSION_HEADER_EXPRESSIONS"><a class="selflink" href="#IPV6_EXTENSION_HEADER_EXPRESSIONS">IPV6
  EXTENSION HEADER EXPRESSIONS</a></h2>
IPv6 extension header expressions refer to data from an IPv6 packet's extension
  headers.
<h2 class="Ss" title="Ss" id="CONNTRACK_EXPRESSIONS"><a class="selflink" href="#CONNTRACK_EXPRESSIONS">CONNTRACK
  EXPRESSIONS</a></h2>
Conntrack expressions refer to meta data of the connection tracking entry
  associated with a packet.
<div class="Pp"></div>
There are three types of conntrack expressions. Some conntrack expressions
  require the flow direction before the conntrack key, others must be used
  directly because they are direction agnostic. The <b>packets and bytes</b>
  keywords can be used with or without a direction. If the direction is omitted,
  the sum of the original and the reply direction is returned.
<div class="Pp"></div>
<br/>
<b>ct</b>
<br/>
{state | direction | status | mark | expiration | helper | label | bytes |
  packets} {original | reply | {l3proto | protocol | saddr | daddr | proto-src |
  proto-dst | bytes | packets}}
<br/>
<div class="Pp"></div>
<b>Conntrack expressions</b>
<table class="tbl">
  <colgroup>
    <col style="width: 10.00ex;"/>
    <col style="width: 69.00ex;"/>
    <col style="width: 19.00ex;"/>
  </colgroup>
  <tr>
    <td>Keyword</td>
    <td>Description</td>
    <td>Type</td>
  </tr>
  <tr>
    <td>state</td>
    <td>State of the connection</td>
    <td>ct_state</td>
  </tr>
  <tr>
    <td>direction</td>
    <td>Direction of the packet relative to the connection</td>
    <td>ct_dir</td>
  </tr>
  <tr>
    <td>status</td>
    <td>Status of the connection</td>
    <td>ct_status</td>
  </tr>
  <tr>
    <td>mark</td>
    <td>Connection mark</td>
    <td>packetmark</td>
  </tr>
  <tr>
    <td>expiration</td>
    <td>Connection expiration time</td>
    <td>time</td>
  </tr>
  <tr>
    <td>helper</td>
    <td>Helper associated with the connection</td>
    <td>string</td>
  </tr>
  <tr>
    <td>label</td>
    <td>Connection tracking label</td>
    <td>ct_label</td>
  </tr>
  <tr>
    <td>l3proto</td>
    <td>Layer 3 protocol of the connection</td>
    <td>nf_proto</td>
  </tr>
  <tr>
    <td>saddr</td>
    <td>Source address of the connection for the given direction</td>
    <td>ipv4_addr/ipv6_addr</td>
  </tr>
  <tr>
    <td>daddr</td>
    <td>Destination address of the connection for the given direction</td>
    <td>ipv4_addr/ipv6_addr</td>
  </tr>
  <tr>
    <td>protocol</td>
    <td>Layer 4 protocol of the connection for the given direction</td>
    <td>inet_proto</td>
  </tr>
  <tr>
    <td>proto-src</td>
    <td>Layer 4 protocol source for the given direction</td>
    <td>integer (16 bit)</td>
  </tr>
  <tr>
    <td>proto-dst</td>
    <td>Layer 4 protocol destination for the given direction</td>
    <td>integer (16 bit)</td>
  </tr>
  <tr>
    <td>packets</td>
    <td>packet count seen in the given direction or sum of original and
      reply</td>
    <td>integer (64 bit)</td>
  </tr>
  <tr>
    <td>bytes</td>
    <td>bytecount seen, see description for <b>packets</b> keyword</td>
    <td>integer (64 bit)</td>
  </tr>
</table>
<h1 class="Sh" title="Sh" id="STATEMENTS"><a class="selflink" href="#STATEMENTS">STATEMENTS</a></h1>
Statements represent actions to be performed. They can alter control flow
  (return, jump to a different chain, accept or drop the packet) or can perform
  actions, such as logging, rejecting a packet, etc.
<div class="Pp"></div>
Statements exist in two kinds. Terminal statements unconditionally terminate
  evaluation of the current rule, non-terminal statements either only
  conditionally or never terminate evaluation of the current rule, in other
  words, they are passive from the ruleset evaluation perspective. There can be
  an arbitrary amount of non-terminal statements in a rule, but only a single
  terminal statement as the final statement.
<h2 class="Ss" title="Ss" id="VERDICT_STATEMENT"><a class="selflink" href="#VERDICT_STATEMENT">VERDICT
  STATEMENT</a></h2>
The verdict statement alters control flow in the ruleset and issues policy
  decisions for packets.
<div class="Pp"></div>
<br/>
{accept | drop | queue | continue | return}
<br/>
{jump | goto} { <i>chain</i>}
<dl class="Bl-tag">
  <dt class="It-tag"><b>accept</b></dt>
  <dd class="It-tag">Terminate ruleset evaluation and accept the packet.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>drop</b></dt>
  <dd class="It-tag">Terminate ruleset evaluation and drop the packet.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>queue</b></dt>
  <dd class="It-tag">Terminate ruleset evaluation and queue the packet to
      userspace.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>continue</b></dt>
  <dd class="It-tag">Continue ruleset evaluation with the next rule. FIXME</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>return</b></dt>
  <dd class="It-tag">Return from the current chain and continue evaluation at
      the next rule in the last chain. If issued in a base chain, it is
      equivalent to <b>accept</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>jump </b><i>chain</i></dt>
  <dd class="It-tag">Continue evaluation at the first rule in <i>chain</i>. The
      current position in the ruleset is pushed to a call stack and evaluation
      will continue there when the new chain is entirely evaluated of a
      <b>return</b> verdict is issued.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>goto </b><i>chain</i></dt>
  <dd class="It-tag">Similar to <b>jump</b>, but the current position is not
      pushed to the call stack, meaning that after the new chain evaluation will
      continue at the last chain instead of the one containing the goto
      statement.</dd>
</dl>
<div class="Pp"></div>
<b>Verdict statements</b>
<div class="Pp"></div>
<pre>
# process packets from eth0 and the internal network in from_lan
# chain, drop all packets from eth0 with different source addresses.
<div class="Pp"></div>
filter input iif eth0 ip saddr 192.168.0.0/24 jump from_lan
filter input iif eth0 drop
					
</pre>
<h2 class="Ss" title="Ss" id="LOG_STATEMENT"><a class="selflink" href="#LOG_STATEMENT">LOG
  STATEMENT</a></h2>
<h2 class="Ss" title="Ss" id="REJECT_STATEMENT"><a class="selflink" href="#REJECT_STATEMENT">REJECT
  STATEMENT</a></h2>
<h2 class="Ss" title="Ss" id="COUNTER_STATEMENT"><a class="selflink" href="#COUNTER_STATEMENT">COUNTER
  STATEMENT</a></h2>
<h2 class="Ss" title="Ss" id="META_STATEMENT"><a class="selflink" href="#META_STATEMENT">META
  STATEMENT</a></h2>
<h2 class="Ss" title="Ss" id="LIMIT_STATEMENT"><a class="selflink" href="#LIMIT_STATEMENT">LIMIT
  STATEMENT</a></h2>
<h2 class="Ss" title="Ss" id="NAT_STATEMENT"><a class="selflink" href="#NAT_STATEMENT">NAT
  STATEMENT</a></h2>
<h2 class="Ss" title="Ss" id="QUEUE_STATEMENT"><a class="selflink" href="#QUEUE_STATEMENT">QUEUE
  STATEMENT</a></h2>
<h1 class="Sh" title="Sh" id="ADDITIONAL_COMMANDS"><a class="selflink" href="#ADDITIONAL_COMMANDS">ADDITIONAL
  COMMANDS</a></h1>
These are some additional commands included in nft.
<h2 class="Ss" title="Ss" id="EXPORT"><a class="selflink" href="#EXPORT">EXPORT</a></h2>
Export your current ruleset in XML or JSON format to stdout.
<div class="Pp"></div>
Examples:
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
% nft export xml
[...]
% nft export json
[...]
				
</pre>
<h2 class="Ss" title="Ss" id="MONITOR"><a class="selflink" href="#MONITOR">MONITOR</a></h2>
The monitor command allows you to listen to Netlink events produced by the
  nf_tables subsystem, related to creation and deletion of objects. When they
  ocurr, nft will print to stdout the monitored events in either XML, JSON or
  native nft format.
<div class="Pp"></div>
To filter events related to a concrete object, use one of the keywords 'tables',
  'chains', 'sets', 'rules', 'elements'.
<div class="Pp"></div>
To filter events related to a concrete action, use keyword 'new' or 'destroy'.
<div class="Pp"></div>
Hit ^C to finish the monitor operation.
<div class="Pp"></div>
<b>Listen to all events, report in native nft format</b>
<div class="Pp"></div>
<pre>
% nft monitor
				
</pre>
<div class="Pp"></div>
<b>Listen to added tables, report in XML format</b>
<div class="Pp"></div>
<pre>
% nft monitor new tables xml
				
</pre>
<div class="Pp"></div>
<b>Listen to deleted rules, report in JSON format</b>
<div class="Pp"></div>
<pre>
% nft monitor destroy rules json
				
</pre>
<div class="Pp"></div>
<b>Listen to both new and destroyed chains, in native nft format</b>
<div class="Pp"></div>
<pre>
% nft monitor chains
				
</pre>
<h1 class="Sh" title="Sh" id="ERROR_REPORTING"><a class="selflink" href="#ERROR_REPORTING">ERROR
  REPORTING</a></h1>
When an error is detected, nft shows the line(s) containing the error, the
  position of the erroneous parts in the input stream and marks up the erroneous
  parts using carrets (^). If the error results from the combination of two
  expressions or statements, the part imposing the constraints which are
  violated is marked using tildes (~).
<div class="Pp"></div>
For errors returned by the kernel, nft can't detect which parts of the input
  caused the error and the entire command is marked.
<div class="Pp"></div>
<b>Error caused by single incorrect expression</b>
<div class="Pp"></div>
<pre>
&lt;cmdline&gt;:1:19-22: Error: Interface does not exist
filter output oif eth0
                  ^^^^
			
</pre>
<div class="Pp"></div>
<b>Error caused by invalid combination of two expressions</b>
<div class="Pp"></div>
<pre>
&lt;cmdline&gt;:1:28-36: Error: Right hand side of relational expression (==) must be constant
filter output tcp dport == tcp dport
                        ~~ ^^^^^^^^^
			
</pre>
<div class="Pp"></div>
<b>Error returned by the kernel</b>
<div class="Pp"></div>
<pre>
&lt;cmdline&gt;:0:0-23: Error: Could not process rule: Operation not permitted
filter output oif wlan0
^^^^^^^^^^^^^^^^^^^^^^^
			
</pre>
<h1 class="Sh" title="Sh" id="EXIT_STATUS"><a class="selflink" href="#EXIT_STATUS">EXIT
  STATUS</a></h1>
On success, nft exits with a status of 0. Unspecified errors cause it to exit
  with a status of 1, memory allocation errors with a status of 2, unable to
  open Netlink socket with 3.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
iptables(8), ip6tables(8), arptables(8), ebtables(8), ip(8), tc(8)
<div class="Pp"></div>
There is an official wiki at: http://wiki.nftables.org
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
nftables was written by Patrick McHardy.
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
Copyright &#x00A9; 2008-2014 Patrick McHardy &lt;kaber@trash.net&gt;
<div class="Pp"></div>
nftables is free software; you can redistribute it and/or modify it under the
  terms of the GNU General Public License version 2 as published by the Free
  Software Foundation.
<div class="Pp"></div>
This documentation is licenced under the terms of the Creative Commons
  Attribution-ShareAlike 4.0 license, CC BY-SA 4.0
  &#x27E8;http://creativecommons.org/licenses/by-sa/4.0/&#x27E9; .</div>
<table class="foot">
  <tr>
    <td class="foot-date">29 June 2016</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
