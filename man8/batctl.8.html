<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:08:55 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>BATCTL(8) B.A.T.M.A.N. Advanced Control Tool
BATCTL(8)</p>

<p style="margin-top: 1em">NAME <br>
batctl - B.A.T.M.A.N. advanced control and management
tool</p>

<p style="margin-top: 1em">SYNOPSIS <br>
batctl [options] command|debug table [parameters]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
batctl offers a convenient way to configure the batman-adv
kernel module as well as displaying debug information such
as originator tables, translation tables and the debug log.
<br>
In combination with a bat-hosts file batctl allows the use
of host names instead of MAC addresses.</p>

<p style="margin-top: 1em">B.A.T.M.A.N. advanced operates
on layer 2. Thus all hosts participating in the virtual
switched network are transparently connected together for
all protocols above layer 2. <br>
Therefore the common diagnosis tools do not work as
expected. To overcome these problems batctl contains the
commands ping, traceroute, tcpdump which provide similar
functional&acirc; <br>
ity to the normal ping(1), traceroute(1), tcpdump(1)
commands, but modified to layer 2 behaviour or using the
B.A.T.M.A.N. advanced protocol. For similar reasons,
throughput&acirc; <br>
meter, a command to test network performances, is also
included.</p>

<p style="margin-top: 1em">OPTIONS <br>
options: <br>
-m specify mesh interface or VLAN created on top of a mesh
interface (default &rsquo;bat0&rsquo;) <br>
-h print general batctl help <br>
-v print batctl version and batman-adv version (if the
module is loaded)</p>

<p style="margin-top: 1em">commands:</p>

<p style="margin-top: 1em">interface|if [-M] [add|del
iface(s)] <br>
If no parameter is given or the first parameter is neither
&quot;add&quot; nor &quot;del&quot; the current interface
settings are displayed. In order to add or delete interfaces
specify <br>
&quot;add&quot; or &quot;del&quot; as first argument and
append the interface names you wish to add or delete.
Multiple interfaces can be specified. The &quot;-M&quot;
option tells batctl to not auto&acirc; <br>
matically create the batman-adv interface on &quot;add&quot;
or to destroy it when &quot;del&quot; removed all interfaces
which belonged to it.</p>

<p style="margin-top: 1em">interface|if [create|destroy]
<br>
A batman-adv interface without attached interfaces can be
created using &quot;create&quot;. The parameter
&quot;destroy&quot; can be used to free all attached
interfaces and remove batman-adv <br>
interface.</p>

<p style="margin-top: 1em">orig_interval|it [interval] <br>
If no parameter is given the current originator interval
setting is displayed otherwise the parameter is used to set
the originator interval. The interval is in units of <br>
milliseconds.</p>

<p style="margin-top: 1em">ap_isolation|ap [0|1] <br>
If no parameter is given the current ap isolation setting is
displayed. Otherwise the parameter is used to enable or
disable ap isolation. This command can be used in con&acirc;
<br>
junction with &quot;-m&quot; option to target per VLAN
configurations.</p>

<p style="margin-top: 1em">bridge_loop_avoidance|bl [0|1]
<br>
If no parameter is given the current bridge loop avoidance
setting is displayed. Otherwise the parameter is used to
enable or disable the bridge loop avoidance. Bridge <br>
loop avoidance support has to be enabled when compiling the
module otherwise this option won&rsquo;t be available.</p>

<p style="margin-top: 1em">distributed_arp_table|dat [0|1]
<br>
If no parameter is given the current distributed arp table
setting is displayed. Otherwise the parameter is used to
enable or disable the distributed arp table.</p>

<p style="margin-top: 1em">aggregation|ag [0|1] <br>
If no parameter is given the current aggregation setting is
displayed. Otherwise the parameter is used to enable or
disable OGM packet aggregation.</p>

<p style="margin-top: 1em">bonding|b [0|1] <br>
If no parameter is given the current bonding mode setting is
displayed. Otherwise the parameter is used to enable or
disable the bonding mode.</p>

<p style="margin-top: 1em">fragmentation|f [0|1] <br>
If no parameter is given the current fragmentation mode
setting is displayed. Otherwise the parameter is used to
enable or disable fragmentation.</p>

<p style="margin-top: 1em">network_coding|nc [0|1] <br>
If no parameter is given the current network coding mode
setting is displayed. Otherwise the parameter is used to
enable or disable network coding.</p>

<p style="margin-top: 1em">multicast_mode|mm [0|1] <br>
If no parameter is given the current multicast mode setting
is displayed. Otherwise the parameter is used to enable or
disable multicast optimizations (i.e. disabling <br>
means always sending own multicast frames via classic
flooding).</p>

<p style="margin-top: 1em">loglevel|ll [level[ level[
level]] ...] <br>
If no parameter is given the current log level settings are
displayed otherwise the parameter(s) is/are used to set the
log level. Level &rsquo;none&rsquo; disables all verbose
log&acirc; <br>
ging. Level &rsquo;batman&rsquo; enables messages related to
routing / flooding / broadcasting. Level
&rsquo;routes&rsquo; enables messages related to routes
being added / changed / deleted. <br>
Level &rsquo;tt&rsquo; enables messages related to
translation table operations. Level &rsquo;bla&rsquo;
enables messages related to the bridge loop avoidance. Level
&rsquo;dat&rsquo; enables messages <br>
related to ARP snooping and the Distributed Arp Table. Level
&rsquo;nc&rsquo; enables messages related to network coding.
Level &rsquo;mcast&rsquo; enables messages related to
multicast opti&acirc; <br>
mizations. Level &rsquo;all&rsquo; enables all messages. The
messages are sent to the batman-adv debug log. Use batctl
log to retrieve it. Make sure to have debugging output
enabled <br>
when compiling the module otherwise the output as well as
the loglevel options won&rsquo;t be available.</p>

<p style="margin-top: 1em">log|l [-n] <br>
batctl will read the batman-adv debug log which has to be
compiled into the kernel module. If &quot;-n&quot; is given
batctl will not replace the MAC addresses with bat-host
names <br>
in the output.</p>

<p style="margin-top: 1em">gw_mode|gw [off|client|server]
[sel_class|bandwidth] <br>
If no parameter is given the current gateway mode is
displayed otherwise the parameter is used to set the gateway
mode. The second (optional) argument specifies the
selec&acirc; <br>
tion class (if &rsquo;client&rsquo; was the first argument)
or the gateway bandwidth (if &rsquo;server&rsquo; was the
first argument). If the node is a server this parameter is
used to inform <br>
other nodes in the network about this node&rsquo;s internet
connection bandwidth. Just enter any number (optionally
followed by &quot;kbit&quot; or &quot;mbit&quot;) and the
batman-adv module will <br>
propagate the entered value in the mesh. Use &quot;/&quot;
to separate the down&acirc; and upload rates. You can omit
the upload rate and the module will assume an upload of
download / 5. <br>
default: 10000 -&gt; 10.0/2.0 MBit <br>
examples: 5000 -&gt; 5.0/1.0 MBit <br>
5000kbit <br>
5mbit <br>
5mbit/1024 <br>
5mbit/1024kbit <br>
5mbit/1mbit <br>
If the node is a gateway client the parameter will decide
which criteria to consider when the batman-adv module has to
choose between different internet connections <br>
announced by the aforementioned servers. <br>
default: 20 -&gt; late switch (TQ 20) <br>
examples: 1 -&gt; fast connection <br>
consider the gateway&rsquo;s advertised throughput as well
as the link quality towards the gateway and stick with the
selection until the gateway disap&acirc; <br>
pears <br>
2 -&gt; stable connection <br>
chooses the gateway with the best link quality and sticks
with it (ignore the advertised throughput) <br>
3 -&gt; fast switch connection <br>
chooses the gateway with the best link quality but switches
to another gateway as soon as a better one is found <br>
XX -&gt; late switch connection <br>
chooses the gateway with the best link quality but switches
to another gateway as soon as a better one is found which is
at least XX TQ better <br>
than the currently selected gateway (XX has to be a number
between 3 and 256).</p>

<p style="margin-top: 1em">routing_algo|ra [algorithm] <br>
If no parameter is given the current routing algorithm
configuration as well as supported routing algorithms are
displayed. Otherwise the parameter is used to select the
<br>
routing algorithm for the following batX interface to be
created.</p>

<p style="margin-top: 1em">isolation_mark|mark <br>
If no parameter is given the current isolation mark value is
displayed. Otherwise the parameter is used to set or unset
the isolation mark used by the Extended Isolation <br>
feature. <br>
The input is supposed to be of the form $value/$mask, where
$value can be any 32bit long integer (expressed in decimal
or hex base) and $mask is a generic bitmask <br>
(expressed in hex base) that selects the bits to take into
consideration from $value. It is also possible to enter the
input using only $value and in this case the full <br>
bitmask is used by default.</p>

<p style="margin-top: 1em">Example 1: 0x00000001/0xffffffff
<br>
Example 2: 0x00040000/0xffff0000 <br>
Example 3: 16 or 0x0F</p>

<p style="margin-top: 1em">debug tables:</p>

<p style="margin-top: 1em">The batman-adv kernel module
comes with a variety of debug tables containing various
information about the state of the mesh seen by each
individual node. These tables are <br>
exported via debugfs and easily accessible via batctl. You
will need debugfs support compiled into your kernel and
preferably have mounted the debugfs to a well-known <br>
mountpoint. If debugfs is not mounted batctl will attempt to
do this step for you.</p>

<p style="margin-top: 1em">All of the debug tables support
the following options: <br>
-w refresh the list every second or add a number to let it
refresh at a custom interval in seconds (with optional
decimal places) <br>
-n do not replace the MAC addresses with bat-host names in
the output <br>
-H do not show the header of the debug table</p>

<p style="margin-top: 1em">The originator table also
supports the &quot;-t&quot; filter option to remove all
originators from the output that have not been seen for the
specified amount of seconds (with <br>
optional decimal places). It furthermore supports the
&quot;-i&quot; parameter to specify an interface for which
the originator table should be printed. If this parameter is
not <br>
supplied, the default originator table is printed.</p>

<p style="margin-top: 1em">The local and global translation
tables also support the &quot;-u&quot; and &quot;-m&quot;
option to only display unicast or multicast translation
table announcements respectively.</p>

<p style="margin-top: 1em">List of debug tables: <br>
- neighbors|n <br>
- originators|o <br>
- gateways|gwl <br>
- translocal|tl <br>
- transglobal|tg <br>
- claimtable|cl (compile time option) <br>
- backbonetable|bbt (compile time option) <br>
- dat_cache|dc (compile time option) <br>
- nc_nodes|nn (compile time option) <br>
- mcast_flags|mf (compile time option)</p>

<p style="margin-top: 1em">translate|t
MAC_address|bat-host_name|host_name|IP_address</p>

<p style="margin-top: 1em">Translates a destination
(hostname, IP, MAC, bat_host-name) to the originator mac
address responsible for it.</p>

<p style="margin-top: 1em">statistics|s <br>
Retrieve traffic counters from batman-adv kernel module. The
output may vary depending on which features have been
compiled into the kernel module. <br>
Each module subsystem has its own counters which are
indicated by their prefixes: <br>
mgmt - mesh protocol counters <br>
tt - translation table counters <br>
All counters without a prefix concern payload (pure user
data) traffic.</p>

<p style="margin-top: 1em">ping|p [-c count][-i
interval][-t time][-R][-T]
MAC_address|bat-host_name|host_name|IP_address <br>
Layer 2 ping of a MAC address or bat-host name. batctl will
try to find the bat-host name if the given parameter was not
a MAC address. It can also try to guess the MAC <br>
address using an IPv4/IPv6 address or a hostname when the
IPv4/IPv6 address was configured on top of the batman-adv
interface of the destination device and both source and <br>
destination devices are in the same IP subnet. The
&quot;-c&quot; option tells batctl how man pings should be
sent before the program exits. Without the &quot;-c&quot;
option batctl will <br>
continue pinging without end. Use CTRL + C to stop it. With
&quot;-i&quot; and &quot;-t&quot; you can set the default
interval between pings and the timeout time for replies,
both in sec&acirc; <br>
onds. When run with &quot;-R&quot;, the route taken by the
ping messages will be recorded. With &quot;-T&quot; you can
disable the automatic translation of a client MAC address to
the origi&acirc; <br>
nator address which is responsible for this client.</p>

<p style="margin-top: 1em">traceroute|tr [-n][-T]
MAC_address|bat-host_name|host_name|IP_address <br>
Layer 2 traceroute to a MAC address or bat-host name. batctl
will try to find the bat-host name if the given parameter
was not a MAC address. It can also try to guess the <br>
MAC address using an IPv4/IPv6 address or a hostname when
the IPv4/IPv6 address was configured on top of the
batman-adv interface of the destination device and both
source <br>
and destination devices are in the same IP subnet. batctl
will send 3 packets to each host and display the response
time. If &quot;-n&quot; is given batctl will not replace the
MAC <br>
addresses with bat-host names in the output. With
&quot;-T&quot; you can disable the automatic translation of
a client MAC address to the originator address which is
responsible for <br>
this client.</p>

<p style="margin-top: 1em">tcpdump|td [-c][-n][-p
filter][-x filter] interface ... <br>
batctl will display all packets that are seen on the given
interface(s). A variety of options to filter the output are
available: To only print packets that match the com&acirc;
<br>
patibility number of batctl specify the &quot;-c&quot;
(compat filter) option. If &quot;-n&quot; is given batctl
will not replace the MAC addresses with bat-host names in
the output. To fil&acirc; <br>
ter the shown packet types you can either use &quot;-p&quot;
(dump only specified packet types) or &quot;-x&quot; (dump
all packet types except specified). The following packet
types are <br>
available: <br>
1 - batman ogm packets <br>
2 - batman icmp packets <br>
4 - batman unicast packets <br>
8 - batman broadcast packets <br>
16 - batman unicast tvlv packets <br>
32 - batman fragmented packets <br>
64 - batman tt / roaming packets <br>
128 - non batman packets <br>
Example: batctl td &lt;interface&gt; -p 129 -&gt; only
display batman ogm packets and non batman packets</p>

<p style="margin-top: 1em">bisect_iv [-l MAC][-t MAC][-r
MAC][-s min [- max]][-o MAC][-n] logfile1 [logfile2 ...
logfileN] <br>
Analyses the B.A.T.M.A.N. IV logfiles to build a small
internal database of all sent sequence numbers and routing
table changes. This database can then be analyzed in a <br>
number of different ways. With &quot;-l&quot; the database
can be used to search for routing loops. Use &quot;-t&quot;
to trace OGMs of a host throughout the network. Use
&quot;-r&quot; to display <br>
routing tables of the nodes. The option &quot;-s&quot; can
be used to limit the output to a range of sequence numbers,
between min and max, or to one specific sequence number,
min. <br>
Furthermore using &quot;-o&quot; you can filter the output
to a specified originator. If &quot;-n&quot; is given batctl
will not replace the MAC addresses with bat-host names in
the output.</p>

<p style="margin-top: 1em">throughputmeter|tp MAC <br>
This command starts a throughput test entirely controlled by
batman module in kernel space: the computational resources
needed to align memory and copy data between user <br>
and kernel space that are required by other user space tools
may represent a bootleneck on some low profile device.</p>

<p style="margin-top: 1em">The test consist of the transfer
of 14 MB of data between the two nodes. The protocol used to
transfer the data is somehow similar to TCP, but simpler:
some TCP features <br>
are still missing, thus protocol performances could be
worst. Since a fixed amount of data is transferred the
experiment duration depends on the network conditions. The
<br>
experiment can be interrupted with CTRL + C. At the end of a
successful experiment the throughput in KBytes per second is
returned, togheter with the experiment duration <br>
in millisecond and the amount of bytes transferred. If too
many packets are lost or the specified MAC address is not
reachable, a message notifing the error is returned <br>
instead of the result.</p>

<p style="margin-top: 1em">FILES <br>
bat-hosts <br>
This file is similar to the /etc/hosts file. You can write
one MAC address and one host name per line. batctl will
search for bat-hosts in /etc, your home directory and <br>
the current directory. The found data is used to match MAC
address to your provided host name or replace MAC addresses
in debug output and logs. Host names are much easier <br>
to remember than MAC addresses.</p>

<p style="margin-top: 1em">SEE ALSO <br>
ping(1), traceroute(1), tcpdump(1), dmesg(1), dot(1)</p>

<p style="margin-top: 1em">AUTHOR <br>
batctl was written by Andreas Langer
&lt;an.langer@gmx.de&gt; and Marek Lindner
&lt;mareklindner@neomailbox.ch&gt;.</p>

<p style="margin-top: 1em">This manual page was written by
Simon Wunderlich &lt;sw@simonwunderlich.de&gt;, Marek
Lindner &lt;mareklindner@neomailbox.ch&gt; and Andrew Lunn
&lt;andrew@lunn.ch&gt;</p>

<p style="margin-top: 1em">Linux July 17, 2015
BATCTL(8)</p>
<hr>
</body>
</html>
