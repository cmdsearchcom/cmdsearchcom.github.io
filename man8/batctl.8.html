<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>BATCTL(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">BATCTL(8)</td>
    <td class="head-vol">B.A.T.M.A.N. Advanced Control Tool</td>
    <td class="head-rtitle">BATCTL(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
batctl - B.A.T.M.A.N. advanced control and management tool
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>batctl
  [<i>options</i>]&#x00A0;<i>command</i>|<i>debug&#x00A0;table</i>&#x00A0;[
  <i>parameters</i>]</b>
<div>&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
batctl offers a convenient way to configure the batman-adv kernel module as well
  as displaying debug information such as originator tables, translation tables
  and the debug log. In combination with a bat-hosts file batctl allows the use
  of host names instead of MAC addresses.
<div class="Pp"></div>
B.A.T.M.A.N. advanced operates on layer 2. Thus all hosts participating in the
  virtual switched network are transparently connected together for all
  protocols above layer 2. Therefore the common diagnosis tools do not work as
  expected. To overcome these problems batctl contains the commands <b>ping</b>,
  <b>traceroute</b>, <b>tcpdump</b> which provide similar functionality to the
  normal <b>ping</b>(1), <b>traceroute</b>(1), <b>tcpdump</b>(1) commands, but
  modified to layer 2 behaviour or using the B.A.T.M.A.N. advanced protocol. For
  similar reasons, <b>throughputmeter</b>, a command to test network
  performances, is also included.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><i><b>options:</b></i></dt>
  <dd class="It-tag">-m specify mesh interface or VLAN created on top of a mesh
      interface (default 'bat0')
    <div>&#x00A0;</div>
    -h print general batctl help
    <div>&#x00A0;</div>
    -v print batctl version and batman-adv version (if the module is loaded)
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i><b>commands:</b></i></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>interface</b>|<b>if</b> [<b>-M</b>] [<b>add</b>|<b>del
    iface(s)</b>]</dt>
  <dd class="It-tag">If no parameter is given or the first parameter is neither
      &quot;add&quot; nor &quot;del&quot; the current interface settings are
      displayed. In order to add or delete interfaces specify &quot;add&quot; or
      &quot;del&quot; as first argument and append the interface names you wish
      to add or delete. Multiple interfaces can be specified. The &quot;-M&quot;
      option tells batctl to not automatically create the batman-adv interface
      on &quot;add&quot; or to destroy it when &quot;del&quot; removed all
      interfaces which belonged to it.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>interface</b>|<b>if</b>
    [<b>create</b>|<b>destroy</b>]</dt>
  <dd class="It-tag">A batman-adv interface without attached interfaces can be
      created using &quot;create&quot;. The parameter &quot;destroy&quot; can be
      used to free all attached interfaces and remove batman-adv interface.
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>orig_interval</b>|<b>it</b> [<b>interval</b>]</dt>
  <dd class="It-tag">If no parameter is given the current originator interval
      setting is displayed otherwise the parameter is used to set the originator
      interval. The interval is in units of milliseconds.
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ap_isolation</b>|<b>ap</b> [<b>0</b>|<b>1</b>]</dt>
  <dd class="It-tag">If no parameter is given the current ap isolation setting
      is displayed. Otherwise the parameter is used to enable or disable ap
      isolation. This command can be used in conjunction with &quot;-m&quot;
      option to target per VLAN configurations.
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>bridge_loop_avoidance</b>|<b>bl</b>
    [<b>0</b>|<b>1</b>]</dt>
  <dd class="It-tag">If no parameter is given the current bridge loop avoidance
      setting is displayed. Otherwise the parameter is used to enable or disable
      the bridge loop avoidance. Bridge loop avoidance support has to be enabled
      when compiling the module otherwise this option won't be available.
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>distributed_arp_table</b>|<b>dat</b>
    [<b>0</b>|<b>1</b>]</dt>
  <dd class="It-tag">If no parameter is given the current distributed arp table
      setting is displayed. Otherwise the parameter is used to enable or disable
      the distributed arp table.
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>aggregation</b>|<b>ag</b> [<b>0</b>|<b>1</b>]</dt>
  <dd class="It-tag">If no parameter is given the current aggregation setting is
      displayed. Otherwise the parameter is used to enable or disable OGM packet
      aggregation.
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>bonding</b>|<b>b</b> [<b>0</b>|<b>1</b>]</dt>
  <dd class="It-tag">If no parameter is given the current bonding mode setting
      is displayed. Otherwise the parameter is used to enable or disable the
      bonding mode.
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>fragmentation</b>|<b>f</b> [<b>0</b>|<b>1</b>]</dt>
  <dd class="It-tag">If no parameter is given the current fragmentation mode
      setting is displayed. Otherwise the parameter is used to enable or disable
      fragmentation.
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>network_coding</b>|<b>nc</b> [<b>0</b>|<b>1</b>]</dt>
  <dd class="It-tag">If no parameter is given the current network coding mode
      setting is displayed. Otherwise the parameter is used to enable or disable
      network coding.
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>multicast_mode</b>|<b>mm</b> [<b>0</b>|<b>1</b>]</dt>
  <dd class="It-tag">If no parameter is given the current multicast mode setting
      is displayed. Otherwise the parameter is used to enable or disable
      multicast optimizations (i.e. disabling means always sending own multicast
      frames via classic flooding).
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>loglevel</b>|<b>ll</b> [<b>level</b>[ <b>level</b>[
    <b>level</b>]] <b>...</b>]</dt>
  <dd class="It-tag">If no parameter is given the current log level settings are
      displayed otherwise the parameter(s) is/are used to set the log level.
      Level 'none' disables all verbose logging. Level 'batman' enables messages
      related to routing / flooding / broadcasting. Level 'routes' enables
      messages related to routes being added / changed / deleted. Level 'tt'
      enables messages related to translation table operations. Level 'bla'
      enables messages related to the bridge loop avoidance. Level 'dat' enables
      messages related to ARP snooping and the Distributed Arp Table. Level 'nc'
      enables messages related to network coding. Level 'mcast' enables messages
      related to multicast optimizations. Level 'all' enables all messages. The
      messages are sent to the batman-adv debug log. Use <b>batctl log</b> to
      retrieve it. Make sure to have debugging output enabled when compiling the
      module otherwise the output as well as the loglevel options won't be
      available.
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>log</b>|<b>l</b> [<b>-n</b>]<b></b></dt>
  <dd class="It-tag">batctl will read the batman-adv debug log which has to be
      compiled into the kernel module. If &quot;-n&quot; is given batctl will
      not replace the MAC addresses with bat-host names in the output.
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>gw_mode|gw</b> [<b>off</b>|<b>client</b>|<b>server</b>]
    [ <b>sel_class|bandwidth</b>]<b></b></dt>
  <dd class="It-tag">If no parameter is given the current gateway mode is
      displayed otherwise the parameter is used to set the gateway mode. The
      second (optional) argument specifies the selection class (if 'client' was
      the first argument) or the gateway bandwidth (if 'server' was the first
      argument). If the node is a server this parameter is used to inform other
      nodes in the network about this node's internet connection bandwidth. Just
      enter any number (optionally followed by &quot;kbit&quot; or
      &quot;mbit&quot;) and the batman-adv module will propagate the entered
      value in the mesh. Use &quot;/&quot; to separate the down&#x2010; and
      upload rates. You can omit the upload rate and the module will assume an
      upload of download / 5.</dd>
</dl>
<div style="margin-left: 17.00ex;">default: 10000 -&gt; 10.0/2.0 MBit</div>
<div style="margin-left: 16.00ex;">examples: 5000 -&gt; 5.0/1.0 MBit</div>
<div style="margin-left: 26.00ex;">
<br/>
 5000kbit
<br/>
 5mbit
<br/>
 5mbit/1024
<br/>
 5mbit/1024kbit
<br/>
 5mbit/1mbit</div>
<div style="margin-left: 7.00ex;">If the node is a gateway client the parameter
  will decide which criteria to consider when the batman-adv module has to
  choose between different internet connections announced by the aforementioned
  servers.</div>
<div style="margin-left: 17.00ex;">default: 20 -&gt; late switch (TQ 20)</div>
<div style="margin-left: 16.00ex;">examples: 1 -&gt; fast connection
<div style="margin-left: 16.00ex;">consider the gateway's advertised throughput
  as well as the link quality towards the gateway and stick with the selection
  until the gateway disappears</div>
</div>
<div style="margin-left: 25.00ex;">
<br/>
 2 -&gt; stable connection
<div style="margin-left: 7.00ex;">chooses the gateway with the best link quality
  and sticks with it (ignore the advertised throughput)</div>
<br/>
 3 -&gt; fast switch connection
<div style="margin-left: 7.00ex;">chooses the gateway with the best link quality
  but switches to another gateway as soon as a better one is found</div>
<br/>
 XX -&gt; late switch connection
<div style="margin-left: 7.00ex;">chooses the gateway with the best link quality
  but switches to another gateway as soon as a better one is found which is at
  least XX TQ better than the currently selected gateway (XX has to be a number
  between 3 and 256).</div>
</div>
<div>&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>routing_algo</b>|<b>ra</b>
    [<b>algorithm</b>]<b></b></dt>
  <dd class="It-tag">If no parameter is given the current routing algorithm
      configuration as well as supported routing algorithms are displayed.
      Otherwise the parameter is used to select the routing algorithm for the
      following batX interface to be created.
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>isolation_mark</b>|<b>mark</b></dt>
  <dd class="It-tag">If no parameter is given the current isolation mark value
      is displayed. Otherwise the parameter is used to set or unset the
      isolation mark used by the Extended Isolation feature.
    <div>&#x00A0;</div>
    The input is supposed to be of the form $value/$mask, where $value can be
      any 32bit long integer (expressed in decimal or hex base) and $mask is a
      generic bitmask (expressed in hex base) that selects the bits to take into
      consideration from $value. It is also possible to enter the input using
      only $value and in this case the full bitmask is used by default.
    <div style="height: 1.00em;">&#x00A0;</div>
    <div>&#x00A0;</div>
    <div>&#x00A0;</div>
    Example 1: 0x00000001/0xffffffff
    <div>&#x00A0;</div>
    Example 2: 0x00040000/0xffff0000
    <div>&#x00A0;</div>
    Example 3: 16 or 0x0F
    <div>&#x00A0;</div>
    <div>&#x00A0;</div>
  </dd>
</dl>
<div class="Pp"></div>
<i><b>debug tables:</b></i>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">The batman-adv kernel module comes with a variety of debug
      tables containing various information about the state of the mesh seen by
      each individual node. These tables are exported via debugfs and easily
      accessible via batctl. You will need debugfs support compiled into your
      kernel and preferably have mounted the debugfs to a well-known mountpoint.
      If debugfs is not mounted batctl will attempt to do this step for you.
    <div style="height: 1.00em;">&#x00A0;</div>
    All of the debug tables support the following options:</dd>
</dl>
<div style="margin-left: 10.00ex;">-w refresh the list every second or add a
  number to let it refresh at a custom interval in seconds (with optional
  decimal places)</div>
<div style="margin-left: 10.00ex;">-n do not replace the MAC addresses with
  bat-host names in the output</div>
<div style="margin-left: 10.00ex;">-H do not show the header of the debug
  table</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 7.00ex;">The originator table also supports the
  &quot;-t&quot; filter option to remove all originators from the output that
  have not been seen for the specified amount of seconds (with optional decimal
  places). It furthermore supports the &quot;-i&quot; parameter to specify an
  interface for which the originator table should be printed. If this parameter
  is not supplied, the default originator table is printed.
<div style="height: 1.00em;">&#x00A0;</div>
The local and global translation tables also support the &quot;-u&quot; and
  &quot;-m&quot; option to only display unicast or multicast translation table
  announcements respectively.
<div style="height: 1.00em;">&#x00A0;</div>
List of debug tables:
<div style="margin-left: 10.00ex;">- neighbors|n</div>
<div style="margin-left: 10.00ex;">- originators|o</div>
<div style="margin-left: 10.00ex;">- gateways|gwl</div>
<div style="margin-left: 10.00ex;">- translocal|tl</div>
<div style="margin-left: 10.00ex;">- transglobal|tg</div>
<div style="margin-left: 10.00ex;">- claimtable|cl (compile time option)</div>
<div style="margin-left: 10.00ex;">- backbonetable|bbt (compile time
  option)</div>
<div style="margin-left: 10.00ex;">- dat_cache|dc (compile time option)</div>
<div style="margin-left: 10.00ex;">- nc_nodes|nn (compile time option)</div>
<div style="margin-left: 10.00ex;">- mcast_flags|mf (compile time option)</div>
</div>
<div>&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>translate</b>|<b>t</b>
    <b>MAC_address</b>|<b>bat-host_name</b>|
    <b>host_name</b>|<b>IP_address</b></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    Translates a destination (hostname, IP, MAC, bat_host-name) to the
      originator mac address responsible for it.
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>statistics</b>|<b>s</b></dt>
  <dd class="It-tag">Retrieve traffic counters from batman-adv kernel module.
      The output may vary depending on which features have been compiled into
      the kernel module.
    <div>&#x00A0;</div>
    Each module subsystem has its own counters which are indicated by their
      prefixes:</dd>
</dl>
<div style="margin-left: 15.00ex;">mgmt - mesh protocol counters</div>
<div style="margin-left: 17.00ex;">tt - translation table counters</div>
<div style="margin-left: 7.00ex;">All counters without a prefix concern payload
  (pure user data) traffic.</div>
<div>&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ping</b>|<b>p</b> [<b>-c count</b>][<b>-i
    interval</b>][<b>-t time</b>][<b>-R</b>][<b>-T</b>]
    <b>MAC_address</b>|<b>bat-host_name</b>|
    <b>host_name</b>|<b>IP_address</b></dt>
  <dd class="It-tag">Layer 2 ping of a MAC address or bat-host name. batctl will
      try to find the bat-host name if the given parameter was not a MAC
      address. It can also try to guess the MAC address using an IPv4/IPv6
      address or a hostname when the IPv4/IPv6 address was configured on top of
      the batman-adv interface of the destination device and both source and
      destination devices are in the same IP subnet. The &quot;-c&quot; option
      tells batctl how man pings should be sent before the program exits.
      Without the &quot;-c&quot; option batctl will continue pinging without
      end. Use CTRL + C to stop it. With &quot;-i&quot; and &quot;-t&quot; you
      can set the default interval between pings and the timeout time for
      replies, both in seconds. When run with &quot;-R&quot;, the route taken by
      the ping messages will be recorded. With &quot;-T&quot; you can disable
      the automatic translation of a client MAC address to the originator
      address which is responsible for this client.
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>traceroute</b>|<b>tr</b> [<b>-n</b>][<b>-T</b>]
    <b>MAC_address</b>|
    <b>bat-host_name</b>|<b>host_name</b>|<b>IP_address</b></dt>
  <dd class="It-tag">Layer 2 traceroute to a MAC address or bat-host name.
      batctl will try to find the bat-host name if the given parameter was not a
      MAC address. It can also try to guess the MAC address using an IPv4/IPv6
      address or a hostname when the IPv4/IPv6 address was configured on top of
      the batman-adv interface of the destination device and both source and
      destination devices are in the same IP subnet. batctl will send 3 packets
      to each host and display the response time. If &quot;-n&quot; is given
      batctl will not replace the MAC addresses with bat-host names in the
      output. With &quot;-T&quot; you can disable the automatic translation of a
      client MAC address to the originator address which is responsible for this
      client.
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>tcpdump</b>|<b>td</b> [<b>-c</b>][<b>-n</b>][<b>-p
    filter</b>][ <b>-x filter</b>] <b>interface ...</b></dt>
  <dd class="It-tag">batctl will display all packets that are seen on the given
      interface(s). A variety of options to filter the output are available: To
      only print packets that match the compatibility number of batctl specify
      the &quot;-c&quot; (compat filter) option. If &quot;-n&quot; is given
      batctl will not replace the MAC addresses with bat-host names in the
      output. To filter the shown packet types you can either use &quot;-p&quot;
      (dump only specified packet types) or &quot;-x&quot; (dump all packet
      types except specified). The following packet types are available:</dd>
</dl>
<div style="margin-left: 17.00ex;">1 - batman ogm packets</div>
<div style="margin-left: 17.00ex;">2 - batman icmp packets</div>
<div style="margin-left: 17.00ex;">4 - batman unicast packets</div>
<div style="margin-left: 17.00ex;">8 - batman broadcast packets</div>
<div style="margin-left: 16.00ex;">16 - batman unicast tvlv packets</div>
<div style="margin-left: 16.00ex;">32 - batman fragmented packets</div>
<div style="margin-left: 16.00ex;">64 - batman tt / roaming packets</div>
<div style="margin-left: 15.00ex;">128 - non batman packets</div>
<div style="margin-left: 7.00ex;">Example: batctl td &lt;interface&gt; -p 129
  -&gt; only display batman ogm packets and non batman packets</div>
<div>&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>bisect_iv</b> [<b>-l MAC</b>][<b>-t MAC</b>][<b>-r
    MAC</b>][ <b>-s min</b> [<b>- max</b>]][<b>-o MAC</b>][<b>-n</b>]
    <b>logfile1</b> [ <b>logfile2</b> ... <b>logfileN</b>]</dt>
  <dd class="It-tag">Analyses the B.A.T.M.A.N. IV logfiles to build a small
      internal database of all sent sequence numbers and routing table changes.
      This database can then be analyzed in a number of different ways. With
      &quot;-l&quot; the database can be used to search for routing loops. Use
      &quot;-t&quot; to trace OGMs of a host throughout the network. Use
      &quot;-r&quot; to display routing tables of the nodes. The option
      &quot;-s&quot; can be used to limit the output to a range of sequence
      numbers, between min and max, or to one specific sequence number, min.
      Furthermore using &quot;-o&quot; you can filter the output to a specified
      originator. If &quot;-n&quot; is given batctl will not replace the MAC
      addresses with bat-host names in the output.</dd>
</dl>
<div>&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>throughputmeter</b>|<b>tp</b> <b>MAC</b></dt>
  <dd class="It-tag">This command starts a throughput test entirely controlled
      by batman module in kernel space: the computational resources needed to
      align memory and copy data between user and kernel space that are required
      by other user space tools may represent a bootleneck on some low profile
      device.
    <div style="height: 1.00em;">&#x00A0;</div>
    The test consist of the transfer of 14 MB of data between the two nodes. The
      protocol used to transfer the data is somehow similar to TCP, but simpler:
      some TCP features are still missing, thus protocol performances could be
      worst. Since a fixed amount of data is transferred the experiment duration
      depends on the network conditions. The experiment can be interrupted with
      CTRL + C. At the end of a successful experiment the throughput in KBytes
      per second is returned, togheter with the experiment duration in
      millisecond and the amount of bytes transferred. If too many packets are
      lost or the specified MAC address is not reachable, a message notifing the
      error is returned instead of the result.</dd>
</dl>
<div>&#x00A0;</div>
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><i><b>bat-hosts</b></i></dt>
  <dd class="It-tag">This file is similar to the /etc/hosts file. You can write
      one MAC address and one host name per line. batctl will search for
      bat-hosts in /etc, your home directory and the current directory. The
      found data is used to match MAC address to your provided host name or
      replace MAC addresses in debug output and logs. Host names are much easier
      to remember than MAC addresses.</dd>
</dl>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>ping</b>(1), <b>traceroute</b>(1), <b>tcpdump</b>(1), <b>dmesg</b>(1),
  <b>dot</b>(1)
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
batctl was written by Andreas Langer &lt;an.langer@gmx.de&gt; and Marek Lindner
  &lt;mareklindner@neomailbox.ch&gt;.
<div class="Pp"></div>
This manual page was written by Simon Wunderlich &lt;sw@simonwunderlich.de&gt;,
  Marek Lindner &lt;mareklindner@neomailbox.ch&gt; and Andrew Lunn
  &lt;andrew@lunn.ch&gt;</div>
<table class="foot">
  <tr>
    <td class="foot-date">July 17, 2015</td>
    <td class="foot-os">Linux</td>
  </tr>
</table>
</body>
</html>
