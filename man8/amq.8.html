<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>AMQ(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">AMQ(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">AMQ(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
amq - automounter query tool
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>amq</b> [ <b>-fmpqsvwHTU</b> ] [ <b>-h</b><i> hostname</i> ] [ <b>-l</b><i>
  log_file</i> ] [ <b>-x</b><i> log_options</i> ] [ <b>-D</b><i>
  debug_options</i> ] [ <b>-P</b><i> program_number</i> ] [[ <b>-u</b> ]
  <i>directory ...</i> ]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>Amq</b> provides a simple way of determining the current state of <b>amd</b>
  program. Communication is by <small>RPC.</small> Three modes of operation are
  supported by the current protocol. By default a list of mount points and
  auto-mounted filesystems is output. An alternative host can be specified using
  the <i>-h</i> option.
<div class="Pp"></div>
If <i>directory</i> names are given, as output by default, then per-filesystem
  information is displayed.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b></dt>
  <dd class="It-tag">Ask the automounter to flush the internal caches and reload
      all the maps.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h</b><i> hostname</i></dt>
  <dd class="It-tag">Specify an alternate host to query. By default the local
      host is used. In an <small>HP-UX</small> cluster, the root server is
      queried by default, since that is the system on which the automounter is
      normally run.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l</b><i> log_file</i></dt>
  <dd class="It-tag">Tell amd to use <i>log_file</i> as the log file name. For
      security reasons, this must be the same log file which amd used when
      started. This option is therefore only useful to refresh amd's open file
      handle on the log file, so that it can be rotated and compressed via daily
      cron jobs.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-m</b></dt>
  <dd class="It-tag">Ask the automounter to provide a list of mounted
      filesystems, including the number of references to each filesystem and any
      error which occurred while mounting.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p</b></dt>
  <dd class="It-tag">Return the process ID of the remote or locally running amd.
      Useful when you need to send a signal to the local amd process, and would
      rather not have to search through the process table. This option is used
      in the <i>ctl-amd</i> script.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-q</b></dt>
  <dd class="It-tag">Suppress error messages produced when attempting
      synchronous unmounts with the <b>-u</b> option.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s</b></dt>
  <dd class="It-tag">Ask the automounter to provide system-wide mount
      statistics.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-u</b></dt>
  <dd class="It-tag">Ask the automounter to unmount the filesystems named in
      <i>directory</i> instead of providing information about them. Unmounts are
      requested, not forced. They merely cause the mounted filesystem to
      timeout, which will be picked up by <b>amd</b>'s main scheduler thus
      causing the normal timeout action to be taken. If the <b>-u</b> option is
      repeated, <b>amq</b> will attempt to unmount the file system synchronously
      by waiting until the timeout action is taken and returning an error if the
      unmount fails. Any error messages produced may be suppressed with the
      <b>-q</b> option.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v</b></dt>
  <dd class="It-tag">Ask the automounter for its version information. This is a
      subset of the information output by <b>amd</b>'s <i>-v</i> option.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-w</b></dt>
  <dd class="It-tag">Translate a full pathname as returned by <i>getcwd</i>(3)
      into a short <b>Amd</b> pathname that goes through its mount points. This
      option requires that <b>Amd</b> is running.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-x</b><i> log_options</i></dt>
  <dd class="It-tag">Ask the automounter to use the logging options specified in
      <i>log_options</i> from now on. Note that the &quot;fatal&quot; and
      &quot;error&quot; options cannot be turned off.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-D</b><i> debug_options</i></dt>
  <dd class="It-tag">Ask the automounter to use the debugging options specified
      in <i>debug_options</i> from now on.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-H</b></dt>
  <dd class="It-tag">Display short usage message.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-P</b><i> program_number</i></dt>
  <dd class="It-tag">Contact an alternate running amd that had registered itself
      on a different RPC <i>program_number</i> and apply all other operations to
      that instance of the automounter. This is useful when you run multiple
      copies of amd, and need to manage each one separately. If not specified,
      amq will use the default program number for amd, 300019. For security
      reasons, the only alternate program numbers amd can use range from 300019
      to 300029, inclusive.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-T</b></dt>
  <dd class="It-tag">Contact <b>amd</b> using the TCP transport only. Normally
      <b>amq</b> will try TCP, and if that failed, will try UDP.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-U</b></dt>
  <dd class="It-tag">Contact <b>amd</b> using UDP (connectionless) transport
      only. Normally <b>amq</b> will try TCP, and if that failed, will try UDP.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>amq.x</b></dt>
  <dd class="It-tag"><small>RPC</small> protocol description.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="CAVEATS"><a class="selflink" href="#CAVEATS">CAVEATS</a></h1>
<b>Amq</b> uses a Sun registered <small>RPC</small> program number (300019
  decimal) which may not be in the /etc/rpc database.
<div class="Pp"></div>
If the TCP wrappers library is available, and the <b>use_tcpwrappers</b> global
  <b>amd.conf</b> option is set to ``yes'', then <b>amd</b> will verify that the
  host running <b>amq</b> is authorized to connect. The <i>amd</i> service name
  must used in the <b>/etc/hosts.allow</b> and <b>/etc/hosts.deny</b> files. For
  example, to allow only localhost to connect to <b>amd,</b> add this line to
  <b>/etc/hosts.allow:</b>
<div class="Pp"></div>
<div style="margin-left: 5.00ex;">amd: localhost</div>
<div class="Pp"></div>
and this line to <b>/etc/hosts.deny:</b>
<div class="Pp"></div>
<div style="margin-left: 5.00ex;">amd: ALL</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>amd</b>(8), <b>amd.conf</b>(5), <b>hosts_access</b>(5).
<div class="Pp"></div>
``am-utils'' <b>info</b>(1) entry.
<div class="Pp"></div>
<i>Linux NFS and Automounter Administration</i> by Erez Zadok, ISBN
  0-7821-2739-8, (Sybex, 2001).
<div class="Pp"></div>
<i>http://www.am-utils.org</i>
<div class="Pp"></div>
<i>Amd - The 4.4 BSD Automounter</i>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
Jan-Simon Pendry &lt;jsp@doc.ic.ac.uk&gt;, Department of Computing, Imperial
  College, London, UK.
<div class="Pp"></div>
Erez Zadok &lt;ezk@cs.sunysb.edu&gt;, Computer Science Department, Stony Brook
  University, Stony Brook, New York, USA.
<div class="Pp"></div>
Other authors and contributors to am-utils are listed in the <b>AUTHORS</b> file
  distributed with am-utils.</div>
<table class="foot">
  <tr>
    <td class="foot-date">25 April 1989</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
