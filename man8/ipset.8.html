<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>IPSET(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">IPSET(8)</td>
    <td class="head-vol"></td>
    <td class="head-rtitle">IPSET(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
ipset &#x2014; administration tool for IP sets
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>ipset</b> [ <i>OPTIONS</i> ] <i>COMMAND</i> [ <i>COMMAND-OPTIONS</i> ]
<div class="Pp"></div>
COMMANDS := { <b>create</b> | <b>add</b> | <b>del</b> | <b>test</b> |
  <b>destroy</b> | <b>list</b> | <b>save</b> | <b>restore</b> | <b>flush</b> |
  <b>rename</b> | <b>swap</b> | <b>help</b> | <b>version</b> | <b>-</b> }
<div class="Pp"></div>
<i>OPTIONS</i> := { <b>-exist</b> | <b>-output</b> { <b>plain</b> | <b>save</b>
  | <b>xml</b> } | <b>-quiet</b> | <b>-resolve</b> | <b>-sorted</b> |
  <b>-name</b> | <b>-terse</b> | <b>-file</b> <i>filename</i> }
<div class="Pp"></div>
<b>ipset</b> <b>create</b> <i>SETNAME</i> <i>TYPENAME</i> [
  <i>CREATE-OPTIONS</i> ]
<div class="Pp"></div>
<b>ipset</b> <b>add</b> <i>SETNAME</i> <i>ADD-ENTRY</i> [ <i>ADD-OPTIONS</i> ]
<div class="Pp"></div>
<b>ipset</b> <b>del</b> <i>SETNAME</i> <i>DEL-ENTRY</i> [ <i>DEL-OPTIONS</i> ]
<div class="Pp"></div>
<b>ipset</b> <b>test</b> <i>SETNAME</i> <i>TEST-ENTRY</i> [ <i>TEST-OPTIONS</i>
  ]
<div class="Pp"></div>
<b>ipset</b> <b>destroy</b> [ <i>SETNAME</i> ]
<div class="Pp"></div>
<b>ipset</b> <b>list</b> [ <i>SETNAME</i> ]
<div class="Pp"></div>
<b>ipset</b> <b>save</b> [ <i>SETNAME</i> ]
<div class="Pp"></div>
<b>ipset</b> <b>restore</b>
<div class="Pp"></div>
<b>ipset</b> <b>flush</b> [ <i>SETNAME</i> ]
<div class="Pp"></div>
<b>ipset</b> <b>rename</b> <i>SETNAME-FROM</i> <i>SETNAME-TO</i>
<div class="Pp"></div>
<b>ipset</b> <b>swap</b> <i>SETNAME-FROM</i> <i>SETNAME-TO</i>
<div class="Pp"></div>
<b>ipset</b> <b>help</b> [ <i>TYPENAME</i> ]
<div class="Pp"></div>
<b>ipset</b> <b>version</b>
<div class="Pp"></div>
<b>ipset</b> <b>-</b>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>ipset</b> is used to set up, maintain and inspect so called IP sets in the
  Linux kernel. Depending on the type of the set, an IP set may store IP(v4/v6)
  addresses, (TCP/UDP) port numbers, IP and MAC address pairs, IP address and
  port number pairs, etc. See the set type definitions below.
<div class="Pp"></div>
<b>Iptables</b> matches and targets referring to sets create references, which
  protect the given sets in the kernel. A set cannot be destroyed while there is
  a single reference pointing to it.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
The options that are recognized by <b>ipset</b> can be divided into several
  different groups.
<h2 class="Ss" title="Ss" id="COMMANDS"><a class="selflink" href="#COMMANDS">COMMANDS</a></h2>
These options specify the desired action to perform. Only one of them can be
  specified on the command line unless otherwise specified below. For all the
  long versions of the command names, you need to use only enough letters to
  ensure that <b>ipset</b> can differentiate it from all other commands. The
  <b>ipset</b> parser follows the order here when looking for the shortest match
  in the long command names.
<dl class="Bl-tag">
  <dt class="It-tag"><b>n</b>, <b>create</b> <i>SETNAME</i> <i>TYPENAME</i> [
    <i>CREATE-OPTIONS</i> ]</dt>
  <dd class="It-tag">Create a set identified with setname and specified type.
      The type may require type specific options. If the <b>-exist</b> option is
      specified, <b>ipset</b> ignores the error otherwise raised when the same
      set (setname and create parameters are identical) already exists.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>add</b> <i>SETNAME</i> <i>ADD-ENTRY</i> [
    <i>ADD-OPTIONS</i> ]</dt>
  <dd class="It-tag">Add a given entry to the set. If the <b>-exist</b> option
      is specified, <b>ipset</b> ignores if the entry already added to the
    set.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>del</b> <i>SETNAME</i> <i>DEL-ENTRY</i> [
    <i>DEL-OPTIONS</i> ]</dt>
  <dd class="It-tag">Delete an entry from a set. If the <b>-exist</b> option is
      specified, <b>ipset</b> ignores if the entry does not added to (already
      expired from) the set.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>test</b> <i>SETNAME</i> <i>TEST-ENTRY</i> [
    <i>TEST-OPTIONS</i> ]</dt>
  <dd class="It-tag">Test wether an entry is in a set or not. Exit status number
      is zero if the tested entry is in the set and nonzero if it is missing
      from the set.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>x</b>, <b>destroy</b> [ <i>SETNAME</i> ]</dt>
  <dd class="It-tag">Destroy the specified set or all the sets if none is given.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the set has got reference(s), nothing is done and no set destroyed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>list</b> [ <i>SETNAME</i> ] [ <i>OPTIONS</i> ]</dt>
  <dd class="It-tag">List the header data and the entries for the specified set,
      or for all sets if none is given. The <b>-resolve</b> option can be used
      to force name lookups (which may be slow). When the <b>-sorted</b> option
      is given, the entries are listed sorted (if the given set type supports
      the operation). The option <b>-output</b> can be used to control the
      format of the listing: <b>plain</b>, <b>save</b> or <b>xml</b>. (The
      default is <b>plain</b>.) If the option <b>-name</b> is specified, just
      the names of the existing sets are listed. If the option <b>-terse</b> is
      specified, just the set names and headers are listed. The output is
      printed to stdout, the option <b>-file</b> can be used to specify a
      filename instead of stdout.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>save</b> [ <i>SETNAME</i> ]</dt>
  <dd class="It-tag">Save the given set, or all sets if none is given to stdout
      in a format that <b>restore</b> can read. The option <b>-file</b> can be
      used to specify a filename instead of stdout.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>restore</b></dt>
  <dd class="It-tag">Restore a saved session generated by <b>save</b>. The saved
      session can be fed from stdin or the option <b>-file</b> can be used to
      specify a filename instead of stdin.
    <div style="height: 1.00em;">&#x00A0;</div>
    Please note, existing sets and elements are not erased by <b>restore</b>
      unless specified so in the restore file. All commands are allowed in
      restore mode except <b>list</b>, <b>help</b>, <b>version</b>, interactive
      mode and <b>restore</b> itself.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>flush</b> [ <i>SETNAME</i> ]</dt>
  <dd class="It-tag">Flush all entries from the specified set or flush all sets
      if none is given.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>e</b>, <b>rename</b> <i>SETNAME-FROM</i>
    <i>SETNAME-TO</i></dt>
  <dd class="It-tag">Rename a set. Set identified by <i>SETNAME-TO</i> must not
      exist.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>w</b>, <b>swap</b> <i>SETNAME-FROM</i>
    <i>SETNAME-TO</i></dt>
  <dd class="It-tag">Swap the content of two sets, or in another words, exchange
      the name of two sets. The referred sets must exist and identical type of
      sets can be swapped only.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>help</b> [ <i>TYPENAME</i> ]</dt>
  <dd class="It-tag">Print help and set type specific help if <i>TYPENAME</i> is
      specified.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>version</b></dt>
  <dd class="It-tag">Print program version.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-</b></dt>
  <dd class="It-tag">If a dash is specified as command, then <b>ipset</b> enters
      a simple interactive mode and the commands are read from the standard
      input. The interactive mode can be finished by entering the pseudo-command
      <b>quit</b>.</dd>
</dl>
<h2 class="Ss" title="Ss" id="OTHER_OPTIONS"><a class="selflink" href="#OTHER_OPTIONS">OTHER
  OPTIONS</a></h2>
The following additional options can be specified. The long option names cannot
  be abbreviated.
<dl class="Bl-tag">
  <dt class="It-tag"><b>-!</b>, <b>-exist</b></dt>
  <dd class="It-tag">Ignore errors when exactly the same set is to be created or
      already added entry is added or missing entry is deleted.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-o</b>, <b>-output</b> { <b>plain</b> | <b>save</b> |
    <b>xml</b> }</dt>
  <dd class="It-tag">Select the output format to the <b>list</b> command.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-q</b>, <b>-quiet</b></dt>
  <dd class="It-tag">Suppress any output to stdout and stderr. <b>ipset</b> will
      still exit with error if it cannot continue.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-r</b>, <b>-resolve</b></dt>
  <dd class="It-tag">When listing sets, enforce name lookup. The program will
      try to display the IP entries resolved to host names which requires
      <b>slow</b> DNS lookups.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s</b>, <b>-sorted</b></dt>
  <dd class="It-tag">Sorted output. When listing sets entries are listed sorted.
      Not supported yet.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n</b>, <b>-name</b></dt>
  <dd class="It-tag">List just the names of the existing sets, i.e. suppress
      listing of set headers and members.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-t</b>, <b>-terse</b></dt>
  <dd class="It-tag">List the set names and headers, i.e. suppress listing of
      set members.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b>, <b>-file</b> <i>filename</i></dt>
  <dd class="It-tag">Specify a filename to print into instead of stdout (
      <b>list</b> or <b>save</b> commands) or read from instead of stdin (
      <b>restore</b> command).</dd>
</dl>
<h1 class="Sh" title="Sh" id="INTRODUCTION"><a class="selflink" href="#INTRODUCTION">INTRODUCTION</a></h1>
A set type comprises of the storage method by which the data is stored and the
  data type(s) which are stored in the set. Therefore the <i>TYPENAME</i>
  parameter of the <b>create</b> command follows the syntax
<div style="height: 1.00em;">&#x00A0;</div>
<i>TYPENAME</i> :=
  <i>method</i><b>:</b><i>datatype</i>[<b>,</b><i>datatype</i>[<b>,</b><i>datatype</i>]]
<div style="height: 1.00em;">&#x00A0;</div>
where the current list of the methods are <b>bitmap</b>, <b>hash</b>, and
  <b>list</b> and the possible data types are <b>ip</b>, <b>net</b>, <b>mac</b>,
  <b>port</b> and <b>iface</b>. The dimension of a set is equal to the number of
  data types in its type name.
<div style="height: 1.00em;">&#x00A0;</div>
When adding, deleting or testing entries in a set, the same comma separated data
  syntax must be used for the entry parameter of the commands, i.e
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo ipaddr,portnum,ipaddr</dd>
</dl>
<div class="Pp"></div>
If host names or service names with dash in the name are used instead of IP
  addresses or service numbers, then the host name or service name must be
  enclosed in square brackets. Example:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo [test-hostname],[ftp-data]</dd>
</dl>
<div class="Pp"></div>
In the case of host names the DNS resolver is called internally by <b>ipset</b>
  but if it returns multiple IP addresses, only the first one is used.
<div style="height: 1.00em;">&#x00A0;</div>
The <b>bitmap</b> and <b>list</b> types use a fixed sized storage. The
  <b>hash</b> types use a hash to store the elements. In order to avoid clashes
  in the hash, a limited number of chaining, and if that is exhausted, the
  doubling of the hash size is performed when adding entries by the <b>ipset</b>
  command. When entries added by the <b>SET</b> target of
  <b>iptables/ip6tables</b>, then the hash size is fixed and the set won't be
  duplicated, even if the new entry cannot be added to the set.
<h1 class="Sh" title="Sh" id="GENERIC_CREATE_AND_ADD_OPTIONS"><a class="selflink" href="#GENERIC_CREATE_AND_ADD_OPTIONS">GENERIC
  CREATE AND ADD OPTIONS</a></h1>
<h2 class="Ss" title="Ss" id="timeout"><a class="selflink" href="#timeout">timeout</a></h2>
All set types supports the optional <b>timeout</b> parameter when creating a set
  and adding entries. The value of the <b>timeout</b> parameter for the
  <b>create</b> command means the default timeout value (in seconds) for new
  entries. If a set is created with timeout support, then the same
  <b>timeout</b> option can be used to specify non-default timeout values when
  adding entries. Zero timeout value means the entry is added permanent to the
  set. The timeout value of already added elements can be changed by readding
  the element using the <b>-exist</b> option. Example:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset create test hash:ip timeout 300</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add test 192.168.0.1 timeout 60</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset -exist add test 192.168.0.1 timeout 600</dd>
</dl>
<h2 class="Ss" title="Ss" id="nomatch"><a class="selflink" href="#nomatch">nomatch</a></h2>
The <b>hash</b> set types which can store <b>net</b> type of data (i.e.
  hash:*net*) support the optional <b>nomatch</b> option when adding entries.
  When matching elements in the set, entries marked as <b>nomatch</b> are
  skipped as if those were not added to the set, which makes possible to build
  up sets with exceptions. See the example at hash type <b>hash:net</b> below.
<div style="height: 1.00em;">&#x00A0;</div>
When elements are tested by <b>ipset</b>, the <b>nomatch</b> flags are taken
  into account. If one wants to test the existence of an element marked with
  <b>nomatch</b> in a set, then the flag must be specified too.
<h2 class="Ss" title="Ss" id="counters,_packets,_bytes"><a class="selflink" href="#counters,_packets,_bytes">counters,
  packets, bytes</a></h2>
All set types support the optional <b>counters</b> option when creating a set.
  If the option is specified then the set is created with packet and byte
  counters per element support. The packet and byte counters are initialized to
  zero when the elements are (re-)added to the set, unless the packet and byte
  counter values are explicitly specified by the <b>packets</b> and <b>bytes</b>
  options. An example when an element is added to a set with non-zero counter
  values:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset create foo hash:ip counters</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 192.168.1.1 packets 42 bytes 1024</dd>
</dl>
<h1 class="Sh" title="Sh" id="SET_TYPES"><a class="selflink" href="#SET_TYPES">SET
  TYPES</a></h1>
<h2 class="Ss" title="Ss" id="bitmap:ip"><a class="selflink" href="#bitmap:ip">bitmap:ip</a></h2>
The <b>bitmap:ip</b> set type uses a memory range to store either IPv4 host
  (default) or IPv4 network addresses. A <b>bitmap:ip</b> type of set can store
  up to 65536 entries.
<div class="Pp"></div>
<i>CREATE-OPTIONS</i> := <b>range</b>
  <i>fromip</i>-<i>toip</i>|<i>ip</i>/<i>cidr</i> [ <b>netmask</b> <i>cidr</i> ]
  [ <b>timeout</b> <i>value</i> ] [ <b>counters</b> ]
<div class="Pp"></div>
<i>ADD-ENTRY</i> := { <i>ip</i> | <i>fromip</i>-<i>toip</i> |
  <i>ip</i>/<i>cidr</i> }
<div class="Pp"></div>
<i>ADD-OPTIONS</i> := [ <b>timeout</b> <i>value</i> ] [ <b>packets</b>
  <i>value</i> ] [ <b>bytes</b> <i>value</i> ]
<div class="Pp"></div>
<i>DEL-ENTRY</i> := { <i>ip</i> | <i>fromip</i>-<i>toip</i> |
  <i>ip</i>/<i>cidr</i> }
<div class="Pp"></div>
<i>TEST-ENTRY</i> := <i>ip</i>
<div class="Pp"></div>
Mandatory <b>create</b> options:
<dl class="Bl-tag">
  <dt class="It-tag"><b>range</b>
    <i>fromip</i>-<i>toip</i>|<i>ip</i>/<i>cidr</i></dt>
  <dd class="It-tag">Create the set from the specified inclusive address range
      expressed in an IPv4 address range or network. The size of the range (in
      entries) cannot exceed the limit of maximum 65536 elements.</dd>
</dl>
<div class="Pp"></div>
Optional <b>create</b> options:
<dl class="Bl-tag">
  <dt class="It-tag"><b>netmask</b> <i>cidr</i></dt>
  <dd class="It-tag">When the optional <b>netmask</b> parameter specified,
      network addresses will be stored in the set instead of IP host addresses.
      The <i>cidr</i> prefix value must be between 1-32. An IP address will be
      in the set if the network address, which is resulted by masking the
      address with the specified netmask, can be found in the set.</dd>
</dl>
<div class="Pp"></div>
The <b>bitmap:ip</b> type supports adding or deleting multiple entries in one
  command.
<div class="Pp"></div>
Examples:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset create foo bitmap:ip range 192.168.0.0/16</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 192.168.1/24</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset test foo 192.168.1.1</dd>
</dl>
<h2 class="Ss" title="Ss" id="bitmap:ip,mac"><a class="selflink" href="#bitmap:ip,mac">bitmap:ip,mac</a></h2>
The <b>bitmap:ip,mac</b> set type uses a memory range to store IPv4 and a MAC
  address pairs. A <b>bitmap:ip,mac</b> type of set can store up to 65536
  entries.
<div class="Pp"></div>
<i>CREATE-OPTIONS</i> := <b>range</b>
  <i>fromip</i>-<i>toip</i>|<i>ip</i>/<i>cidr</i> [ <b>timeout</b> <i>value</i>
  ] [ <b>counters</b> ]
<div class="Pp"></div>
<i>ADD-ENTRY</i> := <i>ip</i>[,<i>macaddr</i>]
<div class="Pp"></div>
<i>ADD-OPTIONS</i> := [ <b>timeout</b> <i>value</i> ] [ <b>packets</b>
  <i>value</i> ] [ <b>bytes</b> <i>value</i> ]
<div class="Pp"></div>
<i>DEL-ENTRY</i> := <i>ip</i>[,<i>macaddr</i>]
<div class="Pp"></div>
<i>TEST-ENTRY</i> := <i>ip</i>[,<i>macaddr</i>]
<div class="Pp"></div>
Mandatory options to use when creating a <b>bitmap:ip,mac</b> type of set:
<dl class="Bl-tag">
  <dt class="It-tag"><b>range</b>
    <i>fromip</i>-<i>toip</i>|<i>ip</i>/<i>cidr</i></dt>
  <dd class="It-tag">Create the set from the specified inclusive address range
      expressed in an IPv4 address range or network. The size of the range
      cannot exceed the limit of maximum 65536 entries.</dd>
</dl>
<div class="Pp"></div>
The <b>bitmap:ip,mac</b> type is exceptional in the sense that the MAC part can
  be left out when adding/deleting/testing entries in the set. If we add an
  entry without the MAC address specified, then when the first time the entry is
  matched by the kernel, it will automatically fill out the missing MAC address
  with the source MAC address from the packet. If the entry was specified with a
  timeout value, the timer starts off when the IP and MAC address pair is
  complete.
<div class="Pp"></div>
The <b>bitmap:ip,mac</b> type of sets require two <b>src/dst</b> parameters of
  the <b>set</b> match and <b>SET</b> target netfilter kernel modules and the
  second one must be <b>src</b> to match, add or delete entries, because the
  <b>set</b> match and <b>SET</b> target have access to the source MAC address
  only.
<div class="Pp"></div>
Examples:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset create foo bitmap:ip,mac range 192.168.0.0/16</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 192.168.1.1,12:34:56:78:9A:BC</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset test foo 192.168.1.1</dd>
</dl>
<h2 class="Ss" title="Ss" id="bitmap:port"><a class="selflink" href="#bitmap:port">bitmap:port</a></h2>
The <b>bitmap:port</b> set type uses a memory range to store port numbers and
  such a set can store up to 65536 ports.
<div class="Pp"></div>
<i>CREATE-OPTIONS</i> := <b>range</b> <i>fromport</i>-<i>toport [
  </i><b>timeout</b> <i>value</i> ] [ <b>counters</b> ]
<div class="Pp"></div>
<i>ADD-ENTRY</i> := { <i>port</i> | <i>fromport</i>-<i>toport</i> }
<div class="Pp"></div>
<i>ADD-OPTIONS</i> := [ <b>timeout</b> <i>value</i> ] [ <b>packets</b>
  <i>value</i> ] [ <b>bytes</b> <i>value</i> ]
<div class="Pp"></div>
<i>DEL-ENTRY</i> := { <i>port</i> | <i>fromport</i>-<i>toport</i> }
<div class="Pp"></div>
<i>TEST-ENTRY</i> := <i>port</i>
<div class="Pp"></div>
Mandatory options to use when creating a <b>bitmap:port</b> type of set:
<dl class="Bl-tag">
  <dt class="It-tag"><b>range</b> <i>fromport</i>-<i>toport</i></dt>
  <dd class="It-tag">Create the set from the specified inclusive port
    range.</dd>
</dl>
<div class="Pp"></div>
The <b>set</b> match and <b>SET</b> target netfilter kernel modules interpret
  the stored numbers as TCP or UDP port numbers.
<div class="Pp"></div>
Examples:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset create foo bitmap:port range 0-1024</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 80</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset test foo 80</dd>
</dl>
<h2 class="Ss" title="Ss" id="hash:ip"><a class="selflink" href="#hash:ip">hash:ip</a></h2>
The <b>hash:ip</b> set type uses a hash to store IP host addresses (default) or
  network addresses. Zero valued IP address cannot be stored in a <b>hash:ip</b>
  type of set.
<div class="Pp"></div>
<i>CREATE-OPTIONS</i> := [ <b>family</b> { <b>inet</b> | <b>inet6</b> } ] | [
  <b>hashsize</b> <i>value</i> ] [ <b>maxelem</b> <i>value</i> ] [
  <b>netmask</b> <i>cidr</i> ] [ <b>timeout</b> <i>value</i> ] [ <b>counters</b>
  ]
<div class="Pp"></div>
<i>ADD-ENTRY</i> := <i>ipaddr</i>
<div class="Pp"></div>
<i>ADD-OPTIONS</i> := [ <b>timeout</b> <i>value</i> ] [ <b>packets</b>
  <i>value</i> ] [ <b>bytes</b> <i>value</i> ]
<div class="Pp"></div>
<i>DEL-ENTRY</i> := <i>ipaddr</i>
<div class="Pp"></div>
<i>TEST-ENTRY</i> := <i>ipaddr</i>
<div class="Pp"></div>
Optional <b>create</b> options:
<dl class="Bl-tag">
  <dt class="It-tag"><b>family</b> { <b>inet</b> | <b>inet6</b> }</dt>
  <dd class="It-tag">The protocol family of the IP addresses to be stored in the
      set. The default is <b>inet</b>, i.e IPv4.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>hashsize</b> <i>value</i></dt>
  <dd class="It-tag">The initial hash size for the set, default is 1024. The
      hash size must be a power of two, the kernel automatically rounds up non
      power of two hash sizes to the first correct value.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>maxelem</b> <i>value</i></dt>
  <dd class="It-tag">The maximal number of elements which can be stored in the
      set, default 65536.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>netmask</b> <i>cidr</i></dt>
  <dd class="It-tag">When the optional <b>netmask</b> parameter specified,
      network addresses will be stored in the set instead of IP host addresses.
      The <i>cidr</i> prefix value must be between 1-32 for IPv4 and between
      1-128 for IPv6. An IP address will be in the set if the network address,
      which is resulted by masking the address with the netmask, can be found in
      the set.</dd>
</dl>
<div class="Pp"></div>
For the <b>inet</b> family one can add or delete multiple entries by specifying
  a range or a network:
<div class="Pp"></div>
<i>ipaddr</i> := { <i>ip</i> | <i>fromaddr</i>-<i>toaddr</i> |
  <i>ip</i>/<i>cidr</i> }
<div class="Pp"></div>
Examples:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset create foo hash:ip netmask 30</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 192.168.1.0/24</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset test foo 192.168.1.2</dd>
</dl>
<h2 class="Ss" title="Ss" id="hash:net"><a class="selflink" href="#hash:net">hash:net</a></h2>
The <b>hash:net</b> set type uses a hash to store different sized IP network
  addresses. Network address with zero prefix size cannot be stored in this type
  of sets.
<div class="Pp"></div>
<i>CREATE-OPTIONS</i> := [ <b>family</b> { <b>inet</b> | <b>inet6</b> } ] | [
  <b>hashsize</b> <i>value</i> ] [ <b>maxelem</b> <i>value</i> ] [
  <b>timeout</b> <i>value</i> ] [ <b>counters</b> ]
<div class="Pp"></div>
<i>ADD-ENTRY</i> := <i>netaddr</i>
<div class="Pp"></div>
<i>ADD-OPTIONS</i> := [ <b>timeout</b> <i>value</i> ] [ <b>nomatch</b> ] [
  <b>packets</b> <i>value</i> ] [ <b>bytes</b> <i>value</i> ]
<div class="Pp"></div>
<i>DEL-ENTRY</i> := <i>netaddr</i>
<div class="Pp"></div>
<i>TEST-ENTRY</i> := <i>netaddr</i>
<div class="Pp"></div>
where <i>netaddr</i> := <i>ip</i>[/<i>cidr</i>]
<div class="Pp"></div>
Optional <b>create</b> options:
<dl class="Bl-tag">
  <dt class="It-tag"><b>family</b> { <b>inet</b> | <b>inet6</b> }</dt>
  <dd class="It-tag">The protocol family of the IP addresses to be stored in the
      set. The default is <b>inet</b>, i.e IPv4.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>hashsize</b> <i>value</i></dt>
  <dd class="It-tag">The initial hash size for the set, default is 1024. The
      hash size must be a power of two, the kernel automatically rounds up non
      power of two hash sizes to the first correct value.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>maxelem</b> <i>value</i></dt>
  <dd class="It-tag">The maximal number of elements which can be stored in the
      set, default 65536.</dd>
</dl>
<div class="Pp"></div>
For the <b>inet</b> family one can add or delete multiple entries by specifying
  a range, which is converted internally to network(s) equal to the range:
<div class="Pp"></div>
<i>netaddr</i> := { <i>ip</i>[/<i>cidr</i>] | <i>fromaddr</i>-<i>toaddr</i> }
<div class="Pp"></div>
When adding/deleting/testing entries, if the cidr prefix parameter is not
  specified, then the host prefix value is assumed. When adding/deleting
  entries, the exact element is added/deleted and overlapping elements are not
  checked by the kernel. When testing entries, if a host address is tested, then
  the kernel tries to match the host address in the networks added to the set
  and reports the result accordingly.
<div class="Pp"></div>
From the <b>set</b> netfilter match point of view the searching for a match
  always starts from the smallest size of netblock (most specific prefix) to the
  largest one (least specific prefix) added to the set. When adding/deleting IP
  addresses to the set by the <b>SET</b> netfilter target, it will be
  added/deleted by the most specific prefix which can be found in the set, or by
  the host prefix value if the set is empty.
<div class="Pp"></div>
The lookup time grows linearly with the number of the different prefix values
  added to the set.
<div class="Pp"></div>
Example:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset create foo hash:net</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 192.168.0.0/24</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 10.1.0.0/16</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 192.168.0/24</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 192.168.0/30 nomatch</dd>
</dl>
<div class="Pp"></div>
When matching the elements in the set above, all IP addresses will match from
  the networks 192.168.0.0/24, 10.1.0.0/16 and 192.168.0/24 except the ones from
  192.168.0/30.
<h2 class="Ss" title="Ss" id="hash:ip,port"><a class="selflink" href="#hash:ip,port">hash:ip,port</a></h2>
The <b>hash:ip,port</b> set type uses a hash to store IP address and port number
  pairs. The port number is interpreted together with a protocol (default TCP)
  and zero protocol number cannot be used.
<div class="Pp"></div>
<i>CREATE-OPTIONS</i> := [ <b>family</b> { <b>inet</b> | <b>inet6</b> } ] | [
  <b>hashsize</b> <i>value</i> ] [ <b>maxelem</b> <i>value</i> ] [
  <b>timeout</b> <i>value</i> ] [ <b>counters</b> ]
<div class="Pp"></div>
<i>ADD-ENTRY</i> := <i>ipaddr</i>,[<i>proto</i>:]<i>port</i>
<div class="Pp"></div>
<i>ADD-OPTIONS</i> := [ <b>timeout</b> <i>value</i> ] [ <b>packets</b>
  <i>value</i> ] [ <b>bytes</b> <i>value</i> ]
<div class="Pp"></div>
<i>DEL-ENTRY</i> := <i>ipaddr</i>,[<i>proto</i>:]<i>port</i>
<div class="Pp"></div>
<i>TEST-ENTRY</i> := <i>ipaddr</i>,[<i>proto</i>:]<i>port</i>
<div class="Pp"></div>
Optional <b>create</b> options:
<dl class="Bl-tag">
  <dt class="It-tag"><b>family</b> { <b>inet</b> | <b>inet6</b> }</dt>
  <dd class="It-tag">The protocol family of the IP addresses to be stored in the
      set. The default is <b>inet</b>, i.e IPv4.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>hashsize</b> <i>value</i></dt>
  <dd class="It-tag">The initial hash size for the set, default is 1024. The
      hash size must be a power of two, the kernel automatically rounds up non
      power of two hash sizes to the first correct value</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>maxelem</b> <i>value</i></dt>
  <dd class="It-tag">The maximal number of elements which can be stored in the
      set, default 65536.</dd>
</dl>
<div class="Pp"></div>
For the <b>inet</b> family one can add or delete multiple entries by specifying
  a range or a network of IPv4 addresses in the IP address part of the entry:
<div class="Pp"></div>
<i>ipaddr</i> := { <i>ip</i> | <i>fromaddr</i>-<i>toaddr</i> |
  <i>ip</i>/<i>cidr</i> }
<div class="Pp"></div>
The [ <i>proto</i>:]<i>port</i> part of the elements may be expressed in the
  following forms, where the range variations are valid when adding or deleting
  entries:
<dl class="Bl-tag">
  <dt class="It-tag"><i>portname[-portname]</i></dt>
  <dd class="It-tag">TCP port or range of ports expressed in TCP portname
      identifiers from /etc/services</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>portnumber[-portnumber]</i></dt>
  <dd class="It-tag">TCP port or range of ports expressed in TCP port
    numbers</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>tcp</b>|<b>sctp</b>|<b>udp</b>|<b>udplite</b>:<i>portname</i>|<i>portnumber</i>[-<i>portname</i>|<i>portnumber</i>]</dt>
  <dd class="It-tag">TCP, SCTP, UDP or UDPLITE port or port range expressed in
      port name(s) or port number(s)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>icmp</b>:<i>codename</i>|<i>type</i>/<i>code</i></dt>
  <dd class="It-tag">ICMP codename or type/code. The supported ICMP codename
      identifiers can always be listed by the help command.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>icmpv6</b>:<i>codename</i>|<i>type</i>/<i>code</i></dt>
  <dd class="It-tag">ICMPv6 codename or type/code. The supported ICMPv6 codename
      identifiers can always be listed by the help command.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>proto</i>:0</dt>
  <dd class="It-tag">All other protocols, as an identifier from /etc/protocols
      or number. The pseudo port number must be zero.</dd>
</dl>
<div class="Pp"></div>
The <b>hash:ip,port</b> type of sets require two <b>src</b>/<b>dst</b>
  parameters of the <b>set</b> match and <b>SET</b> target kernel modules.
<div class="Pp"></div>
Examples:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset create foo hash:ip,port</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 192.168.1.0/24,80-82</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 192.168.1.1,udp:53</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 192.168.1.1,vrrp:0</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset test foo 192.168.1.1,80</dd>
</dl>
<h2 class="Ss" title="Ss" id="hash:net,port"><a class="selflink" href="#hash:net,port">hash:net,port</a></h2>
The <b>hash:net,port</b> set type uses a hash to store different sized IP
  network address and port pairs. The port number is interpreted together with a
  protocol (default TCP) and zero protocol number cannot be used. Network
  address with zero prefix size is not accepted either.
<div class="Pp"></div>
<i>CREATE-OPTIONS</i> := [ <b>family</b> { <b>inet</b> | <b>inet6</b> } ] | [
  <b>hashsize</b> <i>value</i> ] [ <b>maxelem</b> <i>value</i> ] [
  <b>timeout</b> <i>value</i> ] [ <b>counters</b> ]
<div class="Pp"></div>
<i>ADD-ENTRY</i> := <i>netaddr</i>,[<i>proto</i>:]<i>port</i>
<div class="Pp"></div>
<i>ADD-OPTIONS</i> := [ <b>timeout</b> <i>value</i> ] [ <b>nomatch</b> ] [
  <b>packets</b> <i>value</i> ] [ <b>bytes</b> <i>value</i> ]
<div class="Pp"></div>
<i>DEL-ENTRY</i> := <i>netaddr</i>,[<i>proto</i>:]<i>port</i>
<div class="Pp"></div>
<i>TEST-ENTRY</i> := <i>netaddr</i>,[<i>proto</i>:]<i>port</i>
<div class="Pp"></div>
where <i>netaddr</i> := <i>ip</i>[/<i>cidr</i>]
<div class="Pp"></div>
Optional <b>create</b> options:
<dl class="Bl-tag">
  <dt class="It-tag"><b>family</b> { <b>inet</b> | <b>inet6</b> }</dt>
  <dd class="It-tag">The protocol family of the IP addresses to be stored in the
      set. The default is <b>inet</b>, i.e IPv4.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>hashsize</b> <i>value</i></dt>
  <dd class="It-tag">The initial hash size for the set, default is 1024. The
      hash size must be a power of two, the kernel automatically rounds up non
      power of two hash sizes to the first correct value.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>maxelem</b> <i>value</i></dt>
  <dd class="It-tag">The maximal number of elements which can be stored in the
      set, default 65536.</dd>
</dl>
<div class="Pp"></div>
For the <i>netaddr</i> part of the elements see the description at the
  <b>hash:net</b> set type. For the [ <i>proto</i>:]<i>port</i> part of the
  elements see the description at the <b>hash:ip,port</b> set type.
<div class="Pp"></div>
When adding/deleting/testing entries, if the cidr prefix parameter is not
  specified, then the host prefix value is assumed. When adding/deleting
  entries, the exact element is added/deleted and overlapping elements are not
  checked by the kernel. When testing entries, if a host address is tested, then
  the kernel tries to match the host address in the networks added to the set
  and reports the result accordingly.
<div class="Pp"></div>
From the <b>set</b> netfilter match point of view the searching for a match
  always starts from the smallest size of netblock (most specific prefix) to the
  largest one (least specific prefix) added to the set. When adding/deleting IP
  addresses to the set by the <b>SET</b> netfilter target, it will be
  added/deleted by the most specific prefix which can be found in the set, or by
  the host prefix value if the set is empty.
<div class="Pp"></div>
The lookup time grows linearly with the number of the different prefix values
  added to the set.
<div class="Pp"></div>
Examples:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset create foo hash:net,port</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 192.168.0/24,25</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 10.1.0.0/16,80</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset test foo 192.168.0/24,25</dd>
</dl>
<h2 class="Ss" title="Ss" id="hash:ip,port,ip"><a class="selflink" href="#hash:ip,port,ip">hash:ip,port,ip</a></h2>
The <b>hash:ip,port,ip</b> set type uses a hash to store IP address, port number
  and a second IP address triples. The port number is interpreted together with
  a protocol (default TCP) and zero protocol number cannot be used.
<div class="Pp"></div>
<i>CREATE-OPTIONS</i> := [ <b>family</b> { <b>inet</b> | <b>inet6</b> } ] | [
  <b>hashsize</b> <i>value</i> ] [ <b>maxelem</b> <i>value</i> ] [
  <b>timeout</b> <i>value</i> ] [ <b>counters</b> ]
<div class="Pp"></div>
<i>ADD-ENTRY</i> := <i>ipaddr</i>,[<i>proto</i>:]<i>port</i>,<i>ip</i>
<div class="Pp"></div>
<i>ADD-OPTIONS</i> := [ <b>timeout</b> <i>value</i> ] [ <b>packets</b>
  <i>value</i> ] [ <b>bytes</b> <i>value</i> ]
<div class="Pp"></div>
<i>DEL-ENTRY</i> := <i>ipaddr</i>,[<i>proto</i>:]<i>port</i>,<i>ip</i>
<div class="Pp"></div>
<i>TEST-ENTRY</i> := <i>ipaddr</i>,[<i>proto</i>:]<i>port</i>,<i>ip</i>
<div class="Pp"></div>
For the first <i>ipaddr</i> and [ <i>proto</i>:]<i>port</i> parts of the
  elements see the descriptions at the <b>hash:ip,port</b> set type.
<div class="Pp"></div>
Optional <b>create</b> options:
<dl class="Bl-tag">
  <dt class="It-tag"><b>family</b> { <b>inet</b> | <b>inet6</b> }</dt>
  <dd class="It-tag">The protocol family of the IP addresses to be stored in the
      set. The default is <b>inet</b>, i.e IPv4.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>hashsize</b> <i>value</i></dt>
  <dd class="It-tag">The initial hash size for the set, default is 1024. The
      hash size must be a power of two, the kernel automatically rounds up non
      power of two hash sizes to the first correct value.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>maxelem</b> <i>value</i></dt>
  <dd class="It-tag">The maximal number of elements which can be stored in the
      set, default 65536.</dd>
</dl>
<div class="Pp"></div>
The <b>hash:ip,port,ip</b> type of sets require three <b>src</b>/<b>dst</b>
  parameters of the <b>set</b> match and <b>SET</b> target kernel modules.
<div class="Pp"></div>
Examples:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset create foo hash:ip,port,ip</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 192.168.1.1,80,10.0.0.1</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset test foo 192.168.1.1,udp:53,10.0.0.1</dd>
</dl>
<h2 class="Ss" title="Ss" id="hash:ip,port,net"><a class="selflink" href="#hash:ip,port,net">hash:ip,port,net</a></h2>
The <b>hash:ip,port,net</b> set type uses a hash to store IP address, port
  number and IP network address triples. The port number is interpreted together
  with a protocol (default TCP) and zero protocol number cannot be used. Network
  address with zero prefix size cannot be stored either.
<div class="Pp"></div>
<i>CREATE-OPTIONS</i> := [ <b>family</b> { <b>inet</b> | <b>inet6</b> } ] | [
  <b>hashsize</b> <i>value</i> ] [ <b>maxelem</b> <i>value</i> ] [
  <b>timeout</b> <i>value</i> ] [ <b>counters</b> ]
<div class="Pp"></div>
<i>ADD-ENTRY</i> := <i>ipaddr</i>,[<i>proto</i>:]<i>port</i>,<i>netaddr</i>
<div class="Pp"></div>
<i>ADD-OPTIONS</i> := [ <b>timeout</b> <i>value</i> ] [ <b>nomatch</b> ] [
  <b>packets</b> <i>value</i> ] [ <b>bytes</b> <i>value</i> ]
<div class="Pp"></div>
<i>DEL-ENTRY</i> := <i>ipaddr</i>,[<i>proto</i>:]<i>port</i>,<i>netaddr</i>
<div class="Pp"></div>
<i>TEST-ENTRY</i> := <i>ipaddr</i>,[<i>proto</i>:]<i>port</i>,<i>netaddr</i>
<div class="Pp"></div>
where <i>netaddr</i> := <i>ip</i>[/<i>cidr</i>]
<div class="Pp"></div>
For the <i>ipaddr</i> and [ <i>proto</i>:]<i>port</i> parts of the elements see
  the descriptions at the <b>hash:ip,port</b> set type. For the <i>netaddr</i>
  part of the elements see the description at the <b>hash:net</b> set type.
<div class="Pp"></div>
Optional <b>create</b> options:
<dl class="Bl-tag">
  <dt class="It-tag"><b>family</b> { <b>inet</b> | <b>inet6</b> }</dt>
  <dd class="It-tag">The protocol family of the IP addresses to be stored in the
      set. The default is <b>inet</b>, i.e IPv4.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>hashsize</b> <i>value</i></dt>
  <dd class="It-tag">The initial hash size for the set, default is 1024. The
      hash size must be a power of two, the kernel automatically rounds up non
      power of two hash sizes to the first correct value.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>maxelem</b> <i>value</i></dt>
  <dd class="It-tag">The maximal number of elements which can be stored in the
      set, default 65536.</dd>
</dl>
<div class="Pp"></div>
From the <b>set</b> netfilter match point of view the searching for a match
  always starts from the smallest size of netblock (most specific cidr) to the
  largest one (least specific cidr) added to the set. When adding/deleting
  triples to the set by the <b>SET</b> netfilter target, it will be
  added/deleted by the most specific cidr which can be found in the set, or by
  the host cidr value if the set is empty.
<div class="Pp"></div>
The lookup time grows linearly with the number of the different <i>cidr</i>
  values added to the set.
<div class="Pp"></div>
The <b>hash:ip,port,net</b> type of sets require three <b>src</b>/<b>dst</b>
  parameters of the <b>set</b> match and <b>SET</b> target kernel modules.
<div class="Pp"></div>
Examples:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset create foo hash:ip,port,net</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 192.168.1,80,10.0.0/24</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 192.168.2,25,10.1.0.0/16</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset test foo 192.168.1,80.10.0.0/24</dd>
</dl>
<h2 class="Ss" title="Ss" id="hash:net,iface"><a class="selflink" href="#hash:net,iface">hash:net,iface</a></h2>
The <b>hash:net,iface</b> set type uses a hash to store different sized IP
  network address and interface name pairs.
<div class="Pp"></div>
<i>CREATE-OPTIONS</i> := [ <b>family</b> { <b>inet</b> | <b>inet6</b> } ] | [
  <b>hashsize</b> <i>value</i> ] [ <b>maxelem</b> <i>value</i> ] [
  <b>timeout</b> <i>value</i> ] [ <b>counters</b> ]
<div class="Pp"></div>
<i>ADD-ENTRY</i> := <i>netaddr</i>,[<b>physdev</b>:]<i>iface</i>
<div class="Pp"></div>
<i>ADD-OPTIONS</i> := [ <b>timeout</b> <i>value</i> ] [ <b>nomatch</b> ] [
  <b>packets</b> <i>value</i> ] [ <b>bytes</b> <i>value</i> ]
<div class="Pp"></div>
<i>DEL-ENTRY</i> := <i>netaddr</i>,[<b>physdev</b>:]<i>iface</i>
<div class="Pp"></div>
<i>TEST-ENTRY</i> := <i>netaddr</i>,[<b>physdev</b>:]<i>iface</i>
<div class="Pp"></div>
where <i>netaddr</i> := <i>ip</i>[/<i>cidr</i>]
<div class="Pp"></div>
Optional <b>create</b> options:
<dl class="Bl-tag">
  <dt class="It-tag"><b>family</b> { <b>inet</b> | <b>inet6</b> }</dt>
  <dd class="It-tag">The protocol family of the IP addresses to be stored in the
      set. The default is <b>inet</b>, i.e IPv4.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>hashsize</b> <i>value</i></dt>
  <dd class="It-tag">The initial hash size for the set, default is 1024. The
      hash size must be a power of two, the kernel automatically rounds up non
      power of two hash sizes to the first correct value.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>maxelem</b> <i>value</i></dt>
  <dd class="It-tag">The maximal number of elements which can be stored in the
      set, default 65536.</dd>
</dl>
<div class="Pp"></div>
For the <i>netaddr</i> part of the elements see the description at the
  <b>hash:net</b> set type.
<div class="Pp"></div>
When adding/deleting/testing entries, if the cidr prefix parameter is not
  specified, then the host prefix value is assumed. When adding/deleting
  entries, the exact element is added/deleted and overlapping elements are not
  checked by the kernel. When testing entries, if a host address is tested, then
  the kernel tries to match the host address in the networks added to the set
  and reports the result accordingly.
<div class="Pp"></div>
From the <b>set</b> netfilter match point of view the searching for a match
  always starts from the smallest size of netblock (most specific prefix) to the
  largest one (least specific prefix) added to the set. When adding/deleting IP
  addresses to the set by the <b>SET</b> netfilter target, it will be
  added/deleted by the most specific prefix which can be found in the set, or by
  the host prefix value if the set is empty.
<div class="Pp"></div>
The second direction parameter of the <b>set</b> match and <b>SET</b> target
  modules corresponds to the incoming/outgoing interface: <b>src</b> to the
  incoming one (similar to the <b>-i</b> flag of iptables), while <b>dst</b> to
  the outgoing one (similar to the <b>-o</b> flag of iptables). When the
  interface is flagged with <b>physdev:</b>, the interface is interpreted as the
  incoming/outgoing bridge port.
<div class="Pp"></div>
The lookup time grows linearly with the number of the different prefix values
  added to the set.
<div class="Pp"></div>
The internal restriction of the <b>hash:net,iface</b> set type is that the same
  network prefix cannot be stored with more than 64 different interfaces in a
  single set.
<div class="Pp"></div>
Examples:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset create foo hash:net,iface</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 192.168.0/24,eth0</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset add foo 10.1.0.0/16,eth1</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">ipset test foo 192.168.0/24,eth0</dd>
</dl>
<h2 class="Ss" title="Ss" id="list:set"><a class="selflink" href="#list:set">list:set</a></h2>
The <b>list:set</b> type uses a simple list in which you can store set names.
<div class="Pp"></div>
<i>CREATE-OPTIONS</i> := [ <b>size</b> <i>value</i> ] [ <b>timeout</b>
  <i>value</i> ] [ <b>counters</b> ]
<div class="Pp"></div>
<i>ADD-ENTRY</i> := <i>setname</i> [ { <b>before</b> | <b>after</b> }
  <i>setname</i> ]
<div class="Pp"></div>
<i>ADD-OPTIONS</i> := [ <b>timeout</b> <i>value</i> ] [ <b>packets</b>
  <i>value</i> ] [ <b>bytes</b> <i>value</i> ]
<div class="Pp"></div>
<i>DEL-ENTRY</i> := <i>setname</i> [ { <b>before</b> | <b>after</b> }
  <i>setname</i> ]
<div class="Pp"></div>
<i>TEST-ENTRY</i> := <i>setname</i> [ { <b>before</b> | <b>after</b> }
  <i>setname</i> ]
<div class="Pp"></div>
Optional <b>create</b> options:
<dl class="Bl-tag">
  <dt class="It-tag"><b>size</b> <i>value</i></dt>
  <dd class="It-tag">The size of the list, the default is 8.</dd>
</dl>
<div class="Pp"></div>
By the <b>ipset</b> command you can add, delete and test set names in a
  <b>list:set</b> type of set.
<div class="Pp"></div>
By the <b>set</b> match or <b>SET</b> target of netfilter you can test, add or
  delete entries in the sets added to the <b>list:set</b> type of set. The match
  will try to find a matching entry in the sets and the target will try to add
  an entry to the first set to which it can be added. The number of direction
  options of the match and target are important: sets which require more
  parameters than specified are skipped, while sets with equal or less
  parameters are checked, elements added/deleted. For example if <i>a</i> and
  <i>b</i> are <b>list:set</b> type of sets then in the command
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">iptables -m set --match-set a src,dst -j SET --add-set b
      src,dst</dd>
</dl>
<div class="Pp"></div>
the match and target will skip any set in <i>a</i> and <i>b</i> which stores
  data triples, but will match all sets with single or double data storage in
  <i>a</i> set and stop matching at the first successful set, and add src to the
  first single or src,dst to the first double data storage set in <i>b</i> to
  which the entry can be added. You can imagine a <b>list:set</b> type of set as
  an ordered union of the set elements.
<div class="Pp"></div>
Please note: by the <b>ipset</b> command you can add, delete and <b>test</b> the
  setnames in a <b>list:set</b> type of set, and <b>not</b> the presence of a
  set's member (such as an IP address).
<h1 class="Sh" title="Sh" id="GENERAL_RESTRICTIONS"><a class="selflink" href="#GENERAL_RESTRICTIONS">GENERAL
  RESTRICTIONS</a></h1>
Zero valued set entries cannot be used with hash methods. Zero protocol value
  with ports cannot be used.
<h1 class="Sh" title="Sh" id="COMMENTS"><a class="selflink" href="#COMMENTS">COMMENTS</a></h1>
If you want to store same size subnets from a given network (say /24 blocks from
  a /8 network), use the <b>bitmap:ip</b> set type. If you want to store random
  same size networks (say random /24 blocks), use the <b>hash:ip</b> set type.
  If you have got random size of netblocks, use <b>hash:net</b>.
<div class="Pp"></div>
Backward compatibility is maintained and old <b>ipset</b> syntax is still
  supported.
<div class="Pp"></div>
The <b>iptree</b> and <b>iptreemap</b> set types are removed: if you refer to
  them, they are automatically replaced by <b>hash:ip</b> type of sets.
<h1 class="Sh" title="Sh" id="DIAGNOSTICS"><a class="selflink" href="#DIAGNOSTICS">DIAGNOSTICS</a></h1>
Various error messages are printed to standard error. The exit code is 0 for
  correct functioning.
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Bugs? No, just funny features. :-) OK, just kidding...
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>iptables</b>(8), <b>ip6tables</b>(8)
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
Jozsef Kadlecsik wrote ipset, which is based on ippool by Joakim Axelsson,
  Patrick Schaaf and Martin Josefsson.
<div>&#x00A0;</div>
Sven Wegener wrote the iptreemap type.
<h1 class="Sh" title="Sh" id="LAST_REMARK"><a class="selflink" href="#LAST_REMARK">LAST
  REMARK</a></h1>
<b>I stand on the shoulders of giants.</b></div>
<table class="foot">
  <tr>
    <td class="foot-date">April 4, 2013</td>
    <td class="foot-os">Jozsef Kadlecsik</td>
  </tr>
</table>
</body>
</html>
