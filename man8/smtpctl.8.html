<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:16:09 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>SMTPCTL(8) System Manager&rsquo;s Manual SMTPCTL(8)</p>

<p style="margin-top: 1em">NAME <br>
smtpctl, mailq - control the Simple Mail Transfer Protocol
daemon</p>

<p style="margin-top: 1em">SYNOPSIS <br>
smtpctl command [argument ...] <br>
mailq</p>

<p style="margin-top: 1em">DESCRIPTION <br>
The smtpctl program controls smtpd(8). Commands may be
abbreviated to the minimum unambiguous prefix; for example,
sh ro for show routes.</p>

<p style="margin-top: 1em">The mailq command is provided
for compatibility with other MTAs and is simply a shortcut
for show queue.</p>

<p style="margin-top: 1em">The following commands are
available:</p>

<p style="margin-top: 1em">discover envelope-id |
message-id <br>
Schedule a single envelope, or all envelopes with the same
message ID that were manually moved to the queue.</p>

<p style="margin-top: 1em">encrypt [string] <br>
Encrypt the password string to a representation suitable for
user credentials and print it to the standard output. If
string is not provided, cleartext passwords are <br>
read from standard input.</p>

<p style="margin-top: 1em">It is advised to avoid providing
the password as a parameter as it will be visible from
top(1) and ps(1) output.</p>

<p style="margin-top: 1em">log brief <br>
Disable verbose debug logging.</p>

<p style="margin-top: 1em">log verbose <br>
Enable verbose debug logging.</p>

<p style="margin-top: 1em">monitor <br>
Display updates of some smtpd(8) internal counters in one
second intervals. Each line reports the increment of all
counters since the last update, except for some <br>
counters which are always absolute values. The first line
reports the current value of each counter. The fields
are:</p>

<p style="margin-top: 1em">&Acirc;&middot; Current number
of active SMTP clients (absolute value).</p>

<p style="margin-top: 1em">&Acirc;&middot; New SMTP
clients.</p>

<p style="margin-top: 1em">&Acirc;&middot; Disconnected
clients.</p>

<p style="margin-top: 1em">&Acirc;&middot; Current number
of envelopes in the queue (absolute value).</p>

<p style="margin-top: 1em">&Acirc;&middot; Newly enqueued
envelopes.</p>

<p style="margin-top: 1em">&Acirc;&middot; Dequeued
envelopes.</p>

<p style="margin-top: 1em">&Acirc;&middot; Successful
deliveries.</p>

<p style="margin-top: 1em">&Acirc;&middot; Temporary
failures.</p>

<p style="margin-top: 1em">&Acirc;&middot; Permanent
failures.</p>

<p style="margin-top: 1em">&Acirc;&middot; Message
loops.</p>

<p style="margin-top: 1em">&Acirc;&middot; Expired
envelopes.</p>

<p style="margin-top: 1em">&Acirc;&middot; Envelopes
removed by the administrator.</p>

<p style="margin-top: 1em">&Acirc;&middot; Generated
bounces.</p>

<p style="margin-top: 1em">pause envelope envelope-id |
message-id <br>
Temporarily suspend scheduling for the envelope with the
given ID, or all envelopes with the given message ID.</p>

<p style="margin-top: 1em">pause envelope all <br>
Temporarily suspend scheduling all the envelopes.</p>

<p style="margin-top: 1em">pause mda <br>
Temporarily stop deliveries to local users.</p>

<p style="margin-top: 1em">pause mta <br>
Temporarily stop relaying and deliveries to remote
users.</p>

<p style="margin-top: 1em">pause smtp <br>
Temporarily stop accepting incoming sessions.</p>

<p style="margin-top: 1em">profile subsystem <br>
Enables real-time profiling of subsystem. Supported
subsystems are:</p>

<p style="margin-top: 1em">&Acirc;&middot; queue, to
profile cost of queue IO</p>

<p style="margin-top: 1em">&Acirc;&middot; imsg, to profile
cost of event handlers</p>

<p style="margin-top: 1em">remove envelope-id | message-id
<br>
Remove a single envelope, or all envelopes with the same
message ID.</p>

<p style="margin-top: 1em">remove all <br>
Remove all envelopes.</p>

<p style="margin-top: 1em">resume envelope envelope-id |
message-id <br>
Resume scheduling for the envelope with the given ID, or all
envelopes with the given message ID.</p>

<p style="margin-top: 1em">resume envelope all <br>
Resume scheduling all the envelopes.</p>

<p style="margin-top: 1em">resume mda <br>
Resume deliveries to local users.</p>

<p style="margin-top: 1em">resume mta <br>
Resume relaying and deliveries to remote users.</p>

<p style="margin-top: 1em">resume route route-id <br>
Resume routing on disabled route route-id.</p>

<p style="margin-top: 1em">resume smtp <br>
Resume accepting incoming sessions.</p>

<p style="margin-top: 1em">schedule all <br>
Mark all envelopes as ready for immediate delivery.</p>

<p style="margin-top: 1em">schedule envelope-id |
message-id <br>
Mark a single envelope, or all envelopes with the same
message ID, as ready for immediate delivery.</p>

<p style="margin-top: 1em">show envelope envelope-id <br>
Display envelope content for the given ID.</p>

<p style="margin-top: 1em">show hosts <br>
Display the list of known remote MX hosts. For each of them,
it shows the IP address, the canonical hostname, a reference
count, the number of active connections to <br>
this host, and the elapsed time since the last
connection.</p>

<p style="margin-top: 1em">show hoststats <br>
Display status of last delivery for domains that have been
active in the last 4 hours. It consists of the following
fields, separated by a &quot;|&quot;:</p>

<p style="margin-top: 1em">&Acirc;&middot; Domain.</p>

<p style="margin-top: 1em">&Acirc;&middot; Ux timestamp of
last delivery.</p>

<p style="margin-top: 1em">&Acirc;&middot; Status of last
delivery.</p>

<p style="margin-top: 1em">show message envelope-id <br>
Display message content for the given ID.</p>

<p style="margin-top: 1em">show queue <br>
Display information concerning envelopes that are currently
in the queue. Each line of output describes a single
envelope. It consists of the following fields, sep&acirc;
<br>
arated by a &quot;|&quot;:</p>

<p style="margin-top: 1em">&Acirc;&middot; Envelope ID.</p>

<p style="margin-top: 1em">&Acirc;&middot; Address family
of the client which enqueued the mail.</p>

<p style="margin-top: 1em">&Acirc;&middot; Type of
delivery: one of &quot;mta&quot;, &quot;mda&quot; or
&quot;bounce&quot;.</p>

<p style="margin-top: 1em">&Acirc;&middot; Various flags on
the envelope.</p>

<p style="margin-top: 1em">&Acirc;&middot; Sender address
(return path).</p>

<p style="margin-top: 1em">&Acirc;&middot; The original
recipient address.</p>

<p style="margin-top: 1em">&Acirc;&middot; The destination
address.</p>

<p style="margin-top: 1em">&Acirc;&middot; Time of
creation.</p>

<p style="margin-top: 1em">&Acirc;&middot; Time of
expiration.</p>

<p style="margin-top: 1em">&Acirc;&middot; Time of last
delivery or relaying attempt.</p>

<p style="margin-top: 1em">&Acirc;&middot; Number of
delivery or relaying attempts.</p>

<p style="margin-top: 1em">&Acirc;&middot; Current
runstate: either &quot;pending&quot; or &quot;inflight&quot;
if smtpd(8) is running, or &quot;offline&quot;
otherwise.</p>

<p style="margin-top: 1em">&Acirc;&middot; Delay in seconds
before the next attempt if pending, or time ellapsed if
currently running. This field is blank if smtpd(8) is not
running.</p>

<p style="margin-top: 1em">&Acirc;&middot; Error string for
the last failed delivery or relay attempt.</p>

<p style="margin-top: 1em">show relays <br>
Display the list of currently active relays and associated
connectors. For each relay, it shows a number of counters
and information on its internal state on a sin&acirc; <br>
gle line. Then comes the list of connectors (source
addresses to connect from for this relay).</p>

<p style="margin-top: 1em">show routes <br>
Display status of routes currently known by smtpd(8). Each
line consists of a route number, a source address, a
destination address, a set of flags, the number of <br>
connections on this route, the current penalty level which
determines the amount of time the route is disabled if an
error occurs, and the delay before it gets reac&acirc; <br>
tivated. The following flags are defined:</p>

<p style="margin-top: 1em">D The route is currently
disabled.</p>

<p style="margin-top: 1em">N The route is new. No SMTP
session has been established yet.</p>

<p style="margin-top: 1em">Q The route has a timeout
registered to lower its penalty level and possibly
reactivate or discard it.</p>

<p style="margin-top: 1em">show stats <br>
Displays runtime statistics concerning smtpd(8).</p>

<p style="margin-top: 1em">show status <br>
Shows if MTA, MDA and SMTP systems are currently running or
paused.</p>

<p style="margin-top: 1em">stop Stop the server.</p>

<p style="margin-top: 1em">trace subsystem <br>
Enables real-time tracing of subsystem. Supported subsystems
are:</p>

<p style="margin-top: 1em">&Acirc;&middot; imsg</p>

<p style="margin-top: 1em">&Acirc;&middot; io</p>

<p style="margin-top: 1em">&Acirc;&middot; smtp (incoming
sessions)</p>

<p style="margin-top: 1em">&Acirc;&middot; filters</p>

<p style="margin-top: 1em">&Acirc;&middot; mta (outgoing
sessions)</p>

<p style="margin-top: 1em">&Acirc;&middot; bounce</p>

<p style="margin-top: 1em">&Acirc;&middot; scheduler</p>

<p style="margin-top: 1em">&Acirc;&middot; expand
(aliases/virtual/forward expansion)</p>

<p style="margin-top: 1em">&Acirc;&middot; lookup
(user/credentials lookups)</p>

<p style="margin-top: 1em">&Acirc;&middot; stat</p>

<p style="margin-top: 1em">&Acirc;&middot; rules (matched
by incoming sessions)</p>

<p style="margin-top: 1em">&Acirc;&middot; mproc</p>

<p style="margin-top: 1em">&Acirc;&middot; all</p>

<p style="margin-top: 1em">uncorrupt message-id <br>
Move all envelopes with the given message ID from corrupt
bucket back to queue.</p>

<p style="margin-top: 1em">unprofile subsystem <br>
Disables real-time profiling of subsystem.</p>

<p style="margin-top: 1em">untrace subsystem <br>
Disables real-time tracing of subsystem.</p>

<p style="margin-top: 1em">update table name <br>
For table backends that provide caching, causes smtpd(8) to
update the cache.</p>

<p style="margin-top: 1em">When smtpd receives a message,
it generates a message-id for the message, and one
envelope-id per recipient. The message-id is a 32-bit random
identifier that is guaranteed to <br>
be unique on the host system. The envelope-id is a 64-bit
unique identifier that encodes the message-id in the 32
upper bits and a random envelope identifier in the 32 lower
<br>
bits.</p>

<p style="margin-top: 1em">A command which specifies a
message-id applies to all recipients of a message; a command
which specifies an envelope-id applies to a specific
recipient of a message.</p>

<p style="margin-top: 1em">FILES <br>
/var/run/smtpd.sock <br>
Ux -domain socket used for communication with smtpd(8).</p>

<p style="margin-top: 1em">SEE ALSO <br>
smtpd(8)</p>

<p style="margin-top: 1em">HISTORY <br>
The smtpctl program first appeared in OpenBSD 4.6.</p>

<p style="margin-top: 1em">$Mdocdate: June 14 2016 $
SMTPCTL(8)</p>
<hr>
</body>
</html>
