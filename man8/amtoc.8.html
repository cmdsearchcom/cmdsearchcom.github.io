<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>AMTOC(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">AMTOC(8)</td>
    <td class="head-vol">System Administration Commands</td>
    <td class="head-rtitle">AMTOC(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
amtoc - generate TOC (Table Of Contents) for an Amanda run
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div class="Pp" style="margin-left: 6.00ex; text-indent: -6.00ex;"><b>amtoc</b>
  [-a] [-i] [-t] [-f&#x00A0; <i>file</i>] [-s&#x00A0;<i>subs</i>] [-w] [--]
  <i>logfile</i></div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<i>Amtoc</i> generates a table of contents for an Amanda run. It's a perl script
  (if you don't have perl, install it first!).
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<b>-a</b>
<div style="margin-left: 4.00ex;">The output file name will be
  <i>label-of-the-tape</i>.toc in the same directory as <i>logfile</i>.</div>
<div class="Pp"></div>
<b>-i</b>
<div style="margin-left: 4.00ex;">Display help about <b>amtoc</b>.</div>
<div class="Pp"></div>
<b>-t</b>
<div style="margin-left: 4.00ex;">Generate the output in tabular form.</div>
<div class="Pp"></div>
<b>-f file</b>
<div style="margin-left: 4.00ex;">Write the output to a file ('-' for
  stdout).</div>
<div class="Pp"></div>
<b>-s subs</b>
<div style="margin-left: 4.00ex;">Evaluate the output file name from
  <i>subs</i>, with $_ set to <i>label-of-the-tape</i>. The <b>-a</b> option is
  equivalent to <b>-s</b> <i>'s/$_/.toc/'</i>.</div>
<div class="Pp"></div>
<b>-w</b>
<div style="margin-left: 4.00ex;">Separate tapes with form-feeds and display
  blank lines before totals.</div>
<div class="Pp"></div>
<b>--</b>
<div style="margin-left: 4.00ex;">Marks the last option so the next parameter is
  the <i>logfile</i>.</div>
<div class="Pp"></div>
<b>logfile</b>
<div style="margin-left: 4.00ex;">(use '-' for stdin)</div>
<h1 class="Sh" title="Sh" id="OUTPUT_FORMAT"><a class="selflink" href="#OUTPUT_FORMAT">OUTPUT
  FORMAT</a></h1>
The standard output has five fields separated by two spaces:
<pre>
#  Server:/partition  date  level  size[Kb]
0  daily-05:  19991005  -  -
1  cuisun15:/cuisun15/home  19991005  1  96
2  cuinfs:/export/dentiste  19991005  1  96
  ...
103  cuisg11:/  19991005  0  4139136
103  total:  -  -  16716288
</pre>
<div class="Pp"></div>
In tabular format (-t), this would look like:
<pre>
  #  Server:/partition           date      lev  size[Kb]
  0  daily-05:                   19991005    -         -
  1  cuisun15:/cuisun15/home     19991005    1        96
  2  cuinfs:/export/dentiste     19991005    1        96
  ...
103  cuisg11:/                   19991005    0   4139136
103  total:                      -           -  16716288
</pre>
<h1 class="Sh" title="Sh" id="USAGE"><a class="selflink" href="#USAGE">USAGE</a></h1>
The easiest way to use it is to run <b>amtoc</b> right after <i>amdump</i> in
  the <i>cron job:</i>
<pre>
amdump daily ; logdir=`amgetconf daily logdir` ; log=`ls -1t $logdir/log.*.[0-9] | head -1` ; amtoc -a $log
</pre>
<div class="Pp"></div>
which will generate /usr/local/etc/amanda//daily/ <i>tape_label</i>.toc. You may
  also want to call <b>amtoc</b> after an <i>amflush</i>.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>amanda</b>(8), <b>amdump</b>(8), <b>amflush</b>(8), <b>amgetconf</b>(8)
<div class="Pp"></div>
The Amanda Wiki: : http://wiki.zmanda.com/
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
<b>Nicolas Mayencourt</b> &lt;Nicolas.Mayencourt@cui.unige.ch&gt;
<div style="margin-left: 4.00ex;">University of Geneva/Switzerland</div>
<div class="Pp"></div>
<b>Stefan G. Weichinger</b> &lt;sgw@amanda.org&gt;</div>
<table class="foot">
  <tr>
    <td class="foot-date">01/10/2013</td>
    <td class="foot-os">Amanda 3.3.3</td>
  </tr>
</table>
</body>
</html>
