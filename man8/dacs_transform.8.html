<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>DACS_TRANSFORM(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DACS_TRANSFORM(8)</td>
    <td class="head-vol">DACS Web Services Manual</td>
    <td class="head-rtitle">DACS_TRANSFORM(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
dacs_transform - rule-based document transformation
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div class="Pp" style="margin-left: 15.00ex; text-indent: -15.00ex;"><b>dacs_transform</b>
  [ <i></i><b>dacsoptions</b>[1]]</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This web service is part of the <b>DACS</b> suite.
<div class="Pp"></div>
<b>dacs_transform</b> can perform a variety of transformations on an original
  document to produce a new document. Transformations such as redaction,
  insertion, and replacement are available. What makes the program interesting
  is that any transformation can depend on a rule that is evaluated at run-time,
  allowing a new document to be tailored for a specific user or context.
<div class="Pp"></div>
The program looks for embedded markup (meta-information) called directives in
  the input document. A directive specifies a conditional (rule-based) or
  unconditional operation that is evaluated at that point in the document to
  determine the output text that is to be interpolated into the program's
  output. Text outside of a directive is copied verbatim to the program's
  output.
<div class="Pp"></div>
One application of this software is to produce different versions of
  documentation from the same input. For example, consider a requirement to
  produce technical documentation for a series of printers where the printers
  are substantially the same (their documentation shares a lot of the same text
  and graphics) but each model has unique features or capabilities. Instead of
  producing a single manual that describes all models, which makes the manual
  larger and more complicated than necessary, this software provides a
  convenient way to create model-specific documentation from the same input.
  This means that the documentation common to all printers is shared by all of
  the manuals, yet the manual for each printer is easily customized for the
  particular printer.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>dacs_transform</b> is similar in
  concept or purpose to the Apache modules <b>mod_include</b>[2] and
  <b>mod_rewrite</b>[3]. It is not an Apache module, however, and can therefore
  be used with any web server, and provides rich, rule-based selection of
  regions for processing. It can be used in conjunction with
  <b>mod_ext_filter</b>[4]. It is also conceptually similar to languages like
  <b>PHP</b>[5] where ordinary content and special processing directives can be
  combined within a document.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;The <b>dacstransform(1)</b>[6] command
  provides similar functionality from the command line. The
  <b>transform()</b>[7] function is also available.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<b>dacs_transform</b> and
  <b>dacstransform</b> can be particularly useful tools for generating both
  static and dynamic web pages from template files.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;For security reasons, access to
  <b>dacs_transform</b> is disabled by default. Some configuration capabilities
  and features expected in a production version have not been implemented. If
  there are multiple identities, only one identity ( <b>REMOTE_USER</b>) is
  available during rule processing.</div>
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<h2 class="Ss" title="Ss" id="Regions"><a class="selflink" href="#Regions">Regions</a></h2>
A directive delimits a region within the source document. A directive that is
  <i>enabled</i> processes its region in some way, otherwise the directive and
  its region are <i>disabled</i> and produce no output. Whether a directive is
  enabled or disabled depends on the <b>DACS</b> rule that is named in the
  directive. Zero-length regions (i.e., regions with no content) are allowed.
<div class="Pp"></div>
The output that is produced by <b>dacs_transform</b> depends on input that is
  copied verbatim, the selection of regions in the original document, the
  document's rules, region evaluation, and the context in which the rules are
  evaluated. Rules can not only inspect the requesting user's identity (based on
  the environment variable <b>REMOTE_USER</b>), including roles (obtained from
  <b>DACS_ROLES</b>), they can employ C-like expressions and a variety of
  built-in functions (see <b>dacs.exprs(5)</b>[8]). Directives are <i>not</i>
  emitted as part of the transformed document.
<div class="Pp"></div>
Every conditional region is given a name. With the exception of reserved names,
  region names have no particular significance to <b>dacs_transform</b>; they
  are simply attributes to which rules may refer. Each document will usually
  have one or more rules associated with it.
<div class="Pp"></div>
For example, an author might assign a name representing a security level to each
  region in a document: public, secret, top-secret, and so on. For each of these
  security levels, a specified set of rules would be examined by
  <b>dacs_transform</b> to decide which identities are granted (or denied)
  access to the corresponding region. In this way, different users may be given
  different versions of the same source document; some users might not be able
  to view secret and top-secret content, other might be able to view all
  content.
<div class="Pp"></div>
A document that combined text written in different languages might name regions
  English, French, Russian, and so on; the English regions might be enabled by
  <b>dacs_transform</b> based on the user's <b>DACS</b> role or the user's
  stored preference for that language. Another document might contain region
  names corresponding to time zones: PST, MST, EST, and so on. A rule might then
  require the time zone associated with the location corresponding to the user's
  apparent IP address to match that of the region being tested. Or an audio
  stream or speech synthesis content might be automatically enabled if a user
  has a role that indicates she is visually impaired.
<div class="Pp"></div>
At present, no facility is available to assist with working with
  meta-information. It must either be added manually or generated by an
  application that understands how to insert meta-information in its output.
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>Directive and Attribute Syntax</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
In an HTML document served by <b>dacs_transform</b>, a region consists of a
  single directive or is delimited by a pair of directives. All other document
  content is ignored with respect to transformation. By default, directives are
  contained within HTML-style comments and the start of a directive is indicated
  by a line having the initial nine characters &quot;&lt;!--DACS&quot; and
  ending with the normal HTML end-of-comment syntax, &quot;--&gt;&quot;. Such a
  line is unlikely to occur in a document by accident, but the syntax is
  <b>configurable</b>[9].
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Whitespace is not ignored at the
  beginning or end of an input line.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;Because the syntax for comments
  defined for HTML is also acceptable in SGML and XML (and any similar markup
  language that is based on SGML), <b>dacs_transform</b> can also work with
  those documents.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;A directive cannot be &quot;commented
  out&quot; except by modifying the line on which it occurs so that the
  directive will not be recognized as such. That is, the context in which a
  directive occurs with respect to the original document is not considered by
  <b>dacs_transform</b>.</div>
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
A directive contains one or more <i>attribute</i>=&quot;<i>value</i>&quot;
  pairs. Exactly one attribute name must be a directive name that indicates the
  operation to be performed. An attribute name must be a <b>syntactically valid
  variable name</b>[10]. The <i>value</i> must be enclosed in matching double
  quotes, single quotes, or backticks (decimal ASCII code 96). Backtick quotes
  are treated differently in that the enclosed string is evaluated as an
  <b>expression</b>[11]. Variables from the <i>Env</i> and <i>Conf</i>
  <b>namespaces</b>[12] are instantiated. The current directive's attributes are
  accessible in the <i>Attr</i> namespace; these attribute values are
  <i>unevaluated</i> and quoted.
<div class="Pp"></div>
This example input contains two regions:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;!--DACS begin=&quot;English&quot; --&gt;
Hello!
&lt;!--DACS end=&quot;English&quot; --&gt;
&lt;!--DACS begin=&quot;French&quot; --&gt;
Bonjour!
&lt;!--DACS end=&quot;French&quot; --&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;For all directives, the region name
  &quot;*&quot; is reserved and indicates that the region should be enabled
  without evaluating any rule. If an author wants to always insert some text or
  an identification string, for instance, this feature eliminates the need to
  create a rule that does nothing other than return <b>True</b>.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;For all directives, a region name
  prefixed by the <b>negation operator</b>[13] inverts the selection test.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;For all directives, regardless of the
  region name, an attribute named &quot;cond&quot; may be provided. Its value is
  an expression that must evaluate to <b>True</b> for the region to be
  processed. If a rule also applies to the directive, both the rule and the
  expression must grant access.</div>
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
Directive names, which are described below, are reserved and have special
  meaning to <b>dacs_transform</b>. Unrecognized attributes are ignored but can
  be referenced as arguments by rules. A given attribute cannot appear more than
  once within a directive. All attribute names are case-insensitive.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>Negation</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
A region name prefixed by the negation operator (&quot;!&quot;) indicates that
  the region should be enabled if the rule returns <b>False</b> and should be
  disabled if it returns <b>True</b>. Note that the negation character is not
  part of the region name. This syntax eliminates the need to write separate
  &quot;if-true&quot; and &quot;if-false&quot; versions of the same rule,
  although it is an inefficient substitute for an if/else construct.
<div class="Pp"></div>
For example, if a document only has public and secret regions, instead of
  defining one rule for public regions and another for secret regions, an author
  might simply define a single rule to identify secret regions and use negation:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;!--DACS begin=&quot;!secret&quot; --&gt;
This is public stuff, not secret stuff.
&lt;!--DACS end=&quot;!secret&quot; --&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>Recursion</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
By default, content that is included during processing of an insert, insertv, or
  expand directive is recursively processed for directives. Recursion may be
  disabled on a case-by-case basis by specifying the recurse attribute with a
  value of &quot;no&quot; (case insensitively). It may also be explicitly
  enabled by specifying the attribute value &quot;yes&quot; (case
  insensitively).
<div class="Pp"></div>
A maximum stack depth is imposed, primarily to guard against infinite recursion.
  This limit is currently set to <b>100</b> at compile time.
<div class="Pp"></div>
Variables set by outer levels can be referenced by inner levels. If variables at
  different levels have the same name, however, only the innermost value is
  accessible.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>Directives</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
<b>Directive Index:</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 1.begin: start a region</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 2.debug: emit variables for debugging</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 3.end: end a region</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 4.expand: insert content and interpolate
  variables</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 5.filter: transform content</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 6.filterv: transform content, verbatim</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 7.id: insert an identification string</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 8.insert: insert content</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;"> 9.insertv: insert content, verbatim</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">10.set: set or reset variables</div>
<div class="Pp"></div>
begin
<div style="margin-left: 4.00ex;">The begin directive starts a region with the
  specified name:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;!--DACS begin=&quot;secret&quot; --&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
If the region above named secret is enabled, its content is included in the
  program's output. Directives that appear in the region, including other begin
  directives, are processed. Variable references are not expanded; use the
  <b>expand</b>[14] directive to interpolate variable references. Every begin
  directive must have a matching <b>end</b>[15] directive.
<div style="height: 1.00em;">&#x00A0;</div>
The region name (the value of the begin attribute) is accessible in rules using
  <i>${Args::region}</i>.</div>
<div class="Pp"></div>
debug
<div style="margin-left: 4.00ex;">The debug directive can be helpful for
  understanding or debugging processing. It emits variables that exist at the
  point where an enabled debug directive is processed. This directive has no
  matching end directive; it is essentially a region with no content.
<div style="height: 1.00em;">&#x00A0;</div>
By default, all variables in the <i>Attrs</i>, <i>Conf</i>, and <i>DACS</i>
  namespaces are emitted. The attribute name show can be set to Attrs, Conf, or
  DACS to restrict output to the particular namespace. The value all is
  equivalent to the default. Alternatively, the attribute name Attrs can be set
  to &quot;yes&quot; (or &quot;no&quot;) to select (or deselect) the
  <i>Attrs</i> namespace. The same applies for the Conf and DACS attributes.
  These attribute names are case sensitive but their values are not.
<div style="height: 1.00em;">&#x00A0;</div>
The emitted output is preceded by the directive prefix string in effect and
  followed by the directive suffix string in effect. It is assumed that no text
  is emitted in the debugging output that might accidentally be recognized as
  the suffix string.</div>
<div class="Pp"></div>
end
<div style="margin-left: 4.00ex;">The end of a region started by a
  <b>begin</b>[16], <b>filter</b>[17], <b>filterv</b>[18] or <b>expand</b>[14]
  directive is indicated using the end directive:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;!--DACS begin=&quot;secret&quot; --&gt;
This is some secret text.
&lt;!--DACS end=&quot;secret&quot; --&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
When properly balanced, regions can be nested.</div>
<div class="Pp"></div>
expand
<div style="margin-left: 4.00ex;">This directive expands variable references in
  inserted content. Also, text containing variable references may appear in the
  original content, delimited by an end directive.
<div style="height: 1.00em;">&#x00A0;</div>
An expr, uri, or filename attribute may be used to specify the source of the
  input as with the <b>insert</b>[19] directive. Variable references in the text
  from these sources are expanded. If one of these attributes is not specified,
  the directive must be terminated by an end directive.
<div style="height: 1.00em;">&#x00A0;</div>
Directives in the expanded text are recursively processed, modulo the recurse
  attribute (see <b>Recursion</b>[20]).
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
% cat inputfile
&lt;!--DACS expand=&quot;*&quot; --&gt;
Nice dog, ${DACS::dog1}.
&lt;!--DACS end=&quot;*&quot; --&gt;
Meow!
&lt;!--DACS expand=&quot;*&quot; cond=&quot;${DACS::dog3} eq:i 'bandito'&quot; --&gt;
Good boy, ${DACS::dog2}.
&lt;!--DACS end=&quot;*&quot; --&gt;
% dacstransform -Ddog1=Auggie -Ddog2=Harley -Ddog3=Bandito &lt; inputfile
Nice dog, Auggie.
Meow!
Good boy, Harley.
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
filter
<div style="margin-left: 4.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Note</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
This feature is only partially implemented. In the current implementation, a
  filter directive must use the expr operation and may not include another
  filter region.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
Original document content within a delimited region, if any, is replaced by new
  material using the filter directive. This directive must have a corresponding
  end directive. A newline is appended to the result; if this behaviour is
  undesirable, use <b>filterv</b>[18].
<div style="height: 1.00em;">&#x00A0;</div>
Either the expr or uri operations must be specified.
<div style="height: 1.00em;">&#x00A0;</div>
If an expr attribute is present, the original document content, including its
  final newline character, is passed to the given <b>expression</b>[11] as the
  value of the variable <i>${DACS::stdin}</i>. The value of the expression (a
  string) replaces the region's original content. An evaluation error causes the
  program to terminate.
<div style="height: 1.00em;">&#x00A0;</div>
If the uri attribute is present, it specifies a web service to which the region
  should be passed as input and the output of which should replace the original
  document content. By default, the URI is invoked using the POST method but if
  a method attribute is present it specifies the HTTP method to use. The http
  and https schemes are supported. The input is passed as an argument named
  <i>CONTENT</i>.
<div style="height: 1.00em;">&#x00A0;</div>
If no operation attribute is provided, the original content is evaluated as an
  <b>expression</b>[11] and its value becomes the new content of the region.
<div style="height: 1.00em;">&#x00A0;</div>
To interpolate the current date you might use:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;!--DACS filter=&quot;public&quot; expr=&quot;strftime('%v')&quot; --&gt;
&lt;!--DACS end=&quot;public&quot; --&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Or equivalently:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;!--DACS filter=&quot;public&quot; --&gt;
strftime(&quot;%v&quot;)
&lt;!--DACS end=&quot;public&quot; --&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
To simply substitute variable values into the original content, use the
  <b>expand</b>[14] directive or the <b>expand()</b>[21] function. For example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;!--DACS filter=&quot;*&quot; expr=&quot;expand(${DACS::stdin})&quot; section=&quot;Hello, world&quot; --&gt;
&lt;h1&gt;${Attr::section}&lt;/h1&gt;
&lt;!--DACS end=&quot;*&quot; --&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Or, alternatively:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;!--DACS filter=&quot;*&quot; section=&quot;Hello, world&quot; --&gt;
expand(&quot;&lt;h1&gt;${Attr::section}&lt;/h1&gt;&quot;)
&lt;!--DACS end=&quot;*&quot; --&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
In either variation, the three lines in the document are replaced by a single
  line:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;h1&gt;Hello, world&lt;/h1&gt;
</pre>
</div>
<div style="height: 0.50em;">&#x00A0;</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Tip</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
A filter directive with an expr or uri attribute and an empty region can be
  written more simply using an insert directive.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div class="Pp"></div>
filterv
<div style="margin-left: 4.00ex;">This directive is identical to
  <b>filter</b>[17] except that no newline is appended.</div>
<div class="Pp"></div>
id
<div style="margin-left: 4.00ex;">If the region is enabled, the directive is
  replaced by the current time and date, and a <b>DACS</b> version
  identification string. This directive has no matching end directive; it is
  essentially a region with no content.
<div style="height: 1.00em;">&#x00A0;</div>
For example, the directive:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;!--DACS id=&quot;*&quot; --&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
will be replaced by a line similar to this:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;--DACS Generated 6-Sep-2007@11:37:43 by dacstransform DACS 1.4.20
 Release date 13-Aug-07 09:39:03 (revid 2034) on example.com --&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Note that the replacement line appears as a comment in the emitted document and
  will pass through <b>dacs_transform</b> unaltered.</div>
<div class="Pp"></div>
insert
<div style="margin-left: 4.00ex;">Document text is read from a specified source
  using the insert directive. Exactly one filename, uri, or expr attribute must
  be provided. Variable references in the inserted content are <i>not</i>
  expanded - if that is required, use the <b>expand</b>[14] directive.
  Directives in the inserted content are not processed if <b>recursion</b>[20]
  has been disabled.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;!--DACS Interpolate browser-specific JavaScript --&gt;
&lt;!--DACS insert=&quot;mozilla&quot; filename=&quot;/dacs/dacs_transform/js/js1.html&quot; --&gt;
&lt;!--DACS insert=&quot;ie&quot; filename=&quot;/dacs/dacs_transform/js/js2.html&quot; --&gt;
&lt;!--DACS insert=&quot;netscape&quot; filename=&quot;/dacs/dacs_transform/js/js3.html&quot; --&gt;
<div class="Pp"></div>
&lt;!--DACS insert=&quot;*&quot; uri=&quot;http://example.com/data&quot; --&gt;
&lt;!--DACS insert=&quot;*&quot; expr=&quot;strftime('%v')&quot; --&gt;
&lt;!--DACS insert=&quot;*&quot; expr=&quot;exec('/bin/date')&quot; --&gt;
&lt;!--DACS insert=&quot;*&quot; expr=&quot;${Attr::arg1} + ${Attr::arg2}&quot; arg1=&quot;10&quot; arg2=&quot;20&quot; --&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
The region name (the value of the insert attribute) is accessible to rules as
  the value of <i>${Args::region}</i>. This directive has no matching end
  directive; it is essentially a region with no content. Like the begin and end
  directives, the insert directive names the region so that an appropriate rule
  can be applied.
<div style="height: 1.00em;">&#x00A0;</div>
The filename attribute gives the pathname of a file to be inserted into the
  document at the current location. When invoked as <b>dacs_transform</b>, the
  pathname must be absolute (i.e., it must begin with a slash character).
<div style="height: 1.00em;">&#x00A0;</div>
The uri attribute gives a URI that is invoked to obtain the document to be
  inserted. The GET method is used by default, but if a method attribute is
  present it specifies the HTTP method to use. The returned document is inserted
  at the current location. If the URI's scheme is file, it is equivalent to the
  filename attribute. The http and https schemes are also recognized.
<div style="height: 1.00em;">&#x00A0;</div>
A third choice is the expr attribute. The <b>expression</b>[11] is evaluated and
  its result is inserted into the document; an evaluation error causes the
  program to terminate.
<div style="height: 1.00em;">&#x00A0;</div>
Because it is needed in many cases and harmless in many others, a newline
  character is emitted after the inserted text. If this behaviour is
  undesirable, use <b>insertv</b>[22].
<div style="height: 1.00em;">&#x00A0;</div>
These directives demonstrates how to expand a variable reference found in a
  template file into the current document:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;!--DACS insert=&quot;*&quot; expr=&quot;expand(get('/tmp/h1_template'))&quot; s=&quot;Section 1&quot;--&gt;
&lt;!--DACS insert=&quot;*&quot; expr=&quot;expand(get('/tmp/h1_template'))&quot; s=&quot;Section 2&quot;--&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
If the file /tmp/h1_template looks like:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;h1&gt;${Attr::s}&lt;/h1&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
then these two lines would be inserted in the program's output:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;h1&gt;Section 1&lt;/h1&gt;
&lt;h1&gt;Section 2&lt;/h1&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
Equivalent but slightly simpler directives can be used for this example:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;!--DACS expand=&quot;*&quot; filename=&quot;/tmp/h1_template&quot; s=&quot;Section 1&quot;--&gt;
&lt;!--DACS expand=&quot;*&quot; filename=&quot;/tmp/h1_template&quot; s=&quot;Section 2&quot;--&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<div class="Pp"></div>
insertv
<div style="margin-left: 4.00ex;">This directive is identical to
  <b>insert</b>[19] except that no newline is appended.</div>
<div class="Pp"></div>
set
<div style="margin-left: 4.00ex;">This directive is used to set variables that
  will exist for the remainder of the current scope (the document being
  processed) and any documents that are recursively processed. Setting a
  variable creates it or overrides its existing value. Any occurrences of the
  variable in an outer scope are unaffected, as are variables that are created
  from attributes associated with a directive.
<div style="height: 1.00em;">&#x00A0;</div>
This directive is useful to set a variable to a string that will be used more
  than once during document processing, or to establish configuration-related
  variables in a single location. This directive can prevent having to
  repeatedly pass the same string argument as an attribute in multiple
  directives.
<div style="height: 1.00em;">&#x00A0;</div>
If gfile looks like:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;!--DACS set=&quot;*&quot; foo=&quot;1&quot; bar=&quot;2&quot; --&gt;
&lt;!--DACS debug=&quot;*&quot; show=&quot;attrs&quot; --&gt;
&lt;!--DACS set=&quot;*&quot; foo=&quot;3&quot; bar=&quot;4&quot; --&gt;
&lt;!--DACS debug=&quot;*&quot; show=&quot;attrs&quot; --&gt;
&lt;!--DACS insert=&quot;*&quot; filename=&quot;gfile2&quot; --&gt;
&lt;!--DACS debug=&quot;*&quot; show=&quot;attrs&quot; --&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
and gfile2 looks like:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;!--DACS debug=&quot;*&quot; show=&quot;attrs&quot; --&gt;
&lt;!--DACS set=&quot;*&quot; foo=&quot;5&quot; bar=&quot;6&quot; bazz=&quot;7&quot; --&gt;
&lt;!--DACS debug=&quot;*&quot; show=&quot;attrs&quot; --&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
then processing gfile will emit this output:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
&lt;!--DACS Debug:
Attrs:
debug=&quot;*&quot;
show=&quot;attrs&quot;
set=&quot;*&quot;
foo=&quot;1&quot;
bar=&quot;2&quot;
--&gt;
<div class="Pp"></div>
&lt;!--DACS Debug:
Attrs:
debug=&quot;*&quot;
show=&quot;attrs&quot;
set=&quot;*&quot;
foo=&quot;3&quot;
bar=&quot;4&quot;
--&gt;
<div class="Pp"></div>
&lt;!--DACS Debug:
Attrs:
debug=&quot;*&quot;
show=&quot;attrs&quot;
insert=&quot;*&quot;
filename=&quot;gfile2&quot;
set=&quot;*&quot;
foo=&quot;3&quot;
bar=&quot;4&quot;
--&gt;
<div class="Pp"></div>
&lt;!--DACS Debug:
Attrs:
debug=&quot;*&quot;
show=&quot;attrs&quot;
set=&quot;*&quot;
foo=&quot;5&quot;
bar=&quot;6&quot;
bazz=&quot;7&quot;
insert=&quot;*&quot;
filename=&quot;gfile2&quot;
--&gt;
<div class="Pp"></div>
&lt;!--DACS Debug:
Attrs:
debug=&quot;*&quot;
show=&quot;attrs&quot;
set=&quot;*&quot;
foo=&quot;3&quot;
bar=&quot;4&quot;
--&gt;
</pre>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>Configuration</b>
<div>&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div class="Pp"></div>
Configuration variables can be set to change some of the program's defaults:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<i>transform_docs</i>: This is the
  full pathname of the root directory in which original documents are kept. By
  default, the program will use a subdirectory
  <i>${Conf::DACS_HOME}</i>dacs_transform/docs. (default:
  /usr/local/dacs/dacs_transform/docs)
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<div>&#x00A0;</div>
<b>Security</b>
<div>&#x00A0;</div>
<div>&#x00A0;</div>
Change the default with care. In the absence of an appropriate access control
  rule, setting the pathname to &quot;/&quot; or the empty string, would provide
  access to any file on the server that can be read by this web service.
<div style="height: 0.50em;">&#x00A0;</div>
</div>
</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<i>transform_acls</i>: This is the VFS
  specification for the rules. By default, the program will use
  <i>${Conf::DACS_HOME}</i>dacs_transform/acls. (default:
  [transform-acls]dacs-fs:/usr/local/dacs/dacs_transform/acls)</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<i>transform_annotation</i>: This is
  the annotation to interpolate in redacted text instead of the default.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<i>transform_prefix</i>: Instead of
  the default prefix used to introduce a directive, the value of this variable
  is used. It must appear at the beginning of a line.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<i>transform_suffix</i>: Instead of
  the default prefix used to end a directive, the value of this variable is
  used.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<i>transform_rprefix</i>: A line whose
  beginning matches the specified regular expression introduces a
  directive.</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">&#x2022;<i>transform_rsuffix</i>: The end of a
  directive is found by matching the specified regular expression.</div>
<div class="Pp"></div>
IEEE Std 1003.2 (&quot;POSIX.2&quot;) &quot;extended&quot; regular expressions
  are supported ( <b>regex(3)</b>[23]).</div>
<h2 class="Ss" title="Ss" id="Web_Service_Arguments"><a class="selflink" href="#Web_Service_Arguments">Web
  Service Arguments</a></h2>
In addition to the <b>standard CGI arguments</b>[24], <b>dacs_transform</b>
  understands the following CGI arguments:
<div class="Pp"></div>
<i>DOC</i>
<div style="margin-left: 4.00ex;">This value of this argument specifies the
  document to be transformed as a file on the server running
  <b>dacs_transform</b>. It is an absolute path that is remapped within a
  segregated area of the web server.</div>
<div class="Pp"></div>
<i>DOCURI</i>
<div style="margin-left: 4.00ex;">This argument specifies the document to be
  transformed as a URI. The URI must use the http or https scheme. The HTTP GET
  method is used to fetch the document and the URI may include query arguments.
  The URI must be properly URL-encoded.</div>
<div class="Pp"></div>
<i>ANNOTATE</i>
<div style="margin-left: 4.00ex;">If this argument is present and its value is
  &quot;yes&quot;, each deleted region of text is denoted in the retrieved
  document; contiguous deleted regions are denoted only once. The default
  annotation assumes a document Content-Type of text/html.</div>
<div class="Pp"></div>
<i>CONTENT_TYPE</i>
<div style="margin-left: 4.00ex;">If this argument is present, this will be the
  MIME Content-Type of the returned document. If this argument is omitted, the
  program will try to guess the type based on the suffix of the name of the
  original document, or default to text/html.</div>
<h1 class="Sh" title="Sh" id="DIAGNOSTICS"><a class="selflink" href="#DIAGNOSTICS">DIAGNOSTICS</a></h1>
The program exits 0 if everything was fine, 1 if an error occurred.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>dacstransform(1)</b>[6], <b>dacs.exprs(5)</b>[11], <b>dacs.acls(5)</b>[25]
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
There is a lot of room for improvement and new features. Directive syntax slants
  towards the arcane; that may get worse before it gets better.
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Distributed Systems Software ( <b>www.dss.ca</b>[26])
<h1 class="Sh" title="Sh" id="COPYING"><a class="selflink" href="#COPYING">COPYING</a></h1>
Copyright2003-2014 Distributed Systems Software. See the <b>LICENSE</b>[27] file
  that accompanies the distribution for licensing information.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"> 1.</dt>
  <dd class="It-tag">dacsoptions</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.1.html#dacsoptions</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 2.</dt>
  <dd class="It-tag">mod_include</dd>
</dl>
<div style="margin-left: 4.00ex;">http://httpd.apache.org/docs/2.2/mod/mod_include.html</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 3.</dt>
  <dd class="It-tag">mod_rewrite</dd>
</dl>
<div style="margin-left: 4.00ex;">http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 4.</dt>
  <dd class="It-tag">mod_ext_filter</dd>
</dl>
<div style="margin-left: 4.00ex;">http://httpd.apache.org/docs/2.2/mod/mod_ext_filter.html</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 5.</dt>
  <dd class="It-tag">PHP</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.php.net/</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 6.</dt>
  <dd class="It-tag">dacstransform(1)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacstransform.1.html</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 7.</dt>
  <dd class="It-tag">transform()</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.exprs.5.html#transform</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 8.</dt>
  <dd class="It-tag">dacs.exprs(5)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man//dacs/man/dacs.exprs.5.html</div>
<dl class="Bl-tag">
  <dt class="It-tag"> 9.</dt>
  <dd class="It-tag">configurable</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#configuration</div>
<dl class="Bl-tag">
  <dt class="It-tag">10.</dt>
  <dd class="It-tag">syntactically valid variable name</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.exprs.5.html#variable_syntax</div>
<dl class="Bl-tag">
  <dt class="It-tag">11.</dt>
  <dd class="It-tag">expression</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.exprs.5.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">12.</dt>
  <dd class="It-tag">namespaces</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.exprs.5.html#reserved_namespaces</div>
<dl class="Bl-tag">
  <dt class="It-tag">13.</dt>
  <dd class="It-tag">negation operator</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#negation</div>
<dl class="Bl-tag">
  <dt class="It-tag">14.</dt>
  <dd class="It-tag">expand</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#EXPAND</div>
<dl class="Bl-tag">
  <dt class="It-tag">15.</dt>
  <dd class="It-tag">end</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#END</div>
<dl class="Bl-tag">
  <dt class="It-tag">16.</dt>
  <dd class="It-tag">begin</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#BEGIN</div>
<dl class="Bl-tag">
  <dt class="It-tag">17.</dt>
  <dd class="It-tag">filter</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#FILTER</div>
<dl class="Bl-tag">
  <dt class="It-tag">18.</dt>
  <dd class="It-tag">filterv</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#FILTERV</div>
<dl class="Bl-tag">
  <dt class="It-tag">19.</dt>
  <dd class="It-tag">insert</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#INSERT</div>
<dl class="Bl-tag">
  <dt class="It-tag">20.</dt>
  <dd class="It-tag">Recursion</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#recursion</div>
<dl class="Bl-tag">
  <dt class="It-tag">21.</dt>
  <dd class="It-tag">expand()</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.exprs.5.html#expand</div>
<dl class="Bl-tag">
  <dt class="It-tag">22.</dt>
  <dd class="It-tag">insertv</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/#INSERTV</div>
<dl class="Bl-tag">
  <dt class="It-tag">23.</dt>
  <dd class="It-tag">regex(3)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.freebsd.org/cgi/man.cgi?query=regex&amp;apropos=0&amp;esektion=3&amp;emanpath=FreeBSD+10.1-RELEASE&amp;format=html</div>
<dl class="Bl-tag">
  <dt class="It-tag">24.</dt>
  <dd class="It-tag">standard CGI arguments</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.services.8.html#standard_cgi_args</div>
<dl class="Bl-tag">
  <dt class="It-tag">25.</dt>
  <dd class="It-tag">dacs.acls(5)</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/dacs.acls.5.html</div>
<dl class="Bl-tag">
  <dt class="It-tag">26.</dt>
  <dd class="It-tag">www.dss.ca</dd>
</dl>
<div style="margin-left: 4.00ex;">http://www.dss.ca</div>
<dl class="Bl-tag">
  <dt class="It-tag">27.</dt>
  <dd class="It-tag">LICENSE</dd>
</dl>
<div style="margin-left: 4.00ex;">http://dacs.dss.ca/man/../misc/LICENSE</div>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">01/12/2017</td>
    <td class="foot-os">DACS 1.4.38a</td>
  </tr>
</table>
</body>
</html>
