<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:10:19 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>DIRVISH-EXPIRE(8) System Manager&rsquo;s Manual
DIRVISH-EXPIRE(8)</p>

<p style="margin-top: 1em">NAME <br>
dirvish-expire - delete expired dirvish images</p>

<p style="margin-top: 1em">SYNOPSIS <br>
dirvish-expire[OPTIONS]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
Delete dirvish image trees or whole images that have
expired.</p>

<p style="margin-top: 1em">Each image summary file is
checked for the Expire: field. If that field indicates the
image has expired dirvish-expire will delete that image from
the vault.</p>

<p style="margin-top: 1em">By default all subdirectories of
all banks will be treated as vaults and all directories
therein except the one named dirvish will be checked for
summary files.</p>

<p style="margin-top: 1em">The removal of an image will
have no effect on other images.</p>

<p style="margin-top: 1em">Dirvish-expire will not delete
an image unless it finds at least one image in that branch
that has an intact image tree and Status: success in the
summary that is not expired.</p>

<p style="margin-top: 1em">OPTIONS <br>
Each option on the command line may be specified any number
of times. Those options that support lists in the config
files will accumulate all of their arguments otherwise each
<br>
specification will override the ones before.</p>

<p style="margin-top: 1em">Each option may be unambiguously
abbreviated.</p>

<p style="margin-top: 1em">--time time_expression <br>
Execute as though time_expression were the current time.</p>

<p style="margin-top: 1em">Time_expression is processed by
Time::Parsedate(3pm) so relative time and date strings are
permitted. See Time::Parsedate(3pm) for more details.</p>

<p style="margin-top: 1em">--tree Only delete the image
tree, leave in place the rest of the image directory with
summary, log and any other image administrative files.</p>

<p style="margin-top: 1em">--vault vault <br>
Restrict expiration to the specified vault.</p>

<p style="margin-top: 1em">--no-run <br>
Don&rsquo;t actually do anything. Just display what would
have happened.</p>

<p style="margin-top: 1em">--quiet <br>
Run quietly, only report errors.</p>

<p style="margin-top: 1em">Normally dirvish-expire will
report the images deleted.</p>

<p style="margin-top: 1em">EXIT CODES <br>
To facilitate further automation and integration of
dirvish-expire with other tools dirvish-expire provides
rationalised exit codes. The exit codes are range based.
While the <br>
code for a specific error may change from one version to
another it will remain within the specified range. So
don&rsquo;t test for specific exit codes but instead test
for a range of <br>
values. To the degree possible higher value ranges indicate
more severe errors.</p>

<p style="margin-top: 1em">0 success</p>

<p style="margin-top: 1em">200-219 <br>
An error was encountered in loading a configuration
file.</p>

<p style="margin-top: 1em">220-254 <br>
An error was detected in the configuration.</p>

<p style="margin-top: 1em">255 Incorrect usage.</p>

<p style="margin-top: 1em">FILES <br>
/etc/dirvish/master.conf <br>
alternate master configuration file.</p>

<p style="margin-top: 1em">/etc/dirvish.conf <br>
master configuration file.</p>

<p style="margin-top: 1em">bank/vault/image/summary <br>
image creation summary.</p>

<p style="margin-top: 1em">bank/vault/image/tree <br>
actual image of source directory tree.</p>

<p style="margin-top: 1em">SEE ALSO <br>
dirvish.conf(5) <br>
Time::ParseDate(3pm)</p>

<p style="margin-top: 1em">BUGS <br>
Dirvish-expire will walk the file hierarchy of all banks or
the specified vault looking for summary files. Anything
non-dirvish in there may cause excess file-walking.</p>
 
<p style="margin-top: 1em">DIRVISH-EXPIRE(8)</p>
<hr>
</body>
</html>
