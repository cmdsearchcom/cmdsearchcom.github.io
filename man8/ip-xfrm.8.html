<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:12:29 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>IP-XFRM(8) Linux IP-XFRM(8)</p>

<p style="margin-top: 1em">NAME <br>
ip-xfrm - transform configuration</p>

<p style="margin-top: 1em">SYNOPSIS <br>
ip [ OPTIONS ] xfrm { COMMAND | help }</p>

<p style="margin-top: 1em">ip xfrm XFRM-OBJECT { COMMAND |
help }</p>

<p style="margin-top: 1em">XFRM-OBJECT := state | policy |
monitor</p>

<p style="margin-top: 1em">ip xfrm state { add | update }
ID [ ALGO-LIST ] [ mode MODE ] [ mark MARK [ mask MASK ] ] [
reqid REQID ] [ seq SEQ ] [ replay-window SIZE ] [
replay-seq SEQ ] [ replay-oseq SEQ <br>
] [ flag FLAG-LIST ] [ sel SELECTOR ] [ LIMIT-LIST ] [ encap
ENCAP ] [ coa ADDR[/PLEN] ] [ ctx CTX ] [ extra-flag
EXTRA-FLAG-LIST ]</p>

<p style="margin-top: 1em">ip xfrm state allocspi ID [ mode
MODE ] [ mark MARK [ mask MASK ] ] [ reqid REQID ] [ seq SEQ
] [ min SPI max SPI ]</p>

<p style="margin-top: 1em">ip xfrm state { delete | get }
ID [ mark MARK [ mask MASK ] ]</p>

<p style="margin-top: 1em">ip xfrm state { deleteall | list
} [ ID ] [ mode MODE ] [ reqid REQID ] [ flag FLAG-LIST
]</p>

<p style="margin-top: 1em">ip xfrm state flush [ proto
XFRM-PROTO ]</p>

<p style="margin-top: 1em">ip xfrm state count</p>

<p style="margin-top: 1em">ID := [ src ADDR ] [ dst ADDR ]
[ proto XFRM-PROTO ] [ spi SPI ]</p>

<p style="margin-top: 1em">XFRM-PROTO := esp | ah | comp |
route2 | hao</p>

<p style="margin-top: 1em">ALGO-LIST := [ ALGO-LIST ]
ALGO</p>

<p style="margin-top: 1em">ALGO := { enc | auth } ALGO-NAME
ALGO-KEYMAT | <br>
auth-trunc ALGO-NAME ALGO-KEYMAT ALGO-TRUNC-LEN | <br>
aead ALGO-NAME ALGO-KEYMAT ALGO-ICV-LEN | <br>
comp ALGO-NAME</p>

<p style="margin-top: 1em">MODE := transport | tunnel |
beet | ro | in_trigger</p>

<p style="margin-top: 1em">FLAG-LIST := [ FLAG-LIST ]
FLAG</p>

<p style="margin-top: 1em">FLAG := noecn | decap-dscp |
nopmtudisc | wildrecv | icmp | af-unspec | align4</p>

<p style="margin-top: 1em">SELECTOR := [ src ADDR[/PLEN] ]
[ dst ADDR[/PLEN] ] [ dev DEV ] <br>
[ UPSPEC ]</p>

<p style="margin-top: 1em">UPSPEC := proto { PROTO | <br>
{ tcp | udp | sctp | dccp } [ sport PORT ] [ dport PORT ] |
<br>
{ icmp | ipv6-icmp | mobility-header } [ type NUMBER ] [
code NUMBER ] | <br>
gre [ key { DOTTED-QUAD | NUMBER } ] }</p>

<p style="margin-top: 1em">LIMIT-LIST := [ LIMIT-LIST ]
limit LIMIT</p>

<p style="margin-top: 1em">LIMIT := { time-soft | time-hard
| time-use-soft | time-use-hard } SECONDS | <br>
{ byte-soft | byte-hard } SIZE | <br>
{ packet-soft | packet-hard } COUNT</p>

<p style="margin-top: 1em">ENCAP := { espinudp |
espinudp-nonike } SPORT DPORT OADDR</p>

<p style="margin-top: 1em">EXTRA-FLAG-LIST := [
EXTRA-FLAG-LIST ] EXTRA-FLAG</p>

<p style="margin-top: 1em">EXTRA-FLAG :=
dont-encap-dscp</p>

<p style="margin-top: 1em">ip xfrm policy { add | update }
SELECTOR dir DIR [ ctx CTX ] [ mark MARK [ mask MASK ] ] [
index INDEX ] [ ptype PTYPE ] [ action ACTION ] [ priority
PRIORITY ] [ flag FLAG-LIST <br>
] [ LIMIT-LIST ] [ TMPL-LIST ]</p>

<p style="margin-top: 1em">ip xfrm policy { delete | get }
{ SELECTOR | index INDEX } dir DIR [ ctx CTX ] [ mark MARK [
mask MASK ] ] [ ptype PTYPE ]</p>

<p style="margin-top: 1em">ip xfrm policy { deleteall |
list } [ SELECTOR ] [ dir DIR ] [ index INDEX ] [ ptype
PTYPE ] [ action ACTION ] [ priority PRIORITY ] [ flag
FLAG-LIST]</p>

<p style="margin-top: 1em">ip xfrm policy flush [ ptype
PTYPE ]</p>

<p style="margin-top: 1em">ip xfrm policy count</p>

<p style="margin-top: 1em">ip xfrm policy set [ hthresh4
LBITS RBITS ] [ hthresh6 LBITS RBITS ]</p>

<p style="margin-top: 1em">SELECTOR := [ src ADDR[/PLEN] ]
[ dst ADDR[/PLEN] ] [ dev DEV ] [ UPSPEC ]</p>

<p style="margin-top: 1em">UPSPEC := proto { PROTO | <br>
{ tcp | udp | sctp | dccp } [ sport PORT ] [ dport PORT ] |
<br>
{ icmp | ipv6-icmp | mobility-header } [ type NUMBER ] [
code NUMBER ] | <br>
gre [ key { DOTTED-QUAD | NUMBER } ] }</p>

<p style="margin-top: 1em">DIR := in | out | fwd</p>

<p style="margin-top: 1em">PTYPE := main | sub</p>

<p style="margin-top: 1em">ACTION := allow | block</p>

<p style="margin-top: 1em">FLAG-LIST := [ FLAG-LIST ]
FLAG</p>

<p style="margin-top: 1em">FLAG := localok | icmp</p>

<p style="margin-top: 1em">LIMIT-LIST := [ LIMIT-LIST ]
limit LIMIT</p>

<p style="margin-top: 1em">LIMIT := { time-soft | time-hard
| time-use-soft | time-use-hard } SECONDS | <br>
{ byte-soft | byte-hard } SIZE | <br>
{ packet-soft | packet-hard } COUNT</p>

<p style="margin-top: 1em">TMPL-LIST := [ TMPL-LIST ] tmpl
TMPL</p>

<p style="margin-top: 1em">TMPL := ID [ mode MODE ] [ reqid
REQID ] [ level LEVEL ]</p>

<p style="margin-top: 1em">ID := [ src ADDR ] [ dst ADDR ]
[ proto XFRM-PROTO ] [ spi SPI ]</p>

<p style="margin-top: 1em">XFRM-PROTO := esp | ah | comp |
route2 | hao</p>

<p style="margin-top: 1em">MODE := transport | tunnel |
beet | ro | in_trigger</p>

<p style="margin-top: 1em">LEVEL := required | use</p>

<p style="margin-top: 1em">ip xfrm monitor [ all-nsid ] [
all <br>
| LISTofXFRM-OBJECTS ]</p>

<p style="margin-top: 1em">LISTofXFRM-OBJECTS := [
LISTofXFRM-OBJECTS ] XFRM-OBJECT</p>

<p style="margin-top: 1em">XFRM-OBJECT := acquire | expire
| SA | policy | aevent | report</p>

<p style="margin-top: 1em">DESCRIPTION <br>
xfrm is an IP framework for transforming packets (such as
encrypting their payloads). This framework is used to
implement the IPsec protocol suite (with the state object
operat&acirc; <br>
ing on the Security Association Database, and the policy
object operating on the Security Policy Database). It is
also used for the IP Payload Compression Protocol and
features <br>
of Mobile IPv6.</p>

<p style="margin-top: 1em">ip xfrm state add add new state
into xfrm</p>

<p style="margin-top: 1em">ip xfrm state update update
existing state in xfrm <br>
ip xfrm state allocspi allocate an SPI value <br>
ip xfrm state delete delete existing state in xfrm <br>
ip xfrm state get get existing state in xfrm <br>
ip xfrm state deleteall delete all existing state in xfrm
<br>
ip xfrm state list print out the list of existing state in
xfrm <br>
ip xfrm state flush flush all state in xfrm <br>
ip xfrm state count count all existing state in xfrm</p>

<p style="margin-top: 1em">ID is specified by a source
address, destination address, transform protocol XFRM-PROTO,
and/or Security Parameter Index SPI. (For IP Payload
Compression, the Compression <br>
Parameter Index or CPI is used for SPI.)</p>

<p style="margin-top: 1em">XFRM-PROTO <br>
specifies a transform protocol: IPsec Encapsulating Security
Payload (esp), IPsec Authentication Header (ah), IP Payload
Compression (comp), Mobile IPv6 Type 2 Routing <br>
Header (route2), or Mobile IPv6 Home Address Option
(hao).</p>

<p style="margin-top: 1em">ALGO-LIST <br>
contains one or more algorithms to use. Each algorithm ALGO
is specified by:</p>

<p style="margin-top: 1em">&Acirc;&middot; the algorithm
type: encryption (enc), authentication (auth or auth-trunc),
authenticated encryption with associated data (aead), or
compression (comp)</p>

<p style="margin-top: 1em">&Acirc;&middot; the algorithm
name ALGO-NAME (see below)</p>

<p style="margin-top: 1em">&Acirc;&middot; (for all except
comp) the keying material ALGO-KEYMAT, which may include
both a key and a salt or nonce value; refer to the
corresponding RFC</p>

<p style="margin-top: 1em">&Acirc;&middot; (for auth-trunc
only) the truncation length ALGO-TRUNC-LEN in bits</p>

<p style="margin-top: 1em">&Acirc;&middot; (for aead only)
the Integrity Check Value length ALGO-ICV-LEN in bits</p>

<p style="margin-top: 1em">Encryption algorithms include
ecb(cipher_null), cbc(des), cbc(des3_ede), cbc(cast5),
cbc(blowfish), cbc(aes), cbc(serpent), cbc(camellia),
cbc(twofish), and <br>
rfc3686(ctr(aes)).</p>

<p style="margin-top: 1em">Authentication algorithms
include digest_null, hmac(md5), hmac(sha1), hmac(sha256),
hmac(sha384), hmac(sha512), hmac(rmd610), and xcbc(aes).</p>

<p style="margin-top: 1em">Authenticated encryption with
associated data (AEAD) algorithms include rfc4106(gcm(aes)),
rfc4309(ccm(aes)), and rfc4543(gcm(aes)).</p>

<p style="margin-top: 1em">Compression algorithms include
deflate, lzs, and lzjh.</p>

<p style="margin-top: 1em">MODE specifies a mode of
operation for the transform protocol. IPsec and IP Payload
Compression modes are transport, tunnel, and (for IPsec ESP
only) Bound End-to-End Tunnel <br>
(beet). Mobile IPv6 modes are route optimization (ro) and
inbound trigger (in_trigger).</p>

<p style="margin-top: 1em">FLAG-LIST <br>
contains one or more of the following optional flags: noecn,
decap-dscp, nopmtudisc, wildrecv, icmp, af-unspec, or
align4.</p>

<p style="margin-top: 1em">SELECTOR <br>
selects the traffic that will be controlled by the policy,
based on the source address, the destination address, the
network device, and/or UPSPEC.</p>

<p style="margin-top: 1em">UPSPEC selects traffic by
protocol. For the tcp, udp, sctp, or dccp protocols, the
source and destination port can optionally be specified. For
the icmp, ipv6-icmp, or mobility- <br>
header protocols, the type and code numbers can optionally
be specified. For the gre protocol, the key can optionally
be specified as a dotted-quad or number. Other pro&acirc;
<br>
tocols can be selected by name or number PROTO.</p>

<p style="margin-top: 1em">LIMIT-LIST <br>
sets limits in seconds, bytes, or numbers of packets.</p>

<p style="margin-top: 1em">ENCAP encapsulates packets with
protocol espinudp or espinudp-nonike, using source port
SPORT, destination port DPORT , and original address
OADDR.</p>

<p style="margin-top: 1em">ip xfrm policy add add a new
policy <br>
ip xfrm policy update update an existing policy <br>
ip xfrm policy delete delete an existing policy <br>
ip xfrm policy get get an existing policy <br>
ip xfrm policy deleteall delete all existing xfrm policies
<br>
ip xfrm policy list print out the list of xfrm policies <br>
ip xfrm policy flush flush policies</p>

<p style="margin-top: 1em">SELECTOR <br>
selects the traffic that will be controlled by the policy,
based on the source address, the destination address, the
network device, and/or UPSPEC.</p>

<p style="margin-top: 1em">UPSPEC selects traffic by
protocol. For the tcp, udp, sctp, or dccp protocols, the
source and destination port can optionally be specified. For
the icmp, ipv6-icmp, or mobility- <br>
header protocols, the type and code numbers can optionally
be specified. For the gre protocol, the key can optionally
be specified as a dotted-quad or number. Other pro&acirc;
<br>
tocols can be selected by name or number PROTO.</p>

<p style="margin-top: 1em">DIR selects the policy direction
as in, out, or fwd.</p>

<p style="margin-top: 1em">CTX sets the security
context.</p>

<p style="margin-top: 1em">PTYPE can be main (default) or
sub.</p>

<p style="margin-top: 1em">ACTION can be allow (default) or
block.</p>

<p style="margin-top: 1em">PRIORITY <br>
is a number that defaults to zero.</p>

<p style="margin-top: 1em">FLAG-LIST <br>
contains one or both of the following optional flags: local
or icmp.</p>

<p style="margin-top: 1em">LIMIT-LIST <br>
sets limits in seconds, bytes, or numbers of packets.</p>

<p style="margin-top: 1em">TMPL-LIST <br>
is a template list specified using ID, MODE, REQID, and/or
LEVEL.</p>

<p style="margin-top: 1em">ID is specified by a source
address, destination address, transform protocol XFRM-PROTO,
and/or Security Parameter Index SPI. (For IP Payload
Compression, the Compression <br>
Parameter Index or CPI is used for SPI.)</p>

<p style="margin-top: 1em">XFRM-PROTO <br>
specifies a transform protocol: IPsec Encapsulating Security
Payload (esp), IPsec Authentication Header (ah), IP Payload
Compression (comp), Mobile IPv6 Type 2 Routing <br>
Header (route2), or Mobile IPv6 Home Address Option
(hao).</p>

<p style="margin-top: 1em">MODE specifies a mode of
operation for the transform protocol. IPsec and IP Payload
Compression modes are transport, tunnel, and (for IPsec ESP
only) Bound End-to-End Tunnel <br>
(beet). Mobile IPv6 modes are route optimization (ro) and
inbound trigger (in_trigger).</p>

<p style="margin-top: 1em">LEVEL can be required (default)
or use.</p>

<p style="margin-top: 1em">ip xfrm policy count count
existing policies</p>

<p style="margin-top: 1em">Use one or more -s options to
display more details, including policy hash table
information.</p>

<p style="margin-top: 1em">ip xfrm policy set configure the
policy hash table</p>

<p style="margin-top: 1em">Security policies whose address
prefix lengths are greater than or equal policy hash table
thresholds are hashed. Others are stored in the
policy_inexact chained list.</p>

<p style="margin-top: 1em">LBITS specifies the minimum
local address prefix length of policies that are stored in
the Security Policy Database hash table.</p>

<p style="margin-top: 1em">RBITS specifies the minimum
remote address prefix length of policies that are stored in
the Security Policy Database hash table.</p>

<p style="margin-top: 1em">ip xfrm monitor state monitoring
for xfrm objects</p>

<p style="margin-top: 1em">The xfrm objects to monitor can
be optionally specified.</p>

<p style="margin-top: 1em">If the all-nsid option is set,
the program listens to all network namespaces that have a
nsid assigned into the network namespace were the program is
running. A prefix is dis&acirc; <br>
played to show the network namespace where the message
originates. Example:</p>

<p style="margin-top: 1em">[nsid 1]Flushed state proto
0</p>

<p style="margin-top: 1em">AUTHOR <br>
Manpage revised by David Ward &lt;david.ward@ll.mit.edu&gt;
<br>
Manpage revised by Christophe Gouault
&lt;christophe.gouault@6wind.com&gt; <br>
Manpage revised by Nicolas Dichtel
&lt;nicolas.dichtel@6wind.com&gt;</p>

<p style="margin-top: 1em">iproute2 20 Dec 2011
IP-XFRM(8)</p>
<hr>
</body>
</html>
