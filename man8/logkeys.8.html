<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>logkeys(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">logkeys(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">logkeys(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
logkeys - a GNU/Linux keylogger that works!
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>logkeys <b>-s</b> [<b>-m </b><i>keymap</i> | <b>-u</b>] [<b>-o
  </b><i>logfile</i>] [ <b>-d </b><i>device</i>]</b>
<div>&#x00A0;</div>
<br/>
 [ <b>--no-func-keys</b>] [<b>--no-timestamps</b>]
<div>&#x00A0;</div>
<br/>
 [ <b>--post-http=</b><i>URL</i>] [<b>--post-size=</b><i>SIZE</i>]
<div>&#x00A0;</div>
<b>logkeys <b>-k</b></b>
<div>&#x00A0;</div>
<b>logkeys [<b>--export-keymap=</b><i>keymap</i>]</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
logkeys is a linux keylogger. It is no more advanced than other available linux
  keyloggers, notably <b>lkl</b> and <b>uberkey</b>, but is a bit newer, more up
  to date, it doesn't unreliably repeat keys and it shouldn't crash your X. All
  in all, it just seems to work. It relies on the event interface of Linux input
  subsystem (normally devices <i>/dev/input/eventX</i>).
<div class="Pp"></div>
Once set, it logs all common character and function keys, while also being fully
  aware of Shift and AltGr key modifiers. It tries to automatically determine
  the correct input device, and may in some cases also get the character keys
  mapping right.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
Non-optional arguments are required for short options too.
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s</b>, <b>--start</b></dt>
  <dd class="It-tag">Starts the keylogging daemon process.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-k</b>, <b>--kill</b></dt>
  <dd class="It-tag">Terminates the running logkeys process.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-o</b>, <b>--output</b>=<i>logfile</i></dt>
  <dd class="It-tag">Set output log file to <i>logfile</i>. If no <b>-o</b>
      option is provided, logkeys appends to <i>/var/log/logkeys.log</i> file.
      If <i>logfile</i> doesn't exist, logkeys creates the file with 600
      permissions.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">See also <b>LOGFILE FORMAT</b> section.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-m</b>, <b>--keymap</b>=<i>keymap</i></dt>
  <dd class="It-tag">Use file <i>keymap</i> as input keymap for processing
      pressed keys.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">This option works best if <i>keymap</i> is hand corrected
      file, which had been previously exported by <b>--export-keymap</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">See also <b>KEYMAP FORMAT</b> section.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><b>-m</b> and <b>-u</b> option are mutually exclusive.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d</b>, <b>--device</b>=<i>device</i></dt>
  <dd class="It-tag">Use <i>device</i> as keyboard input event device instead of
      <i>/dev/input/eventX</i> default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">You can determine the keyboard device to be used by
      examining <i>/proc/bus/input/devices</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-u</b>, <b>--us-keymap</b></dt>
  <dd class="It-tag">This option makes logkeys interpret keys as on standard US
      keyboard.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><b>-u</b> and <b>-m</b> option are mutually exclusive.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--export-keymap</b>=<i>keymap</i></dt>
  <dd class="It-tag">This option makes logkeys export dynamic keymap as obtained
      from <i>dumpkeys</i>(1) to file <i>keymap</i> and then exit.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><i>keymap</i> can later be used with <b>-m</b> option to
      override automatic keymap &quot;calculation&quot;, which may be
    wrong.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">It is advised that you manually edit <i>keymap</i> and
      correct any mistakes as well as complete deficient entries. It is also
      advised that you use <b>--export-keymap</b> on a virtual terminal outside
      of X ( <i>/dev/ttyX</i>).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">See section <b>KEYMAP FORMAT</b> for exported keymap
      format.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--no-func-keys</b></dt>
  <dd class="It-tag">This option makes logkeys log all and only character key
      presses (1, 2, ..., q, w, e, ..., a, s, d, f, ..., &quot;, @, \,
    ...).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">This option may be useful when correct <i>keymap</i> can
      reliably be expected (i.e. by providing it with <b>-m</b> option). Then
      only character keys are logged, influenced by Shift and AltGr modifiers.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--no-timestamps</b></dt>
  <dd class="It-tag">When this option is set, logkeys doesn't prepend timestamp
      to each line of log file. Timestamps are only logged when logkeys starts
      and stops.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--post-size=</b><i>SIZE</i></dt>
  <dd class="It-tag">When log size reaches <i>SIZE</i>, the current log filename
      is appended <i>.X</i>, where X is ascending number (e.g.
      <i>logfile.1</i>).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">When that happens, logkeys starts remote uploading process
      and all <i>logfile.X</i> files are uploaded as specified by
      <b>--post-http</b> or <b>--post-irc</b> options.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">If <b>--post-size</b> is set, but no post method is set,
      then the logfile is only truncated when it reaches <i>SIZE</i>, renamed to
      <i>logfile.X</i>, and a new blank logfile is created for active
    logging.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">If <b>--post-size</b> is not set, but post method is, then
      the default <i>SIZE</i> of 500 KB (500.000 B) is used.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">If <b>--post-size</b> is not set, and neither is any post
      method, then logkeys appends to the single specified log file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag"><i>SIZE</i> can be an integer bytesize, or an intger
      followed by K or M for kilobytes or megabytes, respectively.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--post-http=</b><i>URL</i></dt>
  <dd class="It-tag">This option tells logkeys to POST the log file to URL,
      where it is preferrably greeted by a (PHP) script.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">The file is sent with header
      <i>Content-Type:&#x00A0;multipart/form-data</i> as file, so it is
      accessible in PHP via $_FILES['file'] variable.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>/var/log/logkeys.log</b></dt>
  <dd class="It-tag">When <b>-o</b> option is not used, logkeys appends to this
      default log file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>etc/logkeys-start.sh</b></dt>
  <dd class="It-tag">Setuid root program <i>llk</i> runs this script. Edit the
      contents to suit your needs.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>etc/logkeys-stop.sh</b></dt>
  <dd class="It-tag">Setuid root program <i>llkk</i> runs this script. Default
      value should work well.
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="LOGFILE_FORMAT"><a class="selflink" href="#LOGFILE_FORMAT">LOGFILE
  FORMAT</a></h1>
Log files are <b>UTF-8 encoded</b>.
<div class="Pp"></div>
Each logging session is enclosed in &quot;Logging started...
  [&lt;timestamp&gt;]&quot; and &quot;Logging stopped at &lt;timestamp&gt;&quot;
  strings. Whenever Enter key (Return key) or Ctrl+C or Ctrl+D combination is
  pressed, a timestamp is appended on a new line (provided
  <b>--no-timestamps</b> is not in effect).
<div class="Pp"></div>
Timestamp format is &quot;%F&#x00A0;%T%z&quot;, which results in
  &quot;YYYY-mm-dd HH:MM:SS+ZZZZ&quot;. Timestamp is separated from the logged
  keys by one '&gt;' symbol.
<div class="Pp"></div>
All character key presses are logged as they appear. All function key presses
  are replaced with strings as obtained from <i>keymap</i> file, or as hardcoded
  when no <i>keymap</i> file is provided.
<div class="Pp"></div>
If a key is pressed down long enough so it repeats, it is logged only once and
  then &quot;&lt;#+DD&gt;&quot; is appended, which hints the key was repeated DD
  more times. The DD decimal figure is not to be relied on.
<div class="Pp"></div>
If a keypress results in keycode, which is not recognized (i.e. key not found on
  a standard US or Intl 105-key keyboard), then the string
  &quot;&lt;E-XX&gt;&quot; is appended, where XX is the received keycode in
  hexadecimal format. All new &quot;WWW&quot;, &quot;E-Mail&quot;,
  &quot;Volume+&quot;, &quot;Media&quot;, &quot;Help&quot;, etc. keys will
  result in such error strings.
<div class="Pp"></div>
Using US keyboard layout, one example log file could look like:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Logging started ...</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">2009-12-11 09:58:17+0100 &gt; llk
    <div>&#x00A0;</div>
    2009-12-11 09:58:20+0100 &gt; sudo cp &lt;RShift&gt;~/foo.&lt;Tab&gt;
      /usr/bin
    <div>&#x00A0;</div>
    2009-12-11 09:58:26+0100 &gt; &lt;LShift&gt;R00&lt;LShift&gt;T_p455\\/0rD
    <div>&#x00A0;</div>
    2009-12-11 09:58:39+0100 &gt; &lt;Up&gt;&lt;Up&gt;&lt;Home&gt;sudo
    <div>&#x00A0;</div>
    2009-12-11 09:58:44+0100 &gt;
      c&lt;#+53&gt;&lt;BckSp&gt;&lt;#+34&gt;&lt;LCtrl&gt;c
    <div>&#x00A0;</div>
    2009-12-11 09:58:54+0100 &gt; llkk</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Logging stopped at 2009-12-11 09:58:54+0100</dd>
</dl>
<div class="Pp"></div>
If the same log was obtained by a logkeys process invoked with
  <b>--no-func-keys</b> option, it would look like:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Logging started ...</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">2009-12-11 09:58:17+0100 &gt; llk
    <div>&#x00A0;</div>
    2009-12-11 09:58:20+0100 &gt; sudo cp ~/foo. /usr/bin
    <div>&#x00A0;</div>
    2009-12-11 09:58:26+0100 &gt; R00T_p455\\/0rD
    <div>&#x00A0;</div>
    2009-12-11 09:58:39+0100 &gt; sudo
    <div>&#x00A0;</div>
    2009-12-11 09:58:44+0100 &gt; c&lt;#+53&gt;c
    <div>&#x00A0;</div>
    2009-12-11 09:58:54+0100 &gt; llkk</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Logging stopped at 2009-12-11 09:58:54+0100</dd>
</dl>
<div class="Pp"></div>
Even when <b>--no-func-keys</b> is in effect, Space and Tab key presses are
  logged as a single space character.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="KEYMAP_FORMAT"><a class="selflink" href="#KEYMAP_FORMAT">KEYMAP
  FORMAT</a></h1>
The keymap file is expected to be <b>UTF-8 encoded</b>.
<div class="Pp"></div>
Each line of file represents either one character key or one function key. The
  format specifies <b>at least one</b> and <b>up to three</b> space-delimited
  characters on character key lines (first without modifiers, optional second
  with Shift in action, optional third with AltGr in action), and up to <b>7
  characters long</b> string on function key lines.
<div class="Pp"></div>
First three lines in a Slovene keymap file look like:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">&lt;Esc&gt;
    <div>&#x00A0;</div>
    1 ! ~
    <div>&#x00A0;</div>
    2 &quot; &#x02C7;
    <div>&#x00A0;</div>
  </dd>
</dl>
<div class="Pp"></div>
How does one know which lines belong to character keys and which lines to
  function keys?
<div class="Pp"></div>
Well, the easiest way is to use <b>--export-keymap</b>, and examine the exported
  keymap. Make sure you export in a virtual terminal (ttyX) and not in X as this
  way more keys could get exported correctly (don't ask me why).
<div class="Pp"></div>
Basically, <b>--export-keymap</b> ouputs 106 lines for 106 keys, even if some of
  those keys aren't located on your keyboard. Lines 1, 14, 15, 28, 29, 42,
  54-83, 85-106 belong to function keys, all other lines (2-13, 16-27, 30-41,
  43-53, 84) belong to character keys.
<div class="Pp"></div>
Line 57 is reserved for Space and it should always be ' '. Line 84 is reserved
  for the key just right to left Shift that is present on some international
  layouts. Other lines can be quite reliably determined by looking at one
  <b>exported keymap</b>. The keys generally follow the order of their
  appearance on the keyboard, top-to-bottom left-to-right.
<div class="Pp"></div>
If you create full and completely valid keymap for your particular language,
  please upload it to project website or send it to me by e-mail. Thanks.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
To print short help:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">$ logkeys</dd>
</dl>
<div class="Pp"></div>
To start logging to a custom log file with dynamically generated keymap:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">$ logkeys --start --output /home/user/.secret/log</dd>
</dl>
<div class="Pp"></div>
To start logging to default log file on a standard US keyboard:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">$ logkeys --start --us-keymap</dd>
</dl>
<div class="Pp"></div>
To export dynamically generated keymap to file:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">$ logkeys --export-keymap my_keymap</dd>
</dl>
<div class="Pp"></div>
To start logging to default log file with a custom keymap:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">$ logkeys --start --keymap my_keymap</dd>
</dl>
<div class="Pp"></div>
To use a custom event device (e.g. /dev/input/event4):
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">$ logkeys --start --device event4</dd>
</dl>
<div class="Pp"></div>
To end running logkeys process:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">$ logkeys --kill</dd>
</dl>
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
logkeys relies on numeric output of <i>dumpkeys</i>(1), which <i>keymaps</i>(5)
  manual page specifically discourages as unportable.
<div class="Pp"></div>
Be nice and hope nothing breaks.
<div class="Pp"></div>
If you come across any bugs, please report them on project website, issues page:
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">http://code.google.com/p/logkeys/issues/</dd>
</dl>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
logkeys was written by Kernc &lt;kerncece+logkeys@gmail.com&gt; with much help
  from the community.
<div class="Pp"></div>
You can always obtain the latest version and information at project website:
  &lt;http://code.google.com/p/logkeys/&gt;.</div>
<table class="foot">
  <tr>
    <td class="foot-date">2010-05-25</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
