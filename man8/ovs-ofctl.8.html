<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:14:16 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>ovs-ofctl(8) Open vSwitch Manual ovs-ofctl(8)</p>

<p style="margin-top: 1em">NAME <br>
ovs-ofctl - administer OpenFlow switches</p>

<p style="margin-top: 1em">SYNOPSIS <br>
ovs-ofctl [options] command [switch] [args...]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
The ovs-ofctl program is a command line tool for monitoring
and administering OpenFlow switches. It can also show the
current state of an OpenFlow switch, including features,
<br>
configuration, and table entries. It should work with any
OpenFlow switch, not just Open vSwitch.</p>

<p style="margin-top: 1em">OpenFlow Switch Management
Commands <br>
These commands allow ovs-ofctl to monitor and administer an
OpenFlow switch. It is able to show the current state of a
switch, including features, configuration, and table <br>
entries.</p>

<p style="margin-top: 1em">Most of these commands take an
argument that specifies the method for connecting to an
OpenFlow switch. The following connection methods are
supported:</p>

<p style="margin-top: 1em">ssl:ip[:port] <br>
tcp:ip[:port] <br>
The specified port on the host at the given ip, which must
be expressed as an IP address (not a DNS name) in IPv4 or
IPv6 address format. Wrap IPv6 addresses in <br>
square brackets, e.g. tcp:[::1]:6653. For ssl, the
--private-key, --certificate, and --ca-cert options are
mandatory.</p>

<p style="margin-top: 1em">If port is not specified, it
defaults to 6653.</p>

<p style="margin-top: 1em">unix:file <br>
On POSIX, a Unix domain server socket named file.</p>

<p style="margin-top: 1em">On Windows, connect to a local
named pipe that is represented by a file created in the path
file to mimic the behavior of a Unix domain socket.</p>

<p style="margin-top: 1em">file This is short for
unix:file, as long as file does not contain a colon.</p>

<p style="margin-top: 1em">bridge This is short for
unix:/var/run/openvswitch/bridge.mgmt, as long as bridge
does not contain a colon.</p>

<p style="margin-top: 1em">[type@]dp <br>
Attempts to look up the bridge associated with dp and open
as above. If type is given, it specifies the datapath
provider of dp, otherwise the default provider <br>
system is assumed.</p>

<p style="margin-top: 1em">show switch <br>
Prints to the console information on switch, including
information on its flow tables and ports.</p>

<p style="margin-top: 1em">dump-tables switch <br>
Prints to the console statistics for each of the flow tables
used by switch.</p>

<p style="margin-top: 1em">dump-table-features switch <br>
Prints to the console features for each of the flow tables
used by switch.</p>

<p style="margin-top: 1em">dump-table-desc switch <br>
Prints to the console configuration for each of the flow
tables used by switch for OpenFlow 1.4+.</p>

<p style="margin-top: 1em">mod-table switch table_id
setting <br>
This command configures flow table settings for OpenFlow
table table_id within switch. The available settings depend
on the OpenFlow version in use. In OpenFlow 1.1 and <br>
1.2 (which must be enabled with the -O option) only,
mod-table configures behavior when no flow is found when a
packet is looked up in a flow table. The following setting
<br>
values are available:</p>

<p style="margin-top: 1em">drop Drop the packet.</p>

<p style="margin-top: 1em">continue <br>
Continue to the next table in the pipeline. (This is how an
OpenFlow 1.0 switch always handles packets that do not match
any flow, in tables other than the last <br>
one.)</p>

<p style="margin-top: 1em">controller <br>
Send to controller. (This is how an OpenFlow 1.0 switch
always handles packets that do not match any flow in the
last table.)</p>

<p style="margin-top: 1em">In OpenFlow 1.4 and later (which
must be enabled with the -O option) only, mod-table
configures the behavior when a controller attempts to add a
flow to a flow table that <br>
is full. The following setting values are available:</p>

<p style="margin-top: 1em">evict Delete some existing flow
from the flow table, according to the algorithm described
for the Flow_Table table in ovs-vswitchd.conf.db(5).</p>

<p style="margin-top: 1em">noevict <br>
Refuse to add the new flow. (Eviction might still be enabled
through the overflow_policy column in the Flow_Table table
documented in ovs-vswitchd.conf.db(5).)</p>

<p style="margin-top: 1em">vacancy:low,high <br>
Enables sending vacancy events to controllers using
TABLE_STATUS messages, based on percentage thresholds low
and high.</p>

<p style="margin-top: 1em">novacancy <br>
Disables vacancy events.</p>

<p style="margin-top: 1em">dump-ports switch [netdev] <br>
Prints to the console statistics for network devices
associated with switch. If netdev is specified, only the
statistics associated with that device will be printed. <br>
netdev can be an OpenFlow assigned port number or device
name, e.g. eth0.</p>

<p style="margin-top: 1em">dump-ports-desc switch [port]
<br>
Prints to the console detailed information about network
devices associated with switch. To dump only a specific
port, specify its number as port. Otherwise, if port is <br>
omitted, or if it is specified as ANY, then all ports are
printed. This is a subset of the information provided by the
show command.</p>

<p style="margin-top: 1em">If the connection to switch
negotiates OpenFlow 1.0, 1.2, or 1.2, this command uses an
OpenFlow extension only implemented in Open vSwitch (version
1.7 and later).</p>

<p style="margin-top: 1em">Only OpenFlow 1.5 and later
support dumping a specific port. Earlier versions of
OpenFlow always dump all ports.</p>

<p style="margin-top: 1em">mod-port switch port action <br>
Modify characteristics of port port in switch. port may be
an OpenFlow port number or name or the keyword LOCAL (the
preferred way to refer to the OpenFlow local port). <br>
The action may be any one of the following: <br>
up <br>
down Enable or disable the interface. This is equivalent to
ifconfig up or ifconfig down on a Unix system.</p>

<p style="margin-top: 1em">stp <br>
no-stp Enable or disable 802.1D spanning tree protocol (STP)
on the interface. OpenFlow implementations that don&rsquo;t
support STP will refuse to enable it.</p>

<p style="margin-top: 1em">receive <br>
no-receive <br>
receive-stp <br>
no-receive-stp <br>
Enable or disable OpenFlow processing of packets received on
this interface. When packet processing is disabled, packets
will be dropped instead of being processed <br>
through the OpenFlow table. The receive or no-receive
setting applies to all packets except 802.1D spanning tree
packets, which are separately controlled by <br>
receive-stp or no-receive-stp.</p>

<p style="margin-top: 1em">forward <br>
no-forward <br>
Allow or disallow forwarding of traffic to this interface.
By default, forwarding is enabled.</p>

<p style="margin-top: 1em">flood <br>
no-flood <br>
Controls whether an OpenFlow flood action will send traffic
out this interface. By default, flooding is enabled.
Disabling flooding is primarily useful to prevent <br>
loops when a spanning tree protocol is not in use.</p>

<p style="margin-top: 1em">packet-in <br>
no-packet-in <br>
Controls whether packets received on this interface that do
not match a flow table entry generate a &lsquo;&lsquo;packet
in&rsquo;&rsquo; message to the OpenFlow controller. By
default, <br>
&lsquo;&lsquo;packet in&rsquo;&rsquo; messages are
enabled.</p>

<p style="margin-top: 1em">The show command displays (among
other information) the configuration that mod-port
changes.</p>

<p style="margin-top: 1em">get-frags switch <br>
Prints switch&rsquo;s fragment handling mode. See set-frags,
below, for a description of each fragment handling mode.</p>

<p style="margin-top: 1em">The show command also prints the
fragment handling mode among its other output.</p>

<p style="margin-top: 1em">set-frags switch frag_mode <br>
Configures switch&rsquo;s treatment of IPv4 and IPv6
fragments. The choices for frag_mode are:</p>

<p style="margin-top: 1em">normal Fragments pass through
the flow table like non-fragmented packets. The TCP ports,
UDP ports, and ICMP type and code fields are always set to
0, even for fragments <br>
where that information would otherwise be available
(fragments with offset 0). This is the default fragment
handling mode for an OpenFlow switch.</p>

<p style="margin-top: 1em">drop Fragments are dropped
without passing through the flow table.</p>

<p style="margin-top: 1em">reassemble <br>
The switch reassembles fragments into full IP packets before
passing them through the flow table. Open vSwitch does not
implement this fragment handling mode.</p>

<p style="margin-top: 1em">nx-match <br>
Fragments pass through the flow table like non-fragmented
packets. The TCP ports, UDP ports, and ICMP type and code
fields are available for matching for fragments <br>
with offset 0, and set to 0 in fragments with nonzero
offset. This mode is a Nicira extension.</p>

<p style="margin-top: 1em">See the description of ip_frag,
below, for a way to match on whether a packet is a fragment
and on its fragment offset.</p>

<p style="margin-top: 1em">dump-flows switch [flows] <br>
Prints to the console all flow entries in switch&rsquo;s
tables that match flows. If flows is omitted, all flows in
the switch are retrieved. See Flow Syntax, below, for the
<br>
syntax of flows. The output format is described in Table
Entry Output.</p>

<p style="margin-top: 1em">By default, ovs-ofctl prints
flow entries in the same order that the switch sends them,
which is unlikely to be intuitive or consistent. See the
description of --sort and <br>
--rsort, under OPTIONS below, to influence the display
order.</p>

<p style="margin-top: 1em">dump-aggregate switch [flows]
<br>
Prints to the console aggregate statistics for flows in
switch&rsquo;s tables that match flows. If flows is omitted,
the statistics are aggregated across all flows in the <br>
switch&rsquo;s flow tables. See Flow Syntax, below, for the
syntax of flows. The output format is described in Table
Entry Output.</p>

<p style="margin-top: 1em">queue-stats switch [port
[queue]] <br>
Prints to the console statistics for the specified queue on
port within switch. port can be an OpenFlow port number or
name, the keyword LOCAL (the preferred way to refer <br>
to the OpenFlow local port), or the keyword ALL. Either of
port or queue or both may be omitted (or equivalently the
keyword ALL). If both are omitted, statistics are <br>
printed for all queues on all ports. If only queue is
omitted, then statistics are printed for all queues on port;
if only port is omitted, then statistics are printed <br>
for queue on every port where it exists.</p>

<p style="margin-top: 1em">queue-get-config switch [port
[queue]] <br>
Prints to the console the configuration of queue on port in
switch. If port is omitted or ANY, reports queues for all
port. If queue is omitted or ANY, reports all <br>
queues. For OpenFlow 1.3 and earlier, the output always
includes all queues, ignoring queue if specified.</p>

<p style="margin-top: 1em">This command has limited
usefulness, because ports often have no configured queues
and because the OpenFlow protocol provides only very limited
information about the con&acirc; <br>
figuration of a queue.</p>

<p style="margin-top: 1em">dump-ipfix-bridge switch <br>
Prints to the console the statistics of bridge IPFIX for
switch. If bridge IPFIX is configured on the switch, IPFIX
statistics can be retrieved. Otherwise, error message <br>
will be printed.</p>

<p style="margin-top: 1em">This command uses an Open
vSwitch extension that is only in Open vSwitch 2.6 and
later.</p>

<p style="margin-top: 1em">dump-ipfix-flow switch <br>
Prints to the console the statistics of flow-based IPFIX for
switch. If flow-based IPFIX is configured on the switch,
statistics of all the collector set ids on the <br>
switch will be printed. Otherwise, print error message.</p>

<p style="margin-top: 1em">Refer to ovs-vswitchd.conf.db(5)
for more details on configuring flow based IPFIX and
collector set ids.</p>

<p style="margin-top: 1em">This command uses an Open
vSwitch extension that is only in Open vSwitch 2.6 and
later.</p>

<p style="margin-top: 1em">ct-flush-zone switch zone <br>
Flushes the connection tracking entries in zone on
switch.</p>

<p style="margin-top: 1em">This command uses an Open
vSwitch extension that is only in Open vSwitch 2.6 and
later.</p>

<p style="margin-top: 1em">OpenFlow 1.1+ Group Table
Commands <br>
The following commands work only with switches that support
OpenFlow 1.1 or later. Because support for OpenFlow 1.1 and
later is still experimental in Open vSwitch, it is
neces&acirc; <br>
sary to explicitly enable these protocol versions in
ovs-ofctl (using -O) and in the switch itself (with the
protocols column in the Bridge table). For more information,
see <br>
&lsquo;&lsquo;Q: What versions of OpenFlow does Open vSwitch
support?&rsquo;&rsquo; in the Open vSwitch FAQ.</p>

<p style="margin-top: 1em">dump-groups switch [group] <br>
Prints group entries in switch&rsquo;s tables to console. To
dump only a specific group, specify its number as group.
Otherwise, if group is omitted, or if it is specified as
<br>
ALL, then all groups are printed. Each line of output is a
group entry as described in Group Syntax below.</p>

<p style="margin-top: 1em">Only OpenFlow 1.5 and later
support dumping a specific group. Earlier versions of
OpenFlow always dump all groups.</p>

<p style="margin-top: 1em">dump-group-features switch <br>
Prints to the console the group features of the switch.</p>

<p style="margin-top: 1em">dump-group-stats switch [groups]
<br>
Prints to the console statistics for the specified groups in
the switch&rsquo;s tables. If groups is omitted then
statistics for all groups are printed. See Group Syntax,
<br>
below, for the syntax of groups.</p>

<p style="margin-top: 1em">OpenFlow 1.3+ Switch Meter Table
Commands <br>
These commands manage the meter table in an OpenFlow switch.
In each case, meter specifies a meter entry in the format
described in Meter Syntax, below.</p>

<p style="margin-top: 1em">OpenFlow 1.3 introduced support
for meters, so these commands only work with switches that
support OpenFlow 1.3 or later. The caveats described for
groups in the previous sec&acirc; <br>
tion also apply to meters.</p>

<p style="margin-top: 1em">add-meter switch meter <br>
Add a meter entry to switch&rsquo;s tables. The meter syntax
is described in section Meter Syntax, below.</p>

<p style="margin-top: 1em">mod-meter switch meter <br>
Modify an existing meter.</p>

<p style="margin-top: 1em">del-meters switch <br>
del-meter switch [meter] <br>
Delete entries from switch&rsquo;s meter table. meter can
specify a single meter with syntax meter=id, or all meters
with syntax meter=all.</p>

<p style="margin-top: 1em">dump-meters switch <br>
dump-meter switch [meter] <br>
Print meter configuration. meter can specify a single meter
with syntax meter=id, or all meters with syntax
meter=all.</p>

<p style="margin-top: 1em">meter-stats switch [meter] <br>
Print meter statistics. meter can specify a single meter
with syntax meter=id, or all meters with syntax
meter=all.</p>

<p style="margin-top: 1em">meter-features switch <br>
Print meter features.</p>

<p style="margin-top: 1em">OpenFlow Switch Flow Table
Commands <br>
These commands manage the flow table in an OpenFlow switch.
In each case, flow specifies a flow entry in the format
described in Flow Syntax, below, file is a text file that
<br>
contains zero or more flows in the same syntax, one per
line, and the optional --bundle option operates the command
as a single atomic transation, see option --bundle,
below.</p>

<p style="margin-top: 1em">[--bundle] add-flow switch flow
<br>
[--bundle] add-flow switch - &lt; file <br>
[--bundle] add-flows switch file <br>
Add each flow entry to switch&rsquo;s tables. Each flow
specification (e.g., each line in file) may start with add,
modify, delete, modify_strict, or delete_strict keyword to
<br>
specify whether a flow is to be added, modified, or deleted,
and whether the modify or delete is strict or not. For
backwards compatibility a flow specification without <br>
one of these keywords is treated as a flow add. All flow
mods are executed in the order specified.</p>

<p style="margin-top: 1em">[--bundle] [--strict] mod-flows
switch flow <br>
[--bundle] [--strict] mod-flows switch - &lt; file <br>
Modify the actions in entries from switch&rsquo;s tables
that match the specified flows. With --strict, wildcards are
not treated as active for matching purposes.</p>

<p style="margin-top: 1em">[--bundle] del-flows switch <br>
[--bundle] [--strict] del-flows switch [flow] <br>
[--bundle] [--strict] del-flows switch - &lt; file <br>
Deletes entries from switch&rsquo;s flow table. With only a
switch argument, deletes all flows. Otherwise, deletes flow
entries that match the specified flows. With --strict, <br>
wildcards are not treated as active for matching
purposes.</p>

<p style="margin-top: 1em">[--bundle] [--readd]
replace-flows switch file <br>
Reads flow entries from file (or stdin if file is -) and
queries the flow table from switch. Then it fixes up any
differences, adding flows from flow that are missing on <br>
switch, deleting flows from switch that are not in file, and
updating flows in switch whose actions, cookie, or timeouts
differ in file.</p>

<p style="margin-top: 1em">With --readd, ovs-ofctl adds all
the flows from file, even those that exist with the same
actions, cookie, and timeout in switch. This resets all the
flow packet and byte <br>
counters to 0, which can be useful for debugging.</p>

<p style="margin-top: 1em">diff-flows source1 source2 <br>
Reads flow entries from source1 and source2 and prints the
differences. A flow that is in source1 but not in source2 is
printed preceded by a -, and a flow that is in <br>
source2 but not in source1 is printed preceded by a +. If a
flow exists in both source1 and source2 with different
actions, cookie, or timeouts, then both versions are <br>
printed preceded by - and +, respectively.</p>

<p style="margin-top: 1em">source1 and source2 may each
name a file or a switch. If a name begins with / or ., then
it is considered to be a file name. A name that contains :
is considered to be a <br>
switch. Otherwise, it is a file if a file by that name
exists, a switch if not.</p>

<p style="margin-top: 1em">For this command, an exit status
of 0 means that no differences were found, 1 means that an
error occurred, and 2 means that some differences were
found.</p>

<p style="margin-top: 1em">packet-out switch packet-out
<br>
Connects to switch and instructs it to execute the
packet-out OpenFlow message, specified as defined in
Packet-Out Syntax section.</p>

<p style="margin-top: 1em">OpenFlow Switch Group Table
Commands <br>
These commands manage the group table in an OpenFlow switch.
In each case, group specifies a group entry in the format
described in Group Syntax, below, and file is a text file
<br>
that contains zero or more groups in the same syntax, one
per line, and the optional --bundle option operates the
command as a single atomic transation, see option --bundle,
<br>
below.</p>

<p style="margin-top: 1em">[--bundle] add-group switch
group <br>
[--bundle] add-group switch - &lt; file <br>
[--bundle] add-groups switch file <br>
Add each group entry to switch&rsquo;s tables. Each group
specification (e.g., each line in file) may start with add,
modify, add_or_mod, delete, insert_bucket, or <br>
remove_bucket keyword to specify whether a flow is to be
added, modified, or deleted, or whether a group bucket is to
be added or removed. For backwards compatibility a <br>
group specification without one of these keywords is treated
as a group add. All group mods are executed in the order
specified.</p>

<p style="margin-top: 1em">[--bundle] [--may-create]
mod-group switch group <br>
[--bundle] [--may-create] mod-group switch - &lt; file <br>
Modify the action buckets in entries from switch&rsquo;s
tables for each group entry. If a specified group does not
already exist, then without --may-create, this command has
<br>
no effect; with --may-create, it creates a new group. The
--may-create option uses an Open vSwitch extension to
OpenFlow only implemented in Open vSwitch 2.6 and later.</p>

<p style="margin-top: 1em">[--bundle] del-groups switch
<br>
[--bundle] del-groups switch [group] <br>
[--bundle] del-groups switch - &lt; file <br>
Deletes entries from switch&rsquo;s group table. With only a
switch argument, deletes all groups. Otherwise, deletes the
group for each group entry.</p>

<p style="margin-top: 1em">[--bundle] insert-buckets switch
group <br>
[--bundle] insert-buckets switch - &lt; file <br>
Add buckets to an existing group present in the
switch&rsquo;s group table. If no command_bucket_id is
present in the group specification then all buckets of the
group are <br>
removed.</p>

<p style="margin-top: 1em">[--bundle] remove-buckets switch
group <br>
[--bundle] remove-buckets switch - &lt; file <br>
Remove buckets to an existing group present in the
switch&rsquo;s group table. If no command_bucket_id is
present in the group specification then all buckets of the
group are <br>
removed.</p>

<p style="margin-top: 1em">OpenFlow Switch Bundle Command
<br>
Transactional updates to both flow and group tables can be
made with the bundle command. file is a text file that
contains zero or more flow mods, group mods, or packet-outs
in <br>
Flow Syntax, Group Syntax, or Packet-Out Syntax, each line
preceded by flow, group, or packet-out keyword,
correspondingly. The flow keyword may be optionally followed
by one of <br>
the keywords add, modify, modify_strict, delete, or
delete_strict, of which the add is assumed if a bare flow is
given. Similarly, the group keyword may be optionally
followed <br>
by one of the keywords add, modify, add_or_mod, delete,
insert_bucket, or remove_bucket, of which the add is assumed
if a bare group is given.</p>

<p style="margin-top: 1em">bundle switch file <br>
Execute all flow and group mods in file as a single atomic
transaction against switch&rsquo;s tables. All bundled mods
are executed in the order specified.</p>

<p style="margin-top: 1em">OpenFlow Switch Tunnel TLV Table
Commands <br>
Open vSwitch maintains a mapping table between tunnel option
TLVs (defined by &lt;class, type, length&gt;) and NXM fields
tun_metadatan, where n ranges from 0 to 63, that can be
oper&acirc; <br>
ated on for the purposes of matches, actions, etc. This TLV
table can be used for Geneve option TLVs or other protocols
with options in same TLV format as Geneve options. This <br>
mapping must be explicitly specified by the user through the
following commands.</p>

<p style="margin-top: 1em">A TLV mapping is specified with
the syntax
{class=class,type=type,len=length}-&gt;tun_metadatan. When
an option mapping exists for a given tun_metadatan, matching
on the defined <br>
field becomes possible, e.g.:</p>

<p style="margin-top: 1em">ovs-ofctl add-tlv-map br0
&quot;{class=0xffff,type=0,len=4}-&gt;tun_metadata0&quot;</p>

<p style="margin-top: 1em">ovs-ofctl add-flow br0
tun_metadata0=1234,actions=controller</p>

<p style="margin-top: 1em">A mapping should not be changed
while it is in active use by a flow. The result of doing so
is undefined.</p>

<p style="margin-top: 1em">These commands are Nicira
extensions to OpenFlow and require Open vSwitch 2.5 or
later.</p>

<p style="margin-top: 1em">add-tlv-map switch
option[,option]... <br>
Add each option to switch&rsquo;s tables. Duplicate fields
are rejected.</p>

<p style="margin-top: 1em">del-tlv-map switch
[option[,option]]... <br>
Delete each option from switch&rsquo;s table, or all option
TLV mapping if no option is specified. Fields that
aren&rsquo;t mapped are ignored.</p>

<p style="margin-top: 1em">dump-tlv-map switch <br>
Show the currently mapped fields in the switch&rsquo;s
option table as well as switch capabilities.</p>

<p style="margin-top: 1em">OpenFlow Switch Monitoring
Commands <br>
snoop switch <br>
Connects to switch and prints to the console all OpenFlow
messages received. Unlike other ovs-ofctl commands, if
switch is the name of a bridge, then the snoop command <br>
connects to a Unix domain socket named
/var/run/openvswitch/switch.snoop. ovs-vswitchd listens on
such a socket for each bridge and sends to it all of the
OpenFlow mes&acirc; <br>
sages sent to or received from its configured OpenFlow
controller. Thus, this command can be used to view OpenFlow
protocol activity between a switch and its controller.</p>

<p style="margin-top: 1em">When a switch has more than one
controller configured, only the traffic to and from a single
controller is output. If none of the controllers is
configured as a master or <br>
a slave (using a Nicira extension to OpenFlow 1.0 or 1.1, or
a standard request in OpenFlow 1.2 or later), then a
controller is chosen arbitrarily among them. If there is
<br>
a master controller, it is chosen; otherwise, if there are
any controllers that are not masters or slaves, one is
chosen arbitrarily; otherwise, a slave controller is
cho&acirc; <br>
sen arbitrarily. This choice is made once at connection time
and does not change as controllers reconfigure their
roles.</p>

<p style="margin-top: 1em">If a switch has no controller
configured, or if the configured controller is disconnected,
no traffic is sent, so monitoring will not show any
traffic.</p>

<p style="margin-top: 1em">monitor switch [miss-len]
[invalid_ttl] [watch:[spec...]] <br>
Connects to switch and prints to the console all OpenFlow
messages received. Usually, switch should specify the name
of a bridge in the ovs-vswitchd database.</p>

<p style="margin-top: 1em">If miss-len is provided,
ovs-ofctl sends an OpenFlow &lsquo;&lsquo;set
configuration&rsquo;&rsquo; message at connection setup time
that requests miss-len bytes of each packet that misses the
<br>
flow table. Open vSwitch does not send these and other
asynchronous messages to an ovs-ofctl monitor client
connection unless a nonzero value is specified on this
argu&acirc; <br>
ment. (Thus, if miss-len is not specified, very little
traffic will ordinarily be printed.)</p>

<p style="margin-top: 1em">If invalid_ttl is passed,
ovs-ofctl sends an OpenFlow &lsquo;&lsquo;set
configuration&rsquo;&rsquo; message at connection setup time
that requests INVALID_TTL_TO_CONTROLLER, so that ovs-ofctl
<br>
monitor can receive &lsquo;&lsquo;packet-in&rsquo;&rsquo;
messages when TTL reaches zero on dec_ttl action. Only
OpenFlow 1.1 and 1.2 support invalid_ttl; Open vSwitch also
implements it for <br>
OpenFlow 1.0 as an extension.</p>

<p style="margin-top: 1em">watch:[spec...] causes ovs-ofctl
to send a &lsquo;&lsquo;monitor request&rsquo;&rsquo; Nicira
extension message to the switch at connection setup time.
This message causes the switch to send <br>
information about flow table changes as they occur. The
following comma-separated spec syntax is available:</p>

<p style="margin-top: 1em">!initial <br>
Do not report the switch&rsquo;s initial flow table
contents.</p>

<p style="margin-top: 1em">!add Do not report newly added
flows.</p>

<p style="margin-top: 1em">!delete <br>
Do not report deleted flows.</p>

<p style="margin-top: 1em">!modify <br>
Do not report modifications to existing flows.</p>

<p style="margin-top: 1em">!own Abbreviate changes made to
the flow table by ovs-ofctl&rsquo;s own connection to the
switch. (These could only occur using the ofctl/send command
described below under <br>
RUNTIME MANAGEMENT COMMANDS.)</p>

<p style="margin-top: 1em">!actions <br>
Do not report actions as part of flow updates.</p>

<p style="margin-top: 1em">table=number <br>
Limits the monitoring to the table with the given number
between 0 and 254. By default, all tables are monitored.</p>

<p style="margin-top: 1em">out_port=port <br>
If set, only flows that output to port are monitored. The
port may be an OpenFlow port number or keyword (e.g.
LOCAL).</p>

<p style="margin-top: 1em">field=value <br>
Monitors only flows that have field specified as the given
value. Any syntax valid for matching on dump-flows may be
used.</p>

<p style="margin-top: 1em">This command may be useful for
debugging switch or controller implementations. With watch:,
it is particularly useful for observing how a controller
updates flow tables.</p>

<p style="margin-top: 1em">OpenFlow Switch and Controller
Commands <br>
The following commands, like those in the previous section,
may be applied to OpenFlow switches, using any of the
connection methods described in that section. Unlike those
com&acirc; <br>
mands, these may also be applied to OpenFlow
controllers.</p>

<p style="margin-top: 1em">probe target <br>
Sends a single OpenFlow echo-request message to target and
waits for the response. With the -t or --timeout option,
this command can test whether an OpenFlow switch or <br>
controller is up and running.</p>

<p style="margin-top: 1em">ping target [n] <br>
Sends a series of 10 echo request packets to target and
times each reply. The echo request packets consist of an
OpenFlow header plus n bytes (default: 64) of randomly <br>
generated payload. This measures the latency of individual
requests.</p>

<p style="margin-top: 1em">benchmark target n count <br>
Sends count echo request packets that each consist of an
OpenFlow header plus n bytes of payload and waits for each
response. Reports the total time required. This is a <br>
measure of the maximum bandwidth to target for round-trips
of n-byte messages.</p>

<p style="margin-top: 1em">Other Commands <br>
ofp-parse file <br>
Reads file (or stdin if file is -) as a series of OpenFlow
messages in the binary format used on an OpenFlow
connection, and prints them to the console. This can be
use&acirc; <br>
ful for printing OpenFlow messages captured from a TCP
stream.</p>

<p style="margin-top: 1em">ofp-parse-pcap file [port...]
<br>
Reads file, which must be in the PCAP format used by network
capture tools such as tcpdump or wireshark, extracts all the
TCP streams for OpenFlow connections, and prints <br>
the OpenFlow messages in those connections in human-readable
format on stdout.</p>

<p style="margin-top: 1em">OpenFlow connections are
distinguished by TCP port number. Non-OpenFlow packets are
ignored. By default, data on TCP ports 6633 and 6653 are
considered to be OpenFlow. <br>
Specify one or more port arguments to override the
default.</p>

<p style="margin-top: 1em">This command cannot usefully
print SSL encrypted traffic. It does not understand
IPv6.</p>

<p style="margin-top: 1em">Flow Syntax <br>
Some ovs-ofctl commands accept an argument that describes a
flow or flows. Such flow descriptions comprise a series of
field=value assignments, separated by commas or white <br>
space. (Embedding spaces into a flow description normally
requires quoting to prevent the shell from breaking the
description into multiple arguments.)</p>

<p style="margin-top: 1em">Flow descriptions should be in
normal form. This means that a flow may only specify a value
for an L3 field if it also specifies a particular L2
protocol, and that a flow may <br>
only specify an L4 field if it also specifies particular L2
and L3 protocol types. For example, if the L2 protocol type
dl_type is wildcarded, then L3 fields nw_src, nw_dst, and
<br>
nw_proto must also be wildcarded. Similarly, if dl_type or
nw_proto (the L3 protocol type) is wildcarded, so must be
the L4 fields tcp_dst and tcp_src. ovs-ofctl will warn <br>
about flows not in normal form.</p>

<p style="margin-top: 1em">ovs-fields(7) describes the
supported fields and how to match them. In addition to match
fields, commands that operate on flows accept a few
additional key-value pairs:</p>

<p style="margin-top: 1em">table=number <br>
For flow dump commands, limits the flows dumped to those in
the table with the given number between 0 and 254. If not
specified (or if 255 is specified as number), then <br>
flows in all tables are dumped.</p>

<p style="margin-top: 1em">For flow table modification
commands, behavior varies based on the OpenFlow version used
to connect to the switch:</p>

<p style="margin-top: 1em">OpenFlow 1.0 <br>
OpenFlow 1.0 does not support table for modifying flows.
ovs-ofctl will exit with an error if table (other than
table=255) is specified for a switch that only sup&acirc;
<br>
ports OpenFlow 1.0.</p>

<p style="margin-top: 1em">In OpenFlow 1.0, the switch
chooses the table into which to insert a new flow. The Open
vSwitch software switch always chooses table 0. Other Open
vSwitch data&acirc; <br>
paths and other OpenFlow implementations may choose
different tables.</p>

<p style="margin-top: 1em">The OpenFlow 1.0 behavior in
Open vSwitch for modifying or removing flows depends on
whether --strict is used. Without --strict, the command
applies to matching <br>
flows in all tables. With --strict, the command will operate
on any single matching flow in any table; it will do nothing
if there are matches in more than one ta&acirc; <br>
ble. (The distinction between these behaviors only matters
if non-OpenFlow 1.0 commands were also used, because
OpenFlow 1.0 alone cannot add flows with the same <br>
matching criteria to multiple tables.)</p>

<p style="margin-top: 1em">OpenFlow 1.0 with table_id
extension <br>
Open vSwitch implements an OpenFlow extension that allows
the controller to specify the table on which to operate.
ovs-ofctl automatically enables the extension <br>
when table is specified and OpenFlow 1.0 is used. ovs-ofctl
automatically detects whether the switch supports the
extension. As of this writing, this extension is <br>
only known to be implemented by Open vSwitch.</p>

<p style="margin-top: 1em">With this extension, ovs-ofctl
operates on the requested table when table is specified, and
acts as described for OpenFlow 1.0 above when no table is
specified (or <br>
for table=255).</p>

<p style="margin-top: 1em">OpenFlow 1.1 <br>
OpenFlow 1.1 requires flow table modification commands to
specify a table. When table is not specified (or table=255
is specified), ovs-ofctl defaults to table 0.</p>

<p style="margin-top: 1em">OpenFlow 1.2 and later <br>
OpenFlow 1.2 and later allow flow deletion commands, but not
other flow table modification commands, to operate on all
flow tables, with the behavior described <br>
above for OpenFlow 1.0.</p>

<p style="margin-top: 1em">duration=... <br>
n_packet=... <br>
n_bytes=... <br>
ovs-ofctl ignores assignments to these
&lsquo;&lsquo;fields&rsquo;&rsquo; to allow output from the
dump-flows command to be used as input for other commands
that parse flows.</p>

<p style="margin-top: 1em">The add-flow, add-flows, and
mod-flows commands require an additional field, which must
be the final field specified:</p>

<p style="margin-top: 1em">actions=[action][,action...]
<br>
Specifies a comma-separated list of actions to take on a
packet when the flow entry matches. If no action is
specified, then packets matching the flow are dropped. The
<br>
following forms of action are supported:</p>

<p style="margin-top: 1em">port <br>
output:port <br>
Outputs the packet to OpenFlow port number port. If port is
the packet&rsquo;s input port, the packet is not output.</p>

<p style="margin-top: 1em">output:src[start..end] <br>
Outputs the packet to the OpenFlow port number read from
src, which may be an NXM field name, as described above, or
a match field name. output:reg0[16..31] out&acirc; <br>
puts to the OpenFlow port number written in the upper half
of register 0. If the port number is the packet&rsquo;s
input port, the packet is not output.</p>

<p style="margin-top: 1em">This form of output was added in
Open vSwitch 1.3.0. This form of output uses an OpenFlow
extension that is not supported by standard OpenFlow
switches.</p>


<p style="margin-top: 1em">output(port=port,max_len=nbytes)
<br>
Outputs the packet to the OpenFlow port number read from
port, with maximum packet size set to nbytes. port may be
OpenFlow port number, local, or in_port. Patch <br>
port is not supported. Packets larger than nbytes will be
trimmed to nbytes while packets smaller than nbytes remains
the original size.</p>

<p style="margin-top: 1em">group:group_id <br>
Outputs the packet to the OpenFlow group group_id. OpenFlow
1.1 introduced support for groups; Open vSwitch 2.6 and
later also supports output to groups as an <br>
extension to OpenFlow 1.0. See Group Syntax for more
details.</p>

<p style="margin-top: 1em">normal Subjects the packet to
the device&rsquo;s normal L2/L3 processing. (This action is
not implemented by all OpenFlow switches.)</p>

<p style="margin-top: 1em">flood Outputs the packet on all
switch physical ports other than the port on which it was
received and any ports on which flooding is disabled
(typically, these would be <br>
ports disabled by the IEEE 802.1D spanning tree
protocol).</p>

<p style="margin-top: 1em">all Outputs the packet on all
switch physical ports other than the port on which it was
received.</p>

<p style="margin-top: 1em">local Outputs the packet on the
&lsquo;&lsquo;local port,&rsquo;&rsquo; which corresponds to
the network device that has the same name as the bridge.</p>

<p style="margin-top: 1em">in_port <br>
Outputs the packet on the port from which it was
received.</p>

<p style="margin-top: 1em">controller(key=value...) <br>
Sends the packet and its metadata to the OpenFlow controller
as a &lsquo;&lsquo;packet in&rsquo;&rsquo; message. The
supported key-value pairs are:</p>

<p style="margin-top: 1em">max_len=nbytes <br>
Limit to nbytes the number of bytes of the packet to send to
the controller. By default the entire packet is sent.</p>

<p style="margin-top: 1em">reason=reason <br>
Specify reason as the reason for sending the message in the
&lsquo;&lsquo;packet in&rsquo;&rsquo; message. The supported
reasons are action (the default), no_match, and <br>
invalid_ttl.</p>

<p style="margin-top: 1em">id=controller-id <br>
Specify controller-id, a 16-bit integer, as the connection
ID of the OpenFlow controller or controllers to which the
&lsquo;&lsquo;packet in&rsquo;&rsquo; message should be
sent. <br>
The default is zero. Zero is also the default connection ID
for each controller connection, and a given controller
connection will only have a nonzero con&acirc; <br>
nection ID if its controller uses the NXT_SET_CONTROLLER_ID
Nicira extension to OpenFlow.</p>

<p style="margin-top: 1em">userdata=hh... <br>
Supplies the bytes represented as hex digits hh as
additional data to the controller in the packet-in message.
Pairs of hex digits may be separated by peri&acirc; <br>
ods for readability.</p>

<p style="margin-top: 1em">pause Causes the switch to
freeze the packet&rsquo;s trip through Open vSwitch flow
tables and serializes that state into the packet-in message
as a &lsquo;&lsquo;continuation,&rsquo;&rsquo; an <br>
additional property in the NXT_PACKET_IN2 message. The
controller can later send the continuation back to the
switch in an NXT_RESUME message, which will <br>
restart the packet&rsquo;s traversal from the point where it
was interrupted. This permits an OpenFlow controller to
interpose on a packet midway through process&acirc; <br>
ing in Open vSwitch.</p>

<p style="margin-top: 1em">If any reason other than action
or any nonzero controller-id is supplied, Open vSwitch
extension NXAST_CONTROLLER, supported by Open vSwitch 1.6
and later, is used. <br>
If userdata is supplied, then NXAST_CONTROLLER2, supported
by Open vSwitch 2.6 and later, is used.</p>

<p style="margin-top: 1em">controller <br>
controller[:nbytes] <br>
Shorthand for controller() or controller(max_len=nbytes),
respectively.</p>

<p style="margin-top: 1em">enqueue(port,queue) <br>
Enqueues the packet on the specified queue within port port,
which must be an OpenFlow port number or keyword (e.g.
LOCAL). The number of supported queues depends <br>
on the switch; some OpenFlow implementations do not support
queuing at all.</p>

<p style="margin-top: 1em">drop Discards the packet, so no
further processing or forwarding takes place. If a drop
action is used, no other actions may be specified.</p>

<p style="margin-top: 1em">mod_vlan_vid:vlan_vid <br>
Modifies the VLAN id on a packet. The VLAN tag is added or
modified as necessary to match the value specified. If the
VLAN tag is added, a priority of zero is <br>
used (see the mod_vlan_pcp action to set this).</p>

<p style="margin-top: 1em">mod_vlan_pcp:vlan_pcp <br>
Modifies the VLAN priority on a packet. The VLAN tag is
added or modified as necessary to match the value specified.
Valid values are between 0 (lowest) and 7 <br>
(highest). If the VLAN tag is added, a vid of zero is used
(see the mod_vlan_vid action to set this).</p>

<p style="margin-top: 1em">strip_vlan <br>
Strips the VLAN tag from a packet if it is present.</p>

<p style="margin-top: 1em">push_vlan:ethertype <br>
Push a new VLAN tag onto the packet. Ethertype is used as
the Ethertype for the tag. Only ethertype 0x8100 should be
used. (0x88a8 which the spec allows isn&rsquo;t sup&acirc;
<br>
ported at the moment.) A priority of zero and the tag of
zero are used for the new tag.</p>

<p style="margin-top: 1em">push_mpls:ethertype <br>
Changes the packet&rsquo;s Ethertype to ethertype, which
must be either 0x8847 or 0x8848, and pushes an MPLS LSE.</p>

<p style="margin-top: 1em">If the packet does not already
contain any MPLS labels then an initial label stack entry is
pushed. The label stack entry&rsquo;s label is 2 if the
packet contains IPv6 <br>
and 0 otherwise, its default traffic control value is the
low 3 bits of the packet&rsquo;s DSCP value (0 if the packet
is not IP), and its TTL is copied from the IP TTL <br>
(64 if the packet is not IP).</p>

<p style="margin-top: 1em">If the packet does already
contain an MPLS label, pushes a new outermost label as a
copy of the existing outermost label.</p>

<p style="margin-top: 1em">A limitation of the
implementation is that processing of actions will stop if
push_mpls follows another push_mpls unless there is a
pop_mpls in between.</p>

<p style="margin-top: 1em">pop_mpls:ethertype <br>
Strips the outermost MPLS label stack entry. Currently the
implementation restricts ethertype to a non-MPLS Ethertype
and thus pop_mpls should only be applied to <br>
packets with an MPLS label stack depth of one. A further
limitation is that processing of actions will stop if
pop_mpls follows another pop_mpls unless there is a <br>
push_mpls in between.</p>

<p style="margin-top: 1em">mod_dl_src:mac <br>
Sets the source Ethernet address to mac.</p>

<p style="margin-top: 1em">mod_dl_dst:mac <br>
Sets the destination Ethernet address to mac.</p>

<p style="margin-top: 1em">mod_nw_src:ip <br>
Sets the IPv4 source address to ip.</p>

<p style="margin-top: 1em">mod_nw_dst:ip <br>
Sets the IPv4 destination address to ip.</p>

<p style="margin-top: 1em">mod_tp_src:port <br>
Sets the TCP or UDP or SCTP source port to port.</p>

<p style="margin-top: 1em">mod_tp_dst:port <br>
Sets the TCP or UDP or SCTP destination port to port.</p>

<p style="margin-top: 1em">mod_nw_tos:tos <br>
Sets the DSCP bits in the IPv4 ToS/DSCP or IPv6 traffic
class field to tos, which must be a multiple of 4 between 0
and 255. This action does not modify the two <br>
least significant bits of the ToS field (the ECN bits).</p>

<p style="margin-top: 1em">mod_nw_ecn:ecn <br>
Sets the ECN bits in the IPv4 ToS or IPv6 traffic class
field to ecn, which must be a value between 0 and 3,
inclusive. This action does not modify the six most <br>
significant bits of the field (the DSCP bits).</p>

<p style="margin-top: 1em">Requires OpenFlow 1.1 or
later.</p>

<p style="margin-top: 1em">mod_nw_ttl:ttl <br>
Sets the IPv4 TTL or IPv6 hop limit field to ttl, which is
specified as a decimal number between 0 and 255, inclusive.
Switch behavior when setting ttl to zero is <br>
not well specified, though.</p>

<p style="margin-top: 1em">Requires OpenFlow 1.1 or
later.</p>

<p style="margin-top: 1em">The following actions are Nicira
vendor extensions that, as of this writing, are only known
to be implemented by Open vSwitch:</p>

<p style="margin-top: 1em">resubmit:port <br>
resubmit([port],[table]) <br>
Re-searches this OpenFlow flow table (or the table whose
number is specified by table) with the in_port field
replaced by port (if port is specified) and executes <br>
the actions found, if any, in addition to any other actions
in this flow entry.</p>

<p style="margin-top: 1em">Recursive resubmit actions are
obeyed up to implementation-defined limits:</p>

<p style="margin-top: 1em">&Acirc;&middot; Open vSwitch
1.0.1 and earlier did not support recursion.</p>

<p style="margin-top: 1em">&Acirc;&middot; Open vSwitch
1.0.2 and 1.0.3 limited recursion to 8 levels.</p>

<p style="margin-top: 1em">&Acirc;&middot; Open vSwitch 1.1
and 1.2 limited recursion to 16 levels.</p>

<p style="margin-top: 1em">&Acirc;&middot; Open vSwitch 1.2
through 1.8 limited recursion to 32 levels.</p>

<p style="margin-top: 1em">&Acirc;&middot; Open vSwitch 1.9
through 2.0 limited recursion to 64 levels.</p>

<p style="margin-top: 1em">&Acirc;&middot; Open vSwitch 2.1
through 2.5 limited recursion to 64 levels and impose a
total limit of 4,096 resubmits per flow translation (earlier
versions did not impose <br>
any total limit).</p>

<p style="margin-top: 1em">&Acirc;&middot; Open vSwitch 2.6
and later imposes the same limits as 2.5, with one
exception: resubmit from table x to any table y &gt; x does
not count against the recursion <br>
limit.</p>

<p style="margin-top: 1em">Open vSwitch before 1.2.90 did
not support table.</p>

<p style="margin-top: 1em">set_tunnel:id <br>
set_tunnel64:id <br>
If outputting to a port that encapsulates the packet in a
tunnel and supports an identifier (such as GRE), sets the
identifier to id. If the set_tunnel form is <br>
used and id fits in 32 bits, then this uses an action
extension that is supported by Open vSwitch 1.0 and later.
Otherwise, if id is a 64-bit value, it requires <br>
Open vSwitch 1.1 or later.</p>

<p style="margin-top: 1em">set_queue:queue <br>
Sets the queue that should be used to queue when packets are
output. The number of supported queues depends on the
switch; some OpenFlow implementations do not <br>
support queuing at all.</p>

<p style="margin-top: 1em">pop_queue <br>
Restores the queue to the value it was before any set_queue
actions were applied.</p>

<p style="margin-top: 1em">ct <br>
ct([argument][,argument...]) <br>
Send the packet through the connection tracker. Refer to the
ct_state documentation above for possible packet and
connection states. The following arguments are <br>
supported:</p>

<p style="margin-top: 1em">commit <br>
Commit the connection to the connection tracking module.
Information about the connection will be stored beyond the
lifetime of the packet in the pipeline. <br>
Some ct_state flags are only available for committed
connections.</p>

<p style="margin-top: 1em">table=number <br>
Fork pipeline processing in two. The original instance of
the packet will continue processing the current actions list
as an untracked packet. An additional <br>
instance of the packet will be sent to the connection
tracker, which will be re-injected into the OpenFlow
pipeline to resume processing in table number, <br>
with the ct_state and other ct match fields set. If the
table is not specified, then the packet which is submitted
to the connection tracker is not re- <br>
injected into the OpenFlow pipeline. It is strongly
recommended to specify a table later than the current table
to prevent loops.</p>

<p style="margin-top: 1em">zone=value <br>
zone=src[start..end] <br>
A 16-bit context id that can be used to isolate connections
into separate domains, allowing overlapping network
addresses in different zones. If a zone is <br>
not provided, then the default is to use zone zero. The zone
may be specified either as an immediate 16-bit value, or may
be provided from an NXM field src. <br>
The start and end pair are inclusive, and must specify a
16-bit range within the field. This value is copied to the
ct_zone match field for packets which are <br>
re-injected into the pipeline using the table option.</p>

<p style="margin-top: 1em">exec([action][,action...]) <br>
Perform actions within the context of connection tracking.
This is a restricted set of actions which are in the same
format as their specifications as part <br>
of a flow. Only actions which modify the ct_mark or ct_label
fields are accepted within the exec action, and these fields
may only be modified with this <br>
option. For example:</p>


<p style="margin-top: 1em">set_field:value[/mask]-&gt;ct_mark
<br>
Store a 32-bit metadata value with the connection.
Subsequent lookups for packets in this connection will
populate the ct_mark flow field when the <br>
packet is sent to the connection tracker with the table
specified.</p>


<p style="margin-top: 1em">set_field:value[/mask]-&gt;ct_label
<br>
Store a 128-bit metadata value with the connection.
Subsequent lookups for packets in this connection will
populate the ct_label flow field when the <br>
packet is sent to the connection tracker with the table
specified.</p>

<p style="margin-top: 1em">The commit parameter must be
specified to use exec(...).</p>

<p style="margin-top: 1em">alg=alg <br>
Specify application layer gateway alg to track specific
connection types. If subsequent related connections are sent
through the ct action, then the rel flag <br>
in the ct_state field will be set. Supported types
include:</p>

<p style="margin-top: 1em">ftp Look for negotiation of FTP
data connections. Specify this option for FTP control
connections to detect related data connections and populate
the rel <br>
flag for the data connections.</p>

<p style="margin-top: 1em">tftp Look for negotiation of
TFTP data connections. Specify this option for TFTP control
connections to detect related data connections and populate
the <br>
rel flag for the data connections.</p>

<p style="margin-top: 1em">The commit parameter must be
specified to use alg=alg.</p>

<p style="margin-top: 1em">When committing related
connections, the ct_mark for that connection is inherited
from the current ct_mark stored with the original connection
(ie, the con&acirc; <br>
nection created by ct(alg=...)).</p>

<p style="margin-top: 1em">Note that with the Linux
datapath, global sysctl options affect the usage of the ct
action. In particular, if net.netfilter.nf_conntrack_helper
is enabled <br>
then application layer gateway helpers may be executed even
if the alg option is not specified. This is the default
setting until Linux 4.7. For security <br>
reasons, the netfilter team recommends users to disable this
option. See this blog post for further details:
http://www.netfilter.org/news.html#2012-04-03</p>


<p style="margin-top: 1em">nat[((src|dst)=addr1[-addr2][:port1[-port2]][,flags])]
<br>
Specify address and port translation for the connection
being tracked. For new connections either src or dst
argument must be provided to set up either <br>
source address/port translation (SNAT) or destination
address/port translation (DNAT), respectively. Setting up
address translation for a new connection <br>
takes effect only if the commit flag is also provided for
the enclosing ct action. A bare nat action will only
translate the packet being processed in the <br>
way the connection has been set up with an earlier ct
action. Also a nat action with src or dst, when applied to a
packet belonging to an established <br>
(rather than new) connection, will behave the same as a bare
nat.</p>

<p style="margin-top: 1em">src and dst options take the
following arguments:</p>

<p style="margin-top: 1em">addr1[-addr2] <br>
The address range from which the translated address should
be selected. If only one address is given, then that address
will always be selected, oth&acirc; <br>
erwise the address selection can be informed by the optional
persistent flag as described below. Either IPv4 or IPv6
addresses can be provided, but <br>
both addresses must be of the same type, and the datapath
behavior is undefined in case of providing IPv4 address
range for an IPv6 packet, or IPv6 <br>
address range for an IPv4 packet. IPv6 addresses must be
bracketed with &rsquo;[&rsquo; and &rsquo;]&rsquo; if a port
range is also given.</p>

<p style="margin-top: 1em">port1[-port2] <br>
The port range from which the translated port should be
selected. If only one port number is provided, then that
should be selected. In case of a <br>
mapping conflict the datapath may choose any other
non-conflicting port number instead, even when no port range
is specified. The port number selec&acirc; <br>
tion can be informed by the optional random and hash flags
as described below.</p>

<p style="margin-top: 1em">The optional flags are:</p>

<p style="margin-top: 1em">random The selection of the port
from the given range should be done using a fresh random
number. This flag is mutually exclusive with hash.</p>

<p style="margin-top: 1em">hash The selection of the port
from the given range should be done using a datapath
specific hash of the packet&rsquo;s IP addresses and the
other, non-mapped <br>
port number. This flag is mutually exclusive with
random.</p>

<p style="margin-top: 1em">persistent <br>
The selection of the IP address from the given range should
be done so that the same mapping can be provided after the
system restarts.</p>

<p style="margin-top: 1em">If an alg is specified for the
committing ct action that also includes nat with a src or
dst attribute, then the datapath tries to set up the helper
to be <br>
NAT aware. This functionality is datapath specific and may
not be supported by all datapaths.</p>

<p style="margin-top: 1em">nat was introduced in Open
vSwitch 2.6. The first datapath that implements ct nat
support is the one that ships with Linux 4.6.</p>

<p style="margin-top: 1em">The ct action may be used as a
primitive to construct stateful firewalls by selectively
committing some traffic, then matching the ct_state to allow
established <br>
connections while denying new connections. The following
flows provide an example of how to implement a simple
firewall that allows new connections from port 1 to <br>
port 2, and only allows established connections to send
traffic from port 2 to port 1: <br>
table=0,priority=1,action=drop <br>
table=0,priority=10,arp,action=normal <br>
table=0,priority=100,ip,ct_state=-trk,action=ct(table=1)
<br>
table=1,in_port=1,ip,ct_state=+trk+new,action=ct(commit),2
<br>
table=1,in_port=1,ip,ct_state=+trk+est,action=2 <br>
table=1,in_port=2,ip,ct_state=+trk+new,action=drop <br>
table=1,in_port=2,ip,ct_state=+trk+est,action=1</p>

<p style="margin-top: 1em">If ct is executed on IP (or
IPv6) fragments, then the message is implicitly reassembled
before sending to the connection tracker and refragmented
upon output, to <br>
the original maximum received fragment size. Reassembly
occurs within the context of the zone, meaning that IP
fragments in different zones are not assembled <br>
together. Pipeline processing for the initial fragments is
halted; When the final fragment is received, the message is
assembled and pipeline processing will con&acirc; <br>
tinue for that flow. Because packet ordering is not
guaranteed by IP protocols, it is not possible to determine
which IP fragment will cause message reassembly <br>
(and therefore continue pipeline processing). As such, it is
strongly recommended that multiple flows should not execute
ct to reassemble fragments from the same IP <br>
message.</p>

<p style="margin-top: 1em">Currently, connection tracking
is only available on Linux kernels with the nf_conntrack
module loaded. The ct action was introduced in Open vSwitch
2.5.</p>

<p style="margin-top: 1em">ct_clear <br>
Clears connection tracking state from the flow, zeroing
ct_state, ct_zone, ct_mark, and ct_label.</p>

<p style="margin-top: 1em">This action was introduced in
Open vSwitch 2.6.90.</p>

<p style="margin-top: 1em">dec_ttl <br>
dec_ttl(id1[,id2]...) <br>
Decrement TTL of IPv4 packet or hop limit of IPv6 packet. If
the TTL or hop limit is initially zero or decrementing would
make it so, no decrement occurs, as pack&acirc; <br>
ets reaching TTL zero must be rejected. Instead, a
&lsquo;&lsquo;packet-in&rsquo;&rsquo; message with reason
code OFPR_INVALID_TTL is sent to each connected controller
that has enabled <br>
receiving them, if any. Processing the current set of
actions then stops. However, if the current set of actions
was reached through &lsquo;&lsquo;resubmit&rsquo;&rsquo;
then remaining <br>
actions in outer levels resume processing.</p>

<p style="margin-top: 1em">This action also optionally
supports the ability to specify a list of valid controller
ids. Each of the controllers in the list will receive the
&lsquo;&lsquo;packet_in&rsquo;&rsquo; mes&acirc; <br>
sage only if they have registered to receive the invalid ttl
packets. If controller ids are not specified, the
&lsquo;&lsquo;packet_in&rsquo;&rsquo; message will be sent
only to the con&acirc; <br>
trollers having controller id zero which have registered for
the invalid ttl packets.</p>

<p style="margin-top: 1em">set_mpls_label:label <br>
Set the label of the outer MPLS label stack entry of a
packet. label should be a 20-bit value that is decimal by
default; use a 0x prefix to specify them in hexa&acirc; <br>
decimal.</p>

<p style="margin-top: 1em">set_mpls_tc:tc <br>
Set the traffic-class of the outer MPLS label stack entry of
a packet. tc should be a in the range 0 to 7 inclusive.</p>

<p style="margin-top: 1em">set_mpls_ttl:ttl <br>
Set the TTL of the outer MPLS label stack entry of a packet.
ttl should be in the range 0 to 255 inclusive.</p>

<p style="margin-top: 1em">dec_mpls_ttl <br>
Decrement TTL of the outer MPLS label stack entry of a
packet. If the TTL is initially zero or decrementing would
make it so, no decrement occurs. Instead, a <br>
&lsquo;&lsquo;packet-in&rsquo;&rsquo; message with reason
code OFPR_INVALID_TTL is sent to the main controller (id
zero), if it has enabled receiving them. Processing the
current set of <br>
actions then stops. However, if the current set of actions
was reached through &lsquo;&lsquo;resubmit&rsquo;&rsquo;
then remaining actions in outer levels resume
processing.</p>

<p style="margin-top: 1em">note:[hh]... <br>
Does nothing at all. Any number of bytes represented as hex
digits hh may be included. Pairs of hex digits may be
separated by periods for readability. The note <br>
action&rsquo;s format doesn&rsquo;t include an exact length
for its payload, so the provided bytes will be padded on the
right by enough bytes with value 0 to make the total <br>
number 6 more than a multiple of 8.</p>


<p style="margin-top: 1em">move:src[start..end]-&gt;dst[start..end]
<br>
Copies the named bits from field src to field dst. src and
dst may be NXM field names as defined in nicira-ext.h, e.g.
NXM_OF_UDP_SRC or NXM_NX_REG0, or a match <br>
field name, e.g. reg0. Each start and end pair, which are
inclusive, must specify the same number of bits and must fit
within its respective field. Shorthands for <br>
[start..end] exist: use [bit] to specify a single bit or []
to specify an entire field (in the latter case the brackets
can also be left off).</p>

<p style="margin-top: 1em">Examples:
move:NXM_NX_REG0[0..5]-&gt;NXM_NX_REG1[26..31] copies the
six bits numbered 0 through 5, inclusive, in register 0 into
bits 26 through 31, inclusive; <br>
move:reg0[0..15]-&gt;vlan_tci copies the least significant
16 bits of register 0 into the VLAN TCI field.</p>

<p style="margin-top: 1em">In OpenFlow 1.0 through 1.4,
move ordinarily uses an Open vSwitch extension to OpenFlow.
In OpenFlow 1.5, move uses the OpenFlow 1.5 standard
copy_field action. <br>
The ONF has also made copy_field available as an extension
to OpenFlow 1.3. Open vSwitch 2.4 and later understands this
extension and uses it if a controller uses <br>
it, but for backward compatibility with older versions of
Open vSwitch, ovs-ofctl does not use it.</p>

<p style="margin-top: 1em">set_field:value[/mask]-&gt;dst
<br>
load:value-&gt;dst[start..end] <br>
Loads a literal value into a field or part of a field. With
set_field, value and the optional mask are given in the
customary syntax for field dst, which is <br>
expressed as a field name. For example,
set_field:00:11:22:33:44:55-&gt;eth_src sets the Ethernet
source address to 00:11:22:33:44:55. With load, value must
be an <br>
integer value (in decimal or prefixed by 0x for hexadecimal)
and dst can also be the NXM or OXM name for the field. For
example, <br>
load:0x001122334455-&gt;OXM_OF_ETH_SRC[] has the same effect
as the prior set_field example.</p>

<p style="margin-top: 1em">The two forms exist for
historical reasons. Open vSwitch 1.1 introduced
NXAST_REG_LOAD as a Nicira extension to OpenFlow 1.0 and
used load to express it. Later, <br>
OpenFlow 1.2 introduced a standard OFPAT_SET_FIELD action
that was restricted to loading entire fields, so Open
vSwitch added the form set_field with this restric&acirc;
<br>
tion. OpenFlow 1.5 extended OFPAT_SET_FIELD to the point
that it became a superset of NXAST_REG_LOAD. Open vSwitch
translates either syntax as necessary for the <br>
OpenFlow version in use: in OpenFlow 1.0 and 1.1,
NXAST_REG_LOAD; in OpenFlow 1.2, 1.3, and 1.4,
NXAST_REG_LOAD for load or for loading a subfield,
OFPAT_SET_FIELD <br>
otherwise; and OpenFlow 1.5 and later, OFPAT_SET_FIELD.</p>

<p style="margin-top: 1em">push:src[start..end] <br>
Pushes start to end bits inclusive, in fields on top of the
stack.</p>

<p style="margin-top: 1em">Example: push:NXM_NX_REG2[0..5]
or push:reg2[0..5] push the value stored in register 2 bits
0 through 5, inclusive, on to the internal stack.</p>

<p style="margin-top: 1em">pop:dst[start..end] <br>
Pops from the top of the stack, retrieves the start to end
bits inclusive, from the value popped and store them into
the corresponding bits in dst.</p>

<p style="margin-top: 1em">Example: pop:NXM_NX_REG2[0..5]
or pop:reg2[0..5] pops the value from top of the stack. Set
register 2 bits 0 through 5, inclusive, based on bits 0
through 5 from <br>
the value just popped.</p>

<p style="margin-top: 1em">multipath(fields, basis,
algorithm, n_links, arg, dst[start..end]) <br>
Hashes fields using basis as a universal hash parameter,
then the applies multipath link selection algorithm (with
parameter arg) to choose one of n_links output <br>
links numbered 0 through n_links minus 1, and stores the
link into dst[start..end], which must be an NXM field as
described above.</p>

<p style="margin-top: 1em">fields must be one of the
following:</p>

<p style="margin-top: 1em">eth_src <br>
Hashes Ethernet source address only.</p>

<p style="margin-top: 1em">symmetric_l4 <br>
Hashes Ethernet source, destination, and type, VLAN ID,
IPv4/IPv6 source, destination, and protocol, and TCP or SCTP
(but not UDP) ports. The hash is com&acirc; <br>
puted so that pairs of corresponding flows in each direction
hash to the same value, in environments where L2 paths are
the same in each direction. UDP <br>
ports are not included in the hash to support protocols such
as VXLAN that use asymmetric ports in each direction.</p>

<p style="margin-top: 1em">symmetric_l3l4 <br>
Hashes IPv4/IPv6 source, destination, and protocol, and TCP
or SCTP (but not UDP) ports. Like symmetric_l4, this is a
symmetric hash, but by excluding L2 <br>
headers it is more effective in environments with asymmetric
L2 paths (e.g. paths involving VRRP IP addresses on a
router). Not an effective hash function <br>
for protocols other than IPv4 and IPv6, which hash to a
constant zero.</p>

<p style="margin-top: 1em">symmetric_l3l4+udp <br>
Like symmetric_l3l4+udp, but UDP ports are included in the
hash. This is a more effective hash when asymmetric UDP
protocols such as VXLAN are not a consid&acirc; <br>
eration.</p>

<p style="margin-top: 1em">algorithm must be one of
modulo_n, hash_threshold, hrw, and iter_hash. Only the
iter_hash algorithm uses arg.</p>

<p style="margin-top: 1em">Refer to nicira-ext.h for more
details.</p>

<p style="margin-top: 1em">bundle(fields, basis, algorithm,
slave_type, slaves:[s1, s2, ...]) <br>
Hashes fields using basis as a universal hash parameter,
then applies the bundle link selection algorithm to choose
one of the listed slaves represented as <br>
slave_type. Currently the only supported slave_type is
ofport. Thus, each s1 through sN should be an OpenFlow port
number. Outputs to the selected slave.</p>

<p style="margin-top: 1em">Currently, fields must be either
eth_src, symmetric_l4, symmetric_l3l4, or
symmetric_l3l4+udp, and algorithm must be one of hrw and
active_backup.</p>

<p style="margin-top: 1em">Example:
bundle(eth_src,0,hrw,ofport,slaves:4,8) uses an Ethernet
source hash with basis 0, to select between OpenFlow ports 4
and 8 using the Highest Random Weight <br>
algorithm.</p>

<p style="margin-top: 1em">Refer to nicira-ext.h for more
details.</p>

<p style="margin-top: 1em">bundle_load(fields, basis,
algorithm, slave_type, dst[start..end], slaves:[s1, s2,
...]) <br>
Has the same behavior as the bundle action, with one
exception. Instead of outputting to the selected slave, it
writes its selection to dst[start..end], which must <br>
be an NXM field as described above.</p>

<p style="margin-top: 1em">Example: bundle_load(eth_src, 0,
hrw, ofport, NXM_NX_REG0[], slaves:4, 8) uses an Ethernet
source hash with basis 0, to select between OpenFlow ports 4
and 8 using <br>
the Highest Random Weight algorithm, and writes the
selection to NXM_NX_REG0[]. Also the match field name can be
used, for example, instead of &rsquo;NXM_NX_REG0&rsquo; the
<br>
name &rsquo;reg0&rsquo; can be used. When the while field is
indicated the empty brackets can also be left off.</p>

<p style="margin-top: 1em">Refer to nicira-ext.h for more
details.</p>

<p style="margin-top: 1em">learn(argument[,argument]...)
<br>
This action adds or modifies a flow in an OpenFlow table,
similar to ovs-ofctl --strict mod-flows. The arguments
specify the flow&rsquo;s match fields, actions, and <br>
other properties, as follows. At least one match criterion
and one action argument should ordinarily be specified.</p>

<p style="margin-top: 1em">idle_timeout=seconds <br>
hard_timeout=seconds <br>
priority=value <br>
cookie=value <br>
send_flow_rem <br>
These arguments have the same meaning as in the usual
ovs-ofctl flow syntax.</p>

<p style="margin-top: 1em">fin_idle_timeout=seconds <br>
fin_hard_timeout=seconds <br>
Adds a fin_timeout action with the specified arguments to
the new flow. This feature was added in Open vSwitch
1.5.90.</p>

<p style="margin-top: 1em">table=number <br>
The table in which the new flow should be inserted. Specify
a decimal number between 0 and 254. The default, if table is
unspecified, is table 1.</p>

<p style="margin-top: 1em">delete_learned <br>
This flag enables deletion of the learned flows when the
flow with the learn action is removed. Specifically, when
the last learn action with this flag and <br>
particular table and cookie values is removed, the switch
deletes all of the flows in the specified table with the
specified cookie.</p>

<p style="margin-top: 1em">This flag was added in Open
vSwitch 2.4.</p>

<p style="margin-top: 1em">field=value <br>
field[start..end]=src[start..end] <br>
field[start..end] <br>
Adds a match criterion to the new flow.</p>

<p style="margin-top: 1em">The first form specifies that
field must match the literal value, e.g. dl_type=0x0800. All
of the fields and values for ovs-ofctl flow syntax are
available <br>
with their usual meanings. Shorthand notation matchers (e.g.
ip in place of dl_type=0x0800) are not currently
implemented.</p>

<p style="margin-top: 1em">The second form specifies that
field[start..end] in the new flow must match src[start..end]
taken from the flow currently being processed. For example,
<br>
NXM_OF_UDP_DST[]=NXM_OF_UDP_SRC[] on a TCP packet for which
the UDP src port is 53, creates a flow which matches
NXM_OF_UDP_DST[]=53.</p>

<p style="margin-top: 1em">The third form is a shorthand
for the second form. It specifies that field[start..end] in
the new flow must match the same field[start..end] taken
from the <br>
flow currently being processed. For example,
NXM_OF_TCP_DST[] on a TCP packet for which the TCP dst port
is 80, creates a flow which matches <br>
NXM_OF_TCP_DST[]=80.</p>

<p style="margin-top: 1em">load:value-&gt;dst[start..end]
<br>
load:src[start..end]-&gt;dst[start..end] <br>
Adds a load action to the new flow.</p>

<p style="margin-top: 1em">The first form loads the literal
value into bits start through end, inclusive, in field dst.
Its syntax is the same as the load action described earlier
in <br>
this section.</p>

<p style="margin-top: 1em">The second form loads
src[start..end], a value from the flow currently being
processed, into bits start through end, inclusive, in field
dst.</p>

<p style="margin-top: 1em">output:field[start..end] <br>
Add an output action to the new flow&rsquo;s actions, that
outputs to the OpenFlow port taken from field[start..end],
which must be an NXM field as described <br>
above.</p>

<p style="margin-top: 1em">For best performance, segregate
learned flows into a table (using table=number) that is not
used for any other flows except possibly for a
lowest-priority &lsquo;&lsquo;catch- <br>
all&rsquo;&rsquo; flow, that is, a flow with no match
criteria. (This is why the default table is 1, to keep the
learned flows separate from the primary flow table 0.)</p>

<p style="margin-top: 1em">clear_actions <br>
Clears all the actions in the action set immediately.</p>


<p style="margin-top: 1em">write_actions([action][,action...])
<br>
Add the specific actions to the action set. The syntax of
actions is the same as in the actions= field. The action set
is carried between flow tables and then <br>
executed at the end of the pipeline.</p>

<p style="margin-top: 1em">The actions in the action set
are applied in the following order, as required by the
OpenFlow specification, regardless of the order in which
they were added to the <br>
action set. Except as specified otherwise below, the action
set only holds at most a single action of each type. When
more than one action of a single type is <br>
written to the action set, the one written later replaces
the earlier action:</p>

<p style="margin-top: 1em">1. strip_vlan <br>
pop_mpls</p>

<p style="margin-top: 1em">2. push_mpls</p>

<p style="margin-top: 1em">3. push_vlan</p>

<p style="margin-top: 1em">4. dec_ttl <br>
dec_mpls_ttl</p>

<p style="margin-top: 1em">5. load <br>
move <br>
mod_dl_dst <br>
mod_dl_src <br>
mod_nw_dst <br>
mod_nw_src <br>
mod_nw_tos <br>
mod_nw_ecn <br>
mod_nw_ttl <br>
mod_tp_dst <br>
mod_tp_src <br>
mod_vlan_pcp <br>
mod_vlan_vid <br>
set_field <br>
set_tunnel <br>
set_tunnel64 <br>
The action set can contain any number of these actions, with
cumulative effect. They will be applied in the order as
added. That is, when multiple actions <br>
modify the same part of a field, the later modification
takes effect, and when they modify different parts of a
field (or different fields), then both modi&acirc; <br>
fications are applied.</p>

<p style="margin-top: 1em">6. set_queue</p>

<p style="margin-top: 1em">7. group <br>
output <br>
resubmit <br>
If more than one of these actions is present, then the one
listed earliest above is executed and the others are
ignored, regardless of the order in which <br>
they were added to the action set. (If none of these actions
is present, the action set has no real effect, because the
modified packet is not sent anywhere <br>
and thus the modifications are not visible.)</p>

<p style="margin-top: 1em">Only the actions listed above
may be written to the action set.</p>

<p style="margin-top: 1em">write_metadata:value[/mask] <br>
Updates the metadata field for the flow. If mask is omitted,
the metadata field is set exactly to value; if mask is
specified, then a 1-bit in mask indicates that <br>
the corresponding bit in the metadata field will be replaced
with the corresponding bit from value. Both value and mask
are 64-bit values that are decimal by <br>
default; use a 0x prefix to specify them in hexadecimal.</p>

<p style="margin-top: 1em">meter:meter_id <br>
Apply the meter_id before any other actions. If a meter band
rate is exceeded, the packet may be dropped, or modified,
depending on the meter band type. See the <br>
description of the Meter Table Commands, above, for more
details.</p>

<p style="margin-top: 1em">goto_table:table <br>
Indicates the next table in the process pipeline.</p>


<p style="margin-top: 1em">fin_timeout(argument[,argument])
<br>
This action changes the idle timeout or hard timeout, or
both, of this OpenFlow rule when the rule matches a TCP
packet with the FIN or RST flag. When such a <br>
packet is observed, the action reduces the rule&rsquo;s
timeouts to those specified on the action. If the
rule&rsquo;s existing timeout is already shorter than the
one that <br>
the action specifies, then that timeout is unaffected.</p>

<p style="margin-top: 1em">argument takes the following
forms:</p>

<p style="margin-top: 1em">idle_timeout=seconds <br>
Causes the flow to expire after the given number of seconds
of inactivity.</p>

<p style="margin-top: 1em">hard_timeout=seconds <br>
Causes the flow to expire after the given number of seconds,
regardless of activity. (seconds specifies time since the
flow&rsquo;s creation, not since the <br>
receipt of the FIN or RST.)</p>

<p style="margin-top: 1em">This action was added in Open
vSwitch 1.5.90.</p>

<p style="margin-top: 1em">sample(argument[,argument]...)
<br>
Samples packets and sends one sample for every sampled
packet.</p>

<p style="margin-top: 1em">argument takes the following
forms:</p>

<p style="margin-top: 1em">probability=packets <br>
The number of sampled packets out of 65535. Must be greater
or equal to 1.</p>

<p style="margin-top: 1em">collector_set_id=id <br>
The unsigned 32-bit integer identifier of the set of sample
collectors to send sampled packets to. Defaults to 0.</p>

<p style="margin-top: 1em">obs_domain_id=id <br>
When sending samples to IPFIX collectors, the unsigned
32-bit integer Observation Domain ID sent in every IPFIX
flow record. Defaults to 0.</p>

<p style="margin-top: 1em">obs_point_id=id <br>
When sending samples to IPFIX collectors, the unsigned
32-bit integer Observation Point ID sent in every IPFIX flow
record. Defaults to 0.</p>

<p style="margin-top: 1em">sampling_port=port <br>
Sample packets on port, which should be the ingress or
egress port. This option, which was added in Open vSwitch
2.5.90, allows the IPFIX implementation to <br>
export egress tunnel information.</p>

<p style="margin-top: 1em">ingress <br>
egress Specifies explicitly that the packet is being sampled
on ingress to or egress from the switch. IPFIX reports sent
by Open vSwitch before version 2.5.90 did <br>
not include a direction. From 2.5.90 until 2.6.90, IPFIX
reports inferred a direction from sampling_port: if it was
the packet&rsquo;s output port, then the <br>
direction was reported as egress, otherwise as ingress. Open
vSwitch 2.6.90 introduced these options, which allow the
inferred direction to be overridden. <br>
This is particularly useful when the ingress (or egress)
port is not a tunnel.</p>

<p style="margin-top: 1em">Refer to ovs-vswitchd.conf.db(5)
for more details on configuring sample collector sets.</p>

<p style="margin-top: 1em">This action was added in Open
vSwitch 1.10.90.</p>

<p style="margin-top: 1em">exit This action causes Open
vSwitch to immediately halt execution of further actions.
Those actions which have already been executed are
unaffected. Any further <br>
actions, including those which may be in other tables, or
different levels of the resubmit call stack, are ignored.
Actions in the action set is still executed <br>
(specify clear_actions before exit to discard them).</p>

<p style="margin-top: 1em">conjunction(id, k/n) <br>
This action allows for sophisticated
&lsquo;&lsquo;conjunctive match&rsquo;&rsquo; flows. Refer
to CONJUNCTIVE MATCH FIELDS in ovs-fields(7) for
details.</p>

<p style="margin-top: 1em">The conjunction action and
conj_id field were introduced in Open vSwitch 2.4.</p>

<p style="margin-top: 1em">clone([action][,action...]) <br>
Executes each nested action, saving much of the packet and
pipeline state beforehand and then restoring it afterward.
The state that is saved and restored includes <br>
all flow data and metadata (including, for example,
ct_state), the stack accessed by push and pop actions, and
the OpenFlow action set.</p>

<p style="margin-top: 1em">This action was added in Open
vSwitch 2.6.90.</p>

<p style="margin-top: 1em">An opaque identifier called a
cookie can be used as a handle to identify a set of
flows:</p>

<p style="margin-top: 1em">cookie=value <br>
A cookie can be associated with a flow using the add-flow,
add-flows, and mod-flows commands. value can be any 64-bit
number and need not be unique among flows. If this <br>
field is omitted, a default cookie value of 0 is used.</p>

<p style="margin-top: 1em">cookie=value/mask <br>
When using NXM, the cookie can be used as a handle for
querying, modifying, and deleting flows. value and mask may
be supplied for the del-flows, mod-flows, dump-flows, <br>
and dump-aggregate commands to limit matching cookies. A
1-bit in mask indicates that the corresponding bit in cookie
must match exactly, and a 0-bit wildcards that bit. <br>
A mask of -1 may be used to exactly match a cookie.</p>

<p style="margin-top: 1em">The mod-flows command can update
the cookies of flows that match a cookie by specifying the
cookie field twice (once with a mask for matching and once
without to indicate <br>
the new value):</p>

<p style="margin-top: 1em">ovs-ofctl mod-flows br0
cookie=1,actions=normal <br>
Change all flows&rsquo; cookies to 1 and change their
actions to normal.</p>

<p style="margin-top: 1em">ovs-ofctl mod-flows br0
cookie=1/-1,cookie=2,actions=normal <br>
Update cookies with a value of 1 to 2 and change their
actions to normal.</p>

<p style="margin-top: 1em">The ability to match on cookies
was added in Open vSwitch 1.5.0.</p>

<p style="margin-top: 1em">The following additional field
sets the priority for flows added by the add-flow and
add-flows commands. For mod-flows and del-flows when
--strict is specified, priority must <br>
match along with the rest of the flow specification. For
mod-flows without --strict, priority is only significant if
the command creates a new flow, that is, non-strict <br>
mod-flows does not match on priority and will not change the
priority of existing flows. Other commands do not allow
priority to be specified.</p>

<p style="margin-top: 1em">priority=value <br>
The priority at which a wildcarded entry will match in
comparison to others. value is a number between 0 and 65535,
inclusive. A higher value will match before a lower <br>
one. An exact-match entry will always have priority over an
entry containing wildcards, so it has an implicit priority
value of 65535. When adding a flow, if the field <br>
is not specified, the flow&rsquo;s priority will default to
32768.</p>

<p style="margin-top: 1em">OpenFlow leaves behavior
undefined when two or more flows with the same priority can
match a single packet. Some users expect
&lsquo;&lsquo;sensible&rsquo;&rsquo; behavior, such as more
specific <br>
flows taking precedence over less specific flows, but
OpenFlow does not specify this and Open vSwitch does not
implement it. Users should therefore take care to use
pri&acirc; <br>
orities to ensure the behavior that they expect.</p>

<p style="margin-top: 1em">The add-flow, add-flows, and
mod-flows commands support the following additional options.
These options affect only new flows. Thus, for add-flow and
add-flows, these options <br>
are always significant, but for mod-flows they are
significant only if the command creates a new flow, that is,
their values do not update or affect existing flows.</p>

<p style="margin-top: 1em">idle_timeout=seconds <br>
Causes the flow to expire after the given number of seconds
of inactivity. A value of 0 (the default) prevents a flow
from expiring due to inactivity.</p>

<p style="margin-top: 1em">hard_timeout=seconds <br>
Causes the flow to expire after the given number of seconds,
regardless of activity. A value of 0 (the default) gives the
flow no hard expiration deadline.</p>

<p style="margin-top: 1em">importance=value <br>
Sets the importance of a flow. The flow entry eviction
mechanism can use importance as a factor in deciding which
flow to evict. A value of 0 (the default) makes the <br>
flow non-evictable on the basis of importance. Specify a
value between 0 and 65535.</p>

<p style="margin-top: 1em">Only OpenFlow 1.4 and later
support importance.</p>

<p style="margin-top: 1em">send_flow_rem <br>
Marks the flow with a flag that causes the switch to
generate a &lsquo;&lsquo;flow removed&rsquo;&rsquo; message
and send it to interested controllers when the flow later
expires or is removed.</p>

<p style="margin-top: 1em">check_overlap <br>
Forces the switch to check that the flow match does not
overlap that of any different flow with the same priority in
the same table. (This check is expensive so it is <br>
best to avoid it.)</p>

<p style="margin-top: 1em">The dump-flows, dump-aggregate,
del-flow and del-flows commands support these additional
optional fields:</p>

<p style="margin-top: 1em">out_port=port <br>
If set, a matching flow must include an output action to
port, which must be an OpenFlow port number or name (e.g.
local).</p>

<p style="margin-top: 1em">out_group=port <br>
If set, a matching flow must include an group action naming
group, which must be an OpenFlow group number. This field is
supported in Open vSwitch 2.5 and later and <br>
requires OpenFlow 1.1 or later.</p>

<p style="margin-top: 1em">Table Entry Output <br>
The dump-tables and dump-aggregate commands print
information about the entries in a datapath&rsquo;s tables.
Each line of output is a flow entry as described in Flow
Syntax, above, <br>
plus some additional fields:</p>

<p style="margin-top: 1em">duration=secs <br>
The time, in seconds, that the entry has been in the table.
secs includes as much precision as the switch provides,
possibly to nanosecond resolution.</p>

<p style="margin-top: 1em">n_packets <br>
The number of packets that have matched the entry.</p>

<p style="margin-top: 1em">n_bytes <br>
The total number of bytes from packets that have matched the
entry.</p>

<p style="margin-top: 1em">The following additional fields
are included only if the switch is Open vSwitch 1.6 or later
and the NXM flow format is used to dump the flow (see the
description of the --flow- <br>
format option below). The values of these additional fields
are approximations only and in particular idle_age will
sometimes become nonzero even for busy flows.</p>

<p style="margin-top: 1em">hard_age=secs <br>
The integer number of seconds since the flow was added or
modified. hard_age is displayed only if it differs from the
integer part of duration. (This is separate from <br>
duration because mod-flows restarts the hard_timeout timer
without zeroing duration.)</p>

<p style="margin-top: 1em">idle_age=secs <br>
The integer number of seconds that have passed without any
packets passing through the flow.</p>

<p style="margin-top: 1em">Packet-Out Syntax <br>
ovs-ofctl bundle command accepts packet-outs to be specified
in the bundle file. Each packet-out comprises of a series of
field=value assignments, separated by commas or white <br>
space. (Embedding spaces into a packet-out description
normally requires quoting to prevent the shell from breaking
the description into multiple arguments.). Unless noted
oth&acirc; <br>
erwise only the last instance of each field is honoured.
This same syntax is also supported by the ovs-ofctl
packet-out command.</p>

<p style="margin-top: 1em">in_port=port <br>
The port number to be considered the in_port when processing
actions. This can be any valid OpenFlow port number, or any
of the LOCAL, CONTROLLER, or NONE. This field is <br>
required.</p>

<p style="margin-top: 1em">packet=hex-string <br>
The actual packet to send, expressed as a string of
hexadecimal bytes. This field is required.</p>

<p style="margin-top: 1em">actions=[action][,action...]
<br>
The syntax of actions are identical to the actions= field
described in Flow Syntax above. Specifying actions= is
optional, but omitting actions is interpreted as a drop,
<br>
so the packet will not be sent anywhere from the switch.
actions must be specified at the end of each line, like for
flow mods.</p>

<p style="margin-top: 1em">Group Syntax <br>
Some ovs-ofctl commands accept an argument that describes a
group or groups. Such flow descriptions comprise a series
field=value assignments, separated by commas or white <br>
space. (Embedding spaces into a group description normally
requires quoting to prevent the shell from breaking the
description into multiple arguments.). Unless noted
otherwise <br>
only the last instance of each field is honoured.</p>

<p style="margin-top: 1em">group_id=id <br>
The integer group id of group. When this field is specified
in del-groups or dump-groups, the keyword &quot;all&quot;
may be used to designate all groups. This field is
required.</p>

<p style="margin-top: 1em">type=type <br>
The type of the group. The add-group, add-groups and
mod-groups commands require this field. It is prohibited for
other commands. The following keywords designated the <br>
allowed types:</p>

<p style="margin-top: 1em">all Execute all buckets in the
group.</p>

<p style="margin-top: 1em">select Execute one bucket in the
group. The switch should select the bucket in such a way
that should implement equal load sharing is achieved. The
switch may optionally <br>
select the bucket based on bucket weights.</p>

<p style="margin-top: 1em">indirect <br>
Executes the one bucket in the group.</p>

<p style="margin-top: 1em">ff <br>
fast_failover <br>
Executes the first live bucket in the group which is
associated with a live port or group.</p>

<p style="margin-top: 1em">command_bucket_id=id <br>
The bucket to operate on. The insert-buckets and
remove-buckets commands require this field. It is prohibited
for other commands. id may be an integer or one of the <br>
following keywords:</p>

<p style="margin-top: 1em">all Operate on all buckets in
the group. Only valid when used with the remove-buckets
command in which case the effect is to remove all buckets
from the group.</p>

<p style="margin-top: 1em">first Operate on the first
bucket present in the group. In the case of the
insert-buckets command the effect is to insert new bucets
just before the first bucket already <br>
present in the group; or to replace the buckets of the group
if there are no buckets already present in the group. In the
case of the remove-buckets command the <br>
effect is to remove the first bucket of the group; or do
nothing if there are no buckets present in the group.</p>

<p style="margin-top: 1em">last Operate on the last bucket
present in the group. In the case of the insert-buckets
command the effect is to insert new bucets just after the
last bucket already <br>
present in the group; or to replace the buckets of the group
if there are no buckets already present in the group. In the
case of the remove-buckets command the <br>
effect is to remove the last bucket of the group; or do
nothing if there are no buckets present in the group.</p>

<p style="margin-top: 1em">If id is an integer then it
should correspond to the bucket_id of a bucket present in
the group. In case of the insert-buckets command the effect
is to insert buckets <br>
just before the bucket in the group whose bucket_id is id.
In case of the iremove-buckets command the effect is to
remove the in the group whose bucket_id is id. It is <br>
an error if there is no bucket persent group in whose
bucket_id is id.</p>

<p style="margin-top: 1em">selection_method=method <br>
The selection method used to select a bucket for a select
group. This is a string of 1 to 15 bytes in length known to
lower layers. This field is optional for add-group, <br>
add-groups and mod-group commands on groups of type select.
Prohibited otherwise. The default value is the empty
string.</p>

<p style="margin-top: 1em">hash Use a hash computed over
the fields specified with the fields option, see below. hash
uses the selection_method_param as the hash basis.</p>

<p style="margin-top: 1em">Note that the hashed fields
become exact matched by the datapath flows. For example, if
the TCP source port is hashed, the created datapath flows
will match the <br>
specific TCP source port value present in the packet
received. Since each TCP connection generally has a
different source port value, a separate datapath flow will
<br>
be need to be inserted for each TCP connection thus hashed
to a select group bucket.</p>

<p style="margin-top: 1em">dp_hash <br>
Use a datapath computed hash value. The hash algorithm
varies accross different datapath implementations. dp_hash
uses the upper 32 bits of the selec&acirc; <br>
tion_method_param as the datapath hash algorithm selector,
which currently must always be 0, corresponding to hash
computation over the IP 5-tuple (selecting spe&acirc; <br>
cific fields with the fields option is not allowed with
dp_hash). The lower 32 bits are used as the hash basis.</p>

<p style="margin-top: 1em">Using dp_hash has the advantage
that it does not require the generated datapath flows to
exact match any additional packet header fields. For
example, even if mul&acirc; <br>
tiple TCP connections thus hashed to different select group
buckets have different source port numbers, generally all of
them would be handled with a small set of <br>
already established datapath flows, resulting in less
latency for TCP SYN packets. The downside is that the shared
datapath flows must match each packet twice, as <br>
the datapath hash value calculation happens only when
needed, and a second match is required to match some bits of
its value. This double-matching incurs a small <br>
additional latency cost for each packet, but this latency is
orders of magnitude less than the latency of creating new
datapath flows for new TCP connections.</p>

<p style="margin-top: 1em">This option will use a Netronome
OpenFlow extension which is only supported when using Open
vSwitch 2.4 and later with OpenFlow 1.5 and later.</p>

<p style="margin-top: 1em">selection_method_param=param
<br>
64-bit integer parameter to the selection method selected by
the selection_method field. The parameter&rsquo;s use is
defined by the lower-layer that implements the selec&acirc;
<br>
tion_method. It is optional if the selection_method field is
specified as a non-empty string. Prohibited otherwise. The
default value is zero.</p>

<p style="margin-top: 1em">This option will use a Netronome
OpenFlow extension which is only supported when using Open
vSwitch 2.4 and later with OpenFlow 1.5 and later.</p>

<p style="margin-top: 1em">fields=field <br>
fields(field[=mask]...) <br>
The field parameters to selection method selected by the
selection_method field. The syntax is described in Flow
Syntax with the additional restrictions that if a value <br>
is provided it is treated as a wildcard mask and wildcard
masks following a slash are prohibited. The pre-requisites
of fields must be provided by any flows that output to <br>
the group. The use of the fields is defined by the
lower-layer that implements the selection_method. They are
optional if the selection_method field is specified as <br>
&lsquo;&lsquo;hash&rsquo;, prohibited otherwise. The default
is no fields.</p>

<p style="margin-top: 1em">This option will use a Netronome
OpenFlow extension which is only supported when using Open
vSwitch 2.4 and later with OpenFlow 1.5 and later.</p>

<p style="margin-top: 1em">bucket=bucket_parameters <br>
The add-group, add-groups and mod-group commands require at
least one bucket field. Bucket fields must appear after all
other fields. Multiple bucket fields to specify <br>
multiple buckets. The order in which buckets are specified
corresponds to their order in the group. If the type of the
group is &quot;indirect&quot; then only one group may be
<br>
specified. bucket_parameters consists of a list of
field=value assignments, separated by commas or white space
followed by a comma-separated list of actions. The fields
<br>
for bucket_parameters are:</p>

<p style="margin-top: 1em">bucket_id=id <br>
The 32-bit integer group id of the bucket. Values greater
than 0xffffff00 are reserved. This field was added in Open
vSwitch 2.4 to conform with the OpenFlow 1.5 <br>
specification. It is not supported when earlier versions of
OpenFlow are used. Open vSwitch will automatically allocate
bucket ids when they are not specified.</p>

<p style="margin-top: 1em">actions=[action][,action...]
<br>
The syntax of actions are identical to the actions= field
described in Flow Syntax above. Specifying actions= is
optional, any unknown bucket parameter will be <br>
interpreted as an action.</p>

<p style="margin-top: 1em">weight=value <br>
The relative weight of the bucket as an integer. This may be
used by the switch during bucket select for groups whose
type is select.</p>

<p style="margin-top: 1em">watch_port=port <br>
Port used to determine liveness of group. This or the
watch_group field is required for groups whose type is ff or
fast_failover.</p>

<p style="margin-top: 1em">watch_group=group_id <br>
Group identifier of group used to determine liveness of
group. This or the watch_port field is required for groups
whose type is ff or fast_failover.</p>

<p style="margin-top: 1em">Meter Syntax <br>
The meter table commands accept an argument that describes a
meter. Such meter descriptions comprise a series field=value
assignments, separated by commas or white space. <br>
(Embedding spaces into a group description normally requires
quoting to prevent the shell from breaking the description
into multiple arguments.). Unless noted otherwise only the
<br>
last instance of each field is honoured.</p>

<p style="margin-top: 1em">meter=id <br>
The integer meter id of the meter. When this field is
specified in del-meter, dump-meter, or meter-stats, the
keyword &quot;all&quot; may be used to designate all meters.
This <br>
field is required, exept for meter-stats, which dumps all
stats when this field is not specified.</p>

<p style="margin-top: 1em">kbps <br>
pktps The unit for the meter band rate parameters, either
kilobits per second, or packets per second, respectively.
One of these must be specified. The burst size unit
corre&acirc; <br>
sponds to the rate unit by dropping the &quot;per
second&quot;, i.e., burst is in units of kilobits or
packets, respectively.</p>

<p style="margin-top: 1em">burst Specify burst size for all
bands, or none of them, if this flag is not given.</p>

<p style="margin-top: 1em">stats Collect meter and band
statistics.</p>

<p style="margin-top: 1em">bands=band_parameters <br>
The add-meter and mod-meter commands require at least one
band specification. Bands must appear after all other
fields.</p>

<p style="margin-top: 1em">type=type <br>
The type of the meter band. This keyword starts a new band
specification. Each band specifies a rate above which the
band is to take some action. The action <br>
depends on the band type. If multiple bands&rsquo; rate is
exceeded, then the band with the highest rate among the
exceeded bands is selected. The following keywords <br>
designate the allowed meter band types:</p>

<p style="margin-top: 1em">drop Drop packets exceeding the
band&rsquo;s rate limit.</p>

<p style="margin-top: 1em">The other band_parameters
are:</p>

<p style="margin-top: 1em">rate=value <br>
The relative rate limit for this band, in kilobits per
second or packets per second, depending on the meter flags
defined above.</p>

<p style="margin-top: 1em">burst_size=size <br>
The maximum burst allowed for the band. If pktps is
specified, then size is a packet count, otherwise it is in
kilobits. If unspecified, the switch is free to <br>
select some reasonable value depending on its
configuration.</p>

<p style="margin-top: 1em">OPTIONS <br>
--strict <br>
Uses strict matching when running flow modification
commands.</p>

<p style="margin-top: 1em">--read-only <br>
Do not execute read/write commands.</p>

<p style="margin-top: 1em">--bundle <br>
Execute flow mods as an OpenFlow 1.4 atomic bundle
transaction.</p>

<p style="margin-top: 1em">&Acirc;&middot; Within a bundle,
all flow mods are processed in the order they appear and as
a single atomic transaction, meaning that if one of them
fails, the whole transaction <br>
fails and none of the changes are made to the switch&rsquo;s
flow table, and that each given datapath packet traversing
the OpenFlow tables sees the flow tables either as <br>
before the transaction, or after all the flow mods in the
bundle have been successfully applied.</p>

<p style="margin-top: 1em">&Acirc;&middot; The beginning
and the end of the flow table modification commands in a
bundle are delimited with OpenFlow 1.4 bundle control
messages, which makes it possible to <br>
stream the included commands without explicit OpenFlow
barriers, which are otherwise used after each flow table
modification command. This may make large modifica&acirc;
<br>
tions execute faster as a bundle.</p>

<p style="margin-top: 1em">&Acirc;&middot; Bundles require
OpenFlow 1.4 or higher. An explicit -O OpenFlow14 option is
not needed, but you may need to enable OpenFlow 1.4 support
for OVS by setting the <br>
OVSDB protocols column in the bridge table.</p>

<p style="margin-top: 1em">-O [version[,version]...] <br>
--protocols=[version[,version]...] <br>
Sets the OpenFlow protocol versions that are allowed when
establishing an OpenFlow session.</p>

<p style="margin-top: 1em">The following versions are
considered to be ready for general use. These protocol
versions are enabled by default:</p>

<p style="margin-top: 1em">&Acirc;&middot; OpenFlow10, for
OpenFlow 1.0.</p>

<p style="margin-top: 1em">Support for the following
protocol versions is provided for testing and development
purposes. They are not enabled by default:</p>

<p style="margin-top: 1em">&Acirc;&middot; OpenFlow11, for
OpenFlow 1.1.</p>

<p style="margin-top: 1em">&Acirc;&middot; OpenFlow12, for
OpenFlow 1.2.</p>

<p style="margin-top: 1em">&Acirc;&middot; OpenFlow13, for
OpenFlow 1.3.</p>

<p style="margin-top: 1em">-F format[,format...] <br>
--flow-format=format[,format...] <br>
ovs-ofctl supports the following individual flow formats,
any number of which may be listed as format:</p>

<p style="margin-top: 1em">OpenFlow10-table_id <br>
This is the standard OpenFlow 1.0 flow format. All OpenFlow
switches and all versions of Open vSwitch support this flow
format.</p>

<p style="margin-top: 1em">OpenFlow10+table_id <br>
This is the standard OpenFlow 1.0 flow format plus a Nicira
extension that allows ovs-ofctl to specify the flow table in
which a particular flow should be placed. <br>
Open vSwitch 1.2 and later supports this flow format.</p>

<p style="margin-top: 1em">NXM-table_id (Nicira Extended
Match) <br>
This Nicira extension to OpenFlow is flexible and
extensible. It supports all of the Nicira flow extensions,
such as tun_id and registers. Open vSwitch 1.1 and <br>
later supports this flow format.</p>

<p style="margin-top: 1em">NXM+table_id (Nicira Extended
Match) <br>
This combines Nicira Extended match with the ability to
place a flow in a specific table. Open vSwitch 1.2 and later
supports this flow format.</p>

<p style="margin-top: 1em">OXM-OpenFlow12 <br>
OXM-OpenFlow13 <br>
OXM-OpenFlow14 <br>
These are the standard OXM (OpenFlow Extensible Match) flow
format in OpenFlow 1.2, 1.3, and 1.4, respectively.</p>

<p style="margin-top: 1em">ovs-ofctl also supports the
following abbreviations for collections of flow formats:</p>

<p style="margin-top: 1em">any Any supported flow
format.</p>

<p style="margin-top: 1em">OpenFlow10 <br>
OpenFlow10-table_id or OpenFlow10+table_id.</p>

<p style="margin-top: 1em">NXM NXM-table_id or
NXM+table_id.</p>

<p style="margin-top: 1em">OXM OXM-OpenFlow12,
OXM-OpenFlow13, or OXM-OpenFlow14.</p>

<p style="margin-top: 1em">For commands that modify the
flow table, ovs-ofctl by default negotiates the most widely
supported flow format that supports the flows being added.
For commands that <br>
query the flow table, ovs-ofctl by default uses the most
advanced format supported by the switch.</p>

<p style="margin-top: 1em">This option, where format is a
comma-separated list of one or more of the formats listed
above, limits ovs-ofctl&rsquo;s choice of flow format. If a
command cannot work as <br>
requested using one of the specified flow formats, ovs-ofctl
will report a fatal error.</p>

<p style="margin-top: 1em">-P format <br>
--packet-in-format=format <br>
ovs-ofctl supports the following
&lsquo;&lsquo;packet-in&rsquo;&rsquo; formats, in order of
increasing capability:</p>

<p style="margin-top: 1em">standard <br>
This uses the OFPT_PACKET_IN message, the standard
&lsquo;&lsquo;packet-in&rsquo;&rsquo; message for any given
OpenFlow version. Every OpenFlow switch that supports a
given OpenFlow ver&acirc; <br>
sion supports this format.</p>

<p style="margin-top: 1em">nxt_packet_in <br>
This uses the NXT_PACKET_IN message, which adds many of the
capabilities of the OpenFlow 1.1 and later
&lsquo;&lsquo;packet-in&rsquo;&rsquo; messages before those
OpenFlow versions were <br>
available in Open vSwitch. Open vSwitch 1.1 and later
support this format. Only Open vSwitch 2.6 and later,
however, support it for OpenFlow 1.1 and later (but <br>
there is little reason to use it with those versions of
OpenFlow).</p>

<p style="margin-top: 1em">nxt_packet_in2 <br>
This uses the NXT_PACKET_IN2 message, which is extensible
and should avoid the need to define new formats later. In
particular, this format supports passing arbi&acirc; <br>
trary user-provided data to a controller using the userdata
option on the controller action. Open vSwitch 2.6 and later
support this format.</p>

<p style="margin-top: 1em">Without this option, ovs-ofctl
prefers nxt_packet_in2 if the switch supports it. Otherwise,
if OpenFlow 1.0 is in use, ovs-ofctl prefers nxt_packet_in
if the switch sup&acirc; <br>
ports it. Otherwise, ovs-ofctl falls back to the standard
packet-in format. When this option is specified, ovs-ofctl
insists on the selected format. If the switch does <br>
not support the requested format, ovs-ofctl will report a
fatal error.</p>

<p style="margin-top: 1em">Before version 2.6, Open vSwitch
called standard format openflow10 and nxt_packet_in format
nxm, and ovs-ofctl still accepts these names as synonyms.
(The name openflow10 <br>
was a misnomer because this format actually varies from one
OpenFlow version to another; it is not consistently OpenFlow
1.0 format. Similarly, when nxt_packet_in2 was <br>
introduced, the name nxm became confusing because it also
uses OXM/NXM.)</p>

<p style="margin-top: 1em">This option affects only the
monitor command.</p>

<p style="margin-top: 1em">--timestamp <br>
Print a timestamp before each received packet. This option
only affects the monitor, snoop, and ofp-parse-pcap
commands.</p>

<p style="margin-top: 1em">-m <br>
--more Increases the verbosity of OpenFlow messages printed
and logged by ovs-ofctl commands. Specify this option more
than once to increase verbosity further.</p>

<p style="margin-top: 1em">--sort[=field] <br>
--rsort[=field] <br>
Display output sorted by flow field in ascending (--sort) or
descending (--rsort) order, where field is any of the fields
that are allowed for matching or priority to sort <br>
by priority. When field is omitted, the output is sorted by
priority. Specify these options multiple times to sort by
multiple fields.</p>

<p style="margin-top: 1em">Any given flow will not
necessarily specify a value for a given field. This requires
special treatement:</p>

<p style="margin-top: 1em">&Acirc;&middot; A flow that does
not specify any part of a field that is used for sorting is
sorted after all the flows that do specify the field. For
example, --sort=tcp_src will <br>
sort all the flows that specify a TCP source port in
ascending order, followed by the flows that do not specify a
TCP source port at all.</p>

<p style="margin-top: 1em">&Acirc;&middot; A flow that only
specifies some bits in a field is sorted as if the
wildcarded bits were zero. For example, --sort=nw_src would
sort a flow that specifies <br>
nw_src=192.168.0.0/24 the same as nw_src=192.168.0.0.</p>

<p style="margin-top: 1em">These options currently affect
only dump-flows output. The following options are valid on
POSIX based platforms.</p>

<p style="margin-top: 1em">--pidfile[=pidfile] <br>
Causes a file (by default, ovs-ofctl.pid) to be created
indicating the PID of the running process. If the pidfile
argument is not specified, or if it does not begin with <br>
/, then it is created in /var/run/openvswitch.</p>

<p style="margin-top: 1em">If --pidfile is not specified,
no pidfile is created.</p>

<p style="margin-top: 1em">--overwrite-pidfile <br>
By default, when --pidfile is specified and the specified
pidfile already exists and is locked by a running process,
ovs-ofctl refuses to start. Specify --overwrite-pid&acirc;
<br>
file to cause it to instead overwrite the pidfile.</p>

<p style="margin-top: 1em">When --pidfile is not specified,
this option has no effect.</p>

<p style="margin-top: 1em">--detach <br>
Runs ovs-ofctl as a background process. The process forks,
and in the child it starts a new session, closes the
standard file descriptors (which has the side effect of <br>
disabling logging to the console), and changes its current
directory to the root (unless --no-chdir is specified).
After the child completes its initialization, the par&acirc;
<br>
ent exits. ovs-ofctl detaches only when executing the
monitor or snoop commands.</p>

<p style="margin-top: 1em">--monitor <br>
Creates an additional process to monitor the ovs-ofctl
daemon. If the daemon dies due to a signal that indicates a
programming error (SIGABRT, SIGALRM, SIGBUS, SIGFPE, <br>
SIGILL, SIGPIPE, SIGSEGV, SIGXCPU, or SIGXFSZ) then the
monitor process starts a new copy of it. If the daemon dies
or exits for another reason, the monitor process <br>
exits.</p>

<p style="margin-top: 1em">This option is normally used
with --detach, but it also functions without it.</p>

<p style="margin-top: 1em">--no-chdir <br>
By default, when --detach is specified, ovs-ofctl changes
its current working directory to the root directory after it
detaches. Otherwise, invoking ovs-ofctl from a <br>
carelessly chosen directory would prevent the administrator
from unmounting the file system that holds that
directory.</p>

<p style="margin-top: 1em">Specifying --no-chdir suppresses
this behavior, preventing ovs-ofctl from changing its
current working directory. This may be useful for collecting
core files, since it <br>
is common behavior to write core dumps into the current
working directory and the root directory is not a good
directory to use.</p>

<p style="margin-top: 1em">This option has no effect when
--detach is not specified.</p>

<p style="margin-top: 1em">--no-self-confinement <br>
By default daemon will try to self-confine itself to work
with files under well-know, at build-time whitelisted
directories. It is better to stick with this default <br>
behavior and not to use this flag unless some other Access
Control is used to confine daemon. Note that in contrast to
other access control implementations that are typi&acirc;
<br>
cally enforced from kernel-space (e.g. DAC or MAC),
self-confinement is imposed from the user-space daemon
itself and hence should not be considered as a full
confinement <br>
strategy, but instead should be viewed as an additional
layer of security.</p>

<p style="margin-top: 1em">--user Causes ovs-ofctl to run
as a different user specified in &quot;user:group&quot;,
thus dropping most of the root privileges. Short forms
&quot;user&quot; and &quot;:group&quot; are also allowed,
with <br>
current user or group are assumed respectively. Only daemons
started by the root user accepts this argument.</p>

<p style="margin-top: 1em">On Linux, daemons will be
granted CAP_IPC_LOCK and CAP_NET_BIND_SERVICES before
dropping root privileges. Daemons that interact with a
datapath, such as ovs-vswitchd, will <br>
be granted two additional capabilities, namely CAP_NET_ADMIN
and CAP_NET_RAW. The capability change will apply even if
new user is &quot;root&quot;.</p>

<p style="margin-top: 1em">On Windows, this option is not
currently supported. For security reasons, specifying this
option will cause the daemon process not to start.</p>

<p style="margin-top: 1em">--unixctl=socket <br>
Sets the name of the control socket on which ovs-ofctl
listens for runtime management commands (see RUNTIME
MANAGEMENT COMMANDS, below). If socket does not begin with
/, <br>
it is interpreted as relative to /var/run/openvswitch. If
--unixctl is not used at all, the default socket is
/var/run/openvswitch/ovs-ofctl.pid.ctl, where pid is <br>
ovs-ofctl&rsquo;s process ID.</p>

<p style="margin-top: 1em">On Windows a local named pipe is
used to listen for runtime management commands. A file is
created in the absolute path as pointed by socket or if
--unixctl is not used <br>
at all, a file is created as ovs-ofctl.ctl in the configured
OVS_RUNDIR directory. The file exists just to mimic the
behavior of a Unix domain socket.</p>

<p style="margin-top: 1em">Specifying none for socket
disables the control socket feature.</p>

<p style="margin-top: 1em">Public Key Infrastructure
Options <br>
-p privkey.pem <br>
--private-key=privkey.pem <br>
Specifies a PEM file containing the private key used as
ovs-ofctl&rsquo;s identity for outgoing SSL connections.</p>

<p style="margin-top: 1em">-c cert.pem <br>
--certificate=cert.pem <br>
Specifies a PEM file containing a certificate that certifies
the private key specified on -p or --private-key to be
trustworthy. The certificate must be signed by the <br>
certificate authority (CA) that the peer in SSL connections
will use to verify it.</p>

<p style="margin-top: 1em">-C cacert.pem <br>
--ca-cert=cacert.pem <br>
Specifies a PEM file containing the CA certificate that
ovs-ofctl should use to verify certificates presented to it
by SSL peers. (This may be the same certificate that <br>
SSL peers use to verify the certificate specified on -c or
--certificate, or it may be a different one, depending on
the PKI design in use.)</p>

<p style="margin-top: 1em">-C none <br>
--ca-cert=none <br>
Disables verification of certificates presented by SSL
peers. This introduces a security risk, because it means
that certificates cannot be verified to be those of known
<br>
trusted hosts.</p>

<p style="margin-top: 1em">-v[spec] <br>
--verbose=[spec] <br>
Sets logging levels. Without any spec, sets the log level
for every module and destination to dbg. Otherwise, spec is
a list of words separated by spaces or commas or <br>
colons, up to one from each category below:</p>

<p style="margin-top: 1em">&Acirc;&middot; A valid module
name, as displayed by the vlog/list command on
ovs-appctl(8), limits the log level change to the specified
module.</p>

<p style="margin-top: 1em">&Acirc;&middot; syslog, console,
or file, to limit the log level change to only to the system
log, to the console, or to a file, respectively. (If
--detach is specified, ovs-ofctl <br>
closes its standard file descriptors, so logging to the
console will have no effect.)</p>

<p style="margin-top: 1em">On Windows platform, syslog is
accepted as a word and is only useful along with the
--syslog-target option (the word has no effect
otherwise).</p>

<p style="margin-top: 1em">&Acirc;&middot; off, emer, err,
warn, info, or dbg, to control the log level. Messages of
the given severity or higher will be logged, and messages of
lower severity will be fil&acirc; <br>
tered out. off filters out all messages. See ovs-appctl(8)
for a definition of each log level.</p>

<p style="margin-top: 1em">Case is not significant within
spec.</p>

<p style="margin-top: 1em">Regardless of the log levels set
for file, logging to a file will not take place unless
--log-file is also specified (see below).</p>

<p style="margin-top: 1em">For compatibility with older
versions of OVS, any is accepted as a word but has no
effect.</p>

<p style="margin-top: 1em">-v <br>
--verbose <br>
Sets the maximum logging verbosity level, equivalent to
--verbose=dbg.</p>

<p style="margin-top: 1em">-vPATTERN:destination:pattern
<br>
--verbose=PATTERN:destination:pattern <br>
Sets the log pattern for destination to pattern. Refer to
ovs-appctl(8) for a description of the valid syntax for
pattern.</p>

<p style="margin-top: 1em">-vFACILITY:facility <br>
--verbose=FACILITY:facility <br>
Sets the RFC5424 facility of the log message. facility can
be one of kern, user, mail, daemon, auth, syslog, lpr, news,
uucp, clock, ftp, ntp, audit, alert, clock2, <br>
local0, local1, local2, local3, local4, local5, local6 or
local7. If this option is not specified, daemon is used as
the default for the local system syslog and local0 is <br>
used while sending a message to the target provided via the
--syslog-target option.</p>

<p style="margin-top: 1em">--log-file[=file] <br>
Enables logging to a file. If file is specified, then it is
used as the exact name for the log file. The default log
file name used if file is omitted is /var/log/open&acirc;
<br>
vswitch/ovs-ofctl.log.</p>

<p style="margin-top: 1em">--syslog-target=host:port <br>
Send syslog messages to UDP port on host, in addition to the
system syslog. The host must be a numerical IP address, not
a hostname.</p>

<p style="margin-top: 1em">--syslog-method=method <br>
Specify method how syslog messages should be sent to syslog
daemon. Following forms are supported:</p>

<p style="margin-top: 1em">&Acirc;&middot; libc, use libc
syslog() function. This is the default behavior. Downside of
using this options is that libc adds fixed prefix to every
message before it is actu&acirc; <br>
ally sent to the syslog daemon over /dev/log UNIX domain
socket.</p>

<p style="margin-top: 1em">&Acirc;&middot; unix:file, use
UNIX domain socket directly. It is possible to specify
arbitrary message format with this option. However, rsyslogd
8.9 and older versions use hard <br>
coded parser function anyway that limits UNIX domain socket
use. If you want to use arbitrary message format with older
rsyslogd versions, then use UDP socket to <br>
localhost IP address instead.</p>

<p style="margin-top: 1em">&Acirc;&middot; udp:ip:port, use
UDP socket. With this method it is possible to use arbitrary
message format also with older rsyslogd. When sending syslog
messages over UDP <br>
socket extra precaution needs to be taken into account, for
example, syslog daemon needs to be configured to listen on
the specified UDP port, accidental iptables <br>
rules could be interfering with local syslog traffic and
there are some security considerations that apply to UDP
sockets, but do not apply to UNIX domain sockets.</p>

<p style="margin-top: 1em">--color[=when] <br>
Colorize the output (for some commands); when can be never,
always, or auto (the default).</p>

<p style="margin-top: 1em">Only some commands support
output coloring. Color names and default colors may change
in future releases.</p>

<p style="margin-top: 1em">The environment variable
OVS_COLORS can be used to specify user-defined colors and
other attributes used to highlight various parts of the
output. If set, its value is a <br>
colon-separated list of capabilities that defaults to
ac:01;31:dr=34:le=31:pm=36:pr=35:sp=33:vl=32. Supported
capabilities were initially designed for coloring flows from
<br>
ovs-ofctl dump-flows switch command, and they are as
follows.</p>

<p style="margin-top: 1em">ac=01;31 <br>
SGR substring for actions= keyword in a flow. The default is
a bold red text foreground.</p>

<p style="margin-top: 1em">dr=34 SGR substring for drop
keyword. The default is a dark blue text foreground.</p>

<p style="margin-top: 1em">le=31 SGR substring for learn=
keyword in a flow. The default is a red text foreground.</p>

<p style="margin-top: 1em">pm=36 SGR substring for flow
match attribute names. The default is a cyan text
foreground.</p>

<p style="margin-top: 1em">pr=35 SGR substring for keywords
in a flow that are followed by arguments inside parenthesis.
The default is a magenta text foreground.</p>

<p style="margin-top: 1em">sp=33 SGR substring for some
special keywords in a flow, notably: table=, priority=,
load:, output:, move:, group:, CONTROLLER:, set_field:,
resubmit:, exit. The <br>
default is a yellow text foreground.</p>

<p style="margin-top: 1em">vl=32 SGR substring for a lone
flow match attribute with no field name. The default is a
green text foreground.</p>

<p style="margin-top: 1em">See the Select Graphic Rendition
(SGR) section in the documentation of the text terminal that
is used for permitted values and their meaning as character
attributes.</p>

<p style="margin-top: 1em">-h <br>
--help Prints a brief help message to the console.</p>

<p style="margin-top: 1em">-V <br>
--version <br>
Prints version information to the console.</p>

<p style="margin-top: 1em">RUNTIME MANAGEMENT COMMANDS <br>
ovs-appctl(8) can send commands to a running ovs-ofctl
process. The supported commands are listed below.</p>

<p style="margin-top: 1em">exit Causes ovs-ofctl to
gracefully terminate. This command applies only when
executing the monitor or snoop commands.</p>

<p style="margin-top: 1em">ofctl/set-output-file file <br>
Causes all subsequent output to go to file instead of
stderr. This command applies only when executing the monitor
or snoop commands.</p>

<p style="margin-top: 1em">ofctl/send ofmsg... <br>
Sends each ofmsg, specified as a sequence of hex digits that
express an OpenFlow message, on the OpenFlow connection.
This command is useful only when executing the moni&acirc;
<br>
tor command.</p>

<p style="margin-top: 1em">ofctl/packet-out packet-out <br>
Sends an OpenFlow PACKET_OUT message specified in Packet-Out
Syntax, on the OpenFlow connection. See Packet-Out Syntax
section for more information. This command is use&acirc;
<br>
ful only when executing the monitor command.</p>

<p style="margin-top: 1em">ofctl/barrier <br>
Sends an OpenFlow barrier request on the OpenFlow connection
and waits for a reply. This command is useful only for the
monitor command.</p>

<p style="margin-top: 1em">EXAMPLES <br>
The following examples assume that ovs-vswitchd has a bridge
named br0 configured.</p>

<p style="margin-top: 1em">ovs-ofctl dump-tables br0 <br>
Prints out the switch&rsquo;s table stats. (This is more
interesting after some traffic has passed through.)</p>

<p style="margin-top: 1em">ovs-ofctl dump-flows br0 <br>
Prints the flow entries in the switch.</p>

<p style="margin-top: 1em">ovs-ofctl add-flow table=0
actions=learn(table=1,hard_timeout=10,
NXM_OF_VLAN_TCI[0..11],output:NXM_OF_IN_PORT[]),
resubmit(,1) <br>
ovs-ofctl add-flow table=1 priority=0 actions=flood
Implements a level 2 MAC learning switch using the
learn.</p>

<p style="margin-top: 1em">ovs-ofctl add-flow br0
&rsquo;table=0,priority=0
actions=load:3-&gt;NXM_NX_REG0[0..15],learn(table=0,priority=1,idle_timeout=10,NXM_OF_ETH_SRC[],NXM_OF_VLAN_TCI[0..11],out&acirc;
<br>
put:NXM_NX_REG0[0..15]),output:2 <br>
In this use of a learn action, the first packet from each
source MAC will be sent to port 2. Subsequent packets will
be output to port 3, with an idle timeout of 10 sec&acirc;
<br>
onds. NXM field names and match field names are both
accepted, e.g. NXM_NX_REG0 or reg0 for the first register,
and empty brackets may be omitted.</p>

<p style="margin-top: 1em">Additional examples may be found
documented as part of related sections.</p>

<p style="margin-top: 1em">SEE ALSO <br>
ovs-fields(7), ovs-appctl(8), ovs-vswitchd(8),
ovs-vswitchd.conf.db(8)</p>

<p style="margin-top: 1em">Open vSwitch 2.7.0
ovs-ofctl(8)</p>
<hr>
</body>
</html>
