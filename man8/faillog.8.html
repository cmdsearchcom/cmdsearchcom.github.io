<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>FAILLOG(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">FAILLOG(8)</td>
    <td class="head-vol">System Management Commands</td>
    <td class="head-rtitle">FAILLOG(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
faillog - display faillog records or set login failure limits
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div class="Pp" style="margin-left: 8.00ex; text-indent: -8.00ex;"><b>faillog</b>
  [ <i>options</i>]</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>faillog</b> displays the contents of the failure log database
  (/var/log/faillog). It can also set the failure counters and limits. When
  <b>faillog</b> is run without arguments, it only displays the faillog records
  of the users who had a login failure.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
The options which apply to the <b>faillog</b> command are:
<div class="Pp"></div>
<b>-a</b>, <b>--all</b>
<div style="margin-left: 4.00ex;">Display (or act on) faillog records for all
  users having an entry in the faillog database.
<div style="height: 1.00em;">&#x00A0;</div>
The range of users can be restricted with the <b>-u</b> option.
<div style="height: 1.00em;">&#x00A0;</div>
In display mode, this is still restricted to existing users but forces the
  display of the faillog entries even if they are empty.
<div style="height: 1.00em;">&#x00A0;</div>
With the <b>-l</b>, <b>-m</b>, <b>-r</b>, <b>-t</b> options, the users' records
  are changed, even if the user does not exist on the system. This is useful to
  reset records of users that have been deleted or to set a policy in advance
  for a range of users.</div>
<div class="Pp"></div>
<b>-h</b>, <b>--help</b>
<div style="margin-left: 4.00ex;">Display help message and exit.</div>
<div class="Pp"></div>
<b>-l</b>, <b>--lock-secs</b>&#x00A0;<i>SEC</i>
<div style="margin-left: 4.00ex;">Lock account for <i>SEC</i> seconds after
  failed login.
<div style="height: 1.00em;">&#x00A0;</div>
Write access to /var/log/faillog is required for this option.</div>
<div class="Pp"></div>
<b>-m</b>, <b>--maximum</b>&#x00A0;<i>MAX</i>
<div style="margin-left: 4.00ex;">Set the maximum number of login failures after
  the account is disabled to <i>MAX</i>.
<div style="height: 1.00em;">&#x00A0;</div>
Selecting a <i>MAX</i> value of 0 has the effect of not placing a limit on the
  number of failed logins.
<div style="height: 1.00em;">&#x00A0;</div>
The maximum failure count should always be 0 for <i>root</i> to prevent a denial
  of services attack against the system.
<div style="height: 1.00em;">&#x00A0;</div>
Write access to /var/log/faillog is required for this option.</div>
<div class="Pp"></div>
<b>-r</b>, <b>--reset</b>
<div style="margin-left: 4.00ex;">Reset the counters of login failures.
<div style="height: 1.00em;">&#x00A0;</div>
Write access to /var/log/faillog is required for this option.</div>
<div class="Pp"></div>
<b>-R</b>, <b>--root</b>&#x00A0;<i>CHROOT_DIR</i>
<div style="margin-left: 4.00ex;">Apply changes in the <i>CHROOT_DIR</i>
  directory and use the configuration files from the <i>CHROOT_DIR</i>
  directory.</div>
<div class="Pp"></div>
<b>-t</b>, <b>--time</b>&#x00A0;<i>DAYS</i>
<div style="margin-left: 4.00ex;">Display faillog records more recent than
  <i>DAYS</i>.</div>
<div class="Pp"></div>
<b>-u</b>, <b>--user</b>&#x00A0;<i>LOGIN</i>|<i>RANGE</i>
<div style="margin-left: 4.00ex;">Display faillog record or maintains failure
  counters and limits (if used with <b>-l</b>, <b>-m</b> or <b>-r</b> options)
  only for the specified user(s).
<div style="height: 1.00em;">&#x00A0;</div>
The users can be specified by a login name, a numerical user ID, or a
  <i>RANGE</i> of users. This <i>RANGE</i> of users can be specified with a min
  and max values ( <i>UID_MIN-UID_MAX</i>), a max value (<i>-UID_MAX</i>), or a
  min value ( <i>UID_MIN-</i>).</div>
<div class="Pp"></div>
When none of the <b>-l</b>, <b>-m</b>, or <b>-r</b> options are used,
  <b>faillog</b> displays the faillog record of the specified user(s).
<h1 class="Sh" title="Sh" id="CAVEATS"><a class="selflink" href="#CAVEATS">CAVEATS</a></h1>
<b>faillog</b> only prints out users with no successful login since the last
  failure. To print out a user who has had a successful login since their last
  failure, you must explicitly request the user with the <b>-u</b> flag, or
  print out all users with the <b>-a</b> flag.
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
/var/log/faillog
<div style="margin-left: 4.00ex;">Failure logging file.</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>login</b>(1), <b>faillog</b>(5).</div>
<table class="foot">
  <tr>
    <td class="foot-date">05/16/2017</td>
    <td class="foot-os">shadow-utils 4.2</td>
  </tr>
</table>
</body>
</html>
