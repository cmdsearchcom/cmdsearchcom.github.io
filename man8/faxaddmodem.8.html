<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>FAXADDMODEM(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">FAXADDMODEM(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">FAXADDMODEM(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
faxaddmodem - configure a modem for use with <i>HylaFAX</i>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>/usr/sbin/faxaddmodem</b> [ <b>-s</b> <i>speed</i> ] [ <b>-f</b> ] [
  <i>tty</i> ]
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<i>faxaddmodem</i> is an interactive shell script that does the necessary setup
  work to configure a modem for use by the <i>HylaFAX</i> software. To enable
  use of the configured modem one must either use the <i>faxmodem</i>(8) program
  or configure the <i>init</i>(8) program to startup a <i>faxgetty</i>(8)
  process for the newly configured modem. In either case the <i>faxq</i>(8)
  program must also be running if outbound services are to be provided.
<div class="Pp"></div>
If the serial port name is not specified on the command line <i>faxaddmodem</i>
  will prompt for it.
<div class="Pp"></div>
The configuration work done by <i>faxaddmodem</i> falls into two main areas:
  creating the necessary files to run a facsimile server process, and defining
  the contents of the configuration database file. The <i>hylafax-config (5)</i>
  manual page has an in-depth description of the contents of the configuration
  file and should be consulted when installing a modem.
<div class="Pp"></div>
Many aspects of configuring a modem are operating system-specific;
  <i>faxaddmodem</i> uses a collection of support routines and parameters that
  are generated by the <i>faxsetup</i>(8) program. If <i>faxsetup</i> has not
  been run on a machine prior to running then <i>faxaddmodem</i> will abort.
<div class="Pp"></div>
<i>faxaddmodem</i> can be used to install a new modem or re-configure an
  existing modem. In the latter case it will propagate all the server-related
  configuration parameters from the existing configuration file to the new
  configuration file. These parameter include items such as the phone number,
  area code, and tracing control parameters. Modem-related configuration
  parameters are, however, not propagated. Instead <i>faxaddmodem</i> deduces
  the type of modem attached to the specified serial port and then sets up the
  configuration parameters using a set of <i>prototype</i> configuration files
  that have been tested with like modems. If a modem is to be installed for
  which there is no existing prototype file, <i>faxaddmodem</i> will work from a
  comprehensive template of parameters that can be edited either during or after
  the installation process.
<div class="Pp"></div>
<i>faxaddmodem</i> deduces the type of modem attached to the serial port by
  sending commands to the modem at a fixed speed. By default, this speed is
  deduced by sending commands to the modem at successively decreasing speeds
  until a valid response is received. Alternatively, a fixed speed can be
  specified from the command line with the <b>-s</b> option.
<div class="Pp"></div>
Because <i>faxaddmodem</i> needs to read and write the modem that is to be
  installed it will not proceed with an installation if the modem is locked for
  use by another process. If the modem is not locked and the <b>-f</b> option is
  used, then the system's <i>fuser</i>(1) command will be invoked to ensure that
  faxaddmodem is the only process using the modem.
<div class="Pp"></div>
Finally, note that an installation can be safely aborted at any time by hitting
  the interrupt key. <i>faxaddmodem</i> delays making installation-related
  changes until after everything has been setup.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s</b><i> speed</i></dt>
  <dd class="It-tag">Communicate with the modem at a fixed <i>speed</i>; this
      may be any value recognized by the <i>stty</i>(1) command.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b></dt>
  <dd class="It-tag">Use the <i>fuser</i>(1) command for exclusive access to the
      device.</dd>
</dl>
<h1 class="Sh" title="Sh" id="PROTOTYPE_CONFIGURATION_FILES"><a class="selflink" href="#PROTOTYPE_CONFIGURATION_FILES">PROTOTYPE
  CONFIGURATION FILES</a></h1>
<i>faxaddmodem</i> uses prototype configuration files that have been created for
  known modems. These prototype files are kept in the <b>config</b> subdirectory
  and, by convention, have names that identify a brand or type of modem and the
  <small>DTE-DCE</small> flow control scheme the prototype files configures. The
  <i>faxaddmodem</i>(8) program that is used to configure a modem for use with
  <i>HylaFAX</i> selects a prototype configuration file using information
  retrieved from the modem and comments embedded in the prototype files. For
  Class 1 and Class 1.0 modems the product ID code returned by the command
  ``ATI0'' and the response from the command ``ATI3'' are used to select a
  prototype configuration file, while for Class 2 modems the manufacturer and
  model as returned by ``AT+FMFR?'' and ``AT+FMDL?'', respectively, are used (or
  ``AT+FMI?'' and ``AT+FMM?'' for Class 2.0 and Class 2.1 modems).
<div class="Pp"></div>
A Class 1 prototype configuration file is identified for use by
  <i>faxaddmodem</i> by searching for a comment of the form:
<pre>
<div style="height: 0.50em;">&#x00A0;</div>
# CONFIG:CLASS1:144:.*:RTSCTS: Manufacturer='AT&amp;T' Model=Dataport
<div style="height: 0.50em;">&#x00A0;</div>
</pre>
In this example ``144'' is the product ID code for an AT&amp;T DataPort modem,
  ``.*'' is a regular expression matched against the result string returned by
  the ``ATI3'' command, and ``RTSCTS'' indicates the modem is configured to use
  hardware flow control during fax operation. The remainder of the line is
  evaluated by the <i>sh</i>(1) and used to specify the modem's manufacturer and
  model (since Class 1 modems do not have standard commands to query this
  information).
<div class="Pp"></div>
Class 2, 2.0, and 2.1 prototype configuration files match the string ``
  <i>manufacturer</i>- <i>model</i>-<i>flowcontrol</i>'' against a <i>sh</i>(1)
  glob pattern specified in the configuration file, where <i>manufacturer</i>
  and <i>model</i> are the strings returned by querying the modem and
  <i>flowcontrol</i> is either ``RTSCTS'' for hardware flow control or
  ``XONXOFF'' for software flow control. For example:
<div style="height: 0.50em;">&#x00A0;</div>
# CONFIG: CLASS2: ZyXEL*-RTSCTS
<div>&#x00A0;</div>
# CONFIG: CLASS2.0: USRobotics*-XONXOFF
<div style="height: 0.50em;">&#x00A0;</div>
are configuration comments that appear in the prototype file for a ZyXEL 1496E
  with Class 2 support, and for a US Robotics Courier modem with Class 2.0
  firmware.
<div class="Pp"></div>
The <i>faxaddmodem</i> program merges server-specific configuration parameters
  into a prototype configuration according to comments placed in the prototype
  file. All lines between ``BEGIN-SERVER'' and ``END-SERVER'' comments are
  placed with the appropriate server configuration parameters. Note that this
  means modem-related configuration parameters must be placed outside this area
  of the file.
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
<pre>
/var/spool/hylafax/etc/setup.cache	master configuration parameters
/var/spool/hylafax/etc/setup.modem	modem-related configuration support
/var/spool/hylafax/config	prototype configuration files
/usr/sbin/ondelay	program to open device without waiting for carrier
/usr/sbin/lockname	SVR4 UUCP lockfile name generator
</pre>
<div class="Pp"></div>
Consult <i>hylafax-server</i>(5) for a complete discussion of the structure and
  content of the spooling area.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i>hylafax-server</i>(5), <i>hylafax-config</i>(5), <i>faxsetup</i>(8),
  <i>faxq</i>(8), <i>faxgetty</i>(8), <i>faxmodem</i>(8), <i>faxconfig</i>(8),
  <i>faxsend</i>(8)</div>
<table class="foot">
  <tr>
    <td class="foot-date">May 12, 1996</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
