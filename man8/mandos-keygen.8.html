<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>MANDOS-KEYGEN(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">MANDOS-KEYGEN(8)</td>
    <td class="head-vol">Mandos Manual</td>
    <td class="head-rtitle">MANDOS-KEYGEN(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
mandos-keygen - Generate key and password for Mandos client and server.
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div class="Pp" style="margin-left: 14.00ex; text-indent: -14.00ex;"><b>mandos-keygen</b>
  [ <b>--dir&#x00A0;</b><b></b><i>DIRECTORY</i> |
  <b>-d&#x00A0;</b><b></b><i>DIRECTORY</i>]
<div>&#x00A0;</div>
[ <b>--type&#x00A0;</b><b></b><i>KEYTYPE</i> |
  <b>-t&#x00A0;</b><b></b><i>KEYTYPE</i>]
<div>&#x00A0;</div>
[ <b>--length&#x00A0;</b><b></b><i>BITS</i> |
  <b>-l&#x00A0;</b><b></b><i>BITS</i>]
<div>&#x00A0;</div>
[ <b>--subtype&#x00A0;</b><b></b><i>KEYTYPE</i> |
  <b>-s&#x00A0;</b><b></b><i>KEYTYPE</i>]
<div>&#x00A0;</div>
[ <b>--sublength&#x00A0;</b><b></b><i>BITS</i> |
  <b>-L&#x00A0;</b><b></b><i>BITS</i>]
<div>&#x00A0;</div>
[ <b>--name&#x00A0;</b><b></b><i>NAME</i> | <b>-n&#x00A0;</b><b></b><i>NAME</i>]
<div>&#x00A0;</div>
[ <b>--email&#x00A0;</b><b></b><i>ADDRESS</i> |
  <b>-e&#x00A0;</b><b></b><i>ADDRESS</i>]
<div>&#x00A0;</div>
[ <b>--comment&#x00A0;</b><b></b><i>TEXT</i> |
  <b>-c&#x00A0;</b><b></b><i>TEXT</i>]
<div>&#x00A0;</div>
[ <b>--expire&#x00A0;</b><b></b><i>TIME</i> |
  <b>-x&#x00A0;</b><b></b><i>TIME</i>]
<div>&#x00A0;</div>
[ <b>--force</b> | <b>-f</b>]</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 14.00ex; text-indent: -14.00ex;"><b>mandos-keygen</b>
  { <b>--password</b> | <b>-p</b> | <b>--passfile&#x00A0;</b><b></b><i>FILE</i>
  | <b>-F</b>&#x00A0;<i>FILE</i>}
<div>&#x00A0;</div>
[ <b>--dir&#x00A0;</b><b></b><i>DIRECTORY</i> |
  <b>-d&#x00A0;</b><b></b><i>DIRECTORY</i>]
<div>&#x00A0;</div>
[ <b>--name&#x00A0;</b><b></b><i>NAME</i> | <b>-n&#x00A0;</b><b></b><i>NAME</i>]
  [ <b>--no-ssh</b> | <b>-S</b>]</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 14.00ex; text-indent: -14.00ex;"><b>mandos-keygen</b>
  { <b>--help</b> | <b>-h</b>}</div>
<div class="Pp"></div>
<div class="Pp" style="margin-left: 14.00ex; text-indent: -14.00ex;"><b>mandos-keygen</b>
  { <b>--version</b> | <b>-v</b>}</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>mandos-keygen</b> is a program to generate the OpenPGP key used by
  <b>mandos-client</b>(8mandos). The key is normally written to /etc/mandos for
  later installation into the initrd image, but this, and most other things, can
  be changed with command line options.
<div class="Pp"></div>
This program can also be used with the <b>--password</b> or <b>--passfile</b>
  options to generate a ready-made section for clients.conf (see
  <b>mandos-clients.conf</b>(5)).
<h1 class="Sh" title="Sh" id="PURPOSE"><a class="selflink" href="#PURPOSE">PURPOSE</a></h1>
The purpose of this is to enable <i>remote and unattended rebooting</i> of
  client host computer with an <i>encrypted root file system</i>. See the
  section called &#x201C;OVERVIEW&#x201D; for details.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<b>--help</b>, <b>-h</b>
<div style="margin-left: 4.00ex;">Show a help message and exit</div>
<div class="Pp"></div>
<b>--dir </b><b></b><i>DIRECTORY</i>, <b>-d </b><b></b><i>DIRECTORY</i>
<div style="margin-left: 4.00ex;">Target directory for key files. Default is
  /etc/mandos.</div>
<div class="Pp"></div>
<b>--type </b><b></b><i>TYPE</i>, <b>-t </b><b></b><i>TYPE</i>
<div style="margin-left: 4.00ex;">Key type. Default is
  &#x201C;RSA&#x201D;.</div>
<div class="Pp"></div>
<b>--length </b><b></b><i>BITS</i>, <b>-l </b><b></b><i>BITS</i>
<div style="margin-left: 4.00ex;">Key length in bits. Default is 4096.</div>
<div class="Pp"></div>
<b>--subtype </b><b></b><i>KEYTYPE</i>, <b>-s </b><b></b><i>KEYTYPE</i>
<div style="margin-left: 4.00ex;">Subkey type. Default is &#x201C;RSA&#x201D;
  (Elgamal encryption-only).</div>
<div class="Pp"></div>
<b>--sublength </b><b></b><i>BITS</i>, <b>-L </b><b></b><i>BITS</i>
<div style="margin-left: 4.00ex;">Subkey length in bits. Default is 4096.</div>
<div class="Pp"></div>
<b>--email </b><b></b><i>ADDRESS</i>, <b>-e </b><b></b><i>ADDRESS</i>
<div style="margin-left: 4.00ex;">Email address of key. Default is empty.</div>
<div class="Pp"></div>
<b>--comment </b><b></b><i>TEXT</i>, <b>-c </b><b></b><i>TEXT</i>
<div style="margin-left: 4.00ex;">Comment field for key. Default is empty.</div>
<div class="Pp"></div>
<b>--expire </b><b></b><i>TIME</i>, <b>-x </b><b></b><i>TIME</i>
<div style="margin-left: 4.00ex;">Key expire time. Default is no expiration. See
  <b>gpg</b>(1) for syntax.</div>
<div class="Pp"></div>
<b>--force</b>, <b>-f</b>
<div style="margin-left: 4.00ex;">Force overwriting old key.</div>
<div class="Pp"></div>
<b>--password</b>, <b>-p</b>
<div style="margin-left: 4.00ex;">Prompt for a password and encrypt it with the
  key already present in either /etc/mandos or the directory specified with the
  <b>--dir</b> option. Outputs, on standard output, a section suitable for
  inclusion in <b>mandos-clients.conf</b>(8). The host name or the name
  specified with the <b>--name</b> option is used for the section header. All
  other options are ignored, and no key is created.</div>
<div class="Pp"></div>
<b>--passfile </b><b></b><i>FILE</i>, <b>-F </b><b></b><i>FILE</i>
<div style="margin-left: 4.00ex;">The same as <b>--password</b>, but read from
  <i>FILE</i>, not the terminal.</div>
<div class="Pp"></div>
<b>--no-ssh</b>, <b>-S</b>
<div style="margin-left: 4.00ex;">When <b>--password</b> or <b>--passfile</b> is
  given, this option will prevent <b>mandos-keygen</b> from calling
  <b>ssh-keyscan</b> to get an SSH fingerprint for this host and, if successful,
  output suitable config options to use this fingerprint as a <b>checker</b>
  option in the output. This is otherwise the default behavior.</div>
<h1 class="Sh" title="Sh" id="OVERVIEW"><a class="selflink" href="#OVERVIEW">OVERVIEW</a></h1>
This is part of the Mandos system for allowing computers to have encrypted root
  file systems and at the same time be capable of remote and/or unattended
  reboots. The computers run a small client program in the initial RAM disk
  environment which will communicate with a server over a network. All network
  communication is encrypted using TLS. The clients are identified by the server
  using an OpenPGP key; each client has one unique to it. The server sends the
  clients an encrypted password. The encrypted password is decrypted by the
  clients using the same OpenPGP key, and the password is then used to unlock
  the root file system, whereupon the computers can continue booting normally.
<div class="Pp"></div>
This program is a small utility to generate new OpenPGP keys for new Mandos
  clients, and to generate sections for inclusion in clients.conf on the server.
<h1 class="Sh" title="Sh" id="EXIT_STATUS"><a class="selflink" href="#EXIT_STATUS">EXIT
  STATUS</a></h1>
The exit status will be 0 if a new key (or password, if the <b>--password</b>
  option was used) was successfully created, otherwise not.
<h1 class="Sh" title="Sh" id="ENVIRONMENT"><a class="selflink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
<b>TMPDIR</b>
<div style="margin-left: 4.00ex;">If set, temporary files will be created here.
  See <b>mktemp</b>(1).</div>
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
Use the <b>--dir</b> option to change where <b>mandos-keygen</b> will write the
  key files. The default file names are shown here.
<div class="Pp"></div>
/etc/mandos/seckey.txt
<div style="margin-left: 4.00ex;">OpenPGP secret key file which will be created
  or overwritten.</div>
<div class="Pp"></div>
/etc/mandos/pubkey.txt
<div style="margin-left: 4.00ex;">OpenPGP public key file which will be created
  or overwritten.</div>
<div class="Pp"></div>
/tmp
<div style="margin-left: 4.00ex;">Temporary files will be written here if
  <i>TMPDIR</i> is not set.</div>
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Please report bugs to the Mandos development mailing list:
  &lt;mandos-dev@recompile.se&gt; (subscription required). Note that this list
  is public. The developers can be reached privately at
  &lt;mandos@recompile.se&gt; (OpenPGP key fingerprint 153A 37F1 0BBA 0435 987F
  2C4A 7223 2973 CA34 C2C4 for encrypted mail).
<h1 class="Sh" title="Sh" id="EXAMPLE"><a class="selflink" href="#EXAMPLE">EXAMPLE</a></h1>
Normal invocation needs no options:
<div class="Pp"></div>
<b>mandos-keygen</b>
<div class="Pp"></div>
Create key in another directory and of another type. Force overwriting old key
  files:
<div class="Pp"></div>
<b>mandos-keygen --dir ~/keydir --type RSA --force</b>
<div class="Pp"></div>
Prompt for a password, encrypt it with the key in /etc/mandos and output a
  section suitable for clients.conf.
<div class="Pp"></div>
<b>mandos-keygen --password</b>
<div class="Pp"></div>
Prompt for a password, encrypt it with the key in the client-key directory and
  output a section suitable for clients.conf.
<div class="Pp"></div>
<b>mandos-keygen --password --dir client-key</b>
<h1 class="Sh" title="Sh" id="SECURITY"><a class="selflink" href="#SECURITY">SECURITY</a></h1>
The <b>--type</b>, <b>--length</b>, <b>--subtype</b>, and <b>--sublength</b>
  options can be used to create keys of low security. If in doubt, leave them to
  the default values.
<div class="Pp"></div>
The key expire time is <i>not</i> guaranteed to be honored by <b>mandos</b>(8).
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>intro</b>(8mandos), <b>gpg</b>(1), <b>mandos-clients.conf</b>(5),
  <b>mandos</b>(8), <b>mandos-client</b>(8mandos), <b>ssh-keyscan</b>(1)
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
Copyright &#x00A9; 2008-2016 Teddy Hogeborn, Bj&#x00F6;rn P&#x00E5;hlsson
<div>&#x00A0;</div>
<div class="Pp"></div>
This manual page is free software: you can redistribute it and/or modify it
  under the terms of the GNU General Public License as published by the Free
  Software Foundation, either version 3 of the License, or (at your option) any
  later version.
<div class="Pp"></div>
This manual page is distributed in the hope that it will be useful, but WITHOUT
  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
  FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
<div class="Pp"></div>
You should have received a copy of the GNU General Public License along with
  this program. If not, see <b>http://www.gnu.org/licenses/</b>.
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2016-03-05</td>
    <td class="foot-os">Mandos 1.7.14</td>
  </tr>
</table>
</body>
</html>
