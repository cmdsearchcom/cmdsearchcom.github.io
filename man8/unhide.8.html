<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:17:12 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>UNHIDE(8) System Manager&rsquo;s Manual UNHIDE(8)</p>

<p style="margin-top: 1em">NAME <br>
unhide &acirc; forensic tool to find hidden processes</p>

<p style="margin-top: 1em">SYNOPSIS <br>
unhide [OPTIONS] TEST_LIST <br>
unhide-posix proc | sys</p>

<p style="margin-top: 1em">DESCRIPTION <br>
unhide is a forensic tool to find processes hidden by
rootkits, Linux kernel modules or by other techniques. It
detects hidden processes using six techniques.</p>

<p style="margin-top: 1em">OPTIONS <br>
Options are only available for unhide-linux not for
unhide-posix.</p>

<p style="margin-top: 1em">-d Do a double check in brute
test to avoid false positive.</p>

<p style="margin-top: 1em">-f Write a log file
(unhide-linux.log) in the current directory.</p>

<p style="margin-top: 1em">-h Display help</p>

<p style="margin-top: 1em">-m Do more checks. As of
2012-03-17 version, this option has only effect for the
procfs, procall, checkopendir and checkchdir tests. <br>
Implies -v</p>

<p style="margin-top: 1em">-r Use alternate version of
sysinfo check in standard tests</p>

<p style="margin-top: 1em">-V Show version and exit</p>

<p style="margin-top: 1em">-v Be verbose, display warning
message (default : don&rsquo;t display). This option may be
repeated more than once.</p>

<p style="margin-top: 1em">TEST_LIST <br>
The checks to do consist of one or more of the following
tests. <br>
The standard tests are the aggregation of one or more
elementary test(s).</p>

<p style="margin-top: 1em">Standard tests :</p>

<p style="margin-top: 1em">The brute technique consists of
bruteforcing the all process IDs. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The proc technique consists of
comparing /proc with the output of /bin/ps.</p>

<p style="margin-top: 1em">The procall technique combinates
proc and procfs tests. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The procfs technique consists of
comparing information gathered from /bin/ps with information
gathered by walking in the procfs. <br>
With -m option, this test makes more checks, see checkchdir
test. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The quick technique combines the
proc, procfs and sys techniques in a quick way. It&rsquo;s
about 20 times faster but may give more false positives.
<br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The reverse technique consists
of verifying that all threads seen by ps are also seen in
procfs and by system calls. It is intended to verify that a
rootkit has not killed a <br>
security tool (IDS or other) and make ps showing a fake
process instead. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The sys technique consists of
comparing information gathered from /bin/ps with information
gathered from system calls.</p>

<p style="margin-top: 1em">Elementary tests :</p>

<p style="margin-top: 1em">The checkbrute technique
consists of bruteforcing the all process IDs. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The checkchdir technique
consists of comparing information gathered from /bin/ps with
information gathered by making chdir() in the procfs. <br>
With the -m option, it also verify that the thread appears
in its &quot;leader process&quot; threads list. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The checkgetaffinity technique
consists of comparing information gathered from /bin/ps with
the result of call to the sched_getaffinity() system
function. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The checkgetparam technique
consists of comparing information gathered from /bin/ps with
the result of call to the sched_getparam() system function.
<br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The checkgetpgid technique
consists of comparing information gathered from /bin/ps with
the result of call to the getpgid() system function. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The checkgetprio technique
consists of comparing information gathered from /bin/ps with
the result of call to the getpriority() system function.
<br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The checkRRgetinterval technique
consists of comparing information gathered from /bin/ps with
the result of call to the sched_rr_get_interval() system
function. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The checkgetsched technique
consists of comparing information gathered from /bin/ps with
the result of call to the sched_getscheduler() system
function. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The checkgetsid technique
consists of comparing information gathered from /bin/ps with
the result of call to the getsid() system function. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The checkkill technique consists
of comparing information gathered from /bin/ps with the
result of call to the kill() system function. <br>
Note : no process is really killed by this test. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The checknoprocps technique
consists of comparing the result of the call to each of the
system functions. No comparison is done against /proc or the
output of ps. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The checkopendir technique
consists of comparing information gathered from /bin/ps with
information gathered by making opendir() in the procfs. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The checkproc technique consists
of comparing /proc with the output of /bin/ps. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The checkquick technique
combines the proc, procfs and sys techniques in a quick way.
It&rsquo;s about 20 times faster but may give more false
positives. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The checkreaddir technique
consists of comparing information gathered from /bin/ps with
information gathered by making readdir() in /proc and
/proc/pid/task. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The checkreverse technique
consists of verifying that all threads seen by ps are also
seen in procfs and by system calls. It is intended to verify
that a rootkit has not killed a <br>
security tool (IDS or other) and make ps showing a fake
process instead. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The checksysinfo technique
consists of comparing the number of process seen by /bin/ps
with information obtained from sysinfo() system call. <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">The checksysinfo2 technique is
an alternate version of checksysinfo test. It might (or not)
work better on kernel patched for RT, preempt or latency and
with kernel that don&rsquo;t <br>
use the standard scheduler. <br>
It&rsquo;s also invoked by standard tests when using the -r
option <br>
This technique is only available with version
unhide-linux.</p>

<p style="margin-top: 1em">Exit status: <br>
0 if OK,</p>

<p style="margin-top: 1em">1 if a hidden or fake thread is
found.</p>

<p style="margin-top: 1em">EXAMPLES <br>
Quicker test: <br>
unhide quick</p>

<p style="margin-top: 1em">Quick test: <br>
unhide quick reverse</p>

<p style="margin-top: 1em">Standard test: <br>
unhide sys proc</p>

<p style="margin-top: 1em">Deeper test: <br>
unhide -m -d sys procall brute reverse</p>

<p style="margin-top: 1em">BUGS <br>
Report unhide bugs on the bug tracker on sourceforge
(http://sourceforge.net/projects/unhide/) <br>
With recent versions of Linux kernel (&gt; 2.6.33), the
sysinfo test may report false positives. It may be due to
optimization in the scheduler, the use of cgroup or even the
use <br>
of systemd. The use of the PREEMPT-RT patch amplifies the
occurence of the problem. This is currently under
investigation.</p>

<p style="margin-top: 1em">SEE ALSO <br>
unhide-tcp (8).</p>

<p style="margin-top: 1em">AUTHOR <br>
This manual page was written by Francois Marier
francois@debian.org and Patrick Gouin. Permission is granted
to copy, distribute and/or modify this document under the
terms of <br>
the GNU General Public License, Version 3 or any later
version published by the Free Software Foundation.</p>

<p style="margin-top: 1em">LICENSE <br>
License GPLv3+: GNU GPL version 3 or later
&lt;http://gnu.org/licenses/gpl.html&gt;. <br>
This is free software: you are free to change and
redistribute it. There is NO WARRANTY, to the extent
permitted by law.</p>

<p style="margin-top: 1em">Administration commands March
2012 UNHIDE(8)</p>
<hr>
</body>
</html>
