<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>UNHIDE(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">UNHIDE(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">UNHIDE(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
unhide &#x2014; forensic tool to find hidden processes
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>unhide</b> [<i>OPTIONS</i>] <i>TEST_LIST</i>
<div>&#x00A0;</div>
<b>unhide-posix</b> <i>proc | sys</i>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>unhide</b> is a forensic tool to find processes hidden by rootkits, Linux
  kernel modules or by other techniques. It detects hidden processes using six
  techniques.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
Options are only available for <b>unhide-linux</b> not for <b>unhide-posix</b>.
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d</b></dt>
  <dd class="It-tag">Do a double check in brute test to avoid false
    positive.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b></dt>
  <dd class="It-tag">Write a log file (unhide-linux.log) in the current
      directory.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h</b></dt>
  <dd class="It-tag">Display help</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-m</b></dt>
  <dd class="It-tag">Do more checks. As of 2012-03-17 version, this option has
      only effect for the procfs, procall, checkopendir and checkchdir tests.
    <div>&#x00A0;</div>
    Implies -v</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-r</b></dt>
  <dd class="It-tag">Use alternate version of sysinfo check in standard
    tests</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-V</b></dt>
  <dd class="It-tag">Show version and exit</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v</b></dt>
  <dd class="It-tag">Be verbose, display warning message (default : don't
      display). This option may be repeated more than once.</dd>
</dl>
<h1 class="Sh" title="Sh" id="TEST_LIST"><a class="selflink" href="#TEST_LIST">TEST_LIST</a></h1>
The checks to do consist of one or more of the following tests.
<div>&#x00A0;</div>
The standard tests are the aggregation of one or more elementary test(s).
<div class="Pp"></div>
<b>Standard tests :</b>
<div class="Pp"></div>
The <i>brute</i> technique consists of bruteforcing the all process IDs.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>proc</i> technique consists of comparing /proc with the output of
  /bin/ps.
<div class="Pp"></div>
The <i>procall</i> technique combinates proc and procfs tests.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>procfs</i> technique consists of comparing information gathered from
  /bin/ps with information gathered by walking in the procfs.
<div>&#x00A0;</div>
With <b>-m</b> option, this test makes more checks, see <i>checkchdir</i> test.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>quick</i> technique combines the proc, procfs and sys techniques in a
  quick way. It's about 20 times faster but may give more false positives.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>reverse</i> technique consists of verifying that all threads seen by ps
  are also seen in procfs and by system calls. It is intended to verify that a
  rootkit has not killed a security tool (IDS or other) and make ps showing a
  fake process instead.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>sys</i> technique consists of comparing information gathered from /bin/ps
  with information gathered from system calls.
<div class="Pp"></div>
<b>Elementary tests :</b>
<div class="Pp"></div>
The <i>checkbrute</i> technique consists of bruteforcing the all process IDs.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>checkchdir</i> technique consists of comparing information gathered from
  /bin/ps with information gathered by making chdir() in the procfs.
<div>&#x00A0;</div>
With the <b>-m</b> option, it also verify that the thread appears in its
  &quot;leader process&quot; threads list.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>checkgetaffinity</i> technique consists of comparing information gathered
  from /bin/ps with the result of call to the sched_getaffinity() system
  function.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>checkgetparam</i> technique consists of comparing information gathered
  from /bin/ps with the result of call to the sched_getparam() system function.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>checkgetpgid</i> technique consists of comparing information gathered
  from /bin/ps with the result of call to the getpgid() system function.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>checkgetprio</i> technique consists of comparing information gathered
  from /bin/ps with the result of call to the getpriority() system function.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>checkRRgetinterval</i> technique consists of comparing information
  gathered from /bin/ps with the result of call to the sched_rr_get_interval()
  system function.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>checkgetsched</i> technique consists of comparing information gathered
  from /bin/ps with the result of call to the sched_getscheduler() system
  function.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>checkgetsid</i> technique consists of comparing information gathered from
  /bin/ps with the result of call to the getsid() system function.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>checkkill</i> technique consists of comparing information gathered from
  /bin/ps with the result of call to the kill() system function.
<div>&#x00A0;</div>
Note : no process is really killed by this test.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>checknoprocps</i> technique consists of comparing the result of the call
  to each of the system functions. No comparison is done against /proc or the
  output of ps.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>checkopendir</i> technique consists of comparing information gathered
  from /bin/ps with information gathered by making opendir() in the procfs.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>checkproc</i> technique consists of comparing /proc with the output of
  /bin/ps.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>checkquick</i> technique combines the proc, procfs and sys techniques in
  a quick way. It's about 20 times faster but may give more false positives.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>checkreaddir</i> technique consists of comparing information gathered
  from /bin/ps with information gathered by making readdir() in /proc and
  /proc/pid/task.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>checkreverse</i> technique consists of verifying that all threads seen by
  ps are also seen in procfs and by system calls. It is intended to verify that
  a rootkit has not killed a security tool (IDS or other) and make ps showing a
  fake process instead.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>checksysinfo</i> technique consists of comparing the number of process
  seen by /bin/ps with information obtained from sysinfo() system call.
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<div class="Pp"></div>
The <i>checksysinfo2</i> technique is an alternate version of checksysinfo test.
  It might (or not) work better on kernel patched for RT, preempt or latency and
  with kernel that don't use the standard scheduler.
<div>&#x00A0;</div>
It's also invoked by standard tests when using the <b>-r</b> option
<div>&#x00A0;</div>
This technique is only available with version unhide-linux.
<h2 class="Ss" title="Ss" id="Exit_status:"><a class="selflink" href="#Exit_status:">Exit
  status:</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag">0</dt>
  <dd class="It-tag">if OK,</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">1</dt>
  <dd class="It-tag">if a hidden or fake thread is found.</dd>
</dl>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag">Quicker test:</dt>
  <dd class="It-tag">unhide quick</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Quick test:</dt>
  <dd class="It-tag">unhide quick reverse</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Standard test:</dt>
  <dd class="It-tag">unhide sys proc</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Deeper test:</dt>
  <dd class="It-tag">unhide -m -d sys procall brute reverse</dd>
</dl>
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Report <b>unhide</b> bugs on the bug tracker on sourceforge
  (http://sourceforge.net/projects/unhide/)
<div>&#x00A0;</div>
With recent versions of Linux kernel (&gt; 2.6.33), the sysinfo test may report
  false positives. It may be due to optimization in the scheduler, the use of
  cgroup or even the use of systemd. The use of the PREEMPT-RT patch amplifies
  the occurence of the problem. This is currently under investigation.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
unhide-tcp (8).
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
This manual page was written by Francois Marier francois@debian.org and Patrick
  Gouin. Permission is granted to copy, distribute and/or modify this document
  under the terms of the GNU General Public License, Version 3 or any later
  version published by the Free Software Foundation.
<h1 class="Sh" title="Sh" id="LICENSE"><a class="selflink" href="#LICENSE">LICENSE</a></h1>
License GPLv3+: GNU GPL version 3 or later
  &lt;http://gnu.org/licenses/gpl.html&gt;.
<div>&#x00A0;</div>
This is free software: you are free to change and redistribute it. There is NO
  WARRANTY, to the extent permitted by law.</div>
<table class="foot">
  <tr>
    <td class="foot-date">March 2012</td>
    <td class="foot-os">Administration commands</td>
  </tr>
</table>
</body>
</html>
