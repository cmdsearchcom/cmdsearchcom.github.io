<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>DEVLINK-SB(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DEVLINK-SB(8)</td>
    <td class="head-vol">Linux</td>
    <td class="head-rtitle">DEVLINK-SB(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
devlink-sb - devlink shared buffer configuration
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<br/>
<b>devlink</b> [ <i>OPTIONS</i> ] <b>sb</b> { <i>COMMAND</i> | <b>help</b> }
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<i>OPTIONS</i> := { <b>-V</b>[<i>ersion</i>] | <b>-n</b>[<i>no-nice-names</i>] }
<div style="height: 1.00em;">&#x00A0;</div>
<b>devlink sb show </b> [ <i>DEV</i> [ <b>sb</b> <i>SB_INDEX</i> ] ]
<div style="height: 1.00em;">&#x00A0;</div>
<b>devlink sb pool show </b> [ <i>DEV</i> [ <b>sb</b> <i>SB_INDEX</i> ]
<div>&#x00A0;</div>
<b>pool</b> <i>POOL_INDEX</i> ]
<div style="height: 1.00em;">&#x00A0;</div>
<b>devlink sb pool set </b><i>DEV</i><b></b> [ <b>sb</b> <i>SB_INDEX</i> ]
<div>&#x00A0;</div>
<b>pool</b><i> POOL_INDEX </i>
<div>&#x00A0;</div>
<b>size</b><i> POOL_SIZE </i>
<div>&#x00A0;</div>
<b>thtype</b> { <b>static</b> | <b>dynamic</b> }
<div style="height: 1.00em;">&#x00A0;</div>
<b>devlink sb port pool show </b> [ <i>DEV/PORT_INDEX</i> [ <b>sb</b>
  <i>SB_INDEX</i> ]
<div>&#x00A0;</div>
<b>pool</b> <i>POOL_INDEX</i> ]
<div style="height: 1.00em;">&#x00A0;</div>
<b>devlink sb port pool set </b><i>DEV/PORT_INDEX</i><b></b> [ <b>sb</b>
  <i>SB_INDEX</i> ]
<div>&#x00A0;</div>
<b>pool</b><i> POOL_INDEX </i>
<div>&#x00A0;</div>
<b>th</b><i> THRESHOLD </i>
<div style="height: 1.00em;">&#x00A0;</div>
<b>devlink sb tc bind show </b> [ <i>DEV/PORT_INDEX</i> [ <b>sb</b>
  <i>SB_INDEX</i> ]
<div>&#x00A0;</div>
<b>tc</b><i> TC_INDEX </i>
<div>&#x00A0;</div>
<b>type</b> { <b>ingress</b> | <b>egress</b> } ]
<div style="height: 1.00em;">&#x00A0;</div>
<b>devlink sb tc bind set </b><i>DEV/PORT_INDEX</i><b></b> [ <b>sb</b>
  <i>SB_INDEX</i> ]
<div>&#x00A0;</div>
<b>tc</b><i> TC_INDEX </i>
<div>&#x00A0;</div>
<b>type</b> { <b>ingress</b> | <b>egress</b> }
<div>&#x00A0;</div>
<b>pool</b><i> POOL_INDEX </i>
<div>&#x00A0;</div>
<b>th</b><i> THRESHOLD </i>
<div style="height: 1.00em;">&#x00A0;</div>
<b>devlink sb occupancy show </b> { <i>DEV</i> | <i>DEV/PORT_INDEX</i> } [
  <b>sb</b> <i>SB_INDEX</i> ]
<div style="height: 1.00em;">&#x00A0;</div>
<b>devlink sb occupancy snapshot </b> <i>DEV</i> [ <b>sb</b> <i>SB_INDEX</i> ]
<div style="height: 1.00em;">&#x00A0;</div>
<b>devlink sb occupancy clearmax </b> <i>DEV</i> [ <b>sb</b> <i>SB_INDEX</i> ]
<div style="height: 1.00em;">&#x00A0;</div>
<b>devlink sb help</b>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<h2 class="Ss" title="Ss" id="devlink_sb_show_-_display_available_shared_buffers_and_their_attributes"><a class="selflink" href="#devlink_sb_show_-_display_available_shared_buffers_and_their_attributes">devlink
  sb show - display available shared buffers and their attributes</a></h2>
<i>DEV</i> - specifies the devlink device to show shared buffers. If this
  argument is omitted all shared buffers of all devices are listed.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<i>SB_INDEX</i> - specifies the shared buffer. If this argument is omitted
  shared buffer with index 0 is selected. Behaviour of this argument it the same
  for every command.
<div style="height: 1.00em;">&#x00A0;</div>
<h2 class="Ss" title="Ss" id="devlink_sb_pool_show_-_display_available_pools_and_their_attributes"><a class="selflink" href="#devlink_sb_pool_show_-_display_available_pools_and_their_attributes">devlink
  sb pool show - display available pools and their attributes</a></h2>
<i>DEV</i> - specifies the devlink device to show pools. If this argument is
  omitted all pools of all devices are listed.
<div style="height: 1.00em;">&#x00A0;</div>
<h2 class="Ss" title="Ss" id="devlink_sb_pool_set_-_set_attributes_of_pool"><a class="selflink" href="#devlink_sb_pool_set_-_set_attributes_of_pool">devlink
  sb pool set - set attributes of pool</a></h2>
<i>DEV</i> - specifies the devlink device to set pool.
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>size</b><i> POOL_SIZE</i></dt>
  <dd class="It-tag">size of the pool in Bytes.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>thtype</b> { <b>static</b> | <b>dynamic</b> } </dt>
  <dd class="It-tag">pool threshold type.
    <div style="height: 1.00em;">&#x00A0;</div>
    <i>static</i> - Threshold values for the pool will be passed in Bytes.
    <div style="height: 1.00em;">&#x00A0;</div>
    <i>dynamic</i> - Threshold values (&quot;to_alpha&quot;) for the pool will
      be used to compute alpha parameter according to formula:
    <div>&#x00A0;</div>
    <br/>
    alpha = 2 ^ (to_alpha - 10)
    <br/>
    <div style="height: 1.00em;">&#x00A0;</div>
    <br/>
    The range of the passed value is between 0 to 20. The computed alpha is used
      to determine the maximum usage of the flow:
    <br/>
    <div>&#x00A0;</div>
    <br/>
    max_usage = alpha / (1 + alpha) * Free_Buffer
    <br/>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h2 class="Ss" title="Ss" id="devlink_sb_port_pool_show_-_display_port-pool_combinations_and_threshold_for_each"><a class="selflink" href="#devlink_sb_port_pool_show_-_display_port-pool_combinations_and_threshold_for_each">devlink
  sb port pool show - display port-pool combinations and threshold for
  each</a></h2>
<i>DEV/PORT_INDEX</i> - specifies the devlink port.
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>pool</b><i> POOL_INDEX</i></dt>
  <dd class="It-tag">pool index.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h2 class="Ss" title="Ss" id="devlink_sb_port_pool_set_-_set_port-pool_threshold"><a class="selflink" href="#devlink_sb_port_pool_set_-_set_port-pool_threshold">devlink
  sb port pool set - set port-pool threshold</a></h2>
<i>DEV/PORT_INDEX</i> - specifies the devlink port.
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>pool</b><i> POOL_INDEX</i></dt>
  <dd class="It-tag">pool index.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>th</b><i> THRESHOLD</i></dt>
  <dd class="It-tag">threshold value. Type of the value is either Bytes or
      &quot;to_alpha&quot;, depends on <b>thtype</b> set for the pool.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h2 class="Ss" title="Ss" id="devlink_sb_tc_bind_show_-_display_port-TC_to_pool_bindings_and_threshold_for_each"><a class="selflink" href="#devlink_sb_tc_bind_show_-_display_port-TC_to_pool_bindings_and_threshold_for_each">devlink
  sb tc bind show - display port-TC to pool bindings and threshold for
  each</a></h2>
<i>DEV/PORT_INDEX</i> - specifies the devlink port.
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>tc</b><i> TC_INDEX</i></dt>
  <dd class="It-tag">index of either ingress or egress TC, usually in range 0 to
      8 (depends on device).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>type</b> { <b>ingress</b> | <b>egress</b> } </dt>
  <dd class="It-tag">TC type.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h2 class="Ss" title="Ss" id="devlink_sb_tc_bind_set_-_set_port-TC_to_pool_binding_with_specified_threshold"><a class="selflink" href="#devlink_sb_tc_bind_set_-_set_port-TC_to_pool_binding_with_specified_threshold">devlink
  sb tc bind set - set port-TC to pool binding with specified threshold</a></h2>
<i>DEV/PORT_INDEX</i> - specifies the devlink port.
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>tc</b><i> TC_INDEX</i></dt>
  <dd class="It-tag">index of either ingress or egress TC, usually in range 0 to
      8 (depends on device).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>type</b> { <b>ingress</b> | <b>egress</b> } </dt>
  <dd class="It-tag">TC type.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>pool</b><i> POOL_INDEX</i></dt>
  <dd class="It-tag">index of pool to bind this to.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>th</b><i> THRESHOLD</i></dt>
  <dd class="It-tag">threshold value. Type of the value is either Bytes or
      &quot;to_alpha&quot;, depends on <b>thtype</b> set for the pool.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h2 class="Ss" title="Ss" id="devlink_sb_occupancy_show_-_display_shared_buffer_occupancy_values_for_device_or_port"><a class="selflink" href="#devlink_sb_occupancy_show_-_display_shared_buffer_occupancy_values_for_device_or_port">devlink
  sb occupancy show - display shared buffer occupancy values for device or
  port</a></h2>
This command is used to browse shared buffer occupancy values. Values are showed
  for every port-pool combination as well as for all port-TC combinations (with
  pool this port-TC is bound to). Format of value is:
<div>&#x00A0;</div>
<br/>
current_value/max_value
<br/>
Note that before showing values, one has to issue command first.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<i>DEV</i> - specifies the devlink device to show occupancy values for.
<div style="height: 1.00em;">&#x00A0;</div>
<i>DEV/PORT_INDEX</i> - specifies the devlink port to show occupancy values for.
<div style="height: 1.00em;">&#x00A0;</div>
<h2 class="Ss" title="Ss" id="devlink_sb_occupancy_snapshot_-_take_occupancy_snapshot_of_shared_buffer_for_device"><a class="selflink" href="#devlink_sb_occupancy_snapshot_-_take_occupancy_snapshot_of_shared_buffer_for_device">devlink
  sb occupancy snapshot - take occupancy snapshot of shared buffer for
  device</a></h2>
This command is used to take a snapshot of shared buffer occupancy values. After
  that, the values can be showed using <b>occupancy show</b> command.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<i>DEV</i> - specifies the devlink device to take occupancy snapshot on.
<div style="height: 1.00em;">&#x00A0;</div>
<h2 class="Ss" title="Ss" id="devlink_sb_occupancy_clearmax_-_clear_occupancy_watermarks_of_shared_buffer_for_device"><a class="selflink" href="#devlink_sb_occupancy_clearmax_-_clear_occupancy_watermarks_of_shared_buffer_for_device">devlink
  sb occupancy clearmax - clear occupancy watermarks of shared buffer for
  device</a></h2>
This command is used to reset maximal occupancy values reached for whole device.
  Note that before browsing reset values, one has to issue <b>occupancy
  snapshot</b> command.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<i>DEV</i> - specifies the devlink device to clear occupancy watermarks on.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
devlink sb show
<div style="margin-left: 4.00ex;">List available share buffers.</div>
<div class="Pp"></div>
devlink sb pool show
<div style="margin-left: 4.00ex;">List available pools and their config.</div>
<div class="Pp"></div>
devlink sb port pool show pci/0000:03:00.0/1 pool 0
<div style="margin-left: 4.00ex;">Show port-pool setup for specified port and
  pool.</div>
<div class="Pp"></div>
sudo devlink sb port pool set pci/0000:03:00.0/1 pool 0 th 15
<div style="margin-left: 4.00ex;">Change threshold for port specified port and
  pool.</div>
<div class="Pp"></div>
devlink sb tc bind show pci/0000:03:00.0/1 tc 0 type ingress
<div style="margin-left: 4.00ex;">Show pool binding and threshold for specified
  port and TC.</div>
<div class="Pp"></div>
sudo devlink sb tc bind set pci/0000:03:00.0/1 tc 0 type ingress pool 0 th 9
<div style="margin-left: 4.00ex;">Set pool binding and threshold for specified
  port and TC.</div>
<div class="Pp"></div>
sudo devlink sb occupancy snapshot pci/0000:03:00.0
<div style="margin-left: 4.00ex;">Make a snapshot of occupancy of shared buffer
  for specified devlink device.</div>
<div class="Pp"></div>
devlink sb occupancy show pci/0000:03:00.0/1
<div style="margin-left: 4.00ex;">Show occupancy for specified port from the
  snapshot.</div>
<div class="Pp"></div>
sudo devlink sb occupancy clearmax pci/0000:03:00.0
<div style="margin-left: 4.00ex;">Clear watermarks for shared buffer of
  specified devlink device.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>devlink</b>(8), <b>devlink-dev</b>(8), <b>devlink-port</b>(8),
  <b>devlink-monitor</b>(8),
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Jiri Pirko &lt;jiri@mellanox.com&gt;</div>
<table class="foot">
  <tr>
    <td class="foot-date">14 Apr 2016</td>
    <td class="foot-os">iproute2</td>
  </tr>
</table>
</body>
</html>
