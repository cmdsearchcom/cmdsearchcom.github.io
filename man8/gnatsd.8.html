<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>gnatsd(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">gnatsd(8)</td>
    <td class="head-vol">GNATS Admininstration Utilities</td>
    <td class="head-rtitle">gnatsd(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
gnatsd - GNATS network server
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>gnatsd</b></dt>
  <dd class="It-tag">[<b>--database</b>&#x00A0;<i>database</i>&#x00A0;|&#x00A0;<b>-d</b>&#x00A0;<i>database</i>]
      [ <b>--not-inetd</b>&#x00A0;|&#x00A0;<b>-n</b>] [
      <b>--max-access-level</b>&#x00A0;
      <i>level</i>&#x00A0;|&#x00A0;<b>-m</b>&#x00A0; <i>level</i>] [
      <b>--version</b>&#x00A0;|&#x00A0; <b>-V</b>] [
      <b>--help</b>&#x00A0;|&#x00A0; <b>-h</b>]</dd>
</dl>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>gnatsd</b> is used to service remote GNATS requests such as querying
  <i>PR</i>s, <i>PR</i> creation, deletion, and editing, and miscellaneous
  database queries. It uses a simple ASCII-based command protocol (similar to
  SMTP or POP3) for communicating with remote clients.
<div class="Pp"></div>
It also provides a security model based either on IP-based authentication
  (generally a <b>terrible</b> idea) or username/passwords. Passwords may be
  encrypted using UNIX crypt() or MD5 (for operating systems that support it).
  Plaintext passwords are also supported but strongly discouraged.
<div class="Pp"></div>
All of the GNATS clients are capable of communicating via the GNATS remote
  protocol to perform their functions.
<div class="Pp"></div>
<b>gnatsd</b> should be run by the GNATS user (by default <b>gnats</b>), and it
  is usually started from <i>inetd</i>(8).
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-V,<b> --version</b></b></dt>
  <dd class="It-tag">Prints the program version to stdout and exits.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h,<b> --help</b></b></dt>
  <dd class="It-tag">Prints a short help text to stdout and exits.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d,<b> --database</b></b></dt>
  <dd class="It-tag">Specifies the default database which is to be serviced by
      this invocation of <b>gnatsd</b>. (The selected database may be changed
      via the <b>CHDB</b> command; this is simply the default if no <b>CHDB</b>
      command is issued.) If no database is specified, the database named
      <i>default</i> is assumed. This option overrides the database specified in
      the <b>GNATSDB</b> environment variable.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--not-inetd</b>,&#x00A0;<b>-n</b></dt>
  <dd class="It-tag">As its name suggests, indicates that <b>gnatsd</b> is not
      being invoked from <i>inetd</i>. This can be used when testing
      <b>gnatsd</b>, or if it being run via <i>ssh</i> or some other
    mechanism.</dd>
</dl>
<div class="Pp"></div>
<div style="margin-left: 0.50in;">This has the effect of using the local
  hostname where <b>gnatsd</b> is being invoked for authentication purposes,
  rather than the remote address of the connecting client.</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--max-access-level</b>,&#x00A0;<b>-m</b></dt>
  <dd class="It-tag">Specifies the maximum access level that the connecting
      client can authenticate to. Authentication is as normal but if the user or
      host authenticates at a higher level, access level is set to this
    level.</dd>
</dl>
<h1 class="Sh" title="Sh" id="COMMAND_PROTOCOL"><a class="selflink" href="#COMMAND_PROTOCOL">COMMAND
  PROTOCOL</a></h1>
Commands are issued to <b>gnatsd</b> as one or more words followed by a
  carriage-return/linefeed pair. For example, the <b>CHDB</b> (change databases)
  command is sent as
<div style="margin-left: 5.00ex;">CHDB <i>database</i>&lt;CR&gt;&lt;LF&gt;</div>
[the CRLF will not be explicitly written for future examples]
<div class="Pp"></div>
Replies from <b>gnatsd</b> are returned as one or more <i>response line</i>s
  containing a 3-digit numeric code followed by a human-readable string; the
  line is terminated with a &lt;CR&gt;&lt;LF&gt; pair. For example, one possible
  response to the <b>CHDB</b> command above would be:
<div style="margin-left: 5.00ex;">210 Now accessing GNATS database
  'database'.</div>
<div class="Pp"></div>
The three-digit code is normally followed by a single ASCII space (character
  0x20). However, if additional response lines are to be returned from the
  server, there will be a single dash (`-') instead of the space character after
  the three-digit code.
<div class="Pp"></div>
Response code values are divided into ranges. The first digit reflects the
  general type of response (such as &quot;successful&quot; or
  &quot;error&quot;), and the subsequent digits identify the specific type of
  response.
<dl class="Bl-tag">
  <dt class="It-tag">Codes 200-299</dt>
  <dd class="It-tag">Positive response indicating that the command was
      successful. No subsequent data will be transmitted with the response. [In
      particular, code 210 ( <b>CODE_OK</b>) is used as the positive result code
      for most simple commands.]</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="Pp"></div>
Commands that expect additional data from the client (such as <b>SUBM</b> or
  <b>VFLD</b>) use a two-step mechanism for sending the data. The server will
  respond to the initial command with either a 211 ( <b>CODE_SEND_PR</b>) or 212
  ( <b>CODE_SEND_TEXT</b>) response line, or an error code if an error occurred
  with the initial command. The client is then expected to send the remaining
  data using the same quoting mechanism as described for server responses in the
  300-349 range. The server will then send a final response line to the
  command.</div>
<dl class="Bl-tag">
  <dt class="It-tag">Codes 300-399</dt>
  <dd class="It-tag">Positive response indicating that the query request was
      successful, and that a <i>PR</i> or other data will follow. Codes 300-349
      are used when transmitting <i>PR</i>s, and 350-399 are used for other
      responses.</dd>
</dl>
<div class="Pp"></div>
<div style="margin-left: 5.00ex;">Codes in the 300-349 range are followed by a
  series of CRLF-terminated lines containing the command response, usually a
  <i>PR</i>. The final line of the result is a single period (`.'). Result lines
  that begin with a period have an extra period prepended to them.
<div class="Pp"></div>
Codes in the 350-399 range use a different scheme for sending their responses.
  The three-digit numeric code will be followed by either a dash (`-') or a
  single space. If the code is followed by a dash, that indicates that another
  response line will follow. The final line of the response has a single space
  after the three-digit code.
<div class="Pp"></div>
In previous versions of the protocol the first line of a CODE_INFORMATION (310)
  response was to be ignored. This is no longer the case. Instead, any lines
  marked with code CODE_INFORMATION_FILLER (351) are to be ignored. This allows
  the server to transmit additional headers or other human-readable text that
  can be safely ignored by the clients.</div>
<dl class="Bl-tag">
  <dt class="It-tag">Codes 400-599</dt>
  <dd class="It-tag">An error occurred, usually because of invalid command
      parameters or invalid input from the client, missing arguments to the
      comamand, or a command was issued out of sequence. The human-readable
      message associated with the response line describes the general problem
      encountered with the command.</dd>
</dl>
<div class="Pp"></div>
<div style="margin-left: 5.00ex;">Multiple error messages may be returned from a
  command; in this case the `-' continuation character is used on all but the
  last response line.</div>
<dl class="Bl-tag">
  <dt class="It-tag">Codes 600-799</dt>
  <dd class="It-tag">An internal error occurred on the server, a timeout
      occurred reading data from the client, or a network failure occurred.
      These errors are of the &quot;this should not occur&quot; nature, and
      retrying the operation may resolve the problem. Fortunately, most GNATS
      transactions are idempotent; unfortunately, locking the database or a
      <i>PR</i> are not repeatable actions (we cannot determine if an existing
      lock is the one we originally requested, or someone else's).</dd>
</dl>
<h1 class="Sh" title="Sh" id="COMMANDS"><a class="selflink" href="#COMMANDS">COMMANDS</a></h1>
Note that the set of GNATS commands and their responses is somewhat inconsistent
  and is very much in flux. At present the GNATS clients are rather
  simple-minded and not very strict about processing responses. For example, if
  the server were to issue a code 300 ( <b>CODE_PR_READY</b>) response to a
  <b>CHDB</b> command, the client would happily expect to see a PR appear (and
  would print it out if one was sent).
<div class="Pp"></div>
It is thus suggested that any clients that use the GNATS protocol be equally
  flexible about the way received responses are handled; in particular, only the
  first digit of the response code should be assumed to be meaningful, although
  subsequent digits are needed in some cases (codes 300-399). <b>No attempt
  should be made to parse the</b> <b>message strings on error response lines;
  they are only intended to be</b> <b>read by humans, and will be changed on a
  regular basis.</b>
<div class="Pp"></div>
Almost every command may result in the response 440 ( <b>CODE_CMD_ERROR</b>).
  This indicates that there was a problem with the command arguments, usually
  because of insufficient or too many arguments being specified.
<dl class="Bl-tag">
  <dt class="It-tag"><b>USER</b> [&lt;<i>userid</i>&gt;
    [&lt;<i>password</i>&gt;]]</dt>
  <dd class="It-tag">Specifies the userid and password for database access. Both
      a username and a password may be given, only a username may be given, or
      both may be omitted; if both are omitted, the current access level is
      returned.</dd>
</dl>
<div style="margin-left: 0.50in;">
<div class="Pp"></div>
The possible server responses are:
<dl class="Bl-tag">
  <dt class="It-tag">350 (<b>CODE_INFORMATION</b>)</dt>
  <dd class="It-tag">The current access level is specified.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">422 (<b>CODE_NO_ACCESS</b>)</dt>
  <dd class="It-tag">A matching username and password could not be found.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">200 (<b>CODE_OK</b>)</dt>
  <dd class="It-tag">A matching username and password was found, and the login
      was successful.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>QUIT</b></dt>
  <dd class="It-tag">Requests that the connection be closed. Possible
    responses:</dd>
</dl>
<div style="margin-left: 0.50in;">
<dl class="Bl-tag">
  <dt class="It-tag">201 (<b>CODE_CLOSING</b>)</dt>
  <dd class="It-tag">Normal exit.</dd>
</dl>
<div class="Pp"></div>
The quit command has the dubious distinction of being the only command that
  cannot fail.</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>LIST</b> &lt;<i>list&#x00A0;type</i>&gt;</dt>
  <dd class="It-tag">Describes various aspects of the database. The lists are
      returned as a list of records, one per line. Each line may contain a
      number of colon-separated fields.</dd>
</dl>
<div class="Pp"></div>
<div style="margin-left: 0.50in;">Possible values for <i>list type</i> include
<div style="margin-left: 0.25in;">
<dl class="Bl-tag">
  <dt class="It-tag"><b>Categories</b></dt>
  <dd class="It-tag">Describes the legal categories for the database.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Submitters</b></dt>
  <dd class="It-tag">Describes the set of submitters for the database.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Responsible</b></dt>
  <dd class="It-tag">Lists the names in the responsible administrative file,
      including their full names and email addresses.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>States</b></dt>
  <dd class="It-tag">Lists the states listed in the state administrative file,
      including the state type (usually blank for most states; the closed state
      has a special type).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>FieldNames</b></dt>
  <dd class="It-tag">Lists the entire set of PR fields.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>InitialInputFields</b></dt>
  <dd class="It-tag">Lists the fields that should be present when a PR is
      initially entered.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>InitialRequiredFields</b></dt>
  <dd class="It-tag">Lists fields that have to be present and nonempty when a PR
      is initially entered (fields containing only blank characters such as
      spaces or newlines are considered empty.)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Databases</b></dt>
  <dd class="It-tag">Lists the set of databases.</dd>
</dl>
</div>
<div class="Pp"></div>
The possible responses are:
<dl class="Bl-tag">
  <dt class="It-tag">301 (<b>CODE_TEXT_READY</b>)</dt>
  <dd class="It-tag">Normal response, followed by the records making up the list
      as described above.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">416 (<b>CODE_INVALID_LIST</b>)</dt>
  <dd class="It-tag">The requested list does not exist.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>FTYP</b> &lt;<i>field</i>&gt; [&lt;<i>field</i>&gt;
    ...]</dt>
  <dd class="It-tag">Describes the type of data held in the field(s) specified
      with the command. The currently-defined data types are:</dd>
</dl>
<div style="margin-left: 0.50in;">
<dl class="Bl-tag">
  <dt class="It-tag">Text</dt>
  <dd class="It-tag">A plain text field, containing exactly one line.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">MultiText</dt>
  <dd class="It-tag">A text field possibly containing multiple lines of
    text.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Enum</dt>
  <dd class="It-tag">An enumerated data field; the value is restricted to one
      entry out of a list of values associated with the field.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">MultiEnum</dt>
  <dd class="It-tag">The field contains one or more enumerated values. Values
      are separated with spaces or colons ( <b>:</b>).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Integer</dt>
  <dd class="It-tag">The field contains an integer value, possibly signed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Date</dt>
  <dd class="It-tag">The field contains a date.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">TextWithRegex</dt>
  <dd class="It-tag">The value in the field must match one or more regular
      expressions associated with the field.</dd>
</dl>
<div class="Pp"></div>
The possible responses are:
<dl class="Bl-tag">
  <dt class="It-tag">350 (<b>CODE_INFORMATION</b>)</dt>
  <dd class="It-tag">The normal response; the supplied text is the data
    type.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">410 (<b>CODE_INVALID_FIELD_NAME</b>)</dt>
  <dd class="It-tag">The specified field does not exist.</dd>
</dl>
<div class="Pp"></div>
If multiple field names were given, multiple response lines will be sent, one
  for each field, using the standard continuation protocol; each response except
  the last will have a dash (`-') immedately after the response code.</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>FTYPINFO</b> &lt;<i>field</i>&gt;
    &lt;<i>property</i>&gt;</dt>
  <dd class="It-tag">Provides field-type-related information. Currently, only
      the property `separators' for MultiEnum fields is supported. When
      `separators' is specified, the possible return codes are:</dd>
</dl>
<div style="margin-left: 0.50in;">
<dl class="Bl-tag">
  <dt class="It-tag">350 (<b>CODE_INFORMATION</b>)</dt>
  <dd class="It-tag">A proper MultiEnum field was specified and the returned
      text is the string of separators specified for the field in the dbconfig
      file, quoted within ''.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">435 (<b>CODE_INVALID_FTYPE_PROPERTY</b>)</dt>
  <dd class="It-tag">The `separators' property is not defined for this field,
      i.e. the specified field is not of type MultiEnum.</dd>
</dl>
<div class="Pp"></div>
Currently, specifying a different property than `separators' results in return
  code 435 as above.</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>FDSC</b> &lt;<i>field</i>&gt; [&lt;<i>field</i>&gt; ...
    ]</dt>
  <dd class="It-tag">Returns a human-readable description of the listed
      field(s). The possible responses are:</dd>
</dl>
<div style="margin-left: 0.50in;">
<dl class="Bl-tag">
  <dt class="It-tag">350 (<b>CODE_INFORMATION</b>)</dt>
  <dd class="It-tag">The normal response; the supplied text is the field
      description.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">410 (<b>CODE_INVALID_FIELD_NAME</b>)</dt>
  <dd class="It-tag">The specified field does not exist.</dd>
</dl>
<div class="Pp"></div>
Like the <b>FVLD</b> command, the standard continuation protocol will be used if
  multiple fields were specified with the command.</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>FIELDFLAGS</b> &lt;<i>field</i>&gt;
    [&lt;<i>field</i>&gt; ... ]</dt>
  <dd class="It-tag">Returns a set of flags describing the specified field(s).
      The possible responses are either 410&#x00A0;(
      <b>CODE_INVALID_FIELD_NAME</b>), meaning that the specified field is
      invalid or nonexistent, or 350&#x00A0;( <b>CODE_INFORMATION</b>) which
      contains the set of flags for the field. The flags may be blank, which
      indicate that no special flags have been set for this field.</dd>
</dl>
<div style="margin-left: 0.50in;">
<div class="Pp"></div>
Like the <b>FDSC</b> and <b>FTYP</b> commands, multiple field names may be
  listed with the command, and a response line will be returned for each one in
  the order that the fields appear on the command line.
<div class="Pp"></div>
The flags include:
<dl class="Bl-tag">
  <dt class="It-tag"><i>textsearch</i></dt>
  <dd class="It-tag">The field will be searched when a text field search is
      requested.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>allowAnyValue</i></dt>
  <dd class="It-tag">For fields that contain enumerated values, any legal value
      may be used in the field, not just ones that appear in the enumerated
      list.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>requireChangeReason</i></dt>
  <dd class="It-tag">If the field is edited, a reason for the change must be
      supplied in the new <i>PR</i> text describing the reason for the change.
      The reason must be supplied as a multitext <i>PR</i> field in the new
      <i>PR</i> whose name is <i>field</i>-Changed-Why (where <i>field</i> is
      the name of the field being edited).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>readonly</i></dt>
  <dd class="It-tag">The field is read-only, and cannot be edited.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>FVLD</b> &lt;<i>field</i>&gt;</dt>
  <dd class="It-tag">Returns one or more regular expressions or strings that
      describe the valid types of data that can be placed in <i>field</i>.
      Exactly what is returned is dependent on the type of data that can be
      stored in the field. For most fields a regular expression is returned; for
      enumerated fields, the returned values are the list of legal strings that
      can be held in the field.</dd>
</dl>
<div class="Pp"></div>
<div style="margin-left: 0.50in;">The possible responses are:
<dl class="Bl-tag">
  <dt class="It-tag">301 (<b>CODE_TEXT_READY</b>)</dt>
  <dd class="It-tag">The normal response, which is followed by the list of
      regexps or strings.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">410 (<b>CODE_INVALID_FIELD_NAME</b>)</dt>
  <dd class="It-tag">The specified field does not exist.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>VFLD</b> &lt;<i>field</i>&gt;</dt>
  <dd class="It-tag"><b>VFLD</b> can be used to validate a given value for a
      field in the database. The client issues the <b>VFLD</b> command with the
      name of the field to validate as an argument. The server will either
      respond with 212 ( <b>CODE_SEND_TEXT</b>), or 410 (
      <b>CODE_INVALID_FIELD_NAME</b>) if the specified field does not
    exist.</dd>
</dl>
<div class="Pp"></div>
<div style="margin-left: 0.50in;">Once the 212 response is received from the
  server, the client should then send the line(s) of text to be validated, using
  the normal quoting mechanism described for <i>PR</i>s. The final line of text
  is followed by a line containing a single period, again as when sending
  <i>PR</i> text.
<div class="Pp"></div>
The server will then either respond with 210 ( <b>CODE_OK</b>), indicating that
  the text is acceptable, or one or more error codes describing the problems
  with the field contents.</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>INPUTDEFAULT</b> &lt;<i>field</i>&gt;
    [&lt;<i>field</i>&gt; ... ]</dt>
  <dd class="It-tag">Returns the suggested default value for a field when a
      <i>PR</i> is initially created. The possible responses are either 410(
      <b>CODE_INVALID_FIELD_NAME</b>), meaning that the specified field is
      invalid or nonexistent, or 350&#x00A0;( <b>CODE_INFORMATION</b>) which
      contains the default value for the field.</dd>
</dl>
<div style="margin-left: 0.50in;">
<div class="Pp"></div>
Like the <b>FDSC</b> and <b>FTYP</b> commands, multiple field names may be
  listed with the command, and a response line will be returned for each one in
  the order that the fields appear on the command line.</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>RSET</b></dt>
  <dd class="It-tag">Used to reset the internal server state. The current query
      expression is cleared, and the index of PRs may be reread if it has been
      updated since the start of the session.</dd>
</dl>
<div style="margin-left: 0.50in;">The possible responses are:
<dl class="Bl-tag">
  <dt class="It-tag">200 (<b>CODE_OK</b>)</dt>
  <dd class="It-tag">The state has been reset.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">440 (<b>CODE_CMD_ERROR</b>)</dt>
  <dd class="It-tag">One or more arguments were supplied to the command.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">6xx (<i>internal error</i>)</dt>
  <dd class="It-tag">There were problems resetting the state (usually because
      the index could not be reread). The session will be immediately
      terminated.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>LKDB</b></dt>
  <dd class="It-tag">Locks the main GNATS database. No subsequent database locks
      will succeed until the lock is removed. Sessions that attempt to write to
      the database will fail.</dd>
</dl>
<div style="margin-left: 0.50in;">The possible responses are:
<dl class="Bl-tag">
  <dt class="It-tag">200 (<b>CODE_OK</b>)</dt>
  <dd class="It-tag">The lock has been established.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">440 (<b>CODE_CMD_ERROR</b>)</dt>
  <dd class="It-tag">One or more arguments were supplied to the command.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">431 (<b>CODE_GNATS_LOCKED</b>)</dt>
  <dd class="It-tag">The database is already locked, and the lock could not be
      obtained after 10 seconds.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">6xx (<i>internal error</i>)</dt>
  <dd class="It-tag">An internal error occurred, usually because of permission
      or other filesystem-related problems. The lock may or may not have been
      established.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>UNDB</b></dt>
  <dd class="It-tag">Unlocks the database. Any session may steal a database
      lock; no checking of any sort is done.</dd>
</dl>
<div style="margin-left: 0.50in;">The possible responses are:
<dl class="Bl-tag">
  <dt class="It-tag">200 (<b>CODE_OK</b>)</dt>
  <dd class="It-tag">The lock has been removed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">432 (<b>CODE_GNATS_NOT_LOCKED</b>)</dt>
  <dd class="It-tag">The database was not locked.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">440 (<b>CODE_CMD_ERROR</b>)</dt>
  <dd class="It-tag">One or more arguments were supplied to the command.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">6xx (<i>internal error</i>)</dt>
  <dd class="It-tag">The database lock could not be removed, usually because of
      permissions or other filesystem-related issues.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>LOCK</b> &lt;<i>PR</i>&gt; &lt;<i>user</i>&gt;
    [&lt;<i>pid</i>&gt;]</dt>
  <dd class="It-tag">Locks the specified <i>PR</i>, marking the lock with the
      name <i>user</i> and the optional <i>pid</i>. (No checking is done that
      the <i>user</i> or <i>pid</i> arguments are valid or meaningful; they are
      simply treated as strings.)</dd>
</dl>
<div style="margin-left: 0.50in;">
<div class="Pp"></div>
The <b>EDIT</b> command requires that the <i>PR</i> be locked before it may be
  successfully executed. However, it does not require that the lock is owned by
  the editing session, so the usefulness of the lock is simply as an advisory
  measure.
<div class="Pp"></div>
The <b>APPN</b> and <b>REPL</b> commands lock the <i>PR</i> as part of the
  editing process, and they do not require that the <i>PR</i> be locked
  <i>before</i> they are invoked.
<div class="Pp"></div>
The possible responses are:
<dl class="Bl-tag">
  <dt class="It-tag">440 (<b>CODE_CMD_ERROR</b>)</dt>
  <dd class="It-tag">Insufficient or too many arguments were specified to the
      command.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">300 (<b>CODE_PR_READY</b>)</dt>
  <dd class="It-tag">The lock was successfully obtained; the text of the
      <i>PR</i> (using the standard quoting mechanism for <i>PR</i>s)
    follows.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">400 (<b>CODE_NONEXISTENT_PR</b>)</dt>
  <dd class="It-tag">The <i>PR</i> specified does not exist.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">430 (<b>CODE_LOCKED_PR</b>)</dt>
  <dd class="It-tag">The <i>PR</i> is already locked by another session.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">6xx (<i>internal error</i>)</dt>
  <dd class="It-tag">The <i>PR</i> lock could not be created, usually because of
      permissions or other filesystem-related issues.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>UNLK</b> &lt;<i>PR</i>&gt;</dt>
  <dd class="It-tag">Unlocks <i>PR</i>. Any user may unlock a <i>PR</i>, as no
      checking is done to determine if the requesting session owns the
    lock.</dd>
</dl>
<div style="margin-left: 0.50in;">
<div class="Pp"></div>
The possible responses are:
<dl class="Bl-tag">
  <dt class="It-tag">440 (<b>CODE_CMD_ERROR</b>)</dt>
  <dd class="It-tag">Insufficient or too many arguments were specified to the
      command.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">200 (<b>CODE_OK</b>)</dt>
  <dd class="It-tag">The <i>PR</i> was successfully unlocked.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">433 (<b>CODE_PR_NOT_LOCKED</b>)</dt>
  <dd class="It-tag">The <i>PR</i> was not locked.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">6xx (<i>internal error</i>)</dt>
  <dd class="It-tag">The <i>PR</i> could not be unlocked, usually because of
      permission or other filesystem-related problems.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>DELETE</b> &lt;<i>PR</i>&gt;</dt>
  <dd class="It-tag">Deletes the specified <i>PR</i>. The user making the
      request must have <i>admin</i> privileges. If successful, the <i>PR</i> is
      removed from the filesystem and the index file; a gap will be left in the
      numbering sequence for <i>PR</i>s. No checks are made that the <i>PR</i>
      is closed.</dd>
</dl>
<div style="margin-left: 0.50in;">
<div class="Pp"></div>
The possible responses are:
<dl class="Bl-tag">
  <dt class="It-tag">200 (<b>CODE_OK</b>)</dt>
  <dd class="It-tag">The <i>PR</i> was successfully deleted.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">422 (<b>CODE_NO_ACCESS</b>)</dt>
  <dd class="It-tag">The user requesting the delete does not have <i>admin</i>
      privileges.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">430 (<b>CODE_LOCKED_PR</b>)</dt>
  <dd class="It-tag">The <i>PR</i> is locked by another session.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">431 (<b>CODE_GNATS_LOCKED</b>)</dt>
  <dd class="It-tag">The database has been locked, and no <i>PR</i>s may be
      updated until the lock is cleared.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">6xx (<i>internal error</i>)</dt>
  <dd class="It-tag">The <i>PR</i> could not be successfully deleted, usually
      because of permission or other filesystem-related problems.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CHEK</b> [initial]</dt>
  <dd class="It-tag">Used to check the text of an entire <i>PR</i> for errors.
      Unlike the <b>VFLD</b> command, it accepts an entire <i>PR</i> at once
      instead of the contents of an individual field.</dd>
</dl>
<div style="margin-left: 0.50in;">
<div class="Pp"></div>
The <i>initial</i> argument indicates that the PR text to be checked is for a
  <i>PR</i> that will be newly created, rather than an edit or replacement of an
  existing PR.
<div class="Pp"></div>
After the <b>CHEK</b> command is issued, the server will respond with either a
  440 ( <b>CODE_CMD_ERROR</b>) response indicating that the command arguments
  were incorrect, or a 211 ( <b>CODE_SEND_PR</b>) response code will be sent.
<div class="Pp"></div>
Once the 211 response is received from the server, the client should send the
  <i>PR</i> using the normal <i>PR</i> quoting mechanism; the final line of the
  <i>PR</i> is then followed by a line containing a single period, as usual.
<div class="Pp"></div>
The server will then respond with either a 200 ( <b>CODE_OK</b>) response,
  indicating there were no problems with the supplied text, or one or more error
  codes listing the problems with the <i>PR</i>.</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>EDIT</b> &lt;<i>PR</i>&gt;</dt>
  <dd class="It-tag">Verifies the replacement text for <i>PR</i>. If the command
      is successful, the contents of <i>PR</i> are completely replaced with the
      supplied text. <i>PR</i> must previously have been locked with the
      <b>LOCK</b> command.</dd>
</dl>
<div style="margin-left: 0.50in;">
<div class="Pp"></div>
The possible responses are:
<dl class="Bl-tag">
  <dt class="It-tag">431 (<b>CODE_GNATS_LOCKED</b>)</dt>
  <dd class="It-tag">The database has been locked, and no <i>PR</i>s may be
      updated until the lock is cleared.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">433 (<b>CODE_PR_NOT_LOCKED</b>)</dt>
  <dd class="It-tag">The <i>PR</i> was not previously locked with the
      <b>LOCK</b> command.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">400 (<b>CODE_NONEXISTENT_PR</b>)</dt>
  <dd class="It-tag">The specified <i>PR</i> does not currently exist. The
      <b>SUBM</b> command should be used to create new <i>PR</i>s.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">211 (<b>CODE_SEND_PR</b>)</dt>
  <dd class="It-tag">The client should now transmit the replacement <i>PR</i>
      text using the normal <i>PR</i> quoting mechanism. After the <i>PR</i> has
      been sent, the server will respond with either a 200 ( <b>CODE_OK</b>)
      response indicating the edit was successful, or one or more error codes
      listing problems with either with the replacement <i>PR</i> text, or
      errors encountered while updating the <i>PR</i> file or index.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>APPN</b> &lt;<i>PR</i>&gt; &lt;<i>field</i>&gt;</dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>REPL</b> &lt;<i>PR</i>&gt; &lt;<i>field</i>&gt;</dt>
  <dd class="It-tag">Appends to or replaces the contents of <i>field</i> in
      <i>PR</i> with the supplied text. The command returns a 201&#x00A0;(
      <b>CODE_SEND_TEXT</b>) response; the client should then transmit the new
      field contents using the standard <i>PR</i> quoting mechanism. After the
      server has read the new contents, it then attempts to make the requested
      change to the <i>PR</i>.</dd>
</dl>
<div style="margin-left: 0.50in;">
<div class="Pp"></div>
The possible responses are:
<dl class="Bl-tag">
  <dt class="It-tag">200 (<b>CODE_OK</b>)</dt>
  <dd class="It-tag">The <i>PR</i> field was successfully changed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">400 (<b>CODE_NONEXISTENT_PR</b>)</dt>
  <dd class="It-tag">The <i>PR</i> specified does not exist.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">410 (<b>CODE_INVALID_FIELD_NAME</b>)</dt>
  <dd class="It-tag">The specified field does not exist.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">402 (<b>CODE_UNREADABLE_PR</b>)</dt>
  <dd class="It-tag">The <i>PR</i> could not be read.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">431 (<b>CODE_GNATS_LOCKED</b>)</dt>
  <dd class="It-tag">The database has been locked, and no <i>PR</i>s may be
      updated until the lock is cleared.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">430 (<b>CODE_LOCKED_PR</b>)</dt>
  <dd class="It-tag">The <i>PR</i> is locked, and may not be altered until the
      lock is cleared.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">413 (<b>CODE_INVALID_FIELD_CONTENTS</b>)</dt>
  <dd class="It-tag">The supplied (or resulting) field contents are not valid
      for the field.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">6xx (<i>internal error</i>)</dt>
  <dd class="It-tag">An internal error occurred, usually because of permission
      or other filesystem-related problems. The <i>PR</i> may or may not have
      been altered.</dd>
</dl>
</div>
<div class="Pp"></div>
<b>SUBM</b> Submits a new <i>PR</i> into the database. The supplied text is
  verified for correctness, and if no problems are found a new <i>PR</i> is
  created.
<div style="margin-left: 0.50in;">
<div class="Pp"></div>
The possible responses are:
<dl class="Bl-tag">
  <dt class="It-tag">431 (<b>CODE_GNATS_LOCKED</b>)</dt>
  <dd class="It-tag">The database has been locked, and no <i>PR</i>s may be
      submitted until the lock is cleared.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">211 (<b>CODE_SEND_PR</b>)</dt>
  <dd class="It-tag">The client should now transmit the new <i>PR</i> text using
      the normal quoting mechanism. After the <i>PR</i> has been sent, the
      server will respond with either a 200 ( <b>CODE_OK</b>) response
      indicating that the new PR has been created (and mail sent to the
      appropriate persons), or one or more error codes listing problems with the
      new <i>PR</i> text.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CHDB</b> &lt;<i>database</i>&gt; [&lt;<i>userid</i>&gt;
    [&lt; <i>password</i>&gt;]]</dt>
  <dd class="It-tag">Switches the current database to the name specified in the
      command. An optional username or an optional username and password may be
      given.</dd>
</dl>
<div style="margin-left: 0.50in;">
<div class="Pp"></div>
The possible responses are:
<dl class="Bl-tag">
  <dt class="It-tag">422 (<b>CODE_NO_ACCESS</b>)</dt>
  <dd class="It-tag">The user does not have permission to access the requested
      database.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">417 (<b>CODE_INVALID_DATABASE</b>)</dt>
  <dd class="It-tag">The database specified does not exist, or one or more
      configuration errors in the database were encountered.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">210 (<b>CODE_OK</b>)</dt>
  <dd class="It-tag">The current database is now <i>database</i>. Any operations
      performed will now be applied to that database. The user access level for
      the new database is also returned.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>DBLS</b></dt>
  <dd class="It-tag">Lists the known set of databases.</dd>
</dl>
<div style="margin-left: 0.50in;">
<div class="Pp"></div>
The possible responses are:
<dl class="Bl-tag">
  <dt class="It-tag">6xx (<i>internal error</i>)</dt>
  <dd class="It-tag">An internal error was encountered while trying to obtain
      the list of available databases, usually due to lack of permissions or
      other filesystem-related problems, or the list of databases is empty.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">301 (<b>CODE_TEXT_READY</b>)</dt>
  <dd class="It-tag">The list of databases follows, one per line, using the
      standard quoting mechanism. Only the database names are sent.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>DBDESC</b> &lt;<i>databasename</i>&gt;</dt>
  <dd class="It-tag">Returns a human-readable description of the specified
      database. Responses include:</dd>
</dl>
<div style="margin-left: 0.50in;">
<dl class="Bl-tag">
  <dt class="It-tag">6xx (<i>internal error</i>)</dt>
  <dd class="It-tag">An internal error was encountered while trying to read the
      list of available databases, usually due to lack of permissions or other
      filesystem-related problems, or the list of databases is empty.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">350 (<b>CODE_INFORMATION</b>)</dt>
  <dd class="It-tag">The normal response; the supplied text is the database
      description.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">417 (<b>CODE_INVALID_DATABASE</b>)</dt>
  <dd class="It-tag">The specified database name does not have an entry.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>EXPR</b> &lt;<i>query expression</i>&gt;</dt>
  <dd class="It-tag">Specifies a query expression used to limit which <i>PR</i>s
      are returned from the <b>QUER</b> command. The expression uses the normal
      query expression syntax, as described in the manual entry for
    query-pr(1).</dd>
</dl>
<div style="margin-left: 0.50in;">
<div class="Pp"></div>
Multiple <b>EXPR</b> commands may be issued; the expressions are boolean
  <i>AND</i>ed together.
<div class="Pp"></div>
Expressions are cleared by the RSET command.
<div class="Pp"></div>
Possible responses include:
<dl class="Bl-tag">
  <dt class="It-tag">415 (<b>CODE_INVALID_EXPR</b>)</dt>
  <dd class="It-tag">The specified expression is invalid, and could not be
      parsed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">200 (<b>CODE_OK</b>)</dt>
  <dd class="It-tag">The expression has been accepted, and will be used to limit
      the results returned from <b>QUER</b>.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>QFMT</b> &lt;<i>query format</i>&gt;</dt>
  <dd class="It-tag">Use the specified query format to format the output of the
      <b>QUER</b> command. The query format may be either the name of a query
      format known to the server, or an actual query format.</dd>
</dl>
<div style="margin-left: 0.50in;">The possible responses are:
<dl class="Bl-tag">
  <dt class="It-tag">200 (<b>CODE_OK</b>)</dt>
  <dd class="It-tag">The normal response, which indicates that the query format
      is acceptable.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">440 (<b>CODE_CMD_ERROR</b>)</dt>
  <dd class="It-tag">No query format was supplied.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">418 (<b>CODE_INVALID_QUERY_FORMAT</b>)</dt>
  <dd class="It-tag">The specified query format does not exist, or could not be
      parsed.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>QUER</b> [<i>PR</i>] [<i>PR</i>] [...]</dt>
  <dd class="It-tag">Searches the contents of the database for <i>PR</i>s that
      match the (optional) specified expressions with the <b>EXPR</b> command.
      If no expressions were specified with <b>EXPR</b>, the entire set of
      <i>PR</i>s is returned.</dd>
</dl>
<div style="margin-left: 0.50in;">
<div class="Pp"></div>
If one or more <i>PR</i>s are specified on the commandline, only those
  <i>PR</i>s will be searched and/or output.
<div class="Pp"></div>
The format of the output from the command is determined by the query format
  selected with the <b>QFMT</b> command.
<div class="Pp"></div>
The possible responses are:
<dl class="Bl-tag">
  <dt class="It-tag">418 (<b>CODE_INVALID_QUERY_FORMAT</b>)</dt>
  <dd class="It-tag">A valid format was not specified with the <b>QFMT</b>
      command prior to invoking <b>QUER</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">300 (<b>CODE_PR_READY</b>)</dt>
  <dd class="It-tag">One or more <i>PR</i>s will be output using the requested
      query format. The <i>PR</i> text is quoted using the normal quoting
      mechanisms for <i>PR</i>s.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">220 (<b>CODE_NO_PRS_MATCHED</b>)</dt>
  <dd class="It-tag">No <i>PR</i>s met the specified criteria.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ADMV</b> &lt;<i>field</i>&gt; &lt;<i>key</i>&gt;
    [&lt;<i>subfield</i>&gt;]</dt>
  <dd class="It-tag">Returns an entry from an adm file associated with
      <i>field</i>. <i>key</i> is used to look up the entry in the data file. If
      <i>subfield</i> is specified, only the value of that subfield is returned;
      otherwise, all of the fields in the adm data file are returned, separated
      by colons (`:').</dd>
</dl>
<div style="margin-left: 0.50in;">
<div class="Pp"></div>
The responses are:
<dl class="Bl-tag">
  <dt class="It-tag">410 (<b>CODE_INVALID_FIELD_NAME</b>)</dt>
  <dd class="It-tag">The specified field does not exist.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">221 (<b>CODE_NO_ADM_ENTRY</b>)</dt>
  <dd class="It-tag">An adm entry matching the key was not found, or the field
      does not have an adm file associated with it.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">350 (<b>CODE_INFORMATION</b>)</dt>
  <dd class="It-tag">The normal response; the supplied text is the requested
      field(s).</dd>
</dl>
</div>
<h1 class="Sh" title="Sh" id="ENVIRONMENT_VARIABLES"><a class="selflink" href="#ENVIRONMENT_VARIABLES">ENVIRONMENT
  VARIABLES</a></h1>
The <b>GNATSDB</b> environment variable is used to determine which database to
  use. For a local database, it contains the name of the database to access.
  <b>gnatsd</b> cannot service remote databases (tho it might be interesting if
  it could) so the database is always assumed to be local.
<div class="Pp"></div>
If <b>GNATSDB</b> is not set and the --database option is not supplied, it is
  assumed that the database is local and that its name is <i>default</i>.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<i>Keeping Track: Managing Messages With GNATS</i> (also installed as the GNU
  Info file <b>gnats.info</b>)
<div class="Pp"></div>
<b>databases</b>(5), <b>dbconfig</b>(5), <b>delete-pr</b>(8), <b>edit-pr</b>(1)
  <b>file-pr</b>(8), <b>gen-index</b>(8), <b>gnats</b>(7), <b>gnatsd</b>(8),
  <b>mkcat</b>(8), <b>mkdb</b>(8), <b>pr-edit</b>(8), <b>query-pr</b>(1),
  <b>queue-pr</b>(8), <b>send-pr</b>(1).
<h1 class="Sh" title="Sh" id="COPYING"><a class="selflink" href="#COPYING">COPYING</a></h1>
Copyright (c) 2000, 2003 Free Software Foundation, Inc.
<div class="Pp"></div>
Permission is granted to make and distribute verbatim copies of this manual
  provided the copyright notice and this permission notice are preserved on all
  copies.
<div class="Pp"></div>
Permission is granted to copy and distribute modified versions of this manual
  under the conditions for verbatim copying, provided that the entire resulting
  derived work is distributed under the terms of a permission notice identical
  to this one.
<div class="Pp"></div>
Permission is granted to copy and distribute translations of this manual into
  another language, under the above conditions for modified versions, except
  that this permission notice may be included in translations approved by the
  Free Software Foundation instead of in the original English.</div>
<table class="foot">
  <tr>
    <td class="foot-date">August 2003</td>
    <td class="foot-os">GNATS </td>
  </tr>
</table>
</body>
</html>
