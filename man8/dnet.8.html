<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>DNET(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DNET(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">DNET(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<b class="Nm" title="Nm">dnet</b> &#x2014; <span class="Nd" title="Nd">dumb
  networking library test program</span>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<table class="Nm">
  <tr>
    <td><b class="Nm" title="Nm">dnet <var class="Ar" title="Ar">command</var>
      <var class="Ar" title="Ar">args</var>
      [<span class="Op">...</span>]</b></td>
    <td></td>
  </tr>
</table>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b class="Nm" title="Nm">dnet</b> is a simple test program for the
  <a class="Xr" title="Xr">dnet(3)</a> library. It can be used to compose and
  transmit network datagrams as a Unix-style filter (e.g. reading from or
  writing to files and pipes) or modify the local system network configuration
  (including the ARP cache, firewall ruleset, network interfaces, and routing
  table).
<h2 class="Ss" title="Ss" id="Payload_generation_commands"><a class="selflink" href="#Payload_generation_commands">Payload
  generation commands</a></h2>
<dl class="Bl-tag" style="margin-left: 6.60ex;">
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">addr</b>
    <var class="Ar" title="Ar">address</var> [<span class="Op">...</span>]</dt>
  <dd class="It-tag">Convert the <var class="Ar" title="Ar">address</var>
      (specified as a hostname, IP address, or MAC address) into its binary
      representation on standard output.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">hex</b>
    <var class="Ar" title="Ar">string</var> [<span class="Op">...</span>]</dt>
  <dd class="It-tag">Convert the C-style escaped
      <var class="Ar" title="Ar">string</var> (shellcode, for instance) into its
      binary representation on standard output.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">rand</b>
    <var class="Ar" title="Ar">len</var></dt>
  <dd class="It-tag">Write <var class="Ar" title="Ar">len</var> random bytes to
      standard output.</dd>
</dl>
<h2 class="Ss" title="Ss" id="Packet_encapsulation_commands"><a class="selflink" href="#Packet_encapsulation_commands">Packet
  encapsulation commands</a></h2>
<dl class="Bl-tag" style="margin-left: 6.60ex;">
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">eth</b>
    [<span class="Op"><b class="Nm" title="Nm">type</b>
    <var class="Ar" title="Ar">type</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">src</b>
    <var class="Ar" title="Ar">mac</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">dst</b>
    <var class="Ar" title="Ar">mac</var></span>]</dt>
  <dd class="It-tag">Prepend the data read from standard input with an Ethernet
      header on standard output. The Ethernet
      <var class="Ar" title="Ar">type</var> may be specified as
      &#x2018;<code class="Li">arp</code>&#x2019;,
      &#x2018;<code class="Li">ip</code>&#x2019;, or as a hex, octal, or decimal
      number.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">arp</b>
    [<span class="Op"><b class="Nm" title="Nm">op</b>
    <var class="Ar" title="Ar">op</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">sha</b>
    <var class="Ar" title="Ar">mac</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">spa</b>
    <var class="Ar" title="Ar">host</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">tha</b>
    <var class="Ar" title="Ar">mac</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">tpa</b>
    <var class="Ar" title="Ar">host</var></span>]</dt>
  <dd class="It-tag">Prepend the data read from standard input with an ARP
      header on standard output. The ARP <var class="Ar" title="Ar">op</var> may
      be specified as &#x2018;<code class="Li">req</code>&#x2019;,
      &#x2018;<code class="Li">rep</code>&#x2019;,
      &#x2018;<code class="Li">revreq</code>&#x2019;,
      &#x2018;<code class="Li">revrep</code>&#x2019;, or as a hex, octal, or
      decimal number.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">ip</b>
    [<span class="Op"><b class="Nm" title="Nm">tos</b>
    <var class="Ar" title="Ar">num</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">id</b>
    <var class="Ar" title="Ar">num</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">off</b>
    <var class="Ar" title="Ar">offset</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">ttl</b>
    <var class="Ar" title="Ar">num</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">proto</b>
    <var class="Ar" title="Ar">protocol</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">src</b>
    <var class="Ar" title="Ar">host</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">dst</b>&#x00A0;<var class="Ar" title="Ar">dst</var></span>]</dt>
  <dd class="It-tag">Prepend the data read from standard input with an IP header
      on standard output. The fragmentation
      <var class="Ar" title="Ar">offset</var> may be specified as a decimal
      number (optionally concatenated with
      &#x2018;<code class="Li">+</code>&#x2019; to indicate more fragments) or
      as a hex number. The <var class="Ar" title="Ar">protocol</var> may be
      specified by name, or as a hex, octal, or decimal number.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">icmp</b>
    [<span class="Op"><b class="Nm" title="Nm">type</b>
    <var class="Ar" title="Ar">num</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">code</b>
    <var class="Ar" title="Ar">num</var></span>]</dt>
  <dd class="It-tag">Prepend the data read from standard input with an ICMP
      header on standard output.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">tcp</b>
    [<span class="Op"><b class="Nm" title="Nm">sport</b>
    <var class="Ar" title="Ar">port</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">dport</b>
    <var class="Ar" title="Ar">port</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">flags</b>
    <var class="Ar" title="Ar">flags</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">seq</b>
    <var class="Ar" title="Ar">num</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">ack</b>
    <var class="Ar" title="Ar">num</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">win</b>
    <var class="Ar" title="Ar">num</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">urp</b>
    <var class="Ar" title="Ar">num</var></span>]</dt>
  <dd class="It-tag">Prepend the data read from standard input with a TCP header
      on standard output. A <var class="Ar" title="Ar">port</var> may be
      specified by name or hex, octal, or decimal number. The TCP
      <var class="Ar" title="Ar">flags</var> may be specified as some
      combination of the characters in the set
      &#x2018;<code class="Li">SAFRPU</code>&#x2019; or as a hex number.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">udp</b>
    [<span class="Op"><b class="Nm" title="Nm">sport</b>
    <var class="Ar" title="Ar">port</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">dport</b>
    <var class="Ar" title="Ar">port</var></span>]</dt>
  <dd class="It-tag">Prepend the data read from standard input with a UDP header
      on standard output. A <var class="Ar" title="Ar">port</var> may be
      specified by name or hex, octal, or decimal number.</dd>
</dl>
<h2 class="Ss" title="Ss" id="Packet_transmission_commands"><a class="selflink" href="#Packet_transmission_commands">Packet
  transmission commands</a></h2>
<dl class="Bl-tag" style="margin-left: 6.60ex;">
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">send</b>
    [<span class="Op"><var class="Ar" title="Ar">device</var></span>]</dt>
  <dd class="It-tag">Read a packet from standard input and send it over the
      network. If no <var class="Ar" title="Ar">device</var> is specified, the
      packet is assumed to be an IP datagram and routed to its destination.
      Otherwise, the packet is assumed to be an Ethernet frame and is
      transmitted on the specified interface.</dd>
</dl>
<h2 class="Ss" title="Ss" id="Kernel_interface_commands"><a class="selflink" href="#Kernel_interface_commands">Kernel
  interface commands</a></h2>
<dl class="Bl-tag" style="margin-left: 6.60ex;">
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">arp
    show</b></dt>
  <dd class="It-tag">Display the kernel ARP cache.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">arp
    get</b> <var class="Ar" title="Ar">host</var></dt>
  <dd class="It-tag">Display the kernel ARP entry for
      <var class="Ar" title="Ar">host</var>.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">arp
    add</b> <var class="Ar" title="Ar">host</var>
    <var class="Ar" title="Ar">mac</var></dt>
  <dd class="It-tag">Add an ARP entry mapping the
      <var class="Ar" title="Ar">mac</var> address for
      <var class="Ar" title="Ar">host</var>.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">arp
    delete</b> <var class="Ar" title="Ar">host</var></dt>
  <dd class="It-tag">Delete the ARP entry for
      <var class="Ar" title="Ar">host</var>.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">fw
    show</b></dt>
  <dd class="It-tag">Display the kernel firewall ruleset.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">fw
    add</b>|<b class="Nm" title="Nm">delete</b>
    <var class="Ar" title="Ar">action</var>
    <var class="Ar" title="Ar">direction</var>
    <var class="Ar" title="Ar">device</var>
    <var class="Ar" title="Ar">protocol</var>
    <var class="Ar" title="Ar">src</var>[<span class="Op">:<var class="Ar" title="Ar">port[-max]</var></span>]
    <var class="Ar" title="Ar">dst</var>[<span class="Op">:<var class="Ar" title="Ar">port[-max]</var></span>]
    [<span class="Op"><var class="Ar" title="Ar">type</var>[<span class="Op">/code</span>]</span>]</dt>
  <dd class="It-tag">Add a rule to or delete a rule from the active firewall
      ruleset. The <var class="Ar" title="Ar">action</var> must be either
      &#x2018;<code class="Li">allow</code>&#x2019; or
      &#x2018;<code class="Li">block</code>&#x2019;. The direction must be
      either &#x2018;<code class="Li">in</code>&#x2019; or
      &#x2018;<code class="Li">out</code>&#x2019;. The
      <var class="Ar" title="Ar">device</var> may specify an interface name, or
      &#x2018;<code class="Li">any</code>&#x2019;. The
      <var class="Ar" title="Ar">protocol</var> may be specified by name, or as
      a decimal number. For TCP and UDP protocols, a
      <var class="Ar" title="Ar">port</var> (or range, if specified with a
      <var class="Ar" title="Ar">max</var> value) may be specified in decimal
      and appended to the source and/or destination address. For ICMP, a
      <var class="Ar" title="Ar">type</var> (and optional
      <var class="Ar" title="Ar">code</var>) may be specified in decimal.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">intf
    show</b></dt>
  <dd class="It-tag">Display the configuration of all network interfaces.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">intf
    get</b> <var class="Ar" title="Ar">device</var></dt>
  <dd class="It-tag">Display the configuration for the interface specified by
      <var class="Ar" title="Ar">device</var>.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">intf
    set</b> <var class="Ar" title="Ar">device</var>
    [<span class="Op"><b class="Nm" title="Nm">alias</b>
    <var class="Ar" title="Ar">host</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">dst</b>
    <var class="Ar" title="Ar">host</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">inet</b>
    <var class="Ar" title="Ar">host</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">link</b>
    <var class="Ar" title="Ar">mac</var></span>]
    [<span class="Op"><b class="Nm" title="Nm">up</b>|<b class="Nm" title="Nm">down</b></span>]
    [<span class="Op"><b class="Nm" title="Nm">arp</b>|<b class="Nm" title="Nm">noarp</b></span>]</dt>
  <dd class="It-tag">Configure the interface specified by
      <var class="Ar" title="Ar">device</var>.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">route
    show</b></dt>
  <dd class="It-tag">Display the kernel routing table.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">route
    get</b> <var class="Ar" title="Ar">dst</var></dt>
  <dd class="It-tag">Display the route for the destination
      <var class="Ar" title="Ar">dst</var>, specified as a hostname, IP address,
      or network prefix in CIDR notation.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">route
    add</b> <var class="Ar" title="Ar">dst</var>
    <var class="Ar" title="Ar">gw</var></dt>
  <dd class="It-tag">Add a route for the destination
      <var class="Ar" title="Ar">dst</var> through the gateway
      <var class="Ar" title="Ar">gw</var>.</dd>
  <dt class="It-tag" style="margin-left: -6.60ex;"><b class="Nm" title="Nm">route
    delete</b> <var class="Ar" title="Ar">dst</var></dt>
  <dd class="It-tag">Delete the route for the destination
      <var class="Ar" title="Ar">dst</var>.</dd>
</dl>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
Send a UDP datagram containing random shellcode:
<div class="Pp"></div>
<div class="Bd" style="margin-left: 5.00ex;">
<pre class="Li">
dnet hex &quot;\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89&quot; \ 
&quot;\x46\x0c\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80&quot; \ 
&quot;\x31\xdb\x89\xd8\x40\xcd\x80\xe8\xdc\xff\xff\xff/bin/sh&quot; | \ 
dnet udp sport 555 dport 666 | \ 
dnet ip proto udp src 1.2.3.4 dst 5.6.7.8 | dnet send
</pre>
</div>
<div class="Pp"></div>
Save an ARP request in a file and send it twice:
<div class="Pp"></div>
<div class="Bd" style="margin-left: 5.00ex;">
<pre class="Li">
dnet arp op req sha 0:d:e:a:d:0 spa 10.0.0.3 tpa 10.0.0.4 | \ 
dnet eth type arp src 0:d:e:a:d:0 dst ff:ff:ff:ff:ff:ff &gt; arp.pkt 
dnet send fxp0 &lt; arp.pkt 
dnet send fxp0 &lt; arp.pkt
</pre>
</div>
<div class="Pp"></div>
Send a fragmented ping packet:
<div class="Pp"></div>
<div class="Bd" style="margin-left: 5.00ex;">
<pre class="Li">
# Create ping packet with IP header, to set ICMP checksum 
echo &quot;monkey monkey monkey monkey&quot; | dnet icmp type 8 code 0 | \ 
dnet ip proto icmp src 1.2.3.4 dst 5.6.7.8 &gt; ping.pkt 
 
# Chop off IP header 
dd if=ping.pkt of=ping.data bs=20 skip=1 
 
# Fragment IP payload 
split -b 24 ping.data p. 
 
# Send fragments 
dnet ip id 1 off 0+ proto icmp src 1.2.3.4 dst 5.6.7.8 &lt; p.aa | \ 
dnet send 
dnet ip id 1 off 24 proto icmp src 1.2.3.4 dst 5.6.7.8 &lt; p.ab | \ 
dnet send
</pre>
</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<a class="Xr" title="Xr">dnet(3)</a>
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
Dug Song &#x27E8;dugsong@monkey.org&#x27E9;</div>
<table class="foot">
  <tr>
    <td class="foot-date">October 17, 2001</td>
    <td class="foot-os">Linux 4.12.14-300.fc26.x86_64</td>
  </tr>
</table>
</body>
</html>
