<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>ovs-pki(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">ovs-pki(8)</td>
    <td class="head-vol">Open vSwitch Manual</td>
    <td class="head-rtitle">ovs-pki(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
ovs-pki - OpenFlow public key infrastructure management utility
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
Each command takes the form:
<div style="height: 1.00em;">&#x00A0;</div>
<b>ovs-pki</b> [<i>options</i>] <i>command</i> [<i>args</i>]
<div style="height: 1.00em;">&#x00A0;</div>
The implemented commands and their arguments are:
<div>&#x00A0;</div>
<b>ovs-pki</b> <b>init</b>
<div>&#x00A0;</div>
<b>ovs-pki</b> <b>req</b> <i>name</i>
<div>&#x00A0;</div>
<b>ovs-pki</b> <b>sign</b> <i>name</i> [<i>type</i>]
<div>&#x00A0;</div>
<b>ovs-pki</b> <b>req+sign</b> <i>name</i> [<i>type</i>]
<div>&#x00A0;</div>
<b>ovs-pki</b> <b>verify</b> <i>name</i> [<i>type</i>]
<div>&#x00A0;</div>
<b>ovs-pki</b> <b>fingerprint</b> <i>file</i>
<div>&#x00A0;</div>
<b>ovs-pki</b> <b>self-sign</b> <i>name</i>
<div style="height: 1.00em;">&#x00A0;</div>
Each <i>type</i> above is a certificate type, either <b>switch</b> (default) or
  <b>controller</b>.
<div style="height: 1.00em;">&#x00A0;</div>
The available options are:
<div>&#x00A0;</div>
[ <b>-k</b> <i>type</i> | <b>--key=</b><i>type</i>]
<div>&#x00A0;</div>
[ <b>-B</b> <i>nbits</i> | <b>--bits=</b><i>nbits</i>]
<div>&#x00A0;</div>
[ <b>-D</b> <i>file</i> | <b>--dsaparam=</b><i>file</i>]
<div>&#x00A0;</div>
[ <b>-b</b> | <b>--batch</b>]
<div>&#x00A0;</div>
[ <b>-f</b> | <b>--force</b>]
<div>&#x00A0;</div>
[ <b>-d</b> <i>dir</i> | <b>--dir=</b><i>dir</i>]
<div>&#x00A0;</div>
[ <b>-l</b> <i>file</i> | <b>--log=</b><i>file</i>]
<div>&#x00A0;</div>
[ <b>-h</b> | <b>--help</b>]
<div style="height: 1.00em;">&#x00A0;</div>
Some options do not apply to every command.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <b>ovs-pki</b> program sets up and manages a public key infrastructure for
  use with OpenFlow. It is intended to be a simple interface for organizations
  that do not have an established public key infrastructure. Other PKI tools can
  substitute for or supplement the use of <b>ovs-pki</b>.
<div style="height: 1.00em;">&#x00A0;</div>
<b>ovs-pki</b> uses <b>openssl</b>(1) for certificate management and key
  generation.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OFFLINE_COMMANDS"><a class="selflink" href="#OFFLINE_COMMANDS">OFFLINE
  COMMANDS</a></h1>
The following <b>ovs-pki</b> commands support manual PKI administration:
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>init</b></dt>
  <dd class="It-tag">Initializes a new PKI (by default in directory
      <b>/var/lib/openvswitch/pki</b>) and populates it with a pair of
      certificate authorities for controllers and switches.
    <div style="height: 1.00em;">&#x00A0;</div>
    This command should ideally be run on a high-security machine separate from
      any OpenFlow controller or switch, called the CA machine. The files
      <b>pki/controllerca/cacert.pem</b> and <b>pki/switchca/cacert.pem</b> that
      it produces will need to be copied over to the OpenFlow switches and
      controllers, respectively. Their contents may safely be made public.
    <div style="height: 1.00em;">&#x00A0;</div>
    By default, <b>ovs-pki</b> generates 2048-bit RSA keys. The <b>-B</b> or
      <b>--bits</b> option (see below) may be used to override the key length.
      The <b>-k dsa</b> or <b>--key=dsa</b> option may be used to use DSA in
      place of RSA. If DSA is selected, the <b>dsaparam.pem</b> file generated
      in the new PKI hierarchy must be copied to any machine on which the
      <b>req</b> command (see below) will be executed. Its contents may safely
      be made public.
    <div style="height: 1.00em;">&#x00A0;</div>
    Other files generated by <b>init</b> may remain on the CA machine. The files
      <b>pki/controllerca/private/cakey.pem</b> and
      <b>pki/switchca/private/cakey.pem</b> have particularly sensitive contents
      that should not be exposed.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>req</b> <i>name</i></dt>
  <dd class="It-tag">Generates a new private key named
      <i>name</i><b>-privkey.pem</b> and corresponding certificate request named
      <i>name</i><b>-req.pem</b>. The private key can be intended for use by a
      switch or a controller.
    <div style="height: 1.00em;">&#x00A0;</div>
    This command should ideally be run on the switch or controller that will use
      the private key to identify itself. The file <i>name</i><b>-req.pem</b>
      must be copied to the CA machine for signing with the <b>sign</b> command
      (below).
    <div style="height: 1.00em;">&#x00A0;</div>
    This command will output a fingerprint to stdout as its final step. Write
      down the fingerprint and take it to the CA machine before continuing with
      the <b>sign</b> step.
    <div style="height: 1.00em;">&#x00A0;</div>
    When RSA keys are in use (as is the default), <b>req</b>, unlike the rest of
      <b>ovs-pki</b>'s commands, does not need access to a PKI hierarchy created
      by <b>ovs-pki init</b>. The <b>-B</b> or <b>--bits</b> option (see below)
      may be used to specify the number of bits in the generated RSA key.
    <div style="height: 1.00em;">&#x00A0;</div>
    When DSA keys are used (as specified with <b>--key=dsa</b>), <b>req</b>
      needs access to the <b>dsaparam.pem</b> file created as part of the PKI
      hierarchy (but not to other files in that tree). By default,
      <b>ovs-pki</b> looks for this file in
      <b>/var/lib/openvswitch/pki/dsaparam.pem</b>, but the <b>-D</b> or
      <b>--dsaparam</b> option (see below) may be used to specify an alternate
      location.
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>name</i><b>-privkey.pem</b> has sensitive contents that should not be
      exposed. <i>name</i><b>-req.pem</b> may be safely made public.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>sign</b> <i>name</i> [<i>type</i>]</dt>
  <dd class="It-tag">Signs the certificate request named
      <i>name</i><b>-req.pem</b> that was produced in the previous step,
      producing a certificate named <i>name</i><b>-cert.pem</b>. <i>type</i>,
      either <b>switch</b> (default) or <b>controller</b>, indicates the use for
      which the key is being certified.
    <div style="height: 1.00em;">&#x00A0;</div>
    This command must be run on the CA machine.
    <div style="height: 1.00em;">&#x00A0;</div>
    The command will output a fingerprint to stdout and request that you verify
      that it is the same fingerprint output by the <b>req</b> command. This
      ensures that the request being signed is the same one produced by
      <b>req</b>. (The <b>-b</b> or <b>--batch</b> option suppresses the
      verification step.)
    <div style="height: 1.00em;">&#x00A0;</div>
    The file <i>name</i><b>-cert.pem</b> will need to be copied back to the
      switch or controller for which it is intended. Its contents may safely be
      made public.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>req+sign</b> <i>name</i> [<i>type</i>]</dt>
  <dd class="It-tag">Combines the <b>req</b> and <b>sign</b> commands into a
      single step, outputting all the files produced by each. The
      <i>name</i><b>-privkey.pem</b> and <i>name</i><b>-cert.pem</b> files must
      be copied securely to the switch or controller.
      <i>name</i><b>-privkey.pem</b> has sensitive contents and must not be
      exposed in transit. Afterward, it should be deleted from the CA machine.
    <div style="height: 1.00em;">&#x00A0;</div>
    This combined method is, theoretically, less secure than the individual
      steps performed separately on two different machines, because there is
      additional potential for exposure of the private key. However, it is also
      more convenient.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>verify</b> <i>name</i> [<i>type</i>]</dt>
  <dd class="It-tag">Verifies that <i>name</i><b>-cert.pem</b> is a valid
      certificate for the given <i>type</i> of use, either <b>switch</b>
      (default) or <b>controller</b>. If the certificate is valid for this use,
      it prints the message `` <i>name</i><b>-cert.pem</b>: OK''; otherwise, it
      prints an error message.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>fingerprint</b> <i>file</i></dt>
  <dd class="It-tag">Prints the fingerprint for <i>file</i>. If <i>file</i> is a
      certificate, then this is the SHA-1 digest of the DER encoded version of
      the certificate; otherwise, it is the SHA-1 digest of the entire file.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>self-sign</b> <i>name</i></dt>
  <dd class="It-tag">Signs the certificate request named
      <i>name</i><b>-req.pem</b> using the private key
      <i>name</i><b>-privkey.pem</b>, producing a self-signed certificate named
      <i>name</i><b>-cert.pem</b>. The input files should have been produced
      with <b>ovs-pki req</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
    Some controllers accept such self-signed certificates.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-k</b> <i>type</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--key=</b><i>type</i></dt>
  <dd class="It-tag">For the <b>init</b> command, sets the public key algorithm
      to use for the new PKI hierarchy. For the <b>req</b> and <b>req+sign</b>
      commands, sets the public key algorithm to use for the key to be
      generated, which must match the value specified on <b>init</b>. With other
      commands, the value has no effect.
    <div style="height: 1.00em;">&#x00A0;</div>
    The <i>type</i> may be <b>rsa</b> (the default) or <b>dsa</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-B</b> <i>nbits</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--bits=</b><i>nbits</i></dt>
  <dd class="It-tag">Sets the number of bits in the key to be generated. When
      RSA keys are in use, this option affects only the <b>init</b>, <b>req</b>,
      and <b>req+sign</b> commands, and the same value should be given each
      time. With DSA keys are in use, this option affects only the <b>init</b>
      command.
    <div style="height: 1.00em;">&#x00A0;</div>
    The value must be at least 1024. The default is 2048.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-D</b> <i>file</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dsaparam=</b><i>file</i></dt>
  <dd class="It-tag">Specifies an alternate location for the <b>dsaparam.pem</b>
      file required by the <b>req</b> and <b>req+sign</b> commands. This option
      affects only these commands, and only when DSA keys are used.
    <div style="height: 1.00em;">&#x00A0;</div>
    The default is <b>dsaparam.pem</b> under the PKI hierarchy.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-b</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--batch</b></dt>
  <dd class="It-tag">Suppresses the interactive verification of fingerprints
      that the <b>sign</b> command by default requires.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d</b> <i>dir</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dir=</b><i>dir</i></dt>
  <dd class="It-tag">Specifies the location of the PKI hierarchy to be used or
      created by the command (default: <b>/var/lib/openvswitch/pki</b>). All
      commands, except <b>req</b>, need access to a PKI hierarchy.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--force</b></dt>
  <dd class="It-tag">By default, <b>ovs-pki</b> will not overwrite existing
      files or directories. This option overrides this behavior.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l</b> <i>file</i></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--log=</b><i>file</i></dt>
  <dd class="It-tag">Sets the log file to <i>file</i>. Default:
      <b>/var/log/openvswitch/ovs-pki.log</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h</b></dt>
  <dd class="It-tag">
    <div>&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help</b></dt>
  <dd class="It-tag">Prints a help usage message and exits.</dd>
</dl>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2.7.0</td>
    <td class="foot-os">Open vSwitch</td>
  </tr>
</table>
</body>
</html>
