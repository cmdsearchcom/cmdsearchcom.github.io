<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>sepolicy-generate(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">sepolicy-generate(8)</td>
    <td class="head-vol"></td>
    <td class="head-rtitle">sepolicy-generate(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
sepolicy-generate - Generate an initial SELinux policy module template.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
Common options
<div style="height: 1.00em;">&#x00A0;</div>
<b>sepolicy generate [-h ] [-p PATH]</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
Confined Applications
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>sepolicy generate --application [-n NAME] [-u USER ]command [-w WRITE_PATH
  ]</b>
<div>&#x00A0;</div>
<b>sepolicy generate --cgi [-n NAME] command [-w WRITE_PATH ]</b>
<div>&#x00A0;</div>
<b>sepolicy generate --dbus [-n NAME] command [-w WRITE_PATH ]</b>
<div>&#x00A0;</div>
<b>sepolicy generate --inetd [-n NAME] command [-w WRITE_PATH ]</b>
<div>&#x00A0;</div>
<b>sepolicy generate --init [-n NAME] command [-w WRITE_PATH ]</b>
<div style="height: 1.00em;">&#x00A0;</div>
Confined Users
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>sepolicy generate --admin_user [-r TRANSITION_ROLE] -n NAME</b>
<div>&#x00A0;</div>
<b>sepolicy generate --confined_admin -n NAME [-a ADMIN_DOMAIN] [-u USER] [-n
  NAME] [-w WRITE_PATH]</b>
<div>&#x00A0;</div>
<b>sepolicy generate --desktop_user -n NAME [-w WRITE_PATH]</b>
<div>&#x00A0;</div>
<b>sepolicy generate --term_user -n NAME [-w WRITE_PATH]</b>
<div>&#x00A0;</div>
<b>sepolicy generate --x_user -n NAME [-w WRITE_PATH]</b>
<div>&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
Miscellaneous Policy
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>sepolicy generate --customize -d DOMAIN -n NAME [-a ADMIN_DOMAIN]</b>
<div>&#x00A0;</div>
<b>sepolicy generate --newtype -t type -n NAME</b>
<div>&#x00A0;</div>
<b>sepolicy generate --sandbox -n NAME</b>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
Use <b>sepolicy generate</b> to generate an SELinux policy Module.
<div style="height: 1.00em;">&#x00A0;</div>
<div>&#x00A0;</div>
<b>sepolicy generate</b> will create 5 files.
<div style="height: 1.00em;">&#x00A0;</div>
When specifying a <b>confined application</b> you must specify a path.
  <b>sepolicy generate</b> will use the rpm payload of the application along
  with <b>nm -D APPLICATION</b> to help it generate types and policy rules for
  your policy files.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Type Enforcing File NAME.te</b>
<div>&#x00A0;</div>
This file can be used to define all the types rules for a particular domain.
<div style="height: 1.00em;">&#x00A0;</div>
<i>Note:</i> Policy generated by <b>sepolicy generate</b> will automatically add
  a permissive DOMAIN to your te file. When you are satisfied that your policy
  works, you need to remove the permissive line from the te file to run your
  domain in enforcing mode.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Interface File NAME.if</b>
<div>&#x00A0;</div>
This file defines the interfaces for the types generated in the te file, which
  can be used by other policy domains.
<div style="height: 1.00em;">&#x00A0;</div>
<b>File Context NAME.fc</b>
<div>&#x00A0;</div>
This file defines the default file context for the system, it takes the file
  types created in the te file and associates file paths to the types. Tools
  like restorecon and RPM will use these paths to put down labels.
<div style="height: 1.00em;">&#x00A0;</div>
<b>RPM Spec File NAME_selinux.spec</b>
<div>&#x00A0;</div>
This file is an RPM SPEC file that can be used to install the SELinux policy on
  to machines and setup the labeling. The spec file also installs the interface
  file and a man page describing the policy. You can use <b>sepolicy manpage -d
  NAME</b> to generate the man page.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Shell File NAME.sh</b>
<div>&#x00A0;</div>
This is a helper shell script to compile, install and fix the labeling on your
  test system. It will also generate a man page based on the installed policy,
  and compile and build an RPM suitable to be installed on other machines
<div style="height: 1.00em;">&#x00A0;</div>
If a generate is possible, this tool will print out all generate paths from the
  source domain to the target domain
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-h, --help</i></dt>
  <dd class="It-tag">Display help message</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-d, --domain</i></dt>
  <dd class="It-tag">Enter domain type(s) which you will be extending</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-n, --name</i></dt>
  <dd class="It-tag">Specify alternate name of policy. The policy will default
      to the executable or name specified</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-p, --path</i></dt>
  <dd class="It-tag">Specify the directory to store the created policy files.
      (Default to current working directory ) optional arguments:</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-r, --role</i></dt>
  <dd class="It-tag">Enter role(s) to which this admin user will
    transition.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-t, --type</i></dt>
  <dd class="It-tag">Enter type(s) for which you will generate new definition
      and rule(s)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-u, --user</i></dt>
  <dd class="It-tag">SELinux user(s) which will transition to this domain</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-w, --writepath</i></dt>
  <dd class="It-tag">Path(s) which the confined processes need to write</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-a, --admin</i></dt>
  <dd class="It-tag">Domain(s) which the confined admin will administrate</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>--admin_user</i></dt>
  <dd class="It-tag">Generate Policy for Administrator Login User Role</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>--application</i></dt>
  <dd class="It-tag">Generate Policy for User Application</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>--cgi</i></dt>
  <dd class="It-tag">Generate Policy for Web Application/Script (CGI)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>--confined_admin</i></dt>
  <dd class="It-tag">Generate Policy for Confined Root Administrator Role</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>--customize</i></dt>
  <dd class="It-tag">Generate Policy for Existing Domain Type</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>--dbus</i></dt>
  <dd class="It-tag">Generate Policy for DBUS System Daemon</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>--desktop_user</i></dt>
  <dd class="It-tag">Generate Policy for Desktop Login User Role</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>--inetd</i></dt>
  <dd class="It-tag">Generate Policy for Internet Services Daemon</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>--init</i></dt>
  <dd class="It-tag">Generate Policy for Standard Init Daemon (Default)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>--newtype</i></dt>
  <dd class="It-tag">Generate new policy for new types to add to an existing
      policy.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>--sandbox</i></dt>
  <dd class="It-tag">Generate Policy for Sandbox</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>--term_user</i></dt>
  <dd class="It-tag">Generate Policy for Minimal Terminal Login User Role</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>--x_user</i></dt>
  <dd class="It-tag">Generate Policy for Minimal X Windows Login User Role
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="EXAMPLE"><a class="selflink" href="#EXAMPLE">EXAMPLE</a></h1>
<b>&gt; sepolicy generate --init /usr/sbin/rwhod</b>
<div>&#x00A0;</div>
Generating Policy for /usr/sbin/rwhod named rwhod
<div>&#x00A0;</div>
Created the following files:
<div>&#x00A0;</div>
rwhod.te # Type Enforcement file
<div>&#x00A0;</div>
rwhod.if # Interface file
<div>&#x00A0;</div>
rwhod.fc # File Contexts file
<div>&#x00A0;</div>
rwhod_selinux.spec # Spec file
<div>&#x00A0;</div>
rwhod.sh # Setup Script
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
This man page was written by Daniel Walsh &lt;dwalsh@redhat.com&gt;
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
sepolicy(8), selinux(8)</div>
<table class="foot">
  <tr>
    <td class="foot-date">20121005</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
