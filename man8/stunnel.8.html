<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>STUNNEL(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">STUNNEL(8)</td>
    <td class="head-vol">stunnel</td>
    <td class="head-rtitle">STUNNEL(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
stunnel - universal SSL tunnel
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Unix:</b></dt>
  <dd class="It-tag"><b>stunnel</b> [&lt;filename&gt;] | -fd&#x00A0;n | -help |
      -version | -sockets</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>WIN32:</b></dt>
  <dd class="It-tag"><b>stunnel</b> [ [-install | -uninstall | -start | -stop] |
      -exit]
    <br/>
     [-quiet] [&lt;filename&gt;] ] | -help | -version | -sockets</dd>
</dl>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <b>stunnel</b> program is designed to work as <i>SSL</i> encryption wrapper
  between remote clients and local ( <i>inetd</i>-startable) or remote servers.
  The concept is that having non-SSL aware daemons running on your system you
  can easily set them up to communicate with clients over secure SSL channels.
<div class="Pp"></div>
<b>stunnel</b> can be used to add SSL functionality to commonly used
  <i>Inetd</i> daemons like POP-2, POP-3, and IMAP servers, to standalone
  daemons like NNTP, SMTP and HTTP, and in tunneling PPP over network sockets
  without changes to the source code.
<div class="Pp"></div>
This product includes cryptographic software written by Eric Young
  (eay@cryptsoft.com)
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag">&lt;<b>filename</b>&gt;</dt>
  <dd class="It-tag">Use specified configuration file</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-fd n</b> (Unix only)</dt>
  <dd class="It-tag">Read the config file from specified file descriptor</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-help</b></dt>
  <dd class="It-tag">Print <b>stunnel</b> help menu</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-version</b></dt>
  <dd class="It-tag">Print <b>stunnel</b> version and compile time defaults</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-sockets</b></dt>
  <dd class="It-tag">Print default socket options</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-install</b> (NT/2000/XP only)</dt>
  <dd class="It-tag">Install NT Service</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-uninstall</b> (NT/2000/XP only)</dt>
  <dd class="It-tag">Uninstall NT Service</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-start</b> (NT/2000/XP only)</dt>
  <dd class="It-tag">Start NT Service</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-stop</b> (NT/2000/XP only)</dt>
  <dd class="It-tag">Stop NT Service</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-exit</b> (Win32 only)</dt>
  <dd class="It-tag">Exit an already started stunnel</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-quiet</b> (NT/2000/XP only)</dt>
  <dd class="It-tag">Don't display any message boxes</dd>
</dl>
<h1 class="Sh" title="Sh" id="CONFIGURATION_FILE"><a class="selflink" href="#CONFIGURATION_FILE">CONFIGURATION
  FILE</a></h1>
Each line of the configuration file can be either:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">An empty line (ignored).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">A comment starting with ';' (ignored).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">An 'option_name = option_value' pair.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">'[service_name]' indicating a start of a service
      definition.</dd>
</dl>
<div class="Pp"></div>
An address parameter of an option may be either:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">A port number.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">A colon-separated pair of IP address (either IPv4, IPv6, or
      domain name) and port number.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">A Unix socket path (Unix only).</dd>
</dl>
<h2 class="Ss" title="Ss" id="GLOBAL_OPTIONS"><a class="selflink" href="#GLOBAL_OPTIONS">GLOBAL
  OPTIONS</a></h2>
<dl class="Bl-tag">
  <dt class="It-tag"><b>chroot</b> = directory (Unix only)</dt>
  <dd class="It-tag">directory to chroot <b>stunnel</b> process
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>chroot</b> keeps <b>stunnel</b> in chrooted jail. <i>CApath</i>,
      <i>CRLpath</i>, <i>pid</i> and <i>exec</i> are located inside the jail and
      the patches have to be relative to the directory specified with
      <b>chroot</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
    Several functions of the operating system also need their files to be
      located within chroot jail, e.g.:</dd>
</dl>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Delayed resolver typically needs /etc/nsswitch.conf and
      /etc/resolv.conf.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Local time in log files needs /etc/timezone.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">Some other functions may need devices, e.g. /dev/zero or
      /dev/null.</dd>
</dl>
</div>
<div style="margin-left: 4.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>compression</b> = deflate | zlib | rle</dt>
  <dd class="It-tag">select data compression algorithm
    <div style="height: 1.00em;">&#x00A0;</div>
    default: no compression
    <div style="height: 1.00em;">&#x00A0;</div>
    deflate is the standard compression method as described in RFC 1951.
    <div style="height: 1.00em;">&#x00A0;</div>
    zlib compression of <b>OpenSSL 0.9.8</b> or above is not backward compatible
      with <b>OpenSSL 0.9.7</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
    rle compression is currently not implemented by the <b>OpenSSL</b>
    library.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>debug</b> = [facility.]level</dt>
  <dd class="It-tag">debugging level
    <div style="height: 1.00em;">&#x00A0;</div>
    Level is a one of the syslog level names or numbers emerg (0), alert (1),
      crit (2), err (3), warning (4), notice (5), info (6), or debug (7). All
      logs for the specified level and all levels numerically less than it will
      be shown. Use <i>debug = debug</i> or <i>debug = 7</i> for greatest
      debugging output. The default is notice (5).
    <div style="height: 1.00em;">&#x00A0;</div>
    The syslog facility 'authpriv' will be used unless a facility name is
      supplied. (Facilities are not supported on Win32.)
    <div style="height: 1.00em;">&#x00A0;</div>
    Case is ignored for both facilities and levels.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>EGD</b> = egd path (Unix only)</dt>
  <dd class="It-tag">path to Entropy Gathering Daemon socket
    <div style="height: 1.00em;">&#x00A0;</div>
    Entropy Gathering Daemon socket to use to feed <b>OpenSSL</b> random number
      generator. (Available only if compiled with <b>OpenSSL 0.9.5a</b> or
      higher)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>engine</b> = auto | &lt;engine id&gt;</dt>
  <dd class="It-tag">select hardware engine
    <div style="height: 1.00em;">&#x00A0;</div>
    default: software-only cryptography
    <div style="height: 1.00em;">&#x00A0;</div>
    Here is an example of advanced engine configuration to read private key from
      an OpenSC engine
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    engine=dynamic
    engineCtrl=SO_PATH:/usr/lib/opensc/engine_pkcs11.so
    engineCtrl=ID:pkcs11
    engineCtrl=LIST_ADD:1
    engineCtrl=LOAD
    engineCtrl=MODULE_PATH:/usr/lib/pkcs11/opensc-pkcs11.so
    engineCtrl=INIT
    [service]
    engineNum=1
    key=id_45
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>engineCtrl</b> = command[:parameter]</dt>
  <dd class="It-tag">control hardware engine
    <div style="height: 1.00em;">&#x00A0;</div>
    Special commands &quot;LOAD&quot; and &quot;INIT&quot; can be used to load
      and initialize the engine cryptogaphic module.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>fips</b> = yes | no</dt>
  <dd class="It-tag">Enable or disable FIPS 140-2 mode.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option allows to disable entering FIPS mode if <b>stunnel</b> was
      compiled with FIPS 140-2 support.
    <div style="height: 1.00em;">&#x00A0;</div>
    default: yes</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>foreground</b> = yes | no (Unix only)</dt>
  <dd class="It-tag">foreground mode
    <div style="height: 1.00em;">&#x00A0;</div>
    Stay in foreground (don't fork) and log to stderr instead of via syslog
      (unless <i>output</i> is specified).
    <div style="height: 1.00em;">&#x00A0;</div>
    default: background in daemon mode</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>output</b> = file</dt>
  <dd class="It-tag">append log messages to a file
    <div style="height: 1.00em;">&#x00A0;</div>
    /dev/stdout device can be used to send log messages to the standard output
      (for example to log them with daemontools splogger).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>pid</b> = file (Unix only)</dt>
  <dd class="It-tag">pid file location
    <div style="height: 1.00em;">&#x00A0;</div>
    If the argument is empty, then no pid file will be created.
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>pid</i> path is relative to <i>chroot</i> directory if specified.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>RNDbytes</b> = bytes</dt>
  <dd class="It-tag">bytes to read from random seed files
    <div style="height: 1.00em;">&#x00A0;</div>
    Number of bytes of data read from random seed files. With SSL versions less
      than <b>0.9.5a</b>, also determines how many bytes of data are considered
      sufficient to seed the PRNG. More recent <b>OpenSSL</b> versions have a
      builtin function to determine when sufficient randomness is
    available.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>RNDfile</b> = file</dt>
  <dd class="It-tag">path to file with random seed data
    <div style="height: 1.00em;">&#x00A0;</div>
    The SSL library will use data from this file first to seed the random number
      generator.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>RNDoverwrite</b> = yes | no</dt>
  <dd class="It-tag">overwrite the random seed files with new random data
    <div style="height: 1.00em;">&#x00A0;</div>
    default: yes</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>service</b> = servicename (Unix only)</dt>
  <dd class="It-tag">use specified string as <i>inetd</i> mode service name for
      TCP Wrapper library
    <div style="height: 1.00em;">&#x00A0;</div>
    default: stunnel</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>setgid</b> = groupname (Unix only)</dt>
  <dd class="It-tag"><i>setgid()</i> to groupname in daemon mode and clears all
      other groups</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>setuid</b> = username (Unix only)</dt>
  <dd class="It-tag"><i>setuid()</i> to username in daemon mode</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>socket</b> = a|l|r:option=value[:value]</dt>
  <dd class="It-tag">Set an option on accept/local/remote socket
    <div style="height: 1.00em;">&#x00A0;</div>
    The values for linger option are l_onof:l_linger. The values for time are
      tv_sec:tv_usec.
    <div style="height: 1.00em;">&#x00A0;</div>
    Examples:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    socket = l:SO_LINGER=1:60
        set one minute timeout for closing local socket
    socket = r:SO_OOBINLINE=yes
        place out-of-band data directly into the
        receive data stream for remote sockets
    socket = a:SO_REUSEADDR=no
        disable address reuse (enabled by default)
    socket = a:SO_BINDTODEVICE=lo
        only accept connections on loopback interface
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>syslog</b> = yes | no (Unix only)</dt>
  <dd class="It-tag">enable logging via syslog
    <div style="height: 1.00em;">&#x00A0;</div>
    default: yes</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>taskbar</b> = yes | no (WIN32 only)</dt>
  <dd class="It-tag">enable the taskbar icon
    <div style="height: 1.00em;">&#x00A0;</div>
    default: yes</dd>
</dl>
<h2 class="Ss" title="Ss" id="SERVICE-LEVEL_OPTIONS"><a class="selflink" href="#SERVICE-LEVEL_OPTIONS">SERVICE-LEVEL
  OPTIONS</a></h2>
Each configuration section begins with service name in square brackets. The
  service name is used for libwrap (TCP Wrappers) access control and lets you
  distinguish <b>stunnel</b> services in your log files.
<div class="Pp"></div>
Note that if you wish to run <b>stunnel</b> in <i>inetd</i> mode (where it is
  provided a network socket by a server such as <i>inetd</i>, <i>xinetd</i>, or
  <i>tcpserver</i>) then you should read the section entitled <i>INETD MODE</i>
  below.
<dl class="Bl-tag">
  <dt class="It-tag"><b>accept</b> = address</dt>
  <dd class="It-tag">accept connections on specified address
    <div style="height: 1.00em;">&#x00A0;</div>
    If no host specified, defaults to all IPv4 addresses for the local host.
    <div style="height: 1.00em;">&#x00A0;</div>
    To listen on all IPv6 addresses use:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    accept = :::port
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CApath</b> = directory</dt>
  <dd class="It-tag">Certificate Authority directory
    <div style="height: 1.00em;">&#x00A0;</div>
    This is the directory in which <b>stunnel</b> will look for certificates
      when using the <i>verify</i>. Note that the certificates in this directory
      should be named XXXXXXXX.0 where XXXXXXXX is the hash value of the DER
      encoded subject of the cert.
    <div style="height: 1.00em;">&#x00A0;</div>
    The hash algorithm has been changed in <b>OpenSSL 1.0.0</b>. It is required
      to c_rehash the directory on upgrade from <b>OpenSSL 0.x.x</b> to
      <b>OpenSSL 1.x.x</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>CApath</i> path is relative to <i>chroot</i> directory if
    specified.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CAfile</b> = certfile</dt>
  <dd class="It-tag">Certificate Authority file
    <div style="height: 1.00em;">&#x00A0;</div>
    This file contains multiple CA certificates, used with the
    <i>verify</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>cert</b> = pemfile</dt>
  <dd class="It-tag">certificate chain PEM file name
    <div style="height: 1.00em;">&#x00A0;</div>
    A PEM is always needed in server mode. Specifying this flag in client mode
      will use this certificate chain as a client side certificate chain. Using
      client side certs is optional. The certificates must be in PEM format and
      must be sorted starting with the certificate to the highest level (root
      CA).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ciphers</b> = cipherlist</dt>
  <dd class="It-tag">Select permitted SSL ciphers
    <div style="height: 1.00em;">&#x00A0;</div>
    A colon delimited list of the ciphers to allow in the SSL connection. For
      example DES-CBC3-SHA:IDEA-CBC-MD5</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>client</b> = yes | no</dt>
  <dd class="It-tag">client mode (remote service uses SSL)
    <div style="height: 1.00em;">&#x00A0;</div>
    default: no (server mode)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>connect</b> = address</dt>
  <dd class="It-tag">connect to a remote address
    <div style="height: 1.00em;">&#x00A0;</div>
    If no host is specified, the host defaults to localhost.
    <div style="height: 1.00em;">&#x00A0;</div>
    Multiple <b>connect</b> options are allowed in a single service section.
    <div style="height: 1.00em;">&#x00A0;</div>
    If host resolves to multiple addresses and/or if multiple <i>connect</i>
      options are specified, then the remote address is chosen using a
      round-robin algorithm.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CRLpath</b> = directory</dt>
  <dd class="It-tag">Certificate Revocation Lists directory
    <div style="height: 1.00em;">&#x00A0;</div>
    This is the directory in which <b>stunnel</b> will look for CRLs when using
      the <i>verify</i>. Note that the CRLs in this directory should be named
      XXXXXXXX.r0 where XXXXXXXX is the hash value of the CRL.
    <div style="height: 1.00em;">&#x00A0;</div>
    The hash algorithm has been changed in <b>OpenSSL 1.0.0</b>. It is required
      to c_rehash the directory on upgrade from <b>OpenSSL 0.x.x</b> to
      <b>OpenSSL 1.x.x</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>CRLpath</i> path is relative to <i>chroot</i> directory if
    specified.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>CRLfile</b> = certfile</dt>
  <dd class="It-tag">Certificate Revocation Lists file
    <div style="height: 1.00em;">&#x00A0;</div>
    This file contains multiple CRLs, used with the <i>verify</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>curve</b> = nid</dt>
  <dd class="It-tag">specify ECDH curve name for server
    <div style="height: 1.00em;">&#x00A0;</div>
    To get a list of supported curves use:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    openssl ecparam -list_curves
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    default: prime256v1</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>delay</b> = yes | no</dt>
  <dd class="It-tag">delay DNS lookup for 'connect' option
    <div style="height: 1.00em;">&#x00A0;</div>
    This option is useful for dynamic DNS, or when DNS is not available during
      <b>stunnel</b> startup (road warrior VPN, dial-up configurations).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>engineNum</b> = engine number</dt>
  <dd class="It-tag">select engine number to read private key
    <div style="height: 1.00em;">&#x00A0;</div>
    The engines are numbered starting from 1.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>exec</b> = executable_path</dt>
  <dd class="It-tag">execute local inetd-type program
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>exec</i> path is relative to <i>chroot</i> directory if specified.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>execargs</b> = $0 $1 $2 ...</dt>
  <dd class="It-tag">arguments for <i>exec</i> including program name ($0)
    <div style="height: 1.00em;">&#x00A0;</div>
    Quoting is currently not supported. Arguments are separated with arbitrary
      number of whitespaces.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>failover</b> = rr | prio</dt>
  <dd class="It-tag">Failover strategy for multiple &quot;connect&quot; targets.
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    rr (round robin) - fair load distribution
    prio (priority) - use the order specified in config file
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    default: rr</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>ident</b> = username</dt>
  <dd class="It-tag">use IDENT (RFC 1413) username checking</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>key</b> = keyfile</dt>
  <dd class="It-tag">private key for certificate specified with <i>cert</i>
      option
    <div style="height: 1.00em;">&#x00A0;</div>
    Private key is needed to authenticate certificate owner. Since this file
      should be kept secret it should only be readable to its owner. On Unix
      systems you can use the following command:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    chmod 600 keyfile
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    default: value of <i>cert</i> option</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>libwrap</b> = yes | no</dt>
  <dd class="It-tag">Enable or disable the use of /etc/hosts.allow and
      /etc/hosts.deny.
    <div style="height: 1.00em;">&#x00A0;</div>
    default: yes</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>local</b> = host</dt>
  <dd class="It-tag">IP of the outgoing interface is used as source for remote
      connections. Use this option to bind a static local IP address,
    instead.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>sni</b> = service_name:server_name_pattern (server
    mode)</dt>
  <dd class="It-tag">Use the service as a slave service (a name-based virtual
      server) for Server Name Indication TLS extension (RFC 3546).
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>service_name</i> specifies the master service that accepts client
      connections with <i>accept</i> option. <i>server_name_pattern</i>
      specifies the host name to be redirected. The pattern may start with '*'
      character, e.g. '*.example.com'. Multiple slave services are normally
      specified for a single master service. <i>sni</i> option can also be
      specified more than once within a single slave service.
    <div style="height: 1.00em;">&#x00A0;</div>
    This service, as well as the master service, may not be configured in client
      mode.
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>connect</i> option of the slave service is ignored when <i>protocol</i>
      option is specified, as <i>protocol</i> connects remote host before TLS
      handshake.
    <div style="height: 1.00em;">&#x00A0;</div>
    Libwrap checks (Unix only) are performed twice: with master service name
      after TCP connection is accepted, and with slave service name during TLS
      handshake.
    <div style="height: 1.00em;">&#x00A0;</div>
    Option <i>sni</i> is only available when compiled with <b>OpenSSL 1.0.0</b>
      and later.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>sni</b> = server_name (client mode)</dt>
  <dd class="It-tag">Use the parameter as the value of TLS Server Name
      Indication (RFC 3546) extension.
    <div style="height: 1.00em;">&#x00A0;</div>
    Option <i>sni</i> is only available when compiled with <b>OpenSSL 1.0.0</b>
      and later.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>OCSP</b> = url</dt>
  <dd class="It-tag">select OCSP server for certificate verification</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>OCSPflag</b> = flag</dt>
  <dd class="It-tag">specify OCSP server flag
    <div style="height: 1.00em;">&#x00A0;</div>
    Several <i>OCSPflag</i> can be used to specify multiple flags.
    <div style="height: 1.00em;">&#x00A0;</div>
    currently supported flags: NOCERTS, NOINTERN NOSIGS, NOCHAIN, NOVERIFY,
      NOEXPLICIT, NOCASIGN, NODELEGATED, NOCHECKS, TRUSTOTHER, RESPID_KEY,
      NOTIME</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>options</b> = SSL_options</dt>
  <dd class="It-tag"><b>OpenSSL</b> library options
    <div style="height: 1.00em;">&#x00A0;</div>
    The parameter is the <b>OpenSSL</b> option name as described in the
      <i></i><i>SSL_CTX_set_options</i><i>(3ssl)</i> manual, but without
      <i>SSL_OP_</i> prefix. Several <i>options</i> can be used to specify
      multiple options.
    <div style="height: 1.00em;">&#x00A0;</div>
    For example for compatibility with erroneous Eudora SSL implementation the
      following option can be used:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    options = DONT_INSERT_EMPTY_FRAGMENTS
    </pre>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>protocol</b> = proto</dt>
  <dd class="It-tag">application protocol to negotiate SSL
    <div style="height: 1.00em;">&#x00A0;</div>
    This option enables initial, protocol-specific negotiation of the SSL/TLS
      encryption. <i>protocol</i> option should not be used with SSL encryption
      on a separate port.
    <div style="height: 1.00em;">&#x00A0;</div>
    Currently supported protocols:</dd>
</dl>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><i>cifs</i></dt>
  <dd class="It-tag">Proprietary (undocummented) extension of CIFS protocol
      implemented in Samba. Support for this extension was dropped in Samba
      3.0.0.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>connect</i></dt>
  <dd class="It-tag">Based on RFC 2817 - <i>Upgrading to TLS Within
      HTTP/1.1</i>, section 5.2 - <i>Requesting a Tunnel with CONNECT</i>
    <div style="height: 1.00em;">&#x00A0;</div>
    This protocol is only supported in client mode.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>imap</i></dt>
  <dd class="It-tag">Based on RFC 2595 - <i>Using TLS with IMAP, POP3 and
      ACAP</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>nntp</i></dt>
  <dd class="It-tag">Based on RFC 4642 - <i>Using Transport Layer Security (TLS)
      with Network News Transfer Protocol (NNTP)</i>
    <div style="height: 1.00em;">&#x00A0;</div>
    This protocol is only supported in client mode.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>pgsql</i></dt>
  <dd class="It-tag">Based on
      http://www.postgresql.org/docs/8.3/static/protocol-flow.html#AEN73982</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>pop3</i></dt>
  <dd class="It-tag">Based on RFC 2449 - <i>POP3 Extension Mechanism</i></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>proxy</i></dt>
  <dd class="It-tag">Haproxy client IP address
      http://haproxy.1wt.eu/download/1.5/doc/proxy-protocol.txt</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>smtp</i></dt>
  <dd class="It-tag">Based on RFC 2487 - <i>SMTP Service Extension for Secure
      SMTP over TLS</i></dd>
</dl>
</div>
<div style="margin-left: 4.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>protocolAuthentication</b> = auth_type</dt>
  <dd class="It-tag">authentication type for protocol negotiations
    <div style="height: 1.00em;">&#x00A0;</div>
    currently supported: basic, NTLM
    <div style="height: 1.00em;">&#x00A0;</div>
    Currently authentication type only applies to the 'connect' protocol.
    <div style="height: 1.00em;">&#x00A0;</div>
    default: basic</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>protocolHost</b> = host:port</dt>
  <dd class="It-tag">destination address for protocol negotiations
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>protocolHost</i> specifies the final SSL server to be connected by the
      proxy, and not the proxy server directly connected by <b>stunnel</b>. The
      proxy server should be specified with the 'connect' option.
    <div style="height: 1.00em;">&#x00A0;</div>
    Currently protocol destination address only applies to 'connect'
    protocol.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>protocolPassword</b> = password</dt>
  <dd class="It-tag">password for protocol negotiations</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>protocolUsername</b> = username</dt>
  <dd class="It-tag">username for protocol negotiations</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>pty</b> = yes | no (Unix only)</dt>
  <dd class="It-tag">allocate pseudo terminal for 'exec' option</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>renegotiation</b> = yes | no</dt>
  <dd class="It-tag">support SSL renegotiation
    <div style="height: 1.00em;">&#x00A0;</div>
    Applications of the SSL renegotiation include some authentication scenarios,
      or re-keying long lasting connections.
    <div style="height: 1.00em;">&#x00A0;</div>
    On the other hand this feature can facilitate a trivial CPU-exhaustion DoS
      attack:
    <div style="height: 1.00em;">&#x00A0;</div>
    http://vincent.bernat.im/en/blog/2011-ssl-dos-mitigation.html
    <div style="height: 1.00em;">&#x00A0;</div>
    Please note that disabling SSL renegotiation does not fully mitigate this
      issue.
    <div style="height: 1.00em;">&#x00A0;</div>
    default: yes (if supported by <b>OpenSSL</b>)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>reset</b> = yes | no</dt>
  <dd class="It-tag">attempt to use TCP RST flag to indicate an error
    <div style="height: 1.00em;">&#x00A0;</div>
    This option is not supported on some platforms.
    <div style="height: 1.00em;">&#x00A0;</div>
    default: yes</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>retry</b> = yes | no</dt>
  <dd class="It-tag">reconnect a connect+exec section after it's disconnected
    <div style="height: 1.00em;">&#x00A0;</div>
    default: no</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>sessionCacheSize</b> = size</dt>
  <dd class="It-tag">session cache size
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>sessionCacheSize</i> specifies the maximum number of the internal
      session cache entries.
    <div style="height: 1.00em;">&#x00A0;</div>
    The value of 0 can be used for unlimited size. It is not recommended for
      production use due to the risk of memory exhaustion DoS attack.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>sessionCacheTimeout</b> = timeout</dt>
  <dd class="It-tag">session cache timeout
    <div style="height: 1.00em;">&#x00A0;</div>
    This is the number of seconds to keep cached SSL sessions.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>sessiond</b> = host:port</dt>
  <dd class="It-tag">address of sessiond SSL cache server</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>sslVersion</b> = version</dt>
  <dd class="It-tag">select version of SSL protocol
    <div style="height: 1.00em;">&#x00A0;</div>
    Allowed options: all, SSLv2, SSLv3, TLSv1, TLSv1.1, TLSv1.2</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>stack</b> = bytes (except for FORK model)</dt>
  <dd class="It-tag">thread stack size</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>TIMEOUTbusy</b> = seconds</dt>
  <dd class="It-tag">time to wait for expected data</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>TIMEOUTclose</b> = seconds</dt>
  <dd class="It-tag">time to wait for close_notify (set to 0 for buggy
    MSIE)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>TIMEOUTconnect</b> = seconds</dt>
  <dd class="It-tag">time to wait to connect a remote host</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>TIMEOUTidle</b> = seconds</dt>
  <dd class="It-tag">time to keep an idle connection</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>transparent</b> = none | source | destination | both
    (Unix only)</dt>
  <dd class="It-tag">enable transparent proxy support on selected platforms
    <div style="height: 1.00em;">&#x00A0;</div>
    Supported values:</dd>
</dl>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag"><i>none</i></dt>
  <dd class="It-tag">Disable transparent proxy support. This is the
    default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>source</i></dt>
  <dd class="It-tag">Re-write address to appear as if wrapped daemon is
      connecting from the SSL client machine instead of the machine running
      <b>stunnel</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option is currently available in:</dd>
</dl>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">Remote mode (<i>connect</i> option) on <i>Linux
    &gt;=2.6.28</i></dt>
  <dd class="It-tag">This configuration requires <b>stunnel</b> to be executed
      as root and without <i>setuid</i> option.
    <div style="height: 1.00em;">&#x00A0;</div>
    This configuration requires the following setup for iptables and routing
      (possibly in /etc/rc.local or equivalent file):
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    iptables -t mangle -N DIVERT
    iptables -t mangle -A PREROUTING -p tcp -m socket -j DIVERT
    iptables -t mangle -A DIVERT -j MARK --set-mark 1
    iptables -t mangle -A DIVERT -j ACCEPT
    ip rule add fwmark 1 lookup 100
    ip route add local 0.0.0.0/0 dev lo table 100
    echo 0 &gt;/proc/sys/net/ipv4/conf/lo/rp_filter
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>stunnel</b> must also to be executed as root and without <i>setuid</i>
      option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Remote mode (<i>connect</i> option) on <i>Linux
    2.2.x</i></dt>
  <dd class="It-tag">This configuration requires kernel to be compiled with
      <i>transparent proxy</i> option. Connected service must be installed on a
      separate host. Routing towards the clients has to go through the
      <b>stunnel</b> box.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>stunnel</b> must also to be executed as root and without <i>setuid</i>
      option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Remote mode (<i>connect</i> option) on <i>FreeBSD
    &gt;=8.0</i></dt>
  <dd class="It-tag">This configuration requires additional firewall and routing
      setup. <b>stunnel</b> must also to be executed as root and without
      <i>setuid</i> option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">Local mode (<i>exec</i> option)</dt>
  <dd class="It-tag">This configuration works by pre-loading
      <i>libstunnel.so</i> shared library. _RLD_LIST environment variable is
      used on Tru64, and LD_PRELOAD variable on other platforms.</dd>
</dl>
</div>
<div style="margin-left: 4.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><i>destination</i></dt>
  <dd class="It-tag">Original destination is used instead of <i>connect</i>
      option.
    <div style="height: 1.00em;">&#x00A0;</div>
    A service section for transparent destination may look like this:
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    [transparent]
    client=yes
    accept=&lt;stunnel_port&gt;
    transparent=destination
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    This configuration requires the following setup for iptables (possibly in
      /etc/rc.local or equivalent file):
    <div style="height: 1.00em;">&#x00A0;</div>
    <pre>
    /sbin/iptables -I INPUT -i eth0 -p tcp --dport &lt;stunnel_port&gt; -j ACCEPT
    /sbin/iptables -t nat -I PREROUTING -i eth0 -p tcp --dport &lt;redirected_port&gt; -j DNAT --to-destination &lt;local_ip&gt;:&lt;stunnel_port&gt;
    </pre>
    <div style="height: 1.00em;">&#x00A0;</div>
    Transparent destination option is currently only supported on Linux.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>both</i></dt>
  <dd class="It-tag">Use both <i>source</i> and <i>destination</i> transparent
      proxy.</dd>
</dl>
</div>
<div style="margin-left: 4.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
Two legacy options are also supported for backward compatibility:
<dl class="Bl-tag">
  <dt class="It-tag"><i>yes</i></dt>
  <dd class="It-tag">This options has been renamed to <i>source</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>no</i></dt>
  <dd class="It-tag">This options has been renamed to <i>none</i>.</dd>
</dl>
</div>
<div style="margin-left: 4.00ex;"></div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>verify</b> = level</dt>
  <dd class="It-tag">verify peer certificate</dd>
</dl>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">level 0</dt>
  <dd class="It-tag">Request and ignore peer certificate.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">level 1</dt>
  <dd class="It-tag">Verify peer certificate if present.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">level 2</dt>
  <dd class="It-tag">Verify peer certificate.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">level 3</dt>
  <dd class="It-tag">Verify peer with locally installed certificate.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">level 4</dt>
  <dd class="It-tag">Ignore CA chain and only verify peer certificate.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">default</dt>
  <dd class="It-tag">No verify.</dd>
</dl>
</div>
<div style="margin-left: 4.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
It is important to understand, that this option was solely designed for access
  control and not for authorization. Specifically for level 2 every non-revoked
  certificate is accepted regardless of its Common Name. For this reason a
  dedicated CA should be used with level 2, and not a generic CA commonly used
  for webservers. Level 3 is preferred for point-to-point connections.</div>
<h1 class="Sh" title="Sh" id="RETURN_VALUE"><a class="selflink" href="#RETURN_VALUE">RETURN
  VALUE</a></h1>
<b>stunnel</b> returns zero on success, non-zero on error.
<h1 class="Sh" title="Sh" id="SIGNALS"><a class="selflink" href="#SIGNALS">SIGNALS</a></h1>
The following signals can be used to control <b>stunnel</b> in Unix environment:
<dl class="Bl-tag">
  <dt class="It-tag">SIGHUP</dt>
  <dd class="It-tag">Force a reload of the configuration file.
    <div style="height: 1.00em;">&#x00A0;</div>
    Some global options will not be reloaded:</dd>
</dl>
<div style="margin-left: 4.00ex;">
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">chroot</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">foreground</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">pid</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">setgid</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">setuid</dd>
</dl>
</div>
<div style="margin-left: 4.00ex;">
<div style="height: 1.00em;">&#x00A0;</div>
The use of 'setuid' option will also prevent <b>stunnel</b> from binding
  privileged (&lt;1024) ports during configuration reloading.
<div style="height: 1.00em;">&#x00A0;</div>
When 'chroot' option is used, <b>stunnel</b> will look for all its files
  (including configuration file, certificates, log file and pid file) within the
  chroot jail.</div>
<dl class="Bl-tag">
  <dt class="It-tag">SIGUSR1</dt>
  <dd class="It-tag">Close and reopen <b>stunnel</b> log file. This function can
      be used for log rotation.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">SIGTERM, SIGQUIT, SIGINT</dt>
  <dd class="It-tag">Shut <b>stunnel</b> down.</dd>
</dl>
<div class="Pp"></div>
The result of sending any other signals to the server is undefined.
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
In order to provide SSL encapsulation to your local <i>imapd</i> service, use
<div class="Pp"></div>
<pre>
    [imapd]
    accept = 993
    exec = /usr/sbin/imapd
    execargs = imapd
</pre>
<div class="Pp"></div>
If you want to provide tunneling to your <i>pppd</i> daemon on port 2020, use
  something like
<div class="Pp"></div>
<pre>
    [vpn]
    accept = 2020
    exec = /usr/sbin/pppd
    execargs = pppd local
    pty = yes
</pre>
<div class="Pp"></div>
If you want to use <b>stunnel</b> in <i>inetd</i> mode to launch your imapd
  process, you'd use this <i>stunnel.conf</i>. Note there must be no
  <i>[service_name]</i> section.
<div class="Pp"></div>
<pre>
    exec = /usr/sbin/imapd
    execargs = imapd
</pre>
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
<h2 class="Ss" title="Ss" id="RESTRICTIONS"><a class="selflink" href="#RESTRICTIONS">RESTRICTIONS</a></h2>
<b>stunnel</b> cannot be used for the FTP daemon because of the nature of the
  FTP protocol which utilizes multiple ports for data transfers. There are
  available SSL enabled versions of FTP and telnet daemons, however.
<h2 class="Ss" title="Ss" id="INETD_MODE"><a class="selflink" href="#INETD_MODE">INETD
  MODE</a></h2>
The most common use of <b>stunnel</b> is to listen on a network port and
  establish communication with either a new port via the connect option, or a
  new program via the <i>exec</i> option. However there is a special case when
  you wish to have some other program accept incoming connections and launch
  <b>stunnel</b>, for example with <i>inetd</i>, <i>xinetd</i>, or
  <i>tcpserver</i>.
<div class="Pp"></div>
For example, if you have the following line in <i>inetd.conf</i>:
<div class="Pp"></div>
<pre>
    imaps stream tcp nowait root /usr/bin/stunnel stunnel /etc/stunnel/imaps.conf
</pre>
<div class="Pp"></div>
In these cases, the <i>inetd</i>-style program is responsible for binding a
  network socket ( <i>imaps</i> above) and handing it to <b>stunnel</b> when a
  connection is received. Thus you do not want <b>stunnel</b> to have any
  <i>accept</i> option. All the <i>Service Level Options</i> should be placed in
  the global options section, and no <i>[service_name]</i> section will be
  present. See the <i>EXAMPLES</i> section for example configurations.
<h2 class="Ss" title="Ss" id="CERTIFICATES"><a class="selflink" href="#CERTIFICATES">CERTIFICATES</a></h2>
Each SSL enabled daemon needs to present a valid X.509 certificate to the peer.
  It also needs a private key to decrypt the incoming data. The easiest way to
  obtain a certificate and a key is to generate them with the free
  <b>OpenSSL</b> package. You can find more information on certificates
  generation on pages listed below.
<div class="Pp"></div>
The order of contents of the <i>.pem</i> file is important. It should contain
  the unencrypted private key first, then a signed certificate (not certificate
  request). There should be also empty lines after certificate and private key.
  Plaintext certificate information appended on the top of generated certificate
  should be discarded. So the file should look like this:
<div class="Pp"></div>
<pre>
    -----BEGIN RSA PRIVATE KEY-----
    [encoded key]
    -----END RSA PRIVATE KEY-----
    [empty line]
    -----BEGIN CERTIFICATE-----
    [encoded certificate]
    -----END CERTIFICATE-----
    [empty line]
</pre>
<h2 class="Ss" title="Ss" id="RANDOMNESS"><a class="selflink" href="#RANDOMNESS">RANDOMNESS</a></h2>
<b>stunnel</b> needs to seed the PRNG (pseudo random number generator) in order
  for SSL to use good randomness. The following sources are loaded in order
  until sufficient random data has been gathered:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The file specified with the <i>RNDfile</i> flag.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The file specified by the RANDFILE environment variable, if
      set.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The file .rnd in your home directory, if RANDFILE not
    set.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The file specified with '--with-random' at compile
    time.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The contents of the screen if running on Windows.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The egd socket specified with the <i>EGD</i> flag.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The egd socket specified with '--with-egd-sock' at compile
      time.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">The /dev/urandom device.</dd>
</dl>
<div class="Pp"></div>
With recent ( <b>OpenSSL 0.9.5a</b> or later) version of SSL it will stop
  loading random data automatically when sufficient entropy has been gathered.
  With previous versions it will continue to gather from all the above sources
  since no SSL function exists to tell when enough data is available.
<div class="Pp"></div>
Note that on Windows machines that do not have console user interaction (mouse
  movements, creating windows, etc.) the screen contents are not variable enough
  to be sufficient, and you should provide a random file for use with the
  <i>RNDfile</i> flag.
<div class="Pp"></div>
Note that the file specified with the <i>RNDfile</i> flag should contain random
  data -- that means it should contain different information each time
  <b>stunnel</b> is run. This is handled automatically unless the
  <i>RNDoverwrite</i> flag is used. If you wish to update this file manually,
  the <i>openssl rand</i> command in recent versions of <b>OpenSSL</b>, would be
  useful.
<div class="Pp"></div>
Important note: If /dev/urandom is available, <b>OpenSSL</b> often seeds the
  PRNG with it while checking the random state. On systems with /dev/urandom
  <b>OpenSSL</b> is likely to use it even though it is listed at the very bottom
  of the list above. This is the behaviour of <b>OpenSSL</b> and not
  <b>stunnel</b>.
<h2 class="Ss" title="Ss" id="DH_PARAMETERS"><a class="selflink" href="#DH_PARAMETERS">DH
  PARAMETERS</a></h2>
Stunnel 4.40 and later contains hardcoded 2048-bit DH parameters.
<div class="Pp"></div>
It is also possible to specify DH parameters in the certificate file:
<div class="Pp"></div>
<pre>
    openssl dhparam 2048 &gt;&gt; stunnel.pem
</pre>
<div class="Pp"></div>
DH parameter generation may take several minutes.
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><i>stunnel.conf</i></dt>
  <dd class="It-tag"><b>stunnel</b> configuration file</dd>
</dl>
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Option <i>execargs</i> and Win32 command line does not support quoting.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><i>tcpd</i>(8)</dt>
  <dd class="It-tag">access control facility for internet services</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>inetd</i>(8)</dt>
  <dd class="It-tag">internet 'super-server'</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>http://www.stunnel.org/</i></dt>
  <dd class="It-tag"><b>stunnel</b> homepage</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>http://www.openssl.org/</i></dt>
  <dd class="It-tag"><b>OpenSSL</b> project website</dd>
</dl>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag">Micha&#x0142; Trojnara</dt>
  <dd class="It-tag">&lt;<i>Michal.Trojnara@mirt.net</i>&gt;</dd>
</dl>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2013.03.20</td>
    <td class="foot-os">4.56</td>
  </tr>
</table>
</body>
</html>
