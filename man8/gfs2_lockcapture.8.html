<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>gfs2_lockcapture(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">gfs2_lockcapture(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">gfs2_lockcapture(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
gfs2_lockcapture - capture locking information from GFS2 file systems and DLM.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>gfs2_lockcapture [-dqyP] [-o <i>output directory]</i> [-r <i>number of
  runs]</i> [-s <i>seconds to sleep]</i> [-n <i>name of GFS2 file
  system]</i></b>
<div class="Pp"></div>
<b>gfs2_lockcapture [-dqyi]</b>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<i>gfs2_lockcapture</i> is used to capture the GFS2 lockdump data and
  corresponding DLM data for GFS2 file systems. The number of captures and their
  frequency can be configured. By default all of the mounted GFS2 file systems
  will have their data collected unless GFS2 file systems are specified.
<div class="Pp"></div>
Please note that sysrq -t (thread) and -m (memory) dumps and the pid directories
  in /proc are collected unless they are disabled with the -P option.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h, --help</b></dt>
  <dd class="It-tag">Prints out a short usage message and exits.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d, --debug</b></dt>
  <dd class="It-tag">Enables debug logging.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-q, --quiet</b></dt>
  <dd class="It-tag">Disables logging to console.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-y, --no_ask</b></dt>
  <dd class="It-tag">Disables all questions and assumes yes.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i, --info</b></dt>
  <dd class="It-tag">Prints information about the mounted GFS2 file
    systems.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-P, --disable_process_gather</b></dt>
  <dd class="It-tag">The gathering of process information will be disabled.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-o </b><i>&lt;output directory&gt;,
    </i><b>--path_to_output_dir</b>= <i>&lt;output directory&gt;</i></dt>
  <dd class="It-tag">The directory where all the collect data will be
    stored.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-r </b><i>&lt;number of runs&gt;,
    </i><b>--num_of_runs</b>= <i>&lt;number of runs&gt;</i></dt>
  <dd class="It-tag">The number of runs capturing the lockdump data. The default
      is 3 runs.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s </b><i>&lt;seconds to sleep&gt;,
    </i><b>--seconds_sleep</b>= <i>&lt;seconds to sleep&gt;</i></dt>
  <dd class="It-tag">The number of seconds to sleep between runs of capturing
      the lockdump data. The default is 120 seconds.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n </b><i>&lt;name of GFS2 filesystem&gt;,
    </i><b>--fs_name</b>= <i>&lt;name of GFS2 filesystem&gt;</i></dt>
  <dd class="It-tag">The name of the GFS2 filesystem(s) that will have their
      lockdump data captured. By default, all mounted GFS2 file systems will
      have their data captured.</dd>
</dl>
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
The output of the following commands will be captured:
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">uname -a</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">uptime</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">ps h -AL -o &quot;tid,s,cmd&quot;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">df -h</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">lsof</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">mount -l</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">dlm_tool ls</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">dlm_tool lockdebug -v -s -w &lt;lockspace name&gt;</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">echo &quot;t&quot; &gt; /proc/sysrq-trigger (If
      /proc/1/stack does not exist)</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag">&#x2022;</dt>
  <dd class="It-tag">echo &quot;m&quot; &gt; /proc/sysrq-trigger (If
      /proc/1/stack does not exist)
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
<pre>
Shane Bradley &lt;sbradley@fedoraproject.org&gt;
</pre>
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
<i>/proc/mounts</i>
<div>&#x00A0;</div>
<i>/proc/slabinfo</i>
<div>&#x00A0;</div>
<i>/sys/kernel/config/dlm/cluster/lkbtbl_size</i>
<div>&#x00A0;</div>
<i>/sys/kernel/config/dlm/cluster/dirtbl_size</i>
<div>&#x00A0;</div>
<i>/sys/kernel/config/dlm/cluster/rsbtbl_size</i>
<div>&#x00A0;</div>
<i>/sys/kernel/debug/gfs2/</i>
<div>&#x00A0;</div>
<i>/sys/kernel/debug/dlm/</i>
<div>&#x00A0;</div>
<i>/proc/&lt;int&gt;/</i> (If /proc/1/stack does exists)
<div>&#x00A0;</div>
<i>/var/log/messages</i>
<div>&#x00A0;</div>
<i>/var/log/cluster/</i>
<div>&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
