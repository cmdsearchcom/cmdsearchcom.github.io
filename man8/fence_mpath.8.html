<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:11:05 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p style="margin-top: 1em">FENCE_AGENT(8) System
Manager&rsquo;s Manual FENCE_AGENT(8)</p>

<p style="margin-top: 1em">NAME <br>
fence_mpath - Fence agent for multipath persistent
reservation</p>

<p style="margin-top: 1em">DESCRIPTION <br>
fence_mpath is an I/O fencing agent that uses SCSI-3
persistent reservations to control access multipath devices.
Underlying devices must support SCSI-3 persistent
reservations <br>
(SPC-3 or greater) as well as the
&quot;preempt-and-abort&quot; subcommand. The fence_mpath
agent works by having a unique key for each node that has to
be set in /etc/multipath.conf. <br>
Once registered, a single node will become the reservation
holder by creating a &quot;write exclusive, registrants
only&quot; reservation on the device(s). The result is that
only regis&acirc; <br>
tered nodes may write to the device(s). When a node failure
occurs, the fence_mpath agent will remove the key belonging
to the failed node from the device(s). The failed node <br>
will no longer be able to write to the device(s). A manual
reboot is required.</p>

<p style="margin-top: 1em">fence_mpath accepts options on
the command line as well as from stdin. Fenced sends
parameters through stdin when it execs the agent.
fence_mpath can be run by itself with com&acirc; <br>
mand line options. This is useful for testing and for
turning outlets on or off from scripts.</p>

<p style="margin-top: 1em">Vendor URL:
https://www.sourceware.org/dm/</p>

<p style="margin-top: 1em">PARAMETERS</p>

<p style="margin-top: 1em">-o, --action=[action] <br>
Fencing Action (Default Value: off)</p>

<p style="margin-top: 1em">-k, --key=[key] <br>
Key to use for the current operation. This key should be
unique to a node and have to be written in
/etc/multipath.conf. For the &quot;on&quot; action, the key
specifies the key use <br>
to register the local node. For the &quot;off&quot; action,
this key specifies the key to be removed from the device(s).
This parameter is always required.</p>

<p style="margin-top: 1em">-d, --devices=[devices] <br>
List of devices to use for current operation. Devices can be
comma-separated list of device-mapper multipath devices (eg.
/dev/mapper/3600508b400105df70000e00000ac0000 or <br>
/dev/mapper/mpath1). Each device must support SCSI-3
persistent reservations.</p>

<p style="margin-top: 1em">-v, --verbose <br>
Verbose mode</p>

<p style="margin-top: 1em">-D, --debug-file=[debugfile]
<br>
Write debug information to given file</p>

<p style="margin-top: 1em">-V, --version <br>
Display version information and exit</p>

<p style="margin-top: 1em">-h, --help <br>
Display help and exit</p>

<p style="margin-top: 1em">--power-wait=[seconds] <br>
Wait X seconds after issuing ON/OFF (Default Value: 0)</p>

<p style="margin-top: 1em">--login-timeout=[seconds] <br>
Wait X seconds for cmd prompt after login (Default Value:
5)</p>

<p style="margin-top: 1em">--power-timeout=[seconds] <br>
Test X seconds for status change after ON/OFF (Default
Value: 20)</p>

<p style="margin-top: 1em">--delay=[seconds] <br>
Wait X seconds before fencing is started (Default Value:
0)</p>

<p style="margin-top: 1em">--mpathpersist-path=[path] <br>
Path to mpathpersist binary (Default Value:
/usr/sbin/mpathpersist)</p>

<p style="margin-top: 1em">--shell-timeout=[seconds] <br>
Wait X seconds for cmd prompt after issuing command (Default
Value: 3)</p>

<p style="margin-top: 1em">--store-path=[path] <br>
Path to directory where fence agent can store information
(Default Value: /var/run/cluster)</p>

<p style="margin-top: 1em">--retry-on=[attempts] <br>
Count of attempts to retry power on (Default Value: 1)</p>

<p style="margin-top: 1em">--use-sudo <br>
Use sudo (without password) when calling 3rd party
sotfware.</p>

<p style="margin-top: 1em">ACTIONS</p>

<p style="margin-top: 1em">on Power on machine.</p>

<p style="margin-top: 1em">off Power off machine.</p>

<p style="margin-top: 1em">status This returns the status
of the plug/virtual machine.</p>

<p style="margin-top: 1em">list List available plugs with
aliases/virtual machines if there is support for more then
one device. Returns N/A otherwise.</p>

<p style="margin-top: 1em">list-status <br>
List available plugs with aliases/virtual machines and their
power state if it can be obtained without additional
commands.</p>

<p style="margin-top: 1em">monitor <br>
Check the health of fence device</p>

<p style="margin-top: 1em">metadata <br>
Display the XML metadata describing this resource.</p>

<p style="margin-top: 1em">STDIN PARAMETERS</p>

<p style="margin-top: 1em">action Fencing Action (Default
Value: off)</p>

<p style="margin-top: 1em">key Key to use for the current
operation. This key should be unique to a node and have to
be written in /etc/multipath.conf. For the &quot;on&quot;
action, the key specifies the key use <br>
to register the local node. For the &quot;off&quot; action,
this key specifies the key to be removed from the device(s).
This parameter is always required.</p>

<p style="margin-top: 1em">devices <br>
List of devices to use for current operation. Devices can be
comma-separated list of device-mapper multipath devices (eg.
/dev/mapper/3600508b400105df70000e00000ac0000 or <br>
/dev/mapper/mpath1). Each device must support SCSI-3
persistent reservations.</p>

<p style="margin-top: 1em">verbose <br>
Verbose mode</p>

<p style="margin-top: 1em">debug Write debug information to
given file</p>

<p style="margin-top: 1em">version <br>
Display version information and exit</p>

<p style="margin-top: 1em">help Display help and exit</p>

<p style="margin-top: 1em">power_wait <br>
Wait X seconds after issuing ON/OFF (Default Value: 0)</p>

<p style="margin-top: 1em">login_timeout <br>
Wait X seconds for cmd prompt after login (Default Value:
5)</p>

<p style="margin-top: 1em">power_timeout <br>
Test X seconds for status change after ON/OFF (Default
Value: 20)</p>

<p style="margin-top: 1em">delay Wait X seconds before
fencing is started (Default Value: 0)</p>

<p style="margin-top: 1em">mpathpersist_path <br>
Path to mpathpersist binary (Default Value:
/usr/sbin/mpathpersist)</p>

<p style="margin-top: 1em">shell_timeout <br>
Wait X seconds for cmd prompt after issuing command (Default
Value: 3)</p>

<p style="margin-top: 1em">store_path <br>
Path to directory where fence agent can store information
(Default Value: /var/run/cluster)</p>

<p style="margin-top: 1em">retry_on <br>
Count of attempts to retry power on (Default Value: 1)</p>

<p style="margin-top: 1em">sudo Use sudo (without password)
when calling 3rd party sotfware.</p>

<p style="margin-top: 1em">fence_mpath (Fence Agent)
2009-10-20 FENCE_AGENT(8)</p>
<hr>
</body>
</html>
