<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>xfs_metadump(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">xfs_metadump(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">xfs_metadump(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
xfs_metadump - copy XFS filesystem metadata to a file
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>xfs_metadump</b> [ <b>-aefFgow</b> ] [ <b>-m</b> <i>max_extents</i> ] ] [
  <b>-l</b> <i>logdev</i> ] <i>source</i> <i>target</i>
<div>&#x00A0;</div>
<b>xfs_metadump -V</b>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>xfs_metadump</b> is a debugging tool that copies the metadata from an XFS
  filesystem to a file. The <i>source</i> argument must be the pathname of the
  device or file containing the XFS filesystem and the <i>target</i> argument
  specifies the destination file name. If <i>target</i> is -, then the output is
  sent to stdout. This allows the output to be redirected to another program
  such as a compression application.
<div class="Pp"></div>
<b>xfs_metadump</b> may only be used to copy unmounted filesystems, or read-only
  mounted filesystems.
<div class="Pp"></div>
<b>xfs_metadump</b> does not alter the source filesystem in any way. The
  <i>target</i> image is a contiguous (non-sparse) file containing all the
  filesystem's metadata and indexes to where the blocks were copied from.
<div class="Pp"></div>
By default, <b>xfs_metadump</b> obfuscates most file (regular file, directory
  and symbolic link) names and extended attribute names to allow the dumps to be
  sent without revealing confidential information. Extended attribute values are
  zeroed and no data is copied. The only exceptions are file or attribute names
  that are 4 or less characters in length. Also file names that span extents
  (this can only occur with the <b>mkfs.xfs</b>(8) options where <b>-n</b>
  <i>size</i> &gt; <b>-b</b> <i>size</i>) are not obfuscated. Names between 5
  and 8 characters in length inclusively are partially obfuscated.
<div class="Pp"></div>
<b>xfs_metadump</b> should not be used for any purposes other than for debugging
  and reporting filesystem problems. The most common usage scenario for this
  tool is when <b>xfs_repair</b>(8) fails to repair a filesystem and a metadump
  image can be sent for analysis.
<div class="Pp"></div>
The file generated by <b>xfs_metadump</b> can be restored to filesystem image
  (minus the data) using the <b>xfs_mdrestore</b>(8) tool.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-a</b></dt>
  <dd class="It-tag">Copies entire metadata blocks. Normally,
      <b>xfs_metadump</b> will zero any stale bytes interspersed with in-use
      metadata. Use this option to copy full metadata blocks, to provide more
      debugging information for a corrupted filesystem. Note that the extra data
      will be unobfuscated.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-e</b></dt>
  <dd class="It-tag">Stops the dump on a read error. Normally, it will ignore
      read errors and copy all the metadata that is accessible.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f</b></dt>
  <dd class="It-tag">Specifies that the filesystem image to be processed is
      stored in a regular file (see the <b>mkfs.xfs -d</b> file option). This
      can also happen if an image copy of a filesystem has been made into an
      ordinary file with <b>xfs_copy</b>(8).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-F</b></dt>
  <dd class="It-tag">Specifies that we want to continue even if the superblock
      magic is not correct. If the source is truly not an XFS filesystem, the
      resulting image will be useless, and xfs_metadump may crash.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-g</b></dt>
  <dd class="It-tag">Shows dump progress. This is sent to stdout if the
      <i>target</i> is a file or to stderr if the <i>target</i> is stdout.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l</b><i> logdev</i></dt>
  <dd class="It-tag">For filesystems which use an external log, this specifies
      the device where the external log resides. The external log is not copied,
      only internal logs are copied.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-m</b></dt>
  <dd class="It-tag">Set the maximum size of an allowed metadata extent.
      Extremely large metadata extents are likely to be corrupt, and will be
      skipped if they exceed this value. The default size is 1000 blocks.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-o</b></dt>
  <dd class="It-tag">Disables obfuscation of file names and extended
    attributes.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-w</b></dt>
  <dd class="It-tag">Prints warnings of inconsistent metadata encountered to
      stderr. Bad metadata is still copied.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-V</b></dt>
  <dd class="It-tag">Prints the version number and exits.</dd>
</dl>
<h1 class="Sh" title="Sh" id="DIAGNOSTICS"><a class="selflink" href="#DIAGNOSTICS">DIAGNOSTICS</a></h1>
<b>xfs_metadump</b> returns an exit code of 0 if all readable metadata is
  successfully copied or 1 if a write error occurs or a read error occurs and
  the <b>-e</b> option used.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
As <b>xfs_metadump</b> copies metadata only, it does not matter if the
  <i>source</i> filesystem has a realtime section or not. If the filesystem has
  an external log, it is not copied. Internal logs are copied and any
  outstanding log transactions are not obfuscated if they contain names.
<div class="Pp"></div>
<b>xfs_metadump</b> is a shell wrapper around the <b>xfs_db</b>(8)
  <b>metadump</b> command.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>xfs_repair</b>(8), <b>xfs_mdrestore</b>(8), <b>xfs_freeze</b>(8),
  <b>xfs_db</b>(8), <b>xfs_copy</b>(8), <b>xfs</b>(5)
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
Email bug reports to <b>xfs@oss.sgi.com</b>.</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
