<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>_UPDOWN(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">_UPDOWN(8)</td>
    <td class="head-vol">Executable programs</td>
    <td class="head-rtitle">_UPDOWN(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
ipsec__updown - kernel and routing manipulation script
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<i>_updown</i> is invoked by pluto when it has brought up a new connection. This
  script is used to insert the appropriate routing entries for IPsec operation
  on some kernel IPsec stacks, such as KLIPS and MAST, and may do other
  necessary work that is kernel or user specific, such as defining custom
  firewall rules. The interface to the script is documented in the pluto man
  page.
<h1 class="Sh" title="Sh" id="VARIABLES"><a class="selflink" href="#VARIABLES">VARIABLES</a></h1>
The <i>_updown</i> is passed along a number of variables which can be used to
  act differently based on the information:
<div class="Pp"></div>
<b>PLUTO_VERSION</b>
<div style="margin-left: 4.00ex;">indicates what version of this interface is
  being used. This document describes version 1.1. This is upwardly compatible
  with version 1.0.</div>
<div class="Pp"></div>
<b>PLUTO_VERB</b>
<div style="margin-left: 4.00ex;">specifies the name of the operation to be
  performed, which can be one of <b>prepare-host</b>, <b>prepare-client</b>,
  <b>up-host</b>, <b>up-client</b>, <b>down-host</b> or <b>down-client</b>. If
  the address family for security gateway to security gateway communications is
  IPv6, then a suffix of -v6 is added to this verb.</div>
<div class="Pp"></div>
<b>PLUTO_CONNECTION</b>
<div style="margin-left: 4.00ex;">is the name of the connection for which we are
  routing.</div>
<div class="Pp"></div>
<b>PLUTO_NEXT_HOP</b>
<div style="margin-left: 4.00ex;">is the next hop to which packets bound for the
  peer must be sent.</div>
<div class="Pp"></div>
<b>PLUTO_INTERFACE</b>
<div style="margin-left: 4.00ex;">is the name of the ipsec interface to be
  used.</div>
<div class="Pp"></div>
<b>PLUTO_ME</b>
<div style="margin-left: 4.00ex;">is the IP address of our host.</div>
<div class="Pp"></div>
<b>PLUTO_MY_CLIENT</b>
<div style="margin-left: 4.00ex;">is the IP address / count of our client
  subnet. If the client is just the host, this will be the host's own IP address
  / max (where max is 32 for IPv4 and 128 for IPv6).</div>
<div class="Pp"></div>
<b>PLUTO_MY_CLIENT_NET</b>
<div style="margin-left: 4.00ex;">is the IP address of our client net. If the
  client is just the host, this will be the host's own IP address.</div>
<div class="Pp"></div>
<b>PLUTO_MY_CLIENT_MASK</b>
<div style="margin-left: 4.00ex;">is the mask for our client net. If the client
  is just the host, this will be 255.255.255.255.</div>
<div class="Pp"></div>
<b>PLUTO_PEER</b>
<div style="margin-left: 4.00ex;">is the IP address of our peer.</div>
<div class="Pp"></div>
<b>PLUTO_PEER_CLIENT</b>
<div style="margin-left: 4.00ex;">is the IP address / count of the peer's client
  subnet. If the client is just the peer, this will be the peer's own IP address
  / max (where max is 32 for IPv4 and 128 for IPv6).</div>
<div class="Pp"></div>
<b>PLUTO_PEER_CLIENT_NET</b>
<div style="margin-left: 4.00ex;">is the IP address of the peer's client net. If
  the client is just the peer, this will be the peer's own IP address.</div>
<div class="Pp"></div>
<b>PLUTO_PEER_CLIENT_MASK</b>
<div style="margin-left: 4.00ex;">is the mask for the peer's client net. If the
  client is just the peer, this will be 255.255.255.255.</div>
<div class="Pp"></div>
<b>PLUTO_MY_PROTOCOL</b>
<div style="margin-left: 4.00ex;">lists the protocols allowed over this IPsec
  SA.</div>
<div class="Pp"></div>
<b>PLUTO_PEER_PROTOCOL</b>
<div style="margin-left: 4.00ex;">lists the protocols the peer allows over this
  IPsec SA.</div>
<div class="Pp"></div>
<b>PLUTO_MY_PORT</b>
<div style="margin-left: 4.00ex;">lists the ports allowed over this IPsec
  SA.</div>
<div class="Pp"></div>
<b>PLUTO_PEER_PORT</b>
<div style="margin-left: 4.00ex;">lists the ports the peer allows over this
  IPsec SA.</div>
<div class="Pp"></div>
<b>PLUTO_MY_ID</b>
<div style="margin-left: 4.00ex;">lists our id.</div>
<div class="Pp"></div>
<b>PLUTO_PEER_ID</b>
<div style="margin-left: 4.00ex;">lists our peer's id.</div>
<div class="Pp"></div>
<b>PLUTO_PEER_CA</b>
<div style="margin-left: 4.00ex;">lists the peer's CA.</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>ipsec</b>(8), <b>ipsec_pluto</b>(8).
<h1 class="Sh" title="Sh" id="HISTORY"><a class="selflink" href="#HISTORY">HISTORY</a></h1>
Man page written for the Linux FreeS/WAN project &lt;
  <b>http://www.freeswan.org/</b>&gt; by Michael Richardson. Original program
  written by Henry Spencer.
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
<b>Paul Wouters</b>
<div style="margin-left: 4.00ex;">placeholder to suppress warning</div>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">11/12/2016</td>
    <td class="foot-os">libreswan</td>
  </tr>
</table>
</body>
</html>
