<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:08:42 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>ASTRACEROUTE(8) netsniff-ng toolkit ASTRACEROUTE(8)</p>

<p style="margin-top: 1em">NAME <br>
astraceroute - autonomous system trace route utility</p>

<p style="margin-top: 1em">SYNOPSIS <br>
astraceroute [options]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
astraceroute is a small utility to retrieve path information
in a traceroute like way, but with additional geographical
location information. It tracks the route of a packet from
<br>
the local host to the remote host by successively increasing
the IP&rsquo;s TTL field, starting from 1, in the hope that
each intermediate node will send an ICMP TIME_EXCEEDED
notifi&acirc; <br>
cation back to the local host when the TTL value is
decremented to 0.</p>

<p style="margin-top: 1em">astraceroute supports IPv4 and
IPv6 queries and will display country and city information,
if available, the AS number the hop belongs to, and its ISP
name. astraceroute also <br>
displays timing information and reverse DNS data.</p>

<p style="margin-top: 1em">Due to astraceroute&rsquo;s
configurability, it is also possible to gather some more
useful information about the hop regarding what it does and
does not allow to pass through. This is <br>
done by using clear text strings for probing DPIs or
keywords. This tool might be a good start for further
in-depth analysis of such systems.</p>

<p style="margin-top: 1em">OPTIONS <br>
-H &lt;host&gt;, --host &lt;host&gt; <br>
Hostname or IPv4 or IPv6 address of the remote host where
the AS route should be traced to. In the case of an IPv6
address or host, option &rsquo;&rsquo;-6&rsquo;&rsquo; must
be used. IPv4 is the <br>
default.</p>

<p style="margin-top: 1em">-p &lt;port&gt;, --port
&lt;port&gt; <br>
TCP port for the remote host to use. If not specified, the
default port used is 80.</p>

<p style="margin-top: 1em">-i &lt;device&gt;, -d
&lt;device&gt;, --dev &lt;device&gt; <br>
Networking device to start the trace route from, e.g. eth0,
wlan0.</p>

<p style="margin-top: 1em">-f &lt;ttl&gt;, --init-ttl
&lt;ttl&gt; <br>
Initial TTL value to be used. This option might be useful if
you are not interested in the first n hops, but only the
following ones. The default initial TTL value is 1.</p>

<p style="margin-top: 1em">-m &lt;ttl&gt;, --max-ttl
&lt;ttl&gt; <br>
Maximum TTL value to be used. If not otherwise specified,
the maximum TTL value is 30. Thus, after this has been
reached astraceroute exits.</p>

<p style="margin-top: 1em">-q &lt;num&gt;, --num-probes
&lt;num&gt; <br>
Specifies the number of queries to be done on a particular
hop. The default is 2 query requests.</p>

<p style="margin-top: 1em">-x &lt;sec&gt;, --timeout
&lt;sec&gt; <br>
Tells astraceroute the probe response timeout in seconds, in
other words the maximum time astraceroute must wait for an
ICMP response from the current hop. The default is 3
sec&acirc; <br>
onds.</p>

<p style="margin-top: 1em">-X &lt;string&gt;, --payload
&lt;string&gt; <br>
Places an ASCII cleartext string into the packet payload.
Cleartext that contains whitespace must be put into quotes
(e.g.: &quot;censor me&quot;).</p>

<p style="margin-top: 1em">-l &lt;len&gt;, --totlen
&lt;len&gt; <br>
Specifies the total length of the packet. Payload that does
not have a cleartext string in it is padded with random
garbage.</p>

<p style="margin-top: 1em">-4, --ipv4 <br>
Use IPv4 only requests. This is the default.</p>

<p style="margin-top: 1em">-6, --ipv6 <br>
Use IPv6 only requests. This must be used when passing an
IPv6 host as an argument.</p>

<p style="margin-top: 1em">-n, --numeric <br>
Tells astraceroute to not perform reverse DNS lookup for hop
replies. The reverse option is
&rsquo;&rsquo;-N&rsquo;&rsquo;.</p>

<p style="margin-top: 1em">-u, --update <br>
The built-in geo-database update mechanism will be invoked
to get Maxmind&rsquo;s latest version. To configure search
locations for databases, the file
/etc/netsniff-ng/geoip.conf con&acirc; <br>
tains possible addresses. Thus, to save bandwidth or for
mirroring Maxmind&rsquo;s databases (to bypass their traffic
limit policy), different hosts or IP addresses can be placed
into <br>
geoip.conf, separated by a newline.</p>

<p style="margin-top: 1em">-L, --latitude <br>
Also show latitude and longitude of hops.</p>

<p style="margin-top: 1em">-N, --dns <br>
Tells astraceroute to perform reverse DNS lookup for hop
replies. The reverse option is
&rsquo;&rsquo;-n&rsquo;&rsquo;.</p>

<p style="margin-top: 1em">-S, --syn <br>
Use TCP&rsquo;s SYN flag for the request.</p>

<p style="margin-top: 1em">-A, --ack <br>
Use TCP&rsquo;s ACK flag for the request.</p>

<p style="margin-top: 1em">-F, --fin <br>
Use TCP&rsquo;s FIN flag for the request.</p>

<p style="margin-top: 1em">-P, --psh <br>
Use TCP&rsquo;s PSH flag for the request.</p>

<p style="margin-top: 1em">-U, --urg <br>
Use TCP&rsquo;s URG flag for the request.</p>

<p style="margin-top: 1em">-R, --rst <br>
Use TCP&rsquo;s RST flag for the request.</p>

<p style="margin-top: 1em">-E, --ecn-syn <br>
Use TCP&rsquo;s ECN flag for the request.</p>

<p style="margin-top: 1em">-t &lt;tos&gt;, --tos
&lt;tos&gt; <br>
Explicitly specify IP&rsquo;s TOS.</p>

<p style="margin-top: 1em">-G, --nofrag <br>
Set IP&rsquo;s no fragmentation flag.</p>

<p style="margin-top: 1em">-Z, --show-packet <br>
Show and dissect the returned packet.</p>

<p style="margin-top: 1em">-v, --version <br>
Show version information and exit.</p>

<p style="margin-top: 1em">-h, --help <br>
Show user help and exit.</p>

<p style="margin-top: 1em">USAGE EXAMPLE <br>
astraceroute -i eth0 -N -S -H netsniff-ng.org <br>
This sends out a TCP SYN probe via the
&rsquo;&rsquo;eth0&rsquo;&rsquo; networking device to the
remote IPv4 host netsniff-ng.org. This request is most
likely to pass. Also, tell astraceroute to perform <br>
reverse DNS lookups for each hop.</p>

<p style="margin-top: 1em">astraceroute -6 -i eth0 -S -E -N
-H www.6bone.net <br>
In this example, a TCP SYN/ECN probe for the IPv6 host
www.6bone.net is being performed. Also in this case, the
&rsquo;&rsquo;eth0&rsquo;&rsquo; device is being used as
well as a reverse DNS lookup for <br>
each hop.</p>

<p style="margin-top: 1em">astraceroute -i eth0 -N -F -H
netsniff-ng.org <br>
Here, we send out a TCP FIN probe to the remote host
netsniff-ng.org. Again, on each hop a reverse DNS lookup is
being done and the queries are transmitted from
&rsquo;&rsquo;eth0&rsquo;&rsquo;. IPv4 is <br>
used.</p>

<p style="margin-top: 1em">astraceroute -i eth0 -N -FPU -H
netsniff-ng.org <br>
As in most other examples, we perform a trace route to IPv4
host netsniff-ng.org and do a TCP Xmas probe this time.</p>

<p style="margin-top: 1em">astraceroute -i eth0 -N -H
netsniff-ng.org -X censor-me -Z <br>
In this example, we have a Null probe to the remote host
netsniff-ng.org, port 80 (default) and this time, we append
the cleartext string &quot;censor-me&quot; into the packet
payload to <br>
test if a firewall or DPI will let this string pass. Such a
trace could be done once without, and once with, a
blacklisted string to gather possible information about
censorship.</p>

<p style="margin-top: 1em">NOTE <br>
If a TCP-based probe fails after a number of retries,
astraceroute will automatically fall back to ICMP-based
probes to pass through firewalls and routers used in load
balancing <br>
for example.</p>

<p style="margin-top: 1em">To gather more information about
astraceroute&rsquo;s displayed AS numbers, see e.g.:
http://bgp.he.net/AS&lt;number&gt;.</p>

<p style="margin-top: 1em">BUGS <br>
The geographical locations are estimated with the help of
Maxmind&rsquo;s GeoIP database and can differ from the real
physical location. To decrease the possible errors, update
the <br>
database regularly using astraceroute&rsquo;s --update
option.</p>

<p style="margin-top: 1em">At some point in time, we need a
similar approach to gather more reliable path information
such as in the paris-traceroute tool.</p>

<p style="margin-top: 1em">Due to the generic nature of
astraceroute, it currently has a built-in mechanism to stop
the trace after a fixed number of hops, since the
configurable TCP flags can have any&acirc; <br>
thing included. It is possible to decrease this number of
course. In the future, if a SYN probe is sent out, there
should be a listener so that we can stop the trace if we
<br>
detect a handshake in progress.</p>

<p style="margin-top: 1em">LEGAL <br>
astraceroute is licensed under the GNU GPL version 2.0.</p>

<p style="margin-top: 1em">HISTORY <br>
astraceroute was originally written for the netsniff-ng
toolkit by Daniel Borkmann. It is currently maintained by
Tobias Klauser &lt;tklauser@distanz.ch&gt; and Daniel
Borkmann <br>
&lt;dborkma@tik.ee.ethz.ch&gt;.</p>

<p style="margin-top: 1em">SEE ALSO <br>
netsniff-ng(8), trafgen(8), mausezahn(8), ifpps(8), bpfc(8),
flowtop(8), curvetun(8)</p>

<p style="margin-top: 1em">AUTHOR <br>
Manpage was written by Daniel Borkmann.</p>

<p style="margin-top: 1em">COLOPHON <br>
This page is part of the Linux netsniff-ng toolkit project.
A description of the project, and information about
reporting bugs, can be found at http://netsniff-ng.org/.</p>

<p style="margin-top: 1em">Linux 03 March 2013
ASTRACEROUTE(8)</p>
<hr>
</body>
</html>
