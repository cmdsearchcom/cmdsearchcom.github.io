<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:08:23 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>AIREPLAY-NG(8) System Manager&rsquo;s Manual
AIREPLAY-NG(8)</p>

<p style="margin-top: 1em">NAME <br>
aireplay-ng - inject packets into a wireless network to
generate traffic</p>

<p style="margin-top: 1em">SYNOPSIS <br>
aireplay-ng [options] &lt;replay interface&gt;</p>

<p style="margin-top: 1em">DESCRIPTION <br>
aireplay-ng is used to inject/replay frames. The primary
function is to generate traffic for the later use in
aircrack-ng for cracking the WEP and WPA-PSK keys. There are
dif&acirc; <br>
ferent attacks which can cause deauthentications for the
purpose of capturing WPA handshake data, fake
authentications, Interactive packet replay, hand-crafted ARP
request injec&acirc; <br>
tion and ARP-request reinjection. With the packetforge-ng
tool it&rsquo;s possible to create arbitrary frames.</p>

<p style="margin-top: 1em">aireplay-ng supports single-NIC
injection/monitor. <br>
This feature needs driver patching.</p>

<p style="margin-top: 1em">OPTIONS <br>
-H, --help <br>
Shows the help screen.</p>

<p style="margin-top: 1em">Filter options:</p>

<p style="margin-top: 1em">-b &lt;bssid&gt; <br>
MAC address of access point.</p>

<p style="margin-top: 1em">-d &lt;dmac&gt; <br>
MAC address of destination.</p>

<p style="margin-top: 1em">-s &lt;smac&gt; <br>
MAC address of source.</p>

<p style="margin-top: 1em">-m &lt;len&gt; <br>
Minimum packet length.</p>

<p style="margin-top: 1em">-n &lt;len&gt; <br>
Maximum packet length.</p>

<p style="margin-top: 1em">-u &lt;type&gt; <br>
Frame control, type field.</p>

<p style="margin-top: 1em">-v &lt;subt&gt; <br>
Frame control, subtype field.</p>

<p style="margin-top: 1em">-t &lt;tods&gt; <br>
Frame control, &quot;To&quot; DS bit (0 or 1).</p>

<p style="margin-top: 1em">-f &lt;fromds&gt; <br>
Frame control, &quot;From&quot; DS bit (0 or 1).</p>

<p style="margin-top: 1em">-w &lt;iswep&gt; <br>
Frame control, WEP bit (0 or 1).</p>

<p style="margin-top: 1em">-D Disable AP Detection.</p>

<p style="margin-top: 1em">Replay options:</p>

<p style="margin-top: 1em">-x &lt;nbpps&gt; <br>
Number of packets per second.</p>

<p style="margin-top: 1em">-p &lt;fctrl&gt; <br>
Set frame control word (hex).</p>

<p style="margin-top: 1em">-a &lt;bssid&gt; <br>
Set Access Point MAC address.</p>

<p style="margin-top: 1em">-c &lt;dmac&gt; <br>
Set destination MAC address.</p>

<p style="margin-top: 1em">-h &lt;smac&gt; <br>
Set source MAC address.</p>

<p style="margin-top: 1em">-g &lt;nb_packets&gt; <br>
Change ring buffer size (default: 8 packets). The minimum is
1.</p>

<p style="margin-top: 1em">-F Choose first matching
packet.</p>

<p style="margin-top: 1em">-e &lt;essid&gt; <br>
Fake Authentication attack: Set target SSID (see below). For
SSID containing special characters, see
http://www.aircrack-ng.org/doku.php?id=faq#how_to_use_spaces_dou&acirc;
<br>
ble_quote_and_single_quote_etc._in_ap_names</p>

<p style="margin-top: 1em">-o &lt;npackets&gt; <br>
Fake Authentication attack: Set the number of packets for
every authentication and association attempt (Default: 1). 0
means auto</p>

<p style="margin-top: 1em">-q &lt;seconds&gt; <br>
Fake Authentication attack: Set the time between keep-alive
packets in fake authentication mode.</p>

<p style="margin-top: 1em">-Q Fake Authentication attack:
Sends reassociation requests instead of performing a
complete authentication and association after each delay
period.</p>

<p style="margin-top: 1em">-y &lt;prga&gt; <br>
Fake Authentication attack: Specifies the keystream file for
fake shared key authentication.</p>

<p style="margin-top: 1em">-T n Fake Authentication attack:
Exit if fake authentication fails &rsquo;n&rsquo;
time(s).</p>

<p style="margin-top: 1em">-j ARP Replay attack : inject
FromDS pakets (see below).</p>

<p style="margin-top: 1em">-k &lt;IP&gt; <br>
Fragmentation attack: Set destination IP in fragments.</p>

<p style="margin-top: 1em">-l &lt;IP&gt; <br>
Fragmentation attack: Set source IP in fragments.</p>

<p style="margin-top: 1em">-B Test option: bitrate
test.</p>

<p style="margin-top: 1em">Source options:</p>

<p style="margin-top: 1em">-i &lt;iface&gt; <br>
Capture packets from this interface.</p>

<p style="margin-top: 1em">-r &lt;file&gt; <br>
Extract packets from this pcap file.</p>

<p style="margin-top: 1em">Miscellaneous options:</p>

<p style="margin-top: 1em">-R disable /dev/rtc usage.</p>

<p style="margin-top: 1em">--ignore-negative-one if the
interface&rsquo;s channel can&rsquo;t be determined ignore
the mismatch, needed for unpatched cfg80211</p>

<p style="margin-top: 1em">Attack modes:</p>

<p style="margin-top: 1em">-0 &lt;count&gt;,
--deauth=&lt;count&gt; <br>
This attack sends deauthentication packets to one or more
clients which are currently associated with a particular
access point. Deauthenticating clients can be done for a
<br>
number of reasons: Recovering a hidden ESSID. This is an
ESSID which is not being broadcast. Another term for this is
&quot;cloaked&quot; or Capturing WPA/WPA2 handshakes by
forcing <br>
clients to reauthenticate or Generate ARP requests (Windows
clients sometimes flush their ARP cache when disconnected).
Of course, this attack is totally useless if there <br>
are no associated wireless client or on fake
authentications.</p>

<p style="margin-top: 1em">-1 &lt;delay&gt;,
--fakeauth=&lt;delay&gt; <br>
The fake authentication attack allows you to perform the two
types of WEP authentication (Open System and Shared Key)
plus associate with the access point (AP). This is <br>
only useful when you need an associated MAC address in
various aireplay-ng attacks and there is currently no
associated client. It should be noted that the fake
authenti&acirc; <br>
cation attack does NOT generate any ARP packets. Fake
authentication cannot be used to authenticate/associate with
WPA/WPA2 Access Points.</p>

<p style="margin-top: 1em">-2, --interactive <br>
This attack allows you to choose a specific packet for
replaying (injecting). The attack can obtain packets to
replay from two sources. The first being a live flow of <br>
packets from your wireless card. The second being from a
pcap file. Reading from a file is an often overlooked
feature of aireplay-ng. This allows you read packets from
<br>
other capture sessions or quite often, various attacks
generate pcap files for easy reuse. A common use of reading
a file containing a packet your created with packet&acirc;
<br>
forge-ng.</p>

<p style="margin-top: 1em">-3, --arpreplay <br>
The classic ARP request replay attack is the most effective
way to generate new initialization vectors (IVs), and works
very reliably. The program listens for an ARP <br>
packet then retransmits it back to the access point. This,
in turn, causes the access point to repeat the ARP packet
with a new IV. The program retransmits the same ARP <br>
packet over and over. However, each ARP packet repeated by
the access point has a new IVs. It is all these new IVs
which allow you to determine the WEP key.</p>

<p style="margin-top: 1em">-4, --chopchop <br>
This attack, when successful, can decrypt a WEP data packet
without knowing the key. It can even work against dynamic
WEP. This attack does not recover the WEP key itself, <br>
but merely reveals the plaintext. However, some access
points are not vulnerable to this attack. Some may seem
vulnerable at first but actually drop data packets shorter
<br>
that 60 bytes. If the access point drops packets shorter
than 42 bytes, aireplay tries to guess the rest of the
missing data, as far as the headers are predictable. If an
<br>
IP packet is captured, it additionally checks if the
checksum of the header is correct after guessing the missing
parts of it. This attack requires at least one WEP data <br>
packet.</p>

<p style="margin-top: 1em">-5, --fragment <br>
This attack, when successful, can obtain 1500 bytes of PRGA
(pseudo random generation algorithm). This attack does not
recover the WEP key itself, but merely obtains the <br>
PRGA. The PRGA can then be used to generate packets with
packetforge-ng which are in turn used for various injection
attacks. It requires at least one data packet to be <br>
received from the access point in order to initiate the
attack.</p>

<p style="margin-top: 1em">-6, --caffe-latte <br>
In general, for an attack to work, the attacker has to be in
the range of an AP and a connected client (fake or real).
Caffe Latte attacks allows one to gather enough <br>
packets to crack a WEP key without the need of an AP, it
just need a client to be in range.</p>

<p style="margin-top: 1em">-7, --cfrag <br>
This attack turns IP or ARP packets from a client into ARP
request against the client. This attack works especially
well against ad-hoc networks. As well it can be used <br>
against softAP clients and normal AP clients.</p>

<p style="margin-top: 1em">-8, --migmode <br>
This attack works against Cisco Aironet access points
configured in WPA Migration Mode, which enables both WPA and
WEP clients to associate to an access point using the <br>
same Service Set Identifier (SSID). The program listens for
a WEP-encapsulated broadcast ARP packet, bitflips it to make
it into an ARP coming from the attacker&rsquo;s MAC <br>
address and retransmits it to the access point. This, in
turn, causes the access point to repeat the ARP packet with
a new IV and also to forward the ARP reply to the <br>
attacker with a new IV. The program retransmits the same ARP
packet over and over. However, each ARP packet repeated by
the access point has a new IV as does the ARP reply <br>
forwarded to the attacker by the access point. It is all
these new IVs which allow you to determine the WEP key.</p>

<p style="margin-top: 1em">-9, --test <br>
Tests injection and quality.</p>

<p style="margin-top: 1em">FRAGMENTATION VERSUS CHOPCHOP
<br>
Fragmentation:</p>

<p style="margin-top: 1em">Pros <br>
- Can obtain the full packet length of 1500 bytes XOR. This
means you can subsequently pretty well create any size of
packet. <br>
- May work where chopchop does not <br>
- Is extremely fast. It yields the XOR stream extremely
quickly when successful.</p>

<p style="margin-top: 1em">Cons <br>
- Setup to execute the attack is more subject to the device
drivers. For example, Atheros does not generate the correct
packets unless the wireless card is set to the mac <br>
address you are spoofing. <br>
- You need to be physically closer to the access point since
if any packets are lost then the attack fails.</p>

<p style="margin-top: 1em">Chopchop</p>

<p style="margin-top: 1em">Pro <br>
- May work where frag does not work.</p>

<p style="margin-top: 1em">Cons <br>
- Cannot be used against every access point. <br>
- The maximum XOR bits is limited to the length of the
packet you chopchop against. <br>
- Much slower then the fragmentation attack.</p>

<p style="margin-top: 1em">AUTHOR <br>
This manual page was written by Adam Cecile
&lt;gandalf@le-vert.net&gt; for the Debian system (but may
be used by others). Permission is granted to copy,
distribute and/or modify this <br>
document under the terms of the GNU General Public License,
Version 2 or any later version published by the Free
Software Foundation On Debian systems, the complete text of
the <br>
GNU General Public License can be found in
/usr/share/common-licenses/GPL.</p>

<p style="margin-top: 1em">SEE ALSO <br>
airbase-ng(8) <br>
airmon-ng(8) <br>
airodump-ng(8) <br>
airodump-ng-oui-update(8) <br>
airserv-ng(8) <br>
airtun-ng(8) <br>
besside-ng(8) <br>
easside-ng(8) <br>
tkiptun-ng(8) <br>
wesside-ng(8) <br>
aircrack-ng(1) <br>
airdecap-ng(1) <br>
airdecloak-ng(1) <br>
airolib-ng(1) <br>
besside-ng-crawler(1) <br>
buddy-ng(1) <br>
ivstools(1) <br>
kstats(1) <br>
makeivs-ng(1) <br>
packetforge-ng(1) <br>
wpaclean(1)</p>

<p style="margin-top: 1em">Version 1.2-rc4 February 2016
AIREPLAY-NG(8)</p>
<hr>
</body>
</html>
