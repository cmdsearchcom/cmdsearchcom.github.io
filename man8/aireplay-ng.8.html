<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>AIREPLAY-NG(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">AIREPLAY-NG(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">AIREPLAY-NG(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
aireplay-ng - inject packets into a wireless network to generate traffic
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>aireplay-ng</b> [options] &lt;replay interface&gt;
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>aireplay-ng</b> is used to inject/replay frames. The primary function is to
  generate traffic for the later use in aircrack-ng for cracking the WEP and
  WPA-PSK keys. There are different attacks which can cause deauthentications
  for the purpose of capturing WPA handshake data, fake authentications,
  Interactive packet replay, hand-crafted ARP request injection and ARP-request
  reinjection. With the packetforge-ng tool it's possible to create arbitrary
  frames.
<div>&#x00A0;</div>
<div class="Pp"></div>
<b>aireplay-ng</b> supports single-NIC injection/monitor.
<div>&#x00A0;</div>
This feature needs driver patching.
<div>&#x00A0;</div>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-H, --help</i></dt>
  <dd class="It-tag">Shows the help screen.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Filter options:</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-b &lt;bssid&gt;</i></dt>
  <dd class="It-tag">MAC address of access point.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-d &lt;dmac&gt;</i></dt>
  <dd class="It-tag">MAC address of destination.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-s &lt;smac&gt;</i></dt>
  <dd class="It-tag">MAC address of source.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-m &lt;len&gt;</i></dt>
  <dd class="It-tag">Minimum packet length.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-n &lt;len&gt;</i></dt>
  <dd class="It-tag">Maximum packet length.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-u &lt;type&gt;</i></dt>
  <dd class="It-tag">Frame control, type field.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-v &lt;subt&gt;</i></dt>
  <dd class="It-tag">Frame control, subtype field.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-t &lt;tods&gt;</i></dt>
  <dd class="It-tag">Frame control, &quot;To&quot; DS bit (0 or 1).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-f &lt;fromds&gt;</i></dt>
  <dd class="It-tag">Frame control, &quot;From&quot; DS bit (0 or 1).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-w &lt;iswep&gt;</i></dt>
  <dd class="It-tag">Frame control, WEP bit (0 or 1).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-D</i></dt>
  <dd class="It-tag">Disable AP Detection.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Replay options:</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-x &lt;nbpps&gt;</i></dt>
  <dd class="It-tag">Number of packets per second.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-p &lt;fctrl&gt;</i></dt>
  <dd class="It-tag">Set frame control word (hex).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-a &lt;bssid&gt;</i></dt>
  <dd class="It-tag">Set Access Point MAC address.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-c &lt;dmac&gt;</i></dt>
  <dd class="It-tag">Set destination MAC address.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-h &lt;smac&gt;</i></dt>
  <dd class="It-tag">Set source MAC address.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-g &lt;nb_packets&gt;</i></dt>
  <dd class="It-tag">Change ring buffer size (default: 8 packets). The minimum
      is 1.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-F</i></dt>
  <dd class="It-tag">Choose first matching packet.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-e &lt;essid&gt;</i></dt>
  <dd class="It-tag">Fake Authentication attack: Set target SSID (see below).
      For SSID containing special characters, see
      http://www.aircrack-ng.org/doku.php?id=faq#how_to_use_spaces_double_quote_and_single_quote_etc._in_ap_names</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-o &lt;npackets&gt;</i></dt>
  <dd class="It-tag">Fake Authentication attack: Set the number of packets for
      every authentication and association attempt (Default: 1). 0 means
    auto</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-q &lt;seconds&gt;</i></dt>
  <dd class="It-tag">Fake Authentication attack: Set the time between keep-alive
      packets in fake authentication mode.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-Q</i></dt>
  <dd class="It-tag">Fake Authentication attack: Sends reassociation requests
      instead of performing a complete authentication and association after each
      delay period.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-y &lt;prga&gt;</i></dt>
  <dd class="It-tag">Fake Authentication attack: Specifies the keystream file
      for fake shared key authentication.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-T n</i></dt>
  <dd class="It-tag">Fake Authentication attack: Exit if fake authentication
      fails 'n' time(s).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-j</i></dt>
  <dd class="It-tag">ARP Replay attack : inject FromDS pakets (see below).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-k &lt;IP&gt;</i></dt>
  <dd class="It-tag">Fragmentation attack: Set destination IP in fragments.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-l &lt;IP&gt;</i></dt>
  <dd class="It-tag">Fragmentation attack: Set source IP in fragments.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-B</i></dt>
  <dd class="It-tag">Test option: bitrate test.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Source options:</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-i &lt;iface&gt;</i></dt>
  <dd class="It-tag">Capture packets from this interface.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-r &lt;file&gt;</i></dt>
  <dd class="It-tag">Extract packets from this pcap file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>Miscellaneous options:</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-R</i></dt>
  <dd class="It-tag">disable /dev/rtc usage.</dd>
</dl>
<div class="Pp"></div>
<i>--ignore-negative-one</i> if the interface's channel can't be determined
  ignore the mismatch, needed for unpatched cfg80211
<dl class="Bl-tag">
  <dt class="It-tag"><b>Attack modes:</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-0 &lt;count&gt;, --deauth=&lt;count&gt;</i></dt>
  <dd class="It-tag">This attack sends deauthentication packets to one or more
      clients which are currently associated with a particular access point.
      Deauthenticating clients can be done for a number of reasons: Recovering a
      hidden ESSID. This is an ESSID which is not being broadcast. Another term
      for this is &quot;cloaked&quot; or Capturing WPA/WPA2 handshakes by
      forcing clients to reauthenticate or Generate ARP requests (Windows
      clients sometimes flush their ARP cache when disconnected). Of course,
      this attack is totally useless if there are no associated wireless client
      or on fake authentications.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-1 &lt;delay&gt;, --fakeauth=&lt;delay&gt;</i></dt>
  <dd class="It-tag">The fake authentication attack allows you to perform the
      two types of WEP authentication (Open System and Shared Key) plus
      associate with the access point (AP). This is only useful when you need an
      associated MAC address in various aireplay-ng attacks and there is
      currently no associated client. It should be noted that the fake
      authentication attack does NOT generate any ARP packets. Fake
      authentication cannot be used to authenticate/associate with WPA/WPA2
      Access Points.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-2, --interactive</i></dt>
  <dd class="It-tag">This attack allows you to choose a specific packet for
      replaying (injecting). The attack can obtain packets to replay from two
      sources. The first being a live flow of packets from your wireless card.
      The second being from a pcap file. Reading from a file is an often
      overlooked feature of aireplay-ng. This allows you read packets from other
      capture sessions or quite often, various attacks generate pcap files for
      easy reuse. A common use of reading a file containing a packet your
      created with packetforge-ng.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-3, --arpreplay</i></dt>
  <dd class="It-tag">The classic ARP request replay attack is the most effective
      way to generate new initialization vectors (IVs), and works very reliably.
      The program listens for an ARP packet then retransmits it back to the
      access point. This, in turn, causes the access point to repeat the ARP
      packet with a new IV. The program retransmits the same ARP packet over and
      over. However, each ARP packet repeated by the access point has a new IVs.
      It is all these new IVs which allow you to determine the WEP key.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-4, --chopchop</i></dt>
  <dd class="It-tag">This attack, when successful, can decrypt a WEP data packet
      without knowing the key. It can even work against dynamic WEP. This attack
      does not recover the WEP key itself, but merely reveals the plaintext.
      However, some access points are not vulnerable to this attack. Some may
      seem vulnerable at first but actually drop data packets shorter that 60
      bytes. If the access point drops packets shorter than 42 bytes, aireplay
      tries to guess the rest of the missing data, as far as the headers are
      predictable. If an IP packet is captured, it additionally checks if the
      checksum of the header is correct after guessing the missing parts of it.
      This attack requires at least one WEP data packet.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-5, --fragment</i></dt>
  <dd class="It-tag">This attack, when successful, can obtain 1500 bytes of PRGA
      (pseudo random generation algorithm). This attack does not recover the WEP
      key itself, but merely obtains the PRGA. The PRGA can then be used to
      generate packets with packetforge-ng which are in turn used for various
      injection attacks. It requires at least one data packet to be received
      from the access point in order to initiate the attack.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-6, --caffe-latte</i></dt>
  <dd class="It-tag">In general, for an attack to work, the attacker has to be
      in the range of an AP and a connected client (fake or real). Caffe Latte
      attacks allows one to gather enough packets to crack a WEP key without the
      need of an AP, it just need a client to be in range.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-7, --cfrag</i></dt>
  <dd class="It-tag">This attack turns IP or ARP packets from a client into ARP
      request against the client. This attack works especially well against
      ad-hoc networks. As well it can be used against softAP clients and normal
      AP clients.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-8, --migmode</i></dt>
  <dd class="It-tag">This attack works against Cisco Aironet access points
      configured in WPA Migration Mode, which enables both WPA and WEP clients
      to associate to an access point using the same Service Set Identifier
      (SSID). The program listens for a WEP-encapsulated broadcast ARP packet,
      bitflips it to make it into an ARP coming from the attacker's MAC address
      and retransmits it to the access point. This, in turn, causes the access
      point to repeat the ARP packet with a new IV and also to forward the ARP
      reply to the attacker with a new IV. The program retransmits the same ARP
      packet over and over. However, each ARP packet repeated by the access
      point has a new IV as does the ARP reply forwarded to the attacker by the
      access point. It is all these new IVs which allow you to determine the WEP
      key.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><i>-9, --test</i></dt>
  <dd class="It-tag">Tests injection and quality.</dd>
</dl>
<h1 class="Sh" title="Sh" id="FRAGMENTATION_VERSUS_CHOPCHOP"><a class="selflink" href="#FRAGMENTATION_VERSUS_CHOPCHOP">FRAGMENTATION
  VERSUS CHOPCHOP</a></h1>
<b>Fragmentation:</b>
<div class="Pp"></div>
<i>Pros</i>
<div>&#x00A0;</div>
- Can obtain the full packet length of 1500 bytes XOR. This means you can
  subsequently pretty well create any size of packet.
<div>&#x00A0;</div>
- May work where chopchop does not
<div>&#x00A0;</div>
- Is extremely fast. It yields the XOR stream extremely quickly when successful.
<div class="Pp"></div>
<i>Cons</i>
<div>&#x00A0;</div>
- Setup to execute the attack is more subject to the device drivers. For
  example, Atheros does not generate the correct packets unless the wireless
  card is set to the mac address you are spoofing.
<div>&#x00A0;</div>
- You need to be physically closer to the access point since if any packets are
  lost then the attack fails.
<div class="Pp"></div>
<b>Chopchop</b>
<div class="Pp"></div>
<i>Pro</i>
<div>&#x00A0;</div>
- May work where frag does not work.
<div class="Pp"></div>
<i>Cons</i>
<div>&#x00A0;</div>
- Cannot be used against every access point.
<div>&#x00A0;</div>
- The maximum XOR bits is limited to the length of the packet you chopchop
  against.
<div>&#x00A0;</div>
- Much slower then the fragmentation attack.
<div>&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
This manual page was written by Adam Cecile &lt;gandalf@le-vert.net&gt; for the
  Debian system (but may be used by others). Permission is granted to copy,
  distribute and/or modify this document under the terms of the GNU General
  Public License, Version 2 or any later version published by the Free Software
  Foundation On Debian systems, the complete text of the GNU General Public
  License can be found in /usr/share/common-licenses/GPL.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>airbase-ng(8)</b>
<div>&#x00A0;</div>
<b>airmon-ng(8)</b>
<div>&#x00A0;</div>
<b>airodump-ng(8)</b>
<div>&#x00A0;</div>
<b>airodump-ng-oui-update(8)</b>
<div>&#x00A0;</div>
<b>airserv-ng(8)</b>
<div>&#x00A0;</div>
<b>airtun-ng(8)</b>
<div>&#x00A0;</div>
<b>besside-ng(8)</b>
<div>&#x00A0;</div>
<b>easside-ng(8)</b>
<div>&#x00A0;</div>
<b>tkiptun-ng(8)</b>
<div>&#x00A0;</div>
<b>wesside-ng(8)</b>
<div>&#x00A0;</div>
<b>aircrack-ng(1)</b>
<div>&#x00A0;</div>
<b>airdecap-ng(1)</b>
<div>&#x00A0;</div>
<b>airdecloak-ng(1)</b>
<div>&#x00A0;</div>
<b>airolib-ng(1)</b>
<div>&#x00A0;</div>
<b>besside-ng-crawler(1)</b>
<div>&#x00A0;</div>
<b>buddy-ng(1)</b>
<div>&#x00A0;</div>
<b>ivstools(1)</b>
<div>&#x00A0;</div>
<b>kstats(1)</b>
<div>&#x00A0;</div>
<b>makeivs-ng(1)</b>
<div>&#x00A0;</div>
<b>packetforge-ng(1)</b>
<div>&#x00A0;</div>
<b>wpaclean(1)</b></div>
<table class="foot">
  <tr>
    <td class="foot-date">February 2016</td>
    <td class="foot-os">Version 1.2-rc4</td>
  </tr>
</table>
</body>
</html>
