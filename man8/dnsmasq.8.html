<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>DNSMASQ(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DNSMASQ(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">DNSMASQ(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
dnsmasq - A lightweight DHCP and caching DNS server.
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>dnsmasq</b> <i>[OPTION]...</i>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>dnsmasq</b> is a lightweight DNS, TFTP, PXE, router advertisement and DHCP
  server. It is intended to provide coupled DNS and DHCP service to a LAN.
<div class="Pp"></div>
Dnsmasq accepts DNS queries and either answers them from a small, local, cache
  or forwards them to a real, recursive, DNS server. It loads the contents of
  /etc/hosts so that local hostnames which do not appear in the global DNS can
  be resolved and also answers DNS queries for DHCP configured hosts. It can
  also act as the authoritative DNS server for one or more domains, allowing
  local names to appear in the global DNS.
<div class="Pp"></div>
The dnsmasq DHCP server supports static address assignments and multiple
  networks. It automatically sends a sensible default set of DHCP options, and
  can be configured to send any desired set of DHCP options, including
  vendor-encapsulated options. It includes a secure, read-only, TFTP server to
  allow net/PXE boot of DHCP hosts and also supports BOOTP. The PXE support is
  full featured, and includes a proxy mode which supplies PXE information to
  clients whilst DHCP address allocation is done by another server.
<div class="Pp"></div>
The dnsmasq DHCPv6 server provides the same set of features as the DHCPv4
  server, and in addition, it includes router advertisements and a neat feature
  which allows nameing for clients which use DHCPv4 and stateless
  autoconfiguration only for IPv6 configuration. There is support for doing
  address allocation (both DHCPv6 and RA) from subnets which are dynamically
  delegated via DHCPv6 prefix delegation.
<div class="Pp"></div>
Dnsmasq is coded with small embedded systems in mind. It aims for the smallest
  possible memory footprint compatible with the supported functions, and allows
  uneeded functions to be omitted from the compiled binary.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
Note that in general missing parameters are allowed and switch off functions,
  for instance &quot;--pid-file&quot; disables writing a PID file. On BSD,
  unless the GNU getopt library is linked, the long form of the options does not
  work on the command line; it is still recognised in the configuration file.
<dl class="Bl-tag">
  <dt class="It-tag"><b>--test</b></dt>
  <dd class="It-tag">Read and syntax check configuration file(s). Exit with code
      0 if all is OK, or a non-zero code otherwise. Do not start up
    dnsmasq.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-h, --no-hosts</b></dt>
  <dd class="It-tag">Don't read the hostnames in /etc/hosts.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-H, --addn-hosts=&lt;file&gt;</b></dt>
  <dd class="It-tag">Additional hosts file. Read the specified file as well as
      /etc/hosts. If -h is given, read only the specified file. This option may
      be repeated for more than one additional hosts file. If a directory is
      given, then read all the files contained in that directory.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-E, --expand-hosts</b></dt>
  <dd class="It-tag">Add the domain to simple names (without a period) in
      /etc/hosts in the same way as for DHCP-derived names. Note that this does
      not apply to domain names in cnames, PTR records, TXT records etc.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-T, --local-ttl=&lt;time&gt;</b></dt>
  <dd class="It-tag">When replying with information from /etc/hosts or the DHCP
      leases file dnsmasq by default sets the time-to-live field to zero,
      meaning that the requester should not itself cache the information. This
      is the correct thing to do in almost all situations. This option allows a
      time-to-live (in seconds) to be given for these replies. This will reduce
      the load on the server at the expense of clients using stale data under
      some circumstances.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--neg-ttl=&lt;time&gt;</b></dt>
  <dd class="It-tag">Negative replies from upstream servers normally contain
      time-to-live information in SOA records which dnsmasq uses for caching. If
      the replies from upstream servers omit this information, dnsmasq does not
      cache the reply. This option gives a default value for time-to-live (in
      seconds) which dnsmasq uses to cache negative replies even in the absence
      of an SOA record.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--max-ttl=&lt;time&gt;</b></dt>
  <dd class="It-tag">Set a maximum TTL value that will be handed out to clients.
      The specified maximum TTL will be given to clients instead of the true TTL
      value if it is lower. The true TTL value is however kept in the cache to
      avoid flooding the upstream DNS servers.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--max-cache-ttl=&lt;time&gt;</b></dt>
  <dd class="It-tag">Set a maximum TTL value for entries in the cache.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--auth-ttl=&lt;time&gt;</b></dt>
  <dd class="It-tag">Set the TTL value returned in answers from the
      authoritative server.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-k, --keep-in-foreground</b></dt>
  <dd class="It-tag">Do not go into the background at startup but otherwise run
      as normal. This is intended for use when dnsmasq is run under daemontools
      or launchd.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-d, --no-daemon</b></dt>
  <dd class="It-tag">Debug mode: don't fork to the background, don't write a pid
      file, don't change user id, generate a complete cache dump on receipt on
      SIGUSR1, log to stderr as well as syslog, don't fork new processes to
      handle TCP queries. Note that this option is for use in debugging only, to
      stop dnsmasq daemonising in production, use <b>-k.</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-q, --log-queries</b></dt>
  <dd class="It-tag">Log the results of DNS queries handled by dnsmasq. Enable a
      full cache dump on receipt of SIGUSR1.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-8, --log-facility=&lt;facility&gt;</b></dt>
  <dd class="It-tag">Set the facility to which dnsmasq will send syslog entries,
      this defaults to DAEMON, and to LOCAL0 when debug mode is in operation. If
      the facility given contains at least one '/' character, it is taken to be
      a filename, and dnsmasq logs to the given file, instead of syslog. If the
      facility is '-' then dnsmasq logs to stderr. (Errors whilst reading
      configuration will still go to syslog, but all output from a successful
      startup, and all output whilst running, will go exclusively to the file.)
      When logging to a file, dnsmasq will close and reopen the file when it
      receives SIGUSR2. This allows the log file to be rotated without stopping
      dnsmasq.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--log-async[=&lt;lines&gt;]</b></dt>
  <dd class="It-tag">Enable asynchronous logging and optionally set the limit on
      the number of lines which will be queued by dnsmasq when writing to the
      syslog is slow. Dnsmasq can log asynchronously: this allows it to continue
      functioning without being blocked by syslog, and allows syslog to use
      dnsmasq for DNS queries without risking deadlock. If the queue of
      log-lines becomes full, dnsmasq will log the overflow, and the number of
      messages lost. The default queue length is 5, a sane value would be 5-25,
      and a maximum limit of 100 is imposed.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-x, --pid-file=&lt;path&gt;</b></dt>
  <dd class="It-tag">Specify an alternate path for dnsmasq to record its
      process-id in. Normally /var/run/dnsmasq.pid.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-u, --user=&lt;username&gt;</b></dt>
  <dd class="It-tag">Specify the userid to which dnsmasq will change after
      startup. Dnsmasq must normally be started as root, but it will drop root
      privileges after startup by changing id to another user. Normally this
      user is &quot;nobody&quot; but that can be over-ridden with this
    switch.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-g, --group=&lt;groupname&gt;</b></dt>
  <dd class="It-tag">Specify the group which dnsmasq will run as. The defaults
      to &quot;dip&quot;, if available, to facilitate access to
      /etc/ppp/resolv.conf which is not normally world readable.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-v, --version</b></dt>
  <dd class="It-tag">Print the version number.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-p, --port=&lt;port&gt;</b></dt>
  <dd class="It-tag">Listen on &lt;port&gt; instead of the standard DNS port
      (53). Setting this to zero completely disables DNS function, leaving only
      DHCP and/or TFTP.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-P, --edns-packet-max=&lt;size&gt;</b></dt>
  <dd class="It-tag">Specify the largest EDNS.0 UDP packet which is supported by
      the DNS forwarder. Defaults to 4096, which is the RFC5625-recommended
      size.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-Q, --query-port=&lt;query_port&gt;</b></dt>
  <dd class="It-tag">Send outbound DNS queries from, and listen for their
      replies on, the specific UDP port &lt;query_port&gt; instead of using
      random ports. NOTE that using this option will make dnsmasq less secure
      against DNS spoofing attacks but it may be faster and use less resources.
      Setting this option to zero makes dnsmasq use a single port allocated to
      it by the OS: this was the default behaviour in versions prior to
    2.43.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--min-port=&lt;port&gt;</b></dt>
  <dd class="It-tag">Do not use ports less than that given as source for
      outbound DNS queries. Dnsmasq picks random ports as source for outbound
      queries: when this option is given, the ports used will always to larger
      than that specified. Useful for systems behind firewalls.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-i, --interface=&lt;interface name&gt;</b></dt>
  <dd class="It-tag">Listen only on the specified interface(s). Dnsmasq
      automatically adds the loopback (local) interface to the list of
      interfaces to use when the <b>--interface</b> option is used. If no
      <b>--interface</b> or <b>--listen-address</b> options are given dnsmasq
      listens on all available interfaces except any given in
      <b>--except-interface</b> options. IP alias interfaces (eg
      &quot;eth1:0&quot;) cannot be used with <b>--interface</b> or
      <b>--except-interface</b> options, use --listen-address instead. A simple
      wildcard, consisting of a trailing '*', can be used in <b>--interface</b>
      and <b>--except-interface</b> options.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-I, --except-interface=&lt;interface name&gt;</b></dt>
  <dd class="It-tag">Do not listen on the specified interface. Note that the
      order of <b>--listen-address</b> <b>--interface</b> and
      <b>--except-interface</b> options does not matter and that
      <b>--except-interface</b> options always override the others.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--auth-server=&lt;domain&gt;,&lt;interface&gt;|&lt;ip-address&gt;</b></dt>
  <dd class="It-tag">Enable DNS authoritative mode for queries arriving at an
      interface or address. Note that the interface or address need not be
      mentioned in <b>--interface</b> or <b>--listen-address</b> configuration,
      indeed <b>--auth-server</b> will overide these and provide a different DNS
      service on the specified interface. The &lt;domain&gt; is the &quot;glue
      record&quot;. It should resolve in the global DNS to a A and/or AAAA
      record which points to the address dnsmasq is listening on.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-2, --no-dhcp-interface=&lt;interface name&gt;</b></dt>
  <dd class="It-tag">Do not provide DHCP or TFTP on the specified interface, but
      do provide DNS service.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-a, --listen-address=&lt;ipaddr&gt;</b></dt>
  <dd class="It-tag">Listen on the given IP address(es). Both <b>--interface</b>
      and <b>--listen-address</b> options may be given, in which case the set of
      both interfaces and addresses is used. Note that if no <b>--interface</b>
      option is given, but <b>--listen-address</b> is, dnsmasq will not
      automatically listen on the loopback interface. To achieve this, its IP
      address, 127.0.0.1, must be explicitly given as a <b>--listen-address</b>
      option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-z, --bind-interfaces</b></dt>
  <dd class="It-tag">On systems which support it, dnsmasq binds the wildcard
      address, even when it is listening on only some interfaces. It then
      discards requests that it shouldn't reply to. This has the advantage of
      working even when interfaces come and go and change address. This option
      forces dnsmasq to really bind only the interfaces it is listening on.
      About the only time when this is useful is when running another nameserver
      (or another instance of dnsmasq) on the same machine. Setting this option
      also enables multiple instances of dnsmasq which provide DHCP service to
      run in the same machine.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--bind-dynamic</b></dt>
  <dd class="It-tag">Enable a network mode which is a hybrid between
      <b>--bind-interfaces</b> and the default. Dnsmasq binds the address of
      individual interfaces, allowing multiple dnsmasq instances, but if new
      interfaces or addresses appear, it automatically listens on those (subject
      to any access-control configuration). This makes dynamically created
      interfaces work in the same way as the default. Implementing this option
      requires non-standard networking APIs and it is only available under
      Linux. On other platforms it falls-back to --bind-interfaces mode.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-y, --localise-queries</b></dt>
  <dd class="It-tag">Return answers to DNS queries from /etc/hosts which depend
      on the interface over which the query was received. If a name in
      /etc/hosts has more than one address associated with it, and at least one
      of those addresses is on the same subnet as the interface to which the
      query was sent, then return only the address(es) on that subnet. This
      allows for a server to have multiple addresses in /etc/hosts corresponding
      to each of its interfaces, and hosts will get the correct address based on
      which network they are attached to. Currently this facility is limited to
      IPv4.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-b, --bogus-priv</b></dt>
  <dd class="It-tag">Bogus private reverse lookups. All reverse lookups for
      private IP ranges (ie 192.168.x.x, etc) which are not found in /etc/hosts
      or the DHCP leases file are answered with &quot;no such domain&quot;
      rather than being forwarded upstream.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-V,
    --alias=[&lt;old-ip&gt;]|[&lt;start-ip&gt;-&lt;end-ip&gt;],&lt;new-ip&gt;[,&lt;mask&gt;]</b></dt>
  <dd class="It-tag">Modify IPv4 addresses returned from upstream nameservers;
      old-ip is replaced by new-ip. If the optional mask is given then any
      address which matches the masked old-ip will be re-written. So, for
      instance <b>--alias=1.2.3.0,6.7.8.0,255.255.255.0</b> will map 1.2.3.56 to
      6.7.8.56 and 1.2.3.67 to 6.7.8.67. This is what Cisco PIX routers call
      &quot;DNS doctoring&quot;. If the old IP is given as range, then only
      addresses in the range, rather than a whole subnet, are re-written. So
      <b>--alias=192.168.0.10-192.168.0.40,10.0.0.0,255.255.255.0</b> maps
      192.168.0.10-&gt;192.168.0.40 to 10.0.0.10-&gt;10.0.0.40</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-B, --bogus-nxdomain=&lt;ipaddr&gt;</b></dt>
  <dd class="It-tag">Transform replies which contain the IP address given into
      &quot;No such domain&quot; replies. This is intended to counteract a
      devious move made by Verisign in September 2003 when they started
      returning the address of an advertising web page in response to queries
      for unregistered names, instead of the correct NXDOMAIN response. This
      option tells dnsmasq to fake the correct response when it sees this
      behaviour. As at Sept 2003 the IP address being returned by Verisign is
      64.94.110.11</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-f, --filterwin2k</b></dt>
  <dd class="It-tag">Later versions of windows make periodic DNS requests which
      don't get sensible answers from the public DNS and can cause problems by
      triggering dial-on-demand links. This flag turns on an option to filter
      such requests. The requests blocked are for records of types SOA and SRV,
      and type ANY where the requested name has underscores, to catch LDAP
      requests.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-r, --resolv-file=&lt;file&gt;</b></dt>
  <dd class="It-tag">Read the IP addresses of the upstream nameservers from
      &lt;file&gt;, instead of /etc/resolv.conf. For the format of this file see
      <b>resolv.conf</b>(5). The only lines relevant to dnsmasq are nameserver
      ones. Dnsmasq can be told to poll more than one resolv.conf file, the
      first file name specified overrides the default, subsequent ones add to
      the list. This is only allowed when polling; the file with the currently
      latest modification time is the one used.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-R, --no-resolv</b></dt>
  <dd class="It-tag">Don't read /etc/resolv.conf. Get upstream servers only from
      the command line or the dnsmasq configuration file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-1, --enable-dbus[=&lt;service-name&gt;]</b></dt>
  <dd class="It-tag">Allow dnsmasq configuration to be updated via DBus method
      calls. The configuration which can be changed is upstream DNS servers (and
      corresponding domains) and cache clear. Requires that dnsmasq has been
      built with DBus support. If the service name is given, dnsmasq provides
      service at that name, rather than the default which is
      <b>uk.org.thekelleys.dnsmasq</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-o, --strict-order</b></dt>
  <dd class="It-tag">By default, dnsmasq will send queries to any of the
      upstream servers it knows about and tries to favour servers that are known
      to be up. Setting this flag forces dnsmasq to try each query with each
      server strictly in the order they appear in /etc/resolv.conf</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--all-servers</b></dt>
  <dd class="It-tag">By default, when dnsmasq has more than one upstream server
      available, it will send queries to just one server. Setting this flag
      forces dnsmasq to send all queries to all available servers. The reply
      from the server which answers first will be returned to the original
      requester.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--stop-dns-rebind</b></dt>
  <dd class="It-tag">Reject (and log) addresses from upstream nameservers which
      are in the private IP ranges. This blocks an attack where a browser behind
      a firewall is used to probe machines on the local network.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--rebind-localhost-ok</b></dt>
  <dd class="It-tag">Exempt 127.0.0.0/8 from rebinding checks. This address
      range is returned by realtime black hole servers, so blocking it may
      disable these services.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--rebind-domain-ok=[&lt;domain&gt;]|[[/&lt;domain&gt;/[&lt;domain&gt;/]</b></dt>
  <dd class="It-tag">Do not detect and block dns-rebind on queries to these
      domains. The argument may be either a single domain, or multiple domains
      surrounded by '/', like the --server syntax, eg.
      <b>--rebind-domain-ok=/domain1/domain2/domain3/</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-n, --no-poll</b></dt>
  <dd class="It-tag">Don't poll /etc/resolv.conf for changes.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--clear-on-reload</b></dt>
  <dd class="It-tag">Whenever /etc/resolv.conf is re-read, clear the DNS cache.
      This is useful when new nameservers may have different data than that held
      in cache.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-D, --domain-needed</b></dt>
  <dd class="It-tag">Tells dnsmasq to never forward A or AAAA queries for plain
      names, without dots or domain parts, to upstream nameservers. If the name
      is not known from /etc/hosts or DHCP then a &quot;not found&quot; answer
      is returned.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-S, --local,
    --server=[/[&lt;domain&gt;]/[domain/]][&lt;ipaddr&gt;[#&lt;port&gt;][@&lt;source-ip&gt;|&lt;interface&gt;[#&lt;port&gt;]]</b></dt>
  <dd class="It-tag">Specify IP address of upstream servers directly. Setting
      this flag does not suppress reading of /etc/resolv.conf, use -R to do
      that. If one or more optional domains are given, that server is used only
      for those domains and they are queried only using the specified server.
      This is intended for private nameservers: if you have a nameserver on your
      network which deals with names of the form xxx.internal.thekelleys.org.uk
      at 192.168.1.1 then giving the flag <b>-S
      /internal.thekelleys.org.uk/192.168.1.1</b> will send all queries for
      internal machines to that nameserver, everything else will go to the
      servers in /etc/resolv.conf. An empty domain specification, <b>//</b> has
      the special meaning of &quot;unqualified names only&quot; ie names without
      any dots in them. A non-standard port may be specified as part of the IP
      address using a # character. More than one -S flag is allowed, with
      repeated domain or ipaddr parts as required.
    <div style="height: 1.00em;">&#x00A0;</div>
    More specific domains take precendence over less specific domains, so:
      <b>--server=/google.com/1.2.3.4</b>
      <b>--server=/www.google.com/2.3.4.5</b> will send queries for *.google.com
      to 1.2.3.4, except *www.google.com, which will go to 2.3.4.5
    <div style="height: 1.00em;">&#x00A0;</div>
    The special server address '#' means, &quot;use the standard servers&quot;,
      so <b>--server=/google.com/1.2.3.4</b> <b>--server=/www.google.com/#</b>
      will send queries for *.google.com to 1.2.3.4, except *www.google.com
      which will be forwarded as usual.
    <div style="height: 1.00em;">&#x00A0;</div>
    Also permitted is a -S flag which gives a domain but no IP address; this
      tells dnsmasq that a domain is local and it may answer queries from
      /etc/hosts or DHCP but should never forward queries on that domain to any
      upstream servers. <b>local</b> is a synonym for <b>server</b> to make
      configuration files clearer in this case.
    <div style="height: 1.00em;">&#x00A0;</div>
    IPv6 addresses may include a %interface scope-id, eg
      fe80::202:a412:4512:7bbf%eth0.
    <div style="height: 1.00em;">&#x00A0;</div>
    The optional string after the @ character tells dnsmasq how to set the
      source of the queries to this nameserver. It should be an ip-address,
      which should belong to the machine on which dnsmasq is running otherwise
      this server line will be logged and then ignored, or an interface name. If
      an interface name is given, then queries to the server will be forced via
      that interface; if an ip-address is given then the source address of the
      queries will be set to that address. The query-port flag is ignored for
      any servers which have a source address specified but the port may be
      specified directly as part of the source address. Forcing queries to an
      interface is not implemented on all platforms supported by dnsmasq.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-A,
    --address=/&lt;domain&gt;/[domain/]&lt;ipaddr&gt;</b></dt>
  <dd class="It-tag">Specify an IP address to return for any host in the given
      domains. Queries in the domains are never forwarded and always replied to
      with the specified IP address which may be IPv4 or IPv6. To give both IPv4
      and IPv6 addresses for a domain, use repeated -A flags. Note that
      /etc/hosts and DHCP leases override this for individual names. A common
      use of this is to redirect the entire doubleclick.net domain to some
      friendly local web server to avoid banner ads. The domain specification
      works in the same was as for --server, with the additional facility that
      /#/ matches any domain. Thus --address=/#/1.2.3.4 will always return
      1.2.3.4 for any query not answered from /etc/hosts or DHCP and not sent to
      an upstream nameserver by a more specific --server directive.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ipset=/&lt;domain&gt;/[domain/]&lt;ipset&gt;[,&lt;ipset&gt;]</b></dt>
  <dd class="It-tag">Places the resolved IP addresses of queries for the
      specified domains in the specified netfilter ip sets. Domains and
      subdomains are matched in the same way as --address. These ip sets must
      already exist. See ipset(8) for more details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-m, --mx-host=&lt;mx
    name&gt;[[,&lt;hostname&gt;],&lt;preference&gt;]</b></dt>
  <dd class="It-tag">Return an MX record named &lt;mx name&gt; pointing to the
      given hostname (if given), or the host specified in the --mx-target switch
      or, if that switch is not given, the host on which dnsmasq is running. The
      default is useful for directing mail from systems on a LAN to a central
      server. The preference value is optional, and defaults to 1 if not given.
      More than one MX record may be given for a host.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-t, --mx-target=&lt;hostname&gt;</b></dt>
  <dd class="It-tag">Specify the default target for the MX record returned by
      dnsmasq. See --mx-host. If --mx-target is given, but not --mx-host, then
      dnsmasq returns a MX record containing the MX target for MX queries on the
      hostname of the machine on which dnsmasq is running.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-e, --selfmx</b></dt>
  <dd class="It-tag">Return an MX record pointing to itself for each local
      machine. Local machines are those in /etc/hosts or with DHCP leases.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-L, --localmx</b></dt>
  <dd class="It-tag">Return an MX record pointing to the host given by mx-target
      (or the machine on which dnsmasq is running) for each local machine. Local
      machines are those in /etc/hosts or with DHCP leases.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-W,
    --srv-host=&lt;_service&gt;.&lt;_prot&gt;.[&lt;domain&gt;],[&lt;target&gt;[,&lt;port&gt;[,&lt;priority&gt;[,&lt;weight&gt;]]]]</b></dt>
  <dd class="It-tag">Return a SRV DNS record. See RFC2782 for details. If not
      supplied, the domain defaults to that given by <b>--domain.</b> The
      default for the target domain is empty, and the default for port is one
      and the defaults for weight and priority are zero. Be careful if
      transposing data from BIND zone files: the port, weight and priority
      numbers are in a different order. More than one SRV record for a given
      service/domain is allowed, all that match are returned.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--host-record=&lt;name&gt;[,&lt;name&gt;....][&lt;IPv4-address&gt;],[&lt;IPv6-address&gt;]</b></dt>
  <dd class="It-tag">Add A, AAAA and PTR records to the DNS. This adds one or
      more names to the DNS with associated IPv4 (A) and IPv6 (AAAA) records. A
      name may appear in more than one <b>host-record</b> and therefore be
      assigned more than one address. Only the first address creates a PTR
      record linking the address to the name. This is the same rule as is used
      reading hosts-files. <b>host-record</b> options are considered to be read
      before host-files, so a name appearing there inhibits PTR-record creation
      if it appears in hosts-file also. Unlike hosts-files, names are not
      expanded, even when <b>expand-hosts</b> is in effect. Short and long names
      may appear in the same <b>host-record,</b> eg.
      <b>--host-record=laptop,laptop.thekelleys.org,192.168.0.1,1234::100</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-Y,
    --txt-record=&lt;name&gt;[[,&lt;text&gt;],&lt;text&gt;]</b></dt>
  <dd class="It-tag">Return a TXT DNS record. The value of TXT record is a set
      of strings, so any number may be included, delimited by commas; use quotes
      to put commas into a string. Note that the maximum length of a single
      string is 255 characters, longer strings are split into 255 character
      chunks.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--ptr-record=&lt;name&gt;[,&lt;target&gt;]</b></dt>
  <dd class="It-tag">Return a PTR DNS record.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--naptr-record=&lt;name&gt;,&lt;order&gt;,&lt;preference&gt;,&lt;flags&gt;,&lt;service&gt;,&lt;regexp&gt;[,&lt;replacement&gt;]</b></dt>
  <dd class="It-tag">Return an NAPTR DNS record, as specified in RFC3403.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--cname=&lt;cname&gt;,&lt;target&gt;</b></dt>
  <dd class="It-tag">Return a CNAME record which indicates that &lt;cname&gt; is
      really &lt;target&gt;. There are significant limitations on the target; it
      must be a DNS name which is known to dnsmasq from /etc/hosts (or
      additional hosts files), from DHCP or from another <b>--cname.</b> If the
      target does not satisfy this criteria, the whole cname is ignored. The
      cname must be unique, but it is permissable to have more than one cname
      pointing to the same target.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dns-rr=&lt;name&gt;,&lt;RR-number&gt;,[&lt;hex
    data&gt;]</b></dt>
  <dd class="It-tag">Return an arbitrary DNS Resource Record. The number is the
      type of the record (which is always in the C_IN class). The value of the
      record is given by the hex data, which may be of the form 01:23:45 or 01
      23 45 or 012345 or any mixture of these.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--interface-name=&lt;name&gt;,&lt;interface&gt;</b></dt>
  <dd class="It-tag">Return a DNS record associating the name with the primary
      address on the given interface. This flag specifies an A record for the
      given name in the same way as an /etc/hosts line, except that the address
      is not constant, but taken from the given interface. If the interface is
      down, not configured or non-existent, an empty record is returned. The
      matching PTR record is also created, mapping the interface address to the
      name. More than one name may be associated with an interface address by
      repeating the flag; in that case the first instance is used for the
      reverse address-to-name mapping.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--add-mac</b></dt>
  <dd class="It-tag">Add the MAC address of the requestor to DNS queries which
      are forwarded upstream. This may be used to DNS filtering by the upstream
      server. The MAC address can only be added if the requestor is on the same
      subnet as the dnsmasq server. Note that the mechanism used to achieve this
      (an EDNS0 option) is not yet standardised, so this should be considered
      experimental. Also note that exposing MAC addresses in this way may have
      security and privacy implications.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-c, --cache-size=&lt;cachesize&gt;</b></dt>
  <dd class="It-tag">Set the size of dnsmasq's cache. The default is 150 names.
      Setting the cache size to zero disables caching.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-N, --no-negcache</b></dt>
  <dd class="It-tag">Disable negative caching. Negative caching allows dnsmasq
      to remember &quot;no such domain&quot; answers from upstream nameservers
      and answer identical queries without forwarding them again.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-0, --dns-forward-max=&lt;queries&gt;</b></dt>
  <dd class="It-tag">Set the maximum number of concurrent DNS queries. The
      default value is 150, which should be fine for most setups. The only known
      situation where this needs to be increased is when using web-server log
      file resolvers, which can generate large numbers of concurrent
    queries.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--proxy-dnssec</b></dt>
  <dd class="It-tag">A resolver on a client machine can do DNSSEC validation in
      two ways: it can perform the cryptograhic operations on the reply it
      receives, or it can rely on the upstream recursive nameserver to do the
      validation and set a bit in the reply if it succeeds. Dnsmasq is not a
      DNSSEC validator, so it cannot perform the validation role of the
      recursive nameserver, but it can pass through the validation results from
      its own upstream nameservers. This option enables this behaviour. You
      should only do this if you trust all the configured upstream nameservers
      <i>and the network between you and them.</i> If you use the first DNSSEC
      mode, validating resolvers in clients, this option is not required.
      Dnsmasq always returns all the data needed for a client to do validation
      itself.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--auth-zone=&lt;domain&gt;[,&lt;subnet&gt;[/&lt;prefix
    length&gt;][,&lt;subnet&gt;[/&lt;prefix length&gt;].....]]</b></dt>
  <dd class="It-tag">Define a DNS zone for which dnsmasq acts as authoritative
      server. Locally defined DNS records which are in the domain will be
      served, except that A and AAAA records must be in one of the specified
      subnets, or in a subnet corresponding to a constructed DHCP range. The
      subnet(s) are also used to define in-addr.arpa and ipv6.arpa domains which
      are served for reverse-DNS queries. If not specified, the prefix length
      defaults to 24 for IPv4 and 64 for IPv6. For IPv4 subnets, the prefix
      length should be have the value 8, 16 or 24 unless you are familiar with
      RFC 2317 and have arranged the in-addr.arpa delegation accordingly.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--auth-soa=&lt;serial&gt;[,&lt;hostmaster&gt;[,&lt;refresh&gt;[,&lt;retry&gt;[,&lt;expiry&gt;]]]]</b></dt>
  <dd class="It-tag">Specify fields in the SOA record associated with
      authoritative zones. Note that this is optional, all the values are set to
      sane defaults.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--auth-sec-servers=&lt;domain&gt;[,&lt;domain&gt;[,&lt;domain&gt;...]]</b></dt>
  <dd class="It-tag">Specify any secondary servers for a zone for which dnsmasq
      is authoritative. These servers must be configured to get zone data from
      dnsmasq by zone transfer, and answer queries for the same authoritative
      zones as dnsmasq.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--auth-peer=&lt;ip-address&gt;[,&lt;ip-address&gt;[,&lt;ip-address&gt;...]]</b></dt>
  <dd class="It-tag">Specify the addresses of secondary servers which are
      allowed to initiate zone transfer (AXFR) requests for zones for which
      dnsmasq is authoritative. If this option is not given, then AXFR requests
      will be accepted from any secondary.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--conntrack</b></dt>
  <dd class="It-tag">Read the Linux connection track mark associated with
      incoming DNS queries and set the same mark value on upstream traffic used
      to answer those queries. This allows traffic generated by dnsmasq to be
      associated with the queries which cause it, useful for bandwidth
      accounting and firewalling. Dnsmasq must have conntrack support compiled
      in and the kernel must have conntrack support included and configured.
      This option cannot be combined with --query-port.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-F,
    --dhcp-range=[tag:&lt;tag&gt;[,tag:&lt;tag&gt;],][set:&lt;tag&gt;,]&lt;start-addr&gt;[,&lt;end-addr&gt;][,&lt;mode&gt;][,&lt;netmask&gt;[,&lt;broadcast&gt;]][,&lt;lease
    time&gt;]</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-F,
    --dhcp-range=[tag:&lt;tag&gt;[,tag:&lt;tag&gt;],][set:&lt;tag&gt;,]&lt;start-IPv6addr&gt;[,&lt;end-IPv6addr&gt;|constructor:&lt;interface&gt;][,&lt;mode&gt;][,&lt;prefix-len&gt;][,&lt;lease
    time&gt;]</b></dt>
  <dd class="It-tag">
    <div style="height: 1.00em;">&#x00A0;</div>
    Enable the DHCP server. Addresses will be given out from the range
      &lt;start-addr&gt; to &lt;end-addr&gt; and from statically defined
      addresses given in <b>dhcp-host</b> options. If the lease time is given,
      then leases will be given for that length of time. The lease time is in
      seconds, or minutes (eg 45m) or hours (eg 1h) or &quot;infinite&quot;. If
      not given, the default lease time is one hour. The minimum lease time is
      two minutes. For IPv6 ranges, the lease time maybe &quot;deprecated&quot;;
      this sets the preferred lifetime sent in a DHCP lease or router
      advertisement to zero, which causes clients to use other addresses, if
      available, for new connections as a prelude to renumbering.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option may be repeated, with different addresses, to enable DHCP
      service to more than one network. For directly connected networks (ie,
      networks on which the machine running dnsmasq has an interface) the
      netmask is optional: dnsmasq will determine it from the interface
      configuration. For networks which receive DHCP service via a relay agent,
      dnsmasq cannot determine the netmask itself, so it should be specified,
      otherwise dnsmasq will have to guess, based on the class (A, B or C) of
      the network address. The broadcast address is always optional. It is
      always allowed to have more than one dhcp-range in a single subnet.
    <div style="height: 1.00em;">&#x00A0;</div>
    For IPv6, the parameters are slightly different: instead of netmask and
      broadcast address, there is an optional prefix length. If not given, this
      defaults to 64. Unlike the IPv4 case, the prefix length is not
      automatically derived from the interface configuration. The mimimum size
      of the prefix length is 64.
    <div style="height: 1.00em;">&#x00A0;</div>
    IPv6 (only) supports another type of range. In this, the start address and
      optional end address contain only the network part (ie ::1) and they are
      followed by <b>constructor:&lt;interface&gt;.</b> This forms a template
      which describes how to create ranges, based on the addresses assigned to
      the interface. For instance
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>--dhcp-range=::1,::400,constructor:eth0</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    will look for addresses of the form &lt;network&gt;::1 or
      &lt;network&gt;:400 on eth0 and then create a range from
      &lt;network&gt;::1 to &lt;network&gt;::400. If the interface is assigned
      more than one network, then the corresponding ranges will be automatically
      created, and then deprecated and finally removed again as the address is
      deprecated and then deleted. The interface name may have a final
      &quot;*&quot; wildcard. Note that just any address on eth0 will not do:
      the non-prefix part must be equal either the start or end address given in
      the dhcp-range. This is to prevent prefixes becoming perpetual if the
      interface gains a SLAAC address for the prefix when it is advertised by
      dnsmasq.
    <div style="height: 1.00em;">&#x00A0;</div>
    The optional <b>set:&lt;tag&gt;</b> sets an alphanumeric label which marks
      this network so that dhcp options may be specified on a per-network basis.
      When it is prefixed with 'tag:' instead, then its meaning changes from
      setting a tag to matching it. Only one tag may be set, but more than one
      tag may be matched.
    <div style="height: 1.00em;">&#x00A0;</div>
    The optional &lt;mode&gt; keyword may be <b>static</b> which tells dnsmasq
      to enable DHCP for the network specified, but not to dynamically allocate
      IP addresses: only hosts which have static addresses given via
      <b>dhcp-host</b> or from /etc/ethers will be served. A static-only subnet
      with address all zeros may be used as a &quot;catch-all&quot; address to
      enable replies to all Information-request packets on a subnet which is
      provided with stateless DHCPv6, ie <b>--dhcp=range=::,static</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    For IPv4, the &lt;mode&gt; may be <b>proxy</b> in which case dnsmasq will
      provide proxy-DHCP on the specified subnet. (See <b>pxe-prompt</b> and
      <b>pxe-service</b> for details.)
    <div style="height: 1.00em;">&#x00A0;</div>
    For IPv6, the mode may be some combination of <b>ra-only, slaac, ra-names,
      ra-stateless.</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>ra-only</b> tells dnsmasq to offer Router Advertisement only on this
      subnet, and not DHCP.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>slaac</b> tells dnsmasq to offer Router Advertisement on this subnet and
      to set the A bit in the router advertisement, so that the client will use
      SLAAC addresses. When used with a DHCP range or static DHCP address this
      results in the client having both a DHCP-assigned and a SLAAC address.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>ra-stateless</b> sends router advertisements with the O and A bits set,
      and provides a stateless DHCP service. The client will use a SLAAC
      address, and use DHCP for other configuration information.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>ra-names</b> enables a mode which gives DNS names to dual-stack hosts
      which do SLAAC for IPv6. Dnsmasq uses the host's IPv4 lease to derive the
      name, network segment and MAC address and assumes that the host will also
      have an IPv6 address calculated using the SLAAC algorithm, on the same
      network segment. The address is pinged, and if a reply is received, an
      AAAA record is added to the DNS for this IPv6 address. Note that this is
      only happens for directly-connected networks, (not one doing DHCP via a
      relay) and it will not work if a host is using privacy extensions.
      <b>ra-names</b> can be combined with <b>ra-stateless</b> and <b>slaac.</b>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-G,
    --dhcp-host=[&lt;hwaddr&gt;][,id:&lt;client_id&gt;|*][,set:&lt;tag&gt;][,&lt;ipaddr&gt;][,&lt;hostname&gt;][,&lt;lease_time&gt;][,ignore]</b></dt>
  <dd class="It-tag">Specify per host parameters for the DHCP server. This
      allows a machine with a particular hardware address to be always allocated
      the same hostname, IP address and lease time. A hostname specified like
      this overrides any supplied by the DHCP client on the machine. It is also
      allowable to omit the hardware address and include the hostname, in which
      case the IP address and lease times will apply to any machine claiming
      that name. For example <b>--dhcp-host=00:20:e0:3b:13:af,wap,infinite</b>
      tells dnsmasq to give the machine with hardware address 00:20:e0:3b:13:af
      the name wap, and an infinite DHCP lease.
      <b>--dhcp-host=lap,192.168.0.199</b> tells dnsmasq to always allocate the
      machine lap the IP address 192.168.0.199.
    <div style="height: 1.00em;">&#x00A0;</div>
    Addresses allocated like this are not constrained to be in the range given
      by the --dhcp-range option, but they must be in the same subnet as some
      valid dhcp-range. For subnets which don't need a pool of dynamically
      allocated addresses, use the &quot;static&quot; keyword in the dhcp-range
      declaration.
    <div style="height: 1.00em;">&#x00A0;</div>
    It is allowed to use client identifiers (called client DUID in IPv6-land
      rather than hardware addresses to identify hosts by prefixing with 'id:'.
      Thus: <b>--dhcp-host=id:01:02:03:04,.....</b> refers to the host with
      client identifier 01:02:03:04. It is also allowed to specify the client ID
      as text, like this: <b>--dhcp-host=id:clientidastext,.....</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    A single <b>dhcp-host</b> may contain an IPv4 address or an IPv6 address, or
      both. IPv6 addresses must be bracketed by square brackets thus:
      <b>--dhcp-host=laptop,[1234::56]</b> IPv6 addresses may contain only the
      host-identifier part: <b>--dhcp-host=laptop,[::56]</b> in which case they
      act as wildcards in constructed dhcp ranges, with the appropriate network
      part inserted. Note that in IPv6 DHCP, the hardware address may not be
      available, though it normally is for direct-connected clients, or clients
      using DHCP relays which support RFC 6939.
    <div style="height: 1.00em;">&#x00A0;</div>
    For DHCPv4, the special option id:* means &quot;ignore any client-id and use
      MAC addresses only.&quot; This is useful when a client presents a
      client-id sometimes but not others.
    <div style="height: 1.00em;">&#x00A0;</div>
    If a name appears in /etc/hosts, the associated address can be allocated to
      a DHCP lease, but only if a <b>--dhcp-host</b> option specifying the name
      also exists. Only one hostname can be given in a <b>dhcp-host</b> option,
      but aliases are possible by using CNAMEs. (See <b>--cname</b> ).
    <div style="height: 1.00em;">&#x00A0;</div>
    The special keyword &quot;ignore&quot; tells dnsmasq to never offer a DHCP
      lease to a machine. The machine can be specified by hardware address,
      client ID or hostname, for instance
      <b>--dhcp-host=00:20:e0:3b:13:af,ignore</b> This is useful when there is
      another DHCP server on the network which should be used by some machines.
    <div style="height: 1.00em;">&#x00A0;</div>
    The set:&lt;tag&gt; construct sets the tag whenever this dhcp-host directive
      is in use. This can be used to selectively send DHCP options just for this
      host. More than one tag can be set in a dhcp-host directive (but not in
      other places where &quot;set:&lt;tag&gt;&quot; is allowed). When a host
      matches any dhcp-host directive (or one implied by /etc/ethers) then the
      special tag &quot;known&quot; is set. This allows dnsmasq to be configured
      to ignore requests from unknown machines using
      <b>--dhcp-ignore=tag:!known</b> Ethernet addresses (but not client-ids)
      may have wildcard bytes, so for example
      <b>--dhcp-host=00:20:e0:3b:13:*,ignore</b> will cause dnsmasq to ignore a
      range of hardware addresses. Note that the &quot;*&quot; will need to be
      escaped or quoted on a command line, but not in the configuration file.
    <div style="height: 1.00em;">&#x00A0;</div>
    Hardware addresses normally match any network (ARP) type, but it is possible
      to restrict them to a single ARP type by preceding them with the ARP-type
      (in HEX) and &quot;-&quot;. so
      <b>--dhcp-host=06-00:20:e0:3b:13:af,1.2.3.4</b> will only match a
      Token-Ring hardware address, since the ARP-address type for token ring is
      6.
    <div style="height: 1.00em;">&#x00A0;</div>
    As a special case, in DHCPv4, it is possible to include more than one
      hardware address. eg:
      <b>--dhcp-host=11:22:33:44:55:66,12:34:56:78:90:12,192.168.0.2</b> This
      allows an IP address to be associated with multiple hardware addresses,
      and gives dnsmasq permission to abandon a DHCP lease to one of the
      hardware addresses when another one asks for a lease. Beware that this is
      a dangerous thing to do, it will only work reliably if only one of the
      hardware addresses is active at any time and there is no way for dnsmasq
      to enforce this. It is, for instance, useful to allocate a stable IP
      address to a laptop which has both wired and wireless interfaces.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dhcp-hostsfile=&lt;path&gt;</b></dt>
  <dd class="It-tag">Read DHCP host information from the specified file. If a
      directory is given, then read all the files contained in that directory.
      The file contains information about one host per line. The format of a
      line is the same as text to the right of '=' in --dhcp-host. The advantage
      of storing DHCP host information in this file is that it can be changed
      without re-starting dnsmasq: the file will be re-read when dnsmasq
      receives SIGHUP.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dhcp-optsfile=&lt;path&gt;</b></dt>
  <dd class="It-tag">Read DHCP option information from the specified file. If a
      directory is given, then read all the files contained in that directory.
      The advantage of using this option is the same as for --dhcp-hostsfile:
      the dhcp-optsfile will be re-read when dnsmasq receives SIGHUP. Note that
      it is possible to encode the information in a <b>--dhcp-boot</b> flag as
      DHCP options, using the options names bootfile-name, server-ip-address and
      tftp-server. This allows these to be included in a dhcp-optsfile.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-Z, --read-ethers</b></dt>
  <dd class="It-tag">Read /etc/ethers for information about hosts for the DHCP
      server. The format of /etc/ethers is a hardware address, followed by
      either a hostname or dotted-quad IP address. When read by dnsmasq these
      lines have exactly the same effect as <b>--dhcp-host</b> options
      containing the same information. /etc/ethers is re-read when dnsmasq
      receives SIGHUP. IPv6 addresses are NOT read from /etc/ethers.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-O,
    --dhcp-option=[tag:&lt;tag&gt;,[tag:&lt;tag&gt;,]][encap:&lt;opt&gt;,][vi-encap:&lt;enterprise&gt;,][vendor:[&lt;vendor-class&gt;],][&lt;opt&gt;|option:&lt;opt-name&gt;|option6:&lt;opt&gt;|option6:&lt;opt-name&gt;],[&lt;value&gt;[,&lt;value&gt;]]</b></dt>
  <dd class="It-tag">Specify different or extra options to DHCP clients. By
      default, dnsmasq sends some standard options to DHCP clients, the netmask
      and broadcast address are set to the same as the host running dnsmasq, and
      the DNS server and default route are set to the address of the machine
      running dnsmasq. (Equivalent rules apply for IPv6.) If the domain name
      option has been set, that is sent. This configuration allows these
      defaults to be overridden, or other options specified. The option, to be
      sent may be given as a decimal number or as
      &quot;option:&lt;option-name&gt;&quot; The option numbers are specified in
      RFC2132 and subsequent RFCs. The set of option-names known by dnsmasq can
      be discovered by running &quot;dnsmasq --help dhcp&quot;. For example, to
      set the default route option to 192.168.4.4, do
      <b>--dhcp-option=3,192.168.4.4</b> or <b>--dhcp-option = option:router,
      192.168.4.4</b> and to set the time-server address to 192.168.0.4, do
      <b>--dhcp-option = 42,192.168.0.4</b> or <b>--dhcp-option =
      option:ntp-server, 192.168.0.4</b> The special address 0.0.0.0 (or [::]
      for DHCPv6) is taken to mean &quot;the address of the machine running
      dnsmasq&quot;. Data types allowed are comma separated dotted-quad IP
      addresses, a decimal number, colon-separated hex digits and a text string.
      If the optional tags are given then this option is only sent when all the
      tags are matched.
    <div style="height: 1.00em;">&#x00A0;</div>
    Special processing is done on a text argument for option 119, to conform
      with RFC 3397. Text or dotted-quad IP addresses as arguments to option 120
      are handled as per RFC 3361. Dotted-quad IP addresses which are followed
      by a slash and then a netmask size are encoded as described in RFC 3442.
    <div style="height: 1.00em;">&#x00A0;</div>
    IPv6 options are specified using the <b>option6:</b> keyword, followed by
      the option number or option name. The IPv6 option name space is disjoint
      from the IPv4 option name space. IPv6 addresses in options must be
      bracketed with square brackets, eg.
      <b>--dhcp-option=option6:ntp-server,[1234::56]</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
    Be careful: no checking is done that the correct type of data for the option
      number is sent, it is quite possible to persuade dnsmasq to generate
      illegal DHCP packets with injudicious use of this flag. When the value is
      a decimal number, dnsmasq must determine how large the data item is. It
      does this by examining the option number and/or the value, but can be
      overridden by appending a single letter flag as follows: b = one byte, s =
      two bytes, i = four bytes. This is mainly useful with encapsulated vendor
      class options (see below) where dnsmasq cannot determine data size from
      the option number. Option data which consists solely of periods and digits
      will be interpreted by dnsmasq as an IP address, and inserted into an
      option as such. To force a literal string, use quotes. For instance when
      using option 66 to send a literal IP address as TFTP server name, it is
      necessary to do <b>--dhcp-option=66,&quot;1.2.3.4&quot;</b>
    <div style="height: 1.00em;">&#x00A0;</div>
    Encapsulated Vendor-class options may also be specified (IPv4 only) using
      --dhcp-option: for instance
      <b>--dhcp-option=vendor:PXEClient,1,0.0.0.0</b> sends the encapsulated
      vendor class-specific option &quot;mftp-address=0.0.0.0&quot; to any
      client whose vendor-class matches &quot;PXEClient&quot;. The vendor-class
      matching is substring based (see --dhcp-vendorclass for details). If a
      vendor-class option (number 60) is sent by dnsmasq, then that is used for
      selecting encapsulated options in preference to any sent by the client. It
      is possible to omit the vendorclass completely;
      <b>--dhcp-option=vendor:,1,0.0.0.0</b> in which case the encapsulated
      option is always sent.
    <div style="height: 1.00em;">&#x00A0;</div>
    Options may be encapsulated (IPv4 only) within other options: for instance
      <b>--dhcp-option=encap:175, 190, iscsi-client0</b> will send option 175,
      within which is the option 190. If multiple options are given which are
      encapsulated with the same option number then they will be correctly
      combined into one encapsulated option. encap: and vendor: are may not both
      be set in the same dhcp-option.
    <div style="height: 1.00em;">&#x00A0;</div>
    The final variant on encapsulated options is &quot;Vendor-Identifying Vendor
      Options&quot; as specified by RFC3925. These are denoted like this:
      <b>--dhcp-option=vi-encap:2, 10, text</b> The number in the vi-encap:
      section is the IANA enterprise number used to identify this option. This
      form of encapsulation is supported in IPv6.
    <div style="height: 1.00em;">&#x00A0;</div>
    The address 0.0.0.0 is not treated specially in encapsulated options.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dhcp-option-force=[tag:&lt;tag&gt;,[tag:&lt;tag&gt;,]][encap:&lt;opt&gt;,][vi-encap:&lt;enterprise&gt;,][vendor:[&lt;vendor-class&gt;],]&lt;opt&gt;,[&lt;value&gt;[,&lt;value&gt;]]</b></dt>
  <dd class="It-tag">This works in exactly the same way as <b>--dhcp-option</b>
      except that the option will always be sent, even if the client does not
      ask for it in the parameter request list. This is sometimes needed, for
      example when sending options to PXELinux.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dhcp-no-override</b></dt>
  <dd class="It-tag">(IPv4 only) Disable re-use of the DHCP servername and
      filename fields as extra option space. If it can, dnsmasq moves the boot
      server and filename information (from dhcp-boot) out of their dedicated
      fields into DHCP options. This make extra space available in the DHCP
      packet for options but can, rarely, confuse old or broken clients. This
      flag forces &quot;simple and safe&quot; behaviour to avoid problems in
      such a case.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-U,
    --dhcp-vendorclass=set:&lt;tag&gt;,[enterprise:&lt;IANA-enterprise
    number&gt;,]&lt;vendor-class&gt;</b></dt>
  <dd class="It-tag">Map from a vendor-class string to a tag. Most DHCP clients
      provide a &quot;vendor class&quot; which represents, in some sense, the
      type of host. This option maps vendor classes to tags, so that DHCP
      options may be selectively delivered to different classes of hosts. For
      example <b>dhcp-vendorclass=set:printers,Hewlett-Packard JetDirect</b>
      will allow options to be set only for HP printers like so:
      <b>--dhcp-option=tag:printers,3,192.168.4.4</b> The vendor-class string is
      substring matched against the vendor-class supplied by the client, to
      allow fuzzy matching. The set: prefix is optional but allowed for
      consistency.
    <div style="height: 1.00em;">&#x00A0;</div>
    Note that in IPv6 only, vendorclasses are namespaced with an IANA-allocated
      enterprise number. This is given with enterprise: keyword and specifies
      that only vendorclasses matching the specified number should be
    searched.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-j,
    --dhcp-userclass=set:&lt;tag&gt;,&lt;user-class&gt;</b></dt>
  <dd class="It-tag">Map from a user-class string to a tag (with substring
      matching, like vendor classes). Most DHCP clients provide a &quot;user
      class&quot; which is configurable. This option maps user classes to tags,
      so that DHCP options may be selectively delivered to different classes of
      hosts. It is possible, for instance to use this to set a different printer
      server for hosts in the class &quot;accounts&quot; than for hosts in the
      class &quot;engineering&quot;.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-4, --dhcp-mac=set:&lt;tag&gt;,&lt;MAC
    address&gt;</b></dt>
  <dd class="It-tag">Map from a MAC address to a tag. The MAC address may
      include wildcards. For example <b>--dhcp-mac=set:3com,01:34:23:*:*:*</b>
      will set the tag &quot;3com&quot; for any host whose MAC address matches
      the pattern.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dhcp-circuitid=set:&lt;tag&gt;,&lt;circuit-id&gt;,
    --dhcp-remoteid=set:&lt;tag&gt;,&lt;remote-id&gt;</b></dt>
  <dd class="It-tag">Map from RFC3046 relay agent options to tags. This data may
      be provided by DHCP relay agents. The circuit-id or remote-id is normally
      given as colon-separated hex, but is also allowed to be a simple string.
      If an exact match is achieved between the circuit or agent ID and one
      provided by a relay agent, the tag is set.
    <div style="height: 1.00em;">&#x00A0;</div>
    <b>dhcp-remoteid</b> (but not dhcp-circuitid) is supported in IPv6.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dhcp-subscrid=set:&lt;tag&gt;,&lt;subscriber-id&gt;</b></dt>
  <dd class="It-tag">(IPv4 and IPv6) Map from RFC3993 subscriber-id relay agent
      options to tags.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dhcp-proxy[=&lt;ip addr&gt;]......</b></dt>
  <dd class="It-tag">(IPv4 only) A normal DHCP relay agent is only used to
      forward the initial parts of a DHCP interaction to the DHCP server. Once a
      client is configured, it communicates directly with the server. This is
      undesirable if the relay agent is adding extra information to the DHCP
      packets, such as that used by <b>dhcp-circuitid</b> and
      <b>dhcp-remoteid.</b> A full relay implementation can use the RFC 5107
      serverid-override option to force the DHCP server to use the relay as a
      full proxy, with all packets passing through it. This flag provides an
      alternative method of doing the same thing, for relays which don't support
      RFC 5107. Given alone, it manipulates the server-id for all interactions
      via relays. If a list of IP addresses is given, only interactions via
      relays at those addresses are affected.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dhcp-match=set:&lt;tag&gt;,&lt;option
    number&gt;|option:&lt;option
    name&gt;|vi-encap:&lt;enterprise&gt;[,&lt;value&gt;]</b></dt>
  <dd class="It-tag">Without a value, set the tag if the client sends a DHCP
      option of the given number or name. When a value is given, set the tag
      only if the option is sent and matches the value. The value may be of the
      form &quot;01:ff:*:02&quot; in which case the value must match (apart from
      wildcards) but the option sent may have unmatched data past the end of the
      value. The value may also be of the same form as in <b>dhcp-option</b> in
      which case the option sent is treated as an array, and one element must
      match, so
    <div style="height: 1.00em;">&#x00A0;</div>
    --dhcp-match=set:efi-ia32,option:client-arch,6
    <div style="height: 1.00em;">&#x00A0;</div>
    will set the tag &quot;efi-ia32&quot; if the the number 6 appears in the
      list of architectures sent by the client in option 93. (See RFC 4578 for
      details.) If the value is a string, substring matching is used.
    <div style="height: 1.00em;">&#x00A0;</div>
    The special form with vi-encap:&lt;enterprise number&gt; matches against
      vendor-identifying vendor classes for the specified enterprise. Please see
      RFC 3925 for more details of these rare and interesting beasts.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tag-if=set:&lt;tag&gt;[,set:&lt;tag&gt;[,tag:&lt;tag&gt;[,tag:&lt;tag&gt;]]]</b></dt>
  <dd class="It-tag">Perform boolean operations on tags. Any tag appearing as
      set:&lt;tag&gt; is set if all the tags which appear as tag:&lt;tag&gt; are
      set, (or unset when tag:!&lt;tag&gt; is used) If no tag:&lt;tag&gt;
      appears set:&lt;tag&gt; tags are set unconditionally. Any number of set:
      and tag: forms may appear, in any order. Tag-if lines ares executed in
      order, so if the tag in tag:&lt;tag&gt; is a tag set by another
      <b>tag-if,</b> the line which sets the tag must precede the one which
      tests it.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-J,
    --dhcp-ignore=tag:&lt;tag&gt;[,tag:&lt;tag&gt;]</b></dt>
  <dd class="It-tag">When all the given tags appear in the tag set ignore the
      host and do not allocate it a DHCP lease.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dhcp-ignore-names[=tag:&lt;tag&gt;[,tag:&lt;tag&gt;]]</b></dt>
  <dd class="It-tag">When all the given tags appear in the tag set, ignore any
      hostname provided by the host. Note that, unlike dhcp-ignore, it is
      permissible to supply no tags, in which case DHCP-client supplied
      hostnames are always ignored, and DHCP hosts are added to the DNS using
      only dhcp-host configuration in dnsmasq and the contents of /etc/hosts and
      /etc/ethers.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dhcp-generate-names=tag:&lt;tag&gt;[,tag:&lt;tag&gt;]</b></dt>
  <dd class="It-tag">(IPv4 only) Generate a name for DHCP clients which do not
      otherwise have one, using the MAC address expressed in hex, separated by
      dashes. Note that if a host provides a name, it will be used by preference
      to this, unless <b>--dhcp-ignore-names</b> is set.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dhcp-broadcast[=tag:&lt;tag&gt;[,tag:&lt;tag&gt;]]</b></dt>
  <dd class="It-tag">(IPv4 only) When all the given tags appear in the tag set,
      always use broadcast to communicate with the host when it is unconfigured.
      It is permissible to supply no tags, in which case this is unconditional.
      Most DHCP clients which need broadcast replies set a flag in their
      requests so that this happens automatically, some old BOOTP clients do
      not.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-M,
    --dhcp-boot=[tag:&lt;tag&gt;,]&lt;filename&gt;,[&lt;servername&gt;[,&lt;server
    address&gt;|&lt;tftp_servername&gt;]]</b></dt>
  <dd class="It-tag">(IPv4 only) Set BOOTP options to be returned by the DHCP
      server. Server name and address are optional: if not provided, the name is
      left empty, and the address set to the address of the machine running
      dnsmasq. If dnsmasq is providing a TFTP service (see <b>--enable-tftp</b>
      ) then only the filename is required here to enable network booting. If
      the optional tag(s) are given, they must match for this configuration to
      be sent. Instead of an IP address, the TFTP server address can be given as
      a domain name which is looked up in /etc/hosts. This name can be
      associated in /etc/hosts with multiple IP addresses, which are used
      round-robin. This facility can be used to load balance the tftp load among
      a set of servers.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dhcp-sequential-ip</b></dt>
  <dd class="It-tag">Dnsmasq is designed to choose IP addresses for DHCP clients
      using a hash of the client's MAC address. This normally allows a client's
      address to remain stable long-term, even if the client sometimes allows
      its DHCP lease to expire. In this default mode IP addresses are
      distributed pseudo-randomly over the entire available address range. There
      are sometimes circumstances (typically server deployment) where it is more
      convenient to have IP addresses allocated sequentially, starting from the
      lowest available address, and setting this flag enables this mode. Note
      that in the sequential mode, clients which allow a lease to expire are
      much more likely to move IP address; for this reason it should not be
      generally used.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--pxe-service=[tag:&lt;tag&gt;,]&lt;CSA&gt;,&lt;menu
    text&gt;[,&lt;basename&gt;|&lt;bootservicetype&gt;][,&lt;server
    address&gt;|&lt;server_name&gt;]</b></dt>
  <dd class="It-tag">Most uses of PXE boot-ROMS simply allow the PXE system to
      obtain an IP address and then download the file specified by
      <b>dhcp-boot</b> and execute it. However the PXE system is capable of more
      complex functions when supported by a suitable DHCP server.
    <div style="height: 1.00em;">&#x00A0;</div>
    This specifies a boot option which may appear in a PXE boot menu.
      &lt;CSA&gt; is client system type, only services of the correct type will
      appear in a menu. The known types are x86PC, PC98, IA64_EFI, Alpha,
      Arc_x86, Intel_Lean_Client, IA32_EFI, BC_EFI, Xscale_EFI and X86-64_EFI;
      an integer may be used for other types. The parameter after the menu text
      may be a file name, in which case dnsmasq acts as a boot server and
      directs the PXE client to download the file by TFTP, either from itself (
      <b>enable-tftp</b> must be set for this to work) or another TFTP server if
      the final server address/name is given. Note that the &quot;layer&quot;
      suffix (normally &quot;.0&quot;) is supplied by PXE, and should not be
      added to the basename. If an integer boot service type, rather than a
      basename is given, then the PXE client will search for a suitable boot
      service for that type on the network. This search may be done by
      broadcast, or direct to a server if its IP address/name is provided. If no
      boot service type or filename is provided (or a boot service type of 0 is
      specified) then the menu entry will abort the net boot procedure and
      continue booting from local media. The server address can be given as a
      domain name which is looked up in /etc/hosts. This name can be associated
      in /etc/hosts with multiple IP addresses, which are used round-robin.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--pxe-prompt=[tag:&lt;tag&gt;,]&lt;prompt&gt;[,&lt;timeout&gt;]</b></dt>
  <dd class="It-tag">Setting this provides a prompt to be displayed after PXE
      boot. If the timeout is given then after the timeout has elapsed with no
      keyboard input, the first available menu option will be automatically
      executed. If the timeout is zero then the first available menu item will
      be executed immediately. If <b>pxe-prompt</b> is omitted the system will
      wait for user input if there are multiple items in the menu, but boot
      immediately if there is only one. See <b>pxe-service</b> for details of
      menu items.
    <div style="height: 1.00em;">&#x00A0;</div>
    Dnsmasq supports PXE &quot;proxy-DHCP&quot;, in this case another DHCP
      server on the network is responsible for allocating IP addresses, and
      dnsmasq simply provides the information given in <b>pxe-prompt</b> and
      <b>pxe-service</b> to allow netbooting. This mode is enabled using the
      <b>proxy</b> keyword in <b>dhcp-range.</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-X, --dhcp-lease-max=&lt;number&gt;</b></dt>
  <dd class="It-tag">Limits dnsmasq to the specified maximum number of DHCP
      leases. The default is 1000. This limit is to prevent DoS attacks from
      hosts which create thousands of leases and use lots of memory in the
      dnsmasq process.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-K, --dhcp-authoritative</b></dt>
  <dd class="It-tag">Should be set when dnsmasq is definitely the only DHCP
      server on a network. For DHCPv4, it changes the behaviour from strict RFC
      compliance so that DHCP requests on unknown leases from unknown hosts are
      not ignored. This allows new hosts to get a lease without a tedious
      timeout under all circumstances. It also allows dnsmasq to rebuild its
      lease database without each client needing to reacquire a lease, if the
      database is lost. For DHCPv6 it sets the priority in replies to 255 (the
      maximum) instead of 0 (the minimum).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dhcp-alternate-port[=&lt;server port&gt;[,&lt;client
    port&gt;]]</b></dt>
  <dd class="It-tag">(IPv4 only) Change the ports used for DHCP from the
      default. If this option is given alone, without arguments, it changes the
      ports used for DHCP from 67 and 68 to 1067 and 1068. If a single argument
      is given, that port number is used for the server and the port number plus
      one used for the client. Finally, two port numbers allows arbitrary
      specification of both server and client ports for DHCP.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-3,
    --bootp-dynamic[=&lt;network-id&gt;[,&lt;network-id&gt;]]</b></dt>
  <dd class="It-tag">(IPv4 only) Enable dynamic allocation of IP addresses to
      BOOTP clients. Use this with care, since each address allocated to a BOOTP
      client is leased forever, and therefore becomes permanently unavailable
      for re-use by other hosts. if this is given without tags, then it
      unconditionally enables dynamic allocation. With tags, only when the tags
      are all set. It may be repeated with different tag sets.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-5, --no-ping</b></dt>
  <dd class="It-tag">(IPv4 only) By default, the DHCP server will attempt to
      ensure that an address in not in use before allocating it to a host. It
      does this by sending an ICMP echo request (aka &quot;ping&quot;) to the
      address in question. If it gets a reply, then the address must already be
      in use, and another is tried. This flag disables this check. Use with
      caution.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--log-dhcp</b></dt>
  <dd class="It-tag">Extra logging for DHCP: log all the options sent to DHCP
      clients and the tags used to determine them.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-l, --dhcp-leasefile=&lt;path&gt;</b></dt>
  <dd class="It-tag">Use the specified file to store DHCP lease
    information.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dhcp-duid=&lt;enterprise-id&gt;,&lt;uid&gt;</b></dt>
  <dd class="It-tag">(IPv6 only) Specify the server persistent UID which the
      DHCPv6 server will use. This option is not normally required as dnsmasq
      creates a DUID automatically when it is first needed. When given, this
      option provides dnsmasq the data required to create a DUID-EN type DUID.
      Note that once set, the DUID is stored in the lease database, so to change
      between DUID-EN and automatically created DUIDs or vice-versa, the lease
      database must be re-intialised. The enterprise-id is assigned by IANA, and
      the uid is a string of hex octets unique to a particular device.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-6 --dhcp-script=&lt;path&gt;</b></dt>
  <dd class="It-tag">Whenever a new DHCP lease is created, or an old one
      destroyed, or a TFTP file transfer completes, the executable specified by
      this option is run. &lt;path&gt; must be an absolute pathname, no PATH
      search occurs. The arguments to the process are &quot;add&quot;,
      &quot;old&quot; or &quot;del&quot;, the MAC address of the host (or DUID
      for IPv6) , the IP address, and the hostname, if known. &quot;add&quot;
      means a lease has been created, &quot;del&quot; means it has been
      destroyed, &quot;old&quot; is a notification of an existing lease when
      dnsmasq starts or a change to MAC address or hostname of an existing lease
      (also, lease length or expiry and client-id, if leasefile-ro is set). If
      the MAC address is from a network type other than ethernet, it will have
      the network type prepended, eg &quot;06-01:23:45:67:89:ab&quot; for token
      ring. The process is run as root (assuming that dnsmasq was originally run
      as root) even if dnsmasq is configured to change UID to an unprivileged
      user.
    <div style="height: 1.00em;">&#x00A0;</div>
    The environment is inherited from the invoker of dnsmasq, with some or all
      of the following variables added
    <div style="height: 1.00em;">&#x00A0;</div>
    For both IPv4 and IPv6:
    <div style="height: 1.00em;">&#x00A0;</div>
    DNSMASQ_DOMAIN if the fully-qualified domain name of the host is known, this
      is set to the domain part. (Note that the hostname passed to the script as
      an argument is never fully-qualified.)
    <div style="height: 1.00em;">&#x00A0;</div>
    If the client provides a hostname, DNSMASQ_SUPPLIED_HOSTNAME
    <div style="height: 1.00em;">&#x00A0;</div>
    If the client provides user-classes,
      DNSMASQ_USER_CLASS0..DNSMASQ_USER_CLASSn
    <div style="height: 1.00em;">&#x00A0;</div>
    If dnsmasq was compiled with HAVE_BROKEN_RTC, then the length of the lease
      (in seconds) is stored in DNSMASQ_LEASE_LENGTH, otherwise the time of
      lease expiry is stored in DNSMASQ_LEASE_EXPIRES. The number of seconds
      until lease expiry is always stored in DNSMASQ_TIME_REMAINING.
    <div style="height: 1.00em;">&#x00A0;</div>
    If a lease used to have a hostname, which is removed, an &quot;old&quot;
      event is generated with the new state of the lease, ie no name, and the
      former name is provided in the environment variable DNSMASQ_OLD_HOSTNAME.
    <div style="height: 1.00em;">&#x00A0;</div>
    DNSMASQ_INTERFACE stores the name of the interface on which the request
      arrived; this is not set for &quot;old&quot; actions when dnsmasq
      restarts.
    <div style="height: 1.00em;">&#x00A0;</div>
    DNSMASQ_RELAY_ADDRESS is set if the client used a DHCP relay to contact
      dnsmasq and the IP address of the relay is known.
    <div style="height: 1.00em;">&#x00A0;</div>
    DNSMASQ_TAGS contains all the tags set during the DHCP transaction,
      separated by spaces.
    <div style="height: 1.00em;">&#x00A0;</div>
    DNSMASQ_LOG_DHCP is set if <b>--log-dhcp</b> is in effect.
    <div style="height: 1.00em;">&#x00A0;</div>
    For IPv4 only:
    <div style="height: 1.00em;">&#x00A0;</div>
    DNSMASQ_CLIENT_ID if the host provided a client-id.
    <div style="height: 1.00em;">&#x00A0;</div>
    DNSMASQ_CIRCUIT_ID, DNSMASQ_SUBSCRIBER_ID, DNSMASQ_REMOTE_ID if a DHCP
      relay-agent added any of these options.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the client provides vendor-class, DNSMASQ_VENDOR_CLASS.
    <div style="height: 1.00em;">&#x00A0;</div>
    For IPv6 only:
    <div style="height: 1.00em;">&#x00A0;</div>
    If the client provides vendor-class, DNSMASQ_VENDOR_CLASS_ID, containing the
      IANA enterprise id for the class, and
      DNSMASQ_VENDOR_CLASS0..DNSMASQ_VENDOR_CLASSn for the data.
    <div style="height: 1.00em;">&#x00A0;</div>
    DNSMASQ_SERVER_DUID containing the DUID of the server: this is the same for
      every call to the script.
    <div style="height: 1.00em;">&#x00A0;</div>
    DNSMASQ_IAID containing the IAID for the lease. If the lease is a temporary
      allocation, this is prefixed to 'T'.
    <div style="height: 1.00em;">&#x00A0;</div>
    DNSMASQ_MAC containing the MAC address of the client, if known.
    <div style="height: 1.00em;">&#x00A0;</div>
    Note that the supplied hostname, vendorclass and userclass data is only
      supplied for &quot;add&quot; actions or &quot;old&quot; actions when a
      host resumes an existing lease, since these data are not held in dnsmasq's
      lease database.
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
    All file descriptors are closed except stdin, stdout and stderr which are
      open to /dev/null (except in debug mode).
    <div style="height: 1.00em;">&#x00A0;</div>
    The script is not invoked concurrently: at most one instance of the script
      is ever running (dnsmasq waits for an instance of script to exit before
      running the next). Changes to the lease database are which require the
      script to be invoked are queued awaiting exit of a running instance. If
      this queueing allows multiple state changes occur to a single lease before
      the script can be run then earlier states are discarded and the current
      state of that lease is reflected when the script finally runs.
    <div style="height: 1.00em;">&#x00A0;</div>
    At dnsmasq startup, the script will be invoked for all existing leases as
      they are read from the lease file. Expired leases will be called with
      &quot;del&quot; and others with &quot;old&quot;. When dnsmasq receives a
      HUP signal, the script will be invoked for existing leases with an
      &quot;old &quot; event.
    <div style="height: 1.00em;">&#x00A0;</div>
    <div style="height: 1.00em;">&#x00A0;</div>
    There are two further actions which may appear as the first argument to the
      script, &quot;init&quot; and &quot;tftp&quot;. More may be added in the
      future, so scripts should be written to ignore unknown actions.
      &quot;init&quot; is described below in <b>--leasefile-ro</b> The
      &quot;tftp&quot; action is invoked when a TFTP file transfer completes:
      the arguments are the file size in bytes, the address to which the file
      was sent, and the complete pathname of the file.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dhcp-luascript=&lt;path&gt;</b></dt>
  <dd class="It-tag">Specify a script written in Lua, to be run when leases are
      created, destroyed or changed. To use this option, dnsmasq must be
      compiled with the correct support. The Lua interpreter is intialised once,
      when dnsmasq starts, so that global variables persist between lease
      events. The Lua code must define a <b>lease</b> function, and may provide
      <b>init</b> and <b>shutdown</b> functions, which are called, without
      arguments when dnsmasq starts up and terminates. It may also provide a
      <b>tftp</b> function.
    <div style="height: 1.00em;">&#x00A0;</div>
    The <b>lease</b> function receives the information detailed in
      <b>--dhcp-script.</b> It gets two arguments, firstly the action, which is
      a string containing, &quot;add&quot;, &quot;old&quot; or &quot;del&quot;,
      and secondly a table of tag value pairs. The tags mostly correspond to the
      environment variables detailed above, for instance the tag
      &quot;domain&quot; holds the same data as the environment variable
      DNSMASQ_DOMAIN. There are a few extra tags which hold the data supplied as
      arguments to <b>--dhcp-script.</b> These are <b>mac_address,
      ip_address</b> and <b>hostname</b> for IPv4, and <b>client_duid,
      ip_address</b> and <b>hostname</b> for IPv6.
    <div style="height: 1.00em;">&#x00A0;</div>
    The <b>tftp</b> function is called in the same way as the lease function,
      and the table holds the tags <b>destination_address,</b> <b>file_name</b>
      and <b>file_size.</b></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dhcp-scriptuser</b></dt>
  <dd class="It-tag">Specify the user as which to run the lease-change script or
      Lua script. This defaults to root, but can be changed to another user
      using this flag.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-9, --leasefile-ro</b></dt>
  <dd class="It-tag">Completely suppress use of the lease database file. The
      file will not be created, read, or written. Change the way the
      lease-change script (if one is provided) is called, so that the lease
      database may be maintained in external storage by the script. In addition
      to the invocations given in <b>--dhcp-script</b> the lease-change script
      is called once, at dnsmasq startup, with the single argument
      &quot;init&quot;. When called like this the script should write the saved
      state of the lease database, in dnsmasq leasefile format, to stdout and
      exit with zero exit code. Setting this option also forces the leasechange
      script to be called on changes to the client-id and lease length and
      expiry time.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--bridge-interface=&lt;interface&gt;,&lt;alias&gt;[,&lt;alias&gt;]</b></dt>
  <dd class="It-tag">Treat DHCP request packets arriving at any of the
      &lt;alias&gt; interfaces as if they had arrived at &lt;interface&gt;. This
      option is necessary when using &quot;old style&quot; bridging on BSD
      platforms, since packets arrive at tap interfaces which don't have an IP
      address.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-s, --domain=&lt;domain&gt;[,&lt;address
    range&gt;[,local]]</b></dt>
  <dd class="It-tag">Specifies DNS domains for the DHCP server. Domains may be
      be given unconditionally (without the IP range) or for limited IP ranges.
      This has two effects; firstly it causes the DHCP server to return the
      domain to any hosts which request it, and secondly it sets the domain
      which it is legal for DHCP-configured hosts to claim. The intention is to
      constrain hostnames so that an untrusted host on the LAN cannot advertise
      its name via dhcp as e.g. &quot;microsoft.com&quot; and capture traffic
      not meant for it. If no domain suffix is specified, then any DHCP hostname
      with a domain part (ie with a period) will be disallowed and logged. If
      suffix is specified, then hostnames with a domain part are allowed,
      provided the domain part matches the suffix. In addition, when a suffix is
      set then hostnames without a domain part have the suffix added as an
      optional domain part. Eg on my network I can set
      <b>--domain=thekelleys.org.uk</b> and have a machine whose DHCP hostname
      is &quot;laptop&quot;. The IP address for that machine is available from
      <b>dnsmasq</b> both as &quot;laptop&quot; and
      &quot;laptop.thekelleys.org.uk&quot;. If the domain is given as
      &quot;#&quot; then the domain is read from the first &quot;search&quot;
      directive in /etc/resolv.conf (or equivalent).
    <div style="height: 1.00em;">&#x00A0;</div>
    The address range can be of the form &lt;ip address&gt;,&lt;ip address&gt;
      or &lt;ip address&gt;/&lt;netmask&gt; or just a single &lt;ip address&gt;.
      See <b>--dhcp-fqdn</b> which can change the behaviour of dnsmasq with
      domains.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the address range is given as ip-address/network-size, then a additional
      flag &quot;local&quot; may be supplied which has the effect of adding
      --local declarations for forward and reverse DNS queries. Eg.
      <b>--domain=thekelleys.org.uk,192.168.0.0/24,local</b> is identical to
      <b>--domain=thekelleys.org.uk,192.168.0.0/24</b>
      --local=/thekelleys.org.uk/ --local=/0.168.192.in-addr.arpa/ The network
      size must be 8, 16 or 24 for this to be legal.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dhcp-fqdn</b></dt>
  <dd class="It-tag">In the default mode, dnsmasq inserts the unqualified names
      of DHCP clients into the DNS. For this reason, the names must be unique,
      even if two clients which have the same name are in different domains. If
      a second DHCP client appears which has the same name as an existing
      client, the name is transferred to the new client. If <b>--dhcp-fqdn</b>
      is set, this behaviour changes: the unqualified name is no longer put in
      the DNS, only the qualified name. Two DHCP clients with the same name may
      both keep the name, provided that the domain part is different (ie the
      fully qualified names differ.) To ensure that all names have a domain
      part, there must be at least <b>--domain</b> without an address specified
      when <b>--dhcp-fqdn</b> is set.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dhcp-client-update</b></dt>
  <dd class="It-tag">Normally, when giving a DHCP lease, dnsmasq sets flags in
      the FQDN option to tell the client not to attempt a DDNS update with its
      name and IP address. This is because the name-IP pair is automatically
      added into dnsmasq's DNS view. This flag suppresses that behaviour, this
      is useful, for instance, to allow Windows clients to update Active
      Directory servers. See RFC 4702 for details.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--enable-ra</b></dt>
  <dd class="It-tag">Enable dnsmasq's IPv6 Router Advertisement feature. DHCPv6
      doesn't handle complete network configuration in the same way as DHCPv4.
      Router discovery and (possibly) prefix discovery for autonomous address
      creation are handled by a different protocol. When DHCP is in use, only a
      subset of this is needed, and dnsmasq can handle it, using existing DHCP
      configuration to provide most data. When RA is enabled, dnsmasq will
      advertise a prefix for each dhcp-range, with default router and recursive
      DNS server as the relevant link-local address on the machine running
      dnsmasq. By default, he &quot;managed address&quot; bits are set, and the
      &quot;use SLAAC&quot; bit is reset. This can be changed for individual
      subnets with the mode keywords described in <b>--dhcp-range.</b> RFC6106
      DNS parameters are included in the advertisements. By default, the
      relevant link-local address of the machine running dnsmasq is sent as
      recursive DNS server. If provided, the DHCPv6 options dns-server and
      domain-search are used for RDNSS and DNSSL.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--enable-tftp</b></dt>
  <dd class="It-tag">Enable the TFTP server function. This is deliberately
      limited to that needed to net-boot a client. Only reading is allowed; the
      tsize and blksize extensions are supported (tsize is only supported in
      octet mode).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tftp-root=&lt;directory&gt;[,&lt;interface&gt;]</b></dt>
  <dd class="It-tag">Look for files to transfer using TFTP relative to the given
      directory. When this is set, TFTP paths which include &quot;..&quot; are
      rejected, to stop clients getting outside the specified root. Absolute
      paths (starting with /) are allowed, but they must be within the
      tftp-root. If the optional interface argument is given, the directory is
      only used for TFTP requests via that interface.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tftp-unique-root</b></dt>
  <dd class="It-tag">Add the IP address of the TFTP client as a path component
      on the end of the TFTP-root (in standard dotted-quad format). Only valid
      if a tftp-root is set and the directory exists. For instance, if tftp-root
      is &quot;/tftp&quot; and client 1.2.3.4 requests file &quot;myfile&quot;
      then the effective path will be &quot;/tftp/1.2.3.4/myfile&quot; if
      /tftp/1.2.3.4 exists or /tftp/myfile otherwise.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tftp-secure</b></dt>
  <dd class="It-tag">Enable TFTP secure mode: without this, any file which is
      readable by the dnsmasq process under normal unix access-control rules is
      available via TFTP. When the --tftp-secure flag is given, only files owned
      by the user running the dnsmasq process are accessible. If dnsmasq is
      being run as root, different rules apply: --tftp-secure has no effect, but
      only files which have the world-readable bit set are accessible. It is not
      recommended to run dnsmasq as root with TFTP enabled, and certainly not
      without specifying --tftp-root. Doing so can expose any world-readable
      file on the server to any host on the net.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tftp-lowercase</b></dt>
  <dd class="It-tag">Convert filenames in TFTP requests to all lowercase. This
      is useful for requests from Windows machines, which have case-insensitive
      filesystems and tend to play fast-and-loose with case in filenames. Note
      that dnsmasq's tftp server always converts &quot;\&quot; to &quot;/&quot;
      in filenames.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tftp-max=&lt;connections&gt;</b></dt>
  <dd class="It-tag">Set the maximum number of concurrent TFTP connections
      allowed. This defaults to 50. When serving a large number of TFTP
      connections, per-process file descriptor limits may be encountered.
      Dnsmasq needs one file descriptor for each concurrent TFTP connection and
      one file descriptor per unique file (plus a few others). So serving the
      same file simultaneously to n clients will use require about n + 10 file
      descriptors, serving different files simultaneously to n clients will
      require about (2*n) + 10 descriptors. If <b>--tftp-port-range</b> is
      given, that can affect the number of concurrent connections.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tftp-no-blocksize</b></dt>
  <dd class="It-tag">Stop the TFTP server from negotiating the
      &quot;blocksize&quot; option with a client. Some buggy clients request
      this option but then behave badly when it is granted.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tftp-port-range=&lt;start&gt;,&lt;end&gt;</b></dt>
  <dd class="It-tag">A TFTP server listens on a well-known port (69) for
      connection initiation, but it also uses a dynamically-allocated port for
      each connection. Normally these are allocated by the OS, but this option
      specifies a range of ports for use by TFTP transfers. This can be useful
      when TFTP has to traverse a firewall. The start of the range cannot be
      lower than 1025 unless dnsmasq is running as root. The number of
      concurrent TFTP connections is limited by the size of the port range.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-C, --conf-file=&lt;file&gt;</b></dt>
  <dd class="It-tag">Specify a different configuration file. The conf-file
      option is also allowed in configuration files, to include multiple
      configuration files. A filename of &quot;-&quot; causes dnsmasq to read
      configuration from stdin.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-7,
    --conf-dir=&lt;directory&gt;[,&lt;file-extension&gt;......]</b></dt>
  <dd class="It-tag">Read all the files in the given directory as configuration
      files. If extension(s) are given, any files which end in those extensions
      are skipped. Any files whose names end in ~ or start with . or start and
      end with # are always skipped. This flag may be given on the command line
      or in a configuration file.</dd>
</dl>
<h1 class="Sh" title="Sh" id="CONFIG_FILE"><a class="selflink" href="#CONFIG_FILE">CONFIG
  FILE</a></h1>
At startup, dnsmasq reads <i>/etc/dnsmasq.conf,</i> if it exists. (On FreeBSD,
  the file is <i>/usr/local/etc/dnsmasq.conf</i> ) (but see the <b>-C</b> and
  <b>-7</b> options.) The format of this file consists of one option per line,
  exactly as the long options detailed in the OPTIONS section but without the
  leading &quot;--&quot;. Lines starting with # are comments and ignored. For
  options which may only be specified once, the configuration file overrides the
  command line. Quoting is allowed in a config file: between &quot; quotes the
  special meanings of ,:. and # are removed and the following escapes are
  allowed: \\ \&quot; \t \e \b \r and \n. The later corresponding to tab,
  escape, backspace, return and newline.
<h1 class="Sh" title="Sh" id="NOTES"><a class="selflink" href="#NOTES">NOTES</a></h1>
When it receives a SIGHUP, <b>dnsmasq</b> clears its cache and then re-loads
  <i>/etc/hosts</i> and <i>/etc/ethers</i> and any file given by
  --dhcp-hostsfile, --dhcp-optsfile or --addn-hosts. The dhcp lease change
  script is called for all existing DHCP leases. If <b>--no-poll</b> is set
  SIGHUP also re-reads <i>/etc/resolv.conf.</i> SIGHUP does NOT re-read the
  configuration file.
<div class="Pp"></div>
When it receives a SIGUSR1, <b>dnsmasq</b> writes statistics to the system log.
  It writes the cache size, the number of names which have had to removed from
  the cache before they expired in order to make room for new names and the
  total number of names that have been inserted into the cache. For each
  upstream server it gives the number of queries sent, and the number which
  resulted in an error. In <b>--no-daemon</b> mode or when full logging is
  enabled (-q), a complete dump of the contents of the cache is made.
<div class="Pp"></div>
When it receives SIGUSR2 and it is logging direct to a file (see
  <b>--log-facility</b> ) <b>dnsmasq</b> will close and reopen the log file.
  Note that during this operation, dnsmasq will not be running as root. When it
  first creates the logfile dnsmasq changes the ownership of the file to the
  non-root user it will run as. Logrotate should be configured to create a new
  log file with the ownership which matches the existing one before sending
  SIGUSR2. If TCP DNS queries are in progress, the old logfile will remain open
  in child processes which are handling TCP queries and may continue to be
  written. There is a limit of 150 seconds, after which all existing TCP
  processes will have expired: for this reason, it is not wise to configure
  logfile compression for logfiles which have just been rotated. Using
  logrotate, the required options are <b>create</b> and <b>delaycompress.</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
Dnsmasq is a DNS query forwarder: it it not capable of recursively answering
  arbitrary queries starting from the root servers but forwards such queries to
  a fully recursive upstream DNS server which is typically provided by an ISP.
  By default, dnsmasq reads <i>/etc/resolv.conf</i> to discover the IP addresses
  of the upstream nameservers it should use, since the information is typically
  stored there. Unless <b>--no-poll</b> is used, <b>dnsmasq</b> checks the
  modification time of <i>/etc/resolv.conf</i> (or equivalent if
  <b>--resolv-file</b> is used) and re-reads it if it changes. This allows the
  DNS servers to be set dynamically by PPP or DHCP since both protocols provide
  the information. Absence of <i>/etc/resolv.conf</i> is not an error since it
  may not have been created before a PPP connection exists. Dnsmasq simply keeps
  checking in case <i>/etc/resolv.conf</i> is created at any time. Dnsmasq can
  be told to parse more than one resolv.conf file. This is useful on a laptop,
  where both PPP and DHCP may be used: dnsmasq can be set to poll both
  <i>/etc/ppp/resolv.conf</i> and <i>/etc/dhcpc/resolv.conf</i> and will use the
  contents of whichever changed last, giving automatic switching between DNS
  servers.
<div class="Pp"></div>
Upstream servers may also be specified on the command line or in the
  configuration file. These server specifications optionally take a domain name
  which tells dnsmasq to use that server only to find names in that particular
  domain.
<div class="Pp"></div>
In order to configure dnsmasq to act as cache for the host on which it is
  running, put &quot;nameserver 127.0.0.1&quot; in <i>/etc/resolv.conf</i> to
  force local processes to send queries to dnsmasq. Then either specify the
  upstream servers directly to dnsmasq using <b>--server</b> options or put
  their addresses real in another file, say <i>/etc/resolv.dnsmasq</i> and run
  dnsmasq with the <b>-r /etc/resolv.dnsmasq</b> option. This second technique
  allows for dynamic update of the server addresses by PPP or DHCP.
<div class="Pp"></div>
Addresses in /etc/hosts will &quot;shadow&quot; different addresses for the same
  names in the upstream DNS, so &quot;mycompany.com 1.2.3.4&quot; in /etc/hosts
  will ensure that queries for &quot;mycompany.com&quot; always return 1.2.3.4
  even if queries in the upstream DNS would otherwise return a different
  address. There is one exception to this: if the upstream DNS contains a CNAME
  which points to a shadowed name, then looking up the CNAME through dnsmasq
  will result in the unshadowed address associated with the target of the CNAME.
  To work around this, add the CNAME to /etc/hosts so that the CNAME is shadowed
  too.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
The tag system works as follows: For each DHCP request, dnsmasq collects a set
  of valid tags from active configuration lines which include set:&lt;tag&gt;,
  including one from the <b>dhcp-range</b> used to allocate the address, one
  from any matching <b>dhcp-host</b> (and &quot;known&quot; if a dhcp-host
  matches) The tag &quot;bootp&quot; is set for BOOTP requests, and a tag whose
  name is the name of the interface on which the request arrived is also set.
<div style="height: 1.00em;">&#x00A0;</div>
Any configuration lines which include one or more tag:&lt;tag&gt; constructs
  will only be valid if all that tags are matched in the set derived above.
  Typically this is dhcp-option. <b>dhcp-option</b> which has tags will be used
  in preference to an untagged <b>dhcp-option,</b> provided that _all_ the tags
  match somewhere in the set collected as described above. The prefix '!' on a
  tag means 'not' so --dhcp=option=tag:!purple,3,1.2.3.4 sends the option when
  the tag purple is not in the set of valid tags. (If using this in a command
  line rather than a configuration file, be sure to escape !, which is a shell
  metacharacter)
<div style="height: 1.00em;">&#x00A0;</div>
When selecting dhcp-options, a tag from dhcp-range is second class relative to
  other tags, to make it easy to override options for individual hosts, so
  <b>dhcp-range=set:interface1,......</b> <b>dhcp-host=set:myhost,.....</b>
  <b>dhcp-option=tag:interface1,option:nis-domain,&quot;domain1&quot;</b>
  <b>dhcp-option=tag:myhost,option:nis-domain,&quot;domain2&quot;</b> will set
  the NIS-domain to domain1 for hosts in the range, but override that to domain2
  for a particular host.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
Note that for <b>dhcp-range</b> both tag:&lt;tag&gt; and set:&lt;tag&gt; are
  allowed, to both select the range in use based on (eg) dhcp-host, and to
  affect the options sent, based on the range selected.
<div style="height: 1.00em;">&#x00A0;</div>
This system evolved from an earlier, more limited one and for backward
  compatibility &quot;net:&quot; may be used instead of &quot;tag:&quot; and
  &quot;set:&quot; may be omitted. (Except in <b>dhcp-host,</b> where
  &quot;net:&quot; may be used instead of &quot;set:&quot;.) For the same
  reason, '#' may be used instead of '!' to indicate NOT.
<div class="Pp"></div>
The DHCP server in dnsmasq will function as a BOOTP server also, provided that
  the MAC address and IP address for clients are given, either using
  <b>dhcp-host</b> configurations or in <i>/etc/ethers</i> , and a
  <b>dhcp-range</b> configuration option is present to activate the DHCP server
  on a particular network. (Setting --bootp-dynamic removes the need for static
  address mappings.) The filename parameter in a BOOTP request is used as a tag,
  as is the tag &quot;bootp&quot;, allowing some control over the options
  returned to different classes of hosts.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHORITATIVE_CONFIGURATION"><a class="selflink" href="#AUTHORITATIVE_CONFIGURATION">AUTHORITATIVE
  CONFIGURATION</a></h1>
Configuring dnsmasq to act as an authoritative DNS server is complicated by the
  fact that it involves configuration of external DNS servers to provide
  delegation. We will walk through three scenarios of increasing complexity.
  Prerequisites for all of these scenarios are a globally accessible IP address,
  an A or AAAA record pointing to that address, and an external DNS server
  capable of doing delegation of the zone in question. For the first part of
  this explanation, we will call the A (or AAAA) record for the globally
  accessible address server.example.com, and the zone for which dnsmasq is
  authoritative our.zone.com.
<div style="height: 1.00em;">&#x00A0;</div>
The simplest configuration consists of two lines of dnsmasq configuration;
  something like
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
<b>auth-server=server.example.com,eth0</b>
<b>auth-zone=our.zone.com,1.2.3.0/24</b>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
and two records in the external DNS
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
server.example.com       A    192.0.43.10
our.zone.com            NS    server.example.com
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
eth0 is the external network interface on which dnsmasq is listening, and has
  (globally accessible) address 192.0.43.10.
<div style="height: 1.00em;">&#x00A0;</div>
Note that the external IP address may well be dynamic (ie assigned from an ISP
  by DHCP or PPP) If so, the A record must be linked to this dynamic assignment
  by one of the usual dynamic-DNS systems.
<div style="height: 1.00em;">&#x00A0;</div>
A more complex, but practically useful configuration has the address record for
  the globally accessible IP address residing in the authoritative zone which
  dnsmasq is serving, typically at the root. Now we have
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
<b>auth-server=our.zone.com,eth0</b>
<b>auth-zone=our.zone.com,1.2.3.0/24</b>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
our.zone.com             A    1.2.3.4
our.zone.com            NS    our.zone.com
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
The A record for our.zone.com has now become a glue record, it solves the
  chicken-and-egg problem of finding the IP address of the nameserver for
  our.zone.com when the A record is within that zone. Note that this is the only
  role of this record: as dnsmasq is now authoritative from our.zone.com it too
  must provide this record. If the external address is static, this can be done
  with an <b>/etc/hosts</b> entry or <b>--host-record.</b>
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
<b>auth-server=our.zone.com,eth0</b>
<b>host-record=our.zone.com,1.2.3.4</b>
<b>auth-zone=our.zone.com,1.2.3.0/24</b>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
If the external address is dynamic, the address associated with our.zone.com
  must be derived from the address of the relevant interface. This is done using
  <b>interface-name</b> Something like:
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
<b>auth-server=our.zone.com,eth0</b>
<b>interface-name=our.zone.com,eth0</b>
<b>auth-zone=our.zone.com,1.2.3.0/24</b>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
Our final configuration builds on that above, but also adds a secondary DNS
  server. This is another DNS server which learns the DNS data for the zone by
  doing zones transfer, and acts as a backup should the primary server become
  inaccessible. The configuration of the secondary is beyond the scope of this
  man-page, but the extra configuration of dnsmasq is simple:
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
<b>auth-sec-servers=secondary.myisp.com</b>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
and
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
our.zone.com           NS    secondary.myisp.com
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
Adding auth-sec-servers enables zone transfer in dnsmasq, to allow the secondary
  to collect the DNS data. If you wish to restrict this data to particular hosts
  then
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
<b>auth-peer=&lt;IP address of secondary&gt;</b>
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
will do so.
<div style="height: 1.00em;">&#x00A0;</div>
Dnsmasq acts as an authoritative server for in-addr.arpa and ipv6.arpa domains
  associated with the subnets given in auth-zone declarations, so reverse
  (address to name) lookups can be simply configured with a suitable NS record,
  for instance in this example, where we allow 1.2.3.0/24 addresses.
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
 3.2.1.in-addr.arpa  NS    our.zone.com
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
Note that at present, reverse (in-addr.arpa and ip6.arpa) zones are not
  available in zone transfers, so there is no point arranging secondary servers
  for reverse lookups.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
When dnsmasq is configured to act as an authoritative server, the following data
  is used to populate the authoritative zone.
<div class="Pp"></div>
<b>--mx-host, --srv-host, --dns-rr, --txt-record, --naptr-record</b> , as long
  as the record names are in the authoritative domain.
<div class="Pp"></div>
<b>--cname</b> as long as the record name is in the authoritative domain. If the
  target of the CNAME is unqualified, then it is qualified with the
  authoritative zone name.
<div class="Pp"></div>
IPv4 and IPv6 addresses from /etc/hosts (and <b>--addn-hosts</b> ) and
  <b>--host-record</b> provided the address falls into one of the subnets
  specified in the <b>--auth-zone.</b>
<div class="Pp"></div>
Addresses specified by <b>--interface-name.</b> In this case, the address is not
  contrained to a subnet from <b>--auth-zone.</b>
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
Addresses of DHCP leases, provided the address falls into one of the subnets
  specified in the <b>--auth-zone</b> OR a constructed DHCP range. In the
  default mode, where a DHCP lease has an unqualified name, and possibly a
  qualified name constructed using <b>--domain</b> then the name in the
  authoritative zone is constructed from the unqualified name and the zone's
  domain. This may or may not equal that specified by <b>--domain.</b> If
  <b>--dhcp-fqdn</b> is set, then the fully qualified names associated with DHCP
  leases are used, and must match the zone's domain.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="EXIT_CODES"><a class="selflink" href="#EXIT_CODES">EXIT
  CODES</a></h1>
0 - Dnsmasq successfully forked into the background, or terminated normally if
  backgrounding is not enabled.
<div class="Pp"></div>
1 - A problem with configuration was detected.
<div class="Pp"></div>
2 - A problem with network access occurred (address in use, attempt to use
  privileged ports without permission).
<div class="Pp"></div>
3 - A problem occurred with a filesystem operation (missing file/directory,
  permissions).
<div class="Pp"></div>
4 - Memory allocation failure.
<div class="Pp"></div>
5 - Other miscellaneous problem.
<div class="Pp"></div>
11 or greater - a non zero return code was received from the lease-script
  process &quot;init&quot; call. The exit code from dnsmasq is the script's exit
  code with 10 added.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="LIMITS"><a class="selflink" href="#LIMITS">LIMITS</a></h1>
The default values for resource limits in dnsmasq are generally conservative,
  and appropriate for embedded router type devices with slow processors and
  limited memory. On more capable hardware, it is possible to increase the
  limits, and handle many more clients. The following applies to dnsmasq-2.37:
  earlier versions did not scale as well.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
Dnsmasq is capable of handling DNS and DHCP for at least a thousand clients. The
  DHCP lease times should not be very short (less than one hour). The value of
  <b>--dns-forward-max</b> can be increased: start with it equal to the number
  of clients and increase if DNS seems slow. Note that DNS performance depends
  too on the performance of the upstream nameservers. The size of the DNS cache
  may be increased: the hard limit is 10000 names and the default (150) is very
  low. Sending SIGUSR1 to dnsmasq makes it log information which is useful for
  tuning the cache size. See the <b>NOTES</b> section for details.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
The built-in TFTP server is capable of many simultaneous file transfers: the
  absolute limit is related to the number of file-handles allowed to a process
  and the ability of the select() system call to cope with large numbers of file
  handles. If the limit is set too high using <b>--tftp-max</b> it will be
  scaled down and the actual limit logged at start-up. Note that more transfers
  are possible when the same file is being sent than when each transfer sends a
  different file.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
It is possible to use dnsmasq to block Web advertising by using a list of known
  banner-ad servers, all resolving to 127.0.0.1 or 0.0.0.0, in <b>/etc/hosts</b>
  or an additional hosts file. The list can be very long, dnsmasq has been
  tested successfully with one million names. That size file needs a 1GHz
  processor and about 60Mb of RAM.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="INTERNATIONALISATION"><a class="selflink" href="#INTERNATIONALISATION">INTERNATIONALISATION</a></h1>
Dnsmasq can be compiled to support internationalisation. To do this, the make
  targets &quot;all-i18n&quot; and &quot;install-i18n&quot; should be used
  instead of the standard targets &quot;all&quot; and &quot;install&quot;. When
  internationalisation is compiled in, dnsmasq will produce log messages in the
  local language and support internationalised domain names (IDN). Domain names
  in /etc/hosts, /etc/ethers and /etc/dnsmasq.conf which contain non-ASCII
  characters will be translated to the DNS-internal punycode representation.
  Note that dnsmasq determines both the language for messages and the assumed
  charset for configuration files from the LANG environment variable. This
  should be set to the system default value by the script which is responsible
  for starting dnsmasq. When editing the configuration files, be careful to do
  so using only the system-default locale and not user-specific one, since
  dnsmasq has no direct way of determining the charset in use, and must assume
  that it is the system default.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
<i>/etc/dnsmasq.conf</i>
<div style="height: 1.00em;">&#x00A0;</div>
<i>/usr/local/etc/dnsmasq.conf</i>
<div style="height: 1.00em;">&#x00A0;</div>
<i>/etc/resolv.conf</i> <i>/var/run/dnsmasq/resolv.conf</i>
  <i>/etc/ppp/resolv.conf</i> <i>/etc/dhcpc/resolv.conf</i>
<div style="height: 1.00em;">&#x00A0;</div>
<i>/etc/hosts</i>
<div style="height: 1.00em;">&#x00A0;</div>
<i>/etc/ethers</i>
<div style="height: 1.00em;">&#x00A0;</div>
<i>/var/lib/dnsmasq/dnsmasq.leases</i>
<div style="height: 1.00em;">&#x00A0;</div>
<i>/var/db/dnsmasq.leases</i>
<div style="height: 1.00em;">&#x00A0;</div>
<i>/var/run/dnsmasq.pid</i>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>hosts</b>(5), <b>resolver</b>(5)
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
This manual page was written by Simon Kelley &lt;simon@thekelleys.org.uk&gt;.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
