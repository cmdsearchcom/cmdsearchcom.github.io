<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>SUDOREPLAY(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">SUDOREPLAY(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">SUDOREPLAY(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
<b class="Nm" title="Nm">sudoreplay</b> &#x2014;
  <span class="Nd" title="Nd">replay sudo session logs</span>
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<table class="Nm">
  <tr>
    <td><b class="Nm" title="Nm">sudoreplay</b></td>
    <td>[<span class="Op"><b class="Fl" title="Fl">-h</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-d</b>&#x00A0;<var class="Ar" title="Ar">directory</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-f</b>&#x00A0;<var class="Ar" title="Ar">filter</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-m</b>&#x00A0;<var class="Ar" title="Ar">max_wait</var></span>]
      [<span class="Op"><b class="Fl" title="Fl">-s</b>&#x00A0;<var class="Ar" title="Ar">speed_factor</var></span>]
      ID</td>
  </tr>
</table>
<div class="Pp"></div>
<br/>
<table class="Nm">
  <tr>
    <td><b class="Nm" title="Nm">sudoreplay</b></td>
    <td>[<span class="Op"><b class="Fl" title="Fl">-h</b></span>]
      [<span class="Op"><b class="Fl" title="Fl">-d</b>&#x00A0;<var class="Ar" title="Ar">directory</var></span>]
      <b class="Fl" title="Fl">-l</b> [<span class="Op">search
      expression</span>]</td>
  </tr>
</table>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b class="Nm" title="Nm">sudoreplay</b> plays back or lists the output logs
  created by <b class="Nm" title="Nm">sudo</b>. When replaying,
  <b class="Nm" title="Nm">sudoreplay</b> can play the session back in
  real-time, or the playback speed may be adjusted (faster or slower) based on
  the command line options.
<div class="Pp"></div>
The <i class="Em" title="Em">ID</i> should either be a six character sequence of
  digits and upper case letters, e.g. <code class="Li">0100A5</code>, or a
  pattern matching the <i class="Em" title="Em">iolog_file</i> option in the
  <i class="Em" title="Em">sudoers</i> file. When a command is run via
  <b class="Nm" title="Nm">sudo</b> with <i class="Em" title="Em">log_output</i>
  enabled in the <i class="Em" title="Em">sudoers</i> file, a
  <code class="Li">TSID=ID</code> string is logged via syslog or to the
  <b class="Nm" title="Nm">sudo</b> log file. The
  <i class="Em" title="Em">ID</i> may also be determined using
  <b class="Nm" title="Nm">sudoreplay</b><span class="No">'s</span> list mode.
<div class="Pp"></div>
In list mode, <b class="Nm" title="Nm">sudoreplay</b> can be used to find the ID
  of a session based on a number of criteria such as the user, tty or command
  run.
<div class="Pp"></div>
In replay mode, if the standard output has not been redirected,
  <b class="Nm" title="Nm">sudoreplay</b> will act on the following keys:
<dl class="Bl-tag" style="margin-left: 17.40ex;">
  <dt class="It-tag" style="margin-left: -17.40ex;">&#x2018;<code class="Li">&#x00A0;</code>&#x2019;
    <span class="No">(space)</span></dt>
  <dd class="It-tag">Pause output; press any key to resume.</dd>
  <dt class="It-tag" style="margin-left: -17.40ex;">&#x2018;<code class="Li">&lt;</code>&#x2019;</dt>
  <dd class="It-tag">Reduce the playback speed by one half.</dd>
  <dt class="It-tag" style="margin-left: -17.40ex;">&#x2018;<code class="Li">&gt;</code>&#x2019;</dt>
  <dd class="It-tag">Double the playback speed.</dd>
</dl>
<div class="Pp"></div>
The options are as follows:
<dl class="Bl-tag" style="margin-left: 17.40ex;">
  <dt class="It-tag" style="margin-left: -17.40ex;"><a class="selflink" href="#d"><b class="Fl" title="Fl" id="d">-d</b></a>
    <var class="Ar" title="Ar">directory</var></dt>
  <dd class="It-tag">Use <var class="Ar" title="Ar">directory</var> to for the
      session logs instead of the default,
      <i class="Pa" title="Pa">/var/log/sudo-io</i>.</dd>
  <dt class="It-tag" style="margin-left: -17.40ex;"><a class="selflink" href="#f"><b class="Fl" title="Fl" id="f">-f</b></a>
    <var class="Ar" title="Ar">filter</var></dt>
  <dd class="It-tag">By default, <b class="Nm" title="Nm">sudoreplay</b> will
      play back the command's standard output, standard error and tty output.
      The <b class="Fl" title="Fl">-f</b> option can be used to select which of
      these to output. The <var class="Ar" title="Ar">filter</var> argument is a
      comma-separated list, consisting of one or more of following:
      <i class="Em" title="Em">stdout</i>, <i class="Em" title="Em">stderr</i>,
      and <i class="Em" title="Em">ttyout</i>.</dd>
  <dt class="It-tag" style="margin-left: -17.40ex;"><a class="selflink" href="#h"><b class="Fl" title="Fl" id="h">-h</b></a></dt>
  <dd class="It-tag">The <b class="Fl" title="Fl">-h</b>
      (<i class="Em" title="Em">help</i>) option causes
      <b class="Nm" title="Nm">sudoreplay</b> to print a short help message to
      the standard output and exit.</dd>
  <dt class="It-tag" style="margin-left: -17.40ex;"><a class="selflink" href="#l"><b class="Fl" title="Fl" id="l">-l</b></a>
    [<span class="Op"><var class="Ar" title="Ar">search
    expression</var></span>]</dt>
  <dd class="It-tag">Enable &#x201C;list mode&#x201D;. In this mode,
      <b class="Nm" title="Nm">sudoreplay</b> will list available sessions in a
      format similar to the <b class="Nm" title="Nm">sudo</b> log file format,
      sorted by file name (or sequence number). If a
      <var class="Ar" title="Ar">search expression</var> is specified, it will
      be used to restrict the IDs that are displayed. An expression is composed
      of the following predicates:
    <dl class="Bl-tag">
      <dt class="It-tag">command <var class="Ar" title="Ar">pattern</var></dt>
      <dd class="It-tag">Evaluates to true if the command run matches
          <var class="Ar" title="Ar">pattern</var>. On systems with POSIX
          regular expression support, the pattern may be an extended regular
          expression. On systems without POSIX regular expression support, a
          simple substring match is performed instead.</dd>
      <dt class="It-tag">cwd <var class="Ar" title="Ar">directory</var></dt>
      <dd class="It-tag">Evaluates to true if the command was run with the
          specified current working directory.</dd>
      <dt class="It-tag">fromdate <var class="Ar" title="Ar">date</var></dt>
      <dd class="It-tag">Evaluates to true if the command was run on or after
          <var class="Ar" title="Ar">date</var>. See
          <a class="Sx" title="Sx" href="#Date_and_time_format">Date and time
          format</a> for a description of supported date and time formats.</dd>
      <dt class="It-tag">group <var class="Ar" title="Ar">runas_group</var></dt>
      <dd class="It-tag">Evaluates to true if the command was run with the
          specified <var class="Ar" title="Ar">runas_group</var>. Note that
          unless a <var class="Ar" title="Ar">runas_group</var> was explicitly
          specified when <b class="Nm" title="Nm">sudo</b> was run this field
          will be empty in the log.</dd>
      <dt class="It-tag">runas <var class="Ar" title="Ar">runas_user</var></dt>
      <dd class="It-tag">Evaluates to true if the command was run as the
          specified <var class="Ar" title="Ar">runas_user</var>. Note that
          <b class="Nm" title="Nm">sudo</b> runs commands as user
          <i class="Em" title="Em">root</i> by default.</dd>
      <dt class="It-tag">todate <var class="Ar" title="Ar">date</var></dt>
      <dd class="It-tag">Evaluates to true if the command was run on or prior to
          <var class="Ar" title="Ar">date</var>. See
          <a class="Sx" title="Sx" href="#Date_and_time_format">Date and time
          format</a> for a description of supported date and time formats.</dd>
      <dt class="It-tag">tty <var class="Ar" title="Ar">tty name</var></dt>
      <dd class="It-tag">Evaluates to true if the command was run on the
          specified terminal device. The <var class="Ar" title="Ar">tty
          name</var> should be specified without the
          <i class="Pa" title="Pa">/dev/</i> prefix, e.g.
          <i class="Pa" title="Pa">tty01</i> instead of
          <i class="Pa" title="Pa">/dev/tty01</i>.</dd>
      <dt class="It-tag">user <var class="Ar" title="Ar">user name</var></dt>
      <dd class="It-tag">Evaluates to true if the ID matches a command run by
          <var class="Ar" title="Ar">user name</var>.</dd>
    </dl>
    <div class="Pp"></div>
    Predicates may be abbreviated to the shortest unique string (currently all
      predicates may be shortened to a single character).
    <div class="Pp"></div>
    Predicates may be combined using <i class="Em" title="Em">and</i>,
      <i class="Em" title="Em">or</i> and <i class="Em" title="Em">!</i>
      operators as well as &#x2018;<code class="Li">(</code>&#x2019; and
      &#x2018;<code class="Li">)</code>&#x2019; grouping (note that parentheses
      must generally be escaped from the shell). The
      <i class="Em" title="Em">and</i> operator is optional, adjacent predicates
      have an implied <i class="Em" title="Em">and</i> unless separated by an
      <i class="Em" title="Em">or</i>.</dd>
  <dt class="It-tag" style="margin-left: -17.40ex;"><a class="selflink" href="#m"><b class="Fl" title="Fl" id="m">-m</b></a>
    <var class="Ar" title="Ar">max_wait</var></dt>
  <dd class="It-tag">Specify an upper bound on how long to wait between key
      presses or output data. By default,
      <b class="Nm" title="Nm">sudoreplay</b> will accurately reproduce the
      delays between key presses or program output. However, this can be tedious
      when the session includes long pauses. When the
      <b class="Fl" title="Fl">-m</b> option is specified,
      <b class="Nm" title="Nm">sudoreplay</b> will limit these pauses to at most
      <i class="Em" title="Em">max_wait</i> seconds. The value may be specified
      as a floating point number, e.g. <i class="Em" title="Em">2.5</i>.</dd>
  <dt class="It-tag" style="margin-left: -17.40ex;"><a class="selflink" href="#s"><b class="Fl" title="Fl" id="s">-s</b></a>
    <var class="Ar" title="Ar">speed_factor</var></dt>
  <dd class="It-tag">This option causes <b class="Nm" title="Nm">sudoreplay</b>
      to adjust the number of seconds it will wait between key presses or
      program output. This can be used to slow down or speed up the display. For
      example, a <var class="Ar" title="Ar">speed_factor</var> of
      <i class="Em" title="Em">2</i> would make the output twice as fast whereas
      a <var class="Ar" title="Ar">speed_factor</var> of
      <i class="Em" title="Em">.5</i> would make the output twice as slow.</dd>
  <dt class="It-tag" style="margin-left: -17.40ex;"><a class="selflink" href="#V"><b class="Fl" title="Fl" id="V">-V</b></a></dt>
  <dd class="It-tag">The <b class="Fl" title="Fl">-V</b>
      (<i class="Em" title="Em">version</i>) option causes
      <b class="Nm" title="Nm">sudoreplay</b> to print its version number and
      exit.</dd>
</dl>
<h2 class="Ss" title="Ss" id="Date_and_time_format"><a class="selflink" href="#Date_and_time_format">Date
  and time format</a></h2>
The time and date may be specified multiple ways, common formats include:
<dl class="Bl-tag">
  <dt class="It-tag">HH:MM:SS am MM/DD/CCYY timezone</dt>
  <dd class="It-tag">24 hour time may be used in place of am/pm.</dd>
  <dt class="It-tag">HH:MM:SS am Month, Day Year timezone</dt>
  <dd class="It-tag">24 hour time may be used in place of am/pm, and month and
      day names may be abbreviated. Note that month and day of the week names
      must be specified in English.</dd>
  <dt class="It-tag">CCYY-MM-DD HH:MM:SS</dt>
  <dd class="It-tag">ISO time format</dd>
  <dt class="It-tag">DD Month CCYY HH:MM:SS</dt>
  <dd class="It-tag">The month name may be abbreviated.</dd>
</dl>
<div class="Pp"></div>
Either time or date may be omitted, the am/pm and timezone are optional. If no
  date is specified, the current day is assumed; if no time is specified, the
  first second of the specified date is used. The less significant parts of both
  time and date may also be omitted, in which case zero is assumed.
<div class="Pp"></div>
The following are all valid time and date specifications:
<dl class="Bl-tag">
  <dt class="It-tag">now</dt>
  <dd class="It-tag">The current time and date.</dd>
  <dt class="It-tag">tomorrow</dt>
  <dd class="It-tag">Exactly one day from now.</dd>
  <dt class="It-tag">yesterday</dt>
  <dd class="It-tag">24 hours ago.</dd>
  <dt class="It-tag">2 hours ago</dt>
  <dd class="It-tag">2 hours ago.</dd>
  <dt class="It-tag">next Friday</dt>
  <dd class="It-tag">The first second of the next Friday.</dd>
  <dt class="It-tag">this week</dt>
  <dd class="It-tag">The current time but the first day of the coming week.</dd>
  <dt class="It-tag">a fortnight ago</dt>
  <dd class="It-tag">The current time but 14 days ago.</dd>
  <dt class="It-tag">10:01 am 9/17/2009</dt>
  <dd class="It-tag">10:01 am, September 17, 2009.</dd>
  <dt class="It-tag">10:01 am</dt>
  <dd class="It-tag">10:01 am on the current day.</dd>
  <dt class="It-tag">10</dt>
  <dd class="It-tag">10:00 am on the current day.</dd>
  <dt class="It-tag">9/17/2009</dt>
  <dd class="It-tag">00:00 am, September 17, 2009.</dd>
  <dt class="It-tag">10:01 am Sep 17, 2009</dt>
  <dd class="It-tag">10:01 am, September 17, 2009.</dd>
</dl>
<h1 class="Sh" title="Sh" id="FILES"><a class="selflink" href="#FILES">FILES</a></h1>
<dl class="Bl-tag" style="margin-left: 31.80ex;">
  <dt class="It-tag" style="margin-left: -31.80ex;"><i class="Pa" title="Pa">/var/log/sudo-io</i></dt>
  <dd class="It-tag">The default I/O log directory.</dd>
  <dt class="It-tag" style="margin-left: -31.80ex;"><i class="Pa" title="Pa">/var/log/sudo-io/00/00/01/log</i></dt>
  <dd class="It-tag">Example session log info.</dd>
  <dt class="It-tag" style="margin-left: -31.80ex;"><i class="Pa" title="Pa">/var/log/sudo-io/00/00/01/stdin</i></dt>
  <dd class="It-tag">Example session standard input log.</dd>
  <dt class="It-tag" style="margin-left: -31.80ex;"><i class="Pa" title="Pa">/var/log/sudo-io/00/00/01/stdout</i></dt>
  <dd class="It-tag">Example session standard output log.</dd>
  <dt class="It-tag" style="margin-left: -31.80ex;"><i class="Pa" title="Pa">/var/log/sudo-io/00/00/01/stderr</i></dt>
  <dd class="It-tag">Example session standard error log.</dd>
  <dt class="It-tag" style="margin-left: -31.80ex;"><i class="Pa" title="Pa">/var/log/sudo-io/00/00/01/ttyin</i></dt>
  <dd class="It-tag">Example session tty input file.</dd>
  <dt class="It-tag" style="margin-left: -31.80ex;"><i class="Pa" title="Pa">/var/log/sudo-io/00/00/01/ttyout</i></dt>
  <dd class="It-tag">Example session tty output file.</dd>
  <dt class="It-tag" style="margin-left: -31.80ex;"><i class="Pa" title="Pa">/var/log/sudo-io/00/00/01/timing</i></dt>
  <dd class="It-tag">Example session timing file.</dd>
</dl>
<div class="Pp"></div>
Note that the <i class="Em" title="Em">stdin</i>,
  <i class="Em" title="Em">stdout</i> and <i class="Em" title="Em">stderr</i>
  files will be empty unless <b class="Nm" title="Nm">sudo</b> was used as part
  of a pipeline for a particular command.
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
List sessions run by user <i class="Em" title="Em">millert</i>:
<div class="Pp"></div>
<div class="Bd" style="margin-left: 5.00ex;">
<pre class="Li">
# sudoreplay -l user millert
</pre>
</div>
<div class="Pp"></div>
List sessions run by user <i class="Em" title="Em">bob</i> with a command
  containing the string vi:
<div class="Pp"></div>
<div class="Bd" style="margin-left: 5.00ex;">
<pre class="Li">
# sudoreplay -l user bob command vi
</pre>
</div>
<div class="Pp"></div>
List sessions run by user <i class="Em" title="Em">jeff</i> that match a regular
  expression:
<div class="Pp"></div>
<div class="Bd" style="margin-left: 5.00ex;">
<pre class="Li">
# sudoreplay -l user jeff command '/bin/[a-z]*sh'
</pre>
</div>
<div class="Pp"></div>
List sessions run by jeff or bob on the console:
<div class="Pp"></div>
<div class="Bd" style="margin-left: 5.00ex;">
<pre class="Li">
# sudoreplay -l ( user jeff or user bob ) tty console
</pre>
</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<a class="Xr" title="Xr">sudo(8)</a>, <a class="Xr" title="Xr">script(1)</a>
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
Todd C. Miller
<h1 class="Sh" title="Sh" id="BUGS"><a class="selflink" href="#BUGS">BUGS</a></h1>
If you feel you have found a bug in <b class="Nm" title="Nm">sudoreplay</b>,
  please submit a bug report at http://www.sudo.ws/sudo/bugs/
<h1 class="Sh" title="Sh" id="SUPPORT"><a class="selflink" href="#SUPPORT">SUPPORT</a></h1>
Limited free support is available via the sudo-users mailing list, see
  http://www.sudo.ws/mailman/listinfo/sudo-users to subscribe or search the
  archives.
<h1 class="Sh" title="Sh" id="DISCLAIMER"><a class="selflink" href="#DISCLAIMER">DISCLAIMER</a></h1>
<b class="Nm" title="Nm">sudoreplay</b> is provided &#x201C;AS IS&#x201D; and
  any express or implied warranties, including, but not limited to, the implied
  warranties of merchantability and fitness for a particular purpose are
  disclaimed. See the LICENSE file distributed with
  <b class="Nm" title="Nm">sudo</b> or http://www.sudo.ws/sudo/license.html for
  complete details.</div>
<table class="foot">
  <tr>
    <td class="foot-date">July 12, 2012</td>
    <td class="foot-os">Sudo 1.8.6p7</td>
  </tr>
</table>
</body>
</html>
