<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>WATCH-MIMEDEFANG(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">WATCH-MIMEDEFANG(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">WATCH-MIMEDEFANG(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
watch-mimedefang - Keep an eye on mimedefang-multiplexor
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>watch-mimedefang [<i>options</i>]</b>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>watch-mimedefang</b> is a Tk script which graphically displays the status of
  <b>mimedefang-multiplexor</b>(8). Note that Tcl/Tk 8.0 or higher is required
  to run <b>watch-mimedefang</b>.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="DISPLAY"><a class="selflink" href="#DISPLAY">DISPLAY</a></h1>
<b>watch-mimedefang</b>'s display is divided into three main areas, from top to
  bottom:
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>o</b></dt>
  <dd class="It-tag">The graph display shows six graphs representing various
      statistics about the multiplexor.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>o</b></dt>
  <dd class="It-tag">The control area shows the maximum number of slaves, number
      of busy slaves, and number of idle slaves. The &quot;Control Command&quot;
      text entry lets you monitor remote MIMEDefang servers; see &quot;REMOTE
      MONITORING&quot; for details.
    <div style="height: 1.00em;">&#x00A0;</div>
    The &quot;10s&quot;, &quot;1m&quot;, &quot;5m&quot; and &quot;10m&quot;
      checkboxes allow you to enable or disable the graphing of statistics
      averaged over the last 10 seconds, 1 minute, 5 minutes and 10 minutes.
    <div style="height: 1.00em;">&#x00A0;</div>
    The &quot;Reread Filters&quot; button forces the multiplexor to reread
      filter rules. The &quot;Quit&quot; button terminates
      <b>watch-mimedefang</b>.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>o</b></dt>
  <dd class="It-tag">The scale at the bottom lets you change the update interval
      (default 500ms). Be aware that frequent updating may make
      <b>watch-mimedefang</b> consume a significant fraction of CPU time.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="THE_GRAPH_AREA"><a class="selflink" href="#THE_GRAPH_AREA">THE
  GRAPH AREA</a></h1>
The graph area contains six graphs:
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>o Busy Slaves</b></dt>
  <dd class="It-tag">This graph shows the number of busy slaves each time the
      statistics are sampled.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>o Slaves/scan</b></dt>
  <dd class="It-tag">This graph shows the average number of busy slaves each
      time a message was scanned. The red plot shows the average over the last
      ten seconds, the blue plot shows the average over the last minute, and the
      green and yellow plots show the average over the last five and ten
      minutes, respectively.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>o Latency (ms)</b></dt>
  <dd class="It-tag">This graph shows the average time taken by each SCAN
      command over the last ten seconds, one minute, five minutes and ten
      minutes.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>o Messages/s</b></dt>
  <dd class="It-tag">This graph shows the average number of messages per second
      that were scanned.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>o Activations/s</b></dt>
  <dd class="It-tag">This graph shows the average number of new slaves activated
      per second.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>o Reaps/s</b></dt>
  <dd class="It-tag">This graph shows the average number of slaves that have
      terminated per second.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the Activations and Reaps increase significantly, it could indicate heavy
      load, or an error causing filters to terminate abnormally.
    <div style="height: 1.00em;">&#x00A0;</div>
    If only Activations increase, then it probably indicates a sudden increase
      in e-mail volume.
    <div style="height: 1.00em;">&#x00A0;</div>
    If only Reaps increase, then it probably indicates a quiet time just after a
      period of heavy mail volume.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<div class="Pp"></div>
You can enable or disable the ten second, one minute, five minute or ten minute
  plots by clicking on the &quot;10s&quot;, &quot;1m&quot;, &quot;5m&quot; or
  &quot;10m&quot; checkbox.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="REMOTE_MONITORING"><a class="selflink" href="#REMOTE_MONITORING">REMOTE
  MONITORING</a></h1>
Running <b>watch-mimedefang</b> on your actual mail server poses two problems:
  You need Tcl/Tk and the X client libraries installed, and the CPU consumption
  of <b>watch-mimedefang</b> can be considerable.
<div style="height: 1.00em;">&#x00A0;</div>
A better method is to run <b>watch-mimedefang</b> on a desktop machine, but have
  it monitor the mail server with a remote session.
<div style="height: 1.00em;">&#x00A0;</div>
The best way to establish a remote session is via SSH. For example, if you are
  running MIMEDefang on &quot;mail.mydomain.net&quot;, you can type the
  following into the <b>Control Command</b> entry box and press enter:
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
	ssh root@mail.mydomain.net md-mx-ctrl
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
You <i>must</i> have a public/private key for the target machine and you must be
  running ssh-agent or equivalent; you cannot use an ssh command that requires
  entry of a password or passphrase.
<div style="height: 1.00em;">&#x00A0;</div>
Assuming your SSH setup is correct, <b>watch-mimedefang</b> will open an SSH
  connection to mail.mydomain.net and exchange low-bandwith information over
  that session for monitoring purposes.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="COMMAND-LINE_OPTIONS"><a class="selflink" href="#COMMAND-LINE_OPTIONS">COMMAND-LINE
  OPTIONS</a></h1>
<b>watch-mimedefang</b> accepts the following command-line options:
<div style="height: 1.00em;">&#x00A0;</div>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-command <i>cmd</i></b></dt>
  <dd class="It-tag">Use <i>cmd</i> as the control command. You may need to
      quote <i>cmd</i>
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-interval <i>msec</i></b></dt>
  <dd class="It-tag">Set the update interval to <i>msec</i> milliseconds.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-10s <i>flag</i></b></dt>
  <dd class="It-tag">Enable the &quot;10s&quot; graph plot if <i>flag</i> is 1,
      or disable it if <i>flag</i> is 0.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-1m <i>flag</i></b></dt>
  <dd class="It-tag">Enable the &quot;1m&quot; graph plot if <i>flag</i> is 1,
      or disable it if <i>flag</i> is 0.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-5m <i>flag</i></b></dt>
  <dd class="It-tag">Enable the &quot;5m&quot; graph plot if <i>flag</i> is 1,
      or disable it if <i>flag</i> is 0.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-10m <i>flag</i></b></dt>
  <dd class="It-tag">Enable the &quot;10m&quot; graph plot if <i>flag</i> is 1,
      or disable it if <i>flag</i> is 0.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-title <i>string</i></b></dt>
  <dd class="It-tag">Add <i>string</i> to the title of the main window.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>-help</b></dt>
  <dd class="It-tag">Print usage information.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<h1 class="Sh" title="Sh" id="EXAMPLE"><a class="selflink" href="#EXAMPLE">EXAMPLE</a></h1>
As an example, to monitor MIMEDefang on the machine
  &quot;mail.mydomain.net&quot; updating once a second, with the 5m and 10m
  plots turned off, use:
<div style="height: 1.00em;">&#x00A0;</div>
<pre>
    watch-mimedefang -command 'ssh root@mail.mydomain.net md-mx-ctrl' \
                     -interval 1000 -5m 0 -10m 0 -title &quot;mail&quot;
</pre>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
<b>watch-mimedefang</b> was written by Dianne Skoll
  &lt;dfs@roaringpenguin.com&gt;. The <b>mimedefang</b> home page is
  <i>http://www.mimedefang.org/</i>.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="PERMISSIONS"><a class="selflink" href="#PERMISSIONS">PERMISSIONS</a></h1>
<b>watch-mimedefang</b> uses <b>md-mx-ctrl</b>; therefore, it probably needs to
  be run as <i>root</i> or the same user as <b>mimedefang-multiplexor</b>, or
  (if you are monitoring a remote machine), the SSH connection must be done as
  root or the MIMEDefang user.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
mimedefang.pl(8), mimedefang-filter(5), mimedefang(8), mimedefang-protocol(7),
  md-mx-ctrl(8), watch-multiple-mimedefangs(8)
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">24 October 2002</td>
    <td class="foot-os">4th Berkeley Distribution</td>
  </tr>
</table>
</body>
</html>
