<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Sun Aug 27 19:14:19 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>PAM_ALREADYLOGGEDIN(8) BSD System Manager&rsquo;s Manual
PAM_ALREADYLOGGEDIN(8)</p>

<p style="margin-top: 1em">NAME <br>
pam_alreadyloggedin &acirc; Already-logged-in PAM module</p>

<p style="margin-top: 1em">SYNOPSIS <br>
[service-name] module-type control-flag pam_alreadyloggedin
[options]</p>

<p style="margin-top: 1em">DESCRIPTION <br>
The Already-logged-in authentication service module for PAM,
pam_alreadyloggedin provides functionality for only one PAM
category: authentication. In terms of the module-type <br>
parameter, this is the &acirc;auth&acirc; feature. It also
provides null functions for other PAM categories.</p>

<p style="margin-top: 1em">Already-logged-in Authentication
Module <br>
The Already-logged-in authentication component
(pam_sm_authenticate()), returns success if and only if the
target user&rsquo;s ID is identical to a current login
specified in the utmp(5) <br>
database and verified with matching permissions on that
login&rsquo;s respective terminal in /dev. If a user shows
up in w(8) output, they will generally be allowed to
authenticate <br>
using this method.</p>

<p style="margin-top: 1em">The following options may be
passed to the authentication module:</p>

<p style="margin-top: 1em">debug Enable verbose output to
syslog at LOG_DEBUG level.</p>

<p style="margin-top: 1em">no_debug Disable verbose output
to syslog even it&rsquo;s enabled at compile time.</p>

<p style="margin-top: 1em">no_root Never allow login with a
target user ID of zero.</p>

<p style="margin-top: 1em">restrict_tty=ttyglob* Only allow
login if the terminal device currently being authenticated
on matches ttyglob*. The ttyglob* argument is specified as a
shell glob, and <br>
checked using the fnmatch(3) function. For example,
restrict_tty=/dev/tty[1-6] allows logging from text consoles
of physical terminal only.</p>

<p style="margin-top: 1em">restrict_loggedin_tty=ttyglob*
Disallow recognition that the user is already logged in
unless the terminal device logged in upon matches
ttyglob*.</p>

<p style="margin-top: 1em">EXAMPLE <br>
Modify auth section of the /etc/pam.d/login file like
following:</p>

<p style="margin-top: 1em">auth required
/lib/security/pam_securetty.so <br>
auth sufficient /lib/security/pam_alreadyloggedin.so no_root
<br>
auth required /lib/security/pam_stack.so
service=system-auth</p>

<p style="margin-top: 1em">BUGS <br>
FreeBSD version expects /dev/ prefix in restrict_tty value,
but value of restrict_loggedin_tty should be without them.
Linux version expects /dev/ in both cases.</p>

<p style="margin-top: 1em">SEE ALSO <br>
fnmatch(3), getuid(2), stat(2), utmp(5), w(8), pam.conf(5),
pam(8)</p>

<p style="margin-top: 1em">AUTHORS <br>
Adopted for Linux PAM by Ilya Evseev at Jan 2004.</p>

<p style="margin-top: 1em">The original pam_alreadyloggedin
module and this manual page were developed for the FreeBSD
Project by NAI Labs and ThinkSec AS, the Security Research
Division of Network Asso&acirc; <br>
ciates, Inc. under DARPA/SPAWAR contract N66001-01-C-8035
(&acirc;CBOSS&acirc;), as part of the DARPA CHATS research
program.</p>

<p style="margin-top: 1em">Linux-PAM January 30, 2004
Linux-PAM</p>
<hr>
</body>
</html>
