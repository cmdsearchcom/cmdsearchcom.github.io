<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>PAM_SUCCEED_IF(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">PAM_SUCCEED_IF(8)</td>
    <td class="head-vol">Linux-PAM</td>
    <td class="head-rtitle">PAM_SUCCEED_IF(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
pam_succeed_if - test account characteristics
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<div class="Pp" style="margin-left: 19.00ex; text-indent: -19.00ex;"><b>pam_succeed_if.so</b>
  [ <i>flag</i>...] [<i>condition</i>...]</div>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
pam_succeed_if.so is designed to succeed or fail authentication based on
  characteristics of the account belonging to the user being authenticated or
  values of other PAM items. One use is to select whether to load other modules
  based on this test.
<div class="Pp"></div>
The module should be given one or more conditions as module arguments, and
  authentication will succeed only if all of the conditions are met.
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
The following <i>flag</i>s are supported:
<div class="Pp"></div>
<b>debug</b>
<div style="margin-left: 4.00ex;">Turns on debugging messages sent to
  syslog.</div>
<div class="Pp"></div>
<b>use_uid</b>
<div style="margin-left: 4.00ex;">Evaluate conditions using the account of the
  user whose UID the application is running under instead of the user being
  authenticated.</div>
<div class="Pp"></div>
<b>quiet</b>
<div style="margin-left: 4.00ex;">Don't log failure or success to the system
  log.</div>
<div class="Pp"></div>
<b>quiet_fail</b>
<div style="margin-left: 4.00ex;">Don't log failure to the system log.</div>
<div class="Pp"></div>
<b>quiet_success</b>
<div style="margin-left: 4.00ex;">Don't log success to the system log.</div>
<div class="Pp"></div>
<b>audit</b>
<div style="margin-left: 4.00ex;">Log unknown users to the system log.</div>
<div class="Pp"></div>
<i>Condition</i>s are three words: a field, a test, and a value to test for.
<div class="Pp"></div>
Available fields are <i>user</i>, <i>uid</i>, <i>gid</i>, <i>shell</i>,
  <i>home</i>, <i>ruser</i>, <i>rhost</i>, <i>tty</i> and <i>service</i>:
<div class="Pp"></div>
<b>field &lt; number</b>
<div style="margin-left: 4.00ex;">Field has a value numerically less than
  number.</div>
<div class="Pp"></div>
<b>field &lt;= number</b>
<div style="margin-left: 4.00ex;">Field has a value numerically less than or
  equal to number.</div>
<div class="Pp"></div>
<b>field eq number</b>
<div style="margin-left: 4.00ex;">Field has a value numerically equal to
  number.</div>
<div class="Pp"></div>
<b>field &gt;= number</b>
<div style="margin-left: 4.00ex;">Field has a value numerically greater than or
  equal to number.</div>
<div class="Pp"></div>
<b>field &gt; number</b>
<div style="margin-left: 4.00ex;">Field has a value numerically greater than
  number.</div>
<div class="Pp"></div>
<b>field ne number</b>
<div style="margin-left: 4.00ex;">Field has a value numerically different from
  number.</div>
<div class="Pp"></div>
<b>field = string</b>
<div style="margin-left: 4.00ex;">Field exactly matches the given string.</div>
<div class="Pp"></div>
<b>field != string</b>
<div style="margin-left: 4.00ex;">Field does not match the given string.</div>
<div class="Pp"></div>
<b>field =~ glob</b>
<div style="margin-left: 4.00ex;">Field matches the given glob.</div>
<div class="Pp"></div>
<b>field !~ glob</b>
<div style="margin-left: 4.00ex;">Field does not match the given glob.</div>
<div class="Pp"></div>
<b>field in item:item:...</b>
<div style="margin-left: 4.00ex;">Field is contained in the list of items
  separated by colons.</div>
<div class="Pp"></div>
<b>field notin item:item:...</b>
<div style="margin-left: 4.00ex;">Field is not contained in the list of items
  separated by colons.</div>
<div class="Pp"></div>
<b>user ingroup group</b>
<div style="margin-left: 4.00ex;">User is in given group.</div>
<div class="Pp"></div>
<b>user notingroup group</b>
<div style="margin-left: 4.00ex;">User is not in given group.</div>
<div class="Pp"></div>
<b>user innetgr netgroup</b>
<div style="margin-left: 4.00ex;">(user,host) is in given netgroup.</div>
<div class="Pp"></div>
<b>user notinnetgr group</b>
<div style="margin-left: 4.00ex;">(user,host) is not in given netgroup.</div>
<h1 class="Sh" title="Sh" id="MODULE_TYPES_PROVIDED"><a class="selflink" href="#MODULE_TYPES_PROVIDED">MODULE
  TYPES PROVIDED</a></h1>
All module types ( <b>account</b>, <b>auth</b>, <b>password</b> and
  <b>session</b>) are provided.
<h1 class="Sh" title="Sh" id="RETURN_VALUES"><a class="selflink" href="#RETURN_VALUES">RETURN
  VALUES</a></h1>
PAM_SUCCESS
<div style="margin-left: 4.00ex;">The condition was true.</div>
<div class="Pp"></div>
PAM_AUTH_ERR
<div style="margin-left: 4.00ex;">The condition was false.</div>
<div class="Pp"></div>
PAM_SERVICE_ERR
<div style="margin-left: 4.00ex;">A service error occurred or the arguments
  can't be parsed correctly.</div>
<h1 class="Sh" title="Sh" id="EXAMPLES"><a class="selflink" href="#EXAMPLES">EXAMPLES</a></h1>
To emulate the behaviour of <i>pam_wheel</i>, except there is no fallback to
  group 0:
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
auth required pam_succeed_if.so quiet user ingroup wheel
    
</pre>
</div>
<div class="Pp"></div>
Given that the type matches, only loads the othermodule rule if the UID is over
  500. Adjust the number after default to skip several rules.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="margin-left: 4.00ex;">
<pre>
type [default=1 success=ignore] pam_succeed_if.so quiet uid &gt; 500
type required othermodule.so arguments...
    
</pre>
</div>
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>glob</b>(7), <b>pam</b>(8)
<h1 class="Sh" title="Sh" id="AUTHOR"><a class="selflink" href="#AUTHOR">AUTHOR</a></h1>
Nalin Dahyabhai &lt;nalin@redhat.com&gt;</div>
<table class="foot">
  <tr>
    <td class="foot-date">09/19/2013</td>
    <td class="foot-os">Linux-PAM</td>
  </tr>
</table>
</body>
</html>
