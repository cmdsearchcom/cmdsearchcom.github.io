<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
  </style>
  <title>CRYPTSETUP(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">CRYPTSETUP(8)</td>
    <td class="head-vol">Maintenance Commands</td>
    <td class="head-rtitle">CRYPTSETUP(8)</td>
  </tr>
</table>
<div class="manual-text">
<h1 class="Sh" title="Sh" id="NAME"><a class="selflink" href="#NAME">NAME</a></h1>
cryptsetup - manage plain dm-crypt and LUKS encrypted volumes
<h1 class="Sh" title="Sh" id="SYNOPSIS"><a class="selflink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>cryptsetup &lt;options&gt; &lt;action&gt; &lt;action args&gt;</b>
<h1 class="Sh" title="Sh" id="DESCRIPTION"><a class="selflink" href="#DESCRIPTION">DESCRIPTION</a></h1>
cryptsetup is used to conveniently setup dm-crypt managed device-mapper
  mappings. These include plain dm-crypt volumes and LUKS volumes. The
  difference is that LUKS uses a metadata header and can hence offer more
  features than plain dm-crypt. On the other hand, the header is visible and
  vulnerable to damage.
<div style="height: 1.00em;">&#x00A0;</div>
In addition, cryptsetup provides limited support for the use of historic loopaes
  volumes and for TrueCrypt compatible volumes.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="PLAIN_DM-CRYPT_OR_LUKS?"><a class="selflink" href="#PLAIN_DM-CRYPT_OR_LUKS?">PLAIN
  DM-CRYPT OR LUKS?</a></h1>
Unless you understand the cryptographic background well, use LUKS. With plain
  dm-crypt there are a number of possible user errors that massively decrease
  security. While LUKS cannot fix them all, it can lessen the impact for many of
  them.
<h1 class="Sh" title="Sh" id="WARNINGS"><a class="selflink" href="#WARNINGS">WARNINGS</a></h1>
A lot of good information on the risks of using encrypted storage, on handling
  problems and on security aspects can be found in the <i>Cryptsetup FAQ</i>.
  Read it. Nonetheless, some risks deserve to be mentioned here.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Backup:</b> Storage media die. Encryption has no influence on that. Backup is
  mandatory for encrypted data as well, if the data has any worth. See the
  Cryptsetup FAQ for advice on how to do backup of an encrypted volume.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Character encoding:</b> If you enter a passphrase with special symbols, the
  passphrase can change depending character encoding. Keyboard settings can also
  change, which can make blind input hard or impossible. For example, switching
  from some ASCII 8-bit variant to UTF-8 can lead to a different binary encoding
  and hence different passphrase seen by cryptsetup, even if what you see on the
  terminal is exactly the same. It is therefore highly recommended to select
  passphrase characters only from 7-bit ASCII, as the encoding for 7-bit ASCII
  stays the same for all ASCII variants and UTF-8.
<div style="height: 1.00em;">&#x00A0;</div>
<b>LUKS header:</b> If the header of a LUKS volume gets damaged, all data is
  permanently lost unless you have a header-backup. If a key-slot is damaged, it
  can only be restored from a header-backup or if another active key-slot with
  known passphrase is undamaged. Damaging the LUKS header is something people
  manage to do with surprising frequency. This risk is the result of a trade-off
  between security and safety, as LUKS is designed for fast and secure wiping by
  just overwriting header and key-slot area.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Previously used partitions:</b> If a partition was previously used, it is a
  very good idea to wipe filesystem signatures, data, etc. before creating a
  LUKS or plain dm-crypt container on it. For a quick removal of filesystem
  signatures, use &quot;wipefs&quot;. Take care though that this may not remove
  everything. In particular md (RAID) signatures at the end of a device may
  survive. It also does not remove data. For a full wipe, overwrite the whole
  partition before container creation. If you do not know how to to that, the
  cryptsetup FAQ describes several options.
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="BASIC_COMMANDS"><a class="selflink" href="#BASIC_COMMANDS">BASIC
  COMMANDS</a></h1>
The following are valid actions for all supported device types.
<div style="height: 1.00em;">&#x00A0;</div>
<i>open</i> &lt;device&gt; &lt;name&gt; --type &lt;device_type&gt;
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Opens (creates a mapping with) &lt;name&gt; backed by
      device &lt;device&gt;.
    <div style="height: 1.00em;">&#x00A0;</div>
    Device type can be <i>plain</i>, <i>luks</i> (default), <i>loopaes</i> or
      <i>tcrypt</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
    For backward compatibility there are <b>open</b> command aliases:
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>create</b> (argument-order &lt;name&gt; &lt;device&gt;): open --type
      plain
    <div>&#x00A0;</div>
     <b>plainOpen</b>: open --type plain
    <div>&#x00A0;</div>
     <b>luksOpen</b>: open --type luks
    <div>&#x00A0;</div>
     <b>loopaesOpen</b>: open --type loopaes
    <div>&#x00A0;</div>
     <b>tcryptOpen</b>: open --type tcrypt
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>&lt;options&gt;</b> are type specific and are described below for
      individual device types. For <b>create</b>, the order of the &lt;name&gt;
      and &lt;device&gt; options is inverted for historical reasons, all other
      aliases use the standard <b>&lt;device&gt; &lt;name&gt;</b> order.</dd>
</dl>
<div class="Pp"></div>
<i>close</i> &lt;name&gt;
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Removes the existing mapping &lt;name&gt; and wipes the key
      from kernel memory.
    <div style="height: 1.00em;">&#x00A0;</div>
    For backward compatibility there are <b>close</b> command aliases:
      <b>remove</b>, <b>plainClose</b>, <b>luksClose</b>, <b>loopaesClose</b>,
      <b>tcryptClose</b> (all behaves exactly the same, device type is
      determined automatically from active device).</dd>
</dl>
<div class="Pp"></div>
<i>status</i> &lt;name&gt;
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Reports the status for the mapping &lt;name&gt;.</dd>
</dl>
<div class="Pp"></div>
<i>resize</i> &lt;name&gt;
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Resizes an active mapping &lt;name&gt;.
    <div style="height: 1.00em;">&#x00A0;</div>
    If --size (in sectors) is not specified, the size of the underlying block
      device is used. Note that this does not change the raw device geometry, it
      just changes how many sectors of the raw device are represented in the
      mapped device.</dd>
</dl>
<h1 class="Sh" title="Sh" id="PLAIN_MODE"><a class="selflink" href="#PLAIN_MODE">PLAIN
  MODE</a></h1>
Plain dm-crypt encrypts the device sector-by-sector with a single, non-salted
  hash of the passphrase. No checks are performed, no metadata is used. There is
  no formatting operation. When the raw device is mapped (opened), the usual
  device operations can be used on the mapped device, including filesystem
  creation. Mapped devices usually reside in /dev/mapper/&lt;name&gt;.
<div style="height: 1.00em;">&#x00A0;</div>
The following are valid plain device type actions:
<div style="height: 1.00em;">&#x00A0;</div>
<i>open</i> --type plain &lt;device&gt; &lt;name&gt;
<div>&#x00A0;</div>
<i>create</i> &lt;name&gt; &lt;device&gt; (<b>OBSOLETE syntax</b>)
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Opens (creates a mapping with) &lt;name&gt; backed by
      device &lt;device&gt;.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>&lt;options&gt;</b> can be [--hash, --cipher, --verify-passphrase,
      --key-file, --keyfile-offset, --key-size, --offset, --skip, --size,
      --readonly, --shared, --allow-discards]
    <div style="height: 1.00em;">&#x00A0;</div>
    Example: 'cryptsetup open --type plain /dev/sda10 e1' maps the raw encrypted
      device /dev/sda10 to the mapped (decrypted) device /dev/mapper/e1, which
      can then be mounted, fsck-ed or have a filesystem created on it.</dd>
</dl>
<h1 class="Sh" title="Sh" id="LUKS_EXTENSION"><a class="selflink" href="#LUKS_EXTENSION">LUKS
  EXTENSION</a></h1>
LUKS, the Linux Unified Key Setup, is a standard for disk encryption. It adds a
  standardized header at the start of the device, a key-slot area directly
  behind the header and the bulk data area behind that. The whole set is called
  a 'LUKS container'. The device that a LUKS container resides on is called a
  'LUKS device'. For most purposes both terms can be used interchangeably. But
  note that when the LUKS header is at a nonzero offset in a device, then the
  device is not a LUKS device anymore, but has a LUKS container stored in it at
  an offset.
<div style="height: 1.00em;">&#x00A0;</div>
LUKS can manage multiple passphrases that can be individually revoked or changed
  and that can be securely scrubbed from persistent media due to the use of
  anti-forensic stripes. Passphrases are protected against brute-force and
  dictionary attacks by PBKDF2, which implements hash iteration and salting in
  one function.
<div style="height: 1.00em;">&#x00A0;</div>
Each passphrase, also called a <b>key</b> in this document, is associated with
  one of 8 key-slots. Key operations that do not specify a slot affect the first
  slot that matches the supplied passphrase or the first empty slot if a new
  passphrase is added.
<div style="height: 1.00em;">&#x00A0;</div>
The <b>&lt;device&gt;</b> parameter can be also specified by a LUKS UUID in the
  format UUID=&lt;uuid&gt;. Translation to real device name uses symlinks in
  /dev/disk/by-uuid directory.
<div style="height: 1.00em;">&#x00A0;</div>
To specify a detached header, the <b>--header</b> parameter can be used in all
  LUKS commands and always takes precedence over positional
  <b>&lt;device&gt;</b> parameter.
<div style="height: 1.00em;">&#x00A0;</div>
The following are valid LUKS actions:
<div style="height: 1.00em;">&#x00A0;</div>
<i>luksFormat</i> &lt;device&gt; [&lt;key file&gt;]
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Initializes a LUKS partition and sets the initial
      passphrase (for key-slot 0), either via prompting or via &lt;key file&gt;.
      Note that if the second argument is present, then the passphrase is taken
      from the file given there, without the need to use the --key-file option.
      Also note that for both forms of reading the passphrase from file you can
      give '-' as file name, which results in the passphrase being read from
      stdin and the safety-question being skipped.
    <div style="height: 1.00em;">&#x00A0;</div>
    You can only call luksFormat on a LUKS device that is not mapped.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>&lt;options&gt;</b> can be [--hash, --cipher, --verify-passphrase,
      --key-size, --key-slot, --key-file (takes precedence over optional second
      argument), --keyfile-offset, --keyfile-size, --use-random | --use-urandom,
      --uuid, --master-key-file, --iter-time, --header, --force-password].
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>WARNING:</b> Doing a luksFormat on an existing LUKS container will make
      all data the old container permanently irretrievable, unless you have a
      header backup.</dd>
</dl>
<div class="Pp"></div>
<i>open</i> --type luks &lt;device&gt; &lt;name&gt;
<div>&#x00A0;</div>
<i>luksOpen</i> &lt;device&gt; &lt;name&gt; (<b>old syntax</b>)
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Opens the LUKS device &lt;device&gt; and sets up a mapping
      &lt;name&gt; after successful verification of the supplied passphrase. If
      the passphrase is not supplied via --key-file, the command prompts for it
      interactively.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>&lt;options&gt;</b> can be [--key-file, --keyfile-offset,
      --keyfile-size, --readonly, --test-passphrase, --allow-discards, --header,
      --key-slot, --master-key-file].</dd>
</dl>
<div class="Pp"></div>
<i>luksSuspend</i> &lt;name&gt;
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Suspends an active device (all IO operations will blocked
      and accesses to the device will wait indefinitely) and wipes the
      encryption key from kernel memory. Needs kernel 2.6.19 or later.
    <div style="height: 1.00em;">&#x00A0;</div>
    After this operation you have to use <i>luksResume</i> to reinstate the
      encryption key and unblock the device or <i>close</i> to remove the mapped
      device.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>WARNING:</b> never suspend the device on which the cryptsetup binary
      resides.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>&lt;options&gt;</b> can be [--header].</dd>
</dl>
<div class="Pp"></div>
<i>luksResume</i> &lt;name&gt;
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Resumes a suspended device and reinstates the encryption
      key. Prompts interactively for a passphrase if --key-file is not given.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>&lt;options&gt;</b> can be [--key-file, --keyfile-size, --header]</dd>
</dl>
<div class="Pp"></div>
<i>luksAddKey</i> &lt;device&gt; [&lt;key file with new key&gt;]
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">adds a new passphrase. An existing passphrase must be
      supplied interactively or via --key-file. The new passphrase to be added
      can be specified interactively or read from the file given as positional
      argument.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>&lt;options&gt;</b> can be [--key-file, --keyfile-offset,
      --keyfile-size, --new-keyfile-offset, --new-keyfile-size, --key-slot,
      --master-key-file, --iter-time, --force-password, --header].</dd>
</dl>
<div class="Pp"></div>
<i>luksRemoveKey</i> &lt;device&gt; [&lt;key file with passphrase to be
  removed&gt;]
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Removes the supplied passphrase from the LUKS device. The
      passphrase to be removed can be specified interactively, as positional
      argument or via --key-file.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>&lt;options&gt;</b> can be [--key-file, --keyfile-offset,
      --keyfile-size, --header]
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>WARNING:</b> If you read the passphrase from stdin (without further
      argument or with '-' as argument to --key-file), batch-mode (-q) will be
      implicitely switched on and no warning will be given when you remove the
      last remaining passphrase from a LUKS container. Removing the last
      passphrase makes the LUKS container permanently inaccessible.</dd>
</dl>
<div class="Pp"></div>
<i>luksChangeKey</i> &lt;device&gt; [&lt;new key file&gt;]
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Changes an existing passphrase. The passphrase to be
      changed must be supplied interactively or via --key-file. The new
      passphrase can be supplied interactively or in a file given as positional
      argument.
    <div style="height: 1.00em;">&#x00A0;</div>
    If a key-slot is specified (via --key-slot), the passphrase for that
      key-slot must be given and the new passphrase will overwrite the specified
      key-slot. If no key-slot is specified and there is still a free key-slot,
      then the new passphrase will be put into a free key-slot before the
      key-slot containing the old passphrase is purged. If there is no free
      key-slot, then the key-slot with the old passphrase is overwritten
      directly.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>WARNING:</b> If a key-slot is overwritten, a media failure during this
      operation can cause the overwrite to fail after the old passphrase has
      been wiped and make the LUKS container inaccessible.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>&lt;options&gt;</b> can be [--key-file, --keyfile-offset,
      --keyfile-size, --new-keyfile-offset, --new-keyfile-size, --key-slot,
      --force-password, --header].</dd>
</dl>
<div class="Pp"></div>
<i>luksKillSlot</i> &lt;device&gt; &lt;key slot number&gt;
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Wipe the key-slot number &lt;key slot&gt; from the LUKS
      device. Except running in batch-mode (-q) a remaining passphrase must be
      supplied, either interactively or via --key-file. This command can remove
      the last remaining key-slot, but requires an interactive confirmation when
      doing so. Removing the last passphrase makes a LUKS container permanently
      inaccessible.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>&lt;options&gt;</b> can be [--key-file, --keyfile-offset,
      --keyfile-size, --header].
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>WARNING:</b> If you read the passphrase from stdin (without further
      argument or with '-' as argument to --key-file), batch-mode (-q) will be
      implicitly switched on and no warning will be given when you remove the
      last remaining passphrase from a LUKS container. Removing the last
      passphrase makes the LUKS container permanently inaccessible.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>NOTE:</b> If there is no passphrase provided (on stdin or through
      --key-file argument) and batch-mode (-q) is active, the key-slot is
      removed without any other warning.
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<div class="Pp"></div>
<i>erase</i> &lt;device&gt;
<div>&#x00A0;</div>
<i>luksErase</i> &lt;device&gt;
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Erase all keyslots and make the LUKS container permanently
      inaccessible. You do not need to provide any password for this operation.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>WARNING:</b> This operation is irreversible.</dd>
</dl>
<div class="Pp"></div>
<i>luksUUID</i> &lt;device&gt;
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Print the UUID of a LUKS device.
    <div>&#x00A0;</div>
    Set new UUID if <i>--uuid</i> option is specified.</dd>
</dl>
<div class="Pp"></div>
<i>isLuks</i> &lt;device&gt;
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Returns true, if &lt;device&gt; is a LUKS device, false
      otherwise. Use option -v to get human-readable feedback. 'Command
      successful.' means the device is a LUKS device.</dd>
</dl>
<div class="Pp"></div>
<i>luksDump</i> &lt;device&gt;
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Dump the header information of a LUKS device.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the --dump-master-key option is used, the LUKS device master key is
      dumped instead of the keyslot info. Beware that the master key cannot be
      changed and can be used to decrypt the data stored in the LUKS container
      without a passphrase and even without the LUKS header. This means that if
      the master key is compromised, the whole device has to be erased to
      prevent further access. Use this option carefully.
    <div style="height: 1.00em;">&#x00A0;</div>
    In order to dump the master key, a passphrase has to be supplied, either
      interactively or via --key-file.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>&lt;options&gt;</b> can be [--dump-master-key, --key-file,
      --keyfile-offset, --keyfile-size, --header].
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>WARNING:</b> If --dump-master-key is used with --key-file and the
      argument to --key-file is '-', no validation question will be asked and no
      warning given.</dd>
</dl>
<div class="Pp"></div>
<i>luksHeaderBackup</i> &lt;device&gt; --header-backup-file &lt;file&gt;
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Stores a binary backup of the LUKS header and keyslot area.
    <div>&#x00A0;</div>
    Note: Using '-' as filename writes the header backup to a file named '-'.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>WARNING:</b> This backup file and a passphrase valid at the time of
      backup allows decryption of the LUKS data area, even if the passphrase was
      later changed or removed from the LUKS device. Also note that with a
      header backup you lose the ability to securely wipe the LUKS device by
      just overwriting the header and key-slots. You either need to securely
      erase all header backups in addition or overwrite the encrypted data area
      as well. The second option is less secure, as some sectors can survive,
      e.g. due to defect management.</dd>
</dl>
<div class="Pp"></div>
<i>luksHeaderRestore</i> &lt;device&gt; --header-backup-file &lt;file&gt;
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Restores a binary backup of the LUKS header and keyslot
      area from the specified file.
    <div>&#x00A0;</div>
    Note: Using '-' as filename reads the header backup from a file named '-'.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>WARNING:</b> Header and keyslots will be replaced, only the passphrases
      from the backup will work afterwards.
    <div style="height: 1.00em;">&#x00A0;</div>
    This command requires that the master key size and data offset of the LUKS
      header already on the device and of the header backup match.
      Alternatively, if there is no LUKS header on the device, the backup will
      also be written to it.</dd>
</dl>
<h1 class="Sh" title="Sh" id="loop-AES_EXTENSION"><a class="selflink" href="#loop-AES_EXTENSION">loop-AES
  EXTENSION</a></h1>
cryptsetup supports mapping loop-AES encrypted partition using a compatibility
  mode.
<div class="Pp"></div>
<i>open</i> --type loopaes &lt;device&gt; &lt;name&gt; --key-file
  &lt;keyfile&gt;
<div>&#x00A0;</div>
<i>loopaesOpen</i> &lt;device&gt; &lt;name&gt; --key-file &lt;keyfile&gt;
  (<b>old syntax</b>)
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Opens the loop-AES &lt;device&gt; and sets up a mapping
      &lt;name&gt;.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the key file is encrypted with GnuPG, then you have to use --key-file=-
      and decrypt it before use, e.g. like this:
    <div>&#x00A0;</div>
    gpg --decrypt &lt;keyfile&gt; | cryptsetup loopaesOpen --key-file=-
      &lt;device&gt; &lt;name&gt;
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>WARNING:</b> The loop-AES extension cannot use direct input of key file
      on real terminal because the keys are separated by end-of-line and only
      part of the multi-key file would be read.
    <div>&#x00A0;</div>
    If you need it in script, just use the pipe redirection:
    <div>&#x00A0;</div>
    echo $keyfile | cryptsetup loopaesOpen --key-file=- &lt;device&gt;
      &lt;name&gt;
    <div style="height: 1.00em;">&#x00A0;</div>
    Use <b>--keyfile-size</b> to specify the proper key length if needed.
    <div style="height: 1.00em;">&#x00A0;</div>
    Use <b>--offset</b> to specify device offset. Note that the units need to be
      specified in number of 512 byte sectors.
    <div style="height: 1.00em;">&#x00A0;</div>
    Use <b>--skip</b> to specify the IV offset. If the original device used an
      offset and but did not use it in IV sector calculations, you have to
      explicitly use <b>--skip 0</b> in addition to the offset parameter.
    <div style="height: 1.00em;">&#x00A0;</div>
    Use <b>--hash</b> to override the default hash function for passphrase
      hashing (otherwise it is detected according to key size).
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>&lt;options&gt;</b> can be [--key-file, --key-size, --offset, --skip,
      --hash, --readonly, --allow-discards].</dd>
</dl>
<div class="Pp"></div>
See also section 7 of the FAQ and <b>http://loop-aes.sourceforge.net</b> for
  more information regarding loop-AES.
<h1 class="Sh" title="Sh" id="TCRYPT_(TrueCrypt-compatible_and_VeraCrypt)_EXTENSION"><a class="selflink" href="#TCRYPT_(TrueCrypt-compatible_and_VeraCrypt)_EXTENSION">TCRYPT
  (TrueCrypt-compatible and VeraCrypt) EXTENSION</a></h1>
cryptsetup supports mapping of TrueCrypt, tcplay or VeraCrypt (with
  <b>--veracrypt</b> option) encrypted partition using a native Linux kernel
  API. Header formatting and TCRYPT header change is not supported, cryptsetup
  never changes TCRYPT header on-device.
<div style="height: 1.00em;">&#x00A0;</div>
TCRYPT extension requires kernel userspace crypto API to be available
  (introduced in Linux kernel 2.6.38). If you are configuring kernel yourself,
  enable &quot;User-space interface for symmetric key cipher algorithms&quot; in
  &quot;Cryptographic API&quot; section (CRYPTO_USER_API_SKCIPHER .config
  option).
<div style="height: 1.00em;">&#x00A0;</div>
Because TCRYPT header is encrypted, you have to always provide valid passphrase
  and keyfiles.
<div style="height: 1.00em;">&#x00A0;</div>
Cryptsetup should recognize all header variants, except legacy cipher chains
  using LRW encryption mode with 64 bits encryption block (namely Blowfish in
  LRW mode is not recognized, this is limitation of kernel crypto API).
<div style="height: 1.00em;">&#x00A0;</div>
To recognize VeraCrypt device use <b>--veracrypt</b> option. VeraCrypt is just
  extension of TrueCrypt header with increased iteration count so unlocking can
  take quite a lot of time (in comparison with TCRYPT device).
<div style="height: 1.00em;">&#x00A0;</div>
<b>NOTE:</b> Activation with <b>tcryptOpen</b> is supported only for cipher
  chains using LRW or XTS encryption modes.
<div style="height: 1.00em;">&#x00A0;</div>
The <b>tcryptDump</b> command should work for all recognized TCRYPT devices and
  doesn't require superuser privilege.
<div style="height: 1.00em;">&#x00A0;</div>
To map system device (device with boot loader where the whole encrypted system
  resides) use <b>--tcrypt-system</b> option. You can use partition device as
  the parameter (parameter must be real partition device, not image in file),
  then only this partition is mapped.
<div style="height: 1.00em;">&#x00A0;</div>
If you have whole TCRYPT device as a file image and you want to map multiple
  partition encrypted with system encryption, please create loopback mapping
  with partitions first ( <b>losetup -P</b>, see <b>losetup(8)</b> man page for
  more info), and use loop partition as the device parameter.
<div style="height: 1.00em;">&#x00A0;</div>
If you use whole base device as parameter, one device for the whole system
  encryption is mapped. This mode is available only for backward compatibility
  with older cryptsetup versions which mapped TCRYPT system encryption using
  whole device.
<div style="height: 1.00em;">&#x00A0;</div>
To use hidden header (and map hidden device, if available), use
  <b>--tcrypt-hidden</b> option.
<div style="height: 1.00em;">&#x00A0;</div>
To explicitly use backup (secondary) header, use <b>--tcrypt-backup</b> option.
<div style="height: 1.00em;">&#x00A0;</div>
<b>NOTE:</b> There is no protection for a hidden volume if the outer volume is
  mounted. The reason is that if there were any protection, it would require
  some metadata describing what to protect in the outer volume and the hidden
  volume would become detectable.
<div style="height: 1.00em;">&#x00A0;</div>
<div class="Pp"></div>
<i>open</i> --type tcrypt &lt;device&gt; &lt;name&gt;
<div>&#x00A0;</div>
<i>tcryptOpen</i> &lt;device&gt; &lt;name&gt; (<b>old syntax</b>)
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Opens the TCRYPT (a TrueCrypt-compatible) &lt;device&gt;
      and sets up a mapping &lt;name&gt;.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>&lt;options&gt;</b> can be [--key-file, --tcrypt-hidden,
      --tcrypt-system, --tcrypt-backup, --readonly, --test-passphrase,
      --allow-discards].
    <div style="height: 1.00em;">&#x00A0;</div>
    The keyfile parameter allows combination of file content with the passphrase
      and can be repeated. Note that using keyfiles is compatible with TCRYPT
      and is different from LUKS keyfile logic.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>WARNING:</b> Option <b>--allow-discards</b> cannot be combined with
      option <b>--tcrypt-hidden</b>. For normal mapping it can cause
      <b>destruction of hidden volume</b> (hidden volume appears as unused space
      for outer volume so this space can be discarded).
    <div style="height: 1.00em;">&#x00A0;</div>
  </dd>
</dl>
<div class="Pp"></div>
<i>tcryptDump</i> &lt;device&gt;
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Dump the header information of a TCRYPT device.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the --dump-master-key option is used, the TCRYPT device master key is
      dumped instead of TCRYPT header info. Beware that the master key (or
      concatenated master keys if cipher chain is used) can be used to decrypt
      the data stored in the TCRYPT container without a passphrase. This means
      that if the master key is compromised, the whole device has to be erased
      to prevent further access. Use this option carefully.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>&lt;options&gt;</b> can be [--dump-master-key, --key-file,
      --tcrypt-hidden, --tcrypt-system, --tcrypt-backup].
    <div style="height: 1.00em;">&#x00A0;</div>
    The keyfile parameter allows combination of file content with the passphrase
      and can be repeated.</dd>
</dl>
<div class="Pp"></div>
See also <b>http://www.truecrypt.org</b> for more information regarding
  TrueCrypt.
<div style="height: 1.00em;">&#x00A0;</div>
Please note that cryptsetup does not use TrueCrypt code, please report all
  problems related to this compatibility extension to cryptsetup project.
<h1 class="Sh" title="Sh" id="MISCELLANEOUS"><a class="selflink" href="#MISCELLANEOUS">MISCELLANEOUS</a></h1>
<i>repair</i> &lt;device&gt;
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Tries to repair the device metadata if possible. Currently
      supported only for LUKS device type.
    <div style="height: 1.00em;">&#x00A0;</div>
    This command is useful to fix some known benign LUKS metadata header
      corruptions. Only basic corruptions of unused keyslot are fixable. This
      command will only change the LUKS header, not any key-slot data.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>WARNING:</b> Always create a binary backup of the original header before
      calling this command.</dd>
</dl>
<div class="Pp"></div>
<i>benchmark</i> &lt;options&gt;
<dl class="Bl-tag">
  <dt class="It-tag"></dt>
  <dd class="It-tag">Benchmarks ciphers and KDF (key derivation function).
      Without parameters it tries to measure few common configurations.
    <div style="height: 1.00em;">&#x00A0;</div>
    To benchmark other ciphers or modes, you need to specify <b>--cipher</b> and
      <b>--key-size</b> options or <b>--hash</b> for KDF test.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>NOTE:</b> This benchmark is using memory only and is only informative.
      You cannot directly predict real storage encryption speed from it.
    <div style="height: 1.00em;">&#x00A0;</div>
    For testing block ciphers, this benchmark requires kernel userspace crypto
      API to be available (introduced in Linux kernel 2.6.38). If you are
      configuring kernel yourself, enable &quot;User-space interface for
      symmetric key cipher algorithms&quot; in &quot;Cryptographic API&quot;
      section (CRYPTO_USER_API_SKCIPHER .config option).
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>&lt;options&gt;</b> can be [--cipher, --key-size, --hash].</dd>
</dl>
<h1 class="Sh" title="Sh" id="OPTIONS"><a class="selflink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verbose, -v</b></dt>
  <dd class="It-tag">Print more information on command execution.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--debug</b></dt>
  <dd class="It-tag">Run in debug mode with full diagnostic logs. Debug output
      lines are always prefixed by '#'.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--hash, -h <i>&lt;hash-spec&gt;</i></b></dt>
  <dd class="It-tag">Specifies the passphrase hash for <i>open</i> (for plain
      and loopaes device types).
    <div style="height: 1.00em;">&#x00A0;</div>
    Specifies the hash used in the LUKS key setup scheme and volume key digest
      for <i>luksFormat</i>. The specified hash is used as hash-parameter for
      PBKDF2 and for the AF splitter.
    <div style="height: 1.00em;">&#x00A0;</div>
    The specified hash name is passed to the compiled-in crypto backend.
      Different backends may support different hashes. For <i>luksFormat</i>,
      the hash algorithm must provide at least 160 bits of output, which
      excludes, e.g., MD5. Do not use a non-crypto hash like
      <b>&quot;crc32&quot;</b> as this breaks security.
    <div style="height: 1.00em;">&#x00A0;</div>
    Values compatible with old version of cryptsetup are
      <b>&quot;ripemd160&quot;</b> for <i>open --type plain</i> and
      <b>&quot;sha1&quot;</b> for <i>luksFormat</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
    Use <i>cryptsetup --help</i> to show the defaults.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--cipher, -c <i>&lt;cipher-spec&gt;</i></b></dt>
  <dd class="It-tag">Set the cipher specification string.
    <div style="height: 1.00em;">&#x00A0;</div>
     <i>cryptsetup --help</i> shows the compiled-in defaults. The current
      default in the distributed sources is &quot;aes-cbc-essiv:sha256&quot; for
      plain dm-crypt and &quot;aes-xts-plain64&quot; for LUKS.
    <div style="height: 1.00em;">&#x00A0;</div>
    If a hash is part of the cipher specification, then it is used as part of
      the IV generation. For example, ESSIV needs a hash function, while
      &quot;plain64&quot; does not and hence none is specified.
    <div style="height: 1.00em;">&#x00A0;</div>
    For XTS mode you can optionally set a key size of 512 bits with the -s
      option. Key size for XTS mode is twice that for other modes for the same
      security level.
    <div style="height: 1.00em;">&#x00A0;</div>
    XTS mode requires kernel 2.6.24 or later and plain64 requires kernel 2.6.33
      or later. More information can be found in the FAQ.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--verify-passphrase, -y</b></dt>
  <dd class="It-tag">When interactively asking for a passphrase, ask for it
      twice and complain if both inputs do not match. Advised when creating a
      regular mapping for the first time, or when running <i>luksFormat</i>.
      Ignored on input from file or stdin.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--key-file, -d <i>name</i></b></dt>
  <dd class="It-tag">Read the passphrase from file.
    <div style="height: 1.00em;">&#x00A0;</div>
    If the name given is &quot;-&quot;, then the passphrase will be read from
      stdin. In this case, reading will not stop at newline characters.
    <div style="height: 1.00em;">&#x00A0;</div>
    With LUKS, passphrases supplied via --key-file are always the existing
      passphrases requested by a command, except in the case of
      <i>luksFormat</i> where --key-file is equivalent to the positional key
      file argument.
    <div style="height: 1.00em;">&#x00A0;</div>
    If you want to set a new passphrase via key file, you have to use a
      positional argument to <i>luksAddKey</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
    See section <b>NOTES ON PASSPHRASE PROCESSING</b> for more information.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--keyfile-offset <i>value</i></b></dt>
  <dd class="It-tag">Skip <i>value</i> bytes at the beginning of the key file.
      Works with all commands that accepts key files.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--keyfile-size, -l <i>value</i></b></dt>
  <dd class="It-tag">Read a maximum of <i>value</i> bytes from the key file.
      Default is to read the whole file up to the compiled-in maximum that can
      be queried with --help. Supplying more data than the compiled-in maximum
      aborts the operation.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option is useful to cut trailing newlines, for example. If
      --keyfile-offset is also given, the size count starts after the offset.
      Works with all commands that accepts key files.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--new-keyfile-offset <i>value</i></b></dt>
  <dd class="It-tag">Skip <i>value</i> bytes at the start when adding a new
      passphrase from key file with <i>luksAddKey</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--new-keyfile-size <i>value</i></b></dt>
  <dd class="It-tag">Read a maximum of <i>value</i> bytes when adding a new
      passphrase from key file with <i>luksAddKey</i>. Default is to read the
      whole file up to the compiled-in maximum length that can be queried with
      --help. Supplying more than the compiled in maximum aborts the operation.
      When --new-keyfile-offset is also given, reading starts after the
    offset.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--master-key-file</b></dt>
  <dd class="It-tag">Use a master key stored in a file.
    <div style="height: 1.00em;">&#x00A0;</div>
    For <i>luksFormat</i> this allows creating a LUKS header with this specific
      master key. If the master key was taken from an existing LUKS header and
      all other parameters are the same, then the new header decrypts the data
      encrypted with the header the master key was taken from.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>WARNING:</b> If you create your own master key, you need to make sure to
      do it right. Otherwise you can end up with a low-entropy or otherwise
      partially predictable master key which will compromise security.
    <div style="height: 1.00em;">&#x00A0;</div>
    For <i>luksAddKey</i> this allows adding a new passphrase without having to
      know an exiting one.
    <div style="height: 1.00em;">&#x00A0;</div>
    For <i>open</i> this allows one to open the LUKS device without giving a
      passphrase.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--dump-master-key</b></dt>
  <dd class="It-tag">For <i>luksDump</i> this option includes the master key in
      the displayed information. Use with care, as the master key can be used to
      bypass the passphrases, see also option --master-key-file.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--use-random</b></dt>
  <dd class="It-tag"></dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--use-urandom</b></dt>
  <dd class="It-tag">For <i>luksFormat</i> these options define which kernel
      random number generator will be used to create the master key (which is a
      long-term key).
    <div style="height: 1.00em;">&#x00A0;</div>
    See <b>NOTES ON RANDOM NUMBER GENERATORS</b> for more information. Use
      <i>cryptsetup --help</i> to show the compiled-in default random number
      generator.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>WARNING:</b> In a low-entropy situation (e.g. in an embedded system),
      both selections are problematic. Using /dev/urandom can lead to weak keys.
      Using /dev/random can block a long time, potentially forever, if not
      enough entropy can be harvested by the kernel.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--key-slot, -S &lt;0-7&gt;</b></dt>
  <dd class="It-tag">For LUKS operations that add key material, this options
      allows you to specify which key slot is selected for the new key. This
      option can be used for <i>luksFormat</i>, and <i>luksAddKey</i>.
    <div>&#x00A0;</div>
    In addition, for <i>open</i>, this option selects a specific key-slot to
      compare the passphrase against. If the given passphrase would only match a
      different key-slot, the operation fails.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--key-size, -s &lt;bits&gt;</b></dt>
  <dd class="It-tag">Sets key size in bits. The argument has to be a multiple of
      8. The possible key-sizes are limited by the cipher and mode used.
    <div style="height: 1.00em;">&#x00A0;</div>
    See /proc/crypto for more information. Note that key-size in /proc/crypto is
      stated in bytes.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option can be used for <i>open --type plain</i> or <i>luksFormat</i>.
      All other LUKS actions will use the key-size specified in the LUKS header.
      Use <i>cryptsetup --help</i> to show the compiled-in defaults.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--size, -b &lt;number of 512 byte sectors&gt;</b></dt>
  <dd class="It-tag">Force the size of the underlying device in sectors of 512
      bytes. This option is only relevant for the <i>open</i> and <i>resize</i>
      actions.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--offset, -o &lt;number of 512 byte sectors&gt;</b></dt>
  <dd class="It-tag">Start offset in the backend device in 512-byte sectors.
      This option is only relevant for the <i>open</i> action with plain or
      loopaes device types.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--skip, -p &lt;number of 512 byte sectors&gt;</b></dt>
  <dd class="It-tag">Start offset used in IV calculation in 512-byte sectors
      (how many sectors of the encrypted data to skip at the beginning). This
      option is only relevant for the <i>open</i> action with plain or loopaes
      device types.
    <div style="height: 1.00em;">&#x00A0;</div>
    Hence, if --offset <i>n</i>, and --skip <i>s</i>, sector <i>n</i> (the first
      sector of encrypted device) will get a sector number of <i>s</i> for the
      IV calculation.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--readonly, -r</b></dt>
  <dd class="It-tag">set up a read-only mapping.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--shared</b></dt>
  <dd class="It-tag">Creates an additional mapping for one common ciphertext
      device. Arbitrary mappings are supported. This option is only relevant for
      the <i>open --type plain</i> action. Use --offset, --size and --skip to
      specify the mapped area.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--iter-time, -i &lt;number of milliseconds&gt;</b></dt>
  <dd class="It-tag">The number of milliseconds to spend with PBKDF2 passphrase
      processing. This option is only relevant for LUKS operations that set or
      change passphrases, such as <i>luksFormat</i> or <i>luksAddKey</i>.
      Specifying 0 as parameter selects the compiled-in default.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--batch-mode, -q</b></dt>
  <dd class="It-tag">Suppresses all confirmation questions. Use with care!
    <div style="height: 1.00em;">&#x00A0;</div>
    If the -y option is not specified, this option also switches off the
      passphrase verification for <i>luksFormat</i>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--timeout, -t &lt;number of seconds&gt;</b></dt>
  <dd class="It-tag">The number of seconds to wait before timeout on passphrase
      input via terminal. It is relevant every time a passphrase is asked, for
      example for <i>open</i>, <i>luksFormat</i> or <i>luksAddKey</i>. It has no
      effect if used in conjunction with --key-file.
    <div>&#x00A0;</div>
    This option is useful when the system should not stall if the user does not
      input a passphrase, e.g. during boot. The default is a value of 0 seconds,
      which means to wait forever.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--tries, -T</b></dt>
  <dd class="It-tag">How often the input of the passphrase shall be retried.
      This option is relevant every time a passphrase is asked, for example for
      <i>open</i>, <i>luksFormat</i> or <i>luksAddKey</i>. The default is 3
      tries.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--align-payload &lt;number of 512 byte
    sectors&gt;</b></dt>
  <dd class="It-tag">Align payload at a boundary of <i>value</i> 512-byte
      sectors. This option is relevant for <i>luksFormat</i>.
    <div style="height: 1.00em;">&#x00A0;</div>
    If not specified, cryptsetup tries to use the topology info provided by
      kernel for the underlying device to get optimal alignment. If not
      available (or the calculated value is a multiple of the default) data is
      by default aligned to a 1MiB boundary (i.e. 2048 512-byte sectors).
    <div style="height: 1.00em;">&#x00A0;</div>
    For a detached LUKS header this option specifies the offset on the data
      device. See also the --header option.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--uuid=<i>UUID</i></b></dt>
  <dd class="It-tag">Use the provided <i>UUID</i> for the <i>luksFormat</i>
      command instead of generating new one. Changes the existing UUID when used
      with the <i>luksUUID</i> command.
    <div style="height: 1.00em;">&#x00A0;</div>
    The UUID must be provided in the standard UUID format, e.g.
      12345678-1234-1234-1234-123456789abc.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--allow-discards</b></dt>
  <dd class="It-tag">Allow the use of discard (TRIM) requests for device. This
      option is only relevant for <i>open</i> action.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>WARNING:</b> This command can have a negative security impact because it
      can make filesystem-level operations visible on the physical device. For
      example, information leaking filesystem type, used space, etc. may be
      extractable from the physical device if the discarded blocks can be
      located later. If in doubt, do not use it.
    <div style="height: 1.00em;">&#x00A0;</div>
    A kernel version of 3.1 or later is needed. For earlier kernels this option
      is ignored.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--perf-same_cpu_crypt</b></dt>
  <dd class="It-tag">Perform encryption using the same cpu that IO was submitted
      on. The default is to use an unbound workqueue so that encryption work is
      automatically balanced between available CPUs. This option is only
      relevant for <i>open</i> action.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>NOTE:</b> This option is available only for low-level dm-crypt
      performance tuning, use only if you need a change to default dm-crypt
      behaviour. Needs kernel 4.0 or later.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--perf-submit_from_crypt_cpus</b></dt>
  <dd class="It-tag">Disable offloading writes to a separate thread after
      encryption. There are some situations where offloading write bios from the
      encryption threads to a single thread degrades performance significantly.
      The default is to offload write bios to the same thread. This option is
      only relevant for <i>open</i> action.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>NOTE:</b> This option is available only for low-level dm-crypt
      performance tuning, use only if you need a change to default dm-crypt
      behaviour. Needs kernel 4.0 or later.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--test-passphrase</b></dt>
  <dd class="It-tag">Do not activate device, just verify passphrase. This option
      is only relevant for <i>open</i> action (the device mapping name is not
      mandatory if this option is used).</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--header &lt;device or file storing the LUKS
    header&gt;</b></dt>
  <dd class="It-tag">Use a detached (separated) metadata device or file where
      the LUKS header is stored. This options allows one to store ciphertext and
      LUKS header on different devices.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option is only relevant for LUKS devices and can be used with the
      <i>luksFormat</i>, <i>open</i>, <i>luksSuspend</i>, <i>luksResume</i>,
      <i>status</i> and <i>resize</i> commands.
    <div style="height: 1.00em;">&#x00A0;</div>
    For <i>luksFormat</i> with a file name as argument to --header, it has to
      exist and be large enough to contain the LUKS header. See the cryptsetup
      FAQ for header size calculation.
    <div style="height: 1.00em;">&#x00A0;</div>
    For other commands that change the LUKS header (e.g. <i>luksAddKey</i>),
      specify the device or file with the LUKS header directly as the LUKS
      device.
    <div style="height: 1.00em;">&#x00A0;</div>
    If used with <i>luksFormat</i>, the --align-payload option is taken as
      absolute sector alignment on ciphertext device and can be zero.
    <div style="height: 1.00em;">&#x00A0;</div>
     <b>WARNING:</b> There is no check whether the ciphertext device specified
      actually belongs to the header given. In fact you can specify an arbitrary
      device as the ciphertext device for <i>open</i> with the --header option.
      Use with care.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--force-password</b></dt>
  <dd class="It-tag">Do not use password quality checking for new LUKS
      passwords.
    <div style="height: 1.00em;">&#x00A0;</div>
    This option applies only to <i>luksFormat</i>, <i>luksAddKey</i> and
      <i>luksChangeKey</i> and is ignored if cryptsetup is built without
      password quality checking support.
    <div style="height: 1.00em;">&#x00A0;</div>
    For more info about password quality check, see manual page for
      <b>pwquality.conf(5)</b> and <b>passwdqc.conf(5)</b>.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--version</b></dt>
  <dd class="It-tag">Show the program version.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--usage</b></dt>
  <dd class="It-tag">Show short option help.</dd>
</dl>
<dl class="Bl-tag">
  <dt class="It-tag"><b>--help, -?</b></dt>
  <dd class="It-tag">Show help text and default parameters.</dd>
</dl>
<h1 class="Sh" title="Sh" id="RETURN_CODES"><a class="selflink" href="#RETURN_CODES">RETURN
  CODES</a></h1>
Cryptsetup returns 0 on success and a non-zero value on error.
<div style="height: 1.00em;">&#x00A0;</div>
Error codes are: 1 wrong parameters, 2 no permission (bad passphrase), 3 out of
  memory, 4 wrong device specified, 5 device already exists or device is busy.
<h1 class="Sh" title="Sh" id="NOTES_ON_PASSPHRASE_PROCESSING_FOR_PLAIN_MODE"><a class="selflink" href="#NOTES_ON_PASSPHRASE_PROCESSING_FOR_PLAIN_MODE">NOTES
  ON PASSPHRASE PROCESSING FOR PLAIN MODE</a></h1>
Note that no iterated hashing or salting is done in plain mode. If hashing is
  done, it is a single direct hash. This means that low-entropy passphrases are
  easy to attack in plain mode.
<div style="height: 1.00em;">&#x00A0;</div>
<b>From a terminal</b>: The passphrase is read until the first newline, i.e.
  '\n'. The input without the newline character is processed with the default
  hash or the hash specified with --hash. The hash result will be truncated to
  the key size of the used cipher, or the size specified with -s.
<div style="height: 1.00em;">&#x00A0;</div>
<b>From stdin</b>: Reading will continue until a newline (or until the maximum
  input size is reached), with the trailing newline stripped. The maximum input
  size is defined by the same compiled-in default as for the maximum key file
  size and can be overwritten using --keyfile-size option.
<div style="height: 1.00em;">&#x00A0;</div>
The data read will be hashed with the default hash or the hash specified with
  --hash. The hash result will be truncated to the key size of the used cipher,
  or the size specified with -s.
<div style="height: 1.00em;">&#x00A0;</div>
Note that if --key-file=- is used for reading the key from stdin, trailing
  newlines are not stripped from the input.
<div style="height: 1.00em;">&#x00A0;</div>
If &quot;plain&quot; is used as argument to --hash, the input data will not be
  hashed. Instead, it will be zero padded (if shorter than the key size) or
  truncated (if longer than the key size) and used directly as the binary key.
  This is useful for directly specifying a binary key. No warning will be given
  if the amount of data read from stdin is less than the key size.
<div style="height: 1.00em;">&#x00A0;</div>
<b>From a key file</b>: It will be truncated to the key size of the used cipher
  or the size given by -s and directly used as binary key.
<div style="height: 1.00em;">&#x00A0;</div>
<b>WARNING</b>: The --hash argument is being ignored. The --hash option is
  usable only for stdin input in plain mode.
<div style="height: 1.00em;">&#x00A0;</div>
If the key file is shorter than the key, cryptsetup will quit with an error. The
  maximum input size is defined by the same compiled-in default as for the
  maximum key file size and can be overwritten using --keyfile-size option.
<div style="height: 1.00em;">&#x00A0;</div>
<div style="height: 1.00em;">&#x00A0;</div>
<h1 class="Sh" title="Sh" id="NOTES_ON_PASSPHRASE_PROCESSING_FOR_LUKS"><a class="selflink" href="#NOTES_ON_PASSPHRASE_PROCESSING_FOR_LUKS">NOTES
  ON PASSPHRASE PROCESSING FOR LUKS</a></h1>
LUKS uses PBKDF2 to protect against dictionary attacks and to give some
  protection to low-entropy passphrases (see RFC 2898 and the cryptsetup FAQ).
<div style="height: 1.00em;">&#x00A0;</div>
<b>From a terminal</b>: The passphrase is read until the first newline and then
  processed by PBKDF2 without the newline character.
<div style="height: 1.00em;">&#x00A0;</div>
<b>From stdin</b>: LUKS will read passphrases from stdin up to the first newline
  character or the compiled-in maximum key file length. If --keyfile-size is
  given, it is ignored.
<div style="height: 1.00em;">&#x00A0;</div>
<b>From key file</b>: The complete keyfile is read up to the compiled-in maximum
  size. Newline characters do not terminate the input. The --keyfile-size option
  can be used to limit what is read.
<div style="height: 1.00em;">&#x00A0;</div>
<b>Passphrase processing</b>: Whenever a passphrase is added to a LUKS header
  (luksAddKey, luksFormat), the user may specify how much the time the
  passphrase processing should consume. The time is used to determine the
  iteration count for PBKDF2 and higher times will offer better protection for
  low-entropy passphrases, but open will take longer to complete. For
  passphrases that have entropy higher than the used key length, higher
  iteration times will not increase security.
<div style="height: 1.00em;">&#x00A0;</div>
The default setting of one second is sufficient for most practical cases. The
  only exception is a low-entropy passphrase used on a device with a slow CPU,
  as this will result in a low iteration count. On a slow device it may be
  advisable to increase the iteration time using the --iter-time option in order
  to obtain a higher iteration count. This does slow down all later luksOpen
  operations accordingly.
<h1 class="Sh" title="Sh" id="INCOHERENT_BEHAVIOR_FOR_INVALID_PASSPHRASES/KEYS"><a class="selflink" href="#INCOHERENT_BEHAVIOR_FOR_INVALID_PASSPHRASES/KEYS">INCOHERENT
  BEHAVIOR FOR INVALID PASSPHRASES/KEYS</a></h1>
LUKS checks for a valid passphrase when an encrypted partition is unlocked. The
  behavior of plain dm-crypt is different. It will always decrypt with the
  passphrase given. If the given passphrase is wrong, the device mapped by plain
  dm-crypt will essentially still contain encrypted data and will be unreadable.
<h1 class="Sh" title="Sh" id="NOTES_ON_SUPPORTED_CIPHERS,_MODES,_HASHES_AND_KEY_SIZES"><a class="selflink" href="#NOTES_ON_SUPPORTED_CIPHERS,_MODES,_HASHES_AND_KEY_SIZES">NOTES
  ON SUPPORTED CIPHERS, MODES, HASHES AND KEY SIZES</a></h1>
The available combinations of ciphers, modes, hashes and key sizes depend on
  kernel support. See /proc/crypto for a list of available options. You might
  need to load additional kernel crypto modules in order to get more options.
<div style="height: 1.00em;">&#x00A0;</div>
For the --hash option, if the crypto backend is libgcrypt, then all algorithms
  supported by the gcrypt library are available. For other crypto backends some
  algorithms may be missing.
<h1 class="Sh" title="Sh" id="NOTES_ON_PASSPHRASES"><a class="selflink" href="#NOTES_ON_PASSPHRASES">NOTES
  ON PASSPHRASES</a></h1>
Mathematics can't be bribed. Make sure you keep your passphrases safe. There are
  a few nice tricks for constructing a fallback, when suddenly out of the blue,
  your brain refuses to cooperate. These fallbacks need LUKS, as it's only
  possible with LUKS to have multiple passphrases. Still, if your attacker model
  does not prevent it, storing your passphrase in a sealed envelope somewhere
  may be a good idea as well.
<h1 class="Sh" title="Sh" id="NOTES_ON_RANDOM_NUMBER_GENERATORS"><a class="selflink" href="#NOTES_ON_RANDOM_NUMBER_GENERATORS">NOTES
  ON RANDOM NUMBER GENERATORS</a></h1>
Random Number Generators (RNG) used in cryptsetup are always the kernel RNGs
  without any modifications or additions to data stream produced.
<div style="height: 1.00em;">&#x00A0;</div>
There are two types of randomness cryptsetup/LUKS needs. One type (which always
  uses /dev/urandom) is used for salts, the AF splitter and for wiping deleted
  keyslots.
<div style="height: 1.00em;">&#x00A0;</div>
The second type is used for the volume (master) key. You can switch between
  using /dev/random and /dev/urandom here, see <b>--use-random</b> and
  <b>--use-urandom</b> options. Using /dev/random on a system without enough
  entropy sources can cause <b>luksFormat</b> to block until the requested
  amount of random data is gathered. In a low-entropy situation (embedded
  system), this can take a very long time and potentially forever. At the same
  time, using /dev/urandom in a low-entropy situation will produce low-quality
  keys. This is a serious problem, but solving it is out of scope for a mere
  man-page. See <b>urandom(4)</b> for more information.
<h1 class="Sh" title="Sh" id="NOTES_ON_LOOPBACK_DEVICE_USE"><a class="selflink" href="#NOTES_ON_LOOPBACK_DEVICE_USE">NOTES
  ON LOOPBACK DEVICE USE</a></h1>
Cryptsetup is usually used directly on a block device (disk partition or LVM
  volume). However, if the device argument is a file, cryptsetup tries to
  allocate a loopback device and map it into this file. This mode requires Linux
  kernel 2.6.25 or more recent which supports the loop autoclear flag (loop
  device is cleared on last close automatically). Of course, you can always map
  a file to a loop-device manually. See the cryptsetup FAQ for an example.
<div style="height: 1.00em;">&#x00A0;</div>
When device mapping is active, you can see the loop backing file in the status
  command output. Also see losetup(8).
<h1 class="Sh" title="Sh" id="DEPRECATED_ACTIONS"><a class="selflink" href="#DEPRECATED_ACTIONS">DEPRECATED
  ACTIONS</a></h1>
The <i>reload</i> action is no longer supported. Please use <i>dmsetup(8)</i> if
  you need to directly manipulate with the device mapping table.
<div class="Pp"></div>
The <i>luksDelKey</i> was replaced with <i>luksKillSlot</i>.
<h1 class="Sh" title="Sh" id="REPORTING_BUGS"><a class="selflink" href="#REPORTING_BUGS">REPORTING
  BUGS</a></h1>
Report bugs, including ones in the documentation, on the cryptsetup mailing list
  at &lt;dm-crypt@saout.de&gt; or in the 'Issues' section on LUKS website.
  Please attach the output of the failed command with the --debug option added.
<h1 class="Sh" title="Sh" id="AUTHORS"><a class="selflink" href="#AUTHORS">AUTHORS</a></h1>
cryptsetup originally written by Jana Saout &lt;jana@saout.de&gt;
<div>&#x00A0;</div>
The LUKS extensions and original man page were written by Clemens Fruhwirth
  &lt;clemens@endorphin.org&gt;.
<div>&#x00A0;</div>
Man page extensions by Milan Broz &lt;gmazyland@gmail.com&gt;.
<div>&#x00A0;</div>
Man page rewrite and extension by Arno Wagner &lt;arno@wagner.name&gt;.
<h1 class="Sh" title="Sh" id="COPYRIGHT"><a class="selflink" href="#COPYRIGHT">COPYRIGHT</a></h1>
Copyright &#x00A9; 2004 Jana Saout
<div>&#x00A0;</div>
Copyright &#x00A9; 2004-2006 Clemens Fruhwirth
<div>&#x00A0;</div>
Copyright &#x00A9; 2009-2015 Red Hat, Inc.
<div>&#x00A0;</div>
Copyright &#x00A9; 2009-2015 Milan Broz
<div>&#x00A0;</div>
Copyright &#x00A9; 2012-2014 Arno Wagner
<div style="height: 1.00em;">&#x00A0;</div>
This is free software; see the source for copying conditions. There is NO
  warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
<h1 class="Sh" title="Sh" id="SEE_ALSO"><a class="selflink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
The LUKS website at <b>https://gitlab.com/cryptsetup/cryptsetup/</b>
<div style="height: 1.00em;">&#x00A0;</div>
The cryptsetup FAQ, contained in the distribution package and online at
  <b>https://gitlab.com/cryptsetup/cryptsetup/wikis/FrequentlyAskedQuestions</b>
<div style="height: 1.00em;">&#x00A0;</div>
The cryptsetup mailing list and list archive, see FAQ entry 1.6.
<div style="height: 1.00em;">&#x00A0;</div>
The LUKS on-disk format specification available at
  <b>https://gitlab.com/cryptsetup/cryptsetup/wikis/Specification</b></div>
<table class="foot">
  <tr>
    <td class="foot-date">December 2013</td>
    <td class="foot-os">cryptsetup</td>
  </tr>
</table>
</body>
</html>
